<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2645218">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2645273">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2645327">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2645378">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2645414">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2645498">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2645555">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2645594">package</span>&nbsp;<span class="ident" id="2645602">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2645608">import</span>&nbsp;<span class="string" id="2645615">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2645625">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2645673">type</span>&nbsp;<span class="ident" id="2645678">data</span>&nbsp;<span class="keyword" id="2645683">struct</span>&nbsp;<span class="op" id="2645690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645693">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2645699">[</span><span class="op" id="2645700">]</span><span class="builtintype" id="2645701">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2645707">error</span>&nbsp;<span class="builtintype" id="2645713">bool</span><br>
<span class="lineno"></span><span class="op" id="2645718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2645721">func</span>&nbsp;<span class="op" id="2645726">(</span><span class="ident" id="2645727">d</span>&nbsp;<span class="op" id="2645729">*</span><span class="ident" id="2645730">data</span><span class="op" id="2645734">)</span>&nbsp;<span class="ident" id="2645736">read</span><span class="op" id="2645740">(</span><span class="ident" id="2645741">n</span>&nbsp;<span class="builtintype" id="2645743">int</span><span class="op" id="2645746">)</span>&nbsp;<span class="op" id="2645748">[</span><span class="op" id="2645749">]</span><span class="builtintype" id="2645750">byte</span>&nbsp;<span class="op" id="2645755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645758">if</span>&nbsp;<span class="builtinfunc" id="2645761">len</span><span class="op" id="2645764">(</span><span class="ident" id="2645765">d</span><span class="op" id="2645766">.</span><span class="ident" id="2645767">p</span><span class="op" id="2645768">)</span>&nbsp;<span class="op" id="2645770">&lt;</span>&nbsp;<span class="ident" id="2645772">n</span>&nbsp;<span class="op" id="2645774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645778">d</span><span class="op" id="2645779">.</span><span class="ident" id="2645780">p</span>&nbsp;<span class="op" id="2645782">=</span>&nbsp;<span class="ident" id="2645784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645790">d</span><span class="op" id="2645791">.</span><span class="builtintype" id="2645792">error</span>&nbsp;<span class="op" id="2645798">=</span>&nbsp;<span class="builtintype" id="2645800">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645807">return</span>&nbsp;<span class="ident" id="2645814">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645822">p</span>&nbsp;<span class="op" id="2645824">:=</span>&nbsp;<span class="ident" id="2645827">d</span><span class="op" id="2645828">.</span><span class="ident" id="2645829">p</span><span class="op" id="2645830">[</span><span class="num" id="2645831">0</span><span class="op" id="2645832">:</span><span class="ident" id="2645833">n</span><span class="op" id="2645834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645837">d</span><span class="op" id="2645838">.</span><span class="ident" id="2645839">p</span>&nbsp;<span class="op" id="2645841">=</span>&nbsp;<span class="ident" id="2645843">d</span><span class="op" id="2645844">.</span><span class="ident" id="2645845">p</span><span class="op" id="2645846">[</span><span class="ident" id="2645847">n</span><span class="op" id="2645848">:</span><span class="op" id="2645849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645852">return</span>&nbsp;<span class="ident" id="2645859">p</span><br>
<span class="lineno"></span><span class="op" id="2645861">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2645864">func</span>&nbsp;<span class="op" id="2645869">(</span><span class="ident" id="2645870">d</span>&nbsp;<span class="op" id="2645872">*</span><span class="ident" id="2645873">data</span><span class="op" id="2645877">)</span>&nbsp;<span class="ident" id="2645879">big4</span><span class="op" id="2645883">(</span><span class="op" id="2645884">)</span>&nbsp;<span class="op" id="2645886">(</span><span class="ident" id="2645887">n</span>&nbsp;<span class="builtintype" id="2645889">uint32</span><span class="op" id="2645895">,</span>&nbsp;<span class="ident" id="2645897">ok</span>&nbsp;<span class="builtintype" id="2645900">bool</span><span class="op" id="2645904">)</span>&nbsp;<span class="op" id="2645906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645909">p</span>&nbsp;<span class="op" id="2645911">:=</span>&nbsp;<span class="ident" id="2645914">d</span><span class="op" id="2645915">.</span><span class="ident" id="2645916">read</span><span class="op" id="2645920">(</span><span class="num" id="2645921">4</span><span class="op" id="2645922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645925">if</span>&nbsp;<span class="builtinfunc" id="2645928">len</span><span class="op" id="2645931">(</span><span class="ident" id="2645932">p</span><span class="op" id="2645933">)</span>&nbsp;<span class="op" id="2645935">&lt;</span>&nbsp;<span class="num" id="2645937">4</span>&nbsp;<span class="op" id="2645939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645943">d</span><span class="op" id="2645944">.</span><span class="builtintype" id="2645945">error</span>&nbsp;<span class="op" id="2645951">=</span>&nbsp;<span class="builtintype" id="2645953">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645960">return</span>&nbsp;<span class="num" id="2645967">0</span><span class="op" id="2645968">,</span>&nbsp;<span class="builtintype" id="2645970">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645980">return</span>&nbsp;<span class="builtintype" id="2645987">uint32</span><span class="op" id="2645993">(</span><span class="ident" id="2645994">p</span><span class="op" id="2645995">[</span><span class="num" id="2645996">0</span><span class="op" id="2645997">]</span><span class="op" id="2645998">)</span><span class="op" id="2645999">&lt;&lt;</span><span class="num" id="2646001">24</span>&nbsp;<span class="op" id="2646004">|</span>&nbsp;<span class="builtintype" id="2646006">uint32</span><span class="op" id="2646012">(</span><span class="ident" id="2646013">p</span><span class="op" id="2646014">[</span><span class="num" id="2646015">1</span><span class="op" id="2646016">]</span><span class="op" id="2646017">)</span><span class="op" id="2646018">&lt;&lt;</span><span class="num" id="2646020">16</span>&nbsp;<span class="op" id="2646023">|</span>&nbsp;<span class="builtintype" id="2646025">uint32</span><span class="op" id="2646031">(</span><span class="ident" id="2646032">p</span><span class="op" id="2646033">[</span><span class="num" id="2646034">2</span><span class="op" id="2646035">]</span><span class="op" id="2646036">)</span><span class="op" id="2646037">&lt;&lt;</span><span class="num" id="2646039">8</span>&nbsp;<span class="op" id="2646041">|</span>&nbsp;<span class="builtintype" id="2646043">uint32</span><span class="op" id="2646049">(</span><span class="ident" id="2646050">p</span><span class="op" id="2646051">[</span><span class="num" id="2646052">3</span><span class="op" id="2646053">]</span><span class="op" id="2646054">)</span><span class="op" id="2646055">,</span>&nbsp;<span class="builtintype" id="2646057">true</span><br>
<span class="lineno"></span><span class="op" id="2646062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2646065">func</span>&nbsp;<span class="op" id="2646070">(</span><span class="ident" id="2646071">d</span>&nbsp;<span class="op" id="2646073">*</span><span class="ident" id="2646074">data</span><span class="op" id="2646078">)</span>&nbsp;<span class="builtintype" id="2646080">byte</span><span class="op" id="2646084">(</span><span class="op" id="2646085">)</span>&nbsp;<span class="op" id="2646087">(</span><span class="ident" id="2646088">n</span>&nbsp;<span class="builtintype" id="2646090">byte</span><span class="op" id="2646094">,</span>&nbsp;<span class="ident" id="2646096">ok</span>&nbsp;<span class="builtintype" id="2646099">bool</span><span class="op" id="2646103">)</span>&nbsp;<span class="op" id="2646105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646108">p</span>&nbsp;<span class="op" id="2646110">:=</span>&nbsp;<span class="ident" id="2646113">d</span><span class="op" id="2646114">.</span><span class="ident" id="2646115">read</span><span class="op" id="2646119">(</span><span class="num" id="2646120">1</span><span class="op" id="2646121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646124">if</span>&nbsp;<span class="builtinfunc" id="2646127">len</span><span class="op" id="2646130">(</span><span class="ident" id="2646131">p</span><span class="op" id="2646132">)</span>&nbsp;<span class="op" id="2646134">&lt;</span>&nbsp;<span class="num" id="2646136">1</span>&nbsp;<span class="op" id="2646138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646142">d</span><span class="op" id="2646143">.</span><span class="builtintype" id="2646144">error</span>&nbsp;<span class="op" id="2646150">=</span>&nbsp;<span class="builtintype" id="2646152">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646159">return</span>&nbsp;<span class="num" id="2646166">0</span><span class="op" id="2646167">,</span>&nbsp;<span class="builtintype" id="2646169">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646179">return</span>&nbsp;<span class="ident" id="2646186">p</span><span class="op" id="2646187">[</span><span class="num" id="2646188">0</span><span class="op" id="2646189">]</span><span class="op" id="2646190">,</span>&nbsp;<span class="builtintype" id="2646192">true</span><br>
<span class="lineno"></span><span class="op" id="2646197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2646200">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2646246">func</span>&nbsp;<span class="ident" id="2646251">byteString</span><span class="op" id="2646261">(</span><span class="ident" id="2646262">p</span>&nbsp;<span class="op" id="2646264">[</span><span class="op" id="2646265">]</span><span class="builtintype" id="2646266">byte</span><span class="op" id="2646270">)</span>&nbsp;<span class="builtintype" id="2646272">string</span>&nbsp;<span class="op" id="2646279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646282">for</span>&nbsp;<span class="ident" id="2646286">i</span>&nbsp;<span class="op" id="2646288">:=</span>&nbsp;<span class="num" id="2646291">0</span><span class="op" id="2646292">;</span>&nbsp;<span class="ident" id="2646294">i</span>&nbsp;<span class="op" id="2646296">&lt;</span>&nbsp;<span class="builtinfunc" id="2646298">len</span><span class="op" id="2646301">(</span><span class="ident" id="2646302">p</span><span class="op" id="2646303">)</span><span class="op" id="2646304">;</span>&nbsp;<span class="ident" id="2646306">i</span><span class="op" id="2646307">++</span>&nbsp;<span class="op" id="2646310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646314">if</span>&nbsp;<span class="ident" id="2646317">p</span><span class="op" id="2646318">[</span><span class="ident" id="2646319">i</span><span class="op" id="2646320">]</span>&nbsp;<span class="op" id="2646322">==</span>&nbsp;<span class="num" id="2646325">0</span>&nbsp;<span class="op" id="2646327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646332">return</span>&nbsp;<span class="builtintype" id="2646339">string</span><span class="op" id="2646345">(</span><span class="ident" id="2646346">p</span><span class="op" id="2646347">[</span><span class="num" id="2646348">0</span><span class="op" id="2646349">:</span><span class="ident" id="2646350">i</span><span class="op" id="2646351">]</span><span class="op" id="2646352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646356">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646362">return</span>&nbsp;<span class="builtintype" id="2646369">string</span><span class="op" id="2646375">(</span><span class="ident" id="2646376">p</span><span class="op" id="2646377">)</span><br>
<span class="lineno"></span><span class="op" id="2646379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2646382">var</span>&nbsp;<span class="ident" id="2646386">badData</span>&nbsp;<span class="op" id="2646394">=</span>&nbsp;<span class="ident" id="2646396">errors</span><span class="op" id="2646402">.</span><span class="ident" id="2646403">New</span><span class="op" id="2646406">(</span><span class="string" id="2646407">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2646440">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2646443">func</span>&nbsp;<span class="ident" id="2646448">loadZoneData</span><span class="op" id="2646460">(</span><span class="ident" id="2646461">bytes</span>&nbsp;<span class="op" id="2646467">[</span><span class="op" id="2646468">]</span><span class="builtintype" id="2646469">byte</span><span class="op" id="2646473">)</span>&nbsp;<span class="op" id="2646475">(</span><span class="ident" id="2646476">l</span>&nbsp;<span class="op" id="2646478">*</span><span class="ident" id="2646479">Location</span><span class="op" id="2646487">,</span>&nbsp;<span class="ident" id="2646489">err</span>&nbsp;<span class="builtintype" id="2646493">error</span><span class="op" id="2646498">)</span>&nbsp;<span class="op" id="2646500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646503">d</span>&nbsp;<span class="op" id="2646505">:=</span>&nbsp;<span class="ident" id="2646508">data</span><span class="op" id="2646512">{</span><span class="ident" id="2646513">bytes</span><span class="op" id="2646518">,</span>&nbsp;<span class="builtintype" id="2646520">false</span><span class="op" id="2646525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646529">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646553">if</span>&nbsp;<span class="ident" id="2646556">magic</span>&nbsp;<span class="op" id="2646562">:=</span>&nbsp;<span class="ident" id="2646565">d</span><span class="op" id="2646566">.</span><span class="ident" id="2646567">read</span><span class="op" id="2646571">(</span><span class="num" id="2646572">4</span><span class="op" id="2646573">)</span><span class="op" id="2646574">;</span>&nbsp;<span class="builtintype" id="2646576">string</span><span class="op" id="2646582">(</span><span class="ident" id="2646583">magic</span><span class="op" id="2646588">)</span>&nbsp;<span class="op" id="2646590">!=</span>&nbsp;<span class="string" id="2646593">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2646600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646604">return</span>&nbsp;<span class="ident" id="2646611">nil</span><span class="op" id="2646614">,</span>&nbsp;<span class="ident" id="2646616">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646629">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646674">var</span>&nbsp;<span class="ident" id="2646678">p</span>&nbsp;<span class="op" id="2646680">[</span><span class="op" id="2646681">]</span><span class="builtintype" id="2646682">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646688">if</span>&nbsp;<span class="ident" id="2646691">p</span>&nbsp;<span class="op" id="2646693">=</span>&nbsp;<span class="ident" id="2646695">d</span><span class="op" id="2646696">.</span><span class="ident" id="2646697">read</span><span class="op" id="2646701">(</span><span class="num" id="2646702">16</span><span class="op" id="2646704">)</span><span class="op" id="2646705">;</span>&nbsp;<span class="builtinfunc" id="2646707">len</span><span class="op" id="2646710">(</span><span class="ident" id="2646711">p</span><span class="op" id="2646712">)</span>&nbsp;<span class="op" id="2646714">!=</span>&nbsp;<span class="num" id="2646717">16</span>&nbsp;<span class="op" id="2646720">||</span>&nbsp;<span class="ident" id="2646723">p</span><span class="op" id="2646724">[</span><span class="num" id="2646725">0</span><span class="op" id="2646726">]</span>&nbsp;<span class="op" id="2646728">!=</span>&nbsp;<span class="num" id="2646731">0</span>&nbsp;<span class="op" id="2646733">&amp;&amp;</span>&nbsp;<span class="ident" id="2646736">p</span><span class="op" id="2646737">[</span><span class="num" id="2646738">0</span><span class="op" id="2646739">]</span>&nbsp;<span class="op" id="2646741">!=</span>&nbsp;<span class="string" id="2646744">&#39;2&#39;</span>&nbsp;<span class="op" id="2646748">&amp;&amp;</span>&nbsp;<span class="ident" id="2646751">p</span><span class="op" id="2646752">[</span><span class="num" id="2646753">0</span><span class="op" id="2646754">]</span>&nbsp;<span class="op" id="2646756">!=</span>&nbsp;<span class="string" id="2646759">&#39;3&#39;</span>&nbsp;<span class="op" id="2646763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646767">return</span>&nbsp;<span class="ident" id="2646774">nil</span><span class="op" id="2646777">,</span>&nbsp;<span class="ident" id="2646779">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646792">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646828">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646863">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646902">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646929">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646960">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2646991">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647044">const</span>&nbsp;<span class="op" id="2647050">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647054">NUTCLocal</span>&nbsp;<span class="op" id="2647064">=</span>&nbsp;<span class="ident" id="2647066">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647073">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647084">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647092">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647100">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647108">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647115">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647118">var</span>&nbsp;<span class="ident" id="2647122">n</span>&nbsp;<span class="op" id="2647124">[</span><span class="num" id="2647125">6</span><span class="op" id="2647126">]</span><span class="builtintype" id="2647127">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647132">for</span>&nbsp;<span class="ident" id="2647136">i</span>&nbsp;<span class="op" id="2647138">:=</span>&nbsp;<span class="num" id="2647141">0</span><span class="op" id="2647142">;</span>&nbsp;<span class="ident" id="2647144">i</span>&nbsp;<span class="op" id="2647146">&lt;</span>&nbsp;<span class="num" id="2647148">6</span><span class="op" id="2647149">;</span>&nbsp;<span class="ident" id="2647151">i</span><span class="op" id="2647152">++</span>&nbsp;<span class="op" id="2647155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647159">nn</span><span class="op" id="2647161">,</span>&nbsp;<span class="ident" id="2647163">ok</span>&nbsp;<span class="op" id="2647166">:=</span>&nbsp;<span class="ident" id="2647169">d</span><span class="op" id="2647170">.</span><span class="ident" id="2647171">big4</span><span class="op" id="2647175">(</span><span class="op" id="2647176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647180">if</span>&nbsp;<span class="op" id="2647183">!</span><span class="ident" id="2647184">ok</span>&nbsp;<span class="op" id="2647187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647192">return</span>&nbsp;<span class="ident" id="2647199">nil</span><span class="op" id="2647202">,</span>&nbsp;<span class="ident" id="2647204">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647218">n</span><span class="op" id="2647219">[</span><span class="ident" id="2647220">i</span><span class="op" id="2647221">]</span>&nbsp;<span class="op" id="2647223">=</span>&nbsp;<span class="builtintype" id="2647225">int</span><span class="op" id="2647228">(</span><span class="ident" id="2647229">nn</span><span class="op" id="2647231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647238">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647260">txtimes</span>&nbsp;<span class="op" id="2647268">:=</span>&nbsp;<span class="ident" id="2647271">data</span><span class="op" id="2647275">{</span><span class="ident" id="2647276">d</span><span class="op" id="2647277">.</span><span class="ident" id="2647278">read</span><span class="op" id="2647282">(</span><span class="ident" id="2647283">n</span><span class="op" id="2647284">[</span><span class="ident" id="2647285">NTime</span><span class="op" id="2647290">]</span>&nbsp;<span class="op" id="2647292">*</span>&nbsp;<span class="num" id="2647294">4</span><span class="op" id="2647295">)</span><span class="op" id="2647296">,</span>&nbsp;<span class="builtintype" id="2647298">false</span><span class="op" id="2647303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647307">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647351">txzones</span>&nbsp;<span class="op" id="2647359">:=</span>&nbsp;<span class="ident" id="2647362">d</span><span class="op" id="2647363">.</span><span class="ident" id="2647364">read</span><span class="op" id="2647368">(</span><span class="ident" id="2647369">n</span><span class="op" id="2647370">[</span><span class="ident" id="2647371">NTime</span><span class="op" id="2647376">]</span><span class="op" id="2647377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647381">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647406">zonedata</span>&nbsp;<span class="op" id="2647415">:=</span>&nbsp;<span class="ident" id="2647418">data</span><span class="op" id="2647422">{</span><span class="ident" id="2647423">d</span><span class="op" id="2647424">.</span><span class="ident" id="2647425">read</span><span class="op" id="2647429">(</span><span class="ident" id="2647430">n</span><span class="op" id="2647431">[</span><span class="ident" id="2647432">NZone</span><span class="op" id="2647437">]</span>&nbsp;<span class="op" id="2647439">*</span>&nbsp;<span class="num" id="2647441">6</span><span class="op" id="2647442">)</span><span class="op" id="2647443">,</span>&nbsp;<span class="builtintype" id="2647445">false</span><span class="op" id="2647450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647454">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647483">abbrev</span>&nbsp;<span class="op" id="2647490">:=</span>&nbsp;<span class="ident" id="2647493">d</span><span class="op" id="2647494">.</span><span class="ident" id="2647495">read</span><span class="op" id="2647499">(</span><span class="ident" id="2647500">n</span><span class="op" id="2647501">[</span><span class="ident" id="2647502">NChar</span><span class="op" id="2647507">]</span><span class="op" id="2647508">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647512">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647539">d</span><span class="op" id="2647540">.</span><span class="ident" id="2647541">read</span><span class="op" id="2647545">(</span><span class="ident" id="2647546">n</span><span class="op" id="2647547">[</span><span class="ident" id="2647548">NLeap</span><span class="op" id="2647553">]</span>&nbsp;<span class="op" id="2647555">*</span>&nbsp;<span class="num" id="2647557">8</span><span class="op" id="2647558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647562">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647616">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647665">isstd</span>&nbsp;<span class="op" id="2647671">:=</span>&nbsp;<span class="ident" id="2647674">d</span><span class="op" id="2647675">.</span><span class="ident" id="2647676">read</span><span class="op" id="2647680">(</span><span class="ident" id="2647681">n</span><span class="op" id="2647682">[</span><span class="ident" id="2647683">NStdWall</span><span class="op" id="2647691">]</span><span class="op" id="2647692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647696">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647750">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647790">isutc</span>&nbsp;<span class="op" id="2647796">:=</span>&nbsp;<span class="ident" id="2647799">d</span><span class="op" id="2647800">.</span><span class="ident" id="2647801">read</span><span class="op" id="2647805">(</span><span class="ident" id="2647806">n</span><span class="op" id="2647807">[</span><span class="ident" id="2647808">NUTCLocal</span><span class="op" id="2647817">]</span><span class="op" id="2647818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647822">if</span>&nbsp;<span class="ident" id="2647825">d</span><span class="op" id="2647826">.</span><span class="builtintype" id="2647827">error</span>&nbsp;<span class="op" id="2647833">{</span>&nbsp;<span class="comment" id="2647835">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647856">return</span>&nbsp;<span class="ident" id="2647863">nil</span><span class="op" id="2647866">,</span>&nbsp;<span class="ident" id="2647868">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647877">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647881">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647948">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2647994">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648031">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648080">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648112">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648148">zone</span>&nbsp;<span class="op" id="2648153">:=</span>&nbsp;<span class="builtinfunc" id="2648156">make</span><span class="op" id="2648160">(</span><span class="op" id="2648161">[</span><span class="op" id="2648162">]</span><span class="ident" id="2648163">zone</span><span class="op" id="2648167">,</span>&nbsp;<span class="ident" id="2648169">n</span><span class="op" id="2648170">[</span><span class="ident" id="2648171">NZone</span><span class="op" id="2648176">]</span><span class="op" id="2648177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648180">for</span>&nbsp;<span class="ident" id="2648184">i</span>&nbsp;<span class="op" id="2648186">:=</span>&nbsp;<span class="keyword" id="2648189">range</span>&nbsp;<span class="ident" id="2648195">zone</span>&nbsp;<span class="op" id="2648200">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648204">var</span>&nbsp;<span class="ident" id="2648208">ok</span>&nbsp;<span class="builtintype" id="2648211">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648218">var</span>&nbsp;<span class="ident" id="2648222">n</span>&nbsp;<span class="builtintype" id="2648224">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648233">if</span>&nbsp;<span class="ident" id="2648236">n</span><span class="op" id="2648237">,</span>&nbsp;<span class="ident" id="2648239">ok</span>&nbsp;<span class="op" id="2648242">=</span>&nbsp;<span class="ident" id="2648244">zonedata</span><span class="op" id="2648252">.</span><span class="ident" id="2648253">big4</span><span class="op" id="2648257">(</span><span class="op" id="2648258">)</span><span class="op" id="2648259">;</span>&nbsp;<span class="op" id="2648261">!</span><span class="ident" id="2648262">ok</span>&nbsp;<span class="op" id="2648265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648270">return</span>&nbsp;<span class="ident" id="2648277">nil</span><span class="op" id="2648280">,</span>&nbsp;<span class="ident" id="2648282">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648292">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648296">zone</span><span class="op" id="2648300">[</span><span class="ident" id="2648301">i</span><span class="op" id="2648302">]</span><span class="op" id="2648303">.</span><span class="ident" id="2648304">offset</span>&nbsp;<span class="op" id="2648311">=</span>&nbsp;<span class="builtintype" id="2648313">int</span><span class="op" id="2648316">(</span><span class="builtintype" id="2648317">int32</span><span class="op" id="2648322">(</span><span class="ident" id="2648323">n</span><span class="op" id="2648324">)</span><span class="op" id="2648325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648329">var</span>&nbsp;<span class="ident" id="2648333">b</span>&nbsp;<span class="builtintype" id="2648335">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648342">if</span>&nbsp;<span class="ident" id="2648345">b</span><span class="op" id="2648346">,</span>&nbsp;<span class="ident" id="2648348">ok</span>&nbsp;<span class="op" id="2648351">=</span>&nbsp;<span class="ident" id="2648353">zonedata</span><span class="op" id="2648361">.</span><span class="builtintype" id="2648362">byte</span><span class="op" id="2648366">(</span><span class="op" id="2648367">)</span><span class="op" id="2648368">;</span>&nbsp;<span class="op" id="2648370">!</span><span class="ident" id="2648371">ok</span>&nbsp;<span class="op" id="2648374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648379">return</span>&nbsp;<span class="ident" id="2648386">nil</span><span class="op" id="2648389">,</span>&nbsp;<span class="ident" id="2648391">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648401">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648405">zone</span><span class="op" id="2648409">[</span><span class="ident" id="2648410">i</span><span class="op" id="2648411">]</span><span class="op" id="2648412">.</span><span class="ident" id="2648413">isDST</span>&nbsp;<span class="op" id="2648419">=</span>&nbsp;<span class="ident" id="2648421">b</span>&nbsp;<span class="op" id="2648423">!=</span>&nbsp;<span class="num" id="2648426">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648430">if</span>&nbsp;<span class="ident" id="2648433">b</span><span class="op" id="2648434">,</span>&nbsp;<span class="ident" id="2648436">ok</span>&nbsp;<span class="op" id="2648439">=</span>&nbsp;<span class="ident" id="2648441">zonedata</span><span class="op" id="2648449">.</span><span class="builtintype" id="2648450">byte</span><span class="op" id="2648454">(</span><span class="op" id="2648455">)</span><span class="op" id="2648456">;</span>&nbsp;<span class="op" id="2648458">!</span><span class="ident" id="2648459">ok</span>&nbsp;<span class="op" id="2648462">||</span>&nbsp;<span class="builtintype" id="2648465">int</span><span class="op" id="2648468">(</span><span class="ident" id="2648469">b</span><span class="op" id="2648470">)</span>&nbsp;<span class="op" id="2648472">&gt;=</span>&nbsp;<span class="builtinfunc" id="2648475">len</span><span class="op" id="2648478">(</span><span class="ident" id="2648479">abbrev</span><span class="op" id="2648485">)</span>&nbsp;<span class="op" id="2648487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648492">return</span>&nbsp;<span class="ident" id="2648499">nil</span><span class="op" id="2648502">,</span>&nbsp;<span class="ident" id="2648504">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648518">zone</span><span class="op" id="2648522">[</span><span class="ident" id="2648523">i</span><span class="op" id="2648524">]</span><span class="op" id="2648525">.</span><span class="ident" id="2648526">name</span>&nbsp;<span class="op" id="2648531">=</span>&nbsp;<span class="ident" id="2648533">byteString</span><span class="op" id="2648543">(</span><span class="ident" id="2648544">abbrev</span><span class="op" id="2648550">[</span><span class="ident" id="2648551">b</span><span class="op" id="2648552">:</span><span class="op" id="2648553">]</span><span class="op" id="2648554">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648561">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648595">tx</span>&nbsp;<span class="op" id="2648598">:=</span>&nbsp;<span class="builtinfunc" id="2648601">make</span><span class="op" id="2648605">(</span><span class="op" id="2648606">[</span><span class="op" id="2648607">]</span><span class="ident" id="2648608">zoneTrans</span><span class="op" id="2648617">,</span>&nbsp;<span class="ident" id="2648619">n</span><span class="op" id="2648620">[</span><span class="ident" id="2648621">NTime</span><span class="op" id="2648626">]</span><span class="op" id="2648627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648630">for</span>&nbsp;<span class="ident" id="2648634">i</span>&nbsp;<span class="op" id="2648636">:=</span>&nbsp;<span class="keyword" id="2648639">range</span>&nbsp;<span class="ident" id="2648645">tx</span>&nbsp;<span class="op" id="2648648">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648652">var</span>&nbsp;<span class="ident" id="2648656">ok</span>&nbsp;<span class="builtintype" id="2648659">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648666">var</span>&nbsp;<span class="ident" id="2648670">n</span>&nbsp;<span class="builtintype" id="2648672">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648681">if</span>&nbsp;<span class="ident" id="2648684">n</span><span class="op" id="2648685">,</span>&nbsp;<span class="ident" id="2648687">ok</span>&nbsp;<span class="op" id="2648690">=</span>&nbsp;<span class="ident" id="2648692">txtimes</span><span class="op" id="2648699">.</span><span class="ident" id="2648700">big4</span><span class="op" id="2648704">(</span><span class="op" id="2648705">)</span><span class="op" id="2648706">;</span>&nbsp;<span class="op" id="2648708">!</span><span class="ident" id="2648709">ok</span>&nbsp;<span class="op" id="2648712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648717">return</span>&nbsp;<span class="ident" id="2648724">nil</span><span class="op" id="2648727">,</span>&nbsp;<span class="ident" id="2648729">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648739">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648743">tx</span><span class="op" id="2648745">[</span><span class="ident" id="2648746">i</span><span class="op" id="2648747">]</span><span class="op" id="2648748">.</span><span class="ident" id="2648749">when</span>&nbsp;<span class="op" id="2648754">=</span>&nbsp;<span class="ident" id="2648756">int64</span><span class="op" id="2648761">(</span><span class="builtintype" id="2648762">int32</span><span class="op" id="2648767">(</span><span class="ident" id="2648768">n</span><span class="op" id="2648769">)</span><span class="op" id="2648770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648774">if</span>&nbsp;<span class="builtintype" id="2648777">int</span><span class="op" id="2648780">(</span><span class="ident" id="2648781">txzones</span><span class="op" id="2648788">[</span><span class="ident" id="2648789">i</span><span class="op" id="2648790">]</span><span class="op" id="2648791">)</span>&nbsp;<span class="op" id="2648793">&gt;=</span>&nbsp;<span class="builtinfunc" id="2648796">len</span><span class="op" id="2648799">(</span><span class="ident" id="2648800">zone</span><span class="op" id="2648804">)</span>&nbsp;<span class="op" id="2648806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648811">return</span>&nbsp;<span class="ident" id="2648818">nil</span><span class="op" id="2648821">,</span>&nbsp;<span class="ident" id="2648823">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648837">tx</span><span class="op" id="2648839">[</span><span class="ident" id="2648840">i</span><span class="op" id="2648841">]</span><span class="op" id="2648842">.</span><span class="ident" id="2648843">index</span>&nbsp;<span class="op" id="2648849">=</span>&nbsp;<span class="ident" id="2648851">txzones</span><span class="op" id="2648858">[</span><span class="ident" id="2648859">i</span><span class="op" id="2648860">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648864">if</span>&nbsp;<span class="ident" id="2648867">i</span>&nbsp;<span class="op" id="2648869">&lt;</span>&nbsp;<span class="builtinfunc" id="2648871">len</span><span class="op" id="2648874">(</span><span class="ident" id="2648875">isstd</span><span class="op" id="2648880">)</span>&nbsp;<span class="op" id="2648882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648887">tx</span><span class="op" id="2648889">[</span><span class="ident" id="2648890">i</span><span class="op" id="2648891">]</span><span class="op" id="2648892">.</span><span class="ident" id="2648893">isstd</span>&nbsp;<span class="op" id="2648899">=</span>&nbsp;<span class="ident" id="2648901">isstd</span><span class="op" id="2648906">[</span><span class="ident" id="2648907">i</span><span class="op" id="2648908">]</span>&nbsp;<span class="op" id="2648910">!=</span>&nbsp;<span class="num" id="2648913">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648921">if</span>&nbsp;<span class="ident" id="2648924">i</span>&nbsp;<span class="op" id="2648926">&lt;</span>&nbsp;<span class="builtinfunc" id="2648928">len</span><span class="op" id="2648931">(</span><span class="ident" id="2648932">isutc</span><span class="op" id="2648937">)</span>&nbsp;<span class="op" id="2648939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648944">tx</span><span class="op" id="2648946">[</span><span class="ident" id="2648947">i</span><span class="op" id="2648948">]</span><span class="op" id="2648949">.</span><span class="ident" id="2648950">isutc</span>&nbsp;<span class="op" id="2648956">=</span>&nbsp;<span class="ident" id="2648958">isutc</span><span class="op" id="2648963">[</span><span class="ident" id="2648964">i</span><span class="op" id="2648965">]</span>&nbsp;<span class="op" id="2648967">!=</span>&nbsp;<span class="num" id="2648970">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648981">if</span>&nbsp;<span class="builtinfunc" id="2648984">len</span><span class="op" id="2648987">(</span><span class="ident" id="2648988">tx</span><span class="op" id="2648990">)</span>&nbsp;<span class="op" id="2648992">==</span>&nbsp;<span class="num" id="2648995">0</span>&nbsp;<span class="op" id="2648997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649001">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649047">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649101">tx</span>&nbsp;<span class="op" id="2649104">=</span>&nbsp;<span class="builtinfunc" id="2649106">append</span><span class="op" id="2649112">(</span><span class="ident" id="2649113">tx</span><span class="op" id="2649115">,</span>&nbsp;<span class="ident" id="2649117">zoneTrans</span><span class="op" id="2649126">{</span><span class="ident" id="2649127">when</span><span class="op" id="2649131">:</span>&nbsp;<span class="ident" id="2649133">alpha</span><span class="op" id="2649138">,</span>&nbsp;<span class="ident" id="2649140">index</span><span class="op" id="2649145">:</span>&nbsp;<span class="num" id="2649147">0</span><span class="op" id="2649148">}</span><span class="op" id="2649149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649156">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649182">l</span>&nbsp;<span class="op" id="2649184">=</span>&nbsp;<span class="op" id="2649186">&amp;</span><span class="ident" id="2649187">Location</span><span class="op" id="2649195">{</span><span class="ident" id="2649196">zone</span><span class="op" id="2649200">:</span>&nbsp;<span class="ident" id="2649202">zone</span><span class="op" id="2649206">,</span>&nbsp;<span class="ident" id="2649208">tx</span><span class="op" id="2649210">:</span>&nbsp;<span class="ident" id="2649212">tx</span><span class="op" id="2649214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649218">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649274">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649321">sec</span><span class="op" id="2649324">,</span>&nbsp;<span class="ident" id="2649326">_</span>&nbsp;<span class="op" id="2649328">:=</span>&nbsp;<span class="ident" id="2649331">now</span><span class="op" id="2649334">(</span><span class="op" id="2649335">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649338">for</span>&nbsp;<span class="ident" id="2649342">i</span>&nbsp;<span class="op" id="2649344">:=</span>&nbsp;<span class="keyword" id="2649347">range</span>&nbsp;<span class="ident" id="2649353">tx</span>&nbsp;<span class="op" id="2649356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649360">if</span>&nbsp;<span class="ident" id="2649363">tx</span><span class="op" id="2649365">[</span><span class="ident" id="2649366">i</span><span class="op" id="2649367">]</span><span class="op" id="2649368">.</span><span class="ident" id="2649369">when</span>&nbsp;<span class="op" id="2649374">&lt;=</span>&nbsp;<span class="ident" id="2649377">sec</span>&nbsp;<span class="op" id="2649381">&amp;&amp;</span>&nbsp;<span class="op" id="2649384">(</span><span class="ident" id="2649385">i</span><span class="op" id="2649386">+</span><span class="num" id="2649387">1</span>&nbsp;<span class="op" id="2649389">==</span>&nbsp;<span class="builtinfunc" id="2649392">len</span><span class="op" id="2649395">(</span><span class="ident" id="2649396">tx</span><span class="op" id="2649398">)</span>&nbsp;<span class="op" id="2649400">||</span>&nbsp;<span class="ident" id="2649403">sec</span>&nbsp;<span class="op" id="2649407">&lt;</span>&nbsp;<span class="ident" id="2649409">tx</span><span class="op" id="2649411">[</span><span class="ident" id="2649412">i</span><span class="op" id="2649413">+</span><span class="num" id="2649414">1</span><span class="op" id="2649415">]</span><span class="op" id="2649416">.</span><span class="ident" id="2649417">when</span><span class="op" id="2649421">)</span>&nbsp;<span class="op" id="2649423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649428">l</span><span class="op" id="2649429">.</span><span class="ident" id="2649430">cacheStart</span>&nbsp;<span class="op" id="2649441">=</span>&nbsp;<span class="ident" id="2649443">tx</span><span class="op" id="2649445">[</span><span class="ident" id="2649446">i</span><span class="op" id="2649447">]</span><span class="op" id="2649448">.</span><span class="ident" id="2649449">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649457">l</span><span class="op" id="2649458">.</span><span class="ident" id="2649459">cacheEnd</span>&nbsp;<span class="op" id="2649468">=</span>&nbsp;<span class="ident" id="2649470">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649479">if</span>&nbsp;<span class="ident" id="2649482">i</span><span class="op" id="2649483">+</span><span class="num" id="2649484">1</span>&nbsp;<span class="op" id="2649486">&lt;</span>&nbsp;<span class="builtinfunc" id="2649488">len</span><span class="op" id="2649491">(</span><span class="ident" id="2649492">tx</span><span class="op" id="2649494">)</span>&nbsp;<span class="op" id="2649496">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649502">l</span><span class="op" id="2649503">.</span><span class="ident" id="2649504">cacheEnd</span>&nbsp;<span class="op" id="2649513">=</span>&nbsp;<span class="ident" id="2649515">tx</span><span class="op" id="2649517">[</span><span class="ident" id="2649518">i</span><span class="op" id="2649519">+</span><span class="num" id="2649520">1</span><span class="op" id="2649521">]</span><span class="op" id="2649522">.</span><span class="ident" id="2649523">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649536">l</span><span class="op" id="2649537">.</span><span class="ident" id="2649538">cacheZone</span>&nbsp;<span class="op" id="2649548">=</span>&nbsp;<span class="op" id="2649550">&amp;</span><span class="ident" id="2649551">l</span><span class="op" id="2649552">.</span><span class="ident" id="2649553">zone</span><span class="op" id="2649557">[</span><span class="ident" id="2649558">tx</span><span class="op" id="2649560">[</span><span class="ident" id="2649561">i</span><span class="op" id="2649562">]</span><span class="op" id="2649563">.</span><span class="ident" id="2649564">index</span><span class="op" id="2649569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649576">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649580">return</span>&nbsp;<span class="ident" id="2649587">l</span><span class="op" id="2649588">,</span>&nbsp;<span class="ident" id="2649590">nil</span><br>
<span class="lineno"></span><span class="op" id="2649594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2649597">func</span>&nbsp;<span class="ident" id="2649602">loadZoneFile</span><span class="op" id="2649614">(</span><span class="ident" id="2649615">dir</span><span class="op" id="2649618">,</span>&nbsp;<span class="ident" id="2649620">name</span>&nbsp;<span class="builtintype" id="2649625">string</span><span class="op" id="2649631">)</span>&nbsp;<span class="op" id="2649633">(</span><span class="ident" id="2649634">l</span>&nbsp;<span class="op" id="2649636">*</span><span class="ident" id="2649637">Location</span><span class="op" id="2649645">,</span>&nbsp;<span class="ident" id="2649647">err</span>&nbsp;<span class="builtintype" id="2649651">error</span><span class="op" id="2649656">)</span>&nbsp;<span class="op" id="2649658">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649661">if</span>&nbsp;<span class="builtinfunc" id="2649664">len</span><span class="op" id="2649667">(</span><span class="ident" id="2649668">dir</span><span class="op" id="2649671">)</span>&nbsp;<span class="op" id="2649673">&gt;</span>&nbsp;<span class="num" id="2649675">4</span>&nbsp;<span class="op" id="2649677">&amp;&amp;</span>&nbsp;<span class="ident" id="2649680">dir</span><span class="op" id="2649683">[</span><span class="builtinfunc" id="2649684">len</span><span class="op" id="2649687">(</span><span class="ident" id="2649688">dir</span><span class="op" id="2649691">)</span><span class="op" id="2649692">-</span><span class="num" id="2649693">4</span><span class="op" id="2649694">:</span><span class="op" id="2649695">]</span>&nbsp;<span class="op" id="2649697">==</span>&nbsp;<span class="string" id="2649700">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2649707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649711">return</span>&nbsp;<span class="ident" id="2649718">loadZoneZip</span><span class="op" id="2649729">(</span><span class="ident" id="2649730">dir</span><span class="op" id="2649733">,</span>&nbsp;<span class="ident" id="2649735">name</span><span class="op" id="2649739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649745">if</span>&nbsp;<span class="ident" id="2649748">dir</span>&nbsp;<span class="op" id="2649752">!=</span>&nbsp;<span class="string" id="2649755">&#34;&#34;</span>&nbsp;<span class="op" id="2649758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649762">name</span>&nbsp;<span class="op" id="2649767">=</span>&nbsp;<span class="ident" id="2649769">dir</span>&nbsp;<span class="op" id="2649773">+</span>&nbsp;<span class="string" id="2649775">&#34;/&#34;</span>&nbsp;<span class="op" id="2649779">+</span>&nbsp;<span class="ident" id="2649781">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649790">buf</span><span class="op" id="2649793">,</span>&nbsp;<span class="ident" id="2649795">err</span>&nbsp;<span class="op" id="2649799">:=</span>&nbsp;<span class="ident" id="2649802">readFile</span><span class="op" id="2649810">(</span><span class="ident" id="2649811">name</span><span class="op" id="2649815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649818">if</span>&nbsp;<span class="ident" id="2649821">err</span>&nbsp;<span class="op" id="2649825">!=</span>&nbsp;<span class="ident" id="2649828">nil</span>&nbsp;<span class="op" id="2649832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649836">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649844">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649847">return</span>&nbsp;<span class="ident" id="2649854">loadZoneData</span><span class="op" id="2649866">(</span><span class="ident" id="2649867">buf</span><span class="op" id="2649870">)</span><br>
<span class="lineno"></span><span class="op" id="2649872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649875">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2649942">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2650001">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2650069">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2650138">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2650203">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2650272">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2650333">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2650386">func</span>&nbsp;<span class="ident" id="2650391">get4</span><span class="op" id="2650395">(</span><span class="ident" id="2650396">b</span>&nbsp;<span class="op" id="2650398">[</span><span class="op" id="2650399">]</span><span class="builtintype" id="2650400">byte</span><span class="op" id="2650404">)</span>&nbsp;<span class="builtintype" id="2650406">int</span>&nbsp;<span class="op" id="2650410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650413">if</span>&nbsp;<span class="builtinfunc" id="2650416">len</span><span class="op" id="2650419">(</span><span class="ident" id="2650420">b</span><span class="op" id="2650421">)</span>&nbsp;<span class="op" id="2650423">&lt;</span>&nbsp;<span class="num" id="2650425">4</span>&nbsp;<span class="op" id="2650427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650431">return</span>&nbsp;<span class="num" id="2650438">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650444">return</span>&nbsp;<span class="builtintype" id="2650451">int</span><span class="op" id="2650454">(</span><span class="ident" id="2650455">b</span><span class="op" id="2650456">[</span><span class="num" id="2650457">0</span><span class="op" id="2650458">]</span><span class="op" id="2650459">)</span>&nbsp;<span class="op" id="2650461">|</span>&nbsp;<span class="builtintype" id="2650463">int</span><span class="op" id="2650466">(</span><span class="ident" id="2650467">b</span><span class="op" id="2650468">[</span><span class="num" id="2650469">1</span><span class="op" id="2650470">]</span><span class="op" id="2650471">)</span><span class="op" id="2650472">&lt;&lt;</span><span class="num" id="2650474">8</span>&nbsp;<span class="op" id="2650476">|</span>&nbsp;<span class="builtintype" id="2650478">int</span><span class="op" id="2650481">(</span><span class="ident" id="2650482">b</span><span class="op" id="2650483">[</span><span class="num" id="2650484">2</span><span class="op" id="2650485">]</span><span class="op" id="2650486">)</span><span class="op" id="2650487">&lt;&lt;</span><span class="num" id="2650489">16</span>&nbsp;<span class="op" id="2650492">|</span>&nbsp;<span class="builtintype" id="2650494">int</span><span class="op" id="2650497">(</span><span class="ident" id="2650498">b</span><span class="op" id="2650499">[</span><span class="num" id="2650500">3</span><span class="op" id="2650501">]</span><span class="op" id="2650502">)</span><span class="op" id="2650503">&lt;&lt;</span><span class="num" id="2650505">24</span><br>
<span class="lineno"></span><span class="op" id="2650508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2650511">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2650564">func</span>&nbsp;<span class="ident" id="2650569">get2</span><span class="op" id="2650573">(</span><span class="ident" id="2650574">b</span>&nbsp;<span class="op" id="2650576">[</span><span class="op" id="2650577">]</span><span class="builtintype" id="2650578">byte</span><span class="op" id="2650582">)</span>&nbsp;<span class="builtintype" id="2650584">int</span>&nbsp;<span class="op" id="2650588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650591">if</span>&nbsp;<span class="builtinfunc" id="2650594">len</span><span class="op" id="2650597">(</span><span class="ident" id="2650598">b</span><span class="op" id="2650599">)</span>&nbsp;<span class="op" id="2650601">&lt;</span>&nbsp;<span class="num" id="2650603">2</span>&nbsp;<span class="op" id="2650605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650609">return</span>&nbsp;<span class="num" id="2650616">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650622">return</span>&nbsp;<span class="builtintype" id="2650629">int</span><span class="op" id="2650632">(</span><span class="ident" id="2650633">b</span><span class="op" id="2650634">[</span><span class="num" id="2650635">0</span><span class="op" id="2650636">]</span><span class="op" id="2650637">)</span>&nbsp;<span class="op" id="2650639">|</span>&nbsp;<span class="builtintype" id="2650641">int</span><span class="op" id="2650644">(</span><span class="ident" id="2650645">b</span><span class="op" id="2650646">[</span><span class="num" id="2650647">1</span><span class="op" id="2650648">]</span><span class="op" id="2650649">)</span><span class="op" id="2650650">&lt;&lt;</span><span class="num" id="2650652">8</span><br>
<span class="lineno">235</span><span class="op" id="2650654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2650657">func</span>&nbsp;<span class="ident" id="2650662">loadZoneZip</span><span class="op" id="2650673">(</span><span class="ident" id="2650674">zipfile</span><span class="op" id="2650681">,</span>&nbsp;<span class="ident" id="2650683">name</span>&nbsp;<span class="builtintype" id="2650688">string</span><span class="op" id="2650694">)</span>&nbsp;<span class="op" id="2650696">(</span><span class="ident" id="2650697">l</span>&nbsp;<span class="op" id="2650699">*</span><span class="ident" id="2650700">Location</span><span class="op" id="2650708">,</span>&nbsp;<span class="ident" id="2650710">err</span>&nbsp;<span class="builtintype" id="2650714">error</span><span class="op" id="2650719">)</span>&nbsp;<span class="op" id="2650721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650724">fd</span><span class="op" id="2650726">,</span>&nbsp;<span class="ident" id="2650728">err</span>&nbsp;<span class="op" id="2650732">:=</span>&nbsp;<span class="ident" id="2650735">open</span><span class="op" id="2650739">(</span><span class="ident" id="2650740">zipfile</span><span class="op" id="2650747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650750">if</span>&nbsp;<span class="ident" id="2650753">err</span>&nbsp;<span class="op" id="2650757">!=</span>&nbsp;<span class="ident" id="2650760">nil</span>&nbsp;<span class="op" id="2650764">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650768">return</span>&nbsp;<span class="ident" id="2650775">nil</span><span class="op" id="2650778">,</span>&nbsp;<span class="ident" id="2650780">errors</span><span class="op" id="2650786">.</span><span class="ident" id="2650787">New</span><span class="op" id="2650790">(</span><span class="string" id="2650791">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2650799">+</span>&nbsp;<span class="ident" id="2650801">zipfile</span>&nbsp;<span class="op" id="2650809">+</span>&nbsp;<span class="string" id="2650811">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2650816">+</span>&nbsp;<span class="ident" id="2650818">err</span><span class="op" id="2650821">.</span><span class="ident" id="2650822">Error</span><span class="op" id="2650827">(</span><span class="op" id="2650828">)</span><span class="op" id="2650829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650835">defer</span>&nbsp;<span class="ident" id="2650841">closefd</span><span class="op" id="2650848">(</span><span class="ident" id="2650849">fd</span><span class="op" id="2650851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650855">const</span>&nbsp;<span class="op" id="2650861">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650865">zecheader</span>&nbsp;<span class="op" id="2650875">=</span>&nbsp;<span class="num" id="2650877">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650890">zcheader</span>&nbsp;&nbsp;<span class="op" id="2650900">=</span>&nbsp;<span class="num" id="2650902">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650915">ztailsize</span>&nbsp;<span class="op" id="2650925">=</span>&nbsp;<span class="num" id="2650927">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650933">zheadersize</span>&nbsp;<span class="op" id="2650945">=</span>&nbsp;<span class="num" id="2650947">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650952">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650964">=</span>&nbsp;<span class="num" id="2650966">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650978">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650982">buf</span>&nbsp;<span class="op" id="2650986">:=</span>&nbsp;<span class="builtinfunc" id="2650989">make</span><span class="op" id="2650993">(</span><span class="op" id="2650994">[</span><span class="op" id="2650995">]</span><span class="builtintype" id="2650996">byte</span><span class="op" id="2651000">,</span>&nbsp;<span class="ident" id="2651002">ztailsize</span><span class="op" id="2651011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651014">if</span>&nbsp;<span class="ident" id="2651017">err</span>&nbsp;<span class="op" id="2651021">:=</span>&nbsp;<span class="ident" id="2651024">preadn</span><span class="op" id="2651030">(</span><span class="ident" id="2651031">fd</span><span class="op" id="2651033">,</span>&nbsp;<span class="ident" id="2651035">buf</span><span class="op" id="2651038">,</span>&nbsp;<span class="op" id="2651040">-</span><span class="ident" id="2651041">ztailsize</span><span class="op" id="2651050">)</span><span class="op" id="2651051">;</span>&nbsp;<span class="ident" id="2651053">err</span>&nbsp;<span class="op" id="2651057">!=</span>&nbsp;<span class="ident" id="2651060">nil</span>&nbsp;<span class="op" id="2651064">||</span>&nbsp;<span class="ident" id="2651067">get4</span><span class="op" id="2651071">(</span><span class="ident" id="2651072">buf</span><span class="op" id="2651075">)</span>&nbsp;<span class="op" id="2651077">!=</span>&nbsp;<span class="ident" id="2651080">zecheader</span>&nbsp;<span class="op" id="2651090">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651094">return</span>&nbsp;<span class="ident" id="2651101">nil</span><span class="op" id="2651104">,</span>&nbsp;<span class="ident" id="2651106">errors</span><span class="op" id="2651112">.</span><span class="ident" id="2651113">New</span><span class="op" id="2651116">(</span><span class="string" id="2651117">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2651137">+</span>&nbsp;<span class="ident" id="2651139">zipfile</span><span class="op" id="2651146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651152">n</span>&nbsp;<span class="op" id="2651154">:=</span>&nbsp;<span class="ident" id="2651157">get2</span><span class="op" id="2651161">(</span><span class="ident" id="2651162">buf</span><span class="op" id="2651165">[</span><span class="num" id="2651166">10</span><span class="op" id="2651168">:</span><span class="op" id="2651169">]</span><span class="op" id="2651170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651173">size</span>&nbsp;<span class="op" id="2651178">:=</span>&nbsp;<span class="ident" id="2651181">get4</span><span class="op" id="2651185">(</span><span class="ident" id="2651186">buf</span><span class="op" id="2651189">[</span><span class="num" id="2651190">12</span><span class="op" id="2651192">:</span><span class="op" id="2651193">]</span><span class="op" id="2651194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651197">off</span>&nbsp;<span class="op" id="2651201">:=</span>&nbsp;<span class="ident" id="2651204">get4</span><span class="op" id="2651208">(</span><span class="ident" id="2651209">buf</span><span class="op" id="2651212">[</span><span class="num" id="2651213">16</span><span class="op" id="2651215">:</span><span class="op" id="2651216">]</span><span class="op" id="2651217">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651221">buf</span>&nbsp;<span class="op" id="2651225">=</span>&nbsp;<span class="builtinfunc" id="2651227">make</span><span class="op" id="2651231">(</span><span class="op" id="2651232">[</span><span class="op" id="2651233">]</span><span class="builtintype" id="2651234">byte</span><span class="op" id="2651238">,</span>&nbsp;<span class="ident" id="2651240">size</span><span class="op" id="2651244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651247">if</span>&nbsp;<span class="ident" id="2651250">err</span>&nbsp;<span class="op" id="2651254">:=</span>&nbsp;<span class="ident" id="2651257">preadn</span><span class="op" id="2651263">(</span><span class="ident" id="2651264">fd</span><span class="op" id="2651266">,</span>&nbsp;<span class="ident" id="2651268">buf</span><span class="op" id="2651271">,</span>&nbsp;<span class="ident" id="2651273">off</span><span class="op" id="2651276">)</span><span class="op" id="2651277">;</span>&nbsp;<span class="ident" id="2651279">err</span>&nbsp;<span class="op" id="2651283">!=</span>&nbsp;<span class="ident" id="2651286">nil</span>&nbsp;<span class="op" id="2651290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651294">return</span>&nbsp;<span class="ident" id="2651301">nil</span><span class="op" id="2651304">,</span>&nbsp;<span class="ident" id="2651306">errors</span><span class="op" id="2651312">.</span><span class="ident" id="2651313">New</span><span class="op" id="2651316">(</span><span class="string" id="2651317">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2651337">+</span>&nbsp;<span class="ident" id="2651339">zipfile</span><span class="op" id="2651346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651349">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651353">for</span>&nbsp;<span class="ident" id="2651357">i</span>&nbsp;<span class="op" id="2651359">:=</span>&nbsp;<span class="num" id="2651362">0</span><span class="op" id="2651363">;</span>&nbsp;<span class="ident" id="2651365">i</span>&nbsp;<span class="op" id="2651367">&lt;</span>&nbsp;<span class="ident" id="2651369">n</span><span class="op" id="2651370">;</span>&nbsp;<span class="ident" id="2651372">i</span><span class="op" id="2651373">++</span>&nbsp;<span class="op" id="2651376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651380">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651403">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651419">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651438">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651455">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651473">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651489">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651505">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651521">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651540">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651559">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651574">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651591">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651610">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651629">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651645">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651662">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651681">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651698">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651715">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651730">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651752">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651793">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651798">if</span>&nbsp;<span class="ident" id="2651801">get4</span><span class="op" id="2651805">(</span><span class="ident" id="2651806">buf</span><span class="op" id="2651809">)</span>&nbsp;<span class="op" id="2651811">!=</span>&nbsp;<span class="ident" id="2651814">zcheader</span>&nbsp;<span class="op" id="2651823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651840">meth</span>&nbsp;<span class="op" id="2651845">:=</span>&nbsp;<span class="ident" id="2651848">get2</span><span class="op" id="2651852">(</span><span class="ident" id="2651853">buf</span><span class="op" id="2651856">[</span><span class="num" id="2651857">10</span><span class="op" id="2651859">:</span><span class="op" id="2651860">]</span><span class="op" id="2651861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651865">size</span>&nbsp;<span class="op" id="2651870">:=</span>&nbsp;<span class="ident" id="2651873">get4</span><span class="op" id="2651877">(</span><span class="ident" id="2651878">buf</span><span class="op" id="2651881">[</span><span class="num" id="2651882">24</span><span class="op" id="2651884">:</span><span class="op" id="2651885">]</span><span class="op" id="2651886">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651890">namelen</span>&nbsp;<span class="op" id="2651898">:=</span>&nbsp;<span class="ident" id="2651901">get2</span><span class="op" id="2651905">(</span><span class="ident" id="2651906">buf</span><span class="op" id="2651909">[</span><span class="num" id="2651910">28</span><span class="op" id="2651912">:</span><span class="op" id="2651913">]</span><span class="op" id="2651914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651918">xlen</span>&nbsp;<span class="op" id="2651923">:=</span>&nbsp;<span class="ident" id="2651926">get2</span><span class="op" id="2651930">(</span><span class="ident" id="2651931">buf</span><span class="op" id="2651934">[</span><span class="num" id="2651935">30</span><span class="op" id="2651937">:</span><span class="op" id="2651938">]</span><span class="op" id="2651939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651943">fclen</span>&nbsp;<span class="op" id="2651949">:=</span>&nbsp;<span class="ident" id="2651952">get2</span><span class="op" id="2651956">(</span><span class="ident" id="2651957">buf</span><span class="op" id="2651960">[</span><span class="num" id="2651961">32</span><span class="op" id="2651963">:</span><span class="op" id="2651964">]</span><span class="op" id="2651965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651969">off</span>&nbsp;<span class="op" id="2651973">:=</span>&nbsp;<span class="ident" id="2651976">get4</span><span class="op" id="2651980">(</span><span class="ident" id="2651981">buf</span><span class="op" id="2651984">[</span><span class="num" id="2651985">42</span><span class="op" id="2651987">:</span><span class="op" id="2651988">]</span><span class="op" id="2651989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651993">zname</span>&nbsp;<span class="op" id="2651999">:=</span>&nbsp;<span class="ident" id="2652002">buf</span><span class="op" id="2652005">[</span><span class="num" id="2652006">46</span>&nbsp;<span class="op" id="2652009">:</span>&nbsp;<span class="num" id="2652011">46</span><span class="op" id="2652013">+</span><span class="ident" id="2652014">namelen</span><span class="op" id="2652021">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652025">buf</span>&nbsp;<span class="op" id="2652029">=</span>&nbsp;<span class="ident" id="2652031">buf</span><span class="op" id="2652034">[</span><span class="num" id="2652035">46</span><span class="op" id="2652037">+</span><span class="ident" id="2652038">namelen</span><span class="op" id="2652045">+</span><span class="ident" id="2652046">xlen</span><span class="op" id="2652050">+</span><span class="ident" id="2652051">fclen</span><span class="op" id="2652056">:</span><span class="op" id="2652057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652061">if</span>&nbsp;<span class="builtintype" id="2652064">string</span><span class="op" id="2652070">(</span><span class="ident" id="2652071">zname</span><span class="op" id="2652076">)</span>&nbsp;<span class="op" id="2652078">!=</span>&nbsp;<span class="ident" id="2652081">name</span>&nbsp;<span class="op" id="2652086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652091">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652106">if</span>&nbsp;<span class="ident" id="2652109">meth</span>&nbsp;<span class="op" id="2652114">!=</span>&nbsp;<span class="num" id="2652117">0</span>&nbsp;<span class="op" id="2652119">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652124">return</span>&nbsp;<span class="ident" id="2652131">nil</span><span class="op" id="2652134">,</span>&nbsp;<span class="ident" id="2652136">errors</span><span class="op" id="2652142">.</span><span class="ident" id="2652143">New</span><span class="op" id="2652146">(</span><span class="string" id="2652147">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2652178">+</span>&nbsp;<span class="ident" id="2652180">name</span>&nbsp;<span class="op" id="2652185">+</span>&nbsp;<span class="string" id="2652187">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2652194">+</span>&nbsp;<span class="ident" id="2652196">zipfile</span><span class="op" id="2652203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652212">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652245">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652261">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652279">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652295">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652311">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652326">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652345">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652364">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652379">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652396">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652415">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652434">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652450">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652472">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2652505">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652510">buf</span>&nbsp;<span class="op" id="2652514">=</span>&nbsp;<span class="builtinfunc" id="2652516">make</span><span class="op" id="2652520">(</span><span class="op" id="2652521">[</span><span class="op" id="2652522">]</span><span class="builtintype" id="2652523">byte</span><span class="op" id="2652527">,</span>&nbsp;<span class="ident" id="2652529">zheadersize</span><span class="op" id="2652540">+</span><span class="ident" id="2652541">namelen</span><span class="op" id="2652548">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652552">if</span>&nbsp;<span class="ident" id="2652555">err</span>&nbsp;<span class="op" id="2652559">:=</span>&nbsp;<span class="ident" id="2652562">preadn</span><span class="op" id="2652568">(</span><span class="ident" id="2652569">fd</span><span class="op" id="2652571">,</span>&nbsp;<span class="ident" id="2652573">buf</span><span class="op" id="2652576">,</span>&nbsp;<span class="ident" id="2652578">off</span><span class="op" id="2652581">)</span><span class="op" id="2652582">;</span>&nbsp;<span class="ident" id="2652584">err</span>&nbsp;<span class="op" id="2652588">!=</span>&nbsp;<span class="ident" id="2652591">nil</span>&nbsp;<span class="op" id="2652595">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652601">get4</span><span class="op" id="2652605">(</span><span class="ident" id="2652606">buf</span><span class="op" id="2652609">)</span>&nbsp;<span class="op" id="2652611">!=</span>&nbsp;<span class="ident" id="2652614">zheader</span>&nbsp;<span class="op" id="2652622">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652628">get2</span><span class="op" id="2652632">(</span><span class="ident" id="2652633">buf</span><span class="op" id="2652636">[</span><span class="num" id="2652637">8</span><span class="op" id="2652638">:</span><span class="op" id="2652639">]</span><span class="op" id="2652640">)</span>&nbsp;<span class="op" id="2652642">!=</span>&nbsp;<span class="ident" id="2652645">meth</span>&nbsp;<span class="op" id="2652650">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652656">get2</span><span class="op" id="2652660">(</span><span class="ident" id="2652661">buf</span><span class="op" id="2652664">[</span><span class="num" id="2652665">26</span><span class="op" id="2652667">:</span><span class="op" id="2652668">]</span><span class="op" id="2652669">)</span>&nbsp;<span class="op" id="2652671">!=</span>&nbsp;<span class="ident" id="2652674">namelen</span>&nbsp;<span class="op" id="2652682">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2652688">string</span><span class="op" id="2652694">(</span><span class="ident" id="2652695">buf</span><span class="op" id="2652698">[</span><span class="num" id="2652699">30</span><span class="op" id="2652701">:</span><span class="num" id="2652702">30</span><span class="op" id="2652704">+</span><span class="ident" id="2652705">namelen</span><span class="op" id="2652712">]</span><span class="op" id="2652713">)</span>&nbsp;<span class="op" id="2652715">!=</span>&nbsp;<span class="ident" id="2652718">name</span>&nbsp;<span class="op" id="2652723">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652728">return</span>&nbsp;<span class="ident" id="2652735">nil</span><span class="op" id="2652738">,</span>&nbsp;<span class="ident" id="2652740">errors</span><span class="op" id="2652746">.</span><span class="ident" id="2652747">New</span><span class="op" id="2652750">(</span><span class="string" id="2652751">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2652771">+</span>&nbsp;<span class="ident" id="2652773">zipfile</span><span class="op" id="2652780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652788">xlen</span>&nbsp;<span class="op" id="2652793">=</span>&nbsp;<span class="ident" id="2652795">get2</span><span class="op" id="2652799">(</span><span class="ident" id="2652800">buf</span><span class="op" id="2652803">[</span><span class="num" id="2652804">28</span><span class="op" id="2652806">:</span><span class="op" id="2652807">]</span><span class="op" id="2652808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652813">buf</span>&nbsp;<span class="op" id="2652817">=</span>&nbsp;<span class="builtinfunc" id="2652819">make</span><span class="op" id="2652823">(</span><span class="op" id="2652824">[</span><span class="op" id="2652825">]</span><span class="builtintype" id="2652826">byte</span><span class="op" id="2652830">,</span>&nbsp;<span class="ident" id="2652832">size</span><span class="op" id="2652836">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652840">if</span>&nbsp;<span class="ident" id="2652843">err</span>&nbsp;<span class="op" id="2652847">:=</span>&nbsp;<span class="ident" id="2652850">preadn</span><span class="op" id="2652856">(</span><span class="ident" id="2652857">fd</span><span class="op" id="2652859">,</span>&nbsp;<span class="ident" id="2652861">buf</span><span class="op" id="2652864">,</span>&nbsp;<span class="ident" id="2652866">off</span><span class="op" id="2652869">+</span><span class="num" id="2652870">30</span><span class="op" id="2652872">+</span><span class="ident" id="2652873">namelen</span><span class="op" id="2652880">+</span><span class="ident" id="2652881">xlen</span><span class="op" id="2652885">)</span><span class="op" id="2652886">;</span>&nbsp;<span class="ident" id="2652888">err</span>&nbsp;<span class="op" id="2652892">!=</span>&nbsp;<span class="ident" id="2652895">nil</span>&nbsp;<span class="op" id="2652899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652904">return</span>&nbsp;<span class="ident" id="2652911">nil</span><span class="op" id="2652914">,</span>&nbsp;<span class="ident" id="2652916">errors</span><span class="op" id="2652922">.</span><span class="ident" id="2652923">New</span><span class="op" id="2652926">(</span><span class="string" id="2652927">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2652947">+</span>&nbsp;<span class="ident" id="2652949">zipfile</span><span class="op" id="2652956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652965">return</span>&nbsp;<span class="ident" id="2652972">loadZoneData</span><span class="op" id="2652984">(</span><span class="ident" id="2652985">buf</span><span class="op" id="2652988">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652995">return</span>&nbsp;<span class="ident" id="2653002">nil</span><span class="op" id="2653005">,</span>&nbsp;<span class="ident" id="2653007">errors</span><span class="op" id="2653013">.</span><span class="ident" id="2653014">New</span><span class="op" id="2653017">(</span><span class="string" id="2653018">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2653033">+</span>&nbsp;<span class="ident" id="2653035">name</span>&nbsp;<span class="op" id="2653040">+</span>&nbsp;<span class="string" id="2653042">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2653058">+</span>&nbsp;<span class="ident" id="2653060">zipfile</span><span class="op" id="2653067">)</span><br>
<span class="lineno"></span><span class="op" id="2653069">}</span>
</div>
</body>
</html>
