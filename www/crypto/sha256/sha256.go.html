<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4276145">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4276200">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4276254">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4276305">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4276383">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4276401">package</span>&nbsp;<span class="ident" id="4276409">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276417">import</span>&nbsp;<span class="op" id="4276424">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4276427">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4276437">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4276444">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276447">func</span>&nbsp;<span class="ident" id="4276452">init</span><span class="op" id="4276456">(</span><span class="op" id="4276457">)</span>&nbsp;<span class="op" id="4276459">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276462"><a href="/crypto/sha256/sha256.go.html#4276427">crypto</a></span><span class="op" id="4276468">.</span><span class="ident" id="4276469">RegisterHash</span><span class="op" id="4276481">(</span><span class="ident" id="4276482"><a href="/crypto/sha256/sha256.go.html#4276427">crypto</a></span><span class="op" id="4276488">.</span><span class="ident" id="4276489">SHA224</span><span class="op" id="4276495">,</span>&nbsp;<span class="ident" id="4276497"><a href="/crypto/sha256/sha256.go.html#4277923">New224</a></span><span class="op" id="4276503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276506"><a href="/crypto/sha256/sha256.go.html#4276427">crypto</a></span><span class="op" id="4276512">.</span><span class="ident" id="4276513">RegisterHash</span><span class="op" id="4276525">(</span><span class="ident" id="4276526"><a href="/crypto/sha256/sha256.go.html#4276427">crypto</a></span><span class="op" id="4276532">.</span><span class="ident" id="4276533">SHA256</span><span class="op" id="4276539">,</span>&nbsp;<span class="ident" id="4276541"><a href="/crypto/sha256/sha256.go.html#4277793">New</a></span><span class="op" id="4276544">)</span><br>
<span class="lineno"></span><span class="op" id="4276546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276549">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4276592">const</span>&nbsp;<span class="ident" id="4276598">Size</span>&nbsp;<span class="op" id="4276603">=</span>&nbsp;<span class="num" id="4276605">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276609">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4276652">const</span>&nbsp;<span class="ident" id="4276658">Size224</span>&nbsp;<span class="op" id="4276666">=</span>&nbsp;<span class="num" id="4276668">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4276672">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4276720">const</span>&nbsp;<span class="ident" id="4276726">BlockSize</span>&nbsp;<span class="op" id="4276736">=</span>&nbsp;<span class="num" id="4276738">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276742">const</span>&nbsp;<span class="op" id="4276748">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276751">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276761">=</span>&nbsp;<span class="num" id="4276763">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276767">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276777">=</span>&nbsp;<span class="num" id="4276779">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276791">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276801">=</span>&nbsp;<span class="num" id="4276803">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276815">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276825">=</span>&nbsp;<span class="num" id="4276827">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276839">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276849">=</span>&nbsp;<span class="num" id="4276851">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276863">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276873">=</span>&nbsp;<span class="num" id="4276875">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276887">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276897">=</span>&nbsp;<span class="num" id="4276899">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276911">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276921">=</span>&nbsp;<span class="num" id="4276923">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276935">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276945">=</span>&nbsp;<span class="num" id="4276947">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276959">init0_224</span>&nbsp;<span class="op" id="4276969">=</span>&nbsp;<span class="num" id="4276971">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276983">init1_224</span>&nbsp;<span class="op" id="4276993">=</span>&nbsp;<span class="num" id="4276995">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277007">init2_224</span>&nbsp;<span class="op" id="4277017">=</span>&nbsp;<span class="num" id="4277019">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277031">init3_224</span>&nbsp;<span class="op" id="4277041">=</span>&nbsp;<span class="num" id="4277043">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277055">init4_224</span>&nbsp;<span class="op" id="4277065">=</span>&nbsp;<span class="num" id="4277067">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277079">init5_224</span>&nbsp;<span class="op" id="4277089">=</span>&nbsp;<span class="num" id="4277091">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277103">init6_224</span>&nbsp;<span class="op" id="4277113">=</span>&nbsp;<span class="num" id="4277115">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277127">init7_224</span>&nbsp;<span class="op" id="4277137">=</span>&nbsp;<span class="num" id="4277139">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4277150">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4277153">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4277212">type</span>&nbsp;<span class="ident" id="4277217">digest</span>&nbsp;<span class="keyword" id="4277224">struct</span>&nbsp;<span class="op" id="4277231">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277234">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4277240">[</span><span class="num" id="4277241">8</span><span class="op" id="4277242">]</span><span class="builtintype" id="4277243">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277251">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4277257">[</span><span class="ident" id="4277258"><a href="/crypto/sha256/sha256.go.html#4276751">chunk</a></span><span class="op" id="4277263">]</span><span class="builtintype" id="4277264">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277270">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4277276">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4277281">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4277287">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277295">is224</span>&nbsp;<span class="builtintype" id="4277301">bool</span>&nbsp;<span class="comment" id="4277306">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4277340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4277343">func</span>&nbsp;<span class="op" id="4277348">(</span><span class="ident" id="4277349">d</span>&nbsp;<span class="op" id="4277351">*</span><span class="ident" id="4277352"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4277358">)</span>&nbsp;<span class="ident" id="4277360">Reset</span><span class="op" id="4277365">(</span><span class="op" id="4277366">)</span>&nbsp;<span class="op" id="4277368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277371">if</span>&nbsp;<span class="op" id="4277374">!</span><span class="ident" id="4277375"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277376">.</span><span class="ident" id="4277377">is224</span>&nbsp;<span class="op" id="4277383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277387"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277388">.</span><span class="ident" id="4277389">h</span><span class="op" id="4277390">[</span><span class="num" id="4277391">0</span><span class="op" id="4277392">]</span>&nbsp;<span class="op" id="4277394">=</span>&nbsp;<span class="ident" id="4277396"><a href="/crypto/sha256/sha256.go.html#4276767">init0</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277404"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277405">.</span><span class="ident" id="4277406">h</span><span class="op" id="4277407">[</span><span class="num" id="4277408">1</span><span class="op" id="4277409">]</span>&nbsp;<span class="op" id="4277411">=</span>&nbsp;<span class="ident" id="4277413"><a href="/crypto/sha256/sha256.go.html#4276791">init1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277421"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277422">.</span><span class="ident" id="4277423">h</span><span class="op" id="4277424">[</span><span class="num" id="4277425">2</span><span class="op" id="4277426">]</span>&nbsp;<span class="op" id="4277428">=</span>&nbsp;<span class="ident" id="4277430"><a href="/crypto/sha256/sha256.go.html#4276815">init2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277438"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277439">.</span><span class="ident" id="4277440">h</span><span class="op" id="4277441">[</span><span class="num" id="4277442">3</span><span class="op" id="4277443">]</span>&nbsp;<span class="op" id="4277445">=</span>&nbsp;<span class="ident" id="4277447"><a href="/crypto/sha256/sha256.go.html#4276839">init3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277455"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277456">.</span><span class="ident" id="4277457">h</span><span class="op" id="4277458">[</span><span class="num" id="4277459">4</span><span class="op" id="4277460">]</span>&nbsp;<span class="op" id="4277462">=</span>&nbsp;<span class="ident" id="4277464"><a href="/crypto/sha256/sha256.go.html#4276863">init4</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277472"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277473">.</span><span class="ident" id="4277474">h</span><span class="op" id="4277475">[</span><span class="num" id="4277476">5</span><span class="op" id="4277477">]</span>&nbsp;<span class="op" id="4277479">=</span>&nbsp;<span class="ident" id="4277481"><a href="/crypto/sha256/sha256.go.html#4276887">init5</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277489"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277490">.</span><span class="ident" id="4277491">h</span><span class="op" id="4277492">[</span><span class="num" id="4277493">6</span><span class="op" id="4277494">]</span>&nbsp;<span class="op" id="4277496">=</span>&nbsp;<span class="ident" id="4277498"><a href="/crypto/sha256/sha256.go.html#4276911">init6</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277506"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277507">.</span><span class="ident" id="4277508">h</span><span class="op" id="4277509">[</span><span class="num" id="4277510">7</span><span class="op" id="4277511">]</span>&nbsp;<span class="op" id="4277513">=</span>&nbsp;<span class="ident" id="4277515"><a href="/crypto/sha256/sha256.go.html#4276935">init7</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277522">}</span>&nbsp;<span class="keyword" id="4277524">else</span>&nbsp;<span class="op" id="4277529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277533"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277534">.</span><span class="ident" id="4277535">h</span><span class="op" id="4277536">[</span><span class="num" id="4277537">0</span><span class="op" id="4277538">]</span>&nbsp;<span class="op" id="4277540">=</span>&nbsp;<span class="ident" id="4277542"><a href="/crypto/sha256/sha256.go.html#4276959">init0_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277554"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277555">.</span><span class="ident" id="4277556">h</span><span class="op" id="4277557">[</span><span class="num" id="4277558">1</span><span class="op" id="4277559">]</span>&nbsp;<span class="op" id="4277561">=</span>&nbsp;<span class="ident" id="4277563"><a href="/crypto/sha256/sha256.go.html#4276983">init1_224</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277575"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277576">.</span><span class="ident" id="4277577">h</span><span class="op" id="4277578">[</span><span class="num" id="4277579">2</span><span class="op" id="4277580">]</span>&nbsp;<span class="op" id="4277582">=</span>&nbsp;<span class="ident" id="4277584"><a href="/crypto/sha256/sha256.go.html#4277007">init2_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277596"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277597">.</span><span class="ident" id="4277598">h</span><span class="op" id="4277599">[</span><span class="num" id="4277600">3</span><span class="op" id="4277601">]</span>&nbsp;<span class="op" id="4277603">=</span>&nbsp;<span class="ident" id="4277605"><a href="/crypto/sha256/sha256.go.html#4277031">init3_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277617"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277618">.</span><span class="ident" id="4277619">h</span><span class="op" id="4277620">[</span><span class="num" id="4277621">4</span><span class="op" id="4277622">]</span>&nbsp;<span class="op" id="4277624">=</span>&nbsp;<span class="ident" id="4277626"><a href="/crypto/sha256/sha256.go.html#4277055">init4_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277638"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277639">.</span><span class="ident" id="4277640">h</span><span class="op" id="4277641">[</span><span class="num" id="4277642">5</span><span class="op" id="4277643">]</span>&nbsp;<span class="op" id="4277645">=</span>&nbsp;<span class="ident" id="4277647"><a href="/crypto/sha256/sha256.go.html#4277079">init5_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277659"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277660">.</span><span class="ident" id="4277661">h</span><span class="op" id="4277662">[</span><span class="num" id="4277663">6</span><span class="op" id="4277664">]</span>&nbsp;<span class="op" id="4277666">=</span>&nbsp;<span class="ident" id="4277668"><a href="/crypto/sha256/sha256.go.html#4277103">init6_224</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277680"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277681">.</span><span class="ident" id="4277682">h</span><span class="op" id="4277683">[</span><span class="num" id="4277684">7</span><span class="op" id="4277685">]</span>&nbsp;<span class="op" id="4277687">=</span>&nbsp;<span class="ident" id="4277689"><a href="/crypto/sha256/sha256.go.html#4277127">init7_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277703"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277704">.</span><span class="ident" id="4277705">nx</span>&nbsp;<span class="op" id="4277708">=</span>&nbsp;<span class="num" id="4277710">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277713"><a href="/crypto/sha256/sha256.go.html#4277349">d</a></span><span class="op" id="4277714">.</span><span class="builtinfunc" id="4277715">len</span>&nbsp;<span class="op" id="4277719">=</span>&nbsp;<span class="num" id="4277721">0</span><br>
<span class="lineno"></span><span class="op" id="4277723">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4277726">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4277788">func</span>&nbsp;<span class="ident" id="4277793">New</span><span class="op" id="4277796">(</span><span class="op" id="4277797">)</span>&nbsp;<span class="ident" id="4277799"><a href="/crypto/sha256/sha256.go.html#4276437">hash</a></span><span class="op" id="4277803">.</span><span class="ident" id="4277804">Hash</span>&nbsp;<span class="op" id="4277809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277812">d</span>&nbsp;<span class="op" id="4277814">:=</span>&nbsp;<span class="builtinfunc" id="4277817">new</span><span class="op" id="4277820">(</span><span class="ident" id="4277821"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4277827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277830"><a href="/crypto/sha256/sha256.go.html#4277812">d</a></span><span class="op" id="4277831">.</span><span class="ident" id="4277832">Reset</span><span class="op" id="4277837">(</span><span class="op" id="4277838">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277841">return</span>&nbsp;<span class="ident" id="4277848"><a href="/crypto/sha256/sha256.go.html#4277812">d</a></span><br>
<span class="lineno"></span><span class="op" id="4277850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4277853">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4277918">func</span>&nbsp;<span class="ident" id="4277923">New224</span><span class="op" id="4277929">(</span><span class="op" id="4277930">)</span>&nbsp;<span class="ident" id="4277932"><a href="/crypto/sha256/sha256.go.html#4276437">hash</a></span><span class="op" id="4277936">.</span><span class="ident" id="4277937">Hash</span>&nbsp;<span class="op" id="4277942">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277945">d</span>&nbsp;<span class="op" id="4277947">:=</span>&nbsp;<span class="builtinfunc" id="4277950">new</span><span class="op" id="4277953">(</span><span class="ident" id="4277954"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4277960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277963"><a href="/crypto/sha256/sha256.go.html#4277945">d</a></span><span class="op" id="4277964">.</span><span class="ident" id="4277965">is224</span>&nbsp;<span class="op" id="4277971">=</span>&nbsp;<span class="builtintype" id="4277973">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277979"><a href="/crypto/sha256/sha256.go.html#4277945">d</a></span><span class="op" id="4277980">.</span><span class="ident" id="4277981">Reset</span><span class="op" id="4277986">(</span><span class="op" id="4277987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277990">return</span>&nbsp;<span class="ident" id="4277997"><a href="/crypto/sha256/sha256.go.html#4277945">d</a></span><br>
<span class="lineno"></span><span class="op" id="4277999">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4278002">func</span>&nbsp;<span class="op" id="4278007">(</span><span class="ident" id="4278008">d</span>&nbsp;<span class="op" id="4278010">*</span><span class="ident" id="4278011"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4278017">)</span>&nbsp;<span class="ident" id="4278019">Size</span><span class="op" id="4278023">(</span><span class="op" id="4278024">)</span>&nbsp;<span class="builtintype" id="4278026">int</span>&nbsp;<span class="op" id="4278030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278033">if</span>&nbsp;<span class="op" id="4278036">!</span><span class="ident" id="4278037"><a href="/crypto/sha256/sha256.go.html#4278008">d</a></span><span class="op" id="4278038">.</span><span class="ident" id="4278039">is224</span>&nbsp;<span class="op" id="4278045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278049">return</span>&nbsp;<span class="ident" id="4278056"><a href="/crypto/sha256/sha256.go.html#4276598">Size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278062">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278065">return</span>&nbsp;<span class="ident" id="4278072"><a href="/crypto/sha256/sha256.go.html#4276658">Size224</a></span><br>
<span class="lineno"></span><span class="op" id="4278080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4278083">func</span>&nbsp;<span class="op" id="4278088">(</span><span class="ident" id="4278089">d</span>&nbsp;<span class="op" id="4278091">*</span><span class="ident" id="4278092"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4278098">)</span>&nbsp;<span class="ident" id="4278100">BlockSize</span><span class="op" id="4278109">(</span><span class="op" id="4278110">)</span>&nbsp;<span class="builtintype" id="4278112">int</span>&nbsp;<span class="op" id="4278116">{</span>&nbsp;<span class="keyword" id="4278118">return</span>&nbsp;<span class="ident" id="4278125"><a href="/crypto/sha256/sha256.go.html#4276726">BlockSize</a></span>&nbsp;<span class="op" id="4278135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4278138">func</span>&nbsp;<span class="op" id="4278143">(</span><span class="ident" id="4278144">d</span>&nbsp;<span class="op" id="4278146">*</span><span class="ident" id="4278147"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4278153">)</span>&nbsp;<span class="ident" id="4278155">Write</span><span class="op" id="4278160">(</span><span class="ident" id="4278161">p</span>&nbsp;<span class="op" id="4278163">[</span><span class="op" id="4278164">]</span><span class="builtintype" id="4278165">byte</span><span class="op" id="4278169">)</span>&nbsp;<span class="op" id="4278171">(</span><span class="ident" id="4278172">nn</span>&nbsp;<span class="builtintype" id="4278175">int</span><span class="op" id="4278178">,</span>&nbsp;<span class="ident" id="4278180">err</span>&nbsp;<span class="builtintype" id="4278184">error</span><span class="op" id="4278189">)</span>&nbsp;<span class="op" id="4278191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278194"><a href="/crypto/sha256/sha256.go.html#4278172">nn</a></span>&nbsp;<span class="op" id="4278197">=</span>&nbsp;<span class="builtinfunc" id="4278199">len</span><span class="op" id="4278202">(</span><span class="ident" id="4278203"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278207"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278208">.</span><span class="builtinfunc" id="4278209">len</span>&nbsp;<span class="op" id="4278213">+=</span>&nbsp;<span class="ident" id="4278216">uint64</span><span class="op" id="4278222">(</span><span class="ident" id="4278223"><a href="/crypto/sha256/sha256.go.html#4278172">nn</a></span><span class="op" id="4278225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278228">if</span>&nbsp;<span class="ident" id="4278231"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278232">.</span><span class="ident" id="4278233">nx</span>&nbsp;<span class="op" id="4278236">&gt;</span>&nbsp;<span class="num" id="4278238">0</span>&nbsp;<span class="op" id="4278240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278244">n</span>&nbsp;<span class="op" id="4278246">:=</span>&nbsp;<span class="builtinfunc" id="4278249">copy</span><span class="op" id="4278253">(</span><span class="ident" id="4278254"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278255">.</span><span class="ident" id="4278256">x</span><span class="op" id="4278257">[</span><span class="ident" id="4278258"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278259">.</span><span class="ident" id="4278260">nx</span><span class="op" id="4278262">:</span><span class="op" id="4278263">]</span><span class="op" id="4278264">,</span>&nbsp;<span class="ident" id="4278266"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278267">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278271"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278272">.</span><span class="ident" id="4278273">nx</span>&nbsp;<span class="op" id="4278276">+=</span>&nbsp;<span class="ident" id="4278279"><a href="/crypto/sha256/sha256.go.html#4278244">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278283">if</span>&nbsp;<span class="ident" id="4278286"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278287">.</span><span class="ident" id="4278288">nx</span>&nbsp;<span class="op" id="4278291">==</span>&nbsp;<span class="ident" id="4278294"><a href="/crypto/sha256/sha256.go.html#4276751">chunk</a></span>&nbsp;<span class="op" id="4278300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278305"><a href="/crypto/sha256/sha256block_decl.go.html#4279953">block</a></span><span class="op" id="4278310">(</span><span class="ident" id="4278311"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278312">,</span>&nbsp;<span class="ident" id="4278314"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278315">.</span><span class="ident" id="4278316">x</span><span class="op" id="4278317">[</span><span class="op" id="4278318">:</span><span class="op" id="4278319">]</span><span class="op" id="4278320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278325"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278326">.</span><span class="ident" id="4278327">nx</span>&nbsp;<span class="op" id="4278330">=</span>&nbsp;<span class="num" id="4278332">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278336">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278340"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span>&nbsp;<span class="op" id="4278342">=</span>&nbsp;<span class="ident" id="4278344"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278345">[</span><span class="ident" id="4278346"><a href="/crypto/sha256/sha256.go.html#4278244">n</a></span><span class="op" id="4278347">:</span><span class="op" id="4278348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278354">if</span>&nbsp;<span class="builtinfunc" id="4278357">len</span><span class="op" id="4278360">(</span><span class="ident" id="4278361"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278362">)</span>&nbsp;<span class="op" id="4278364">&gt;=</span>&nbsp;<span class="ident" id="4278367"><a href="/crypto/sha256/sha256.go.html#4276751">chunk</a></span>&nbsp;<span class="op" id="4278373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278377">n</span>&nbsp;<span class="op" id="4278379">:=</span>&nbsp;<span class="builtinfunc" id="4278382">len</span><span class="op" id="4278385">(</span><span class="ident" id="4278386"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278387">)</span>&nbsp;<span class="op" id="4278389">&amp;^</span>&nbsp;<span class="op" id="4278392">(</span><span class="ident" id="4278393"><a href="/crypto/sha256/sha256.go.html#4276751">chunk</a></span>&nbsp;<span class="op" id="4278399">-</span>&nbsp;<span class="num" id="4278401">1</span><span class="op" id="4278402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278406"><a href="/crypto/sha256/sha256block_decl.go.html#4279953">block</a></span><span class="op" id="4278411">(</span><span class="ident" id="4278412"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278413">,</span>&nbsp;<span class="ident" id="4278415"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278416">[</span><span class="op" id="4278417">:</span><span class="ident" id="4278418"><a href="/crypto/sha256/sha256.go.html#4278377">n</a></span><span class="op" id="4278419">]</span><span class="op" id="4278420">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278424"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span>&nbsp;<span class="op" id="4278426">=</span>&nbsp;<span class="ident" id="4278428"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278429">[</span><span class="ident" id="4278430"><a href="/crypto/sha256/sha256.go.html#4278377">n</a></span><span class="op" id="4278431">:</span><span class="op" id="4278432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278438">if</span>&nbsp;<span class="builtinfunc" id="4278441">len</span><span class="op" id="4278444">(</span><span class="ident" id="4278445"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278446">)</span>&nbsp;<span class="op" id="4278448">&gt;</span>&nbsp;<span class="num" id="4278450">0</span>&nbsp;<span class="op" id="4278452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278456"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278457">.</span><span class="ident" id="4278458">nx</span>&nbsp;<span class="op" id="4278461">=</span>&nbsp;<span class="builtinfunc" id="4278463">copy</span><span class="op" id="4278467">(</span><span class="ident" id="4278468"><a href="/crypto/sha256/sha256.go.html#4278144">d</a></span><span class="op" id="4278469">.</span><span class="ident" id="4278470">x</span><span class="op" id="4278471">[</span><span class="op" id="4278472">:</span><span class="op" id="4278473">]</span><span class="op" id="4278474">,</span>&nbsp;<span class="ident" id="4278476"><a href="/crypto/sha256/sha256.go.html#4278161">p</a></span><span class="op" id="4278477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278480">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278483">return</span><br>
<span class="lineno"></span><span class="op" id="4278490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4278493">func</span>&nbsp;<span class="op" id="4278498">(</span><span class="ident" id="4278499">d0</span>&nbsp;<span class="op" id="4278502">*</span><span class="ident" id="4278503"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4278509">)</span>&nbsp;<span class="ident" id="4278511">Sum</span><span class="op" id="4278514">(</span><span class="ident" id="4278515">in</span>&nbsp;<span class="op" id="4278518">[</span><span class="op" id="4278519">]</span><span class="builtintype" id="4278520">byte</span><span class="op" id="4278524">)</span>&nbsp;<span class="op" id="4278526">[</span><span class="op" id="4278527">]</span><span class="builtintype" id="4278528">byte</span>&nbsp;<span class="op" id="4278533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4278536">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278603">d</span>&nbsp;<span class="op" id="4278605">:=</span>&nbsp;<span class="op" id="4278608">*</span><span class="ident" id="4278609"><a href="/crypto/sha256/sha256.go.html#4278499">d0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278613">hash</span>&nbsp;<span class="op" id="4278618">:=</span>&nbsp;<span class="ident" id="4278621"><a href="/crypto/sha256/sha256.go.html#4278603">d</a></span><span class="op" id="4278622">.</span><span class="ident" id="4278623">checkSum</span><span class="op" id="4278631">(</span><span class="op" id="4278632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278635">if</span>&nbsp;<span class="ident" id="4278638"><a href="/crypto/sha256/sha256.go.html#4278603">d</a></span><span class="op" id="4278639">.</span><span class="ident" id="4278640">is224</span>&nbsp;<span class="op" id="4278646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278650">return</span>&nbsp;<span class="builtinfunc" id="4278657">append</span><span class="op" id="4278663">(</span><span class="ident" id="4278664"><a href="/crypto/sha256/sha256.go.html#4278515">in</a></span><span class="op" id="4278666">,</span>&nbsp;<span class="ident" id="4278668"><a href="/crypto/sha256/sha256.go.html#4278613">hash</a></span><span class="op" id="4278672">[</span><span class="op" id="4278673">:</span><span class="ident" id="4278674"><a href="/crypto/sha256/sha256.go.html#4276658">Size224</a></span><span class="op" id="4278681">]</span><span class="op" id="4278682">...</span><span class="op" id="4278685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278688">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278691">return</span>&nbsp;<span class="builtinfunc" id="4278698">append</span><span class="op" id="4278704">(</span><span class="ident" id="4278705"><a href="/crypto/sha256/sha256.go.html#4278515">in</a></span><span class="op" id="4278707">,</span>&nbsp;<span class="ident" id="4278709"><a href="/crypto/sha256/sha256.go.html#4278613">hash</a></span><span class="op" id="4278713">[</span><span class="op" id="4278714">:</span><span class="op" id="4278715">]</span><span class="op" id="4278716">...</span><span class="op" id="4278719">)</span><br>
<span class="lineno"></span><span class="op" id="4278721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4278724">func</span>&nbsp;<span class="op" id="4278729">(</span><span class="ident" id="4278730">d</span>&nbsp;<span class="op" id="4278732">*</span><span class="ident" id="4278733"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><span class="op" id="4278739">)</span>&nbsp;<span class="ident" id="4278741">checkSum</span><span class="op" id="4278749">(</span><span class="op" id="4278750">)</span>&nbsp;<span class="op" id="4278752">[</span><span class="ident" id="4278753"><a href="/crypto/sha256/sha256.go.html#4276598">Size</a></span><span class="op" id="4278757">]</span><span class="builtintype" id="4278758">byte</span>&nbsp;<span class="op" id="4278763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4278766">len</span>&nbsp;<span class="op" id="4278770">:=</span>&nbsp;<span class="ident" id="4278773"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4278774">.</span><span class="builtinfunc" id="4278775">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4278780">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278840">var</span>&nbsp;<span class="ident" id="4278844">tmp</span>&nbsp;<span class="op" id="4278848">[</span><span class="num" id="4278849">64</span><span class="op" id="4278851">]</span><span class="builtintype" id="4278852">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278858"><a href="/crypto/sha256/sha256.go.html#4278844">tmp</a></span><span class="op" id="4278861">[</span><span class="num" id="4278862">0</span><span class="op" id="4278863">]</span>&nbsp;<span class="op" id="4278865">=</span>&nbsp;<span class="num" id="4278867">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278873">if</span>&nbsp;<span class="builtinfunc" id="4278876"><a href="/crypto/sha256/sha256.go.html#4278766">len</a></span><span class="op" id="4278879">%</span><span class="num" id="4278880">64</span>&nbsp;<span class="op" id="4278883">&lt;</span>&nbsp;<span class="num" id="4278885">56</span>&nbsp;<span class="op" id="4278888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278892"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4278893">.</span><span class="ident" id="4278894">Write</span><span class="op" id="4278899">(</span><span class="ident" id="4278900"><a href="/crypto/sha256/sha256.go.html#4278844">tmp</a></span><span class="op" id="4278903">[</span><span class="num" id="4278904">0</span>&nbsp;<span class="op" id="4278906">:</span>&nbsp;<span class="num" id="4278908">56</span><span class="op" id="4278910">-</span><span class="builtinfunc" id="4278911"><a href="/crypto/sha256/sha256.go.html#4278766">len</a></span><span class="op" id="4278914">%</span><span class="num" id="4278915">64</span><span class="op" id="4278917">]</span><span class="op" id="4278918">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278921">}</span>&nbsp;<span class="keyword" id="4278923">else</span>&nbsp;<span class="op" id="4278928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278932"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4278933">.</span><span class="ident" id="4278934">Write</span><span class="op" id="4278939">(</span><span class="ident" id="4278940"><a href="/crypto/sha256/sha256.go.html#4278844">tmp</a></span><span class="op" id="4278943">[</span><span class="num" id="4278944">0</span>&nbsp;<span class="op" id="4278946">:</span>&nbsp;<span class="num" id="4278948">64</span><span class="op" id="4278950">+</span><span class="num" id="4278951">56</span><span class="op" id="4278953">-</span><span class="builtinfunc" id="4278954"><a href="/crypto/sha256/sha256.go.html#4278766">len</a></span><span class="op" id="4278957">%</span><span class="num" id="4278958">64</span><span class="op" id="4278960">]</span><span class="op" id="4278961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4278968">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4278988"><a href="/crypto/sha256/sha256.go.html#4278766">len</a></span>&nbsp;<span class="op" id="4278992">&lt;&lt;=</span>&nbsp;<span class="num" id="4278996">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278999">for</span>&nbsp;<span class="ident" id="4279003">i</span>&nbsp;<span class="op" id="4279005">:=</span>&nbsp;<span class="builtintype" id="4279008">uint</span><span class="op" id="4279012">(</span><span class="num" id="4279013">0</span><span class="op" id="4279014">)</span><span class="op" id="4279015">;</span>&nbsp;<span class="ident" id="4279017"><a href="/crypto/sha256/sha256.go.html#4279003">i</a></span>&nbsp;<span class="op" id="4279019">&lt;</span>&nbsp;<span class="num" id="4279021">8</span><span class="op" id="4279022">;</span>&nbsp;<span class="ident" id="4279024"><a href="/crypto/sha256/sha256.go.html#4279003">i</a></span><span class="op" id="4279025">++</span>&nbsp;<span class="op" id="4279028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279032"><a href="/crypto/sha256/sha256.go.html#4278844">tmp</a></span><span class="op" id="4279035">[</span><span class="ident" id="4279036"><a href="/crypto/sha256/sha256.go.html#4279003">i</a></span><span class="op" id="4279037">]</span>&nbsp;<span class="op" id="4279039">=</span>&nbsp;<span class="builtintype" id="4279041">byte</span><span class="op" id="4279045">(</span><span class="builtinfunc" id="4279046"><a href="/crypto/sha256/sha256.go.html#4278766">len</a></span>&nbsp;<span class="op" id="4279050">&gt;&gt;</span>&nbsp;<span class="op" id="4279053">(</span><span class="num" id="4279054">56</span>&nbsp;<span class="op" id="4279057">-</span>&nbsp;<span class="num" id="4279059">8</span><span class="op" id="4279060">*</span><span class="ident" id="4279061"><a href="/crypto/sha256/sha256.go.html#4279003">i</a></span><span class="op" id="4279062">)</span><span class="op" id="4279063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4279066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279069"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4279070">.</span><span class="ident" id="4279071">Write</span><span class="op" id="4279076">(</span><span class="ident" id="4279077"><a href="/crypto/sha256/sha256.go.html#4278844">tmp</a></span><span class="op" id="4279080">[</span><span class="num" id="4279081">0</span><span class="op" id="4279082">:</span><span class="num" id="4279083">8</span><span class="op" id="4279084">]</span><span class="op" id="4279085">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279089">if</span>&nbsp;<span class="ident" id="4279092"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4279093">.</span><span class="ident" id="4279094">nx</span>&nbsp;<span class="op" id="4279097">!=</span>&nbsp;<span class="num" id="4279100">0</span>&nbsp;<span class="op" id="4279102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4279106">panic</span><span class="op" id="4279111">(</span><span class="string" id="4279112">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4279123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4279126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279130">h</span>&nbsp;<span class="op" id="4279132">:=</span>&nbsp;<span class="ident" id="4279135"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4279136">.</span><span class="ident" id="4279137">h</span><span class="op" id="4279138">[</span><span class="op" id="4279139">:</span><span class="op" id="4279140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279143">if</span>&nbsp;<span class="ident" id="4279146"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4279147">.</span><span class="ident" id="4279148">is224</span>&nbsp;<span class="op" id="4279154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279158"><a href="/crypto/sha256/sha256.go.html#4279130">h</a></span>&nbsp;<span class="op" id="4279160">=</span>&nbsp;<span class="ident" id="4279162"><a href="/crypto/sha256/sha256.go.html#4278730">d</a></span><span class="op" id="4279163">.</span><span class="ident" id="4279164">h</span><span class="op" id="4279165">[</span><span class="op" id="4279166">:</span><span class="num" id="4279167">7</span><span class="op" id="4279168">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4279171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279175">var</span>&nbsp;<span class="ident" id="4279179">digest</span>&nbsp;<span class="op" id="4279186">[</span><span class="ident" id="4279187"><a href="/crypto/sha256/sha256.go.html#4276598">Size</a></span><span class="op" id="4279191">]</span><span class="builtintype" id="4279192">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279198">for</span>&nbsp;<span class="ident" id="4279202">i</span><span class="op" id="4279203">,</span>&nbsp;<span class="ident" id="4279205">s</span>&nbsp;<span class="op" id="4279207">:=</span>&nbsp;<span class="keyword" id="4279210">range</span>&nbsp;<span class="ident" id="4279216"><a href="/crypto/sha256/sha256.go.html#4279130">h</a></span>&nbsp;<span class="op" id="4279218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279222"><a href="/crypto/sha256/sha256.go.html#4279179">digest</a></span><span class="op" id="4279228">[</span><span class="ident" id="4279229"><a href="/crypto/sha256/sha256.go.html#4279202">i</a></span><span class="op" id="4279230">*</span><span class="num" id="4279231">4</span><span class="op" id="4279232">]</span>&nbsp;<span class="op" id="4279234">=</span>&nbsp;<span class="builtintype" id="4279236">byte</span><span class="op" id="4279240">(</span><span class="ident" id="4279241"><a href="/crypto/sha256/sha256.go.html#4279205">s</a></span>&nbsp;<span class="op" id="4279243">&gt;&gt;</span>&nbsp;<span class="num" id="4279246">24</span><span class="op" id="4279248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279252"><a href="/crypto/sha256/sha256.go.html#4279179">digest</a></span><span class="op" id="4279258">[</span><span class="ident" id="4279259"><a href="/crypto/sha256/sha256.go.html#4279202">i</a></span><span class="op" id="4279260">*</span><span class="num" id="4279261">4</span><span class="op" id="4279262">+</span><span class="num" id="4279263">1</span><span class="op" id="4279264">]</span>&nbsp;<span class="op" id="4279266">=</span>&nbsp;<span class="builtintype" id="4279268">byte</span><span class="op" id="4279272">(</span><span class="ident" id="4279273"><a href="/crypto/sha256/sha256.go.html#4279205">s</a></span>&nbsp;<span class="op" id="4279275">&gt;&gt;</span>&nbsp;<span class="num" id="4279278">16</span><span class="op" id="4279280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279284"><a href="/crypto/sha256/sha256.go.html#4279179">digest</a></span><span class="op" id="4279290">[</span><span class="ident" id="4279291"><a href="/crypto/sha256/sha256.go.html#4279202">i</a></span><span class="op" id="4279292">*</span><span class="num" id="4279293">4</span><span class="op" id="4279294">+</span><span class="num" id="4279295">2</span><span class="op" id="4279296">]</span>&nbsp;<span class="op" id="4279298">=</span>&nbsp;<span class="builtintype" id="4279300">byte</span><span class="op" id="4279304">(</span><span class="ident" id="4279305"><a href="/crypto/sha256/sha256.go.html#4279205">s</a></span>&nbsp;<span class="op" id="4279307">&gt;&gt;</span>&nbsp;<span class="num" id="4279310">8</span><span class="op" id="4279311">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279315"><a href="/crypto/sha256/sha256.go.html#4279179">digest</a></span><span class="op" id="4279321">[</span><span class="ident" id="4279322"><a href="/crypto/sha256/sha256.go.html#4279202">i</a></span><span class="op" id="4279323">*</span><span class="num" id="4279324">4</span><span class="op" id="4279325">+</span><span class="num" id="4279326">3</span><span class="op" id="4279327">]</span>&nbsp;<span class="op" id="4279329">=</span>&nbsp;<span class="builtintype" id="4279331">byte</span><span class="op" id="4279335">(</span><span class="ident" id="4279336"><a href="/crypto/sha256/sha256.go.html#4279205">s</a></span><span class="op" id="4279337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4279340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279344">return</span>&nbsp;<span class="ident" id="4279351"><a href="/crypto/sha256/sha256.go.html#4279179">digest</a></span><br>
<span class="lineno"></span><span class="op" id="4279358">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4279361">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4279412">func</span>&nbsp;<span class="ident" id="4279417">Sum256</span><span class="op" id="4279423">(</span><span class="ident" id="4279424">data</span>&nbsp;<span class="op" id="4279429">[</span><span class="op" id="4279430">]</span><span class="builtintype" id="4279431">byte</span><span class="op" id="4279435">)</span>&nbsp;<span class="op" id="4279437">[</span><span class="ident" id="4279438"><a href="/crypto/sha256/sha256.go.html#4276598">Size</a></span><span class="op" id="4279442">]</span><span class="builtintype" id="4279443">byte</span>&nbsp;<span class="op" id="4279448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279451">var</span>&nbsp;<span class="ident" id="4279455">d</span>&nbsp;<span class="ident" id="4279457"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279465"><a href="/crypto/sha256/sha256.go.html#4279455">d</a></span><span class="op" id="4279466">.</span><span class="ident" id="4279467">Reset</span><span class="op" id="4279472">(</span><span class="op" id="4279473">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279476"><a href="/crypto/sha256/sha256.go.html#4279455">d</a></span><span class="op" id="4279477">.</span><span class="ident" id="4279478">Write</span><span class="op" id="4279483">(</span><span class="ident" id="4279484"><a href="/crypto/sha256/sha256.go.html#4279424">data</a></span><span class="op" id="4279488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279491">return</span>&nbsp;<span class="ident" id="4279498"><a href="/crypto/sha256/sha256.go.html#4279455">d</a></span><span class="op" id="4279499">.</span><span class="ident" id="4279500">checkSum</span><span class="op" id="4279508">(</span><span class="op" id="4279509">)</span><br>
<span class="lineno"></span><span class="op" id="4279511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4279514">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4279565">func</span>&nbsp;<span class="ident" id="4279570">Sum224</span><span class="op" id="4279576">(</span><span class="ident" id="4279577">data</span>&nbsp;<span class="op" id="4279582">[</span><span class="op" id="4279583">]</span><span class="builtintype" id="4279584">byte</span><span class="op" id="4279588">)</span>&nbsp;<span class="op" id="4279590">(</span><span class="ident" id="4279591">sum224</span>&nbsp;<span class="op" id="4279598">[</span><span class="ident" id="4279599"><a href="/crypto/sha256/sha256.go.html#4276658">Size224</a></span><span class="op" id="4279606">]</span><span class="builtintype" id="4279607">byte</span><span class="op" id="4279611">)</span>&nbsp;<span class="op" id="4279613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279616">var</span>&nbsp;<span class="ident" id="4279620">d</span>&nbsp;<span class="ident" id="4279622"><a href="/crypto/sha256/sha256.go.html#4277217">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279630"><a href="/crypto/sha256/sha256.go.html#4279620">d</a></span><span class="op" id="4279631">.</span><span class="ident" id="4279632">is224</span>&nbsp;<span class="op" id="4279638">=</span>&nbsp;<span class="builtintype" id="4279640">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279646"><a href="/crypto/sha256/sha256.go.html#4279620">d</a></span><span class="op" id="4279647">.</span><span class="ident" id="4279648">Reset</span><span class="op" id="4279653">(</span><span class="op" id="4279654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279657"><a href="/crypto/sha256/sha256.go.html#4279620">d</a></span><span class="op" id="4279658">.</span><span class="ident" id="4279659">Write</span><span class="op" id="4279664">(</span><span class="ident" id="4279665"><a href="/crypto/sha256/sha256.go.html#4279577">data</a></span><span class="op" id="4279669">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279672">sum</span>&nbsp;<span class="op" id="4279676">:=</span>&nbsp;<span class="ident" id="4279679"><a href="/crypto/sha256/sha256.go.html#4279620">d</a></span><span class="op" id="4279680">.</span><span class="ident" id="4279681">checkSum</span><span class="op" id="4279689">(</span><span class="op" id="4279690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4279693">copy</span><span class="op" id="4279697">(</span><span class="ident" id="4279698"><a href="/crypto/sha256/sha256.go.html#4279591">sum224</a></span><span class="op" id="4279704">[</span><span class="op" id="4279705">:</span><span class="op" id="4279706">]</span><span class="op" id="4279707">,</span>&nbsp;<span class="ident" id="4279709"><a href="/crypto/sha256/sha256.go.html#4279672">sum</a></span><span class="op" id="4279712">[</span><span class="op" id="4279713">:</span><span class="ident" id="4279714"><a href="/crypto/sha256/sha256.go.html#4276658">Size224</a></span><span class="op" id="4279721">]</span><span class="op" id="4279722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279725">return</span><br>
<span class="lineno"></span><span class="op" id="4279732">}</span>
</div>
</body>
</html>
