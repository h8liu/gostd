<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7301048">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7301103">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7301157">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7301208">package</span>&nbsp;<span class="ident" id="7301216">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301221">import</span>&nbsp;<span class="op" id="7301228">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301231">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301240">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301250">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301265">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301280">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301299">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301315">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301321">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301333">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301344">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7301360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7301363">func</span>&nbsp;<span class="ident" id="7301368">decodeBase64</span><span class="op" id="7301380">(</span><span class="ident" id="7301381">in</span>&nbsp;<span class="builtintype" id="7301384">string</span><span class="op" id="7301390">)</span>&nbsp;<span class="op" id="7301392">[</span><span class="op" id="7301393">]</span><span class="builtintype" id="7301394">byte</span>&nbsp;<span class="op" id="7301399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7301402">out</span>&nbsp;<span class="op" id="7301406">:=</span>&nbsp;<span class="builtinfunc" id="7301409">make</span><span class="op" id="7301413">(</span><span class="op" id="7301414">[</span><span class="op" id="7301415">]</span><span class="builtintype" id="7301416">byte</span><span class="op" id="7301420">,</span>&nbsp;<span class="ident" id="7301422">base64</span><span class="op" id="7301428">.</span><span class="ident" id="7301429">StdEncoding</span><span class="op" id="7301440">.</span><span class="ident" id="7301441">DecodedLen</span><span class="op" id="7301451">(</span><span class="builtinfunc" id="7301452">len</span><span class="op" id="7301455">(</span><span class="ident" id="7301456">in</span><span class="op" id="7301458">)</span><span class="op" id="7301459">)</span><span class="op" id="7301460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7301463">n</span><span class="op" id="7301464">,</span>&nbsp;<span class="ident" id="7301466">err</span>&nbsp;<span class="op" id="7301470">:=</span>&nbsp;<span class="ident" id="7301473">base64</span><span class="op" id="7301479">.</span><span class="ident" id="7301480">StdEncoding</span><span class="op" id="7301491">.</span><span class="ident" id="7301492">Decode</span><span class="op" id="7301498">(</span><span class="ident" id="7301499">out</span><span class="op" id="7301502">,</span>&nbsp;<span class="op" id="7301504">[</span><span class="op" id="7301505">]</span><span class="builtintype" id="7301506">byte</span><span class="op" id="7301510">(</span><span class="ident" id="7301511">in</span><span class="op" id="7301513">)</span><span class="op" id="7301514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7301517">if</span>&nbsp;<span class="ident" id="7301520">err</span>&nbsp;<span class="op" id="7301524">!=</span>&nbsp;<span class="builtintype" id="7301527">nil</span>&nbsp;<span class="op" id="7301531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7301535">return</span>&nbsp;<span class="builtintype" id="7301542">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7301550">return</span>&nbsp;<span class="ident" id="7301557">out</span><span class="op" id="7301560">[</span><span class="num" id="7301561">0</span><span class="op" id="7301562">:</span><span class="ident" id="7301563">n</span><span class="op" id="7301564">]</span><br>
<span class="lineno"></span><span class="op" id="7301566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301569">type</span>&nbsp;<span class="ident" id="7301574">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="7301594">struct</span>&nbsp;<span class="op" id="7301601">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7301604">in</span><span class="op" id="7301606">,</span>&nbsp;<span class="ident" id="7301608">out</span>&nbsp;<span class="builtintype" id="7301612">string</span><br>
<span class="lineno"></span><span class="op" id="7301619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7301622">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7301696">var</span>&nbsp;<span class="ident" id="7301700">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7301721">=</span>&nbsp;<span class="op" id="7301723">[</span><span class="op" id="7301724">]</span><span class="ident" id="7301725">DecryptPKCS1v15Test</span><span class="op" id="7301744">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301751">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="7301841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301845">&#34;x&#34;</span><span class="op" id="7301848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301851">}</span><span class="op" id="7301852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301855">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301859">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="7301949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301953">&#34;testing.&#34;</span><span class="op" id="7301963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301966">}</span><span class="op" id="7301967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7301970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7301974">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="7302064">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7302068">&#34;testing.\n&#34;</span><span class="op" id="7302080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302083">}</span><span class="op" id="7302084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7302091">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="7302181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7302185">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="7302240">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302243">}</span><span class="op" id="7302244">,</span><br>
<span class="lineno"></span><span class="op" id="7302246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7302249">func</span>&nbsp;<span class="ident" id="7302254">TestDecryptPKCS1v15</span><span class="op" id="7302273">(</span><span class="ident" id="7302274">t</span>&nbsp;<span class="op" id="7302276">*</span><span class="ident" id="7302277">testing</span><span class="op" id="7302284">.</span><span class="ident" id="7302285">T</span><span class="op" id="7302286">)</span>&nbsp;<span class="op" id="7302288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302291">for</span>&nbsp;<span class="ident" id="7302295">i</span><span class="op" id="7302296">,</span>&nbsp;<span class="ident" id="7302298">test</span>&nbsp;<span class="op" id="7302303">:=</span>&nbsp;<span class="keyword" id="7302306">range</span>&nbsp;<span class="ident" id="7302312">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7302333">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302337">out</span><span class="op" id="7302340">,</span>&nbsp;<span class="ident" id="7302342">err</span>&nbsp;<span class="op" id="7302346">:=</span>&nbsp;<span class="ident" id="7302349">DecryptPKCS1v15</span><span class="op" id="7302364">(</span><span class="builtintype" id="7302365">nil</span><span class="op" id="7302368">,</span>&nbsp;<span class="ident" id="7302370">rsaPrivateKey</span><span class="op" id="7302383">,</span>&nbsp;<span class="ident" id="7302385">decodeBase64</span><span class="op" id="7302397">(</span><span class="ident" id="7302398">test</span><span class="op" id="7302402">.</span><span class="ident" id="7302403">in</span><span class="op" id="7302405">)</span><span class="op" id="7302406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302410">if</span>&nbsp;<span class="ident" id="7302413">err</span>&nbsp;<span class="op" id="7302417">!=</span>&nbsp;<span class="builtintype" id="7302420">nil</span>&nbsp;<span class="op" id="7302424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302429">t</span><span class="op" id="7302430">.</span><span class="ident" id="7302431">Errorf</span><span class="op" id="7302437">(</span><span class="string" id="7302438">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7302460">,</span>&nbsp;<span class="ident" id="7302462">i</span><span class="op" id="7302463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302471">want</span>&nbsp;<span class="op" id="7302476">:=</span>&nbsp;<span class="op" id="7302479">[</span><span class="op" id="7302480">]</span><span class="builtintype" id="7302481">byte</span><span class="op" id="7302485">(</span><span class="ident" id="7302486">test</span><span class="op" id="7302490">.</span><span class="ident" id="7302491">out</span><span class="op" id="7302494">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302498">if</span>&nbsp;<span class="op" id="7302501">!</span><span class="ident" id="7302502">bytes</span><span class="op" id="7302507">.</span><span class="ident" id="7302508">Equal</span><span class="op" id="7302513">(</span><span class="ident" id="7302514">out</span><span class="op" id="7302517">,</span>&nbsp;<span class="ident" id="7302519">want</span><span class="op" id="7302523">)</span>&nbsp;<span class="op" id="7302525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302530">t</span><span class="op" id="7302531">.</span><span class="ident" id="7302532">Errorf</span><span class="op" id="7302538">(</span><span class="string" id="7302539">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7302561">,</span>&nbsp;<span class="ident" id="7302563">i</span><span class="op" id="7302564">,</span>&nbsp;<span class="ident" id="7302566">out</span><span class="op" id="7302569">,</span>&nbsp;<span class="ident" id="7302571">want</span><span class="op" id="7302575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302582">}</span><br>
<span class="lineno"></span><span class="op" id="7302584">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7302587">func</span>&nbsp;<span class="ident" id="7302592">TestEncryptPKCS1v15</span><span class="op" id="7302611">(</span><span class="ident" id="7302612">t</span>&nbsp;<span class="op" id="7302614">*</span><span class="ident" id="7302615">testing</span><span class="op" id="7302622">.</span><span class="ident" id="7302623">T</span><span class="op" id="7302624">)</span>&nbsp;<span class="op" id="7302626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302629">random</span>&nbsp;<span class="op" id="7302636">:=</span>&nbsp;<span class="ident" id="7302639">rand</span><span class="op" id="7302643">.</span><span class="ident" id="7302644">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302652">k</span>&nbsp;<span class="op" id="7302654">:=</span>&nbsp;<span class="op" id="7302657">(</span><span class="ident" id="7302658">rsaPrivateKey</span><span class="op" id="7302671">.</span><span class="ident" id="7302672">N</span><span class="op" id="7302673">.</span><span class="ident" id="7302674">BitLen</span><span class="op" id="7302680">(</span><span class="op" id="7302681">)</span>&nbsp;<span class="op" id="7302683">+</span>&nbsp;<span class="num" id="7302685">7</span><span class="op" id="7302686">)</span>&nbsp;<span class="op" id="7302688">/</span>&nbsp;<span class="num" id="7302690">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302694">tryEncryptDecrypt</span>&nbsp;<span class="op" id="7302712">:=</span>&nbsp;<span class="keyword" id="7302715">func</span><span class="op" id="7302719">(</span><span class="ident" id="7302720">in</span>&nbsp;<span class="op" id="7302723">[</span><span class="op" id="7302724">]</span><span class="builtintype" id="7302725">byte</span><span class="op" id="7302729">,</span>&nbsp;<span class="ident" id="7302731">blind</span>&nbsp;<span class="builtintype" id="7302737">bool</span><span class="op" id="7302741">)</span>&nbsp;<span class="builtintype" id="7302743">bool</span>&nbsp;<span class="op" id="7302748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302752">if</span>&nbsp;<span class="builtinfunc" id="7302755">len</span><span class="op" id="7302758">(</span><span class="ident" id="7302759">in</span><span class="op" id="7302761">)</span>&nbsp;<span class="op" id="7302763">&gt;</span>&nbsp;<span class="ident" id="7302765">k</span><span class="op" id="7302766">-</span><span class="num" id="7302767">11</span>&nbsp;<span class="op" id="7302770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302775">in</span>&nbsp;<span class="op" id="7302778">=</span>&nbsp;<span class="ident" id="7302780">in</span><span class="op" id="7302782">[</span><span class="num" id="7302783">0</span>&nbsp;<span class="op" id="7302785">:</span>&nbsp;<span class="ident" id="7302787">k</span><span class="op" id="7302788">-</span><span class="num" id="7302789">11</span><span class="op" id="7302791">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302800">ciphertext</span><span class="op" id="7302810">,</span>&nbsp;<span class="ident" id="7302812">err</span>&nbsp;<span class="op" id="7302816">:=</span>&nbsp;<span class="ident" id="7302819">EncryptPKCS1v15</span><span class="op" id="7302834">(</span><span class="ident" id="7302835">random</span><span class="op" id="7302841">,</span>&nbsp;<span class="op" id="7302843">&amp;</span><span class="ident" id="7302844">rsaPrivateKey</span><span class="op" id="7302857">.</span><span class="ident" id="7302858">PublicKey</span><span class="op" id="7302867">,</span>&nbsp;<span class="ident" id="7302869">in</span><span class="op" id="7302871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302875">if</span>&nbsp;<span class="ident" id="7302878">err</span>&nbsp;<span class="op" id="7302882">!=</span>&nbsp;<span class="builtintype" id="7302885">nil</span>&nbsp;<span class="op" id="7302889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302894">t</span><span class="op" id="7302895">.</span><span class="ident" id="7302896">Errorf</span><span class="op" id="7302902">(</span><span class="string" id="7302903">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="7302925">,</span>&nbsp;<span class="ident" id="7302927">err</span><span class="op" id="7302930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302935">return</span>&nbsp;<span class="builtintype" id="7302942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7302950">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302955">var</span>&nbsp;<span class="ident" id="7302959">rand</span>&nbsp;<span class="ident" id="7302964">io</span><span class="op" id="7302966">.</span><span class="ident" id="7302967">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7302976">if</span>&nbsp;<span class="op" id="7302979">!</span><span class="ident" id="7302980">blind</span>&nbsp;<span class="op" id="7302986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7302991">rand</span>&nbsp;<span class="op" id="7302996">=</span>&nbsp;<span class="builtintype" id="7302998">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303004">}</span>&nbsp;<span class="keyword" id="7303006">else</span>&nbsp;<span class="op" id="7303011">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303016">rand</span>&nbsp;<span class="op" id="7303021">=</span>&nbsp;<span class="ident" id="7303023">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303036">plaintext</span><span class="op" id="7303045">,</span>&nbsp;<span class="ident" id="7303047">err</span>&nbsp;<span class="op" id="7303051">:=</span>&nbsp;<span class="ident" id="7303054">DecryptPKCS1v15</span><span class="op" id="7303069">(</span><span class="ident" id="7303070">rand</span><span class="op" id="7303074">,</span>&nbsp;<span class="ident" id="7303076">rsaPrivateKey</span><span class="op" id="7303089">,</span>&nbsp;<span class="ident" id="7303091">ciphertext</span><span class="op" id="7303101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303105">if</span>&nbsp;<span class="ident" id="7303108">err</span>&nbsp;<span class="op" id="7303112">!=</span>&nbsp;<span class="builtintype" id="7303115">nil</span>&nbsp;<span class="op" id="7303119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303124">t</span><span class="op" id="7303125">.</span><span class="ident" id="7303126">Errorf</span><span class="op" id="7303132">(</span><span class="string" id="7303133">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="7303155">,</span>&nbsp;<span class="ident" id="7303157">err</span><span class="op" id="7303160">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303165">return</span>&nbsp;<span class="builtintype" id="7303172">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303185">if</span>&nbsp;<span class="op" id="7303188">!</span><span class="ident" id="7303189">bytes</span><span class="op" id="7303194">.</span><span class="ident" id="7303195">Equal</span><span class="op" id="7303200">(</span><span class="ident" id="7303201">plaintext</span><span class="op" id="7303210">,</span>&nbsp;<span class="ident" id="7303212">in</span><span class="op" id="7303214">)</span>&nbsp;<span class="op" id="7303216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303221">t</span><span class="op" id="7303222">.</span><span class="ident" id="7303223">Errorf</span><span class="op" id="7303229">(</span><span class="string" id="7303230">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="7303256">,</span>&nbsp;<span class="ident" id="7303258">plaintext</span><span class="op" id="7303267">,</span>&nbsp;<span class="ident" id="7303269">in</span><span class="op" id="7303271">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303276">return</span>&nbsp;<span class="builtintype" id="7303283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303295">return</span>&nbsp;<span class="builtintype" id="7303302">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303312">config</span>&nbsp;<span class="op" id="7303319">:=</span>&nbsp;<span class="builtinfunc" id="7303322">new</span><span class="op" id="7303325">(</span><span class="ident" id="7303326">quick</span><span class="op" id="7303331">.</span><span class="ident" id="7303332">Config</span><span class="op" id="7303338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7303341">if</span>&nbsp;<span class="ident" id="7303344">testing</span><span class="op" id="7303351">.</span><span class="ident" id="7303352">Short</span><span class="op" id="7303357">(</span><span class="op" id="7303358">)</span>&nbsp;<span class="op" id="7303360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303364">config</span><span class="op" id="7303370">.</span><span class="ident" id="7303371">MaxCount</span>&nbsp;<span class="op" id="7303380">=</span>&nbsp;<span class="num" id="7303382">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303389">quick</span><span class="op" id="7303394">.</span><span class="ident" id="7303395">Check</span><span class="op" id="7303400">(</span><span class="ident" id="7303401">tryEncryptDecrypt</span><span class="op" id="7303418">,</span>&nbsp;<span class="ident" id="7303420">config</span><span class="op" id="7303426">)</span><br>
<span class="lineno">105</span><span class="op" id="7303428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7303431">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7303505">var</span>&nbsp;<span class="ident" id="7303509">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7303540">=</span>&nbsp;<span class="op" id="7303542">[</span><span class="op" id="7303543">]</span><span class="ident" id="7303544">DecryptPKCS1v15Test</span><span class="op" id="7303563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303566">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303570">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="7303660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303664">&#34;1234&#34;</span><span class="op" id="7303670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303673">}</span><span class="op" id="7303674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303681">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="7303771">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303775">&#34;FAIL&#34;</span><span class="op" id="7303781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303784">}</span><span class="op" id="7303785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303792">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="7303882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303886">&#34;abcd&#34;</span><span class="op" id="7303892">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303895">}</span><span class="op" id="7303896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7303899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303903">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="7303993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7303997">&#34;FAIL&#34;</span><span class="op" id="7304003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304006">}</span><span class="op" id="7304007">,</span><br>
<span class="lineno">125</span><span class="op" id="7304009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7304012">func</span>&nbsp;<span class="ident" id="7304017">TestEncryptPKCS1v15SessionKey</span><span class="op" id="7304046">(</span><span class="ident" id="7304047">t</span>&nbsp;<span class="op" id="7304049">*</span><span class="ident" id="7304050">testing</span><span class="op" id="7304057">.</span><span class="ident" id="7304058">T</span><span class="op" id="7304059">)</span>&nbsp;<span class="op" id="7304061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304064">for</span>&nbsp;<span class="ident" id="7304068">i</span><span class="op" id="7304069">,</span>&nbsp;<span class="ident" id="7304071">test</span>&nbsp;<span class="op" id="7304076">:=</span>&nbsp;<span class="keyword" id="7304079">range</span>&nbsp;<span class="ident" id="7304085">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7304116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304120">key</span>&nbsp;<span class="op" id="7304124">:=</span>&nbsp;<span class="op" id="7304127">[</span><span class="op" id="7304128">]</span><span class="builtintype" id="7304129">byte</span><span class="op" id="7304133">(</span><span class="string" id="7304134">&#34;FAIL&#34;</span><span class="op" id="7304140">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304144">err</span>&nbsp;<span class="op" id="7304148">:=</span>&nbsp;<span class="ident" id="7304151">DecryptPKCS1v15SessionKey</span><span class="op" id="7304176">(</span><span class="builtintype" id="7304177">nil</span><span class="op" id="7304180">,</span>&nbsp;<span class="ident" id="7304182">rsaPrivateKey</span><span class="op" id="7304195">,</span>&nbsp;<span class="ident" id="7304197">decodeBase64</span><span class="op" id="7304209">(</span><span class="ident" id="7304210">test</span><span class="op" id="7304214">.</span><span class="ident" id="7304215">in</span><span class="op" id="7304217">)</span><span class="op" id="7304218">,</span>&nbsp;<span class="ident" id="7304220">key</span><span class="op" id="7304223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304227">if</span>&nbsp;<span class="ident" id="7304230">err</span>&nbsp;<span class="op" id="7304234">!=</span>&nbsp;<span class="builtintype" id="7304237">nil</span>&nbsp;<span class="op" id="7304241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304246">t</span><span class="op" id="7304247">.</span><span class="ident" id="7304248">Errorf</span><span class="op" id="7304254">(</span><span class="string" id="7304255">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7304277">,</span>&nbsp;<span class="ident" id="7304279">i</span><span class="op" id="7304280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304288">want</span>&nbsp;<span class="op" id="7304293">:=</span>&nbsp;<span class="op" id="7304296">[</span><span class="op" id="7304297">]</span><span class="builtintype" id="7304298">byte</span><span class="op" id="7304302">(</span><span class="ident" id="7304303">test</span><span class="op" id="7304307">.</span><span class="ident" id="7304308">out</span><span class="op" id="7304311">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304315">if</span>&nbsp;<span class="op" id="7304318">!</span><span class="ident" id="7304319">bytes</span><span class="op" id="7304324">.</span><span class="ident" id="7304325">Equal</span><span class="op" id="7304330">(</span><span class="ident" id="7304331">key</span><span class="op" id="7304334">,</span>&nbsp;<span class="ident" id="7304336">want</span><span class="op" id="7304340">)</span>&nbsp;<span class="op" id="7304342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304347">t</span><span class="op" id="7304348">.</span><span class="ident" id="7304349">Errorf</span><span class="op" id="7304355">(</span><span class="string" id="7304356">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7304378">,</span>&nbsp;<span class="ident" id="7304380">i</span><span class="op" id="7304381">,</span>&nbsp;<span class="ident" id="7304383">key</span><span class="op" id="7304386">,</span>&nbsp;<span class="ident" id="7304388">want</span><span class="op" id="7304392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304399">}</span><br>
<span class="lineno"></span><span class="op" id="7304401">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7304404">func</span>&nbsp;<span class="ident" id="7304409">TestNonZeroRandomBytes</span><span class="op" id="7304431">(</span><span class="ident" id="7304432">t</span>&nbsp;<span class="op" id="7304434">*</span><span class="ident" id="7304435">testing</span><span class="op" id="7304442">.</span><span class="ident" id="7304443">T</span><span class="op" id="7304444">)</span>&nbsp;<span class="op" id="7304446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304449">random</span>&nbsp;<span class="op" id="7304456">:=</span>&nbsp;<span class="ident" id="7304459">rand</span><span class="op" id="7304463">.</span><span class="ident" id="7304464">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304473">b</span>&nbsp;<span class="op" id="7304475">:=</span>&nbsp;<span class="builtinfunc" id="7304478">make</span><span class="op" id="7304482">(</span><span class="op" id="7304483">[</span><span class="op" id="7304484">]</span><span class="builtintype" id="7304485">byte</span><span class="op" id="7304489">,</span>&nbsp;<span class="num" id="7304491">512</span><span class="op" id="7304494">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304497">err</span>&nbsp;<span class="op" id="7304501">:=</span>&nbsp;<span class="ident" id="7304504">nonZeroRandomBytes</span><span class="op" id="7304522">(</span><span class="ident" id="7304523">b</span><span class="op" id="7304524">,</span>&nbsp;<span class="ident" id="7304526">random</span><span class="op" id="7304532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304535">if</span>&nbsp;<span class="ident" id="7304538">err</span>&nbsp;<span class="op" id="7304542">!=</span>&nbsp;<span class="builtintype" id="7304545">nil</span>&nbsp;<span class="op" id="7304549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304553">t</span><span class="op" id="7304554">.</span><span class="ident" id="7304555">Errorf</span><span class="op" id="7304561">(</span><span class="string" id="7304562">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7304582">,</span>&nbsp;<span class="ident" id="7304584">err</span><span class="op" id="7304587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304593">for</span>&nbsp;<span class="ident" id="7304597">_</span><span class="op" id="7304598">,</span>&nbsp;<span class="ident" id="7304600">b</span>&nbsp;<span class="op" id="7304602">:=</span>&nbsp;<span class="keyword" id="7304605">range</span>&nbsp;<span class="ident" id="7304611">b</span>&nbsp;<span class="op" id="7304613">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304617">if</span>&nbsp;<span class="ident" id="7304620">b</span>&nbsp;<span class="op" id="7304622">==</span>&nbsp;<span class="num" id="7304625">0</span>&nbsp;<span class="op" id="7304627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304632">t</span><span class="op" id="7304633">.</span><span class="ident" id="7304634">Errorf</span><span class="op" id="7304640">(</span><span class="string" id="7304641">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="7304659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7304664">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304676">}</span><br>
<span class="lineno">155</span><span class="op" id="7304678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7304681">type</span>&nbsp;<span class="ident" id="7304686">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="7304703">struct</span>&nbsp;<span class="op" id="7304710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304713">in</span><span class="op" id="7304715">,</span>&nbsp;<span class="ident" id="7304717">out</span>&nbsp;<span class="builtintype" id="7304721">string</span><br>
<span class="lineno"></span><span class="op" id="7304728">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7304731">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7304770">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="7304837">var</span>&nbsp;<span class="ident" id="7304841">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7304859">=</span>&nbsp;<span class="op" id="7304861">[</span><span class="op" id="7304862">]</span><span class="ident" id="7304863">signPKCS1v15Test</span><span class="op" id="7304879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304882">{</span><span class="string" id="7304883">&#34;Test.\n&#34;</span><span class="op" id="7304892">,</span>&nbsp;<span class="string" id="7304894">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="7305024">}</span><span class="op" id="7305025">,</span><br>
<span class="lineno">165</span><span class="op" id="7305027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7305030">func</span>&nbsp;<span class="ident" id="7305035">TestSignPKCS1v15</span><span class="op" id="7305051">(</span><span class="ident" id="7305052">t</span>&nbsp;<span class="op" id="7305054">*</span><span class="ident" id="7305055">testing</span><span class="op" id="7305062">.</span><span class="ident" id="7305063">T</span><span class="op" id="7305064">)</span>&nbsp;<span class="op" id="7305066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305069">for</span>&nbsp;<span class="ident" id="7305073">i</span><span class="op" id="7305074">,</span>&nbsp;<span class="ident" id="7305076">test</span>&nbsp;<span class="op" id="7305081">:=</span>&nbsp;<span class="keyword" id="7305084">range</span>&nbsp;<span class="ident" id="7305090">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7305108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305112">h</span>&nbsp;<span class="op" id="7305114">:=</span>&nbsp;<span class="ident" id="7305117">sha1</span><span class="op" id="7305121">.</span><span class="ident" id="7305122">New</span><span class="op" id="7305125">(</span><span class="op" id="7305126">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305130">h</span><span class="op" id="7305131">.</span><span class="ident" id="7305132">Write</span><span class="op" id="7305137">(</span><span class="op" id="7305138">[</span><span class="op" id="7305139">]</span><span class="builtintype" id="7305140">byte</span><span class="op" id="7305144">(</span><span class="ident" id="7305145">test</span><span class="op" id="7305149">.</span><span class="ident" id="7305150">in</span><span class="op" id="7305152">)</span><span class="op" id="7305153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305157">digest</span>&nbsp;<span class="op" id="7305164">:=</span>&nbsp;<span class="ident" id="7305167">h</span><span class="op" id="7305168">.</span><span class="ident" id="7305169">Sum</span><span class="op" id="7305172">(</span><span class="builtintype" id="7305173">nil</span><span class="op" id="7305176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305181">s</span><span class="op" id="7305182">,</span>&nbsp;<span class="ident" id="7305184">err</span>&nbsp;<span class="op" id="7305188">:=</span>&nbsp;<span class="ident" id="7305191">SignPKCS1v15</span><span class="op" id="7305203">(</span><span class="builtintype" id="7305204">nil</span><span class="op" id="7305207">,</span>&nbsp;<span class="ident" id="7305209">rsaPrivateKey</span><span class="op" id="7305222">,</span>&nbsp;<span class="ident" id="7305224">crypto</span><span class="op" id="7305230">.</span><span class="ident" id="7305231">SHA1</span><span class="op" id="7305235">,</span>&nbsp;<span class="ident" id="7305237">digest</span><span class="op" id="7305243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305247">if</span>&nbsp;<span class="ident" id="7305250">err</span>&nbsp;<span class="op" id="7305254">!=</span>&nbsp;<span class="builtintype" id="7305257">nil</span>&nbsp;<span class="op" id="7305261">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305266">t</span><span class="op" id="7305267">.</span><span class="ident" id="7305268">Errorf</span><span class="op" id="7305274">(</span><span class="string" id="7305275">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7305283">,</span>&nbsp;<span class="ident" id="7305285">i</span><span class="op" id="7305286">,</span>&nbsp;<span class="ident" id="7305288">err</span><span class="op" id="7305291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7305295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305300">expected</span><span class="op" id="7305308">,</span>&nbsp;<span class="ident" id="7305310">_</span>&nbsp;<span class="op" id="7305312">:=</span>&nbsp;<span class="ident" id="7305315">hex</span><span class="op" id="7305318">.</span><span class="ident" id="7305319">DecodeString</span><span class="op" id="7305331">(</span><span class="ident" id="7305332">test</span><span class="op" id="7305336">.</span><span class="ident" id="7305337">out</span><span class="op" id="7305340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305344">if</span>&nbsp;<span class="op" id="7305347">!</span><span class="ident" id="7305348">bytes</span><span class="op" id="7305353">.</span><span class="ident" id="7305354">Equal</span><span class="op" id="7305359">(</span><span class="ident" id="7305360">s</span><span class="op" id="7305361">,</span>&nbsp;<span class="ident" id="7305363">expected</span><span class="op" id="7305371">)</span>&nbsp;<span class="op" id="7305373">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305378">t</span><span class="op" id="7305379">.</span><span class="ident" id="7305380">Errorf</span><span class="op" id="7305386">(</span><span class="string" id="7305387">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="7305409">,</span>&nbsp;<span class="ident" id="7305411">i</span><span class="op" id="7305412">,</span>&nbsp;<span class="ident" id="7305414">s</span><span class="op" id="7305415">,</span>&nbsp;<span class="ident" id="7305417">expected</span><span class="op" id="7305425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7305429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7305432">}</span><br>
<span class="lineno"></span><span class="op" id="7305434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="7305437">func</span>&nbsp;<span class="ident" id="7305442">TestVerifyPKCS1v15</span><span class="op" id="7305460">(</span><span class="ident" id="7305461">t</span>&nbsp;<span class="op" id="7305463">*</span><span class="ident" id="7305464">testing</span><span class="op" id="7305471">.</span><span class="ident" id="7305472">T</span><span class="op" id="7305473">)</span>&nbsp;<span class="op" id="7305475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305478">for</span>&nbsp;<span class="ident" id="7305482">i</span><span class="op" id="7305483">,</span>&nbsp;<span class="ident" id="7305485">test</span>&nbsp;<span class="op" id="7305490">:=</span>&nbsp;<span class="keyword" id="7305493">range</span>&nbsp;<span class="ident" id="7305499">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7305517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305521">h</span>&nbsp;<span class="op" id="7305523">:=</span>&nbsp;<span class="ident" id="7305526">sha1</span><span class="op" id="7305530">.</span><span class="ident" id="7305531">New</span><span class="op" id="7305534">(</span><span class="op" id="7305535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305539">h</span><span class="op" id="7305540">.</span><span class="ident" id="7305541">Write</span><span class="op" id="7305546">(</span><span class="op" id="7305547">[</span><span class="op" id="7305548">]</span><span class="builtintype" id="7305549">byte</span><span class="op" id="7305553">(</span><span class="ident" id="7305554">test</span><span class="op" id="7305558">.</span><span class="ident" id="7305559">in</span><span class="op" id="7305561">)</span><span class="op" id="7305562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305566">digest</span>&nbsp;<span class="op" id="7305573">:=</span>&nbsp;<span class="ident" id="7305576">h</span><span class="op" id="7305577">.</span><span class="ident" id="7305578">Sum</span><span class="op" id="7305581">(</span><span class="builtintype" id="7305582">nil</span><span class="op" id="7305585">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305590">sig</span><span class="op" id="7305593">,</span>&nbsp;<span class="ident" id="7305595">_</span>&nbsp;<span class="op" id="7305597">:=</span>&nbsp;<span class="ident" id="7305600">hex</span><span class="op" id="7305603">.</span><span class="ident" id="7305604">DecodeString</span><span class="op" id="7305616">(</span><span class="ident" id="7305617">test</span><span class="op" id="7305621">.</span><span class="ident" id="7305622">out</span><span class="op" id="7305625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305630">err</span>&nbsp;<span class="op" id="7305634">:=</span>&nbsp;<span class="ident" id="7305637">VerifyPKCS1v15</span><span class="op" id="7305651">(</span><span class="op" id="7305652">&amp;</span><span class="ident" id="7305653">rsaPrivateKey</span><span class="op" id="7305666">.</span><span class="ident" id="7305667">PublicKey</span><span class="op" id="7305676">,</span>&nbsp;<span class="ident" id="7305678">crypto</span><span class="op" id="7305684">.</span><span class="ident" id="7305685">SHA1</span><span class="op" id="7305689">,</span>&nbsp;<span class="ident" id="7305691">digest</span><span class="op" id="7305697">,</span>&nbsp;<span class="ident" id="7305699">sig</span><span class="op" id="7305702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305706">if</span>&nbsp;<span class="ident" id="7305709">err</span>&nbsp;<span class="op" id="7305713">!=</span>&nbsp;<span class="builtintype" id="7305716">nil</span>&nbsp;<span class="op" id="7305720">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305725">t</span><span class="op" id="7305726">.</span><span class="ident" id="7305727">Errorf</span><span class="op" id="7305733">(</span><span class="string" id="7305734">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7305742">,</span>&nbsp;<span class="ident" id="7305744">i</span><span class="op" id="7305745">,</span>&nbsp;<span class="ident" id="7305747">err</span><span class="op" id="7305750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7305754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7305757">}</span><br>
<span class="lineno"></span><span class="op" id="7305759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="7305762">func</span>&nbsp;<span class="ident" id="7305767">TestOverlongMessagePKCS1v15</span><span class="op" id="7305794">(</span><span class="ident" id="7305795">t</span>&nbsp;<span class="op" id="7305797">*</span><span class="ident" id="7305798">testing</span><span class="op" id="7305805">.</span><span class="ident" id="7305806">T</span><span class="op" id="7305807">)</span>&nbsp;<span class="op" id="7305809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305812">ciphertext</span>&nbsp;<span class="op" id="7305823">:=</span>&nbsp;<span class="ident" id="7305826">decodeBase64</span><span class="op" id="7305838">(</span><span class="string" id="7305839">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="7305931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7305934">_</span><span class="op" id="7305935">,</span>&nbsp;<span class="ident" id="7305937">err</span>&nbsp;<span class="op" id="7305941">:=</span>&nbsp;<span class="ident" id="7305944">DecryptPKCS1v15</span><span class="op" id="7305959">(</span><span class="builtintype" id="7305960">nil</span><span class="op" id="7305963">,</span>&nbsp;<span class="ident" id="7305965">rsaPrivateKey</span><span class="op" id="7305978">,</span>&nbsp;<span class="ident" id="7305980">ciphertext</span><span class="op" id="7305990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7305993">if</span>&nbsp;<span class="ident" id="7305996">err</span>&nbsp;<span class="op" id="7306000">==</span>&nbsp;<span class="builtintype" id="7306003">nil</span>&nbsp;<span class="op" id="7306007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306011">t</span><span class="op" id="7306012">.</span><span class="ident" id="7306013">Error</span><span class="op" id="7306018">(</span><span class="string" id="7306019">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="7306063">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306066">}</span><br>
<span class="lineno"></span><span class="op" id="7306068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7306071">func</span>&nbsp;<span class="ident" id="7306076">TestUnpaddedSignature</span><span class="op" id="7306097">(</span><span class="ident" id="7306098">t</span>&nbsp;<span class="op" id="7306100">*</span><span class="ident" id="7306101">testing</span><span class="op" id="7306108">.</span><span class="ident" id="7306109">T</span><span class="op" id="7306110">)</span>&nbsp;<span class="op" id="7306112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306115">msg</span>&nbsp;<span class="op" id="7306119">:=</span>&nbsp;<span class="op" id="7306122">[</span><span class="op" id="7306123">]</span><span class="builtintype" id="7306124">byte</span><span class="op" id="7306128">(</span><span class="string" id="7306129">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="7306161">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306164">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306206">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306257">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306322">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306326">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306399">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306409">expectedSig</span>&nbsp;<span class="op" id="7306421">:=</span>&nbsp;<span class="ident" id="7306424">decodeBase64</span><span class="op" id="7306436">(</span><span class="string" id="7306437">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="7306527">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306531">sig</span><span class="op" id="7306534">,</span>&nbsp;<span class="ident" id="7306536">err</span>&nbsp;<span class="op" id="7306540">:=</span>&nbsp;<span class="ident" id="7306543">SignPKCS1v15</span><span class="op" id="7306555">(</span><span class="builtintype" id="7306556">nil</span><span class="op" id="7306559">,</span>&nbsp;<span class="ident" id="7306561">rsaPrivateKey</span><span class="op" id="7306574">,</span>&nbsp;<span class="ident" id="7306576">crypto</span><span class="op" id="7306582">.</span><span class="ident" id="7306583">Hash</span><span class="op" id="7306587">(</span><span class="num" id="7306588">0</span><span class="op" id="7306589">)</span><span class="op" id="7306590">,</span>&nbsp;<span class="ident" id="7306592">msg</span><span class="op" id="7306595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7306598">if</span>&nbsp;<span class="ident" id="7306601">err</span>&nbsp;<span class="op" id="7306605">!=</span>&nbsp;<span class="builtintype" id="7306608">nil</span>&nbsp;<span class="op" id="7306612">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306616">t</span><span class="op" id="7306617">.</span><span class="ident" id="7306618">Fatalf</span><span class="op" id="7306624">(</span><span class="string" id="7306625">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7306650">,</span>&nbsp;<span class="ident" id="7306652">err</span><span class="op" id="7306655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7306661">if</span>&nbsp;<span class="op" id="7306664">!</span><span class="ident" id="7306665">bytes</span><span class="op" id="7306670">.</span><span class="ident" id="7306671">Equal</span><span class="op" id="7306676">(</span><span class="ident" id="7306677">sig</span><span class="op" id="7306680">,</span>&nbsp;<span class="ident" id="7306682">expectedSig</span><span class="op" id="7306693">)</span>&nbsp;<span class="op" id="7306695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306699">t</span><span class="op" id="7306700">.</span><span class="ident" id="7306701">Fatalf</span><span class="op" id="7306707">(</span><span class="string" id="7306708">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7306758">,</span>&nbsp;<span class="ident" id="7306760">sig</span><span class="op" id="7306763">,</span>&nbsp;<span class="ident" id="7306765">expectedSig</span><span class="op" id="7306776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306779">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7306782">if</span>&nbsp;<span class="ident" id="7306785">err</span>&nbsp;<span class="op" id="7306789">:=</span>&nbsp;<span class="ident" id="7306792">VerifyPKCS1v15</span><span class="op" id="7306806">(</span><span class="op" id="7306807">&amp;</span><span class="ident" id="7306808">rsaPrivateKey</span><span class="op" id="7306821">.</span><span class="ident" id="7306822">PublicKey</span><span class="op" id="7306831">,</span>&nbsp;<span class="ident" id="7306833">crypto</span><span class="op" id="7306839">.</span><span class="ident" id="7306840">Hash</span><span class="op" id="7306844">(</span><span class="num" id="7306845">0</span><span class="op" id="7306846">)</span><span class="op" id="7306847">,</span>&nbsp;<span class="ident" id="7306849">msg</span><span class="op" id="7306852">,</span>&nbsp;<span class="ident" id="7306854">sig</span><span class="op" id="7306857">)</span><span class="op" id="7306858">;</span>&nbsp;<span class="ident" id="7306860">err</span>&nbsp;<span class="op" id="7306864">!=</span>&nbsp;<span class="builtintype" id="7306867">nil</span>&nbsp;<span class="op" id="7306871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306875">t</span><span class="op" id="7306876">.</span><span class="ident" id="7306877">Fatalf</span><span class="op" id="7306883">(</span><span class="string" id="7306884">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="7306916">,</span>&nbsp;<span class="ident" id="7306918">err</span><span class="op" id="7306921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306924">}</span><br>
<span class="lineno"></span><span class="op" id="7306926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="7306929">func</span>&nbsp;<span class="ident" id="7306934">TestShortSessionKey</span><span class="op" id="7306953">(</span><span class="ident" id="7306954">t</span>&nbsp;<span class="op" id="7306956">*</span><span class="ident" id="7306957">testing</span><span class="op" id="7306964">.</span><span class="ident" id="7306965">T</span><span class="op" id="7306966">)</span>&nbsp;<span class="op" id="7306968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7306971">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7307037">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7307103">ciphertext</span><span class="op" id="7307113">,</span>&nbsp;<span class="ident" id="7307115">err</span>&nbsp;<span class="op" id="7307119">:=</span>&nbsp;<span class="ident" id="7307122">EncryptPKCS1v15</span><span class="op" id="7307137">(</span><span class="ident" id="7307138">rand</span><span class="op" id="7307142">.</span><span class="ident" id="7307143">Reader</span><span class="op" id="7307149">,</span>&nbsp;<span class="op" id="7307151">&amp;</span><span class="ident" id="7307152">rsaPrivateKey</span><span class="op" id="7307165">.</span><span class="ident" id="7307166">PublicKey</span><span class="op" id="7307175">,</span>&nbsp;<span class="op" id="7307177">[</span><span class="op" id="7307178">]</span><span class="builtintype" id="7307179">byte</span><span class="op" id="7307183">{</span><span class="num" id="7307184">1</span><span class="op" id="7307185">}</span><span class="op" id="7307186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307189">if</span>&nbsp;<span class="ident" id="7307192">err</span>&nbsp;<span class="op" id="7307196">!=</span>&nbsp;<span class="builtintype" id="7307199">nil</span>&nbsp;<span class="op" id="7307203">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7307207">t</span><span class="op" id="7307208">.</span><span class="ident" id="7307209">Fatalf</span><span class="op" id="7307215">(</span><span class="string" id="7307216">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7307253">,</span>&nbsp;<span class="ident" id="7307255">err</span><span class="op" id="7307258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307265">var</span>&nbsp;<span class="ident" id="7307269">key</span>&nbsp;<span class="op" id="7307273">[</span><span class="num" id="7307274">32</span><span class="op" id="7307276">]</span><span class="builtintype" id="7307277">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307283">if</span>&nbsp;<span class="ident" id="7307286">err</span>&nbsp;<span class="op" id="7307290">:=</span>&nbsp;<span class="ident" id="7307293">DecryptPKCS1v15SessionKey</span><span class="op" id="7307318">(</span><span class="builtintype" id="7307319">nil</span><span class="op" id="7307322">,</span>&nbsp;<span class="ident" id="7307324">rsaPrivateKey</span><span class="op" id="7307337">,</span>&nbsp;<span class="ident" id="7307339">ciphertext</span><span class="op" id="7307349">,</span>&nbsp;<span class="ident" id="7307351">key</span><span class="op" id="7307354">[</span><span class="op" id="7307355">:</span><span class="op" id="7307356">]</span><span class="op" id="7307357">)</span><span class="op" id="7307358">;</span>&nbsp;<span class="ident" id="7307360">err</span>&nbsp;<span class="op" id="7307364">!=</span>&nbsp;<span class="builtintype" id="7307367">nil</span>&nbsp;<span class="op" id="7307371">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7307375">t</span><span class="op" id="7307376">.</span><span class="ident" id="7307377">Fatalf</span><span class="op" id="7307383">(</span><span class="string" id="7307384">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7307421">,</span>&nbsp;<span class="ident" id="7307423">err</span><span class="op" id="7307426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307433">for</span>&nbsp;<span class="ident" id="7307437">_</span><span class="op" id="7307438">,</span>&nbsp;<span class="ident" id="7307440">v</span>&nbsp;<span class="op" id="7307442">:=</span>&nbsp;<span class="keyword" id="7307445">range</span>&nbsp;<span class="ident" id="7307451">key</span>&nbsp;<span class="op" id="7307455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307459">if</span>&nbsp;<span class="ident" id="7307462">v</span>&nbsp;<span class="op" id="7307464">!=</span>&nbsp;<span class="num" id="7307467">0</span>&nbsp;<span class="op" id="7307469">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7307474">t</span><span class="op" id="7307475">.</span><span class="ident" id="7307476">Fatal</span><span class="op" id="7307481">(</span><span class="string" id="7307482">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="7307528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307535">}</span><br>
<span class="lineno"></span><span class="op" id="7307537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="7307540">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="7307619">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="7307654">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="7307722">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="7307790">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="7307858">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="7307926">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="7307994">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="7308062">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="7308106">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7308140">var</span>&nbsp;<span class="ident" id="7308144">rsaPrivateKey</span>&nbsp;<span class="op" id="7308158">=</span>&nbsp;<span class="op" id="7308160">&amp;</span><span class="ident" id="7308161">PrivateKey</span><span class="op" id="7308171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308174">PublicKey</span><span class="op" id="7308183">:</span>&nbsp;<span class="ident" id="7308185">PublicKey</span><span class="op" id="7308194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308198">N</span><span class="op" id="7308199">:</span>&nbsp;<span class="ident" id="7308201">fromBase10</span><span class="op" id="7308211">(</span><span class="string" id="7308212">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7308368">)</span><span class="op" id="7308369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308373">E</span><span class="op" id="7308374">:</span>&nbsp;<span class="num" id="7308376">65537</span><span class="op" id="7308381">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7308384">}</span><span class="op" id="7308385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308388">D</span><span class="op" id="7308389">:</span>&nbsp;<span class="ident" id="7308391">fromBase10</span><span class="op" id="7308401">(</span><span class="string" id="7308402">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7308558">)</span><span class="op" id="7308559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308562">Primes</span><span class="op" id="7308568">:</span>&nbsp;<span class="op" id="7308570">[</span><span class="op" id="7308571">]</span><span class="op" id="7308572">*</span><span class="ident" id="7308573">big</span><span class="op" id="7308576">.</span><span class="ident" id="7308577">Int</span><span class="op" id="7308580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308584">fromBase10</span><span class="op" id="7308594">(</span><span class="string" id="7308595">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7308674">)</span><span class="op" id="7308675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7308679">fromBase10</span><span class="op" id="7308689">(</span><span class="string" id="7308690">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7308769">)</span><span class="op" id="7308770">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7308773">}</span><span class="op" id="7308774">,</span><br>
<span class="lineno"></span><span class="op" id="7308776">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
