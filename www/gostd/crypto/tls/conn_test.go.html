<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6555667">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6555722">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6555776">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6555827">package</span>&nbsp;<span class="ident" id="6555835">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555840">import</span>&nbsp;<span class="op" id="6555847">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6555850">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6555860">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6555863">func</span>&nbsp;<span class="ident" id="6555868">TestRoundUp</span><span class="op" id="6555879">(</span><span class="ident" id="6555880">t</span>&nbsp;<span class="op" id="6555882">*</span><span class="ident" id="6555883">testing</span><span class="op" id="6555890">.</span><span class="ident" id="6555891">T</span><span class="op" id="6555892">)</span>&nbsp;<span class="op" id="6555894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6555897">if</span>&nbsp;<span class="ident" id="6555900">roundUp</span><span class="op" id="6555907">(</span><span class="num" id="6555908">0</span><span class="op" id="6555909">,</span>&nbsp;<span class="num" id="6555911">16</span><span class="op" id="6555913">)</span>&nbsp;<span class="op" id="6555915">!=</span>&nbsp;<span class="num" id="6555918">0</span>&nbsp;<span class="op" id="6555920">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555925">roundUp</span><span class="op" id="6555932">(</span><span class="num" id="6555933">1</span><span class="op" id="6555934">,</span>&nbsp;<span class="num" id="6555936">16</span><span class="op" id="6555938">)</span>&nbsp;<span class="op" id="6555940">!=</span>&nbsp;<span class="num" id="6555943">16</span>&nbsp;<span class="op" id="6555946">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555951">roundUp</span><span class="op" id="6555958">(</span><span class="num" id="6555959">15</span><span class="op" id="6555961">,</span>&nbsp;<span class="num" id="6555963">16</span><span class="op" id="6555965">)</span>&nbsp;<span class="op" id="6555967">!=</span>&nbsp;<span class="num" id="6555970">16</span>&nbsp;<span class="op" id="6555973">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555978">roundUp</span><span class="op" id="6555985">(</span><span class="num" id="6555986">16</span><span class="op" id="6555988">,</span>&nbsp;<span class="num" id="6555990">16</span><span class="op" id="6555992">)</span>&nbsp;<span class="op" id="6555994">!=</span>&nbsp;<span class="num" id="6555997">16</span>&nbsp;<span class="op" id="6556000">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556005">roundUp</span><span class="op" id="6556012">(</span><span class="num" id="6556013">17</span><span class="op" id="6556015">,</span>&nbsp;<span class="num" id="6556017">16</span><span class="op" id="6556019">)</span>&nbsp;<span class="op" id="6556021">!=</span>&nbsp;<span class="num" id="6556024">32</span>&nbsp;<span class="op" id="6556027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556031">t</span><span class="op" id="6556032">.</span><span class="ident" id="6556033">Error</span><span class="op" id="6556038">(</span><span class="string" id="6556039">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="6556055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556058">}</span><br>
<span class="lineno"></span><span class="op" id="6556060">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6556063">var</span>&nbsp;<span class="ident" id="6556067">paddingTests</span>&nbsp;<span class="op" id="6556080">=</span>&nbsp;<span class="op" id="6556082">[</span><span class="op" id="6556083">]</span><span class="keyword" id="6556084">struct</span>&nbsp;<span class="op" id="6556091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556094">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556106">[</span><span class="op" id="6556107">]</span><span class="builtintype" id="6556108">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556114">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6556126">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556132">expectedLen</span>&nbsp;<span class="builtintype" id="6556144">int</span><br>
<span class="lineno">25</span><span class="op" id="6556148">}</span><span class="op" id="6556149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556152">{</span><span class="op" id="6556153">[</span><span class="op" id="6556154">]</span><span class="builtintype" id="6556155">byte</span><span class="op" id="6556159">{</span><span class="num" id="6556160">1</span><span class="op" id="6556161">,</span>&nbsp;<span class="num" id="6556163">2</span><span class="op" id="6556164">,</span>&nbsp;<span class="num" id="6556166">3</span><span class="op" id="6556167">,</span>&nbsp;<span class="num" id="6556169">4</span><span class="op" id="6556170">,</span>&nbsp;<span class="num" id="6556172">0</span><span class="op" id="6556173">}</span><span class="op" id="6556174">,</span>&nbsp;<span class="builtintype" id="6556176">true</span><span class="op" id="6556180">,</span>&nbsp;<span class="num" id="6556182">4</span><span class="op" id="6556183">}</span><span class="op" id="6556184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556187">{</span><span class="op" id="6556188">[</span><span class="op" id="6556189">]</span><span class="builtintype" id="6556190">byte</span><span class="op" id="6556194">{</span><span class="num" id="6556195">1</span><span class="op" id="6556196">,</span>&nbsp;<span class="num" id="6556198">2</span><span class="op" id="6556199">,</span>&nbsp;<span class="num" id="6556201">3</span><span class="op" id="6556202">,</span>&nbsp;<span class="num" id="6556204">4</span><span class="op" id="6556205">,</span>&nbsp;<span class="num" id="6556207">0</span><span class="op" id="6556208">,</span>&nbsp;<span class="num" id="6556210">1</span><span class="op" id="6556211">}</span><span class="op" id="6556212">,</span>&nbsp;<span class="builtintype" id="6556214">false</span><span class="op" id="6556219">,</span>&nbsp;<span class="num" id="6556221">0</span><span class="op" id="6556222">}</span><span class="op" id="6556223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556226">{</span><span class="op" id="6556227">[</span><span class="op" id="6556228">]</span><span class="builtintype" id="6556229">byte</span><span class="op" id="6556233">{</span><span class="num" id="6556234">1</span><span class="op" id="6556235">,</span>&nbsp;<span class="num" id="6556237">2</span><span class="op" id="6556238">,</span>&nbsp;<span class="num" id="6556240">3</span><span class="op" id="6556241">,</span>&nbsp;<span class="num" id="6556243">4</span><span class="op" id="6556244">,</span>&nbsp;<span class="num" id="6556246">99</span><span class="op" id="6556248">,</span>&nbsp;<span class="num" id="6556250">99</span><span class="op" id="6556252">}</span><span class="op" id="6556253">,</span>&nbsp;<span class="builtintype" id="6556255">false</span><span class="op" id="6556260">,</span>&nbsp;<span class="num" id="6556262">0</span><span class="op" id="6556263">}</span><span class="op" id="6556264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556267">{</span><span class="op" id="6556268">[</span><span class="op" id="6556269">]</span><span class="builtintype" id="6556270">byte</span><span class="op" id="6556274">{</span><span class="num" id="6556275">1</span><span class="op" id="6556276">,</span>&nbsp;<span class="num" id="6556278">2</span><span class="op" id="6556279">,</span>&nbsp;<span class="num" id="6556281">3</span><span class="op" id="6556282">,</span>&nbsp;<span class="num" id="6556284">4</span><span class="op" id="6556285">,</span>&nbsp;<span class="num" id="6556287">1</span><span class="op" id="6556288">,</span>&nbsp;<span class="num" id="6556290">1</span><span class="op" id="6556291">}</span><span class="op" id="6556292">,</span>&nbsp;<span class="builtintype" id="6556294">true</span><span class="op" id="6556298">,</span>&nbsp;<span class="num" id="6556300">4</span><span class="op" id="6556301">}</span><span class="op" id="6556302">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556305">{</span><span class="op" id="6556306">[</span><span class="op" id="6556307">]</span><span class="builtintype" id="6556308">byte</span><span class="op" id="6556312">{</span><span class="num" id="6556313">1</span><span class="op" id="6556314">,</span>&nbsp;<span class="num" id="6556316">2</span><span class="op" id="6556317">,</span>&nbsp;<span class="num" id="6556319">3</span><span class="op" id="6556320">,</span>&nbsp;<span class="num" id="6556322">2</span><span class="op" id="6556323">,</span>&nbsp;<span class="num" id="6556325">2</span><span class="op" id="6556326">,</span>&nbsp;<span class="num" id="6556328">2</span><span class="op" id="6556329">}</span><span class="op" id="6556330">,</span>&nbsp;<span class="builtintype" id="6556332">true</span><span class="op" id="6556336">,</span>&nbsp;<span class="num" id="6556338">3</span><span class="op" id="6556339">}</span><span class="op" id="6556340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556343">{</span><span class="op" id="6556344">[</span><span class="op" id="6556345">]</span><span class="builtintype" id="6556346">byte</span><span class="op" id="6556350">{</span><span class="num" id="6556351">1</span><span class="op" id="6556352">,</span>&nbsp;<span class="num" id="6556354">2</span><span class="op" id="6556355">,</span>&nbsp;<span class="num" id="6556357">3</span><span class="op" id="6556358">,</span>&nbsp;<span class="num" id="6556360">3</span><span class="op" id="6556361">,</span>&nbsp;<span class="num" id="6556363">3</span><span class="op" id="6556364">,</span>&nbsp;<span class="num" id="6556366">3</span><span class="op" id="6556367">}</span><span class="op" id="6556368">,</span>&nbsp;<span class="builtintype" id="6556370">true</span><span class="op" id="6556374">,</span>&nbsp;<span class="num" id="6556376">2</span><span class="op" id="6556377">}</span><span class="op" id="6556378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556381">{</span><span class="op" id="6556382">[</span><span class="op" id="6556383">]</span><span class="builtintype" id="6556384">byte</span><span class="op" id="6556388">{</span><span class="num" id="6556389">1</span><span class="op" id="6556390">,</span>&nbsp;<span class="num" id="6556392">2</span><span class="op" id="6556393">,</span>&nbsp;<span class="num" id="6556395">3</span><span class="op" id="6556396">,</span>&nbsp;<span class="num" id="6556398">4</span><span class="op" id="6556399">,</span>&nbsp;<span class="num" id="6556401">3</span><span class="op" id="6556402">,</span>&nbsp;<span class="num" id="6556404">3</span><span class="op" id="6556405">}</span><span class="op" id="6556406">,</span>&nbsp;<span class="builtintype" id="6556408">false</span><span class="op" id="6556413">,</span>&nbsp;<span class="num" id="6556415">0</span><span class="op" id="6556416">}</span><span class="op" id="6556417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556420">{</span><span class="op" id="6556421">[</span><span class="op" id="6556422">]</span><span class="builtintype" id="6556423">byte</span><span class="op" id="6556427">{</span><span class="num" id="6556428">1</span><span class="op" id="6556429">,</span>&nbsp;<span class="num" id="6556431">4</span><span class="op" id="6556432">,</span>&nbsp;<span class="num" id="6556434">4</span><span class="op" id="6556435">,</span>&nbsp;<span class="num" id="6556437">4</span><span class="op" id="6556438">,</span>&nbsp;<span class="num" id="6556440">4</span><span class="op" id="6556441">,</span>&nbsp;<span class="num" id="6556443">4</span><span class="op" id="6556444">}</span><span class="op" id="6556445">,</span>&nbsp;<span class="builtintype" id="6556447">true</span><span class="op" id="6556451">,</span>&nbsp;<span class="num" id="6556453">1</span><span class="op" id="6556454">}</span><span class="op" id="6556455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556458">{</span><span class="op" id="6556459">[</span><span class="op" id="6556460">]</span><span class="builtintype" id="6556461">byte</span><span class="op" id="6556465">{</span><span class="num" id="6556466">5</span><span class="op" id="6556467">,</span>&nbsp;<span class="num" id="6556469">5</span><span class="op" id="6556470">,</span>&nbsp;<span class="num" id="6556472">5</span><span class="op" id="6556473">,</span>&nbsp;<span class="num" id="6556475">5</span><span class="op" id="6556476">,</span>&nbsp;<span class="num" id="6556478">5</span><span class="op" id="6556479">,</span>&nbsp;<span class="num" id="6556481">5</span><span class="op" id="6556482">}</span><span class="op" id="6556483">,</span>&nbsp;<span class="builtintype" id="6556485">true</span><span class="op" id="6556489">,</span>&nbsp;<span class="num" id="6556491">0</span><span class="op" id="6556492">}</span><span class="op" id="6556493">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556496">{</span><span class="op" id="6556497">[</span><span class="op" id="6556498">]</span><span class="builtintype" id="6556499">byte</span><span class="op" id="6556503">{</span><span class="num" id="6556504">6</span><span class="op" id="6556505">,</span>&nbsp;<span class="num" id="6556507">6</span><span class="op" id="6556508">,</span>&nbsp;<span class="num" id="6556510">6</span><span class="op" id="6556511">,</span>&nbsp;<span class="num" id="6556513">6</span><span class="op" id="6556514">,</span>&nbsp;<span class="num" id="6556516">6</span><span class="op" id="6556517">,</span>&nbsp;<span class="num" id="6556519">6</span><span class="op" id="6556520">}</span><span class="op" id="6556521">,</span>&nbsp;<span class="builtintype" id="6556523">false</span><span class="op" id="6556528">,</span>&nbsp;<span class="num" id="6556530">0</span><span class="op" id="6556531">}</span><span class="op" id="6556532">,</span><br>
<span class="lineno"></span><span class="op" id="6556534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6556537">func</span>&nbsp;<span class="ident" id="6556542">TestRemovePadding</span><span class="op" id="6556559">(</span><span class="ident" id="6556560">t</span>&nbsp;<span class="op" id="6556562">*</span><span class="ident" id="6556563">testing</span><span class="op" id="6556570">.</span><span class="ident" id="6556571">T</span><span class="op" id="6556572">)</span>&nbsp;<span class="op" id="6556574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556577">for</span>&nbsp;<span class="ident" id="6556581">i</span><span class="op" id="6556582">,</span>&nbsp;<span class="ident" id="6556584">test</span>&nbsp;<span class="op" id="6556589">:=</span>&nbsp;<span class="keyword" id="6556592">range</span>&nbsp;<span class="ident" id="6556598">paddingTests</span>&nbsp;<span class="op" id="6556611">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556615">payload</span><span class="op" id="6556622">,</span>&nbsp;<span class="ident" id="6556624">good</span>&nbsp;<span class="op" id="6556629">:=</span>&nbsp;<span class="ident" id="6556632">removePadding</span><span class="op" id="6556645">(</span><span class="ident" id="6556646">test</span><span class="op" id="6556650">.</span><span class="ident" id="6556651">in</span><span class="op" id="6556653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556657">expectedGood</span>&nbsp;<span class="op" id="6556670">:=</span>&nbsp;<span class="builtintype" id="6556673">byte</span><span class="op" id="6556677">(</span><span class="num" id="6556678">255</span><span class="op" id="6556681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556685">if</span>&nbsp;<span class="op" id="6556688">!</span><span class="ident" id="6556689">test</span><span class="op" id="6556693">.</span><span class="ident" id="6556694">good</span>&nbsp;<span class="op" id="6556699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556704">expectedGood</span>&nbsp;<span class="op" id="6556717">=</span>&nbsp;<span class="num" id="6556719">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556723">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556727">if</span>&nbsp;<span class="ident" id="6556730">good</span>&nbsp;<span class="op" id="6556735">!=</span>&nbsp;<span class="ident" id="6556738">expectedGood</span>&nbsp;<span class="op" id="6556751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556756">t</span><span class="op" id="6556757">.</span><span class="ident" id="6556758">Errorf</span><span class="op" id="6556764">(</span><span class="string" id="6556765">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="6556802">,</span>&nbsp;<span class="ident" id="6556804">i</span><span class="op" id="6556805">,</span>&nbsp;<span class="ident" id="6556807">expectedGood</span><span class="op" id="6556819">,</span>&nbsp;<span class="ident" id="6556821">good</span><span class="op" id="6556825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556833">if</span>&nbsp;<span class="ident" id="6556836">good</span>&nbsp;<span class="op" id="6556841">==</span>&nbsp;<span class="num" id="6556844">255</span>&nbsp;<span class="op" id="6556848">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6556851">len</span><span class="op" id="6556854">(</span><span class="ident" id="6556855">payload</span><span class="op" id="6556862">)</span>&nbsp;<span class="op" id="6556864">!=</span>&nbsp;<span class="ident" id="6556867">test</span><span class="op" id="6556871">.</span><span class="ident" id="6556872">expectedLen</span>&nbsp;<span class="op" id="6556884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556889">t</span><span class="op" id="6556890">.</span><span class="ident" id="6556891">Errorf</span><span class="op" id="6556897">(</span><span class="string" id="6556898">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6556920">,</span>&nbsp;<span class="ident" id="6556922">i</span><span class="op" id="6556923">,</span>&nbsp;<span class="builtinfunc" id="6556925">len</span><span class="op" id="6556928">(</span><span class="ident" id="6556929">payload</span><span class="op" id="6556936">)</span><span class="op" id="6556937">,</span>&nbsp;<span class="ident" id="6556939">test</span><span class="op" id="6556943">.</span><span class="ident" id="6556944">expectedLen</span><span class="op" id="6556955">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556962">}</span><br>
<span class="lineno"></span><span class="op" id="6556964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6556967">var</span>&nbsp;<span class="ident" id="6556971">certExampleCom</span>&nbsp;<span class="op" id="6556986">=</span>&nbsp;<span class="string" id="6556988">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6557640">var</span>&nbsp;<span class="ident" id="6557644">certWildcardExampleCom</span>&nbsp;<span class="op" id="6557667">=</span>&nbsp;<span class="string" id="6557669">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558325">var</span>&nbsp;<span class="ident" id="6558329">certFooExampleCom</span>&nbsp;<span class="op" id="6558347">=</span>&nbsp;<span class="string" id="6558349">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="6559009">var</span>&nbsp;<span class="ident" id="6559013">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="6559042">=</span>&nbsp;<span class="string" id="6559044">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6559704">func</span>&nbsp;<span class="ident" id="6559709">TestCertificateSelection</span><span class="op" id="6559733">(</span><span class="ident" id="6559734">t</span>&nbsp;<span class="op" id="6559736">*</span><span class="ident" id="6559737">testing</span><span class="op" id="6559744">.</span><span class="ident" id="6559745">T</span><span class="op" id="6559746">)</span>&nbsp;<span class="op" id="6559748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559751">config</span>&nbsp;<span class="op" id="6559758">:=</span>&nbsp;<span class="ident" id="6559761">Config</span><span class="op" id="6559767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559771">Certificates</span><span class="op" id="6559783">:</span>&nbsp;<span class="op" id="6559785">[</span><span class="op" id="6559786">]</span><span class="ident" id="6559787">Certificate</span><span class="op" id="6559798">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559809">Certificate</span><span class="op" id="6559820">:</span>&nbsp;<span class="op" id="6559822">[</span><span class="op" id="6559823">]</span><span class="op" id="6559824">[</span><span class="op" id="6559825">]</span><span class="builtintype" id="6559826">byte</span><span class="op" id="6559830">{</span><span class="ident" id="6559831">fromHex</span><span class="op" id="6559838">(</span><span class="ident" id="6559839">certExampleCom</span><span class="op" id="6559853">)</span><span class="op" id="6559854">}</span><span class="op" id="6559855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559860">}</span><span class="op" id="6559861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559872">Certificate</span><span class="op" id="6559883">:</span>&nbsp;<span class="op" id="6559885">[</span><span class="op" id="6559886">]</span><span class="op" id="6559887">[</span><span class="op" id="6559888">]</span><span class="builtintype" id="6559889">byte</span><span class="op" id="6559893">{</span><span class="ident" id="6559894">fromHex</span><span class="op" id="6559901">(</span><span class="ident" id="6559902">certWildcardExampleCom</span><span class="op" id="6559924">)</span><span class="op" id="6559925">}</span><span class="op" id="6559926">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559931">}</span><span class="op" id="6559932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559943">Certificate</span><span class="op" id="6559954">:</span>&nbsp;<span class="op" id="6559956">[</span><span class="op" id="6559957">]</span><span class="op" id="6559958">[</span><span class="op" id="6559959">]</span><span class="builtintype" id="6559960">byte</span><span class="op" id="6559964">{</span><span class="ident" id="6559965">fromHex</span><span class="op" id="6559972">(</span><span class="ident" id="6559973">certFooExampleCom</span><span class="op" id="6559990">)</span><span class="op" id="6559991">}</span><span class="op" id="6559992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559997">}</span><span class="op" id="6559998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560003">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560009">Certificate</span><span class="op" id="6560020">:</span>&nbsp;<span class="op" id="6560022">[</span><span class="op" id="6560023">]</span><span class="op" id="6560024">[</span><span class="op" id="6560025">]</span><span class="builtintype" id="6560026">byte</span><span class="op" id="6560030">{</span><span class="ident" id="6560031">fromHex</span><span class="op" id="6560038">(</span><span class="ident" id="6560039">certDoubleWildcardExampleCom</span><span class="op" id="6560067">)</span><span class="op" id="6560068">}</span><span class="op" id="6560069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560074">}</span><span class="op" id="6560075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560079">}</span><span class="op" id="6560080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560087">config</span><span class="op" id="6560093">.</span><span class="ident" id="6560094">BuildNameToCertificate</span><span class="op" id="6560116">(</span><span class="op" id="6560117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560121">pointerToIndex</span>&nbsp;<span class="op" id="6560136">:=</span>&nbsp;<span class="keyword" id="6560139">func</span><span class="op" id="6560143">(</span><span class="ident" id="6560144">c</span>&nbsp;<span class="op" id="6560146">*</span><span class="ident" id="6560147">Certificate</span><span class="op" id="6560158">)</span>&nbsp;<span class="builtintype" id="6560160">int</span>&nbsp;<span class="op" id="6560164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560168">for</span>&nbsp;<span class="ident" id="6560172">i</span>&nbsp;<span class="op" id="6560174">:=</span>&nbsp;<span class="keyword" id="6560177">range</span>&nbsp;<span class="ident" id="6560183">config</span><span class="op" id="6560189">.</span><span class="ident" id="6560190">Certificates</span>&nbsp;<span class="op" id="6560203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560208">if</span>&nbsp;<span class="ident" id="6560211">c</span>&nbsp;<span class="op" id="6560213">==</span>&nbsp;<span class="op" id="6560216">&amp;</span><span class="ident" id="6560217">config</span><span class="op" id="6560223">.</span><span class="ident" id="6560224">Certificates</span><span class="op" id="6560236">[</span><span class="ident" id="6560237">i</span><span class="op" id="6560238">]</span>&nbsp;<span class="op" id="6560240">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560246">return</span>&nbsp;<span class="ident" id="6560253">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560266">return</span>&nbsp;<span class="op" id="6560273">-</span><span class="num" id="6560274">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560277">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560281">certificateForName</span>&nbsp;<span class="op" id="6560300">:=</span>&nbsp;<span class="keyword" id="6560303">func</span><span class="op" id="6560307">(</span><span class="ident" id="6560308">name</span>&nbsp;<span class="builtintype" id="6560313">string</span><span class="op" id="6560319">)</span>&nbsp;<span class="op" id="6560321">*</span><span class="ident" id="6560322">Certificate</span>&nbsp;<span class="op" id="6560334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560338">clientHello</span>&nbsp;<span class="op" id="6560350">:=</span>&nbsp;<span class="op" id="6560353">&amp;</span><span class="ident" id="6560354">ClientHelloInfo</span><span class="op" id="6560369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560374">ServerName</span><span class="op" id="6560384">:</span>&nbsp;<span class="ident" id="6560386">name</span><span class="op" id="6560390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560394">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560398">if</span>&nbsp;<span class="ident" id="6560401">cert</span><span class="op" id="6560405">,</span>&nbsp;<span class="ident" id="6560407">err</span>&nbsp;<span class="op" id="6560411">:=</span>&nbsp;<span class="ident" id="6560414">config</span><span class="op" id="6560420">.</span><span class="ident" id="6560421">getCertificate</span><span class="op" id="6560435">(</span><span class="ident" id="6560436">clientHello</span><span class="op" id="6560447">)</span><span class="op" id="6560448">;</span>&nbsp;<span class="ident" id="6560450">err</span>&nbsp;<span class="op" id="6560454">!=</span>&nbsp;<span class="builtintype" id="6560457">nil</span>&nbsp;<span class="op" id="6560461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560466">t</span><span class="op" id="6560467">.</span><span class="ident" id="6560468">Errorf</span><span class="op" id="6560474">(</span><span class="string" id="6560475">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="6560520">,</span>&nbsp;<span class="ident" id="6560522">name</span><span class="op" id="6560526">,</span>&nbsp;<span class="ident" id="6560528">err</span><span class="op" id="6560531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560536">return</span>&nbsp;<span class="builtintype" id="6560543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560549">}</span>&nbsp;<span class="keyword" id="6560551">else</span>&nbsp;<span class="op" id="6560556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560561">return</span>&nbsp;<span class="ident" id="6560568">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560582">if</span>&nbsp;<span class="ident" id="6560585">n</span>&nbsp;<span class="op" id="6560587">:=</span>&nbsp;<span class="ident" id="6560590">pointerToIndex</span><span class="op" id="6560604">(</span><span class="ident" id="6560605">certificateForName</span><span class="op" id="6560623">(</span><span class="string" id="6560624">&#34;example.com&#34;</span><span class="op" id="6560637">)</span><span class="op" id="6560638">)</span><span class="op" id="6560639">;</span>&nbsp;<span class="ident" id="6560641">n</span>&nbsp;<span class="op" id="6560643">!=</span>&nbsp;<span class="num" id="6560646">0</span>&nbsp;<span class="op" id="6560648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560652">t</span><span class="op" id="6560653">.</span><span class="ident" id="6560654">Errorf</span><span class="op" id="6560660">(</span><span class="string" id="6560661">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6560705">,</span>&nbsp;<span class="ident" id="6560707">n</span><span class="op" id="6560708">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560714">if</span>&nbsp;<span class="ident" id="6560717">n</span>&nbsp;<span class="op" id="6560719">:=</span>&nbsp;<span class="ident" id="6560722">pointerToIndex</span><span class="op" id="6560736">(</span><span class="ident" id="6560737">certificateForName</span><span class="op" id="6560755">(</span><span class="string" id="6560756">&#34;bar.example.com&#34;</span><span class="op" id="6560773">)</span><span class="op" id="6560774">)</span><span class="op" id="6560775">;</span>&nbsp;<span class="ident" id="6560777">n</span>&nbsp;<span class="op" id="6560779">!=</span>&nbsp;<span class="num" id="6560782">1</span>&nbsp;<span class="op" id="6560784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560788">t</span><span class="op" id="6560789">.</span><span class="ident" id="6560790">Errorf</span><span class="op" id="6560796">(</span><span class="string" id="6560797">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="6560845">,</span>&nbsp;<span class="ident" id="6560847">n</span><span class="op" id="6560848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560854">if</span>&nbsp;<span class="ident" id="6560857">n</span>&nbsp;<span class="op" id="6560859">:=</span>&nbsp;<span class="ident" id="6560862">pointerToIndex</span><span class="op" id="6560876">(</span><span class="ident" id="6560877">certificateForName</span><span class="op" id="6560895">(</span><span class="string" id="6560896">&#34;foo.example.com&#34;</span><span class="op" id="6560913">)</span><span class="op" id="6560914">)</span><span class="op" id="6560915">;</span>&nbsp;<span class="ident" id="6560917">n</span>&nbsp;<span class="op" id="6560919">!=</span>&nbsp;<span class="num" id="6560922">2</span>&nbsp;<span class="op" id="6560924">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560928">t</span><span class="op" id="6560929">.</span><span class="ident" id="6560930">Errorf</span><span class="op" id="6560936">(</span><span class="string" id="6560937">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="6560985">,</span>&nbsp;<span class="ident" id="6560987">n</span><span class="op" id="6560988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560994">if</span>&nbsp;<span class="ident" id="6560997">n</span>&nbsp;<span class="op" id="6560999">:=</span>&nbsp;<span class="ident" id="6561002">pointerToIndex</span><span class="op" id="6561016">(</span><span class="ident" id="6561017">certificateForName</span><span class="op" id="6561035">(</span><span class="string" id="6561036">&#34;foo.bar.example.com&#34;</span><span class="op" id="6561057">)</span><span class="op" id="6561058">)</span><span class="op" id="6561059">;</span>&nbsp;<span class="ident" id="6561061">n</span>&nbsp;<span class="op" id="6561063">!=</span>&nbsp;<span class="num" id="6561066">3</span>&nbsp;<span class="op" id="6561068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561072">t</span><span class="op" id="6561073">.</span><span class="ident" id="6561074">Errorf</span><span class="op" id="6561080">(</span><span class="string" id="6561081">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="6561133">,</span>&nbsp;<span class="ident" id="6561135">n</span><span class="op" id="6561136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561139">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561142">if</span>&nbsp;<span class="ident" id="6561145">n</span>&nbsp;<span class="op" id="6561147">:=</span>&nbsp;<span class="ident" id="6561150">pointerToIndex</span><span class="op" id="6561164">(</span><span class="ident" id="6561165">certificateForName</span><span class="op" id="6561183">(</span><span class="string" id="6561184">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="6561209">)</span><span class="op" id="6561210">)</span><span class="op" id="6561211">;</span>&nbsp;<span class="ident" id="6561213">n</span>&nbsp;<span class="op" id="6561215">!=</span>&nbsp;<span class="num" id="6561218">0</span>&nbsp;<span class="op" id="6561220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561224">t</span><span class="op" id="6561225">.</span><span class="ident" id="6561226">Errorf</span><span class="op" id="6561232">(</span><span class="string" id="6561233">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6561289">,</span>&nbsp;<span class="ident" id="6561291">n</span><span class="op" id="6561292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561295">}</span><br>
<span class="lineno"></span><span class="op" id="6561297">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
