<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2598331">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2598386">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2598440">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2598491">package</span>&nbsp;<span class="ident" id="2598499">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2598505">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2598572">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2598639">func</span>&nbsp;<span class="ident" id="2598644">Sleep</span><span class="op" id="2598649">(</span><span class="ident" id="2598650">d</span>&nbsp;<span class="ident" id="2598652">Duration</span><span class="op" id="2598660">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2598663">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2598741">func</span>&nbsp;<span class="ident" id="2598746">runtimeNano</span><span class="op" id="2598757">(</span><span class="op" id="2598758">)</span>&nbsp;<span class="ident" id="2598760">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2598767">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2598822">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2598883">type</span>&nbsp;<span class="ident" id="2598888">runtimeTimer</span>&nbsp;<span class="keyword" id="2598901">struct</span>&nbsp;<span class="op" id="2598908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598911">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2598918">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598923">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2598930">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598937">period</span>&nbsp;<span class="ident" id="2598944">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598951">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2598958">func</span><span class="op" id="2598962">(</span><span class="keyword" id="2598963">interface</span><span class="op" id="2598972">{</span><span class="op" id="2598973">}</span><span class="op" id="2598974">,</span>&nbsp;<span class="builtintype" id="2598976">uintptr</span><span class="op" id="2598983">)</span>&nbsp;<span class="comment" id="2598985">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599015">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2599022">interface</span><span class="op" id="2599031">{</span><span class="op" id="2599032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599035">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2599042">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2599050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2599053">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2599130">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2599209">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2599287">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2599341">func</span>&nbsp;<span class="ident" id="2599346">when</span><span class="op" id="2599350">(</span><span class="ident" id="2599351">d</span>&nbsp;<span class="ident" id="2599353">Duration</span><span class="op" id="2599361">)</span>&nbsp;<span class="ident" id="2599363">int64</span>&nbsp;<span class="op" id="2599369">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599372">if</span>&nbsp;<span class="ident" id="2599375">d</span>&nbsp;<span class="op" id="2599377">&lt;=</span>&nbsp;<span class="num" id="2599380">0</span>&nbsp;<span class="op" id="2599382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599386">return</span>&nbsp;<span class="ident" id="2599393">runtimeNano</span><span class="op" id="2599404">(</span><span class="op" id="2599405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599411">t</span>&nbsp;<span class="op" id="2599413">:=</span>&nbsp;<span class="ident" id="2599416">runtimeNano</span><span class="op" id="2599427">(</span><span class="op" id="2599428">)</span>&nbsp;<span class="op" id="2599430">+</span>&nbsp;<span class="ident" id="2599432">int64</span><span class="op" id="2599437">(</span><span class="ident" id="2599438">d</span><span class="op" id="2599439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599442">if</span>&nbsp;<span class="ident" id="2599445">t</span>&nbsp;<span class="op" id="2599447">&lt;</span>&nbsp;<span class="num" id="2599449">0</span>&nbsp;<span class="op" id="2599451">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599455">t</span>&nbsp;<span class="op" id="2599457">=</span>&nbsp;<span class="num" id="2599459">1</span><span class="op" id="2599460">&lt;&lt;</span><span class="num" id="2599462">63</span>&nbsp;<span class="op" id="2599465">-</span>&nbsp;<span class="num" id="2599467">1</span>&nbsp;<span class="comment" id="2599469">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599490">return</span>&nbsp;<span class="ident" id="2599497">t</span><br>
<span class="lineno"></span><span class="op" id="2599499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2599502">func</span>&nbsp;<span class="ident" id="2599507">startTimer</span><span class="op" id="2599517">(</span><span class="op" id="2599518">*</span><span class="ident" id="2599519">runtimeTimer</span><span class="op" id="2599531">)</span><br>
<span class="lineno"></span><span class="keyword" id="2599533">func</span>&nbsp;<span class="ident" id="2599538">stopTimer</span><span class="op" id="2599547">(</span><span class="op" id="2599548">*</span><span class="ident" id="2599549">runtimeTimer</span><span class="op" id="2599561">)</span>&nbsp;<span class="builtintype" id="2599563">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2599569">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2599614">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2599677">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2599723">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2599778">type</span>&nbsp;<span class="ident" id="2599783">Timer</span>&nbsp;<span class="keyword" id="2599789">struct</span>&nbsp;<span class="op" id="2599796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599799">C</span>&nbsp;<span class="op" id="2599801">&lt;-</span><span class="keyword" id="2599803">chan</span>&nbsp;<span class="ident" id="2599808">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599814">r</span>&nbsp;<span class="ident" id="2599816">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2599829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2599832">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2599872">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2599951">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2599979">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2600061">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2600077">func</span>&nbsp;<span class="op" id="2600082">(</span><span class="ident" id="2600083">t</span>&nbsp;<span class="op" id="2600085">*</span><span class="ident" id="2600086">Timer</span><span class="op" id="2600091">)</span>&nbsp;<span class="ident" id="2600093">Stop</span><span class="op" id="2600097">(</span><span class="op" id="2600098">)</span>&nbsp;<span class="builtintype" id="2600100">bool</span>&nbsp;<span class="op" id="2600105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600108">if</span>&nbsp;<span class="ident" id="2600111">t</span><span class="op" id="2600112">.</span><span class="ident" id="2600113">r</span><span class="op" id="2600114">.</span><span class="ident" id="2600115">f</span>&nbsp;<span class="op" id="2600117">==</span>&nbsp;<span class="ident" id="2600120">nil</span>&nbsp;<span class="op" id="2600124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2600128">panic</span><span class="op" id="2600133">(</span><span class="string" id="2600134">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2600176">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600182">return</span>&nbsp;<span class="ident" id="2600189">stopTimer</span><span class="op" id="2600198">(</span><span class="op" id="2600199">&amp;</span><span class="ident" id="2600200">t</span><span class="op" id="2600201">.</span><span class="ident" id="2600202">r</span><span class="op" id="2600203">)</span><br>
<span class="lineno"></span><span class="op" id="2600205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2600208">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2600255">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2600317">func</span>&nbsp;<span class="ident" id="2600322">NewTimer</span><span class="op" id="2600330">(</span><span class="ident" id="2600331">d</span>&nbsp;<span class="ident" id="2600333">Duration</span><span class="op" id="2600341">)</span>&nbsp;<span class="op" id="2600343">*</span><span class="ident" id="2600344">Timer</span>&nbsp;<span class="op" id="2600350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600353">c</span>&nbsp;<span class="op" id="2600355">:=</span>&nbsp;<span class="builtinfunc" id="2600358">make</span><span class="op" id="2600362">(</span><span class="keyword" id="2600363">chan</span>&nbsp;<span class="ident" id="2600368">Time</span><span class="op" id="2600372">,</span>&nbsp;<span class="num" id="2600374">1</span><span class="op" id="2600375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600378">t</span>&nbsp;<span class="op" id="2600380">:=</span>&nbsp;<span class="op" id="2600383">&amp;</span><span class="ident" id="2600384">Timer</span><span class="op" id="2600389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600393">C</span><span class="op" id="2600394">:</span>&nbsp;<span class="ident" id="2600396">c</span><span class="op" id="2600397">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600401">r</span><span class="op" id="2600402">:</span>&nbsp;<span class="ident" id="2600404">runtimeTimer</span><span class="op" id="2600416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600421">when</span><span class="op" id="2600425">:</span>&nbsp;<span class="ident" id="2600427">when</span><span class="op" id="2600431">(</span><span class="ident" id="2600432">d</span><span class="op" id="2600433">)</span><span class="op" id="2600434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600439">f</span><span class="op" id="2600440">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2600445">sendTime</span><span class="op" id="2600453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600458">arg</span><span class="op" id="2600461">:</span>&nbsp;&nbsp;<span class="ident" id="2600464">c</span><span class="op" id="2600465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600469">}</span><span class="op" id="2600470">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600476">startTimer</span><span class="op" id="2600486">(</span><span class="op" id="2600487">&amp;</span><span class="ident" id="2600488">t</span><span class="op" id="2600489">.</span><span class="ident" id="2600490">r</span><span class="op" id="2600491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600494">return</span>&nbsp;<span class="ident" id="2600501">t</span><br>
<span class="lineno"></span><span class="op" id="2600503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2600506">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2600561">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2600633">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2600661">func</span>&nbsp;<span class="op" id="2600666">(</span><span class="ident" id="2600667">t</span>&nbsp;<span class="op" id="2600669">*</span><span class="ident" id="2600670">Timer</span><span class="op" id="2600675">)</span>&nbsp;<span class="ident" id="2600677">Reset</span><span class="op" id="2600682">(</span><span class="ident" id="2600683">d</span>&nbsp;<span class="ident" id="2600685">Duration</span><span class="op" id="2600693">)</span>&nbsp;<span class="builtintype" id="2600695">bool</span>&nbsp;<span class="op" id="2600700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600703">if</span>&nbsp;<span class="ident" id="2600706">t</span><span class="op" id="2600707">.</span><span class="ident" id="2600708">r</span><span class="op" id="2600709">.</span><span class="ident" id="2600710">f</span>&nbsp;<span class="op" id="2600712">==</span>&nbsp;<span class="ident" id="2600715">nil</span>&nbsp;<span class="op" id="2600719">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2600723">panic</span><span class="op" id="2600728">(</span><span class="string" id="2600729">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2600772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600778">w</span>&nbsp;<span class="op" id="2600780">:=</span>&nbsp;<span class="ident" id="2600783">when</span><span class="op" id="2600787">(</span><span class="ident" id="2600788">d</span><span class="op" id="2600789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600792">active</span>&nbsp;<span class="op" id="2600799">:=</span>&nbsp;<span class="ident" id="2600802">stopTimer</span><span class="op" id="2600811">(</span><span class="op" id="2600812">&amp;</span><span class="ident" id="2600813">t</span><span class="op" id="2600814">.</span><span class="ident" id="2600815">r</span><span class="op" id="2600816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600819">t</span><span class="op" id="2600820">.</span><span class="ident" id="2600821">r</span><span class="op" id="2600822">.</span><span class="ident" id="2600823">when</span>&nbsp;<span class="op" id="2600828">=</span>&nbsp;<span class="ident" id="2600830">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600833">startTimer</span><span class="op" id="2600843">(</span><span class="op" id="2600844">&amp;</span><span class="ident" id="2600845">t</span><span class="op" id="2600846">.</span><span class="ident" id="2600847">r</span><span class="op" id="2600848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600851">return</span>&nbsp;<span class="ident" id="2600858">active</span><br>
<span class="lineno"></span><span class="op" id="2600865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2600868">func</span>&nbsp;<span class="ident" id="2600873">sendTime</span><span class="op" id="2600881">(</span><span class="ident" id="2600882">c</span>&nbsp;<span class="keyword" id="2600884">interface</span><span class="op" id="2600893">{</span><span class="op" id="2600894">}</span><span class="op" id="2600895">,</span>&nbsp;<span class="ident" id="2600897">seq</span>&nbsp;<span class="builtintype" id="2600901">uintptr</span><span class="op" id="2600908">)</span>&nbsp;<span class="op" id="2600910">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2600913">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2600949">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601004">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601058">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601112">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601148">select</span>&nbsp;<span class="op" id="2601155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601158">case</span>&nbsp;<span class="ident" id="2601163">c</span><span class="op" id="2601164">.</span><span class="op" id="2601165">(</span><span class="keyword" id="2601166">chan</span>&nbsp;<span class="ident" id="2601171">Time</span><span class="op" id="2601175">)</span>&nbsp;<span class="op" id="2601177">&lt;-</span>&nbsp;<span class="ident" id="2601180">Now</span><span class="op" id="2601183">(</span><span class="op" id="2601184">)</span><span class="op" id="2601185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601188">default</span><span class="op" id="2601195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601198">}</span><br>
<span class="lineno"></span><span class="op" id="2601200">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2601203">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2601277">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2601305">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2601343">func</span>&nbsp;<span class="ident" id="2601348">After</span><span class="op" id="2601353">(</span><span class="ident" id="2601354">d</span>&nbsp;<span class="ident" id="2601356">Duration</span><span class="op" id="2601364">)</span>&nbsp;<span class="op" id="2601366">&lt;-</span><span class="keyword" id="2601368">chan</span>&nbsp;<span class="ident" id="2601373">Time</span>&nbsp;<span class="op" id="2601378">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601381">return</span>&nbsp;<span class="ident" id="2601388">NewTimer</span><span class="op" id="2601396">(</span><span class="ident" id="2601397">d</span><span class="op" id="2601398">)</span><span class="op" id="2601399">.</span><span class="ident" id="2601400">C</span><br>
<span class="lineno"></span><span class="op" id="2601402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2601405">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2601468">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2601521">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2601574">func</span>&nbsp;<span class="ident" id="2601579">AfterFunc</span><span class="op" id="2601588">(</span><span class="ident" id="2601589">d</span>&nbsp;<span class="ident" id="2601591">Duration</span><span class="op" id="2601599">,</span>&nbsp;<span class="ident" id="2601601">f</span>&nbsp;<span class="keyword" id="2601603">func</span><span class="op" id="2601607">(</span><span class="op" id="2601608">)</span><span class="op" id="2601609">)</span>&nbsp;<span class="op" id="2601611">*</span><span class="ident" id="2601612">Timer</span>&nbsp;<span class="op" id="2601618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601621">t</span>&nbsp;<span class="op" id="2601623">:=</span>&nbsp;<span class="op" id="2601626">&amp;</span><span class="ident" id="2601627">Timer</span><span class="op" id="2601632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601636">r</span><span class="op" id="2601637">:</span>&nbsp;<span class="ident" id="2601639">runtimeTimer</span><span class="op" id="2601651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601656">when</span><span class="op" id="2601660">:</span>&nbsp;<span class="ident" id="2601662">when</span><span class="op" id="2601666">(</span><span class="ident" id="2601667">d</span><span class="op" id="2601668">)</span><span class="op" id="2601669">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601674">f</span><span class="op" id="2601675">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2601680">goFunc</span><span class="op" id="2601686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601691">arg</span><span class="op" id="2601694">:</span>&nbsp;&nbsp;<span class="ident" id="2601697">f</span><span class="op" id="2601698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601702">}</span><span class="op" id="2601703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601709">startTimer</span><span class="op" id="2601719">(</span><span class="op" id="2601720">&amp;</span><span class="ident" id="2601721">t</span><span class="op" id="2601722">.</span><span class="ident" id="2601723">r</span><span class="op" id="2601724">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601727">return</span>&nbsp;<span class="ident" id="2601734">t</span><br>
<span class="lineno"></span><span class="op" id="2601736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2601739">func</span>&nbsp;<span class="ident" id="2601744">goFunc</span><span class="op" id="2601750">(</span><span class="ident" id="2601751">arg</span>&nbsp;<span class="keyword" id="2601755">interface</span><span class="op" id="2601764">{</span><span class="op" id="2601765">}</span><span class="op" id="2601766">,</span>&nbsp;<span class="ident" id="2601768">seq</span>&nbsp;<span class="builtintype" id="2601772">uintptr</span><span class="op" id="2601779">)</span>&nbsp;<span class="op" id="2601781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601784">go</span>&nbsp;<span class="ident" id="2601787">arg</span><span class="op" id="2601790">.</span><span class="op" id="2601791">(</span><span class="keyword" id="2601792">func</span><span class="op" id="2601796">(</span><span class="op" id="2601797">)</span><span class="op" id="2601798">)</span><span class="op" id="2601799">(</span><span class="op" id="2601800">)</span><br>
<span class="lineno">130</span><span class="op" id="2601802">}</span>
</div>
</body>
</html>
