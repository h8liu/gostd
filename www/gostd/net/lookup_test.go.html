<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html" class="current">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8049851">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8049906">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8049960">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8050011">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="8050075">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8050102">package</span>&nbsp;<span class="ident" id="8050110">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8050115">import</span>&nbsp;<span class="op" id="8050122">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050125">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050133">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050144">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8050154">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8050157">var</span>&nbsp;<span class="ident" id="8050161">testExternal</span>&nbsp;<span class="op" id="8050174">=</span>&nbsp;<span class="ident" id="8050176">flag</span><span class="op" id="8050180">.</span><span class="ident" id="8050181">Bool</span><span class="op" id="8050185">(</span><span class="string" id="8050186">&#34;external&#34;</span><span class="op" id="8050196">,</span>&nbsp;<span class="builtintype" id="8050198">true</span><span class="op" id="8050202">,</span>&nbsp;<span class="string" id="8050204">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="8050253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8050256">var</span>&nbsp;<span class="ident" id="8050260">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="8050281">=</span>&nbsp;<span class="op" id="8050283">[</span><span class="op" id="8050284">]</span><span class="keyword" id="8050285">struct</span>&nbsp;<span class="op" id="8050292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050295">service</span><span class="op" id="8050302">,</span>&nbsp;<span class="ident" id="8050304">proto</span><span class="op" id="8050309">,</span>&nbsp;<span class="ident" id="8050311">name</span>&nbsp;<span class="builtintype" id="8050316">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050324">cname</span><span class="op" id="8050329">,</span>&nbsp;<span class="ident" id="8050331">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8050345">string</span><br>
<span class="lineno"></span><span class="op" id="8050352">}</span><span class="op" id="8050353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050360">&#34;xmpp-server&#34;</span><span class="op" id="8050373">,</span>&nbsp;<span class="string" id="8050375">&#34;tcp&#34;</span><span class="op" id="8050380">,</span>&nbsp;<span class="string" id="8050382">&#34;google.com&#34;</span><span class="op" id="8050394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050398">&#34;.google.com&#34;</span><span class="op" id="8050411">,</span>&nbsp;<span class="string" id="8050413">&#34;.google.com&#34;</span><span class="op" id="8050426">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050429">}</span><span class="op" id="8050430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050437">&#34;&#34;</span><span class="op" id="8050439">,</span>&nbsp;<span class="string" id="8050441">&#34;&#34;</span><span class="op" id="8050443">,</span>&nbsp;<span class="string" id="8050445">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="8050475">,</span>&nbsp;<span class="comment" id="8050477">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8050505">&#34;.google.com&#34;</span><span class="op" id="8050518">,</span>&nbsp;<span class="string" id="8050520">&#34;.google.com&#34;</span><span class="op" id="8050533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050536">}</span><span class="op" id="8050537">,</span><br>
<span class="lineno">30</span><span class="op" id="8050539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8050542">func</span>&nbsp;<span class="ident" id="8050547">TestLookupGoogleSRV</span><span class="op" id="8050566">(</span><span class="ident" id="8050567">t</span>&nbsp;<span class="op" id="8050569">*</span><span class="ident" id="8050570">testing</span><span class="op" id="8050577">.</span><span class="ident" id="8050578">T</span><span class="op" id="8050579">)</span>&nbsp;<span class="op" id="8050581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050584">if</span>&nbsp;<span class="ident" id="8050587">testing</span><span class="op" id="8050594">.</span><span class="ident" id="8050595">Short</span><span class="op" id="8050600">(</span><span class="op" id="8050601">)</span>&nbsp;<span class="op" id="8050603">||</span>&nbsp;<span class="op" id="8050606">!</span><span class="op" id="8050607">*</span><span class="ident" id="8050608">testExternal</span>&nbsp;<span class="op" id="8050621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050625">t</span><span class="op" id="8050626">.</span><span class="ident" id="8050627">Skip</span><span class="op" id="8050631">(</span><span class="string" id="8050632">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8050673">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050680">for</span>&nbsp;<span class="ident" id="8050684">_</span><span class="op" id="8050685">,</span>&nbsp;<span class="ident" id="8050687">tt</span>&nbsp;<span class="op" id="8050690">:=</span>&nbsp;<span class="keyword" id="8050693">range</span>&nbsp;<span class="ident" id="8050699">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="8050720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050724">cname</span><span class="op" id="8050729">,</span>&nbsp;<span class="ident" id="8050731">srvs</span><span class="op" id="8050735">,</span>&nbsp;<span class="ident" id="8050737">err</span>&nbsp;<span class="op" id="8050741">:=</span>&nbsp;<span class="ident" id="8050744">LookupSRV</span><span class="op" id="8050753">(</span><span class="ident" id="8050754">tt</span><span class="op" id="8050756">.</span><span class="ident" id="8050757">service</span><span class="op" id="8050764">,</span>&nbsp;<span class="ident" id="8050766">tt</span><span class="op" id="8050768">.</span><span class="ident" id="8050769">proto</span><span class="op" id="8050774">,</span>&nbsp;<span class="ident" id="8050776">tt</span><span class="op" id="8050778">.</span><span class="ident" id="8050779">name</span><span class="op" id="8050783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050787">if</span>&nbsp;<span class="ident" id="8050790">err</span>&nbsp;<span class="op" id="8050794">!=</span>&nbsp;<span class="ident" id="8050797">nil</span>&nbsp;<span class="op" id="8050801">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050806">t</span><span class="op" id="8050807">.</span><span class="ident" id="8050808">Fatal</span><span class="op" id="8050813">(</span><span class="ident" id="8050814">err</span><span class="op" id="8050817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050825">if</span>&nbsp;<span class="builtinfunc" id="8050828">len</span><span class="op" id="8050831">(</span><span class="ident" id="8050832">srvs</span><span class="op" id="8050836">)</span>&nbsp;<span class="op" id="8050838">==</span>&nbsp;<span class="num" id="8050841">0</span>&nbsp;<span class="op" id="8050843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050848">t</span><span class="op" id="8050849">.</span><span class="ident" id="8050850">Error</span><span class="op" id="8050855">(</span><span class="string" id="8050856">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8050871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050875">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050879">if</span>&nbsp;<span class="op" id="8050882">!</span><span class="ident" id="8050883">strings</span><span class="op" id="8050890">.</span><span class="ident" id="8050891">Contains</span><span class="op" id="8050899">(</span><span class="ident" id="8050900">cname</span><span class="op" id="8050905">,</span>&nbsp;<span class="ident" id="8050907">tt</span><span class="op" id="8050909">.</span><span class="ident" id="8050910">cname</span><span class="op" id="8050915">)</span>&nbsp;<span class="op" id="8050917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8050922">t</span><span class="op" id="8050923">.</span><span class="ident" id="8050924">Errorf</span><span class="op" id="8050930">(</span><span class="string" id="8050931">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8050948">,</span>&nbsp;<span class="ident" id="8050950">cname</span><span class="op" id="8050955">,</span>&nbsp;<span class="ident" id="8050957">tt</span><span class="op" id="8050959">.</span><span class="ident" id="8050960">cname</span><span class="op" id="8050965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8050969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8050973">for</span>&nbsp;<span class="ident" id="8050977">_</span><span class="op" id="8050978">,</span>&nbsp;<span class="ident" id="8050980">srv</span>&nbsp;<span class="op" id="8050984">:=</span>&nbsp;<span class="keyword" id="8050987">range</span>&nbsp;<span class="ident" id="8050993">srvs</span>&nbsp;<span class="op" id="8050998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051003">if</span>&nbsp;<span class="op" id="8051006">!</span><span class="ident" id="8051007">strings</span><span class="op" id="8051014">.</span><span class="ident" id="8051015">Contains</span><span class="op" id="8051023">(</span><span class="ident" id="8051024">srv</span><span class="op" id="8051027">.</span><span class="ident" id="8051028">Target</span><span class="op" id="8051034">,</span>&nbsp;<span class="ident" id="8051036">tt</span><span class="op" id="8051038">.</span><span class="ident" id="8051039">target</span><span class="op" id="8051045">)</span>&nbsp;<span class="op" id="8051047">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051053">t</span><span class="op" id="8051054">.</span><span class="ident" id="8051055">Errorf</span><span class="op" id="8051061">(</span><span class="string" id="8051062">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="8051099">,</span>&nbsp;<span class="ident" id="8051101">srv</span><span class="op" id="8051104">,</span>&nbsp;<span class="ident" id="8051106">tt</span><span class="op" id="8051108">.</span><span class="ident" id="8051109">target</span><span class="op" id="8051115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051127">}</span><br>
<span class="lineno"></span><span class="op" id="8051129">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8051132">func</span>&nbsp;<span class="ident" id="8051137">TestLookupGmailMX</span><span class="op" id="8051154">(</span><span class="ident" id="8051155">t</span>&nbsp;<span class="op" id="8051157">*</span><span class="ident" id="8051158">testing</span><span class="op" id="8051165">.</span><span class="ident" id="8051166">T</span><span class="op" id="8051167">)</span>&nbsp;<span class="op" id="8051169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051172">if</span>&nbsp;<span class="ident" id="8051175">testing</span><span class="op" id="8051182">.</span><span class="ident" id="8051183">Short</span><span class="op" id="8051188">(</span><span class="op" id="8051189">)</span>&nbsp;<span class="op" id="8051191">||</span>&nbsp;<span class="op" id="8051194">!</span><span class="op" id="8051195">*</span><span class="ident" id="8051196">testExternal</span>&nbsp;<span class="op" id="8051209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051213">t</span><span class="op" id="8051214">.</span><span class="ident" id="8051215">Skip</span><span class="op" id="8051219">(</span><span class="string" id="8051220">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8051261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051264">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051268">mxs</span><span class="op" id="8051271">,</span>&nbsp;<span class="ident" id="8051273">err</span>&nbsp;<span class="op" id="8051277">:=</span>&nbsp;<span class="ident" id="8051280">LookupMX</span><span class="op" id="8051288">(</span><span class="string" id="8051289">&#34;gmail.com&#34;</span><span class="op" id="8051300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051303">if</span>&nbsp;<span class="ident" id="8051306">err</span>&nbsp;<span class="op" id="8051310">!=</span>&nbsp;<span class="ident" id="8051313">nil</span>&nbsp;<span class="op" id="8051317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051321">t</span><span class="op" id="8051322">.</span><span class="ident" id="8051323">Fatal</span><span class="op" id="8051328">(</span><span class="ident" id="8051329">err</span><span class="op" id="8051332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051335">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051338">if</span>&nbsp;<span class="builtinfunc" id="8051341">len</span><span class="op" id="8051344">(</span><span class="ident" id="8051345">mxs</span><span class="op" id="8051348">)</span>&nbsp;<span class="op" id="8051350">==</span>&nbsp;<span class="num" id="8051353">0</span>&nbsp;<span class="op" id="8051355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051359">t</span><span class="op" id="8051360">.</span><span class="ident" id="8051361">Error</span><span class="op" id="8051366">(</span><span class="string" id="8051367">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8051382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051388">for</span>&nbsp;<span class="ident" id="8051392">_</span><span class="op" id="8051393">,</span>&nbsp;<span class="ident" id="8051395">mx</span>&nbsp;<span class="op" id="8051398">:=</span>&nbsp;<span class="keyword" id="8051401">range</span>&nbsp;<span class="ident" id="8051407">mxs</span>&nbsp;<span class="op" id="8051411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051415">if</span>&nbsp;<span class="op" id="8051418">!</span><span class="ident" id="8051419">strings</span><span class="op" id="8051426">.</span><span class="ident" id="8051427">Contains</span><span class="op" id="8051435">(</span><span class="ident" id="8051436">mx</span><span class="op" id="8051438">.</span><span class="ident" id="8051439">Host</span><span class="op" id="8051443">,</span>&nbsp;<span class="string" id="8051445">&#34;.google.com&#34;</span><span class="op" id="8051458">)</span>&nbsp;<span class="op" id="8051460">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051465">t</span><span class="op" id="8051466">.</span><span class="ident" id="8051467">Errorf</span><span class="op" id="8051473">(</span><span class="string" id="8051474">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="8051521">,</span>&nbsp;<span class="ident" id="8051523">mx</span><span class="op" id="8051525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051532">}</span><br>
<span class="lineno"></span><span class="op" id="8051534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="8051537">func</span>&nbsp;<span class="ident" id="8051542">TestLookupGmailNS</span><span class="op" id="8051559">(</span><span class="ident" id="8051560">t</span>&nbsp;<span class="op" id="8051562">*</span><span class="ident" id="8051563">testing</span><span class="op" id="8051570">.</span><span class="ident" id="8051571">T</span><span class="op" id="8051572">)</span>&nbsp;<span class="op" id="8051574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051577">if</span>&nbsp;<span class="ident" id="8051580">testing</span><span class="op" id="8051587">.</span><span class="ident" id="8051588">Short</span><span class="op" id="8051593">(</span><span class="op" id="8051594">)</span>&nbsp;<span class="op" id="8051596">||</span>&nbsp;<span class="op" id="8051599">!</span><span class="op" id="8051600">*</span><span class="ident" id="8051601">testExternal</span>&nbsp;<span class="op" id="8051614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051618">t</span><span class="op" id="8051619">.</span><span class="ident" id="8051620">Skip</span><span class="op" id="8051624">(</span><span class="string" id="8051625">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8051666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051673">nss</span><span class="op" id="8051676">,</span>&nbsp;<span class="ident" id="8051678">err</span>&nbsp;<span class="op" id="8051682">:=</span>&nbsp;<span class="ident" id="8051685">LookupNS</span><span class="op" id="8051693">(</span><span class="string" id="8051694">&#34;gmail.com&#34;</span><span class="op" id="8051705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051708">if</span>&nbsp;<span class="ident" id="8051711">err</span>&nbsp;<span class="op" id="8051715">!=</span>&nbsp;<span class="ident" id="8051718">nil</span>&nbsp;<span class="op" id="8051722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051726">t</span><span class="op" id="8051727">.</span><span class="ident" id="8051728">Fatal</span><span class="op" id="8051733">(</span><span class="ident" id="8051734">err</span><span class="op" id="8051737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051743">if</span>&nbsp;<span class="builtinfunc" id="8051746">len</span><span class="op" id="8051749">(</span><span class="ident" id="8051750">nss</span><span class="op" id="8051753">)</span>&nbsp;<span class="op" id="8051755">==</span>&nbsp;<span class="num" id="8051758">0</span>&nbsp;<span class="op" id="8051760">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051764">t</span><span class="op" id="8051765">.</span><span class="ident" id="8051766">Error</span><span class="op" id="8051771">(</span><span class="string" id="8051772">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8051787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051793">for</span>&nbsp;<span class="ident" id="8051797">_</span><span class="op" id="8051798">,</span>&nbsp;<span class="ident" id="8051800">ns</span>&nbsp;<span class="op" id="8051803">:=</span>&nbsp;<span class="keyword" id="8051806">range</span>&nbsp;<span class="ident" id="8051812">nss</span>&nbsp;<span class="op" id="8051816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051820">if</span>&nbsp;<span class="op" id="8051823">!</span><span class="ident" id="8051824">strings</span><span class="op" id="8051831">.</span><span class="ident" id="8051832">Contains</span><span class="op" id="8051840">(</span><span class="ident" id="8051841">ns</span><span class="op" id="8051843">.</span><span class="ident" id="8051844">Host</span><span class="op" id="8051848">,</span>&nbsp;<span class="string" id="8051850">&#34;.google.com&#34;</span><span class="op" id="8051863">)</span>&nbsp;<span class="op" id="8051865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8051870">t</span><span class="op" id="8051871">.</span><span class="ident" id="8051872">Errorf</span><span class="op" id="8051878">(</span><span class="string" id="8051879">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="8051926">,</span>&nbsp;<span class="ident" id="8051928">ns</span><span class="op" id="8051930">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8051937">}</span><br>
<span class="lineno"></span><span class="op" id="8051939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8051942">func</span>&nbsp;<span class="ident" id="8051947">TestLookupGmailTXT</span><span class="op" id="8051965">(</span><span class="ident" id="8051966">t</span>&nbsp;<span class="op" id="8051968">*</span><span class="ident" id="8051969">testing</span><span class="op" id="8051976">.</span><span class="ident" id="8051977">T</span><span class="op" id="8051978">)</span>&nbsp;<span class="op" id="8051980">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8051983">if</span>&nbsp;<span class="ident" id="8051986">testing</span><span class="op" id="8051993">.</span><span class="ident" id="8051994">Short</span><span class="op" id="8051999">(</span><span class="op" id="8052000">)</span>&nbsp;<span class="op" id="8052002">||</span>&nbsp;<span class="op" id="8052005">!</span><span class="op" id="8052006">*</span><span class="ident" id="8052007">testExternal</span>&nbsp;<span class="op" id="8052020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052024">t</span><span class="op" id="8052025">.</span><span class="ident" id="8052026">Skip</span><span class="op" id="8052030">(</span><span class="string" id="8052031">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8052072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052079">txts</span><span class="op" id="8052083">,</span>&nbsp;<span class="ident" id="8052085">err</span>&nbsp;<span class="op" id="8052089">:=</span>&nbsp;<span class="ident" id="8052092">LookupTXT</span><span class="op" id="8052101">(</span><span class="string" id="8052102">&#34;gmail.com&#34;</span><span class="op" id="8052113">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052116">if</span>&nbsp;<span class="ident" id="8052119">err</span>&nbsp;<span class="op" id="8052123">!=</span>&nbsp;<span class="ident" id="8052126">nil</span>&nbsp;<span class="op" id="8052130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052134">t</span><span class="op" id="8052135">.</span><span class="ident" id="8052136">Fatal</span><span class="op" id="8052141">(</span><span class="ident" id="8052142">err</span><span class="op" id="8052145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052151">if</span>&nbsp;<span class="builtinfunc" id="8052154">len</span><span class="op" id="8052157">(</span><span class="ident" id="8052158">txts</span><span class="op" id="8052162">)</span>&nbsp;<span class="op" id="8052164">==</span>&nbsp;<span class="num" id="8052167">0</span>&nbsp;<span class="op" id="8052169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052173">t</span><span class="op" id="8052174">.</span><span class="ident" id="8052175">Error</span><span class="op" id="8052180">(</span><span class="string" id="8052181">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8052196">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052202">for</span>&nbsp;<span class="ident" id="8052206">_</span><span class="op" id="8052207">,</span>&nbsp;<span class="ident" id="8052209">txt</span>&nbsp;<span class="op" id="8052213">:=</span>&nbsp;<span class="keyword" id="8052216">range</span>&nbsp;<span class="ident" id="8052222">txts</span>&nbsp;<span class="op" id="8052227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052231">if</span>&nbsp;<span class="op" id="8052234">!</span><span class="ident" id="8052235">strings</span><span class="op" id="8052242">.</span><span class="ident" id="8052243">Contains</span><span class="op" id="8052251">(</span><span class="ident" id="8052252">txt</span><span class="op" id="8052255">,</span>&nbsp;<span class="string" id="8052257">&#34;spf&#34;</span><span class="op" id="8052262">)</span>&nbsp;<span class="op" id="8052264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052269">t</span><span class="op" id="8052270">.</span><span class="ident" id="8052271">Errorf</span><span class="op" id="8052277">(</span><span class="string" id="8052278">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="8052305">,</span>&nbsp;<span class="ident" id="8052307">txt</span><span class="op" id="8052310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052314">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052317">}</span><br>
<span class="lineno"></span><span class="op" id="8052319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052322">var</span>&nbsp;<span class="ident" id="8052326">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="8052353">=</span>&nbsp;<span class="op" id="8052355">[</span><span class="op" id="8052356">]</span><span class="keyword" id="8052357">struct</span>&nbsp;<span class="op" id="8052364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052367">addr</span>&nbsp;<span class="builtintype" id="8052372">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052380">name</span>&nbsp;<span class="builtintype" id="8052385">string</span><br>
<span class="lineno"></span><span class="op" id="8052392">}</span><span class="op" id="8052393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052396">{</span><span class="string" id="8052397">&#34;8.8.8.8&#34;</span><span class="op" id="8052406">,</span>&nbsp;<span class="string" id="8052408">&#34;.google.com.&#34;</span><span class="op" id="8052422">}</span><span class="op" id="8052423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052426">{</span><span class="string" id="8052427">&#34;8.8.4.4&#34;</span><span class="op" id="8052436">,</span>&nbsp;<span class="string" id="8052438">&#34;.google.com.&#34;</span><span class="op" id="8052452">}</span><span class="op" id="8052453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052456">{</span><span class="string" id="8052457">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="8052479">,</span>&nbsp;<span class="string" id="8052481">&#34;.google.com.&#34;</span><span class="op" id="8052495">}</span><span class="op" id="8052496">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052499">{</span><span class="string" id="8052500">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="8052522">,</span>&nbsp;<span class="string" id="8052524">&#34;.google.com.&#34;</span><span class="op" id="8052538">}</span><span class="op" id="8052539">,</span><br>
<span class="lineno"></span><span class="op" id="8052541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052544">func</span>&nbsp;<span class="ident" id="8052549">TestLookupGooglePublicDNSAddr</span><span class="op" id="8052578">(</span><span class="ident" id="8052579">t</span>&nbsp;<span class="op" id="8052581">*</span><span class="ident" id="8052582">testing</span><span class="op" id="8052589">.</span><span class="ident" id="8052590">T</span><span class="op" id="8052591">)</span>&nbsp;<span class="op" id="8052593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052596">if</span>&nbsp;<span class="ident" id="8052599">testing</span><span class="op" id="8052606">.</span><span class="ident" id="8052607">Short</span><span class="op" id="8052612">(</span><span class="op" id="8052613">)</span>&nbsp;<span class="op" id="8052615">||</span>&nbsp;<span class="op" id="8052618">!</span><span class="op" id="8052619">*</span><span class="ident" id="8052620">testExternal</span>&nbsp;<span class="op" id="8052633">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052637">t</span><span class="op" id="8052638">.</span><span class="ident" id="8052639">Skip</span><span class="op" id="8052643">(</span><span class="string" id="8052644">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8052685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052692">for</span>&nbsp;<span class="ident" id="8052696">_</span><span class="op" id="8052697">,</span>&nbsp;<span class="ident" id="8052699">tt</span>&nbsp;<span class="op" id="8052702">:=</span>&nbsp;<span class="keyword" id="8052705">range</span>&nbsp;<span class="ident" id="8052711">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="8052738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052742">names</span><span class="op" id="8052747">,</span>&nbsp;<span class="ident" id="8052749">err</span>&nbsp;<span class="op" id="8052753">:=</span>&nbsp;<span class="ident" id="8052756">LookupAddr</span><span class="op" id="8052766">(</span><span class="ident" id="8052767">tt</span><span class="op" id="8052769">.</span><span class="ident" id="8052770">addr</span><span class="op" id="8052774">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052778">if</span>&nbsp;<span class="ident" id="8052781">err</span>&nbsp;<span class="op" id="8052785">!=</span>&nbsp;<span class="ident" id="8052788">nil</span>&nbsp;<span class="op" id="8052792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052797">t</span><span class="op" id="8052798">.</span><span class="ident" id="8052799">Fatal</span><span class="op" id="8052804">(</span><span class="ident" id="8052805">err</span><span class="op" id="8052808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052816">if</span>&nbsp;<span class="builtinfunc" id="8052819">len</span><span class="op" id="8052822">(</span><span class="ident" id="8052823">names</span><span class="op" id="8052828">)</span>&nbsp;<span class="op" id="8052830">==</span>&nbsp;<span class="num" id="8052833">0</span>&nbsp;<span class="op" id="8052835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052840">t</span><span class="op" id="8052841">.</span><span class="ident" id="8052842">Error</span><span class="op" id="8052847">(</span><span class="string" id="8052848">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8052863">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8052867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052871">for</span>&nbsp;<span class="ident" id="8052875">_</span><span class="op" id="8052876">,</span>&nbsp;<span class="ident" id="8052878">name</span>&nbsp;<span class="op" id="8052883">:=</span>&nbsp;<span class="keyword" id="8052886">range</span>&nbsp;<span class="ident" id="8052892">names</span>&nbsp;<span class="op" id="8052898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8052903">if</span>&nbsp;<span class="op" id="8052906">!</span><span class="ident" id="8052907">strings</span><span class="op" id="8052914">.</span><span class="ident" id="8052915">HasSuffix</span><span class="op" id="8052924">(</span><span class="ident" id="8052925">name</span><span class="op" id="8052929">,</span>&nbsp;<span class="ident" id="8052931">tt</span><span class="op" id="8052933">.</span><span class="ident" id="8052934">name</span><span class="op" id="8052938">)</span>&nbsp;<span class="op" id="8052940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8052946">t</span><span class="op" id="8052947">.</span><span class="ident" id="8052948">Errorf</span><span class="op" id="8052954">(</span><span class="string" id="8052955">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="8052992">,</span>&nbsp;<span class="ident" id="8052994">name</span><span class="op" id="8052998">,</span>&nbsp;<span class="ident" id="8053000">tt</span><span class="op" id="8053002">.</span><span class="ident" id="8053003">name</span><span class="op" id="8053007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053012">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053019">}</span><br>
<span class="lineno"></span><span class="op" id="8053021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8053024">func</span>&nbsp;<span class="ident" id="8053029">TestLookupIANACNAME</span><span class="op" id="8053048">(</span><span class="ident" id="8053049">t</span>&nbsp;<span class="op" id="8053051">*</span><span class="ident" id="8053052">testing</span><span class="op" id="8053059">.</span><span class="ident" id="8053060">T</span><span class="op" id="8053061">)</span>&nbsp;<span class="op" id="8053063">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053066">if</span>&nbsp;<span class="ident" id="8053069">testing</span><span class="op" id="8053076">.</span><span class="ident" id="8053077">Short</span><span class="op" id="8053082">(</span><span class="op" id="8053083">)</span>&nbsp;<span class="op" id="8053085">||</span>&nbsp;<span class="op" id="8053088">!</span><span class="op" id="8053089">*</span><span class="ident" id="8053090">testExternal</span>&nbsp;<span class="op" id="8053103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053107">t</span><span class="op" id="8053108">.</span><span class="ident" id="8053109">Skip</span><span class="op" id="8053113">(</span><span class="string" id="8053114">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8053155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053162">cname</span><span class="op" id="8053167">,</span>&nbsp;<span class="ident" id="8053169">err</span>&nbsp;<span class="op" id="8053173">:=</span>&nbsp;<span class="ident" id="8053176">LookupCNAME</span><span class="op" id="8053187">(</span><span class="string" id="8053188">&#34;www.iana.org&#34;</span><span class="op" id="8053202">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053205">if</span>&nbsp;<span class="ident" id="8053208">err</span>&nbsp;<span class="op" id="8053212">!=</span>&nbsp;<span class="ident" id="8053215">nil</span>&nbsp;<span class="op" id="8053219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053223">t</span><span class="op" id="8053224">.</span><span class="ident" id="8053225">Fatal</span><span class="op" id="8053230">(</span><span class="ident" id="8053231">err</span><span class="op" id="8053234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053240">if</span>&nbsp;<span class="op" id="8053243">!</span><span class="ident" id="8053244">strings</span><span class="op" id="8053251">.</span><span class="ident" id="8053252">HasSuffix</span><span class="op" id="8053261">(</span><span class="ident" id="8053262">cname</span><span class="op" id="8053267">,</span>&nbsp;<span class="string" id="8053269">&#34;.icann.org.&#34;</span><span class="op" id="8053282">)</span>&nbsp;<span class="op" id="8053284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053288">t</span><span class="op" id="8053289">.</span><span class="ident" id="8053290">Errorf</span><span class="op" id="8053296">(</span><span class="string" id="8053297">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="8053343">,</span>&nbsp;<span class="ident" id="8053345">cname</span><span class="op" id="8053350">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053353">}</span><br>
<span class="lineno"></span><span class="op" id="8053355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8053358">func</span>&nbsp;<span class="ident" id="8053363">TestLookupGoogleHost</span><span class="op" id="8053383">(</span><span class="ident" id="8053384">t</span>&nbsp;<span class="op" id="8053386">*</span><span class="ident" id="8053387">testing</span><span class="op" id="8053394">.</span><span class="ident" id="8053395">T</span><span class="op" id="8053396">)</span>&nbsp;<span class="op" id="8053398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053401">if</span>&nbsp;<span class="ident" id="8053404">testing</span><span class="op" id="8053411">.</span><span class="ident" id="8053412">Short</span><span class="op" id="8053417">(</span><span class="op" id="8053418">)</span>&nbsp;<span class="op" id="8053420">||</span>&nbsp;<span class="op" id="8053423">!</span><span class="op" id="8053424">*</span><span class="ident" id="8053425">testExternal</span>&nbsp;<span class="op" id="8053438">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053442">t</span><span class="op" id="8053443">.</span><span class="ident" id="8053444">Skip</span><span class="op" id="8053448">(</span><span class="string" id="8053449">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8053490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053497">addrs</span><span class="op" id="8053502">,</span>&nbsp;<span class="ident" id="8053504">err</span>&nbsp;<span class="op" id="8053508">:=</span>&nbsp;<span class="ident" id="8053511">LookupHost</span><span class="op" id="8053521">(</span><span class="string" id="8053522">&#34;google.com&#34;</span><span class="op" id="8053534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053537">if</span>&nbsp;<span class="ident" id="8053540">err</span>&nbsp;<span class="op" id="8053544">!=</span>&nbsp;<span class="ident" id="8053547">nil</span>&nbsp;<span class="op" id="8053551">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053555">t</span><span class="op" id="8053556">.</span><span class="ident" id="8053557">Fatal</span><span class="op" id="8053562">(</span><span class="ident" id="8053563">err</span><span class="op" id="8053566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053572">if</span>&nbsp;<span class="builtinfunc" id="8053575">len</span><span class="op" id="8053578">(</span><span class="ident" id="8053579">addrs</span><span class="op" id="8053584">)</span>&nbsp;<span class="op" id="8053586">==</span>&nbsp;<span class="num" id="8053589">0</span>&nbsp;<span class="op" id="8053591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053595">t</span><span class="op" id="8053596">.</span><span class="ident" id="8053597">Error</span><span class="op" id="8053602">(</span><span class="string" id="8053603">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8053618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053621">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053624">for</span>&nbsp;<span class="ident" id="8053628">_</span><span class="op" id="8053629">,</span>&nbsp;<span class="ident" id="8053631">addr</span>&nbsp;<span class="op" id="8053636">:=</span>&nbsp;<span class="keyword" id="8053639">range</span>&nbsp;<span class="ident" id="8053645">addrs</span>&nbsp;<span class="op" id="8053651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053655">if</span>&nbsp;<span class="ident" id="8053658">ParseIP</span><span class="op" id="8053665">(</span><span class="ident" id="8053666">addr</span><span class="op" id="8053670">)</span>&nbsp;<span class="op" id="8053672">==</span>&nbsp;<span class="ident" id="8053675">nil</span>&nbsp;<span class="op" id="8053679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053684">t</span><span class="op" id="8053685">.</span><span class="ident" id="8053686">Errorf</span><span class="op" id="8053692">(</span><span class="string" id="8053693">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="8053728">,</span>&nbsp;<span class="ident" id="8053730">addr</span><span class="op" id="8053734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053741">}</span><br>
<span class="lineno">175</span><span class="op" id="8053743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8053746">func</span>&nbsp;<span class="ident" id="8053751">TestLookupGoogleIP</span><span class="op" id="8053769">(</span><span class="ident" id="8053770">t</span>&nbsp;<span class="op" id="8053772">*</span><span class="ident" id="8053773">testing</span><span class="op" id="8053780">.</span><span class="ident" id="8053781">T</span><span class="op" id="8053782">)</span>&nbsp;<span class="op" id="8053784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053787">if</span>&nbsp;<span class="ident" id="8053790">testing</span><span class="op" id="8053797">.</span><span class="ident" id="8053798">Short</span><span class="op" id="8053803">(</span><span class="op" id="8053804">)</span>&nbsp;<span class="op" id="8053806">||</span>&nbsp;<span class="op" id="8053809">!</span><span class="op" id="8053810">*</span><span class="ident" id="8053811">testExternal</span>&nbsp;<span class="op" id="8053824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053828">t</span><span class="op" id="8053829">.</span><span class="ident" id="8053830">Skip</span><span class="op" id="8053834">(</span><span class="string" id="8053835">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8053876">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053883">ips</span><span class="op" id="8053886">,</span>&nbsp;<span class="ident" id="8053888">err</span>&nbsp;<span class="op" id="8053892">:=</span>&nbsp;<span class="ident" id="8053895">LookupIP</span><span class="op" id="8053903">(</span><span class="string" id="8053904">&#34;google.com&#34;</span><span class="op" id="8053916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053919">if</span>&nbsp;<span class="ident" id="8053922">err</span>&nbsp;<span class="op" id="8053926">!=</span>&nbsp;<span class="ident" id="8053929">nil</span>&nbsp;<span class="op" id="8053933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053937">t</span><span class="op" id="8053938">.</span><span class="ident" id="8053939">Fatal</span><span class="op" id="8053944">(</span><span class="ident" id="8053945">err</span><span class="op" id="8053948">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8053951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8053954">if</span>&nbsp;<span class="builtinfunc" id="8053957">len</span><span class="op" id="8053960">(</span><span class="ident" id="8053961">ips</span><span class="op" id="8053964">)</span>&nbsp;<span class="op" id="8053966">==</span>&nbsp;<span class="num" id="8053969">0</span>&nbsp;<span class="op" id="8053971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8053975">t</span><span class="op" id="8053976">.</span><span class="ident" id="8053977">Error</span><span class="op" id="8053982">(</span><span class="string" id="8053983">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="8053998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8054004">for</span>&nbsp;<span class="ident" id="8054008">_</span><span class="op" id="8054009">,</span>&nbsp;<span class="ident" id="8054011">ip</span>&nbsp;<span class="op" id="8054014">:=</span>&nbsp;<span class="keyword" id="8054017">range</span>&nbsp;<span class="ident" id="8054023">ips</span>&nbsp;<span class="op" id="8054027">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8054031">if</span>&nbsp;<span class="ident" id="8054034">ip</span><span class="op" id="8054036">.</span><span class="ident" id="8054037">To4</span><span class="op" id="8054040">(</span><span class="op" id="8054041">)</span>&nbsp;<span class="op" id="8054043">==</span>&nbsp;<span class="ident" id="8054046">nil</span>&nbsp;<span class="op" id="8054050">&amp;&amp;</span>&nbsp;<span class="ident" id="8054053">ip</span><span class="op" id="8054055">.</span><span class="ident" id="8054056">To16</span><span class="op" id="8054060">(</span><span class="op" id="8054061">)</span>&nbsp;<span class="op" id="8054063">==</span>&nbsp;<span class="ident" id="8054066">nil</span>&nbsp;<span class="op" id="8054070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8054075">t</span><span class="op" id="8054076">.</span><span class="ident" id="8054077">Errorf</span><span class="op" id="8054083">(</span><span class="string" id="8054084">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="8054112">,</span>&nbsp;<span class="ident" id="8054114">ip</span><span class="op" id="8054116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054123">}</span><br>
<span class="lineno"></span><span class="op" id="8054125">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="8054128">var</span>&nbsp;<span class="ident" id="8054132">revAddrTests</span>&nbsp;<span class="op" id="8054145">=</span>&nbsp;<span class="op" id="8054147">[</span><span class="op" id="8054148">]</span><span class="keyword" id="8054149">struct</span>&nbsp;<span class="op" id="8054156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8054159">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8054169">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8054177">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8054187">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8054195">ErrPrefix</span>&nbsp;<span class="builtintype" id="8054205">string</span><br>
<span class="lineno">200</span><span class="op" id="8054212">}</span><span class="op" id="8054213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054216">{</span><span class="string" id="8054217">&#34;1.2.3.4&#34;</span><span class="op" id="8054226">,</span>&nbsp;<span class="string" id="8054228">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="8054251">,</span>&nbsp;<span class="string" id="8054253">&#34;&#34;</span><span class="op" id="8054255">}</span><span class="op" id="8054256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054259">{</span><span class="string" id="8054260">&#34;245.110.36.114&#34;</span><span class="op" id="8054276">,</span>&nbsp;<span class="string" id="8054278">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="8054308">,</span>&nbsp;<span class="string" id="8054310">&#34;&#34;</span><span class="op" id="8054312">}</span><span class="op" id="8054313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054316">{</span><span class="string" id="8054317">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="8054337">,</span>&nbsp;<span class="string" id="8054339">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="8054366">,</span>&nbsp;<span class="string" id="8054368">&#34;&#34;</span><span class="op" id="8054370">}</span><span class="op" id="8054371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054374">{</span><span class="string" id="8054375">&#34;::1&#34;</span><span class="op" id="8054380">,</span>&nbsp;<span class="string" id="8054382">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="8054457">,</span>&nbsp;<span class="string" id="8054459">&#34;&#34;</span><span class="op" id="8054461">}</span><span class="op" id="8054462">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054465">{</span><span class="string" id="8054466">&#34;1::&#34;</span><span class="op" id="8054471">,</span>&nbsp;<span class="string" id="8054473">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="8054548">,</span>&nbsp;<span class="string" id="8054550">&#34;&#34;</span><span class="op" id="8054552">}</span><span class="op" id="8054553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054556">{</span><span class="string" id="8054557">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="8054577">,</span>&nbsp;<span class="string" id="8054579">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="8054654">,</span>&nbsp;<span class="string" id="8054656">&#34;&#34;</span><span class="op" id="8054658">}</span><span class="op" id="8054659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054662">{</span><span class="string" id="8054663">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="8054702">,</span>&nbsp;<span class="string" id="8054704">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="8054779">,</span>&nbsp;<span class="string" id="8054781">&#34;&#34;</span><span class="op" id="8054783">}</span><span class="op" id="8054784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054787">{</span><span class="string" id="8054788">&#34;1.2.3&#34;</span><span class="op" id="8054795">,</span>&nbsp;<span class="string" id="8054797">&#34;&#34;</span><span class="op" id="8054799">,</span>&nbsp;<span class="string" id="8054801">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8054823">}</span><span class="op" id="8054824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054827">{</span><span class="string" id="8054828">&#34;1.2.3.4.5&#34;</span><span class="op" id="8054839">,</span>&nbsp;<span class="string" id="8054841">&#34;&#34;</span><span class="op" id="8054843">,</span>&nbsp;<span class="string" id="8054845">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8054867">}</span><span class="op" id="8054868">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054871">{</span><span class="string" id="8054872">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="8054898">,</span>&nbsp;<span class="string" id="8054900">&#34;&#34;</span><span class="op" id="8054902">,</span>&nbsp;<span class="string" id="8054904">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8054926">}</span><span class="op" id="8054927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8054930">{</span><span class="string" id="8054931">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="8054962">,</span>&nbsp;<span class="string" id="8054964">&#34;&#34;</span><span class="op" id="8054966">,</span>&nbsp;<span class="string" id="8054968">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="8054990">}</span><span class="op" id="8054991">,</span><br>
<span class="lineno"></span><span class="op" id="8054993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8054996">func</span>&nbsp;<span class="ident" id="8055001">TestReverseAddress</span><span class="op" id="8055019">(</span><span class="ident" id="8055020">t</span>&nbsp;<span class="op" id="8055022">*</span><span class="ident" id="8055023">testing</span><span class="op" id="8055030">.</span><span class="ident" id="8055031">T</span><span class="op" id="8055032">)</span>&nbsp;<span class="op" id="8055034">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055037">for</span>&nbsp;<span class="ident" id="8055041">i</span><span class="op" id="8055042">,</span>&nbsp;<span class="ident" id="8055044">tt</span>&nbsp;<span class="op" id="8055047">:=</span>&nbsp;<span class="keyword" id="8055050">range</span>&nbsp;<span class="ident" id="8055056">revAddrTests</span>&nbsp;<span class="op" id="8055069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8055073">a</span><span class="op" id="8055074">,</span>&nbsp;<span class="ident" id="8055076">err</span>&nbsp;<span class="op" id="8055080">:=</span>&nbsp;<span class="ident" id="8055083">reverseaddr</span><span class="op" id="8055094">(</span><span class="ident" id="8055095">tt</span><span class="op" id="8055097">.</span><span class="ident" id="8055098">Addr</span><span class="op" id="8055102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055106">if</span>&nbsp;<span class="builtinfunc" id="8055109">len</span><span class="op" id="8055112">(</span><span class="ident" id="8055113">tt</span><span class="op" id="8055115">.</span><span class="ident" id="8055116">ErrPrefix</span><span class="op" id="8055125">)</span>&nbsp;<span class="op" id="8055127">&gt;</span>&nbsp;<span class="num" id="8055129">0</span>&nbsp;<span class="op" id="8055131">&amp;&amp;</span>&nbsp;<span class="ident" id="8055134">err</span>&nbsp;<span class="op" id="8055138">==</span>&nbsp;<span class="ident" id="8055141">nil</span>&nbsp;<span class="op" id="8055145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8055150">t</span><span class="op" id="8055151">.</span><span class="ident" id="8055152">Errorf</span><span class="op" id="8055158">(</span><span class="string" id="8055159">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="8055196">,</span>&nbsp;<span class="ident" id="8055198">i</span><span class="op" id="8055199">,</span>&nbsp;<span class="ident" id="8055201">tt</span><span class="op" id="8055203">.</span><span class="ident" id="8055204">ErrPrefix</span><span class="op" id="8055213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055218">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8055229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055233">if</span>&nbsp;<span class="builtinfunc" id="8055236">len</span><span class="op" id="8055239">(</span><span class="ident" id="8055240">tt</span><span class="op" id="8055242">.</span><span class="ident" id="8055243">ErrPrefix</span><span class="op" id="8055252">)</span>&nbsp;<span class="op" id="8055254">==</span>&nbsp;<span class="num" id="8055257">0</span>&nbsp;<span class="op" id="8055259">&amp;&amp;</span>&nbsp;<span class="ident" id="8055262">err</span>&nbsp;<span class="op" id="8055266">!=</span>&nbsp;<span class="ident" id="8055269">nil</span>&nbsp;<span class="op" id="8055273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8055278">t</span><span class="op" id="8055279">.</span><span class="ident" id="8055280">Errorf</span><span class="op" id="8055286">(</span><span class="string" id="8055287">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="8055324">,</span>&nbsp;<span class="ident" id="8055326">i</span><span class="op" id="8055327">,</span>&nbsp;<span class="ident" id="8055329">err</span><span class="op" id="8055332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8055336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055340">if</span>&nbsp;<span class="ident" id="8055343">err</span>&nbsp;<span class="op" id="8055347">!=</span>&nbsp;<span class="ident" id="8055350">nil</span>&nbsp;<span class="op" id="8055354">&amp;&amp;</span>&nbsp;<span class="ident" id="8055357">err</span><span class="op" id="8055360">.</span><span class="op" id="8055361">(</span><span class="op" id="8055362">*</span><span class="ident" id="8055363">DNSError</span><span class="op" id="8055371">)</span><span class="op" id="8055372">.</span><span class="ident" id="8055373">Err</span>&nbsp;<span class="op" id="8055377">!=</span>&nbsp;<span class="ident" id="8055380">tt</span><span class="op" id="8055382">.</span><span class="ident" id="8055383">ErrPrefix</span>&nbsp;<span class="op" id="8055393">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8055398">t</span><span class="op" id="8055399">.</span><span class="ident" id="8055400">Errorf</span><span class="op" id="8055406">(</span><span class="string" id="8055407">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="8055452">,</span>&nbsp;<span class="ident" id="8055454">i</span><span class="op" id="8055455">,</span>&nbsp;<span class="ident" id="8055457">tt</span><span class="op" id="8055459">.</span><span class="ident" id="8055460">ErrPrefix</span><span class="op" id="8055469">,</span>&nbsp;<span class="ident" id="8055471">err</span><span class="op" id="8055474">.</span><span class="op" id="8055475">(</span><span class="op" id="8055476">*</span><span class="ident" id="8055477">DNSError</span><span class="op" id="8055485">)</span><span class="op" id="8055486">.</span><span class="ident" id="8055487">Err</span><span class="op" id="8055490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8055494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8055498">if</span>&nbsp;<span class="ident" id="8055501">a</span>&nbsp;<span class="op" id="8055503">!=</span>&nbsp;<span class="ident" id="8055506">tt</span><span class="op" id="8055508">.</span><span class="ident" id="8055509">Reverse</span>&nbsp;<span class="op" id="8055517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8055522">t</span><span class="op" id="8055523">.</span><span class="ident" id="8055524">Errorf</span><span class="op" id="8055530">(</span><span class="string" id="8055531">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="8055575">,</span>&nbsp;<span class="ident" id="8055577">i</span><span class="op" id="8055578">,</span>&nbsp;<span class="ident" id="8055580">tt</span><span class="op" id="8055582">.</span><span class="ident" id="8055583">Reverse</span><span class="op" id="8055590">,</span>&nbsp;<span class="ident" id="8055592">a</span><span class="op" id="8055593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8055597">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8055600">}</span><br>
<span class="lineno"></span><span class="op" id="8055602">}</span>
</div>
</body>
</html>
