<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8112837">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8112892">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8112946">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8112997">package</span>&nbsp;<span class="ident" id="8113005">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113010">import</span>&nbsp;<span class="op" id="8113017">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113020">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8113030">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="8113033">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8113077">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="8113121">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="8113166">func</span>&nbsp;<span class="ident" id="8113171">TestPowx</span><span class="op" id="8113179">(</span><span class="ident" id="8113180">t</span>&nbsp;<span class="op" id="8113182">*</span><span class="ident" id="8113183">testing</span><span class="op" id="8113190">.</span><span class="ident" id="8113191">T</span><span class="op" id="8113192">)</span>&nbsp;<span class="op" id="8113194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113197">p</span>&nbsp;<span class="op" id="8113199">:=</span>&nbsp;<span class="num" id="8113202">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113205">for</span>&nbsp;<span class="ident" id="8113209">i</span>&nbsp;<span class="op" id="8113211">:=</span>&nbsp;<span class="num" id="8113214">0</span><span class="op" id="8113215">;</span>&nbsp;<span class="ident" id="8113217">i</span>&nbsp;<span class="op" id="8113219">&lt;</span>&nbsp;<span class="builtinfunc" id="8113221">len</span><span class="op" id="8113224">(</span><span class="ident" id="8113225">powx</span><span class="op" id="8113229">)</span><span class="op" id="8113230">;</span>&nbsp;<span class="ident" id="8113232">i</span><span class="op" id="8113233">++</span>&nbsp;<span class="op" id="8113236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113240">if</span>&nbsp;<span class="ident" id="8113243">powx</span><span class="op" id="8113247">[</span><span class="ident" id="8113248">i</span><span class="op" id="8113249">]</span>&nbsp;<span class="op" id="8113251">!=</span>&nbsp;<span class="builtintype" id="8113254">byte</span><span class="op" id="8113258">(</span><span class="ident" id="8113259">p</span><span class="op" id="8113260">)</span>&nbsp;<span class="op" id="8113262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113267">t</span><span class="op" id="8113268">.</span><span class="ident" id="8113269">Errorf</span><span class="op" id="8113275">(</span><span class="string" id="8113276">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8113302">,</span>&nbsp;<span class="ident" id="8113304">i</span><span class="op" id="8113305">,</span>&nbsp;<span class="ident" id="8113307">powx</span><span class="op" id="8113311">[</span><span class="ident" id="8113312">i</span><span class="op" id="8113313">]</span><span class="op" id="8113314">,</span>&nbsp;<span class="ident" id="8113316">p</span><span class="op" id="8113317">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113325">p</span>&nbsp;<span class="op" id="8113327">&lt;&lt;=</span>&nbsp;<span class="num" id="8113331">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113335">if</span>&nbsp;<span class="ident" id="8113338">p</span><span class="op" id="8113339">&amp;</span><span class="num" id="8113340">0x100</span>&nbsp;<span class="op" id="8113346">!=</span>&nbsp;<span class="num" id="8113349">0</span>&nbsp;<span class="op" id="8113351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113356">p</span>&nbsp;<span class="op" id="8113358">^=</span>&nbsp;<span class="ident" id="8113361">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113368">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113371">}</span><br>
<span class="lineno"></span><span class="op" id="8113373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8113376">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="8113429">func</span>&nbsp;<span class="ident" id="8113434">mul</span><span class="op" id="8113437">(</span><span class="ident" id="8113438">b</span><span class="op" id="8113439">,</span>&nbsp;<span class="ident" id="8113441">c</span>&nbsp;<span class="builtintype" id="8113443">uint32</span><span class="op" id="8113449">)</span>&nbsp;<span class="builtintype" id="8113451">uint32</span>&nbsp;<span class="op" id="8113458">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113461">i</span>&nbsp;<span class="op" id="8113463">:=</span>&nbsp;<span class="ident" id="8113466">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113469">j</span>&nbsp;<span class="op" id="8113471">:=</span>&nbsp;<span class="ident" id="8113474">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113477">s</span>&nbsp;<span class="op" id="8113479">:=</span>&nbsp;<span class="builtintype" id="8113482">uint32</span><span class="op" id="8113488">(</span><span class="num" id="8113489">0</span><span class="op" id="8113490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113493">for</span>&nbsp;<span class="ident" id="8113497">k</span>&nbsp;<span class="op" id="8113499">:=</span>&nbsp;<span class="builtintype" id="8113502">uint32</span><span class="op" id="8113508">(</span><span class="num" id="8113509">1</span><span class="op" id="8113510">)</span><span class="op" id="8113511">;</span>&nbsp;<span class="ident" id="8113513">k</span>&nbsp;<span class="op" id="8113515">&lt;</span>&nbsp;<span class="num" id="8113517">0x100</span>&nbsp;<span class="op" id="8113523">&amp;&amp;</span>&nbsp;<span class="ident" id="8113526">j</span>&nbsp;<span class="op" id="8113528">!=</span>&nbsp;<span class="num" id="8113531">0</span><span class="op" id="8113532">;</span>&nbsp;<span class="ident" id="8113534">k</span>&nbsp;<span class="op" id="8113536">&lt;&lt;=</span>&nbsp;<span class="num" id="8113540">1</span>&nbsp;<span class="op" id="8113542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8113546">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113588">if</span>&nbsp;<span class="ident" id="8113591">j</span><span class="op" id="8113592">&amp;</span><span class="ident" id="8113593">k</span>&nbsp;<span class="op" id="8113595">!=</span>&nbsp;<span class="num" id="8113598">0</span>&nbsp;<span class="op" id="8113600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8113605">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113642">s</span>&nbsp;<span class="op" id="8113644">^=</span>&nbsp;<span class="ident" id="8113647">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113652">j</span>&nbsp;<span class="op" id="8113654">^=</span>&nbsp;<span class="ident" id="8113657">k</span>&nbsp;<span class="comment" id="8113659">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8113700">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113743">i</span>&nbsp;<span class="op" id="8113745">&lt;&lt;=</span>&nbsp;<span class="num" id="8113749">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113753">if</span>&nbsp;<span class="ident" id="8113756">i</span><span class="op" id="8113757">&amp;</span><span class="num" id="8113758">0x100</span>&nbsp;<span class="op" id="8113764">!=</span>&nbsp;<span class="num" id="8113767">0</span>&nbsp;<span class="op" id="8113769">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113774">i</span>&nbsp;<span class="op" id="8113776">^=</span>&nbsp;<span class="ident" id="8113779">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8113789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113792">return</span>&nbsp;<span class="ident" id="8113799">s</span><br>
<span class="lineno"></span><span class="op" id="8113801">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="8113804">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="8113861">func</span>&nbsp;<span class="ident" id="8113866">TestMul</span><span class="op" id="8113873">(</span><span class="ident" id="8113874">t</span>&nbsp;<span class="op" id="8113876">*</span><span class="ident" id="8113877">testing</span><span class="op" id="8113884">.</span><span class="ident" id="8113885">T</span><span class="op" id="8113886">)</span>&nbsp;<span class="op" id="8113888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113891">for</span>&nbsp;<span class="ident" id="8113895">i</span>&nbsp;<span class="op" id="8113897">:=</span>&nbsp;<span class="builtintype" id="8113900">uint32</span><span class="op" id="8113906">(</span><span class="num" id="8113907">0</span><span class="op" id="8113908">)</span><span class="op" id="8113909">;</span>&nbsp;<span class="ident" id="8113911">i</span>&nbsp;<span class="op" id="8113913">&lt;</span>&nbsp;<span class="num" id="8113915">256</span><span class="op" id="8113918">;</span>&nbsp;<span class="ident" id="8113920">i</span><span class="op" id="8113921">++</span>&nbsp;<span class="op" id="8113924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113928">for</span>&nbsp;<span class="ident" id="8113932">j</span>&nbsp;<span class="op" id="8113934">:=</span>&nbsp;<span class="builtintype" id="8113937">uint32</span><span class="op" id="8113943">(</span><span class="num" id="8113944">0</span><span class="op" id="8113945">)</span><span class="op" id="8113946">;</span>&nbsp;<span class="ident" id="8113948">j</span>&nbsp;<span class="op" id="8113950">&lt;</span>&nbsp;<span class="num" id="8113952">256</span><span class="op" id="8113955">;</span>&nbsp;<span class="ident" id="8113957">j</span><span class="op" id="8113958">++</span>&nbsp;<span class="op" id="8113961">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8113966">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113998">s</span>&nbsp;<span class="op" id="8114000">:=</span>&nbsp;<span class="builtintype" id="8114003">uint8</span><span class="op" id="8114008">(</span><span class="num" id="8114009">0</span><span class="op" id="8114010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114015">for</span>&nbsp;<span class="ident" id="8114019">k</span>&nbsp;<span class="op" id="8114021">:=</span>&nbsp;<span class="builtintype" id="8114024">uint</span><span class="op" id="8114028">(</span><span class="num" id="8114029">0</span><span class="op" id="8114030">)</span><span class="op" id="8114031">;</span>&nbsp;<span class="ident" id="8114033">k</span>&nbsp;<span class="op" id="8114035">&lt;</span>&nbsp;<span class="num" id="8114037">8</span><span class="op" id="8114038">;</span>&nbsp;<span class="ident" id="8114040">k</span><span class="op" id="8114041">++</span>&nbsp;<span class="op" id="8114044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114050">for</span>&nbsp;<span class="ident" id="8114054">l</span>&nbsp;<span class="op" id="8114056">:=</span>&nbsp;<span class="builtintype" id="8114059">uint</span><span class="op" id="8114063">(</span><span class="num" id="8114064">0</span><span class="op" id="8114065">)</span><span class="op" id="8114066">;</span>&nbsp;<span class="ident" id="8114068">l</span>&nbsp;<span class="op" id="8114070">&lt;</span>&nbsp;<span class="num" id="8114072">8</span><span class="op" id="8114073">;</span>&nbsp;<span class="ident" id="8114075">l</span><span class="op" id="8114076">++</span>&nbsp;<span class="op" id="8114079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114086">if</span>&nbsp;<span class="ident" id="8114089">i</span><span class="op" id="8114090">&amp;</span><span class="op" id="8114091">(</span><span class="num" id="8114092">1</span><span class="op" id="8114093">&lt;&lt;</span><span class="ident" id="8114095">k</span><span class="op" id="8114096">)</span>&nbsp;<span class="op" id="8114098">!=</span>&nbsp;<span class="num" id="8114101">0</span>&nbsp;<span class="op" id="8114103">&amp;&amp;</span>&nbsp;<span class="ident" id="8114106">j</span><span class="op" id="8114107">&amp;</span><span class="op" id="8114108">(</span><span class="num" id="8114109">1</span><span class="op" id="8114110">&lt;&lt;</span><span class="ident" id="8114112">l</span><span class="op" id="8114113">)</span>&nbsp;<span class="op" id="8114115">!=</span>&nbsp;<span class="num" id="8114118">0</span>&nbsp;<span class="op" id="8114120">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114128">s</span>&nbsp;<span class="op" id="8114130">^=</span>&nbsp;<span class="ident" id="8114133">powx</span><span class="op" id="8114137">[</span><span class="ident" id="8114138">k</span><span class="op" id="8114139">+</span><span class="ident" id="8114140">l</span><span class="op" id="8114141">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114164">if</span>&nbsp;<span class="ident" id="8114167">x</span>&nbsp;<span class="op" id="8114169">:=</span>&nbsp;<span class="ident" id="8114172">mul</span><span class="op" id="8114175">(</span><span class="ident" id="8114176">i</span><span class="op" id="8114177">,</span>&nbsp;<span class="ident" id="8114179">j</span><span class="op" id="8114180">)</span><span class="op" id="8114181">;</span>&nbsp;<span class="ident" id="8114183">x</span>&nbsp;<span class="op" id="8114185">!=</span>&nbsp;<span class="builtintype" id="8114188">uint32</span><span class="op" id="8114194">(</span><span class="ident" id="8114195">s</span><span class="op" id="8114196">)</span>&nbsp;<span class="op" id="8114198">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114204">t</span><span class="op" id="8114205">.</span><span class="ident" id="8114206">Fatalf</span><span class="op" id="8114212">(</span><span class="string" id="8114213">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8114244">,</span>&nbsp;<span class="ident" id="8114246">i</span><span class="op" id="8114247">,</span>&nbsp;<span class="ident" id="8114249">j</span><span class="op" id="8114250">,</span>&nbsp;<span class="ident" id="8114252">x</span><span class="op" id="8114253">,</span>&nbsp;<span class="ident" id="8114255">s</span><span class="op" id="8114256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114268">}</span><br>
<span class="lineno"></span><span class="op" id="8114270">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="8114273">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="8114323">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="8114371">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="8114420">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="8114467">func</span>&nbsp;<span class="ident" id="8114472">TestSboxes</span><span class="op" id="8114482">(</span><span class="ident" id="8114483">t</span>&nbsp;<span class="op" id="8114485">*</span><span class="ident" id="8114486">testing</span><span class="op" id="8114493">.</span><span class="ident" id="8114494">T</span><span class="op" id="8114495">)</span>&nbsp;<span class="op" id="8114497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114500">for</span>&nbsp;<span class="ident" id="8114504">i</span>&nbsp;<span class="op" id="8114506">:=</span>&nbsp;<span class="num" id="8114509">0</span><span class="op" id="8114510">;</span>&nbsp;<span class="ident" id="8114512">i</span>&nbsp;<span class="op" id="8114514">&lt;</span>&nbsp;<span class="num" id="8114516">256</span><span class="op" id="8114519">;</span>&nbsp;<span class="ident" id="8114521">i</span><span class="op" id="8114522">++</span>&nbsp;<span class="op" id="8114525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114529">if</span>&nbsp;<span class="ident" id="8114532">j</span>&nbsp;<span class="op" id="8114534">:=</span>&nbsp;<span class="ident" id="8114537">sbox0</span><span class="op" id="8114542">[</span><span class="ident" id="8114543">sbox1</span><span class="op" id="8114548">[</span><span class="ident" id="8114549">i</span><span class="op" id="8114550">]</span><span class="op" id="8114551">]</span><span class="op" id="8114552">;</span>&nbsp;<span class="ident" id="8114554">j</span>&nbsp;<span class="op" id="8114556">!=</span>&nbsp;<span class="builtintype" id="8114559">byte</span><span class="op" id="8114563">(</span><span class="ident" id="8114564">i</span><span class="op" id="8114565">)</span>&nbsp;<span class="op" id="8114567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114572">t</span><span class="op" id="8114573">.</span><span class="ident" id="8114574">Errorf</span><span class="op" id="8114580">(</span><span class="string" id="8114581">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8114606">,</span>&nbsp;<span class="ident" id="8114608">i</span><span class="op" id="8114609">,</span>&nbsp;<span class="ident" id="8114611">j</span><span class="op" id="8114612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114616">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114620">if</span>&nbsp;<span class="ident" id="8114623">j</span>&nbsp;<span class="op" id="8114625">:=</span>&nbsp;<span class="ident" id="8114628">sbox1</span><span class="op" id="8114633">[</span><span class="ident" id="8114634">sbox0</span><span class="op" id="8114639">[</span><span class="ident" id="8114640">i</span><span class="op" id="8114641">]</span><span class="op" id="8114642">]</span><span class="op" id="8114643">;</span>&nbsp;<span class="ident" id="8114645">j</span>&nbsp;<span class="op" id="8114647">!=</span>&nbsp;<span class="builtintype" id="8114650">byte</span><span class="op" id="8114654">(</span><span class="ident" id="8114655">i</span><span class="op" id="8114656">)</span>&nbsp;<span class="op" id="8114658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114663">t</span><span class="op" id="8114664">.</span><span class="ident" id="8114665">Errorf</span><span class="op" id="8114671">(</span><span class="string" id="8114672">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8114697">,</span>&nbsp;<span class="ident" id="8114699">i</span><span class="op" id="8114700">,</span>&nbsp;<span class="ident" id="8114702">j</span><span class="op" id="8114703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114710">}</span><br>
<span class="lineno"></span><span class="op" id="8114712">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="8114715">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="8114759">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8114806">func</span>&nbsp;<span class="ident" id="8114811">TestTe</span><span class="op" id="8114817">(</span><span class="ident" id="8114818">t</span>&nbsp;<span class="op" id="8114820">*</span><span class="ident" id="8114821">testing</span><span class="op" id="8114828">.</span><span class="ident" id="8114829">T</span><span class="op" id="8114830">)</span>&nbsp;<span class="op" id="8114832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8114835">for</span>&nbsp;<span class="ident" id="8114839">i</span>&nbsp;<span class="op" id="8114841">:=</span>&nbsp;<span class="num" id="8114844">0</span><span class="op" id="8114845">;</span>&nbsp;<span class="ident" id="8114847">i</span>&nbsp;<span class="op" id="8114849">&lt;</span>&nbsp;<span class="num" id="8114851">256</span><span class="op" id="8114854">;</span>&nbsp;<span class="ident" id="8114856">i</span><span class="op" id="8114857">++</span>&nbsp;<span class="op" id="8114860">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114864">s</span>&nbsp;<span class="op" id="8114866">:=</span>&nbsp;<span class="builtintype" id="8114869">uint32</span><span class="op" id="8114875">(</span><span class="ident" id="8114876">sbox0</span><span class="op" id="8114881">[</span><span class="ident" id="8114882">i</span><span class="op" id="8114883">]</span><span class="op" id="8114884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114888">s2</span>&nbsp;<span class="op" id="8114891">:=</span>&nbsp;<span class="ident" id="8114894">mul</span><span class="op" id="8114897">(</span><span class="ident" id="8114898">s</span><span class="op" id="8114899">,</span>&nbsp;<span class="num" id="8114901">2</span><span class="op" id="8114902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114906">s3</span>&nbsp;<span class="op" id="8114909">:=</span>&nbsp;<span class="ident" id="8114912">mul</span><span class="op" id="8114915">(</span><span class="ident" id="8114916">s</span><span class="op" id="8114917">,</span>&nbsp;<span class="num" id="8114919">3</span><span class="op" id="8114920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114924">w</span>&nbsp;<span class="op" id="8114926">:=</span>&nbsp;<span class="ident" id="8114929">s2</span><span class="op" id="8114931">&lt;&lt;</span><span class="num" id="8114933">24</span>&nbsp;<span class="op" id="8114936">|</span>&nbsp;<span class="ident" id="8114938">s</span><span class="op" id="8114939">&lt;&lt;</span><span class="num" id="8114941">16</span>&nbsp;<span class="op" id="8114944">|</span>&nbsp;<span class="ident" id="8114946">s</span><span class="op" id="8114947">&lt;&lt;</span><span class="num" id="8114949">8</span>&nbsp;<span class="op" id="8114951">|</span>&nbsp;<span class="ident" id="8114953">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114958">te</span>&nbsp;<span class="op" id="8114961">:=</span>&nbsp;<span class="op" id="8114964">[</span><span class="op" id="8114965">]</span><span class="op" id="8114966">[</span><span class="num" id="8114967">256</span><span class="op" id="8114970">]</span><span class="builtintype" id="8114971">uint32</span><span class="op" id="8114977">{</span><span class="ident" id="8114978">te0</span><span class="op" id="8114981">,</span>&nbsp;<span class="ident" id="8114983">te1</span><span class="op" id="8114986">,</span>&nbsp;<span class="ident" id="8114988">te2</span><span class="op" id="8114991">,</span>&nbsp;<span class="ident" id="8114993">te3</span><span class="op" id="8114996">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8115000">for</span>&nbsp;<span class="ident" id="8115004">j</span>&nbsp;<span class="op" id="8115006">:=</span>&nbsp;<span class="num" id="8115009">0</span><span class="op" id="8115010">;</span>&nbsp;<span class="ident" id="8115012">j</span>&nbsp;<span class="op" id="8115014">&lt;</span>&nbsp;<span class="num" id="8115016">4</span><span class="op" id="8115017">;</span>&nbsp;<span class="ident" id="8115019">j</span><span class="op" id="8115020">++</span>&nbsp;<span class="op" id="8115023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8115028">if</span>&nbsp;<span class="ident" id="8115031">x</span>&nbsp;<span class="op" id="8115033">:=</span>&nbsp;<span class="ident" id="8115036">te</span><span class="op" id="8115038">[</span><span class="ident" id="8115039">j</span><span class="op" id="8115040">]</span><span class="op" id="8115041">[</span><span class="ident" id="8115042">i</span><span class="op" id="8115043">]</span><span class="op" id="8115044">;</span>&nbsp;<span class="ident" id="8115046">x</span>&nbsp;<span class="op" id="8115048">!=</span>&nbsp;<span class="ident" id="8115051">w</span>&nbsp;<span class="op" id="8115053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115059">t</span><span class="op" id="8115060">.</span><span class="ident" id="8115061">Fatalf</span><span class="op" id="8115067">(</span><span class="string" id="8115068">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8115096">,</span>&nbsp;<span class="ident" id="8115098">j</span><span class="op" id="8115099">,</span>&nbsp;<span class="ident" id="8115101">i</span><span class="op" id="8115102">,</span>&nbsp;<span class="ident" id="8115104">x</span><span class="op" id="8115105">,</span>&nbsp;<span class="ident" id="8115107">w</span><span class="op" id="8115108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115118">w</span>&nbsp;<span class="op" id="8115120">=</span>&nbsp;<span class="ident" id="8115122">w</span><span class="op" id="8115123">&lt;&lt;</span><span class="num" id="8115125">24</span>&nbsp;<span class="op" id="8115128">|</span>&nbsp;<span class="ident" id="8115130">w</span><span class="op" id="8115131">&gt;&gt;</span><span class="num" id="8115133">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115140">}</span><br>
<span class="lineno"></span><span class="op" id="8115142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8115145">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="8115189">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8115236">func</span>&nbsp;<span class="ident" id="8115241">TestTd</span><span class="op" id="8115247">(</span><span class="ident" id="8115248">t</span>&nbsp;<span class="op" id="8115250">*</span><span class="ident" id="8115251">testing</span><span class="op" id="8115258">.</span><span class="ident" id="8115259">T</span><span class="op" id="8115260">)</span>&nbsp;<span class="op" id="8115262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8115265">for</span>&nbsp;<span class="ident" id="8115269">i</span>&nbsp;<span class="op" id="8115271">:=</span>&nbsp;<span class="num" id="8115274">0</span><span class="op" id="8115275">;</span>&nbsp;<span class="ident" id="8115277">i</span>&nbsp;<span class="op" id="8115279">&lt;</span>&nbsp;<span class="num" id="8115281">256</span><span class="op" id="8115284">;</span>&nbsp;<span class="ident" id="8115286">i</span><span class="op" id="8115287">++</span>&nbsp;<span class="op" id="8115290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115294">s</span>&nbsp;<span class="op" id="8115296">:=</span>&nbsp;<span class="builtintype" id="8115299">uint32</span><span class="op" id="8115305">(</span><span class="ident" id="8115306">sbox1</span><span class="op" id="8115311">[</span><span class="ident" id="8115312">i</span><span class="op" id="8115313">]</span><span class="op" id="8115314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115318">s9</span>&nbsp;<span class="op" id="8115321">:=</span>&nbsp;<span class="ident" id="8115324">mul</span><span class="op" id="8115327">(</span><span class="ident" id="8115328">s</span><span class="op" id="8115329">,</span>&nbsp;<span class="num" id="8115331">0x9</span><span class="op" id="8115334">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115338">sb</span>&nbsp;<span class="op" id="8115341">:=</span>&nbsp;<span class="ident" id="8115344">mul</span><span class="op" id="8115347">(</span><span class="ident" id="8115348">s</span><span class="op" id="8115349">,</span>&nbsp;<span class="num" id="8115351">0xb</span><span class="op" id="8115354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115358">sd</span>&nbsp;<span class="op" id="8115361">:=</span>&nbsp;<span class="ident" id="8115364">mul</span><span class="op" id="8115367">(</span><span class="ident" id="8115368">s</span><span class="op" id="8115369">,</span>&nbsp;<span class="num" id="8115371">0xd</span><span class="op" id="8115374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115378">se</span>&nbsp;<span class="op" id="8115381">:=</span>&nbsp;<span class="ident" id="8115384">mul</span><span class="op" id="8115387">(</span><span class="ident" id="8115388">s</span><span class="op" id="8115389">,</span>&nbsp;<span class="num" id="8115391">0xe</span><span class="op" id="8115394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115398">w</span>&nbsp;<span class="op" id="8115400">:=</span>&nbsp;<span class="ident" id="8115403">se</span><span class="op" id="8115405">&lt;&lt;</span><span class="num" id="8115407">24</span>&nbsp;<span class="op" id="8115410">|</span>&nbsp;<span class="ident" id="8115412">s9</span><span class="op" id="8115414">&lt;&lt;</span><span class="num" id="8115416">16</span>&nbsp;<span class="op" id="8115419">|</span>&nbsp;<span class="ident" id="8115421">sd</span><span class="op" id="8115423">&lt;&lt;</span><span class="num" id="8115425">8</span>&nbsp;<span class="op" id="8115427">|</span>&nbsp;<span class="ident" id="8115429">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115434">td</span>&nbsp;<span class="op" id="8115437">:=</span>&nbsp;<span class="op" id="8115440">[</span><span class="op" id="8115441">]</span><span class="op" id="8115442">[</span><span class="num" id="8115443">256</span><span class="op" id="8115446">]</span><span class="builtintype" id="8115447">uint32</span><span class="op" id="8115453">{</span><span class="ident" id="8115454">td0</span><span class="op" id="8115457">,</span>&nbsp;<span class="ident" id="8115459">td1</span><span class="op" id="8115462">,</span>&nbsp;<span class="ident" id="8115464">td2</span><span class="op" id="8115467">,</span>&nbsp;<span class="ident" id="8115469">td3</span><span class="op" id="8115472">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8115476">for</span>&nbsp;<span class="ident" id="8115480">j</span>&nbsp;<span class="op" id="8115482">:=</span>&nbsp;<span class="num" id="8115485">0</span><span class="op" id="8115486">;</span>&nbsp;<span class="ident" id="8115488">j</span>&nbsp;<span class="op" id="8115490">&lt;</span>&nbsp;<span class="num" id="8115492">4</span><span class="op" id="8115493">;</span>&nbsp;<span class="ident" id="8115495">j</span><span class="op" id="8115496">++</span>&nbsp;<span class="op" id="8115499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8115504">if</span>&nbsp;<span class="ident" id="8115507">x</span>&nbsp;<span class="op" id="8115509">:=</span>&nbsp;<span class="ident" id="8115512">td</span><span class="op" id="8115514">[</span><span class="ident" id="8115515">j</span><span class="op" id="8115516">]</span><span class="op" id="8115517">[</span><span class="ident" id="8115518">i</span><span class="op" id="8115519">]</span><span class="op" id="8115520">;</span>&nbsp;<span class="ident" id="8115522">x</span>&nbsp;<span class="op" id="8115524">!=</span>&nbsp;<span class="ident" id="8115527">w</span>&nbsp;<span class="op" id="8115529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115535">t</span><span class="op" id="8115536">.</span><span class="ident" id="8115537">Fatalf</span><span class="op" id="8115543">(</span><span class="string" id="8115544">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8115572">,</span>&nbsp;<span class="ident" id="8115574">j</span><span class="op" id="8115575">,</span>&nbsp;<span class="ident" id="8115577">i</span><span class="op" id="8115578">,</span>&nbsp;<span class="ident" id="8115580">x</span><span class="op" id="8115581">,</span>&nbsp;<span class="ident" id="8115583">w</span><span class="op" id="8115584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115594">w</span>&nbsp;<span class="op" id="8115596">=</span>&nbsp;<span class="ident" id="8115598">w</span><span class="op" id="8115599">&lt;&lt;</span><span class="num" id="8115601">24</span>&nbsp;<span class="op" id="8115604">|</span>&nbsp;<span class="ident" id="8115606">w</span><span class="op" id="8115607">&gt;&gt;</span><span class="num" id="8115609">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115616">}</span><br>
<span class="lineno"></span><span class="op" id="8115618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8115621">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="8115656">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8115724">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="8115774">type</span>&nbsp;<span class="ident" id="8115779">KeyTest</span>&nbsp;<span class="keyword" id="8115787">struct</span>&nbsp;<span class="op" id="8115794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115797">key</span>&nbsp;<span class="op" id="8115801">[</span><span class="op" id="8115802">]</span><span class="builtintype" id="8115803">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115809">enc</span>&nbsp;<span class="op" id="8115813">[</span><span class="op" id="8115814">]</span><span class="builtintype" id="8115815">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115823">dec</span>&nbsp;<span class="op" id="8115827">[</span><span class="op" id="8115828">]</span><span class="builtintype" id="8115829">uint32</span>&nbsp;<span class="comment" id="8115836">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="8115910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8115913">var</span>&nbsp;<span class="ident" id="8115917">keyTests</span>&nbsp;<span class="op" id="8115926">=</span>&nbsp;<span class="op" id="8115928">[</span><span class="op" id="8115929">]</span><span class="ident" id="8115930">KeyTest</span><span class="op" id="8115937">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8115944">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115989">[</span><span class="op" id="8115990">]</span><span class="builtintype" id="8115991">byte</span><span class="op" id="8115995">{</span><span class="num" id="8115996">0x2b</span><span class="op" id="8116000">,</span>&nbsp;<span class="num" id="8116002">0x7e</span><span class="op" id="8116006">,</span>&nbsp;<span class="num" id="8116008">0x15</span><span class="op" id="8116012">,</span>&nbsp;<span class="num" id="8116014">0x16</span><span class="op" id="8116018">,</span>&nbsp;<span class="num" id="8116020">0x28</span><span class="op" id="8116024">,</span>&nbsp;<span class="num" id="8116026">0xae</span><span class="op" id="8116030">,</span>&nbsp;<span class="num" id="8116032">0xd2</span><span class="op" id="8116036">,</span>&nbsp;<span class="num" id="8116038">0xa6</span><span class="op" id="8116042">,</span>&nbsp;<span class="num" id="8116044">0xab</span><span class="op" id="8116048">,</span>&nbsp;<span class="num" id="8116050">0xf7</span><span class="op" id="8116054">,</span>&nbsp;<span class="num" id="8116056">0x15</span><span class="op" id="8116060">,</span>&nbsp;<span class="num" id="8116062">0x88</span><span class="op" id="8116066">,</span>&nbsp;<span class="num" id="8116068">0x09</span><span class="op" id="8116072">,</span>&nbsp;<span class="num" id="8116074">0xcf</span><span class="op" id="8116078">,</span>&nbsp;<span class="num" id="8116080">0x4f</span><span class="op" id="8116084">,</span>&nbsp;<span class="num" id="8116086">0x3c</span><span class="op" id="8116090">}</span><span class="op" id="8116091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116095">[</span><span class="op" id="8116096">]</span><span class="builtintype" id="8116097">uint32</span><span class="op" id="8116103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116108">0x2b7e1516</span><span class="op" id="8116118">,</span>&nbsp;<span class="num" id="8116120">0x28aed2a6</span><span class="op" id="8116130">,</span>&nbsp;<span class="num" id="8116132">0xabf71588</span><span class="op" id="8116142">,</span>&nbsp;<span class="num" id="8116144">0x09cf4f3c</span><span class="op" id="8116154">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116159">0xa0fafe17</span><span class="op" id="8116169">,</span>&nbsp;<span class="num" id="8116171">0x88542cb1</span><span class="op" id="8116181">,</span>&nbsp;<span class="num" id="8116183">0x23a33939</span><span class="op" id="8116193">,</span>&nbsp;<span class="num" id="8116195">0x2a6c7605</span><span class="op" id="8116205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116210">0xf2c295f2</span><span class="op" id="8116220">,</span>&nbsp;<span class="num" id="8116222">0x7a96b943</span><span class="op" id="8116232">,</span>&nbsp;<span class="num" id="8116234">0x5935807a</span><span class="op" id="8116244">,</span>&nbsp;<span class="num" id="8116246">0x7359f67f</span><span class="op" id="8116256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116261">0x3d80477d</span><span class="op" id="8116271">,</span>&nbsp;<span class="num" id="8116273">0x4716fe3e</span><span class="op" id="8116283">,</span>&nbsp;<span class="num" id="8116285">0x1e237e44</span><span class="op" id="8116295">,</span>&nbsp;<span class="num" id="8116297">0x6d7a883b</span><span class="op" id="8116307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116312">0xef44a541</span><span class="op" id="8116322">,</span>&nbsp;<span class="num" id="8116324">0xa8525b7f</span><span class="op" id="8116334">,</span>&nbsp;<span class="num" id="8116336">0xb671253b</span><span class="op" id="8116346">,</span>&nbsp;<span class="num" id="8116348">0xdb0bad00</span><span class="op" id="8116358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116363">0xd4d1c6f8</span><span class="op" id="8116373">,</span>&nbsp;<span class="num" id="8116375">0x7c839d87</span><span class="op" id="8116385">,</span>&nbsp;<span class="num" id="8116387">0xcaf2b8bc</span><span class="op" id="8116397">,</span>&nbsp;<span class="num" id="8116399">0x11f915bc</span><span class="op" id="8116409">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116414">0x6d88a37a</span><span class="op" id="8116424">,</span>&nbsp;<span class="num" id="8116426">0x110b3efd</span><span class="op" id="8116436">,</span>&nbsp;<span class="num" id="8116438">0xdbf98641</span><span class="op" id="8116448">,</span>&nbsp;<span class="num" id="8116450">0xca0093fd</span><span class="op" id="8116460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116465">0x4e54f70e</span><span class="op" id="8116475">,</span>&nbsp;<span class="num" id="8116477">0x5f5fc9f3</span><span class="op" id="8116487">,</span>&nbsp;<span class="num" id="8116489">0x84a64fb2</span><span class="op" id="8116499">,</span>&nbsp;<span class="num" id="8116501">0x4ea6dc4f</span><span class="op" id="8116511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116516">0xead27321</span><span class="op" id="8116526">,</span>&nbsp;<span class="num" id="8116528">0xb58dbad2</span><span class="op" id="8116538">,</span>&nbsp;<span class="num" id="8116540">0x312bf560</span><span class="op" id="8116550">,</span>&nbsp;<span class="num" id="8116552">0x7f8d292f</span><span class="op" id="8116562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116567">0xac7766f3</span><span class="op" id="8116577">,</span>&nbsp;<span class="num" id="8116579">0x19fadc21</span><span class="op" id="8116589">,</span>&nbsp;<span class="num" id="8116591">0x28d12941</span><span class="op" id="8116601">,</span>&nbsp;<span class="num" id="8116603">0x575c006e</span><span class="op" id="8116613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116618">0xd014f9a8</span><span class="op" id="8116628">,</span>&nbsp;<span class="num" id="8116630">0xc9ee2589</span><span class="op" id="8116640">,</span>&nbsp;<span class="num" id="8116642">0xe13f0cc8</span><span class="op" id="8116652">,</span>&nbsp;<span class="num" id="8116654">0xb6630ca6</span><span class="op" id="8116664">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116668">}</span><span class="op" id="8116669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116673">[</span><span class="op" id="8116674">]</span><span class="builtintype" id="8116675">uint32</span><span class="op" id="8116681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116686">0xd014f9a8</span><span class="op" id="8116696">,</span>&nbsp;<span class="num" id="8116698">0xc9ee2589</span><span class="op" id="8116708">,</span>&nbsp;<span class="num" id="8116710">0xe13f0cc8</span><span class="op" id="8116720">,</span>&nbsp;<span class="num" id="8116722">0xb6630ca6</span><span class="op" id="8116732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116737">0xc7b5a63</span><span class="op" id="8116746">,</span>&nbsp;<span class="num" id="8116748">0x1319eafe</span><span class="op" id="8116758">,</span>&nbsp;<span class="num" id="8116760">0xb0398890</span><span class="op" id="8116770">,</span>&nbsp;<span class="num" id="8116772">0x664cfbb4</span><span class="op" id="8116782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116787">0xdf7d925a</span><span class="op" id="8116797">,</span>&nbsp;<span class="num" id="8116799">0x1f62b09d</span><span class="op" id="8116809">,</span>&nbsp;<span class="num" id="8116811">0xa320626e</span><span class="op" id="8116821">,</span>&nbsp;<span class="num" id="8116823">0xd6757324</span><span class="op" id="8116833">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116838">0x12c07647</span><span class="op" id="8116848">,</span>&nbsp;<span class="num" id="8116850">0xc01f22c7</span><span class="op" id="8116860">,</span>&nbsp;<span class="num" id="8116862">0xbc42d2f3</span><span class="op" id="8116872">,</span>&nbsp;<span class="num" id="8116874">0x7555114a</span><span class="op" id="8116884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116889">0x6efcd876</span><span class="op" id="8116899">,</span>&nbsp;<span class="num" id="8116901">0xd2df5480</span><span class="op" id="8116911">,</span>&nbsp;<span class="num" id="8116913">0x7c5df034</span><span class="op" id="8116923">,</span>&nbsp;<span class="num" id="8116925">0xc917c3b9</span><span class="op" id="8116935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116940">0x6ea30afc</span><span class="op" id="8116950">,</span>&nbsp;<span class="num" id="8116952">0xbc238cf6</span><span class="op" id="8116962">,</span>&nbsp;<span class="num" id="8116964">0xae82a4b4</span><span class="op" id="8116974">,</span>&nbsp;<span class="num" id="8116976">0xb54a338d</span><span class="op" id="8116986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116991">0x90884413</span><span class="op" id="8117001">,</span>&nbsp;<span class="num" id="8117003">0xd280860a</span><span class="op" id="8117013">,</span>&nbsp;<span class="num" id="8117015">0x12a12842</span><span class="op" id="8117025">,</span>&nbsp;<span class="num" id="8117027">0x1bc89739</span><span class="op" id="8117037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117042">0x7c1f13f7</span><span class="op" id="8117052">,</span>&nbsp;<span class="num" id="8117054">0x4208c219</span><span class="op" id="8117064">,</span>&nbsp;<span class="num" id="8117066">0xc021ae48</span><span class="op" id="8117076">,</span>&nbsp;<span class="num" id="8117078">0x969bf7b</span><span class="op" id="8117087">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117092">0xcc7505eb</span><span class="op" id="8117102">,</span>&nbsp;<span class="num" id="8117104">0x3e17d1ee</span><span class="op" id="8117114">,</span>&nbsp;<span class="num" id="8117116">0x82296c51</span><span class="op" id="8117126">,</span>&nbsp;<span class="num" id="8117128">0xc9481133</span><span class="op" id="8117138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117143">0x2b3708a7</span><span class="op" id="8117153">,</span>&nbsp;<span class="num" id="8117155">0xf262d405</span><span class="op" id="8117165">,</span>&nbsp;<span class="num" id="8117167">0xbc3ebdbf</span><span class="op" id="8117177">,</span>&nbsp;<span class="num" id="8117179">0x4b617d62</span><span class="op" id="8117189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117194">0x2b7e1516</span><span class="op" id="8117204">,</span>&nbsp;<span class="num" id="8117206">0x28aed2a6</span><span class="op" id="8117216">,</span>&nbsp;<span class="num" id="8117218">0xabf71588</span><span class="op" id="8117228">,</span>&nbsp;<span class="num" id="8117230">0x9cf4f3c</span><span class="op" id="8117239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117243">}</span><span class="op" id="8117244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117247">}</span><span class="op" id="8117248">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8117255">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117300">[</span><span class="op" id="8117301">]</span><span class="builtintype" id="8117302">byte</span><span class="op" id="8117306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117311">0x8e</span><span class="op" id="8117315">,</span>&nbsp;<span class="num" id="8117317">0x73</span><span class="op" id="8117321">,</span>&nbsp;<span class="num" id="8117323">0xb0</span><span class="op" id="8117327">,</span>&nbsp;<span class="num" id="8117329">0xf7</span><span class="op" id="8117333">,</span>&nbsp;<span class="num" id="8117335">0xda</span><span class="op" id="8117339">,</span>&nbsp;<span class="num" id="8117341">0x0e</span><span class="op" id="8117345">,</span>&nbsp;<span class="num" id="8117347">0x64</span><span class="op" id="8117351">,</span>&nbsp;<span class="num" id="8117353">0x52</span><span class="op" id="8117357">,</span>&nbsp;<span class="num" id="8117359">0xc8</span><span class="op" id="8117363">,</span>&nbsp;<span class="num" id="8117365">0x10</span><span class="op" id="8117369">,</span>&nbsp;<span class="num" id="8117371">0xf3</span><span class="op" id="8117375">,</span>&nbsp;<span class="num" id="8117377">0x2b</span><span class="op" id="8117381">,</span>&nbsp;<span class="num" id="8117383">0x80</span><span class="op" id="8117387">,</span>&nbsp;<span class="num" id="8117389">0x90</span><span class="op" id="8117393">,</span>&nbsp;<span class="num" id="8117395">0x79</span><span class="op" id="8117399">,</span>&nbsp;<span class="num" id="8117401">0xe5</span><span class="op" id="8117405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117410">0x62</span><span class="op" id="8117414">,</span>&nbsp;<span class="num" id="8117416">0xf8</span><span class="op" id="8117420">,</span>&nbsp;<span class="num" id="8117422">0xea</span><span class="op" id="8117426">,</span>&nbsp;<span class="num" id="8117428">0xd2</span><span class="op" id="8117432">,</span>&nbsp;<span class="num" id="8117434">0x52</span><span class="op" id="8117438">,</span>&nbsp;<span class="num" id="8117440">0x2c</span><span class="op" id="8117444">,</span>&nbsp;<span class="num" id="8117446">0x6b</span><span class="op" id="8117450">,</span>&nbsp;<span class="num" id="8117452">0x7b</span><span class="op" id="8117456">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117460">}</span><span class="op" id="8117461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117465">[</span><span class="op" id="8117466">]</span><span class="builtintype" id="8117467">uint32</span><span class="op" id="8117473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117478">0x8e73b0f7</span><span class="op" id="8117488">,</span>&nbsp;<span class="num" id="8117490">0xda0e6452</span><span class="op" id="8117500">,</span>&nbsp;<span class="num" id="8117502">0xc810f32b</span><span class="op" id="8117512">,</span>&nbsp;<span class="num" id="8117514">0x809079e5</span><span class="op" id="8117524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117529">0x62f8ead2</span><span class="op" id="8117539">,</span>&nbsp;<span class="num" id="8117541">0x522c6b7b</span><span class="op" id="8117551">,</span>&nbsp;<span class="num" id="8117553">0xfe0c91f7</span><span class="op" id="8117563">,</span>&nbsp;<span class="num" id="8117565">0x2402f5a5</span><span class="op" id="8117575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117580">0xec12068e</span><span class="op" id="8117590">,</span>&nbsp;<span class="num" id="8117592">0x6c827f6b</span><span class="op" id="8117602">,</span>&nbsp;<span class="num" id="8117604">0x0e7a95b9</span><span class="op" id="8117614">,</span>&nbsp;<span class="num" id="8117616">0x5c56fec2</span><span class="op" id="8117626">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117631">0x4db7b4bd</span><span class="op" id="8117641">,</span>&nbsp;<span class="num" id="8117643">0x69b54118</span><span class="op" id="8117653">,</span>&nbsp;<span class="num" id="8117655">0x85a74796</span><span class="op" id="8117665">,</span>&nbsp;<span class="num" id="8117667">0xe92538fd</span><span class="op" id="8117677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117682">0xe75fad44</span><span class="op" id="8117692">,</span>&nbsp;<span class="num" id="8117694">0xbb095386</span><span class="op" id="8117704">,</span>&nbsp;<span class="num" id="8117706">0x485af057</span><span class="op" id="8117716">,</span>&nbsp;<span class="num" id="8117718">0x21efb14f</span><span class="op" id="8117728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117733">0xa448f6d9</span><span class="op" id="8117743">,</span>&nbsp;<span class="num" id="8117745">0x4d6dce24</span><span class="op" id="8117755">,</span>&nbsp;<span class="num" id="8117757">0xaa326360</span><span class="op" id="8117767">,</span>&nbsp;<span class="num" id="8117769">0x113b30e6</span><span class="op" id="8117779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117784">0xa25e7ed5</span><span class="op" id="8117794">,</span>&nbsp;<span class="num" id="8117796">0x83b1cf9a</span><span class="op" id="8117806">,</span>&nbsp;<span class="num" id="8117808">0x27f93943</span><span class="op" id="8117818">,</span>&nbsp;<span class="num" id="8117820">0x6a94f767</span><span class="op" id="8117830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117835">0xc0a69407</span><span class="op" id="8117845">,</span>&nbsp;<span class="num" id="8117847">0xd19da4e1</span><span class="op" id="8117857">,</span>&nbsp;<span class="num" id="8117859">0xec1786eb</span><span class="op" id="8117869">,</span>&nbsp;<span class="num" id="8117871">0x6fa64971</span><span class="op" id="8117881">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117886">0x485f7032</span><span class="op" id="8117896">,</span>&nbsp;<span class="num" id="8117898">0x22cb8755</span><span class="op" id="8117908">,</span>&nbsp;<span class="num" id="8117910">0xe26d1352</span><span class="op" id="8117920">,</span>&nbsp;<span class="num" id="8117922">0x33f0b7b3</span><span class="op" id="8117932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117937">0x40beeb28</span><span class="op" id="8117947">,</span>&nbsp;<span class="num" id="8117949">0x2f18a259</span><span class="op" id="8117959">,</span>&nbsp;<span class="num" id="8117961">0x6747d26b</span><span class="op" id="8117971">,</span>&nbsp;<span class="num" id="8117973">0x458c553e</span><span class="op" id="8117983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8117988">0xa7e1466c</span><span class="op" id="8117998">,</span>&nbsp;<span class="num" id="8118000">0x9411f1df</span><span class="op" id="8118010">,</span>&nbsp;<span class="num" id="8118012">0x821f750a</span><span class="op" id="8118022">,</span>&nbsp;<span class="num" id="8118024">0xad07d753</span><span class="op" id="8118034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118039">0xca400538</span><span class="op" id="8118049">,</span>&nbsp;<span class="num" id="8118051">0x8fcc5006</span><span class="op" id="8118061">,</span>&nbsp;<span class="num" id="8118063">0x282d166a</span><span class="op" id="8118073">,</span>&nbsp;<span class="num" id="8118075">0xbc3ce7b5</span><span class="op" id="8118085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118090">0xe98ba06f</span><span class="op" id="8118100">,</span>&nbsp;<span class="num" id="8118102">0x448c773c</span><span class="op" id="8118112">,</span>&nbsp;<span class="num" id="8118114">0x8ecc7204</span><span class="op" id="8118124">,</span>&nbsp;<span class="num" id="8118126">0x01002202</span><span class="op" id="8118136">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118140">}</span><span class="op" id="8118141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8118145">nil</span><span class="op" id="8118148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118151">}</span><span class="op" id="8118152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8118159">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118204">[</span><span class="op" id="8118205">]</span><span class="builtintype" id="8118206">byte</span><span class="op" id="8118210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118215">0x60</span><span class="op" id="8118219">,</span>&nbsp;<span class="num" id="8118221">0x3d</span><span class="op" id="8118225">,</span>&nbsp;<span class="num" id="8118227">0xeb</span><span class="op" id="8118231">,</span>&nbsp;<span class="num" id="8118233">0x10</span><span class="op" id="8118237">,</span>&nbsp;<span class="num" id="8118239">0x15</span><span class="op" id="8118243">,</span>&nbsp;<span class="num" id="8118245">0xca</span><span class="op" id="8118249">,</span>&nbsp;<span class="num" id="8118251">0x71</span><span class="op" id="8118255">,</span>&nbsp;<span class="num" id="8118257">0xbe</span><span class="op" id="8118261">,</span>&nbsp;<span class="num" id="8118263">0x2b</span><span class="op" id="8118267">,</span>&nbsp;<span class="num" id="8118269">0x73</span><span class="op" id="8118273">,</span>&nbsp;<span class="num" id="8118275">0xae</span><span class="op" id="8118279">,</span>&nbsp;<span class="num" id="8118281">0xf0</span><span class="op" id="8118285">,</span>&nbsp;<span class="num" id="8118287">0x85</span><span class="op" id="8118291">,</span>&nbsp;<span class="num" id="8118293">0x7d</span><span class="op" id="8118297">,</span>&nbsp;<span class="num" id="8118299">0x77</span><span class="op" id="8118303">,</span>&nbsp;<span class="num" id="8118305">0x81</span><span class="op" id="8118309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118314">0x1f</span><span class="op" id="8118318">,</span>&nbsp;<span class="num" id="8118320">0x35</span><span class="op" id="8118324">,</span>&nbsp;<span class="num" id="8118326">0x2c</span><span class="op" id="8118330">,</span>&nbsp;<span class="num" id="8118332">0x07</span><span class="op" id="8118336">,</span>&nbsp;<span class="num" id="8118338">0x3b</span><span class="op" id="8118342">,</span>&nbsp;<span class="num" id="8118344">0x61</span><span class="op" id="8118348">,</span>&nbsp;<span class="num" id="8118350">0x08</span><span class="op" id="8118354">,</span>&nbsp;<span class="num" id="8118356">0xd7</span><span class="op" id="8118360">,</span>&nbsp;<span class="num" id="8118362">0x2d</span><span class="op" id="8118366">,</span>&nbsp;<span class="num" id="8118368">0x98</span><span class="op" id="8118372">,</span>&nbsp;<span class="num" id="8118374">0x10</span><span class="op" id="8118378">,</span>&nbsp;<span class="num" id="8118380">0xa3</span><span class="op" id="8118384">,</span>&nbsp;<span class="num" id="8118386">0x09</span><span class="op" id="8118390">,</span>&nbsp;<span class="num" id="8118392">0x14</span><span class="op" id="8118396">,</span>&nbsp;<span class="num" id="8118398">0xdf</span><span class="op" id="8118402">,</span>&nbsp;<span class="num" id="8118404">0xf4</span><span class="op" id="8118408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118412">}</span><span class="op" id="8118413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118417">[</span><span class="op" id="8118418">]</span><span class="builtintype" id="8118419">uint32</span><span class="op" id="8118425">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118430">0x603deb10</span><span class="op" id="8118440">,</span>&nbsp;<span class="num" id="8118442">0x15ca71be</span><span class="op" id="8118452">,</span>&nbsp;<span class="num" id="8118454">0x2b73aef0</span><span class="op" id="8118464">,</span>&nbsp;<span class="num" id="8118466">0x857d7781</span><span class="op" id="8118476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118481">0x1f352c07</span><span class="op" id="8118491">,</span>&nbsp;<span class="num" id="8118493">0x3b6108d7</span><span class="op" id="8118503">,</span>&nbsp;<span class="num" id="8118505">0x2d9810a3</span><span class="op" id="8118515">,</span>&nbsp;<span class="num" id="8118517">0x0914dff4</span><span class="op" id="8118527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118532">0x9ba35411</span><span class="op" id="8118542">,</span>&nbsp;<span class="num" id="8118544">0x8e6925af</span><span class="op" id="8118554">,</span>&nbsp;<span class="num" id="8118556">0xa51a8b5f</span><span class="op" id="8118566">,</span>&nbsp;<span class="num" id="8118568">0x2067fcde</span><span class="op" id="8118578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118583">0xa8b09c1a</span><span class="op" id="8118593">,</span>&nbsp;<span class="num" id="8118595">0x93d194cd</span><span class="op" id="8118605">,</span>&nbsp;<span class="num" id="8118607">0xbe49846e</span><span class="op" id="8118617">,</span>&nbsp;<span class="num" id="8118619">0xb75d5b9a</span><span class="op" id="8118629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118634">0xd59aecb8</span><span class="op" id="8118644">,</span>&nbsp;<span class="num" id="8118646">0x5bf3c917</span><span class="op" id="8118656">,</span>&nbsp;<span class="num" id="8118658">0xfee94248</span><span class="op" id="8118668">,</span>&nbsp;<span class="num" id="8118670">0xde8ebe96</span><span class="op" id="8118680">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118685">0xb5a9328a</span><span class="op" id="8118695">,</span>&nbsp;<span class="num" id="8118697">0x2678a647</span><span class="op" id="8118707">,</span>&nbsp;<span class="num" id="8118709">0x98312229</span><span class="op" id="8118719">,</span>&nbsp;<span class="num" id="8118721">0x2f6c79b3</span><span class="op" id="8118731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118736">0x812c81ad</span><span class="op" id="8118746">,</span>&nbsp;<span class="num" id="8118748">0xdadf48ba</span><span class="op" id="8118758">,</span>&nbsp;<span class="num" id="8118760">0x24360af2</span><span class="op" id="8118770">,</span>&nbsp;<span class="num" id="8118772">0xfab8b464</span><span class="op" id="8118782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118787">0x98c5bfc9</span><span class="op" id="8118797">,</span>&nbsp;<span class="num" id="8118799">0xbebd198e</span><span class="op" id="8118809">,</span>&nbsp;<span class="num" id="8118811">0x268c3ba7</span><span class="op" id="8118821">,</span>&nbsp;<span class="num" id="8118823">0x09e04214</span><span class="op" id="8118833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118838">0x68007bac</span><span class="op" id="8118848">,</span>&nbsp;<span class="num" id="8118850">0xb2df3316</span><span class="op" id="8118860">,</span>&nbsp;<span class="num" id="8118862">0x96e939e4</span><span class="op" id="8118872">,</span>&nbsp;<span class="num" id="8118874">0x6c518d80</span><span class="op" id="8118884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118889">0xc814e204</span><span class="op" id="8118899">,</span>&nbsp;<span class="num" id="8118901">0x76a9fb8a</span><span class="op" id="8118911">,</span>&nbsp;<span class="num" id="8118913">0x5025c02d</span><span class="op" id="8118923">,</span>&nbsp;<span class="num" id="8118925">0x59c58239</span><span class="op" id="8118935">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118940">0xde136967</span><span class="op" id="8118950">,</span>&nbsp;<span class="num" id="8118952">0x6ccc5a71</span><span class="op" id="8118962">,</span>&nbsp;<span class="num" id="8118964">0xfa256395</span><span class="op" id="8118974">,</span>&nbsp;<span class="num" id="8118976">0x9674ee15</span><span class="op" id="8118986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118991">0x5886ca5d</span><span class="op" id="8119001">,</span>&nbsp;<span class="num" id="8119003">0x2e2f31d7</span><span class="op" id="8119013">,</span>&nbsp;<span class="num" id="8119015">0x7e0af1fa</span><span class="op" id="8119025">,</span>&nbsp;<span class="num" id="8119027">0x27cf73c3</span><span class="op" id="8119037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119042">0x749c47ab</span><span class="op" id="8119052">,</span>&nbsp;<span class="num" id="8119054">0x18501dda</span><span class="op" id="8119064">,</span>&nbsp;<span class="num" id="8119066">0xe2757e4f</span><span class="op" id="8119076">,</span>&nbsp;<span class="num" id="8119078">0x7401905a</span><span class="op" id="8119088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119093">0xcafaaae3</span><span class="op" id="8119103">,</span>&nbsp;<span class="num" id="8119105">0xe4d59b34</span><span class="op" id="8119115">,</span>&nbsp;<span class="num" id="8119117">0x9adf6ace</span><span class="op" id="8119127">,</span>&nbsp;<span class="num" id="8119129">0xbd10190d</span><span class="op" id="8119139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119144">0xfe4890d1</span><span class="op" id="8119154">,</span>&nbsp;<span class="num" id="8119156">0xe6188d0b</span><span class="op" id="8119166">,</span>&nbsp;<span class="num" id="8119168">0x046df344</span><span class="op" id="8119178">,</span>&nbsp;<span class="num" id="8119180">0x706c631e</span><span class="op" id="8119190">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119194">}</span><span class="op" id="8119195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8119199">nil</span><span class="op" id="8119202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119205">}</span><span class="op" id="8119206">,</span><br>
<span class="lineno"></span><span class="op" id="8119208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="8119211">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8119260">func</span>&nbsp;<span class="ident" id="8119265">TestExpandKey</span><span class="op" id="8119278">(</span><span class="ident" id="8119279">t</span>&nbsp;<span class="op" id="8119281">*</span><span class="ident" id="8119282">testing</span><span class="op" id="8119289">.</span><span class="ident" id="8119290">T</span><span class="op" id="8119291">)</span>&nbsp;<span class="op" id="8119293">{</span><br>
<span class="lineno"></span><span class="ident" id="8119295">L</span><span class="op" id="8119296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119299">for</span>&nbsp;<span class="ident" id="8119303">i</span><span class="op" id="8119304">,</span>&nbsp;<span class="ident" id="8119306">tt</span>&nbsp;<span class="op" id="8119309">:=</span>&nbsp;<span class="keyword" id="8119312">range</span>&nbsp;<span class="ident" id="8119318">keyTests</span>&nbsp;<span class="op" id="8119327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119331">enc</span>&nbsp;<span class="op" id="8119335">:=</span>&nbsp;<span class="builtinfunc" id="8119338">make</span><span class="op" id="8119342">(</span><span class="op" id="8119343">[</span><span class="op" id="8119344">]</span><span class="builtintype" id="8119345">uint32</span><span class="op" id="8119351">,</span>&nbsp;<span class="builtinfunc" id="8119353">len</span><span class="op" id="8119356">(</span><span class="ident" id="8119357">tt</span><span class="op" id="8119359">.</span><span class="ident" id="8119360">enc</span><span class="op" id="8119363">)</span><span class="op" id="8119364">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119368">var</span>&nbsp;<span class="ident" id="8119372">dec</span>&nbsp;<span class="op" id="8119376">[</span><span class="op" id="8119377">]</span><span class="builtintype" id="8119378">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119387">if</span>&nbsp;<span class="ident" id="8119390">tt</span><span class="op" id="8119392">.</span><span class="ident" id="8119393">dec</span>&nbsp;<span class="op" id="8119397">!=</span>&nbsp;<span class="builtintype" id="8119400">nil</span>&nbsp;<span class="op" id="8119404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119409">dec</span>&nbsp;<span class="op" id="8119413">=</span>&nbsp;<span class="builtinfunc" id="8119415">make</span><span class="op" id="8119419">(</span><span class="op" id="8119420">[</span><span class="op" id="8119421">]</span><span class="builtintype" id="8119422">uint32</span><span class="op" id="8119428">,</span>&nbsp;<span class="builtinfunc" id="8119430">len</span><span class="op" id="8119433">(</span><span class="ident" id="8119434">tt</span><span class="op" id="8119436">.</span><span class="ident" id="8119437">dec</span><span class="op" id="8119440">)</span><span class="op" id="8119441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8119449">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8119516">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8119581">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119650">expandKeyGo</span><span class="op" id="8119661">(</span><span class="ident" id="8119662">tt</span><span class="op" id="8119664">.</span><span class="ident" id="8119665">key</span><span class="op" id="8119668">,</span>&nbsp;<span class="ident" id="8119670">enc</span><span class="op" id="8119673">,</span>&nbsp;<span class="ident" id="8119675">dec</span><span class="op" id="8119678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119682">for</span>&nbsp;<span class="ident" id="8119686">j</span><span class="op" id="8119687">,</span>&nbsp;<span class="ident" id="8119689">v</span>&nbsp;<span class="op" id="8119691">:=</span>&nbsp;<span class="keyword" id="8119694">range</span>&nbsp;<span class="ident" id="8119700">enc</span>&nbsp;<span class="op" id="8119704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119709">if</span>&nbsp;<span class="ident" id="8119712">v</span>&nbsp;<span class="op" id="8119714">!=</span>&nbsp;<span class="ident" id="8119717">tt</span><span class="op" id="8119719">.</span><span class="ident" id="8119720">enc</span><span class="op" id="8119723">[</span><span class="ident" id="8119724">j</span><span class="op" id="8119725">]</span>&nbsp;<span class="op" id="8119727">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119733">t</span><span class="op" id="8119734">.</span><span class="ident" id="8119735">Errorf</span><span class="op" id="8119741">(</span><span class="string" id="8119742">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8119775">,</span>&nbsp;<span class="ident" id="8119777">i</span><span class="op" id="8119778">,</span>&nbsp;<span class="ident" id="8119780">j</span><span class="op" id="8119781">,</span>&nbsp;<span class="ident" id="8119783">v</span><span class="op" id="8119784">,</span>&nbsp;<span class="ident" id="8119786">tt</span><span class="op" id="8119788">.</span><span class="ident" id="8119789">enc</span><span class="op" id="8119792">[</span><span class="ident" id="8119793">j</span><span class="op" id="8119794">]</span><span class="op" id="8119795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119801">continue</span>&nbsp;<span class="ident" id="8119810">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119823">if</span>&nbsp;<span class="ident" id="8119826">dec</span>&nbsp;<span class="op" id="8119830">!=</span>&nbsp;<span class="builtintype" id="8119833">nil</span>&nbsp;<span class="op" id="8119837">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119842">for</span>&nbsp;<span class="ident" id="8119846">j</span><span class="op" id="8119847">,</span>&nbsp;<span class="ident" id="8119849">v</span>&nbsp;<span class="op" id="8119851">:=</span>&nbsp;<span class="keyword" id="8119854">range</span>&nbsp;<span class="ident" id="8119860">dec</span>&nbsp;<span class="op" id="8119864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119870">if</span>&nbsp;<span class="ident" id="8119873">v</span>&nbsp;<span class="op" id="8119875">!=</span>&nbsp;<span class="ident" id="8119878">tt</span><span class="op" id="8119880">.</span><span class="ident" id="8119881">dec</span><span class="op" id="8119884">[</span><span class="ident" id="8119885">j</span><span class="op" id="8119886">]</span>&nbsp;<span class="op" id="8119888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119895">t</span><span class="op" id="8119896">.</span><span class="ident" id="8119897">Errorf</span><span class="op" id="8119903">(</span><span class="string" id="8119904">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8119937">,</span>&nbsp;<span class="ident" id="8119939">i</span><span class="op" id="8119940">,</span>&nbsp;<span class="ident" id="8119942">j</span><span class="op" id="8119943">,</span>&nbsp;<span class="ident" id="8119945">v</span><span class="op" id="8119946">,</span>&nbsp;<span class="ident" id="8119948">tt</span><span class="op" id="8119950">.</span><span class="ident" id="8119951">dec</span><span class="op" id="8119954">[</span><span class="ident" id="8119955">j</span><span class="op" id="8119956">]</span><span class="op" id="8119957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119964">continue</span>&nbsp;<span class="ident" id="8119973">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119979">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119991">}</span><br>
<span class="lineno"></span><span class="op" id="8119993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="8119996">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="8120060">type</span>&nbsp;<span class="ident" id="8120065">CryptTest</span>&nbsp;<span class="keyword" id="8120075">struct</span>&nbsp;<span class="op" id="8120082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8120085">key</span>&nbsp;<span class="op" id="8120089">[</span><span class="op" id="8120090">]</span><span class="builtintype" id="8120091">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8120097">in</span>&nbsp;&nbsp;<span class="op" id="8120101">[</span><span class="op" id="8120102">]</span><span class="builtintype" id="8120103">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8120109">out</span>&nbsp;<span class="op" id="8120113">[</span><span class="op" id="8120114">]</span><span class="builtintype" id="8120115">byte</span><br>
<span class="lineno">250</span><span class="op" id="8120120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8120123">var</span>&nbsp;<span class="ident" id="8120127">encryptTests</span>&nbsp;<span class="op" id="8120140">=</span>&nbsp;<span class="op" id="8120142">[</span><span class="op" id="8120143">]</span><span class="ident" id="8120144">CryptTest</span><span class="op" id="8120153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8120160">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120177">[</span><span class="op" id="8120178">]</span><span class="builtintype" id="8120179">byte</span><span class="op" id="8120183">{</span><span class="num" id="8120184">0x2b</span><span class="op" id="8120188">,</span>&nbsp;<span class="num" id="8120190">0x7e</span><span class="op" id="8120194">,</span>&nbsp;<span class="num" id="8120196">0x15</span><span class="op" id="8120200">,</span>&nbsp;<span class="num" id="8120202">0x16</span><span class="op" id="8120206">,</span>&nbsp;<span class="num" id="8120208">0x28</span><span class="op" id="8120212">,</span>&nbsp;<span class="num" id="8120214">0xae</span><span class="op" id="8120218">,</span>&nbsp;<span class="num" id="8120220">0xd2</span><span class="op" id="8120224">,</span>&nbsp;<span class="num" id="8120226">0xa6</span><span class="op" id="8120230">,</span>&nbsp;<span class="num" id="8120232">0xab</span><span class="op" id="8120236">,</span>&nbsp;<span class="num" id="8120238">0xf7</span><span class="op" id="8120242">,</span>&nbsp;<span class="num" id="8120244">0x15</span><span class="op" id="8120248">,</span>&nbsp;<span class="num" id="8120250">0x88</span><span class="op" id="8120254">,</span>&nbsp;<span class="num" id="8120256">0x09</span><span class="op" id="8120260">,</span>&nbsp;<span class="num" id="8120262">0xcf</span><span class="op" id="8120266">,</span>&nbsp;<span class="num" id="8120268">0x4f</span><span class="op" id="8120272">,</span>&nbsp;<span class="num" id="8120274">0x3c</span><span class="op" id="8120278">}</span><span class="op" id="8120279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120283">[</span><span class="op" id="8120284">]</span><span class="builtintype" id="8120285">byte</span><span class="op" id="8120289">{</span><span class="num" id="8120290">0x32</span><span class="op" id="8120294">,</span>&nbsp;<span class="num" id="8120296">0x43</span><span class="op" id="8120300">,</span>&nbsp;<span class="num" id="8120302">0xf6</span><span class="op" id="8120306">,</span>&nbsp;<span class="num" id="8120308">0xa8</span><span class="op" id="8120312">,</span>&nbsp;<span class="num" id="8120314">0x88</span><span class="op" id="8120318">,</span>&nbsp;<span class="num" id="8120320">0x5a</span><span class="op" id="8120324">,</span>&nbsp;<span class="num" id="8120326">0x30</span><span class="op" id="8120330">,</span>&nbsp;<span class="num" id="8120332">0x8d</span><span class="op" id="8120336">,</span>&nbsp;<span class="num" id="8120338">0x31</span><span class="op" id="8120342">,</span>&nbsp;<span class="num" id="8120344">0x31</span><span class="op" id="8120348">,</span>&nbsp;<span class="num" id="8120350">0x98</span><span class="op" id="8120354">,</span>&nbsp;<span class="num" id="8120356">0xa2</span><span class="op" id="8120360">,</span>&nbsp;<span class="num" id="8120362">0xe0</span><span class="op" id="8120366">,</span>&nbsp;<span class="num" id="8120368">0x37</span><span class="op" id="8120372">,</span>&nbsp;<span class="num" id="8120374">0x07</span><span class="op" id="8120378">,</span>&nbsp;<span class="num" id="8120380">0x34</span><span class="op" id="8120384">}</span><span class="op" id="8120385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120389">[</span><span class="op" id="8120390">]</span><span class="builtintype" id="8120391">byte</span><span class="op" id="8120395">{</span><span class="num" id="8120396">0x39</span><span class="op" id="8120400">,</span>&nbsp;<span class="num" id="8120402">0x25</span><span class="op" id="8120406">,</span>&nbsp;<span class="num" id="8120408">0x84</span><span class="op" id="8120412">,</span>&nbsp;<span class="num" id="8120414">0x1d</span><span class="op" id="8120418">,</span>&nbsp;<span class="num" id="8120420">0x02</span><span class="op" id="8120424">,</span>&nbsp;<span class="num" id="8120426">0xdc</span><span class="op" id="8120430">,</span>&nbsp;<span class="num" id="8120432">0x09</span><span class="op" id="8120436">,</span>&nbsp;<span class="num" id="8120438">0xfb</span><span class="op" id="8120442">,</span>&nbsp;<span class="num" id="8120444">0xdc</span><span class="op" id="8120448">,</span>&nbsp;<span class="num" id="8120450">0x11</span><span class="op" id="8120454">,</span>&nbsp;<span class="num" id="8120456">0x85</span><span class="op" id="8120460">,</span>&nbsp;<span class="num" id="8120462">0x97</span><span class="op" id="8120466">,</span>&nbsp;<span class="num" id="8120468">0x19</span><span class="op" id="8120472">,</span>&nbsp;<span class="num" id="8120474">0x6a</span><span class="op" id="8120478">,</span>&nbsp;<span class="num" id="8120480">0x0b</span><span class="op" id="8120484">,</span>&nbsp;<span class="num" id="8120486">0x32</span><span class="op" id="8120490">}</span><span class="op" id="8120491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120494">}</span><span class="op" id="8120495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120498">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8120502">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120530">[</span><span class="op" id="8120531">]</span><span class="builtintype" id="8120532">byte</span><span class="op" id="8120536">{</span><span class="num" id="8120537">0x00</span><span class="op" id="8120541">,</span>&nbsp;<span class="num" id="8120543">0x01</span><span class="op" id="8120547">,</span>&nbsp;<span class="num" id="8120549">0x02</span><span class="op" id="8120553">,</span>&nbsp;<span class="num" id="8120555">0x03</span><span class="op" id="8120559">,</span>&nbsp;<span class="num" id="8120561">0x04</span><span class="op" id="8120565">,</span>&nbsp;<span class="num" id="8120567">0x05</span><span class="op" id="8120571">,</span>&nbsp;<span class="num" id="8120573">0x06</span><span class="op" id="8120577">,</span>&nbsp;<span class="num" id="8120579">0x07</span><span class="op" id="8120583">,</span>&nbsp;<span class="num" id="8120585">0x08</span><span class="op" id="8120589">,</span>&nbsp;<span class="num" id="8120591">0x09</span><span class="op" id="8120595">,</span>&nbsp;<span class="num" id="8120597">0x0a</span><span class="op" id="8120601">,</span>&nbsp;<span class="num" id="8120603">0x0b</span><span class="op" id="8120607">,</span>&nbsp;<span class="num" id="8120609">0x0c</span><span class="op" id="8120613">,</span>&nbsp;<span class="num" id="8120615">0x0d</span><span class="op" id="8120619">,</span>&nbsp;<span class="num" id="8120621">0x0e</span><span class="op" id="8120625">,</span>&nbsp;<span class="num" id="8120627">0x0f</span><span class="op" id="8120631">}</span><span class="op" id="8120632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120636">[</span><span class="op" id="8120637">]</span><span class="builtintype" id="8120638">byte</span><span class="op" id="8120642">{</span><span class="num" id="8120643">0x00</span><span class="op" id="8120647">,</span>&nbsp;<span class="num" id="8120649">0x11</span><span class="op" id="8120653">,</span>&nbsp;<span class="num" id="8120655">0x22</span><span class="op" id="8120659">,</span>&nbsp;<span class="num" id="8120661">0x33</span><span class="op" id="8120665">,</span>&nbsp;<span class="num" id="8120667">0x44</span><span class="op" id="8120671">,</span>&nbsp;<span class="num" id="8120673">0x55</span><span class="op" id="8120677">,</span>&nbsp;<span class="num" id="8120679">0x66</span><span class="op" id="8120683">,</span>&nbsp;<span class="num" id="8120685">0x77</span><span class="op" id="8120689">,</span>&nbsp;<span class="num" id="8120691">0x88</span><span class="op" id="8120695">,</span>&nbsp;<span class="num" id="8120697">0x99</span><span class="op" id="8120701">,</span>&nbsp;<span class="num" id="8120703">0xaa</span><span class="op" id="8120707">,</span>&nbsp;<span class="num" id="8120709">0xbb</span><span class="op" id="8120713">,</span>&nbsp;<span class="num" id="8120715">0xcc</span><span class="op" id="8120719">,</span>&nbsp;<span class="num" id="8120721">0xdd</span><span class="op" id="8120725">,</span>&nbsp;<span class="num" id="8120727">0xee</span><span class="op" id="8120731">,</span>&nbsp;<span class="num" id="8120733">0xff</span><span class="op" id="8120737">}</span><span class="op" id="8120738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120742">[</span><span class="op" id="8120743">]</span><span class="builtintype" id="8120744">byte</span><span class="op" id="8120748">{</span><span class="num" id="8120749">0x69</span><span class="op" id="8120753">,</span>&nbsp;<span class="num" id="8120755">0xc4</span><span class="op" id="8120759">,</span>&nbsp;<span class="num" id="8120761">0xe0</span><span class="op" id="8120765">,</span>&nbsp;<span class="num" id="8120767">0xd8</span><span class="op" id="8120771">,</span>&nbsp;<span class="num" id="8120773">0x6a</span><span class="op" id="8120777">,</span>&nbsp;<span class="num" id="8120779">0x7b</span><span class="op" id="8120783">,</span>&nbsp;<span class="num" id="8120785">0x04</span><span class="op" id="8120789">,</span>&nbsp;<span class="num" id="8120791">0x30</span><span class="op" id="8120795">,</span>&nbsp;<span class="num" id="8120797">0xd8</span><span class="op" id="8120801">,</span>&nbsp;<span class="num" id="8120803">0xcd</span><span class="op" id="8120807">,</span>&nbsp;<span class="num" id="8120809">0xb7</span><span class="op" id="8120813">,</span>&nbsp;<span class="num" id="8120815">0x80</span><span class="op" id="8120819">,</span>&nbsp;<span class="num" id="8120821">0x70</span><span class="op" id="8120825">,</span>&nbsp;<span class="num" id="8120827">0xb4</span><span class="op" id="8120831">,</span>&nbsp;<span class="num" id="8120833">0xc5</span><span class="op" id="8120837">,</span>&nbsp;<span class="num" id="8120839">0x5a</span><span class="op" id="8120843">}</span><span class="op" id="8120844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120847">}</span><span class="op" id="8120848">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8120855">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8120883">[</span><span class="op" id="8120884">]</span><span class="builtintype" id="8120885">byte</span><span class="op" id="8120889">{</span><span class="num" id="8120890">0x00</span><span class="op" id="8120894">,</span>&nbsp;<span class="num" id="8120896">0x01</span><span class="op" id="8120900">,</span>&nbsp;<span class="num" id="8120902">0x02</span><span class="op" id="8120906">,</span>&nbsp;<span class="num" id="8120908">0x03</span><span class="op" id="8120912">,</span>&nbsp;<span class="num" id="8120914">0x04</span><span class="op" id="8120918">,</span>&nbsp;<span class="num" id="8120920">0x05</span><span class="op" id="8120924">,</span>&nbsp;<span class="num" id="8120926">0x06</span><span class="op" id="8120930">,</span>&nbsp;<span class="num" id="8120932">0x07</span><span class="op" id="8120936">,</span>&nbsp;<span class="num" id="8120938">0x08</span><span class="op" id="8120942">,</span>&nbsp;<span class="num" id="8120944">0x09</span><span class="op" id="8120948">,</span>&nbsp;<span class="num" id="8120950">0x0a</span><span class="op" id="8120954">,</span>&nbsp;<span class="num" id="8120956">0x0b</span><span class="op" id="8120960">,</span>&nbsp;<span class="num" id="8120962">0x0c</span><span class="op" id="8120966">,</span>&nbsp;<span class="num" id="8120968">0x0d</span><span class="op" id="8120972">,</span>&nbsp;<span class="num" id="8120974">0x0e</span><span class="op" id="8120978">,</span>&nbsp;<span class="num" id="8120980">0x0f</span><span class="op" id="8120984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8120989">0x10</span><span class="op" id="8120993">,</span>&nbsp;<span class="num" id="8120995">0x11</span><span class="op" id="8120999">,</span>&nbsp;<span class="num" id="8121001">0x12</span><span class="op" id="8121005">,</span>&nbsp;<span class="num" id="8121007">0x13</span><span class="op" id="8121011">,</span>&nbsp;<span class="num" id="8121013">0x14</span><span class="op" id="8121017">,</span>&nbsp;<span class="num" id="8121019">0x15</span><span class="op" id="8121023">,</span>&nbsp;<span class="num" id="8121025">0x16</span><span class="op" id="8121029">,</span>&nbsp;<span class="num" id="8121031">0x17</span><span class="op" id="8121035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121039">}</span><span class="op" id="8121040">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121044">[</span><span class="op" id="8121045">]</span><span class="builtintype" id="8121046">byte</span><span class="op" id="8121050">{</span><span class="num" id="8121051">0x00</span><span class="op" id="8121055">,</span>&nbsp;<span class="num" id="8121057">0x11</span><span class="op" id="8121061">,</span>&nbsp;<span class="num" id="8121063">0x22</span><span class="op" id="8121067">,</span>&nbsp;<span class="num" id="8121069">0x33</span><span class="op" id="8121073">,</span>&nbsp;<span class="num" id="8121075">0x44</span><span class="op" id="8121079">,</span>&nbsp;<span class="num" id="8121081">0x55</span><span class="op" id="8121085">,</span>&nbsp;<span class="num" id="8121087">0x66</span><span class="op" id="8121091">,</span>&nbsp;<span class="num" id="8121093">0x77</span><span class="op" id="8121097">,</span>&nbsp;<span class="num" id="8121099">0x88</span><span class="op" id="8121103">,</span>&nbsp;<span class="num" id="8121105">0x99</span><span class="op" id="8121109">,</span>&nbsp;<span class="num" id="8121111">0xaa</span><span class="op" id="8121115">,</span>&nbsp;<span class="num" id="8121117">0xbb</span><span class="op" id="8121121">,</span>&nbsp;<span class="num" id="8121123">0xcc</span><span class="op" id="8121127">,</span>&nbsp;<span class="num" id="8121129">0xdd</span><span class="op" id="8121133">,</span>&nbsp;<span class="num" id="8121135">0xee</span><span class="op" id="8121139">,</span>&nbsp;<span class="num" id="8121141">0xff</span><span class="op" id="8121145">}</span><span class="op" id="8121146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121150">[</span><span class="op" id="8121151">]</span><span class="builtintype" id="8121152">byte</span><span class="op" id="8121156">{</span><span class="num" id="8121157">0xdd</span><span class="op" id="8121161">,</span>&nbsp;<span class="num" id="8121163">0xa9</span><span class="op" id="8121167">,</span>&nbsp;<span class="num" id="8121169">0x7c</span><span class="op" id="8121173">,</span>&nbsp;<span class="num" id="8121175">0xa4</span><span class="op" id="8121179">,</span>&nbsp;<span class="num" id="8121181">0x86</span><span class="op" id="8121185">,</span>&nbsp;<span class="num" id="8121187">0x4c</span><span class="op" id="8121191">,</span>&nbsp;<span class="num" id="8121193">0xdf</span><span class="op" id="8121197">,</span>&nbsp;<span class="num" id="8121199">0xe0</span><span class="op" id="8121203">,</span>&nbsp;<span class="num" id="8121205">0x6e</span><span class="op" id="8121209">,</span>&nbsp;<span class="num" id="8121211">0xaf</span><span class="op" id="8121215">,</span>&nbsp;<span class="num" id="8121217">0x70</span><span class="op" id="8121221">,</span>&nbsp;<span class="num" id="8121223">0xa0</span><span class="op" id="8121227">,</span>&nbsp;<span class="num" id="8121229">0xec</span><span class="op" id="8121233">,</span>&nbsp;<span class="num" id="8121235">0x0d</span><span class="op" id="8121239">,</span>&nbsp;<span class="num" id="8121241">0x71</span><span class="op" id="8121245">,</span>&nbsp;<span class="num" id="8121247">0x91</span><span class="op" id="8121251">}</span><span class="op" id="8121252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121255">}</span><span class="op" id="8121256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8121263">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121291">[</span><span class="op" id="8121292">]</span><span class="builtintype" id="8121293">byte</span><span class="op" id="8121297">{</span><span class="num" id="8121298">0x00</span><span class="op" id="8121302">,</span>&nbsp;<span class="num" id="8121304">0x01</span><span class="op" id="8121308">,</span>&nbsp;<span class="num" id="8121310">0x02</span><span class="op" id="8121314">,</span>&nbsp;<span class="num" id="8121316">0x03</span><span class="op" id="8121320">,</span>&nbsp;<span class="num" id="8121322">0x04</span><span class="op" id="8121326">,</span>&nbsp;<span class="num" id="8121328">0x05</span><span class="op" id="8121332">,</span>&nbsp;<span class="num" id="8121334">0x06</span><span class="op" id="8121338">,</span>&nbsp;<span class="num" id="8121340">0x07</span><span class="op" id="8121344">,</span>&nbsp;<span class="num" id="8121346">0x08</span><span class="op" id="8121350">,</span>&nbsp;<span class="num" id="8121352">0x09</span><span class="op" id="8121356">,</span>&nbsp;<span class="num" id="8121358">0x0a</span><span class="op" id="8121362">,</span>&nbsp;<span class="num" id="8121364">0x0b</span><span class="op" id="8121368">,</span>&nbsp;<span class="num" id="8121370">0x0c</span><span class="op" id="8121374">,</span>&nbsp;<span class="num" id="8121376">0x0d</span><span class="op" id="8121380">,</span>&nbsp;<span class="num" id="8121382">0x0e</span><span class="op" id="8121386">,</span>&nbsp;<span class="num" id="8121388">0x0f</span><span class="op" id="8121392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8121397">0x10</span><span class="op" id="8121401">,</span>&nbsp;<span class="num" id="8121403">0x11</span><span class="op" id="8121407">,</span>&nbsp;<span class="num" id="8121409">0x12</span><span class="op" id="8121413">,</span>&nbsp;<span class="num" id="8121415">0x13</span><span class="op" id="8121419">,</span>&nbsp;<span class="num" id="8121421">0x14</span><span class="op" id="8121425">,</span>&nbsp;<span class="num" id="8121427">0x15</span><span class="op" id="8121431">,</span>&nbsp;<span class="num" id="8121433">0x16</span><span class="op" id="8121437">,</span>&nbsp;<span class="num" id="8121439">0x17</span><span class="op" id="8121443">,</span>&nbsp;<span class="num" id="8121445">0x18</span><span class="op" id="8121449">,</span>&nbsp;<span class="num" id="8121451">0x19</span><span class="op" id="8121455">,</span>&nbsp;<span class="num" id="8121457">0x1a</span><span class="op" id="8121461">,</span>&nbsp;<span class="num" id="8121463">0x1b</span><span class="op" id="8121467">,</span>&nbsp;<span class="num" id="8121469">0x1c</span><span class="op" id="8121473">,</span>&nbsp;<span class="num" id="8121475">0x1d</span><span class="op" id="8121479">,</span>&nbsp;<span class="num" id="8121481">0x1e</span><span class="op" id="8121485">,</span>&nbsp;<span class="num" id="8121487">0x1f</span><span class="op" id="8121491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121495">}</span><span class="op" id="8121496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121500">[</span><span class="op" id="8121501">]</span><span class="builtintype" id="8121502">byte</span><span class="op" id="8121506">{</span><span class="num" id="8121507">0x00</span><span class="op" id="8121511">,</span>&nbsp;<span class="num" id="8121513">0x11</span><span class="op" id="8121517">,</span>&nbsp;<span class="num" id="8121519">0x22</span><span class="op" id="8121523">,</span>&nbsp;<span class="num" id="8121525">0x33</span><span class="op" id="8121529">,</span>&nbsp;<span class="num" id="8121531">0x44</span><span class="op" id="8121535">,</span>&nbsp;<span class="num" id="8121537">0x55</span><span class="op" id="8121541">,</span>&nbsp;<span class="num" id="8121543">0x66</span><span class="op" id="8121547">,</span>&nbsp;<span class="num" id="8121549">0x77</span><span class="op" id="8121553">,</span>&nbsp;<span class="num" id="8121555">0x88</span><span class="op" id="8121559">,</span>&nbsp;<span class="num" id="8121561">0x99</span><span class="op" id="8121565">,</span>&nbsp;<span class="num" id="8121567">0xaa</span><span class="op" id="8121571">,</span>&nbsp;<span class="num" id="8121573">0xbb</span><span class="op" id="8121577">,</span>&nbsp;<span class="num" id="8121579">0xcc</span><span class="op" id="8121583">,</span>&nbsp;<span class="num" id="8121585">0xdd</span><span class="op" id="8121589">,</span>&nbsp;<span class="num" id="8121591">0xee</span><span class="op" id="8121595">,</span>&nbsp;<span class="num" id="8121597">0xff</span><span class="op" id="8121601">}</span><span class="op" id="8121602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121606">[</span><span class="op" id="8121607">]</span><span class="builtintype" id="8121608">byte</span><span class="op" id="8121612">{</span><span class="num" id="8121613">0x8e</span><span class="op" id="8121617">,</span>&nbsp;<span class="num" id="8121619">0xa2</span><span class="op" id="8121623">,</span>&nbsp;<span class="num" id="8121625">0xb7</span><span class="op" id="8121629">,</span>&nbsp;<span class="num" id="8121631">0xca</span><span class="op" id="8121635">,</span>&nbsp;<span class="num" id="8121637">0x51</span><span class="op" id="8121641">,</span>&nbsp;<span class="num" id="8121643">0x67</span><span class="op" id="8121647">,</span>&nbsp;<span class="num" id="8121649">0x45</span><span class="op" id="8121653">,</span>&nbsp;<span class="num" id="8121655">0xbf</span><span class="op" id="8121659">,</span>&nbsp;<span class="num" id="8121661">0xea</span><span class="op" id="8121665">,</span>&nbsp;<span class="num" id="8121667">0xfc</span><span class="op" id="8121671">,</span>&nbsp;<span class="num" id="8121673">0x49</span><span class="op" id="8121677">,</span>&nbsp;<span class="num" id="8121679">0x90</span><span class="op" id="8121683">,</span>&nbsp;<span class="num" id="8121685">0x4b</span><span class="op" id="8121689">,</span>&nbsp;<span class="num" id="8121691">0x49</span><span class="op" id="8121695">,</span>&nbsp;<span class="num" id="8121697">0x60</span><span class="op" id="8121701">,</span>&nbsp;<span class="num" id="8121703">0x89</span><span class="op" id="8121707">}</span><span class="op" id="8121708">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8121711">}</span><span class="op" id="8121712">,</span><br>
<span class="lineno"></span><span class="op" id="8121714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8121717">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8121765">func</span>&nbsp;<span class="ident" id="8121770">TestEncryptBlock</span><span class="op" id="8121786">(</span><span class="ident" id="8121787">t</span>&nbsp;<span class="op" id="8121789">*</span><span class="ident" id="8121790">testing</span><span class="op" id="8121797">.</span><span class="ident" id="8121798">T</span><span class="op" id="8121799">)</span>&nbsp;<span class="op" id="8121801">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8121804">for</span>&nbsp;<span class="ident" id="8121808">i</span><span class="op" id="8121809">,</span>&nbsp;<span class="ident" id="8121811">tt</span>&nbsp;<span class="op" id="8121814">:=</span>&nbsp;<span class="keyword" id="8121817">range</span>&nbsp;<span class="ident" id="8121823">encryptTests</span>&nbsp;<span class="op" id="8121836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121840">n</span>&nbsp;<span class="op" id="8121842">:=</span>&nbsp;<span class="builtinfunc" id="8121845">len</span><span class="op" id="8121848">(</span><span class="ident" id="8121849">tt</span><span class="op" id="8121851">.</span><span class="ident" id="8121852">key</span><span class="op" id="8121855">)</span>&nbsp;<span class="op" id="8121857">+</span>&nbsp;<span class="num" id="8121859">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121864">enc</span>&nbsp;<span class="op" id="8121868">:=</span>&nbsp;<span class="builtinfunc" id="8121871">make</span><span class="op" id="8121875">(</span><span class="op" id="8121876">[</span><span class="op" id="8121877">]</span><span class="builtintype" id="8121878">uint32</span><span class="op" id="8121884">,</span>&nbsp;<span class="ident" id="8121886">n</span><span class="op" id="8121887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121891">dec</span>&nbsp;<span class="op" id="8121895">:=</span>&nbsp;<span class="builtinfunc" id="8121898">make</span><span class="op" id="8121902">(</span><span class="op" id="8121903">[</span><span class="op" id="8121904">]</span><span class="builtintype" id="8121905">uint32</span><span class="op" id="8121911">,</span>&nbsp;<span class="ident" id="8121913">n</span><span class="op" id="8121914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121918">expandKey</span><span class="op" id="8121927">(</span><span class="ident" id="8121928">tt</span><span class="op" id="8121930">.</span><span class="ident" id="8121931">key</span><span class="op" id="8121934">,</span>&nbsp;<span class="ident" id="8121936">enc</span><span class="op" id="8121939">,</span>&nbsp;<span class="ident" id="8121941">dec</span><span class="op" id="8121944">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121948">out</span>&nbsp;<span class="op" id="8121952">:=</span>&nbsp;<span class="builtinfunc" id="8121955">make</span><span class="op" id="8121959">(</span><span class="op" id="8121960">[</span><span class="op" id="8121961">]</span><span class="builtintype" id="8121962">byte</span><span class="op" id="8121966">,</span>&nbsp;<span class="builtinfunc" id="8121968">len</span><span class="op" id="8121971">(</span><span class="ident" id="8121972">tt</span><span class="op" id="8121974">.</span><span class="ident" id="8121975">in</span><span class="op" id="8121977">)</span><span class="op" id="8121978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8121982">encryptBlock</span><span class="op" id="8121994">(</span><span class="ident" id="8121995">enc</span><span class="op" id="8121998">,</span>&nbsp;<span class="ident" id="8122000">out</span><span class="op" id="8122003">,</span>&nbsp;<span class="ident" id="8122005">tt</span><span class="op" id="8122007">.</span><span class="ident" id="8122008">in</span><span class="op" id="8122010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122014">for</span>&nbsp;<span class="ident" id="8122018">j</span><span class="op" id="8122019">,</span>&nbsp;<span class="ident" id="8122021">v</span>&nbsp;<span class="op" id="8122023">:=</span>&nbsp;<span class="keyword" id="8122026">range</span>&nbsp;<span class="ident" id="8122032">out</span>&nbsp;<span class="op" id="8122036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122041">if</span>&nbsp;<span class="ident" id="8122044">v</span>&nbsp;<span class="op" id="8122046">!=</span>&nbsp;<span class="ident" id="8122049">tt</span><span class="op" id="8122051">.</span><span class="ident" id="8122052">out</span><span class="op" id="8122055">[</span><span class="ident" id="8122056">j</span><span class="op" id="8122057">]</span>&nbsp;<span class="op" id="8122059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122065">t</span><span class="op" id="8122066">.</span><span class="ident" id="8122067">Errorf</span><span class="op" id="8122073">(</span><span class="string" id="8122074">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8122116">,</span>&nbsp;<span class="ident" id="8122118">i</span><span class="op" id="8122119">,</span>&nbsp;<span class="ident" id="8122121">j</span><span class="op" id="8122122">,</span>&nbsp;<span class="ident" id="8122124">v</span><span class="op" id="8122125">,</span>&nbsp;<span class="ident" id="8122127">tt</span><span class="op" id="8122129">.</span><span class="ident" id="8122130">out</span><span class="op" id="8122133">[</span><span class="ident" id="8122134">j</span><span class="op" id="8122135">]</span><span class="op" id="8122136">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122142">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122158">}</span><br>
<span class="lineno"></span><span class="op" id="8122160">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="8122163">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8122211">func</span>&nbsp;<span class="ident" id="8122216">TestDecryptBlock</span><span class="op" id="8122232">(</span><span class="ident" id="8122233">t</span>&nbsp;<span class="op" id="8122235">*</span><span class="ident" id="8122236">testing</span><span class="op" id="8122243">.</span><span class="ident" id="8122244">T</span><span class="op" id="8122245">)</span>&nbsp;<span class="op" id="8122247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122250">for</span>&nbsp;<span class="ident" id="8122254">i</span><span class="op" id="8122255">,</span>&nbsp;<span class="ident" id="8122257">tt</span>&nbsp;<span class="op" id="8122260">:=</span>&nbsp;<span class="keyword" id="8122263">range</span>&nbsp;<span class="ident" id="8122269">encryptTests</span>&nbsp;<span class="op" id="8122282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122286">n</span>&nbsp;<span class="op" id="8122288">:=</span>&nbsp;<span class="builtinfunc" id="8122291">len</span><span class="op" id="8122294">(</span><span class="ident" id="8122295">tt</span><span class="op" id="8122297">.</span><span class="ident" id="8122298">key</span><span class="op" id="8122301">)</span>&nbsp;<span class="op" id="8122303">+</span>&nbsp;<span class="num" id="8122305">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122310">enc</span>&nbsp;<span class="op" id="8122314">:=</span>&nbsp;<span class="builtinfunc" id="8122317">make</span><span class="op" id="8122321">(</span><span class="op" id="8122322">[</span><span class="op" id="8122323">]</span><span class="builtintype" id="8122324">uint32</span><span class="op" id="8122330">,</span>&nbsp;<span class="ident" id="8122332">n</span><span class="op" id="8122333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122337">dec</span>&nbsp;<span class="op" id="8122341">:=</span>&nbsp;<span class="builtinfunc" id="8122344">make</span><span class="op" id="8122348">(</span><span class="op" id="8122349">[</span><span class="op" id="8122350">]</span><span class="builtintype" id="8122351">uint32</span><span class="op" id="8122357">,</span>&nbsp;<span class="ident" id="8122359">n</span><span class="op" id="8122360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122364">expandKey</span><span class="op" id="8122373">(</span><span class="ident" id="8122374">tt</span><span class="op" id="8122376">.</span><span class="ident" id="8122377">key</span><span class="op" id="8122380">,</span>&nbsp;<span class="ident" id="8122382">enc</span><span class="op" id="8122385">,</span>&nbsp;<span class="ident" id="8122387">dec</span><span class="op" id="8122390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122394">plain</span>&nbsp;<span class="op" id="8122400">:=</span>&nbsp;<span class="builtinfunc" id="8122403">make</span><span class="op" id="8122407">(</span><span class="op" id="8122408">[</span><span class="op" id="8122409">]</span><span class="builtintype" id="8122410">byte</span><span class="op" id="8122414">,</span>&nbsp;<span class="builtinfunc" id="8122416">len</span><span class="op" id="8122419">(</span><span class="ident" id="8122420">tt</span><span class="op" id="8122422">.</span><span class="ident" id="8122423">in</span><span class="op" id="8122425">)</span><span class="op" id="8122426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122430">decryptBlock</span><span class="op" id="8122442">(</span><span class="ident" id="8122443">dec</span><span class="op" id="8122446">,</span>&nbsp;<span class="ident" id="8122448">plain</span><span class="op" id="8122453">,</span>&nbsp;<span class="ident" id="8122455">tt</span><span class="op" id="8122457">.</span><span class="ident" id="8122458">out</span><span class="op" id="8122461">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122465">for</span>&nbsp;<span class="ident" id="8122469">j</span><span class="op" id="8122470">,</span>&nbsp;<span class="ident" id="8122472">v</span>&nbsp;<span class="op" id="8122474">:=</span>&nbsp;<span class="keyword" id="8122477">range</span>&nbsp;<span class="ident" id="8122483">plain</span>&nbsp;<span class="op" id="8122489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122494">if</span>&nbsp;<span class="ident" id="8122497">v</span>&nbsp;<span class="op" id="8122499">!=</span>&nbsp;<span class="ident" id="8122502">tt</span><span class="op" id="8122504">.</span><span class="ident" id="8122505">in</span><span class="op" id="8122507">[</span><span class="ident" id="8122508">j</span><span class="op" id="8122509">]</span>&nbsp;<span class="op" id="8122511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122517">t</span><span class="op" id="8122518">.</span><span class="ident" id="8122519">Errorf</span><span class="op" id="8122525">(</span><span class="string" id="8122526">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8122570">,</span>&nbsp;<span class="ident" id="8122572">i</span><span class="op" id="8122573">,</span>&nbsp;<span class="ident" id="8122575">j</span><span class="op" id="8122576">,</span>&nbsp;<span class="ident" id="8122578">v</span><span class="op" id="8122579">,</span>&nbsp;<span class="ident" id="8122581">tt</span><span class="op" id="8122583">.</span><span class="ident" id="8122584">in</span><span class="op" id="8122586">[</span><span class="ident" id="8122587">j</span><span class="op" id="8122588">]</span><span class="op" id="8122589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122595">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122604">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122611">}</span><br>
<span class="lineno"></span><span class="op" id="8122613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8122616">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="8122673">func</span>&nbsp;<span class="ident" id="8122678">TestCipherEncrypt</span><span class="op" id="8122695">(</span><span class="ident" id="8122696">t</span>&nbsp;<span class="op" id="8122698">*</span><span class="ident" id="8122699">testing</span><span class="op" id="8122706">.</span><span class="ident" id="8122707">T</span><span class="op" id="8122708">)</span>&nbsp;<span class="op" id="8122710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122713">for</span>&nbsp;<span class="ident" id="8122717">i</span><span class="op" id="8122718">,</span>&nbsp;<span class="ident" id="8122720">tt</span>&nbsp;<span class="op" id="8122723">:=</span>&nbsp;<span class="keyword" id="8122726">range</span>&nbsp;<span class="ident" id="8122732">encryptTests</span>&nbsp;<span class="op" id="8122745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122749">c</span><span class="op" id="8122750">,</span>&nbsp;<span class="ident" id="8122752">err</span>&nbsp;<span class="op" id="8122756">:=</span>&nbsp;<span class="ident" id="8122759">NewCipher</span><span class="op" id="8122768">(</span><span class="ident" id="8122769">tt</span><span class="op" id="8122771">.</span><span class="ident" id="8122772">key</span><span class="op" id="8122775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122779">if</span>&nbsp;<span class="ident" id="8122782">err</span>&nbsp;<span class="op" id="8122786">!=</span>&nbsp;<span class="builtintype" id="8122789">nil</span>&nbsp;<span class="op" id="8122793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122798">t</span><span class="op" id="8122799">.</span><span class="ident" id="8122800">Errorf</span><span class="op" id="8122806">(</span><span class="string" id="8122807">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8122833">,</span>&nbsp;<span class="builtinfunc" id="8122835">len</span><span class="op" id="8122838">(</span><span class="ident" id="8122839">tt</span><span class="op" id="8122841">.</span><span class="ident" id="8122842">key</span><span class="op" id="8122845">)</span><span class="op" id="8122846">,</span>&nbsp;<span class="ident" id="8122848">err</span><span class="op" id="8122851">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122856">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8122867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122871">out</span>&nbsp;<span class="op" id="8122875">:=</span>&nbsp;<span class="builtinfunc" id="8122878">make</span><span class="op" id="8122882">(</span><span class="op" id="8122883">[</span><span class="op" id="8122884">]</span><span class="builtintype" id="8122885">byte</span><span class="op" id="8122889">,</span>&nbsp;<span class="builtinfunc" id="8122891">len</span><span class="op" id="8122894">(</span><span class="ident" id="8122895">tt</span><span class="op" id="8122897">.</span><span class="ident" id="8122898">in</span><span class="op" id="8122900">)</span><span class="op" id="8122901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122905">c</span><span class="op" id="8122906">.</span><span class="ident" id="8122907">Encrypt</span><span class="op" id="8122914">(</span><span class="ident" id="8122915">out</span><span class="op" id="8122918">,</span>&nbsp;<span class="ident" id="8122920">tt</span><span class="op" id="8122922">.</span><span class="ident" id="8122923">in</span><span class="op" id="8122925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122929">for</span>&nbsp;<span class="ident" id="8122933">j</span><span class="op" id="8122934">,</span>&nbsp;<span class="ident" id="8122936">v</span>&nbsp;<span class="op" id="8122938">:=</span>&nbsp;<span class="keyword" id="8122941">range</span>&nbsp;<span class="ident" id="8122947">out</span>&nbsp;<span class="op" id="8122951">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8122956">if</span>&nbsp;<span class="ident" id="8122959">v</span>&nbsp;<span class="op" id="8122961">!=</span>&nbsp;<span class="ident" id="8122964">tt</span><span class="op" id="8122966">.</span><span class="ident" id="8122967">out</span><span class="op" id="8122970">[</span><span class="ident" id="8122971">j</span><span class="op" id="8122972">]</span>&nbsp;<span class="op" id="8122974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8122980">t</span><span class="op" id="8122981">.</span><span class="ident" id="8122982">Errorf</span><span class="op" id="8122988">(</span><span class="string" id="8122989">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8123033">,</span>&nbsp;<span class="ident" id="8123035">i</span><span class="op" id="8123036">,</span>&nbsp;<span class="ident" id="8123038">j</span><span class="op" id="8123039">,</span>&nbsp;<span class="ident" id="8123041">v</span><span class="op" id="8123042">,</span>&nbsp;<span class="ident" id="8123044">tt</span><span class="op" id="8123046">.</span><span class="ident" id="8123047">out</span><span class="op" id="8123050">[</span><span class="ident" id="8123051">j</span><span class="op" id="8123052">]</span><span class="op" id="8123053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123059">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123072">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123075">}</span><br>
<span class="lineno"></span><span class="op" id="8123077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8123080">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8123130">func</span>&nbsp;<span class="ident" id="8123135">TestCipherDecrypt</span><span class="op" id="8123152">(</span><span class="ident" id="8123153">t</span>&nbsp;<span class="op" id="8123155">*</span><span class="ident" id="8123156">testing</span><span class="op" id="8123163">.</span><span class="ident" id="8123164">T</span><span class="op" id="8123165">)</span>&nbsp;<span class="op" id="8123167">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123170">for</span>&nbsp;<span class="ident" id="8123174">i</span><span class="op" id="8123175">,</span>&nbsp;<span class="ident" id="8123177">tt</span>&nbsp;<span class="op" id="8123180">:=</span>&nbsp;<span class="keyword" id="8123183">range</span>&nbsp;<span class="ident" id="8123189">encryptTests</span>&nbsp;<span class="op" id="8123202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123206">c</span><span class="op" id="8123207">,</span>&nbsp;<span class="ident" id="8123209">err</span>&nbsp;<span class="op" id="8123213">:=</span>&nbsp;<span class="ident" id="8123216">NewCipher</span><span class="op" id="8123225">(</span><span class="ident" id="8123226">tt</span><span class="op" id="8123228">.</span><span class="ident" id="8123229">key</span><span class="op" id="8123232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123236">if</span>&nbsp;<span class="ident" id="8123239">err</span>&nbsp;<span class="op" id="8123243">!=</span>&nbsp;<span class="builtintype" id="8123246">nil</span>&nbsp;<span class="op" id="8123250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123255">t</span><span class="op" id="8123256">.</span><span class="ident" id="8123257">Errorf</span><span class="op" id="8123263">(</span><span class="string" id="8123264">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8123290">,</span>&nbsp;<span class="builtinfunc" id="8123292">len</span><span class="op" id="8123295">(</span><span class="ident" id="8123296">tt</span><span class="op" id="8123298">.</span><span class="ident" id="8123299">key</span><span class="op" id="8123302">)</span><span class="op" id="8123303">,</span>&nbsp;<span class="ident" id="8123305">err</span><span class="op" id="8123308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123313">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123328">plain</span>&nbsp;<span class="op" id="8123334">:=</span>&nbsp;<span class="builtinfunc" id="8123337">make</span><span class="op" id="8123341">(</span><span class="op" id="8123342">[</span><span class="op" id="8123343">]</span><span class="builtintype" id="8123344">byte</span><span class="op" id="8123348">,</span>&nbsp;<span class="builtinfunc" id="8123350">len</span><span class="op" id="8123353">(</span><span class="ident" id="8123354">tt</span><span class="op" id="8123356">.</span><span class="ident" id="8123357">in</span><span class="op" id="8123359">)</span><span class="op" id="8123360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123364">c</span><span class="op" id="8123365">.</span><span class="ident" id="8123366">Decrypt</span><span class="op" id="8123373">(</span><span class="ident" id="8123374">plain</span><span class="op" id="8123379">,</span>&nbsp;<span class="ident" id="8123381">tt</span><span class="op" id="8123383">.</span><span class="ident" id="8123384">out</span><span class="op" id="8123387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123391">for</span>&nbsp;<span class="ident" id="8123395">j</span><span class="op" id="8123396">,</span>&nbsp;<span class="ident" id="8123398">v</span>&nbsp;<span class="op" id="8123400">:=</span>&nbsp;<span class="keyword" id="8123403">range</span>&nbsp;<span class="ident" id="8123409">plain</span>&nbsp;<span class="op" id="8123415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123420">if</span>&nbsp;<span class="ident" id="8123423">v</span>&nbsp;<span class="op" id="8123425">!=</span>&nbsp;<span class="ident" id="8123428">tt</span><span class="op" id="8123430">.</span><span class="ident" id="8123431">in</span><span class="op" id="8123433">[</span><span class="ident" id="8123434">j</span><span class="op" id="8123435">]</span>&nbsp;<span class="op" id="8123437">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123443">t</span><span class="op" id="8123444">.</span><span class="ident" id="8123445">Errorf</span><span class="op" id="8123451">(</span><span class="string" id="8123452">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8123496">,</span>&nbsp;<span class="ident" id="8123498">i</span><span class="op" id="8123499">,</span>&nbsp;<span class="ident" id="8123501">j</span><span class="op" id="8123502">,</span>&nbsp;<span class="ident" id="8123504">v</span><span class="op" id="8123505">,</span>&nbsp;<span class="ident" id="8123507">tt</span><span class="op" id="8123509">.</span><span class="ident" id="8123510">in</span><span class="op" id="8123512">[</span><span class="ident" id="8123513">j</span><span class="op" id="8123514">]</span><span class="op" id="8123515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8123521">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8123537">}</span><br>
<span class="lineno">355</span><span class="op" id="8123539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8123542">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="8123570">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="8123602">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="8123621">func</span>&nbsp;<span class="ident" id="8123626">TestShortBlocks</span><span class="op" id="8123641">(</span><span class="ident" id="8123642">t</span>&nbsp;<span class="op" id="8123644">*</span><span class="ident" id="8123645">testing</span><span class="op" id="8123652">.</span><span class="ident" id="8123653">T</span><span class="op" id="8123654">)</span>&nbsp;<span class="op" id="8123656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123659">bytes</span>&nbsp;<span class="op" id="8123665">:=</span>&nbsp;<span class="keyword" id="8123668">func</span><span class="op" id="8123672">(</span><span class="ident" id="8123673">n</span>&nbsp;<span class="builtintype" id="8123675">int</span><span class="op" id="8123678">)</span>&nbsp;<span class="op" id="8123680">[</span><span class="op" id="8123681">]</span><span class="builtintype" id="8123682">byte</span>&nbsp;<span class="op" id="8123687">{</span>&nbsp;<span class="keyword" id="8123689">return</span>&nbsp;<span class="builtinfunc" id="8123696">make</span><span class="op" id="8123700">(</span><span class="op" id="8123701">[</span><span class="op" id="8123702">]</span><span class="builtintype" id="8123703">byte</span><span class="op" id="8123707">,</span>&nbsp;<span class="ident" id="8123709">n</span><span class="op" id="8123710">)</span>&nbsp;<span class="op" id="8123712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123716">c</span><span class="op" id="8123717">,</span>&nbsp;<span class="ident" id="8123719">_</span>&nbsp;<span class="op" id="8123721">:=</span>&nbsp;<span class="ident" id="8123724">NewCipher</span><span class="op" id="8123733">(</span><span class="ident" id="8123734">bytes</span><span class="op" id="8123739">(</span><span class="num" id="8123740">16</span><span class="op" id="8123742">)</span><span class="op" id="8123743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123747">mustPanic</span><span class="op" id="8123756">(</span><span class="ident" id="8123757">t</span><span class="op" id="8123758">,</span>&nbsp;<span class="string" id="8123760">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8123794">,</span>&nbsp;<span class="keyword" id="8123796">func</span><span class="op" id="8123800">(</span><span class="op" id="8123801">)</span>&nbsp;<span class="op" id="8123803">{</span>&nbsp;<span class="ident" id="8123805">c</span><span class="op" id="8123806">.</span><span class="ident" id="8123807">Encrypt</span><span class="op" id="8123814">(</span><span class="ident" id="8123815">bytes</span><span class="op" id="8123820">(</span><span class="num" id="8123821">1</span><span class="op" id="8123822">)</span><span class="op" id="8123823">,</span>&nbsp;<span class="ident" id="8123825">bytes</span><span class="op" id="8123830">(</span><span class="num" id="8123831">1</span><span class="op" id="8123832">)</span><span class="op" id="8123833">)</span>&nbsp;<span class="op" id="8123835">}</span><span class="op" id="8123836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123839">mustPanic</span><span class="op" id="8123848">(</span><span class="ident" id="8123849">t</span><span class="op" id="8123850">,</span>&nbsp;<span class="string" id="8123852">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8123886">,</span>&nbsp;<span class="keyword" id="8123888">func</span><span class="op" id="8123892">(</span><span class="op" id="8123893">)</span>&nbsp;<span class="op" id="8123895">{</span>&nbsp;<span class="ident" id="8123897">c</span><span class="op" id="8123898">.</span><span class="ident" id="8123899">Decrypt</span><span class="op" id="8123906">(</span><span class="ident" id="8123907">bytes</span><span class="op" id="8123912">(</span><span class="num" id="8123913">1</span><span class="op" id="8123914">)</span><span class="op" id="8123915">,</span>&nbsp;<span class="ident" id="8123917">bytes</span><span class="op" id="8123922">(</span><span class="num" id="8123923">1</span><span class="op" id="8123924">)</span><span class="op" id="8123925">)</span>&nbsp;<span class="op" id="8123927">}</span><span class="op" id="8123928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8123931">mustPanic</span><span class="op" id="8123940">(</span><span class="ident" id="8123941">t</span><span class="op" id="8123942">,</span>&nbsp;<span class="string" id="8123944">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8123978">,</span>&nbsp;<span class="keyword" id="8123980">func</span><span class="op" id="8123984">(</span><span class="op" id="8123985">)</span>&nbsp;<span class="op" id="8123987">{</span>&nbsp;<span class="ident" id="8123989">c</span><span class="op" id="8123990">.</span><span class="ident" id="8123991">Encrypt</span><span class="op" id="8123998">(</span><span class="ident" id="8123999">bytes</span><span class="op" id="8124004">(</span><span class="num" id="8124005">100</span><span class="op" id="8124008">)</span><span class="op" id="8124009">,</span>&nbsp;<span class="ident" id="8124011">bytes</span><span class="op" id="8124016">(</span><span class="num" id="8124017">1</span><span class="op" id="8124018">)</span><span class="op" id="8124019">)</span>&nbsp;<span class="op" id="8124021">}</span><span class="op" id="8124022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124025">mustPanic</span><span class="op" id="8124034">(</span><span class="ident" id="8124035">t</span><span class="op" id="8124036">,</span>&nbsp;<span class="string" id="8124038">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8124072">,</span>&nbsp;<span class="keyword" id="8124074">func</span><span class="op" id="8124078">(</span><span class="op" id="8124079">)</span>&nbsp;<span class="op" id="8124081">{</span>&nbsp;<span class="ident" id="8124083">c</span><span class="op" id="8124084">.</span><span class="ident" id="8124085">Decrypt</span><span class="op" id="8124092">(</span><span class="ident" id="8124093">bytes</span><span class="op" id="8124098">(</span><span class="num" id="8124099">100</span><span class="op" id="8124102">)</span><span class="op" id="8124103">,</span>&nbsp;<span class="ident" id="8124105">bytes</span><span class="op" id="8124110">(</span><span class="num" id="8124111">1</span><span class="op" id="8124112">)</span><span class="op" id="8124113">)</span>&nbsp;<span class="op" id="8124115">}</span><span class="op" id="8124116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124119">mustPanic</span><span class="op" id="8124128">(</span><span class="ident" id="8124129">t</span><span class="op" id="8124130">,</span>&nbsp;<span class="string" id="8124132">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8124167">,</span>&nbsp;<span class="keyword" id="8124169">func</span><span class="op" id="8124173">(</span><span class="op" id="8124174">)</span>&nbsp;<span class="op" id="8124176">{</span>&nbsp;<span class="ident" id="8124178">c</span><span class="op" id="8124179">.</span><span class="ident" id="8124180">Encrypt</span><span class="op" id="8124187">(</span><span class="ident" id="8124188">bytes</span><span class="op" id="8124193">(</span><span class="num" id="8124194">1</span><span class="op" id="8124195">)</span><span class="op" id="8124196">,</span>&nbsp;<span class="ident" id="8124198">bytes</span><span class="op" id="8124203">(</span><span class="num" id="8124204">100</span><span class="op" id="8124207">)</span><span class="op" id="8124208">)</span>&nbsp;<span class="op" id="8124210">}</span><span class="op" id="8124211">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124214">mustPanic</span><span class="op" id="8124223">(</span><span class="ident" id="8124224">t</span><span class="op" id="8124225">,</span>&nbsp;<span class="string" id="8124227">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8124262">,</span>&nbsp;<span class="keyword" id="8124264">func</span><span class="op" id="8124268">(</span><span class="op" id="8124269">)</span>&nbsp;<span class="op" id="8124271">{</span>&nbsp;<span class="ident" id="8124273">c</span><span class="op" id="8124274">.</span><span class="ident" id="8124275">Decrypt</span><span class="op" id="8124282">(</span><span class="ident" id="8124283">bytes</span><span class="op" id="8124288">(</span><span class="num" id="8124289">1</span><span class="op" id="8124290">)</span><span class="op" id="8124291">,</span>&nbsp;<span class="ident" id="8124293">bytes</span><span class="op" id="8124298">(</span><span class="num" id="8124299">100</span><span class="op" id="8124302">)</span><span class="op" id="8124303">)</span>&nbsp;<span class="op" id="8124305">}</span><span class="op" id="8124306">)</span><br>
<span class="lineno"></span><span class="op" id="8124308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8124311">func</span>&nbsp;<span class="ident" id="8124316">mustPanic</span><span class="op" id="8124325">(</span><span class="ident" id="8124326">t</span>&nbsp;<span class="op" id="8124328">*</span><span class="ident" id="8124329">testing</span><span class="op" id="8124336">.</span><span class="ident" id="8124337">T</span><span class="op" id="8124338">,</span>&nbsp;<span class="ident" id="8124340">msg</span>&nbsp;<span class="builtintype" id="8124344">string</span><span class="op" id="8124350">,</span>&nbsp;<span class="ident" id="8124352">f</span>&nbsp;<span class="keyword" id="8124354">func</span><span class="op" id="8124358">(</span><span class="op" id="8124359">)</span><span class="op" id="8124360">)</span>&nbsp;<span class="op" id="8124362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8124365">defer</span>&nbsp;<span class="keyword" id="8124371">func</span><span class="op" id="8124375">(</span><span class="op" id="8124376">)</span>&nbsp;<span class="op" id="8124378">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124382">err</span>&nbsp;<span class="op" id="8124386">:=</span>&nbsp;<span class="builtinfunc" id="8124389">recover</span><span class="op" id="8124396">(</span><span class="op" id="8124397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8124401">if</span>&nbsp;<span class="ident" id="8124404">err</span>&nbsp;<span class="op" id="8124408">==</span>&nbsp;<span class="builtintype" id="8124411">nil</span>&nbsp;<span class="op" id="8124415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124420">t</span><span class="op" id="8124421">.</span><span class="ident" id="8124422">Errorf</span><span class="op" id="8124428">(</span><span class="string" id="8124429">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8124464">,</span>&nbsp;<span class="ident" id="8124466">msg</span><span class="op" id="8124469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124473">}</span>&nbsp;<span class="keyword" id="8124475">else</span>&nbsp;<span class="keyword" id="8124480">if</span>&nbsp;<span class="ident" id="8124483">err</span>&nbsp;<span class="op" id="8124487">!=</span>&nbsp;<span class="ident" id="8124490">msg</span>&nbsp;<span class="op" id="8124494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124499">t</span><span class="op" id="8124500">.</span><span class="ident" id="8124501">Errorf</span><span class="op" id="8124507">(</span><span class="string" id="8124508">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8124533">,</span>&nbsp;<span class="ident" id="8124535">err</span><span class="op" id="8124538">,</span>&nbsp;<span class="ident" id="8124540">msg</span><span class="op" id="8124543">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124550">}</span><span class="op" id="8124551">(</span><span class="op" id="8124552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124555">f</span><span class="op" id="8124556">(</span><span class="op" id="8124557">)</span><br>
<span class="lineno"></span><span class="op" id="8124559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="8124562">func</span>&nbsp;<span class="ident" id="8124567">BenchmarkEncrypt</span><span class="op" id="8124583">(</span><span class="ident" id="8124584">b</span>&nbsp;<span class="op" id="8124586">*</span><span class="ident" id="8124587">testing</span><span class="op" id="8124594">.</span><span class="ident" id="8124595">B</span><span class="op" id="8124596">)</span>&nbsp;<span class="op" id="8124598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124601">tt</span>&nbsp;<span class="op" id="8124604">:=</span>&nbsp;<span class="ident" id="8124607">encryptTests</span><span class="op" id="8124619">[</span><span class="num" id="8124620">0</span><span class="op" id="8124621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124624">c</span><span class="op" id="8124625">,</span>&nbsp;<span class="ident" id="8124627">err</span>&nbsp;<span class="op" id="8124631">:=</span>&nbsp;<span class="ident" id="8124634">NewCipher</span><span class="op" id="8124643">(</span><span class="ident" id="8124644">tt</span><span class="op" id="8124646">.</span><span class="ident" id="8124647">key</span><span class="op" id="8124650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8124653">if</span>&nbsp;<span class="ident" id="8124656">err</span>&nbsp;<span class="op" id="8124660">!=</span>&nbsp;<span class="builtintype" id="8124663">nil</span>&nbsp;<span class="op" id="8124667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124671">b</span><span class="op" id="8124672">.</span><span class="ident" id="8124673">Fatal</span><span class="op" id="8124678">(</span><span class="string" id="8124679">&#34;NewCipher:&#34;</span><span class="op" id="8124691">,</span>&nbsp;<span class="ident" id="8124693">err</span><span class="op" id="8124696">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124702">out</span>&nbsp;<span class="op" id="8124706">:=</span>&nbsp;<span class="builtinfunc" id="8124709">make</span><span class="op" id="8124713">(</span><span class="op" id="8124714">[</span><span class="op" id="8124715">]</span><span class="builtintype" id="8124716">byte</span><span class="op" id="8124720">,</span>&nbsp;<span class="builtinfunc" id="8124722">len</span><span class="op" id="8124725">(</span><span class="ident" id="8124726">tt</span><span class="op" id="8124728">.</span><span class="ident" id="8124729">in</span><span class="op" id="8124731">)</span><span class="op" id="8124732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124735">b</span><span class="op" id="8124736">.</span><span class="ident" id="8124737">SetBytes</span><span class="op" id="8124745">(</span><span class="ident" id="8124746">int64</span><span class="op" id="8124751">(</span><span class="builtinfunc" id="8124752">len</span><span class="op" id="8124755">(</span><span class="ident" id="8124756">out</span><span class="op" id="8124759">)</span><span class="op" id="8124760">)</span><span class="op" id="8124761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124764">b</span><span class="op" id="8124765">.</span><span class="ident" id="8124766">ResetTimer</span><span class="op" id="8124776">(</span><span class="op" id="8124777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8124780">for</span>&nbsp;<span class="ident" id="8124784">i</span>&nbsp;<span class="op" id="8124786">:=</span>&nbsp;<span class="num" id="8124789">0</span><span class="op" id="8124790">;</span>&nbsp;<span class="ident" id="8124792">i</span>&nbsp;<span class="op" id="8124794">&lt;</span>&nbsp;<span class="ident" id="8124796">b</span><span class="op" id="8124797">.</span><span class="ident" id="8124798">N</span><span class="op" id="8124799">;</span>&nbsp;<span class="ident" id="8124801">i</span><span class="op" id="8124802">++</span>&nbsp;<span class="op" id="8124805">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124809">c</span><span class="op" id="8124810">.</span><span class="ident" id="8124811">Encrypt</span><span class="op" id="8124818">(</span><span class="ident" id="8124819">out</span><span class="op" id="8124822">,</span>&nbsp;<span class="ident" id="8124824">tt</span><span class="op" id="8124826">.</span><span class="ident" id="8124827">in</span><span class="op" id="8124829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124832">}</span><br>
<span class="lineno"></span><span class="op" id="8124834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8124837">func</span>&nbsp;<span class="ident" id="8124842">BenchmarkDecrypt</span><span class="op" id="8124858">(</span><span class="ident" id="8124859">b</span>&nbsp;<span class="op" id="8124861">*</span><span class="ident" id="8124862">testing</span><span class="op" id="8124869">.</span><span class="ident" id="8124870">B</span><span class="op" id="8124871">)</span>&nbsp;<span class="op" id="8124873">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124876">tt</span>&nbsp;<span class="op" id="8124879">:=</span>&nbsp;<span class="ident" id="8124882">encryptTests</span><span class="op" id="8124894">[</span><span class="num" id="8124895">0</span><span class="op" id="8124896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124899">c</span><span class="op" id="8124900">,</span>&nbsp;<span class="ident" id="8124902">err</span>&nbsp;<span class="op" id="8124906">:=</span>&nbsp;<span class="ident" id="8124909">NewCipher</span><span class="op" id="8124918">(</span><span class="ident" id="8124919">tt</span><span class="op" id="8124921">.</span><span class="ident" id="8124922">key</span><span class="op" id="8124925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8124928">if</span>&nbsp;<span class="ident" id="8124931">err</span>&nbsp;<span class="op" id="8124935">!=</span>&nbsp;<span class="builtintype" id="8124938">nil</span>&nbsp;<span class="op" id="8124942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124946">b</span><span class="op" id="8124947">.</span><span class="ident" id="8124948">Fatal</span><span class="op" id="8124953">(</span><span class="string" id="8124954">&#34;NewCipher:&#34;</span><span class="op" id="8124966">,</span>&nbsp;<span class="ident" id="8124968">err</span><span class="op" id="8124971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8124974">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8124977">out</span>&nbsp;<span class="op" id="8124981">:=</span>&nbsp;<span class="builtinfunc" id="8124984">make</span><span class="op" id="8124988">(</span><span class="op" id="8124989">[</span><span class="op" id="8124990">]</span><span class="builtintype" id="8124991">byte</span><span class="op" id="8124995">,</span>&nbsp;<span class="builtinfunc" id="8124997">len</span><span class="op" id="8125000">(</span><span class="ident" id="8125001">tt</span><span class="op" id="8125003">.</span><span class="ident" id="8125004">out</span><span class="op" id="8125007">)</span><span class="op" id="8125008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125011">b</span><span class="op" id="8125012">.</span><span class="ident" id="8125013">SetBytes</span><span class="op" id="8125021">(</span><span class="ident" id="8125022">int64</span><span class="op" id="8125027">(</span><span class="builtinfunc" id="8125028">len</span><span class="op" id="8125031">(</span><span class="ident" id="8125032">out</span><span class="op" id="8125035">)</span><span class="op" id="8125036">)</span><span class="op" id="8125037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125040">b</span><span class="op" id="8125041">.</span><span class="ident" id="8125042">ResetTimer</span><span class="op" id="8125052">(</span><span class="op" id="8125053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8125056">for</span>&nbsp;<span class="ident" id="8125060">i</span>&nbsp;<span class="op" id="8125062">:=</span>&nbsp;<span class="num" id="8125065">0</span><span class="op" id="8125066">;</span>&nbsp;<span class="ident" id="8125068">i</span>&nbsp;<span class="op" id="8125070">&lt;</span>&nbsp;<span class="ident" id="8125072">b</span><span class="op" id="8125073">.</span><span class="ident" id="8125074">N</span><span class="op" id="8125075">;</span>&nbsp;<span class="ident" id="8125077">i</span><span class="op" id="8125078">++</span>&nbsp;<span class="op" id="8125081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125085">c</span><span class="op" id="8125086">.</span><span class="ident" id="8125087">Decrypt</span><span class="op" id="8125094">(</span><span class="ident" id="8125095">out</span><span class="op" id="8125098">,</span>&nbsp;<span class="ident" id="8125100">tt</span><span class="op" id="8125102">.</span><span class="ident" id="8125103">out</span><span class="op" id="8125106">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8125109">}</span><br>
<span class="lineno"></span><span class="op" id="8125111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125114">func</span>&nbsp;<span class="ident" id="8125119">BenchmarkExpand</span><span class="op" id="8125134">(</span><span class="ident" id="8125135">b</span>&nbsp;<span class="op" id="8125137">*</span><span class="ident" id="8125138">testing</span><span class="op" id="8125145">.</span><span class="ident" id="8125146">B</span><span class="op" id="8125147">)</span>&nbsp;<span class="op" id="8125149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125152">tt</span>&nbsp;<span class="op" id="8125155">:=</span>&nbsp;<span class="ident" id="8125158">encryptTests</span><span class="op" id="8125170">[</span><span class="num" id="8125171">0</span><span class="op" id="8125172">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125175">n</span>&nbsp;<span class="op" id="8125177">:=</span>&nbsp;<span class="builtinfunc" id="8125180">len</span><span class="op" id="8125183">(</span><span class="ident" id="8125184">tt</span><span class="op" id="8125186">.</span><span class="ident" id="8125187">key</span><span class="op" id="8125190">)</span>&nbsp;<span class="op" id="8125192">+</span>&nbsp;<span class="num" id="8125194">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125198">c</span>&nbsp;<span class="op" id="8125200">:=</span>&nbsp;<span class="op" id="8125203">&amp;</span><span class="ident" id="8125204">aesCipher</span><span class="op" id="8125213">{</span><span class="builtinfunc" id="8125214">make</span><span class="op" id="8125218">(</span><span class="op" id="8125219">[</span><span class="op" id="8125220">]</span><span class="builtintype" id="8125221">uint32</span><span class="op" id="8125227">,</span>&nbsp;<span class="ident" id="8125229">n</span><span class="op" id="8125230">)</span><span class="op" id="8125231">,</span>&nbsp;<span class="builtinfunc" id="8125233">make</span><span class="op" id="8125237">(</span><span class="op" id="8125238">[</span><span class="op" id="8125239">]</span><span class="builtintype" id="8125240">uint32</span><span class="op" id="8125246">,</span>&nbsp;<span class="ident" id="8125248">n</span><span class="op" id="8125249">)</span><span class="op" id="8125250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125253">b</span><span class="op" id="8125254">.</span><span class="ident" id="8125255">ResetTimer</span><span class="op" id="8125265">(</span><span class="op" id="8125266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8125269">for</span>&nbsp;<span class="ident" id="8125273">i</span>&nbsp;<span class="op" id="8125275">:=</span>&nbsp;<span class="num" id="8125278">0</span><span class="op" id="8125279">;</span>&nbsp;<span class="ident" id="8125281">i</span>&nbsp;<span class="op" id="8125283">&lt;</span>&nbsp;<span class="ident" id="8125285">b</span><span class="op" id="8125286">.</span><span class="ident" id="8125287">N</span><span class="op" id="8125288">;</span>&nbsp;<span class="ident" id="8125290">i</span><span class="op" id="8125291">++</span>&nbsp;<span class="op" id="8125294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8125298">expandKey</span><span class="op" id="8125307">(</span><span class="ident" id="8125308">tt</span><span class="op" id="8125310">.</span><span class="ident" id="8125311">key</span><span class="op" id="8125314">,</span>&nbsp;<span class="ident" id="8125316">c</span><span class="op" id="8125317">.</span><span class="ident" id="8125318">enc</span><span class="op" id="8125321">,</span>&nbsp;<span class="ident" id="8125323">c</span><span class="op" id="8125324">.</span><span class="ident" id="8125325">dec</span><span class="op" id="8125328">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8125331">}</span><br>
<span class="lineno"></span><span class="op" id="8125333">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
