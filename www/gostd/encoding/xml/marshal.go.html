<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6007524">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6007579">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6007633">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6007684">package</span>&nbsp;<span class="ident" id="6007692">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6007697">import</span>&nbsp;<span class="op" id="6007704">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007707">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007716">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007725">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007737">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007744">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007750">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007761">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6007772">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6007782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6007785">const</span>&nbsp;<span class="op" id="6007791">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007794">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007864">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007931">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007968">Header</span>&nbsp;<span class="op" id="6007975">=</span>&nbsp;<span class="string" id="6007977">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="6008018">+</span>&nbsp;<span class="string" id="6008020">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="6008025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6008028">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="6008070">//</span><br>
<span class="lineno"></span><span class="comment" id="6008073">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6008147">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6008225">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="6008303">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6008378">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="6008457">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6008490">//</span><br>
<span class="lineno"></span><span class="comment" id="6008493">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="6008565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="6008628">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="6008685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6008746">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6008808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="6008849">//</span><br>
<span class="lineno"></span><span class="comment" id="6008852">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6008929">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="6008986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="6009043">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="6009085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6009149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6009193">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6009257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6009297">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="6009365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6009397">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="6009468">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="6009513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6009584">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="6009657">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6009693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="6009765">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6009838">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6009909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="6009941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6010011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="6010057">//</span><br>
<span class="lineno"></span><span class="comment" id="6010060">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="6010135">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="6010212">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6010268">//</span><br>
<span class="lineno"></span><span class="comment" id="6010271">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="6010308">//</span><br>
<span class="lineno"></span><span class="comment" id="6010311">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="6010392">func</span>&nbsp;<span class="ident" id="6010397">Marshal</span><span class="op" id="6010404">(</span><span class="ident" id="6010405">v</span>&nbsp;<span class="keyword" id="6010407">interface</span><span class="op" id="6010416">{</span><span class="op" id="6010417">}</span><span class="op" id="6010418">)</span>&nbsp;<span class="op" id="6010420">(</span><span class="op" id="6010421">[</span><span class="op" id="6010422">]</span><span class="builtintype" id="6010423">byte</span><span class="op" id="6010427">,</span>&nbsp;<span class="builtintype" id="6010429">error</span><span class="op" id="6010434">)</span>&nbsp;<span class="op" id="6010436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010439">var</span>&nbsp;<span class="ident" id="6010443">b</span>&nbsp;<span class="ident" id="6010445">bytes</span><span class="op" id="6010450">.</span><span class="ident" id="6010451">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010459">if</span>&nbsp;<span class="ident" id="6010462">err</span>&nbsp;<span class="op" id="6010466">:=</span>&nbsp;<span class="ident" id="6010469">NewEncoder</span><span class="op" id="6010479">(</span><span class="op" id="6010480">&amp;</span><span class="ident" id="6010481">b</span><span class="op" id="6010482">)</span><span class="op" id="6010483">.</span><span class="ident" id="6010484">Encode</span><span class="op" id="6010490">(</span><span class="ident" id="6010491">v</span><span class="op" id="6010492">)</span><span class="op" id="6010493">;</span>&nbsp;<span class="ident" id="6010495">err</span>&nbsp;<span class="op" id="6010499">!=</span>&nbsp;<span class="ident" id="6010502">nil</span>&nbsp;<span class="op" id="6010506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010510">return</span>&nbsp;<span class="ident" id="6010517">nil</span><span class="op" id="6010520">,</span>&nbsp;<span class="ident" id="6010522">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010527">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010530">return</span>&nbsp;<span class="ident" id="6010537">b</span><span class="op" id="6010538">.</span><span class="ident" id="6010539">Bytes</span><span class="op" id="6010544">(</span><span class="op" id="6010545">)</span><span class="op" id="6010546">,</span>&nbsp;<span class="ident" id="6010548">nil</span><br>
<span class="lineno"></span><span class="op" id="6010552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6010555">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6010625">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="6010664">//</span><br>
<span class="lineno"></span><span class="comment" id="6010667">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6010732">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="6010803">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="6010834">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="6010898">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6010964">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="6010981">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="6011046">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6011111">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="6011150">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="6011219">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6011270">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="6011336">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6011353">type</span>&nbsp;<span class="ident" id="6011358">Marshaler</span>&nbsp;<span class="keyword" id="6011368">interface</span>&nbsp;<span class="op" id="6011378">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011381">MarshalXML</span><span class="op" id="6011391">(</span><span class="ident" id="6011392">e</span>&nbsp;<span class="op" id="6011394">*</span><span class="ident" id="6011395">Encoder</span><span class="op" id="6011402">,</span>&nbsp;<span class="ident" id="6011404">start</span>&nbsp;<span class="ident" id="6011410">StartElement</span><span class="op" id="6011422">)</span>&nbsp;<span class="builtintype" id="6011424">error</span><br>
<span class="lineno"></span><span class="op" id="6011430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6011433">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6011507">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="6011548">//</span><br>
<span class="lineno"></span><span class="comment" id="6011551">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="6011634">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="6011700">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6011763">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="6011780">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="6011849">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="6011885">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6011943">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="6011978">type</span>&nbsp;<span class="ident" id="6011983">MarshalerAttr</span>&nbsp;<span class="keyword" id="6011997">interface</span>&nbsp;<span class="op" id="6012007">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012010">MarshalXMLAttr</span><span class="op" id="6012024">(</span><span class="ident" id="6012025">name</span>&nbsp;<span class="ident" id="6012030">Name</span><span class="op" id="6012034">)</span>&nbsp;<span class="op" id="6012036">(</span><span class="ident" id="6012037">Attr</span><span class="op" id="6012041">,</span>&nbsp;<span class="builtintype" id="6012043">error</span><span class="op" id="6012048">)</span><br>
<span class="lineno"></span><span class="op" id="6012050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6012053">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="6012127">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="6012199">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6012251">func</span>&nbsp;<span class="ident" id="6012256">MarshalIndent</span><span class="op" id="6012269">(</span><span class="ident" id="6012270">v</span>&nbsp;<span class="keyword" id="6012272">interface</span><span class="op" id="6012281">{</span><span class="op" id="6012282">}</span><span class="op" id="6012283">,</span>&nbsp;<span class="ident" id="6012285">prefix</span><span class="op" id="6012291">,</span>&nbsp;<span class="ident" id="6012293">indent</span>&nbsp;<span class="builtintype" id="6012300">string</span><span class="op" id="6012306">)</span>&nbsp;<span class="op" id="6012308">(</span><span class="op" id="6012309">[</span><span class="op" id="6012310">]</span><span class="builtintype" id="6012311">byte</span><span class="op" id="6012315">,</span>&nbsp;<span class="builtintype" id="6012317">error</span><span class="op" id="6012322">)</span>&nbsp;<span class="op" id="6012324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012327">var</span>&nbsp;<span class="ident" id="6012331">b</span>&nbsp;<span class="ident" id="6012333">bytes</span><span class="op" id="6012338">.</span><span class="ident" id="6012339">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012347">enc</span>&nbsp;<span class="op" id="6012351">:=</span>&nbsp;<span class="ident" id="6012354">NewEncoder</span><span class="op" id="6012364">(</span><span class="op" id="6012365">&amp;</span><span class="ident" id="6012366">b</span><span class="op" id="6012367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012370">enc</span><span class="op" id="6012373">.</span><span class="ident" id="6012374">Indent</span><span class="op" id="6012380">(</span><span class="ident" id="6012381">prefix</span><span class="op" id="6012387">,</span>&nbsp;<span class="ident" id="6012389">indent</span><span class="op" id="6012395">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012398">if</span>&nbsp;<span class="ident" id="6012401">err</span>&nbsp;<span class="op" id="6012405">:=</span>&nbsp;<span class="ident" id="6012408">enc</span><span class="op" id="6012411">.</span><span class="ident" id="6012412">Encode</span><span class="op" id="6012418">(</span><span class="ident" id="6012419">v</span><span class="op" id="6012420">)</span><span class="op" id="6012421">;</span>&nbsp;<span class="ident" id="6012423">err</span>&nbsp;<span class="op" id="6012427">!=</span>&nbsp;<span class="ident" id="6012430">nil</span>&nbsp;<span class="op" id="6012434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012438">return</span>&nbsp;<span class="ident" id="6012445">nil</span><span class="op" id="6012448">,</span>&nbsp;<span class="ident" id="6012450">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012458">return</span>&nbsp;<span class="ident" id="6012465">b</span><span class="op" id="6012466">.</span><span class="ident" id="6012467">Bytes</span><span class="op" id="6012472">(</span><span class="op" id="6012473">)</span><span class="op" id="6012474">,</span>&nbsp;<span class="ident" id="6012476">nil</span><br>
<span class="lineno"></span><span class="op" id="6012480">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6012483">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6012534">type</span>&nbsp;<span class="ident" id="6012539">Encoder</span>&nbsp;<span class="keyword" id="6012547">struct</span>&nbsp;<span class="op" id="6012554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012557">p</span>&nbsp;<span class="ident" id="6012559">printer</span><br>
<span class="lineno"></span><span class="op" id="6012567">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="6012570">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6012624">func</span>&nbsp;<span class="ident" id="6012629">NewEncoder</span><span class="op" id="6012639">(</span><span class="ident" id="6012640">w</span>&nbsp;<span class="ident" id="6012642">io</span><span class="op" id="6012644">.</span><span class="ident" id="6012645">Writer</span><span class="op" id="6012651">)</span>&nbsp;<span class="op" id="6012653">*</span><span class="ident" id="6012654">Encoder</span>&nbsp;<span class="op" id="6012662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012665">e</span>&nbsp;<span class="op" id="6012667">:=</span>&nbsp;<span class="op" id="6012670">&amp;</span><span class="ident" id="6012671">Encoder</span><span class="op" id="6012678">{</span><span class="ident" id="6012679">printer</span><span class="op" id="6012686">{</span><span class="ident" id="6012687">Writer</span><span class="op" id="6012693">:</span>&nbsp;<span class="ident" id="6012695">bufio</span><span class="op" id="6012700">.</span><span class="ident" id="6012701">NewWriter</span><span class="op" id="6012710">(</span><span class="ident" id="6012711">w</span><span class="op" id="6012712">)</span><span class="op" id="6012713">}</span><span class="op" id="6012714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012717">e</span><span class="op" id="6012718">.</span><span class="ident" id="6012719">p</span><span class="op" id="6012720">.</span><span class="ident" id="6012721">encoder</span>&nbsp;<span class="op" id="6012729">=</span>&nbsp;<span class="ident" id="6012731">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012734">return</span>&nbsp;<span class="ident" id="6012741">e</span><br>
<span class="lineno"></span><span class="op" id="6012743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6012746">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="6012811">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="6012887">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6012951">func</span>&nbsp;<span class="op" id="6012956">(</span><span class="ident" id="6012957">enc</span>&nbsp;<span class="op" id="6012961">*</span><span class="ident" id="6012962">Encoder</span><span class="op" id="6012969">)</span>&nbsp;<span class="ident" id="6012971">Indent</span><span class="op" id="6012977">(</span><span class="ident" id="6012978">prefix</span><span class="op" id="6012984">,</span>&nbsp;<span class="ident" id="6012986">indent</span>&nbsp;<span class="builtintype" id="6012993">string</span><span class="op" id="6012999">)</span>&nbsp;<span class="op" id="6013001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013004">enc</span><span class="op" id="6013007">.</span><span class="ident" id="6013008">p</span><span class="op" id="6013009">.</span><span class="ident" id="6013010">prefix</span>&nbsp;<span class="op" id="6013017">=</span>&nbsp;<span class="ident" id="6013019">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013027">enc</span><span class="op" id="6013030">.</span><span class="ident" id="6013031">p</span><span class="op" id="6013032">.</span><span class="ident" id="6013033">indent</span>&nbsp;<span class="op" id="6013040">=</span>&nbsp;<span class="ident" id="6013042">indent</span><br>
<span class="lineno"></span><span class="op" id="6013049">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="6013052">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6013106">//</span><br>
<span class="lineno"></span><span class="comment" id="6013109">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6013179">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="6013203">//</span><br>
<span class="lineno"></span><span class="comment" id="6013206">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6013246">func</span>&nbsp;<span class="op" id="6013251">(</span><span class="ident" id="6013252">enc</span>&nbsp;<span class="op" id="6013256">*</span><span class="ident" id="6013257">Encoder</span><span class="op" id="6013264">)</span>&nbsp;<span class="ident" id="6013266">Encode</span><span class="op" id="6013272">(</span><span class="ident" id="6013273">v</span>&nbsp;<span class="keyword" id="6013275">interface</span><span class="op" id="6013284">{</span><span class="op" id="6013285">}</span><span class="op" id="6013286">)</span>&nbsp;<span class="builtintype" id="6013288">error</span>&nbsp;<span class="op" id="6013294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013297">err</span>&nbsp;<span class="op" id="6013301">:=</span>&nbsp;<span class="ident" id="6013304">enc</span><span class="op" id="6013307">.</span><span class="ident" id="6013308">p</span><span class="op" id="6013309">.</span><span class="ident" id="6013310">marshalValue</span><span class="op" id="6013322">(</span><span class="ident" id="6013323">reflect</span><span class="op" id="6013330">.</span><span class="ident" id="6013331">ValueOf</span><span class="op" id="6013338">(</span><span class="ident" id="6013339">v</span><span class="op" id="6013340">)</span><span class="op" id="6013341">,</span>&nbsp;<span class="ident" id="6013343">nil</span><span class="op" id="6013346">,</span>&nbsp;<span class="ident" id="6013348">nil</span><span class="op" id="6013351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013354">if</span>&nbsp;<span class="ident" id="6013357">err</span>&nbsp;<span class="op" id="6013361">!=</span>&nbsp;<span class="ident" id="6013364">nil</span>&nbsp;<span class="op" id="6013368">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013372">return</span>&nbsp;<span class="ident" id="6013379">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013387">return</span>&nbsp;<span class="ident" id="6013394">enc</span><span class="op" id="6013397">.</span><span class="ident" id="6013398">p</span><span class="op" id="6013399">.</span><span class="ident" id="6013400">Flush</span><span class="op" id="6013405">(</span><span class="op" id="6013406">)</span><br>
<span class="lineno"></span><span class="op" id="6013408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6013411">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="6013472">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="6013525">//</span><br>
<span class="lineno"></span><span class="comment" id="6013528">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6013598">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="6013622">//</span><br>
<span class="lineno"></span><span class="comment" id="6013625">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6013672">func</span>&nbsp;<span class="op" id="6013677">(</span><span class="ident" id="6013678">enc</span>&nbsp;<span class="op" id="6013682">*</span><span class="ident" id="6013683">Encoder</span><span class="op" id="6013690">)</span>&nbsp;<span class="ident" id="6013692">EncodeElement</span><span class="op" id="6013705">(</span><span class="ident" id="6013706">v</span>&nbsp;<span class="keyword" id="6013708">interface</span><span class="op" id="6013717">{</span><span class="op" id="6013718">}</span><span class="op" id="6013719">,</span>&nbsp;<span class="ident" id="6013721">start</span>&nbsp;<span class="ident" id="6013727">StartElement</span><span class="op" id="6013739">)</span>&nbsp;<span class="builtintype" id="6013741">error</span>&nbsp;<span class="op" id="6013747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013750">err</span>&nbsp;<span class="op" id="6013754">:=</span>&nbsp;<span class="ident" id="6013757">enc</span><span class="op" id="6013760">.</span><span class="ident" id="6013761">p</span><span class="op" id="6013762">.</span><span class="ident" id="6013763">marshalValue</span><span class="op" id="6013775">(</span><span class="ident" id="6013776">reflect</span><span class="op" id="6013783">.</span><span class="ident" id="6013784">ValueOf</span><span class="op" id="6013791">(</span><span class="ident" id="6013792">v</span><span class="op" id="6013793">)</span><span class="op" id="6013794">,</span>&nbsp;<span class="ident" id="6013796">nil</span><span class="op" id="6013799">,</span>&nbsp;<span class="op" id="6013801">&amp;</span><span class="ident" id="6013802">start</span><span class="op" id="6013807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013810">if</span>&nbsp;<span class="ident" id="6013813">err</span>&nbsp;<span class="op" id="6013817">!=</span>&nbsp;<span class="ident" id="6013820">nil</span>&nbsp;<span class="op" id="6013824">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013828">return</span>&nbsp;<span class="ident" id="6013835">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013843">return</span>&nbsp;<span class="ident" id="6013850">enc</span><span class="op" id="6013853">.</span><span class="ident" id="6013854">p</span><span class="op" id="6013855">.</span><span class="ident" id="6013856">Flush</span><span class="op" id="6013861">(</span><span class="op" id="6013862">)</span><br>
<span class="lineno"></span><span class="op" id="6013864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6013867">var</span>&nbsp;<span class="op" id="6013871">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013874">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6013887">=</span>&nbsp;<span class="op" id="6013889">[</span><span class="op" id="6013890">]</span><span class="builtintype" id="6013891">byte</span><span class="op" id="6013895">(</span><span class="string" id="6013896">&#34;--&gt;&#34;</span><span class="op" id="6013901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013904">endProcInst</span>&nbsp;&nbsp;<span class="op" id="6013917">=</span>&nbsp;<span class="op" id="6013919">[</span><span class="op" id="6013920">]</span><span class="builtintype" id="6013921">byte</span><span class="op" id="6013925">(</span><span class="string" id="6013926">&#34;?&gt;&#34;</span><span class="op" id="6013930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013933">endDirective</span>&nbsp;<span class="op" id="6013946">=</span>&nbsp;<span class="op" id="6013948">[</span><span class="op" id="6013949">]</span><span class="builtintype" id="6013950">byte</span><span class="op" id="6013954">(</span><span class="string" id="6013955">&#34;&gt;&#34;</span><span class="op" id="6013958">)</span><br>
<span class="lineno"></span><span class="op" id="6013960">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="6013963">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6014020">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="6014107">//</span><br>
<span class="lineno"></span><span class="comment" id="6014110">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="6014195">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="6014274">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="6014333">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="6014413">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="6014490">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="6014543">//</span><br>
<span class="lineno"></span><span class="comment" id="6014546">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="6014636">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6014654">func</span>&nbsp;<span class="op" id="6014659">(</span><span class="ident" id="6014660">enc</span>&nbsp;<span class="op" id="6014664">*</span><span class="ident" id="6014665">Encoder</span><span class="op" id="6014672">)</span>&nbsp;<span class="ident" id="6014674">EncodeToken</span><span class="op" id="6014685">(</span><span class="ident" id="6014686">t</span>&nbsp;<span class="ident" id="6014688">Token</span><span class="op" id="6014693">)</span>&nbsp;<span class="builtintype" id="6014695">error</span>&nbsp;<span class="op" id="6014701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014704">p</span>&nbsp;<span class="op" id="6014706">:=</span>&nbsp;<span class="op" id="6014709">&amp;</span><span class="ident" id="6014710">enc</span><span class="op" id="6014713">.</span><span class="ident" id="6014714">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014717">switch</span>&nbsp;<span class="ident" id="6014724">t</span>&nbsp;<span class="op" id="6014726">:=</span>&nbsp;<span class="ident" id="6014729">t</span><span class="op" id="6014730">.</span><span class="op" id="6014731">(</span><span class="keyword" id="6014732">type</span><span class="op" id="6014736">)</span>&nbsp;<span class="op" id="6014738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014741">case</span>&nbsp;<span class="ident" id="6014746">StartElement</span><span class="op" id="6014758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014762">if</span>&nbsp;<span class="ident" id="6014765">err</span>&nbsp;<span class="op" id="6014769">:=</span>&nbsp;<span class="ident" id="6014772">p</span><span class="op" id="6014773">.</span><span class="ident" id="6014774">writeStart</span><span class="op" id="6014784">(</span><span class="op" id="6014785">&amp;</span><span class="ident" id="6014786">t</span><span class="op" id="6014787">)</span><span class="op" id="6014788">;</span>&nbsp;<span class="ident" id="6014790">err</span>&nbsp;<span class="op" id="6014794">!=</span>&nbsp;<span class="ident" id="6014797">nil</span>&nbsp;<span class="op" id="6014801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014806">return</span>&nbsp;<span class="ident" id="6014813">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014819">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014822">case</span>&nbsp;<span class="ident" id="6014827">EndElement</span><span class="op" id="6014837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014841">if</span>&nbsp;<span class="ident" id="6014844">err</span>&nbsp;<span class="op" id="6014848">:=</span>&nbsp;<span class="ident" id="6014851">p</span><span class="op" id="6014852">.</span><span class="ident" id="6014853">writeEnd</span><span class="op" id="6014861">(</span><span class="ident" id="6014862">t</span><span class="op" id="6014863">.</span><span class="ident" id="6014864">Name</span><span class="op" id="6014868">)</span><span class="op" id="6014869">;</span>&nbsp;<span class="ident" id="6014871">err</span>&nbsp;<span class="op" id="6014875">!=</span>&nbsp;<span class="ident" id="6014878">nil</span>&nbsp;<span class="op" id="6014882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014887">return</span>&nbsp;<span class="ident" id="6014894">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014903">case</span>&nbsp;<span class="ident" id="6014908">CharData</span><span class="op" id="6014916">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014920">EscapeText</span><span class="op" id="6014930">(</span><span class="ident" id="6014931">p</span><span class="op" id="6014932">,</span>&nbsp;<span class="ident" id="6014934">t</span><span class="op" id="6014935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014938">case</span>&nbsp;<span class="ident" id="6014943">Comment</span><span class="op" id="6014950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014954">if</span>&nbsp;<span class="ident" id="6014957">bytes</span><span class="op" id="6014962">.</span><span class="ident" id="6014963">Contains</span><span class="op" id="6014971">(</span><span class="ident" id="6014972">t</span><span class="op" id="6014973">,</span>&nbsp;<span class="ident" id="6014975">endComment</span><span class="op" id="6014985">)</span>&nbsp;<span class="op" id="6014987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014992">return</span>&nbsp;<span class="ident" id="6014999">fmt</span><span class="op" id="6015002">.</span><span class="ident" id="6015003">Errorf</span><span class="op" id="6015009">(</span><span class="string" id="6015010">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="6015061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015065">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015069">p</span><span class="op" id="6015070">.</span><span class="ident" id="6015071">WriteString</span><span class="op" id="6015082">(</span><span class="string" id="6015083">&#34;&lt;!--&#34;</span><span class="op" id="6015089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015093">p</span><span class="op" id="6015094">.</span><span class="ident" id="6015095">Write</span><span class="op" id="6015100">(</span><span class="ident" id="6015101">t</span><span class="op" id="6015102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015106">p</span><span class="op" id="6015107">.</span><span class="ident" id="6015108">WriteString</span><span class="op" id="6015119">(</span><span class="string" id="6015120">&#34;--&gt;&#34;</span><span class="op" id="6015125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015129">return</span>&nbsp;<span class="ident" id="6015136">p</span><span class="op" id="6015137">.</span><span class="ident" id="6015138">cachedWriteError</span><span class="op" id="6015154">(</span><span class="op" id="6015155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015158">case</span>&nbsp;<span class="ident" id="6015163">ProcInst</span><span class="op" id="6015171">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015175">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015250">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015330">if</span>&nbsp;<span class="ident" id="6015333">t</span><span class="op" id="6015334">.</span><span class="ident" id="6015335">Target</span>&nbsp;<span class="op" id="6015342">==</span>&nbsp;<span class="string" id="6015345">&#34;xml&#34;</span>&nbsp;<span class="op" id="6015351">&amp;&amp;</span>&nbsp;<span class="ident" id="6015354">p</span><span class="op" id="6015355">.</span><span class="ident" id="6015356">Buffered</span><span class="op" id="6015364">(</span><span class="op" id="6015365">)</span>&nbsp;<span class="op" id="6015367">!=</span>&nbsp;<span class="num" id="6015370">0</span>&nbsp;<span class="op" id="6015372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015377">return</span>&nbsp;<span class="ident" id="6015384">fmt</span><span class="op" id="6015387">.</span><span class="ident" id="6015388">Errorf</span><span class="op" id="6015394">(</span><span class="string" id="6015395">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="6015488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015492">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015496">if</span>&nbsp;<span class="op" id="6015499">!</span><span class="ident" id="6015500">isNameString</span><span class="op" id="6015512">(</span><span class="ident" id="6015513">t</span><span class="op" id="6015514">.</span><span class="ident" id="6015515">Target</span><span class="op" id="6015521">)</span>&nbsp;<span class="op" id="6015523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015528">return</span>&nbsp;<span class="ident" id="6015535">fmt</span><span class="op" id="6015538">.</span><span class="ident" id="6015539">Errorf</span><span class="op" id="6015545">(</span><span class="string" id="6015546">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="6015596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015604">if</span>&nbsp;<span class="ident" id="6015607">bytes</span><span class="op" id="6015612">.</span><span class="ident" id="6015613">Contains</span><span class="op" id="6015621">(</span><span class="ident" id="6015622">t</span><span class="op" id="6015623">.</span><span class="ident" id="6015624">Inst</span><span class="op" id="6015628">,</span>&nbsp;<span class="ident" id="6015630">endProcInst</span><span class="op" id="6015641">)</span>&nbsp;<span class="op" id="6015643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015648">return</span>&nbsp;<span class="ident" id="6015655">fmt</span><span class="op" id="6015658">.</span><span class="ident" id="6015659">Errorf</span><span class="op" id="6015665">(</span><span class="string" id="6015666">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="6015717">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015725">p</span><span class="op" id="6015726">.</span><span class="ident" id="6015727">WriteString</span><span class="op" id="6015738">(</span><span class="string" id="6015739">&#34;&lt;?&#34;</span><span class="op" id="6015743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015747">p</span><span class="op" id="6015748">.</span><span class="ident" id="6015749">WriteString</span><span class="op" id="6015760">(</span><span class="ident" id="6015761">t</span><span class="op" id="6015762">.</span><span class="ident" id="6015763">Target</span><span class="op" id="6015769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015773">if</span>&nbsp;<span class="builtinfunc" id="6015776">len</span><span class="op" id="6015779">(</span><span class="ident" id="6015780">t</span><span class="op" id="6015781">.</span><span class="ident" id="6015782">Inst</span><span class="op" id="6015786">)</span>&nbsp;<span class="op" id="6015788">&gt;</span>&nbsp;<span class="num" id="6015790">0</span>&nbsp;<span class="op" id="6015792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015797">p</span><span class="op" id="6015798">.</span><span class="ident" id="6015799">WriteByte</span><span class="op" id="6015808">(</span><span class="string" id="6015809">&#39;&nbsp;&#39;</span><span class="op" id="6015812">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015817">p</span><span class="op" id="6015818">.</span><span class="ident" id="6015819">Write</span><span class="op" id="6015824">(</span><span class="ident" id="6015825">t</span><span class="op" id="6015826">.</span><span class="ident" id="6015827">Inst</span><span class="op" id="6015831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015839">p</span><span class="op" id="6015840">.</span><span class="ident" id="6015841">WriteString</span><span class="op" id="6015852">(</span><span class="string" id="6015853">&#34;?&gt;&#34;</span><span class="op" id="6015857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015860">case</span>&nbsp;<span class="ident" id="6015865">Directive</span><span class="op" id="6015874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015878">if</span>&nbsp;<span class="ident" id="6015881">bytes</span><span class="op" id="6015886">.</span><span class="ident" id="6015887">Contains</span><span class="op" id="6015895">(</span><span class="ident" id="6015896">t</span><span class="op" id="6015897">,</span>&nbsp;<span class="ident" id="6015899">endDirective</span><span class="op" id="6015911">)</span>&nbsp;<span class="op" id="6015913">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015918">return</span>&nbsp;<span class="ident" id="6015925">fmt</span><span class="op" id="6015928">.</span><span class="ident" id="6015929">Errorf</span><span class="op" id="6015935">(</span><span class="string" id="6015936">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="6015987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015995">p</span><span class="op" id="6015996">.</span><span class="ident" id="6015997">WriteString</span><span class="op" id="6016008">(</span><span class="string" id="6016009">&#34;&lt;!&#34;</span><span class="op" id="6016013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016017">p</span><span class="op" id="6016018">.</span><span class="ident" id="6016019">Write</span><span class="op" id="6016024">(</span><span class="ident" id="6016025">t</span><span class="op" id="6016026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016030">p</span><span class="op" id="6016031">.</span><span class="ident" id="6016032">WriteString</span><span class="op" id="6016043">(</span><span class="string" id="6016044">&#34;&gt;&#34;</span><span class="op" id="6016047">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016053">return</span>&nbsp;<span class="ident" id="6016060">p</span><span class="op" id="6016061">.</span><span class="ident" id="6016062">cachedWriteError</span><span class="op" id="6016078">(</span><span class="op" id="6016079">)</span><br>
<span class="lineno"></span><span class="op" id="6016081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6016084">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="6016144">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="6016221">func</span>&nbsp;<span class="op" id="6016226">(</span><span class="ident" id="6016227">enc</span>&nbsp;<span class="op" id="6016231">*</span><span class="ident" id="6016232">Encoder</span><span class="op" id="6016239">)</span>&nbsp;<span class="ident" id="6016241">Flush</span><span class="op" id="6016246">(</span><span class="op" id="6016247">)</span>&nbsp;<span class="builtintype" id="6016249">error</span>&nbsp;<span class="op" id="6016255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016258">return</span>&nbsp;<span class="ident" id="6016265">enc</span><span class="op" id="6016268">.</span><span class="ident" id="6016269">p</span><span class="op" id="6016270">.</span><span class="ident" id="6016271">Flush</span><span class="op" id="6016276">(</span><span class="op" id="6016277">)</span><br>
<span class="lineno"></span><span class="op" id="6016279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="6016282">type</span>&nbsp;<span class="ident" id="6016287">printer</span>&nbsp;<span class="keyword" id="6016295">struct</span>&nbsp;<span class="op" id="6016302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016305">*</span><span class="ident" id="6016306">bufio</span><span class="op" id="6016311">.</span><span class="ident" id="6016312">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016320">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6016331">*</span><span class="ident" id="6016332">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016341">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6016352">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016357">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6016368">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016376">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6016387">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016395">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6016406">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016411">indentedIn</span>&nbsp;<span class="builtintype" id="6016422">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016428">putNewline</span>&nbsp;<span class="builtintype" id="6016439">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016445">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6016456">map</span><span class="op" id="6016459">[</span><span class="builtintype" id="6016460">string</span><span class="op" id="6016466">]</span><span class="builtintype" id="6016467">string</span>&nbsp;<span class="comment" id="6016474">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016503">attrPrefix</span>&nbsp;<span class="keyword" id="6016514">map</span><span class="op" id="6016517">[</span><span class="builtintype" id="6016518">string</span><span class="op" id="6016524">]</span><span class="builtintype" id="6016525">string</span>&nbsp;<span class="comment" id="6016532">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016561">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6016572">[</span><span class="op" id="6016573">]</span><span class="builtintype" id="6016574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016582">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6016593">[</span><span class="op" id="6016594">]</span><span class="ident" id="6016595">Name</span><br>
<span class="lineno"></span><span class="op" id="6016600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="6016603">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="6016694">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6016756">func</span>&nbsp;<span class="op" id="6016761">(</span><span class="ident" id="6016762">p</span>&nbsp;<span class="op" id="6016764">*</span><span class="ident" id="6016765">printer</span><span class="op" id="6016772">)</span>&nbsp;<span class="ident" id="6016774">createAttrPrefix</span><span class="op" id="6016790">(</span><span class="ident" id="6016791">url</span>&nbsp;<span class="builtintype" id="6016795">string</span><span class="op" id="6016801">)</span>&nbsp;<span class="builtintype" id="6016803">string</span>&nbsp;<span class="op" id="6016810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016813">if</span>&nbsp;<span class="ident" id="6016816">prefix</span>&nbsp;<span class="op" id="6016823">:=</span>&nbsp;<span class="ident" id="6016826">p</span><span class="op" id="6016827">.</span><span class="ident" id="6016828">attrPrefix</span><span class="op" id="6016838">[</span><span class="ident" id="6016839">url</span><span class="op" id="6016842">]</span><span class="op" id="6016843">;</span>&nbsp;<span class="ident" id="6016845">prefix</span>&nbsp;<span class="op" id="6016852">!=</span>&nbsp;<span class="string" id="6016855">&#34;&#34;</span>&nbsp;<span class="op" id="6016858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016862">return</span>&nbsp;<span class="ident" id="6016869">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6016881">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6016962">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017000">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017083">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017162">if</span>&nbsp;<span class="ident" id="6017165">url</span>&nbsp;<span class="op" id="6017169">==</span>&nbsp;<span class="ident" id="6017172">xmlURL</span>&nbsp;<span class="op" id="6017179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017183">return</span>&nbsp;<span class="string" id="6017190">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017201">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017238">if</span>&nbsp;<span class="ident" id="6017241">p</span><span class="op" id="6017242">.</span><span class="ident" id="6017243">attrPrefix</span>&nbsp;<span class="op" id="6017254">==</span>&nbsp;<span class="ident" id="6017257">nil</span>&nbsp;<span class="op" id="6017261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017265">p</span><span class="op" id="6017266">.</span><span class="ident" id="6017267">attrPrefix</span>&nbsp;<span class="op" id="6017278">=</span>&nbsp;<span class="builtinfunc" id="6017280">make</span><span class="op" id="6017284">(</span><span class="keyword" id="6017285">map</span><span class="op" id="6017288">[</span><span class="builtintype" id="6017289">string</span><span class="op" id="6017295">]</span><span class="builtintype" id="6017296">string</span><span class="op" id="6017302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017306">p</span><span class="op" id="6017307">.</span><span class="ident" id="6017308">attrNS</span>&nbsp;<span class="op" id="6017315">=</span>&nbsp;<span class="builtinfunc" id="6017317">make</span><span class="op" id="6017321">(</span><span class="keyword" id="6017322">map</span><span class="op" id="6017325">[</span><span class="builtintype" id="6017326">string</span><span class="op" id="6017332">]</span><span class="builtintype" id="6017333">string</span><span class="op" id="6017339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017342">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017346">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017407">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017431">prefix</span>&nbsp;<span class="op" id="6017438">:=</span>&nbsp;<span class="ident" id="6017441">strings</span><span class="op" id="6017448">.</span><span class="ident" id="6017449">TrimRight</span><span class="op" id="6017458">(</span><span class="ident" id="6017459">url</span><span class="op" id="6017462">,</span>&nbsp;<span class="string" id="6017464">&#34;/&#34;</span><span class="op" id="6017467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017470">if</span>&nbsp;<span class="ident" id="6017473">i</span>&nbsp;<span class="op" id="6017475">:=</span>&nbsp;<span class="ident" id="6017478">strings</span><span class="op" id="6017485">.</span><span class="ident" id="6017486">LastIndex</span><span class="op" id="6017495">(</span><span class="ident" id="6017496">prefix</span><span class="op" id="6017502">,</span>&nbsp;<span class="string" id="6017504">&#34;/&#34;</span><span class="op" id="6017507">)</span><span class="op" id="6017508">;</span>&nbsp;<span class="ident" id="6017510">i</span>&nbsp;<span class="op" id="6017512">&gt;=</span>&nbsp;<span class="num" id="6017515">0</span>&nbsp;<span class="op" id="6017517">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017521">prefix</span>&nbsp;<span class="op" id="6017528">=</span>&nbsp;<span class="ident" id="6017530">prefix</span><span class="op" id="6017536">[</span><span class="ident" id="6017537">i</span><span class="op" id="6017538">+</span><span class="num" id="6017539">1</span><span class="op" id="6017540">:</span><span class="op" id="6017541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017547">if</span>&nbsp;<span class="ident" id="6017550">prefix</span>&nbsp;<span class="op" id="6017557">==</span>&nbsp;<span class="string" id="6017560">&#34;&#34;</span>&nbsp;<span class="op" id="6017563">||</span>&nbsp;<span class="op" id="6017566">!</span><span class="ident" id="6017567">isName</span><span class="op" id="6017573">(</span><span class="op" id="6017574">[</span><span class="op" id="6017575">]</span><span class="builtintype" id="6017576">byte</span><span class="op" id="6017580">(</span><span class="ident" id="6017581">prefix</span><span class="op" id="6017587">)</span><span class="op" id="6017588">)</span>&nbsp;<span class="op" id="6017590">||</span>&nbsp;<span class="ident" id="6017593">strings</span><span class="op" id="6017600">.</span><span class="ident" id="6017601">Contains</span><span class="op" id="6017609">(</span><span class="ident" id="6017610">prefix</span><span class="op" id="6017616">,</span>&nbsp;<span class="string" id="6017618">&#34;:&#34;</span><span class="op" id="6017621">)</span>&nbsp;<span class="op" id="6017623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017627">prefix</span>&nbsp;<span class="op" id="6017634">=</span>&nbsp;<span class="string" id="6017636">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017641">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017644">if</span>&nbsp;<span class="ident" id="6017647">strings</span><span class="op" id="6017654">.</span><span class="ident" id="6017655">HasPrefix</span><span class="op" id="6017664">(</span><span class="ident" id="6017665">prefix</span><span class="op" id="6017671">,</span>&nbsp;<span class="string" id="6017673">&#34;xml&#34;</span><span class="op" id="6017678">)</span>&nbsp;<span class="op" id="6017680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017684">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017714">prefix</span>&nbsp;<span class="op" id="6017721">=</span>&nbsp;<span class="string" id="6017723">&#34;_&#34;</span>&nbsp;<span class="op" id="6017727">+</span>&nbsp;<span class="ident" id="6017729">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017740">if</span>&nbsp;<span class="ident" id="6017743">p</span><span class="op" id="6017744">.</span><span class="ident" id="6017745">attrNS</span><span class="op" id="6017751">[</span><span class="ident" id="6017752">prefix</span><span class="op" id="6017758">]</span>&nbsp;<span class="op" id="6017760">!=</span>&nbsp;<span class="string" id="6017763">&#34;&#34;</span>&nbsp;<span class="op" id="6017766">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6017770">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017809">for</span>&nbsp;<span class="ident" id="6017813">p</span><span class="op" id="6017814">.</span><span class="ident" id="6017815">seq</span><span class="op" id="6017818">++</span><span class="op" id="6017820">;</span>&nbsp;<span class="op" id="6017822">;</span>&nbsp;<span class="ident" id="6017824">p</span><span class="op" id="6017825">.</span><span class="ident" id="6017826">seq</span><span class="op" id="6017829">++</span>&nbsp;<span class="op" id="6017832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017837">if</span>&nbsp;<span class="ident" id="6017840">id</span>&nbsp;<span class="op" id="6017843">:=</span>&nbsp;<span class="ident" id="6017846">prefix</span>&nbsp;<span class="op" id="6017853">+</span>&nbsp;<span class="string" id="6017855">&#34;_&#34;</span>&nbsp;<span class="op" id="6017859">+</span>&nbsp;<span class="ident" id="6017861">strconv</span><span class="op" id="6017868">.</span><span class="ident" id="6017869">Itoa</span><span class="op" id="6017873">(</span><span class="ident" id="6017874">p</span><span class="op" id="6017875">.</span><span class="ident" id="6017876">seq</span><span class="op" id="6017879">)</span><span class="op" id="6017880">;</span>&nbsp;<span class="ident" id="6017882">p</span><span class="op" id="6017883">.</span><span class="ident" id="6017884">attrNS</span><span class="op" id="6017890">[</span><span class="ident" id="6017891">id</span><span class="op" id="6017893">]</span>&nbsp;<span class="op" id="6017895">==</span>&nbsp;<span class="string" id="6017898">&#34;&#34;</span>&nbsp;<span class="op" id="6017901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017907">prefix</span>&nbsp;<span class="op" id="6017914">=</span>&nbsp;<span class="ident" id="6017916">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017923">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017943">p</span><span class="op" id="6017944">.</span><span class="ident" id="6017945">attrPrefix</span><span class="op" id="6017955">[</span><span class="ident" id="6017956">url</span><span class="op" id="6017959">]</span>&nbsp;<span class="op" id="6017961">=</span>&nbsp;<span class="ident" id="6017963">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017971">p</span><span class="op" id="6017972">.</span><span class="ident" id="6017973">attrNS</span><span class="op" id="6017979">[</span><span class="ident" id="6017980">prefix</span><span class="op" id="6017986">]</span>&nbsp;<span class="op" id="6017988">=</span>&nbsp;<span class="ident" id="6017990">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017996">p</span><span class="op" id="6017997">.</span><span class="ident" id="6017998">WriteString</span><span class="op" id="6018009">(</span><span class="string" id="6018010">`xmlns:`</span><span class="op" id="6018018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018021">p</span><span class="op" id="6018022">.</span><span class="ident" id="6018023">WriteString</span><span class="op" id="6018034">(</span><span class="ident" id="6018035">prefix</span><span class="op" id="6018041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018044">p</span><span class="op" id="6018045">.</span><span class="ident" id="6018046">WriteString</span><span class="op" id="6018057">(</span><span class="string" id="6018058">`=&#34;`</span><span class="op" id="6018062">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018065">EscapeText</span><span class="op" id="6018075">(</span><span class="ident" id="6018076">p</span><span class="op" id="6018077">,</span>&nbsp;<span class="op" id="6018079">[</span><span class="op" id="6018080">]</span><span class="builtintype" id="6018081">byte</span><span class="op" id="6018085">(</span><span class="ident" id="6018086">url</span><span class="op" id="6018089">)</span><span class="op" id="6018090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018093">p</span><span class="op" id="6018094">.</span><span class="ident" id="6018095">WriteString</span><span class="op" id="6018106">(</span><span class="string" id="6018107">`&#34;&nbsp;`</span><span class="op" id="6018111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018115">p</span><span class="op" id="6018116">.</span><span class="ident" id="6018117">prefixes</span>&nbsp;<span class="op" id="6018126">=</span>&nbsp;<span class="builtinfunc" id="6018128">append</span><span class="op" id="6018134">(</span><span class="ident" id="6018135">p</span><span class="op" id="6018136">.</span><span class="ident" id="6018137">prefixes</span><span class="op" id="6018145">,</span>&nbsp;<span class="ident" id="6018147">prefix</span><span class="op" id="6018153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6018157">return</span>&nbsp;<span class="ident" id="6018164">prefix</span><br>
<span class="lineno"></span><span class="op" id="6018171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6018174">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6018234">func</span>&nbsp;<span class="op" id="6018239">(</span><span class="ident" id="6018240">p</span>&nbsp;<span class="op" id="6018242">*</span><span class="ident" id="6018243">printer</span><span class="op" id="6018250">)</span>&nbsp;<span class="ident" id="6018252">deleteAttrPrefix</span><span class="op" id="6018268">(</span><span class="ident" id="6018269">prefix</span>&nbsp;<span class="builtintype" id="6018276">string</span><span class="op" id="6018282">)</span>&nbsp;<span class="op" id="6018284">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6018287">delete</span><span class="op" id="6018293">(</span><span class="ident" id="6018294">p</span><span class="op" id="6018295">.</span><span class="ident" id="6018296">attrPrefix</span><span class="op" id="6018306">,</span>&nbsp;<span class="ident" id="6018308">p</span><span class="op" id="6018309">.</span><span class="ident" id="6018310">attrNS</span><span class="op" id="6018316">[</span><span class="ident" id="6018317">prefix</span><span class="op" id="6018323">]</span><span class="op" id="6018324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6018327">delete</span><span class="op" id="6018333">(</span><span class="ident" id="6018334">p</span><span class="op" id="6018335">.</span><span class="ident" id="6018336">attrNS</span><span class="op" id="6018342">,</span>&nbsp;<span class="ident" id="6018344">prefix</span><span class="op" id="6018350">)</span><br>
<span class="lineno"></span><span class="op" id="6018352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6018355">func</span>&nbsp;<span class="op" id="6018360">(</span><span class="ident" id="6018361">p</span>&nbsp;<span class="op" id="6018363">*</span><span class="ident" id="6018364">printer</span><span class="op" id="6018371">)</span>&nbsp;<span class="ident" id="6018373">markPrefix</span><span class="op" id="6018383">(</span><span class="op" id="6018384">)</span>&nbsp;<span class="op" id="6018386">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018389">p</span><span class="op" id="6018390">.</span><span class="ident" id="6018391">prefixes</span>&nbsp;<span class="op" id="6018400">=</span>&nbsp;<span class="builtinfunc" id="6018402">append</span><span class="op" id="6018408">(</span><span class="ident" id="6018409">p</span><span class="op" id="6018410">.</span><span class="ident" id="6018411">prefixes</span><span class="op" id="6018419">,</span>&nbsp;<span class="string" id="6018421">&#34;&#34;</span><span class="op" id="6018423">)</span><br>
<span class="lineno"></span><span class="op" id="6018425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6018428">func</span>&nbsp;<span class="op" id="6018433">(</span><span class="ident" id="6018434">p</span>&nbsp;<span class="op" id="6018436">*</span><span class="ident" id="6018437">printer</span><span class="op" id="6018444">)</span>&nbsp;<span class="ident" id="6018446">popPrefix</span><span class="op" id="6018455">(</span><span class="op" id="6018456">)</span>&nbsp;<span class="op" id="6018458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6018461">for</span>&nbsp;<span class="builtinfunc" id="6018465">len</span><span class="op" id="6018468">(</span><span class="ident" id="6018469">p</span><span class="op" id="6018470">.</span><span class="ident" id="6018471">prefixes</span><span class="op" id="6018479">)</span>&nbsp;<span class="op" id="6018481">&gt;</span>&nbsp;<span class="num" id="6018483">0</span>&nbsp;<span class="op" id="6018485">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018489">prefix</span>&nbsp;<span class="op" id="6018496">:=</span>&nbsp;<span class="ident" id="6018499">p</span><span class="op" id="6018500">.</span><span class="ident" id="6018501">prefixes</span><span class="op" id="6018509">[</span><span class="builtinfunc" id="6018510">len</span><span class="op" id="6018513">(</span><span class="ident" id="6018514">p</span><span class="op" id="6018515">.</span><span class="ident" id="6018516">prefixes</span><span class="op" id="6018524">)</span><span class="op" id="6018525">-</span><span class="num" id="6018526">1</span><span class="op" id="6018527">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018531">p</span><span class="op" id="6018532">.</span><span class="ident" id="6018533">prefixes</span>&nbsp;<span class="op" id="6018542">=</span>&nbsp;<span class="ident" id="6018544">p</span><span class="op" id="6018545">.</span><span class="ident" id="6018546">prefixes</span><span class="op" id="6018554">[</span><span class="op" id="6018555">:</span><span class="builtinfunc" id="6018556">len</span><span class="op" id="6018559">(</span><span class="ident" id="6018560">p</span><span class="op" id="6018561">.</span><span class="ident" id="6018562">prefixes</span><span class="op" id="6018570">)</span><span class="op" id="6018571">-</span><span class="num" id="6018572">1</span><span class="op" id="6018573">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6018577">if</span>&nbsp;<span class="ident" id="6018580">prefix</span>&nbsp;<span class="op" id="6018587">==</span>&nbsp;<span class="string" id="6018590">&#34;&#34;</span>&nbsp;<span class="op" id="6018593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6018598">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6018606">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018610">p</span><span class="op" id="6018611">.</span><span class="ident" id="6018612">deleteAttrPrefix</span><span class="op" id="6018628">(</span><span class="ident" id="6018629">prefix</span><span class="op" id="6018635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6018638">}</span><br>
<span class="lineno"></span><span class="op" id="6018640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6018643">var</span>&nbsp;<span class="op" id="6018647">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018650">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018668">=</span>&nbsp;<span class="ident" id="6018670">reflect</span><span class="op" id="6018677">.</span><span class="ident" id="6018678">TypeOf</span><span class="op" id="6018684">(</span><span class="op" id="6018685">(</span><span class="op" id="6018686">*</span><span class="ident" id="6018687">Marshaler</span><span class="op" id="6018696">)</span><span class="op" id="6018697">(</span><span class="ident" id="6018698">nil</span><span class="op" id="6018701">)</span><span class="op" id="6018702">)</span><span class="op" id="6018703">.</span><span class="ident" id="6018704">Elem</span><span class="op" id="6018708">(</span><span class="op" id="6018709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018712">marshalerAttrType</span>&nbsp;<span class="op" id="6018730">=</span>&nbsp;<span class="ident" id="6018732">reflect</span><span class="op" id="6018739">.</span><span class="ident" id="6018740">TypeOf</span><span class="op" id="6018746">(</span><span class="op" id="6018747">(</span><span class="op" id="6018748">*</span><span class="ident" id="6018749">MarshalerAttr</span><span class="op" id="6018762">)</span><span class="op" id="6018763">(</span><span class="ident" id="6018764">nil</span><span class="op" id="6018767">)</span><span class="op" id="6018768">)</span><span class="op" id="6018769">.</span><span class="ident" id="6018770">Elem</span><span class="op" id="6018774">(</span><span class="op" id="6018775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018778">textMarshalerType</span>&nbsp;<span class="op" id="6018796">=</span>&nbsp;<span class="ident" id="6018798">reflect</span><span class="op" id="6018805">.</span><span class="ident" id="6018806">TypeOf</span><span class="op" id="6018812">(</span><span class="op" id="6018813">(</span><span class="op" id="6018814">*</span><span class="ident" id="6018815">encoding</span><span class="op" id="6018823">.</span><span class="ident" id="6018824">TextMarshaler</span><span class="op" id="6018837">)</span><span class="op" id="6018838">(</span><span class="ident" id="6018839">nil</span><span class="op" id="6018842">)</span><span class="op" id="6018843">)</span><span class="op" id="6018844">.</span><span class="ident" id="6018845">Elem</span><span class="op" id="6018849">(</span><span class="op" id="6018850">)</span><br>
<span class="lineno"></span><span class="op" id="6018852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="6018855">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="6018921">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="6018994">func</span>&nbsp;<span class="op" id="6018999">(</span><span class="ident" id="6019000">p</span>&nbsp;<span class="op" id="6019002">*</span><span class="ident" id="6019003">printer</span><span class="op" id="6019010">)</span>&nbsp;<span class="ident" id="6019012">marshalValue</span><span class="op" id="6019024">(</span><span class="ident" id="6019025">val</span>&nbsp;<span class="ident" id="6019029">reflect</span><span class="op" id="6019036">.</span><span class="ident" id="6019037">Value</span><span class="op" id="6019042">,</span>&nbsp;<span class="ident" id="6019044">finfo</span>&nbsp;<span class="op" id="6019050">*</span><span class="ident" id="6019051">fieldInfo</span><span class="op" id="6019060">,</span>&nbsp;<span class="ident" id="6019062">startTemplate</span>&nbsp;<span class="op" id="6019076">*</span><span class="ident" id="6019077">StartElement</span><span class="op" id="6019089">)</span>&nbsp;<span class="builtintype" id="6019091">error</span>&nbsp;<span class="op" id="6019097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019100">if</span>&nbsp;<span class="ident" id="6019103">startTemplate</span>&nbsp;<span class="op" id="6019117">!=</span>&nbsp;<span class="ident" id="6019120">nil</span>&nbsp;<span class="op" id="6019124">&amp;&amp;</span>&nbsp;<span class="ident" id="6019127">startTemplate</span><span class="op" id="6019140">.</span><span class="ident" id="6019141">Name</span><span class="op" id="6019145">.</span><span class="ident" id="6019146">Local</span>&nbsp;<span class="op" id="6019152">==</span>&nbsp;<span class="string" id="6019155">&#34;&#34;</span>&nbsp;<span class="op" id="6019158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019162">return</span>&nbsp;<span class="ident" id="6019169">fmt</span><span class="op" id="6019172">.</span><span class="ident" id="6019173">Errorf</span><span class="op" id="6019179">(</span><span class="string" id="6019180">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="6019234">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019241">if</span>&nbsp;<span class="op" id="6019244">!</span><span class="ident" id="6019245">val</span><span class="op" id="6019248">.</span><span class="ident" id="6019249">IsValid</span><span class="op" id="6019256">(</span><span class="op" id="6019257">)</span>&nbsp;<span class="op" id="6019259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019263">return</span>&nbsp;<span class="ident" id="6019270">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019275">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019278">if</span>&nbsp;<span class="ident" id="6019281">finfo</span>&nbsp;<span class="op" id="6019287">!=</span>&nbsp;<span class="ident" id="6019290">nil</span>&nbsp;<span class="op" id="6019294">&amp;&amp;</span>&nbsp;<span class="ident" id="6019297">finfo</span><span class="op" id="6019302">.</span><span class="ident" id="6019303">flags</span><span class="op" id="6019308">&amp;</span><span class="ident" id="6019309">fOmitEmpty</span>&nbsp;<span class="op" id="6019320">!=</span>&nbsp;<span class="num" id="6019323">0</span>&nbsp;<span class="op" id="6019325">&amp;&amp;</span>&nbsp;<span class="ident" id="6019328">isEmptyValue</span><span class="op" id="6019340">(</span><span class="ident" id="6019341">val</span><span class="op" id="6019344">)</span>&nbsp;<span class="op" id="6019346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019350">return</span>&nbsp;<span class="ident" id="6019357">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6019366">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6019406">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6019468">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019506">for</span>&nbsp;<span class="ident" id="6019510">val</span><span class="op" id="6019513">.</span><span class="ident" id="6019514">Kind</span><span class="op" id="6019518">(</span><span class="op" id="6019519">)</span>&nbsp;<span class="op" id="6019521">==</span>&nbsp;<span class="ident" id="6019524">reflect</span><span class="op" id="6019531">.</span><span class="ident" id="6019532">Interface</span>&nbsp;<span class="op" id="6019542">||</span>&nbsp;<span class="ident" id="6019545">val</span><span class="op" id="6019548">.</span><span class="ident" id="6019549">Kind</span><span class="op" id="6019553">(</span><span class="op" id="6019554">)</span>&nbsp;<span class="op" id="6019556">==</span>&nbsp;<span class="ident" id="6019559">reflect</span><span class="op" id="6019566">.</span><span class="ident" id="6019567">Ptr</span>&nbsp;<span class="op" id="6019571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019575">if</span>&nbsp;<span class="ident" id="6019578">val</span><span class="op" id="6019581">.</span><span class="ident" id="6019582">IsNil</span><span class="op" id="6019587">(</span><span class="op" id="6019588">)</span>&nbsp;<span class="op" id="6019590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019595">return</span>&nbsp;<span class="ident" id="6019602">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019612">val</span>&nbsp;<span class="op" id="6019616">=</span>&nbsp;<span class="ident" id="6019618">val</span><span class="op" id="6019621">.</span><span class="ident" id="6019622">Elem</span><span class="op" id="6019626">(</span><span class="op" id="6019627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019634">kind</span>&nbsp;<span class="op" id="6019639">:=</span>&nbsp;<span class="ident" id="6019642">val</span><span class="op" id="6019645">.</span><span class="ident" id="6019646">Kind</span><span class="op" id="6019650">(</span><span class="op" id="6019651">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019654">typ</span>&nbsp;<span class="op" id="6019658">:=</span>&nbsp;<span class="ident" id="6019661">val</span><span class="op" id="6019664">.</span><span class="ident" id="6019665">Type</span><span class="op" id="6019669">(</span><span class="op" id="6019670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6019674">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019699">if</span>&nbsp;<span class="ident" id="6019702">val</span><span class="op" id="6019705">.</span><span class="ident" id="6019706">CanInterface</span><span class="op" id="6019718">(</span><span class="op" id="6019719">)</span>&nbsp;<span class="op" id="6019721">&amp;&amp;</span>&nbsp;<span class="ident" id="6019724">typ</span><span class="op" id="6019727">.</span><span class="ident" id="6019728">Implements</span><span class="op" id="6019738">(</span><span class="ident" id="6019739">marshalerType</span><span class="op" id="6019752">)</span>&nbsp;<span class="op" id="6019754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019758">return</span>&nbsp;<span class="ident" id="6019765">p</span><span class="op" id="6019766">.</span><span class="ident" id="6019767">marshalInterface</span><span class="op" id="6019783">(</span><span class="ident" id="6019784">val</span><span class="op" id="6019787">.</span><span class="ident" id="6019788">Interface</span><span class="op" id="6019797">(</span><span class="op" id="6019798">)</span><span class="op" id="6019799">.</span><span class="op" id="6019800">(</span><span class="ident" id="6019801">Marshaler</span><span class="op" id="6019810">)</span><span class="op" id="6019811">,</span>&nbsp;<span class="ident" id="6019813">defaultStart</span><span class="op" id="6019825">(</span><span class="ident" id="6019826">typ</span><span class="op" id="6019829">,</span>&nbsp;<span class="ident" id="6019831">finfo</span><span class="op" id="6019836">,</span>&nbsp;<span class="ident" id="6019838">startTemplate</span><span class="op" id="6019851">)</span><span class="op" id="6019852">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019858">if</span>&nbsp;<span class="ident" id="6019861">val</span><span class="op" id="6019864">.</span><span class="ident" id="6019865">CanAddr</span><span class="op" id="6019872">(</span><span class="op" id="6019873">)</span>&nbsp;<span class="op" id="6019875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019879">pv</span>&nbsp;<span class="op" id="6019882">:=</span>&nbsp;<span class="ident" id="6019885">val</span><span class="op" id="6019888">.</span><span class="ident" id="6019889">Addr</span><span class="op" id="6019893">(</span><span class="op" id="6019894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019898">if</span>&nbsp;<span class="ident" id="6019901">pv</span><span class="op" id="6019903">.</span><span class="ident" id="6019904">CanInterface</span><span class="op" id="6019916">(</span><span class="op" id="6019917">)</span>&nbsp;<span class="op" id="6019919">&amp;&amp;</span>&nbsp;<span class="ident" id="6019922">pv</span><span class="op" id="6019924">.</span><span class="ident" id="6019925">Type</span><span class="op" id="6019929">(</span><span class="op" id="6019930">)</span><span class="op" id="6019931">.</span><span class="ident" id="6019932">Implements</span><span class="op" id="6019942">(</span><span class="ident" id="6019943">marshalerType</span><span class="op" id="6019956">)</span>&nbsp;<span class="op" id="6019958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019963">return</span>&nbsp;<span class="ident" id="6019970">p</span><span class="op" id="6019971">.</span><span class="ident" id="6019972">marshalInterface</span><span class="op" id="6019988">(</span><span class="ident" id="6019989">pv</span><span class="op" id="6019991">.</span><span class="ident" id="6019992">Interface</span><span class="op" id="6020001">(</span><span class="op" id="6020002">)</span><span class="op" id="6020003">.</span><span class="op" id="6020004">(</span><span class="ident" id="6020005">Marshaler</span><span class="op" id="6020014">)</span><span class="op" id="6020015">,</span>&nbsp;<span class="ident" id="6020017">defaultStart</span><span class="op" id="6020029">(</span><span class="ident" id="6020030">pv</span><span class="op" id="6020032">.</span><span class="ident" id="6020033">Type</span><span class="op" id="6020037">(</span><span class="op" id="6020038">)</span><span class="op" id="6020039">,</span>&nbsp;<span class="ident" id="6020041">finfo</span><span class="op" id="6020046">,</span>&nbsp;<span class="ident" id="6020048">startTemplate</span><span class="op" id="6020061">)</span><span class="op" id="6020062">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020073">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020103">if</span>&nbsp;<span class="ident" id="6020106">val</span><span class="op" id="6020109">.</span><span class="ident" id="6020110">CanInterface</span><span class="op" id="6020122">(</span><span class="op" id="6020123">)</span>&nbsp;<span class="op" id="6020125">&amp;&amp;</span>&nbsp;<span class="ident" id="6020128">typ</span><span class="op" id="6020131">.</span><span class="ident" id="6020132">Implements</span><span class="op" id="6020142">(</span><span class="ident" id="6020143">textMarshalerType</span><span class="op" id="6020160">)</span>&nbsp;<span class="op" id="6020162">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020166">return</span>&nbsp;<span class="ident" id="6020173">p</span><span class="op" id="6020174">.</span><span class="ident" id="6020175">marshalTextInterface</span><span class="op" id="6020195">(</span><span class="ident" id="6020196">val</span><span class="op" id="6020199">.</span><span class="ident" id="6020200">Interface</span><span class="op" id="6020209">(</span><span class="op" id="6020210">)</span><span class="op" id="6020211">.</span><span class="op" id="6020212">(</span><span class="ident" id="6020213">encoding</span><span class="op" id="6020221">.</span><span class="ident" id="6020222">TextMarshaler</span><span class="op" id="6020235">)</span><span class="op" id="6020236">,</span>&nbsp;<span class="ident" id="6020238">defaultStart</span><span class="op" id="6020250">(</span><span class="ident" id="6020251">typ</span><span class="op" id="6020254">,</span>&nbsp;<span class="ident" id="6020256">finfo</span><span class="op" id="6020261">,</span>&nbsp;<span class="ident" id="6020263">startTemplate</span><span class="op" id="6020276">)</span><span class="op" id="6020277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020283">if</span>&nbsp;<span class="ident" id="6020286">val</span><span class="op" id="6020289">.</span><span class="ident" id="6020290">CanAddr</span><span class="op" id="6020297">(</span><span class="op" id="6020298">)</span>&nbsp;<span class="op" id="6020300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020304">pv</span>&nbsp;<span class="op" id="6020307">:=</span>&nbsp;<span class="ident" id="6020310">val</span><span class="op" id="6020313">.</span><span class="ident" id="6020314">Addr</span><span class="op" id="6020318">(</span><span class="op" id="6020319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020323">if</span>&nbsp;<span class="ident" id="6020326">pv</span><span class="op" id="6020328">.</span><span class="ident" id="6020329">CanInterface</span><span class="op" id="6020341">(</span><span class="op" id="6020342">)</span>&nbsp;<span class="op" id="6020344">&amp;&amp;</span>&nbsp;<span class="ident" id="6020347">pv</span><span class="op" id="6020349">.</span><span class="ident" id="6020350">Type</span><span class="op" id="6020354">(</span><span class="op" id="6020355">)</span><span class="op" id="6020356">.</span><span class="ident" id="6020357">Implements</span><span class="op" id="6020367">(</span><span class="ident" id="6020368">textMarshalerType</span><span class="op" id="6020385">)</span>&nbsp;<span class="op" id="6020387">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020392">return</span>&nbsp;<span class="ident" id="6020399">p</span><span class="op" id="6020400">.</span><span class="ident" id="6020401">marshalTextInterface</span><span class="op" id="6020421">(</span><span class="ident" id="6020422">pv</span><span class="op" id="6020424">.</span><span class="ident" id="6020425">Interface</span><span class="op" id="6020434">(</span><span class="op" id="6020435">)</span><span class="op" id="6020436">.</span><span class="op" id="6020437">(</span><span class="ident" id="6020438">encoding</span><span class="op" id="6020446">.</span><span class="ident" id="6020447">TextMarshaler</span><span class="op" id="6020460">)</span><span class="op" id="6020461">,</span>&nbsp;<span class="ident" id="6020463">defaultStart</span><span class="op" id="6020475">(</span><span class="ident" id="6020476">pv</span><span class="op" id="6020478">.</span><span class="ident" id="6020479">Type</span><span class="op" id="6020483">(</span><span class="op" id="6020484">)</span><span class="op" id="6020485">,</span>&nbsp;<span class="ident" id="6020487">finfo</span><span class="op" id="6020492">,</span>&nbsp;<span class="ident" id="6020494">startTemplate</span><span class="op" id="6020507">)</span><span class="op" id="6020508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020519">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020603">if</span>&nbsp;<span class="op" id="6020606">(</span><span class="ident" id="6020607">kind</span>&nbsp;<span class="op" id="6020612">==</span>&nbsp;<span class="ident" id="6020615">reflect</span><span class="op" id="6020622">.</span><span class="ident" id="6020623">Slice</span>&nbsp;<span class="op" id="6020629">||</span>&nbsp;<span class="ident" id="6020632">kind</span>&nbsp;<span class="op" id="6020637">==</span>&nbsp;<span class="ident" id="6020640">reflect</span><span class="op" id="6020647">.</span><span class="ident" id="6020648">Array</span><span class="op" id="6020653">)</span>&nbsp;<span class="op" id="6020655">&amp;&amp;</span>&nbsp;<span class="ident" id="6020658">typ</span><span class="op" id="6020661">.</span><span class="ident" id="6020662">Elem</span><span class="op" id="6020666">(</span><span class="op" id="6020667">)</span><span class="op" id="6020668">.</span><span class="ident" id="6020669">Kind</span><span class="op" id="6020673">(</span><span class="op" id="6020674">)</span>&nbsp;<span class="op" id="6020676">!=</span>&nbsp;<span class="ident" id="6020679">reflect</span><span class="op" id="6020686">.</span><span class="ident" id="6020687">Uint8</span>&nbsp;<span class="op" id="6020693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020697">for</span>&nbsp;<span class="ident" id="6020701">i</span><span class="op" id="6020702">,</span>&nbsp;<span class="ident" id="6020704">n</span>&nbsp;<span class="op" id="6020706">:=</span>&nbsp;<span class="num" id="6020709">0</span><span class="op" id="6020710">,</span>&nbsp;<span class="ident" id="6020712">val</span><span class="op" id="6020715">.</span><span class="ident" id="6020716">Len</span><span class="op" id="6020719">(</span><span class="op" id="6020720">)</span><span class="op" id="6020721">;</span>&nbsp;<span class="ident" id="6020723">i</span>&nbsp;<span class="op" id="6020725">&lt;</span>&nbsp;<span class="ident" id="6020727">n</span><span class="op" id="6020728">;</span>&nbsp;<span class="ident" id="6020730">i</span><span class="op" id="6020731">++</span>&nbsp;<span class="op" id="6020734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020739">if</span>&nbsp;<span class="ident" id="6020742">err</span>&nbsp;<span class="op" id="6020746">:=</span>&nbsp;<span class="ident" id="6020749">p</span><span class="op" id="6020750">.</span><span class="ident" id="6020751">marshalValue</span><span class="op" id="6020763">(</span><span class="ident" id="6020764">val</span><span class="op" id="6020767">.</span><span class="ident" id="6020768">Index</span><span class="op" id="6020773">(</span><span class="ident" id="6020774">i</span><span class="op" id="6020775">)</span><span class="op" id="6020776">,</span>&nbsp;<span class="ident" id="6020778">finfo</span><span class="op" id="6020783">,</span>&nbsp;<span class="ident" id="6020785">startTemplate</span><span class="op" id="6020798">)</span><span class="op" id="6020799">;</span>&nbsp;<span class="ident" id="6020801">err</span>&nbsp;<span class="op" id="6020805">!=</span>&nbsp;<span class="ident" id="6020808">nil</span>&nbsp;<span class="op" id="6020812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020818">return</span>&nbsp;<span class="ident" id="6020825">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020832">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020840">return</span>&nbsp;<span class="ident" id="6020847">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020856">tinfo</span><span class="op" id="6020861">,</span>&nbsp;<span class="ident" id="6020863">err</span>&nbsp;<span class="op" id="6020867">:=</span>&nbsp;<span class="ident" id="6020870">getTypeInfo</span><span class="op" id="6020881">(</span><span class="ident" id="6020882">typ</span><span class="op" id="6020885">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020888">if</span>&nbsp;<span class="ident" id="6020891">err</span>&nbsp;<span class="op" id="6020895">!=</span>&nbsp;<span class="ident" id="6020898">nil</span>&nbsp;<span class="op" id="6020902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020906">return</span>&nbsp;<span class="ident" id="6020913">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020922">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020948">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020992">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021013">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021056">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021103">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021120">var</span>&nbsp;<span class="ident" id="6021124">start</span>&nbsp;<span class="ident" id="6021130">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021145">if</span>&nbsp;<span class="ident" id="6021148">startTemplate</span>&nbsp;<span class="op" id="6021162">!=</span>&nbsp;<span class="ident" id="6021165">nil</span>&nbsp;<span class="op" id="6021169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021173">start</span><span class="op" id="6021178">.</span><span class="ident" id="6021179">Name</span>&nbsp;<span class="op" id="6021184">=</span>&nbsp;<span class="ident" id="6021186">startTemplate</span><span class="op" id="6021199">.</span><span class="ident" id="6021200">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021207">start</span><span class="op" id="6021212">.</span><span class="ident" id="6021213">Attr</span>&nbsp;<span class="op" id="6021218">=</span>&nbsp;<span class="builtinfunc" id="6021220">append</span><span class="op" id="6021226">(</span><span class="ident" id="6021227">start</span><span class="op" id="6021232">.</span><span class="ident" id="6021233">Attr</span><span class="op" id="6021237">,</span>&nbsp;<span class="ident" id="6021239">startTemplate</span><span class="op" id="6021252">.</span><span class="ident" id="6021253">Attr</span><span class="op" id="6021257">...</span><span class="op" id="6021260">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021263">}</span>&nbsp;<span class="keyword" id="6021265">else</span>&nbsp;<span class="keyword" id="6021270">if</span>&nbsp;<span class="ident" id="6021273">tinfo</span><span class="op" id="6021278">.</span><span class="ident" id="6021279">xmlname</span>&nbsp;<span class="op" id="6021287">!=</span>&nbsp;<span class="ident" id="6021290">nil</span>&nbsp;<span class="op" id="6021294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021298">xmlname</span>&nbsp;<span class="op" id="6021306">:=</span>&nbsp;<span class="ident" id="6021309">tinfo</span><span class="op" id="6021314">.</span><span class="ident" id="6021315">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021325">if</span>&nbsp;<span class="ident" id="6021328">xmlname</span><span class="op" id="6021335">.</span><span class="ident" id="6021336">name</span>&nbsp;<span class="op" id="6021341">!=</span>&nbsp;<span class="string" id="6021344">&#34;&#34;</span>&nbsp;<span class="op" id="6021347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021352">start</span><span class="op" id="6021357">.</span><span class="ident" id="6021358">Name</span><span class="op" id="6021362">.</span><span class="ident" id="6021363">Space</span><span class="op" id="6021368">,</span>&nbsp;<span class="ident" id="6021370">start</span><span class="op" id="6021375">.</span><span class="ident" id="6021376">Name</span><span class="op" id="6021380">.</span><span class="ident" id="6021381">Local</span>&nbsp;<span class="op" id="6021387">=</span>&nbsp;<span class="ident" id="6021389">xmlname</span><span class="op" id="6021396">.</span><span class="ident" id="6021397">xmlns</span><span class="op" id="6021402">,</span>&nbsp;<span class="ident" id="6021404">xmlname</span><span class="op" id="6021411">.</span><span class="ident" id="6021412">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021419">}</span>&nbsp;<span class="keyword" id="6021421">else</span>&nbsp;<span class="keyword" id="6021426">if</span>&nbsp;<span class="ident" id="6021429">v</span><span class="op" id="6021430">,</span>&nbsp;<span class="ident" id="6021432">ok</span>&nbsp;<span class="op" id="6021435">:=</span>&nbsp;<span class="ident" id="6021438">xmlname</span><span class="op" id="6021445">.</span><span class="ident" id="6021446">value</span><span class="op" id="6021451">(</span><span class="ident" id="6021452">val</span><span class="op" id="6021455">)</span><span class="op" id="6021456">.</span><span class="ident" id="6021457">Interface</span><span class="op" id="6021466">(</span><span class="op" id="6021467">)</span><span class="op" id="6021468">.</span><span class="op" id="6021469">(</span><span class="ident" id="6021470">Name</span><span class="op" id="6021474">)</span><span class="op" id="6021475">;</span>&nbsp;<span class="ident" id="6021477">ok</span>&nbsp;<span class="op" id="6021480">&amp;&amp;</span>&nbsp;<span class="ident" id="6021483">v</span><span class="op" id="6021484">.</span><span class="ident" id="6021485">Local</span>&nbsp;<span class="op" id="6021491">!=</span>&nbsp;<span class="string" id="6021494">&#34;&#34;</span>&nbsp;<span class="op" id="6021497">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021502">start</span><span class="op" id="6021507">.</span><span class="ident" id="6021508">Name</span>&nbsp;<span class="op" id="6021513">=</span>&nbsp;<span class="ident" id="6021515">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021525">if</span>&nbsp;<span class="ident" id="6021528">start</span><span class="op" id="6021533">.</span><span class="ident" id="6021534">Name</span><span class="op" id="6021538">.</span><span class="ident" id="6021539">Local</span>&nbsp;<span class="op" id="6021545">==</span>&nbsp;<span class="string" id="6021548">&#34;&#34;</span>&nbsp;<span class="op" id="6021551">&amp;&amp;</span>&nbsp;<span class="ident" id="6021554">finfo</span>&nbsp;<span class="op" id="6021560">!=</span>&nbsp;<span class="ident" id="6021563">nil</span>&nbsp;<span class="op" id="6021567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021571">start</span><span class="op" id="6021576">.</span><span class="ident" id="6021577">Name</span><span class="op" id="6021581">.</span><span class="ident" id="6021582">Space</span><span class="op" id="6021587">,</span>&nbsp;<span class="ident" id="6021589">start</span><span class="op" id="6021594">.</span><span class="ident" id="6021595">Name</span><span class="op" id="6021599">.</span><span class="ident" id="6021600">Local</span>&nbsp;<span class="op" id="6021606">=</span>&nbsp;<span class="ident" id="6021608">finfo</span><span class="op" id="6021613">.</span><span class="ident" id="6021614">xmlns</span><span class="op" id="6021619">,</span>&nbsp;<span class="ident" id="6021621">finfo</span><span class="op" id="6021626">.</span><span class="ident" id="6021627">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021636">if</span>&nbsp;<span class="ident" id="6021639">start</span><span class="op" id="6021644">.</span><span class="ident" id="6021645">Name</span><span class="op" id="6021649">.</span><span class="ident" id="6021650">Local</span>&nbsp;<span class="op" id="6021656">==</span>&nbsp;<span class="string" id="6021659">&#34;&#34;</span>&nbsp;<span class="op" id="6021662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021666">name</span>&nbsp;<span class="op" id="6021671">:=</span>&nbsp;<span class="ident" id="6021674">typ</span><span class="op" id="6021677">.</span><span class="ident" id="6021678">Name</span><span class="op" id="6021682">(</span><span class="op" id="6021683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021687">if</span>&nbsp;<span class="ident" id="6021690">name</span>&nbsp;<span class="op" id="6021695">==</span>&nbsp;<span class="string" id="6021698">&#34;&#34;</span>&nbsp;<span class="op" id="6021701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021706">return</span>&nbsp;<span class="op" id="6021713">&amp;</span><span class="ident" id="6021714">UnsupportedTypeError</span><span class="op" id="6021734">{</span><span class="ident" id="6021735">typ</span><span class="op" id="6021738">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021746">start</span><span class="op" id="6021751">.</span><span class="ident" id="6021752">Name</span><span class="op" id="6021756">.</span><span class="ident" id="6021757">Local</span>&nbsp;<span class="op" id="6021763">=</span>&nbsp;<span class="ident" id="6021765">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021775">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021790">for</span>&nbsp;<span class="ident" id="6021794">i</span>&nbsp;<span class="op" id="6021796">:=</span>&nbsp;<span class="keyword" id="6021799">range</span>&nbsp;<span class="ident" id="6021805">tinfo</span><span class="op" id="6021810">.</span><span class="ident" id="6021811">fields</span>&nbsp;<span class="op" id="6021818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021822">finfo</span>&nbsp;<span class="op" id="6021828">:=</span>&nbsp;<span class="op" id="6021831">&amp;</span><span class="ident" id="6021832">tinfo</span><span class="op" id="6021837">.</span><span class="ident" id="6021838">fields</span><span class="op" id="6021844">[</span><span class="ident" id="6021845">i</span><span class="op" id="6021846">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021850">if</span>&nbsp;<span class="ident" id="6021853">finfo</span><span class="op" id="6021858">.</span><span class="ident" id="6021859">flags</span><span class="op" id="6021864">&amp;</span><span class="ident" id="6021865">fAttr</span>&nbsp;<span class="op" id="6021871">==</span>&nbsp;<span class="num" id="6021874">0</span>&nbsp;<span class="op" id="6021876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021881">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021892">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021896">fv</span>&nbsp;<span class="op" id="6021899">:=</span>&nbsp;<span class="ident" id="6021902">finfo</span><span class="op" id="6021907">.</span><span class="ident" id="6021908">value</span><span class="op" id="6021913">(</span><span class="ident" id="6021914">val</span><span class="op" id="6021917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021921">name</span>&nbsp;<span class="op" id="6021926">:=</span>&nbsp;<span class="ident" id="6021929">Name</span><span class="op" id="6021933">{</span><span class="ident" id="6021934">Space</span><span class="op" id="6021939">:</span>&nbsp;<span class="ident" id="6021941">finfo</span><span class="op" id="6021946">.</span><span class="ident" id="6021947">xmlns</span><span class="op" id="6021952">,</span>&nbsp;<span class="ident" id="6021954">Local</span><span class="op" id="6021959">:</span>&nbsp;<span class="ident" id="6021961">finfo</span><span class="op" id="6021966">.</span><span class="ident" id="6021967">name</span><span class="op" id="6021971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021976">if</span>&nbsp;<span class="ident" id="6021979">finfo</span><span class="op" id="6021984">.</span><span class="ident" id="6021985">flags</span><span class="op" id="6021990">&amp;</span><span class="ident" id="6021991">fOmitEmpty</span>&nbsp;<span class="op" id="6022002">!=</span>&nbsp;<span class="num" id="6022005">0</span>&nbsp;<span class="op" id="6022007">&amp;&amp;</span>&nbsp;<span class="ident" id="6022010">isEmptyValue</span><span class="op" id="6022022">(</span><span class="ident" id="6022023">fv</span><span class="op" id="6022025">)</span>&nbsp;<span class="op" id="6022027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022032">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022048">if</span>&nbsp;<span class="ident" id="6022051">fv</span><span class="op" id="6022053">.</span><span class="ident" id="6022054">Kind</span><span class="op" id="6022058">(</span><span class="op" id="6022059">)</span>&nbsp;<span class="op" id="6022061">==</span>&nbsp;<span class="ident" id="6022064">reflect</span><span class="op" id="6022071">.</span><span class="ident" id="6022072">Interface</span>&nbsp;<span class="op" id="6022082">&amp;&amp;</span>&nbsp;<span class="ident" id="6022085">fv</span><span class="op" id="6022087">.</span><span class="ident" id="6022088">IsNil</span><span class="op" id="6022093">(</span><span class="op" id="6022094">)</span>&nbsp;<span class="op" id="6022096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022101">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022112">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022117">if</span>&nbsp;<span class="ident" id="6022120">fv</span><span class="op" id="6022122">.</span><span class="ident" id="6022123">CanInterface</span><span class="op" id="6022135">(</span><span class="op" id="6022136">)</span>&nbsp;<span class="op" id="6022138">&amp;&amp;</span>&nbsp;<span class="ident" id="6022141">fv</span><span class="op" id="6022143">.</span><span class="ident" id="6022144">Type</span><span class="op" id="6022148">(</span><span class="op" id="6022149">)</span><span class="op" id="6022150">.</span><span class="ident" id="6022151">Implements</span><span class="op" id="6022161">(</span><span class="ident" id="6022162">marshalerAttrType</span><span class="op" id="6022179">)</span>&nbsp;<span class="op" id="6022181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022186">attr</span><span class="op" id="6022190">,</span>&nbsp;<span class="ident" id="6022192">err</span>&nbsp;<span class="op" id="6022196">:=</span>&nbsp;<span class="ident" id="6022199">fv</span><span class="op" id="6022201">.</span><span class="ident" id="6022202">Interface</span><span class="op" id="6022211">(</span><span class="op" id="6022212">)</span><span class="op" id="6022213">.</span><span class="op" id="6022214">(</span><span class="ident" id="6022215">MarshalerAttr</span><span class="op" id="6022228">)</span><span class="op" id="6022229">.</span><span class="ident" id="6022230">MarshalXMLAttr</span><span class="op" id="6022244">(</span><span class="ident" id="6022245">name</span><span class="op" id="6022249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022254">if</span>&nbsp;<span class="ident" id="6022257">err</span>&nbsp;<span class="op" id="6022261">!=</span>&nbsp;<span class="ident" id="6022264">nil</span>&nbsp;<span class="op" id="6022268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022274">return</span>&nbsp;<span class="ident" id="6022281">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022293">if</span>&nbsp;<span class="ident" id="6022296">attr</span><span class="op" id="6022300">.</span><span class="ident" id="6022301">Name</span><span class="op" id="6022305">.</span><span class="ident" id="6022306">Local</span>&nbsp;<span class="op" id="6022312">!=</span>&nbsp;<span class="string" id="6022315">&#34;&#34;</span>&nbsp;<span class="op" id="6022318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022324">start</span><span class="op" id="6022329">.</span><span class="ident" id="6022330">Attr</span>&nbsp;<span class="op" id="6022335">=</span>&nbsp;<span class="builtinfunc" id="6022337">append</span><span class="op" id="6022343">(</span><span class="ident" id="6022344">start</span><span class="op" id="6022349">.</span><span class="ident" id="6022350">Attr</span><span class="op" id="6022354">,</span>&nbsp;<span class="ident" id="6022356">attr</span><span class="op" id="6022360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022370">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022386">if</span>&nbsp;<span class="ident" id="6022389">fv</span><span class="op" id="6022391">.</span><span class="ident" id="6022392">CanAddr</span><span class="op" id="6022399">(</span><span class="op" id="6022400">)</span>&nbsp;<span class="op" id="6022402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022407">pv</span>&nbsp;<span class="op" id="6022410">:=</span>&nbsp;<span class="ident" id="6022413">fv</span><span class="op" id="6022415">.</span><span class="ident" id="6022416">Addr</span><span class="op" id="6022420">(</span><span class="op" id="6022421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022426">if</span>&nbsp;<span class="ident" id="6022429">pv</span><span class="op" id="6022431">.</span><span class="ident" id="6022432">CanInterface</span><span class="op" id="6022444">(</span><span class="op" id="6022445">)</span>&nbsp;<span class="op" id="6022447">&amp;&amp;</span>&nbsp;<span class="ident" id="6022450">pv</span><span class="op" id="6022452">.</span><span class="ident" id="6022453">Type</span><span class="op" id="6022457">(</span><span class="op" id="6022458">)</span><span class="op" id="6022459">.</span><span class="ident" id="6022460">Implements</span><span class="op" id="6022470">(</span><span class="ident" id="6022471">marshalerAttrType</span><span class="op" id="6022488">)</span>&nbsp;<span class="op" id="6022490">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022496">attr</span><span class="op" id="6022500">,</span>&nbsp;<span class="ident" id="6022502">err</span>&nbsp;<span class="op" id="6022506">:=</span>&nbsp;<span class="ident" id="6022509">pv</span><span class="op" id="6022511">.</span><span class="ident" id="6022512">Interface</span><span class="op" id="6022521">(</span><span class="op" id="6022522">)</span><span class="op" id="6022523">.</span><span class="op" id="6022524">(</span><span class="ident" id="6022525">MarshalerAttr</span><span class="op" id="6022538">)</span><span class="op" id="6022539">.</span><span class="ident" id="6022540">MarshalXMLAttr</span><span class="op" id="6022554">(</span><span class="ident" id="6022555">name</span><span class="op" id="6022559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022565">if</span>&nbsp;<span class="ident" id="6022568">err</span>&nbsp;<span class="op" id="6022572">!=</span>&nbsp;<span class="ident" id="6022575">nil</span>&nbsp;<span class="op" id="6022579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022586">return</span>&nbsp;<span class="ident" id="6022593">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022607">if</span>&nbsp;<span class="ident" id="6022610">attr</span><span class="op" id="6022614">.</span><span class="ident" id="6022615">Name</span><span class="op" id="6022619">.</span><span class="ident" id="6022620">Local</span>&nbsp;<span class="op" id="6022626">!=</span>&nbsp;<span class="string" id="6022629">&#34;&#34;</span>&nbsp;<span class="op" id="6022632">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022639">start</span><span class="op" id="6022644">.</span><span class="ident" id="6022645">Attr</span>&nbsp;<span class="op" id="6022650">=</span>&nbsp;<span class="builtinfunc" id="6022652">append</span><span class="op" id="6022658">(</span><span class="ident" id="6022659">start</span><span class="op" id="6022664">.</span><span class="ident" id="6022665">Attr</span><span class="op" id="6022669">,</span>&nbsp;<span class="ident" id="6022671">attr</span><span class="op" id="6022675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022687">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022703">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022708">if</span>&nbsp;<span class="ident" id="6022711">fv</span><span class="op" id="6022713">.</span><span class="ident" id="6022714">CanInterface</span><span class="op" id="6022726">(</span><span class="op" id="6022727">)</span>&nbsp;<span class="op" id="6022729">&amp;&amp;</span>&nbsp;<span class="ident" id="6022732">fv</span><span class="op" id="6022734">.</span><span class="ident" id="6022735">Type</span><span class="op" id="6022739">(</span><span class="op" id="6022740">)</span><span class="op" id="6022741">.</span><span class="ident" id="6022742">Implements</span><span class="op" id="6022752">(</span><span class="ident" id="6022753">textMarshalerType</span><span class="op" id="6022770">)</span>&nbsp;<span class="op" id="6022772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022777">text</span><span class="op" id="6022781">,</span>&nbsp;<span class="ident" id="6022783">err</span>&nbsp;<span class="op" id="6022787">:=</span>&nbsp;<span class="ident" id="6022790">fv</span><span class="op" id="6022792">.</span><span class="ident" id="6022793">Interface</span><span class="op" id="6022802">(</span><span class="op" id="6022803">)</span><span class="op" id="6022804">.</span><span class="op" id="6022805">(</span><span class="ident" id="6022806">encoding</span><span class="op" id="6022814">.</span><span class="ident" id="6022815">TextMarshaler</span><span class="op" id="6022828">)</span><span class="op" id="6022829">.</span><span class="ident" id="6022830">MarshalText</span><span class="op" id="6022841">(</span><span class="op" id="6022842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022847">if</span>&nbsp;<span class="ident" id="6022850">err</span>&nbsp;<span class="op" id="6022854">!=</span>&nbsp;<span class="ident" id="6022857">nil</span>&nbsp;<span class="op" id="6022861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022867">return</span>&nbsp;<span class="ident" id="6022874">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022886">start</span><span class="op" id="6022891">.</span><span class="ident" id="6022892">Attr</span>&nbsp;<span class="op" id="6022897">=</span>&nbsp;<span class="builtinfunc" id="6022899">append</span><span class="op" id="6022905">(</span><span class="ident" id="6022906">start</span><span class="op" id="6022911">.</span><span class="ident" id="6022912">Attr</span><span class="op" id="6022916">,</span>&nbsp;<span class="ident" id="6022918">Attr</span><span class="op" id="6022922">{</span><span class="ident" id="6022923">name</span><span class="op" id="6022927">,</span>&nbsp;<span class="builtintype" id="6022929">string</span><span class="op" id="6022935">(</span><span class="ident" id="6022936">text</span><span class="op" id="6022940">)</span><span class="op" id="6022941">}</span><span class="op" id="6022942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022947">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022963">if</span>&nbsp;<span class="ident" id="6022966">fv</span><span class="op" id="6022968">.</span><span class="ident" id="6022969">CanAddr</span><span class="op" id="6022976">(</span><span class="op" id="6022977">)</span>&nbsp;<span class="op" id="6022979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022984">pv</span>&nbsp;<span class="op" id="6022987">:=</span>&nbsp;<span class="ident" id="6022990">fv</span><span class="op" id="6022992">.</span><span class="ident" id="6022993">Addr</span><span class="op" id="6022997">(</span><span class="op" id="6022998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023003">if</span>&nbsp;<span class="ident" id="6023006">pv</span><span class="op" id="6023008">.</span><span class="ident" id="6023009">CanInterface</span><span class="op" id="6023021">(</span><span class="op" id="6023022">)</span>&nbsp;<span class="op" id="6023024">&amp;&amp;</span>&nbsp;<span class="ident" id="6023027">pv</span><span class="op" id="6023029">.</span><span class="ident" id="6023030">Type</span><span class="op" id="6023034">(</span><span class="op" id="6023035">)</span><span class="op" id="6023036">.</span><span class="ident" id="6023037">Implements</span><span class="op" id="6023047">(</span><span class="ident" id="6023048">textMarshalerType</span><span class="op" id="6023065">)</span>&nbsp;<span class="op" id="6023067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023073">text</span><span class="op" id="6023077">,</span>&nbsp;<span class="ident" id="6023079">err</span>&nbsp;<span class="op" id="6023083">:=</span>&nbsp;<span class="ident" id="6023086">pv</span><span class="op" id="6023088">.</span><span class="ident" id="6023089">Interface</span><span class="op" id="6023098">(</span><span class="op" id="6023099">)</span><span class="op" id="6023100">.</span><span class="op" id="6023101">(</span><span class="ident" id="6023102">encoding</span><span class="op" id="6023110">.</span><span class="ident" id="6023111">TextMarshaler</span><span class="op" id="6023124">)</span><span class="op" id="6023125">.</span><span class="ident" id="6023126">MarshalText</span><span class="op" id="6023137">(</span><span class="op" id="6023138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023144">if</span>&nbsp;<span class="ident" id="6023147">err</span>&nbsp;<span class="op" id="6023151">!=</span>&nbsp;<span class="ident" id="6023154">nil</span>&nbsp;<span class="op" id="6023158">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023165">return</span>&nbsp;<span class="ident" id="6023172">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023186">start</span><span class="op" id="6023191">.</span><span class="ident" id="6023192">Attr</span>&nbsp;<span class="op" id="6023197">=</span>&nbsp;<span class="builtinfunc" id="6023199">append</span><span class="op" id="6023205">(</span><span class="ident" id="6023206">start</span><span class="op" id="6023211">.</span><span class="ident" id="6023212">Attr</span><span class="op" id="6023216">,</span>&nbsp;<span class="ident" id="6023218">Attr</span><span class="op" id="6023222">{</span><span class="ident" id="6023223">name</span><span class="op" id="6023227">,</span>&nbsp;<span class="builtintype" id="6023229">string</span><span class="op" id="6023235">(</span><span class="ident" id="6023236">text</span><span class="op" id="6023240">)</span><span class="op" id="6023241">}</span><span class="op" id="6023242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023248">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023260">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023269">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023325">switch</span>&nbsp;<span class="ident" id="6023332">fv</span><span class="op" id="6023334">.</span><span class="ident" id="6023335">Kind</span><span class="op" id="6023339">(</span><span class="op" id="6023340">)</span>&nbsp;<span class="op" id="6023342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023346">case</span>&nbsp;<span class="ident" id="6023351">reflect</span><span class="op" id="6023358">.</span><span class="ident" id="6023359">Ptr</span><span class="op" id="6023362">,</span>&nbsp;<span class="ident" id="6023364">reflect</span><span class="op" id="6023371">.</span><span class="ident" id="6023372">Interface</span><span class="op" id="6023381">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023386">if</span>&nbsp;<span class="ident" id="6023389">fv</span><span class="op" id="6023391">.</span><span class="ident" id="6023392">IsNil</span><span class="op" id="6023397">(</span><span class="op" id="6023398">)</span>&nbsp;<span class="op" id="6023400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023406">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023423">fv</span>&nbsp;<span class="op" id="6023426">=</span>&nbsp;<span class="ident" id="6023428">fv</span><span class="op" id="6023430">.</span><span class="ident" id="6023431">Elem</span><span class="op" id="6023435">(</span><span class="op" id="6023436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023440">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023445">s</span><span class="op" id="6023446">,</span>&nbsp;<span class="ident" id="6023448">b</span><span class="op" id="6023449">,</span>&nbsp;<span class="ident" id="6023451">err</span>&nbsp;<span class="op" id="6023455">:=</span>&nbsp;<span class="ident" id="6023458">p</span><span class="op" id="6023459">.</span><span class="ident" id="6023460">marshalSimple</span><span class="op" id="6023473">(</span><span class="ident" id="6023474">fv</span><span class="op" id="6023476">.</span><span class="ident" id="6023477">Type</span><span class="op" id="6023481">(</span><span class="op" id="6023482">)</span><span class="op" id="6023483">,</span>&nbsp;<span class="ident" id="6023485">fv</span><span class="op" id="6023487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023491">if</span>&nbsp;<span class="ident" id="6023494">err</span>&nbsp;<span class="op" id="6023498">!=</span>&nbsp;<span class="ident" id="6023501">nil</span>&nbsp;<span class="op" id="6023505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023510">return</span>&nbsp;<span class="ident" id="6023517">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023523">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023527">if</span>&nbsp;<span class="ident" id="6023530">b</span>&nbsp;<span class="op" id="6023532">!=</span>&nbsp;<span class="ident" id="6023535">nil</span>&nbsp;<span class="op" id="6023539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023544">s</span>&nbsp;<span class="op" id="6023546">=</span>&nbsp;<span class="builtintype" id="6023548">string</span><span class="op" id="6023554">(</span><span class="ident" id="6023555">b</span><span class="op" id="6023556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023564">start</span><span class="op" id="6023569">.</span><span class="ident" id="6023570">Attr</span>&nbsp;<span class="op" id="6023575">=</span>&nbsp;<span class="builtinfunc" id="6023577">append</span><span class="op" id="6023583">(</span><span class="ident" id="6023584">start</span><span class="op" id="6023589">.</span><span class="ident" id="6023590">Attr</span><span class="op" id="6023594">,</span>&nbsp;<span class="ident" id="6023596">Attr</span><span class="op" id="6023600">{</span><span class="ident" id="6023601">name</span><span class="op" id="6023605">,</span>&nbsp;<span class="ident" id="6023607">s</span><span class="op" id="6023608">}</span><span class="op" id="6023609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023612">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023616">if</span>&nbsp;<span class="ident" id="6023619">err</span>&nbsp;<span class="op" id="6023623">:=</span>&nbsp;<span class="ident" id="6023626">p</span><span class="op" id="6023627">.</span><span class="ident" id="6023628">writeStart</span><span class="op" id="6023638">(</span><span class="op" id="6023639">&amp;</span><span class="ident" id="6023640">start</span><span class="op" id="6023645">)</span><span class="op" id="6023646">;</span>&nbsp;<span class="ident" id="6023648">err</span>&nbsp;<span class="op" id="6023652">!=</span>&nbsp;<span class="ident" id="6023655">nil</span>&nbsp;<span class="op" id="6023659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023663">return</span>&nbsp;<span class="ident" id="6023670">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023679">if</span>&nbsp;<span class="ident" id="6023682">val</span><span class="op" id="6023685">.</span><span class="ident" id="6023686">Kind</span><span class="op" id="6023690">(</span><span class="op" id="6023691">)</span>&nbsp;<span class="op" id="6023693">==</span>&nbsp;<span class="ident" id="6023696">reflect</span><span class="op" id="6023703">.</span><span class="ident" id="6023704">Struct</span>&nbsp;<span class="op" id="6023711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023715">err</span>&nbsp;<span class="op" id="6023719">=</span>&nbsp;<span class="ident" id="6023721">p</span><span class="op" id="6023722">.</span><span class="ident" id="6023723">marshalStruct</span><span class="op" id="6023736">(</span><span class="ident" id="6023737">tinfo</span><span class="op" id="6023742">,</span>&nbsp;<span class="ident" id="6023744">val</span><span class="op" id="6023747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023750">}</span>&nbsp;<span class="keyword" id="6023752">else</span>&nbsp;<span class="op" id="6023757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023761">s</span><span class="op" id="6023762">,</span>&nbsp;<span class="ident" id="6023764">b</span><span class="op" id="6023765">,</span>&nbsp;<span class="ident" id="6023767">err1</span>&nbsp;<span class="op" id="6023772">:=</span>&nbsp;<span class="ident" id="6023775">p</span><span class="op" id="6023776">.</span><span class="ident" id="6023777">marshalSimple</span><span class="op" id="6023790">(</span><span class="ident" id="6023791">typ</span><span class="op" id="6023794">,</span>&nbsp;<span class="ident" id="6023796">val</span><span class="op" id="6023799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023803">if</span>&nbsp;<span class="ident" id="6023806">err1</span>&nbsp;<span class="op" id="6023811">!=</span>&nbsp;<span class="ident" id="6023814">nil</span>&nbsp;<span class="op" id="6023818">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023823">err</span>&nbsp;<span class="op" id="6023827">=</span>&nbsp;<span class="ident" id="6023829">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023836">}</span>&nbsp;<span class="keyword" id="6023838">else</span>&nbsp;<span class="keyword" id="6023843">if</span>&nbsp;<span class="ident" id="6023846">b</span>&nbsp;<span class="op" id="6023848">!=</span>&nbsp;<span class="ident" id="6023851">nil</span>&nbsp;<span class="op" id="6023855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023860">EscapeText</span><span class="op" id="6023870">(</span><span class="ident" id="6023871">p</span><span class="op" id="6023872">,</span>&nbsp;<span class="ident" id="6023874">b</span><span class="op" id="6023875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023879">}</span>&nbsp;<span class="keyword" id="6023881">else</span>&nbsp;<span class="op" id="6023886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023891">p</span><span class="op" id="6023892">.</span><span class="ident" id="6023893">EscapeString</span><span class="op" id="6023905">(</span><span class="ident" id="6023906">s</span><span class="op" id="6023907">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023917">if</span>&nbsp;<span class="ident" id="6023920">err</span>&nbsp;<span class="op" id="6023924">!=</span>&nbsp;<span class="ident" id="6023927">nil</span>&nbsp;<span class="op" id="6023931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023935">return</span>&nbsp;<span class="ident" id="6023942">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023947">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023951">if</span>&nbsp;<span class="ident" id="6023954">err</span>&nbsp;<span class="op" id="6023958">:=</span>&nbsp;<span class="ident" id="6023961">p</span><span class="op" id="6023962">.</span><span class="ident" id="6023963">writeEnd</span><span class="op" id="6023971">(</span><span class="ident" id="6023972">start</span><span class="op" id="6023977">.</span><span class="ident" id="6023978">Name</span><span class="op" id="6023982">)</span><span class="op" id="6023983">;</span>&nbsp;<span class="ident" id="6023985">err</span>&nbsp;<span class="op" id="6023989">!=</span>&nbsp;<span class="ident" id="6023992">nil</span>&nbsp;<span class="op" id="6023996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024000">return</span>&nbsp;<span class="ident" id="6024007">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024016">return</span>&nbsp;<span class="ident" id="6024023">p</span><span class="op" id="6024024">.</span><span class="ident" id="6024025">cachedWriteError</span><span class="op" id="6024041">(</span><span class="op" id="6024042">)</span><br>
<span class="lineno"></span><span class="op" id="6024044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6024047">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="6024105">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="6024164">func</span>&nbsp;<span class="ident" id="6024169">defaultStart</span><span class="op" id="6024181">(</span><span class="ident" id="6024182">typ</span>&nbsp;<span class="ident" id="6024186">reflect</span><span class="op" id="6024193">.</span><span class="ident" id="6024194">Type</span><span class="op" id="6024198">,</span>&nbsp;<span class="ident" id="6024200">finfo</span>&nbsp;<span class="op" id="6024206">*</span><span class="ident" id="6024207">fieldInfo</span><span class="op" id="6024216">,</span>&nbsp;<span class="ident" id="6024218">startTemplate</span>&nbsp;<span class="op" id="6024232">*</span><span class="ident" id="6024233">StartElement</span><span class="op" id="6024245">)</span>&nbsp;<span class="ident" id="6024247">StartElement</span>&nbsp;<span class="op" id="6024260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024263">var</span>&nbsp;<span class="ident" id="6024267">start</span>&nbsp;<span class="ident" id="6024273">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024287">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024340">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024407">if</span>&nbsp;<span class="ident" id="6024410">startTemplate</span>&nbsp;<span class="op" id="6024424">!=</span>&nbsp;<span class="ident" id="6024427">nil</span>&nbsp;<span class="op" id="6024431">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024435">start</span><span class="op" id="6024440">.</span><span class="ident" id="6024441">Name</span>&nbsp;<span class="op" id="6024446">=</span>&nbsp;<span class="ident" id="6024448">startTemplate</span><span class="op" id="6024461">.</span><span class="ident" id="6024462">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024469">start</span><span class="op" id="6024474">.</span><span class="ident" id="6024475">Attr</span>&nbsp;<span class="op" id="6024480">=</span>&nbsp;<span class="builtinfunc" id="6024482">append</span><span class="op" id="6024488">(</span><span class="ident" id="6024489">start</span><span class="op" id="6024494">.</span><span class="ident" id="6024495">Attr</span><span class="op" id="6024499">,</span>&nbsp;<span class="ident" id="6024501">startTemplate</span><span class="op" id="6024514">.</span><span class="ident" id="6024515">Attr</span><span class="op" id="6024519">...</span><span class="op" id="6024522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024525">}</span>&nbsp;<span class="keyword" id="6024527">else</span>&nbsp;<span class="keyword" id="6024532">if</span>&nbsp;<span class="ident" id="6024535">finfo</span>&nbsp;<span class="op" id="6024541">!=</span>&nbsp;<span class="ident" id="6024544">nil</span>&nbsp;<span class="op" id="6024548">&amp;&amp;</span>&nbsp;<span class="ident" id="6024551">finfo</span><span class="op" id="6024556">.</span><span class="ident" id="6024557">name</span>&nbsp;<span class="op" id="6024562">!=</span>&nbsp;<span class="string" id="6024565">&#34;&#34;</span>&nbsp;<span class="op" id="6024568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024572">start</span><span class="op" id="6024577">.</span><span class="ident" id="6024578">Name</span><span class="op" id="6024582">.</span><span class="ident" id="6024583">Local</span>&nbsp;<span class="op" id="6024589">=</span>&nbsp;<span class="ident" id="6024591">finfo</span><span class="op" id="6024596">.</span><span class="ident" id="6024597">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024604">start</span><span class="op" id="6024609">.</span><span class="ident" id="6024610">Name</span><span class="op" id="6024614">.</span><span class="ident" id="6024615">Space</span>&nbsp;<span class="op" id="6024621">=</span>&nbsp;<span class="ident" id="6024623">finfo</span><span class="op" id="6024628">.</span><span class="ident" id="6024629">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024636">}</span>&nbsp;<span class="keyword" id="6024638">else</span>&nbsp;<span class="keyword" id="6024643">if</span>&nbsp;<span class="ident" id="6024646">typ</span><span class="op" id="6024649">.</span><span class="ident" id="6024650">Name</span><span class="op" id="6024654">(</span><span class="op" id="6024655">)</span>&nbsp;<span class="op" id="6024657">!=</span>&nbsp;<span class="string" id="6024660">&#34;&#34;</span>&nbsp;<span class="op" id="6024663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024667">start</span><span class="op" id="6024672">.</span><span class="ident" id="6024673">Name</span><span class="op" id="6024677">.</span><span class="ident" id="6024678">Local</span>&nbsp;<span class="op" id="6024684">=</span>&nbsp;<span class="ident" id="6024686">typ</span><span class="op" id="6024689">.</span><span class="ident" id="6024690">Name</span><span class="op" id="6024694">(</span><span class="op" id="6024695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024698">}</span>&nbsp;<span class="keyword" id="6024700">else</span>&nbsp;<span class="op" id="6024705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024709">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024749">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024790">start</span><span class="op" id="6024795">.</span><span class="ident" id="6024796">Name</span><span class="op" id="6024800">.</span><span class="ident" id="6024801">Local</span>&nbsp;<span class="op" id="6024807">=</span>&nbsp;<span class="ident" id="6024809">typ</span><span class="op" id="6024812">.</span><span class="ident" id="6024813">Elem</span><span class="op" id="6024817">(</span><span class="op" id="6024818">)</span><span class="op" id="6024819">.</span><span class="ident" id="6024820">Name</span><span class="op" id="6024824">(</span><span class="op" id="6024825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024831">return</span>&nbsp;<span class="ident" id="6024838">start</span><br>
<span class="lineno"></span><span class="op" id="6024844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="6024847">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6024905">func</span>&nbsp;<span class="op" id="6024910">(</span><span class="ident" id="6024911">p</span>&nbsp;<span class="op" id="6024913">*</span><span class="ident" id="6024914">printer</span><span class="op" id="6024921">)</span>&nbsp;<span class="ident" id="6024923">marshalInterface</span><span class="op" id="6024939">(</span><span class="ident" id="6024940">val</span>&nbsp;<span class="ident" id="6024944">Marshaler</span><span class="op" id="6024953">,</span>&nbsp;<span class="ident" id="6024955">start</span>&nbsp;<span class="ident" id="6024961">StartElement</span><span class="op" id="6024973">)</span>&nbsp;<span class="builtintype" id="6024975">error</span>&nbsp;<span class="op" id="6024981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024984">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025040">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025092">p</span><span class="op" id="6025093">.</span><span class="ident" id="6025094">tags</span>&nbsp;<span class="op" id="6025099">=</span>&nbsp;<span class="builtinfunc" id="6025101">append</span><span class="op" id="6025107">(</span><span class="ident" id="6025108">p</span><span class="op" id="6025109">.</span><span class="ident" id="6025110">tags</span><span class="op" id="6025114">,</span>&nbsp;<span class="ident" id="6025116">Name</span><span class="op" id="6025120">{</span><span class="op" id="6025121">}</span><span class="op" id="6025122">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025125">n</span>&nbsp;<span class="op" id="6025127">:=</span>&nbsp;<span class="builtinfunc" id="6025130">len</span><span class="op" id="6025133">(</span><span class="ident" id="6025134">p</span><span class="op" id="6025135">.</span><span class="ident" id="6025136">tags</span><span class="op" id="6025140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025144">err</span>&nbsp;<span class="op" id="6025148">:=</span>&nbsp;<span class="ident" id="6025151">val</span><span class="op" id="6025154">.</span><span class="ident" id="6025155">MarshalXML</span><span class="op" id="6025165">(</span><span class="ident" id="6025166">p</span><span class="op" id="6025167">.</span><span class="ident" id="6025168">encoder</span><span class="op" id="6025175">,</span>&nbsp;<span class="ident" id="6025177">start</span><span class="op" id="6025182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025185">if</span>&nbsp;<span class="ident" id="6025188">err</span>&nbsp;<span class="op" id="6025192">!=</span>&nbsp;<span class="ident" id="6025195">nil</span>&nbsp;<span class="op" id="6025199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025203">return</span>&nbsp;<span class="ident" id="6025210">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025219">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025290">if</span>&nbsp;<span class="builtinfunc" id="6025293">len</span><span class="op" id="6025296">(</span><span class="ident" id="6025297">p</span><span class="op" id="6025298">.</span><span class="ident" id="6025299">tags</span><span class="op" id="6025303">)</span>&nbsp;<span class="op" id="6025305">&gt;</span>&nbsp;<span class="ident" id="6025307">n</span>&nbsp;<span class="op" id="6025309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025313">return</span>&nbsp;<span class="ident" id="6025320">fmt</span><span class="op" id="6025323">.</span><span class="ident" id="6025324">Errorf</span><span class="op" id="6025330">(</span><span class="string" id="6025331">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="6025386">,</span>&nbsp;<span class="ident" id="6025388">receiverType</span><span class="op" id="6025400">(</span><span class="ident" id="6025401">val</span><span class="op" id="6025404">)</span><span class="op" id="6025405">,</span>&nbsp;<span class="ident" id="6025407">p</span><span class="op" id="6025408">.</span><span class="ident" id="6025409">tags</span><span class="op" id="6025413">[</span><span class="builtinfunc" id="6025414">len</span><span class="op" id="6025417">(</span><span class="ident" id="6025418">p</span><span class="op" id="6025419">.</span><span class="ident" id="6025420">tags</span><span class="op" id="6025424">)</span><span class="op" id="6025425">-</span><span class="num" id="6025426">1</span><span class="op" id="6025427">]</span><span class="op" id="6025428">.</span><span class="ident" id="6025429">Local</span><span class="op" id="6025434">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025440">p</span><span class="op" id="6025441">.</span><span class="ident" id="6025442">tags</span>&nbsp;<span class="op" id="6025447">=</span>&nbsp;<span class="ident" id="6025449">p</span><span class="op" id="6025450">.</span><span class="ident" id="6025451">tags</span><span class="op" id="6025455">[</span><span class="op" id="6025456">:</span><span class="ident" id="6025457">n</span><span class="op" id="6025458">-</span><span class="num" id="6025459">1</span><span class="op" id="6025460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025463">return</span>&nbsp;<span class="ident" id="6025470">nil</span><br>
<span class="lineno"></span><span class="op" id="6025474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="6025477">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6025543">func</span>&nbsp;<span class="op" id="6025548">(</span><span class="ident" id="6025549">p</span>&nbsp;<span class="op" id="6025551">*</span><span class="ident" id="6025552">printer</span><span class="op" id="6025559">)</span>&nbsp;<span class="ident" id="6025561">marshalTextInterface</span><span class="op" id="6025581">(</span><span class="ident" id="6025582">val</span>&nbsp;<span class="ident" id="6025586">encoding</span><span class="op" id="6025594">.</span><span class="ident" id="6025595">TextMarshaler</span><span class="op" id="6025608">,</span>&nbsp;<span class="ident" id="6025610">start</span>&nbsp;<span class="ident" id="6025616">StartElement</span><span class="op" id="6025628">)</span>&nbsp;<span class="builtintype" id="6025630">error</span>&nbsp;<span class="op" id="6025636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025639">if</span>&nbsp;<span class="ident" id="6025642">err</span>&nbsp;<span class="op" id="6025646">:=</span>&nbsp;<span class="ident" id="6025649">p</span><span class="op" id="6025650">.</span><span class="ident" id="6025651">writeStart</span><span class="op" id="6025661">(</span><span class="op" id="6025662">&amp;</span><span class="ident" id="6025663">start</span><span class="op" id="6025668">)</span><span class="op" id="6025669">;</span>&nbsp;<span class="ident" id="6025671">err</span>&nbsp;<span class="op" id="6025675">!=</span>&nbsp;<span class="ident" id="6025678">nil</span>&nbsp;<span class="op" id="6025682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025686">return</span>&nbsp;<span class="ident" id="6025693">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025698">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025701">text</span><span class="op" id="6025705">,</span>&nbsp;<span class="ident" id="6025707">err</span>&nbsp;<span class="op" id="6025711">:=</span>&nbsp;<span class="ident" id="6025714">val</span><span class="op" id="6025717">.</span><span class="ident" id="6025718">MarshalText</span><span class="op" id="6025729">(</span><span class="op" id="6025730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025733">if</span>&nbsp;<span class="ident" id="6025736">err</span>&nbsp;<span class="op" id="6025740">!=</span>&nbsp;<span class="ident" id="6025743">nil</span>&nbsp;<span class="op" id="6025747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025751">return</span>&nbsp;<span class="ident" id="6025758">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025766">EscapeText</span><span class="op" id="6025776">(</span><span class="ident" id="6025777">p</span><span class="op" id="6025778">,</span>&nbsp;<span class="ident" id="6025780">text</span><span class="op" id="6025784">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025787">return</span>&nbsp;<span class="ident" id="6025794">p</span><span class="op" id="6025795">.</span><span class="ident" id="6025796">writeEnd</span><span class="op" id="6025804">(</span><span class="ident" id="6025805">start</span><span class="op" id="6025810">.</span><span class="ident" id="6025811">Name</span><span class="op" id="6025815">)</span><br>
<span class="lineno"></span><span class="op" id="6025817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6025820">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="6025866">func</span>&nbsp;<span class="op" id="6025871">(</span><span class="ident" id="6025872">p</span>&nbsp;<span class="op" id="6025874">*</span><span class="ident" id="6025875">printer</span><span class="op" id="6025882">)</span>&nbsp;<span class="ident" id="6025884">writeStart</span><span class="op" id="6025894">(</span><span class="ident" id="6025895">start</span>&nbsp;<span class="op" id="6025901">*</span><span class="ident" id="6025902">StartElement</span><span class="op" id="6025914">)</span>&nbsp;<span class="builtintype" id="6025916">error</span>&nbsp;<span class="op" id="6025922">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025925">if</span>&nbsp;<span class="ident" id="6025928">start</span><span class="op" id="6025933">.</span><span class="ident" id="6025934">Name</span><span class="op" id="6025938">.</span><span class="ident" id="6025939">Local</span>&nbsp;<span class="op" id="6025945">==</span>&nbsp;<span class="string" id="6025948">&#34;&#34;</span>&nbsp;<span class="op" id="6025951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025955">return</span>&nbsp;<span class="ident" id="6025962">fmt</span><span class="op" id="6025965">.</span><span class="ident" id="6025966">Errorf</span><span class="op" id="6025972">(</span><span class="string" id="6025973">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6026002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026009">p</span><span class="op" id="6026010">.</span><span class="ident" id="6026011">tags</span>&nbsp;<span class="op" id="6026016">=</span>&nbsp;<span class="builtinfunc" id="6026018">append</span><span class="op" id="6026024">(</span><span class="ident" id="6026025">p</span><span class="op" id="6026026">.</span><span class="ident" id="6026027">tags</span><span class="op" id="6026031">,</span>&nbsp;<span class="ident" id="6026033">start</span><span class="op" id="6026038">.</span><span class="ident" id="6026039">Name</span><span class="op" id="6026043">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026046">p</span><span class="op" id="6026047">.</span><span class="ident" id="6026048">markPrefix</span><span class="op" id="6026058">(</span><span class="op" id="6026059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026063">p</span><span class="op" id="6026064">.</span><span class="ident" id="6026065">writeIndent</span><span class="op" id="6026076">(</span><span class="num" id="6026077">1</span><span class="op" id="6026078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026081">p</span><span class="op" id="6026082">.</span><span class="ident" id="6026083">WriteByte</span><span class="op" id="6026092">(</span><span class="string" id="6026093">&#39;&lt;&#39;</span><span class="op" id="6026096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026099">p</span><span class="op" id="6026100">.</span><span class="ident" id="6026101">WriteString</span><span class="op" id="6026112">(</span><span class="ident" id="6026113">start</span><span class="op" id="6026118">.</span><span class="ident" id="6026119">Name</span><span class="op" id="6026123">.</span><span class="ident" id="6026124">Local</span><span class="op" id="6026129">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026133">if</span>&nbsp;<span class="ident" id="6026136">start</span><span class="op" id="6026141">.</span><span class="ident" id="6026142">Name</span><span class="op" id="6026146">.</span><span class="ident" id="6026147">Space</span>&nbsp;<span class="op" id="6026153">!=</span>&nbsp;<span class="string" id="6026156">&#34;&#34;</span>&nbsp;<span class="op" id="6026159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026163">p</span><span class="op" id="6026164">.</span><span class="ident" id="6026165">WriteString</span><span class="op" id="6026176">(</span><span class="string" id="6026177">`&nbsp;xmlns=&#34;`</span><span class="op" id="6026187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026191">p</span><span class="op" id="6026192">.</span><span class="ident" id="6026193">EscapeString</span><span class="op" id="6026205">(</span><span class="ident" id="6026206">start</span><span class="op" id="6026211">.</span><span class="ident" id="6026212">Name</span><span class="op" id="6026216">.</span><span class="ident" id="6026217">Space</span><span class="op" id="6026222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026226">p</span><span class="op" id="6026227">.</span><span class="ident" id="6026228">WriteByte</span><span class="op" id="6026237">(</span><span class="string" id="6026238">&#39;&#34;&#39;</span><span class="op" id="6026241">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6026248">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026263">for</span>&nbsp;<span class="ident" id="6026267">_</span><span class="op" id="6026268">,</span>&nbsp;<span class="ident" id="6026270">attr</span>&nbsp;<span class="op" id="6026275">:=</span>&nbsp;<span class="keyword" id="6026278">range</span>&nbsp;<span class="ident" id="6026284">start</span><span class="op" id="6026289">.</span><span class="ident" id="6026290">Attr</span>&nbsp;<span class="op" id="6026295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026299">name</span>&nbsp;<span class="op" id="6026304">:=</span>&nbsp;<span class="ident" id="6026307">attr</span><span class="op" id="6026311">.</span><span class="ident" id="6026312">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026319">if</span>&nbsp;<span class="ident" id="6026322">name</span><span class="op" id="6026326">.</span><span class="ident" id="6026327">Local</span>&nbsp;<span class="op" id="6026333">==</span>&nbsp;<span class="string" id="6026336">&#34;&#34;</span>&nbsp;<span class="op" id="6026339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026344">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026359">p</span><span class="op" id="6026360">.</span><span class="ident" id="6026361">WriteByte</span><span class="op" id="6026370">(</span><span class="string" id="6026371">&#39;&nbsp;&#39;</span><span class="op" id="6026374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026378">if</span>&nbsp;<span class="ident" id="6026381">name</span><span class="op" id="6026385">.</span><span class="ident" id="6026386">Space</span>&nbsp;<span class="op" id="6026392">!=</span>&nbsp;<span class="string" id="6026395">&#34;&#34;</span>&nbsp;<span class="op" id="6026398">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026403">p</span><span class="op" id="6026404">.</span><span class="ident" id="6026405">WriteString</span><span class="op" id="6026416">(</span><span class="ident" id="6026417">p</span><span class="op" id="6026418">.</span><span class="ident" id="6026419">createAttrPrefix</span><span class="op" id="6026435">(</span><span class="ident" id="6026436">name</span><span class="op" id="6026440">.</span><span class="ident" id="6026441">Space</span><span class="op" id="6026446">)</span><span class="op" id="6026447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026452">p</span><span class="op" id="6026453">.</span><span class="ident" id="6026454">WriteByte</span><span class="op" id="6026463">(</span><span class="string" id="6026464">&#39;:&#39;</span><span class="op" id="6026467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026475">p</span><span class="op" id="6026476">.</span><span class="ident" id="6026477">WriteString</span><span class="op" id="6026488">(</span><span class="ident" id="6026489">name</span><span class="op" id="6026493">.</span><span class="ident" id="6026494">Local</span><span class="op" id="6026499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026503">p</span><span class="op" id="6026504">.</span><span class="ident" id="6026505">WriteString</span><span class="op" id="6026516">(</span><span class="string" id="6026517">`=&#34;`</span><span class="op" id="6026521">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026525">p</span><span class="op" id="6026526">.</span><span class="ident" id="6026527">EscapeString</span><span class="op" id="6026539">(</span><span class="ident" id="6026540">attr</span><span class="op" id="6026544">.</span><span class="ident" id="6026545">Value</span><span class="op" id="6026550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026554">p</span><span class="op" id="6026555">.</span><span class="ident" id="6026556">WriteByte</span><span class="op" id="6026565">(</span><span class="string" id="6026566">&#39;&#34;&#39;</span><span class="op" id="6026569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026575">p</span><span class="op" id="6026576">.</span><span class="ident" id="6026577">WriteByte</span><span class="op" id="6026586">(</span><span class="string" id="6026587">&#39;&gt;&#39;</span><span class="op" id="6026590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026593">return</span>&nbsp;<span class="ident" id="6026600">nil</span><br>
<span class="lineno">645</span><span class="op" id="6026604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6026607">func</span>&nbsp;<span class="op" id="6026612">(</span><span class="ident" id="6026613">p</span>&nbsp;<span class="op" id="6026615">*</span><span class="ident" id="6026616">printer</span><span class="op" id="6026623">)</span>&nbsp;<span class="ident" id="6026625">writeEnd</span><span class="op" id="6026633">(</span><span class="ident" id="6026634">name</span>&nbsp;<span class="ident" id="6026639">Name</span><span class="op" id="6026643">)</span>&nbsp;<span class="builtintype" id="6026645">error</span>&nbsp;<span class="op" id="6026651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026654">if</span>&nbsp;<span class="ident" id="6026657">name</span><span class="op" id="6026661">.</span><span class="ident" id="6026662">Local</span>&nbsp;<span class="op" id="6026668">==</span>&nbsp;<span class="string" id="6026671">&#34;&#34;</span>&nbsp;<span class="op" id="6026674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026678">return</span>&nbsp;<span class="ident" id="6026685">fmt</span><span class="op" id="6026688">.</span><span class="ident" id="6026689">Errorf</span><span class="op" id="6026695">(</span><span class="string" id="6026696">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6026723">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026729">if</span>&nbsp;<span class="builtinfunc" id="6026732">len</span><span class="op" id="6026735">(</span><span class="ident" id="6026736">p</span><span class="op" id="6026737">.</span><span class="ident" id="6026738">tags</span><span class="op" id="6026742">)</span>&nbsp;<span class="op" id="6026744">==</span>&nbsp;<span class="num" id="6026747">0</span>&nbsp;<span class="op" id="6026749">||</span>&nbsp;<span class="ident" id="6026752">p</span><span class="op" id="6026753">.</span><span class="ident" id="6026754">tags</span><span class="op" id="6026758">[</span><span class="builtinfunc" id="6026759">len</span><span class="op" id="6026762">(</span><span class="ident" id="6026763">p</span><span class="op" id="6026764">.</span><span class="ident" id="6026765">tags</span><span class="op" id="6026769">)</span><span class="op" id="6026770">-</span><span class="num" id="6026771">1</span><span class="op" id="6026772">]</span><span class="op" id="6026773">.</span><span class="ident" id="6026774">Local</span>&nbsp;<span class="op" id="6026780">==</span>&nbsp;<span class="string" id="6026783">&#34;&#34;</span>&nbsp;<span class="op" id="6026786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026790">return</span>&nbsp;<span class="ident" id="6026797">fmt</span><span class="op" id="6026800">.</span><span class="ident" id="6026801">Errorf</span><span class="op" id="6026807">(</span><span class="string" id="6026808">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="6026846">,</span>&nbsp;<span class="ident" id="6026848">name</span><span class="op" id="6026852">.</span><span class="ident" id="6026853">Local</span><span class="op" id="6026858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026864">if</span>&nbsp;<span class="ident" id="6026867">top</span>&nbsp;<span class="op" id="6026871">:=</span>&nbsp;<span class="ident" id="6026874">p</span><span class="op" id="6026875">.</span><span class="ident" id="6026876">tags</span><span class="op" id="6026880">[</span><span class="builtinfunc" id="6026881">len</span><span class="op" id="6026884">(</span><span class="ident" id="6026885">p</span><span class="op" id="6026886">.</span><span class="ident" id="6026887">tags</span><span class="op" id="6026891">)</span><span class="op" id="6026892">-</span><span class="num" id="6026893">1</span><span class="op" id="6026894">]</span><span class="op" id="6026895">;</span>&nbsp;<span class="ident" id="6026897">top</span>&nbsp;<span class="op" id="6026901">!=</span>&nbsp;<span class="ident" id="6026904">name</span>&nbsp;<span class="op" id="6026909">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026913">if</span>&nbsp;<span class="ident" id="6026916">top</span><span class="op" id="6026919">.</span><span class="ident" id="6026920">Local</span>&nbsp;<span class="op" id="6026926">!=</span>&nbsp;<span class="ident" id="6026929">name</span><span class="op" id="6026933">.</span><span class="ident" id="6026934">Local</span>&nbsp;<span class="op" id="6026940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6026945">return</span>&nbsp;<span class="ident" id="6026952">fmt</span><span class="op" id="6026955">.</span><span class="ident" id="6026956">Errorf</span><span class="op" id="6026962">(</span><span class="string" id="6026963">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6027013">,</span>&nbsp;<span class="ident" id="6027015">name</span><span class="op" id="6027019">.</span><span class="ident" id="6027020">Local</span><span class="op" id="6027025">,</span>&nbsp;<span class="ident" id="6027027">top</span><span class="op" id="6027030">.</span><span class="ident" id="6027031">Local</span><span class="op" id="6027036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6027040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027044">return</span>&nbsp;<span class="ident" id="6027051">fmt</span><span class="op" id="6027054">.</span><span class="ident" id="6027055">Errorf</span><span class="op" id="6027061">(</span><span class="string" id="6027062">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="6027144">,</span>&nbsp;<span class="ident" id="6027146">name</span><span class="op" id="6027150">.</span><span class="ident" id="6027151">Local</span><span class="op" id="6027156">,</span>&nbsp;<span class="ident" id="6027158">name</span><span class="op" id="6027162">.</span><span class="ident" id="6027163">Space</span><span class="op" id="6027168">,</span>&nbsp;<span class="ident" id="6027170">top</span><span class="op" id="6027173">.</span><span class="ident" id="6027174">Local</span><span class="op" id="6027179">,</span>&nbsp;<span class="ident" id="6027181">top</span><span class="op" id="6027184">.</span><span class="ident" id="6027185">Space</span><span class="op" id="6027190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6027193">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027196">p</span><span class="op" id="6027197">.</span><span class="ident" id="6027198">tags</span>&nbsp;<span class="op" id="6027203">=</span>&nbsp;<span class="ident" id="6027205">p</span><span class="op" id="6027206">.</span><span class="ident" id="6027207">tags</span><span class="op" id="6027211">[</span><span class="op" id="6027212">:</span><span class="builtinfunc" id="6027213">len</span><span class="op" id="6027216">(</span><span class="ident" id="6027217">p</span><span class="op" id="6027218">.</span><span class="ident" id="6027219">tags</span><span class="op" id="6027223">)</span><span class="op" id="6027224">-</span><span class="num" id="6027225">1</span><span class="op" id="6027226">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027230">p</span><span class="op" id="6027231">.</span><span class="ident" id="6027232">writeIndent</span><span class="op" id="6027243">(</span><span class="op" id="6027244">-</span><span class="num" id="6027245">1</span><span class="op" id="6027246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027249">p</span><span class="op" id="6027250">.</span><span class="ident" id="6027251">WriteByte</span><span class="op" id="6027260">(</span><span class="string" id="6027261">&#39;&lt;&#39;</span><span class="op" id="6027264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027267">p</span><span class="op" id="6027268">.</span><span class="ident" id="6027269">WriteByte</span><span class="op" id="6027278">(</span><span class="string" id="6027279">&#39;/&#39;</span><span class="op" id="6027282">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027285">p</span><span class="op" id="6027286">.</span><span class="ident" id="6027287">WriteString</span><span class="op" id="6027298">(</span><span class="ident" id="6027299">name</span><span class="op" id="6027303">.</span><span class="ident" id="6027304">Local</span><span class="op" id="6027309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027312">p</span><span class="op" id="6027313">.</span><span class="ident" id="6027314">WriteByte</span><span class="op" id="6027323">(</span><span class="string" id="6027324">&#39;&gt;&#39;</span><span class="op" id="6027327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6027330">p</span><span class="op" id="6027331">.</span><span class="ident" id="6027332">popPrefix</span><span class="op" id="6027341">(</span><span class="op" id="6027342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027345">return</span>&nbsp;<span class="ident" id="6027352">nil</span><br>
<span class="lineno"></span><span class="op" id="6027356">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="6027359">func</span>&nbsp;<span class="op" id="6027364">(</span><span class="ident" id="6027365">p</span>&nbsp;<span class="op" id="6027367">*</span><span class="ident" id="6027368">printer</span><span class="op" id="6027375">)</span>&nbsp;<span class="ident" id="6027377">marshalSimple</span><span class="op" id="6027390">(</span><span class="ident" id="6027391">typ</span>&nbsp;<span class="ident" id="6027395">reflect</span><span class="op" id="6027402">.</span><span class="ident" id="6027403">Type</span><span class="op" id="6027407">,</span>&nbsp;<span class="ident" id="6027409">val</span>&nbsp;<span class="ident" id="6027413">reflect</span><span class="op" id="6027420">.</span><span class="ident" id="6027421">Value</span><span class="op" id="6027426">)</span>&nbsp;<span class="op" id="6027428">(</span><span class="builtintype" id="6027429">string</span><span class="op" id="6027435">,</span>&nbsp;<span class="op" id="6027437">[</span><span class="op" id="6027438">]</span><span class="builtintype" id="6027439">byte</span><span class="op" id="6027443">,</span>&nbsp;<span class="builtintype" id="6027445">error</span><span class="op" id="6027450">)</span>&nbsp;<span class="op" id="6027452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027455">switch</span>&nbsp;<span class="ident" id="6027462">val</span><span class="op" id="6027465">.</span><span class="ident" id="6027466">Kind</span><span class="op" id="6027470">(</span><span class="op" id="6027471">)</span>&nbsp;<span class="op" id="6027473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027476">case</span>&nbsp;<span class="ident" id="6027481">reflect</span><span class="op" id="6027488">.</span><span class="ident" id="6027489">Int</span><span class="op" id="6027492">,</span>&nbsp;<span class="ident" id="6027494">reflect</span><span class="op" id="6027501">.</span><span class="ident" id="6027502">Int8</span><span class="op" id="6027506">,</span>&nbsp;<span class="ident" id="6027508">reflect</span><span class="op" id="6027515">.</span><span class="ident" id="6027516">Int16</span><span class="op" id="6027521">,</span>&nbsp;<span class="ident" id="6027523">reflect</span><span class="op" id="6027530">.</span><span class="ident" id="6027531">Int32</span><span class="op" id="6027536">,</span>&nbsp;<span class="ident" id="6027538">reflect</span><span class="op" id="6027545">.</span><span class="ident" id="6027546">Int64</span><span class="op" id="6027551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027555">return</span>&nbsp;<span class="ident" id="6027562">strconv</span><span class="op" id="6027569">.</span><span class="ident" id="6027570">FormatInt</span><span class="op" id="6027579">(</span><span class="ident" id="6027580">val</span><span class="op" id="6027583">.</span><span class="ident" id="6027584">Int</span><span class="op" id="6027587">(</span><span class="op" id="6027588">)</span><span class="op" id="6027589">,</span>&nbsp;<span class="num" id="6027591">10</span><span class="op" id="6027593">)</span><span class="op" id="6027594">,</span>&nbsp;<span class="ident" id="6027596">nil</span><span class="op" id="6027599">,</span>&nbsp;<span class="ident" id="6027601">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027606">case</span>&nbsp;<span class="ident" id="6027611">reflect</span><span class="op" id="6027618">.</span><span class="ident" id="6027619">Uint</span><span class="op" id="6027623">,</span>&nbsp;<span class="ident" id="6027625">reflect</span><span class="op" id="6027632">.</span><span class="ident" id="6027633">Uint8</span><span class="op" id="6027638">,</span>&nbsp;<span class="ident" id="6027640">reflect</span><span class="op" id="6027647">.</span><span class="ident" id="6027648">Uint16</span><span class="op" id="6027654">,</span>&nbsp;<span class="ident" id="6027656">reflect</span><span class="op" id="6027663">.</span><span class="ident" id="6027664">Uint32</span><span class="op" id="6027670">,</span>&nbsp;<span class="ident" id="6027672">reflect</span><span class="op" id="6027679">.</span><span class="ident" id="6027680">Uint64</span><span class="op" id="6027686">,</span>&nbsp;<span class="ident" id="6027688">reflect</span><span class="op" id="6027695">.</span><span class="ident" id="6027696">Uintptr</span><span class="op" id="6027703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027707">return</span>&nbsp;<span class="ident" id="6027714">strconv</span><span class="op" id="6027721">.</span><span class="ident" id="6027722">FormatUint</span><span class="op" id="6027732">(</span><span class="ident" id="6027733">val</span><span class="op" id="6027736">.</span><span class="ident" id="6027737">Uint</span><span class="op" id="6027741">(</span><span class="op" id="6027742">)</span><span class="op" id="6027743">,</span>&nbsp;<span class="num" id="6027745">10</span><span class="op" id="6027747">)</span><span class="op" id="6027748">,</span>&nbsp;<span class="ident" id="6027750">nil</span><span class="op" id="6027753">,</span>&nbsp;<span class="ident" id="6027755">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027760">case</span>&nbsp;<span class="ident" id="6027765">reflect</span><span class="op" id="6027772">.</span><span class="ident" id="6027773">Float32</span><span class="op" id="6027780">,</span>&nbsp;<span class="ident" id="6027782">reflect</span><span class="op" id="6027789">.</span><span class="ident" id="6027790">Float64</span><span class="op" id="6027797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027801">return</span>&nbsp;<span class="ident" id="6027808">strconv</span><span class="op" id="6027815">.</span><span class="ident" id="6027816">FormatFloat</span><span class="op" id="6027827">(</span><span class="ident" id="6027828">val</span><span class="op" id="6027831">.</span><span class="ident" id="6027832">Float</span><span class="op" id="6027837">(</span><span class="op" id="6027838">)</span><span class="op" id="6027839">,</span>&nbsp;<span class="string" id="6027841">&#39;g&#39;</span><span class="op" id="6027844">,</span>&nbsp;<span class="op" id="6027846">-</span><span class="num" id="6027847">1</span><span class="op" id="6027848">,</span>&nbsp;<span class="ident" id="6027850">val</span><span class="op" id="6027853">.</span><span class="ident" id="6027854">Type</span><span class="op" id="6027858">(</span><span class="op" id="6027859">)</span><span class="op" id="6027860">.</span><span class="ident" id="6027861">Bits</span><span class="op" id="6027865">(</span><span class="op" id="6027866">)</span><span class="op" id="6027867">)</span><span class="op" id="6027868">,</span>&nbsp;<span class="ident" id="6027870">nil</span><span class="op" id="6027873">,</span>&nbsp;<span class="ident" id="6027875">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027880">case</span>&nbsp;<span class="ident" id="6027885">reflect</span><span class="op" id="6027892">.</span><span class="ident" id="6027893">String</span><span class="op" id="6027899">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027903">return</span>&nbsp;<span class="ident" id="6027910">val</span><span class="op" id="6027913">.</span><span class="ident" id="6027914">String</span><span class="op" id="6027920">(</span><span class="op" id="6027921">)</span><span class="op" id="6027922">,</span>&nbsp;<span class="ident" id="6027924">nil</span><span class="op" id="6027927">,</span>&nbsp;<span class="ident" id="6027929">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027934">case</span>&nbsp;<span class="ident" id="6027939">reflect</span><span class="op" id="6027946">.</span><span class="ident" id="6027947">Bool</span><span class="op" id="6027951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6027955">return</span>&nbsp;<span class="ident" id="6027962">strconv</span><span class="op" id="6027969">.</span><span class="ident" id="6027970">FormatBool</span><span class="op" id="6027980">(</span><span class="ident" id="6027981">val</span><span class="op" id="6027984">.</span><span class="ident" id="6027985">Bool</span><span class="op" id="6027989">(</span><span class="op" id="6027990">)</span><span class="op" id="6027991">)</span><span class="op" id="6027992">,</span>&nbsp;<span class="ident" id="6027994">nil</span><span class="op" id="6027997">,</span>&nbsp;<span class="ident" id="6027999">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028004">case</span>&nbsp;<span class="ident" id="6028009">reflect</span><span class="op" id="6028016">.</span><span class="ident" id="6028017">Array</span><span class="op" id="6028022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028026">if</span>&nbsp;<span class="ident" id="6028029">typ</span><span class="op" id="6028032">.</span><span class="ident" id="6028033">Elem</span><span class="op" id="6028037">(</span><span class="op" id="6028038">)</span><span class="op" id="6028039">.</span><span class="ident" id="6028040">Kind</span><span class="op" id="6028044">(</span><span class="op" id="6028045">)</span>&nbsp;<span class="op" id="6028047">!=</span>&nbsp;<span class="ident" id="6028050">reflect</span><span class="op" id="6028057">.</span><span class="ident" id="6028058">Uint8</span>&nbsp;<span class="op" id="6028064">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028069">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6028081">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028096">var</span>&nbsp;<span class="ident" id="6028100">bytes</span>&nbsp;<span class="op" id="6028106">[</span><span class="op" id="6028107">]</span><span class="builtintype" id="6028108">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028115">if</span>&nbsp;<span class="ident" id="6028118">val</span><span class="op" id="6028121">.</span><span class="ident" id="6028122">CanAddr</span><span class="op" id="6028129">(</span><span class="op" id="6028130">)</span>&nbsp;<span class="op" id="6028132">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028137">bytes</span>&nbsp;<span class="op" id="6028143">=</span>&nbsp;<span class="ident" id="6028145">val</span><span class="op" id="6028148">.</span><span class="ident" id="6028149">Slice</span><span class="op" id="6028154">(</span><span class="num" id="6028155">0</span><span class="op" id="6028156">,</span>&nbsp;<span class="ident" id="6028158">val</span><span class="op" id="6028161">.</span><span class="ident" id="6028162">Len</span><span class="op" id="6028165">(</span><span class="op" id="6028166">)</span><span class="op" id="6028167">)</span><span class="op" id="6028168">.</span><span class="ident" id="6028169">Bytes</span><span class="op" id="6028174">(</span><span class="op" id="6028175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028179">}</span>&nbsp;<span class="keyword" id="6028181">else</span>&nbsp;<span class="op" id="6028186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028191">bytes</span>&nbsp;<span class="op" id="6028197">=</span>&nbsp;<span class="builtinfunc" id="6028199">make</span><span class="op" id="6028203">(</span><span class="op" id="6028204">[</span><span class="op" id="6028205">]</span><span class="builtintype" id="6028206">byte</span><span class="op" id="6028210">,</span>&nbsp;<span class="ident" id="6028212">val</span><span class="op" id="6028215">.</span><span class="ident" id="6028216">Len</span><span class="op" id="6028219">(</span><span class="op" id="6028220">)</span><span class="op" id="6028221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028226">reflect</span><span class="op" id="6028233">.</span><span class="ident" id="6028234">Copy</span><span class="op" id="6028238">(</span><span class="ident" id="6028239">reflect</span><span class="op" id="6028246">.</span><span class="ident" id="6028247">ValueOf</span><span class="op" id="6028254">(</span><span class="ident" id="6028255">bytes</span><span class="op" id="6028260">)</span><span class="op" id="6028261">,</span>&nbsp;<span class="ident" id="6028263">val</span><span class="op" id="6028266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028270">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028274">return</span>&nbsp;<span class="string" id="6028281">&#34;&#34;</span><span class="op" id="6028283">,</span>&nbsp;<span class="ident" id="6028285">bytes</span><span class="op" id="6028290">,</span>&nbsp;<span class="ident" id="6028292">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028297">case</span>&nbsp;<span class="ident" id="6028302">reflect</span><span class="op" id="6028309">.</span><span class="ident" id="6028310">Slice</span><span class="op" id="6028315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028319">if</span>&nbsp;<span class="ident" id="6028322">typ</span><span class="op" id="6028325">.</span><span class="ident" id="6028326">Elem</span><span class="op" id="6028330">(</span><span class="op" id="6028331">)</span><span class="op" id="6028332">.</span><span class="ident" id="6028333">Kind</span><span class="op" id="6028337">(</span><span class="op" id="6028338">)</span>&nbsp;<span class="op" id="6028340">!=</span>&nbsp;<span class="ident" id="6028343">reflect</span><span class="op" id="6028350">.</span><span class="ident" id="6028351">Uint8</span>&nbsp;<span class="op" id="6028357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028362">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028370">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6028374">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028386">return</span>&nbsp;<span class="string" id="6028393">&#34;&#34;</span><span class="op" id="6028395">,</span>&nbsp;<span class="ident" id="6028397">val</span><span class="op" id="6028400">.</span><span class="ident" id="6028401">Bytes</span><span class="op" id="6028406">(</span><span class="op" id="6028407">)</span><span class="op" id="6028408">,</span>&nbsp;<span class="ident" id="6028410">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028418">return</span>&nbsp;<span class="string" id="6028425">&#34;&#34;</span><span class="op" id="6028427">,</span>&nbsp;<span class="ident" id="6028429">nil</span><span class="op" id="6028432">,</span>&nbsp;<span class="op" id="6028434">&amp;</span><span class="ident" id="6028435">UnsupportedTypeError</span><span class="op" id="6028455">{</span><span class="ident" id="6028456">typ</span><span class="op" id="6028459">}</span><br>
<span class="lineno"></span><span class="op" id="6028461">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="6028464">var</span>&nbsp;<span class="ident" id="6028468">ddBytes</span>&nbsp;<span class="op" id="6028476">=</span>&nbsp;<span class="op" id="6028478">[</span><span class="op" id="6028479">]</span><span class="builtintype" id="6028480">byte</span><span class="op" id="6028484">(</span><span class="string" id="6028485">&#34;--&#34;</span><span class="op" id="6028489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6028492">func</span>&nbsp;<span class="op" id="6028497">(</span><span class="ident" id="6028498">p</span>&nbsp;<span class="op" id="6028500">*</span><span class="ident" id="6028501">printer</span><span class="op" id="6028508">)</span>&nbsp;<span class="ident" id="6028510">marshalStruct</span><span class="op" id="6028523">(</span><span class="ident" id="6028524">tinfo</span>&nbsp;<span class="op" id="6028530">*</span><span class="ident" id="6028531">typeInfo</span><span class="op" id="6028539">,</span>&nbsp;<span class="ident" id="6028541">val</span>&nbsp;<span class="ident" id="6028545">reflect</span><span class="op" id="6028552">.</span><span class="ident" id="6028553">Value</span><span class="op" id="6028558">)</span>&nbsp;<span class="builtintype" id="6028560">error</span>&nbsp;<span class="op" id="6028566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028569">s</span>&nbsp;<span class="op" id="6028571">:=</span>&nbsp;<span class="ident" id="6028574">parentStack</span><span class="op" id="6028585">{</span><span class="ident" id="6028586">p</span><span class="op" id="6028587">:</span>&nbsp;<span class="ident" id="6028589">p</span><span class="op" id="6028590">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028593">for</span>&nbsp;<span class="ident" id="6028597">i</span>&nbsp;<span class="op" id="6028599">:=</span>&nbsp;<span class="keyword" id="6028602">range</span>&nbsp;<span class="ident" id="6028608">tinfo</span><span class="op" id="6028613">.</span><span class="ident" id="6028614">fields</span>&nbsp;<span class="op" id="6028621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028625">finfo</span>&nbsp;<span class="op" id="6028631">:=</span>&nbsp;<span class="op" id="6028634">&amp;</span><span class="ident" id="6028635">tinfo</span><span class="op" id="6028640">.</span><span class="ident" id="6028641">fields</span><span class="op" id="6028647">[</span><span class="ident" id="6028648">i</span><span class="op" id="6028649">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028653">if</span>&nbsp;<span class="ident" id="6028656">finfo</span><span class="op" id="6028661">.</span><span class="ident" id="6028662">flags</span><span class="op" id="6028667">&amp;</span><span class="ident" id="6028668">fAttr</span>&nbsp;<span class="op" id="6028674">!=</span>&nbsp;<span class="num" id="6028677">0</span>&nbsp;<span class="op" id="6028679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028684">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028695">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028699">vf</span>&nbsp;<span class="op" id="6028702">:=</span>&nbsp;<span class="ident" id="6028705">finfo</span><span class="op" id="6028710">.</span><span class="ident" id="6028711">value</span><span class="op" id="6028716">(</span><span class="ident" id="6028717">val</span><span class="op" id="6028720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6028725">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028781">switch</span>&nbsp;<span class="ident" id="6028788">vf</span><span class="op" id="6028790">.</span><span class="ident" id="6028791">Kind</span><span class="op" id="6028795">(</span><span class="op" id="6028796">)</span>&nbsp;<span class="op" id="6028798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028802">case</span>&nbsp;<span class="ident" id="6028807">reflect</span><span class="op" id="6028814">.</span><span class="ident" id="6028815">Ptr</span><span class="op" id="6028818">,</span>&nbsp;<span class="ident" id="6028820">reflect</span><span class="op" id="6028827">.</span><span class="ident" id="6028828">Interface</span><span class="op" id="6028837">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028842">if</span>&nbsp;<span class="op" id="6028845">!</span><span class="ident" id="6028846">vf</span><span class="op" id="6028848">.</span><span class="ident" id="6028849">IsNil</span><span class="op" id="6028854">(</span><span class="op" id="6028855">)</span>&nbsp;<span class="op" id="6028857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6028863">vf</span>&nbsp;<span class="op" id="6028866">=</span>&nbsp;<span class="ident" id="6028868">vf</span><span class="op" id="6028870">.</span><span class="ident" id="6028871">Elem</span><span class="op" id="6028875">(</span><span class="op" id="6028876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6028885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028890">switch</span>&nbsp;<span class="ident" id="6028897">finfo</span><span class="op" id="6028902">.</span><span class="ident" id="6028903">flags</span>&nbsp;<span class="op" id="6028909">&amp;</span>&nbsp;<span class="ident" id="6028911">fMode</span>&nbsp;<span class="op" id="6028917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028921">case</span>&nbsp;<span class="ident" id="6028926">fCharData</span><span class="op" id="6028935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6028940">if</span>&nbsp;<span class="ident" id="6028943">vf</span><span class="op" id="6028945">.</span><span class="ident" id="6028946">CanInterface</span><span class="op" id="6028958">(</span><span class="op" id="6028959">)</span>&nbsp;<span class="op" id="6028961">&amp;&amp;</span>&nbsp;<span class="ident" id="6028964">vf</span><span class="op" id="6028966">.</span><span class="ident" id="6028967">Type</span><span class="op" id="6028971">(</span><span class="op" id="6028972">)</span><span class="op" id="6028973">.</span><span class="ident" id="6028974">Implements</span><span class="op" id="6028984">(</span><span class="ident" id="6028985">textMarshalerType</span><span class="op" id="6029002">)</span>&nbsp;<span class="op" id="6029004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029010">data</span><span class="op" id="6029014">,</span>&nbsp;<span class="ident" id="6029016">err</span>&nbsp;<span class="op" id="6029020">:=</span>&nbsp;<span class="ident" id="6029023">vf</span><span class="op" id="6029025">.</span><span class="ident" id="6029026">Interface</span><span class="op" id="6029035">(</span><span class="op" id="6029036">)</span><span class="op" id="6029037">.</span><span class="op" id="6029038">(</span><span class="ident" id="6029039">encoding</span><span class="op" id="6029047">.</span><span class="ident" id="6029048">TextMarshaler</span><span class="op" id="6029061">)</span><span class="op" id="6029062">.</span><span class="ident" id="6029063">MarshalText</span><span class="op" id="6029074">(</span><span class="op" id="6029075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029081">if</span>&nbsp;<span class="ident" id="6029084">err</span>&nbsp;<span class="op" id="6029088">!=</span>&nbsp;<span class="ident" id="6029091">nil</span>&nbsp;<span class="op" id="6029095">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029102">return</span>&nbsp;<span class="ident" id="6029109">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6029117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029123">Escape</span><span class="op" id="6029129">(</span><span class="ident" id="6029130">p</span><span class="op" id="6029131">,</span>&nbsp;<span class="ident" id="6029133">data</span><span class="op" id="6029137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029143">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6029155">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029160">if</span>&nbsp;<span class="ident" id="6029163">vf</span><span class="op" id="6029165">.</span><span class="ident" id="6029166">CanAddr</span><span class="op" id="6029173">(</span><span class="op" id="6029174">)</span>&nbsp;<span class="op" id="6029176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029182">pv</span>&nbsp;<span class="op" id="6029185">:=</span>&nbsp;<span class="ident" id="6029188">vf</span><span class="op" id="6029190">.</span><span class="ident" id="6029191">Addr</span><span class="op" id="6029195">(</span><span class="op" id="6029196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029202">if</span>&nbsp;<span class="ident" id="6029205">pv</span><span class="op" id="6029207">.</span><span class="ident" id="6029208">CanInterface</span><span class="op" id="6029220">(</span><span class="op" id="6029221">)</span>&nbsp;<span class="op" id="6029223">&amp;&amp;</span>&nbsp;<span class="ident" id="6029226">pv</span><span class="op" id="6029228">.</span><span class="ident" id="6029229">Type</span><span class="op" id="6029233">(</span><span class="op" id="6029234">)</span><span class="op" id="6029235">.</span><span class="ident" id="6029236">Implements</span><span class="op" id="6029246">(</span><span class="ident" id="6029247">textMarshalerType</span><span class="op" id="6029264">)</span>&nbsp;<span class="op" id="6029266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029273">data</span><span class="op" id="6029277">,</span>&nbsp;<span class="ident" id="6029279">err</span>&nbsp;<span class="op" id="6029283">:=</span>&nbsp;<span class="ident" id="6029286">pv</span><span class="op" id="6029288">.</span><span class="ident" id="6029289">Interface</span><span class="op" id="6029298">(</span><span class="op" id="6029299">)</span><span class="op" id="6029300">.</span><span class="op" id="6029301">(</span><span class="ident" id="6029302">encoding</span><span class="op" id="6029310">.</span><span class="ident" id="6029311">TextMarshaler</span><span class="op" id="6029324">)</span><span class="op" id="6029325">.</span><span class="ident" id="6029326">MarshalText</span><span class="op" id="6029337">(</span><span class="op" id="6029338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029345">if</span>&nbsp;<span class="ident" id="6029348">err</span>&nbsp;<span class="op" id="6029352">!=</span>&nbsp;<span class="ident" id="6029355">nil</span>&nbsp;<span class="op" id="6029359">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029367">return</span>&nbsp;<span class="ident" id="6029374">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6029383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029390">Escape</span><span class="op" id="6029396">(</span><span class="ident" id="6029397">p</span><span class="op" id="6029398">,</span>&nbsp;<span class="ident" id="6029400">data</span><span class="op" id="6029404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029411">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6029424">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6029429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029434">var</span>&nbsp;<span class="ident" id="6029438">scratch</span>&nbsp;<span class="op" id="6029446">[</span><span class="num" id="6029447">64</span><span class="op" id="6029449">]</span><span class="builtintype" id="6029450">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029458">switch</span>&nbsp;<span class="ident" id="6029465">vf</span><span class="op" id="6029467">.</span><span class="ident" id="6029468">Kind</span><span class="op" id="6029472">(</span><span class="op" id="6029473">)</span>&nbsp;<span class="op" id="6029475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029480">case</span>&nbsp;<span class="ident" id="6029485">reflect</span><span class="op" id="6029492">.</span><span class="ident" id="6029493">Int</span><span class="op" id="6029496">,</span>&nbsp;<span class="ident" id="6029498">reflect</span><span class="op" id="6029505">.</span><span class="ident" id="6029506">Int8</span><span class="op" id="6029510">,</span>&nbsp;<span class="ident" id="6029512">reflect</span><span class="op" id="6029519">.</span><span class="ident" id="6029520">Int16</span><span class="op" id="6029525">,</span>&nbsp;<span class="ident" id="6029527">reflect</span><span class="op" id="6029534">.</span><span class="ident" id="6029535">Int32</span><span class="op" id="6029540">,</span>&nbsp;<span class="ident" id="6029542">reflect</span><span class="op" id="6029549">.</span><span class="ident" id="6029550">Int64</span><span class="op" id="6029555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029561">Escape</span><span class="op" id="6029567">(</span><span class="ident" id="6029568">p</span><span class="op" id="6029569">,</span>&nbsp;<span class="ident" id="6029571">strconv</span><span class="op" id="6029578">.</span><span class="ident" id="6029579">AppendInt</span><span class="op" id="6029588">(</span><span class="ident" id="6029589">scratch</span><span class="op" id="6029596">[</span><span class="op" id="6029597">:</span><span class="num" id="6029598">0</span><span class="op" id="6029599">]</span><span class="op" id="6029600">,</span>&nbsp;<span class="ident" id="6029602">vf</span><span class="op" id="6029604">.</span><span class="ident" id="6029605">Int</span><span class="op" id="6029608">(</span><span class="op" id="6029609">)</span><span class="op" id="6029610">,</span>&nbsp;<span class="num" id="6029612">10</span><span class="op" id="6029614">)</span><span class="op" id="6029615">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029620">case</span>&nbsp;<span class="ident" id="6029625">reflect</span><span class="op" id="6029632">.</span><span class="ident" id="6029633">Uint</span><span class="op" id="6029637">,</span>&nbsp;<span class="ident" id="6029639">reflect</span><span class="op" id="6029646">.</span><span class="ident" id="6029647">Uint8</span><span class="op" id="6029652">,</span>&nbsp;<span class="ident" id="6029654">reflect</span><span class="op" id="6029661">.</span><span class="ident" id="6029662">Uint16</span><span class="op" id="6029668">,</span>&nbsp;<span class="ident" id="6029670">reflect</span><span class="op" id="6029677">.</span><span class="ident" id="6029678">Uint32</span><span class="op" id="6029684">,</span>&nbsp;<span class="ident" id="6029686">reflect</span><span class="op" id="6029693">.</span><span class="ident" id="6029694">Uint64</span><span class="op" id="6029700">,</span>&nbsp;<span class="ident" id="6029702">reflect</span><span class="op" id="6029709">.</span><span class="ident" id="6029710">Uintptr</span><span class="op" id="6029717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029723">Escape</span><span class="op" id="6029729">(</span><span class="ident" id="6029730">p</span><span class="op" id="6029731">,</span>&nbsp;<span class="ident" id="6029733">strconv</span><span class="op" id="6029740">.</span><span class="ident" id="6029741">AppendUint</span><span class="op" id="6029751">(</span><span class="ident" id="6029752">scratch</span><span class="op" id="6029759">[</span><span class="op" id="6029760">:</span><span class="num" id="6029761">0</span><span class="op" id="6029762">]</span><span class="op" id="6029763">,</span>&nbsp;<span class="ident" id="6029765">vf</span><span class="op" id="6029767">.</span><span class="ident" id="6029768">Uint</span><span class="op" id="6029772">(</span><span class="op" id="6029773">)</span><span class="op" id="6029774">,</span>&nbsp;<span class="num" id="6029776">10</span><span class="op" id="6029778">)</span><span class="op" id="6029779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029784">case</span>&nbsp;<span class="ident" id="6029789">reflect</span><span class="op" id="6029796">.</span><span class="ident" id="6029797">Float32</span><span class="op" id="6029804">,</span>&nbsp;<span class="ident" id="6029806">reflect</span><span class="op" id="6029813">.</span><span class="ident" id="6029814">Float64</span><span class="op" id="6029821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029827">Escape</span><span class="op" id="6029833">(</span><span class="ident" id="6029834">p</span><span class="op" id="6029835">,</span>&nbsp;<span class="ident" id="6029837">strconv</span><span class="op" id="6029844">.</span><span class="ident" id="6029845">AppendFloat</span><span class="op" id="6029856">(</span><span class="ident" id="6029857">scratch</span><span class="op" id="6029864">[</span><span class="op" id="6029865">:</span><span class="num" id="6029866">0</span><span class="op" id="6029867">]</span><span class="op" id="6029868">,</span>&nbsp;<span class="ident" id="6029870">vf</span><span class="op" id="6029872">.</span><span class="ident" id="6029873">Float</span><span class="op" id="6029878">(</span><span class="op" id="6029879">)</span><span class="op" id="6029880">,</span>&nbsp;<span class="string" id="6029882">&#39;g&#39;</span><span class="op" id="6029885">,</span>&nbsp;<span class="op" id="6029887">-</span><span class="num" id="6029888">1</span><span class="op" id="6029889">,</span>&nbsp;<span class="ident" id="6029891">vf</span><span class="op" id="6029893">.</span><span class="ident" id="6029894">Type</span><span class="op" id="6029898">(</span><span class="op" id="6029899">)</span><span class="op" id="6029900">.</span><span class="ident" id="6029901">Bits</span><span class="op" id="6029905">(</span><span class="op" id="6029906">)</span><span class="op" id="6029907">)</span><span class="op" id="6029908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029913">case</span>&nbsp;<span class="ident" id="6029918">reflect</span><span class="op" id="6029925">.</span><span class="ident" id="6029926">Bool</span><span class="op" id="6029930">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6029936">Escape</span><span class="op" id="6029942">(</span><span class="ident" id="6029943">p</span><span class="op" id="6029944">,</span>&nbsp;<span class="ident" id="6029946">strconv</span><span class="op" id="6029953">.</span><span class="ident" id="6029954">AppendBool</span><span class="op" id="6029964">(</span><span class="ident" id="6029965">scratch</span><span class="op" id="6029972">[</span><span class="op" id="6029973">:</span><span class="num" id="6029974">0</span><span class="op" id="6029975">]</span><span class="op" id="6029976">,</span>&nbsp;<span class="ident" id="6029978">vf</span><span class="op" id="6029980">.</span><span class="ident" id="6029981">Bool</span><span class="op" id="6029985">(</span><span class="op" id="6029986">)</span><span class="op" id="6029987">)</span><span class="op" id="6029988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6029993">case</span>&nbsp;<span class="ident" id="6029998">reflect</span><span class="op" id="6030005">.</span><span class="ident" id="6030006">String</span><span class="op" id="6030012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030018">if</span>&nbsp;<span class="ident" id="6030021">err</span>&nbsp;<span class="op" id="6030025">:=</span>&nbsp;<span class="ident" id="6030028">EscapeText</span><span class="op" id="6030038">(</span><span class="ident" id="6030039">p</span><span class="op" id="6030040">,</span>&nbsp;<span class="op" id="6030042">[</span><span class="op" id="6030043">]</span><span class="builtintype" id="6030044">byte</span><span class="op" id="6030048">(</span><span class="ident" id="6030049">vf</span><span class="op" id="6030051">.</span><span class="ident" id="6030052">String</span><span class="op" id="6030058">(</span><span class="op" id="6030059">)</span><span class="op" id="6030060">)</span><span class="op" id="6030061">)</span><span class="op" id="6030062">;</span>&nbsp;<span class="ident" id="6030064">err</span>&nbsp;<span class="op" id="6030068">!=</span>&nbsp;<span class="ident" id="6030071">nil</span>&nbsp;<span class="op" id="6030075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030082">return</span>&nbsp;<span class="ident" id="6030089">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030097">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030102">case</span>&nbsp;<span class="ident" id="6030107">reflect</span><span class="op" id="6030114">.</span><span class="ident" id="6030115">Slice</span><span class="op" id="6030120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030126">if</span>&nbsp;<span class="ident" id="6030129">elem</span><span class="op" id="6030133">,</span>&nbsp;<span class="ident" id="6030135">ok</span>&nbsp;<span class="op" id="6030138">:=</span>&nbsp;<span class="ident" id="6030141">vf</span><span class="op" id="6030143">.</span><span class="ident" id="6030144">Interface</span><span class="op" id="6030153">(</span><span class="op" id="6030154">)</span><span class="op" id="6030155">.</span><span class="op" id="6030156">(</span><span class="op" id="6030157">[</span><span class="op" id="6030158">]</span><span class="builtintype" id="6030159">byte</span><span class="op" id="6030163">)</span><span class="op" id="6030164">;</span>&nbsp;<span class="ident" id="6030166">ok</span>&nbsp;<span class="op" id="6030169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030176">if</span>&nbsp;<span class="ident" id="6030179">err</span>&nbsp;<span class="op" id="6030183">:=</span>&nbsp;<span class="ident" id="6030186">EscapeText</span><span class="op" id="6030196">(</span><span class="ident" id="6030197">p</span><span class="op" id="6030198">,</span>&nbsp;<span class="ident" id="6030200">elem</span><span class="op" id="6030204">)</span><span class="op" id="6030205">;</span>&nbsp;<span class="ident" id="6030207">err</span>&nbsp;<span class="op" id="6030211">!=</span>&nbsp;<span class="ident" id="6030214">nil</span>&nbsp;<span class="op" id="6030218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030226">return</span>&nbsp;<span class="ident" id="6030233">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030242">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030258">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030270">case</span>&nbsp;<span class="ident" id="6030275">fComment</span><span class="op" id="6030283">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030288">k</span>&nbsp;<span class="op" id="6030290">:=</span>&nbsp;<span class="ident" id="6030293">vf</span><span class="op" id="6030295">.</span><span class="ident" id="6030296">Kind</span><span class="op" id="6030300">(</span><span class="op" id="6030301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030306">if</span>&nbsp;<span class="op" id="6030309">!</span><span class="op" id="6030310">(</span><span class="ident" id="6030311">k</span>&nbsp;<span class="op" id="6030313">==</span>&nbsp;<span class="ident" id="6030316">reflect</span><span class="op" id="6030323">.</span><span class="ident" id="6030324">String</span>&nbsp;<span class="op" id="6030331">||</span>&nbsp;<span class="ident" id="6030334">k</span>&nbsp;<span class="op" id="6030336">==</span>&nbsp;<span class="ident" id="6030339">reflect</span><span class="op" id="6030346">.</span><span class="ident" id="6030347">Slice</span>&nbsp;<span class="op" id="6030353">&amp;&amp;</span>&nbsp;<span class="ident" id="6030356">vf</span><span class="op" id="6030358">.</span><span class="ident" id="6030359">Type</span><span class="op" id="6030363">(</span><span class="op" id="6030364">)</span><span class="op" id="6030365">.</span><span class="ident" id="6030366">Elem</span><span class="op" id="6030370">(</span><span class="op" id="6030371">)</span><span class="op" id="6030372">.</span><span class="ident" id="6030373">Kind</span><span class="op" id="6030377">(</span><span class="op" id="6030378">)</span>&nbsp;<span class="op" id="6030380">==</span>&nbsp;<span class="ident" id="6030383">reflect</span><span class="op" id="6030390">.</span><span class="ident" id="6030391">Uint8</span><span class="op" id="6030396">)</span>&nbsp;<span class="op" id="6030398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030404">return</span>&nbsp;<span class="ident" id="6030411">fmt</span><span class="op" id="6030414">.</span><span class="ident" id="6030415">Errorf</span><span class="op" id="6030421">(</span><span class="string" id="6030422">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="6030461">,</span>&nbsp;<span class="ident" id="6030463">val</span><span class="op" id="6030466">.</span><span class="ident" id="6030467">Type</span><span class="op" id="6030471">(</span><span class="op" id="6030472">)</span><span class="op" id="6030473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030483">if</span>&nbsp;<span class="ident" id="6030486">vf</span><span class="op" id="6030488">.</span><span class="ident" id="6030489">Len</span><span class="op" id="6030492">(</span><span class="op" id="6030493">)</span>&nbsp;<span class="op" id="6030495">==</span>&nbsp;<span class="num" id="6030498">0</span>&nbsp;<span class="op" id="6030500">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030506">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030523">p</span><span class="op" id="6030524">.</span><span class="ident" id="6030525">writeIndent</span><span class="op" id="6030536">(</span><span class="num" id="6030537">0</span><span class="op" id="6030538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030543">p</span><span class="op" id="6030544">.</span><span class="ident" id="6030545">WriteString</span><span class="op" id="6030556">(</span><span class="string" id="6030557">&#34;&lt;!--&#34;</span><span class="op" id="6030563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030568">dashDash</span>&nbsp;<span class="op" id="6030577">:=</span>&nbsp;<span class="builtintype" id="6030580">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030589">dashLast</span>&nbsp;<span class="op" id="6030598">:=</span>&nbsp;<span class="builtintype" id="6030601">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030610">switch</span>&nbsp;<span class="ident" id="6030617">k</span>&nbsp;<span class="op" id="6030619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030624">case</span>&nbsp;<span class="ident" id="6030629">reflect</span><span class="op" id="6030636">.</span><span class="ident" id="6030637">String</span><span class="op" id="6030643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030649">s</span>&nbsp;<span class="op" id="6030651">:=</span>&nbsp;<span class="ident" id="6030654">vf</span><span class="op" id="6030656">.</span><span class="ident" id="6030657">String</span><span class="op" id="6030663">(</span><span class="op" id="6030664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030670">dashDash</span>&nbsp;<span class="op" id="6030679">=</span>&nbsp;<span class="ident" id="6030681">strings</span><span class="op" id="6030688">.</span><span class="ident" id="6030689">Index</span><span class="op" id="6030694">(</span><span class="ident" id="6030695">s</span><span class="op" id="6030696">,</span>&nbsp;<span class="string" id="6030698">&#34;--&#34;</span><span class="op" id="6030702">)</span>&nbsp;<span class="op" id="6030704">&gt;=</span>&nbsp;<span class="num" id="6030707">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030713">dashLast</span>&nbsp;<span class="op" id="6030722">=</span>&nbsp;<span class="ident" id="6030724">s</span><span class="op" id="6030725">[</span><span class="builtinfunc" id="6030726">len</span><span class="op" id="6030729">(</span><span class="ident" id="6030730">s</span><span class="op" id="6030731">)</span><span class="op" id="6030732">-</span><span class="num" id="6030733">1</span><span class="op" id="6030734">]</span>&nbsp;<span class="op" id="6030736">==</span>&nbsp;<span class="string" id="6030739">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030747">if</span>&nbsp;<span class="op" id="6030750">!</span><span class="ident" id="6030751">dashDash</span>&nbsp;<span class="op" id="6030760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030767">p</span><span class="op" id="6030768">.</span><span class="ident" id="6030769">WriteString</span><span class="op" id="6030780">(</span><span class="ident" id="6030781">s</span><span class="op" id="6030782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030793">case</span>&nbsp;<span class="ident" id="6030798">reflect</span><span class="op" id="6030805">.</span><span class="ident" id="6030806">Slice</span><span class="op" id="6030811">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030817">b</span>&nbsp;<span class="op" id="6030819">:=</span>&nbsp;<span class="ident" id="6030822">vf</span><span class="op" id="6030824">.</span><span class="ident" id="6030825">Bytes</span><span class="op" id="6030830">(</span><span class="op" id="6030831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030837">dashDash</span>&nbsp;<span class="op" id="6030846">=</span>&nbsp;<span class="ident" id="6030848">bytes</span><span class="op" id="6030853">.</span><span class="ident" id="6030854">Index</span><span class="op" id="6030859">(</span><span class="ident" id="6030860">b</span><span class="op" id="6030861">,</span>&nbsp;<span class="ident" id="6030863">ddBytes</span><span class="op" id="6030870">)</span>&nbsp;<span class="op" id="6030872">&gt;=</span>&nbsp;<span class="num" id="6030875">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030881">dashLast</span>&nbsp;<span class="op" id="6030890">=</span>&nbsp;<span class="ident" id="6030892">b</span><span class="op" id="6030893">[</span><span class="builtinfunc" id="6030894">len</span><span class="op" id="6030897">(</span><span class="ident" id="6030898">b</span><span class="op" id="6030899">)</span><span class="op" id="6030900">-</span><span class="num" id="6030901">1</span><span class="op" id="6030902">]</span>&nbsp;<span class="op" id="6030904">==</span>&nbsp;<span class="string" id="6030907">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030915">if</span>&nbsp;<span class="op" id="6030918">!</span><span class="ident" id="6030919">dashDash</span>&nbsp;<span class="op" id="6030928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6030935">p</span><span class="op" id="6030936">.</span><span class="ident" id="6030937">Write</span><span class="op" id="6030942">(</span><span class="ident" id="6030943">b</span><span class="op" id="6030944">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030955">default</span><span class="op" id="6030962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6030968">panic</span><span class="op" id="6030973">(</span><span class="string" id="6030974">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="6030988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6030993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6030998">if</span>&nbsp;<span class="ident" id="6031001">dashDash</span>&nbsp;<span class="op" id="6031010">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031016">return</span>&nbsp;<span class="ident" id="6031023">fmt</span><span class="op" id="6031026">.</span><span class="ident" id="6031027">Errorf</span><span class="op" id="6031033">(</span><span class="string" id="6031034">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="6031071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031081">if</span>&nbsp;<span class="ident" id="6031084">dashLast</span>&nbsp;<span class="op" id="6031093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6031099">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031149">p</span><span class="op" id="6031150">.</span><span class="ident" id="6031151">WriteByte</span><span class="op" id="6031160">(</span><span class="string" id="6031161">&#39;&nbsp;&#39;</span><span class="op" id="6031164">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031174">p</span><span class="op" id="6031175">.</span><span class="ident" id="6031176">WriteString</span><span class="op" id="6031187">(</span><span class="string" id="6031188">&#34;--&gt;&#34;</span><span class="op" id="6031193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031198">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031210">case</span>&nbsp;<span class="ident" id="6031215">fInnerXml</span><span class="op" id="6031224">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031229">iface</span>&nbsp;<span class="op" id="6031235">:=</span>&nbsp;<span class="ident" id="6031238">vf</span><span class="op" id="6031240">.</span><span class="ident" id="6031241">Interface</span><span class="op" id="6031250">(</span><span class="op" id="6031251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031256">switch</span>&nbsp;<span class="ident" id="6031263">raw</span>&nbsp;<span class="op" id="6031267">:=</span>&nbsp;<span class="ident" id="6031270">iface</span><span class="op" id="6031275">.</span><span class="op" id="6031276">(</span><span class="keyword" id="6031277">type</span><span class="op" id="6031281">)</span>&nbsp;<span class="op" id="6031283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031288">case</span>&nbsp;<span class="op" id="6031293">[</span><span class="op" id="6031294">]</span><span class="builtintype" id="6031295">byte</span><span class="op" id="6031299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031305">p</span><span class="op" id="6031306">.</span><span class="ident" id="6031307">Write</span><span class="op" id="6031312">(</span><span class="ident" id="6031313">raw</span><span class="op" id="6031316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031322">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031334">case</span>&nbsp;<span class="builtintype" id="6031339">string</span><span class="op" id="6031345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031351">p</span><span class="op" id="6031352">.</span><span class="ident" id="6031353">WriteString</span><span class="op" id="6031364">(</span><span class="ident" id="6031365">raw</span><span class="op" id="6031368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031374">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031391">case</span>&nbsp;<span class="ident" id="6031396">fElement</span><span class="op" id="6031404">,</span>&nbsp;<span class="ident" id="6031406">fElement</span>&nbsp;<span class="op" id="6031415">|</span>&nbsp;<span class="ident" id="6031417">fAny</span><span class="op" id="6031421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031426">if</span>&nbsp;<span class="ident" id="6031429">err</span>&nbsp;<span class="op" id="6031433">:=</span>&nbsp;<span class="ident" id="6031436">s</span><span class="op" id="6031437">.</span><span class="ident" id="6031438">trim</span><span class="op" id="6031442">(</span><span class="ident" id="6031443">finfo</span><span class="op" id="6031448">.</span><span class="ident" id="6031449">parents</span><span class="op" id="6031456">)</span><span class="op" id="6031457">;</span>&nbsp;<span class="ident" id="6031459">err</span>&nbsp;<span class="op" id="6031463">!=</span>&nbsp;<span class="ident" id="6031466">nil</span>&nbsp;<span class="op" id="6031470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031476">return</span>&nbsp;<span class="ident" id="6031483">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031495">if</span>&nbsp;<span class="builtinfunc" id="6031498">len</span><span class="op" id="6031501">(</span><span class="ident" id="6031502">finfo</span><span class="op" id="6031507">.</span><span class="ident" id="6031508">parents</span><span class="op" id="6031515">)</span>&nbsp;<span class="op" id="6031517">&gt;</span>&nbsp;<span class="builtinfunc" id="6031519">len</span><span class="op" id="6031522">(</span><span class="ident" id="6031523">s</span><span class="op" id="6031524">.</span><span class="ident" id="6031525">stack</span><span class="op" id="6031530">)</span>&nbsp;<span class="op" id="6031532">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031538">if</span>&nbsp;<span class="ident" id="6031541">vf</span><span class="op" id="6031543">.</span><span class="ident" id="6031544">Kind</span><span class="op" id="6031548">(</span><span class="op" id="6031549">)</span>&nbsp;<span class="op" id="6031551">!=</span>&nbsp;<span class="ident" id="6031554">reflect</span><span class="op" id="6031561">.</span><span class="ident" id="6031562">Ptr</span>&nbsp;<span class="op" id="6031566">&amp;&amp;</span>&nbsp;<span class="ident" id="6031569">vf</span><span class="op" id="6031571">.</span><span class="ident" id="6031572">Kind</span><span class="op" id="6031576">(</span><span class="op" id="6031577">)</span>&nbsp;<span class="op" id="6031579">!=</span>&nbsp;<span class="ident" id="6031582">reflect</span><span class="op" id="6031589">.</span><span class="ident" id="6031590">Interface</span>&nbsp;<span class="op" id="6031600">||</span>&nbsp;<span class="op" id="6031603">!</span><span class="ident" id="6031604">vf</span><span class="op" id="6031606">.</span><span class="ident" id="6031607">IsNil</span><span class="op" id="6031612">(</span><span class="op" id="6031613">)</span>&nbsp;<span class="op" id="6031615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031622">if</span>&nbsp;<span class="ident" id="6031625">err</span>&nbsp;<span class="op" id="6031629">:=</span>&nbsp;<span class="ident" id="6031632">s</span><span class="op" id="6031633">.</span><span class="ident" id="6031634">push</span><span class="op" id="6031638">(</span><span class="ident" id="6031639">finfo</span><span class="op" id="6031644">.</span><span class="ident" id="6031645">parents</span><span class="op" id="6031652">[</span><span class="builtinfunc" id="6031653">len</span><span class="op" id="6031656">(</span><span class="ident" id="6031657">s</span><span class="op" id="6031658">.</span><span class="ident" id="6031659">stack</span><span class="op" id="6031664">)</span><span class="op" id="6031665">:</span><span class="op" id="6031666">]</span><span class="op" id="6031667">)</span><span class="op" id="6031668">;</span>&nbsp;<span class="ident" id="6031670">err</span>&nbsp;<span class="op" id="6031674">!=</span>&nbsp;<span class="ident" id="6031677">nil</span>&nbsp;<span class="op" id="6031681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031689">return</span>&nbsp;<span class="ident" id="6031696">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031711">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031724">if</span>&nbsp;<span class="ident" id="6031727">err</span>&nbsp;<span class="op" id="6031731">:=</span>&nbsp;<span class="ident" id="6031734">p</span><span class="op" id="6031735">.</span><span class="ident" id="6031736">marshalValue</span><span class="op" id="6031748">(</span><span class="ident" id="6031749">vf</span><span class="op" id="6031751">,</span>&nbsp;<span class="ident" id="6031753">finfo</span><span class="op" id="6031758">,</span>&nbsp;<span class="ident" id="6031760">nil</span><span class="op" id="6031763">)</span><span class="op" id="6031764">;</span>&nbsp;<span class="ident" id="6031766">err</span>&nbsp;<span class="op" id="6031770">!=</span>&nbsp;<span class="ident" id="6031773">nil</span>&nbsp;<span class="op" id="6031777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031782">return</span>&nbsp;<span class="ident" id="6031789">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031795">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6031798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031801">s</span><span class="op" id="6031802">.</span><span class="ident" id="6031803">trim</span><span class="op" id="6031807">(</span><span class="ident" id="6031808">nil</span><span class="op" id="6031811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031814">return</span>&nbsp;<span class="ident" id="6031821">p</span><span class="op" id="6031822">.</span><span class="ident" id="6031823">cachedWriteError</span><span class="op" id="6031839">(</span><span class="op" id="6031840">)</span><br>
<span class="lineno"></span><span class="op" id="6031842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="6031845">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="6031893">func</span>&nbsp;<span class="op" id="6031898">(</span><span class="ident" id="6031899">p</span>&nbsp;<span class="op" id="6031901">*</span><span class="ident" id="6031902">printer</span><span class="op" id="6031909">)</span>&nbsp;<span class="ident" id="6031911">cachedWriteError</span><span class="op" id="6031927">(</span><span class="op" id="6031928">)</span>&nbsp;<span class="builtintype" id="6031930">error</span>&nbsp;<span class="op" id="6031936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6031939">_</span><span class="op" id="6031940">,</span>&nbsp;<span class="ident" id="6031942">err</span>&nbsp;<span class="op" id="6031946">:=</span>&nbsp;<span class="ident" id="6031949">p</span><span class="op" id="6031950">.</span><span class="ident" id="6031951">Write</span><span class="op" id="6031956">(</span><span class="ident" id="6031957">nil</span><span class="op" id="6031960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6031963">return</span>&nbsp;<span class="ident" id="6031970">err</span><br>
<span class="lineno"></span><span class="op" id="6031974">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="6031977">func</span>&nbsp;<span class="op" id="6031982">(</span><span class="ident" id="6031983">p</span>&nbsp;<span class="op" id="6031985">*</span><span class="ident" id="6031986">printer</span><span class="op" id="6031993">)</span>&nbsp;<span class="ident" id="6031995">writeIndent</span><span class="op" id="6032006">(</span><span class="ident" id="6032007">depthDelta</span>&nbsp;<span class="builtintype" id="6032018">int</span><span class="op" id="6032021">)</span>&nbsp;<span class="op" id="6032023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032026">if</span>&nbsp;<span class="builtinfunc" id="6032029">len</span><span class="op" id="6032032">(</span><span class="ident" id="6032033">p</span><span class="op" id="6032034">.</span><span class="ident" id="6032035">prefix</span><span class="op" id="6032041">)</span>&nbsp;<span class="op" id="6032043">==</span>&nbsp;<span class="num" id="6032046">0</span>&nbsp;<span class="op" id="6032048">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6032051">len</span><span class="op" id="6032054">(</span><span class="ident" id="6032055">p</span><span class="op" id="6032056">.</span><span class="ident" id="6032057">indent</span><span class="op" id="6032063">)</span>&nbsp;<span class="op" id="6032065">==</span>&nbsp;<span class="num" id="6032068">0</span>&nbsp;<span class="op" id="6032070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032074">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032082">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032085">if</span>&nbsp;<span class="ident" id="6032088">depthDelta</span>&nbsp;<span class="op" id="6032099">&lt;</span>&nbsp;<span class="num" id="6032101">0</span>&nbsp;<span class="op" id="6032103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032107">p</span><span class="op" id="6032108">.</span><span class="ident" id="6032109">depth</span><span class="op" id="6032114">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032119">if</span>&nbsp;<span class="ident" id="6032122">p</span><span class="op" id="6032123">.</span><span class="ident" id="6032124">indentedIn</span>&nbsp;<span class="op" id="6032135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032140">p</span><span class="op" id="6032141">.</span><span class="ident" id="6032142">indentedIn</span>&nbsp;<span class="op" id="6032153">=</span>&nbsp;<span class="builtintype" id="6032155">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032164">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032177">p</span><span class="op" id="6032178">.</span><span class="ident" id="6032179">indentedIn</span>&nbsp;<span class="op" id="6032190">=</span>&nbsp;<span class="builtintype" id="6032192">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032202">if</span>&nbsp;<span class="ident" id="6032205">p</span><span class="op" id="6032206">.</span><span class="ident" id="6032207">putNewline</span>&nbsp;<span class="op" id="6032218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032222">p</span><span class="op" id="6032223">.</span><span class="ident" id="6032224">WriteByte</span><span class="op" id="6032233">(</span><span class="string" id="6032234">&#39;\n&#39;</span><span class="op" id="6032238">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032241">}</span>&nbsp;<span class="keyword" id="6032243">else</span>&nbsp;<span class="op" id="6032248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032252">p</span><span class="op" id="6032253">.</span><span class="ident" id="6032254">putNewline</span>&nbsp;<span class="op" id="6032265">=</span>&nbsp;<span class="builtintype" id="6032267">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032276">if</span>&nbsp;<span class="builtinfunc" id="6032279">len</span><span class="op" id="6032282">(</span><span class="ident" id="6032283">p</span><span class="op" id="6032284">.</span><span class="ident" id="6032285">prefix</span><span class="op" id="6032291">)</span>&nbsp;<span class="op" id="6032293">&gt;</span>&nbsp;<span class="num" id="6032295">0</span>&nbsp;<span class="op" id="6032297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032301">p</span><span class="op" id="6032302">.</span><span class="ident" id="6032303">WriteString</span><span class="op" id="6032314">(</span><span class="ident" id="6032315">p</span><span class="op" id="6032316">.</span><span class="ident" id="6032317">prefix</span><span class="op" id="6032323">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032329">if</span>&nbsp;<span class="builtinfunc" id="6032332">len</span><span class="op" id="6032335">(</span><span class="ident" id="6032336">p</span><span class="op" id="6032337">.</span><span class="ident" id="6032338">indent</span><span class="op" id="6032344">)</span>&nbsp;<span class="op" id="6032346">&gt;</span>&nbsp;<span class="num" id="6032348">0</span>&nbsp;<span class="op" id="6032350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032354">for</span>&nbsp;<span class="ident" id="6032358">i</span>&nbsp;<span class="op" id="6032360">:=</span>&nbsp;<span class="num" id="6032363">0</span><span class="op" id="6032364">;</span>&nbsp;<span class="ident" id="6032366">i</span>&nbsp;<span class="op" id="6032368">&lt;</span>&nbsp;<span class="ident" id="6032370">p</span><span class="op" id="6032371">.</span><span class="ident" id="6032372">depth</span><span class="op" id="6032377">;</span>&nbsp;<span class="ident" id="6032379">i</span><span class="op" id="6032380">++</span>&nbsp;<span class="op" id="6032383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032388">p</span><span class="op" id="6032389">.</span><span class="ident" id="6032390">WriteString</span><span class="op" id="6032401">(</span><span class="ident" id="6032402">p</span><span class="op" id="6032403">.</span><span class="ident" id="6032404">indent</span><span class="op" id="6032410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032414">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032420">if</span>&nbsp;<span class="ident" id="6032423">depthDelta</span>&nbsp;<span class="op" id="6032434">&gt;</span>&nbsp;<span class="num" id="6032436">0</span>&nbsp;<span class="op" id="6032438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032442">p</span><span class="op" id="6032443">.</span><span class="ident" id="6032444">depth</span><span class="op" id="6032449">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032454">p</span><span class="op" id="6032455">.</span><span class="ident" id="6032456">indentedIn</span>&nbsp;<span class="op" id="6032467">=</span>&nbsp;<span class="builtintype" id="6032469">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032475">}</span><br>
<span class="lineno">875</span><span class="op" id="6032477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6032480">type</span>&nbsp;<span class="ident" id="6032485">parentStack</span>&nbsp;<span class="keyword" id="6032497">struct</span>&nbsp;<span class="op" id="6032504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032507">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6032513">*</span><span class="ident" id="6032514">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032523">stack</span>&nbsp;<span class="op" id="6032529">[</span><span class="op" id="6032530">]</span><span class="builtintype" id="6032531">string</span><br>
<span class="lineno">880</span><span class="op" id="6032538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6032541">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="6032621">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="6032695">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="6032764">func</span>&nbsp;<span class="op" id="6032769">(</span><span class="ident" id="6032770">s</span>&nbsp;<span class="op" id="6032772">*</span><span class="ident" id="6032773">parentStack</span><span class="op" id="6032784">)</span>&nbsp;<span class="ident" id="6032786">trim</span><span class="op" id="6032790">(</span><span class="ident" id="6032791">parents</span>&nbsp;<span class="op" id="6032799">[</span><span class="op" id="6032800">]</span><span class="builtintype" id="6032801">string</span><span class="op" id="6032807">)</span>&nbsp;<span class="builtintype" id="6032809">error</span>&nbsp;<span class="op" id="6032815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6032818">split</span>&nbsp;<span class="op" id="6032824">:=</span>&nbsp;<span class="num" id="6032827">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032830">for</span>&nbsp;<span class="op" id="6032834">;</span>&nbsp;<span class="ident" id="6032836">split</span>&nbsp;<span class="op" id="6032842">&lt;</span>&nbsp;<span class="builtinfunc" id="6032844">len</span><span class="op" id="6032847">(</span><span class="ident" id="6032848">parents</span><span class="op" id="6032855">)</span>&nbsp;<span class="op" id="6032857">&amp;&amp;</span>&nbsp;<span class="ident" id="6032860">split</span>&nbsp;<span class="op" id="6032866">&lt;</span>&nbsp;<span class="builtinfunc" id="6032868">len</span><span class="op" id="6032871">(</span><span class="ident" id="6032872">s</span><span class="op" id="6032873">.</span><span class="ident" id="6032874">stack</span><span class="op" id="6032879">)</span><span class="op" id="6032880">;</span>&nbsp;<span class="ident" id="6032882">split</span><span class="op" id="6032887">++</span>&nbsp;<span class="op" id="6032890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032894">if</span>&nbsp;<span class="ident" id="6032897">parents</span><span class="op" id="6032904">[</span><span class="ident" id="6032905">split</span><span class="op" id="6032910">]</span>&nbsp;<span class="op" id="6032912">!=</span>&nbsp;<span class="ident" id="6032915">s</span><span class="op" id="6032916">.</span><span class="ident" id="6032917">stack</span><span class="op" id="6032922">[</span><span class="ident" id="6032923">split</span><span class="op" id="6032928">]</span>&nbsp;<span class="op" id="6032930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032935">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6032946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032949">for</span>&nbsp;<span class="ident" id="6032953">i</span>&nbsp;<span class="op" id="6032955">:=</span>&nbsp;<span class="builtinfunc" id="6032958">len</span><span class="op" id="6032961">(</span><span class="ident" id="6032962">s</span><span class="op" id="6032963">.</span><span class="ident" id="6032964">stack</span><span class="op" id="6032969">)</span>&nbsp;<span class="op" id="6032971">-</span>&nbsp;<span class="num" id="6032973">1</span><span class="op" id="6032974">;</span>&nbsp;<span class="ident" id="6032976">i</span>&nbsp;<span class="op" id="6032978">&gt;=</span>&nbsp;<span class="ident" id="6032981">split</span><span class="op" id="6032986">;</span>&nbsp;<span class="ident" id="6032988">i</span><span class="op" id="6032989">--</span>&nbsp;<span class="op" id="6032992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6032996">if</span>&nbsp;<span class="ident" id="6032999">err</span>&nbsp;<span class="op" id="6033003">:=</span>&nbsp;<span class="ident" id="6033006">s</span><span class="op" id="6033007">.</span><span class="ident" id="6033008">p</span><span class="op" id="6033009">.</span><span class="ident" id="6033010">writeEnd</span><span class="op" id="6033018">(</span><span class="ident" id="6033019">Name</span><span class="op" id="6033023">{</span><span class="ident" id="6033024">Local</span><span class="op" id="6033029">:</span>&nbsp;<span class="ident" id="6033031">s</span><span class="op" id="6033032">.</span><span class="ident" id="6033033">stack</span><span class="op" id="6033038">[</span><span class="ident" id="6033039">i</span><span class="op" id="6033040">]</span><span class="op" id="6033041">}</span><span class="op" id="6033042">)</span><span class="op" id="6033043">;</span>&nbsp;<span class="ident" id="6033045">err</span>&nbsp;<span class="op" id="6033049">!=</span>&nbsp;<span class="ident" id="6033052">nil</span>&nbsp;<span class="op" id="6033056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033061">return</span>&nbsp;<span class="ident" id="6033068">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6033074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6033077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6033080">s</span><span class="op" id="6033081">.</span><span class="ident" id="6033082">stack</span>&nbsp;<span class="op" id="6033088">=</span>&nbsp;<span class="ident" id="6033090">parents</span><span class="op" id="6033097">[</span><span class="op" id="6033098">:</span><span class="ident" id="6033099">split</span><span class="op" id="6033104">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033107">return</span>&nbsp;<span class="ident" id="6033114">nil</span><br>
<span class="lineno"></span><span class="op" id="6033118">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="6033121">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="6033185">func</span>&nbsp;<span class="op" id="6033190">(</span><span class="ident" id="6033191">s</span>&nbsp;<span class="op" id="6033193">*</span><span class="ident" id="6033194">parentStack</span><span class="op" id="6033205">)</span>&nbsp;<span class="ident" id="6033207">push</span><span class="op" id="6033211">(</span><span class="ident" id="6033212">parents</span>&nbsp;<span class="op" id="6033220">[</span><span class="op" id="6033221">]</span><span class="builtintype" id="6033222">string</span><span class="op" id="6033228">)</span>&nbsp;<span class="builtintype" id="6033230">error</span>&nbsp;<span class="op" id="6033236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033239">for</span>&nbsp;<span class="ident" id="6033243">i</span>&nbsp;<span class="op" id="6033245">:=</span>&nbsp;<span class="num" id="6033248">0</span><span class="op" id="6033249">;</span>&nbsp;<span class="ident" id="6033251">i</span>&nbsp;<span class="op" id="6033253">&lt;</span>&nbsp;<span class="builtinfunc" id="6033255">len</span><span class="op" id="6033258">(</span><span class="ident" id="6033259">parents</span><span class="op" id="6033266">)</span><span class="op" id="6033267">;</span>&nbsp;<span class="ident" id="6033269">i</span><span class="op" id="6033270">++</span>&nbsp;<span class="op" id="6033273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033277">if</span>&nbsp;<span class="ident" id="6033280">err</span>&nbsp;<span class="op" id="6033284">:=</span>&nbsp;<span class="ident" id="6033287">s</span><span class="op" id="6033288">.</span><span class="ident" id="6033289">p</span><span class="op" id="6033290">.</span><span class="ident" id="6033291">writeStart</span><span class="op" id="6033301">(</span><span class="op" id="6033302">&amp;</span><span class="ident" id="6033303">StartElement</span><span class="op" id="6033315">{</span><span class="ident" id="6033316">Name</span><span class="op" id="6033320">:</span>&nbsp;<span class="ident" id="6033322">Name</span><span class="op" id="6033326">{</span><span class="ident" id="6033327">Local</span><span class="op" id="6033332">:</span>&nbsp;<span class="ident" id="6033334">parents</span><span class="op" id="6033341">[</span><span class="ident" id="6033342">i</span><span class="op" id="6033343">]</span><span class="op" id="6033344">}</span><span class="op" id="6033345">}</span><span class="op" id="6033346">)</span><span class="op" id="6033347">;</span>&nbsp;<span class="ident" id="6033349">err</span>&nbsp;<span class="op" id="6033353">!=</span>&nbsp;<span class="ident" id="6033356">nil</span>&nbsp;<span class="op" id="6033360">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033365">return</span>&nbsp;<span class="ident" id="6033372">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6033378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6033381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6033384">s</span><span class="op" id="6033385">.</span><span class="ident" id="6033386">stack</span>&nbsp;<span class="op" id="6033392">=</span>&nbsp;<span class="builtinfunc" id="6033394">append</span><span class="op" id="6033400">(</span><span class="ident" id="6033401">s</span><span class="op" id="6033402">.</span><span class="ident" id="6033403">stack</span><span class="op" id="6033408">,</span>&nbsp;<span class="ident" id="6033410">parents</span><span class="op" id="6033417">...</span><span class="op" id="6033420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033423">return</span>&nbsp;<span class="ident" id="6033430">nil</span><br>
<span class="lineno">910</span><span class="op" id="6033434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6033437">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6033501">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="6033539">type</span>&nbsp;<span class="ident" id="6033544">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="6033565">struct</span>&nbsp;<span class="op" id="6033572">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6033575">Type</span>&nbsp;<span class="ident" id="6033580">reflect</span><span class="op" id="6033587">.</span><span class="ident" id="6033588">Type</span><br>
<span class="lineno"></span><span class="op" id="6033593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6033596">func</span>&nbsp;<span class="op" id="6033601">(</span><span class="ident" id="6033602">e</span>&nbsp;<span class="op" id="6033604">*</span><span class="ident" id="6033605">UnsupportedTypeError</span><span class="op" id="6033625">)</span>&nbsp;<span class="ident" id="6033627">Error</span><span class="op" id="6033632">(</span><span class="op" id="6033633">)</span>&nbsp;<span class="builtintype" id="6033635">string</span>&nbsp;<span class="op" id="6033642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033645">return</span>&nbsp;<span class="string" id="6033652">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="6033678">+</span>&nbsp;<span class="ident" id="6033680">e</span><span class="op" id="6033681">.</span><span class="ident" id="6033682">Type</span><span class="op" id="6033686">.</span><span class="ident" id="6033687">String</span><span class="op" id="6033693">(</span><span class="op" id="6033694">)</span><br>
<span class="lineno">920</span><span class="op" id="6033696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6033699">func</span>&nbsp;<span class="ident" id="6033704">isEmptyValue</span><span class="op" id="6033716">(</span><span class="ident" id="6033717">v</span>&nbsp;<span class="ident" id="6033719">reflect</span><span class="op" id="6033726">.</span><span class="ident" id="6033727">Value</span><span class="op" id="6033732">)</span>&nbsp;<span class="builtintype" id="6033734">bool</span>&nbsp;<span class="op" id="6033739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033742">switch</span>&nbsp;<span class="ident" id="6033749">v</span><span class="op" id="6033750">.</span><span class="ident" id="6033751">Kind</span><span class="op" id="6033755">(</span><span class="op" id="6033756">)</span>&nbsp;<span class="op" id="6033758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033761">case</span>&nbsp;<span class="ident" id="6033766">reflect</span><span class="op" id="6033773">.</span><span class="ident" id="6033774">Array</span><span class="op" id="6033779">,</span>&nbsp;<span class="ident" id="6033781">reflect</span><span class="op" id="6033788">.</span><span class="ident" id="6033789">Map</span><span class="op" id="6033792">,</span>&nbsp;<span class="ident" id="6033794">reflect</span><span class="op" id="6033801">.</span><span class="ident" id="6033802">Slice</span><span class="op" id="6033807">,</span>&nbsp;<span class="ident" id="6033809">reflect</span><span class="op" id="6033816">.</span><span class="ident" id="6033817">String</span><span class="op" id="6033823">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033827">return</span>&nbsp;<span class="ident" id="6033834">v</span><span class="op" id="6033835">.</span><span class="ident" id="6033836">Len</span><span class="op" id="6033839">(</span><span class="op" id="6033840">)</span>&nbsp;<span class="op" id="6033842">==</span>&nbsp;<span class="num" id="6033845">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033848">case</span>&nbsp;<span class="ident" id="6033853">reflect</span><span class="op" id="6033860">.</span><span class="ident" id="6033861">Bool</span><span class="op" id="6033865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033869">return</span>&nbsp;<span class="op" id="6033876">!</span><span class="ident" id="6033877">v</span><span class="op" id="6033878">.</span><span class="ident" id="6033879">Bool</span><span class="op" id="6033883">(</span><span class="op" id="6033884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033887">case</span>&nbsp;<span class="ident" id="6033892">reflect</span><span class="op" id="6033899">.</span><span class="ident" id="6033900">Int</span><span class="op" id="6033903">,</span>&nbsp;<span class="ident" id="6033905">reflect</span><span class="op" id="6033912">.</span><span class="ident" id="6033913">Int8</span><span class="op" id="6033917">,</span>&nbsp;<span class="ident" id="6033919">reflect</span><span class="op" id="6033926">.</span><span class="ident" id="6033927">Int16</span><span class="op" id="6033932">,</span>&nbsp;<span class="ident" id="6033934">reflect</span><span class="op" id="6033941">.</span><span class="ident" id="6033942">Int32</span><span class="op" id="6033947">,</span>&nbsp;<span class="ident" id="6033949">reflect</span><span class="op" id="6033956">.</span><span class="ident" id="6033957">Int64</span><span class="op" id="6033962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033966">return</span>&nbsp;<span class="ident" id="6033973">v</span><span class="op" id="6033974">.</span><span class="ident" id="6033975">Int</span><span class="op" id="6033978">(</span><span class="op" id="6033979">)</span>&nbsp;<span class="op" id="6033981">==</span>&nbsp;<span class="num" id="6033984">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6033987">case</span>&nbsp;<span class="ident" id="6033992">reflect</span><span class="op" id="6033999">.</span><span class="ident" id="6034000">Uint</span><span class="op" id="6034004">,</span>&nbsp;<span class="ident" id="6034006">reflect</span><span class="op" id="6034013">.</span><span class="ident" id="6034014">Uint8</span><span class="op" id="6034019">,</span>&nbsp;<span class="ident" id="6034021">reflect</span><span class="op" id="6034028">.</span><span class="ident" id="6034029">Uint16</span><span class="op" id="6034035">,</span>&nbsp;<span class="ident" id="6034037">reflect</span><span class="op" id="6034044">.</span><span class="ident" id="6034045">Uint32</span><span class="op" id="6034051">,</span>&nbsp;<span class="ident" id="6034053">reflect</span><span class="op" id="6034060">.</span><span class="ident" id="6034061">Uint64</span><span class="op" id="6034067">,</span>&nbsp;<span class="ident" id="6034069">reflect</span><span class="op" id="6034076">.</span><span class="ident" id="6034077">Uintptr</span><span class="op" id="6034084">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034088">return</span>&nbsp;<span class="ident" id="6034095">v</span><span class="op" id="6034096">.</span><span class="ident" id="6034097">Uint</span><span class="op" id="6034101">(</span><span class="op" id="6034102">)</span>&nbsp;<span class="op" id="6034104">==</span>&nbsp;<span class="num" id="6034107">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034110">case</span>&nbsp;<span class="ident" id="6034115">reflect</span><span class="op" id="6034122">.</span><span class="ident" id="6034123">Float32</span><span class="op" id="6034130">,</span>&nbsp;<span class="ident" id="6034132">reflect</span><span class="op" id="6034139">.</span><span class="ident" id="6034140">Float64</span><span class="op" id="6034147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034151">return</span>&nbsp;<span class="ident" id="6034158">v</span><span class="op" id="6034159">.</span><span class="ident" id="6034160">Float</span><span class="op" id="6034165">(</span><span class="op" id="6034166">)</span>&nbsp;<span class="op" id="6034168">==</span>&nbsp;<span class="num" id="6034171">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034174">case</span>&nbsp;<span class="ident" id="6034179">reflect</span><span class="op" id="6034186">.</span><span class="ident" id="6034187">Interface</span><span class="op" id="6034196">,</span>&nbsp;<span class="ident" id="6034198">reflect</span><span class="op" id="6034205">.</span><span class="ident" id="6034206">Ptr</span><span class="op" id="6034209">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034213">return</span>&nbsp;<span class="ident" id="6034220">v</span><span class="op" id="6034221">.</span><span class="ident" id="6034222">IsNil</span><span class="op" id="6034227">(</span><span class="op" id="6034228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6034231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6034234">return</span>&nbsp;<span class="builtintype" id="6034241">false</span><br>
<span class="lineno"></span><span class="op" id="6034247">}</span>
</div>
</body>
</html>
