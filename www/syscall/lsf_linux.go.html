<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2110424">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2110480">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2110534">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2110585">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2110609">package</span>&nbsp;<span class="ident" id="2110617">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2110626">import</span>&nbsp;<span class="op" id="2110633">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2110636">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2110645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2110648">func</span>&nbsp;<span class="ident" id="2110653">LsfStmt</span><span class="op" id="2110660">(</span><span class="ident" id="2110661">code</span><span class="op" id="2110665">,</span>&nbsp;<span class="ident" id="2110667">k</span>&nbsp;<span class="builtintype" id="2110669">int</span><span class="op" id="2110672">)</span>&nbsp;<span class="op" id="2110674">*</span><span class="ident" id="2110675"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span>&nbsp;<span class="op" id="2110686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110689">return</span>&nbsp;<span class="op" id="2110696">&amp;</span><span class="ident" id="2110697"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span><span class="op" id="2110707">{</span><span class="ident" id="2110708">Code</span><span class="op" id="2110712">:</span>&nbsp;<span class="builtintype" id="2110714">uint16</span><span class="op" id="2110720">(</span><span class="ident" id="2110721"><a href="/syscall/lsf_linux.go.html#2110661">code</a></span><span class="op" id="2110725">)</span><span class="op" id="2110726">,</span>&nbsp;<span class="ident" id="2110728">K</span><span class="op" id="2110729">:</span>&nbsp;<span class="builtintype" id="2110731">uint32</span><span class="op" id="2110737">(</span><span class="ident" id="2110738"><a href="/syscall/lsf_linux.go.html#2110667">k</a></span><span class="op" id="2110739">)</span><span class="op" id="2110740">}</span><br>
<span class="lineno">15</span><span class="op" id="2110742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2110745">func</span>&nbsp;<span class="ident" id="2110750">LsfJump</span><span class="op" id="2110757">(</span><span class="ident" id="2110758">code</span><span class="op" id="2110762">,</span>&nbsp;<span class="ident" id="2110764">k</span><span class="op" id="2110765">,</span>&nbsp;<span class="ident" id="2110767">jt</span><span class="op" id="2110769">,</span>&nbsp;<span class="ident" id="2110771">jf</span>&nbsp;<span class="builtintype" id="2110774">int</span><span class="op" id="2110777">)</span>&nbsp;<span class="op" id="2110779">*</span><span class="ident" id="2110780"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span>&nbsp;<span class="op" id="2110791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110794">return</span>&nbsp;<span class="op" id="2110801">&amp;</span><span class="ident" id="2110802"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span><span class="op" id="2110812">{</span><span class="ident" id="2110813">Code</span><span class="op" id="2110817">:</span>&nbsp;<span class="builtintype" id="2110819">uint16</span><span class="op" id="2110825">(</span><span class="ident" id="2110826"><a href="/syscall/lsf_linux.go.html#2110758">code</a></span><span class="op" id="2110830">)</span><span class="op" id="2110831">,</span>&nbsp;<span class="ident" id="2110833">Jt</span><span class="op" id="2110835">:</span>&nbsp;<span class="builtintype" id="2110837">uint8</span><span class="op" id="2110842">(</span><span class="ident" id="2110843"><a href="/syscall/lsf_linux.go.html#2110767">jt</a></span><span class="op" id="2110845">)</span><span class="op" id="2110846">,</span>&nbsp;<span class="ident" id="2110848">Jf</span><span class="op" id="2110850">:</span>&nbsp;<span class="builtintype" id="2110852">uint8</span><span class="op" id="2110857">(</span><span class="ident" id="2110858"><a href="/syscall/lsf_linux.go.html#2110771">jf</a></span><span class="op" id="2110860">)</span><span class="op" id="2110861">,</span>&nbsp;<span class="ident" id="2110863">K</span><span class="op" id="2110864">:</span>&nbsp;<span class="builtintype" id="2110866">uint32</span><span class="op" id="2110872">(</span><span class="ident" id="2110873"><a href="/syscall/lsf_linux.go.html#2110764">k</a></span><span class="op" id="2110874">)</span><span class="op" id="2110875">}</span><br>
<span class="lineno"></span><span class="op" id="2110877">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2110880">func</span>&nbsp;<span class="ident" id="2110885">LsfSocket</span><span class="op" id="2110894">(</span><span class="ident" id="2110895">ifindex</span><span class="op" id="2110902">,</span>&nbsp;<span class="ident" id="2110904">proto</span>&nbsp;<span class="builtintype" id="2110910">int</span><span class="op" id="2110913">)</span>&nbsp;<span class="op" id="2110915">(</span><span class="builtintype" id="2110916">int</span><span class="op" id="2110919">,</span>&nbsp;<span class="builtintype" id="2110921">error</span><span class="op" id="2110926">)</span>&nbsp;<span class="op" id="2110928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110931">var</span>&nbsp;<span class="ident" id="2110935">lsall</span>&nbsp;<span class="ident" id="2110941"><a href="/syscall/syscall_linux.go.html#2132065">SockaddrLinklayer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110960">s</span><span class="op" id="2110961">,</span>&nbsp;<span class="ident" id="2110963">e</span>&nbsp;<span class="op" id="2110965">:=</span>&nbsp;<span class="ident" id="2110968"><a href="/syscall/syscall_unix.go.html#2163230">Socket</a></span><span class="op" id="2110974">(</span><span class="ident" id="2110975"><a href="/syscall/zerrors_linux_amd64.go.html#2165098">AF_PACKET</a></span><span class="op" id="2110984">,</span>&nbsp;<span class="ident" id="2110986"><a href="/syscall/zerrors_linux_amd64.go.html#2205238">SOCK_RAW</a></span><span class="op" id="2110994">,</span>&nbsp;<span class="ident" id="2110996"><a href="/syscall/lsf_linux.go.html#2110904">proto</a></span><span class="op" id="2111001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111004">if</span>&nbsp;<span class="ident" id="2111007"><a href="/syscall/lsf_linux.go.html#2110963">e</a></span>&nbsp;<span class="op" id="2111009">!=</span>&nbsp;<span class="ident" id="2111012">nil</span>&nbsp;<span class="op" id="2111016">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111020">return</span>&nbsp;<span class="num" id="2111027">0</span><span class="op" id="2111028">,</span>&nbsp;<span class="ident" id="2111030"><a href="/syscall/lsf_linux.go.html#2110963">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111036">p</span>&nbsp;<span class="op" id="2111038">:=</span>&nbsp;<span class="op" id="2111041">(</span><span class="op" id="2111042">*</span><span class="op" id="2111043">[</span><span class="num" id="2111044">2</span><span class="op" id="2111045">]</span><span class="builtintype" id="2111046">byte</span><span class="op" id="2111050">)</span><span class="op" id="2111051">(</span><span class="ident" id="2111052"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2111058">.</span><span class="ident" id="2111059">Pointer</span><span class="op" id="2111066">(</span><span class="op" id="2111067">&amp;</span><span class="ident" id="2111068"><a href="/syscall/lsf_linux.go.html#2110935">lsall</a></span><span class="op" id="2111073">.</span><span class="ident" id="2111074">Protocol</span><span class="op" id="2111082">)</span><span class="op" id="2111083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111086"><a href="/syscall/lsf_linux.go.html#2111036">p</a></span><span class="op" id="2111087">[</span><span class="num" id="2111088">0</span><span class="op" id="2111089">]</span>&nbsp;<span class="op" id="2111091">=</span>&nbsp;<span class="builtintype" id="2111093">byte</span><span class="op" id="2111097">(</span><span class="ident" id="2111098"><a href="/syscall/lsf_linux.go.html#2110904">proto</a></span>&nbsp;<span class="op" id="2111104">&gt;&gt;</span>&nbsp;<span class="num" id="2111107">8</span><span class="op" id="2111108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111111"><a href="/syscall/lsf_linux.go.html#2111036">p</a></span><span class="op" id="2111112">[</span><span class="num" id="2111113">1</span><span class="op" id="2111114">]</span>&nbsp;<span class="op" id="2111116">=</span>&nbsp;<span class="builtintype" id="2111118">byte</span><span class="op" id="2111122">(</span><span class="ident" id="2111123"><a href="/syscall/lsf_linux.go.html#2110904">proto</a></span><span class="op" id="2111128">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111131"><a href="/syscall/lsf_linux.go.html#2110935">lsall</a></span><span class="op" id="2111136">.</span><span class="ident" id="2111137">Ifindex</span>&nbsp;<span class="op" id="2111145">=</span>&nbsp;<span class="ident" id="2111147"><a href="/syscall/lsf_linux.go.html#2110895">ifindex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111156"><a href="/syscall/lsf_linux.go.html#2110963">e</a></span>&nbsp;<span class="op" id="2111158">=</span>&nbsp;<span class="ident" id="2111160"><a href="/syscall/syscall_unix.go.html#2160776">Bind</a></span><span class="op" id="2111164">(</span><span class="ident" id="2111165"><a href="/syscall/lsf_linux.go.html#2110960">s</a></span><span class="op" id="2111166">,</span>&nbsp;<span class="op" id="2111168">&amp;</span><span class="ident" id="2111169"><a href="/syscall/lsf_linux.go.html#2110935">lsall</a></span><span class="op" id="2111174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111177">if</span>&nbsp;<span class="ident" id="2111180"><a href="/syscall/lsf_linux.go.html#2110963">e</a></span>&nbsp;<span class="op" id="2111182">!=</span>&nbsp;<span class="ident" id="2111185">nil</span>&nbsp;<span class="op" id="2111189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111193"><a href="/syscall/zsyscall_linux_amd64.go.html#2230053">Close</a></span><span class="op" id="2111198">(</span><span class="ident" id="2111199"><a href="/syscall/lsf_linux.go.html#2110960">s</a></span><span class="op" id="2111200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111204">return</span>&nbsp;<span class="num" id="2111211">0</span><span class="op" id="2111212">,</span>&nbsp;<span class="ident" id="2111214"><a href="/syscall/lsf_linux.go.html#2110963">e</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111220">return</span>&nbsp;<span class="ident" id="2111227"><a href="/syscall/lsf_linux.go.html#2110960">s</a></span><span class="op" id="2111228">,</span>&nbsp;<span class="ident" id="2111230">nil</span><br>
<span class="lineno"></span><span class="op" id="2111234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2111237">type</span>&nbsp;<span class="ident" id="2111242">iflags</span>&nbsp;<span class="keyword" id="2111249">struct</span>&nbsp;<span class="op" id="2111256">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111259">name</span>&nbsp;&nbsp;<span class="op" id="2111265">[</span><span class="ident" id="2111266"><a href="/syscall/zerrors_linux_amd64.go.html#2177257">IFNAMSIZ</a></span><span class="op" id="2111274">]</span><span class="builtintype" id="2111275">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111281">flags</span>&nbsp;<span class="builtintype" id="2111287">uint16</span><br>
<span class="lineno"></span><span class="op" id="2111294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2111297">func</span>&nbsp;<span class="ident" id="2111302">SetLsfPromisc</span><span class="op" id="2111315">(</span><span class="ident" id="2111316">name</span>&nbsp;<span class="builtintype" id="2111321">string</span><span class="op" id="2111327">,</span>&nbsp;<span class="ident" id="2111329">m</span>&nbsp;<span class="builtintype" id="2111331">bool</span><span class="op" id="2111335">)</span>&nbsp;<span class="builtintype" id="2111337">error</span>&nbsp;<span class="op" id="2111343">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111346">s</span><span class="op" id="2111347">,</span>&nbsp;<span class="ident" id="2111349">e</span>&nbsp;<span class="op" id="2111351">:=</span>&nbsp;<span class="ident" id="2111354"><a href="/syscall/syscall_unix.go.html#2163230">Socket</a></span><span class="op" id="2111360">(</span><span class="ident" id="2111361"><a href="/syscall/zerrors_linux_amd64.go.html#2164572">AF_INET</a></span><span class="op" id="2111368">,</span>&nbsp;<span class="ident" id="2111370"><a href="/syscall/zerrors_linux_amd64.go.html#2205116">SOCK_DGRAM</a></span><span class="op" id="2111380">,</span>&nbsp;<span class="num" id="2111382">0</span><span class="op" id="2111383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111386">if</span>&nbsp;<span class="ident" id="2111389"><a href="/syscall/lsf_linux.go.html#2111349">e</a></span>&nbsp;<span class="op" id="2111391">!=</span>&nbsp;<span class="ident" id="2111394">nil</span>&nbsp;<span class="op" id="2111398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111402">return</span>&nbsp;<span class="ident" id="2111409"><a href="/syscall/lsf_linux.go.html#2111349">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111415">defer</span>&nbsp;<span class="ident" id="2111421"><a href="/syscall/zsyscall_linux_amd64.go.html#2230053">Close</a></span><span class="op" id="2111426">(</span><span class="ident" id="2111427"><a href="/syscall/lsf_linux.go.html#2111346">s</a></span><span class="op" id="2111428">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111431">var</span>&nbsp;<span class="ident" id="2111435">ifl</span>&nbsp;<span class="ident" id="2111439"><a href="/syscall/lsf_linux.go.html#2111242">iflags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2111447">copy</span><span class="op" id="2111451">(</span><span class="ident" id="2111452"><a href="/syscall/lsf_linux.go.html#2111435">ifl</a></span><span class="op" id="2111455">.</span><span class="ident" id="2111456">name</span><span class="op" id="2111460">[</span><span class="op" id="2111461">:</span><span class="op" id="2111462">]</span><span class="op" id="2111463">,</span>&nbsp;<span class="op" id="2111465">[</span><span class="op" id="2111466">]</span><span class="builtintype" id="2111467">byte</span><span class="op" id="2111471">(</span><span class="ident" id="2111472"><a href="/syscall/lsf_linux.go.html#2111316">name</a></span><span class="op" id="2111476">)</span><span class="op" id="2111477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111480">_</span><span class="op" id="2111481">,</span>&nbsp;<span class="ident" id="2111483">_</span><span class="op" id="2111484">,</span>&nbsp;<span class="ident" id="2111486">ep</span>&nbsp;<span class="op" id="2111489">:=</span>&nbsp;<span class="ident" id="2111492"><a href="/syscall/syscall_unix.go.html#2157190">Syscall</a></span><span class="op" id="2111499">(</span><span class="ident" id="2111500"><a href="/syscall/zsysnum_linux_amd64.go.html#2269830">SYS_IOCTL</a></span><span class="op" id="2111509">,</span>&nbsp;<span class="builtintype" id="2111511">uintptr</span><span class="op" id="2111518">(</span><span class="ident" id="2111519"><a href="/syscall/lsf_linux.go.html#2111346">s</a></span><span class="op" id="2111520">)</span><span class="op" id="2111521">,</span>&nbsp;<span class="ident" id="2111523"><a href="/syscall/zerrors_linux_amd64.go.html#2203355">SIOCGIFFLAGS</a></span><span class="op" id="2111535">,</span>&nbsp;<span class="builtintype" id="2111537">uintptr</span><span class="op" id="2111544">(</span><span class="ident" id="2111545"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2111551">.</span><span class="ident" id="2111552">Pointer</span><span class="op" id="2111559">(</span><span class="op" id="2111560">&amp;</span><span class="ident" id="2111561"><a href="/syscall/lsf_linux.go.html#2111435">ifl</a></span><span class="op" id="2111564">)</span><span class="op" id="2111565">)</span><span class="op" id="2111566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111569">if</span>&nbsp;<span class="ident" id="2111572"><a href="/syscall/lsf_linux.go.html#2111486">ep</a></span>&nbsp;<span class="op" id="2111575">!=</span>&nbsp;<span class="num" id="2111578">0</span>&nbsp;<span class="op" id="2111580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111584">return</span>&nbsp;<span class="ident" id="2111591"><a href="/syscall/syscall_unix.go.html#2159119">Errno</a></span><span class="op" id="2111596">(</span><span class="ident" id="2111597"><a href="/syscall/lsf_linux.go.html#2111486">ep</a></span><span class="op" id="2111599">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111605">if</span>&nbsp;<span class="ident" id="2111608"><a href="/syscall/lsf_linux.go.html#2111329">m</a></span>&nbsp;<span class="op" id="2111610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111614"><a href="/syscall/lsf_linux.go.html#2111435">ifl</a></span><span class="op" id="2111617">.</span><span class="ident" id="2111618">flags</span>&nbsp;<span class="op" id="2111624">|=</span>&nbsp;<span class="builtintype" id="2111627">uint16</span><span class="op" id="2111633">(</span><span class="ident" id="2111634"><a href="/syscall/zerrors_linux_amd64.go.html#2176926">IFF_PROMISC</a></span><span class="op" id="2111645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111648">}</span>&nbsp;<span class="keyword" id="2111650">else</span>&nbsp;<span class="op" id="2111655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111659"><a href="/syscall/lsf_linux.go.html#2111435">ifl</a></span><span class="op" id="2111662">.</span><span class="ident" id="2111663">flags</span>&nbsp;<span class="op" id="2111669">&amp;=</span>&nbsp;<span class="op" id="2111672">^</span><span class="builtintype" id="2111673">uint16</span><span class="op" id="2111679">(</span><span class="ident" id="2111680"><a href="/syscall/zerrors_linux_amd64.go.html#2176926">IFF_PROMISC</a></span><span class="op" id="2111691">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111697">_</span><span class="op" id="2111698">,</span>&nbsp;<span class="ident" id="2111700">_</span><span class="op" id="2111701">,</span>&nbsp;<span class="ident" id="2111703"><a href="/syscall/lsf_linux.go.html#2111486">ep</a></span>&nbsp;<span class="op" id="2111706">=</span>&nbsp;<span class="ident" id="2111708"><a href="/syscall/syscall_unix.go.html#2157190">Syscall</a></span><span class="op" id="2111715">(</span><span class="ident" id="2111716"><a href="/syscall/zsysnum_linux_amd64.go.html#2269830">SYS_IOCTL</a></span><span class="op" id="2111725">,</span>&nbsp;<span class="builtintype" id="2111727">uintptr</span><span class="op" id="2111734">(</span><span class="ident" id="2111735"><a href="/syscall/lsf_linux.go.html#2111346">s</a></span><span class="op" id="2111736">)</span><span class="op" id="2111737">,</span>&nbsp;<span class="ident" id="2111739"><a href="/syscall/zerrors_linux_amd64.go.html#2204387">SIOCSIFFLAGS</a></span><span class="op" id="2111751">,</span>&nbsp;<span class="builtintype" id="2111753">uintptr</span><span class="op" id="2111760">(</span><span class="ident" id="2111761"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2111767">.</span><span class="ident" id="2111768">Pointer</span><span class="op" id="2111775">(</span><span class="op" id="2111776">&amp;</span><span class="ident" id="2111777"><a href="/syscall/lsf_linux.go.html#2111435">ifl</a></span><span class="op" id="2111780">)</span><span class="op" id="2111781">)</span><span class="op" id="2111782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111785">if</span>&nbsp;<span class="ident" id="2111788"><a href="/syscall/lsf_linux.go.html#2111486">ep</a></span>&nbsp;<span class="op" id="2111791">!=</span>&nbsp;<span class="num" id="2111794">0</span>&nbsp;<span class="op" id="2111796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111800">return</span>&nbsp;<span class="ident" id="2111807"><a href="/syscall/syscall_unix.go.html#2159119">Errno</a></span><span class="op" id="2111812">(</span><span class="ident" id="2111813"><a href="/syscall/lsf_linux.go.html#2111486">ep</a></span><span class="op" id="2111815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111818">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111821">return</span>&nbsp;<span class="ident" id="2111828">nil</span><br>
<span class="lineno"></span><span class="op" id="2111832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2111835">func</span>&nbsp;<span class="ident" id="2111840">AttachLsf</span><span class="op" id="2111849">(</span><span class="ident" id="2111850">fd</span>&nbsp;<span class="builtintype" id="2111853">int</span><span class="op" id="2111856">,</span>&nbsp;<span class="ident" id="2111858">i</span>&nbsp;<span class="op" id="2111860">[</span><span class="op" id="2111861">]</span><span class="ident" id="2111862"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span><span class="op" id="2111872">)</span>&nbsp;<span class="builtintype" id="2111874">error</span>&nbsp;<span class="op" id="2111880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111883">var</span>&nbsp;<span class="ident" id="2111887">p</span>&nbsp;<span class="ident" id="2111889"><a href="/syscall/ztypes_linux_amd64.go.html#2288208">SockFprog</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111900"><a href="/syscall/lsf_linux.go.html#2111887">p</a></span><span class="op" id="2111901">.</span><span class="ident" id="2111902">Len</span>&nbsp;<span class="op" id="2111906">=</span>&nbsp;<span class="builtintype" id="2111908">uint16</span><span class="op" id="2111914">(</span><span class="builtinfunc" id="2111915">len</span><span class="op" id="2111918">(</span><span class="ident" id="2111919"><a href="/syscall/lsf_linux.go.html#2111858">i</a></span><span class="op" id="2111920">)</span><span class="op" id="2111921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111924"><a href="/syscall/lsf_linux.go.html#2111887">p</a></span><span class="op" id="2111925">.</span><span class="ident" id="2111926">Filter</span>&nbsp;<span class="op" id="2111933">=</span>&nbsp;<span class="op" id="2111935">(</span><span class="op" id="2111936">*</span><span class="ident" id="2111937"><a href="/syscall/ztypes_linux_amd64.go.html#2288130">SockFilter</a></span><span class="op" id="2111947">)</span><span class="op" id="2111948">(</span><span class="ident" id="2111949"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2111955">.</span><span class="ident" id="2111956">Pointer</span><span class="op" id="2111963">(</span><span class="op" id="2111964">&amp;</span><span class="ident" id="2111965"><a href="/syscall/lsf_linux.go.html#2111858">i</a></span><span class="op" id="2111966">[</span><span class="num" id="2111967">0</span><span class="op" id="2111968">]</span><span class="op" id="2111969">)</span><span class="op" id="2111970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111973">return</span>&nbsp;<span class="ident" id="2111980"><a href="/syscall/zsyscall_linux_amd64.go.html#2265901">setsockopt</a></span><span class="op" id="2111990">(</span><span class="ident" id="2111991"><a href="/syscall/lsf_linux.go.html#2111850">fd</a></span><span class="op" id="2111993">,</span>&nbsp;<span class="ident" id="2111995"><a href="/syscall/zerrors_linux_amd64.go.html#2205771">SOL_SOCKET</a></span><span class="op" id="2112005">,</span>&nbsp;<span class="ident" id="2112007"><a href="/syscall/zerrors_linux_amd64.go.html#2205975">SO_ATTACH_FILTER</a></span><span class="op" id="2112023">,</span>&nbsp;<span class="ident" id="2112025"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2112031">.</span><span class="ident" id="2112032">Pointer</span><span class="op" id="2112039">(</span><span class="op" id="2112040">&amp;</span><span class="ident" id="2112041"><a href="/syscall/lsf_linux.go.html#2111887">p</a></span><span class="op" id="2112042">)</span><span class="op" id="2112043">,</span>&nbsp;<span class="ident" id="2112045"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2112051">.</span><span class="ident" id="2112052">Sizeof</span><span class="op" id="2112058">(</span><span class="ident" id="2112059"><a href="/syscall/lsf_linux.go.html#2111887">p</a></span><span class="op" id="2112060">)</span><span class="op" id="2112061">)</span><br>
<span class="lineno"></span><span class="op" id="2112063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2112066">func</span>&nbsp;<span class="ident" id="2112071">DetachLsf</span><span class="op" id="2112080">(</span><span class="ident" id="2112081">fd</span>&nbsp;<span class="builtintype" id="2112084">int</span><span class="op" id="2112087">)</span>&nbsp;<span class="builtintype" id="2112089">error</span>&nbsp;<span class="op" id="2112095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112098">var</span>&nbsp;<span class="ident" id="2112102">dummy</span>&nbsp;<span class="builtintype" id="2112108">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112113">return</span>&nbsp;<span class="ident" id="2112120"><a href="/syscall/zsyscall_linux_amd64.go.html#2265901">setsockopt</a></span><span class="op" id="2112130">(</span><span class="ident" id="2112131"><a href="/syscall/lsf_linux.go.html#2112081">fd</a></span><span class="op" id="2112133">,</span>&nbsp;<span class="ident" id="2112135"><a href="/syscall/zerrors_linux_amd64.go.html#2205771">SOL_SOCKET</a></span><span class="op" id="2112145">,</span>&nbsp;<span class="ident" id="2112147"><a href="/syscall/zerrors_linux_amd64.go.html#2206177">SO_DETACH_FILTER</a></span><span class="op" id="2112163">,</span>&nbsp;<span class="ident" id="2112165"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2112171">.</span><span class="ident" id="2112172">Pointer</span><span class="op" id="2112179">(</span><span class="op" id="2112180">&amp;</span><span class="ident" id="2112181"><a href="/syscall/lsf_linux.go.html#2112102">dummy</a></span><span class="op" id="2112186">)</span><span class="op" id="2112187">,</span>&nbsp;<span class="ident" id="2112189"><a href="/syscall/lsf_linux.go.html#2110636">unsafe</a></span><span class="op" id="2112195">.</span><span class="ident" id="2112196">Sizeof</span><span class="op" id="2112202">(</span><span class="ident" id="2112203"><a href="/syscall/lsf_linux.go.html#2112102">dummy</a></span><span class="op" id="2112208">)</span><span class="op" id="2112209">)</span><br>
<span class="lineno"></span><span class="op" id="2112211">}</span>
</div>
</body>
</html>
