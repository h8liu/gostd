<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1881415">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1881470">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1881524">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1881575">package</span>&nbsp;<span class="ident" id="1881583">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881592">import</span>&nbsp;<span class="string" id="1881599">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881609">var</span>&nbsp;<span class="ident" id="1881613">indexError</span>&nbsp;<span class="op" id="1881624">=</span>&nbsp;<span class="builtintype" id="1881626">error</span><span class="op" id="1881631">(</span><span class="ident" id="1881632"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1881643">(</span><span class="string" id="1881644">&#34;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="1881664">)</span><span class="op" id="1881665">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1881668">func</span>&nbsp;<span class="ident" id="1881673">panicindex</span><span class="op" id="1881683">(</span><span class="op" id="1881684">)</span>&nbsp;<span class="op" id="1881686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1881689">panic</span><span class="op" id="1881694">(</span><span class="ident" id="1881695"><a href="/runtime/panic.go.html#1881613">indexError</a></span><span class="op" id="1881705">)</span><br>
<span class="lineno"></span><span class="op" id="1881707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1881710">var</span>&nbsp;<span class="ident" id="1881714">sliceError</span>&nbsp;<span class="op" id="1881725">=</span>&nbsp;<span class="builtintype" id="1881727">error</span><span class="op" id="1881732">(</span><span class="ident" id="1881733"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1881744">(</span><span class="string" id="1881745">&#34;slice&nbsp;bounds&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="1881772">)</span><span class="op" id="1881773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881776">func</span>&nbsp;<span class="ident" id="1881781">panicslice</span><span class="op" id="1881791">(</span><span class="op" id="1881792">)</span>&nbsp;<span class="op" id="1881794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1881797">panic</span><span class="op" id="1881802">(</span><span class="ident" id="1881803"><a href="/runtime/panic.go.html#1881714">sliceError</a></span><span class="op" id="1881813">)</span><br>
<span class="lineno"></span><span class="op" id="1881815">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="1881818">var</span>&nbsp;<span class="ident" id="1881822">divideError</span>&nbsp;<span class="op" id="1881834">=</span>&nbsp;<span class="builtintype" id="1881836">error</span><span class="op" id="1881841">(</span><span class="ident" id="1881842"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1881853">(</span><span class="string" id="1881854">&#34;integer&nbsp;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="1881878">)</span><span class="op" id="1881879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881882">func</span>&nbsp;<span class="ident" id="1881887">panicdivide</span><span class="op" id="1881898">(</span><span class="op" id="1881899">)</span>&nbsp;<span class="op" id="1881901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1881904">panic</span><span class="op" id="1881909">(</span><span class="ident" id="1881910"><a href="/runtime/panic.go.html#1881822">divideError</a></span><span class="op" id="1881921">)</span><br>
<span class="lineno">25</span><span class="op" id="1881923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881926">var</span>&nbsp;<span class="ident" id="1881930">overflowError</span>&nbsp;<span class="op" id="1881944">=</span>&nbsp;<span class="builtintype" id="1881946">error</span><span class="op" id="1881951">(</span><span class="ident" id="1881952"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1881963">(</span><span class="string" id="1881964">&#34;integer&nbsp;overflow&#34;</span><span class="op" id="1881982">)</span><span class="op" id="1881983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1881986">func</span>&nbsp;<span class="ident" id="1881991">panicoverflow</span><span class="op" id="1882004">(</span><span class="op" id="1882005">)</span>&nbsp;<span class="op" id="1882007">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1882010">panic</span><span class="op" id="1882015">(</span><span class="ident" id="1882016"><a href="/runtime/panic.go.html#1881930">overflowError</a></span><span class="op" id="1882029">)</span><br>
<span class="lineno"></span><span class="op" id="1882031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1882034">var</span>&nbsp;<span class="ident" id="1882038">floatError</span>&nbsp;<span class="op" id="1882049">=</span>&nbsp;<span class="builtintype" id="1882051">error</span><span class="op" id="1882056">(</span><span class="ident" id="1882057"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1882068">(</span><span class="string" id="1882069">&#34;floating&nbsp;point&nbsp;error&#34;</span><span class="op" id="1882091">)</span><span class="op" id="1882092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="1882095">func</span>&nbsp;<span class="ident" id="1882100">panicfloat</span><span class="op" id="1882110">(</span><span class="op" id="1882111">)</span>&nbsp;<span class="op" id="1882113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1882116">panic</span><span class="op" id="1882121">(</span><span class="ident" id="1882122"><a href="/runtime/panic.go.html#1882038">floatError</a></span><span class="op" id="1882132">)</span><br>
<span class="lineno"></span><span class="op" id="1882134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1882137">var</span>&nbsp;<span class="ident" id="1882141">memoryError</span>&nbsp;<span class="op" id="1882153">=</span>&nbsp;<span class="builtintype" id="1882155">error</span><span class="op" id="1882160">(</span><span class="ident" id="1882161"><a href="/runtime/error.go.html#1755462">errorString</a></span><span class="op" id="1882172">(</span><span class="string" id="1882173">&#34;invalid&nbsp;memory&nbsp;address&nbsp;or&nbsp;nil&nbsp;pointer&nbsp;dereference&#34;</span><span class="op" id="1882224">)</span><span class="op" id="1882225">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="1882228">func</span>&nbsp;<span class="ident" id="1882233">panicmem</span><span class="op" id="1882241">(</span><span class="op" id="1882242">)</span>&nbsp;<span class="op" id="1882244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1882247">panic</span><span class="op" id="1882252">(</span><span class="ident" id="1882253"><a href="/runtime/panic.go.html#1882141">memoryError</a></span><span class="op" id="1882264">)</span><br>
<span class="lineno"></span><span class="op" id="1882266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="1882269">func</span>&nbsp;<span class="ident" id="1882274">throwreturn</span><span class="op" id="1882285">(</span><span class="op" id="1882286">)</span>&nbsp;<span class="op" id="1882288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1882291"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1882298">(</span><span class="string" id="1882299">&#34;no&nbsp;return&nbsp;at&nbsp;end&nbsp;of&nbsp;a&nbsp;typed&nbsp;function&nbsp;-&nbsp;compiler&nbsp;is&nbsp;broken&#34;</span><span class="op" id="1882358">)</span><br>
<span class="lineno"></span><span class="op" id="1882360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1882363">func</span>&nbsp;<span class="ident" id="1882368">throwinit</span><span class="op" id="1882377">(</span><span class="op" id="1882378">)</span>&nbsp;<span class="op" id="1882380">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1882383"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1882390">(</span><span class="string" id="1882391">&#34;recursive&nbsp;call&nbsp;during&nbsp;initialization&nbsp;-&nbsp;linker&nbsp;skew&#34;</span><span class="op" id="1882443">)</span><br>
<span class="lineno"></span><span class="op" id="1882445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1882448">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;deferred&nbsp;function&nbsp;fn&nbsp;with&nbsp;siz&nbsp;bytes&nbsp;of&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="1882514">//&nbsp;The&nbsp;compiler&nbsp;turns&nbsp;a&nbsp;defer&nbsp;statement&nbsp;into&nbsp;a&nbsp;call&nbsp;to&nbsp;this.</span><br>
<span class="lineno">55</span><span class="comment" id="1882575">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1882588">func</span>&nbsp;<span class="ident" id="1882593">deferproc</span><span class="op" id="1882602">(</span><span class="ident" id="1882603">siz</span>&nbsp;<span class="builtintype" id="1882607">int32</span><span class="op" id="1882612">,</span>&nbsp;<span class="ident" id="1882614">fn</span>&nbsp;<span class="op" id="1882617">*</span><span class="ident" id="1882618"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2016291">funcval</a></span><span class="op" id="1882625">)</span>&nbsp;<span class="op" id="1882627">{</span>&nbsp;<span class="comment" id="1882629">//&nbsp;arguments&nbsp;of&nbsp;fn&nbsp;follow&nbsp;fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1882659">//&nbsp;the&nbsp;arguments&nbsp;of&nbsp;fn&nbsp;are&nbsp;in&nbsp;a&nbsp;perilous&nbsp;state.&nbsp;&nbsp;The&nbsp;stack&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1882723">//&nbsp;for&nbsp;deferproc&nbsp;does&nbsp;not&nbsp;describe&nbsp;them.&nbsp;&nbsp;So&nbsp;we&nbsp;can&#39;t&nbsp;let&nbsp;garbage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1882790">//&nbsp;collection&nbsp;or&nbsp;stack&nbsp;copying&nbsp;trigger&nbsp;until&nbsp;we&#39;ve&nbsp;copied&nbsp;them&nbsp;out</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1882858">//&nbsp;to&nbsp;somewhere&nbsp;safe.&nbsp;&nbsp;deferproc_m&nbsp;does&nbsp;that.&nbsp;&nbsp;Until&nbsp;deferproc_m,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1882925">//&nbsp;we&nbsp;can&nbsp;only&nbsp;call&nbsp;nosplit&nbsp;routines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1882964">argp</span>&nbsp;<span class="op" id="1882969">:=</span>&nbsp;<span class="builtintype" id="1882972">uintptr</span><span class="op" id="1882979">(</span><span class="ident" id="1882980"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1882986">.</span><span class="ident" id="1882987">Pointer</span><span class="op" id="1882994">(</span><span class="op" id="1882995">&amp;</span><span class="ident" id="1882996"><a href="/runtime/panic.go.html#1882614">fn</a></span><span class="op" id="1882998">)</span><span class="op" id="1882999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883002"><a href="/runtime/panic.go.html#1882964">argp</a></span>&nbsp;<span class="op" id="1883007">+=</span>&nbsp;<span class="ident" id="1883010"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1883016">.</span><span class="ident" id="1883017">Sizeof</span><span class="op" id="1883023">(</span><span class="ident" id="1883024"><a href="/runtime/panic.go.html#1882614">fn</a></span><span class="op" id="1883026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1883029">if</span>&nbsp;<span class="ident" id="1883032"><a href="/runtime/extern.go.html#1763748">GOARCH</a></span>&nbsp;<span class="op" id="1883039">==</span>&nbsp;<span class="string" id="1883042">&#34;arm&#34;</span>&nbsp;<span class="op" id="1883048">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883052"><a href="/runtime/panic.go.html#1882964">argp</a></span>&nbsp;<span class="op" id="1883057">+=</span>&nbsp;<span class="ident" id="1883060"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span>&nbsp;<span class="comment" id="1883068">//&nbsp;skip&nbsp;caller&#39;s&nbsp;saved&nbsp;link&nbsp;register</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1883106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883109">mp</span>&nbsp;<span class="op" id="1883112">:=</span>&nbsp;<span class="ident" id="1883115"><a href="/runtime/stubs.go.html#1968901">acquirem</a></span><span class="op" id="1883123">(</span><span class="op" id="1883124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883127"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883129">.</span><span class="ident" id="1883130">scalararg</span><span class="op" id="1883139">[</span><span class="num" id="1883140">0</span><span class="op" id="1883141">]</span>&nbsp;<span class="op" id="1883143">=</span>&nbsp;<span class="builtintype" id="1883145">uintptr</span><span class="op" id="1883152">(</span><span class="ident" id="1883153"><a href="/runtime/panic.go.html#1882603">siz</a></span><span class="op" id="1883156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883159"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883161">.</span><span class="ident" id="1883162">ptrarg</span><span class="op" id="1883168">[</span><span class="num" id="1883169">0</span><span class="op" id="1883170">]</span>&nbsp;<span class="op" id="1883172">=</span>&nbsp;<span class="ident" id="1883174"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1883180">.</span><span class="ident" id="1883181">Pointer</span><span class="op" id="1883188">(</span><span class="ident" id="1883189"><a href="/runtime/panic.go.html#1882614">fn</a></span><span class="op" id="1883191">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883194"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883196">.</span><span class="ident" id="1883197">scalararg</span><span class="op" id="1883206">[</span><span class="num" id="1883207">1</span><span class="op" id="1883208">]</span>&nbsp;<span class="op" id="1883210">=</span>&nbsp;<span class="ident" id="1883212"><a href="/runtime/panic.go.html#1882964">argp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883218"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883220">.</span><span class="ident" id="1883221">scalararg</span><span class="op" id="1883230">[</span><span class="num" id="1883231">2</span><span class="op" id="1883232">]</span>&nbsp;<span class="op" id="1883234">=</span>&nbsp;<span class="ident" id="1883236"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1883247">(</span><span class="ident" id="1883248"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1883254">.</span><span class="ident" id="1883255">Pointer</span><span class="op" id="1883262">(</span><span class="op" id="1883263">&amp;</span><span class="ident" id="1883264"><a href="/runtime/panic.go.html#1882603">siz</a></span><span class="op" id="1883267">)</span><span class="op" id="1883268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1883272">if</span>&nbsp;<span class="ident" id="1883275"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883277">.</span><span class="ident" id="1883278">curg</span>&nbsp;<span class="op" id="1883283">!=</span>&nbsp;<span class="ident" id="1883286"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1883290">(</span><span class="op" id="1883291">)</span>&nbsp;<span class="op" id="1883293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883297">//&nbsp;go&nbsp;code&nbsp;on&nbsp;the&nbsp;m&nbsp;stack&nbsp;can&#39;t&nbsp;defer</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883337"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1883344">(</span><span class="string" id="1883345">&#34;defer&nbsp;on&nbsp;m&#34;</span><span class="op" id="1883357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1883360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883364"><a href="/runtime/stubs.go.html#1971002">onM</a></span><span class="op" id="1883367">(</span><span class="ident" id="1883368"><a href="/runtime/stubs.go.html#1972361">deferproc_m</a></span><span class="op" id="1883379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883383"><a href="/runtime/stubs.go.html#1968920">releasem</a></span><span class="op" id="1883391">(</span><span class="ident" id="1883392"><a href="/runtime/panic.go.html#1883109">mp</a></span><span class="op" id="1883394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883398">//&nbsp;deferproc&nbsp;returns&nbsp;0&nbsp;normally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883432">//&nbsp;a&nbsp;deferred&nbsp;func&nbsp;that&nbsp;stops&nbsp;a&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883471">//&nbsp;makes&nbsp;the&nbsp;deferproc&nbsp;return&nbsp;1.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883505">//&nbsp;the&nbsp;code&nbsp;the&nbsp;compiler&nbsp;generates&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883548">//&nbsp;checks&nbsp;the&nbsp;return&nbsp;value&nbsp;and&nbsp;jumps&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883593">//&nbsp;end&nbsp;of&nbsp;the&nbsp;function&nbsp;if&nbsp;deferproc&nbsp;returns&nbsp;!=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1883644"><a href="/runtime/stubs.go.html#1976999">return0</a></span><span class="op" id="1883651">(</span><span class="op" id="1883652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883655">//&nbsp;No&nbsp;code&nbsp;can&nbsp;go&nbsp;here&nbsp;-&nbsp;the&nbsp;C&nbsp;return&nbsp;register&nbsp;has</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1883707">//&nbsp;been&nbsp;set&nbsp;and&nbsp;must&nbsp;not&nbsp;be&nbsp;clobbered.</span><br>
<span class="lineno"></span><span class="op" id="1883746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1883749">//&nbsp;Small&nbsp;malloc&nbsp;size&nbsp;classes&nbsp;&gt;=&nbsp;16&nbsp;are&nbsp;the&nbsp;multiples&nbsp;of&nbsp;16:&nbsp;16,&nbsp;32,&nbsp;48,&nbsp;64,&nbsp;80,&nbsp;96,&nbsp;112,&nbsp;128,&nbsp;144,&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1883852">//&nbsp;Each&nbsp;P&nbsp;holds&nbsp;a&nbsp;pool&nbsp;for&nbsp;defers&nbsp;with&nbsp;small&nbsp;arg&nbsp;sizes.</span><br>
<span class="lineno">95</span><span class="comment" id="1883908">//&nbsp;Assign&nbsp;defer&nbsp;allocations&nbsp;to&nbsp;pools&nbsp;by&nbsp;rounding&nbsp;to&nbsp;16,&nbsp;to&nbsp;match&nbsp;malloc&nbsp;size&nbsp;classes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1883995">const</span>&nbsp;<span class="op" id="1884001">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884004">deferHeaderSize</span>&nbsp;<span class="op" id="1884020">=</span>&nbsp;<span class="ident" id="1884022"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1884028">.</span><span class="ident" id="1884029">Sizeof</span><span class="op" id="1884035">(</span><span class="ident" id="1884036"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1884042">{</span><span class="op" id="1884043">}</span><span class="op" id="1884044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884047">minDeferAlloc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1884063">=</span>&nbsp;<span class="op" id="1884065">(</span><span class="ident" id="1884066"><a href="/runtime/panic.go.html#1884004">deferHeaderSize</a></span>&nbsp;<span class="op" id="1884082">+</span>&nbsp;<span class="num" id="1884084">15</span><span class="op" id="1884086">)</span>&nbsp;<span class="op" id="1884088">&amp;^</span>&nbsp;<span class="num" id="1884091">15</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884095">minDeferArgs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1884111">=</span>&nbsp;<span class="ident" id="1884113"><a href="/runtime/panic.go.html#1884047">minDeferAlloc</a></span>&nbsp;<span class="op" id="1884127">-</span>&nbsp;<span class="ident" id="1884129"><a href="/runtime/panic.go.html#1884004">deferHeaderSize</a></span><br>
<span class="lineno"></span><span class="op" id="1884145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1884148">//&nbsp;defer&nbsp;size&nbsp;class&nbsp;for&nbsp;arg&nbsp;size&nbsp;sz</span><br>
<span class="lineno"></span><span class="comment" id="1884184">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="1884197">func</span>&nbsp;<span class="ident" id="1884202">deferclass</span><span class="op" id="1884212">(</span><span class="ident" id="1884213">siz</span>&nbsp;<span class="builtintype" id="1884217">uintptr</span><span class="op" id="1884224">)</span>&nbsp;<span class="builtintype" id="1884226">uintptr</span>&nbsp;<span class="op" id="1884234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884237">if</span>&nbsp;<span class="ident" id="1884240"><a href="/runtime/panic.go.html#1884213">siz</a></span>&nbsp;<span class="op" id="1884244">&lt;=</span>&nbsp;<span class="ident" id="1884247"><a href="/runtime/panic.go.html#1884095">minDeferArgs</a></span>&nbsp;<span class="op" id="1884260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884264">return</span>&nbsp;<span class="num" id="1884271">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1884274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884277">return</span>&nbsp;<span class="op" id="1884284">(</span><span class="ident" id="1884285"><a href="/runtime/panic.go.html#1884213">siz</a></span>&nbsp;<span class="op" id="1884289">-</span>&nbsp;<span class="ident" id="1884291"><a href="/runtime/panic.go.html#1884095">minDeferArgs</a></span>&nbsp;<span class="op" id="1884304">+</span>&nbsp;<span class="num" id="1884306">15</span><span class="op" id="1884308">)</span>&nbsp;<span class="op" id="1884310">/</span>&nbsp;<span class="num" id="1884312">16</span><br>
<span class="lineno">110</span><span class="op" id="1884315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1884318">//&nbsp;total&nbsp;size&nbsp;of&nbsp;memory&nbsp;block&nbsp;for&nbsp;defer&nbsp;with&nbsp;arg&nbsp;size&nbsp;sz</span><br>
<span class="lineno"></span><span class="keyword" id="1884375">func</span>&nbsp;<span class="ident" id="1884380">totaldefersize</span><span class="op" id="1884394">(</span><span class="ident" id="1884395">siz</span>&nbsp;<span class="builtintype" id="1884399">uintptr</span><span class="op" id="1884406">)</span>&nbsp;<span class="builtintype" id="1884408">uintptr</span>&nbsp;<span class="op" id="1884416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884419">if</span>&nbsp;<span class="ident" id="1884422"><a href="/runtime/panic.go.html#1884395">siz</a></span>&nbsp;<span class="op" id="1884426">&lt;=</span>&nbsp;<span class="ident" id="1884429"><a href="/runtime/panic.go.html#1884095">minDeferArgs</a></span>&nbsp;<span class="op" id="1884442">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884446">return</span>&nbsp;<span class="ident" id="1884453"><a href="/runtime/panic.go.html#1884047">minDeferAlloc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1884468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884471">return</span>&nbsp;<span class="ident" id="1884478"><a href="/runtime/panic.go.html#1884004">deferHeaderSize</a></span>&nbsp;<span class="op" id="1884494">+</span>&nbsp;<span class="ident" id="1884496"><a href="/runtime/panic.go.html#1884395">siz</a></span><br>
<span class="lineno"></span><span class="op" id="1884500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="1884503">//&nbsp;Ensure&nbsp;that&nbsp;defer&nbsp;arg&nbsp;sizes&nbsp;that&nbsp;map&nbsp;to&nbsp;the&nbsp;same&nbsp;defer&nbsp;size&nbsp;class</span><br>
<span class="lineno"></span><span class="comment" id="1884572">//&nbsp;also&nbsp;map&nbsp;to&nbsp;the&nbsp;same&nbsp;malloc&nbsp;size&nbsp;class.</span><br>
<span class="lineno"></span><span class="keyword" id="1884615">func</span>&nbsp;<span class="ident" id="1884620">testdefersizes</span><span class="op" id="1884634">(</span><span class="op" id="1884635">)</span>&nbsp;<span class="op" id="1884637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884640">var</span>&nbsp;<span class="ident" id="1884644">m</span>&nbsp;<span class="op" id="1884646">[</span><span class="builtinfunc" id="1884647">len</span><span class="op" id="1884650">(</span><span class="ident" id="1884651"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2018563">p</a></span><span class="op" id="1884652">{</span><span class="op" id="1884653">}</span><span class="op" id="1884654">.</span><span class="ident" id="1884655">deferpool</span><span class="op" id="1884664">)</span><span class="op" id="1884665">]</span><span class="builtintype" id="1884666">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884674">for</span>&nbsp;<span class="ident" id="1884678">i</span>&nbsp;<span class="op" id="1884680">:=</span>&nbsp;<span class="keyword" id="1884683">range</span>&nbsp;<span class="ident" id="1884689"><a href="/runtime/panic.go.html#1884644">m</a></span>&nbsp;<span class="op" id="1884691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884695"><a href="/runtime/panic.go.html#1884644">m</a></span><span class="op" id="1884696">[</span><span class="ident" id="1884697"><a href="/runtime/panic.go.html#1884678">i</a></span><span class="op" id="1884698">]</span>&nbsp;<span class="op" id="1884700">=</span>&nbsp;<span class="op" id="1884702">-</span><span class="num" id="1884703">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1884706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884709">for</span>&nbsp;<span class="ident" id="1884713">i</span>&nbsp;<span class="op" id="1884715">:=</span>&nbsp;<span class="builtintype" id="1884718">uintptr</span><span class="op" id="1884725">(</span><span class="num" id="1884726">0</span><span class="op" id="1884727">)</span><span class="op" id="1884728">;</span>&nbsp;<span class="op" id="1884730">;</span>&nbsp;<span class="ident" id="1884732"><a href="/runtime/panic.go.html#1884713">i</a></span><span class="op" id="1884733">++</span>&nbsp;<span class="op" id="1884736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884740">defersc</span>&nbsp;<span class="op" id="1884748">:=</span>&nbsp;<span class="ident" id="1884751"><a href="/runtime/panic.go.html#1884202">deferclass</a></span><span class="op" id="1884761">(</span><span class="ident" id="1884762"><a href="/runtime/panic.go.html#1884713">i</a></span><span class="op" id="1884763">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884767">if</span>&nbsp;<span class="ident" id="1884770"><a href="/runtime/panic.go.html#1884740">defersc</a></span>&nbsp;<span class="op" id="1884778">&gt;=</span>&nbsp;<span class="builtintype" id="1884781">uintptr</span><span class="op" id="1884788">(</span><span class="builtinfunc" id="1884789">len</span><span class="op" id="1884792">(</span><span class="ident" id="1884793"><a href="/runtime/panic.go.html#1884644">m</a></span><span class="op" id="1884794">)</span><span class="op" id="1884795">)</span>&nbsp;<span class="op" id="1884797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884802">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1884810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884814">siz</span>&nbsp;<span class="op" id="1884818">:=</span>&nbsp;<span class="ident" id="1884821"><a href="/runtime/malloc.go.html#1829245">goroundupsize</a></span><span class="op" id="1884834">(</span><span class="ident" id="1884835"><a href="/runtime/panic.go.html#1884380">totaldefersize</a></span><span class="op" id="1884849">(</span><span class="ident" id="1884850"><a href="/runtime/panic.go.html#1884713">i</a></span><span class="op" id="1884851">)</span><span class="op" id="1884852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884856">if</span>&nbsp;<span class="ident" id="1884859"><a href="/runtime/panic.go.html#1884644">m</a></span><span class="op" id="1884860">[</span><span class="ident" id="1884861"><a href="/runtime/panic.go.html#1884740">defersc</a></span><span class="op" id="1884868">]</span>&nbsp;<span class="op" id="1884870">&lt;</span>&nbsp;<span class="num" id="1884872">0</span>&nbsp;<span class="op" id="1884874">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1884879"><a href="/runtime/panic.go.html#1884644">m</a></span><span class="op" id="1884880">[</span><span class="ident" id="1884881"><a href="/runtime/panic.go.html#1884740">defersc</a></span><span class="op" id="1884888">]</span>&nbsp;<span class="op" id="1884890">=</span>&nbsp;<span class="builtintype" id="1884892">int32</span><span class="op" id="1884897">(</span><span class="ident" id="1884898"><a href="/runtime/panic.go.html#1884814">siz</a></span><span class="op" id="1884901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884906">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1884917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1884921">if</span>&nbsp;<span class="ident" id="1884924"><a href="/runtime/panic.go.html#1884644">m</a></span><span class="op" id="1884925">[</span><span class="ident" id="1884926"><a href="/runtime/panic.go.html#1884740">defersc</a></span><span class="op" id="1884933">]</span>&nbsp;<span class="op" id="1884935">!=</span>&nbsp;<span class="builtintype" id="1884938">int32</span><span class="op" id="1884943">(</span><span class="ident" id="1884944"><a href="/runtime/panic.go.html#1884814">siz</a></span><span class="op" id="1884947">)</span>&nbsp;<span class="op" id="1884949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1884954">print</span><span class="op" id="1884959">(</span><span class="string" id="1884960">&#34;bad&nbsp;defer&nbsp;size&nbsp;class:&nbsp;i=&#34;</span><span class="op" id="1884986">,</span>&nbsp;<span class="ident" id="1884988"><a href="/runtime/panic.go.html#1884713">i</a></span><span class="op" id="1884989">,</span>&nbsp;<span class="string" id="1884991">&#34;&nbsp;siz=&#34;</span><span class="op" id="1884998">,</span>&nbsp;<span class="ident" id="1885000"><a href="/runtime/panic.go.html#1884814">siz</a></span><span class="op" id="1885003">,</span>&nbsp;<span class="string" id="1885005">&#34;&nbsp;defersc=&#34;</span><span class="op" id="1885016">,</span>&nbsp;<span class="ident" id="1885018"><a href="/runtime/panic.go.html#1884740">defersc</a></span><span class="op" id="1885025">,</span>&nbsp;<span class="string" id="1885027">&#34;\n&#34;</span><span class="op" id="1885031">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885036"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1885043">(</span><span class="string" id="1885044">&#34;bad&nbsp;defer&nbsp;size&nbsp;class&#34;</span><span class="op" id="1885066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1885070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1885073">}</span><br>
<span class="lineno"></span><span class="op" id="1885075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="1885078">//&nbsp;The&nbsp;arguments&nbsp;associated&nbsp;with&nbsp;a&nbsp;deferred&nbsp;call&nbsp;are&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="1885138">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;_defer&nbsp;header&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span><span class="comment" id="1885188">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1885201">func</span>&nbsp;<span class="ident" id="1885206">deferArgs</span><span class="op" id="1885215">(</span><span class="ident" id="1885216">d</span>&nbsp;<span class="op" id="1885218">*</span><span class="ident" id="1885219"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1885225">)</span>&nbsp;<span class="ident" id="1885227"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1885233">.</span><span class="ident" id="1885234">Pointer</span>&nbsp;<span class="op" id="1885242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885245">return</span>&nbsp;<span class="ident" id="1885252"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1885255">(</span><span class="ident" id="1885256"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1885262">.</span><span class="ident" id="1885263">Pointer</span><span class="op" id="1885270">(</span><span class="ident" id="1885271"><a href="/runtime/panic.go.html#1885216">d</a></span><span class="op" id="1885272">)</span><span class="op" id="1885273">,</span>&nbsp;<span class="ident" id="1885275"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1885281">.</span><span class="ident" id="1885282">Sizeof</span><span class="op" id="1885288">(</span><span class="op" id="1885289">*</span><span class="ident" id="1885290"><a href="/runtime/panic.go.html#1885216">d</a></span><span class="op" id="1885291">)</span><span class="op" id="1885292">)</span><br>
<span class="lineno">150</span><span class="op" id="1885294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1885297">var</span>&nbsp;<span class="ident" id="1885301">deferType</span>&nbsp;<span class="op" id="1885311">*</span><span class="ident" id="1885312"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2025572">_type</a></span>&nbsp;<span class="comment" id="1885318">//&nbsp;type&nbsp;of&nbsp;_defer&nbsp;struct</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1885344">func</span>&nbsp;<span class="ident" id="1885349">init</span><span class="op" id="1885353">(</span><span class="op" id="1885354">)</span>&nbsp;<span class="op" id="1885356">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885359">var</span>&nbsp;<span class="ident" id="1885363">x</span>&nbsp;<span class="keyword" id="1885365">interface</span><span class="op" id="1885374">{</span><span class="op" id="1885375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885378"><a href="/runtime/panic.go.html#1885363">x</a></span>&nbsp;<span class="op" id="1885380">=</span>&nbsp;<span class="op" id="1885382">(</span><span class="op" id="1885383">*</span><span class="ident" id="1885384"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1885390">)</span><span class="op" id="1885391">(</span><span class="ident" id="1885392">nil</span><span class="op" id="1885395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885398"><a href="/runtime/panic.go.html#1885301">deferType</a></span>&nbsp;<span class="op" id="1885408">=</span>&nbsp;<span class="op" id="1885410">(</span><span class="op" id="1885411">*</span><span class="op" id="1885412">(</span><span class="op" id="1885413">*</span><span class="op" id="1885414">*</span><span class="ident" id="1885415"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026489">ptrtype</a></span><span class="op" id="1885422">)</span><span class="op" id="1885423">(</span><span class="ident" id="1885424"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1885430">.</span><span class="ident" id="1885431">Pointer</span><span class="op" id="1885438">(</span><span class="op" id="1885439">&amp;</span><span class="ident" id="1885440"><a href="/runtime/panic.go.html#1885363">x</a></span><span class="op" id="1885441">)</span><span class="op" id="1885442">)</span><span class="op" id="1885443">)</span><span class="op" id="1885444">.</span><span class="ident" id="1885445">elem</span><br>
<span class="lineno"></span><span class="op" id="1885450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="1885453">//&nbsp;Allocate&nbsp;a&nbsp;Defer,&nbsp;usually&nbsp;using&nbsp;per-P&nbsp;pool.</span><br>
<span class="lineno"></span><span class="comment" id="1885500">//&nbsp;Each&nbsp;defer&nbsp;must&nbsp;be&nbsp;released&nbsp;with&nbsp;freedefer.</span><br>
<span class="lineno"></span><span class="comment" id="1885547">//&nbsp;Note:&nbsp;runs&nbsp;on&nbsp;M&nbsp;stack</span><br>
<span class="lineno"></span><span class="keyword" id="1885572">func</span>&nbsp;<span class="ident" id="1885577">newdefer</span><span class="op" id="1885585">(</span><span class="ident" id="1885586">siz</span>&nbsp;<span class="builtintype" id="1885590">int32</span><span class="op" id="1885595">)</span>&nbsp;<span class="op" id="1885597">*</span><span class="ident" id="1885598"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span>&nbsp;<span class="op" id="1885605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885608">var</span>&nbsp;<span class="ident" id="1885612">d</span>&nbsp;<span class="op" id="1885614">*</span><span class="ident" id="1885615"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885623">sc</span>&nbsp;<span class="op" id="1885626">:=</span>&nbsp;<span class="ident" id="1885629"><a href="/runtime/panic.go.html#1884202">deferclass</a></span><span class="op" id="1885639">(</span><span class="builtintype" id="1885640">uintptr</span><span class="op" id="1885647">(</span><span class="ident" id="1885648"><a href="/runtime/panic.go.html#1885586">siz</a></span><span class="op" id="1885651">)</span><span class="op" id="1885652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885655">mp</span>&nbsp;<span class="op" id="1885658">:=</span>&nbsp;<span class="ident" id="1885661"><a href="/runtime/stubs.go.html#1968901">acquirem</a></span><span class="op" id="1885669">(</span><span class="op" id="1885670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885673">if</span>&nbsp;<span class="ident" id="1885676"><a href="/runtime/panic.go.html#1885623">sc</a></span>&nbsp;<span class="op" id="1885679">&lt;</span>&nbsp;<span class="builtintype" id="1885681">uintptr</span><span class="op" id="1885688">(</span><span class="builtinfunc" id="1885689">len</span><span class="op" id="1885692">(</span><span class="ident" id="1885693"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2018563">p</a></span><span class="op" id="1885694">{</span><span class="op" id="1885695">}</span><span class="op" id="1885696">.</span><span class="ident" id="1885697">deferpool</span><span class="op" id="1885706">)</span><span class="op" id="1885707">)</span>&nbsp;<span class="op" id="1885709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885713">pp</span>&nbsp;<span class="op" id="1885716">:=</span>&nbsp;<span class="ident" id="1885719"><a href="/runtime/panic.go.html#1885655">mp</a></span><span class="op" id="1885721">.</span><span class="ident" id="1885722">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885726"><a href="/runtime/panic.go.html#1885612">d</a></span>&nbsp;<span class="op" id="1885728">=</span>&nbsp;<span class="ident" id="1885730"><a href="/runtime/panic.go.html#1885713">pp</a></span><span class="op" id="1885732">.</span><span class="ident" id="1885733">deferpool</span><span class="op" id="1885742">[</span><span class="ident" id="1885743"><a href="/runtime/panic.go.html#1885623">sc</a></span><span class="op" id="1885745">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885749">if</span>&nbsp;<span class="ident" id="1885752"><a href="/runtime/panic.go.html#1885612">d</a></span>&nbsp;<span class="op" id="1885754">!=</span>&nbsp;<span class="ident" id="1885757">nil</span>&nbsp;<span class="op" id="1885761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885766"><a href="/runtime/panic.go.html#1885713">pp</a></span><span class="op" id="1885768">.</span><span class="ident" id="1885769">deferpool</span><span class="op" id="1885778">[</span><span class="ident" id="1885779"><a href="/runtime/panic.go.html#1885623">sc</a></span><span class="op" id="1885781">]</span>&nbsp;<span class="op" id="1885783">=</span>&nbsp;<span class="ident" id="1885785"><a href="/runtime/panic.go.html#1885612">d</a></span><span class="op" id="1885786">.</span><span class="ident" id="1885787">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1885794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1885797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1885800">if</span>&nbsp;<span class="ident" id="1885803"><a href="/runtime/panic.go.html#1885612">d</a></span>&nbsp;<span class="op" id="1885805">==</span>&nbsp;<span class="ident" id="1885808">nil</span>&nbsp;<span class="op" id="1885812">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1885816">//&nbsp;Allocate&nbsp;new&nbsp;defer+args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885846">total</span>&nbsp;<span class="op" id="1885852">:=</span>&nbsp;<span class="ident" id="1885855"><a href="/runtime/malloc.go.html#1829245">goroundupsize</a></span><span class="op" id="1885868">(</span><span class="ident" id="1885869"><a href="/runtime/panic.go.html#1884380">totaldefersize</a></span><span class="op" id="1885883">(</span><span class="builtintype" id="1885884">uintptr</span><span class="op" id="1885891">(</span><span class="ident" id="1885892"><a href="/runtime/panic.go.html#1885586">siz</a></span><span class="op" id="1885895">)</span><span class="op" id="1885896">)</span><span class="op" id="1885897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885901"><a href="/runtime/panic.go.html#1885612">d</a></span>&nbsp;<span class="op" id="1885903">=</span>&nbsp;<span class="op" id="1885905">(</span><span class="op" id="1885906">*</span><span class="ident" id="1885907"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1885913">)</span><span class="op" id="1885914">(</span><span class="ident" id="1885915"><a href="/runtime/malloc.go.html#1819594">mallocgc</a></span><span class="op" id="1885923">(</span><span class="ident" id="1885924"><a href="/runtime/panic.go.html#1885846">total</a></span><span class="op" id="1885929">,</span>&nbsp;<span class="ident" id="1885931"><a href="/runtime/panic.go.html#1885301">deferType</a></span><span class="op" id="1885940">,</span>&nbsp;<span class="num" id="1885942">0</span><span class="op" id="1885943">)</span><span class="op" id="1885944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1885947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885950"><a href="/runtime/panic.go.html#1885612">d</a></span><span class="op" id="1885951">.</span><span class="ident" id="1885952">siz</span>&nbsp;<span class="op" id="1885956">=</span>&nbsp;<span class="ident" id="1885958"><a href="/runtime/panic.go.html#1885586">siz</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885963">gp</span>&nbsp;<span class="op" id="1885966">:=</span>&nbsp;<span class="ident" id="1885969"><a href="/runtime/panic.go.html#1885655">mp</a></span><span class="op" id="1885971">.</span><span class="ident" id="1885972">curg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885978"><a href="/runtime/panic.go.html#1885612">d</a></span><span class="op" id="1885979">.</span><span class="ident" id="1885980">link</span>&nbsp;<span class="op" id="1885985">=</span>&nbsp;<span class="ident" id="1885987"><a href="/runtime/panic.go.html#1885963">gp</a></span><span class="op" id="1885989">.</span><span class="ident" id="1885990">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1885998"><a href="/runtime/panic.go.html#1885963">gp</a></span><span class="op" id="1886000">.</span><span class="ident" id="1886001">_defer</span>&nbsp;<span class="op" id="1886008">=</span>&nbsp;<span class="ident" id="1886010"><a href="/runtime/panic.go.html#1885612">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886013"><a href="/runtime/stubs.go.html#1968920">releasem</a></span><span class="op" id="1886021">(</span><span class="ident" id="1886022"><a href="/runtime/panic.go.html#1885655">mp</a></span><span class="op" id="1886024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1886027">return</span>&nbsp;<span class="ident" id="1886034"><a href="/runtime/panic.go.html#1885612">d</a></span><br>
<span class="lineno">185</span><span class="op" id="1886036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1886039">//&nbsp;Free&nbsp;the&nbsp;given&nbsp;defer.</span><br>
<span class="lineno"></span><span class="comment" id="1886064">//&nbsp;The&nbsp;defer&nbsp;cannot&nbsp;be&nbsp;used&nbsp;after&nbsp;this&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1886109">//go:nosplit</span><br>
<span class="lineno">190</span><span class="keyword" id="1886122">func</span>&nbsp;<span class="ident" id="1886127">freedefer</span><span class="op" id="1886136">(</span><span class="ident" id="1886137">d</span>&nbsp;<span class="op" id="1886139">*</span><span class="ident" id="1886140"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1886146">)</span>&nbsp;<span class="op" id="1886148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1886151">if</span>&nbsp;<span class="ident" id="1886154"><a href="/runtime/panic.go.html#1886137">d</a></span><span class="op" id="1886155">.</span><span class="ident" id="1886156">_panic</span>&nbsp;<span class="op" id="1886163">!=</span>&nbsp;<span class="ident" id="1886166">nil</span>&nbsp;<span class="op" id="1886170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886174"><a href="/runtime/panic.go.html#1886524">freedeferpanic</a></span><span class="op" id="1886188">(</span><span class="op" id="1886189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1886192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1886195">if</span>&nbsp;<span class="ident" id="1886198"><a href="/runtime/panic.go.html#1886137">d</a></span><span class="op" id="1886199">.</span><span class="ident" id="1886200">fn</span>&nbsp;<span class="op" id="1886203">!=</span>&nbsp;<span class="ident" id="1886206">nil</span>&nbsp;<span class="op" id="1886210">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886214"><a href="/runtime/panic.go.html#1886651">freedeferfn</a></span><span class="op" id="1886225">(</span><span class="op" id="1886226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1886229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886232">sc</span>&nbsp;<span class="op" id="1886235">:=</span>&nbsp;<span class="ident" id="1886238"><a href="/runtime/panic.go.html#1884202">deferclass</a></span><span class="op" id="1886248">(</span><span class="builtintype" id="1886249">uintptr</span><span class="op" id="1886256">(</span><span class="ident" id="1886257"><a href="/runtime/panic.go.html#1886137">d</a></span><span class="op" id="1886258">.</span><span class="ident" id="1886259">siz</span><span class="op" id="1886262">)</span><span class="op" id="1886263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1886266">if</span>&nbsp;<span class="ident" id="1886269"><a href="/runtime/panic.go.html#1886232">sc</a></span>&nbsp;<span class="op" id="1886272">&lt;</span>&nbsp;<span class="builtintype" id="1886274">uintptr</span><span class="op" id="1886281">(</span><span class="builtinfunc" id="1886282">len</span><span class="op" id="1886285">(</span><span class="ident" id="1886286"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2018563">p</a></span><span class="op" id="1886287">{</span><span class="op" id="1886288">}</span><span class="op" id="1886289">.</span><span class="ident" id="1886290">deferpool</span><span class="op" id="1886299">)</span><span class="op" id="1886300">)</span>&nbsp;<span class="op" id="1886302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886306">mp</span>&nbsp;<span class="op" id="1886309">:=</span>&nbsp;<span class="ident" id="1886312"><a href="/runtime/stubs.go.html#1968901">acquirem</a></span><span class="op" id="1886320">(</span><span class="op" id="1886321">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886325">pp</span>&nbsp;<span class="op" id="1886328">:=</span>&nbsp;<span class="ident" id="1886331"><a href="/runtime/panic.go.html#1886306">mp</a></span><span class="op" id="1886333">.</span><span class="ident" id="1886334">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1886338">*</span><span class="ident" id="1886339"><a href="/runtime/panic.go.html#1886137">d</a></span>&nbsp;<span class="op" id="1886341">=</span>&nbsp;<span class="ident" id="1886343"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020668">_defer</a></span><span class="op" id="1886349">{</span><span class="op" id="1886350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886354"><a href="/runtime/panic.go.html#1886137">d</a></span><span class="op" id="1886355">.</span><span class="ident" id="1886356">link</span>&nbsp;<span class="op" id="1886361">=</span>&nbsp;<span class="ident" id="1886363"><a href="/runtime/panic.go.html#1886325">pp</a></span><span class="op" id="1886365">.</span><span class="ident" id="1886366">deferpool</span><span class="op" id="1886375">[</span><span class="ident" id="1886376"><a href="/runtime/panic.go.html#1886232">sc</a></span><span class="op" id="1886378">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886382"><a href="/runtime/panic.go.html#1886325">pp</a></span><span class="op" id="1886384">.</span><span class="ident" id="1886385">deferpool</span><span class="op" id="1886394">[</span><span class="ident" id="1886395"><a href="/runtime/panic.go.html#1886232">sc</a></span><span class="op" id="1886397">]</span>&nbsp;<span class="op" id="1886399">=</span>&nbsp;<span class="ident" id="1886401"><a href="/runtime/panic.go.html#1886137">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886405"><a href="/runtime/stubs.go.html#1968920">releasem</a></span><span class="op" id="1886413">(</span><span class="ident" id="1886414"><a href="/runtime/panic.go.html#1886306">mp</a></span><span class="op" id="1886416">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1886419">}</span><br>
<span class="lineno"></span><span class="op" id="1886421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1886424">//&nbsp;Separate&nbsp;function&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;split&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="1886473">//&nbsp;Windows&nbsp;otherwise&nbsp;runs&nbsp;out&nbsp;of&nbsp;stack&nbsp;space.</span><br>
<span class="lineno">210</span><span class="keyword" id="1886519">func</span>&nbsp;<span class="ident" id="1886524">freedeferpanic</span><span class="op" id="1886538">(</span><span class="op" id="1886539">)</span>&nbsp;<span class="op" id="1886541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1886544">//&nbsp;_panic&nbsp;must&nbsp;be&nbsp;cleared&nbsp;before&nbsp;d&nbsp;is&nbsp;unlinked&nbsp;from&nbsp;gp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886601"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1886608">(</span><span class="string" id="1886609">&#34;freedefer&nbsp;with&nbsp;d._panic&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="1886641">)</span><br>
<span class="lineno"></span><span class="op" id="1886643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="1886646">func</span>&nbsp;<span class="ident" id="1886651">freedeferfn</span><span class="op" id="1886662">(</span><span class="op" id="1886663">)</span>&nbsp;<span class="op" id="1886665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1886668">//&nbsp;fn&nbsp;must&nbsp;be&nbsp;cleared&nbsp;before&nbsp;d&nbsp;is&nbsp;unlinked&nbsp;from&nbsp;gp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1886721"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1886728">(</span><span class="string" id="1886729">&#34;freedefer&nbsp;with&nbsp;d.fn&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="1886757">)</span><br>
<span class="lineno"></span><span class="op" id="1886759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="1886762">//&nbsp;Run&nbsp;a&nbsp;deferred&nbsp;function&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="1886806">//&nbsp;The&nbsp;compiler&nbsp;inserts&nbsp;a&nbsp;call&nbsp;to&nbsp;this&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="1886863">//&nbsp;function&nbsp;which&nbsp;calls&nbsp;defer.</span><br>
<span class="lineno"></span><span class="comment" id="1886894">//&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;deferred&nbsp;function,&nbsp;this&nbsp;will&nbsp;call&nbsp;runtimejmpdefer,</span><br>
<span class="lineno"></span><span class="comment" id="1886964">//&nbsp;which&nbsp;will&nbsp;jump&nbsp;to&nbsp;the&nbsp;deferred&nbsp;function&nbsp;such&nbsp;that&nbsp;it&nbsp;appears</span><br>
<span class="lineno">225</span><span class="comment" id="1887029">//&nbsp;to&nbsp;have&nbsp;been&nbsp;called&nbsp;by&nbsp;the&nbsp;caller&nbsp;of&nbsp;deferreturn&nbsp;at&nbsp;the&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="1887094">//&nbsp;just&nbsp;before&nbsp;deferreturn&nbsp;was&nbsp;called.&nbsp;&nbsp;The&nbsp;effect&nbsp;is&nbsp;that&nbsp;deferreturn</span><br>
<span class="lineno"></span><span class="comment" id="1887165">//&nbsp;is&nbsp;called&nbsp;again&nbsp;and&nbsp;again&nbsp;until&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;deferred&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="1887238">//&nbsp;Cannot&nbsp;split&nbsp;the&nbsp;stack&nbsp;because&nbsp;we&nbsp;reuse&nbsp;the&nbsp;caller&#39;s&nbsp;frame&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1887303">//&nbsp;call&nbsp;the&nbsp;deferred&nbsp;function.</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="1887335">//&nbsp;The&nbsp;single&nbsp;argument&nbsp;isn&#39;t&nbsp;actually&nbsp;used&nbsp;-&nbsp;it&nbsp;just&nbsp;has&nbsp;its&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="1887404">//&nbsp;taken&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;matched&nbsp;against&nbsp;pending&nbsp;defers.</span><br>
<span class="lineno"></span><span class="comment" id="1887458">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1887471">func</span>&nbsp;<span class="ident" id="1887476">deferreturn</span><span class="op" id="1887487">(</span><span class="ident" id="1887488">arg0</span>&nbsp;<span class="builtintype" id="1887493">uintptr</span><span class="op" id="1887500">)</span>&nbsp;<span class="op" id="1887502">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887505">gp</span>&nbsp;<span class="op" id="1887508">:=</span>&nbsp;<span class="ident" id="1887511"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1887515">(</span><span class="op" id="1887516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887519">d</span>&nbsp;<span class="op" id="1887521">:=</span>&nbsp;<span class="ident" id="1887524"><a href="/runtime/panic.go.html#1887505">gp</a></span><span class="op" id="1887526">.</span><span class="ident" id="1887527">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1887535">if</span>&nbsp;<span class="ident" id="1887538"><a href="/runtime/panic.go.html#1887519">d</a></span>&nbsp;<span class="op" id="1887540">==</span>&nbsp;<span class="ident" id="1887543">nil</span>&nbsp;<span class="op" id="1887547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1887551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1887559">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887562">argp</span>&nbsp;<span class="op" id="1887567">:=</span>&nbsp;<span class="builtintype" id="1887570">uintptr</span><span class="op" id="1887577">(</span><span class="ident" id="1887578"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1887584">.</span><span class="ident" id="1887585">Pointer</span><span class="op" id="1887592">(</span><span class="op" id="1887593">&amp;</span><span class="ident" id="1887594"><a href="/runtime/panic.go.html#1887488">arg0</a></span><span class="op" id="1887598">)</span><span class="op" id="1887599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1887602">if</span>&nbsp;<span class="ident" id="1887605"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887606">.</span><span class="ident" id="1887607">argp</span>&nbsp;<span class="op" id="1887612">!=</span>&nbsp;<span class="ident" id="1887615"><a href="/runtime/panic.go.html#1887562">argp</a></span>&nbsp;<span class="op" id="1887620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1887624">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1887632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887636">//&nbsp;Moving&nbsp;arguments&nbsp;around.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887665">//&nbsp;Do&nbsp;not&nbsp;allow&nbsp;preemption&nbsp;here,&nbsp;because&nbsp;the&nbsp;garbage&nbsp;collector</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887729">//&nbsp;won&#39;t&nbsp;know&nbsp;the&nbsp;form&nbsp;of&nbsp;the&nbsp;arguments&nbsp;until&nbsp;the&nbsp;jmpdefer&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887793">//&nbsp;flip&nbsp;the&nbsp;PC&nbsp;over&nbsp;to&nbsp;fn.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887821">mp</span>&nbsp;<span class="op" id="1887824">:=</span>&nbsp;<span class="ident" id="1887827"><a href="/runtime/stubs.go.html#1968901">acquirem</a></span><span class="op" id="1887835">(</span><span class="op" id="1887836">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887839"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1887846">(</span><span class="ident" id="1887847"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1887853">.</span><span class="ident" id="1887854">Pointer</span><span class="op" id="1887861">(</span><span class="ident" id="1887862"><a href="/runtime/panic.go.html#1887562">argp</a></span><span class="op" id="1887866">)</span><span class="op" id="1887867">,</span>&nbsp;<span class="ident" id="1887869"><a href="/runtime/panic.go.html#1885206">deferArgs</a></span><span class="op" id="1887878">(</span><span class="ident" id="1887879"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887880">)</span><span class="op" id="1887881">,</span>&nbsp;<span class="builtintype" id="1887883">uintptr</span><span class="op" id="1887890">(</span><span class="ident" id="1887891"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887892">.</span><span class="ident" id="1887893">siz</span><span class="op" id="1887896">)</span><span class="op" id="1887897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887900">fn</span>&nbsp;<span class="op" id="1887903">:=</span>&nbsp;<span class="ident" id="1887906"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887907">.</span><span class="ident" id="1887908">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887912"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887913">.</span><span class="ident" id="1887914">fn</span>&nbsp;<span class="op" id="1887917">=</span>&nbsp;<span class="ident" id="1887919">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887924"><a href="/runtime/panic.go.html#1887505">gp</a></span><span class="op" id="1887926">.</span><span class="ident" id="1887927">_defer</span>&nbsp;<span class="op" id="1887934">=</span>&nbsp;<span class="ident" id="1887936"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887937">.</span><span class="ident" id="1887938">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887944"><a href="/runtime/panic.go.html#1886127">freedefer</a></span><span class="op" id="1887953">(</span><span class="ident" id="1887954"><a href="/runtime/panic.go.html#1887519">d</a></span><span class="op" id="1887955">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887958"><a href="/runtime/stubs.go.html#1968920">releasem</a></span><span class="op" id="1887966">(</span><span class="ident" id="1887967"><a href="/runtime/panic.go.html#1887821">mp</a></span><span class="op" id="1887969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887972"><a href="/runtime/stubs.go.html#1973767">jmpdefer</a></span><span class="op" id="1887980">(</span><span class="ident" id="1887981"><a href="/runtime/panic.go.html#1887900">fn</a></span><span class="op" id="1887983">,</span>&nbsp;<span class="ident" id="1887985"><a href="/runtime/panic.go.html#1887562">argp</a></span><span class="op" id="1887989">)</span><br>
<span class="lineno"></span><span class="op" id="1887991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1887994">//&nbsp;Goexit&nbsp;terminates&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.&nbsp;&nbsp;No&nbsp;other&nbsp;goroutine&nbsp;is&nbsp;affected.</span><br>
<span class="lineno">260</span><span class="comment" id="1888077">//&nbsp;Goexit&nbsp;runs&nbsp;all&nbsp;deferred&nbsp;calls&nbsp;before&nbsp;terminating&nbsp;the&nbsp;goroutine.&nbsp;&nbsp;Because&nbsp;Goexit</span><br>
<span class="lineno"></span><span class="comment" id="1888161">//&nbsp;is&nbsp;not&nbsp;panic,&nbsp;however,&nbsp;any&nbsp;recover&nbsp;calls&nbsp;in&nbsp;those&nbsp;deferred&nbsp;functions&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1888250">//</span><br>
<span class="lineno"></span><span class="comment" id="1888253">//&nbsp;Calling&nbsp;Goexit&nbsp;from&nbsp;the&nbsp;main&nbsp;goroutine&nbsp;terminates&nbsp;that&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="1888321">//&nbsp;without&nbsp;func&nbsp;main&nbsp;returning.&nbsp;Since&nbsp;func&nbsp;main&nbsp;has&nbsp;not&nbsp;returned,</span><br>
<span class="lineno">265</span><span class="comment" id="1888387">//&nbsp;the&nbsp;program&nbsp;continues&nbsp;execution&nbsp;of&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="1888443">//&nbsp;If&nbsp;all&nbsp;other&nbsp;goroutines&nbsp;exit,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="keyword" id="1888497">func</span>&nbsp;<span class="ident" id="1888502">Goexit</span><span class="op" id="1888508">(</span><span class="op" id="1888509">)</span>&nbsp;<span class="op" id="1888511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888514">//&nbsp;Run&nbsp;all&nbsp;deferred&nbsp;functions&nbsp;for&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888572">//&nbsp;This&nbsp;code&nbsp;is&nbsp;similar&nbsp;to&nbsp;gopanic,&nbsp;see&nbsp;that&nbsp;implementation</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888633">//&nbsp;for&nbsp;detailed&nbsp;comments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888660">gp</span>&nbsp;<span class="op" id="1888663">:=</span>&nbsp;<span class="ident" id="1888666"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1888670">(</span><span class="op" id="1888671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888674">for</span>&nbsp;<span class="op" id="1888678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888682">d</span>&nbsp;<span class="op" id="1888684">:=</span>&nbsp;<span class="ident" id="1888687"><a href="/runtime/panic.go.html#1888660">gp</a></span><span class="op" id="1888689">.</span><span class="ident" id="1888690">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888699">if</span>&nbsp;<span class="ident" id="1888702"><a href="/runtime/panic.go.html#1888682">d</a></span>&nbsp;<span class="op" id="1888704">==</span>&nbsp;<span class="ident" id="1888707">nil</span>&nbsp;<span class="op" id="1888711">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888716">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888728">if</span>&nbsp;<span class="ident" id="1888731"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888732">.</span><span class="ident" id="1888733">started</span>&nbsp;<span class="op" id="1888741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888746">if</span>&nbsp;<span class="ident" id="1888749"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888750">.</span><span class="ident" id="1888751">_panic</span>&nbsp;<span class="op" id="1888758">!=</span>&nbsp;<span class="ident" id="1888761">nil</span>&nbsp;<span class="op" id="1888765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888771"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888772">.</span><span class="ident" id="1888773">_panic</span><span class="op" id="1888779">.</span><span class="ident" id="1888780">aborted</span>&nbsp;<span class="op" id="1888788">=</span>&nbsp;<span class="ident" id="1888790">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888799"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888800">.</span><span class="ident" id="1888801">_panic</span>&nbsp;<span class="op" id="1888808">=</span>&nbsp;<span class="ident" id="1888810">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888822"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888823">.</span><span class="ident" id="1888824">fn</span>&nbsp;<span class="op" id="1888827">=</span>&nbsp;<span class="ident" id="1888829">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888836"><a href="/runtime/panic.go.html#1888660">gp</a></span><span class="op" id="1888838">.</span><span class="ident" id="1888839">_defer</span>&nbsp;<span class="op" id="1888846">=</span>&nbsp;<span class="ident" id="1888848"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888849">.</span><span class="ident" id="1888850">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888858"><a href="/runtime/panic.go.html#1886127">freedefer</a></span><span class="op" id="1888867">(</span><span class="ident" id="1888868"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888869">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888874">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888889"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888890">.</span><span class="ident" id="1888891">started</span>&nbsp;<span class="op" id="1888899">=</span>&nbsp;<span class="ident" id="1888901">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888908"><a href="/runtime/stubs.go.html#1974328">reflectcall</a></span><span class="op" id="1888919">(</span><span class="ident" id="1888920"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1888926">.</span><span class="ident" id="1888927">Pointer</span><span class="op" id="1888934">(</span><span class="ident" id="1888935"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888936">.</span><span class="ident" id="1888937">fn</span><span class="op" id="1888939">)</span><span class="op" id="1888940">,</span>&nbsp;<span class="ident" id="1888942"><a href="/runtime/panic.go.html#1885206">deferArgs</a></span><span class="op" id="1888951">(</span><span class="ident" id="1888952"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888953">)</span><span class="op" id="1888954">,</span>&nbsp;<span class="builtintype" id="1888956">uint32</span><span class="op" id="1888962">(</span><span class="ident" id="1888963"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888964">.</span><span class="ident" id="1888965">siz</span><span class="op" id="1888968">)</span><span class="op" id="1888969">,</span>&nbsp;<span class="builtintype" id="1888971">uint32</span><span class="op" id="1888977">(</span><span class="ident" id="1888978"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1888979">.</span><span class="ident" id="1888980">siz</span><span class="op" id="1888983">)</span><span class="op" id="1888984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888988">if</span>&nbsp;<span class="ident" id="1888991"><a href="/runtime/panic.go.html#1888660">gp</a></span><span class="op" id="1888993">.</span><span class="ident" id="1888994">_defer</span>&nbsp;<span class="op" id="1889001">!=</span>&nbsp;<span class="ident" id="1889004"><a href="/runtime/panic.go.html#1888682">d</a></span>&nbsp;<span class="op" id="1889006">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889011"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1889018">(</span><span class="string" id="1889019">&#34;bad&nbsp;defer&nbsp;entry&nbsp;in&nbsp;Goexit&#34;</span><span class="op" id="1889046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889054"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1889055">.</span><span class="ident" id="1889056">_panic</span>&nbsp;<span class="op" id="1889063">=</span>&nbsp;<span class="ident" id="1889065">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889071"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1889072">.</span><span class="ident" id="1889073">fn</span>&nbsp;<span class="op" id="1889076">=</span>&nbsp;<span class="ident" id="1889078">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889084"><a href="/runtime/panic.go.html#1888660">gp</a></span><span class="op" id="1889086">.</span><span class="ident" id="1889087">_defer</span>&nbsp;<span class="op" id="1889094">=</span>&nbsp;<span class="ident" id="1889096"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1889097">.</span><span class="ident" id="1889098">link</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889105"><a href="/runtime/panic.go.html#1886127">freedefer</a></span><span class="op" id="1889114">(</span><span class="ident" id="1889115"><a href="/runtime/panic.go.html#1888682">d</a></span><span class="op" id="1889116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889120">//&nbsp;Note:&nbsp;we&nbsp;ignore&nbsp;recovers&nbsp;here&nbsp;because&nbsp;Goexit&nbsp;isn&#39;t&nbsp;a&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889186"><a href="/runtime/stubs.go.html#1974611">goexit</a></span><span class="op" id="1889192">(</span><span class="op" id="1889193">)</span><br>
<span class="lineno"></span><span class="op" id="1889195">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="keyword" id="1889198">func</span>&nbsp;<span class="ident" id="1889203">canpanic</span><span class="op" id="1889211">(</span><span class="op" id="1889212">*</span><span class="ident" id="1889213"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017238">g</a></span><span class="op" id="1889214">)</span>&nbsp;<span class="builtintype" id="1889216">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1889222">//&nbsp;Print&nbsp;all&nbsp;currently&nbsp;active&nbsp;panics.&nbsp;&nbsp;Used&nbsp;when&nbsp;crashing.</span><br>
<span class="lineno"></span><span class="keyword" id="1889281">func</span>&nbsp;<span class="ident" id="1889286">printpanics</span><span class="op" id="1889297">(</span><span class="ident" id="1889298">p</span>&nbsp;<span class="op" id="1889300">*</span><span class="ident" id="1889301"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020786">_panic</a></span><span class="op" id="1889307">)</span>&nbsp;<span class="op" id="1889309">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889312">if</span>&nbsp;<span class="ident" id="1889315"><a href="/runtime/panic.go.html#1889298">p</a></span><span class="op" id="1889316">.</span><span class="ident" id="1889317">link</span>&nbsp;<span class="op" id="1889322">!=</span>&nbsp;<span class="ident" id="1889325">nil</span>&nbsp;<span class="op" id="1889329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889333"><a href="/runtime/panic.go.html#1889286">printpanics</a></span><span class="op" id="1889344">(</span><span class="ident" id="1889345"><a href="/runtime/panic.go.html#1889298">p</a></span><span class="op" id="1889346">.</span><span class="ident" id="1889347">link</span><span class="op" id="1889351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889355">print</span><span class="op" id="1889360">(</span><span class="string" id="1889361">&#34;\t&#34;</span><span class="op" id="1889365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889371">print</span><span class="op" id="1889376">(</span><span class="string" id="1889377">&#34;panic:&nbsp;&#34;</span><span class="op" id="1889386">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889389"><a href="/runtime/error.go.html#1755955">printany</a></span><span class="op" id="1889397">(</span><span class="ident" id="1889398"><a href="/runtime/panic.go.html#1889298">p</a></span><span class="op" id="1889399">.</span><span class="ident" id="1889400">arg</span><span class="op" id="1889403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889406">if</span>&nbsp;<span class="ident" id="1889409"><a href="/runtime/panic.go.html#1889298">p</a></span><span class="op" id="1889410">.</span><span class="ident" id="1889411">recovered</span>&nbsp;<span class="op" id="1889421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889425">print</span><span class="op" id="1889430">(</span><span class="string" id="1889431">&#34;&nbsp;[recovered]&#34;</span><span class="op" id="1889445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889451">print</span><span class="op" id="1889456">(</span><span class="string" id="1889457">&#34;\n&#34;</span><span class="op" id="1889461">)</span><br>
<span class="lineno">315</span><span class="op" id="1889463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1889466">//&nbsp;The&nbsp;implementation&nbsp;of&nbsp;the&nbsp;predeclared&nbsp;function&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="1889523">func</span>&nbsp;<span class="ident" id="1889528">gopanic</span><span class="op" id="1889535">(</span><span class="ident" id="1889536">e</span>&nbsp;<span class="keyword" id="1889538">interface</span><span class="op" id="1889547">{</span><span class="op" id="1889548">}</span><span class="op" id="1889549">)</span>&nbsp;<span class="op" id="1889551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889554">gp</span>&nbsp;<span class="op" id="1889557">:=</span>&nbsp;<span class="ident" id="1889560"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1889564">(</span><span class="op" id="1889565">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889568">if</span>&nbsp;<span class="ident" id="1889571"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1889573">.</span><span class="ident" id="1889574">m</span><span class="op" id="1889575">.</span><span class="ident" id="1889576">curg</span>&nbsp;<span class="op" id="1889581">!=</span>&nbsp;<span class="ident" id="1889584"><a href="/runtime/panic.go.html#1889554">gp</a></span>&nbsp;<span class="op" id="1889587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889591"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1889598">(</span><span class="string" id="1889599">&#34;panic&nbsp;on&nbsp;m&nbsp;stack&#34;</span><span class="op" id="1889617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889624">//&nbsp;m.softfloat&nbsp;is&nbsp;set&nbsp;during&nbsp;software&nbsp;floating&nbsp;point.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889679">//&nbsp;It&nbsp;increments&nbsp;m.locks&nbsp;to&nbsp;avoid&nbsp;preemption.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889726">//&nbsp;We&nbsp;moved&nbsp;the&nbsp;memory&nbsp;loads&nbsp;out,&nbsp;so&nbsp;there&nbsp;shouldn&#39;t&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889783">//&nbsp;any&nbsp;reason&nbsp;for&nbsp;it&nbsp;to&nbsp;panic&nbsp;anymore.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889823">if</span>&nbsp;<span class="ident" id="1889826"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1889828">.</span><span class="ident" id="1889829">m</span><span class="op" id="1889830">.</span><span class="ident" id="1889831">softfloat</span>&nbsp;<span class="op" id="1889841">!=</span>&nbsp;<span class="num" id="1889844">0</span>&nbsp;<span class="op" id="1889846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889850"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1889852">.</span><span class="ident" id="1889853">m</span><span class="op" id="1889854">.</span><span class="ident" id="1889855">locks</span><span class="op" id="1889860">--</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889865"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1889867">.</span><span class="ident" id="1889868">m</span><span class="op" id="1889869">.</span><span class="ident" id="1889870">softfloat</span>&nbsp;<span class="op" id="1889880">=</span>&nbsp;<span class="num" id="1889882">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889886"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1889893">(</span><span class="string" id="1889894">&#34;panic&nbsp;during&nbsp;softfloat&#34;</span><span class="op" id="1889918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889924">if</span>&nbsp;<span class="ident" id="1889927"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1889929">.</span><span class="ident" id="1889930">m</span><span class="op" id="1889931">.</span><span class="ident" id="1889932">mallocing</span>&nbsp;<span class="op" id="1889942">!=</span>&nbsp;<span class="num" id="1889945">0</span>&nbsp;<span class="op" id="1889947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889951">print</span><span class="op" id="1889956">(</span><span class="string" id="1889957">&#34;panic:&nbsp;&#34;</span><span class="op" id="1889966">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889970"><a href="/runtime/error.go.html#1755955">printany</a></span><span class="op" id="1889978">(</span><span class="ident" id="1889979"><a href="/runtime/panic.go.html#1889536">e</a></span><span class="op" id="1889980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1889984">print</span><span class="op" id="1889989">(</span><span class="string" id="1889990">&#34;\n&#34;</span><span class="op" id="1889994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889998"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1890005">(</span><span class="string" id="1890006">&#34;panic&nbsp;during&nbsp;malloc&#34;</span><span class="op" id="1890027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890033">if</span>&nbsp;<span class="ident" id="1890036"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890038">.</span><span class="ident" id="1890039">m</span><span class="op" id="1890040">.</span><span class="ident" id="1890041">gcing</span>&nbsp;<span class="op" id="1890047">!=</span>&nbsp;<span class="num" id="1890050">0</span>&nbsp;<span class="op" id="1890052">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1890056">print</span><span class="op" id="1890061">(</span><span class="string" id="1890062">&#34;panic:&nbsp;&#34;</span><span class="op" id="1890071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890075"><a href="/runtime/error.go.html#1755955">printany</a></span><span class="op" id="1890083">(</span><span class="ident" id="1890084"><a href="/runtime/panic.go.html#1889536">e</a></span><span class="op" id="1890085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1890089">print</span><span class="op" id="1890094">(</span><span class="string" id="1890095">&#34;\n&#34;</span><span class="op" id="1890099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890103"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1890110">(</span><span class="string" id="1890111">&#34;panic&nbsp;during&nbsp;gc&#34;</span><span class="op" id="1890128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890131">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890134">if</span>&nbsp;<span class="ident" id="1890137"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890139">.</span><span class="ident" id="1890140">m</span><span class="op" id="1890141">.</span><span class="ident" id="1890142">locks</span>&nbsp;<span class="op" id="1890148">!=</span>&nbsp;<span class="num" id="1890151">0</span>&nbsp;<span class="op" id="1890153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1890157">print</span><span class="op" id="1890162">(</span><span class="string" id="1890163">&#34;panic:&nbsp;&#34;</span><span class="op" id="1890172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890176"><a href="/runtime/error.go.html#1755955">printany</a></span><span class="op" id="1890184">(</span><span class="ident" id="1890185"><a href="/runtime/panic.go.html#1889536">e</a></span><span class="op" id="1890186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1890190">print</span><span class="op" id="1890195">(</span><span class="string" id="1890196">&#34;\n&#34;</span><span class="op" id="1890200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890204"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1890211">(</span><span class="string" id="1890212">&#34;panic&nbsp;holding&nbsp;locks&#34;</span><span class="op" id="1890233">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890240">var</span>&nbsp;<span class="ident" id="1890244">p</span>&nbsp;<span class="ident" id="1890246"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020786">_panic</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890254"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1890255">.</span><span class="ident" id="1890256">arg</span>&nbsp;<span class="op" id="1890260">=</span>&nbsp;<span class="ident" id="1890262"><a href="/runtime/panic.go.html#1889536">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890265"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1890266">.</span><span class="ident" id="1890267">link</span>&nbsp;<span class="op" id="1890272">=</span>&nbsp;<span class="ident" id="1890274"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890276">.</span><span class="ident" id="1890277">_panic</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890285"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890287">.</span><span class="ident" id="1890288">_panic</span>&nbsp;<span class="op" id="1890295">=</span>&nbsp;<span class="op" id="1890297">(</span><span class="op" id="1890298">*</span><span class="ident" id="1890299"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020786">_panic</a></span><span class="op" id="1890305">)</span><span class="op" id="1890306">(</span><span class="ident" id="1890307"><a href="/runtime/stubs.go.html#1973287">noescape</a></span><span class="op" id="1890315">(</span><span class="ident" id="1890316"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1890322">.</span><span class="ident" id="1890323">Pointer</span><span class="op" id="1890330">(</span><span class="op" id="1890331">&amp;</span><span class="ident" id="1890332"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1890333">)</span><span class="op" id="1890334">)</span><span class="op" id="1890335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890339">for</span>&nbsp;<span class="op" id="1890343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890347">d</span>&nbsp;<span class="op" id="1890349">:=</span>&nbsp;<span class="ident" id="1890352"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890354">.</span><span class="ident" id="1890355">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890364">if</span>&nbsp;<span class="ident" id="1890367"><a href="/runtime/panic.go.html#1890347">d</a></span>&nbsp;<span class="op" id="1890369">==</span>&nbsp;<span class="ident" id="1890372">nil</span>&nbsp;<span class="op" id="1890376">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890381">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890394">//&nbsp;If&nbsp;defer&nbsp;was&nbsp;started&nbsp;by&nbsp;earlier&nbsp;panic&nbsp;or&nbsp;Goexit&nbsp;(and,&nbsp;since&nbsp;we&#39;re&nbsp;back&nbsp;here,&nbsp;that&nbsp;triggered&nbsp;a&nbsp;new&nbsp;panic),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890505">//&nbsp;take&nbsp;defer&nbsp;off&nbsp;list.&nbsp;The&nbsp;earlier&nbsp;panic&nbsp;or&nbsp;Goexit&nbsp;will&nbsp;not&nbsp;continue&nbsp;running.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890586">if</span>&nbsp;<span class="ident" id="1890589"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890590">.</span><span class="ident" id="1890591">started</span>&nbsp;<span class="op" id="1890599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890604">if</span>&nbsp;<span class="ident" id="1890607"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890608">.</span><span class="ident" id="1890609">_panic</span>&nbsp;<span class="op" id="1890616">!=</span>&nbsp;<span class="ident" id="1890619">nil</span>&nbsp;<span class="op" id="1890623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890629"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890630">.</span><span class="ident" id="1890631">_panic</span><span class="op" id="1890637">.</span><span class="ident" id="1890638">aborted</span>&nbsp;<span class="op" id="1890646">=</span>&nbsp;<span class="ident" id="1890648">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890661"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890662">.</span><span class="ident" id="1890663">_panic</span>&nbsp;<span class="op" id="1890670">=</span>&nbsp;<span class="ident" id="1890672">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890679"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890680">.</span><span class="ident" id="1890681">fn</span>&nbsp;<span class="op" id="1890684">=</span>&nbsp;<span class="ident" id="1890686">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890693"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1890695">.</span><span class="ident" id="1890696">_defer</span>&nbsp;<span class="op" id="1890703">=</span>&nbsp;<span class="ident" id="1890705"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890706">.</span><span class="ident" id="1890707">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890715"><a href="/runtime/panic.go.html#1886127">freedefer</a></span><span class="op" id="1890724">(</span><span class="ident" id="1890725"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890731">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890742">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890747">//&nbsp;Mark&nbsp;defer&nbsp;as&nbsp;started,&nbsp;but&nbsp;keep&nbsp;on&nbsp;list,&nbsp;so&nbsp;that&nbsp;traceback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890811">//&nbsp;can&nbsp;find&nbsp;and&nbsp;update&nbsp;the&nbsp;defer&#39;s&nbsp;argument&nbsp;frame&nbsp;if&nbsp;stack&nbsp;growth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890879">//&nbsp;or&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;hapens&nbsp;before&nbsp;reflectcall&nbsp;starts&nbsp;executing&nbsp;d.fn.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890957"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1890958">.</span><span class="ident" id="1890959">started</span>&nbsp;<span class="op" id="1890967">=</span>&nbsp;<span class="ident" id="1890969">true</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890977">//&nbsp;Record&nbsp;the&nbsp;panic&nbsp;that&nbsp;is&nbsp;running&nbsp;the&nbsp;defer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891026">//&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;new&nbsp;panic&nbsp;during&nbsp;the&nbsp;deferred&nbsp;call,&nbsp;that&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891092">//&nbsp;will&nbsp;find&nbsp;d&nbsp;in&nbsp;the&nbsp;list&nbsp;and&nbsp;will&nbsp;mark&nbsp;d._panic&nbsp;(this&nbsp;panic)&nbsp;aborted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891166"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891167">.</span><span class="ident" id="1891168">_panic</span>&nbsp;<span class="op" id="1891175">=</span>&nbsp;<span class="op" id="1891177">(</span><span class="op" id="1891178">*</span><span class="ident" id="1891179"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2020786">_panic</a></span><span class="op" id="1891185">)</span><span class="op" id="1891186">(</span><span class="ident" id="1891187"><a href="/runtime/stubs.go.html#1973287">noescape</a></span><span class="op" id="1891195">(</span><span class="op" id="1891196">(</span><span class="ident" id="1891197"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1891203">.</span><span class="ident" id="1891204">Pointer</span><span class="op" id="1891211">)</span><span class="op" id="1891212">(</span><span class="op" id="1891213">&amp;</span><span class="ident" id="1891214"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1891215">)</span><span class="op" id="1891216">)</span><span class="op" id="1891217">)</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891222"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1891223">.</span><span class="ident" id="1891224">argp</span>&nbsp;<span class="op" id="1891229">=</span>&nbsp;<span class="ident" id="1891231"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1891237">.</span><span class="ident" id="1891238">Pointer</span><span class="op" id="1891245">(</span><span class="ident" id="1891246"><a href="/runtime/panic.go.html#1892485">getargp</a></span><span class="op" id="1891253">(</span><span class="num" id="1891254">0</span><span class="op" id="1891255">)</span><span class="op" id="1891256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891260"><a href="/runtime/stubs.go.html#1974328">reflectcall</a></span><span class="op" id="1891271">(</span><span class="ident" id="1891272"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1891278">.</span><span class="ident" id="1891279">Pointer</span><span class="op" id="1891286">(</span><span class="ident" id="1891287"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891288">.</span><span class="ident" id="1891289">fn</span><span class="op" id="1891291">)</span><span class="op" id="1891292">,</span>&nbsp;<span class="ident" id="1891294"><a href="/runtime/panic.go.html#1885206">deferArgs</a></span><span class="op" id="1891303">(</span><span class="ident" id="1891304"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891305">)</span><span class="op" id="1891306">,</span>&nbsp;<span class="builtintype" id="1891308">uint32</span><span class="op" id="1891314">(</span><span class="ident" id="1891315"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891316">.</span><span class="ident" id="1891317">siz</span><span class="op" id="1891320">)</span><span class="op" id="1891321">,</span>&nbsp;<span class="builtintype" id="1891323">uint32</span><span class="op" id="1891329">(</span><span class="ident" id="1891330"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891331">.</span><span class="ident" id="1891332">siz</span><span class="op" id="1891335">)</span><span class="op" id="1891336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891340"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1891341">.</span><span class="ident" id="1891342">argp</span>&nbsp;<span class="op" id="1891347">=</span>&nbsp;<span class="ident" id="1891349">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891356">//&nbsp;reflectcall&nbsp;did&nbsp;not&nbsp;panic.&nbsp;Remove&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891398">if</span>&nbsp;<span class="ident" id="1891401"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891403">.</span><span class="ident" id="1891404">_defer</span>&nbsp;<span class="op" id="1891411">!=</span>&nbsp;<span class="ident" id="1891414"><a href="/runtime/panic.go.html#1890347">d</a></span>&nbsp;<span class="op" id="1891416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891421"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1891428">(</span><span class="string" id="1891429">&#34;bad&nbsp;defer&nbsp;entry&nbsp;in&nbsp;panic&#34;</span><span class="op" id="1891455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891463"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891464">.</span><span class="ident" id="1891465">_panic</span>&nbsp;<span class="op" id="1891472">=</span>&nbsp;<span class="ident" id="1891474">nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891480"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891481">.</span><span class="ident" id="1891482">fn</span>&nbsp;<span class="op" id="1891485">=</span>&nbsp;<span class="ident" id="1891487">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891493"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891495">.</span><span class="ident" id="1891496">_defer</span>&nbsp;<span class="op" id="1891503">=</span>&nbsp;<span class="ident" id="1891505"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891506">.</span><span class="ident" id="1891507">link</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891515">//&nbsp;trigger&nbsp;shrinkage&nbsp;to&nbsp;test&nbsp;stack&nbsp;copy.&nbsp;&nbsp;See&nbsp;stack_test.go:TestStackPanic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891592">//GC()</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891602">pc</span>&nbsp;<span class="op" id="1891605">:=</span>&nbsp;<span class="ident" id="1891608"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891609">.</span><span class="ident" id="1891610">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891615">argp</span>&nbsp;<span class="op" id="1891620">:=</span>&nbsp;<span class="ident" id="1891623"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1891629">.</span><span class="ident" id="1891630">Pointer</span><span class="op" id="1891637">(</span><span class="ident" id="1891638"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891639">.</span><span class="ident" id="1891640">argp</span><span class="op" id="1891644">)</span>&nbsp;<span class="comment" id="1891646">//&nbsp;must&nbsp;be&nbsp;pointer&nbsp;so&nbsp;it&nbsp;gets&nbsp;adjusted&nbsp;during&nbsp;stack&nbsp;copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891705"><a href="/runtime/panic.go.html#1886127">freedefer</a></span><span class="op" id="1891714">(</span><span class="ident" id="1891715"><a href="/runtime/panic.go.html#1890347">d</a></span><span class="op" id="1891716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891720">if</span>&nbsp;<span class="ident" id="1891723"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1891724">.</span><span class="ident" id="1891725">recovered</span>&nbsp;<span class="op" id="1891735">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891740"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891742">.</span><span class="ident" id="1891743">_panic</span>&nbsp;<span class="op" id="1891750">=</span>&nbsp;<span class="ident" id="1891752"><a href="/runtime/panic.go.html#1890244">p</a></span><span class="op" id="1891753">.</span><span class="ident" id="1891754">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891762">//&nbsp;Aborted&nbsp;panics&nbsp;are&nbsp;marked&nbsp;but&nbsp;remain&nbsp;on&nbsp;the&nbsp;g.panic&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891826">//&nbsp;Remove&nbsp;them&nbsp;from&nbsp;the&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891859">for</span>&nbsp;<span class="ident" id="1891863"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891865">.</span><span class="ident" id="1891866">_panic</span>&nbsp;<span class="op" id="1891873">!=</span>&nbsp;<span class="ident" id="1891876">nil</span>&nbsp;<span class="op" id="1891880">&amp;&amp;</span>&nbsp;<span class="ident" id="1891883"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891885">.</span><span class="ident" id="1891886">_panic</span><span class="op" id="1891892">.</span><span class="ident" id="1891893">aborted</span>&nbsp;<span class="op" id="1891901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891907"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891909">.</span><span class="ident" id="1891910">_panic</span>&nbsp;<span class="op" id="1891917">=</span>&nbsp;<span class="ident" id="1891919"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891921">.</span><span class="ident" id="1891922">_panic</span><span class="op" id="1891928">.</span><span class="ident" id="1891929">link</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891942">if</span>&nbsp;<span class="ident" id="1891945"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891947">.</span><span class="ident" id="1891948">_panic</span>&nbsp;<span class="op" id="1891955">==</span>&nbsp;<span class="ident" id="1891958">nil</span>&nbsp;<span class="op" id="1891962">{</span>&nbsp;<span class="comment" id="1891964">//&nbsp;must&nbsp;be&nbsp;done&nbsp;with&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891996"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1891998">.</span><span class="ident" id="1891999">sig</span>&nbsp;<span class="op" id="1892003">=</span>&nbsp;<span class="num" id="1892005">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892015">//&nbsp;Pass&nbsp;information&nbsp;about&nbsp;recovering&nbsp;frame&nbsp;to&nbsp;recovery.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892074"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1892076">.</span><span class="ident" id="1892077">sigcode0</span>&nbsp;<span class="op" id="1892086">=</span>&nbsp;<span class="builtintype" id="1892088">uintptr</span><span class="op" id="1892095">(</span><span class="ident" id="1892096"><a href="/runtime/panic.go.html#1891615">argp</a></span><span class="op" id="1892100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892105"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1892107">.</span><span class="ident" id="1892108">sigcode1</span>&nbsp;<span class="op" id="1892117">=</span>&nbsp;<span class="ident" id="1892119"><a href="/runtime/panic.go.html#1891602">pc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892125"><a href="/runtime/stubs.go.html#1969611">mcall</a></span><span class="op" id="1892130">(</span><span class="ident" id="1892131"><a href="/runtime/stubs.go.html#1972023">recovery_m</a></span><span class="op" id="1892141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892146"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1892153">(</span><span class="string" id="1892154">&#34;recovery&nbsp;failed&#34;</span><span class="op" id="1892171">)</span>&nbsp;<span class="comment" id="1892173">//&nbsp;mcall&nbsp;should&nbsp;not&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892202">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892209">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;deferred&nbsp;calls&nbsp;-&nbsp;old-school&nbsp;panic&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892262"><a href="/runtime/panic.go.html#1893730">startpanic</a></span><span class="op" id="1892272">(</span><span class="op" id="1892273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892276"><a href="/runtime/panic.go.html#1889286">printpanics</a></span><span class="op" id="1892287">(</span><span class="ident" id="1892288"><a href="/runtime/panic.go.html#1889554">gp</a></span><span class="op" id="1892290">.</span><span class="ident" id="1892291">_panic</span><span class="op" id="1892297">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892300"><a href="/runtime/panic.go.html#1893794">dopanic</a></span><span class="op" id="1892307">(</span><span class="num" id="1892308">0</span><span class="op" id="1892309">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1892317">//&nbsp;should&nbsp;not&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892339">*</span><span class="op" id="1892340">(</span><span class="op" id="1892341">*</span><span class="builtintype" id="1892342">int</span><span class="op" id="1892345">)</span><span class="op" id="1892346">(</span><span class="ident" id="1892347">nil</span><span class="op" id="1892350">)</span>&nbsp;<span class="op" id="1892352">=</span>&nbsp;<span class="num" id="1892354">0</span>&nbsp;<span class="comment" id="1892356">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno"></span><span class="op" id="1892371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1892374">//&nbsp;getargp&nbsp;returns&nbsp;the&nbsp;location&nbsp;where&nbsp;the&nbsp;caller</span><br>
<span class="lineno">430</span><span class="comment" id="1892423">//&nbsp;writes&nbsp;outgoing&nbsp;function&nbsp;call&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="1892467">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1892480">func</span>&nbsp;<span class="ident" id="1892485">getargp</span><span class="op" id="1892492">(</span><span class="ident" id="1892493">x</span>&nbsp;<span class="builtintype" id="1892495">int</span><span class="op" id="1892498">)</span>&nbsp;<span class="builtintype" id="1892500">uintptr</span>&nbsp;<span class="op" id="1892508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892511">//&nbsp;x&nbsp;is&nbsp;an&nbsp;argument&nbsp;mainly&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;return&nbsp;its&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892574">//&nbsp;However,&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;the&nbsp;function&nbsp;complex&nbsp;enough</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892631">//&nbsp;that&nbsp;it&nbsp;won&#39;t&nbsp;be&nbsp;inlined.&nbsp;We&nbsp;always&nbsp;pass&nbsp;x&nbsp;=&nbsp;0,&nbsp;so&nbsp;this&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892696">//&nbsp;does&nbsp;nothing&nbsp;other&nbsp;than&nbsp;keep&nbsp;the&nbsp;compiler&nbsp;from&nbsp;thinking</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892756">//&nbsp;the&nbsp;function&nbsp;is&nbsp;simple&nbsp;enough&nbsp;to&nbsp;inline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892801">if</span>&nbsp;<span class="ident" id="1892804"><a href="/runtime/panic.go.html#1892493">x</a></span>&nbsp;<span class="op" id="1892806">&gt;</span>&nbsp;<span class="num" id="1892808">0</span>&nbsp;<span class="op" id="1892810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892814">return</span>&nbsp;<span class="ident" id="1892821"><a href="/runtime/stubs.go.html#1976425">getcallersp</a></span><span class="op" id="1892832">(</span><span class="ident" id="1892833"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1892839">.</span><span class="ident" id="1892840">Pointer</span><span class="op" id="1892847">(</span><span class="op" id="1892848">&amp;</span><span class="ident" id="1892849"><a href="/runtime/panic.go.html#1892493">x</a></span><span class="op" id="1892850">)</span><span class="op" id="1892851">)</span>&nbsp;<span class="op" id="1892853">*</span>&nbsp;<span class="num" id="1892855">0</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892861">return</span>&nbsp;<span class="builtintype" id="1892868">uintptr</span><span class="op" id="1892875">(</span><span class="ident" id="1892876"><a href="/runtime/stubs.go.html#1973287">noescape</a></span><span class="op" id="1892884">(</span><span class="ident" id="1892885"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1892891">.</span><span class="ident" id="1892892">Pointer</span><span class="op" id="1892899">(</span><span class="op" id="1892900">&amp;</span><span class="ident" id="1892901"><a href="/runtime/panic.go.html#1892493">x</a></span><span class="op" id="1892902">)</span><span class="op" id="1892903">)</span><span class="op" id="1892904">)</span><br>
<span class="lineno"></span><span class="op" id="1892906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1892909">//&nbsp;The&nbsp;implementation&nbsp;of&nbsp;the&nbsp;predeclared&nbsp;function&nbsp;recover.</span><br>
<span class="lineno">445</span><span class="comment" id="1892968">//&nbsp;Cannot&nbsp;split&nbsp;the&nbsp;stack&nbsp;because&nbsp;it&nbsp;needs&nbsp;to&nbsp;reliably</span><br>
<span class="lineno"></span><span class="comment" id="1893023">//&nbsp;find&nbsp;the&nbsp;stack&nbsp;segment&nbsp;of&nbsp;its&nbsp;caller.</span><br>
<span class="lineno"></span><span class="comment" id="1893064">//</span><br>
<span class="lineno"></span><span class="comment" id="1893067">//&nbsp;TODO(rsc):&nbsp;Once&nbsp;we&nbsp;commit&nbsp;to&nbsp;CopyStackAlways,</span><br>
<span class="lineno"></span><span class="comment" id="1893116">//&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;nosplit.</span><br>
<span class="lineno">450</span><span class="comment" id="1893152">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1893165">func</span>&nbsp;<span class="ident" id="1893170">gorecover</span><span class="op" id="1893179">(</span><span class="ident" id="1893180">argp</span>&nbsp;<span class="builtintype" id="1893185">uintptr</span><span class="op" id="1893192">)</span>&nbsp;<span class="keyword" id="1893194">interface</span><span class="op" id="1893203">{</span><span class="op" id="1893204">}</span>&nbsp;<span class="op" id="1893206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893209">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;a&nbsp;function&nbsp;running&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;deferred&nbsp;call&nbsp;during&nbsp;the&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893288">//&nbsp;Must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;topmost&nbsp;function&nbsp;of&nbsp;the&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893345">//&nbsp;(the&nbsp;function&nbsp;used&nbsp;in&nbsp;the&nbsp;defer&nbsp;statement).</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893393">//&nbsp;p.argp&nbsp;is&nbsp;the&nbsp;argument&nbsp;pointer&nbsp;of&nbsp;that&nbsp;topmost&nbsp;deferred&nbsp;function&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893468">//&nbsp;Compare&nbsp;against&nbsp;argp&nbsp;reported&nbsp;by&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893513">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;the&nbsp;caller&nbsp;is&nbsp;the&nbsp;one&nbsp;who&nbsp;can&nbsp;recover.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893571">gp</span>&nbsp;<span class="op" id="1893574">:=</span>&nbsp;<span class="ident" id="1893577"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1893581">(</span><span class="op" id="1893582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893585">p</span>&nbsp;<span class="op" id="1893587">:=</span>&nbsp;<span class="ident" id="1893590"><a href="/runtime/panic.go.html#1893571">gp</a></span><span class="op" id="1893592">.</span><span class="ident" id="1893593">_panic</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893601">if</span>&nbsp;<span class="ident" id="1893604"><a href="/runtime/panic.go.html#1893585">p</a></span>&nbsp;<span class="op" id="1893606">!=</span>&nbsp;<span class="ident" id="1893609">nil</span>&nbsp;<span class="op" id="1893613">&amp;&amp;</span>&nbsp;<span class="op" id="1893616">!</span><span class="ident" id="1893617"><a href="/runtime/panic.go.html#1893585">p</a></span><span class="op" id="1893618">.</span><span class="ident" id="1893619">recovered</span>&nbsp;<span class="op" id="1893629">&amp;&amp;</span>&nbsp;<span class="ident" id="1893632"><a href="/runtime/panic.go.html#1893180">argp</a></span>&nbsp;<span class="op" id="1893637">==</span>&nbsp;<span class="builtintype" id="1893640">uintptr</span><span class="op" id="1893647">(</span><span class="ident" id="1893648"><a href="/runtime/panic.go.html#1893585">p</a></span><span class="op" id="1893649">.</span><span class="ident" id="1893650">argp</span><span class="op" id="1893654">)</span>&nbsp;<span class="op" id="1893656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893660"><a href="/runtime/panic.go.html#1893585">p</a></span><span class="op" id="1893661">.</span><span class="ident" id="1893662">recovered</span>&nbsp;<span class="op" id="1893672">=</span>&nbsp;<span class="ident" id="1893674">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893681">return</span>&nbsp;<span class="ident" id="1893688"><a href="/runtime/panic.go.html#1893585">p</a></span><span class="op" id="1893689">.</span><span class="ident" id="1893690">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893698">return</span>&nbsp;<span class="ident" id="1893705">nil</span><br>
<span class="lineno">465</span><span class="op" id="1893709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1893712">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1893725">func</span>&nbsp;<span class="ident" id="1893730">startpanic</span><span class="op" id="1893740">(</span><span class="op" id="1893741">)</span>&nbsp;<span class="op" id="1893743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893746"><a href="/runtime/stubs.go.html#1971833">onM_signalok</a></span><span class="op" id="1893758">(</span><span class="ident" id="1893759"><a href="/runtime/stubs.go.html#1972396">startpanic_m</a></span><span class="op" id="1893771">)</span><br>
<span class="lineno">470</span><span class="op" id="1893773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1893776">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1893789">func</span>&nbsp;<span class="ident" id="1893794">dopanic</span><span class="op" id="1893801">(</span><span class="ident" id="1893802">unused</span>&nbsp;<span class="builtintype" id="1893809">int</span><span class="op" id="1893812">)</span>&nbsp;<span class="op" id="1893814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893817">gp</span>&nbsp;<span class="op" id="1893820">:=</span>&nbsp;<span class="ident" id="1893823"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1893827">(</span><span class="op" id="1893828">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893831">mp</span>&nbsp;<span class="op" id="1893834">:=</span>&nbsp;<span class="ident" id="1893837"><a href="/runtime/stubs.go.html#1968901">acquirem</a></span><span class="op" id="1893845">(</span><span class="op" id="1893846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893849"><a href="/runtime/panic.go.html#1893831">mp</a></span><span class="op" id="1893851">.</span><span class="ident" id="1893852">ptrarg</span><span class="op" id="1893858">[</span><span class="num" id="1893859">0</span><span class="op" id="1893860">]</span>&nbsp;<span class="op" id="1893862">=</span>&nbsp;<span class="ident" id="1893864"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1893870">.</span><span class="ident" id="1893871">Pointer</span><span class="op" id="1893878">(</span><span class="ident" id="1893879"><a href="/runtime/panic.go.html#1893817">gp</a></span><span class="op" id="1893881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893884"><a href="/runtime/panic.go.html#1893831">mp</a></span><span class="op" id="1893886">.</span><span class="ident" id="1893887">scalararg</span><span class="op" id="1893896">[</span><span class="num" id="1893897">0</span><span class="op" id="1893898">]</span>&nbsp;<span class="op" id="1893900">=</span>&nbsp;<span class="ident" id="1893902"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1893913">(</span><span class="op" id="1893914">(</span><span class="ident" id="1893915"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1893921">.</span><span class="ident" id="1893922">Pointer</span><span class="op" id="1893929">)</span><span class="op" id="1893930">(</span><span class="op" id="1893931">&amp;</span><span class="ident" id="1893932"><a href="/runtime/panic.go.html#1893802">unused</a></span><span class="op" id="1893938">)</span><span class="op" id="1893939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893942"><a href="/runtime/panic.go.html#1893831">mp</a></span><span class="op" id="1893944">.</span><span class="ident" id="1893945">scalararg</span><span class="op" id="1893954">[</span><span class="num" id="1893955">1</span><span class="op" id="1893956">]</span>&nbsp;<span class="op" id="1893958">=</span>&nbsp;<span class="ident" id="1893960"><a href="/runtime/stubs.go.html#1976425">getcallersp</a></span><span class="op" id="1893971">(</span><span class="op" id="1893972">(</span><span class="ident" id="1893973"><a href="/runtime/panic.go.html#1881599">unsafe</a></span><span class="op" id="1893979">.</span><span class="ident" id="1893980">Pointer</span><span class="op" id="1893987">)</span><span class="op" id="1893988">(</span><span class="op" id="1893989">&amp;</span><span class="ident" id="1893990"><a href="/runtime/panic.go.html#1893802">unused</a></span><span class="op" id="1893996">)</span><span class="op" id="1893997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894000"><a href="/runtime/stubs.go.html#1971833">onM_signalok</a></span><span class="op" id="1894012">(</span><span class="ident" id="1894013"><a href="/runtime/stubs.go.html#1972416">dopanic_m</a></span><span class="op" id="1894022">)</span>&nbsp;<span class="comment" id="1894024">//&nbsp;should&nbsp;never&nbsp;return</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894048">*</span><span class="op" id="1894049">(</span><span class="op" id="1894050">*</span><span class="builtintype" id="1894051">int</span><span class="op" id="1894054">)</span><span class="op" id="1894055">(</span><span class="ident" id="1894056">nil</span><span class="op" id="1894059">)</span>&nbsp;<span class="op" id="1894061">=</span>&nbsp;<span class="num" id="1894063">0</span><br>
<span class="lineno"></span><span class="op" id="1894065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1894068">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1894081">func</span>&nbsp;<span class="ident" id="1894086">throw</span><span class="op" id="1894091">(</span><span class="ident" id="1894092">s</span>&nbsp;<span class="op" id="1894094">*</span><span class="builtintype" id="1894095">byte</span><span class="op" id="1894099">)</span>&nbsp;<span class="op" id="1894101">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894104">gp</span>&nbsp;<span class="op" id="1894107">:=</span>&nbsp;<span class="ident" id="1894110"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1894114">(</span><span class="op" id="1894115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894118">if</span>&nbsp;<span class="ident" id="1894121"><a href="/runtime/panic.go.html#1894104">gp</a></span><span class="op" id="1894123">.</span><span class="ident" id="1894124">m</span><span class="op" id="1894125">.</span><span class="ident" id="1894126">throwing</span>&nbsp;<span class="op" id="1894135">==</span>&nbsp;<span class="num" id="1894138">0</span>&nbsp;<span class="op" id="1894140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894144"><a href="/runtime/panic.go.html#1894104">gp</a></span><span class="op" id="1894146">.</span><span class="ident" id="1894147">m</span><span class="op" id="1894148">.</span><span class="ident" id="1894149">throwing</span>&nbsp;<span class="op" id="1894158">=</span>&nbsp;<span class="num" id="1894160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894166"><a href="/runtime/panic.go.html#1893730">startpanic</a></span><span class="op" id="1894176">(</span><span class="op" id="1894177">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1894180">print</span><span class="op" id="1894185">(</span><span class="string" id="1894186">&#34;fatal&nbsp;error:&nbsp;&#34;</span><span class="op" id="1894201">,</span>&nbsp;<span class="ident" id="1894203"><a href="/runtime/stubs.go.html#1974575">gostringnocopy</a></span><span class="op" id="1894217">(</span><span class="ident" id="1894218"><a href="/runtime/panic.go.html#1894092">s</a></span><span class="op" id="1894219">)</span><span class="op" id="1894220">,</span>&nbsp;<span class="string" id="1894222">&#34;\n&#34;</span><span class="op" id="1894226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894229"><a href="/runtime/panic.go.html#1893794">dopanic</a></span><span class="op" id="1894236">(</span><span class="num" id="1894237">0</span><span class="op" id="1894238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894241">*</span><span class="op" id="1894242">(</span><span class="op" id="1894243">*</span><span class="builtintype" id="1894244">int</span><span class="op" id="1894247">)</span><span class="op" id="1894248">(</span><span class="ident" id="1894249">nil</span><span class="op" id="1894252">)</span>&nbsp;<span class="op" id="1894254">=</span>&nbsp;<span class="num" id="1894256">0</span>&nbsp;<span class="comment" id="1894258">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno"></span><span class="op" id="1894273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="comment" id="1894276">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1894289">func</span>&nbsp;<span class="ident" id="1894294">gothrow</span><span class="op" id="1894301">(</span><span class="ident" id="1894302">s</span>&nbsp;<span class="builtintype" id="1894304">string</span><span class="op" id="1894310">)</span>&nbsp;<span class="op" id="1894312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894315">gp</span>&nbsp;<span class="op" id="1894318">:=</span>&nbsp;<span class="ident" id="1894321"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1894325">(</span><span class="op" id="1894326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894329">if</span>&nbsp;<span class="ident" id="1894332"><a href="/runtime/panic.go.html#1894315">gp</a></span><span class="op" id="1894334">.</span><span class="ident" id="1894335">m</span><span class="op" id="1894336">.</span><span class="ident" id="1894337">throwing</span>&nbsp;<span class="op" id="1894346">==</span>&nbsp;<span class="num" id="1894349">0</span>&nbsp;<span class="op" id="1894351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894355"><a href="/runtime/panic.go.html#1894315">gp</a></span><span class="op" id="1894357">.</span><span class="ident" id="1894358">m</span><span class="op" id="1894359">.</span><span class="ident" id="1894360">throwing</span>&nbsp;<span class="op" id="1894369">=</span>&nbsp;<span class="num" id="1894371">1</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894377"><a href="/runtime/panic.go.html#1893730">startpanic</a></span><span class="op" id="1894387">(</span><span class="op" id="1894388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1894391">print</span><span class="op" id="1894396">(</span><span class="string" id="1894397">&#34;fatal&nbsp;error:&nbsp;&#34;</span><span class="op" id="1894412">,</span>&nbsp;<span class="ident" id="1894414"><a href="/runtime/panic.go.html#1894302">s</a></span><span class="op" id="1894415">,</span>&nbsp;<span class="string" id="1894417">&#34;\n&#34;</span><span class="op" id="1894421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894424"><a href="/runtime/panic.go.html#1893794">dopanic</a></span><span class="op" id="1894431">(</span><span class="num" id="1894432">0</span><span class="op" id="1894433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894436">*</span><span class="op" id="1894437">(</span><span class="op" id="1894438">*</span><span class="builtintype" id="1894439">int</span><span class="op" id="1894442">)</span><span class="op" id="1894443">(</span><span class="ident" id="1894444">nil</span><span class="op" id="1894447">)</span>&nbsp;<span class="op" id="1894449">=</span>&nbsp;<span class="num" id="1894451">0</span>&nbsp;<span class="comment" id="1894453">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno">505</span><span class="op" id="1894468">}</span>
</div>
</body>
</html>
