<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html" class="current">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4558226">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4558282">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4558336">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4558387">package</span>&nbsp;<span class="ident" id="4558395">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4558405">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4558480">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4558498">//</span><br>
<span class="lineno">10</span><span class="comment" id="4558501">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4558581">import</span>&nbsp;<span class="op" id="4558588">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4558591">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4558602">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4558605">var</span>&nbsp;<span class="ident" id="4558609">p224</span>&nbsp;<span class="ident" id="4558614">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4558625">type</span>&nbsp;<span class="ident" id="4558630">p224Curve</span>&nbsp;<span class="keyword" id="4558640">struct</span>&nbsp;<span class="op" id="4558647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4558650">*</span><span class="ident" id="4558651">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558664">gx</span><span class="op" id="4558666">,</span>&nbsp;<span class="ident" id="4558668">gy</span><span class="op" id="4558670">,</span>&nbsp;<span class="ident" id="4558672">b</span>&nbsp;<span class="ident" id="4558674">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4558691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4558694">func</span>&nbsp;<span class="ident" id="4558699">initP224</span><span class="op" id="4558707">(</span><span class="op" id="4558708">)</span>&nbsp;<span class="op" id="4558710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4558713">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558747">p224</span><span class="op" id="4558751">.</span><span class="ident" id="4558752">CurveParams</span>&nbsp;<span class="op" id="4558764">=</span>&nbsp;<span class="builtinfunc" id="4558766">new</span><span class="op" id="4558769">(</span><span class="ident" id="4558770">CurveParams</span><span class="op" id="4558781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558784">p224</span><span class="op" id="4558788">.</span><span class="ident" id="4558789">P</span><span class="op" id="4558790">,</span>&nbsp;<span class="ident" id="4558792">_</span>&nbsp;<span class="op" id="4558794">=</span>&nbsp;<span class="builtinfunc" id="4558796">new</span><span class="op" id="4558799">(</span><span class="ident" id="4558800">big</span><span class="op" id="4558803">.</span><span class="ident" id="4558804">Int</span><span class="op" id="4558807">)</span><span class="op" id="4558808">.</span><span class="ident" id="4558809">SetString</span><span class="op" id="4558818">(</span><span class="string" id="4558819">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4558889">,</span>&nbsp;<span class="num" id="4558891">10</span><span class="op" id="4558893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558896">p224</span><span class="op" id="4558900">.</span><span class="ident" id="4558901">N</span><span class="op" id="4558902">,</span>&nbsp;<span class="ident" id="4558904">_</span>&nbsp;<span class="op" id="4558906">=</span>&nbsp;<span class="builtinfunc" id="4558908">new</span><span class="op" id="4558911">(</span><span class="ident" id="4558912">big</span><span class="op" id="4558915">.</span><span class="ident" id="4558916">Int</span><span class="op" id="4558919">)</span><span class="op" id="4558920">.</span><span class="ident" id="4558921">SetString</span><span class="op" id="4558930">(</span><span class="string" id="4558931">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4559001">,</span>&nbsp;<span class="num" id="4559003">10</span><span class="op" id="4559005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559008">p224</span><span class="op" id="4559012">.</span><span class="ident" id="4559013">B</span><span class="op" id="4559014">,</span>&nbsp;<span class="ident" id="4559016">_</span>&nbsp;<span class="op" id="4559018">=</span>&nbsp;<span class="builtinfunc" id="4559020">new</span><span class="op" id="4559023">(</span><span class="ident" id="4559024">big</span><span class="op" id="4559027">.</span><span class="ident" id="4559028">Int</span><span class="op" id="4559031">)</span><span class="op" id="4559032">.</span><span class="ident" id="4559033">SetString</span><span class="op" id="4559042">(</span><span class="string" id="4559043">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4559101">,</span>&nbsp;<span class="num" id="4559103">16</span><span class="op" id="4559105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559108">p224</span><span class="op" id="4559112">.</span><span class="ident" id="4559113">Gx</span><span class="op" id="4559115">,</span>&nbsp;<span class="ident" id="4559117">_</span>&nbsp;<span class="op" id="4559119">=</span>&nbsp;<span class="builtinfunc" id="4559121">new</span><span class="op" id="4559124">(</span><span class="ident" id="4559125">big</span><span class="op" id="4559128">.</span><span class="ident" id="4559129">Int</span><span class="op" id="4559132">)</span><span class="op" id="4559133">.</span><span class="ident" id="4559134">SetString</span><span class="op" id="4559143">(</span><span class="string" id="4559144">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4559202">,</span>&nbsp;<span class="num" id="4559204">16</span><span class="op" id="4559206">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559209">p224</span><span class="op" id="4559213">.</span><span class="ident" id="4559214">Gy</span><span class="op" id="4559216">,</span>&nbsp;<span class="ident" id="4559218">_</span>&nbsp;<span class="op" id="4559220">=</span>&nbsp;<span class="builtinfunc" id="4559222">new</span><span class="op" id="4559225">(</span><span class="ident" id="4559226">big</span><span class="op" id="4559229">.</span><span class="ident" id="4559230">Int</span><span class="op" id="4559233">)</span><span class="op" id="4559234">.</span><span class="ident" id="4559235">SetString</span><span class="op" id="4559244">(</span><span class="string" id="4559245">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4559303">,</span>&nbsp;<span class="num" id="4559305">16</span><span class="op" id="4559307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559310">p224</span><span class="op" id="4559314">.</span><span class="ident" id="4559315">BitSize</span>&nbsp;<span class="op" id="4559323">=</span>&nbsp;<span class="num" id="4559325">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559331">p224FromBig</span><span class="op" id="4559342">(</span><span class="op" id="4559343">&amp;</span><span class="ident" id="4559344">p224</span><span class="op" id="4559348">.</span><span class="ident" id="4559349">gx</span><span class="op" id="4559351">,</span>&nbsp;<span class="ident" id="4559353">p224</span><span class="op" id="4559357">.</span><span class="ident" id="4559358">Gx</span><span class="op" id="4559360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559363">p224FromBig</span><span class="op" id="4559374">(</span><span class="op" id="4559375">&amp;</span><span class="ident" id="4559376">p224</span><span class="op" id="4559380">.</span><span class="ident" id="4559381">gy</span><span class="op" id="4559383">,</span>&nbsp;<span class="ident" id="4559385">p224</span><span class="op" id="4559389">.</span><span class="ident" id="4559390">Gy</span><span class="op" id="4559392">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559395">p224FromBig</span><span class="op" id="4559406">(</span><span class="op" id="4559407">&amp;</span><span class="ident" id="4559408">p224</span><span class="op" id="4559412">.</span><span class="ident" id="4559413">b</span><span class="op" id="4559414">,</span>&nbsp;<span class="ident" id="4559416">p224</span><span class="op" id="4559420">.</span><span class="ident" id="4559421">B</span><span class="op" id="4559422">)</span><br>
<span class="lineno"></span><span class="op" id="4559424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4559427">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4559506">func</span>&nbsp;<span class="ident" id="4559511">P224</span><span class="op" id="4559515">(</span><span class="op" id="4559516">)</span>&nbsp;<span class="ident" id="4559518">Curve</span>&nbsp;<span class="op" id="4559524">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559527">initonce</span><span class="op" id="4559535">.</span><span class="ident" id="4559536">Do</span><span class="op" id="4559538">(</span><span class="ident" id="4559539">initAll</span><span class="op" id="4559546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559549">return</span>&nbsp;<span class="ident" id="4559556">p224</span><br>
<span class="lineno"></span><span class="op" id="4559561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4559564">func</span>&nbsp;<span class="op" id="4559569">(</span><span class="ident" id="4559570">curve</span>&nbsp;<span class="ident" id="4559576">p224Curve</span><span class="op" id="4559585">)</span>&nbsp;<span class="ident" id="4559587">Params</span><span class="op" id="4559593">(</span><span class="op" id="4559594">)</span>&nbsp;<span class="op" id="4559596">*</span><span class="ident" id="4559597">CurveParams</span>&nbsp;<span class="op" id="4559609">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559612">return</span>&nbsp;<span class="ident" id="4559619">curve</span><span class="op" id="4559624">.</span><span class="ident" id="4559625">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4559637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4559640">func</span>&nbsp;<span class="op" id="4559645">(</span><span class="ident" id="4559646">curve</span>&nbsp;<span class="ident" id="4559652">p224Curve</span><span class="op" id="4559661">)</span>&nbsp;<span class="ident" id="4559663">IsOnCurve</span><span class="op" id="4559672">(</span><span class="ident" id="4559673">bigX</span><span class="op" id="4559677">,</span>&nbsp;<span class="ident" id="4559679">bigY</span>&nbsp;<span class="op" id="4559684">*</span><span class="ident" id="4559685">big</span><span class="op" id="4559688">.</span><span class="ident" id="4559689">Int</span><span class="op" id="4559692">)</span>&nbsp;<span class="builtintype" id="4559694">bool</span>&nbsp;<span class="op" id="4559699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559702">var</span>&nbsp;<span class="ident" id="4559706">x</span><span class="op" id="4559707">,</span>&nbsp;<span class="ident" id="4559709">y</span>&nbsp;<span class="ident" id="4559711">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559729">p224FromBig</span><span class="op" id="4559740">(</span><span class="op" id="4559741">&amp;</span><span class="ident" id="4559742">x</span><span class="op" id="4559743">,</span>&nbsp;<span class="ident" id="4559745">bigX</span><span class="op" id="4559749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559752">p224FromBig</span><span class="op" id="4559763">(</span><span class="op" id="4559764">&amp;</span><span class="ident" id="4559765">y</span><span class="op" id="4559766">,</span>&nbsp;<span class="ident" id="4559768">bigY</span><span class="op" id="4559772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4559776">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559799">var</span>&nbsp;<span class="ident" id="4559803">tmp</span>&nbsp;<span class="ident" id="4559807">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559830">var</span>&nbsp;<span class="ident" id="4559834">x3</span>&nbsp;<span class="ident" id="4559837">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559855">p224Square</span><span class="op" id="4559865">(</span><span class="op" id="4559866">&amp;</span><span class="ident" id="4559867">x3</span><span class="op" id="4559869">,</span>&nbsp;<span class="op" id="4559871">&amp;</span><span class="ident" id="4559872">x</span><span class="op" id="4559873">,</span>&nbsp;<span class="op" id="4559875">&amp;</span><span class="ident" id="4559876">tmp</span><span class="op" id="4559879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559882">p224Mul</span><span class="op" id="4559889">(</span><span class="op" id="4559890">&amp;</span><span class="ident" id="4559891">x3</span><span class="op" id="4559893">,</span>&nbsp;<span class="op" id="4559895">&amp;</span><span class="ident" id="4559896">x3</span><span class="op" id="4559898">,</span>&nbsp;<span class="op" id="4559900">&amp;</span><span class="ident" id="4559901">x</span><span class="op" id="4559902">,</span>&nbsp;<span class="op" id="4559904">&amp;</span><span class="ident" id="4559905">tmp</span><span class="op" id="4559908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4559912">for</span>&nbsp;<span class="ident" id="4559916">i</span>&nbsp;<span class="op" id="4559918">:=</span>&nbsp;<span class="num" id="4559921">0</span><span class="op" id="4559922">;</span>&nbsp;<span class="ident" id="4559924">i</span>&nbsp;<span class="op" id="4559926">&lt;</span>&nbsp;<span class="num" id="4559928">8</span><span class="op" id="4559929">;</span>&nbsp;<span class="ident" id="4559931">i</span><span class="op" id="4559932">++</span>&nbsp;<span class="op" id="4559935">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559939">x</span><span class="op" id="4559940">[</span><span class="ident" id="4559941">i</span><span class="op" id="4559942">]</span>&nbsp;<span class="op" id="4559944">*=</span>&nbsp;<span class="num" id="4559947">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4559950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559953">p224Sub</span><span class="op" id="4559960">(</span><span class="op" id="4559961">&amp;</span><span class="ident" id="4559962">x3</span><span class="op" id="4559964">,</span>&nbsp;<span class="op" id="4559966">&amp;</span><span class="ident" id="4559967">x3</span><span class="op" id="4559969">,</span>&nbsp;<span class="op" id="4559971">&amp;</span><span class="ident" id="4559972">x</span><span class="op" id="4559973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559976">p224Reduce</span><span class="op" id="4559986">(</span><span class="op" id="4559987">&amp;</span><span class="ident" id="4559988">x3</span><span class="op" id="4559990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4559993">p224Add</span><span class="op" id="4560000">(</span><span class="op" id="4560001">&amp;</span><span class="ident" id="4560002">x3</span><span class="op" id="4560004">,</span>&nbsp;<span class="op" id="4560006">&amp;</span><span class="ident" id="4560007">x3</span><span class="op" id="4560009">,</span>&nbsp;<span class="op" id="4560011">&amp;</span><span class="ident" id="4560012">curve</span><span class="op" id="4560017">.</span><span class="ident" id="4560018">b</span><span class="op" id="4560019">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560022">p224Contract</span><span class="op" id="4560034">(</span><span class="op" id="4560035">&amp;</span><span class="ident" id="4560036">x3</span><span class="op" id="4560038">,</span>&nbsp;<span class="op" id="4560040">&amp;</span><span class="ident" id="4560041">x3</span><span class="op" id="4560043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560047">p224Square</span><span class="op" id="4560057">(</span><span class="op" id="4560058">&amp;</span><span class="ident" id="4560059">y</span><span class="op" id="4560060">,</span>&nbsp;<span class="op" id="4560062">&amp;</span><span class="ident" id="4560063">y</span><span class="op" id="4560064">,</span>&nbsp;<span class="op" id="4560066">&amp;</span><span class="ident" id="4560067">tmp</span><span class="op" id="4560070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560073">p224Contract</span><span class="op" id="4560085">(</span><span class="op" id="4560086">&amp;</span><span class="ident" id="4560087">y</span><span class="op" id="4560088">,</span>&nbsp;<span class="op" id="4560090">&amp;</span><span class="ident" id="4560091">y</span><span class="op" id="4560092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560096">for</span>&nbsp;<span class="ident" id="4560100">i</span>&nbsp;<span class="op" id="4560102">:=</span>&nbsp;<span class="num" id="4560105">0</span><span class="op" id="4560106">;</span>&nbsp;<span class="ident" id="4560108">i</span>&nbsp;<span class="op" id="4560110">&lt;</span>&nbsp;<span class="num" id="4560112">8</span><span class="op" id="4560113">;</span>&nbsp;<span class="ident" id="4560115">i</span><span class="op" id="4560116">++</span>&nbsp;<span class="op" id="4560119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560123">if</span>&nbsp;<span class="ident" id="4560126">y</span><span class="op" id="4560127">[</span><span class="ident" id="4560128">i</span><span class="op" id="4560129">]</span>&nbsp;<span class="op" id="4560131">!=</span>&nbsp;<span class="ident" id="4560134">x3</span><span class="op" id="4560136">[</span><span class="ident" id="4560137">i</span><span class="op" id="4560138">]</span>&nbsp;<span class="op" id="4560140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560145">return</span>&nbsp;<span class="builtintype" id="4560152">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560163">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560166">return</span>&nbsp;<span class="builtintype" id="4560173">true</span><br>
<span class="lineno"></span><span class="op" id="4560178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4560181">func</span>&nbsp;<span class="op" id="4560186">(</span><span class="ident" id="4560187">p224Curve</span><span class="op" id="4560196">)</span>&nbsp;<span class="ident" id="4560198">Add</span><span class="op" id="4560201">(</span><span class="ident" id="4560202">bigX1</span><span class="op" id="4560207">,</span>&nbsp;<span class="ident" id="4560209">bigY1</span><span class="op" id="4560214">,</span>&nbsp;<span class="ident" id="4560216">bigX2</span><span class="op" id="4560221">,</span>&nbsp;<span class="ident" id="4560223">bigY2</span>&nbsp;<span class="op" id="4560229">*</span><span class="ident" id="4560230">big</span><span class="op" id="4560233">.</span><span class="ident" id="4560234">Int</span><span class="op" id="4560237">)</span>&nbsp;<span class="op" id="4560239">(</span><span class="ident" id="4560240">x</span><span class="op" id="4560241">,</span>&nbsp;<span class="ident" id="4560243">y</span>&nbsp;<span class="op" id="4560245">*</span><span class="ident" id="4560246">big</span><span class="op" id="4560249">.</span><span class="ident" id="4560250">Int</span><span class="op" id="4560253">)</span>&nbsp;<span class="op" id="4560255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560258">var</span>&nbsp;<span class="ident" id="4560262">x1</span><span class="op" id="4560264">,</span>&nbsp;<span class="ident" id="4560266">y1</span><span class="op" id="4560268">,</span>&nbsp;<span class="ident" id="4560270">z1</span><span class="op" id="4560272">,</span>&nbsp;<span class="ident" id="4560274">x2</span><span class="op" id="4560276">,</span>&nbsp;<span class="ident" id="4560278">y2</span><span class="op" id="4560280">,</span>&nbsp;<span class="ident" id="4560282">z2</span><span class="op" id="4560284">,</span>&nbsp;<span class="ident" id="4560286">x3</span><span class="op" id="4560288">,</span>&nbsp;<span class="ident" id="4560290">y3</span><span class="op" id="4560292">,</span>&nbsp;<span class="ident" id="4560294">z3</span>&nbsp;<span class="ident" id="4560297">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560316">p224FromBig</span><span class="op" id="4560327">(</span><span class="op" id="4560328">&amp;</span><span class="ident" id="4560329">x1</span><span class="op" id="4560331">,</span>&nbsp;<span class="ident" id="4560333">bigX1</span><span class="op" id="4560338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560341">p224FromBig</span><span class="op" id="4560352">(</span><span class="op" id="4560353">&amp;</span><span class="ident" id="4560354">y1</span><span class="op" id="4560356">,</span>&nbsp;<span class="ident" id="4560358">bigY1</span><span class="op" id="4560363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560366">if</span>&nbsp;<span class="ident" id="4560369">bigX1</span><span class="op" id="4560374">.</span><span class="ident" id="4560375">Sign</span><span class="op" id="4560379">(</span><span class="op" id="4560380">)</span>&nbsp;<span class="op" id="4560382">!=</span>&nbsp;<span class="num" id="4560385">0</span>&nbsp;<span class="op" id="4560387">||</span>&nbsp;<span class="ident" id="4560390">bigY1</span><span class="op" id="4560395">.</span><span class="ident" id="4560396">Sign</span><span class="op" id="4560400">(</span><span class="op" id="4560401">)</span>&nbsp;<span class="op" id="4560403">!=</span>&nbsp;<span class="num" id="4560406">0</span>&nbsp;<span class="op" id="4560408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560412">z1</span><span class="op" id="4560414">[</span><span class="num" id="4560415">0</span><span class="op" id="4560416">]</span>&nbsp;<span class="op" id="4560418">=</span>&nbsp;<span class="num" id="4560420">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560426">p224FromBig</span><span class="op" id="4560437">(</span><span class="op" id="4560438">&amp;</span><span class="ident" id="4560439">x2</span><span class="op" id="4560441">,</span>&nbsp;<span class="ident" id="4560443">bigX2</span><span class="op" id="4560448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560451">p224FromBig</span><span class="op" id="4560462">(</span><span class="op" id="4560463">&amp;</span><span class="ident" id="4560464">y2</span><span class="op" id="4560466">,</span>&nbsp;<span class="ident" id="4560468">bigY2</span><span class="op" id="4560473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560476">if</span>&nbsp;<span class="ident" id="4560479">bigX2</span><span class="op" id="4560484">.</span><span class="ident" id="4560485">Sign</span><span class="op" id="4560489">(</span><span class="op" id="4560490">)</span>&nbsp;<span class="op" id="4560492">!=</span>&nbsp;<span class="num" id="4560495">0</span>&nbsp;<span class="op" id="4560497">||</span>&nbsp;<span class="ident" id="4560500">bigY2</span><span class="op" id="4560505">.</span><span class="ident" id="4560506">Sign</span><span class="op" id="4560510">(</span><span class="op" id="4560511">)</span>&nbsp;<span class="op" id="4560513">!=</span>&nbsp;<span class="num" id="4560516">0</span>&nbsp;<span class="op" id="4560518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560522">z2</span><span class="op" id="4560524">[</span><span class="num" id="4560525">0</span><span class="op" id="4560526">]</span>&nbsp;<span class="op" id="4560528">=</span>&nbsp;<span class="num" id="4560530">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4560533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560537">p224AddJacobian</span><span class="op" id="4560552">(</span><span class="op" id="4560553">&amp;</span><span class="ident" id="4560554">x3</span><span class="op" id="4560556">,</span>&nbsp;<span class="op" id="4560558">&amp;</span><span class="ident" id="4560559">y3</span><span class="op" id="4560561">,</span>&nbsp;<span class="op" id="4560563">&amp;</span><span class="ident" id="4560564">z3</span><span class="op" id="4560566">,</span>&nbsp;<span class="op" id="4560568">&amp;</span><span class="ident" id="4560569">x1</span><span class="op" id="4560571">,</span>&nbsp;<span class="op" id="4560573">&amp;</span><span class="ident" id="4560574">y1</span><span class="op" id="4560576">,</span>&nbsp;<span class="op" id="4560578">&amp;</span><span class="ident" id="4560579">z1</span><span class="op" id="4560581">,</span>&nbsp;<span class="op" id="4560583">&amp;</span><span class="ident" id="4560584">x2</span><span class="op" id="4560586">,</span>&nbsp;<span class="op" id="4560588">&amp;</span><span class="ident" id="4560589">y2</span><span class="op" id="4560591">,</span>&nbsp;<span class="op" id="4560593">&amp;</span><span class="ident" id="4560594">z2</span><span class="op" id="4560596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560599">return</span>&nbsp;<span class="ident" id="4560606">p224ToAffine</span><span class="op" id="4560618">(</span><span class="op" id="4560619">&amp;</span><span class="ident" id="4560620">x3</span><span class="op" id="4560622">,</span>&nbsp;<span class="op" id="4560624">&amp;</span><span class="ident" id="4560625">y3</span><span class="op" id="4560627">,</span>&nbsp;<span class="op" id="4560629">&amp;</span><span class="ident" id="4560630">z3</span><span class="op" id="4560632">)</span><br>
<span class="lineno"></span><span class="op" id="4560634">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4560637">func</span>&nbsp;<span class="op" id="4560642">(</span><span class="ident" id="4560643">p224Curve</span><span class="op" id="4560652">)</span>&nbsp;<span class="ident" id="4560654">Double</span><span class="op" id="4560660">(</span><span class="ident" id="4560661">bigX1</span><span class="op" id="4560666">,</span>&nbsp;<span class="ident" id="4560668">bigY1</span>&nbsp;<span class="op" id="4560674">*</span><span class="ident" id="4560675">big</span><span class="op" id="4560678">.</span><span class="ident" id="4560679">Int</span><span class="op" id="4560682">)</span>&nbsp;<span class="op" id="4560684">(</span><span class="ident" id="4560685">x</span><span class="op" id="4560686">,</span>&nbsp;<span class="ident" id="4560688">y</span>&nbsp;<span class="op" id="4560690">*</span><span class="ident" id="4560691">big</span><span class="op" id="4560694">.</span><span class="ident" id="4560695">Int</span><span class="op" id="4560698">)</span>&nbsp;<span class="op" id="4560700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560703">var</span>&nbsp;<span class="ident" id="4560707">x1</span><span class="op" id="4560709">,</span>&nbsp;<span class="ident" id="4560711">y1</span><span class="op" id="4560713">,</span>&nbsp;<span class="ident" id="4560715">z1</span><span class="op" id="4560717">,</span>&nbsp;<span class="ident" id="4560719">x2</span><span class="op" id="4560721">,</span>&nbsp;<span class="ident" id="4560723">y2</span><span class="op" id="4560725">,</span>&nbsp;<span class="ident" id="4560727">z2</span>&nbsp;<span class="ident" id="4560730">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560749">p224FromBig</span><span class="op" id="4560760">(</span><span class="op" id="4560761">&amp;</span><span class="ident" id="4560762">x1</span><span class="op" id="4560764">,</span>&nbsp;<span class="ident" id="4560766">bigX1</span><span class="op" id="4560771">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560774">p224FromBig</span><span class="op" id="4560785">(</span><span class="op" id="4560786">&amp;</span><span class="ident" id="4560787">y1</span><span class="op" id="4560789">,</span>&nbsp;<span class="ident" id="4560791">bigY1</span><span class="op" id="4560796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560799">z1</span><span class="op" id="4560801">[</span><span class="num" id="4560802">0</span><span class="op" id="4560803">]</span>&nbsp;<span class="op" id="4560805">=</span>&nbsp;<span class="num" id="4560807">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4560811">p224DoubleJacobian</span><span class="op" id="4560829">(</span><span class="op" id="4560830">&amp;</span><span class="ident" id="4560831">x2</span><span class="op" id="4560833">,</span>&nbsp;<span class="op" id="4560835">&amp;</span><span class="ident" id="4560836">y2</span><span class="op" id="4560838">,</span>&nbsp;<span class="op" id="4560840">&amp;</span><span class="ident" id="4560841">z2</span><span class="op" id="4560843">,</span>&nbsp;<span class="op" id="4560845">&amp;</span><span class="ident" id="4560846">x1</span><span class="op" id="4560848">,</span>&nbsp;<span class="op" id="4560850">&amp;</span><span class="ident" id="4560851">y1</span><span class="op" id="4560853">,</span>&nbsp;<span class="op" id="4560855">&amp;</span><span class="ident" id="4560856">z1</span><span class="op" id="4560858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560861">return</span>&nbsp;<span class="ident" id="4560868">p224ToAffine</span><span class="op" id="4560880">(</span><span class="op" id="4560881">&amp;</span><span class="ident" id="4560882">x2</span><span class="op" id="4560884">,</span>&nbsp;<span class="op" id="4560886">&amp;</span><span class="ident" id="4560887">y2</span><span class="op" id="4560889">,</span>&nbsp;<span class="op" id="4560891">&amp;</span><span class="ident" id="4560892">z2</span><span class="op" id="4560894">)</span><br>
<span class="lineno">105</span><span class="op" id="4560896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4560899">func</span>&nbsp;<span class="op" id="4560904">(</span><span class="ident" id="4560905">p224Curve</span><span class="op" id="4560914">)</span>&nbsp;<span class="ident" id="4560916">ScalarMult</span><span class="op" id="4560926">(</span><span class="ident" id="4560927">bigX1</span><span class="op" id="4560932">,</span>&nbsp;<span class="ident" id="4560934">bigY1</span>&nbsp;<span class="op" id="4560940">*</span><span class="ident" id="4560941">big</span><span class="op" id="4560944">.</span><span class="ident" id="4560945">Int</span><span class="op" id="4560948">,</span>&nbsp;<span class="ident" id="4560950">scalar</span>&nbsp;<span class="op" id="4560957">[</span><span class="op" id="4560958">]</span><span class="builtintype" id="4560959">byte</span><span class="op" id="4560963">)</span>&nbsp;<span class="op" id="4560965">(</span><span class="ident" id="4560966">x</span><span class="op" id="4560967">,</span>&nbsp;<span class="ident" id="4560969">y</span>&nbsp;<span class="op" id="4560971">*</span><span class="ident" id="4560972">big</span><span class="op" id="4560975">.</span><span class="ident" id="4560976">Int</span><span class="op" id="4560979">)</span>&nbsp;<span class="op" id="4560981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4560984">var</span>&nbsp;<span class="ident" id="4560988">x1</span><span class="op" id="4560990">,</span>&nbsp;<span class="ident" id="4560992">y1</span><span class="op" id="4560994">,</span>&nbsp;<span class="ident" id="4560996">z1</span><span class="op" id="4560998">,</span>&nbsp;<span class="ident" id="4561000">x2</span><span class="op" id="4561002">,</span>&nbsp;<span class="ident" id="4561004">y2</span><span class="op" id="4561006">,</span>&nbsp;<span class="ident" id="4561008">z2</span>&nbsp;<span class="ident" id="4561011">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561030">p224FromBig</span><span class="op" id="4561041">(</span><span class="op" id="4561042">&amp;</span><span class="ident" id="4561043">x1</span><span class="op" id="4561045">,</span>&nbsp;<span class="ident" id="4561047">bigX1</span><span class="op" id="4561052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561055">p224FromBig</span><span class="op" id="4561066">(</span><span class="op" id="4561067">&amp;</span><span class="ident" id="4561068">y1</span><span class="op" id="4561070">,</span>&nbsp;<span class="ident" id="4561072">bigY1</span><span class="op" id="4561077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561080">z1</span><span class="op" id="4561082">[</span><span class="num" id="4561083">0</span><span class="op" id="4561084">]</span>&nbsp;<span class="op" id="4561086">=</span>&nbsp;<span class="num" id="4561088">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561092">p224ScalarMult</span><span class="op" id="4561106">(</span><span class="op" id="4561107">&amp;</span><span class="ident" id="4561108">x2</span><span class="op" id="4561110">,</span>&nbsp;<span class="op" id="4561112">&amp;</span><span class="ident" id="4561113">y2</span><span class="op" id="4561115">,</span>&nbsp;<span class="op" id="4561117">&amp;</span><span class="ident" id="4561118">z2</span><span class="op" id="4561120">,</span>&nbsp;<span class="op" id="4561122">&amp;</span><span class="ident" id="4561123">x1</span><span class="op" id="4561125">,</span>&nbsp;<span class="op" id="4561127">&amp;</span><span class="ident" id="4561128">y1</span><span class="op" id="4561130">,</span>&nbsp;<span class="op" id="4561132">&amp;</span><span class="ident" id="4561133">z1</span><span class="op" id="4561135">,</span>&nbsp;<span class="ident" id="4561137">scalar</span><span class="op" id="4561143">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561146">return</span>&nbsp;<span class="ident" id="4561153">p224ToAffine</span><span class="op" id="4561165">(</span><span class="op" id="4561166">&amp;</span><span class="ident" id="4561167">x2</span><span class="op" id="4561169">,</span>&nbsp;<span class="op" id="4561171">&amp;</span><span class="ident" id="4561172">y2</span><span class="op" id="4561174">,</span>&nbsp;<span class="op" id="4561176">&amp;</span><span class="ident" id="4561177">z2</span><span class="op" id="4561179">)</span><br>
<span class="lineno"></span><span class="op" id="4561181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4561184">func</span>&nbsp;<span class="op" id="4561189">(</span><span class="ident" id="4561190">curve</span>&nbsp;<span class="ident" id="4561196">p224Curve</span><span class="op" id="4561205">)</span>&nbsp;<span class="ident" id="4561207">ScalarBaseMult</span><span class="op" id="4561221">(</span><span class="ident" id="4561222">scalar</span>&nbsp;<span class="op" id="4561229">[</span><span class="op" id="4561230">]</span><span class="builtintype" id="4561231">byte</span><span class="op" id="4561235">)</span>&nbsp;<span class="op" id="4561237">(</span><span class="ident" id="4561238">x</span><span class="op" id="4561239">,</span>&nbsp;<span class="ident" id="4561241">y</span>&nbsp;<span class="op" id="4561243">*</span><span class="ident" id="4561244">big</span><span class="op" id="4561247">.</span><span class="ident" id="4561248">Int</span><span class="op" id="4561251">)</span>&nbsp;<span class="op" id="4561253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561256">var</span>&nbsp;<span class="ident" id="4561260">z1</span><span class="op" id="4561262">,</span>&nbsp;<span class="ident" id="4561264">x2</span><span class="op" id="4561266">,</span>&nbsp;<span class="ident" id="4561268">y2</span><span class="op" id="4561270">,</span>&nbsp;<span class="ident" id="4561272">z2</span>&nbsp;<span class="ident" id="4561275">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561294">z1</span><span class="op" id="4561296">[</span><span class="num" id="4561297">0</span><span class="op" id="4561298">]</span>&nbsp;<span class="op" id="4561300">=</span>&nbsp;<span class="num" id="4561302">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4561305">p224ScalarMult</span><span class="op" id="4561319">(</span><span class="op" id="4561320">&amp;</span><span class="ident" id="4561321">x2</span><span class="op" id="4561323">,</span>&nbsp;<span class="op" id="4561325">&amp;</span><span class="ident" id="4561326">y2</span><span class="op" id="4561328">,</span>&nbsp;<span class="op" id="4561330">&amp;</span><span class="ident" id="4561331">z2</span><span class="op" id="4561333">,</span>&nbsp;<span class="op" id="4561335">&amp;</span><span class="ident" id="4561336">curve</span><span class="op" id="4561341">.</span><span class="ident" id="4561342">gx</span><span class="op" id="4561344">,</span>&nbsp;<span class="op" id="4561346">&amp;</span><span class="ident" id="4561347">curve</span><span class="op" id="4561352">.</span><span class="ident" id="4561353">gy</span><span class="op" id="4561355">,</span>&nbsp;<span class="op" id="4561357">&amp;</span><span class="ident" id="4561358">z1</span><span class="op" id="4561360">,</span>&nbsp;<span class="ident" id="4561362">scalar</span><span class="op" id="4561368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4561371">return</span>&nbsp;<span class="ident" id="4561378">p224ToAffine</span><span class="op" id="4561390">(</span><span class="op" id="4561391">&amp;</span><span class="ident" id="4561392">x2</span><span class="op" id="4561394">,</span>&nbsp;<span class="op" id="4561396">&amp;</span><span class="ident" id="4561397">y2</span><span class="op" id="4561399">,</span>&nbsp;<span class="op" id="4561401">&amp;</span><span class="ident" id="4561402">z2</span><span class="op" id="4561404">)</span><br>
<span class="lineno"></span><span class="op" id="4561406">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4561409">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4561437">//</span><br>
<span class="lineno"></span><span class="comment" id="4561440">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4561519">//</span><br>
<span class="lineno">130</span><span class="comment" id="4561522">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4561600">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4561660">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4561719">//</span><br>
<span class="lineno"></span><span class="comment" id="4561722">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4561802">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4561881">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4561944">type</span>&nbsp;<span class="ident" id="4561949">p224FieldElement</span>&nbsp;<span class="op" id="4561966">[</span><span class="num" id="4561967">8</span><span class="op" id="4561968">]</span><span class="builtintype" id="4561969">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4561977">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4562048">var</span>&nbsp;<span class="ident" id="4562052">p224P</span>&nbsp;<span class="op" id="4562058">=</span>&nbsp;<span class="op" id="4562060">[</span><span class="num" id="4562061">8</span><span class="op" id="4562062">]</span><span class="builtintype" id="4562063">uint32</span><span class="op" id="4562069">{</span><span class="num" id="4562070">1</span><span class="op" id="4562071">,</span>&nbsp;<span class="num" id="4562073">0</span><span class="op" id="4562074">,</span>&nbsp;<span class="num" id="4562076">0</span><span class="op" id="4562077">,</span>&nbsp;<span class="num" id="4562079">0xffff000</span><span class="op" id="4562088">,</span>&nbsp;<span class="num" id="4562090">0xfffffff</span><span class="op" id="4562099">,</span>&nbsp;<span class="num" id="4562101">0xfffffff</span><span class="op" id="4562110">,</span>&nbsp;<span class="num" id="4562112">0xfffffff</span><span class="op" id="4562121">,</span>&nbsp;<span class="num" id="4562123">0xfffffff</span><span class="op" id="4562132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4562135">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4562192">//</span><br>
<span class="lineno"></span><span class="comment" id="4562195">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4562211">func</span>&nbsp;<span class="ident" id="4562216">p224IsZero</span><span class="op" id="4562226">(</span><span class="ident" id="4562227">a</span>&nbsp;<span class="op" id="4562229">*</span><span class="ident" id="4562230">p224FieldElement</span><span class="op" id="4562246">)</span>&nbsp;<span class="builtintype" id="4562248">uint32</span>&nbsp;<span class="op" id="4562255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4562258">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4562328">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562363">var</span>&nbsp;<span class="ident" id="4562367">minimal</span>&nbsp;<span class="ident" id="4562375">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562393">p224Contract</span><span class="op" id="4562405">(</span><span class="op" id="4562406">&amp;</span><span class="ident" id="4562407">minimal</span><span class="op" id="4562414">,</span>&nbsp;<span class="ident" id="4562416">a</span><span class="op" id="4562417">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562421">var</span>&nbsp;<span class="ident" id="4562425">isZero</span><span class="op" id="4562431">,</span>&nbsp;<span class="ident" id="4562433">isP</span>&nbsp;<span class="builtintype" id="4562437">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562445">for</span>&nbsp;<span class="ident" id="4562449">i</span><span class="op" id="4562450">,</span>&nbsp;<span class="ident" id="4562452">v</span>&nbsp;<span class="op" id="4562454">:=</span>&nbsp;<span class="keyword" id="4562457">range</span>&nbsp;<span class="ident" id="4562463">minimal</span>&nbsp;<span class="op" id="4562471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562475">isZero</span>&nbsp;<span class="op" id="4562482">|=</span>&nbsp;<span class="ident" id="4562485">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562489">isP</span>&nbsp;<span class="op" id="4562493">|=</span>&nbsp;<span class="ident" id="4562496">v</span>&nbsp;<span class="op" id="4562498">-</span>&nbsp;<span class="ident" id="4562500">p224P</span><span class="op" id="4562505">[</span><span class="ident" id="4562506">i</span><span class="op" id="4562507">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4562510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4562514">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562573">isZero</span>&nbsp;<span class="op" id="4562580">|=</span>&nbsp;<span class="ident" id="4562583">isZero</span>&nbsp;<span class="op" id="4562590">&gt;&gt;</span>&nbsp;<span class="num" id="4562593">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562597">isZero</span>&nbsp;<span class="op" id="4562604">|=</span>&nbsp;<span class="ident" id="4562607">isZero</span>&nbsp;<span class="op" id="4562614">&gt;&gt;</span>&nbsp;<span class="num" id="4562617">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562620">isZero</span>&nbsp;<span class="op" id="4562627">|=</span>&nbsp;<span class="ident" id="4562630">isZero</span>&nbsp;<span class="op" id="4562637">&gt;&gt;</span>&nbsp;<span class="num" id="4562640">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562643">isZero</span>&nbsp;<span class="op" id="4562650">|=</span>&nbsp;<span class="ident" id="4562653">isZero</span>&nbsp;<span class="op" id="4562660">&gt;&gt;</span>&nbsp;<span class="num" id="4562663">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562666">isZero</span>&nbsp;<span class="op" id="4562673">|=</span>&nbsp;<span class="ident" id="4562676">isZero</span>&nbsp;<span class="op" id="4562683">&gt;&gt;</span>&nbsp;<span class="num" id="4562686">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562690">isP</span>&nbsp;<span class="op" id="4562694">|=</span>&nbsp;<span class="ident" id="4562697">isP</span>&nbsp;<span class="op" id="4562701">&gt;&gt;</span>&nbsp;<span class="num" id="4562704">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562708">isP</span>&nbsp;<span class="op" id="4562712">|=</span>&nbsp;<span class="ident" id="4562715">isP</span>&nbsp;<span class="op" id="4562719">&gt;&gt;</span>&nbsp;<span class="num" id="4562722">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562725">isP</span>&nbsp;<span class="op" id="4562729">|=</span>&nbsp;<span class="ident" id="4562732">isP</span>&nbsp;<span class="op" id="4562736">&gt;&gt;</span>&nbsp;<span class="num" id="4562739">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562742">isP</span>&nbsp;<span class="op" id="4562746">|=</span>&nbsp;<span class="ident" id="4562749">isP</span>&nbsp;<span class="op" id="4562753">&gt;&gt;</span>&nbsp;<span class="num" id="4562756">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562759">isP</span>&nbsp;<span class="op" id="4562763">|=</span>&nbsp;<span class="ident" id="4562766">isP</span>&nbsp;<span class="op" id="4562770">&gt;&gt;</span>&nbsp;<span class="num" id="4562773">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4562777">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562841">result</span>&nbsp;<span class="op" id="4562848">:=</span>&nbsp;<span class="ident" id="4562851">isZero</span>&nbsp;<span class="op" id="4562858">&amp;</span>&nbsp;<span class="ident" id="4562860">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4562865">result</span>&nbsp;<span class="op" id="4562872">=</span>&nbsp;<span class="op" id="4562874">(</span><span class="op" id="4562875">^</span><span class="ident" id="4562876">result</span><span class="op" id="4562882">)</span>&nbsp;<span class="op" id="4562884">&amp;</span>&nbsp;<span class="num" id="4562886">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4562890">return</span>&nbsp;<span class="ident" id="4562897">result</span><br>
<span class="lineno">175</span><span class="op" id="4562904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4562907">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4562938">//</span><br>
<span class="lineno"></span><span class="comment" id="4562941">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4562964">func</span>&nbsp;<span class="ident" id="4562969">p224Add</span><span class="op" id="4562976">(</span><span class="ident" id="4562977">out</span><span class="op" id="4562980">,</span>&nbsp;<span class="ident" id="4562982">a</span><span class="op" id="4562983">,</span>&nbsp;<span class="ident" id="4562985">b</span>&nbsp;<span class="op" id="4562987">*</span><span class="ident" id="4562988">p224FieldElement</span><span class="op" id="4563004">)</span>&nbsp;<span class="op" id="4563006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563009">for</span>&nbsp;<span class="ident" id="4563013">i</span>&nbsp;<span class="op" id="4563015">:=</span>&nbsp;<span class="num" id="4563018">0</span><span class="op" id="4563019">;</span>&nbsp;<span class="ident" id="4563021">i</span>&nbsp;<span class="op" id="4563023">&lt;</span>&nbsp;<span class="num" id="4563025">8</span><span class="op" id="4563026">;</span>&nbsp;<span class="ident" id="4563028">i</span><span class="op" id="4563029">++</span>&nbsp;<span class="op" id="4563032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563036">out</span><span class="op" id="4563039">[</span><span class="ident" id="4563040">i</span><span class="op" id="4563041">]</span>&nbsp;<span class="op" id="4563043">=</span>&nbsp;<span class="ident" id="4563045">a</span><span class="op" id="4563046">[</span><span class="ident" id="4563047">i</span><span class="op" id="4563048">]</span>&nbsp;<span class="op" id="4563050">+</span>&nbsp;<span class="ident" id="4563052">b</span><span class="op" id="4563053">[</span><span class="ident" id="4563054">i</span><span class="op" id="4563055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563058">}</span><br>
<span class="lineno"></span><span class="op" id="4563060">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4563063">const</span>&nbsp;<span class="ident" id="4563069">two31p3</span>&nbsp;<span class="op" id="4563077">=</span>&nbsp;<span class="num" id="4563079">1</span><span class="op" id="4563080">&lt;&lt;</span><span class="num" id="4563082">31</span>&nbsp;<span class="op" id="4563085">+</span>&nbsp;<span class="num" id="4563087">1</span><span class="op" id="4563088">&lt;&lt;</span><span class="num" id="4563090">3</span><br>
<span class="lineno"></span><span class="keyword" id="4563092">const</span>&nbsp;<span class="ident" id="4563098">two31m3</span>&nbsp;<span class="op" id="4563106">=</span>&nbsp;<span class="num" id="4563108">1</span><span class="op" id="4563109">&lt;&lt;</span><span class="num" id="4563111">31</span>&nbsp;<span class="op" id="4563114">-</span>&nbsp;<span class="num" id="4563116">1</span><span class="op" id="4563117">&lt;&lt;</span><span class="num" id="4563119">3</span><br>
<span class="lineno"></span><span class="keyword" id="4563121">const</span>&nbsp;<span class="ident" id="4563127">two31m15m3</span>&nbsp;<span class="op" id="4563138">=</span>&nbsp;<span class="num" id="4563140">1</span><span class="op" id="4563141">&lt;&lt;</span><span class="num" id="4563143">31</span>&nbsp;<span class="op" id="4563146">-</span>&nbsp;<span class="num" id="4563148">1</span><span class="op" id="4563149">&lt;&lt;</span><span class="num" id="4563151">15</span>&nbsp;<span class="op" id="4563154">-</span>&nbsp;<span class="num" id="4563156">1</span><span class="op" id="4563157">&lt;&lt;</span><span class="num" id="4563159">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4563162">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4563239">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4563319">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4563341">var</span>&nbsp;<span class="ident" id="4563345">p224ZeroModP31</span>&nbsp;<span class="op" id="4563360">=</span>&nbsp;<span class="op" id="4563362">[</span><span class="op" id="4563363">]</span><span class="builtintype" id="4563364">uint32</span><span class="op" id="4563370">{</span><span class="ident" id="4563371">two31p3</span><span class="op" id="4563378">,</span>&nbsp;<span class="ident" id="4563380">two31m3</span><span class="op" id="4563387">,</span>&nbsp;<span class="ident" id="4563389">two31m3</span><span class="op" id="4563396">,</span>&nbsp;<span class="ident" id="4563398">two31m15m3</span><span class="op" id="4563408">,</span>&nbsp;<span class="ident" id="4563410">two31m3</span><span class="op" id="4563417">,</span>&nbsp;<span class="ident" id="4563419">two31m3</span><span class="op" id="4563426">,</span>&nbsp;<span class="ident" id="4563428">two31m3</span><span class="op" id="4563435">,</span>&nbsp;<span class="ident" id="4563437">two31m3</span><span class="op" id="4563444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4563447">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4563478">//</span><br>
<span class="lineno"></span><span class="comment" id="4563481">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4563503">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4563521">func</span>&nbsp;<span class="ident" id="4563526">p224Sub</span><span class="op" id="4563533">(</span><span class="ident" id="4563534">out</span><span class="op" id="4563537">,</span>&nbsp;<span class="ident" id="4563539">a</span><span class="op" id="4563540">,</span>&nbsp;<span class="ident" id="4563542">b</span>&nbsp;<span class="op" id="4563544">*</span><span class="ident" id="4563545">p224FieldElement</span><span class="op" id="4563561">)</span>&nbsp;<span class="op" id="4563563">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4563566">for</span>&nbsp;<span class="ident" id="4563570">i</span>&nbsp;<span class="op" id="4563572">:=</span>&nbsp;<span class="num" id="4563575">0</span><span class="op" id="4563576">;</span>&nbsp;<span class="ident" id="4563578">i</span>&nbsp;<span class="op" id="4563580">&lt;</span>&nbsp;<span class="num" id="4563582">8</span><span class="op" id="4563583">;</span>&nbsp;<span class="ident" id="4563585">i</span><span class="op" id="4563586">++</span>&nbsp;<span class="op" id="4563589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4563593">out</span><span class="op" id="4563596">[</span><span class="ident" id="4563597">i</span><span class="op" id="4563598">]</span>&nbsp;<span class="op" id="4563600">=</span>&nbsp;<span class="ident" id="4563602">a</span><span class="op" id="4563603">[</span><span class="ident" id="4563604">i</span><span class="op" id="4563605">]</span>&nbsp;<span class="op" id="4563607">+</span>&nbsp;<span class="ident" id="4563609">p224ZeroModP31</span><span class="op" id="4563623">[</span><span class="ident" id="4563624">i</span><span class="op" id="4563625">]</span>&nbsp;<span class="op" id="4563627">-</span>&nbsp;<span class="ident" id="4563629">b</span><span class="op" id="4563630">[</span><span class="ident" id="4563631">i</span><span class="op" id="4563632">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4563635">}</span><br>
<span class="lineno"></span><span class="op" id="4563637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4563640">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4563716">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4563794">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4563842">type</span>&nbsp;<span class="ident" id="4563847">p224LargeFieldElement</span>&nbsp;<span class="op" id="4563869">[</span><span class="num" id="4563870">15</span><span class="op" id="4563872">]</span><span class="builtintype" id="4563873">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4563881">const</span>&nbsp;<span class="ident" id="4563887">two63p35</span>&nbsp;<span class="op" id="4563896">=</span>&nbsp;<span class="num" id="4563898">1</span><span class="op" id="4563899">&lt;&lt;</span><span class="num" id="4563901">63</span>&nbsp;<span class="op" id="4563904">+</span>&nbsp;<span class="num" id="4563906">1</span><span class="op" id="4563907">&lt;&lt;</span><span class="num" id="4563909">35</span><br>
<span class="lineno"></span><span class="keyword" id="4563912">const</span>&nbsp;<span class="ident" id="4563918">two63m35</span>&nbsp;<span class="op" id="4563927">=</span>&nbsp;<span class="num" id="4563929">1</span><span class="op" id="4563930">&lt;&lt;</span><span class="num" id="4563932">63</span>&nbsp;<span class="op" id="4563935">-</span>&nbsp;<span class="num" id="4563937">1</span><span class="op" id="4563938">&lt;&lt;</span><span class="num" id="4563940">35</span><br>
<span class="lineno"></span><span class="keyword" id="4563943">const</span>&nbsp;<span class="ident" id="4563949">two63m35m19</span>&nbsp;<span class="op" id="4563961">=</span>&nbsp;<span class="num" id="4563963">1</span><span class="op" id="4563964">&lt;&lt;</span><span class="num" id="4563966">63</span>&nbsp;<span class="op" id="4563969">-</span>&nbsp;<span class="num" id="4563971">1</span><span class="op" id="4563972">&lt;&lt;</span><span class="num" id="4563974">35</span>&nbsp;<span class="op" id="4563977">-</span>&nbsp;<span class="num" id="4563979">1</span><span class="op" id="4563980">&lt;&lt;</span><span class="num" id="4563982">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4563986">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4564065">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4564098">var</span>&nbsp;<span class="ident" id="4564102">p224ZeroModP63</span>&nbsp;<span class="op" id="4564117">=</span>&nbsp;<span class="op" id="4564119">[</span><span class="num" id="4564120">8</span><span class="op" id="4564121">]</span><span class="builtintype" id="4564122">uint64</span><span class="op" id="4564128">{</span><span class="ident" id="4564129">two63p35</span><span class="op" id="4564137">,</span>&nbsp;<span class="ident" id="4564139">two63m35</span><span class="op" id="4564147">,</span>&nbsp;<span class="ident" id="4564149">two63m35</span><span class="op" id="4564157">,</span>&nbsp;<span class="ident" id="4564159">two63m35</span><span class="op" id="4564167">,</span>&nbsp;<span class="ident" id="4564169">two63m35m19</span><span class="op" id="4564180">,</span>&nbsp;<span class="ident" id="4564182">two63m35</span><span class="op" id="4564190">,</span>&nbsp;<span class="ident" id="4564192">two63m35</span><span class="op" id="4564200">,</span>&nbsp;<span class="ident" id="4564202">two63m35</span><span class="op" id="4564210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4564213">const</span>&nbsp;<span class="ident" id="4564219">bottom12Bits</span>&nbsp;<span class="op" id="4564232">=</span>&nbsp;<span class="num" id="4564234">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4564240">const</span>&nbsp;<span class="ident" id="4564246">bottom28Bits</span>&nbsp;<span class="op" id="4564259">=</span>&nbsp;<span class="num" id="4564261">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4564272">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4564303">//</span><br>
<span class="lineno"></span><span class="comment" id="4564306">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4564352">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4564370">func</span>&nbsp;<span class="ident" id="4564375">p224Mul</span><span class="op" id="4564382">(</span><span class="ident" id="4564383">out</span><span class="op" id="4564386">,</span>&nbsp;<span class="ident" id="4564388">a</span><span class="op" id="4564389">,</span>&nbsp;<span class="ident" id="4564391">b</span>&nbsp;<span class="op" id="4564393">*</span><span class="ident" id="4564394">p224FieldElement</span><span class="op" id="4564410">,</span>&nbsp;<span class="ident" id="4564412">tmp</span>&nbsp;<span class="op" id="4564416">*</span><span class="ident" id="4564417">p224LargeFieldElement</span><span class="op" id="4564438">)</span>&nbsp;<span class="op" id="4564440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564443">for</span>&nbsp;<span class="ident" id="4564447">i</span>&nbsp;<span class="op" id="4564449">:=</span>&nbsp;<span class="num" id="4564452">0</span><span class="op" id="4564453">;</span>&nbsp;<span class="ident" id="4564455">i</span>&nbsp;<span class="op" id="4564457">&lt;</span>&nbsp;<span class="num" id="4564459">15</span><span class="op" id="4564461">;</span>&nbsp;<span class="ident" id="4564463">i</span><span class="op" id="4564464">++</span>&nbsp;<span class="op" id="4564467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564471">tmp</span><span class="op" id="4564474">[</span><span class="ident" id="4564475">i</span><span class="op" id="4564476">]</span>&nbsp;<span class="op" id="4564478">=</span>&nbsp;<span class="num" id="4564480">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564487">for</span>&nbsp;<span class="ident" id="4564491">i</span>&nbsp;<span class="op" id="4564493">:=</span>&nbsp;<span class="num" id="4564496">0</span><span class="op" id="4564497">;</span>&nbsp;<span class="ident" id="4564499">i</span>&nbsp;<span class="op" id="4564501">&lt;</span>&nbsp;<span class="num" id="4564503">8</span><span class="op" id="4564504">;</span>&nbsp;<span class="ident" id="4564506">i</span><span class="op" id="4564507">++</span>&nbsp;<span class="op" id="4564510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564514">for</span>&nbsp;<span class="ident" id="4564518">j</span>&nbsp;<span class="op" id="4564520">:=</span>&nbsp;<span class="num" id="4564523">0</span><span class="op" id="4564524">;</span>&nbsp;<span class="ident" id="4564526">j</span>&nbsp;<span class="op" id="4564528">&lt;</span>&nbsp;<span class="num" id="4564530">8</span><span class="op" id="4564531">;</span>&nbsp;<span class="ident" id="4564533">j</span><span class="op" id="4564534">++</span>&nbsp;<span class="op" id="4564537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564542">tmp</span><span class="op" id="4564545">[</span><span class="ident" id="4564546">i</span><span class="op" id="4564547">+</span><span class="ident" id="4564548">j</span><span class="op" id="4564549">]</span>&nbsp;<span class="op" id="4564551">+=</span>&nbsp;<span class="builtintype" id="4564554">uint64</span><span class="op" id="4564560">(</span><span class="ident" id="4564561">a</span><span class="op" id="4564562">[</span><span class="ident" id="4564563">i</span><span class="op" id="4564564">]</span><span class="op" id="4564565">)</span>&nbsp;<span class="op" id="4564567">*</span>&nbsp;<span class="builtintype" id="4564569">uint64</span><span class="op" id="4564575">(</span><span class="ident" id="4564576">b</span><span class="op" id="4564577">[</span><span class="ident" id="4564578">j</span><span class="op" id="4564579">]</span><span class="op" id="4564580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564587">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564591">p224ReduceLarge</span><span class="op" id="4564606">(</span><span class="ident" id="4564607">out</span><span class="op" id="4564610">,</span>&nbsp;<span class="ident" id="4564612">tmp</span><span class="op" id="4564615">)</span><br>
<span class="lineno"></span><span class="op" id="4564617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4564620">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4564650">//</span><br>
<span class="lineno"></span><span class="comment" id="4564653">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4564669">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4564687">func</span>&nbsp;<span class="ident" id="4564692">p224Square</span><span class="op" id="4564702">(</span><span class="ident" id="4564703">out</span><span class="op" id="4564706">,</span>&nbsp;<span class="ident" id="4564708">a</span>&nbsp;<span class="op" id="4564710">*</span><span class="ident" id="4564711">p224FieldElement</span><span class="op" id="4564727">,</span>&nbsp;<span class="ident" id="4564729">tmp</span>&nbsp;<span class="op" id="4564733">*</span><span class="ident" id="4564734">p224LargeFieldElement</span><span class="op" id="4564755">)</span>&nbsp;<span class="op" id="4564757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564760">for</span>&nbsp;<span class="ident" id="4564764">i</span>&nbsp;<span class="op" id="4564766">:=</span>&nbsp;<span class="num" id="4564769">0</span><span class="op" id="4564770">;</span>&nbsp;<span class="ident" id="4564772">i</span>&nbsp;<span class="op" id="4564774">&lt;</span>&nbsp;<span class="num" id="4564776">15</span><span class="op" id="4564778">;</span>&nbsp;<span class="ident" id="4564780">i</span><span class="op" id="4564781">++</span>&nbsp;<span class="op" id="4564784">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564788">tmp</span><span class="op" id="4564791">[</span><span class="ident" id="4564792">i</span><span class="op" id="4564793">]</span>&nbsp;<span class="op" id="4564795">=</span>&nbsp;<span class="num" id="4564797">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564804">for</span>&nbsp;<span class="ident" id="4564808">i</span>&nbsp;<span class="op" id="4564810">:=</span>&nbsp;<span class="num" id="4564813">0</span><span class="op" id="4564814">;</span>&nbsp;<span class="ident" id="4564816">i</span>&nbsp;<span class="op" id="4564818">&lt;</span>&nbsp;<span class="num" id="4564820">8</span><span class="op" id="4564821">;</span>&nbsp;<span class="ident" id="4564823">i</span><span class="op" id="4564824">++</span>&nbsp;<span class="op" id="4564827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564831">for</span>&nbsp;<span class="ident" id="4564835">j</span>&nbsp;<span class="op" id="4564837">:=</span>&nbsp;<span class="num" id="4564840">0</span><span class="op" id="4564841">;</span>&nbsp;<span class="ident" id="4564843">j</span>&nbsp;<span class="op" id="4564845">&lt;=</span>&nbsp;<span class="ident" id="4564848">i</span><span class="op" id="4564849">;</span>&nbsp;<span class="ident" id="4564851">j</span><span class="op" id="4564852">++</span>&nbsp;<span class="op" id="4564855">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564860">r</span>&nbsp;<span class="op" id="4564862">:=</span>&nbsp;<span class="builtintype" id="4564865">uint64</span><span class="op" id="4564871">(</span><span class="ident" id="4564872">a</span><span class="op" id="4564873">[</span><span class="ident" id="4564874">i</span><span class="op" id="4564875">]</span><span class="op" id="4564876">)</span>&nbsp;<span class="op" id="4564878">*</span>&nbsp;<span class="builtintype" id="4564880">uint64</span><span class="op" id="4564886">(</span><span class="ident" id="4564887">a</span><span class="op" id="4564888">[</span><span class="ident" id="4564889">j</span><span class="op" id="4564890">]</span><span class="op" id="4564891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4564896">if</span>&nbsp;<span class="ident" id="4564899">i</span>&nbsp;<span class="op" id="4564901">==</span>&nbsp;<span class="ident" id="4564904">j</span>&nbsp;<span class="op" id="4564906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564912">tmp</span><span class="op" id="4564915">[</span><span class="ident" id="4564916">i</span><span class="op" id="4564917">+</span><span class="ident" id="4564918">j</span><span class="op" id="4564919">]</span>&nbsp;<span class="op" id="4564921">+=</span>&nbsp;<span class="ident" id="4564924">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564929">}</span>&nbsp;<span class="keyword" id="4564931">else</span>&nbsp;<span class="op" id="4564936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564942">tmp</span><span class="op" id="4564945">[</span><span class="ident" id="4564946">i</span><span class="op" id="4564947">+</span><span class="ident" id="4564948">j</span><span class="op" id="4564949">]</span>&nbsp;<span class="op" id="4564951">+=</span>&nbsp;<span class="ident" id="4564954">r</span>&nbsp;<span class="op" id="4564956">&lt;&lt;</span>&nbsp;<span class="num" id="4564959">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4564971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4564975">p224ReduceLarge</span><span class="op" id="4564990">(</span><span class="ident" id="4564991">out</span><span class="op" id="4564994">,</span>&nbsp;<span class="ident" id="4564996">tmp</span><span class="op" id="4564999">)</span><br>
<span class="lineno">260</span><span class="op" id="4565001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4565004">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4565075">//</span><br>
<span class="lineno"></span><span class="comment" id="4565078">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4565095">func</span>&nbsp;<span class="ident" id="4565100">p224ReduceLarge</span><span class="op" id="4565115">(</span><span class="ident" id="4565116">out</span>&nbsp;<span class="op" id="4565120">*</span><span class="ident" id="4565121">p224FieldElement</span><span class="op" id="4565137">,</span>&nbsp;<span class="ident" id="4565139">in</span>&nbsp;<span class="op" id="4565142">*</span><span class="ident" id="4565143">p224LargeFieldElement</span><span class="op" id="4565164">)</span>&nbsp;<span class="op" id="4565166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565169">for</span>&nbsp;<span class="ident" id="4565173">i</span>&nbsp;<span class="op" id="4565175">:=</span>&nbsp;<span class="num" id="4565178">0</span><span class="op" id="4565179">;</span>&nbsp;<span class="ident" id="4565181">i</span>&nbsp;<span class="op" id="4565183">&lt;</span>&nbsp;<span class="num" id="4565185">8</span><span class="op" id="4565186">;</span>&nbsp;<span class="ident" id="4565188">i</span><span class="op" id="4565189">++</span>&nbsp;<span class="op" id="4565192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565196">in</span><span class="op" id="4565198">[</span><span class="ident" id="4565199">i</span><span class="op" id="4565200">]</span>&nbsp;<span class="op" id="4565202">+=</span>&nbsp;<span class="ident" id="4565205">p224ZeroModP63</span><span class="op" id="4565219">[</span><span class="ident" id="4565220">i</span><span class="op" id="4565221">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565228">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565282">for</span>&nbsp;<span class="ident" id="4565286">i</span>&nbsp;<span class="op" id="4565288">:=</span>&nbsp;<span class="num" id="4565291">14</span><span class="op" id="4565293">;</span>&nbsp;<span class="ident" id="4565295">i</span>&nbsp;<span class="op" id="4565297">&gt;=</span>&nbsp;<span class="num" id="4565300">8</span><span class="op" id="4565301">;</span>&nbsp;<span class="ident" id="4565303">i</span><span class="op" id="4565304">--</span>&nbsp;<span class="op" id="4565307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565311">in</span><span class="op" id="4565313">[</span><span class="ident" id="4565314">i</span><span class="op" id="4565315">-</span><span class="num" id="4565316">8</span><span class="op" id="4565317">]</span>&nbsp;<span class="op" id="4565319">-=</span>&nbsp;<span class="ident" id="4565322">in</span><span class="op" id="4565324">[</span><span class="ident" id="4565325">i</span><span class="op" id="4565326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565330">in</span><span class="op" id="4565332">[</span><span class="ident" id="4565333">i</span><span class="op" id="4565334">-</span><span class="num" id="4565335">5</span><span class="op" id="4565336">]</span>&nbsp;<span class="op" id="4565338">+=</span>&nbsp;<span class="op" id="4565341">(</span><span class="ident" id="4565342">in</span><span class="op" id="4565344">[</span><span class="ident" id="4565345">i</span><span class="op" id="4565346">]</span>&nbsp;<span class="op" id="4565348">&amp;</span>&nbsp;<span class="num" id="4565350">0xffff</span><span class="op" id="4565356">)</span>&nbsp;<span class="op" id="4565358">&lt;&lt;</span>&nbsp;<span class="num" id="4565361">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565366">in</span><span class="op" id="4565368">[</span><span class="ident" id="4565369">i</span><span class="op" id="4565370">-</span><span class="num" id="4565371">4</span><span class="op" id="4565372">]</span>&nbsp;<span class="op" id="4565374">+=</span>&nbsp;<span class="ident" id="4565377">in</span><span class="op" id="4565379">[</span><span class="ident" id="4565380">i</span><span class="op" id="4565381">]</span>&nbsp;<span class="op" id="4565383">&gt;&gt;</span>&nbsp;<span class="num" id="4565386">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565393">in</span><span class="op" id="4565395">[</span><span class="num" id="4565396">8</span><span class="op" id="4565397">]</span>&nbsp;<span class="op" id="4565399">=</span>&nbsp;<span class="num" id="4565401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565404">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565426">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565497">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4565528">for</span>&nbsp;<span class="ident" id="4565532">i</span>&nbsp;<span class="op" id="4565534">:=</span>&nbsp;<span class="num" id="4565537">1</span><span class="op" id="4565538">;</span>&nbsp;<span class="ident" id="4565540">i</span>&nbsp;<span class="op" id="4565542">&lt;</span>&nbsp;<span class="num" id="4565544">8</span><span class="op" id="4565545">;</span>&nbsp;<span class="ident" id="4565547">i</span><span class="op" id="4565548">++</span>&nbsp;<span class="op" id="4565551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565555">in</span><span class="op" id="4565557">[</span><span class="ident" id="4565558">i</span><span class="op" id="4565559">+</span><span class="num" id="4565560">1</span><span class="op" id="4565561">]</span>&nbsp;<span class="op" id="4565563">+=</span>&nbsp;<span class="ident" id="4565566">in</span><span class="op" id="4565568">[</span><span class="ident" id="4565569">i</span><span class="op" id="4565570">]</span>&nbsp;<span class="op" id="4565572">&gt;&gt;</span>&nbsp;<span class="num" id="4565575">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565580">out</span><span class="op" id="4565583">[</span><span class="ident" id="4565584">i</span><span class="op" id="4565585">]</span>&nbsp;<span class="op" id="4565587">=</span>&nbsp;<span class="builtintype" id="4565589">uint32</span><span class="op" id="4565595">(</span><span class="ident" id="4565596">in</span><span class="op" id="4565598">[</span><span class="ident" id="4565599">i</span><span class="op" id="4565600">]</span>&nbsp;<span class="op" id="4565602">&amp;</span>&nbsp;<span class="ident" id="4565604">bottom28Bits</span><span class="op" id="4565616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4565619">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565622">in</span><span class="op" id="4565624">[</span><span class="num" id="4565625">0</span><span class="op" id="4565626">]</span>&nbsp;<span class="op" id="4565628">-=</span>&nbsp;<span class="ident" id="4565631">in</span><span class="op" id="4565633">[</span><span class="num" id="4565634">8</span><span class="op" id="4565635">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565638">out</span><span class="op" id="4565641">[</span><span class="num" id="4565642">3</span><span class="op" id="4565643">]</span>&nbsp;<span class="op" id="4565645">+=</span>&nbsp;<span class="builtintype" id="4565648">uint32</span><span class="op" id="4565654">(</span><span class="ident" id="4565655">in</span><span class="op" id="4565657">[</span><span class="num" id="4565658">8</span><span class="op" id="4565659">]</span><span class="op" id="4565660">&amp;</span><span class="num" id="4565661">0xffff</span><span class="op" id="4565667">)</span>&nbsp;<span class="op" id="4565669">&lt;&lt;</span>&nbsp;<span class="num" id="4565672">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565676">out</span><span class="op" id="4565679">[</span><span class="num" id="4565680">4</span><span class="op" id="4565681">]</span>&nbsp;<span class="op" id="4565683">+=</span>&nbsp;<span class="builtintype" id="4565686">uint32</span><span class="op" id="4565692">(</span><span class="ident" id="4565693">in</span><span class="op" id="4565695">[</span><span class="num" id="4565696">8</span><span class="op" id="4565697">]</span>&nbsp;<span class="op" id="4565699">&gt;&gt;</span>&nbsp;<span class="num" id="4565702">16</span><span class="op" id="4565704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565707">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565725">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565744">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565763">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565790">out</span><span class="op" id="4565793">[</span><span class="num" id="4565794">0</span><span class="op" id="4565795">]</span>&nbsp;<span class="op" id="4565797">=</span>&nbsp;<span class="builtintype" id="4565799">uint32</span><span class="op" id="4565805">(</span><span class="ident" id="4565806">in</span><span class="op" id="4565808">[</span><span class="num" id="4565809">0</span><span class="op" id="4565810">]</span>&nbsp;<span class="op" id="4565812">&amp;</span>&nbsp;<span class="ident" id="4565814">bottom28Bits</span><span class="op" id="4565826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565829">out</span><span class="op" id="4565832">[</span><span class="num" id="4565833">1</span><span class="op" id="4565834">]</span>&nbsp;<span class="op" id="4565836">+=</span>&nbsp;<span class="builtintype" id="4565839">uint32</span><span class="op" id="4565845">(</span><span class="op" id="4565846">(</span><span class="ident" id="4565847">in</span><span class="op" id="4565849">[</span><span class="num" id="4565850">0</span><span class="op" id="4565851">]</span>&nbsp;<span class="op" id="4565853">&gt;&gt;</span>&nbsp;<span class="num" id="4565856">28</span><span class="op" id="4565858">)</span>&nbsp;<span class="op" id="4565860">&amp;</span>&nbsp;<span class="ident" id="4565862">bottom28Bits</span><span class="op" id="4565874">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4565877">out</span><span class="op" id="4565880">[</span><span class="num" id="4565881">2</span><span class="op" id="4565882">]</span>&nbsp;<span class="op" id="4565884">+=</span>&nbsp;<span class="builtintype" id="4565887">uint32</span><span class="op" id="4565893">(</span><span class="ident" id="4565894">in</span><span class="op" id="4565896">[</span><span class="num" id="4565897">0</span><span class="op" id="4565898">]</span>&nbsp;<span class="op" id="4565900">&gt;&gt;</span>&nbsp;<span class="num" id="4565903">56</span><span class="op" id="4565905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565908">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565927">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4565949">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4565970">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4565973">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4566032">//</span><br>
<span class="lineno"></span><span class="comment" id="4566035">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4566069">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4566094">func</span>&nbsp;<span class="ident" id="4566099">p224Reduce</span><span class="op" id="4566109">(</span><span class="ident" id="4566110">a</span>&nbsp;<span class="op" id="4566112">*</span><span class="ident" id="4566113">p224FieldElement</span><span class="op" id="4566129">)</span>&nbsp;<span class="op" id="4566131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566134">for</span>&nbsp;<span class="ident" id="4566138">i</span>&nbsp;<span class="op" id="4566140">:=</span>&nbsp;<span class="num" id="4566143">0</span><span class="op" id="4566144">;</span>&nbsp;<span class="ident" id="4566146">i</span>&nbsp;<span class="op" id="4566148">&lt;</span>&nbsp;<span class="num" id="4566150">7</span><span class="op" id="4566151">;</span>&nbsp;<span class="ident" id="4566153">i</span><span class="op" id="4566154">++</span>&nbsp;<span class="op" id="4566157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566161">a</span><span class="op" id="4566162">[</span><span class="ident" id="4566163">i</span><span class="op" id="4566164">+</span><span class="num" id="4566165">1</span><span class="op" id="4566166">]</span>&nbsp;<span class="op" id="4566168">+=</span>&nbsp;<span class="ident" id="4566171">a</span><span class="op" id="4566172">[</span><span class="ident" id="4566173">i</span><span class="op" id="4566174">]</span>&nbsp;<span class="op" id="4566176">&gt;&gt;</span>&nbsp;<span class="num" id="4566179">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566184">a</span><span class="op" id="4566185">[</span><span class="ident" id="4566186">i</span><span class="op" id="4566187">]</span>&nbsp;<span class="op" id="4566189">&amp;=</span>&nbsp;<span class="ident" id="4566192">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4566206">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566209">top</span>&nbsp;<span class="op" id="4566213">:=</span>&nbsp;<span class="ident" id="4566216">a</span><span class="op" id="4566217">[</span><span class="num" id="4566218">7</span><span class="op" id="4566219">]</span>&nbsp;<span class="op" id="4566221">&gt;&gt;</span>&nbsp;<span class="num" id="4566224">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566228">a</span><span class="op" id="4566229">[</span><span class="num" id="4566230">7</span><span class="op" id="4566231">]</span>&nbsp;<span class="op" id="4566233">&amp;=</span>&nbsp;<span class="ident" id="4566236">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566251">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566266">mask</span>&nbsp;<span class="op" id="4566271">:=</span>&nbsp;<span class="ident" id="4566274">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566279">mask</span>&nbsp;<span class="op" id="4566284">|=</span>&nbsp;<span class="ident" id="4566287">mask</span>&nbsp;<span class="op" id="4566292">&gt;&gt;</span>&nbsp;<span class="num" id="4566295">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566298">mask</span>&nbsp;<span class="op" id="4566303">|=</span>&nbsp;<span class="ident" id="4566306">mask</span>&nbsp;<span class="op" id="4566311">&gt;&gt;</span>&nbsp;<span class="num" id="4566314">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566317">mask</span>&nbsp;<span class="op" id="4566322">&lt;&lt;=</span>&nbsp;<span class="num" id="4566326">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566330">mask</span>&nbsp;<span class="op" id="4566335">=</span>&nbsp;<span class="builtintype" id="4566337">uint32</span><span class="op" id="4566343">(</span><span class="builtintype" id="4566344">int32</span><span class="op" id="4566349">(</span><span class="ident" id="4566350">mask</span><span class="op" id="4566354">)</span>&nbsp;<span class="op" id="4566356">&gt;&gt;</span>&nbsp;<span class="num" id="4566359">31</span><span class="op" id="4566361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566364">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566418">a</span><span class="op" id="4566419">[</span><span class="num" id="4566420">0</span><span class="op" id="4566421">]</span>&nbsp;<span class="op" id="4566423">-=</span>&nbsp;<span class="ident" id="4566426">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566431">a</span><span class="op" id="4566432">[</span><span class="num" id="4566433">3</span><span class="op" id="4566434">]</span>&nbsp;<span class="op" id="4566436">+=</span>&nbsp;<span class="ident" id="4566439">top</span>&nbsp;<span class="op" id="4566443">&lt;&lt;</span>&nbsp;<span class="num" id="4566446">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566451">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566520">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566590">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566614">a</span><span class="op" id="4566615">[</span><span class="num" id="4566616">3</span><span class="op" id="4566617">]</span>&nbsp;<span class="op" id="4566619">-=</span>&nbsp;<span class="num" id="4566622">1</span>&nbsp;<span class="op" id="4566624">&amp;</span>&nbsp;<span class="ident" id="4566626">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566632">a</span><span class="op" id="4566633">[</span><span class="num" id="4566634">2</span><span class="op" id="4566635">]</span>&nbsp;<span class="op" id="4566637">+=</span>&nbsp;<span class="ident" id="4566640">mask</span>&nbsp;<span class="op" id="4566645">&amp;</span>&nbsp;<span class="op" id="4566647">(</span><span class="num" id="4566648">1</span><span class="op" id="4566649">&lt;&lt;</span><span class="num" id="4566651">28</span>&nbsp;<span class="op" id="4566654">-</span>&nbsp;<span class="num" id="4566656">1</span><span class="op" id="4566657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566660">a</span><span class="op" id="4566661">[</span><span class="num" id="4566662">1</span><span class="op" id="4566663">]</span>&nbsp;<span class="op" id="4566665">+=</span>&nbsp;<span class="ident" id="4566668">mask</span>&nbsp;<span class="op" id="4566673">&amp;</span>&nbsp;<span class="op" id="4566675">(</span><span class="num" id="4566676">1</span><span class="op" id="4566677">&lt;&lt;</span><span class="num" id="4566679">28</span>&nbsp;<span class="op" id="4566682">-</span>&nbsp;<span class="num" id="4566684">1</span><span class="op" id="4566685">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566688">a</span><span class="op" id="4566689">[</span><span class="num" id="4566690">0</span><span class="op" id="4566691">]</span>&nbsp;<span class="op" id="4566693">+=</span>&nbsp;<span class="ident" id="4566696">mask</span>&nbsp;<span class="op" id="4566701">&amp;</span>&nbsp;<span class="op" id="4566703">(</span><span class="num" id="4566704">1</span>&nbsp;<span class="op" id="4566706">&lt;&lt;</span>&nbsp;<span class="num" id="4566709">28</span><span class="op" id="4566711">)</span><br>
<span class="lineno"></span><span class="op" id="4566713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4566716">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4566794">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4566827">func</span>&nbsp;<span class="ident" id="4566832">p224Invert</span><span class="op" id="4566842">(</span><span class="ident" id="4566843">out</span><span class="op" id="4566846">,</span>&nbsp;<span class="ident" id="4566848">in</span>&nbsp;<span class="op" id="4566851">*</span><span class="ident" id="4566852">p224FieldElement</span><span class="op" id="4566868">)</span>&nbsp;<span class="op" id="4566870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566873">var</span>&nbsp;<span class="ident" id="4566877">f1</span><span class="op" id="4566879">,</span>&nbsp;<span class="ident" id="4566881">f2</span><span class="op" id="4566883">,</span>&nbsp;<span class="ident" id="4566885">f3</span><span class="op" id="4566887">,</span>&nbsp;<span class="ident" id="4566889">f4</span>&nbsp;<span class="ident" id="4566892">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4566910">var</span>&nbsp;<span class="ident" id="4566914">c</span>&nbsp;<span class="ident" id="4566916">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566940">p224Square</span><span class="op" id="4566950">(</span><span class="op" id="4566951">&amp;</span><span class="ident" id="4566952">f1</span><span class="op" id="4566954">,</span>&nbsp;<span class="ident" id="4566956">in</span><span class="op" id="4566958">,</span>&nbsp;<span class="op" id="4566960">&amp;</span><span class="ident" id="4566961">c</span><span class="op" id="4566962">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4566967">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4566973">p224Mul</span><span class="op" id="4566980">(</span><span class="op" id="4566981">&amp;</span><span class="ident" id="4566982">f1</span><span class="op" id="4566984">,</span>&nbsp;<span class="op" id="4566986">&amp;</span><span class="ident" id="4566987">f1</span><span class="op" id="4566989">,</span>&nbsp;<span class="ident" id="4566991">in</span><span class="op" id="4566993">,</span>&nbsp;<span class="op" id="4566995">&amp;</span><span class="ident" id="4566996">c</span><span class="op" id="4566997">)</span>&nbsp;&nbsp;<span class="comment" id="4567000">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567013">p224Square</span><span class="op" id="4567023">(</span><span class="op" id="4567024">&amp;</span><span class="ident" id="4567025">f1</span><span class="op" id="4567027">,</span>&nbsp;<span class="op" id="4567029">&amp;</span><span class="ident" id="4567030">f1</span><span class="op" id="4567032">,</span>&nbsp;<span class="op" id="4567034">&amp;</span><span class="ident" id="4567035">c</span><span class="op" id="4567036">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567040">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567053">p224Mul</span><span class="op" id="4567060">(</span><span class="op" id="4567061">&amp;</span><span class="ident" id="4567062">f1</span><span class="op" id="4567064">,</span>&nbsp;<span class="op" id="4567066">&amp;</span><span class="ident" id="4567067">f1</span><span class="op" id="4567069">,</span>&nbsp;<span class="ident" id="4567071">in</span><span class="op" id="4567073">,</span>&nbsp;<span class="op" id="4567075">&amp;</span><span class="ident" id="4567076">c</span><span class="op" id="4567077">)</span>&nbsp;&nbsp;<span class="comment" id="4567080">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567093">p224Square</span><span class="op" id="4567103">(</span><span class="op" id="4567104">&amp;</span><span class="ident" id="4567105">f2</span><span class="op" id="4567107">,</span>&nbsp;<span class="op" id="4567109">&amp;</span><span class="ident" id="4567110">f1</span><span class="op" id="4567112">,</span>&nbsp;<span class="op" id="4567114">&amp;</span><span class="ident" id="4567115">c</span><span class="op" id="4567116">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567120">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567133">p224Square</span><span class="op" id="4567143">(</span><span class="op" id="4567144">&amp;</span><span class="ident" id="4567145">f2</span><span class="op" id="4567147">,</span>&nbsp;<span class="op" id="4567149">&amp;</span><span class="ident" id="4567150">f2</span><span class="op" id="4567152">,</span>&nbsp;<span class="op" id="4567154">&amp;</span><span class="ident" id="4567155">c</span><span class="op" id="4567156">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567160">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567173">p224Square</span><span class="op" id="4567183">(</span><span class="op" id="4567184">&amp;</span><span class="ident" id="4567185">f2</span><span class="op" id="4567187">,</span>&nbsp;<span class="op" id="4567189">&amp;</span><span class="ident" id="4567190">f2</span><span class="op" id="4567192">,</span>&nbsp;<span class="op" id="4567194">&amp;</span><span class="ident" id="4567195">c</span><span class="op" id="4567196">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567200">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567213">p224Mul</span><span class="op" id="4567220">(</span><span class="op" id="4567221">&amp;</span><span class="ident" id="4567222">f1</span><span class="op" id="4567224">,</span>&nbsp;<span class="op" id="4567226">&amp;</span><span class="ident" id="4567227">f1</span><span class="op" id="4567229">,</span>&nbsp;<span class="op" id="4567231">&amp;</span><span class="ident" id="4567232">f2</span><span class="op" id="4567234">,</span>&nbsp;<span class="op" id="4567236">&amp;</span><span class="ident" id="4567237">c</span><span class="op" id="4567238">)</span>&nbsp;<span class="comment" id="4567240">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567253">p224Square</span><span class="op" id="4567263">(</span><span class="op" id="4567264">&amp;</span><span class="ident" id="4567265">f2</span><span class="op" id="4567267">,</span>&nbsp;<span class="op" id="4567269">&amp;</span><span class="ident" id="4567270">f1</span><span class="op" id="4567272">,</span>&nbsp;<span class="op" id="4567274">&amp;</span><span class="ident" id="4567275">c</span><span class="op" id="4567276">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567280">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567293">for</span>&nbsp;<span class="ident" id="4567297">i</span>&nbsp;<span class="op" id="4567299">:=</span>&nbsp;<span class="num" id="4567302">0</span><span class="op" id="4567303">;</span>&nbsp;<span class="ident" id="4567305">i</span>&nbsp;<span class="op" id="4567307">&lt;</span>&nbsp;<span class="num" id="4567309">5</span><span class="op" id="4567310">;</span>&nbsp;<span class="ident" id="4567312">i</span><span class="op" id="4567313">++</span>&nbsp;<span class="op" id="4567316">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567320">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567338">p224Square</span><span class="op" id="4567348">(</span><span class="op" id="4567349">&amp;</span><span class="ident" id="4567350">f2</span><span class="op" id="4567352">,</span>&nbsp;<span class="op" id="4567354">&amp;</span><span class="ident" id="4567355">f2</span><span class="op" id="4567357">,</span>&nbsp;<span class="op" id="4567359">&amp;</span><span class="ident" id="4567360">c</span><span class="op" id="4567361">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567367">p224Mul</span><span class="op" id="4567374">(</span><span class="op" id="4567375">&amp;</span><span class="ident" id="4567376">f2</span><span class="op" id="4567378">,</span>&nbsp;<span class="op" id="4567380">&amp;</span><span class="ident" id="4567381">f2</span><span class="op" id="4567383">,</span>&nbsp;<span class="op" id="4567385">&amp;</span><span class="ident" id="4567386">f1</span><span class="op" id="4567388">,</span>&nbsp;<span class="op" id="4567390">&amp;</span><span class="ident" id="4567391">c</span><span class="op" id="4567392">)</span>&nbsp;<span class="comment" id="4567394">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567408">p224Square</span><span class="op" id="4567418">(</span><span class="op" id="4567419">&amp;</span><span class="ident" id="4567420">f3</span><span class="op" id="4567422">,</span>&nbsp;<span class="op" id="4567424">&amp;</span><span class="ident" id="4567425">f2</span><span class="op" id="4567427">,</span>&nbsp;<span class="op" id="4567429">&amp;</span><span class="ident" id="4567430">c</span><span class="op" id="4567431">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567435">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567449">for</span>&nbsp;<span class="ident" id="4567453">i</span>&nbsp;<span class="op" id="4567455">:=</span>&nbsp;<span class="num" id="4567458">0</span><span class="op" id="4567459">;</span>&nbsp;<span class="ident" id="4567461">i</span>&nbsp;<span class="op" id="4567463">&lt;</span>&nbsp;<span class="num" id="4567465">11</span><span class="op" id="4567467">;</span>&nbsp;<span class="ident" id="4567469">i</span><span class="op" id="4567470">++</span>&nbsp;<span class="op" id="4567473">{</span>&nbsp;&nbsp;<span class="comment" id="4567476">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567495">p224Square</span><span class="op" id="4567505">(</span><span class="op" id="4567506">&amp;</span><span class="ident" id="4567507">f3</span><span class="op" id="4567509">,</span>&nbsp;<span class="op" id="4567511">&amp;</span><span class="ident" id="4567512">f3</span><span class="op" id="4567514">,</span>&nbsp;<span class="op" id="4567516">&amp;</span><span class="ident" id="4567517">c</span><span class="op" id="4567518">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567524">p224Mul</span><span class="op" id="4567531">(</span><span class="op" id="4567532">&amp;</span><span class="ident" id="4567533">f2</span><span class="op" id="4567535">,</span>&nbsp;<span class="op" id="4567537">&amp;</span><span class="ident" id="4567538">f3</span><span class="op" id="4567540">,</span>&nbsp;<span class="op" id="4567542">&amp;</span><span class="ident" id="4567543">f2</span><span class="op" id="4567545">,</span>&nbsp;<span class="op" id="4567547">&amp;</span><span class="ident" id="4567548">c</span><span class="op" id="4567549">)</span>&nbsp;<span class="comment" id="4567551">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567565">p224Square</span><span class="op" id="4567575">(</span><span class="op" id="4567576">&amp;</span><span class="ident" id="4567577">f3</span><span class="op" id="4567579">,</span>&nbsp;<span class="op" id="4567581">&amp;</span><span class="ident" id="4567582">f2</span><span class="op" id="4567584">,</span>&nbsp;<span class="op" id="4567586">&amp;</span><span class="ident" id="4567587">c</span><span class="op" id="4567588">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567592">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567606">for</span>&nbsp;<span class="ident" id="4567610">i</span>&nbsp;<span class="op" id="4567612">:=</span>&nbsp;<span class="num" id="4567615">0</span><span class="op" id="4567616">;</span>&nbsp;<span class="ident" id="4567618">i</span>&nbsp;<span class="op" id="4567620">&lt;</span>&nbsp;<span class="num" id="4567622">23</span><span class="op" id="4567624">;</span>&nbsp;<span class="ident" id="4567626">i</span><span class="op" id="4567627">++</span>&nbsp;<span class="op" id="4567630">{</span>&nbsp;&nbsp;<span class="comment" id="4567633">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567652">p224Square</span><span class="op" id="4567662">(</span><span class="op" id="4567663">&amp;</span><span class="ident" id="4567664">f3</span><span class="op" id="4567666">,</span>&nbsp;<span class="op" id="4567668">&amp;</span><span class="ident" id="4567669">f3</span><span class="op" id="4567671">,</span>&nbsp;<span class="op" id="4567673">&amp;</span><span class="ident" id="4567674">c</span><span class="op" id="4567675">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567681">p224Mul</span><span class="op" id="4567688">(</span><span class="op" id="4567689">&amp;</span><span class="ident" id="4567690">f3</span><span class="op" id="4567692">,</span>&nbsp;<span class="op" id="4567694">&amp;</span><span class="ident" id="4567695">f3</span><span class="op" id="4567697">,</span>&nbsp;<span class="op" id="4567699">&amp;</span><span class="ident" id="4567700">f2</span><span class="op" id="4567702">,</span>&nbsp;<span class="op" id="4567704">&amp;</span><span class="ident" id="4567705">c</span><span class="op" id="4567706">)</span>&nbsp;<span class="comment" id="4567708">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567722">p224Square</span><span class="op" id="4567732">(</span><span class="op" id="4567733">&amp;</span><span class="ident" id="4567734">f4</span><span class="op" id="4567736">,</span>&nbsp;<span class="op" id="4567738">&amp;</span><span class="ident" id="4567739">f3</span><span class="op" id="4567741">,</span>&nbsp;<span class="op" id="4567743">&amp;</span><span class="ident" id="4567744">c</span><span class="op" id="4567745">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567749">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567763">for</span>&nbsp;<span class="ident" id="4567767">i</span>&nbsp;<span class="op" id="4567769">:=</span>&nbsp;<span class="num" id="4567772">0</span><span class="op" id="4567773">;</span>&nbsp;<span class="ident" id="4567775">i</span>&nbsp;<span class="op" id="4567777">&lt;</span>&nbsp;<span class="num" id="4567779">47</span><span class="op" id="4567781">;</span>&nbsp;<span class="ident" id="4567783">i</span><span class="op" id="4567784">++</span>&nbsp;<span class="op" id="4567787">{</span>&nbsp;&nbsp;<span class="comment" id="4567790">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567809">p224Square</span><span class="op" id="4567819">(</span><span class="op" id="4567820">&amp;</span><span class="ident" id="4567821">f4</span><span class="op" id="4567823">,</span>&nbsp;<span class="op" id="4567825">&amp;</span><span class="ident" id="4567826">f4</span><span class="op" id="4567828">,</span>&nbsp;<span class="op" id="4567830">&amp;</span><span class="ident" id="4567831">c</span><span class="op" id="4567832">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567838">p224Mul</span><span class="op" id="4567845">(</span><span class="op" id="4567846">&amp;</span><span class="ident" id="4567847">f3</span><span class="op" id="4567849">,</span>&nbsp;<span class="op" id="4567851">&amp;</span><span class="ident" id="4567852">f3</span><span class="op" id="4567854">,</span>&nbsp;<span class="op" id="4567856">&amp;</span><span class="ident" id="4567857">f4</span><span class="op" id="4567859">,</span>&nbsp;<span class="op" id="4567861">&amp;</span><span class="ident" id="4567862">c</span><span class="op" id="4567863">)</span>&nbsp;<span class="comment" id="4567865">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567879">p224Square</span><span class="op" id="4567889">(</span><span class="op" id="4567890">&amp;</span><span class="ident" id="4567891">f4</span><span class="op" id="4567893">,</span>&nbsp;<span class="op" id="4567895">&amp;</span><span class="ident" id="4567896">f3</span><span class="op" id="4567898">,</span>&nbsp;<span class="op" id="4567900">&amp;</span><span class="ident" id="4567901">c</span><span class="op" id="4567902">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4567906">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4567920">for</span>&nbsp;<span class="ident" id="4567924">i</span>&nbsp;<span class="op" id="4567926">:=</span>&nbsp;<span class="num" id="4567929">0</span><span class="op" id="4567930">;</span>&nbsp;<span class="ident" id="4567932">i</span>&nbsp;<span class="op" id="4567934">&lt;</span>&nbsp;<span class="num" id="4567936">23</span><span class="op" id="4567938">;</span>&nbsp;<span class="ident" id="4567940">i</span><span class="op" id="4567941">++</span>&nbsp;<span class="op" id="4567944">{</span>&nbsp;&nbsp;<span class="comment" id="4567947">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567967">p224Square</span><span class="op" id="4567977">(</span><span class="op" id="4567978">&amp;</span><span class="ident" id="4567979">f4</span><span class="op" id="4567981">,</span>&nbsp;<span class="op" id="4567983">&amp;</span><span class="ident" id="4567984">f4</span><span class="op" id="4567986">,</span>&nbsp;<span class="op" id="4567988">&amp;</span><span class="ident" id="4567989">c</span><span class="op" id="4567990">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4567996">p224Mul</span><span class="op" id="4568003">(</span><span class="op" id="4568004">&amp;</span><span class="ident" id="4568005">f2</span><span class="op" id="4568007">,</span>&nbsp;<span class="op" id="4568009">&amp;</span><span class="ident" id="4568010">f4</span><span class="op" id="4568012">,</span>&nbsp;<span class="op" id="4568014">&amp;</span><span class="ident" id="4568015">f2</span><span class="op" id="4568017">,</span>&nbsp;<span class="op" id="4568019">&amp;</span><span class="ident" id="4568020">c</span><span class="op" id="4568021">)</span>&nbsp;<span class="comment" id="4568023">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568038">for</span>&nbsp;<span class="ident" id="4568042">i</span>&nbsp;<span class="op" id="4568044">:=</span>&nbsp;<span class="num" id="4568047">0</span><span class="op" id="4568048">;</span>&nbsp;<span class="ident" id="4568050">i</span>&nbsp;<span class="op" id="4568052">&lt;</span>&nbsp;<span class="num" id="4568054">6</span><span class="op" id="4568055">;</span>&nbsp;<span class="ident" id="4568057">i</span><span class="op" id="4568058">++</span>&nbsp;<span class="op" id="4568061">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4568065">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568084">p224Square</span><span class="op" id="4568094">(</span><span class="op" id="4568095">&amp;</span><span class="ident" id="4568096">f2</span><span class="op" id="4568098">,</span>&nbsp;<span class="op" id="4568100">&amp;</span><span class="ident" id="4568101">f2</span><span class="op" id="4568103">,</span>&nbsp;<span class="op" id="4568105">&amp;</span><span class="ident" id="4568106">c</span><span class="op" id="4568107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568110">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568113">p224Mul</span><span class="op" id="4568120">(</span><span class="op" id="4568121">&amp;</span><span class="ident" id="4568122">f1</span><span class="op" id="4568124">,</span>&nbsp;<span class="op" id="4568126">&amp;</span><span class="ident" id="4568127">f1</span><span class="op" id="4568129">,</span>&nbsp;<span class="op" id="4568131">&amp;</span><span class="ident" id="4568132">f2</span><span class="op" id="4568134">,</span>&nbsp;<span class="op" id="4568136">&amp;</span><span class="ident" id="4568137">c</span><span class="op" id="4568138">)</span>&nbsp;<span class="comment" id="4568140">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568155">p224Square</span><span class="op" id="4568165">(</span><span class="op" id="4568166">&amp;</span><span class="ident" id="4568167">f1</span><span class="op" id="4568169">,</span>&nbsp;<span class="op" id="4568171">&amp;</span><span class="ident" id="4568172">f1</span><span class="op" id="4568174">,</span>&nbsp;<span class="op" id="4568176">&amp;</span><span class="ident" id="4568177">c</span><span class="op" id="4568178">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4568182">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568197">p224Mul</span><span class="op" id="4568204">(</span><span class="op" id="4568205">&amp;</span><span class="ident" id="4568206">f1</span><span class="op" id="4568208">,</span>&nbsp;<span class="op" id="4568210">&amp;</span><span class="ident" id="4568211">f1</span><span class="op" id="4568213">,</span>&nbsp;<span class="ident" id="4568215">in</span><span class="op" id="4568217">,</span>&nbsp;<span class="op" id="4568219">&amp;</span><span class="ident" id="4568220">c</span><span class="op" id="4568221">)</span>&nbsp;&nbsp;<span class="comment" id="4568224">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568239">for</span>&nbsp;<span class="ident" id="4568243">i</span>&nbsp;<span class="op" id="4568245">:=</span>&nbsp;<span class="num" id="4568248">0</span><span class="op" id="4568249">;</span>&nbsp;<span class="ident" id="4568251">i</span>&nbsp;<span class="op" id="4568253">&lt;</span>&nbsp;<span class="num" id="4568255">97</span><span class="op" id="4568257">;</span>&nbsp;<span class="ident" id="4568259">i</span><span class="op" id="4568260">++</span>&nbsp;<span class="op" id="4568263">{</span>&nbsp;&nbsp;<span class="comment" id="4568266">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568286">p224Square</span><span class="op" id="4568296">(</span><span class="op" id="4568297">&amp;</span><span class="ident" id="4568298">f1</span><span class="op" id="4568300">,</span>&nbsp;<span class="op" id="4568302">&amp;</span><span class="ident" id="4568303">f1</span><span class="op" id="4568305">,</span>&nbsp;<span class="op" id="4568307">&amp;</span><span class="ident" id="4568308">c</span><span class="op" id="4568309">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568315">p224Mul</span><span class="op" id="4568322">(</span><span class="ident" id="4568323">out</span><span class="op" id="4568326">,</span>&nbsp;<span class="op" id="4568328">&amp;</span><span class="ident" id="4568329">f1</span><span class="op" id="4568331">,</span>&nbsp;<span class="op" id="4568333">&amp;</span><span class="ident" id="4568334">f3</span><span class="op" id="4568336">,</span>&nbsp;<span class="op" id="4568338">&amp;</span><span class="ident" id="4568339">c</span><span class="op" id="4568340">)</span>&nbsp;<span class="comment" id="4568342">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4568364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4568367">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4568436">//</span><br>
<span class="lineno"></span><span class="comment" id="4568439">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4568466">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4568492">func</span>&nbsp;<span class="ident" id="4568497">p224Contract</span><span class="op" id="4568509">(</span><span class="ident" id="4568510">out</span><span class="op" id="4568513">,</span>&nbsp;<span class="ident" id="4568515">in</span>&nbsp;<span class="op" id="4568518">*</span><span class="ident" id="4568519">p224FieldElement</span><span class="op" id="4568535">)</span>&nbsp;<span class="op" id="4568537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4568540">copy</span><span class="op" id="4568544">(</span><span class="ident" id="4568545">out</span><span class="op" id="4568548">[</span><span class="op" id="4568549">:</span><span class="op" id="4568550">]</span><span class="op" id="4568551">,</span>&nbsp;<span class="ident" id="4568553">in</span><span class="op" id="4568555">[</span><span class="op" id="4568556">:</span><span class="op" id="4568557">]</span><span class="op" id="4568558">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568562">for</span>&nbsp;<span class="ident" id="4568566">i</span>&nbsp;<span class="op" id="4568568">:=</span>&nbsp;<span class="num" id="4568571">0</span><span class="op" id="4568572">;</span>&nbsp;<span class="ident" id="4568574">i</span>&nbsp;<span class="op" id="4568576">&lt;</span>&nbsp;<span class="num" id="4568578">7</span><span class="op" id="4568579">;</span>&nbsp;<span class="ident" id="4568581">i</span><span class="op" id="4568582">++</span>&nbsp;<span class="op" id="4568585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568589">out</span><span class="op" id="4568592">[</span><span class="ident" id="4568593">i</span><span class="op" id="4568594">+</span><span class="num" id="4568595">1</span><span class="op" id="4568596">]</span>&nbsp;<span class="op" id="4568598">+=</span>&nbsp;<span class="ident" id="4568601">out</span><span class="op" id="4568604">[</span><span class="ident" id="4568605">i</span><span class="op" id="4568606">]</span>&nbsp;<span class="op" id="4568608">&gt;&gt;</span>&nbsp;<span class="num" id="4568611">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568616">out</span><span class="op" id="4568619">[</span><span class="ident" id="4568620">i</span><span class="op" id="4568621">]</span>&nbsp;<span class="op" id="4568623">&amp;=</span>&nbsp;<span class="ident" id="4568626">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568640">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568643">top</span>&nbsp;<span class="op" id="4568647">:=</span>&nbsp;<span class="ident" id="4568650">out</span><span class="op" id="4568653">[</span><span class="num" id="4568654">7</span><span class="op" id="4568655">]</span>&nbsp;<span class="op" id="4568657">&gt;&gt;</span>&nbsp;<span class="num" id="4568660">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568664">out</span><span class="op" id="4568667">[</span><span class="num" id="4568668">7</span><span class="op" id="4568669">]</span>&nbsp;<span class="op" id="4568671">&amp;=</span>&nbsp;<span class="ident" id="4568674">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568689">out</span><span class="op" id="4568692">[</span><span class="num" id="4568693">0</span><span class="op" id="4568694">]</span>&nbsp;<span class="op" id="4568696">-=</span>&nbsp;<span class="ident" id="4568699">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568704">out</span><span class="op" id="4568707">[</span><span class="num" id="4568708">3</span><span class="op" id="4568709">]</span>&nbsp;<span class="op" id="4568711">+=</span>&nbsp;<span class="ident" id="4568714">top</span>&nbsp;<span class="op" id="4568718">&lt;&lt;</span>&nbsp;<span class="num" id="4568721">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4568726">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4568798">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4568868">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4568901">for</span>&nbsp;<span class="ident" id="4568905">i</span>&nbsp;<span class="op" id="4568907">:=</span>&nbsp;<span class="num" id="4568910">0</span><span class="op" id="4568911">;</span>&nbsp;<span class="ident" id="4568913">i</span>&nbsp;<span class="op" id="4568915">&lt;</span>&nbsp;<span class="num" id="4568917">3</span><span class="op" id="4568918">;</span>&nbsp;<span class="ident" id="4568920">i</span><span class="op" id="4568921">++</span>&nbsp;<span class="op" id="4568924">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568928">mask</span>&nbsp;<span class="op" id="4568933">:=</span>&nbsp;<span class="builtintype" id="4568936">uint32</span><span class="op" id="4568942">(</span><span class="builtintype" id="4568943">int32</span><span class="op" id="4568948">(</span><span class="ident" id="4568949">out</span><span class="op" id="4568952">[</span><span class="ident" id="4568953">i</span><span class="op" id="4568954">]</span><span class="op" id="4568955">)</span>&nbsp;<span class="op" id="4568957">&gt;&gt;</span>&nbsp;<span class="num" id="4568960">31</span><span class="op" id="4568962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568966">out</span><span class="op" id="4568969">[</span><span class="ident" id="4568970">i</span><span class="op" id="4568971">]</span>&nbsp;<span class="op" id="4568973">+=</span>&nbsp;<span class="op" id="4568976">(</span><span class="num" id="4568977">1</span>&nbsp;<span class="op" id="4568979">&lt;&lt;</span>&nbsp;<span class="num" id="4568982">28</span><span class="op" id="4568984">)</span>&nbsp;<span class="op" id="4568986">&amp;</span>&nbsp;<span class="ident" id="4568988">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4568995">out</span><span class="op" id="4568998">[</span><span class="ident" id="4568999">i</span><span class="op" id="4569000">+</span><span class="num" id="4569001">1</span><span class="op" id="4569002">]</span>&nbsp;<span class="op" id="4569004">-=</span>&nbsp;<span class="num" id="4569007">1</span>&nbsp;<span class="op" id="4569009">&amp;</span>&nbsp;<span class="ident" id="4569011">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569021">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569096">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4569113">for</span>&nbsp;<span class="ident" id="4569117">i</span>&nbsp;<span class="op" id="4569119">:=</span>&nbsp;<span class="num" id="4569122">3</span><span class="op" id="4569123">;</span>&nbsp;<span class="ident" id="4569125">i</span>&nbsp;<span class="op" id="4569127">&lt;</span>&nbsp;<span class="num" id="4569129">7</span><span class="op" id="4569130">;</span>&nbsp;<span class="ident" id="4569132">i</span><span class="op" id="4569133">++</span>&nbsp;<span class="op" id="4569136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569140">out</span><span class="op" id="4569143">[</span><span class="ident" id="4569144">i</span><span class="op" id="4569145">+</span><span class="num" id="4569146">1</span><span class="op" id="4569147">]</span>&nbsp;<span class="op" id="4569149">+=</span>&nbsp;<span class="ident" id="4569152">out</span><span class="op" id="4569155">[</span><span class="ident" id="4569156">i</span><span class="op" id="4569157">]</span>&nbsp;<span class="op" id="4569159">&gt;&gt;</span>&nbsp;<span class="num" id="4569162">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569167">out</span><span class="op" id="4569170">[</span><span class="ident" id="4569171">i</span><span class="op" id="4569172">]</span>&nbsp;<span class="op" id="4569174">&amp;=</span>&nbsp;<span class="ident" id="4569177">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4569191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569194">top</span>&nbsp;<span class="op" id="4569198">=</span>&nbsp;<span class="ident" id="4569200">out</span><span class="op" id="4569203">[</span><span class="num" id="4569204">7</span><span class="op" id="4569205">]</span>&nbsp;<span class="op" id="4569207">&gt;&gt;</span>&nbsp;<span class="num" id="4569210">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569214">out</span><span class="op" id="4569217">[</span><span class="num" id="4569218">7</span><span class="op" id="4569219">]</span>&nbsp;<span class="op" id="4569221">&amp;=</span>&nbsp;<span class="ident" id="4569224">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569239">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569297">out</span><span class="op" id="4569300">[</span><span class="num" id="4569301">0</span><span class="op" id="4569302">]</span>&nbsp;<span class="op" id="4569304">-=</span>&nbsp;<span class="ident" id="4569307">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4569312">out</span><span class="op" id="4569315">[</span><span class="num" id="4569316">3</span><span class="op" id="4569317">]</span>&nbsp;<span class="op" id="4569319">+=</span>&nbsp;<span class="ident" id="4569322">top</span>&nbsp;<span class="op" id="4569326">&lt;&lt;</span>&nbsp;<span class="num" id="4569329">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569334">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569382">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569536">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569562">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569795">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569950">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4569973">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570050">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570120">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570147">for</span>&nbsp;<span class="ident" id="4570151">i</span>&nbsp;<span class="op" id="4570153">:=</span>&nbsp;<span class="num" id="4570156">0</span><span class="op" id="4570157">;</span>&nbsp;<span class="ident" id="4570159">i</span>&nbsp;<span class="op" id="4570161">&lt;</span>&nbsp;<span class="num" id="4570163">3</span><span class="op" id="4570164">;</span>&nbsp;<span class="ident" id="4570166">i</span><span class="op" id="4570167">++</span>&nbsp;<span class="op" id="4570170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570174">mask</span>&nbsp;<span class="op" id="4570179">:=</span>&nbsp;<span class="builtintype" id="4570182">uint32</span><span class="op" id="4570188">(</span><span class="builtintype" id="4570189">int32</span><span class="op" id="4570194">(</span><span class="ident" id="4570195">out</span><span class="op" id="4570198">[</span><span class="ident" id="4570199">i</span><span class="op" id="4570200">]</span><span class="op" id="4570201">)</span>&nbsp;<span class="op" id="4570203">&gt;&gt;</span>&nbsp;<span class="num" id="4570206">31</span><span class="op" id="4570208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570212">out</span><span class="op" id="4570215">[</span><span class="ident" id="4570216">i</span><span class="op" id="4570217">]</span>&nbsp;<span class="op" id="4570219">+=</span>&nbsp;<span class="op" id="4570222">(</span><span class="num" id="4570223">1</span>&nbsp;<span class="op" id="4570225">&lt;&lt;</span>&nbsp;<span class="num" id="4570228">28</span><span class="op" id="4570230">)</span>&nbsp;<span class="op" id="4570232">&amp;</span>&nbsp;<span class="ident" id="4570234">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570241">out</span><span class="op" id="4570244">[</span><span class="ident" id="4570245">i</span><span class="op" id="4570246">+</span><span class="num" id="4570247">1</span><span class="op" id="4570248">]</span>&nbsp;<span class="op" id="4570250">-=</span>&nbsp;<span class="num" id="4570253">1</span>&nbsp;<span class="op" id="4570255">&amp;</span>&nbsp;<span class="ident" id="4570257">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570267">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570328">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570397">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570466">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570537">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570547">top4AllOnes</span>&nbsp;<span class="op" id="4570559">:=</span>&nbsp;<span class="builtintype" id="4570562">uint32</span><span class="op" id="4570568">(</span><span class="num" id="4570569">0xffffffff</span><span class="op" id="4570579">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4570582">for</span>&nbsp;<span class="ident" id="4570586">i</span>&nbsp;<span class="op" id="4570588">:=</span>&nbsp;<span class="num" id="4570591">4</span><span class="op" id="4570592">;</span>&nbsp;<span class="ident" id="4570594">i</span>&nbsp;<span class="op" id="4570596">&lt;</span>&nbsp;<span class="num" id="4570598">8</span><span class="op" id="4570599">;</span>&nbsp;<span class="ident" id="4570601">i</span><span class="op" id="4570602">++</span>&nbsp;<span class="op" id="4570605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570609">top4AllOnes</span>&nbsp;<span class="op" id="4570621">&amp;=</span>&nbsp;<span class="ident" id="4570624">out</span><span class="op" id="4570627">[</span><span class="ident" id="4570628">i</span><span class="op" id="4570629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4570632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570635">top4AllOnes</span>&nbsp;<span class="op" id="4570647">|=</span>&nbsp;<span class="num" id="4570650">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570662">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570729">top4AllOnes</span>&nbsp;<span class="op" id="4570741">&amp;=</span>&nbsp;<span class="ident" id="4570744">top4AllOnes</span>&nbsp;<span class="op" id="4570756">&gt;&gt;</span>&nbsp;<span class="num" id="4570759">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570763">top4AllOnes</span>&nbsp;<span class="op" id="4570775">&amp;=</span>&nbsp;<span class="ident" id="4570778">top4AllOnes</span>&nbsp;<span class="op" id="4570790">&gt;&gt;</span>&nbsp;<span class="num" id="4570793">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570796">top4AllOnes</span>&nbsp;<span class="op" id="4570808">&amp;=</span>&nbsp;<span class="ident" id="4570811">top4AllOnes</span>&nbsp;<span class="op" id="4570823">&gt;&gt;</span>&nbsp;<span class="num" id="4570826">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570829">top4AllOnes</span>&nbsp;<span class="op" id="4570841">&amp;=</span>&nbsp;<span class="ident" id="4570844">top4AllOnes</span>&nbsp;<span class="op" id="4570856">&gt;&gt;</span>&nbsp;<span class="num" id="4570859">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570862">top4AllOnes</span>&nbsp;<span class="op" id="4570874">&amp;=</span>&nbsp;<span class="ident" id="4570877">top4AllOnes</span>&nbsp;<span class="op" id="4570889">&gt;&gt;</span>&nbsp;<span class="num" id="4570892">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570895">top4AllOnes</span>&nbsp;<span class="op" id="4570907">=</span>&nbsp;<span class="builtintype" id="4570909">uint32</span><span class="op" id="4570915">(</span><span class="builtintype" id="4570916">int32</span><span class="op" id="4570921">(</span><span class="ident" id="4570922">top4AllOnes</span><span class="op" id="4570933">&lt;&lt;</span><span class="num" id="4570935">31</span><span class="op" id="4570937">)</span>&nbsp;<span class="op" id="4570939">&gt;&gt;</span>&nbsp;<span class="num" id="4570942">31</span><span class="op" id="4570944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4570948">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571009">bottom3NonZero</span>&nbsp;<span class="op" id="4571024">:=</span>&nbsp;<span class="ident" id="4571027">out</span><span class="op" id="4571030">[</span><span class="num" id="4571031">0</span><span class="op" id="4571032">]</span>&nbsp;<span class="op" id="4571034">|</span>&nbsp;<span class="ident" id="4571036">out</span><span class="op" id="4571039">[</span><span class="num" id="4571040">1</span><span class="op" id="4571041">]</span>&nbsp;<span class="op" id="4571043">|</span>&nbsp;<span class="ident" id="4571045">out</span><span class="op" id="4571048">[</span><span class="num" id="4571049">2</span><span class="op" id="4571050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571053">bottom3NonZero</span>&nbsp;<span class="op" id="4571068">|=</span>&nbsp;<span class="ident" id="4571071">bottom3NonZero</span>&nbsp;<span class="op" id="4571086">&gt;&gt;</span>&nbsp;<span class="num" id="4571089">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571093">bottom3NonZero</span>&nbsp;<span class="op" id="4571108">|=</span>&nbsp;<span class="ident" id="4571111">bottom3NonZero</span>&nbsp;<span class="op" id="4571126">&gt;&gt;</span>&nbsp;<span class="num" id="4571129">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571132">bottom3NonZero</span>&nbsp;<span class="op" id="4571147">|=</span>&nbsp;<span class="ident" id="4571150">bottom3NonZero</span>&nbsp;<span class="op" id="4571165">&gt;&gt;</span>&nbsp;<span class="num" id="4571168">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571171">bottom3NonZero</span>&nbsp;<span class="op" id="4571186">|=</span>&nbsp;<span class="ident" id="4571189">bottom3NonZero</span>&nbsp;<span class="op" id="4571204">&gt;&gt;</span>&nbsp;<span class="num" id="4571207">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571210">bottom3NonZero</span>&nbsp;<span class="op" id="4571225">|=</span>&nbsp;<span class="ident" id="4571228">bottom3NonZero</span>&nbsp;<span class="op" id="4571243">&gt;&gt;</span>&nbsp;<span class="num" id="4571246">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571249">bottom3NonZero</span>&nbsp;<span class="op" id="4571264">=</span>&nbsp;<span class="builtintype" id="4571266">uint32</span><span class="op" id="4571272">(</span><span class="builtintype" id="4571273">int32</span><span class="op" id="4571278">(</span><span class="ident" id="4571279">bottom3NonZero</span><span class="op" id="4571293">&lt;&lt;</span><span class="num" id="4571295">31</span><span class="op" id="4571297">)</span>&nbsp;<span class="op" id="4571299">&gt;&gt;</span>&nbsp;<span class="num" id="4571302">31</span><span class="op" id="4571304">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571308">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571355">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571432">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571543">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571599">n</span>&nbsp;<span class="op" id="4571601">:=</span>&nbsp;<span class="ident" id="4571604">out</span><span class="op" id="4571607">[</span><span class="num" id="4571608">3</span><span class="op" id="4571609">]</span>&nbsp;<span class="op" id="4571611">-</span>&nbsp;<span class="num" id="4571613">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571624">out3Equal</span>&nbsp;<span class="op" id="4571634">:=</span>&nbsp;<span class="ident" id="4571637">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571640">out3Equal</span>&nbsp;<span class="op" id="4571650">|=</span>&nbsp;<span class="ident" id="4571653">out3Equal</span>&nbsp;<span class="op" id="4571663">&gt;&gt;</span>&nbsp;<span class="num" id="4571666">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571670">out3Equal</span>&nbsp;<span class="op" id="4571680">|=</span>&nbsp;<span class="ident" id="4571683">out3Equal</span>&nbsp;<span class="op" id="4571693">&gt;&gt;</span>&nbsp;<span class="num" id="4571696">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571699">out3Equal</span>&nbsp;<span class="op" id="4571709">|=</span>&nbsp;<span class="ident" id="4571712">out3Equal</span>&nbsp;<span class="op" id="4571722">&gt;&gt;</span>&nbsp;<span class="num" id="4571725">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571728">out3Equal</span>&nbsp;<span class="op" id="4571738">|=</span>&nbsp;<span class="ident" id="4571741">out3Equal</span>&nbsp;<span class="op" id="4571751">&gt;&gt;</span>&nbsp;<span class="num" id="4571754">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571757">out3Equal</span>&nbsp;<span class="op" id="4571767">|=</span>&nbsp;<span class="ident" id="4571770">out3Equal</span>&nbsp;<span class="op" id="4571780">&gt;&gt;</span>&nbsp;<span class="num" id="4571783">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571786">out3Equal</span>&nbsp;<span class="op" id="4571796">=</span>&nbsp;<span class="op" id="4571798">^</span><span class="builtintype" id="4571799">uint32</span><span class="op" id="4571805">(</span><span class="builtintype" id="4571806">int32</span><span class="op" id="4571811">(</span><span class="ident" id="4571812">out3Equal</span><span class="op" id="4571821">&lt;&lt;</span><span class="num" id="4571823">31</span><span class="op" id="4571825">)</span>&nbsp;<span class="op" id="4571827">&gt;&gt;</span>&nbsp;<span class="num" id="4571830">31</span><span class="op" id="4571832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4571836">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571889">out3GT</span>&nbsp;<span class="op" id="4571896">:=</span>&nbsp;<span class="op" id="4571899">^</span><span class="builtintype" id="4571900">uint32</span><span class="op" id="4571906">(</span><span class="builtintype" id="4571907">int32</span><span class="op" id="4571912">(</span><span class="ident" id="4571913">n</span><span class="op" id="4571914">)</span>&nbsp;<span class="op" id="4571916">&gt;&gt;</span>&nbsp;<span class="num" id="4571919">31</span><span class="op" id="4571921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571925">mask</span>&nbsp;<span class="op" id="4571930">:=</span>&nbsp;<span class="ident" id="4571933">top4AllOnes</span>&nbsp;<span class="op" id="4571945">&amp;</span>&nbsp;<span class="op" id="4571947">(</span><span class="op" id="4571948">(</span><span class="ident" id="4571949">out3Equal</span>&nbsp;<span class="op" id="4571959">&amp;</span>&nbsp;<span class="ident" id="4571961">bottom3NonZero</span><span class="op" id="4571975">)</span>&nbsp;<span class="op" id="4571977">|</span>&nbsp;<span class="ident" id="4571979">out3GT</span><span class="op" id="4571985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571988">out</span><span class="op" id="4571991">[</span><span class="num" id="4571992">0</span><span class="op" id="4571993">]</span>&nbsp;<span class="op" id="4571995">-=</span>&nbsp;<span class="num" id="4571998">1</span>&nbsp;<span class="op" id="4572000">&amp;</span>&nbsp;<span class="ident" id="4572002">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572008">out</span><span class="op" id="4572011">[</span><span class="num" id="4572012">3</span><span class="op" id="4572013">]</span>&nbsp;<span class="op" id="4572015">-=</span>&nbsp;<span class="num" id="4572018">0xffff000</span>&nbsp;<span class="op" id="4572028">&amp;</span>&nbsp;<span class="ident" id="4572030">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572036">out</span><span class="op" id="4572039">[</span><span class="num" id="4572040">4</span><span class="op" id="4572041">]</span>&nbsp;<span class="op" id="4572043">-=</span>&nbsp;<span class="num" id="4572046">0xfffffff</span>&nbsp;<span class="op" id="4572056">&amp;</span>&nbsp;<span class="ident" id="4572058">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572064">out</span><span class="op" id="4572067">[</span><span class="num" id="4572068">5</span><span class="op" id="4572069">]</span>&nbsp;<span class="op" id="4572071">-=</span>&nbsp;<span class="num" id="4572074">0xfffffff</span>&nbsp;<span class="op" id="4572084">&amp;</span>&nbsp;<span class="ident" id="4572086">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572092">out</span><span class="op" id="4572095">[</span><span class="num" id="4572096">6</span><span class="op" id="4572097">]</span>&nbsp;<span class="op" id="4572099">-=</span>&nbsp;<span class="num" id="4572102">0xfffffff</span>&nbsp;<span class="op" id="4572112">&amp;</span>&nbsp;<span class="ident" id="4572114">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572120">out</span><span class="op" id="4572123">[</span><span class="num" id="4572124">7</span><span class="op" id="4572125">]</span>&nbsp;<span class="op" id="4572127">-=</span>&nbsp;<span class="num" id="4572130">0xfffffff</span>&nbsp;<span class="op" id="4572140">&amp;</span>&nbsp;<span class="ident" id="4572142">mask</span><br>
<span class="lineno">495</span><span class="op" id="4572147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4572150">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4572178">//</span><br>
<span class="lineno"></span><span class="comment" id="4572181">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4572257">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4572317">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4572370">func</span>&nbsp;<span class="ident" id="4572375">p224AddJacobian</span><span class="op" id="4572390">(</span><span class="ident" id="4572391">x3</span><span class="op" id="4572393">,</span>&nbsp;<span class="ident" id="4572395">y3</span><span class="op" id="4572397">,</span>&nbsp;<span class="ident" id="4572399">z3</span><span class="op" id="4572401">,</span>&nbsp;<span class="ident" id="4572403">x1</span><span class="op" id="4572405">,</span>&nbsp;<span class="ident" id="4572407">y1</span><span class="op" id="4572409">,</span>&nbsp;<span class="ident" id="4572411">z1</span><span class="op" id="4572413">,</span>&nbsp;<span class="ident" id="4572415">x2</span><span class="op" id="4572417">,</span>&nbsp;<span class="ident" id="4572419">y2</span><span class="op" id="4572421">,</span>&nbsp;<span class="ident" id="4572423">z2</span>&nbsp;<span class="op" id="4572426">*</span><span class="ident" id="4572427">p224FieldElement</span><span class="op" id="4572443">)</span>&nbsp;<span class="op" id="4572445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572448">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572542">var</span>&nbsp;<span class="ident" id="4572546">z1z1</span><span class="op" id="4572550">,</span>&nbsp;<span class="ident" id="4572552">z2z2</span><span class="op" id="4572556">,</span>&nbsp;<span class="ident" id="4572558">u1</span><span class="op" id="4572560">,</span>&nbsp;<span class="ident" id="4572562">u2</span><span class="op" id="4572564">,</span>&nbsp;<span class="ident" id="4572566">s1</span><span class="op" id="4572568">,</span>&nbsp;<span class="ident" id="4572570">s2</span><span class="op" id="4572572">,</span>&nbsp;<span class="ident" id="4572574">h</span><span class="op" id="4572575">,</span>&nbsp;<span class="ident" id="4572577">i</span><span class="op" id="4572578">,</span>&nbsp;<span class="ident" id="4572580">j</span><span class="op" id="4572581">,</span>&nbsp;<span class="ident" id="4572583">r</span><span class="op" id="4572584">,</span>&nbsp;<span class="ident" id="4572586">v</span>&nbsp;<span class="ident" id="4572588">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572606">var</span>&nbsp;<span class="ident" id="4572610">c</span>&nbsp;<span class="ident" id="4572612">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572636">z1IsZero</span>&nbsp;<span class="op" id="4572645">:=</span>&nbsp;<span class="ident" id="4572648">p224IsZero</span><span class="op" id="4572658">(</span><span class="ident" id="4572659">z1</span><span class="op" id="4572661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572664">z2IsZero</span>&nbsp;<span class="op" id="4572673">:=</span>&nbsp;<span class="ident" id="4572676">p224IsZero</span><span class="op" id="4572686">(</span><span class="ident" id="4572687">z2</span><span class="op" id="4572689">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572693">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572709">p224Square</span><span class="op" id="4572719">(</span><span class="op" id="4572720">&amp;</span><span class="ident" id="4572721">z1z1</span><span class="op" id="4572725">,</span>&nbsp;<span class="ident" id="4572727">z1</span><span class="op" id="4572729">,</span>&nbsp;<span class="op" id="4572731">&amp;</span><span class="ident" id="4572732">c</span><span class="op" id="4572733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572736">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572752">p224Square</span><span class="op" id="4572762">(</span><span class="op" id="4572763">&amp;</span><span class="ident" id="4572764">z2z2</span><span class="op" id="4572768">,</span>&nbsp;<span class="ident" id="4572770">z2</span><span class="op" id="4572772">,</span>&nbsp;<span class="op" id="4572774">&amp;</span><span class="ident" id="4572775">c</span><span class="op" id="4572776">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572779">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572796">p224Mul</span><span class="op" id="4572803">(</span><span class="op" id="4572804">&amp;</span><span class="ident" id="4572805">u1</span><span class="op" id="4572807">,</span>&nbsp;<span class="ident" id="4572809">x1</span><span class="op" id="4572811">,</span>&nbsp;<span class="op" id="4572813">&amp;</span><span class="ident" id="4572814">z2z2</span><span class="op" id="4572818">,</span>&nbsp;<span class="op" id="4572820">&amp;</span><span class="ident" id="4572821">c</span><span class="op" id="4572822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572825">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572842">p224Mul</span><span class="op" id="4572849">(</span><span class="op" id="4572850">&amp;</span><span class="ident" id="4572851">u2</span><span class="op" id="4572853">,</span>&nbsp;<span class="ident" id="4572855">x2</span><span class="op" id="4572857">,</span>&nbsp;<span class="op" id="4572859">&amp;</span><span class="ident" id="4572860">z1z1</span><span class="op" id="4572864">,</span>&nbsp;<span class="op" id="4572866">&amp;</span><span class="ident" id="4572867">c</span><span class="op" id="4572868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572871">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572891">p224Mul</span><span class="op" id="4572898">(</span><span class="op" id="4572899">&amp;</span><span class="ident" id="4572900">s1</span><span class="op" id="4572902">,</span>&nbsp;<span class="ident" id="4572904">z2</span><span class="op" id="4572906">,</span>&nbsp;<span class="op" id="4572908">&amp;</span><span class="ident" id="4572909">z2z2</span><span class="op" id="4572913">,</span>&nbsp;<span class="op" id="4572915">&amp;</span><span class="ident" id="4572916">c</span><span class="op" id="4572917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572920">p224Mul</span><span class="op" id="4572927">(</span><span class="op" id="4572928">&amp;</span><span class="ident" id="4572929">s1</span><span class="op" id="4572931">,</span>&nbsp;<span class="ident" id="4572933">y1</span><span class="op" id="4572935">,</span>&nbsp;<span class="op" id="4572937">&amp;</span><span class="ident" id="4572938">s1</span><span class="op" id="4572940">,</span>&nbsp;<span class="op" id="4572942">&amp;</span><span class="ident" id="4572943">c</span><span class="op" id="4572944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572947">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572967">p224Mul</span><span class="op" id="4572974">(</span><span class="op" id="4572975">&amp;</span><span class="ident" id="4572976">s2</span><span class="op" id="4572978">,</span>&nbsp;<span class="ident" id="4572980">z1</span><span class="op" id="4572982">,</span>&nbsp;<span class="op" id="4572984">&amp;</span><span class="ident" id="4572985">z1z1</span><span class="op" id="4572989">,</span>&nbsp;<span class="op" id="4572991">&amp;</span><span class="ident" id="4572992">c</span><span class="op" id="4572993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572996">p224Mul</span><span class="op" id="4573003">(</span><span class="op" id="4573004">&amp;</span><span class="ident" id="4573005">s2</span><span class="op" id="4573007">,</span>&nbsp;<span class="ident" id="4573009">y2</span><span class="op" id="4573011">,</span>&nbsp;<span class="op" id="4573013">&amp;</span><span class="ident" id="4573014">s2</span><span class="op" id="4573016">,</span>&nbsp;<span class="op" id="4573018">&amp;</span><span class="ident" id="4573019">c</span><span class="op" id="4573020">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573023">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573037">p224Sub</span><span class="op" id="4573044">(</span><span class="op" id="4573045">&amp;</span><span class="ident" id="4573046">h</span><span class="op" id="4573047">,</span>&nbsp;<span class="op" id="4573049">&amp;</span><span class="ident" id="4573050">u2</span><span class="op" id="4573052">,</span>&nbsp;<span class="op" id="4573054">&amp;</span><span class="ident" id="4573055">u1</span><span class="op" id="4573057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573060">p224Reduce</span><span class="op" id="4573070">(</span><span class="op" id="4573071">&amp;</span><span class="ident" id="4573072">h</span><span class="op" id="4573073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573076">xEqual</span>&nbsp;<span class="op" id="4573083">:=</span>&nbsp;<span class="ident" id="4573086">p224IsZero</span><span class="op" id="4573096">(</span><span class="op" id="4573097">&amp;</span><span class="ident" id="4573098">h</span><span class="op" id="4573099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573102">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573118">for</span>&nbsp;<span class="ident" id="4573122">j</span>&nbsp;<span class="op" id="4573124">:=</span>&nbsp;<span class="num" id="4573127">0</span><span class="op" id="4573128">;</span>&nbsp;<span class="ident" id="4573130">j</span>&nbsp;<span class="op" id="4573132">&lt;</span>&nbsp;<span class="num" id="4573134">8</span><span class="op" id="4573135">;</span>&nbsp;<span class="ident" id="4573137">j</span><span class="op" id="4573138">++</span>&nbsp;<span class="op" id="4573141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573145">i</span><span class="op" id="4573146">[</span><span class="ident" id="4573147">j</span><span class="op" id="4573148">]</span>&nbsp;<span class="op" id="4573150">=</span>&nbsp;<span class="ident" id="4573152">h</span><span class="op" id="4573153">[</span><span class="ident" id="4573154">j</span><span class="op" id="4573155">]</span>&nbsp;<span class="op" id="4573157">&lt;&lt;</span>&nbsp;<span class="num" id="4573160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573166">p224Reduce</span><span class="op" id="4573176">(</span><span class="op" id="4573177">&amp;</span><span class="ident" id="4573178">i</span><span class="op" id="4573179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573182">p224Square</span><span class="op" id="4573192">(</span><span class="op" id="4573193">&amp;</span><span class="ident" id="4573194">i</span><span class="op" id="4573195">,</span>&nbsp;<span class="op" id="4573197">&amp;</span><span class="ident" id="4573198">i</span><span class="op" id="4573199">,</span>&nbsp;<span class="op" id="4573201">&amp;</span><span class="ident" id="4573202">c</span><span class="op" id="4573203">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573206">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573218">p224Mul</span><span class="op" id="4573225">(</span><span class="op" id="4573226">&amp;</span><span class="ident" id="4573227">j</span><span class="op" id="4573228">,</span>&nbsp;<span class="op" id="4573230">&amp;</span><span class="ident" id="4573231">h</span><span class="op" id="4573232">,</span>&nbsp;<span class="op" id="4573234">&amp;</span><span class="ident" id="4573235">i</span><span class="op" id="4573236">,</span>&nbsp;<span class="op" id="4573238">&amp;</span><span class="ident" id="4573239">c</span><span class="op" id="4573240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573243">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573261">p224Sub</span><span class="op" id="4573268">(</span><span class="op" id="4573269">&amp;</span><span class="ident" id="4573270">r</span><span class="op" id="4573271">,</span>&nbsp;<span class="op" id="4573273">&amp;</span><span class="ident" id="4573274">s2</span><span class="op" id="4573276">,</span>&nbsp;<span class="op" id="4573278">&amp;</span><span class="ident" id="4573279">s1</span><span class="op" id="4573281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573284">p224Reduce</span><span class="op" id="4573294">(</span><span class="op" id="4573295">&amp;</span><span class="ident" id="4573296">r</span><span class="op" id="4573297">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573300">yEqual</span>&nbsp;<span class="op" id="4573307">:=</span>&nbsp;<span class="ident" id="4573310">p224IsZero</span><span class="op" id="4573320">(</span><span class="op" id="4573321">&amp;</span><span class="ident" id="4573322">r</span><span class="op" id="4573323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573326">if</span>&nbsp;<span class="ident" id="4573329">xEqual</span>&nbsp;<span class="op" id="4573336">==</span>&nbsp;<span class="num" id="4573339">1</span>&nbsp;<span class="op" id="4573341">&amp;&amp;</span>&nbsp;<span class="ident" id="4573344">yEqual</span>&nbsp;<span class="op" id="4573351">==</span>&nbsp;<span class="num" id="4573354">1</span>&nbsp;<span class="op" id="4573356">&amp;&amp;</span>&nbsp;<span class="ident" id="4573359">z1IsZero</span>&nbsp;<span class="op" id="4573368">==</span>&nbsp;<span class="num" id="4573371">0</span>&nbsp;<span class="op" id="4573373">&amp;&amp;</span>&nbsp;<span class="ident" id="4573376">z2IsZero</span>&nbsp;<span class="op" id="4573385">==</span>&nbsp;<span class="num" id="4573388">0</span>&nbsp;<span class="op" id="4573390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573394">p224DoubleJacobian</span><span class="op" id="4573412">(</span><span class="ident" id="4573413">x3</span><span class="op" id="4573415">,</span>&nbsp;<span class="ident" id="4573417">y3</span><span class="op" id="4573419">,</span>&nbsp;<span class="ident" id="4573421">z3</span><span class="op" id="4573423">,</span>&nbsp;<span class="ident" id="4573425">x1</span><span class="op" id="4573427">,</span>&nbsp;<span class="ident" id="4573429">y1</span><span class="op" id="4573431">,</span>&nbsp;<span class="ident" id="4573433">z1</span><span class="op" id="4573435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573447">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573450">for</span>&nbsp;<span class="ident" id="4573454">i</span>&nbsp;<span class="op" id="4573456">:=</span>&nbsp;<span class="num" id="4573459">0</span><span class="op" id="4573460">;</span>&nbsp;<span class="ident" id="4573462">i</span>&nbsp;<span class="op" id="4573464">&lt;</span>&nbsp;<span class="num" id="4573466">8</span><span class="op" id="4573467">;</span>&nbsp;<span class="ident" id="4573469">i</span><span class="op" id="4573470">++</span>&nbsp;<span class="op" id="4573473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573477">r</span><span class="op" id="4573478">[</span><span class="ident" id="4573479">i</span><span class="op" id="4573480">]</span>&nbsp;<span class="op" id="4573482">&lt;&lt;=</span>&nbsp;<span class="num" id="4573486">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573492">p224Reduce</span><span class="op" id="4573502">(</span><span class="op" id="4573503">&amp;</span><span class="ident" id="4573504">r</span><span class="op" id="4573505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573508">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573521">p224Mul</span><span class="op" id="4573528">(</span><span class="op" id="4573529">&amp;</span><span class="ident" id="4573530">v</span><span class="op" id="4573531">,</span>&nbsp;<span class="op" id="4573533">&amp;</span><span class="ident" id="4573534">u1</span><span class="op" id="4573536">,</span>&nbsp;<span class="op" id="4573538">&amp;</span><span class="ident" id="4573539">i</span><span class="op" id="4573540">,</span>&nbsp;<span class="op" id="4573542">&amp;</span><span class="ident" id="4573543">c</span><span class="op" id="4573544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573547">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573580">p224Add</span><span class="op" id="4573587">(</span><span class="op" id="4573588">&amp;</span><span class="ident" id="4573589">z1z1</span><span class="op" id="4573593">,</span>&nbsp;<span class="op" id="4573595">&amp;</span><span class="ident" id="4573596">z1z1</span><span class="op" id="4573600">,</span>&nbsp;<span class="op" id="4573602">&amp;</span><span class="ident" id="4573603">z2z2</span><span class="op" id="4573607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573610">p224Add</span><span class="op" id="4573617">(</span><span class="op" id="4573618">&amp;</span><span class="ident" id="4573619">z2z2</span><span class="op" id="4573623">,</span>&nbsp;<span class="ident" id="4573625">z1</span><span class="op" id="4573627">,</span>&nbsp;<span class="ident" id="4573629">z2</span><span class="op" id="4573631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573634">p224Reduce</span><span class="op" id="4573644">(</span><span class="op" id="4573645">&amp;</span><span class="ident" id="4573646">z2z2</span><span class="op" id="4573650">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573653">p224Square</span><span class="op" id="4573663">(</span><span class="op" id="4573664">&amp;</span><span class="ident" id="4573665">z2z2</span><span class="op" id="4573669">,</span>&nbsp;<span class="op" id="4573671">&amp;</span><span class="ident" id="4573672">z2z2</span><span class="op" id="4573676">,</span>&nbsp;<span class="op" id="4573678">&amp;</span><span class="ident" id="4573679">c</span><span class="op" id="4573680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573683">p224Sub</span><span class="op" id="4573690">(</span><span class="ident" id="4573691">z3</span><span class="op" id="4573693">,</span>&nbsp;<span class="op" id="4573695">&amp;</span><span class="ident" id="4573696">z2z2</span><span class="op" id="4573700">,</span>&nbsp;<span class="op" id="4573702">&amp;</span><span class="ident" id="4573703">z1z1</span><span class="op" id="4573707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573710">p224Reduce</span><span class="op" id="4573720">(</span><span class="ident" id="4573721">z3</span><span class="op" id="4573723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573726">p224Mul</span><span class="op" id="4573733">(</span><span class="ident" id="4573734">z3</span><span class="op" id="4573736">,</span>&nbsp;<span class="ident" id="4573738">z3</span><span class="op" id="4573740">,</span>&nbsp;<span class="op" id="4573742">&amp;</span><span class="ident" id="4573743">h</span><span class="op" id="4573744">,</span>&nbsp;<span class="op" id="4573746">&amp;</span><span class="ident" id="4573747">c</span><span class="op" id="4573748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573751">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573770">for</span>&nbsp;<span class="ident" id="4573774">i</span>&nbsp;<span class="op" id="4573776">:=</span>&nbsp;<span class="num" id="4573779">0</span><span class="op" id="4573780">;</span>&nbsp;<span class="ident" id="4573782">i</span>&nbsp;<span class="op" id="4573784">&lt;</span>&nbsp;<span class="num" id="4573786">8</span><span class="op" id="4573787">;</span>&nbsp;<span class="ident" id="4573789">i</span><span class="op" id="4573790">++</span>&nbsp;<span class="op" id="4573793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573797">z1z1</span><span class="op" id="4573801">[</span><span class="ident" id="4573802">i</span><span class="op" id="4573803">]</span>&nbsp;<span class="op" id="4573805">=</span>&nbsp;<span class="ident" id="4573807">v</span><span class="op" id="4573808">[</span><span class="ident" id="4573809">i</span><span class="op" id="4573810">]</span>&nbsp;<span class="op" id="4573812">&lt;&lt;</span>&nbsp;<span class="num" id="4573815">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573821">p224Add</span><span class="op" id="4573828">(</span><span class="op" id="4573829">&amp;</span><span class="ident" id="4573830">z1z1</span><span class="op" id="4573834">,</span>&nbsp;<span class="op" id="4573836">&amp;</span><span class="ident" id="4573837">j</span><span class="op" id="4573838">,</span>&nbsp;<span class="op" id="4573840">&amp;</span><span class="ident" id="4573841">z1z1</span><span class="op" id="4573845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573848">p224Reduce</span><span class="op" id="4573858">(</span><span class="op" id="4573859">&amp;</span><span class="ident" id="4573860">z1z1</span><span class="op" id="4573864">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573867">p224Square</span><span class="op" id="4573877">(</span><span class="ident" id="4573878">x3</span><span class="op" id="4573880">,</span>&nbsp;<span class="op" id="4573882">&amp;</span><span class="ident" id="4573883">r</span><span class="op" id="4573884">,</span>&nbsp;<span class="op" id="4573886">&amp;</span><span class="ident" id="4573887">c</span><span class="op" id="4573888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573891">p224Sub</span><span class="op" id="4573898">(</span><span class="ident" id="4573899">x3</span><span class="op" id="4573901">,</span>&nbsp;<span class="ident" id="4573903">x3</span><span class="op" id="4573905">,</span>&nbsp;<span class="op" id="4573907">&amp;</span><span class="ident" id="4573908">z1z1</span><span class="op" id="4573912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573915">p224Reduce</span><span class="op" id="4573925">(</span><span class="ident" id="4573926">x3</span><span class="op" id="4573928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4573931">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573956">for</span>&nbsp;<span class="ident" id="4573960">i</span>&nbsp;<span class="op" id="4573962">:=</span>&nbsp;<span class="num" id="4573965">0</span><span class="op" id="4573966">;</span>&nbsp;<span class="ident" id="4573968">i</span>&nbsp;<span class="op" id="4573970">&lt;</span>&nbsp;<span class="num" id="4573972">8</span><span class="op" id="4573973">;</span>&nbsp;<span class="ident" id="4573975">i</span><span class="op" id="4573976">++</span>&nbsp;<span class="op" id="4573979">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573983">s1</span><span class="op" id="4573985">[</span><span class="ident" id="4573986">i</span><span class="op" id="4573987">]</span>&nbsp;<span class="op" id="4573989">&lt;&lt;=</span>&nbsp;<span class="num" id="4573993">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573999">p224Mul</span><span class="op" id="4574006">(</span><span class="op" id="4574007">&amp;</span><span class="ident" id="4574008">s1</span><span class="op" id="4574010">,</span>&nbsp;<span class="op" id="4574012">&amp;</span><span class="ident" id="4574013">s1</span><span class="op" id="4574015">,</span>&nbsp;<span class="op" id="4574017">&amp;</span><span class="ident" id="4574018">j</span><span class="op" id="4574019">,</span>&nbsp;<span class="op" id="4574021">&amp;</span><span class="ident" id="4574022">c</span><span class="op" id="4574023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574026">p224Sub</span><span class="op" id="4574033">(</span><span class="op" id="4574034">&amp;</span><span class="ident" id="4574035">z1z1</span><span class="op" id="4574039">,</span>&nbsp;<span class="op" id="4574041">&amp;</span><span class="ident" id="4574042">v</span><span class="op" id="4574043">,</span>&nbsp;<span class="ident" id="4574045">x3</span><span class="op" id="4574047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574050">p224Reduce</span><span class="op" id="4574060">(</span><span class="op" id="4574061">&amp;</span><span class="ident" id="4574062">z1z1</span><span class="op" id="4574066">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574069">p224Mul</span><span class="op" id="4574076">(</span><span class="op" id="4574077">&amp;</span><span class="ident" id="4574078">z1z1</span><span class="op" id="4574082">,</span>&nbsp;<span class="op" id="4574084">&amp;</span><span class="ident" id="4574085">z1z1</span><span class="op" id="4574089">,</span>&nbsp;<span class="op" id="4574091">&amp;</span><span class="ident" id="4574092">r</span><span class="op" id="4574093">,</span>&nbsp;<span class="op" id="4574095">&amp;</span><span class="ident" id="4574096">c</span><span class="op" id="4574097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574100">p224Sub</span><span class="op" id="4574107">(</span><span class="ident" id="4574108">y3</span><span class="op" id="4574110">,</span>&nbsp;<span class="op" id="4574112">&amp;</span><span class="ident" id="4574113">z1z1</span><span class="op" id="4574117">,</span>&nbsp;<span class="op" id="4574119">&amp;</span><span class="ident" id="4574120">s1</span><span class="op" id="4574122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574125">p224Reduce</span><span class="op" id="4574135">(</span><span class="ident" id="4574136">y3</span><span class="op" id="4574138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574142">p224CopyConditional</span><span class="op" id="4574161">(</span><span class="ident" id="4574162">x3</span><span class="op" id="4574164">,</span>&nbsp;<span class="ident" id="4574166">x2</span><span class="op" id="4574168">,</span>&nbsp;<span class="ident" id="4574170">z1IsZero</span><span class="op" id="4574178">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574181">p224CopyConditional</span><span class="op" id="4574200">(</span><span class="ident" id="4574201">x3</span><span class="op" id="4574203">,</span>&nbsp;<span class="ident" id="4574205">x1</span><span class="op" id="4574207">,</span>&nbsp;<span class="ident" id="4574209">z2IsZero</span><span class="op" id="4574217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574220">p224CopyConditional</span><span class="op" id="4574239">(</span><span class="ident" id="4574240">y3</span><span class="op" id="4574242">,</span>&nbsp;<span class="ident" id="4574244">y2</span><span class="op" id="4574246">,</span>&nbsp;<span class="ident" id="4574248">z1IsZero</span><span class="op" id="4574256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574259">p224CopyConditional</span><span class="op" id="4574278">(</span><span class="ident" id="4574279">y3</span><span class="op" id="4574281">,</span>&nbsp;<span class="ident" id="4574283">y1</span><span class="op" id="4574285">,</span>&nbsp;<span class="ident" id="4574287">z2IsZero</span><span class="op" id="4574295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574298">p224CopyConditional</span><span class="op" id="4574317">(</span><span class="ident" id="4574318">z3</span><span class="op" id="4574320">,</span>&nbsp;<span class="ident" id="4574322">z2</span><span class="op" id="4574324">,</span>&nbsp;<span class="ident" id="4574326">z1IsZero</span><span class="op" id="4574334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574337">p224CopyConditional</span><span class="op" id="4574356">(</span><span class="ident" id="4574357">z3</span><span class="op" id="4574359">,</span>&nbsp;<span class="ident" id="4574361">z1</span><span class="op" id="4574363">,</span>&nbsp;<span class="ident" id="4574365">z2IsZero</span><span class="op" id="4574373">)</span><br>
<span class="lineno">585</span><span class="op" id="4574375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4574378">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4574421">func</span>&nbsp;<span class="ident" id="4574426">p224DoubleJacobian</span><span class="op" id="4574444">(</span><span class="ident" id="4574445">x3</span><span class="op" id="4574447">,</span>&nbsp;<span class="ident" id="4574449">y3</span><span class="op" id="4574451">,</span>&nbsp;<span class="ident" id="4574453">z3</span><span class="op" id="4574455">,</span>&nbsp;<span class="ident" id="4574457">x1</span><span class="op" id="4574459">,</span>&nbsp;<span class="ident" id="4574461">y1</span><span class="op" id="4574463">,</span>&nbsp;<span class="ident" id="4574465">z1</span>&nbsp;<span class="op" id="4574468">*</span><span class="ident" id="4574469">p224FieldElement</span><span class="op" id="4574485">)</span>&nbsp;<span class="op" id="4574487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574490">var</span>&nbsp;<span class="ident" id="4574494">delta</span><span class="op" id="4574499">,</span>&nbsp;<span class="ident" id="4574501">gamma</span><span class="op" id="4574506">,</span>&nbsp;<span class="ident" id="4574508">beta</span><span class="op" id="4574512">,</span>&nbsp;<span class="ident" id="4574514">alpha</span><span class="op" id="4574519">,</span>&nbsp;<span class="ident" id="4574521">t</span>&nbsp;<span class="ident" id="4574523">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574541">var</span>&nbsp;<span class="ident" id="4574545">c</span>&nbsp;<span class="ident" id="4574547">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574571">p224Square</span><span class="op" id="4574581">(</span><span class="op" id="4574582">&amp;</span><span class="ident" id="4574583">delta</span><span class="op" id="4574588">,</span>&nbsp;<span class="ident" id="4574590">z1</span><span class="op" id="4574592">,</span>&nbsp;<span class="op" id="4574594">&amp;</span><span class="ident" id="4574595">c</span><span class="op" id="4574596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574599">p224Square</span><span class="op" id="4574609">(</span><span class="op" id="4574610">&amp;</span><span class="ident" id="4574611">gamma</span><span class="op" id="4574616">,</span>&nbsp;<span class="ident" id="4574618">y1</span><span class="op" id="4574620">,</span>&nbsp;<span class="op" id="4574622">&amp;</span><span class="ident" id="4574623">c</span><span class="op" id="4574624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574627">p224Mul</span><span class="op" id="4574634">(</span><span class="op" id="4574635">&amp;</span><span class="ident" id="4574636">beta</span><span class="op" id="4574640">,</span>&nbsp;<span class="ident" id="4574642">x1</span><span class="op" id="4574644">,</span>&nbsp;<span class="op" id="4574646">&amp;</span><span class="ident" id="4574647">gamma</span><span class="op" id="4574652">,</span>&nbsp;<span class="op" id="4574654">&amp;</span><span class="ident" id="4574655">c</span><span class="op" id="4574656">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4574660">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574696">p224Add</span><span class="op" id="4574703">(</span><span class="op" id="4574704">&amp;</span><span class="ident" id="4574705">t</span><span class="op" id="4574706">,</span>&nbsp;<span class="ident" id="4574708">x1</span><span class="op" id="4574710">,</span>&nbsp;<span class="op" id="4574712">&amp;</span><span class="ident" id="4574713">delta</span><span class="op" id="4574718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574721">for</span>&nbsp;<span class="ident" id="4574725">i</span>&nbsp;<span class="op" id="4574727">:=</span>&nbsp;<span class="num" id="4574730">0</span><span class="op" id="4574731">;</span>&nbsp;<span class="ident" id="4574733">i</span>&nbsp;<span class="op" id="4574735">&lt;</span>&nbsp;<span class="num" id="4574737">8</span><span class="op" id="4574738">;</span>&nbsp;<span class="ident" id="4574740">i</span><span class="op" id="4574741">++</span>&nbsp;<span class="op" id="4574744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574748">t</span><span class="op" id="4574749">[</span><span class="ident" id="4574750">i</span><span class="op" id="4574751">]</span>&nbsp;<span class="op" id="4574753">+=</span>&nbsp;<span class="ident" id="4574756">t</span><span class="op" id="4574757">[</span><span class="ident" id="4574758">i</span><span class="op" id="4574759">]</span>&nbsp;<span class="op" id="4574761">&lt;&lt;</span>&nbsp;<span class="num" id="4574764">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574770">p224Reduce</span><span class="op" id="4574780">(</span><span class="op" id="4574781">&amp;</span><span class="ident" id="4574782">t</span><span class="op" id="4574783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574786">p224Sub</span><span class="op" id="4574793">(</span><span class="op" id="4574794">&amp;</span><span class="ident" id="4574795">alpha</span><span class="op" id="4574800">,</span>&nbsp;<span class="ident" id="4574802">x1</span><span class="op" id="4574804">,</span>&nbsp;<span class="op" id="4574806">&amp;</span><span class="ident" id="4574807">delta</span><span class="op" id="4574812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574815">p224Reduce</span><span class="op" id="4574825">(</span><span class="op" id="4574826">&amp;</span><span class="ident" id="4574827">alpha</span><span class="op" id="4574832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574835">p224Mul</span><span class="op" id="4574842">(</span><span class="op" id="4574843">&amp;</span><span class="ident" id="4574844">alpha</span><span class="op" id="4574849">,</span>&nbsp;<span class="op" id="4574851">&amp;</span><span class="ident" id="4574852">alpha</span><span class="op" id="4574857">,</span>&nbsp;<span class="op" id="4574859">&amp;</span><span class="ident" id="4574860">t</span><span class="op" id="4574861">,</span>&nbsp;<span class="op" id="4574863">&amp;</span><span class="ident" id="4574864">c</span><span class="op" id="4574865">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4574869">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574900">p224Add</span><span class="op" id="4574907">(</span><span class="ident" id="4574908">z3</span><span class="op" id="4574910">,</span>&nbsp;<span class="ident" id="4574912">y1</span><span class="op" id="4574914">,</span>&nbsp;<span class="ident" id="4574916">z1</span><span class="op" id="4574918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574921">p224Reduce</span><span class="op" id="4574931">(</span><span class="ident" id="4574932">z3</span><span class="op" id="4574934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574937">p224Square</span><span class="op" id="4574947">(</span><span class="ident" id="4574948">z3</span><span class="op" id="4574950">,</span>&nbsp;<span class="ident" id="4574952">z3</span><span class="op" id="4574954">,</span>&nbsp;<span class="op" id="4574956">&amp;</span><span class="ident" id="4574957">c</span><span class="op" id="4574958">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574961">p224Sub</span><span class="op" id="4574968">(</span><span class="ident" id="4574969">z3</span><span class="op" id="4574971">,</span>&nbsp;<span class="ident" id="4574973">z3</span><span class="op" id="4574975">,</span>&nbsp;<span class="op" id="4574977">&amp;</span><span class="ident" id="4574978">gamma</span><span class="op" id="4574983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574986">p224Reduce</span><span class="op" id="4574996">(</span><span class="ident" id="4574997">z3</span><span class="op" id="4574999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575002">p224Sub</span><span class="op" id="4575009">(</span><span class="ident" id="4575010">z3</span><span class="op" id="4575012">,</span>&nbsp;<span class="ident" id="4575014">z3</span><span class="op" id="4575016">,</span>&nbsp;<span class="op" id="4575018">&amp;</span><span class="ident" id="4575019">delta</span><span class="op" id="4575024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575027">p224Reduce</span><span class="op" id="4575037">(</span><span class="ident" id="4575038">z3</span><span class="op" id="4575040">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4575044">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575068">for</span>&nbsp;<span class="ident" id="4575072">i</span>&nbsp;<span class="op" id="4575074">:=</span>&nbsp;<span class="num" id="4575077">0</span><span class="op" id="4575078">;</span>&nbsp;<span class="ident" id="4575080">i</span>&nbsp;<span class="op" id="4575082">&lt;</span>&nbsp;<span class="num" id="4575084">8</span><span class="op" id="4575085">;</span>&nbsp;<span class="ident" id="4575087">i</span><span class="op" id="4575088">++</span>&nbsp;<span class="op" id="4575091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575095">delta</span><span class="op" id="4575100">[</span><span class="ident" id="4575101">i</span><span class="op" id="4575102">]</span>&nbsp;<span class="op" id="4575104">=</span>&nbsp;<span class="ident" id="4575106">beta</span><span class="op" id="4575110">[</span><span class="ident" id="4575111">i</span><span class="op" id="4575112">]</span>&nbsp;<span class="op" id="4575114">&lt;&lt;</span>&nbsp;<span class="num" id="4575117">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575123">p224Reduce</span><span class="op" id="4575133">(</span><span class="op" id="4575134">&amp;</span><span class="ident" id="4575135">delta</span><span class="op" id="4575140">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575143">p224Square</span><span class="op" id="4575153">(</span><span class="ident" id="4575154">x3</span><span class="op" id="4575156">,</span>&nbsp;<span class="op" id="4575158">&amp;</span><span class="ident" id="4575159">alpha</span><span class="op" id="4575164">,</span>&nbsp;<span class="op" id="4575166">&amp;</span><span class="ident" id="4575167">c</span><span class="op" id="4575168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575171">p224Sub</span><span class="op" id="4575178">(</span><span class="ident" id="4575179">x3</span><span class="op" id="4575181">,</span>&nbsp;<span class="ident" id="4575183">x3</span><span class="op" id="4575185">,</span>&nbsp;<span class="op" id="4575187">&amp;</span><span class="ident" id="4575188">delta</span><span class="op" id="4575193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575196">p224Reduce</span><span class="op" id="4575206">(</span><span class="ident" id="4575207">x3</span><span class="op" id="4575209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4575213">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575250">for</span>&nbsp;<span class="ident" id="4575254">i</span>&nbsp;<span class="op" id="4575256">:=</span>&nbsp;<span class="num" id="4575259">0</span><span class="op" id="4575260">;</span>&nbsp;<span class="ident" id="4575262">i</span>&nbsp;<span class="op" id="4575264">&lt;</span>&nbsp;<span class="num" id="4575266">8</span><span class="op" id="4575267">;</span>&nbsp;<span class="ident" id="4575269">i</span><span class="op" id="4575270">++</span>&nbsp;<span class="op" id="4575273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575277">beta</span><span class="op" id="4575281">[</span><span class="ident" id="4575282">i</span><span class="op" id="4575283">]</span>&nbsp;<span class="op" id="4575285">&lt;&lt;=</span>&nbsp;<span class="num" id="4575289">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575295">p224Sub</span><span class="op" id="4575302">(</span><span class="op" id="4575303">&amp;</span><span class="ident" id="4575304">beta</span><span class="op" id="4575308">,</span>&nbsp;<span class="op" id="4575310">&amp;</span><span class="ident" id="4575311">beta</span><span class="op" id="4575315">,</span>&nbsp;<span class="ident" id="4575317">x3</span><span class="op" id="4575319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575322">p224Reduce</span><span class="op" id="4575332">(</span><span class="op" id="4575333">&amp;</span><span class="ident" id="4575334">beta</span><span class="op" id="4575338">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575341">p224Square</span><span class="op" id="4575351">(</span><span class="op" id="4575352">&amp;</span><span class="ident" id="4575353">gamma</span><span class="op" id="4575358">,</span>&nbsp;<span class="op" id="4575360">&amp;</span><span class="ident" id="4575361">gamma</span><span class="op" id="4575366">,</span>&nbsp;<span class="op" id="4575368">&amp;</span><span class="ident" id="4575369">c</span><span class="op" id="4575370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575373">for</span>&nbsp;<span class="ident" id="4575377">i</span>&nbsp;<span class="op" id="4575379">:=</span>&nbsp;<span class="num" id="4575382">0</span><span class="op" id="4575383">;</span>&nbsp;<span class="ident" id="4575385">i</span>&nbsp;<span class="op" id="4575387">&lt;</span>&nbsp;<span class="num" id="4575389">8</span><span class="op" id="4575390">;</span>&nbsp;<span class="ident" id="4575392">i</span><span class="op" id="4575393">++</span>&nbsp;<span class="op" id="4575396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575400">gamma</span><span class="op" id="4575405">[</span><span class="ident" id="4575406">i</span><span class="op" id="4575407">]</span>&nbsp;<span class="op" id="4575409">&lt;&lt;=</span>&nbsp;<span class="num" id="4575413">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575419">p224Reduce</span><span class="op" id="4575429">(</span><span class="op" id="4575430">&amp;</span><span class="ident" id="4575431">gamma</span><span class="op" id="4575436">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575439">p224Mul</span><span class="op" id="4575446">(</span><span class="ident" id="4575447">y3</span><span class="op" id="4575449">,</span>&nbsp;<span class="op" id="4575451">&amp;</span><span class="ident" id="4575452">alpha</span><span class="op" id="4575457">,</span>&nbsp;<span class="op" id="4575459">&amp;</span><span class="ident" id="4575460">beta</span><span class="op" id="4575464">,</span>&nbsp;<span class="op" id="4575466">&amp;</span><span class="ident" id="4575467">c</span><span class="op" id="4575468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575471">p224Sub</span><span class="op" id="4575478">(</span><span class="ident" id="4575479">y3</span><span class="op" id="4575481">,</span>&nbsp;<span class="ident" id="4575483">y3</span><span class="op" id="4575485">,</span>&nbsp;<span class="op" id="4575487">&amp;</span><span class="ident" id="4575488">gamma</span><span class="op" id="4575493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575496">p224Reduce</span><span class="op" id="4575506">(</span><span class="ident" id="4575507">y3</span><span class="op" id="4575509">)</span><br>
<span class="lineno"></span><span class="op" id="4575511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4575514">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4575594">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4575636">func</span>&nbsp;<span class="ident" id="4575641">p224CopyConditional</span><span class="op" id="4575660">(</span><span class="ident" id="4575661">out</span><span class="op" id="4575664">,</span>&nbsp;<span class="ident" id="4575666">in</span>&nbsp;<span class="op" id="4575669">*</span><span class="ident" id="4575670">p224FieldElement</span><span class="op" id="4575686">,</span>&nbsp;<span class="ident" id="4575688">control</span>&nbsp;<span class="builtintype" id="4575696">uint32</span><span class="op" id="4575702">)</span>&nbsp;<span class="op" id="4575704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575707">control</span>&nbsp;<span class="op" id="4575715">&lt;&lt;=</span>&nbsp;<span class="num" id="4575719">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575723">control</span>&nbsp;<span class="op" id="4575731">=</span>&nbsp;<span class="builtintype" id="4575733">uint32</span><span class="op" id="4575739">(</span><span class="builtintype" id="4575740">int32</span><span class="op" id="4575745">(</span><span class="ident" id="4575746">control</span><span class="op" id="4575753">)</span>&nbsp;<span class="op" id="4575755">&gt;&gt;</span>&nbsp;<span class="num" id="4575758">31</span><span class="op" id="4575760">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575764">for</span>&nbsp;<span class="ident" id="4575768">i</span>&nbsp;<span class="op" id="4575770">:=</span>&nbsp;<span class="num" id="4575773">0</span><span class="op" id="4575774">;</span>&nbsp;<span class="ident" id="4575776">i</span>&nbsp;<span class="op" id="4575778">&lt;</span>&nbsp;<span class="num" id="4575780">8</span><span class="op" id="4575781">;</span>&nbsp;<span class="ident" id="4575783">i</span><span class="op" id="4575784">++</span>&nbsp;<span class="op" id="4575787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575791">out</span><span class="op" id="4575794">[</span><span class="ident" id="4575795">i</span><span class="op" id="4575796">]</span>&nbsp;<span class="op" id="4575798">^=</span>&nbsp;<span class="op" id="4575801">(</span><span class="ident" id="4575802">out</span><span class="op" id="4575805">[</span><span class="ident" id="4575806">i</span><span class="op" id="4575807">]</span>&nbsp;<span class="op" id="4575809">^</span>&nbsp;<span class="ident" id="4575811">in</span><span class="op" id="4575813">[</span><span class="ident" id="4575814">i</span><span class="op" id="4575815">]</span><span class="op" id="4575816">)</span>&nbsp;<span class="op" id="4575818">&amp;</span>&nbsp;<span class="ident" id="4575820">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575829">}</span><br>
<span class="lineno"></span><span class="op" id="4575831">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4575834">func</span>&nbsp;<span class="ident" id="4575839">p224ScalarMult</span><span class="op" id="4575853">(</span><span class="ident" id="4575854">outX</span><span class="op" id="4575858">,</span>&nbsp;<span class="ident" id="4575860">outY</span><span class="op" id="4575864">,</span>&nbsp;<span class="ident" id="4575866">outZ</span><span class="op" id="4575870">,</span>&nbsp;<span class="ident" id="4575872">inX</span><span class="op" id="4575875">,</span>&nbsp;<span class="ident" id="4575877">inY</span><span class="op" id="4575880">,</span>&nbsp;<span class="ident" id="4575882">inZ</span>&nbsp;<span class="op" id="4575886">*</span><span class="ident" id="4575887">p224FieldElement</span><span class="op" id="4575903">,</span>&nbsp;<span class="ident" id="4575905">scalar</span>&nbsp;<span class="op" id="4575912">[</span><span class="op" id="4575913">]</span><span class="builtintype" id="4575914">byte</span><span class="op" id="4575918">)</span>&nbsp;<span class="op" id="4575920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575923">var</span>&nbsp;<span class="ident" id="4575927">xx</span><span class="op" id="4575929">,</span>&nbsp;<span class="ident" id="4575931">yy</span><span class="op" id="4575933">,</span>&nbsp;<span class="ident" id="4575935">zz</span>&nbsp;<span class="ident" id="4575938">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575956">for</span>&nbsp;<span class="ident" id="4575960">i</span>&nbsp;<span class="op" id="4575962">:=</span>&nbsp;<span class="num" id="4575965">0</span><span class="op" id="4575966">;</span>&nbsp;<span class="ident" id="4575968">i</span>&nbsp;<span class="op" id="4575970">&lt;</span>&nbsp;<span class="num" id="4575972">8</span><span class="op" id="4575973">;</span>&nbsp;<span class="ident" id="4575975">i</span><span class="op" id="4575976">++</span>&nbsp;<span class="op" id="4575979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575983">outX</span><span class="op" id="4575987">[</span><span class="ident" id="4575988">i</span><span class="op" id="4575989">]</span>&nbsp;<span class="op" id="4575991">=</span>&nbsp;<span class="num" id="4575993">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575997">outY</span><span class="op" id="4576001">[</span><span class="ident" id="4576002">i</span><span class="op" id="4576003">]</span>&nbsp;<span class="op" id="4576005">=</span>&nbsp;<span class="num" id="4576007">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576011">outZ</span><span class="op" id="4576015">[</span><span class="ident" id="4576016">i</span><span class="op" id="4576017">]</span>&nbsp;<span class="op" id="4576019">=</span>&nbsp;<span class="num" id="4576021">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576028">for</span>&nbsp;<span class="ident" id="4576032">_</span><span class="op" id="4576033">,</span>&nbsp;<span class="builtintype" id="4576035">byte</span>&nbsp;<span class="op" id="4576040">:=</span>&nbsp;<span class="keyword" id="4576043">range</span>&nbsp;<span class="ident" id="4576049">scalar</span>&nbsp;<span class="op" id="4576056">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576060">for</span>&nbsp;<span class="ident" id="4576064">bitNum</span>&nbsp;<span class="op" id="4576071">:=</span>&nbsp;<span class="builtintype" id="4576074">uint</span><span class="op" id="4576078">(</span><span class="num" id="4576079">0</span><span class="op" id="4576080">)</span><span class="op" id="4576081">;</span>&nbsp;<span class="ident" id="4576083">bitNum</span>&nbsp;<span class="op" id="4576090">&lt;</span>&nbsp;<span class="num" id="4576092">8</span><span class="op" id="4576093">;</span>&nbsp;<span class="ident" id="4576095">bitNum</span><span class="op" id="4576101">++</span>&nbsp;<span class="op" id="4576104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576109">p224DoubleJacobian</span><span class="op" id="4576127">(</span><span class="ident" id="4576128">outX</span><span class="op" id="4576132">,</span>&nbsp;<span class="ident" id="4576134">outY</span><span class="op" id="4576138">,</span>&nbsp;<span class="ident" id="4576140">outZ</span><span class="op" id="4576144">,</span>&nbsp;<span class="ident" id="4576146">outX</span><span class="op" id="4576150">,</span>&nbsp;<span class="ident" id="4576152">outY</span><span class="op" id="4576156">,</span>&nbsp;<span class="ident" id="4576158">outZ</span><span class="op" id="4576162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576167">bit</span>&nbsp;<span class="op" id="4576171">:=</span>&nbsp;<span class="builtintype" id="4576174">uint32</span><span class="op" id="4576180">(</span><span class="op" id="4576181">(</span><span class="builtintype" id="4576182">byte</span>&nbsp;<span class="op" id="4576187">&gt;&gt;</span>&nbsp;<span class="op" id="4576190">(</span><span class="num" id="4576191">7</span>&nbsp;<span class="op" id="4576193">-</span>&nbsp;<span class="ident" id="4576195">bitNum</span><span class="op" id="4576201">)</span><span class="op" id="4576202">)</span>&nbsp;<span class="op" id="4576204">&amp;</span>&nbsp;<span class="num" id="4576206">1</span><span class="op" id="4576207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576212">p224AddJacobian</span><span class="op" id="4576227">(</span><span class="op" id="4576228">&amp;</span><span class="ident" id="4576229">xx</span><span class="op" id="4576231">,</span>&nbsp;<span class="op" id="4576233">&amp;</span><span class="ident" id="4576234">yy</span><span class="op" id="4576236">,</span>&nbsp;<span class="op" id="4576238">&amp;</span><span class="ident" id="4576239">zz</span><span class="op" id="4576241">,</span>&nbsp;<span class="ident" id="4576243">inX</span><span class="op" id="4576246">,</span>&nbsp;<span class="ident" id="4576248">inY</span><span class="op" id="4576251">,</span>&nbsp;<span class="ident" id="4576253">inZ</span><span class="op" id="4576256">,</span>&nbsp;<span class="ident" id="4576258">outX</span><span class="op" id="4576262">,</span>&nbsp;<span class="ident" id="4576264">outY</span><span class="op" id="4576268">,</span>&nbsp;<span class="ident" id="4576270">outZ</span><span class="op" id="4576274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576279">p224CopyConditional</span><span class="op" id="4576298">(</span><span class="ident" id="4576299">outX</span><span class="op" id="4576303">,</span>&nbsp;<span class="op" id="4576305">&amp;</span><span class="ident" id="4576306">xx</span><span class="op" id="4576308">,</span>&nbsp;<span class="ident" id="4576310">bit</span><span class="op" id="4576313">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576318">p224CopyConditional</span><span class="op" id="4576337">(</span><span class="ident" id="4576338">outY</span><span class="op" id="4576342">,</span>&nbsp;<span class="op" id="4576344">&amp;</span><span class="ident" id="4576345">yy</span><span class="op" id="4576347">,</span>&nbsp;<span class="ident" id="4576349">bit</span><span class="op" id="4576352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576357">p224CopyConditional</span><span class="op" id="4576376">(</span><span class="ident" id="4576377">outZ</span><span class="op" id="4576381">,</span>&nbsp;<span class="op" id="4576383">&amp;</span><span class="ident" id="4576384">zz</span><span class="op" id="4576386">,</span>&nbsp;<span class="ident" id="4576388">bit</span><span class="op" id="4576391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576398">}</span><br>
<span class="lineno"></span><span class="op" id="4576400">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4576403">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4576458">func</span>&nbsp;<span class="ident" id="4576463">p224ToAffine</span><span class="op" id="4576475">(</span><span class="ident" id="4576476">x</span><span class="op" id="4576477">,</span>&nbsp;<span class="ident" id="4576479">y</span><span class="op" id="4576480">,</span>&nbsp;<span class="ident" id="4576482">z</span>&nbsp;<span class="op" id="4576484">*</span><span class="ident" id="4576485">p224FieldElement</span><span class="op" id="4576501">)</span>&nbsp;<span class="op" id="4576503">(</span><span class="op" id="4576504">*</span><span class="ident" id="4576505">big</span><span class="op" id="4576508">.</span><span class="ident" id="4576509">Int</span><span class="op" id="4576512">,</span>&nbsp;<span class="op" id="4576514">*</span><span class="ident" id="4576515">big</span><span class="op" id="4576518">.</span><span class="ident" id="4576519">Int</span><span class="op" id="4576522">)</span>&nbsp;<span class="op" id="4576524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576527">var</span>&nbsp;<span class="ident" id="4576531">zinv</span><span class="op" id="4576535">,</span>&nbsp;<span class="ident" id="4576537">zinvsq</span><span class="op" id="4576543">,</span>&nbsp;<span class="ident" id="4576545">outx</span><span class="op" id="4576549">,</span>&nbsp;<span class="ident" id="4576551">outy</span>&nbsp;<span class="ident" id="4576556">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576574">var</span>&nbsp;<span class="ident" id="4576578">tmp</span>&nbsp;<span class="ident" id="4576582">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576606">if</span>&nbsp;<span class="ident" id="4576609">isPointAtInfinity</span>&nbsp;<span class="op" id="4576627">:=</span>&nbsp;<span class="ident" id="4576630">p224IsZero</span><span class="op" id="4576640">(</span><span class="ident" id="4576641">z</span><span class="op" id="4576642">)</span><span class="op" id="4576643">;</span>&nbsp;<span class="ident" id="4576645">isPointAtInfinity</span>&nbsp;<span class="op" id="4576663">==</span>&nbsp;<span class="num" id="4576666">1</span>&nbsp;<span class="op" id="4576668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576672">return</span>&nbsp;<span class="builtinfunc" id="4576679">new</span><span class="op" id="4576682">(</span><span class="ident" id="4576683">big</span><span class="op" id="4576686">.</span><span class="ident" id="4576687">Int</span><span class="op" id="4576690">)</span><span class="op" id="4576691">,</span>&nbsp;<span class="builtinfunc" id="4576693">new</span><span class="op" id="4576696">(</span><span class="ident" id="4576697">big</span><span class="op" id="4576700">.</span><span class="ident" id="4576701">Int</span><span class="op" id="4576704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576711">p224Invert</span><span class="op" id="4576721">(</span><span class="op" id="4576722">&amp;</span><span class="ident" id="4576723">zinv</span><span class="op" id="4576727">,</span>&nbsp;<span class="ident" id="4576729">z</span><span class="op" id="4576730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576733">p224Square</span><span class="op" id="4576743">(</span><span class="op" id="4576744">&amp;</span><span class="ident" id="4576745">zinvsq</span><span class="op" id="4576751">,</span>&nbsp;<span class="op" id="4576753">&amp;</span><span class="ident" id="4576754">zinv</span><span class="op" id="4576758">,</span>&nbsp;<span class="op" id="4576760">&amp;</span><span class="ident" id="4576761">tmp</span><span class="op" id="4576764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576767">p224Mul</span><span class="op" id="4576774">(</span><span class="ident" id="4576775">x</span><span class="op" id="4576776">,</span>&nbsp;<span class="ident" id="4576778">x</span><span class="op" id="4576779">,</span>&nbsp;<span class="op" id="4576781">&amp;</span><span class="ident" id="4576782">zinvsq</span><span class="op" id="4576788">,</span>&nbsp;<span class="op" id="4576790">&amp;</span><span class="ident" id="4576791">tmp</span><span class="op" id="4576794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576797">p224Mul</span><span class="op" id="4576804">(</span><span class="op" id="4576805">&amp;</span><span class="ident" id="4576806">zinvsq</span><span class="op" id="4576812">,</span>&nbsp;<span class="op" id="4576814">&amp;</span><span class="ident" id="4576815">zinvsq</span><span class="op" id="4576821">,</span>&nbsp;<span class="op" id="4576823">&amp;</span><span class="ident" id="4576824">zinv</span><span class="op" id="4576828">,</span>&nbsp;<span class="op" id="4576830">&amp;</span><span class="ident" id="4576831">tmp</span><span class="op" id="4576834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576837">p224Mul</span><span class="op" id="4576844">(</span><span class="ident" id="4576845">y</span><span class="op" id="4576846">,</span>&nbsp;<span class="ident" id="4576848">y</span><span class="op" id="4576849">,</span>&nbsp;<span class="op" id="4576851">&amp;</span><span class="ident" id="4576852">zinvsq</span><span class="op" id="4576858">,</span>&nbsp;<span class="op" id="4576860">&amp;</span><span class="ident" id="4576861">tmp</span><span class="op" id="4576864">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576868">p224Contract</span><span class="op" id="4576880">(</span><span class="op" id="4576881">&amp;</span><span class="ident" id="4576882">outx</span><span class="op" id="4576886">,</span>&nbsp;<span class="ident" id="4576888">x</span><span class="op" id="4576889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576892">p224Contract</span><span class="op" id="4576904">(</span><span class="op" id="4576905">&amp;</span><span class="ident" id="4576906">outy</span><span class="op" id="4576910">,</span>&nbsp;<span class="ident" id="4576912">y</span><span class="op" id="4576913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576916">return</span>&nbsp;<span class="ident" id="4576923">p224ToBig</span><span class="op" id="4576932">(</span><span class="op" id="4576933">&amp;</span><span class="ident" id="4576934">outx</span><span class="op" id="4576938">)</span><span class="op" id="4576939">,</span>&nbsp;<span class="ident" id="4576941">p224ToBig</span><span class="op" id="4576950">(</span><span class="op" id="4576951">&amp;</span><span class="ident" id="4576952">outy</span><span class="op" id="4576956">)</span><br>
<span class="lineno"></span><span class="op" id="4576958">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4576961">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4577036">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4577088">func</span>&nbsp;<span class="ident" id="4577093">get28BitsFromEnd</span><span class="op" id="4577109">(</span><span class="ident" id="4577110">buf</span>&nbsp;<span class="op" id="4577114">[</span><span class="op" id="4577115">]</span><span class="builtintype" id="4577116">byte</span><span class="op" id="4577120">,</span>&nbsp;<span class="ident" id="4577122">shift</span>&nbsp;<span class="builtintype" id="4577128">uint</span><span class="op" id="4577132">)</span>&nbsp;<span class="op" id="4577134">(</span><span class="builtintype" id="4577135">uint32</span><span class="op" id="4577141">,</span>&nbsp;<span class="op" id="4577143">[</span><span class="op" id="4577144">]</span><span class="builtintype" id="4577145">byte</span><span class="op" id="4577149">)</span>&nbsp;<span class="op" id="4577151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577154">var</span>&nbsp;<span class="ident" id="4577158">ret</span>&nbsp;<span class="builtintype" id="4577162">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577171">for</span>&nbsp;<span class="ident" id="4577175">i</span>&nbsp;<span class="op" id="4577177">:=</span>&nbsp;<span class="builtintype" id="4577180">uint</span><span class="op" id="4577184">(</span><span class="num" id="4577185">0</span><span class="op" id="4577186">)</span><span class="op" id="4577187">;</span>&nbsp;<span class="ident" id="4577189">i</span>&nbsp;<span class="op" id="4577191">&lt;</span>&nbsp;<span class="num" id="4577193">4</span><span class="op" id="4577194">;</span>&nbsp;<span class="ident" id="4577196">i</span><span class="op" id="4577197">++</span>&nbsp;<span class="op" id="4577200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577204">var</span>&nbsp;<span class="ident" id="4577208">b</span>&nbsp;<span class="builtintype" id="4577210">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577217">if</span>&nbsp;<span class="ident" id="4577220">l</span>&nbsp;<span class="op" id="4577222">:=</span>&nbsp;<span class="builtinfunc" id="4577225">len</span><span class="op" id="4577228">(</span><span class="ident" id="4577229">buf</span><span class="op" id="4577232">)</span><span class="op" id="4577233">;</span>&nbsp;<span class="ident" id="4577235">l</span>&nbsp;<span class="op" id="4577237">&gt;</span>&nbsp;<span class="num" id="4577239">0</span>&nbsp;<span class="op" id="4577241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577246">b</span>&nbsp;<span class="op" id="4577248">=</span>&nbsp;<span class="ident" id="4577250">buf</span><span class="op" id="4577253">[</span><span class="ident" id="4577254">l</span><span class="op" id="4577255">-</span><span class="num" id="4577256">1</span><span class="op" id="4577257">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4577262">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4577332">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577357">if</span>&nbsp;<span class="ident" id="4577360">i</span>&nbsp;<span class="op" id="4577362">!=</span>&nbsp;<span class="num" id="4577365">3</span>&nbsp;<span class="op" id="4577367">||</span>&nbsp;<span class="ident" id="4577370">shift</span>&nbsp;<span class="op" id="4577376">==</span>&nbsp;<span class="num" id="4577379">4</span>&nbsp;<span class="op" id="4577381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577387">buf</span>&nbsp;<span class="op" id="4577391">=</span>&nbsp;<span class="ident" id="4577393">buf</span><span class="op" id="4577396">[</span><span class="op" id="4577397">:</span><span class="ident" id="4577398">l</span><span class="op" id="4577399">-</span><span class="num" id="4577400">1</span><span class="op" id="4577401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577406">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577414">ret</span>&nbsp;<span class="op" id="4577418">|=</span>&nbsp;<span class="builtintype" id="4577421">uint32</span><span class="op" id="4577427">(</span><span class="ident" id="4577428">b</span><span class="op" id="4577429">)</span>&nbsp;<span class="op" id="4577431">&lt;&lt;</span>&nbsp;<span class="op" id="4577434">(</span><span class="num" id="4577435">8</span>&nbsp;<span class="op" id="4577437">*</span>&nbsp;<span class="ident" id="4577439">i</span><span class="op" id="4577440">)</span>&nbsp;<span class="op" id="4577442">&gt;&gt;</span>&nbsp;<span class="ident" id="4577445">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577455">ret</span>&nbsp;<span class="op" id="4577459">&amp;=</span>&nbsp;<span class="ident" id="4577462">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577476">return</span>&nbsp;<span class="ident" id="4577483">ret</span><span class="op" id="4577486">,</span>&nbsp;<span class="ident" id="4577488">buf</span><br>
<span class="lineno">710</span><span class="op" id="4577492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4577495">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4577527">func</span>&nbsp;<span class="ident" id="4577532">p224FromBig</span><span class="op" id="4577543">(</span><span class="ident" id="4577544">out</span>&nbsp;<span class="op" id="4577548">*</span><span class="ident" id="4577549">p224FieldElement</span><span class="op" id="4577565">,</span>&nbsp;<span class="ident" id="4577567">in</span>&nbsp;<span class="op" id="4577570">*</span><span class="ident" id="4577571">big</span><span class="op" id="4577574">.</span><span class="ident" id="4577575">Int</span><span class="op" id="4577578">)</span>&nbsp;<span class="op" id="4577580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577583">bytes</span>&nbsp;<span class="op" id="4577589">:=</span>&nbsp;<span class="ident" id="4577592">in</span><span class="op" id="4577594">.</span><span class="ident" id="4577595">Bytes</span><span class="op" id="4577600">(</span><span class="op" id="4577601">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577604">out</span><span class="op" id="4577607">[</span><span class="num" id="4577608">0</span><span class="op" id="4577609">]</span><span class="op" id="4577610">,</span>&nbsp;<span class="ident" id="4577612">bytes</span>&nbsp;<span class="op" id="4577618">=</span>&nbsp;<span class="ident" id="4577620">get28BitsFromEnd</span><span class="op" id="4577636">(</span><span class="ident" id="4577637">bytes</span><span class="op" id="4577642">,</span>&nbsp;<span class="num" id="4577644">0</span><span class="op" id="4577645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577648">out</span><span class="op" id="4577651">[</span><span class="num" id="4577652">1</span><span class="op" id="4577653">]</span><span class="op" id="4577654">,</span>&nbsp;<span class="ident" id="4577656">bytes</span>&nbsp;<span class="op" id="4577662">=</span>&nbsp;<span class="ident" id="4577664">get28BitsFromEnd</span><span class="op" id="4577680">(</span><span class="ident" id="4577681">bytes</span><span class="op" id="4577686">,</span>&nbsp;<span class="num" id="4577688">4</span><span class="op" id="4577689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577692">out</span><span class="op" id="4577695">[</span><span class="num" id="4577696">2</span><span class="op" id="4577697">]</span><span class="op" id="4577698">,</span>&nbsp;<span class="ident" id="4577700">bytes</span>&nbsp;<span class="op" id="4577706">=</span>&nbsp;<span class="ident" id="4577708">get28BitsFromEnd</span><span class="op" id="4577724">(</span><span class="ident" id="4577725">bytes</span><span class="op" id="4577730">,</span>&nbsp;<span class="num" id="4577732">0</span><span class="op" id="4577733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577736">out</span><span class="op" id="4577739">[</span><span class="num" id="4577740">3</span><span class="op" id="4577741">]</span><span class="op" id="4577742">,</span>&nbsp;<span class="ident" id="4577744">bytes</span>&nbsp;<span class="op" id="4577750">=</span>&nbsp;<span class="ident" id="4577752">get28BitsFromEnd</span><span class="op" id="4577768">(</span><span class="ident" id="4577769">bytes</span><span class="op" id="4577774">,</span>&nbsp;<span class="num" id="4577776">4</span><span class="op" id="4577777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577780">out</span><span class="op" id="4577783">[</span><span class="num" id="4577784">4</span><span class="op" id="4577785">]</span><span class="op" id="4577786">,</span>&nbsp;<span class="ident" id="4577788">bytes</span>&nbsp;<span class="op" id="4577794">=</span>&nbsp;<span class="ident" id="4577796">get28BitsFromEnd</span><span class="op" id="4577812">(</span><span class="ident" id="4577813">bytes</span><span class="op" id="4577818">,</span>&nbsp;<span class="num" id="4577820">0</span><span class="op" id="4577821">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577824">out</span><span class="op" id="4577827">[</span><span class="num" id="4577828">5</span><span class="op" id="4577829">]</span><span class="op" id="4577830">,</span>&nbsp;<span class="ident" id="4577832">bytes</span>&nbsp;<span class="op" id="4577838">=</span>&nbsp;<span class="ident" id="4577840">get28BitsFromEnd</span><span class="op" id="4577856">(</span><span class="ident" id="4577857">bytes</span><span class="op" id="4577862">,</span>&nbsp;<span class="num" id="4577864">4</span><span class="op" id="4577865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577868">out</span><span class="op" id="4577871">[</span><span class="num" id="4577872">6</span><span class="op" id="4577873">]</span><span class="op" id="4577874">,</span>&nbsp;<span class="ident" id="4577876">bytes</span>&nbsp;<span class="op" id="4577882">=</span>&nbsp;<span class="ident" id="4577884">get28BitsFromEnd</span><span class="op" id="4577900">(</span><span class="ident" id="4577901">bytes</span><span class="op" id="4577906">,</span>&nbsp;<span class="num" id="4577908">0</span><span class="op" id="4577909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577912">out</span><span class="op" id="4577915">[</span><span class="num" id="4577916">7</span><span class="op" id="4577917">]</span><span class="op" id="4577918">,</span>&nbsp;<span class="ident" id="4577920">bytes</span>&nbsp;<span class="op" id="4577926">=</span>&nbsp;<span class="ident" id="4577928">get28BitsFromEnd</span><span class="op" id="4577944">(</span><span class="ident" id="4577945">bytes</span><span class="op" id="4577950">,</span>&nbsp;<span class="num" id="4577952">4</span><span class="op" id="4577953">)</span><br>
<span class="lineno"></span><span class="op" id="4577955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4577958">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4577996">func</span>&nbsp;<span class="ident" id="4578001">p224ToBig</span><span class="op" id="4578010">(</span><span class="ident" id="4578011">in</span>&nbsp;<span class="op" id="4578014">*</span><span class="ident" id="4578015">p224FieldElement</span><span class="op" id="4578031">)</span>&nbsp;<span class="op" id="4578033">*</span><span class="ident" id="4578034">big</span><span class="op" id="4578037">.</span><span class="ident" id="4578038">Int</span>&nbsp;<span class="op" id="4578042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578045">var</span>&nbsp;<span class="ident" id="4578049">buf</span>&nbsp;<span class="op" id="4578053">[</span><span class="num" id="4578054">28</span><span class="op" id="4578056">]</span><span class="builtintype" id="4578057">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578063">buf</span><span class="op" id="4578066">[</span><span class="num" id="4578067">27</span><span class="op" id="4578069">]</span>&nbsp;<span class="op" id="4578071">=</span>&nbsp;<span class="builtintype" id="4578073">byte</span><span class="op" id="4578077">(</span><span class="ident" id="4578078">in</span><span class="op" id="4578080">[</span><span class="num" id="4578081">0</span><span class="op" id="4578082">]</span><span class="op" id="4578083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578086">buf</span><span class="op" id="4578089">[</span><span class="num" id="4578090">26</span><span class="op" id="4578092">]</span>&nbsp;<span class="op" id="4578094">=</span>&nbsp;<span class="builtintype" id="4578096">byte</span><span class="op" id="4578100">(</span><span class="ident" id="4578101">in</span><span class="op" id="4578103">[</span><span class="num" id="4578104">0</span><span class="op" id="4578105">]</span>&nbsp;<span class="op" id="4578107">&gt;&gt;</span>&nbsp;<span class="num" id="4578110">8</span><span class="op" id="4578111">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578114">buf</span><span class="op" id="4578117">[</span><span class="num" id="4578118">25</span><span class="op" id="4578120">]</span>&nbsp;<span class="op" id="4578122">=</span>&nbsp;<span class="builtintype" id="4578124">byte</span><span class="op" id="4578128">(</span><span class="ident" id="4578129">in</span><span class="op" id="4578131">[</span><span class="num" id="4578132">0</span><span class="op" id="4578133">]</span>&nbsp;<span class="op" id="4578135">&gt;&gt;</span>&nbsp;<span class="num" id="4578138">16</span><span class="op" id="4578140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578143">buf</span><span class="op" id="4578146">[</span><span class="num" id="4578147">24</span><span class="op" id="4578149">]</span>&nbsp;<span class="op" id="4578151">=</span>&nbsp;<span class="builtintype" id="4578153">byte</span><span class="op" id="4578157">(</span><span class="op" id="4578158">(</span><span class="op" id="4578159">(</span><span class="ident" id="4578160">in</span><span class="op" id="4578162">[</span><span class="num" id="4578163">0</span><span class="op" id="4578164">]</span>&nbsp;<span class="op" id="4578166">&gt;&gt;</span>&nbsp;<span class="num" id="4578169">24</span><span class="op" id="4578171">)</span>&nbsp;<span class="op" id="4578173">&amp;</span>&nbsp;<span class="num" id="4578175">0x0f</span><span class="op" id="4578179">)</span>&nbsp;<span class="op" id="4578181">|</span>&nbsp;<span class="op" id="4578183">(</span><span class="ident" id="4578184">in</span><span class="op" id="4578186">[</span><span class="num" id="4578187">1</span><span class="op" id="4578188">]</span><span class="op" id="4578189">&lt;&lt;</span><span class="num" id="4578191">4</span><span class="op" id="4578192">)</span><span class="op" id="4578193">&amp;</span><span class="num" id="4578194">0xf0</span><span class="op" id="4578198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578202">buf</span><span class="op" id="4578205">[</span><span class="num" id="4578206">23</span><span class="op" id="4578208">]</span>&nbsp;<span class="op" id="4578210">=</span>&nbsp;<span class="builtintype" id="4578212">byte</span><span class="op" id="4578216">(</span><span class="ident" id="4578217">in</span><span class="op" id="4578219">[</span><span class="num" id="4578220">1</span><span class="op" id="4578221">]</span>&nbsp;<span class="op" id="4578223">&gt;&gt;</span>&nbsp;<span class="num" id="4578226">4</span><span class="op" id="4578227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578230">buf</span><span class="op" id="4578233">[</span><span class="num" id="4578234">22</span><span class="op" id="4578236">]</span>&nbsp;<span class="op" id="4578238">=</span>&nbsp;<span class="builtintype" id="4578240">byte</span><span class="op" id="4578244">(</span><span class="ident" id="4578245">in</span><span class="op" id="4578247">[</span><span class="num" id="4578248">1</span><span class="op" id="4578249">]</span>&nbsp;<span class="op" id="4578251">&gt;&gt;</span>&nbsp;<span class="num" id="4578254">12</span><span class="op" id="4578256">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578259">buf</span><span class="op" id="4578262">[</span><span class="num" id="4578263">21</span><span class="op" id="4578265">]</span>&nbsp;<span class="op" id="4578267">=</span>&nbsp;<span class="builtintype" id="4578269">byte</span><span class="op" id="4578273">(</span><span class="ident" id="4578274">in</span><span class="op" id="4578276">[</span><span class="num" id="4578277">1</span><span class="op" id="4578278">]</span>&nbsp;<span class="op" id="4578280">&gt;&gt;</span>&nbsp;<span class="num" id="4578283">20</span><span class="op" id="4578285">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578289">buf</span><span class="op" id="4578292">[</span><span class="num" id="4578293">20</span><span class="op" id="4578295">]</span>&nbsp;<span class="op" id="4578297">=</span>&nbsp;<span class="builtintype" id="4578299">byte</span><span class="op" id="4578303">(</span><span class="ident" id="4578304">in</span><span class="op" id="4578306">[</span><span class="num" id="4578307">2</span><span class="op" id="4578308">]</span><span class="op" id="4578309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578312">buf</span><span class="op" id="4578315">[</span><span class="num" id="4578316">19</span><span class="op" id="4578318">]</span>&nbsp;<span class="op" id="4578320">=</span>&nbsp;<span class="builtintype" id="4578322">byte</span><span class="op" id="4578326">(</span><span class="ident" id="4578327">in</span><span class="op" id="4578329">[</span><span class="num" id="4578330">2</span><span class="op" id="4578331">]</span>&nbsp;<span class="op" id="4578333">&gt;&gt;</span>&nbsp;<span class="num" id="4578336">8</span><span class="op" id="4578337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578340">buf</span><span class="op" id="4578343">[</span><span class="num" id="4578344">18</span><span class="op" id="4578346">]</span>&nbsp;<span class="op" id="4578348">=</span>&nbsp;<span class="builtintype" id="4578350">byte</span><span class="op" id="4578354">(</span><span class="ident" id="4578355">in</span><span class="op" id="4578357">[</span><span class="num" id="4578358">2</span><span class="op" id="4578359">]</span>&nbsp;<span class="op" id="4578361">&gt;&gt;</span>&nbsp;<span class="num" id="4578364">16</span><span class="op" id="4578366">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578369">buf</span><span class="op" id="4578372">[</span><span class="num" id="4578373">17</span><span class="op" id="4578375">]</span>&nbsp;<span class="op" id="4578377">=</span>&nbsp;<span class="builtintype" id="4578379">byte</span><span class="op" id="4578383">(</span><span class="op" id="4578384">(</span><span class="op" id="4578385">(</span><span class="ident" id="4578386">in</span><span class="op" id="4578388">[</span><span class="num" id="4578389">2</span><span class="op" id="4578390">]</span>&nbsp;<span class="op" id="4578392">&gt;&gt;</span>&nbsp;<span class="num" id="4578395">24</span><span class="op" id="4578397">)</span>&nbsp;<span class="op" id="4578399">&amp;</span>&nbsp;<span class="num" id="4578401">0x0f</span><span class="op" id="4578405">)</span>&nbsp;<span class="op" id="4578407">|</span>&nbsp;<span class="op" id="4578409">(</span><span class="ident" id="4578410">in</span><span class="op" id="4578412">[</span><span class="num" id="4578413">3</span><span class="op" id="4578414">]</span><span class="op" id="4578415">&lt;&lt;</span><span class="num" id="4578417">4</span><span class="op" id="4578418">)</span><span class="op" id="4578419">&amp;</span><span class="num" id="4578420">0xf0</span><span class="op" id="4578424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578428">buf</span><span class="op" id="4578431">[</span><span class="num" id="4578432">16</span><span class="op" id="4578434">]</span>&nbsp;<span class="op" id="4578436">=</span>&nbsp;<span class="builtintype" id="4578438">byte</span><span class="op" id="4578442">(</span><span class="ident" id="4578443">in</span><span class="op" id="4578445">[</span><span class="num" id="4578446">3</span><span class="op" id="4578447">]</span>&nbsp;<span class="op" id="4578449">&gt;&gt;</span>&nbsp;<span class="num" id="4578452">4</span><span class="op" id="4578453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578456">buf</span><span class="op" id="4578459">[</span><span class="num" id="4578460">15</span><span class="op" id="4578462">]</span>&nbsp;<span class="op" id="4578464">=</span>&nbsp;<span class="builtintype" id="4578466">byte</span><span class="op" id="4578470">(</span><span class="ident" id="4578471">in</span><span class="op" id="4578473">[</span><span class="num" id="4578474">3</span><span class="op" id="4578475">]</span>&nbsp;<span class="op" id="4578477">&gt;&gt;</span>&nbsp;<span class="num" id="4578480">12</span><span class="op" id="4578482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578485">buf</span><span class="op" id="4578488">[</span><span class="num" id="4578489">14</span><span class="op" id="4578491">]</span>&nbsp;<span class="op" id="4578493">=</span>&nbsp;<span class="builtintype" id="4578495">byte</span><span class="op" id="4578499">(</span><span class="ident" id="4578500">in</span><span class="op" id="4578502">[</span><span class="num" id="4578503">3</span><span class="op" id="4578504">]</span>&nbsp;<span class="op" id="4578506">&gt;&gt;</span>&nbsp;<span class="num" id="4578509">20</span><span class="op" id="4578511">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578515">buf</span><span class="op" id="4578518">[</span><span class="num" id="4578519">13</span><span class="op" id="4578521">]</span>&nbsp;<span class="op" id="4578523">=</span>&nbsp;<span class="builtintype" id="4578525">byte</span><span class="op" id="4578529">(</span><span class="ident" id="4578530">in</span><span class="op" id="4578532">[</span><span class="num" id="4578533">4</span><span class="op" id="4578534">]</span><span class="op" id="4578535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578538">buf</span><span class="op" id="4578541">[</span><span class="num" id="4578542">12</span><span class="op" id="4578544">]</span>&nbsp;<span class="op" id="4578546">=</span>&nbsp;<span class="builtintype" id="4578548">byte</span><span class="op" id="4578552">(</span><span class="ident" id="4578553">in</span><span class="op" id="4578555">[</span><span class="num" id="4578556">4</span><span class="op" id="4578557">]</span>&nbsp;<span class="op" id="4578559">&gt;&gt;</span>&nbsp;<span class="num" id="4578562">8</span><span class="op" id="4578563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578566">buf</span><span class="op" id="4578569">[</span><span class="num" id="4578570">11</span><span class="op" id="4578572">]</span>&nbsp;<span class="op" id="4578574">=</span>&nbsp;<span class="builtintype" id="4578576">byte</span><span class="op" id="4578580">(</span><span class="ident" id="4578581">in</span><span class="op" id="4578583">[</span><span class="num" id="4578584">4</span><span class="op" id="4578585">]</span>&nbsp;<span class="op" id="4578587">&gt;&gt;</span>&nbsp;<span class="num" id="4578590">16</span><span class="op" id="4578592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578595">buf</span><span class="op" id="4578598">[</span><span class="num" id="4578599">10</span><span class="op" id="4578601">]</span>&nbsp;<span class="op" id="4578603">=</span>&nbsp;<span class="builtintype" id="4578605">byte</span><span class="op" id="4578609">(</span><span class="op" id="4578610">(</span><span class="op" id="4578611">(</span><span class="ident" id="4578612">in</span><span class="op" id="4578614">[</span><span class="num" id="4578615">4</span><span class="op" id="4578616">]</span>&nbsp;<span class="op" id="4578618">&gt;&gt;</span>&nbsp;<span class="num" id="4578621">24</span><span class="op" id="4578623">)</span>&nbsp;<span class="op" id="4578625">&amp;</span>&nbsp;<span class="num" id="4578627">0x0f</span><span class="op" id="4578631">)</span>&nbsp;<span class="op" id="4578633">|</span>&nbsp;<span class="op" id="4578635">(</span><span class="ident" id="4578636">in</span><span class="op" id="4578638">[</span><span class="num" id="4578639">5</span><span class="op" id="4578640">]</span><span class="op" id="4578641">&lt;&lt;</span><span class="num" id="4578643">4</span><span class="op" id="4578644">)</span><span class="op" id="4578645">&amp;</span><span class="num" id="4578646">0xf0</span><span class="op" id="4578650">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578654">buf</span><span class="op" id="4578657">[</span><span class="num" id="4578658">9</span><span class="op" id="4578659">]</span>&nbsp;<span class="op" id="4578661">=</span>&nbsp;<span class="builtintype" id="4578663">byte</span><span class="op" id="4578667">(</span><span class="ident" id="4578668">in</span><span class="op" id="4578670">[</span><span class="num" id="4578671">5</span><span class="op" id="4578672">]</span>&nbsp;<span class="op" id="4578674">&gt;&gt;</span>&nbsp;<span class="num" id="4578677">4</span><span class="op" id="4578678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578681">buf</span><span class="op" id="4578684">[</span><span class="num" id="4578685">8</span><span class="op" id="4578686">]</span>&nbsp;<span class="op" id="4578688">=</span>&nbsp;<span class="builtintype" id="4578690">byte</span><span class="op" id="4578694">(</span><span class="ident" id="4578695">in</span><span class="op" id="4578697">[</span><span class="num" id="4578698">5</span><span class="op" id="4578699">]</span>&nbsp;<span class="op" id="4578701">&gt;&gt;</span>&nbsp;<span class="num" id="4578704">12</span><span class="op" id="4578706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578709">buf</span><span class="op" id="4578712">[</span><span class="num" id="4578713">7</span><span class="op" id="4578714">]</span>&nbsp;<span class="op" id="4578716">=</span>&nbsp;<span class="builtintype" id="4578718">byte</span><span class="op" id="4578722">(</span><span class="ident" id="4578723">in</span><span class="op" id="4578725">[</span><span class="num" id="4578726">5</span><span class="op" id="4578727">]</span>&nbsp;<span class="op" id="4578729">&gt;&gt;</span>&nbsp;<span class="num" id="4578732">20</span><span class="op" id="4578734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578738">buf</span><span class="op" id="4578741">[</span><span class="num" id="4578742">6</span><span class="op" id="4578743">]</span>&nbsp;<span class="op" id="4578745">=</span>&nbsp;<span class="builtintype" id="4578747">byte</span><span class="op" id="4578751">(</span><span class="ident" id="4578752">in</span><span class="op" id="4578754">[</span><span class="num" id="4578755">6</span><span class="op" id="4578756">]</span><span class="op" id="4578757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578760">buf</span><span class="op" id="4578763">[</span><span class="num" id="4578764">5</span><span class="op" id="4578765">]</span>&nbsp;<span class="op" id="4578767">=</span>&nbsp;<span class="builtintype" id="4578769">byte</span><span class="op" id="4578773">(</span><span class="ident" id="4578774">in</span><span class="op" id="4578776">[</span><span class="num" id="4578777">6</span><span class="op" id="4578778">]</span>&nbsp;<span class="op" id="4578780">&gt;&gt;</span>&nbsp;<span class="num" id="4578783">8</span><span class="op" id="4578784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578787">buf</span><span class="op" id="4578790">[</span><span class="num" id="4578791">4</span><span class="op" id="4578792">]</span>&nbsp;<span class="op" id="4578794">=</span>&nbsp;<span class="builtintype" id="4578796">byte</span><span class="op" id="4578800">(</span><span class="ident" id="4578801">in</span><span class="op" id="4578803">[</span><span class="num" id="4578804">6</span><span class="op" id="4578805">]</span>&nbsp;<span class="op" id="4578807">&gt;&gt;</span>&nbsp;<span class="num" id="4578810">16</span><span class="op" id="4578812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578815">buf</span><span class="op" id="4578818">[</span><span class="num" id="4578819">3</span><span class="op" id="4578820">]</span>&nbsp;<span class="op" id="4578822">=</span>&nbsp;<span class="builtintype" id="4578824">byte</span><span class="op" id="4578828">(</span><span class="op" id="4578829">(</span><span class="op" id="4578830">(</span><span class="ident" id="4578831">in</span><span class="op" id="4578833">[</span><span class="num" id="4578834">6</span><span class="op" id="4578835">]</span>&nbsp;<span class="op" id="4578837">&gt;&gt;</span>&nbsp;<span class="num" id="4578840">24</span><span class="op" id="4578842">)</span>&nbsp;<span class="op" id="4578844">&amp;</span>&nbsp;<span class="num" id="4578846">0x0f</span><span class="op" id="4578850">)</span>&nbsp;<span class="op" id="4578852">|</span>&nbsp;<span class="op" id="4578854">(</span><span class="ident" id="4578855">in</span><span class="op" id="4578857">[</span><span class="num" id="4578858">7</span><span class="op" id="4578859">]</span><span class="op" id="4578860">&lt;&lt;</span><span class="num" id="4578862">4</span><span class="op" id="4578863">)</span><span class="op" id="4578864">&amp;</span><span class="num" id="4578865">0xf0</span><span class="op" id="4578869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578873">buf</span><span class="op" id="4578876">[</span><span class="num" id="4578877">2</span><span class="op" id="4578878">]</span>&nbsp;<span class="op" id="4578880">=</span>&nbsp;<span class="builtintype" id="4578882">byte</span><span class="op" id="4578886">(</span><span class="ident" id="4578887">in</span><span class="op" id="4578889">[</span><span class="num" id="4578890">7</span><span class="op" id="4578891">]</span>&nbsp;<span class="op" id="4578893">&gt;&gt;</span>&nbsp;<span class="num" id="4578896">4</span><span class="op" id="4578897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578900">buf</span><span class="op" id="4578903">[</span><span class="num" id="4578904">1</span><span class="op" id="4578905">]</span>&nbsp;<span class="op" id="4578907">=</span>&nbsp;<span class="builtintype" id="4578909">byte</span><span class="op" id="4578913">(</span><span class="ident" id="4578914">in</span><span class="op" id="4578916">[</span><span class="num" id="4578917">7</span><span class="op" id="4578918">]</span>&nbsp;<span class="op" id="4578920">&gt;&gt;</span>&nbsp;<span class="num" id="4578923">12</span><span class="op" id="4578925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578928">buf</span><span class="op" id="4578931">[</span><span class="num" id="4578932">0</span><span class="op" id="4578933">]</span>&nbsp;<span class="op" id="4578935">=</span>&nbsp;<span class="builtintype" id="4578937">byte</span><span class="op" id="4578941">(</span><span class="ident" id="4578942">in</span><span class="op" id="4578944">[</span><span class="num" id="4578945">7</span><span class="op" id="4578946">]</span>&nbsp;<span class="op" id="4578948">&gt;&gt;</span>&nbsp;<span class="num" id="4578951">20</span><span class="op" id="4578953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578957">return</span>&nbsp;<span class="builtinfunc" id="4578964">new</span><span class="op" id="4578967">(</span><span class="ident" id="4578968">big</span><span class="op" id="4578971">.</span><span class="ident" id="4578972">Int</span><span class="op" id="4578975">)</span><span class="op" id="4578976">.</span><span class="ident" id="4578977">SetBytes</span><span class="op" id="4578985">(</span><span class="ident" id="4578986">buf</span><span class="op" id="4578989">[</span><span class="op" id="4578990">:</span><span class="op" id="4578991">]</span><span class="op" id="4578992">)</span><br>
<span class="lineno">765</span><span class="op" id="4578994">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
