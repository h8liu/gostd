<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5561703">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5561758">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5561812">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5561863">package</span>&nbsp;<span class="ident" id="5561871">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5561878">import</span>&nbsp;<span class="string" id="5561885">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5561893">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5561953">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5562023">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5562081">//</span><br>
<span class="lineno"></span><span class="comment" id="5562084">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5562132">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5562196">//</span><br>
<span class="lineno"></span><span class="comment" id="5562199">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5562260">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5562330">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5562405">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5562472">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5562545">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5562617">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5562631">//</span><br>
<span class="lineno"></span><span class="comment" id="5562634">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5562700">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5562766">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5562779">//</span><br>
<span class="lineno"></span><span class="comment" id="5562782">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5562806">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5562836">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="5562859">//</span><br>
<span class="lineno"></span><span class="comment" id="5562862">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5562878">//</span><br>
<span class="lineno">35</span><span class="comment" id="5562881">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5562914">//</span><br>
<span class="lineno"></span><span class="comment" id="5562917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5562946">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="5562976">//</span><br>
<span class="lineno">40</span><span class="comment" id="5562979">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5563008">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5563038">//</span><br>
<span class="lineno"></span><span class="comment" id="5563041">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5563101">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="5563133">//</span><br>
<span class="lineno"></span><span class="comment" id="5563136">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="5563197">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5563267">//</span><br>
<span class="lineno"></span><span class="comment" id="5563270">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="5563283">//</span><br>
<span class="lineno"></span><span class="comment" id="5563286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5563326">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5563384">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="5563444">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5563505">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="5563543">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="5563633">func</span>&nbsp;<span class="ident" id="5563638">Sqrt</span><span class="op" id="5563642">(</span><span class="ident" id="5563643">x</span>&nbsp;<span class="builtintype" id="5563645">complex128</span><span class="op" id="5563655">)</span>&nbsp;<span class="builtintype" id="5563657">complex128</span>&nbsp;<span class="op" id="5563668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563671">if</span>&nbsp;<span class="builtinfunc" id="5563674">imag</span><span class="op" id="5563678">(</span><span class="ident" id="5563679"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563680">)</span>&nbsp;<span class="op" id="5563682">==</span>&nbsp;<span class="num" id="5563685">0</span>&nbsp;<span class="op" id="5563687">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563691">if</span>&nbsp;<span class="builtinfunc" id="5563694">real</span><span class="op" id="5563698">(</span><span class="ident" id="5563699"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563700">)</span>&nbsp;<span class="op" id="5563702">==</span>&nbsp;<span class="num" id="5563705">0</span>&nbsp;<span class="op" id="5563707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563712">return</span>&nbsp;<span class="builtinfunc" id="5563719">complex</span><span class="op" id="5563726">(</span><span class="num" id="5563727">0</span><span class="op" id="5563728">,</span>&nbsp;<span class="num" id="5563730">0</span><span class="op" id="5563731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563739">if</span>&nbsp;<span class="builtinfunc" id="5563742">real</span><span class="op" id="5563746">(</span><span class="ident" id="5563747"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563748">)</span>&nbsp;<span class="op" id="5563750">&lt;</span>&nbsp;<span class="num" id="5563752">0</span>&nbsp;<span class="op" id="5563754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563759">return</span>&nbsp;<span class="builtinfunc" id="5563766">complex</span><span class="op" id="5563773">(</span><span class="num" id="5563774">0</span><span class="op" id="5563775">,</span>&nbsp;<span class="ident" id="5563777"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5563781">.</span><span class="ident" id="5563782">Sqrt</span><span class="op" id="5563786">(</span><span class="op" id="5563787">-</span><span class="builtinfunc" id="5563788">real</span><span class="op" id="5563792">(</span><span class="ident" id="5563793"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563794">)</span><span class="op" id="5563795">)</span><span class="op" id="5563796">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563804">return</span>&nbsp;<span class="builtinfunc" id="5563811">complex</span><span class="op" id="5563818">(</span><span class="ident" id="5563819"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5563823">.</span><span class="ident" id="5563824">Sqrt</span><span class="op" id="5563828">(</span><span class="builtinfunc" id="5563829">real</span><span class="op" id="5563833">(</span><span class="ident" id="5563834"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563835">)</span><span class="op" id="5563836">)</span><span class="op" id="5563837">,</span>&nbsp;<span class="num" id="5563839">0</span><span class="op" id="5563840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563846">if</span>&nbsp;<span class="builtinfunc" id="5563849">real</span><span class="op" id="5563853">(</span><span class="ident" id="5563854"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563855">)</span>&nbsp;<span class="op" id="5563857">==</span>&nbsp;<span class="num" id="5563860">0</span>&nbsp;<span class="op" id="5563862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563866">if</span>&nbsp;<span class="builtinfunc" id="5563869">imag</span><span class="op" id="5563873">(</span><span class="ident" id="5563874"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563875">)</span>&nbsp;<span class="op" id="5563877">&lt;</span>&nbsp;<span class="num" id="5563879">0</span>&nbsp;<span class="op" id="5563881">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563886">r</span>&nbsp;<span class="op" id="5563888">:=</span>&nbsp;<span class="ident" id="5563891"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5563895">.</span><span class="ident" id="5563896">Sqrt</span><span class="op" id="5563900">(</span><span class="op" id="5563901">-</span><span class="num" id="5563902">0.5</span>&nbsp;<span class="op" id="5563906">*</span>&nbsp;<span class="builtinfunc" id="5563908">imag</span><span class="op" id="5563912">(</span><span class="ident" id="5563913"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563914">)</span><span class="op" id="5563915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563920">return</span>&nbsp;<span class="builtinfunc" id="5563927">complex</span><span class="op" id="5563934">(</span><span class="ident" id="5563935"><a href="/math/cmplx/sqrt.go.html#5563886">r</a></span><span class="op" id="5563936">,</span>&nbsp;<span class="op" id="5563938">-</span><span class="ident" id="5563939"><a href="/math/cmplx/sqrt.go.html#5563886">r</a></span><span class="op" id="5563940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563948">r</span>&nbsp;<span class="op" id="5563950">:=</span>&nbsp;<span class="ident" id="5563953"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5563957">.</span><span class="ident" id="5563958">Sqrt</span><span class="op" id="5563962">(</span><span class="num" id="5563963">0.5</span>&nbsp;<span class="op" id="5563967">*</span>&nbsp;<span class="builtinfunc" id="5563969">imag</span><span class="op" id="5563973">(</span><span class="ident" id="5563974"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5563975">)</span><span class="op" id="5563976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563980">return</span>&nbsp;<span class="builtinfunc" id="5563987">complex</span><span class="op" id="5563994">(</span><span class="ident" id="5563995"><a href="/math/cmplx/sqrt.go.html#5563948">r</a></span><span class="op" id="5563996">,</span>&nbsp;<span class="ident" id="5563998"><a href="/math/cmplx/sqrt.go.html#5563948">r</a></span><span class="op" id="5563999">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564005">a</span>&nbsp;<span class="op" id="5564007">:=</span>&nbsp;<span class="builtinfunc" id="5564010">real</span><span class="op" id="5564014">(</span><span class="ident" id="5564015"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5564016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564019">b</span>&nbsp;<span class="op" id="5564021">:=</span>&nbsp;<span class="builtinfunc" id="5564024">imag</span><span class="op" id="5564028">(</span><span class="ident" id="5564029"><a href="/math/cmplx/sqrt.go.html#5563643">x</a></span><span class="op" id="5564030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564033">var</span>&nbsp;<span class="ident" id="5564037">scale</span>&nbsp;<span class="builtintype" id="5564043">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5564052">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564105">if</span>&nbsp;<span class="ident" id="5564108"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564112">.</span><span class="ident" id="5564113">Abs</span><span class="op" id="5564116">(</span><span class="ident" id="5564117"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span><span class="op" id="5564118">)</span>&nbsp;<span class="op" id="5564120">&gt;</span>&nbsp;<span class="num" id="5564122">4</span>&nbsp;<span class="op" id="5564124">||</span>&nbsp;<span class="ident" id="5564127"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564131">.</span><span class="ident" id="5564132">Abs</span><span class="op" id="5564135">(</span><span class="ident" id="5564136"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span><span class="op" id="5564137">)</span>&nbsp;<span class="op" id="5564139">&gt;</span>&nbsp;<span class="num" id="5564141">4</span>&nbsp;<span class="op" id="5564143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564147"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span>&nbsp;<span class="op" id="5564149">*=</span>&nbsp;<span class="num" id="5564152">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564159"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span>&nbsp;<span class="op" id="5564161">*=</span>&nbsp;<span class="num" id="5564164">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564171"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span>&nbsp;<span class="op" id="5564177">=</span>&nbsp;<span class="num" id="5564179">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564182">}</span>&nbsp;<span class="keyword" id="5564184">else</span>&nbsp;<span class="op" id="5564189">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564193"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span>&nbsp;<span class="op" id="5564195">*=</span>&nbsp;<span class="num" id="5564198">1.8014398509481984e16</span>&nbsp;<span class="comment" id="5564220">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564231"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span>&nbsp;<span class="op" id="5564233">*=</span>&nbsp;<span class="num" id="5564236">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564260"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span>&nbsp;<span class="op" id="5564266">=</span>&nbsp;<span class="num" id="5564268">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="5564292">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564306">r</span>&nbsp;<span class="op" id="5564308">:=</span>&nbsp;<span class="ident" id="5564311"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564315">.</span><span class="ident" id="5564316">Hypot</span><span class="op" id="5564321">(</span><span class="ident" id="5564322"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span><span class="op" id="5564323">,</span>&nbsp;<span class="ident" id="5564325"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span><span class="op" id="5564326">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564329">var</span>&nbsp;<span class="ident" id="5564333">t</span>&nbsp;<span class="builtintype" id="5564335">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564344">if</span>&nbsp;<span class="ident" id="5564347"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span>&nbsp;<span class="op" id="5564349">&gt;</span>&nbsp;<span class="num" id="5564351">0</span>&nbsp;<span class="op" id="5564353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564357"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span>&nbsp;<span class="op" id="5564359">=</span>&nbsp;<span class="ident" id="5564361"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564365">.</span><span class="ident" id="5564366">Sqrt</span><span class="op" id="5564370">(</span><span class="num" id="5564371">0.5</span><span class="op" id="5564374">*</span><span class="ident" id="5564375"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span>&nbsp;<span class="op" id="5564377">+</span>&nbsp;<span class="num" id="5564379">0.5</span><span class="op" id="5564382">*</span><span class="ident" id="5564383"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span><span class="op" id="5564384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564388"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span>&nbsp;<span class="op" id="5564390">=</span>&nbsp;<span class="ident" id="5564392"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span>&nbsp;<span class="op" id="5564398">*</span>&nbsp;<span class="ident" id="5564400"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564404">.</span><span class="ident" id="5564405">Abs</span><span class="op" id="5564408">(</span><span class="op" id="5564409">(</span><span class="num" id="5564410">0.5</span><span class="op" id="5564413">*</span><span class="ident" id="5564414"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span><span class="op" id="5564415">)</span><span class="op" id="5564416">/</span><span class="ident" id="5564417"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span><span class="op" id="5564418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564422"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span>&nbsp;<span class="op" id="5564424">*=</span>&nbsp;<span class="ident" id="5564427"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564434">}</span>&nbsp;<span class="keyword" id="5564436">else</span>&nbsp;<span class="op" id="5564441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564445"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span>&nbsp;<span class="op" id="5564447">=</span>&nbsp;<span class="ident" id="5564449"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564453">.</span><span class="ident" id="5564454">Sqrt</span><span class="op" id="5564458">(</span><span class="num" id="5564459">0.5</span><span class="op" id="5564462">*</span><span class="ident" id="5564463"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span>&nbsp;<span class="op" id="5564465">-</span>&nbsp;<span class="num" id="5564467">0.5</span><span class="op" id="5564470">*</span><span class="ident" id="5564471"><a href="/math/cmplx/sqrt.go.html#5564005">a</a></span><span class="op" id="5564472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564476"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span>&nbsp;<span class="op" id="5564478">=</span>&nbsp;<span class="ident" id="5564480"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span>&nbsp;<span class="op" id="5564486">*</span>&nbsp;<span class="ident" id="5564488"><a href="/math/cmplx/sqrt.go.html#5561885">math</a></span><span class="op" id="5564492">.</span><span class="ident" id="5564493">Abs</span><span class="op" id="5564496">(</span><span class="op" id="5564497">(</span><span class="num" id="5564498">0.5</span><span class="op" id="5564501">*</span><span class="ident" id="5564502"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span><span class="op" id="5564503">)</span><span class="op" id="5564504">/</span><span class="ident" id="5564505"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span><span class="op" id="5564506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564510"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span>&nbsp;<span class="op" id="5564512">*=</span>&nbsp;<span class="ident" id="5564515"><a href="/math/cmplx/sqrt.go.html#5564037">scale</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564522">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564525">if</span>&nbsp;<span class="ident" id="5564528"><a href="/math/cmplx/sqrt.go.html#5564019">b</a></span>&nbsp;<span class="op" id="5564530">&lt;</span>&nbsp;<span class="num" id="5564532">0</span>&nbsp;<span class="op" id="5564534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564538">return</span>&nbsp;<span class="builtinfunc" id="5564545">complex</span><span class="op" id="5564552">(</span><span class="ident" id="5564553"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span><span class="op" id="5564554">,</span>&nbsp;<span class="op" id="5564556">-</span><span class="ident" id="5564557"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span><span class="op" id="5564558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564564">return</span>&nbsp;<span class="builtinfunc" id="5564571">complex</span><span class="op" id="5564578">(</span><span class="ident" id="5564579"><a href="/math/cmplx/sqrt.go.html#5564333">t</a></span><span class="op" id="5564580">,</span>&nbsp;<span class="ident" id="5564582"><a href="/math/cmplx/sqrt.go.html#5564306">r</a></span><span class="op" id="5564583">)</span><br>
<span class="lineno"></span><span class="op" id="5564585">}</span>
</div>
</body>
</html>
