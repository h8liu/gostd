<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7051333">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7051388">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7051442">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7051493">package</span>&nbsp;<span class="ident" id="7051501">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7051512">import</span>&nbsp;<span class="op" id="7051519">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7051522">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7051531">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7051544">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7051555">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7051565">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7051568">func</span>&nbsp;<span class="ident" id="7051573">TestWriter</span><span class="op" id="7051583">(</span><span class="ident" id="7051584">t</span>&nbsp;<span class="op" id="7051586">*</span><span class="ident" id="7051587"><a href="/mime/multipart/writer_test.go.html#7051555">testing</a></span><span class="op" id="7051594">.</span><span class="ident" id="7051595">T</span><span class="op" id="7051596">)</span>&nbsp;<span class="op" id="7051598">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051601">fileContents</span>&nbsp;<span class="op" id="7051614">:=</span>&nbsp;<span class="op" id="7051617">[</span><span class="op" id="7051618">]</span><span class="builtintype" id="7051619">byte</span><span class="op" id="7051623">(</span><span class="string" id="7051624">&#34;my&nbsp;file&nbsp;contents&#34;</span><span class="op" id="7051642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051646">var</span>&nbsp;<span class="ident" id="7051650">b</span>&nbsp;<span class="ident" id="7051652"><a href="/mime/multipart/writer_test.go.html#7051522">bytes</a></span><span class="op" id="7051657">.</span><span class="ident" id="7051658">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051666">w</span>&nbsp;<span class="op" id="7051668">:=</span>&nbsp;<span class="ident" id="7051671"><a href="/mime/multipart/writer.go.html#3979643">NewWriter</a></span><span class="op" id="7051680">(</span><span class="op" id="7051681">&amp;</span><span class="ident" id="7051682"><a href="/mime/multipart/writer_test.go.html#7051650">b</a></span><span class="op" id="7051683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051686">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051690">part</span><span class="op" id="7051694">,</span>&nbsp;<span class="ident" id="7051696">err</span>&nbsp;<span class="op" id="7051700">:=</span>&nbsp;<span class="ident" id="7051703"><a href="/mime/multipart/writer_test.go.html#7051666">w</a></span><span class="op" id="7051704">.</span><span class="ident" id="7051705">CreateFormFile</span><span class="op" id="7051719">(</span><span class="string" id="7051720">&#34;myfile&#34;</span><span class="op" id="7051728">,</span>&nbsp;<span class="string" id="7051730">&#34;my-file.txt&#34;</span><span class="op" id="7051743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051747">if</span>&nbsp;<span class="ident" id="7051750"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span>&nbsp;<span class="op" id="7051754">!=</span>&nbsp;<span class="ident" id="7051757">nil</span>&nbsp;<span class="op" id="7051761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051766"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7051767">.</span><span class="ident" id="7051768">Fatalf</span><span class="op" id="7051774">(</span><span class="string" id="7051775">&#34;CreateFormFile:&nbsp;%v&#34;</span><span class="op" id="7051795">,</span>&nbsp;<span class="ident" id="7051797"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span><span class="op" id="7051800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051808"><a href="/mime/multipart/writer_test.go.html#7051690">part</a></span><span class="op" id="7051812">.</span><span class="ident" id="7051813">Write</span><span class="op" id="7051818">(</span><span class="ident" id="7051819"><a href="/mime/multipart/writer_test.go.html#7051601">fileContents</a></span><span class="op" id="7051831">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051835"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span>&nbsp;<span class="op" id="7051839">=</span>&nbsp;<span class="ident" id="7051841"><a href="/mime/multipart/writer_test.go.html#7051666">w</a></span><span class="op" id="7051842">.</span><span class="ident" id="7051843">WriteField</span><span class="op" id="7051853">(</span><span class="string" id="7051854">&#34;key&#34;</span><span class="op" id="7051859">,</span>&nbsp;<span class="string" id="7051861">&#34;val&#34;</span><span class="op" id="7051866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051870">if</span>&nbsp;<span class="ident" id="7051873"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span>&nbsp;<span class="op" id="7051877">!=</span>&nbsp;<span class="ident" id="7051880">nil</span>&nbsp;<span class="op" id="7051884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051889"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7051890">.</span><span class="ident" id="7051891">Fatalf</span><span class="op" id="7051897">(</span><span class="string" id="7051898">&#34;WriteField:&nbsp;%v&#34;</span><span class="op" id="7051914">,</span>&nbsp;<span class="ident" id="7051916"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span><span class="op" id="7051919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7051923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051927"><a href="/mime/multipart/writer_test.go.html#7051690">part</a></span><span class="op" id="7051931">.</span><span class="ident" id="7051932">Write</span><span class="op" id="7051937">(</span><span class="op" id="7051938">[</span><span class="op" id="7051939">]</span><span class="builtintype" id="7051940">byte</span><span class="op" id="7051944">(</span><span class="string" id="7051945">&#34;val&#34;</span><span class="op" id="7051950">)</span><span class="op" id="7051951">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051955"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span>&nbsp;<span class="op" id="7051959">=</span>&nbsp;<span class="ident" id="7051961"><a href="/mime/multipart/writer_test.go.html#7051666">w</a></span><span class="op" id="7051962">.</span><span class="ident" id="7051963">Close</span><span class="op" id="7051968">(</span><span class="op" id="7051969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7051973">if</span>&nbsp;<span class="ident" id="7051976"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span>&nbsp;<span class="op" id="7051980">!=</span>&nbsp;<span class="ident" id="7051983">nil</span>&nbsp;<span class="op" id="7051987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7051992"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7051993">.</span><span class="ident" id="7051994">Fatalf</span><span class="op" id="7052000">(</span><span class="string" id="7052001">&#34;Close:&nbsp;%v&#34;</span><span class="op" id="7052012">,</span>&nbsp;<span class="ident" id="7052014"><a href="/mime/multipart/writer_test.go.html#7051696">err</a></span><span class="op" id="7052017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052025">s</span>&nbsp;<span class="op" id="7052027">:=</span>&nbsp;<span class="ident" id="7052030"><a href="/mime/multipart/writer_test.go.html#7051650">b</a></span><span class="op" id="7052031">.</span><span class="ident" id="7052032">String</span><span class="op" id="7052038">(</span><span class="op" id="7052039">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052043">if</span>&nbsp;<span class="builtinfunc" id="7052046">len</span><span class="op" id="7052049">(</span><span class="ident" id="7052050"><a href="/mime/multipart/writer_test.go.html#7052025">s</a></span><span class="op" id="7052051">)</span>&nbsp;<span class="op" id="7052053">==</span>&nbsp;<span class="num" id="7052056">0</span>&nbsp;<span class="op" id="7052058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052063"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052064">.</span><span class="ident" id="7052065">Fatal</span><span class="op" id="7052070">(</span><span class="string" id="7052071">&#34;String:&nbsp;unexpected&nbsp;empty&nbsp;result&#34;</span><span class="op" id="7052104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052112">if</span>&nbsp;<span class="ident" id="7052115"><a href="/mime/multipart/writer_test.go.html#7052025">s</a></span><span class="op" id="7052116">[</span><span class="num" id="7052117">0</span><span class="op" id="7052118">]</span>&nbsp;<span class="op" id="7052120">==</span>&nbsp;<span class="string" id="7052123">&#39;\r&#39;</span>&nbsp;<span class="op" id="7052128">||</span>&nbsp;<span class="ident" id="7052131"><a href="/mime/multipart/writer_test.go.html#7052025">s</a></span><span class="op" id="7052132">[</span><span class="num" id="7052133">0</span><span class="op" id="7052134">]</span>&nbsp;<span class="op" id="7052136">==</span>&nbsp;<span class="string" id="7052139">&#39;\n&#39;</span>&nbsp;<span class="op" id="7052144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052149"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052150">.</span><span class="ident" id="7052151">Fatal</span><span class="op" id="7052156">(</span><span class="string" id="7052157">&#34;String:&nbsp;unexpected&nbsp;newline&#34;</span><span class="op" id="7052185">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052196">r</span>&nbsp;<span class="op" id="7052198">:=</span>&nbsp;<span class="ident" id="7052201"><a href="/mime/multipart/multipart.go.html#3968802">NewReader</a></span><span class="op" id="7052210">(</span><span class="op" id="7052211">&amp;</span><span class="ident" id="7052212"><a href="/mime/multipart/writer_test.go.html#7051650">b</a></span><span class="op" id="7052213">,</span>&nbsp;<span class="ident" id="7052215"><a href="/mime/multipart/writer_test.go.html#7051666">w</a></span><span class="op" id="7052216">.</span><span class="ident" id="7052217">Boundary</span><span class="op" id="7052225">(</span><span class="op" id="7052226">)</span><span class="op" id="7052227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052231">part</span><span class="op" id="7052235">,</span>&nbsp;<span class="ident" id="7052237">err</span>&nbsp;<span class="op" id="7052241">:=</span>&nbsp;<span class="ident" id="7052244"><a href="/mime/multipart/writer_test.go.html#7052196">r</a></span><span class="op" id="7052245">.</span><span class="ident" id="7052246">NextPart</span><span class="op" id="7052254">(</span><span class="op" id="7052255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052258">if</span>&nbsp;<span class="ident" id="7052261"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052265">!=</span>&nbsp;<span class="ident" id="7052268">nil</span>&nbsp;<span class="op" id="7052272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052276"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052277">.</span><span class="ident" id="7052278">Fatalf</span><span class="op" id="7052284">(</span><span class="string" id="7052285">&#34;part&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7052297">,</span>&nbsp;<span class="ident" id="7052299"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span><span class="op" id="7052302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052308">if</span>&nbsp;<span class="ident" id="7052311">g</span><span class="op" id="7052312">,</span>&nbsp;<span class="ident" id="7052314">e</span>&nbsp;<span class="op" id="7052316">:=</span>&nbsp;<span class="ident" id="7052319"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052323">.</span><span class="ident" id="7052324">FormName</span><span class="op" id="7052332">(</span><span class="op" id="7052333">)</span><span class="op" id="7052334">,</span>&nbsp;<span class="string" id="7052336">&#34;myfile&#34;</span><span class="op" id="7052344">;</span>&nbsp;<span class="ident" id="7052346"><a href="/mime/multipart/writer_test.go.html#7052311">g</a></span>&nbsp;<span class="op" id="7052348">!=</span>&nbsp;<span class="ident" id="7052351"><a href="/mime/multipart/writer_test.go.html#7052314">e</a></span>&nbsp;<span class="op" id="7052353">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052357"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052358">.</span><span class="ident" id="7052359">Errorf</span><span class="op" id="7052365">(</span><span class="string" id="7052366">&#34;part&nbsp;1:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7052401">,</span>&nbsp;<span class="ident" id="7052403"><a href="/mime/multipart/writer_test.go.html#7052314">e</a></span><span class="op" id="7052404">,</span>&nbsp;<span class="ident" id="7052406"><a href="/mime/multipart/writer_test.go.html#7052311">g</a></span><span class="op" id="7052407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052413">slurp</span><span class="op" id="7052418">,</span>&nbsp;<span class="ident" id="7052420"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052424">:=</span>&nbsp;<span class="ident" id="7052427"><a href="/mime/multipart/writer_test.go.html#7051531">ioutil</a></span><span class="op" id="7052433">.</span><span class="ident" id="7052434">ReadAll</span><span class="op" id="7052441">(</span><span class="ident" id="7052442"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052449">if</span>&nbsp;<span class="ident" id="7052452"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052456">!=</span>&nbsp;<span class="ident" id="7052459">nil</span>&nbsp;<span class="op" id="7052463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052467"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052468">.</span><span class="ident" id="7052469">Fatalf</span><span class="op" id="7052475">(</span><span class="string" id="7052476">&#34;part&nbsp;1:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7052497">,</span>&nbsp;<span class="ident" id="7052499"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span><span class="op" id="7052502">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052508">if</span>&nbsp;<span class="ident" id="7052511">e</span><span class="op" id="7052512">,</span>&nbsp;<span class="ident" id="7052514">g</span>&nbsp;<span class="op" id="7052516">:=</span>&nbsp;<span class="builtintype" id="7052519">string</span><span class="op" id="7052525">(</span><span class="ident" id="7052526"><a href="/mime/multipart/writer_test.go.html#7051601">fileContents</a></span><span class="op" id="7052538">)</span><span class="op" id="7052539">,</span>&nbsp;<span class="builtintype" id="7052541">string</span><span class="op" id="7052547">(</span><span class="ident" id="7052548"><a href="/mime/multipart/writer_test.go.html#7052413">slurp</a></span><span class="op" id="7052553">)</span><span class="op" id="7052554">;</span>&nbsp;<span class="ident" id="7052556"><a href="/mime/multipart/writer_test.go.html#7052511">e</a></span>&nbsp;<span class="op" id="7052558">!=</span>&nbsp;<span class="ident" id="7052561"><a href="/mime/multipart/writer_test.go.html#7052514">g</a></span>&nbsp;<span class="op" id="7052563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052567"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052568">.</span><span class="ident" id="7052569">Errorf</span><span class="op" id="7052575">(</span><span class="string" id="7052576">&#34;part&nbsp;1:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7052610">,</span>&nbsp;<span class="ident" id="7052612"><a href="/mime/multipart/writer_test.go.html#7052511">e</a></span><span class="op" id="7052613">,</span>&nbsp;<span class="ident" id="7052615"><a href="/mime/multipart/writer_test.go.html#7052514">g</a></span><span class="op" id="7052616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052623"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052627">,</span>&nbsp;<span class="ident" id="7052629"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052633">=</span>&nbsp;<span class="ident" id="7052635"><a href="/mime/multipart/writer_test.go.html#7052196">r</a></span><span class="op" id="7052636">.</span><span class="ident" id="7052637">NextPart</span><span class="op" id="7052645">(</span><span class="op" id="7052646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052649">if</span>&nbsp;<span class="ident" id="7052652"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052656">!=</span>&nbsp;<span class="ident" id="7052659">nil</span>&nbsp;<span class="op" id="7052663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052667"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052668">.</span><span class="ident" id="7052669">Fatalf</span><span class="op" id="7052675">(</span><span class="string" id="7052676">&#34;part&nbsp;2:&nbsp;%v&#34;</span><span class="op" id="7052688">,</span>&nbsp;<span class="ident" id="7052690"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span><span class="op" id="7052693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052699">if</span>&nbsp;<span class="ident" id="7052702">g</span><span class="op" id="7052703">,</span>&nbsp;<span class="ident" id="7052705">e</span>&nbsp;<span class="op" id="7052707">:=</span>&nbsp;<span class="ident" id="7052710"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052714">.</span><span class="ident" id="7052715">FormName</span><span class="op" id="7052723">(</span><span class="op" id="7052724">)</span><span class="op" id="7052725">,</span>&nbsp;<span class="string" id="7052727">&#34;key&#34;</span><span class="op" id="7052732">;</span>&nbsp;<span class="ident" id="7052734"><a href="/mime/multipart/writer_test.go.html#7052702">g</a></span>&nbsp;<span class="op" id="7052736">!=</span>&nbsp;<span class="ident" id="7052739"><a href="/mime/multipart/writer_test.go.html#7052705">e</a></span>&nbsp;<span class="op" id="7052741">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052745"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052746">.</span><span class="ident" id="7052747">Errorf</span><span class="op" id="7052753">(</span><span class="string" id="7052754">&#34;part&nbsp;2:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7052789">,</span>&nbsp;<span class="ident" id="7052791"><a href="/mime/multipart/writer_test.go.html#7052705">e</a></span><span class="op" id="7052792">,</span>&nbsp;<span class="ident" id="7052794"><a href="/mime/multipart/writer_test.go.html#7052702">g</a></span><span class="op" id="7052795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052801"><a href="/mime/multipart/writer_test.go.html#7052413">slurp</a></span><span class="op" id="7052806">,</span>&nbsp;<span class="ident" id="7052808"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052812">=</span>&nbsp;<span class="ident" id="7052814"><a href="/mime/multipart/writer_test.go.html#7051531">ioutil</a></span><span class="op" id="7052820">.</span><span class="ident" id="7052821">ReadAll</span><span class="op" id="7052828">(</span><span class="ident" id="7052829"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052836">if</span>&nbsp;<span class="ident" id="7052839"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7052843">!=</span>&nbsp;<span class="ident" id="7052846">nil</span>&nbsp;<span class="op" id="7052850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052854"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052855">.</span><span class="ident" id="7052856">Fatalf</span><span class="op" id="7052862">(</span><span class="string" id="7052863">&#34;part&nbsp;2:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7052884">,</span>&nbsp;<span class="ident" id="7052886"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span><span class="op" id="7052889">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7052895">if</span>&nbsp;<span class="ident" id="7052898">e</span><span class="op" id="7052899">,</span>&nbsp;<span class="ident" id="7052901">g</span>&nbsp;<span class="op" id="7052903">:=</span>&nbsp;<span class="string" id="7052906">&#34;val&#34;</span><span class="op" id="7052911">,</span>&nbsp;<span class="builtintype" id="7052913">string</span><span class="op" id="7052919">(</span><span class="ident" id="7052920"><a href="/mime/multipart/writer_test.go.html#7052413">slurp</a></span><span class="op" id="7052925">)</span><span class="op" id="7052926">;</span>&nbsp;<span class="ident" id="7052928"><a href="/mime/multipart/writer_test.go.html#7052898">e</a></span>&nbsp;<span class="op" id="7052930">!=</span>&nbsp;<span class="ident" id="7052933"><a href="/mime/multipart/writer_test.go.html#7052901">g</a></span>&nbsp;<span class="op" id="7052935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052939"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7052940">.</span><span class="ident" id="7052941">Errorf</span><span class="op" id="7052947">(</span><span class="string" id="7052948">&#34;part&nbsp;2:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7052982">,</span>&nbsp;<span class="ident" id="7052984"><a href="/mime/multipart/writer_test.go.html#7052898">e</a></span><span class="op" id="7052985">,</span>&nbsp;<span class="ident" id="7052987"><a href="/mime/multipart/writer_test.go.html#7052901">g</a></span><span class="op" id="7052988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7052991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7052995"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7052999">,</span>&nbsp;<span class="ident" id="7053001"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7053005">=</span>&nbsp;<span class="ident" id="7053007"><a href="/mime/multipart/writer_test.go.html#7052196">r</a></span><span class="op" id="7053008">.</span><span class="ident" id="7053009">NextPart</span><span class="op" id="7053017">(</span><span class="op" id="7053018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053021">if</span>&nbsp;<span class="ident" id="7053024"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span>&nbsp;<span class="op" id="7053029">!=</span>&nbsp;<span class="ident" id="7053032">nil</span>&nbsp;<span class="op" id="7053036">||</span>&nbsp;<span class="ident" id="7053039"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span>&nbsp;<span class="op" id="7053043">==</span>&nbsp;<span class="ident" id="7053046">nil</span>&nbsp;<span class="op" id="7053050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053054"><a href="/mime/multipart/writer_test.go.html#7051584">t</a></span><span class="op" id="7053055">.</span><span class="ident" id="7053056">Fatalf</span><span class="op" id="7053062">(</span><span class="string" id="7053063">&#34;expected&nbsp;end&nbsp;of&nbsp;parts;&nbsp;got&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7053098">,</span>&nbsp;<span class="ident" id="7053100"><a href="/mime/multipart/writer_test.go.html#7052231">part</a></span><span class="op" id="7053104">,</span>&nbsp;<span class="ident" id="7053106"><a href="/mime/multipart/writer_test.go.html#7052237">err</a></span><span class="op" id="7053109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053112">}</span><br>
<span class="lineno"></span><span class="op" id="7053114">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7053117">func</span>&nbsp;<span class="ident" id="7053122">TestWriterSetBoundary</span><span class="op" id="7053143">(</span><span class="ident" id="7053144">t</span>&nbsp;<span class="op" id="7053146">*</span><span class="ident" id="7053147"><a href="/mime/multipart/writer_test.go.html#7051555">testing</a></span><span class="op" id="7053154">.</span><span class="ident" id="7053155">T</span><span class="op" id="7053156">)</span>&nbsp;<span class="op" id="7053158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053161">var</span>&nbsp;<span class="ident" id="7053165">b</span>&nbsp;<span class="ident" id="7053167"><a href="/mime/multipart/writer_test.go.html#7051522">bytes</a></span><span class="op" id="7053172">.</span><span class="ident" id="7053173">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053181">w</span>&nbsp;<span class="op" id="7053183">:=</span>&nbsp;<span class="ident" id="7053186"><a href="/mime/multipart/writer.go.html#3979643">NewWriter</a></span><span class="op" id="7053195">(</span><span class="op" id="7053196">&amp;</span><span class="ident" id="7053197"><a href="/mime/multipart/writer_test.go.html#7053165">b</a></span><span class="op" id="7053198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053201">tests</span>&nbsp;<span class="op" id="7053207">:=</span>&nbsp;<span class="op" id="7053210">[</span><span class="op" id="7053211">]</span><span class="keyword" id="7053212">struct</span>&nbsp;<span class="op" id="7053219">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053223">b</span>&nbsp;&nbsp;<span class="builtintype" id="7053226">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053235">ok</span>&nbsp;<span class="builtintype" id="7053238">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053244">}</span><span class="op" id="7053245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053249">{</span><span class="string" id="7053250">&#34;abc&#34;</span><span class="op" id="7053255">,</span>&nbsp;<span class="ident" id="7053257">true</span><span class="op" id="7053261">}</span><span class="op" id="7053262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053266">{</span><span class="string" id="7053267">&#34;&#34;</span><span class="op" id="7053269">,</span>&nbsp;<span class="ident" id="7053271">false</span><span class="op" id="7053276">}</span><span class="op" id="7053277">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053281">{</span><span class="string" id="7053282">&#34;ung√ºltig&#34;</span><span class="op" id="7053293">,</span>&nbsp;<span class="ident" id="7053295">false</span><span class="op" id="7053300">}</span><span class="op" id="7053301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053305">{</span><span class="string" id="7053306">&#34;!&#34;</span><span class="op" id="7053309">,</span>&nbsp;<span class="ident" id="7053311">false</span><span class="op" id="7053316">}</span><span class="op" id="7053317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053321">{</span><span class="ident" id="7053322"><a href="/mime/multipart/writer_test.go.html#7051544">strings</a></span><span class="op" id="7053329">.</span><span class="ident" id="7053330">Repeat</span><span class="op" id="7053336">(</span><span class="string" id="7053337">&#34;x&#34;</span><span class="op" id="7053340">,</span>&nbsp;<span class="num" id="7053342">69</span><span class="op" id="7053344">)</span><span class="op" id="7053345">,</span>&nbsp;<span class="ident" id="7053347">true</span><span class="op" id="7053351">}</span><span class="op" id="7053352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053356">{</span><span class="ident" id="7053357"><a href="/mime/multipart/writer_test.go.html#7051544">strings</a></span><span class="op" id="7053364">.</span><span class="ident" id="7053365">Repeat</span><span class="op" id="7053371">(</span><span class="string" id="7053372">&#34;x&#34;</span><span class="op" id="7053375">,</span>&nbsp;<span class="num" id="7053377">70</span><span class="op" id="7053379">)</span><span class="op" id="7053380">,</span>&nbsp;<span class="ident" id="7053382">false</span><span class="op" id="7053387">}</span><span class="op" id="7053388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053392">{</span><span class="string" id="7053393">&#34;bad!ascii!&#34;</span><span class="op" id="7053405">,</span>&nbsp;<span class="ident" id="7053407">false</span><span class="op" id="7053412">}</span><span class="op" id="7053413">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053417">{</span><span class="string" id="7053418">&#34;my-separator&#34;</span><span class="op" id="7053432">,</span>&nbsp;<span class="ident" id="7053434">true</span><span class="op" id="7053438">}</span><span class="op" id="7053439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053445">for</span>&nbsp;<span class="ident" id="7053449">i</span><span class="op" id="7053450">,</span>&nbsp;<span class="ident" id="7053452">tt</span>&nbsp;<span class="op" id="7053455">:=</span>&nbsp;<span class="keyword" id="7053458">range</span>&nbsp;<span class="ident" id="7053464"><a href="/mime/multipart/writer_test.go.html#7053201">tests</a></span>&nbsp;<span class="op" id="7053470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053474">err</span>&nbsp;<span class="op" id="7053478">:=</span>&nbsp;<span class="ident" id="7053481"><a href="/mime/multipart/writer_test.go.html#7053181">w</a></span><span class="op" id="7053482">.</span><span class="ident" id="7053483">SetBoundary</span><span class="op" id="7053494">(</span><span class="ident" id="7053495"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053497">.</span><span class="ident" id="7053498">b</span><span class="op" id="7053499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053503">got</span>&nbsp;<span class="op" id="7053507">:=</span>&nbsp;<span class="ident" id="7053510"><a href="/mime/multipart/writer_test.go.html#7053474">err</a></span>&nbsp;<span class="op" id="7053514">==</span>&nbsp;<span class="ident" id="7053517">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053523">if</span>&nbsp;<span class="ident" id="7053526"><a href="/mime/multipart/writer_test.go.html#7053503">got</a></span>&nbsp;<span class="op" id="7053530">!=</span>&nbsp;<span class="ident" id="7053533"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053535">.</span><span class="ident" id="7053536">ok</span>&nbsp;<span class="op" id="7053539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053544"><a href="/mime/multipart/writer_test.go.html#7053144">t</a></span><span class="op" id="7053545">.</span><span class="ident" id="7053546">Errorf</span><span class="op" id="7053552">(</span><span class="string" id="7053553">&#34;%d.&nbsp;boundary&nbsp;%q&nbsp;=&nbsp;%v&nbsp;(%v);&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7053589">,</span>&nbsp;<span class="ident" id="7053591"><a href="/mime/multipart/writer_test.go.html#7053449">i</a></span><span class="op" id="7053592">,</span>&nbsp;<span class="ident" id="7053594"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053596">.</span><span class="ident" id="7053597">b</span><span class="op" id="7053598">,</span>&nbsp;<span class="ident" id="7053600"><a href="/mime/multipart/writer_test.go.html#7053503">got</a></span><span class="op" id="7053603">,</span>&nbsp;<span class="ident" id="7053605"><a href="/mime/multipart/writer_test.go.html#7053474">err</a></span><span class="op" id="7053608">,</span>&nbsp;<span class="ident" id="7053610"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053612">.</span><span class="ident" id="7053613">ok</span><span class="op" id="7053615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053619">}</span>&nbsp;<span class="keyword" id="7053621">else</span>&nbsp;<span class="keyword" id="7053626">if</span>&nbsp;<span class="ident" id="7053629"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053631">.</span><span class="ident" id="7053632">ok</span>&nbsp;<span class="op" id="7053635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053640">got</span>&nbsp;<span class="op" id="7053644">:=</span>&nbsp;<span class="ident" id="7053647"><a href="/mime/multipart/writer_test.go.html#7053181">w</a></span><span class="op" id="7053648">.</span><span class="ident" id="7053649">Boundary</span><span class="op" id="7053657">(</span><span class="op" id="7053658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053663">if</span>&nbsp;<span class="ident" id="7053666"><a href="/mime/multipart/writer_test.go.html#7053640">got</a></span>&nbsp;<span class="op" id="7053670">!=</span>&nbsp;<span class="ident" id="7053673"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053675">.</span><span class="ident" id="7053676">b</span>&nbsp;<span class="op" id="7053678">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053684"><a href="/mime/multipart/writer_test.go.html#7053144">t</a></span><span class="op" id="7053685">.</span><span class="ident" id="7053686">Errorf</span><span class="op" id="7053692">(</span><span class="string" id="7053693">&#34;boundary&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7053717">,</span>&nbsp;<span class="ident" id="7053719"><a href="/mime/multipart/writer_test.go.html#7053640">got</a></span><span class="op" id="7053722">,</span>&nbsp;<span class="ident" id="7053724"><a href="/mime/multipart/writer_test.go.html#7053452">tt</a></span><span class="op" id="7053726">.</span><span class="ident" id="7053727">b</span><span class="op" id="7053728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053743"><a href="/mime/multipart/writer_test.go.html#7053181">w</a></span><span class="op" id="7053744">.</span><span class="ident" id="7053745">Close</span><span class="op" id="7053750">(</span><span class="op" id="7053751">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7053754">if</span>&nbsp;<span class="ident" id="7053757">got</span>&nbsp;<span class="op" id="7053761">:=</span>&nbsp;<span class="ident" id="7053764"><a href="/mime/multipart/writer_test.go.html#7053165">b</a></span><span class="op" id="7053765">.</span><span class="ident" id="7053766">String</span><span class="op" id="7053772">(</span><span class="op" id="7053773">)</span><span class="op" id="7053774">;</span>&nbsp;<span class="op" id="7053776">!</span><span class="ident" id="7053777"><a href="/mime/multipart/writer_test.go.html#7051544">strings</a></span><span class="op" id="7053784">.</span><span class="ident" id="7053785">Contains</span><span class="op" id="7053793">(</span><span class="ident" id="7053794"><a href="/mime/multipart/writer_test.go.html#7053757">got</a></span><span class="op" id="7053797">,</span>&nbsp;<span class="string" id="7053799">&#34;\r\n--my-separator--\r\n&#34;</span><span class="op" id="7053825">)</span>&nbsp;<span class="op" id="7053827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7053831"><a href="/mime/multipart/writer_test.go.html#7053144">t</a></span><span class="op" id="7053832">.</span><span class="ident" id="7053833">Errorf</span><span class="op" id="7053839">(</span><span class="string" id="7053840">&#34;expected&nbsp;my-separator&nbsp;in&nbsp;output.&nbsp;got:&nbsp;%q&#34;</span><span class="op" id="7053882">,</span>&nbsp;<span class="ident" id="7053884"><a href="/mime/multipart/writer_test.go.html#7053757">got</a></span><span class="op" id="7053887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7053890">}</span><br>
<span class="lineno"></span><span class="op" id="7053892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7053895">func</span>&nbsp;<span class="ident" id="7053900">TestWriterBoundaryGoroutines</span><span class="op" id="7053928">(</span><span class="ident" id="7053929">t</span>&nbsp;<span class="op" id="7053931">*</span><span class="ident" id="7053932"><a href="/mime/multipart/writer_test.go.html#7051555">testing</a></span><span class="op" id="7053939">.</span><span class="ident" id="7053940">T</span><span class="op" id="7053941">)</span>&nbsp;<span class="op" id="7053943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7053946">//&nbsp;Verify&nbsp;there&#39;s&nbsp;no&nbsp;data&nbsp;race&nbsp;accessing&nbsp;any&nbsp;lazy&nbsp;boundary&nbsp;if&nbsp;it&#39;s&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7054022">//&nbsp;different&nbsp;goroutines.&nbsp;This&nbsp;was&nbsp;previously&nbsp;broken&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7054078">//&nbsp;https://codereview.appspot.com/95760043/&nbsp;and&nbsp;reverted&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7054139">//&nbsp;https://codereview.appspot.com/117600043/</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054185">w</span>&nbsp;<span class="op" id="7054187">:=</span>&nbsp;<span class="ident" id="7054190"><a href="/mime/multipart/writer.go.html#3979643">NewWriter</a></span><span class="op" id="7054199">(</span><span class="ident" id="7054200"><a href="/mime/multipart/writer_test.go.html#7051531">ioutil</a></span><span class="op" id="7054206">.</span><span class="ident" id="7054207">Discard</span><span class="op" id="7054214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054217">done</span>&nbsp;<span class="op" id="7054222">:=</span>&nbsp;<span class="builtinfunc" id="7054225">make</span><span class="op" id="7054229">(</span><span class="keyword" id="7054230">chan</span>&nbsp;<span class="builtintype" id="7054235">int</span><span class="op" id="7054238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054241">go</span>&nbsp;<span class="keyword" id="7054244">func</span><span class="op" id="7054248">(</span><span class="op" id="7054249">)</span>&nbsp;<span class="op" id="7054251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054255"><a href="/mime/multipart/writer_test.go.html#7054185">w</a></span><span class="op" id="7054256">.</span><span class="ident" id="7054257">CreateFormField</span><span class="op" id="7054272">(</span><span class="string" id="7054273">&#34;foo&#34;</span><span class="op" id="7054278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054282"><a href="/mime/multipart/writer_test.go.html#7054217">done</a></span>&nbsp;<span class="op" id="7054287">&lt;-</span>&nbsp;<span class="num" id="7054290">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054293">}</span><span class="op" id="7054294">(</span><span class="op" id="7054295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054298"><a href="/mime/multipart/writer_test.go.html#7054185">w</a></span><span class="op" id="7054299">.</span><span class="ident" id="7054300">Boundary</span><span class="op" id="7054308">(</span><span class="op" id="7054309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054312">&lt;-</span><span class="ident" id="7054314"><a href="/mime/multipart/writer_test.go.html#7054217">done</a></span><br>
<span class="lineno"></span><span class="op" id="7054319">}</span>
</div>
</body>
</html>
