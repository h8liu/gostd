<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5646442">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5646497">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5646551">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5646602">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="5646659">package</span>&nbsp;<span class="ident" id="5646667">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5646673">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5646726">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="5646797">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="5646868">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="5646936">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="5646962">//</span><br>
<span class="lineno"></span><span class="keyword" id="5646965">type</span>&nbsp;<span class="ident" id="5646970">Ring</span>&nbsp;<span class="keyword" id="5646975">struct</span>&nbsp;<span class="op" id="5646982">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5646985">next</span><span class="op" id="5646989">,</span>&nbsp;<span class="ident" id="5646991">prev</span>&nbsp;<span class="op" id="5646996">*</span><span class="ident" id="5646997">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647003">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5647014">interface</span><span class="op" id="5647023">{</span><span class="op" id="5647024">}</span>&nbsp;<span class="comment" id="5647026">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="5647074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5647077">func</span>&nbsp;<span class="op" id="5647082">(</span><span class="ident" id="5647083">r</span>&nbsp;<span class="op" id="5647085">*</span><span class="ident" id="5647086">Ring</span><span class="op" id="5647090">)</span>&nbsp;<span class="ident" id="5647092">init</span><span class="op" id="5647096">(</span><span class="op" id="5647097">)</span>&nbsp;<span class="op" id="5647099">*</span><span class="ident" id="5647100">Ring</span>&nbsp;<span class="op" id="5647105">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647108">r</span><span class="op" id="5647109">.</span><span class="ident" id="5647110">next</span>&nbsp;<span class="op" id="5647115">=</span>&nbsp;<span class="ident" id="5647117">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647120">r</span><span class="op" id="5647121">.</span><span class="ident" id="5647122">prev</span>&nbsp;<span class="op" id="5647127">=</span>&nbsp;<span class="ident" id="5647129">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647132">return</span>&nbsp;<span class="ident" id="5647139">r</span><br>
<span class="lineno"></span><span class="op" id="5647141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5647144">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5647204">func</span>&nbsp;<span class="op" id="5647209">(</span><span class="ident" id="5647210">r</span>&nbsp;<span class="op" id="5647212">*</span><span class="ident" id="5647213">Ring</span><span class="op" id="5647217">)</span>&nbsp;<span class="ident" id="5647219">Next</span><span class="op" id="5647223">(</span><span class="op" id="5647224">)</span>&nbsp;<span class="op" id="5647226">*</span><span class="ident" id="5647227">Ring</span>&nbsp;<span class="op" id="5647232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647235">if</span>&nbsp;<span class="ident" id="5647238">r</span><span class="op" id="5647239">.</span><span class="ident" id="5647240">next</span>&nbsp;<span class="op" id="5647245">==</span>&nbsp;<span class="ident" id="5647248">nil</span>&nbsp;<span class="op" id="5647252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647256">return</span>&nbsp;<span class="ident" id="5647263">r</span><span class="op" id="5647264">.</span><span class="ident" id="5647265">init</span><span class="op" id="5647269">(</span><span class="op" id="5647270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647273">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647276">return</span>&nbsp;<span class="ident" id="5647283">r</span><span class="op" id="5647284">.</span><span class="ident" id="5647285">next</span><br>
<span class="lineno"></span><span class="op" id="5647290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5647293">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5647357">func</span>&nbsp;<span class="op" id="5647362">(</span><span class="ident" id="5647363">r</span>&nbsp;<span class="op" id="5647365">*</span><span class="ident" id="5647366">Ring</span><span class="op" id="5647370">)</span>&nbsp;<span class="ident" id="5647372">Prev</span><span class="op" id="5647376">(</span><span class="op" id="5647377">)</span>&nbsp;<span class="op" id="5647379">*</span><span class="ident" id="5647380">Ring</span>&nbsp;<span class="op" id="5647385">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647388">if</span>&nbsp;<span class="ident" id="5647391">r</span><span class="op" id="5647392">.</span><span class="ident" id="5647393">next</span>&nbsp;<span class="op" id="5647398">==</span>&nbsp;<span class="ident" id="5647401">nil</span>&nbsp;<span class="op" id="5647405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647409">return</span>&nbsp;<span class="ident" id="5647416">r</span><span class="op" id="5647417">.</span><span class="ident" id="5647418">init</span><span class="op" id="5647422">(</span><span class="op" id="5647423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647429">return</span>&nbsp;<span class="ident" id="5647436">r</span><span class="op" id="5647437">.</span><span class="ident" id="5647438">prev</span><br>
<span class="lineno"></span><span class="op" id="5647443">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="5647446">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="5647518">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="5647585">//</span><br>
<span class="lineno"></span><span class="keyword" id="5647588">func</span>&nbsp;<span class="op" id="5647593">(</span><span class="ident" id="5647594">r</span>&nbsp;<span class="op" id="5647596">*</span><span class="ident" id="5647597">Ring</span><span class="op" id="5647601">)</span>&nbsp;<span class="ident" id="5647603">Move</span><span class="op" id="5647607">(</span><span class="ident" id="5647608">n</span>&nbsp;<span class="builtintype" id="5647610">int</span><span class="op" id="5647613">)</span>&nbsp;<span class="op" id="5647615">*</span><span class="ident" id="5647616">Ring</span>&nbsp;<span class="op" id="5647621">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647624">if</span>&nbsp;<span class="ident" id="5647627">r</span><span class="op" id="5647628">.</span><span class="ident" id="5647629">next</span>&nbsp;<span class="op" id="5647634">==</span>&nbsp;<span class="ident" id="5647637">nil</span>&nbsp;<span class="op" id="5647641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647645">return</span>&nbsp;<span class="ident" id="5647652">r</span><span class="op" id="5647653">.</span><span class="ident" id="5647654">init</span><span class="op" id="5647658">(</span><span class="op" id="5647659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647665">switch</span>&nbsp;<span class="op" id="5647672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647675">case</span>&nbsp;<span class="ident" id="5647680">n</span>&nbsp;<span class="op" id="5647682">&lt;</span>&nbsp;<span class="num" id="5647684">0</span><span class="op" id="5647685">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647689">for</span>&nbsp;<span class="op" id="5647693">;</span>&nbsp;<span class="ident" id="5647695">n</span>&nbsp;<span class="op" id="5647697">&lt;</span>&nbsp;<span class="num" id="5647699">0</span><span class="op" id="5647700">;</span>&nbsp;<span class="ident" id="5647702">n</span><span class="op" id="5647703">++</span>&nbsp;<span class="op" id="5647706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647711">r</span>&nbsp;<span class="op" id="5647713">=</span>&nbsp;<span class="ident" id="5647715">r</span><span class="op" id="5647716">.</span><span class="ident" id="5647717">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647727">case</span>&nbsp;<span class="ident" id="5647732">n</span>&nbsp;<span class="op" id="5647734">&gt;</span>&nbsp;<span class="num" id="5647736">0</span><span class="op" id="5647737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647741">for</span>&nbsp;<span class="op" id="5647745">;</span>&nbsp;<span class="ident" id="5647747">n</span>&nbsp;<span class="op" id="5647749">&gt;</span>&nbsp;<span class="num" id="5647751">0</span><span class="op" id="5647752">;</span>&nbsp;<span class="ident" id="5647754">n</span><span class="op" id="5647755">--</span>&nbsp;<span class="op" id="5647758">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647763">r</span>&nbsp;<span class="op" id="5647765">=</span>&nbsp;<span class="ident" id="5647767">r</span><span class="op" id="5647768">.</span><span class="ident" id="5647769">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647782">return</span>&nbsp;<span class="ident" id="5647789">r</span><br>
<span class="lineno"></span><span class="op" id="5647791">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5647794">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="5647831">func</span>&nbsp;<span class="ident" id="5647836">New</span><span class="op" id="5647839">(</span><span class="ident" id="5647840">n</span>&nbsp;<span class="builtintype" id="5647842">int</span><span class="op" id="5647845">)</span>&nbsp;<span class="op" id="5647847">*</span><span class="ident" id="5647848">Ring</span>&nbsp;<span class="op" id="5647853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647856">if</span>&nbsp;<span class="ident" id="5647859">n</span>&nbsp;<span class="op" id="5647861">&lt;=</span>&nbsp;<span class="num" id="5647864">0</span>&nbsp;<span class="op" id="5647866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647870">return</span>&nbsp;<span class="ident" id="5647877">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647885">r</span>&nbsp;<span class="op" id="5647887">:=</span>&nbsp;<span class="builtinfunc" id="5647890">new</span><span class="op" id="5647893">(</span><span class="ident" id="5647894">Ring</span><span class="op" id="5647898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647901">p</span>&nbsp;<span class="op" id="5647903">:=</span>&nbsp;<span class="ident" id="5647906">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5647909">for</span>&nbsp;<span class="ident" id="5647913">i</span>&nbsp;<span class="op" id="5647915">:=</span>&nbsp;<span class="num" id="5647918">1</span><span class="op" id="5647919">;</span>&nbsp;<span class="ident" id="5647921">i</span>&nbsp;<span class="op" id="5647923">&lt;</span>&nbsp;<span class="ident" id="5647925">n</span><span class="op" id="5647926">;</span>&nbsp;<span class="ident" id="5647928">i</span><span class="op" id="5647929">++</span>&nbsp;<span class="op" id="5647932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647936">p</span><span class="op" id="5647937">.</span><span class="ident" id="5647938">next</span>&nbsp;<span class="op" id="5647943">=</span>&nbsp;<span class="op" id="5647945">&amp;</span><span class="ident" id="5647946">Ring</span><span class="op" id="5647950">{</span><span class="ident" id="5647951">prev</span><span class="op" id="5647955">:</span>&nbsp;<span class="ident" id="5647957">p</span><span class="op" id="5647958">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647962">p</span>&nbsp;<span class="op" id="5647964">=</span>&nbsp;<span class="ident" id="5647966">p</span><span class="op" id="5647967">.</span><span class="ident" id="5647968">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5647974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647977">p</span><span class="op" id="5647978">.</span><span class="ident" id="5647979">next</span>&nbsp;<span class="op" id="5647984">=</span>&nbsp;<span class="ident" id="5647986">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647989">r</span><span class="op" id="5647990">.</span><span class="ident" id="5647991">prev</span>&nbsp;<span class="op" id="5647996">=</span>&nbsp;<span class="ident" id="5647998">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5648001">return</span>&nbsp;<span class="ident" id="5648008">r</span><br>
<span class="lineno">75</span><span class="op" id="5648010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5648013">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="5648068">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="5648126">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="5648150">//</span><br>
<span class="lineno"></span><span class="comment" id="5648153">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5648199">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5648259">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5648318">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="5648377">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="5648433">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="5648450">//</span><br>
<span class="lineno"></span><span class="comment" id="5648453">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5648501">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="5648563">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5648622">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="5648660">//</span><br>
<span class="lineno"></span><span class="keyword" id="5648663">func</span>&nbsp;<span class="op" id="5648668">(</span><span class="ident" id="5648669">r</span>&nbsp;<span class="op" id="5648671">*</span><span class="ident" id="5648672">Ring</span><span class="op" id="5648676">)</span>&nbsp;<span class="ident" id="5648678">Link</span><span class="op" id="5648682">(</span><span class="ident" id="5648683">s</span>&nbsp;<span class="op" id="5648685">*</span><span class="ident" id="5648686">Ring</span><span class="op" id="5648690">)</span>&nbsp;<span class="op" id="5648692">*</span><span class="ident" id="5648693">Ring</span>&nbsp;<span class="op" id="5648698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648701">n</span>&nbsp;<span class="op" id="5648703">:=</span>&nbsp;<span class="ident" id="5648706">r</span><span class="op" id="5648707">.</span><span class="ident" id="5648708">Next</span><span class="op" id="5648712">(</span><span class="op" id="5648713">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5648716">if</span>&nbsp;<span class="ident" id="5648719">s</span>&nbsp;<span class="op" id="5648721">!=</span>&nbsp;<span class="ident" id="5648724">nil</span>&nbsp;<span class="op" id="5648728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648732">p</span>&nbsp;<span class="op" id="5648734">:=</span>&nbsp;<span class="ident" id="5648737">s</span><span class="op" id="5648738">.</span><span class="ident" id="5648739">Prev</span><span class="op" id="5648743">(</span><span class="op" id="5648744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648748">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648798">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648845">r</span><span class="op" id="5648846">.</span><span class="ident" id="5648847">next</span>&nbsp;<span class="op" id="5648852">=</span>&nbsp;<span class="ident" id="5648854">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648858">s</span><span class="op" id="5648859">.</span><span class="ident" id="5648860">prev</span>&nbsp;<span class="op" id="5648865">=</span>&nbsp;<span class="ident" id="5648867">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648871">n</span><span class="op" id="5648872">.</span><span class="ident" id="5648873">prev</span>&nbsp;<span class="op" id="5648878">=</span>&nbsp;<span class="ident" id="5648880">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648884">p</span><span class="op" id="5648885">.</span><span class="ident" id="5648886">next</span>&nbsp;<span class="op" id="5648891">=</span>&nbsp;<span class="ident" id="5648893">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5648896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5648899">return</span>&nbsp;<span class="ident" id="5648906">n</span><br>
<span class="lineno">105</span><span class="op" id="5648908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5648911">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="5648976">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="5649034">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="5649093">//</span><br>
<span class="lineno"></span><span class="keyword" id="5649096">func</span>&nbsp;<span class="op" id="5649101">(</span><span class="ident" id="5649102">r</span>&nbsp;<span class="op" id="5649104">*</span><span class="ident" id="5649105">Ring</span><span class="op" id="5649109">)</span>&nbsp;<span class="ident" id="5649111">Unlink</span><span class="op" id="5649117">(</span><span class="ident" id="5649118">n</span>&nbsp;<span class="builtintype" id="5649120">int</span><span class="op" id="5649123">)</span>&nbsp;<span class="op" id="5649125">*</span><span class="ident" id="5649126">Ring</span>&nbsp;<span class="op" id="5649131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649134">if</span>&nbsp;<span class="ident" id="5649137">n</span>&nbsp;<span class="op" id="5649139">&lt;=</span>&nbsp;<span class="num" id="5649142">0</span>&nbsp;<span class="op" id="5649144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649148">return</span>&nbsp;<span class="ident" id="5649155">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5649160">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649163">return</span>&nbsp;<span class="ident" id="5649170">r</span><span class="op" id="5649171">.</span><span class="ident" id="5649172">Link</span><span class="op" id="5649176">(</span><span class="ident" id="5649177">r</span><span class="op" id="5649178">.</span><span class="ident" id="5649179">Move</span><span class="op" id="5649183">(</span><span class="ident" id="5649184">n</span>&nbsp;<span class="op" id="5649186">+</span>&nbsp;<span class="num" id="5649188">1</span><span class="op" id="5649189">)</span><span class="op" id="5649190">)</span><br>
<span class="lineno"></span><span class="op" id="5649192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649195">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5649245">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="5649308">//</span><br>
<span class="lineno"></span><span class="keyword" id="5649311">func</span>&nbsp;<span class="op" id="5649316">(</span><span class="ident" id="5649317">r</span>&nbsp;<span class="op" id="5649319">*</span><span class="ident" id="5649320">Ring</span><span class="op" id="5649324">)</span>&nbsp;<span class="ident" id="5649326">Len</span><span class="op" id="5649329">(</span><span class="op" id="5649330">)</span>&nbsp;<span class="builtintype" id="5649332">int</span>&nbsp;<span class="op" id="5649336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649339">n</span>&nbsp;<span class="op" id="5649341">:=</span>&nbsp;<span class="num" id="5649344">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649347">if</span>&nbsp;<span class="ident" id="5649350">r</span>&nbsp;<span class="op" id="5649352">!=</span>&nbsp;<span class="ident" id="5649355">nil</span>&nbsp;<span class="op" id="5649359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649363">n</span>&nbsp;<span class="op" id="5649365">=</span>&nbsp;<span class="num" id="5649367">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649371">for</span>&nbsp;<span class="ident" id="5649375">p</span>&nbsp;<span class="op" id="5649377">:=</span>&nbsp;<span class="ident" id="5649380">r</span><span class="op" id="5649381">.</span><span class="ident" id="5649382">Next</span><span class="op" id="5649386">(</span><span class="op" id="5649387">)</span><span class="op" id="5649388">;</span>&nbsp;<span class="ident" id="5649390">p</span>&nbsp;<span class="op" id="5649392">!=</span>&nbsp;<span class="ident" id="5649395">r</span><span class="op" id="5649396">;</span>&nbsp;<span class="ident" id="5649398">p</span>&nbsp;<span class="op" id="5649400">=</span>&nbsp;<span class="ident" id="5649402">p</span><span class="op" id="5649403">.</span><span class="ident" id="5649404">next</span>&nbsp;<span class="op" id="5649409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649414">n</span><span class="op" id="5649415">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5649420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5649423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649426">return</span>&nbsp;<span class="ident" id="5649433">n</span><br>
<span class="lineno">130</span><span class="op" id="5649435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649438">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="5649508">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="5649560">func</span>&nbsp;<span class="op" id="5649565">(</span><span class="ident" id="5649566">r</span>&nbsp;<span class="op" id="5649568">*</span><span class="ident" id="5649569">Ring</span><span class="op" id="5649573">)</span>&nbsp;<span class="ident" id="5649575">Do</span><span class="op" id="5649577">(</span><span class="ident" id="5649578">f</span>&nbsp;<span class="keyword" id="5649580">func</span><span class="op" id="5649584">(</span><span class="keyword" id="5649585">interface</span><span class="op" id="5649594">{</span><span class="op" id="5649595">}</span><span class="op" id="5649596">)</span><span class="op" id="5649597">)</span>&nbsp;<span class="op" id="5649599">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649602">if</span>&nbsp;<span class="ident" id="5649605">r</span>&nbsp;<span class="op" id="5649607">!=</span>&nbsp;<span class="ident" id="5649610">nil</span>&nbsp;<span class="op" id="5649614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649618">f</span><span class="op" id="5649619">(</span><span class="ident" id="5649620">r</span><span class="op" id="5649621">.</span><span class="ident" id="5649622">Value</span><span class="op" id="5649627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5649631">for</span>&nbsp;<span class="ident" id="5649635">p</span>&nbsp;<span class="op" id="5649637">:=</span>&nbsp;<span class="ident" id="5649640">r</span><span class="op" id="5649641">.</span><span class="ident" id="5649642">Next</span><span class="op" id="5649646">(</span><span class="op" id="5649647">)</span><span class="op" id="5649648">;</span>&nbsp;<span class="ident" id="5649650">p</span>&nbsp;<span class="op" id="5649652">!=</span>&nbsp;<span class="ident" id="5649655">r</span><span class="op" id="5649656">;</span>&nbsp;<span class="ident" id="5649658">p</span>&nbsp;<span class="op" id="5649660">=</span>&nbsp;<span class="ident" id="5649662">p</span><span class="op" id="5649663">.</span><span class="ident" id="5649664">next</span>&nbsp;<span class="op" id="5649669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649674">f</span><span class="op" id="5649675">(</span><span class="ident" id="5649676">p</span><span class="op" id="5649677">.</span><span class="ident" id="5649678">Value</span><span class="op" id="5649683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5649687">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5649690">}</span><br>
<span class="lineno"></span><span class="op" id="5649692">}</span>
</div>
</body>
</html>
