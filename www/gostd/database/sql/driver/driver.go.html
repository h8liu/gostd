<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5842368">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5842423">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5842477">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5842528">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5842595">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5842630">//</span><br>
<span class="lineno"></span><span class="comment" id="5842633">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5842670">package</span>&nbsp;<span class="ident" id="5842678">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5842686">import</span>&nbsp;<span class="string" id="5842693">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842703">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5842760">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5842818">//</span><br>
<span class="lineno"></span><span class="comment" id="5842821">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5842832">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5842845">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5842855">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5842867">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5842919">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5842934">type</span>&nbsp;<span class="ident" id="5842939">Value</span>&nbsp;<span class="keyword" id="5842945">interface</span><span class="op" id="5842954">{</span><span class="op" id="5842955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842958">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5843024">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5843035">type</span>&nbsp;<span class="ident" id="5843040">Driver</span>&nbsp;<span class="keyword" id="5843047">interface</span>&nbsp;<span class="op" id="5843057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843060">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843111">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843165">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843169">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843225">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843283">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843346">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843350">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843413">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843423">Open</span><span class="op" id="5843427">(</span><span class="ident" id="5843428">name</span>&nbsp;<span class="builtintype" id="5843433">string</span><span class="op" id="5843439">)</span>&nbsp;<span class="op" id="5843441">(</span><span class="ident" id="5843442">Conn</span><span class="op" id="5843446">,</span>&nbsp;<span class="builtintype" id="5843448">error</span><span class="op" id="5843453">)</span><br>
<span class="lineno"></span><span class="op" id="5843455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5843458">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5843525">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5843594">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5843658">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5843717">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5843732">var</span>&nbsp;<span class="ident" id="5843736">ErrSkip</span>&nbsp;<span class="op" id="5843744">=</span>&nbsp;<span class="ident" id="5843746">errors</span><span class="op" id="5843752">.</span><span class="ident" id="5843753">New</span><span class="op" id="5843756">(</span><span class="string" id="5843757">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5843811">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5843814">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5843880">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5843948">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5844016">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5844046">//</span><br>
<span class="lineno"></span><span class="comment" id="5844049">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5844119">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5844183">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5844251">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5844287">var</span>&nbsp;<span class="ident" id="5844291">ErrBadConn</span>&nbsp;<span class="op" id="5844302">=</span>&nbsp;<span class="ident" id="5844304">errors</span><span class="op" id="5844310">.</span><span class="ident" id="5844311">New</span><span class="op" id="5844314">(</span><span class="string" id="5844315">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5844339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5844342">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5844412">//</span><br>
<span class="lineno"></span><span class="comment" id="5844415">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5844486">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5844554">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5844568">//</span><br>
<span class="lineno"></span><span class="comment" id="5844571">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5844599">type</span>&nbsp;<span class="ident" id="5844604">Execer</span>&nbsp;<span class="keyword" id="5844611">interface</span>&nbsp;<span class="op" id="5844621">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844624">Exec</span><span class="op" id="5844628">(</span><span class="ident" id="5844629">query</span>&nbsp;<span class="builtintype" id="5844635">string</span><span class="op" id="5844641">,</span>&nbsp;<span class="ident" id="5844643">args</span>&nbsp;<span class="op" id="5844648">[</span><span class="op" id="5844649">]</span><span class="ident" id="5844650">Value</span><span class="op" id="5844655">)</span>&nbsp;<span class="op" id="5844657">(</span><span class="ident" id="5844658">Result</span><span class="op" id="5844664">,</span>&nbsp;<span class="builtintype" id="5844666">error</span><span class="op" id="5844671">)</span><br>
<span class="lineno"></span><span class="op" id="5844673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5844676">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5844747">//</span><br>
<span class="lineno">70</span><span class="comment" id="5844750">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5844823">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5844891">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5844905">//</span><br>
<span class="lineno"></span><span class="comment" id="5844908">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5844937">type</span>&nbsp;<span class="ident" id="5844942">Queryer</span>&nbsp;<span class="keyword" id="5844950">interface</span>&nbsp;<span class="op" id="5844960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844963">Query</span><span class="op" id="5844968">(</span><span class="ident" id="5844969">query</span>&nbsp;<span class="builtintype" id="5844975">string</span><span class="op" id="5844981">,</span>&nbsp;<span class="ident" id="5844983">args</span>&nbsp;<span class="op" id="5844988">[</span><span class="op" id="5844989">]</span><span class="ident" id="5844990">Value</span><span class="op" id="5844995">)</span>&nbsp;<span class="op" id="5844997">(</span><span class="ident" id="5844998">Rows</span><span class="op" id="5845002">,</span>&nbsp;<span class="builtintype" id="5845004">error</span><span class="op" id="5845009">)</span><br>
<span class="lineno"></span><span class="op" id="5845011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5845014">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5845081">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5845108">//</span><br>
<span class="lineno"></span><span class="comment" id="5845111">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5845146">type</span>&nbsp;<span class="ident" id="5845151">Conn</span>&nbsp;<span class="keyword" id="5845156">interface</span>&nbsp;<span class="op" id="5845166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845169">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845237">Prepare</span><span class="op" id="5845244">(</span><span class="ident" id="5845245">query</span>&nbsp;<span class="builtintype" id="5845251">string</span><span class="op" id="5845257">)</span>&nbsp;<span class="op" id="5845259">(</span><span class="ident" id="5845260">Stmt</span><span class="op" id="5845264">,</span>&nbsp;<span class="builtintype" id="5845266">error</span><span class="op" id="5845271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845275">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845331">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845386">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845422">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845426">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845479">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845542">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845605">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845642">Close</span><span class="op" id="5845647">(</span><span class="op" id="5845648">)</span>&nbsp;<span class="builtintype" id="5845650">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845658">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845706">Begin</span><span class="op" id="5845711">(</span><span class="op" id="5845712">)</span>&nbsp;<span class="op" id="5845714">(</span><span class="ident" id="5845715">Tx</span><span class="op" id="5845717">,</span>&nbsp;<span class="builtintype" id="5845719">error</span><span class="op" id="5845724">)</span><br>
<span class="lineno"></span><span class="op" id="5845726">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5845729">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5845775">type</span>&nbsp;<span class="ident" id="5845780">Result</span>&nbsp;<span class="keyword" id="5845787">interface</span>&nbsp;<span class="op" id="5845797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845800">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845858">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845918">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845927">LastInsertId</span><span class="op" id="5845939">(</span><span class="op" id="5845940">)</span>&nbsp;<span class="op" id="5845942">(</span><span class="ident" id="5845943">int64</span><span class="op" id="5845948">,</span>&nbsp;<span class="builtintype" id="5845950">error</span><span class="op" id="5845955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845959">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846019">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846030">RowsAffected</span><span class="op" id="5846042">(</span><span class="op" id="5846043">)</span>&nbsp;<span class="op" id="5846045">(</span><span class="ident" id="5846046">int64</span><span class="op" id="5846051">,</span>&nbsp;<span class="builtintype" id="5846053">error</span><span class="op" id="5846058">)</span><br>
<span class="lineno"></span><span class="op" id="5846060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5846063">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5846126">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5846171">type</span>&nbsp;<span class="ident" id="5846176">Stmt</span>&nbsp;<span class="keyword" id="5846181">interface</span>&nbsp;<span class="op" id="5846191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846194">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846226">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846230">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846289">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846309">Close</span><span class="op" id="5846314">(</span><span class="op" id="5846315">)</span>&nbsp;<span class="builtintype" id="5846317">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846325">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846384">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846388">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846452">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846517">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846578">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846582">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846642">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846704">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846761">NumInput</span><span class="op" id="5846769">(</span><span class="op" id="5846770">)</span>&nbsp;<span class="builtintype" id="5846772">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846778">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846835">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846863">Exec</span><span class="op" id="5846867">(</span><span class="ident" id="5846868">args</span>&nbsp;<span class="op" id="5846873">[</span><span class="op" id="5846874">]</span><span class="ident" id="5846875">Value</span><span class="op" id="5846880">)</span>&nbsp;<span class="op" id="5846882">(</span><span class="ident" id="5846883">Result</span><span class="op" id="5846889">,</span>&nbsp;<span class="builtintype" id="5846891">error</span><span class="op" id="5846896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846900">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846959">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846971">Query</span><span class="op" id="5846976">(</span><span class="ident" id="5846977">args</span>&nbsp;<span class="op" id="5846982">[</span><span class="op" id="5846983">]</span><span class="ident" id="5846984">Value</span><span class="op" id="5846989">)</span>&nbsp;<span class="op" id="5846991">(</span><span class="ident" id="5846992">Rows</span><span class="op" id="5846996">,</span>&nbsp;<span class="builtintype" id="5846998">error</span><span class="op" id="5847003">)</span><br>
<span class="lineno">140</span><span class="op" id="5847005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5847008">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5847072">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5847141">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5847172">type</span>&nbsp;<span class="ident" id="5847177">ColumnConverter</span>&nbsp;<span class="keyword" id="5847193">interface</span>&nbsp;<span class="op" id="5847203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847206">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847268">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847332">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847393">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847414">ColumnConverter</span><span class="op" id="5847429">(</span><span class="ident" id="5847430">idx</span>&nbsp;<span class="builtintype" id="5847434">int</span><span class="op" id="5847437">)</span>&nbsp;<span class="ident" id="5847439">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5847454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5847457">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5847514">type</span>&nbsp;<span class="ident" id="5847519">Rows</span>&nbsp;<span class="keyword" id="5847524">interface</span>&nbsp;<span class="op" id="5847534">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847537">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847597">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847658">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847720">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847766">Columns</span><span class="op" id="5847773">(</span><span class="op" id="5847774">)</span>&nbsp;<span class="op" id="5847776">[</span><span class="op" id="5847777">]</span><span class="builtintype" id="5847778">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847787">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847823">Close</span><span class="op" id="5847828">(</span><span class="op" id="5847829">)</span>&nbsp;<span class="builtintype" id="5847831">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847839">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847896">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847956">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847992">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847996">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848042">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848089">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848140">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848144">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848203">Next</span><span class="op" id="5848207">(</span><span class="ident" id="5848208">dest</span>&nbsp;<span class="op" id="5848213">[</span><span class="op" id="5848214">]</span><span class="ident" id="5848215">Value</span><span class="op" id="5848220">)</span>&nbsp;<span class="builtintype" id="5848222">error</span><br>
<span class="lineno"></span><span class="op" id="5848228">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5848231">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5848255">type</span>&nbsp;<span class="ident" id="5848260">Tx</span>&nbsp;<span class="keyword" id="5848263">interface</span>&nbsp;<span class="op" id="5848273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848276">Commit</span><span class="op" id="5848282">(</span><span class="op" id="5848283">)</span>&nbsp;<span class="builtintype" id="5848285">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848292">Rollback</span><span class="op" id="5848300">(</span><span class="op" id="5848301">)</span>&nbsp;<span class="builtintype" id="5848303">error</span><br>
<span class="lineno">180</span><span class="op" id="5848309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848312">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5848380">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5848415">type</span>&nbsp;<span class="ident" id="5848420">RowsAffected</span>&nbsp;<span class="ident" id="5848433">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5848440">var</span>&nbsp;<span class="ident" id="5848444">_</span>&nbsp;<span class="ident" id="5848446">Result</span>&nbsp;<span class="op" id="5848453">=</span>&nbsp;<span class="ident" id="5848455">RowsAffected</span><span class="op" id="5848467">(</span><span class="num" id="5848468">0</span><span class="op" id="5848469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5848472">func</span>&nbsp;<span class="op" id="5848477">(</span><span class="ident" id="5848478">RowsAffected</span><span class="op" id="5848490">)</span>&nbsp;<span class="ident" id="5848492">LastInsertId</span><span class="op" id="5848504">(</span><span class="op" id="5848505">)</span>&nbsp;<span class="op" id="5848507">(</span><span class="ident" id="5848508">int64</span><span class="op" id="5848513">,</span>&nbsp;<span class="builtintype" id="5848515">error</span><span class="op" id="5848520">)</span>&nbsp;<span class="op" id="5848522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848525">return</span>&nbsp;<span class="num" id="5848532">0</span><span class="op" id="5848533">,</span>&nbsp;<span class="ident" id="5848535">errors</span><span class="op" id="5848541">.</span><span class="ident" id="5848542">New</span><span class="op" id="5848545">(</span><span class="string" id="5848546">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5848573">)</span><br>
<span class="lineno">190</span><span class="op" id="5848575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5848578">func</span>&nbsp;<span class="op" id="5848583">(</span><span class="ident" id="5848584">v</span>&nbsp;<span class="ident" id="5848586">RowsAffected</span><span class="op" id="5848598">)</span>&nbsp;<span class="ident" id="5848600">RowsAffected</span><span class="op" id="5848612">(</span><span class="op" id="5848613">)</span>&nbsp;<span class="op" id="5848615">(</span><span class="ident" id="5848616">int64</span><span class="op" id="5848621">,</span>&nbsp;<span class="builtintype" id="5848623">error</span><span class="op" id="5848628">)</span>&nbsp;<span class="op" id="5848630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848633">return</span>&nbsp;<span class="ident" id="5848640">int64</span><span class="op" id="5848645">(</span><span class="ident" id="5848646">v</span><span class="op" id="5848647">)</span><span class="op" id="5848648">,</span>&nbsp;<span class="ident" id="5848650">nil</span><br>
<span class="lineno"></span><span class="op" id="5848654">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5848657">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5848730">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5848805">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5848839">var</span>&nbsp;<span class="ident" id="5848843">ResultNoRows</span>&nbsp;<span class="ident" id="5848856">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5848864">type</span>&nbsp;<span class="ident" id="5848869">noRows</span>&nbsp;<span class="keyword" id="5848876">struct</span><span class="op" id="5848882">{</span><span class="op" id="5848883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5848886">var</span>&nbsp;<span class="ident" id="5848890">_</span>&nbsp;<span class="ident" id="5848892">Result</span>&nbsp;<span class="op" id="5848899">=</span>&nbsp;<span class="ident" id="5848901">noRows</span><span class="op" id="5848907">{</span><span class="op" id="5848908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5848911">func</span>&nbsp;<span class="op" id="5848916">(</span><span class="ident" id="5848917">noRows</span><span class="op" id="5848923">)</span>&nbsp;<span class="ident" id="5848925">LastInsertId</span><span class="op" id="5848937">(</span><span class="op" id="5848938">)</span>&nbsp;<span class="op" id="5848940">(</span><span class="ident" id="5848941">int64</span><span class="op" id="5848946">,</span>&nbsp;<span class="builtintype" id="5848948">error</span><span class="op" id="5848953">)</span>&nbsp;<span class="op" id="5848955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848958">return</span>&nbsp;<span class="num" id="5848965">0</span><span class="op" id="5848966">,</span>&nbsp;<span class="ident" id="5848968">errors</span><span class="op" id="5848974">.</span><span class="ident" id="5848975">New</span><span class="op" id="5848978">(</span><span class="string" id="5848979">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5849026">)</span><br>
<span class="lineno"></span><span class="op" id="5849028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5849031">func</span>&nbsp;<span class="op" id="5849036">(</span><span class="ident" id="5849037">noRows</span><span class="op" id="5849043">)</span>&nbsp;<span class="ident" id="5849045">RowsAffected</span><span class="op" id="5849057">(</span><span class="op" id="5849058">)</span>&nbsp;<span class="op" id="5849060">(</span><span class="ident" id="5849061">int64</span><span class="op" id="5849066">,</span>&nbsp;<span class="builtintype" id="5849068">error</span><span class="op" id="5849073">)</span>&nbsp;<span class="op" id="5849075">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849078">return</span>&nbsp;<span class="num" id="5849085">0</span><span class="op" id="5849086">,</span>&nbsp;<span class="ident" id="5849088">errors</span><span class="op" id="5849094">.</span><span class="ident" id="5849095">New</span><span class="op" id="5849098">(</span><span class="string" id="5849099">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5849146">)</span><br>
<span class="lineno"></span><span class="op" id="5849148">}</span>
</div>
</body>
</html>
