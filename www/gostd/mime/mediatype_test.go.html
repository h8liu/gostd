<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html" class="current">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8420487">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8420542">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8420596">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8420647">package</span>&nbsp;<span class="ident" id="8420655">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8420661">import</span>&nbsp;<span class="op" id="8420668">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8420671">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8420682">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8420692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8420695">func</span>&nbsp;<span class="ident" id="8420700">TestConsumeToken</span><span class="op" id="8420716">(</span><span class="ident" id="8420717">t</span>&nbsp;<span class="op" id="8420719">*</span><span class="ident" id="8420720">testing</span><span class="op" id="8420727">.</span><span class="ident" id="8420728">T</span><span class="op" id="8420729">)</span>&nbsp;<span class="op" id="8420731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8420734">tests</span>&nbsp;<span class="op" id="8420740">:=</span>&nbsp;<span class="op" id="8420743">[</span><span class="op" id="8420744">...</span><span class="op" id="8420747">]</span><span class="op" id="8420748">[</span><span class="num" id="8420749">3</span><span class="op" id="8420750">]</span><span class="builtintype" id="8420751">string</span><span class="op" id="8420757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8420761">{</span><span class="string" id="8420762">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8420771">,</span>&nbsp;<span class="string" id="8420773">&#34;foo&#34;</span><span class="op" id="8420778">,</span>&nbsp;<span class="string" id="8420780">&#34;&nbsp;bar&#34;</span><span class="op" id="8420786">}</span><span class="op" id="8420787">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8420791">{</span><span class="string" id="8420792">&#34;bar&#34;</span><span class="op" id="8420797">,</span>&nbsp;<span class="string" id="8420799">&#34;bar&#34;</span><span class="op" id="8420804">,</span>&nbsp;<span class="string" id="8420806">&#34;&#34;</span><span class="op" id="8420808">}</span><span class="op" id="8420809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8420813">{</span><span class="string" id="8420814">&#34;&#34;</span><span class="op" id="8420816">,</span>&nbsp;<span class="string" id="8420818">&#34;&#34;</span><span class="op" id="8420820">,</span>&nbsp;<span class="string" id="8420822">&#34;&#34;</span><span class="op" id="8420824">}</span><span class="op" id="8420825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8420829">{</span><span class="string" id="8420830">&#34;&nbsp;foo&#34;</span><span class="op" id="8420836">,</span>&nbsp;<span class="string" id="8420838">&#34;&#34;</span><span class="op" id="8420840">,</span>&nbsp;<span class="string" id="8420842">&#34;&nbsp;foo&#34;</span><span class="op" id="8420848">}</span><span class="op" id="8420849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8420852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8420855">for</span>&nbsp;<span class="ident" id="8420859">_</span><span class="op" id="8420860">,</span>&nbsp;<span class="ident" id="8420862">test</span>&nbsp;<span class="op" id="8420867">:=</span>&nbsp;<span class="keyword" id="8420870">range</span>&nbsp;<span class="ident" id="8420876">tests</span>&nbsp;<span class="op" id="8420882">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8420886">token</span><span class="op" id="8420891">,</span>&nbsp;<span class="ident" id="8420893">rest</span>&nbsp;<span class="op" id="8420898">:=</span>&nbsp;<span class="ident" id="8420901">consumeToken</span><span class="op" id="8420913">(</span><span class="ident" id="8420914">test</span><span class="op" id="8420918">[</span><span class="num" id="8420919">0</span><span class="op" id="8420920">]</span><span class="op" id="8420921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8420925">expectedToken</span>&nbsp;<span class="op" id="8420939">:=</span>&nbsp;<span class="ident" id="8420942">test</span><span class="op" id="8420946">[</span><span class="num" id="8420947">1</span><span class="op" id="8420948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8420952">expectedRest</span>&nbsp;<span class="op" id="8420965">:=</span>&nbsp;<span class="ident" id="8420968">test</span><span class="op" id="8420972">[</span><span class="num" id="8420973">2</span><span class="op" id="8420974">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8420978">if</span>&nbsp;<span class="ident" id="8420981">token</span>&nbsp;<span class="op" id="8420987">!=</span>&nbsp;<span class="ident" id="8420990">expectedToken</span>&nbsp;<span class="op" id="8421004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421009">t</span><span class="op" id="8421010">.</span><span class="ident" id="8421011">Errorf</span><span class="op" id="8421017">(</span><span class="string" id="8421018">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8421070">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421076">expectedToken</span><span class="op" id="8421089">,</span>&nbsp;<span class="ident" id="8421091">token</span><span class="op" id="8421096">,</span>&nbsp;<span class="ident" id="8421098">test</span><span class="op" id="8421102">[</span><span class="num" id="8421103">0</span><span class="op" id="8421104">]</span><span class="op" id="8421105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421109">}</span>&nbsp;<span class="keyword" id="8421111">else</span>&nbsp;<span class="keyword" id="8421116">if</span>&nbsp;<span class="ident" id="8421119">rest</span>&nbsp;<span class="op" id="8421124">!=</span>&nbsp;<span class="ident" id="8421127">expectedRest</span>&nbsp;<span class="op" id="8421140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421145">t</span><span class="op" id="8421146">.</span><span class="ident" id="8421147">Errorf</span><span class="op" id="8421153">(</span><span class="string" id="8421154">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8421227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421233">expectedRest</span><span class="op" id="8421245">,</span>&nbsp;<span class="ident" id="8421247">rest</span><span class="op" id="8421251">,</span>&nbsp;<span class="ident" id="8421253">token</span><span class="op" id="8421258">,</span>&nbsp;<span class="ident" id="8421260">test</span><span class="op" id="8421264">[</span><span class="num" id="8421265">0</span><span class="op" id="8421266">]</span><span class="op" id="8421267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421271">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421274">}</span><br>
<span class="lineno"></span><span class="op" id="8421276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8421279">func</span>&nbsp;<span class="ident" id="8421284">TestConsumeValue</span><span class="op" id="8421300">(</span><span class="ident" id="8421301">t</span>&nbsp;<span class="op" id="8421303">*</span><span class="ident" id="8421304">testing</span><span class="op" id="8421311">.</span><span class="ident" id="8421312">T</span><span class="op" id="8421313">)</span>&nbsp;<span class="op" id="8421315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421318">tests</span>&nbsp;<span class="op" id="8421324">:=</span>&nbsp;<span class="op" id="8421327">[</span><span class="op" id="8421328">...</span><span class="op" id="8421331">]</span><span class="op" id="8421332">[</span><span class="num" id="8421333">3</span><span class="op" id="8421334">]</span><span class="builtintype" id="8421335">string</span><span class="op" id="8421341">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421345">{</span><span class="string" id="8421346">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8421355">,</span>&nbsp;<span class="string" id="8421357">&#34;foo&#34;</span><span class="op" id="8421362">,</span>&nbsp;<span class="string" id="8421364">&#34;&nbsp;bar&#34;</span><span class="op" id="8421370">}</span><span class="op" id="8421371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421375">{</span><span class="string" id="8421376">&#34;bar&#34;</span><span class="op" id="8421381">,</span>&nbsp;<span class="string" id="8421383">&#34;bar&#34;</span><span class="op" id="8421388">,</span>&nbsp;<span class="string" id="8421390">&#34;&#34;</span><span class="op" id="8421392">}</span><span class="op" id="8421393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421397">{</span><span class="string" id="8421398">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8421405">,</span>&nbsp;<span class="string" id="8421407">&#34;&#34;</span><span class="op" id="8421409">,</span>&nbsp;<span class="string" id="8421411">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8421418">}</span><span class="op" id="8421419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421423">{</span><span class="string" id="8421424">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="8421439">,</span>&nbsp;<span class="string" id="8421441">&#34;My&nbsp;value&#34;</span><span class="op" id="8421451">,</span>&nbsp;<span class="string" id="8421453">&#34;end&#34;</span><span class="op" id="8421458">}</span><span class="op" id="8421459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421463">{</span><span class="string" id="8421464">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="8421480">,</span>&nbsp;<span class="string" id="8421482">&#34;My&nbsp;value&#34;</span><span class="op" id="8421492">,</span>&nbsp;<span class="string" id="8421494">&#34;&nbsp;end&#34;</span><span class="op" id="8421500">}</span><span class="op" id="8421501">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421505">{</span><span class="string" id="8421506">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="8421517">,</span>&nbsp;<span class="string" id="8421519">&#34;\\&#34;</span><span class="op" id="8421523">,</span>&nbsp;<span class="string" id="8421525">&#34;&nbsp;rest&#34;</span><span class="op" id="8421532">}</span><span class="op" id="8421533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421537">{</span><span class="string" id="8421538">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="8421556">,</span>&nbsp;<span class="string" id="8421558">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="8421571">,</span>&nbsp;<span class="string" id="8421573">&#34;end&#34;</span><span class="op" id="8421578">}</span><span class="op" id="8421579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421583">{</span><span class="string" id="8421584">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8421594">,</span>&nbsp;<span class="string" id="8421596">&#34;&#34;</span><span class="op" id="8421598">,</span>&nbsp;<span class="string" id="8421600">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8421610">}</span><span class="op" id="8421611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8421617">for</span>&nbsp;<span class="ident" id="8421621">_</span><span class="op" id="8421622">,</span>&nbsp;<span class="ident" id="8421624">test</span>&nbsp;<span class="op" id="8421629">:=</span>&nbsp;<span class="keyword" id="8421632">range</span>&nbsp;<span class="ident" id="8421638">tests</span>&nbsp;<span class="op" id="8421644">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421648">value</span><span class="op" id="8421653">,</span>&nbsp;<span class="ident" id="8421655">rest</span>&nbsp;<span class="op" id="8421660">:=</span>&nbsp;<span class="ident" id="8421663">consumeValue</span><span class="op" id="8421675">(</span><span class="ident" id="8421676">test</span><span class="op" id="8421680">[</span><span class="num" id="8421681">0</span><span class="op" id="8421682">]</span><span class="op" id="8421683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421687">expectedValue</span>&nbsp;<span class="op" id="8421701">:=</span>&nbsp;<span class="ident" id="8421704">test</span><span class="op" id="8421708">[</span><span class="num" id="8421709">1</span><span class="op" id="8421710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421714">expectedRest</span>&nbsp;<span class="op" id="8421727">:=</span>&nbsp;<span class="ident" id="8421730">test</span><span class="op" id="8421734">[</span><span class="num" id="8421735">2</span><span class="op" id="8421736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8421740">if</span>&nbsp;<span class="ident" id="8421743">value</span>&nbsp;<span class="op" id="8421749">!=</span>&nbsp;<span class="ident" id="8421752">expectedValue</span>&nbsp;<span class="op" id="8421766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421771">t</span><span class="op" id="8421772">.</span><span class="ident" id="8421773">Errorf</span><span class="op" id="8421779">(</span><span class="string" id="8421780">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8421832">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421838">expectedValue</span><span class="op" id="8421851">,</span>&nbsp;<span class="ident" id="8421853">value</span><span class="op" id="8421858">,</span>&nbsp;<span class="ident" id="8421860">test</span><span class="op" id="8421864">[</span><span class="num" id="8421865">0</span><span class="op" id="8421866">]</span><span class="op" id="8421867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8421871">}</span>&nbsp;<span class="keyword" id="8421873">else</span>&nbsp;<span class="keyword" id="8421878">if</span>&nbsp;<span class="ident" id="8421881">rest</span>&nbsp;<span class="op" id="8421886">!=</span>&nbsp;<span class="ident" id="8421889">expectedRest</span>&nbsp;<span class="op" id="8421902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421907">t</span><span class="op" id="8421908">.</span><span class="ident" id="8421909">Errorf</span><span class="op" id="8421915">(</span><span class="string" id="8421916">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8421989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8421995">expectedRest</span><span class="op" id="8422007">,</span>&nbsp;<span class="ident" id="8422009">rest</span><span class="op" id="8422013">,</span>&nbsp;<span class="ident" id="8422015">value</span><span class="op" id="8422020">,</span>&nbsp;<span class="ident" id="8422022">test</span><span class="op" id="8422026">[</span><span class="num" id="8422027">0</span><span class="op" id="8422028">]</span><span class="op" id="8422029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422033">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422036">}</span><br>
<span class="lineno"></span><span class="op" id="8422038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422041">func</span>&nbsp;<span class="ident" id="8422046">TestConsumeMediaParam</span><span class="op" id="8422067">(</span><span class="ident" id="8422068">t</span>&nbsp;<span class="op" id="8422070">*</span><span class="ident" id="8422071">testing</span><span class="op" id="8422078">.</span><span class="ident" id="8422079">T</span><span class="op" id="8422080">)</span>&nbsp;<span class="op" id="8422082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422085">tests</span>&nbsp;<span class="op" id="8422091">:=</span>&nbsp;<span class="op" id="8422094">[</span><span class="op" id="8422095">...</span><span class="op" id="8422098">]</span><span class="op" id="8422099">[</span><span class="num" id="8422100">4</span><span class="op" id="8422101">]</span><span class="builtintype" id="8422102">string</span><span class="op" id="8422108">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422112">{</span><span class="string" id="8422113">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="8422125">,</span>&nbsp;<span class="string" id="8422127">&#34;foo&#34;</span><span class="op" id="8422132">,</span>&nbsp;<span class="string" id="8422134">&#34;bar&#34;</span><span class="op" id="8422139">,</span>&nbsp;<span class="string" id="8422141">&#34;&#34;</span><span class="op" id="8422143">}</span><span class="op" id="8422144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422148">{</span><span class="string" id="8422149">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="8422160">,</span>&nbsp;<span class="string" id="8422162">&#34;foo&#34;</span><span class="op" id="8422167">,</span>&nbsp;<span class="string" id="8422169">&#34;bar&#34;</span><span class="op" id="8422174">,</span>&nbsp;<span class="string" id="8422176">&#34;&#34;</span><span class="op" id="8422178">}</span><span class="op" id="8422179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422183">{</span><span class="string" id="8422184">&#34;;foo=bar&#34;</span><span class="op" id="8422194">,</span>&nbsp;<span class="string" id="8422196">&#34;foo&#34;</span><span class="op" id="8422201">,</span>&nbsp;<span class="string" id="8422203">&#34;bar&#34;</span><span class="op" id="8422208">,</span>&nbsp;<span class="string" id="8422210">&#34;&#34;</span><span class="op" id="8422212">}</span><span class="op" id="8422213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422217">{</span><span class="string" id="8422218">&#34;;FOO=bar&#34;</span><span class="op" id="8422228">,</span>&nbsp;<span class="string" id="8422230">&#34;foo&#34;</span><span class="op" id="8422235">,</span>&nbsp;<span class="string" id="8422237">&#34;bar&#34;</span><span class="op" id="8422242">,</span>&nbsp;<span class="string" id="8422244">&#34;&#34;</span><span class="op" id="8422246">}</span><span class="op" id="8422247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422251">{</span><span class="string" id="8422252">`;foo=&#34;bar&#34;`</span><span class="op" id="8422264">,</span>&nbsp;<span class="string" id="8422266">&#34;foo&#34;</span><span class="op" id="8422271">,</span>&nbsp;<span class="string" id="8422273">&#34;bar&#34;</span><span class="op" id="8422278">,</span>&nbsp;<span class="string" id="8422280">&#34;&#34;</span><span class="op" id="8422282">}</span><span class="op" id="8422283">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422287">{</span><span class="string" id="8422288">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="8422302">,</span>&nbsp;<span class="string" id="8422304">&#34;foo&#34;</span><span class="op" id="8422309">,</span>&nbsp;<span class="string" id="8422311">&#34;bar&#34;</span><span class="op" id="8422316">,</span>&nbsp;<span class="string" id="8422318">&#34;;&nbsp;&#34;</span><span class="op" id="8422322">}</span><span class="op" id="8422323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422327">{</span><span class="string" id="8422328">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="8422349">,</span>&nbsp;<span class="string" id="8422351">&#34;foo&#34;</span><span class="op" id="8422356">,</span>&nbsp;<span class="string" id="8422358">&#34;bar&#34;</span><span class="op" id="8422363">,</span>&nbsp;<span class="string" id="8422365">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="8422376">}</span><span class="op" id="8422377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422381">{</span><span class="string" id="8422382">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="8422404">,</span>&nbsp;<span class="string" id="8422406">&#34;boundary&#34;</span><span class="op" id="8422416">,</span>&nbsp;<span class="string" id="8422418">&#34;----CUT&#34;</span><span class="op" id="8422427">,</span>&nbsp;<span class="string" id="8422429">&#34;;&#34;</span><span class="op" id="8422432">}</span><span class="op" id="8422433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422437">{</span><span class="string" id="8422438">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8422479">,</span>&nbsp;<span class="string" id="8422481">&#34;key&#34;</span><span class="op" id="8422486">,</span>&nbsp;<span class="string" id="8422488">&#34;value&#34;</span><span class="op" id="8422495">,</span>&nbsp;<span class="string" id="8422497">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8422526">}</span><span class="op" id="8422527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422531">{</span><span class="string" id="8422532">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8422561">,</span>&nbsp;<span class="string" id="8422563">&#34;blah&#34;</span><span class="op" id="8422569">,</span>&nbsp;<span class="string" id="8422571">&#34;value&#34;</span><span class="op" id="8422578">,</span>&nbsp;<span class="string" id="8422580">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8422594">}</span><span class="op" id="8422595">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422599">{</span><span class="string" id="8422600">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8422614">,</span>&nbsp;<span class="string" id="8422616">&#34;name&#34;</span><span class="op" id="8422622">,</span>&nbsp;<span class="string" id="8422624">&#34;foo&#34;</span><span class="op" id="8422629">,</span>&nbsp;<span class="string" id="8422631">`&nbsp;`</span><span class="op" id="8422634">}</span><span class="op" id="8422635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8422641">for</span>&nbsp;<span class="ident" id="8422645">_</span><span class="op" id="8422646">,</span>&nbsp;<span class="ident" id="8422648">test</span>&nbsp;<span class="op" id="8422653">:=</span>&nbsp;<span class="keyword" id="8422656">range</span>&nbsp;<span class="ident" id="8422662">tests</span>&nbsp;<span class="op" id="8422668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422672">param</span><span class="op" id="8422677">,</span>&nbsp;<span class="ident" id="8422679">value</span><span class="op" id="8422684">,</span>&nbsp;<span class="ident" id="8422686">rest</span>&nbsp;<span class="op" id="8422691">:=</span>&nbsp;<span class="ident" id="8422694">consumeMediaParam</span><span class="op" id="8422711">(</span><span class="ident" id="8422712">test</span><span class="op" id="8422716">[</span><span class="num" id="8422717">0</span><span class="op" id="8422718">]</span><span class="op" id="8422719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422723">expectedParam</span>&nbsp;<span class="op" id="8422737">:=</span>&nbsp;<span class="ident" id="8422740">test</span><span class="op" id="8422744">[</span><span class="num" id="8422745">1</span><span class="op" id="8422746">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422750">expectedValue</span>&nbsp;<span class="op" id="8422764">:=</span>&nbsp;<span class="ident" id="8422767">test</span><span class="op" id="8422771">[</span><span class="num" id="8422772">2</span><span class="op" id="8422773">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422777">expectedRest</span>&nbsp;<span class="op" id="8422790">:=</span>&nbsp;<span class="ident" id="8422793">test</span><span class="op" id="8422797">[</span><span class="num" id="8422798">3</span><span class="op" id="8422799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8422803">if</span>&nbsp;<span class="ident" id="8422806">param</span>&nbsp;<span class="op" id="8422812">!=</span>&nbsp;<span class="ident" id="8422815">expectedParam</span>&nbsp;<span class="op" id="8422829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422834">t</span><span class="op" id="8422835">.</span><span class="ident" id="8422836">Errorf</span><span class="op" id="8422842">(</span><span class="string" id="8422843">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8422895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422901">expectedParam</span><span class="op" id="8422914">,</span>&nbsp;<span class="ident" id="8422916">param</span><span class="op" id="8422921">,</span>&nbsp;<span class="ident" id="8422923">test</span><span class="op" id="8422927">[</span><span class="num" id="8422928">0</span><span class="op" id="8422929">]</span><span class="op" id="8422930">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8422934">}</span>&nbsp;<span class="keyword" id="8422936">else</span>&nbsp;<span class="keyword" id="8422941">if</span>&nbsp;<span class="ident" id="8422944">value</span>&nbsp;<span class="op" id="8422950">!=</span>&nbsp;<span class="ident" id="8422953">expectedValue</span>&nbsp;<span class="op" id="8422967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8422972">t</span><span class="op" id="8422973">.</span><span class="ident" id="8422974">Errorf</span><span class="op" id="8422980">(</span><span class="string" id="8422981">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8423033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423039">expectedValue</span><span class="op" id="8423052">,</span>&nbsp;<span class="ident" id="8423054">value</span><span class="op" id="8423059">,</span>&nbsp;<span class="ident" id="8423061">test</span><span class="op" id="8423065">[</span><span class="num" id="8423066">0</span><span class="op" id="8423067">]</span><span class="op" id="8423068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423072">}</span>&nbsp;<span class="keyword" id="8423074">else</span>&nbsp;<span class="keyword" id="8423079">if</span>&nbsp;<span class="ident" id="8423082">rest</span>&nbsp;<span class="op" id="8423087">!=</span>&nbsp;<span class="ident" id="8423090">expectedRest</span>&nbsp;<span class="op" id="8423103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423108">t</span><span class="op" id="8423109">.</span><span class="ident" id="8423110">Errorf</span><span class="op" id="8423116">(</span><span class="string" id="8423117">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8423187">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423193">expectedRest</span><span class="op" id="8423205">,</span>&nbsp;<span class="ident" id="8423207">rest</span><span class="op" id="8423211">,</span>&nbsp;<span class="ident" id="8423213">param</span><span class="op" id="8423218">,</span>&nbsp;<span class="ident" id="8423220">value</span><span class="op" id="8423225">,</span>&nbsp;<span class="ident" id="8423227">test</span><span class="op" id="8423231">[</span><span class="num" id="8423232">0</span><span class="op" id="8423233">]</span><span class="op" id="8423234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423241">}</span><br>
<span class="lineno"></span><span class="op" id="8423243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8423246">type</span>&nbsp;<span class="ident" id="8423251">mediaTypeTest</span>&nbsp;<span class="keyword" id="8423265">struct</span>&nbsp;<span class="op" id="8423272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423275">in</span>&nbsp;<span class="builtintype" id="8423278">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423286">t</span>&nbsp;&nbsp;<span class="builtintype" id="8423289">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423297">p</span>&nbsp;&nbsp;<span class="keyword" id="8423300">map</span><span class="op" id="8423303">[</span><span class="builtintype" id="8423304">string</span><span class="op" id="8423310">]</span><span class="builtintype" id="8423311">string</span><br>
<span class="lineno"></span><span class="op" id="8423318">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="8423321">func</span>&nbsp;<span class="ident" id="8423326">TestParseMediaType</span><span class="op" id="8423344">(</span><span class="ident" id="8423345">t</span>&nbsp;<span class="op" id="8423347">*</span><span class="ident" id="8423348">testing</span><span class="op" id="8423355">.</span><span class="ident" id="8423356">T</span><span class="op" id="8423357">)</span>&nbsp;<span class="op" id="8423359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8423362">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423394">m</span>&nbsp;<span class="op" id="8423396">:=</span>&nbsp;<span class="keyword" id="8423399">func</span><span class="op" id="8423403">(</span><span class="ident" id="8423404">s</span>&nbsp;<span class="op" id="8423406">...</span><span class="builtintype" id="8423409">string</span><span class="op" id="8423415">)</span>&nbsp;<span class="keyword" id="8423417">map</span><span class="op" id="8423420">[</span><span class="builtintype" id="8423421">string</span><span class="op" id="8423427">]</span><span class="builtintype" id="8423428">string</span>&nbsp;<span class="op" id="8423435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423439">sm</span>&nbsp;<span class="op" id="8423442">:=</span>&nbsp;<span class="builtinfunc" id="8423445">make</span><span class="op" id="8423449">(</span><span class="keyword" id="8423450">map</span><span class="op" id="8423453">[</span><span class="builtintype" id="8423454">string</span><span class="op" id="8423460">]</span><span class="builtintype" id="8423461">string</span><span class="op" id="8423467">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8423471">for</span>&nbsp;<span class="ident" id="8423475">i</span>&nbsp;<span class="op" id="8423477">:=</span>&nbsp;<span class="num" id="8423480">0</span><span class="op" id="8423481">;</span>&nbsp;<span class="ident" id="8423483">i</span>&nbsp;<span class="op" id="8423485">&lt;</span>&nbsp;<span class="builtinfunc" id="8423487">len</span><span class="op" id="8423490">(</span><span class="ident" id="8423491">s</span><span class="op" id="8423492">)</span><span class="op" id="8423493">;</span>&nbsp;<span class="ident" id="8423495">i</span>&nbsp;<span class="op" id="8423497">+=</span>&nbsp;<span class="num" id="8423500">2</span>&nbsp;<span class="op" id="8423502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423507">sm</span><span class="op" id="8423509">[</span><span class="ident" id="8423510">s</span><span class="op" id="8423511">[</span><span class="ident" id="8423512">i</span><span class="op" id="8423513">]</span><span class="op" id="8423514">]</span>&nbsp;<span class="op" id="8423516">=</span>&nbsp;<span class="ident" id="8423518">s</span><span class="op" id="8423519">[</span><span class="ident" id="8423520">i</span><span class="op" id="8423521">+</span><span class="num" id="8423522">1</span><span class="op" id="8423523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8423531">return</span>&nbsp;<span class="ident" id="8423538">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423542">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423546">nameFoo</span>&nbsp;<span class="op" id="8423554">:=</span>&nbsp;<span class="keyword" id="8423557">map</span><span class="op" id="8423560">[</span><span class="builtintype" id="8423561">string</span><span class="op" id="8423567">]</span><span class="builtintype" id="8423568">string</span><span class="op" id="8423574">{</span><span class="string" id="8423575">&#34;name&#34;</span><span class="op" id="8423581">:</span>&nbsp;<span class="string" id="8423583">&#34;foo&#34;</span><span class="op" id="8423588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423591">tests</span>&nbsp;<span class="op" id="8423597">:=</span>&nbsp;<span class="op" id="8423600">[</span><span class="op" id="8423601">]</span><span class="ident" id="8423602">mediaTypeTest</span><span class="op" id="8423615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423619">{</span><span class="string" id="8423620">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8423643">,</span>&nbsp;<span class="string" id="8423645">&#34;form-data&#34;</span><span class="op" id="8423656">,</span>&nbsp;<span class="ident" id="8423658">nameFoo</span><span class="op" id="8423665">}</span><span class="op" id="8423666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423670">{</span><span class="string" id="8423671">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="8423694">,</span>&nbsp;<span class="string" id="8423696">&#34;form-data&#34;</span><span class="op" id="8423707">,</span>&nbsp;<span class="ident" id="8423709">nameFoo</span><span class="op" id="8423716">}</span><span class="op" id="8423717">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423721">{</span><span class="string" id="8423722">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="8423744">,</span>&nbsp;<span class="string" id="8423746">&#34;form-data&#34;</span><span class="op" id="8423757">,</span>&nbsp;<span class="ident" id="8423759">nameFoo</span><span class="op" id="8423766">}</span><span class="op" id="8423767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423771">{</span><span class="string" id="8423772">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8423797">,</span>&nbsp;<span class="string" id="8423799">&#34;form-data&#34;</span><span class="op" id="8423810">,</span>&nbsp;<span class="ident" id="8423812">nameFoo</span><span class="op" id="8423819">}</span><span class="op" id="8423820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423824">{</span><span class="string" id="8423825">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8423850">,</span>&nbsp;<span class="string" id="8423852">&#34;form-data&#34;</span><span class="op" id="8423863">,</span>&nbsp;<span class="ident" id="8423865">nameFoo</span><span class="op" id="8423872">}</span><span class="op" id="8423873">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8423878">{</span><span class="string" id="8423879">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8423928">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8423933">&#34;form-data&#34;</span><span class="op" id="8423944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8423949">m</span><span class="op" id="8423950">(</span><span class="string" id="8423951">&#34;key&#34;</span><span class="op" id="8423956">,</span>&nbsp;<span class="string" id="8423958">&#34;value&#34;</span><span class="op" id="8423965">,</span>&nbsp;<span class="string" id="8423967">&#34;blah&#34;</span><span class="op" id="8423973">,</span>&nbsp;<span class="string" id="8423975">&#34;value&#34;</span><span class="op" id="8423982">,</span>&nbsp;<span class="string" id="8423984">&#34;name&#34;</span><span class="op" id="8423990">,</span>&nbsp;<span class="string" id="8423992">&#34;foo&#34;</span><span class="op" id="8423997">)</span><span class="op" id="8423998">}</span><span class="op" id="8423999">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424004">{</span><span class="string" id="8424005">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="8424062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424067">&#34;&#34;</span><span class="op" id="8424069">,</span>&nbsp;<span class="ident" id="8424071">m</span><span class="op" id="8424072">(</span><span class="op" id="8424073">)</span><span class="op" id="8424074">}</span><span class="op" id="8424075">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8424080">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424100">{</span><span class="string" id="8424101">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="8424179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424184">&#34;application/x-stuff&#34;</span><span class="op" id="8424205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8424210">m</span><span class="op" id="8424211">(</span><span class="string" id="8424212">&#34;title&#34;</span><span class="op" id="8424219">,</span>&nbsp;<span class="string" id="8424221">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="8424240">)</span><span class="op" id="8424241">}</span><span class="op" id="8424242">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424247">{</span><span class="string" id="8424248">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="8424291">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424296">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="8424314">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424319">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="8424377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424382">&#34;message/external-body&#34;</span><span class="op" id="8424405">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8424410">m</span><span class="op" id="8424411">(</span><span class="string" id="8424412">&#34;access-type&#34;</span><span class="op" id="8424425">,</span>&nbsp;<span class="string" id="8424427">&#34;URL&#34;</span><span class="op" id="8424432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424438">&#34;url&#34;</span><span class="op" id="8424443">,</span>&nbsp;<span class="string" id="8424445">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="8424501">)</span><span class="op" id="8424502">}</span><span class="op" id="8424503">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424508">{</span><span class="string" id="8424509">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="8424533">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424538">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="8424590">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424595">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="8424633">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424638">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="8424659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424664">&#34;application/x-stuff&#34;</span><span class="op" id="8424685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8424690">m</span><span class="op" id="8424691">(</span><span class="string" id="8424692">&#34;title&#34;</span><span class="op" id="8424699">,</span>&nbsp;<span class="string" id="8424701">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="8424740">)</span><span class="op" id="8424741">}</span><span class="op" id="8424742">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8424747">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8424797">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424860">{</span><span class="string" id="8424861">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="8424895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8424900">&#34;attachment&#34;</span><span class="op" id="8424912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8424917">m</span><span class="op" id="8424918">(</span><span class="string" id="8424919">&#34;filename&#34;</span><span class="op" id="8424929">,</span>&nbsp;<span class="string" id="8424931">&#34;foo.html&#34;</span><span class="op" id="8424941">)</span><span class="op" id="8424942">}</span><span class="op" id="8424943">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8424947">{</span><span class="string" id="8424948">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="8424996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425001">&#34;attachment&#34;</span><span class="op" id="8425013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425018">m</span><span class="op" id="8425019">(</span><span class="string" id="8425020">&#34;filename&#34;</span><span class="op" id="8425030">,</span>&nbsp;<span class="string" id="8425032">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="8425055">)</span><span class="op" id="8425056">}</span><span class="op" id="8425057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425061">{</span><span class="string" id="8425062">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="8425111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425116">&#34;attachment&#34;</span><span class="op" id="8425128">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425133">m</span><span class="op" id="8425134">(</span><span class="string" id="8425135">&#34;filename&#34;</span><span class="op" id="8425145">,</span>&nbsp;<span class="string" id="8425147">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="8425173">)</span><span class="op" id="8425174">}</span><span class="op" id="8425175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425179">{</span><span class="string" id="8425180">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="8425224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425229">&#34;attachment&#34;</span><span class="op" id="8425241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425246">m</span><span class="op" id="8425247">(</span><span class="string" id="8425248">&#34;foo&#34;</span><span class="op" id="8425253">,</span>&nbsp;<span class="string" id="8425255">&#34;\&#34;\\&#34;</span><span class="op" id="8425261">,</span>&nbsp;<span class="string" id="8425263">&#34;filename&#34;</span><span class="op" id="8425273">,</span>&nbsp;<span class="string" id="8425275">&#34;foo.html&#34;</span><span class="op" id="8425285">)</span><span class="op" id="8425286">}</span><span class="op" id="8425287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425291">{</span><span class="string" id="8425292">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="8425323">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425328">&#34;attachment&#34;</span><span class="op" id="8425340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425345">m</span><span class="op" id="8425346">(</span><span class="string" id="8425347">&#34;filename&#34;</span><span class="op" id="8425357">,</span>&nbsp;<span class="string" id="8425359">&#34;foo.html&#34;</span><span class="op" id="8425369">)</span><span class="op" id="8425370">}</span><span class="op" id="8425371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425375">{</span><span class="string" id="8425376">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="8425409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425414">&#34;attachment&#34;</span><span class="op" id="8425426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425431">m</span><span class="op" id="8425432">(</span><span class="string" id="8425433">&#34;filename&#34;</span><span class="op" id="8425443">,</span>&nbsp;<span class="string" id="8425445">&#34;foo.html&#34;</span><span class="op" id="8425455">)</span><span class="op" id="8425456">}</span><span class="op" id="8425457">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425461">{</span><span class="string" id="8425462">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="8425495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425500">&#34;attachment&#34;</span><span class="op" id="8425512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425517">m</span><span class="op" id="8425518">(</span><span class="string" id="8425519">&#34;filename&#34;</span><span class="op" id="8425529">,</span>&nbsp;<span class="string" id="8425531">&#34;foo.html&#34;</span><span class="op" id="8425541">)</span><span class="op" id="8425542">}</span><span class="op" id="8425543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425547">{</span><span class="string" id="8425548">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="8425585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425590">&#34;attachment&#34;</span><span class="op" id="8425602">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425607">m</span><span class="op" id="8425608">(</span><span class="string" id="8425609">&#34;filename&#34;</span><span class="op" id="8425619">,</span>&nbsp;<span class="string" id="8425621">&#34;foo-%41.html&#34;</span><span class="op" id="8425635">)</span><span class="op" id="8425636">}</span><span class="op" id="8425637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425641">{</span><span class="string" id="8425642">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="8425680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425685">&#34;attachment&#34;</span><span class="op" id="8425697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8425702">m</span><span class="op" id="8425703">(</span><span class="string" id="8425704">&#34;filename&#34;</span><span class="op" id="8425714">,</span>&nbsp;<span class="string" id="8425716">&#34;foo-%41.html&#34;</span><span class="op" id="8425730">)</span><span class="op" id="8425731">}</span><span class="op" id="8425732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425736">{</span><span class="string" id="8425737">`filename=foo.html`</span><span class="op" id="8425756">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425761">&#34;&#34;</span><span class="op" id="8425763">,</span>&nbsp;<span class="ident" id="8425765">m</span><span class="op" id="8425766">(</span><span class="op" id="8425767">)</span><span class="op" id="8425768">}</span><span class="op" id="8425769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425773">{</span><span class="string" id="8425774">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="8425798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425803">&#34;&#34;</span><span class="op" id="8425805">,</span>&nbsp;<span class="ident" id="8425807">m</span><span class="op" id="8425808">(</span><span class="op" id="8425809">)</span><span class="op" id="8425810">}</span><span class="op" id="8425811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425815">{</span><span class="string" id="8425816">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="8425855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425860">&#34;&#34;</span><span class="op" id="8425862">,</span>&nbsp;<span class="ident" id="8425864">m</span><span class="op" id="8425865">(</span><span class="op" id="8425866">)</span><span class="op" id="8425867">}</span><span class="op" id="8425868">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425872">{</span><span class="string" id="8425873">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="8425912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425917">&#34;&#34;</span><span class="op" id="8425919">,</span>&nbsp;<span class="ident" id="8425921">m</span><span class="op" id="8425922">(</span><span class="op" id="8425923">)</span><span class="op" id="8425924">}</span><span class="op" id="8425925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425929">{</span><span class="string" id="8425930">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="8425967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8425972">&#34;&#34;</span><span class="op" id="8425974">,</span>&nbsp;<span class="ident" id="8425976">m</span><span class="op" id="8425977">(</span><span class="op" id="8425978">)</span><span class="op" id="8425979">}</span><span class="op" id="8425980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8425984">{</span><span class="string" id="8425985">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="8426012">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426017">&#34;&#34;</span><span class="op" id="8426019">,</span>&nbsp;<span class="ident" id="8426021">m</span><span class="op" id="8426022">(</span><span class="op" id="8426023">)</span><span class="op" id="8426024">}</span><span class="op" id="8426025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426029">{</span><span class="string" id="8426030">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="8426091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426096">&#34;attachment&#34;</span><span class="op" id="8426108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426113">m</span><span class="op" id="8426114">(</span><span class="string" id="8426115">&#34;creation-date&#34;</span><span class="op" id="8426130">,</span>&nbsp;<span class="string" id="8426132">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="8426165">)</span><span class="op" id="8426166">}</span><span class="op" id="8426167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426171">{</span><span class="string" id="8426172">`foobar`</span><span class="op" id="8426180">,</span>&nbsp;<span class="string" id="8426182">&#34;foobar&#34;</span><span class="op" id="8426190">,</span>&nbsp;<span class="ident" id="8426192">m</span><span class="op" id="8426193">(</span><span class="op" id="8426194">)</span><span class="op" id="8426195">}</span><span class="op" id="8426196">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426200">{</span><span class="string" id="8426201">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8426248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426253">&#34;attachment&#34;</span><span class="op" id="8426265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426270">m</span><span class="op" id="8426271">(</span><span class="string" id="8426272">&#34;filename&#34;</span><span class="op" id="8426282">,</span>&nbsp;<span class="string" id="8426284">&#34;foo-.html&#34;</span><span class="op" id="8426297">)</span><span class="op" id="8426298">}</span><span class="op" id="8426299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426303">{</span><span class="string" id="8426304">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="8426347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426352">&#34;attachment&#34;</span><span class="op" id="8426364">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426369">m</span><span class="op" id="8426370">(</span><span class="string" id="8426371">&#34;filename&#34;</span><span class="op" id="8426381">,</span>&nbsp;<span class="string" id="8426383">&#34;A-%41.html&#34;</span><span class="op" id="8426395">)</span><span class="op" id="8426396">}</span><span class="op" id="8426397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426401">{</span><span class="string" id="8426402">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="8426452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426457">&#34;attachment&#34;</span><span class="op" id="8426469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426474">m</span><span class="op" id="8426475">(</span><span class="string" id="8426476">&#34;filename&#34;</span><span class="op" id="8426486">,</span>&nbsp;<span class="string" id="8426488">&#34;foo.html&#34;</span><span class="op" id="8426498">)</span><span class="op" id="8426499">}</span><span class="op" id="8426500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426504">{</span><span class="string" id="8426505">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="8426568">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426573">&#34;attachment&#34;</span><span class="op" id="8426585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426590">m</span><span class="op" id="8426591">(</span><span class="string" id="8426592">&#34;filename&#34;</span><span class="op" id="8426602">,</span>&nbsp;<span class="string" id="8426604">&#34;foo-.html&#34;</span><span class="op" id="8426617">)</span><span class="op" id="8426618">}</span><span class="op" id="8426619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426623">{</span><span class="string" id="8426624">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="8426673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426678">&#34;attachment&#34;</span><span class="op" id="8426690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426695">m</span><span class="op" id="8426696">(</span><span class="string" id="8426697">&#34;filename&#34;</span><span class="op" id="8426707">,</span>&nbsp;<span class="string" id="8426709">&#34;foo&#34;</span><span class="op" id="8426714">)</span><span class="op" id="8426715">}</span><span class="op" id="8426716">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426720">{</span><span class="string" id="8426721">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8426769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426774">&#34;attachment&#34;</span><span class="op" id="8426786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426791">m</span><span class="op" id="8426792">(</span><span class="string" id="8426793">&#34;filename&#34;</span><span class="op" id="8426803">,</span>&nbsp;<span class="string" id="8426805">&#34;foo&#34;</span><span class="op" id="8426810">)</span><span class="op" id="8426811">}</span><span class="op" id="8426812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426816">{</span><span class="string" id="8426817">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8426865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426870">&#34;attachment&#34;</span><span class="op" id="8426882">,</span>&nbsp;<span class="ident" id="8426884">m</span><span class="op" id="8426885">(</span><span class="op" id="8426886">)</span><span class="op" id="8426887">}</span><span class="op" id="8426888">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426892">{</span><span class="string" id="8426893">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="8426941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8426946">&#34;attachment&#34;</span><span class="op" id="8426958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8426963">m</span><span class="op" id="8426964">(</span><span class="string" id="8426965">&#34;filename&#34;</span><span class="op" id="8426975">,</span>&nbsp;<span class="string" id="8426977">&#34;foobar&#34;</span><span class="op" id="8426985">)</span><span class="op" id="8426986">}</span><span class="op" id="8426987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8426991">{</span><span class="string" id="8426992">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8427062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8427067">&#34;attachment&#34;</span><span class="op" id="8427079">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427084">m</span><span class="op" id="8427085">(</span><span class="string" id="8427086">&#34;filename&#34;</span><span class="op" id="8427096">,</span>&nbsp;<span class="string" id="8427098">&#34;foo-.html&#34;</span><span class="op" id="8427111">)</span><span class="op" id="8427112">}</span><span class="op" id="8427113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427117">{</span><span class="string" id="8427118">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="8427188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8427193">&#34;attachment&#34;</span><span class="op" id="8427205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427210">m</span><span class="op" id="8427211">(</span><span class="string" id="8427212">&#34;filename&#34;</span><span class="op" id="8427222">,</span>&nbsp;<span class="string" id="8427224">&#34;foo-.html&#34;</span><span class="op" id="8427237">)</span><span class="op" id="8427238">}</span><span class="op" id="8427239">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8427244">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8427306">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427363">{</span><span class="string" id="8427364">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="8427428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8427433">&#34;form-data&#34;</span><span class="op" id="8427444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427449">m</span><span class="op" id="8427450">(</span><span class="string" id="8427451">&#34;firstname&#34;</span><span class="op" id="8427462">,</span>&nbsp;<span class="string" id="8427464">&#34;&#34;</span><span class="op" id="8427474">,</span>&nbsp;<span class="string" id="8427476">&#34;lastname&#34;</span><span class="op" id="8427486">,</span>&nbsp;<span class="string" id="8427488">&#34;&#34;</span><span class="op" id="8427508">)</span><span class="op" id="8427509">}</span><span class="op" id="8427510">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427516">for</span>&nbsp;<span class="ident" id="8427520">_</span><span class="op" id="8427521">,</span>&nbsp;<span class="ident" id="8427523">test</span>&nbsp;<span class="op" id="8427528">:=</span>&nbsp;<span class="keyword" id="8427531">range</span>&nbsp;<span class="ident" id="8427537">tests</span>&nbsp;<span class="op" id="8427543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427547">mt</span><span class="op" id="8427549">,</span>&nbsp;<span class="ident" id="8427551">params</span><span class="op" id="8427557">,</span>&nbsp;<span class="ident" id="8427559">err</span>&nbsp;<span class="op" id="8427563">:=</span>&nbsp;<span class="ident" id="8427566">ParseMediaType</span><span class="op" id="8427580">(</span><span class="ident" id="8427581">test</span><span class="op" id="8427585">.</span><span class="ident" id="8427586">in</span><span class="op" id="8427588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427592">if</span>&nbsp;<span class="ident" id="8427595">err</span>&nbsp;<span class="op" id="8427599">!=</span>&nbsp;<span class="builtintype" id="8427602">nil</span>&nbsp;<span class="op" id="8427606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427611">if</span>&nbsp;<span class="ident" id="8427614">test</span><span class="op" id="8427618">.</span><span class="ident" id="8427619">t</span>&nbsp;<span class="op" id="8427621">!=</span>&nbsp;<span class="string" id="8427624">&#34;&#34;</span>&nbsp;<span class="op" id="8427627">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427633">t</span><span class="op" id="8427634">.</span><span class="ident" id="8427635">Errorf</span><span class="op" id="8427641">(</span><span class="string" id="8427642">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8427678">,</span>&nbsp;<span class="ident" id="8427680">test</span><span class="op" id="8427684">.</span><span class="ident" id="8427685">in</span><span class="op" id="8427687">,</span>&nbsp;<span class="ident" id="8427689">err</span><span class="op" id="8427692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427698">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427715">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427726">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427730">if</span>&nbsp;<span class="ident" id="8427733">g</span><span class="op" id="8427734">,</span>&nbsp;<span class="ident" id="8427736">e</span>&nbsp;<span class="op" id="8427738">:=</span>&nbsp;<span class="ident" id="8427741">mt</span><span class="op" id="8427743">,</span>&nbsp;<span class="ident" id="8427745">test</span><span class="op" id="8427749">.</span><span class="ident" id="8427750">t</span><span class="op" id="8427751">;</span>&nbsp;<span class="ident" id="8427753">g</span>&nbsp;<span class="op" id="8427755">!=</span>&nbsp;<span class="ident" id="8427758">e</span>&nbsp;<span class="op" id="8427760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427765">t</span><span class="op" id="8427766">.</span><span class="ident" id="8427767">Errorf</span><span class="op" id="8427773">(</span><span class="string" id="8427774">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8427814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427820">test</span><span class="op" id="8427824">.</span><span class="ident" id="8427825">in</span><span class="op" id="8427827">,</span>&nbsp;<span class="ident" id="8427829">e</span><span class="op" id="8427830">,</span>&nbsp;<span class="ident" id="8427832">g</span><span class="op" id="8427833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427838">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427849">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427853">if</span>&nbsp;<span class="builtinfunc" id="8427856">len</span><span class="op" id="8427859">(</span><span class="ident" id="8427860">params</span><span class="op" id="8427866">)</span>&nbsp;<span class="op" id="8427868">==</span>&nbsp;<span class="num" id="8427871">0</span>&nbsp;<span class="op" id="8427873">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8427876">len</span><span class="op" id="8427879">(</span><span class="ident" id="8427880">test</span><span class="op" id="8427884">.</span><span class="ident" id="8427885">p</span><span class="op" id="8427886">)</span>&nbsp;<span class="op" id="8427888">==</span>&nbsp;<span class="num" id="8427891">0</span>&nbsp;<span class="op" id="8427893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427898">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8427909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8427913">if</span>&nbsp;<span class="op" id="8427916">!</span><span class="ident" id="8427917">reflect</span><span class="op" id="8427924">.</span><span class="ident" id="8427925">DeepEqual</span><span class="op" id="8427934">(</span><span class="ident" id="8427935">params</span><span class="op" id="8427941">,</span>&nbsp;<span class="ident" id="8427943">test</span><span class="op" id="8427947">.</span><span class="ident" id="8427948">p</span><span class="op" id="8427949">)</span>&nbsp;<span class="op" id="8427951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8427956">t</span><span class="op" id="8427957">.</span><span class="ident" id="8427958">Errorf</span><span class="op" id="8427964">(</span><span class="string" id="8427965">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="8427996">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8428002">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="8428019">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8428025">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="8428040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428046">test</span><span class="op" id="8428050">.</span><span class="ident" id="8428051">in</span><span class="op" id="8428053">,</span>&nbsp;<span class="ident" id="8428055">test</span><span class="op" id="8428059">.</span><span class="ident" id="8428060">p</span><span class="op" id="8428061">,</span>&nbsp;<span class="ident" id="8428063">params</span><span class="op" id="8428069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428076">}</span><br>
<span class="lineno">245</span><span class="op" id="8428078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8428081">type</span>&nbsp;<span class="ident" id="8428086">badMediaTypeTest</span>&nbsp;<span class="keyword" id="8428103">struct</span>&nbsp;<span class="op" id="8428110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428113">in</span>&nbsp;&nbsp;<span class="builtintype" id="8428117">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428125">err</span>&nbsp;<span class="builtintype" id="8428129">string</span><br>
<span class="lineno">250</span><span class="op" id="8428136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8428139">var</span>&nbsp;<span class="ident" id="8428143">badMediaTypeTests</span>&nbsp;<span class="op" id="8428161">=</span>&nbsp;<span class="op" id="8428163">[</span><span class="op" id="8428164">]</span><span class="ident" id="8428165">badMediaTypeTest</span><span class="op" id="8428181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428184">{</span><span class="string" id="8428185">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="8428203">,</span>&nbsp;<span class="string" id="8428205">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="8428236">}</span><span class="op" id="8428237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428240">{</span><span class="string" id="8428241">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8428271">,</span>&nbsp;<span class="string" id="8428273">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="8428307">}</span><span class="op" id="8428308">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428311">{</span><span class="string" id="8428312">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8428347">,</span>&nbsp;<span class="string" id="8428349">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="8428395">}</span><span class="op" id="8428396">,</span><br>
<span class="lineno"></span><span class="op" id="8428398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8428401">func</span>&nbsp;<span class="ident" id="8428406">TestParseMediaTypeBogus</span><span class="op" id="8428429">(</span><span class="ident" id="8428430">t</span>&nbsp;<span class="op" id="8428432">*</span><span class="ident" id="8428433">testing</span><span class="op" id="8428440">.</span><span class="ident" id="8428441">T</span><span class="op" id="8428442">)</span>&nbsp;<span class="op" id="8428444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428447">for</span>&nbsp;<span class="ident" id="8428451">_</span><span class="op" id="8428452">,</span>&nbsp;<span class="ident" id="8428454">tt</span>&nbsp;<span class="op" id="8428457">:=</span>&nbsp;<span class="keyword" id="8428460">range</span>&nbsp;<span class="ident" id="8428466">badMediaTypeTests</span>&nbsp;<span class="op" id="8428484">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428488">mt</span><span class="op" id="8428490">,</span>&nbsp;<span class="ident" id="8428492">params</span><span class="op" id="8428498">,</span>&nbsp;<span class="ident" id="8428500">err</span>&nbsp;<span class="op" id="8428504">:=</span>&nbsp;<span class="ident" id="8428507">ParseMediaType</span><span class="op" id="8428521">(</span><span class="ident" id="8428522">tt</span><span class="op" id="8428524">.</span><span class="ident" id="8428525">in</span><span class="op" id="8428527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428531">if</span>&nbsp;<span class="ident" id="8428534">err</span>&nbsp;<span class="op" id="8428538">==</span>&nbsp;<span class="builtintype" id="8428541">nil</span>&nbsp;<span class="op" id="8428545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428550">t</span><span class="op" id="8428551">.</span><span class="ident" id="8428552">Errorf</span><span class="op" id="8428558">(</span><span class="string" id="8428559">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="8428609">,</span>&nbsp;<span class="ident" id="8428611">tt</span><span class="op" id="8428613">.</span><span class="ident" id="8428614">in</span><span class="op" id="8428616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428621">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428632">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428636">if</span>&nbsp;<span class="ident" id="8428639">err</span><span class="op" id="8428642">.</span><span class="ident" id="8428643">Error</span><span class="op" id="8428648">(</span><span class="op" id="8428649">)</span>&nbsp;<span class="op" id="8428651">!=</span>&nbsp;<span class="ident" id="8428654">tt</span><span class="op" id="8428656">.</span><span class="ident" id="8428657">err</span>&nbsp;<span class="op" id="8428661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428666">t</span><span class="op" id="8428667">.</span><span class="ident" id="8428668">Errorf</span><span class="op" id="8428674">(</span><span class="string" id="8428675">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8428713">,</span>&nbsp;<span class="ident" id="8428715">tt</span><span class="op" id="8428717">.</span><span class="ident" id="8428718">in</span><span class="op" id="8428720">,</span>&nbsp;<span class="ident" id="8428722">err</span><span class="op" id="8428725">.</span><span class="ident" id="8428726">Error</span><span class="op" id="8428731">(</span><span class="op" id="8428732">)</span><span class="op" id="8428733">,</span>&nbsp;<span class="ident" id="8428735">tt</span><span class="op" id="8428737">.</span><span class="ident" id="8428738">err</span><span class="op" id="8428741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428749">if</span>&nbsp;<span class="ident" id="8428752">params</span>&nbsp;<span class="op" id="8428759">!=</span>&nbsp;<span class="builtintype" id="8428762">nil</span>&nbsp;<span class="op" id="8428766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428771">t</span><span class="op" id="8428772">.</span><span class="ident" id="8428773">Errorf</span><span class="op" id="8428779">(</span><span class="string" id="8428780">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="8428829">,</span>&nbsp;<span class="ident" id="8428831">tt</span><span class="op" id="8428833">.</span><span class="ident" id="8428834">in</span><span class="op" id="8428836">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8428844">if</span>&nbsp;<span class="ident" id="8428847">mt</span>&nbsp;<span class="op" id="8428850">!=</span>&nbsp;<span class="string" id="8428853">&#34;&#34;</span>&nbsp;<span class="op" id="8428856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428861">t</span><span class="op" id="8428862">.</span><span class="ident" id="8428863">Errorf</span><span class="op" id="8428869">(</span><span class="string" id="8428870">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="8428932">,</span>&nbsp;<span class="ident" id="8428934">tt</span><span class="op" id="8428936">.</span><span class="ident" id="8428937">in</span><span class="op" id="8428939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8428946">}</span><br>
<span class="lineno">275</span><span class="op" id="8428948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8428951">type</span>&nbsp;<span class="ident" id="8428956">formatTest</span>&nbsp;<span class="keyword" id="8428967">struct</span>&nbsp;<span class="op" id="8428974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428977">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8428984">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8428992">params</span>&nbsp;<span class="keyword" id="8428999">map</span><span class="op" id="8429002">[</span><span class="builtintype" id="8429003">string</span><span class="op" id="8429009">]</span><span class="builtintype" id="8429010">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8429018">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8429025">string</span><br>
<span class="lineno"></span><span class="op" id="8429032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8429035">var</span>&nbsp;<span class="ident" id="8429039">formatTests</span>&nbsp;<span class="op" id="8429051">=</span>&nbsp;<span class="op" id="8429053">[</span><span class="op" id="8429054">]</span><span class="ident" id="8429055">formatTest</span><span class="op" id="8429065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429068">{</span><span class="string" id="8429069">&#34;noslash&#34;</span><span class="op" id="8429078">,</span>&nbsp;<span class="builtintype" id="8429080">nil</span><span class="op" id="8429083">,</span>&nbsp;<span class="string" id="8429085">&#34;&#34;</span><span class="op" id="8429087">}</span><span class="op" id="8429088">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429091">{</span><span class="string" id="8429092">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="8429105">,</span>&nbsp;<span class="builtintype" id="8429107">nil</span><span class="op" id="8429110">,</span>&nbsp;<span class="string" id="8429112">&#34;&#34;</span><span class="op" id="8429114">}</span><span class="op" id="8429115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429118">{</span><span class="string" id="8429119">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="8429132">,</span>&nbsp;<span class="builtintype" id="8429134">nil</span><span class="op" id="8429137">,</span>&nbsp;<span class="string" id="8429139">&#34;&#34;</span><span class="op" id="8429141">}</span><span class="op" id="8429142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429145">{</span><span class="string" id="8429146">&#34;foo/BAR&#34;</span><span class="op" id="8429155">,</span>&nbsp;<span class="builtintype" id="8429157">nil</span><span class="op" id="8429160">,</span>&nbsp;<span class="string" id="8429162">&#34;foo/bar&#34;</span><span class="op" id="8429171">}</span><span class="op" id="8429172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429175">{</span><span class="string" id="8429176">&#34;foo/BAR&#34;</span><span class="op" id="8429185">,</span>&nbsp;<span class="keyword" id="8429187">map</span><span class="op" id="8429190">[</span><span class="builtintype" id="8429191">string</span><span class="op" id="8429197">]</span><span class="builtintype" id="8429198">string</span><span class="op" id="8429204">{</span><span class="string" id="8429205">&#34;X&#34;</span><span class="op" id="8429208">:</span>&nbsp;<span class="string" id="8429210">&#34;Y&#34;</span><span class="op" id="8429213">}</span><span class="op" id="8429214">,</span>&nbsp;<span class="string" id="8429216">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="8429230">}</span><span class="op" id="8429231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429234">{</span><span class="string" id="8429235">&#34;foo/BAR&#34;</span><span class="op" id="8429244">,</span>&nbsp;<span class="keyword" id="8429246">map</span><span class="op" id="8429249">[</span><span class="builtintype" id="8429250">string</span><span class="op" id="8429256">]</span><span class="builtintype" id="8429257">string</span><span class="op" id="8429263">{</span><span class="string" id="8429264">&#34;space&#34;</span><span class="op" id="8429271">:</span>&nbsp;<span class="string" id="8429273">&#34;With&nbsp;space&#34;</span><span class="op" id="8429285">}</span><span class="op" id="8429286">,</span>&nbsp;<span class="string" id="8429288">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="8429317">}</span><span class="op" id="8429318">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429321">{</span><span class="string" id="8429322">&#34;foo/BAR&#34;</span><span class="op" id="8429331">,</span>&nbsp;<span class="keyword" id="8429333">map</span><span class="op" id="8429336">[</span><span class="builtintype" id="8429337">string</span><span class="op" id="8429343">]</span><span class="builtintype" id="8429344">string</span><span class="op" id="8429350">{</span><span class="string" id="8429351">&#34;quote&#34;</span><span class="op" id="8429358">:</span>&nbsp;<span class="string" id="8429360">`With&nbsp;&#34;quote`</span><span class="op" id="8429373">}</span><span class="op" id="8429374">,</span>&nbsp;<span class="string" id="8429376">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="8429407">}</span><span class="op" id="8429408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429411">{</span><span class="string" id="8429412">&#34;foo/BAR&#34;</span><span class="op" id="8429421">,</span>&nbsp;<span class="keyword" id="8429423">map</span><span class="op" id="8429426">[</span><span class="builtintype" id="8429427">string</span><span class="op" id="8429433">]</span><span class="builtintype" id="8429434">string</span><span class="op" id="8429440">{</span><span class="string" id="8429441">&#34;bslash&#34;</span><span class="op" id="8429449">:</span>&nbsp;<span class="string" id="8429451">`With&nbsp;\backslash`</span><span class="op" id="8429468">}</span><span class="op" id="8429469">,</span>&nbsp;<span class="string" id="8429471">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="8429507">}</span><span class="op" id="8429508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429511">{</span><span class="string" id="8429512">&#34;foo/BAR&#34;</span><span class="op" id="8429521">,</span>&nbsp;<span class="keyword" id="8429523">map</span><span class="op" id="8429526">[</span><span class="builtintype" id="8429527">string</span><span class="op" id="8429533">]</span><span class="builtintype" id="8429534">string</span><span class="op" id="8429540">{</span><span class="string" id="8429541">&#34;both&#34;</span><span class="op" id="8429547">:</span>&nbsp;<span class="string" id="8429549">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="8429577">}</span><span class="op" id="8429578">,</span>&nbsp;<span class="string" id="8429580">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="8429626">}</span><span class="op" id="8429627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429630">{</span><span class="string" id="8429631">&#34;foo/BAR&#34;</span><span class="op" id="8429640">,</span>&nbsp;<span class="keyword" id="8429642">map</span><span class="op" id="8429645">[</span><span class="builtintype" id="8429646">string</span><span class="op" id="8429652">]</span><span class="builtintype" id="8429653">string</span><span class="op" id="8429659">{</span><span class="string" id="8429660">&#34;&#34;</span><span class="op" id="8429662">:</span>&nbsp;<span class="string" id="8429664">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="8429681">}</span><span class="op" id="8429682">,</span>&nbsp;<span class="string" id="8429684">&#34;&#34;</span><span class="op" id="8429686">}</span><span class="op" id="8429687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429690">{</span><span class="string" id="8429691">&#34;foo/BAR&#34;</span><span class="op" id="8429700">,</span>&nbsp;<span class="keyword" id="8429702">map</span><span class="op" id="8429705">[</span><span class="builtintype" id="8429706">string</span><span class="op" id="8429712">]</span><span class="builtintype" id="8429713">string</span><span class="op" id="8429719">{</span><span class="string" id="8429720">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="8429735">:</span>&nbsp;<span class="string" id="8429737">&#34;baz&#34;</span><span class="op" id="8429742">}</span><span class="op" id="8429743">,</span>&nbsp;<span class="string" id="8429745">&#34;&#34;</span><span class="op" id="8429747">}</span><span class="op" id="8429748">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429751">{</span><span class="string" id="8429752">&#34;foo/BAR&#34;</span><span class="op" id="8429761">,</span>&nbsp;<span class="keyword" id="8429763">map</span><span class="op" id="8429766">[</span><span class="builtintype" id="8429767">string</span><span class="op" id="8429773">]</span><span class="builtintype" id="8429774">string</span><span class="op" id="8429780">{</span><span class="string" id="8429781">&#34;nonascii&#34;</span><span class="op" id="8429791">:</span>&nbsp;<span class="string" id="8429793">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="8429821">}</span><span class="op" id="8429822">,</span>&nbsp;<span class="string" id="8429824">&#34;&#34;</span><span class="op" id="8429826">}</span><span class="op" id="8429827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8429830">{</span><span class="string" id="8429831">&#34;foo/bar&#34;</span><span class="op" id="8429840">,</span>&nbsp;<span class="keyword" id="8429842">map</span><span class="op" id="8429845">[</span><span class="builtintype" id="8429846">string</span><span class="op" id="8429852">]</span><span class="builtintype" id="8429853">string</span><span class="op" id="8429859">{</span><span class="string" id="8429860">&#34;a&#34;</span><span class="op" id="8429863">:</span>&nbsp;<span class="string" id="8429865">&#34;av&#34;</span><span class="op" id="8429869">,</span>&nbsp;<span class="string" id="8429871">&#34;b&#34;</span><span class="op" id="8429874">:</span>&nbsp;<span class="string" id="8429876">&#34;bv&#34;</span><span class="op" id="8429880">,</span>&nbsp;<span class="string" id="8429882">&#34;c&#34;</span><span class="op" id="8429885">:</span>&nbsp;<span class="string" id="8429887">&#34;cv&#34;</span><span class="op" id="8429891">}</span><span class="op" id="8429892">,</span>&nbsp;<span class="string" id="8429894">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="8429921">}</span><span class="op" id="8429922">,</span><br>
<span class="lineno"></span><span class="op" id="8429924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8429927">func</span>&nbsp;<span class="ident" id="8429932">TestFormatMediaType</span><span class="op" id="8429951">(</span><span class="ident" id="8429952">t</span>&nbsp;<span class="op" id="8429954">*</span><span class="ident" id="8429955">testing</span><span class="op" id="8429962">.</span><span class="ident" id="8429963">T</span><span class="op" id="8429964">)</span>&nbsp;<span class="op" id="8429966">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8429969">for</span>&nbsp;<span class="ident" id="8429973">i</span><span class="op" id="8429974">,</span>&nbsp;<span class="ident" id="8429976">tt</span>&nbsp;<span class="op" id="8429979">:=</span>&nbsp;<span class="keyword" id="8429982">range</span>&nbsp;<span class="ident" id="8429988">formatTests</span>&nbsp;<span class="op" id="8430000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430004">got</span>&nbsp;<span class="op" id="8430008">:=</span>&nbsp;<span class="ident" id="8430011">FormatMediaType</span><span class="op" id="8430026">(</span><span class="ident" id="8430027">tt</span><span class="op" id="8430029">.</span><span class="ident" id="8430030">typ</span><span class="op" id="8430033">,</span>&nbsp;<span class="ident" id="8430035">tt</span><span class="op" id="8430037">.</span><span class="ident" id="8430038">params</span><span class="op" id="8430044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430048">if</span>&nbsp;<span class="ident" id="8430051">got</span>&nbsp;<span class="op" id="8430055">!=</span>&nbsp;<span class="ident" id="8430058">tt</span><span class="op" id="8430060">.</span><span class="ident" id="8430061">want</span>&nbsp;<span class="op" id="8430066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430071">t</span><span class="op" id="8430072">.</span><span class="ident" id="8430073">Errorf</span><span class="op" id="8430079">(</span><span class="string" id="8430080">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8430123">,</span>&nbsp;<span class="ident" id="8430125">i</span><span class="op" id="8430126">,</span>&nbsp;<span class="ident" id="8430128">tt</span><span class="op" id="8430130">.</span><span class="ident" id="8430131">typ</span><span class="op" id="8430134">,</span>&nbsp;<span class="ident" id="8430136">tt</span><span class="op" id="8430138">.</span><span class="ident" id="8430139">params</span><span class="op" id="8430145">,</span>&nbsp;<span class="ident" id="8430147">got</span><span class="op" id="8430150">,</span>&nbsp;<span class="ident" id="8430152">tt</span><span class="op" id="8430154">.</span><span class="ident" id="8430155">want</span><span class="op" id="8430159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430163">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430166">}</span><br>
<span class="lineno"></span><span class="op" id="8430168">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
