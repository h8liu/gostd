<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4518405">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4518460">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4518514">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4518565">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4518643">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4518661">package</span>&nbsp;<span class="ident" id="4518669">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4518677">import</span>&nbsp;<span class="op" id="4518684">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4518687">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4518697">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4518704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4518707">func</span>&nbsp;<span class="ident" id="4518712">init</span><span class="op" id="4518716">(</span><span class="op" id="4518717">)</span>&nbsp;<span class="op" id="4518719">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518722"><a href="/crypto/sha256/sha256.go.html#4518687">crypto</a></span><span class="op" id="4518728">.</span><span class="ident" id="4518729">RegisterHash</span><span class="op" id="4518741">(</span><span class="ident" id="4518742"><a href="/crypto/sha256/sha256.go.html#4518687">crypto</a></span><span class="op" id="4518748">.</span><span class="ident" id="4518749">SHA224</span><span class="op" id="4518755">,</span>&nbsp;<span class="ident" id="4518757"><a href="/crypto/sha256/sha256.go.html#4520183">New224</a></span><span class="op" id="4518763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518766"><a href="/crypto/sha256/sha256.go.html#4518687">crypto</a></span><span class="op" id="4518772">.</span><span class="ident" id="4518773">RegisterHash</span><span class="op" id="4518785">(</span><span class="ident" id="4518786"><a href="/crypto/sha256/sha256.go.html#4518687">crypto</a></span><span class="op" id="4518792">.</span><span class="ident" id="4518793">SHA256</span><span class="op" id="4518799">,</span>&nbsp;<span class="ident" id="4518801"><a href="/crypto/sha256/sha256.go.html#4520053">New</a></span><span class="op" id="4518804">)</span><br>
<span class="lineno"></span><span class="op" id="4518806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4518809">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4518852">const</span>&nbsp;<span class="ident" id="4518858">Size</span>&nbsp;<span class="op" id="4518863">=</span>&nbsp;<span class="num" id="4518865">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4518869">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4518912">const</span>&nbsp;<span class="ident" id="4518918">Size224</span>&nbsp;<span class="op" id="4518926">=</span>&nbsp;<span class="num" id="4518928">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4518932">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4518980">const</span>&nbsp;<span class="ident" id="4518986">BlockSize</span>&nbsp;<span class="op" id="4518996">=</span>&nbsp;<span class="num" id="4518998">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4519002">const</span>&nbsp;<span class="op" id="4519008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519011">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519021">=</span>&nbsp;<span class="num" id="4519023">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519027">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519037">=</span>&nbsp;<span class="num" id="4519039">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519051">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519061">=</span>&nbsp;<span class="num" id="4519063">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519075">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519085">=</span>&nbsp;<span class="num" id="4519087">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519099">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519109">=</span>&nbsp;<span class="num" id="4519111">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519123">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519133">=</span>&nbsp;<span class="num" id="4519135">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519147">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519157">=</span>&nbsp;<span class="num" id="4519159">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519171">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519181">=</span>&nbsp;<span class="num" id="4519183">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519195">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519205">=</span>&nbsp;<span class="num" id="4519207">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519219">init0_224</span>&nbsp;<span class="op" id="4519229">=</span>&nbsp;<span class="num" id="4519231">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519243">init1_224</span>&nbsp;<span class="op" id="4519253">=</span>&nbsp;<span class="num" id="4519255">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519267">init2_224</span>&nbsp;<span class="op" id="4519277">=</span>&nbsp;<span class="num" id="4519279">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519291">init3_224</span>&nbsp;<span class="op" id="4519301">=</span>&nbsp;<span class="num" id="4519303">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519315">init4_224</span>&nbsp;<span class="op" id="4519325">=</span>&nbsp;<span class="num" id="4519327">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519339">init5_224</span>&nbsp;<span class="op" id="4519349">=</span>&nbsp;<span class="num" id="4519351">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519363">init6_224</span>&nbsp;<span class="op" id="4519373">=</span>&nbsp;<span class="num" id="4519375">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519387">init7_224</span>&nbsp;<span class="op" id="4519397">=</span>&nbsp;<span class="num" id="4519399">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4519410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4519413">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4519472">type</span>&nbsp;<span class="ident" id="4519477">digest</span>&nbsp;<span class="keyword" id="4519484">struct</span>&nbsp;<span class="op" id="4519491">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519494">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519500">[</span><span class="num" id="4519501">8</span><span class="op" id="4519502">]</span><span class="builtintype" id="4519503">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519511">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519517">[</span><span class="ident" id="4519518"><a href="/crypto/sha256/sha256.go.html#4519011">chunk</a></span><span class="op" id="4519523">]</span><span class="builtintype" id="4519524">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519530">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4519536">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4519541">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4519547">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519555">is224</span>&nbsp;<span class="builtintype" id="4519561">bool</span>&nbsp;<span class="comment" id="4519566">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4519600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4519603">func</span>&nbsp;<span class="op" id="4519608">(</span><span class="ident" id="4519609">d</span>&nbsp;<span class="op" id="4519611">*</span><span class="ident" id="4519612"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4519618">)</span>&nbsp;<span class="ident" id="4519620">Reset</span><span class="op" id="4519625">(</span><span class="op" id="4519626">)</span>&nbsp;<span class="op" id="4519628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4519631">if</span>&nbsp;<span class="op" id="4519634">!</span><span class="ident" id="4519635"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519636">.</span><span class="ident" id="4519637">is224</span>&nbsp;<span class="op" id="4519643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519647"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519648">.</span><span class="ident" id="4519649">h</span><span class="op" id="4519650">[</span><span class="num" id="4519651">0</span><span class="op" id="4519652">]</span>&nbsp;<span class="op" id="4519654">=</span>&nbsp;<span class="ident" id="4519656"><a href="/crypto/sha256/sha256.go.html#4519027">init0</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519664"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519665">.</span><span class="ident" id="4519666">h</span><span class="op" id="4519667">[</span><span class="num" id="4519668">1</span><span class="op" id="4519669">]</span>&nbsp;<span class="op" id="4519671">=</span>&nbsp;<span class="ident" id="4519673"><a href="/crypto/sha256/sha256.go.html#4519051">init1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519681"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519682">.</span><span class="ident" id="4519683">h</span><span class="op" id="4519684">[</span><span class="num" id="4519685">2</span><span class="op" id="4519686">]</span>&nbsp;<span class="op" id="4519688">=</span>&nbsp;<span class="ident" id="4519690"><a href="/crypto/sha256/sha256.go.html#4519075">init2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519698"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519699">.</span><span class="ident" id="4519700">h</span><span class="op" id="4519701">[</span><span class="num" id="4519702">3</span><span class="op" id="4519703">]</span>&nbsp;<span class="op" id="4519705">=</span>&nbsp;<span class="ident" id="4519707"><a href="/crypto/sha256/sha256.go.html#4519099">init3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519715"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519716">.</span><span class="ident" id="4519717">h</span><span class="op" id="4519718">[</span><span class="num" id="4519719">4</span><span class="op" id="4519720">]</span>&nbsp;<span class="op" id="4519722">=</span>&nbsp;<span class="ident" id="4519724"><a href="/crypto/sha256/sha256.go.html#4519123">init4</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519732"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519733">.</span><span class="ident" id="4519734">h</span><span class="op" id="4519735">[</span><span class="num" id="4519736">5</span><span class="op" id="4519737">]</span>&nbsp;<span class="op" id="4519739">=</span>&nbsp;<span class="ident" id="4519741"><a href="/crypto/sha256/sha256.go.html#4519147">init5</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519749"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519750">.</span><span class="ident" id="4519751">h</span><span class="op" id="4519752">[</span><span class="num" id="4519753">6</span><span class="op" id="4519754">]</span>&nbsp;<span class="op" id="4519756">=</span>&nbsp;<span class="ident" id="4519758"><a href="/crypto/sha256/sha256.go.html#4519171">init6</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519766"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519767">.</span><span class="ident" id="4519768">h</span><span class="op" id="4519769">[</span><span class="num" id="4519770">7</span><span class="op" id="4519771">]</span>&nbsp;<span class="op" id="4519773">=</span>&nbsp;<span class="ident" id="4519775"><a href="/crypto/sha256/sha256.go.html#4519195">init7</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4519782">}</span>&nbsp;<span class="keyword" id="4519784">else</span>&nbsp;<span class="op" id="4519789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519793"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519794">.</span><span class="ident" id="4519795">h</span><span class="op" id="4519796">[</span><span class="num" id="4519797">0</span><span class="op" id="4519798">]</span>&nbsp;<span class="op" id="4519800">=</span>&nbsp;<span class="ident" id="4519802"><a href="/crypto/sha256/sha256.go.html#4519219">init0_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519814"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519815">.</span><span class="ident" id="4519816">h</span><span class="op" id="4519817">[</span><span class="num" id="4519818">1</span><span class="op" id="4519819">]</span>&nbsp;<span class="op" id="4519821">=</span>&nbsp;<span class="ident" id="4519823"><a href="/crypto/sha256/sha256.go.html#4519243">init1_224</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519835"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519836">.</span><span class="ident" id="4519837">h</span><span class="op" id="4519838">[</span><span class="num" id="4519839">2</span><span class="op" id="4519840">]</span>&nbsp;<span class="op" id="4519842">=</span>&nbsp;<span class="ident" id="4519844"><a href="/crypto/sha256/sha256.go.html#4519267">init2_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519856"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519857">.</span><span class="ident" id="4519858">h</span><span class="op" id="4519859">[</span><span class="num" id="4519860">3</span><span class="op" id="4519861">]</span>&nbsp;<span class="op" id="4519863">=</span>&nbsp;<span class="ident" id="4519865"><a href="/crypto/sha256/sha256.go.html#4519291">init3_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519877"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519878">.</span><span class="ident" id="4519879">h</span><span class="op" id="4519880">[</span><span class="num" id="4519881">4</span><span class="op" id="4519882">]</span>&nbsp;<span class="op" id="4519884">=</span>&nbsp;<span class="ident" id="4519886"><a href="/crypto/sha256/sha256.go.html#4519315">init4_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519898"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519899">.</span><span class="ident" id="4519900">h</span><span class="op" id="4519901">[</span><span class="num" id="4519902">5</span><span class="op" id="4519903">]</span>&nbsp;<span class="op" id="4519905">=</span>&nbsp;<span class="ident" id="4519907"><a href="/crypto/sha256/sha256.go.html#4519339">init5_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519919"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519920">.</span><span class="ident" id="4519921">h</span><span class="op" id="4519922">[</span><span class="num" id="4519923">6</span><span class="op" id="4519924">]</span>&nbsp;<span class="op" id="4519926">=</span>&nbsp;<span class="ident" id="4519928"><a href="/crypto/sha256/sha256.go.html#4519363">init6_224</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519940"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519941">.</span><span class="ident" id="4519942">h</span><span class="op" id="4519943">[</span><span class="num" id="4519944">7</span><span class="op" id="4519945">]</span>&nbsp;<span class="op" id="4519947">=</span>&nbsp;<span class="ident" id="4519949"><a href="/crypto/sha256/sha256.go.html#4519387">init7_224</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4519960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519963"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519964">.</span><span class="ident" id="4519965">nx</span>&nbsp;<span class="op" id="4519968">=</span>&nbsp;<span class="num" id="4519970">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519973"><a href="/crypto/sha256/sha256.go.html#4519609">d</a></span><span class="op" id="4519974">.</span><span class="builtinfunc" id="4519975">len</span>&nbsp;<span class="op" id="4519979">=</span>&nbsp;<span class="num" id="4519981">0</span><br>
<span class="lineno"></span><span class="op" id="4519983">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4519986">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4520048">func</span>&nbsp;<span class="ident" id="4520053">New</span><span class="op" id="4520056">(</span><span class="op" id="4520057">)</span>&nbsp;<span class="ident" id="4520059"><a href="/crypto/sha256/sha256.go.html#4518697">hash</a></span><span class="op" id="4520063">.</span><span class="ident" id="4520064">Hash</span>&nbsp;<span class="op" id="4520069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520072">d</span>&nbsp;<span class="op" id="4520074">:=</span>&nbsp;<span class="builtinfunc" id="4520077">new</span><span class="op" id="4520080">(</span><span class="ident" id="4520081"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520090"><a href="/crypto/sha256/sha256.go.html#4520072">d</a></span><span class="op" id="4520091">.</span><span class="ident" id="4520092">Reset</span><span class="op" id="4520097">(</span><span class="op" id="4520098">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520101">return</span>&nbsp;<span class="ident" id="4520108"><a href="/crypto/sha256/sha256.go.html#4520072">d</a></span><br>
<span class="lineno"></span><span class="op" id="4520110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4520113">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4520178">func</span>&nbsp;<span class="ident" id="4520183">New224</span><span class="op" id="4520189">(</span><span class="op" id="4520190">)</span>&nbsp;<span class="ident" id="4520192"><a href="/crypto/sha256/sha256.go.html#4518697">hash</a></span><span class="op" id="4520196">.</span><span class="ident" id="4520197">Hash</span>&nbsp;<span class="op" id="4520202">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520205">d</span>&nbsp;<span class="op" id="4520207">:=</span>&nbsp;<span class="builtinfunc" id="4520210">new</span><span class="op" id="4520213">(</span><span class="ident" id="4520214"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520223"><a href="/crypto/sha256/sha256.go.html#4520205">d</a></span><span class="op" id="4520224">.</span><span class="ident" id="4520225">is224</span>&nbsp;<span class="op" id="4520231">=</span>&nbsp;<span class="ident" id="4520233">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520239"><a href="/crypto/sha256/sha256.go.html#4520205">d</a></span><span class="op" id="4520240">.</span><span class="ident" id="4520241">Reset</span><span class="op" id="4520246">(</span><span class="op" id="4520247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520250">return</span>&nbsp;<span class="ident" id="4520257"><a href="/crypto/sha256/sha256.go.html#4520205">d</a></span><br>
<span class="lineno"></span><span class="op" id="4520259">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4520262">func</span>&nbsp;<span class="op" id="4520267">(</span><span class="ident" id="4520268">d</span>&nbsp;<span class="op" id="4520270">*</span><span class="ident" id="4520271"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520277">)</span>&nbsp;<span class="ident" id="4520279">Size</span><span class="op" id="4520283">(</span><span class="op" id="4520284">)</span>&nbsp;<span class="builtintype" id="4520286">int</span>&nbsp;<span class="op" id="4520290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520293">if</span>&nbsp;<span class="op" id="4520296">!</span><span class="ident" id="4520297"><a href="/crypto/sha256/sha256.go.html#4520268">d</a></span><span class="op" id="4520298">.</span><span class="ident" id="4520299">is224</span>&nbsp;<span class="op" id="4520305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520309">return</span>&nbsp;<span class="ident" id="4520316"><a href="/crypto/sha256/sha256.go.html#4518858">Size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520322">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520325">return</span>&nbsp;<span class="ident" id="4520332"><a href="/crypto/sha256/sha256.go.html#4518918">Size224</a></span><br>
<span class="lineno"></span><span class="op" id="4520340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520343">func</span>&nbsp;<span class="op" id="4520348">(</span><span class="ident" id="4520349">d</span>&nbsp;<span class="op" id="4520351">*</span><span class="ident" id="4520352"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520358">)</span>&nbsp;<span class="ident" id="4520360">BlockSize</span><span class="op" id="4520369">(</span><span class="op" id="4520370">)</span>&nbsp;<span class="builtintype" id="4520372">int</span>&nbsp;<span class="op" id="4520376">{</span>&nbsp;<span class="keyword" id="4520378">return</span>&nbsp;<span class="ident" id="4520385"><a href="/crypto/sha256/sha256.go.html#4518986">BlockSize</a></span>&nbsp;<span class="op" id="4520395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4520398">func</span>&nbsp;<span class="op" id="4520403">(</span><span class="ident" id="4520404">d</span>&nbsp;<span class="op" id="4520406">*</span><span class="ident" id="4520407"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520413">)</span>&nbsp;<span class="ident" id="4520415">Write</span><span class="op" id="4520420">(</span><span class="ident" id="4520421">p</span>&nbsp;<span class="op" id="4520423">[</span><span class="op" id="4520424">]</span><span class="builtintype" id="4520425">byte</span><span class="op" id="4520429">)</span>&nbsp;<span class="op" id="4520431">(</span><span class="ident" id="4520432">nn</span>&nbsp;<span class="builtintype" id="4520435">int</span><span class="op" id="4520438">,</span>&nbsp;<span class="ident" id="4520440">err</span>&nbsp;<span class="builtintype" id="4520444">error</span><span class="op" id="4520449">)</span>&nbsp;<span class="op" id="4520451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520454"><a href="/crypto/sha256/sha256.go.html#4520432">nn</a></span>&nbsp;<span class="op" id="4520457">=</span>&nbsp;<span class="builtinfunc" id="4520459">len</span><span class="op" id="4520462">(</span><span class="ident" id="4520463"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520467"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520468">.</span><span class="builtinfunc" id="4520469">len</span>&nbsp;<span class="op" id="4520473">+=</span>&nbsp;<span class="ident" id="4520476">uint64</span><span class="op" id="4520482">(</span><span class="ident" id="4520483"><a href="/crypto/sha256/sha256.go.html#4520432">nn</a></span><span class="op" id="4520485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520488">if</span>&nbsp;<span class="ident" id="4520491"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520492">.</span><span class="ident" id="4520493">nx</span>&nbsp;<span class="op" id="4520496">&gt;</span>&nbsp;<span class="num" id="4520498">0</span>&nbsp;<span class="op" id="4520500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520504">n</span>&nbsp;<span class="op" id="4520506">:=</span>&nbsp;<span class="builtinfunc" id="4520509">copy</span><span class="op" id="4520513">(</span><span class="ident" id="4520514"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520515">.</span><span class="ident" id="4520516">x</span><span class="op" id="4520517">[</span><span class="ident" id="4520518"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520519">.</span><span class="ident" id="4520520">nx</span><span class="op" id="4520522">:</span><span class="op" id="4520523">]</span><span class="op" id="4520524">,</span>&nbsp;<span class="ident" id="4520526"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520527">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520531"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520532">.</span><span class="ident" id="4520533">nx</span>&nbsp;<span class="op" id="4520536">+=</span>&nbsp;<span class="ident" id="4520539"><a href="/crypto/sha256/sha256.go.html#4520504">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520543">if</span>&nbsp;<span class="ident" id="4520546"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520547">.</span><span class="ident" id="4520548">nx</span>&nbsp;<span class="op" id="4520551">==</span>&nbsp;<span class="ident" id="4520554"><a href="/crypto/sha256/sha256.go.html#4519011">chunk</a></span>&nbsp;<span class="op" id="4520560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520565"><a href="/crypto/sha256/sha256block_decl.go.html#4522213">block</a></span><span class="op" id="4520570">(</span><span class="ident" id="4520571"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520572">,</span>&nbsp;<span class="ident" id="4520574"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520575">.</span><span class="ident" id="4520576">x</span><span class="op" id="4520577">[</span><span class="op" id="4520578">:</span><span class="op" id="4520579">]</span><span class="op" id="4520580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520585"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520586">.</span><span class="ident" id="4520587">nx</span>&nbsp;<span class="op" id="4520590">=</span>&nbsp;<span class="num" id="4520592">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520596">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520600"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span>&nbsp;<span class="op" id="4520602">=</span>&nbsp;<span class="ident" id="4520604"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520605">[</span><span class="ident" id="4520606"><a href="/crypto/sha256/sha256.go.html#4520504">n</a></span><span class="op" id="4520607">:</span><span class="op" id="4520608">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520614">if</span>&nbsp;<span class="builtinfunc" id="4520617">len</span><span class="op" id="4520620">(</span><span class="ident" id="4520621"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520622">)</span>&nbsp;<span class="op" id="4520624">&gt;=</span>&nbsp;<span class="ident" id="4520627"><a href="/crypto/sha256/sha256.go.html#4519011">chunk</a></span>&nbsp;<span class="op" id="4520633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520637">n</span>&nbsp;<span class="op" id="4520639">:=</span>&nbsp;<span class="builtinfunc" id="4520642">len</span><span class="op" id="4520645">(</span><span class="ident" id="4520646"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520647">)</span>&nbsp;<span class="op" id="4520649">&amp;^</span>&nbsp;<span class="op" id="4520652">(</span><span class="ident" id="4520653"><a href="/crypto/sha256/sha256.go.html#4519011">chunk</a></span>&nbsp;<span class="op" id="4520659">-</span>&nbsp;<span class="num" id="4520661">1</span><span class="op" id="4520662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520666"><a href="/crypto/sha256/sha256block_decl.go.html#4522213">block</a></span><span class="op" id="4520671">(</span><span class="ident" id="4520672"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520673">,</span>&nbsp;<span class="ident" id="4520675"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520676">[</span><span class="op" id="4520677">:</span><span class="ident" id="4520678"><a href="/crypto/sha256/sha256.go.html#4520637">n</a></span><span class="op" id="4520679">]</span><span class="op" id="4520680">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520684"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span>&nbsp;<span class="op" id="4520686">=</span>&nbsp;<span class="ident" id="4520688"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520689">[</span><span class="ident" id="4520690"><a href="/crypto/sha256/sha256.go.html#4520637">n</a></span><span class="op" id="4520691">:</span><span class="op" id="4520692">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520698">if</span>&nbsp;<span class="builtinfunc" id="4520701">len</span><span class="op" id="4520704">(</span><span class="ident" id="4520705"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520706">)</span>&nbsp;<span class="op" id="4520708">&gt;</span>&nbsp;<span class="num" id="4520710">0</span>&nbsp;<span class="op" id="4520712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520716"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520717">.</span><span class="ident" id="4520718">nx</span>&nbsp;<span class="op" id="4520721">=</span>&nbsp;<span class="builtinfunc" id="4520723">copy</span><span class="op" id="4520727">(</span><span class="ident" id="4520728"><a href="/crypto/sha256/sha256.go.html#4520404">d</a></span><span class="op" id="4520729">.</span><span class="ident" id="4520730">x</span><span class="op" id="4520731">[</span><span class="op" id="4520732">:</span><span class="op" id="4520733">]</span><span class="op" id="4520734">,</span>&nbsp;<span class="ident" id="4520736"><a href="/crypto/sha256/sha256.go.html#4520421">p</a></span><span class="op" id="4520737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520740">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520743">return</span><br>
<span class="lineno"></span><span class="op" id="4520750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520753">func</span>&nbsp;<span class="op" id="4520758">(</span><span class="ident" id="4520759">d0</span>&nbsp;<span class="op" id="4520762">*</span><span class="ident" id="4520763"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520769">)</span>&nbsp;<span class="ident" id="4520771">Sum</span><span class="op" id="4520774">(</span><span class="ident" id="4520775">in</span>&nbsp;<span class="op" id="4520778">[</span><span class="op" id="4520779">]</span><span class="builtintype" id="4520780">byte</span><span class="op" id="4520784">)</span>&nbsp;<span class="op" id="4520786">[</span><span class="op" id="4520787">]</span><span class="builtintype" id="4520788">byte</span>&nbsp;<span class="op" id="4520793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4520796">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520863">d</span>&nbsp;<span class="op" id="4520865">:=</span>&nbsp;<span class="op" id="4520868">*</span><span class="ident" id="4520869"><a href="/crypto/sha256/sha256.go.html#4520759">d0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520873">hash</span>&nbsp;<span class="op" id="4520878">:=</span>&nbsp;<span class="ident" id="4520881"><a href="/crypto/sha256/sha256.go.html#4520863">d</a></span><span class="op" id="4520882">.</span><span class="ident" id="4520883">checkSum</span><span class="op" id="4520891">(</span><span class="op" id="4520892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520895">if</span>&nbsp;<span class="ident" id="4520898"><a href="/crypto/sha256/sha256.go.html#4520863">d</a></span><span class="op" id="4520899">.</span><span class="ident" id="4520900">is224</span>&nbsp;<span class="op" id="4520906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520910">return</span>&nbsp;<span class="builtinfunc" id="4520917">append</span><span class="op" id="4520923">(</span><span class="ident" id="4520924"><a href="/crypto/sha256/sha256.go.html#4520775">in</a></span><span class="op" id="4520926">,</span>&nbsp;<span class="ident" id="4520928"><a href="/crypto/sha256/sha256.go.html#4520873">hash</a></span><span class="op" id="4520932">[</span><span class="op" id="4520933">:</span><span class="ident" id="4520934"><a href="/crypto/sha256/sha256.go.html#4518918">Size224</a></span><span class="op" id="4520941">]</span><span class="op" id="4520942">...</span><span class="op" id="4520945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520948">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520951">return</span>&nbsp;<span class="builtinfunc" id="4520958">append</span><span class="op" id="4520964">(</span><span class="ident" id="4520965"><a href="/crypto/sha256/sha256.go.html#4520775">in</a></span><span class="op" id="4520967">,</span>&nbsp;<span class="ident" id="4520969"><a href="/crypto/sha256/sha256.go.html#4520873">hash</a></span><span class="op" id="4520973">[</span><span class="op" id="4520974">:</span><span class="op" id="4520975">]</span><span class="op" id="4520976">...</span><span class="op" id="4520979">)</span><br>
<span class="lineno"></span><span class="op" id="4520981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520984">func</span>&nbsp;<span class="op" id="4520989">(</span><span class="ident" id="4520990">d</span>&nbsp;<span class="op" id="4520992">*</span><span class="ident" id="4520993"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><span class="op" id="4520999">)</span>&nbsp;<span class="ident" id="4521001">checkSum</span><span class="op" id="4521009">(</span><span class="op" id="4521010">)</span>&nbsp;<span class="op" id="4521012">[</span><span class="ident" id="4521013"><a href="/crypto/sha256/sha256.go.html#4518858">Size</a></span><span class="op" id="4521017">]</span><span class="builtintype" id="4521018">byte</span>&nbsp;<span class="op" id="4521023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521026">len</span>&nbsp;<span class="op" id="4521030">:=</span>&nbsp;<span class="ident" id="4521033"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521034">.</span><span class="builtinfunc" id="4521035">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4521040">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521100">var</span>&nbsp;<span class="ident" id="4521104">tmp</span>&nbsp;<span class="op" id="4521108">[</span><span class="num" id="4521109">64</span><span class="op" id="4521111">]</span><span class="builtintype" id="4521112">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521118"><a href="/crypto/sha256/sha256.go.html#4521104">tmp</a></span><span class="op" id="4521121">[</span><span class="num" id="4521122">0</span><span class="op" id="4521123">]</span>&nbsp;<span class="op" id="4521125">=</span>&nbsp;<span class="num" id="4521127">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521133">if</span>&nbsp;<span class="builtinfunc" id="4521136"><a href="/crypto/sha256/sha256.go.html#4521026">len</a></span><span class="op" id="4521139">%</span><span class="num" id="4521140">64</span>&nbsp;<span class="op" id="4521143">&lt;</span>&nbsp;<span class="num" id="4521145">56</span>&nbsp;<span class="op" id="4521148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521152"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521153">.</span><span class="ident" id="4521154">Write</span><span class="op" id="4521159">(</span><span class="ident" id="4521160"><a href="/crypto/sha256/sha256.go.html#4521104">tmp</a></span><span class="op" id="4521163">[</span><span class="num" id="4521164">0</span>&nbsp;<span class="op" id="4521166">:</span>&nbsp;<span class="num" id="4521168">56</span><span class="op" id="4521170">-</span><span class="builtinfunc" id="4521171"><a href="/crypto/sha256/sha256.go.html#4521026">len</a></span><span class="op" id="4521174">%</span><span class="num" id="4521175">64</span><span class="op" id="4521177">]</span><span class="op" id="4521178">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521181">}</span>&nbsp;<span class="keyword" id="4521183">else</span>&nbsp;<span class="op" id="4521188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521192"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521193">.</span><span class="ident" id="4521194">Write</span><span class="op" id="4521199">(</span><span class="ident" id="4521200"><a href="/crypto/sha256/sha256.go.html#4521104">tmp</a></span><span class="op" id="4521203">[</span><span class="num" id="4521204">0</span>&nbsp;<span class="op" id="4521206">:</span>&nbsp;<span class="num" id="4521208">64</span><span class="op" id="4521210">+</span><span class="num" id="4521211">56</span><span class="op" id="4521213">-</span><span class="builtinfunc" id="4521214"><a href="/crypto/sha256/sha256.go.html#4521026">len</a></span><span class="op" id="4521217">%</span><span class="num" id="4521218">64</span><span class="op" id="4521220">]</span><span class="op" id="4521221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4521228">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521248"><a href="/crypto/sha256/sha256.go.html#4521026">len</a></span>&nbsp;<span class="op" id="4521252">&lt;&lt;=</span>&nbsp;<span class="num" id="4521256">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521259">for</span>&nbsp;<span class="ident" id="4521263">i</span>&nbsp;<span class="op" id="4521265">:=</span>&nbsp;<span class="builtintype" id="4521268">uint</span><span class="op" id="4521272">(</span><span class="num" id="4521273">0</span><span class="op" id="4521274">)</span><span class="op" id="4521275">;</span>&nbsp;<span class="ident" id="4521277"><a href="/crypto/sha256/sha256.go.html#4521263">i</a></span>&nbsp;<span class="op" id="4521279">&lt;</span>&nbsp;<span class="num" id="4521281">8</span><span class="op" id="4521282">;</span>&nbsp;<span class="ident" id="4521284"><a href="/crypto/sha256/sha256.go.html#4521263">i</a></span><span class="op" id="4521285">++</span>&nbsp;<span class="op" id="4521288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521292"><a href="/crypto/sha256/sha256.go.html#4521104">tmp</a></span><span class="op" id="4521295">[</span><span class="ident" id="4521296"><a href="/crypto/sha256/sha256.go.html#4521263">i</a></span><span class="op" id="4521297">]</span>&nbsp;<span class="op" id="4521299">=</span>&nbsp;<span class="builtintype" id="4521301">byte</span><span class="op" id="4521305">(</span><span class="builtinfunc" id="4521306"><a href="/crypto/sha256/sha256.go.html#4521026">len</a></span>&nbsp;<span class="op" id="4521310">&gt;&gt;</span>&nbsp;<span class="op" id="4521313">(</span><span class="num" id="4521314">56</span>&nbsp;<span class="op" id="4521317">-</span>&nbsp;<span class="num" id="4521319">8</span><span class="op" id="4521320">*</span><span class="ident" id="4521321"><a href="/crypto/sha256/sha256.go.html#4521263">i</a></span><span class="op" id="4521322">)</span><span class="op" id="4521323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521329"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521330">.</span><span class="ident" id="4521331">Write</span><span class="op" id="4521336">(</span><span class="ident" id="4521337"><a href="/crypto/sha256/sha256.go.html#4521104">tmp</a></span><span class="op" id="4521340">[</span><span class="num" id="4521341">0</span><span class="op" id="4521342">:</span><span class="num" id="4521343">8</span><span class="op" id="4521344">]</span><span class="op" id="4521345">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521349">if</span>&nbsp;<span class="ident" id="4521352"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521353">.</span><span class="ident" id="4521354">nx</span>&nbsp;<span class="op" id="4521357">!=</span>&nbsp;<span class="num" id="4521360">0</span>&nbsp;<span class="op" id="4521362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521366">panic</span><span class="op" id="4521371">(</span><span class="string" id="4521372">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4521383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521390">h</span>&nbsp;<span class="op" id="4521392">:=</span>&nbsp;<span class="ident" id="4521395"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521396">.</span><span class="ident" id="4521397">h</span><span class="op" id="4521398">[</span><span class="op" id="4521399">:</span><span class="op" id="4521400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521403">if</span>&nbsp;<span class="ident" id="4521406"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521407">.</span><span class="ident" id="4521408">is224</span>&nbsp;<span class="op" id="4521414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521418"><a href="/crypto/sha256/sha256.go.html#4521390">h</a></span>&nbsp;<span class="op" id="4521420">=</span>&nbsp;<span class="ident" id="4521422"><a href="/crypto/sha256/sha256.go.html#4520990">d</a></span><span class="op" id="4521423">.</span><span class="ident" id="4521424">h</span><span class="op" id="4521425">[</span><span class="op" id="4521426">:</span><span class="num" id="4521427">7</span><span class="op" id="4521428">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521435">var</span>&nbsp;<span class="ident" id="4521439">digest</span>&nbsp;<span class="op" id="4521446">[</span><span class="ident" id="4521447"><a href="/crypto/sha256/sha256.go.html#4518858">Size</a></span><span class="op" id="4521451">]</span><span class="builtintype" id="4521452">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521458">for</span>&nbsp;<span class="ident" id="4521462">i</span><span class="op" id="4521463">,</span>&nbsp;<span class="ident" id="4521465">s</span>&nbsp;<span class="op" id="4521467">:=</span>&nbsp;<span class="keyword" id="4521470">range</span>&nbsp;<span class="ident" id="4521476"><a href="/crypto/sha256/sha256.go.html#4521390">h</a></span>&nbsp;<span class="op" id="4521478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521482"><a href="/crypto/sha256/sha256.go.html#4521439">digest</a></span><span class="op" id="4521488">[</span><span class="ident" id="4521489"><a href="/crypto/sha256/sha256.go.html#4521462">i</a></span><span class="op" id="4521490">*</span><span class="num" id="4521491">4</span><span class="op" id="4521492">]</span>&nbsp;<span class="op" id="4521494">=</span>&nbsp;<span class="builtintype" id="4521496">byte</span><span class="op" id="4521500">(</span><span class="ident" id="4521501"><a href="/crypto/sha256/sha256.go.html#4521465">s</a></span>&nbsp;<span class="op" id="4521503">&gt;&gt;</span>&nbsp;<span class="num" id="4521506">24</span><span class="op" id="4521508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521512"><a href="/crypto/sha256/sha256.go.html#4521439">digest</a></span><span class="op" id="4521518">[</span><span class="ident" id="4521519"><a href="/crypto/sha256/sha256.go.html#4521462">i</a></span><span class="op" id="4521520">*</span><span class="num" id="4521521">4</span><span class="op" id="4521522">+</span><span class="num" id="4521523">1</span><span class="op" id="4521524">]</span>&nbsp;<span class="op" id="4521526">=</span>&nbsp;<span class="builtintype" id="4521528">byte</span><span class="op" id="4521532">(</span><span class="ident" id="4521533"><a href="/crypto/sha256/sha256.go.html#4521465">s</a></span>&nbsp;<span class="op" id="4521535">&gt;&gt;</span>&nbsp;<span class="num" id="4521538">16</span><span class="op" id="4521540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521544"><a href="/crypto/sha256/sha256.go.html#4521439">digest</a></span><span class="op" id="4521550">[</span><span class="ident" id="4521551"><a href="/crypto/sha256/sha256.go.html#4521462">i</a></span><span class="op" id="4521552">*</span><span class="num" id="4521553">4</span><span class="op" id="4521554">+</span><span class="num" id="4521555">2</span><span class="op" id="4521556">]</span>&nbsp;<span class="op" id="4521558">=</span>&nbsp;<span class="builtintype" id="4521560">byte</span><span class="op" id="4521564">(</span><span class="ident" id="4521565"><a href="/crypto/sha256/sha256.go.html#4521465">s</a></span>&nbsp;<span class="op" id="4521567">&gt;&gt;</span>&nbsp;<span class="num" id="4521570">8</span><span class="op" id="4521571">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521575"><a href="/crypto/sha256/sha256.go.html#4521439">digest</a></span><span class="op" id="4521581">[</span><span class="ident" id="4521582"><a href="/crypto/sha256/sha256.go.html#4521462">i</a></span><span class="op" id="4521583">*</span><span class="num" id="4521584">4</span><span class="op" id="4521585">+</span><span class="num" id="4521586">3</span><span class="op" id="4521587">]</span>&nbsp;<span class="op" id="4521589">=</span>&nbsp;<span class="builtintype" id="4521591">byte</span><span class="op" id="4521595">(</span><span class="ident" id="4521596"><a href="/crypto/sha256/sha256.go.html#4521465">s</a></span><span class="op" id="4521597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521604">return</span>&nbsp;<span class="ident" id="4521611"><a href="/crypto/sha256/sha256.go.html#4521439">digest</a></span><br>
<span class="lineno"></span><span class="op" id="4521618">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4521621">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4521672">func</span>&nbsp;<span class="ident" id="4521677">Sum256</span><span class="op" id="4521683">(</span><span class="ident" id="4521684">data</span>&nbsp;<span class="op" id="4521689">[</span><span class="op" id="4521690">]</span><span class="builtintype" id="4521691">byte</span><span class="op" id="4521695">)</span>&nbsp;<span class="op" id="4521697">[</span><span class="ident" id="4521698"><a href="/crypto/sha256/sha256.go.html#4518858">Size</a></span><span class="op" id="4521702">]</span><span class="builtintype" id="4521703">byte</span>&nbsp;<span class="op" id="4521708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521711">var</span>&nbsp;<span class="ident" id="4521715">d</span>&nbsp;<span class="ident" id="4521717"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521725"><a href="/crypto/sha256/sha256.go.html#4521715">d</a></span><span class="op" id="4521726">.</span><span class="ident" id="4521727">Reset</span><span class="op" id="4521732">(</span><span class="op" id="4521733">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521736"><a href="/crypto/sha256/sha256.go.html#4521715">d</a></span><span class="op" id="4521737">.</span><span class="ident" id="4521738">Write</span><span class="op" id="4521743">(</span><span class="ident" id="4521744"><a href="/crypto/sha256/sha256.go.html#4521684">data</a></span><span class="op" id="4521748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521751">return</span>&nbsp;<span class="ident" id="4521758"><a href="/crypto/sha256/sha256.go.html#4521715">d</a></span><span class="op" id="4521759">.</span><span class="ident" id="4521760">checkSum</span><span class="op" id="4521768">(</span><span class="op" id="4521769">)</span><br>
<span class="lineno"></span><span class="op" id="4521771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4521774">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4521825">func</span>&nbsp;<span class="ident" id="4521830">Sum224</span><span class="op" id="4521836">(</span><span class="ident" id="4521837">data</span>&nbsp;<span class="op" id="4521842">[</span><span class="op" id="4521843">]</span><span class="builtintype" id="4521844">byte</span><span class="op" id="4521848">)</span>&nbsp;<span class="op" id="4521850">(</span><span class="ident" id="4521851">sum224</span>&nbsp;<span class="op" id="4521858">[</span><span class="ident" id="4521859"><a href="/crypto/sha256/sha256.go.html#4518918">Size224</a></span><span class="op" id="4521866">]</span><span class="builtintype" id="4521867">byte</span><span class="op" id="4521871">)</span>&nbsp;<span class="op" id="4521873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521876">var</span>&nbsp;<span class="ident" id="4521880">d</span>&nbsp;<span class="ident" id="4521882"><a href="/crypto/sha256/sha256.go.html#4519477">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521890"><a href="/crypto/sha256/sha256.go.html#4521880">d</a></span><span class="op" id="4521891">.</span><span class="ident" id="4521892">is224</span>&nbsp;<span class="op" id="4521898">=</span>&nbsp;<span class="ident" id="4521900">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521906"><a href="/crypto/sha256/sha256.go.html#4521880">d</a></span><span class="op" id="4521907">.</span><span class="ident" id="4521908">Reset</span><span class="op" id="4521913">(</span><span class="op" id="4521914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521917"><a href="/crypto/sha256/sha256.go.html#4521880">d</a></span><span class="op" id="4521918">.</span><span class="ident" id="4521919">Write</span><span class="op" id="4521924">(</span><span class="ident" id="4521925"><a href="/crypto/sha256/sha256.go.html#4521837">data</a></span><span class="op" id="4521929">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521932">sum</span>&nbsp;<span class="op" id="4521936">:=</span>&nbsp;<span class="ident" id="4521939"><a href="/crypto/sha256/sha256.go.html#4521880">d</a></span><span class="op" id="4521940">.</span><span class="ident" id="4521941">checkSum</span><span class="op" id="4521949">(</span><span class="op" id="4521950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521953">copy</span><span class="op" id="4521957">(</span><span class="ident" id="4521958"><a href="/crypto/sha256/sha256.go.html#4521851">sum224</a></span><span class="op" id="4521964">[</span><span class="op" id="4521965">:</span><span class="op" id="4521966">]</span><span class="op" id="4521967">,</span>&nbsp;<span class="ident" id="4521969"><a href="/crypto/sha256/sha256.go.html#4521932">sum</a></span><span class="op" id="4521972">[</span><span class="op" id="4521973">:</span><span class="ident" id="4521974"><a href="/crypto/sha256/sha256.go.html#4518918">Size224</a></span><span class="op" id="4521981">]</span><span class="op" id="4521982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521985">return</span><br>
<span class="lineno"></span><span class="op" id="4521992">}</span>
</div>
</body>
</html>
