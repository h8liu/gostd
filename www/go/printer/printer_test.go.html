<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8409531">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8409586">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8409640">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8409691">package</span>&nbsp;<span class="ident" id="8409699">printer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8409708">import</span>&nbsp;<span class="op" id="8409715">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409718">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409727">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409737">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409745">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409752">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409762">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409775">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409787">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409800">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409817">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409828">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8409835">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8409838">const</span>&nbsp;<span class="op" id="8409844">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8409847">dataDir</span>&nbsp;&nbsp;<span class="op" id="8409856">=</span>&nbsp;<span class="string" id="8409858">&#34;testdata&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8409870">tabwidth</span>&nbsp;<span class="op" id="8409879">=</span>&nbsp;<span class="num" id="8409881">8</span><br>
<span class="lineno"></span><span class="op" id="8409883">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="8409886">var</span>&nbsp;<span class="ident" id="8409890">update</span>&nbsp;<span class="op" id="8409897">=</span>&nbsp;<span class="ident" id="8409899"><a href="/go/printer/printer_test.go.html#8409737">flag</a></span><span class="op" id="8409903">.</span><span class="ident" id="8409904">Bool</span><span class="op" id="8409908">(</span><span class="string" id="8409909">&#34;update&#34;</span><span class="op" id="8409917">,</span>&nbsp;<span class="ident" id="8409919">false</span><span class="op" id="8409924">,</span>&nbsp;<span class="string" id="8409926">&#34;update&nbsp;golden&nbsp;files&#34;</span><span class="op" id="8409947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8409950">var</span>&nbsp;<span class="ident" id="8409954">fset</span>&nbsp;<span class="op" id="8409959">=</span>&nbsp;<span class="ident" id="8409961"><a href="/go/printer/printer_test.go.html#8409775">token</a></span><span class="op" id="8409966">.</span><span class="ident" id="8409967">NewFileSet</span><span class="op" id="8409977">(</span><span class="op" id="8409978">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8409981">type</span>&nbsp;<span class="ident" id="8409986">checkMode</span>&nbsp;<span class="builtintype" id="8409996">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8410002">const</span>&nbsp;<span class="op" id="8410008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410011">export</span>&nbsp;<span class="ident" id="8410018"><a href="/go/printer/printer_test.go.html#8409986">checkMode</a></span>&nbsp;<span class="op" id="8410028">=</span>&nbsp;<span class="num" id="8410030">1</span>&nbsp;<span class="op" id="8410032">&lt;&lt;</span>&nbsp;<span class="ident" id="8410035">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410041">rawFormat</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410052">idempotent</span><br>
<span class="lineno"></span><span class="op" id="8410063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8410066">//&nbsp;format&nbsp;parses&nbsp;src,&nbsp;prints&nbsp;the&nbsp;corresponding&nbsp;AST,&nbsp;verifies&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="8410141">//&nbsp;src&nbsp;is&nbsp;syntactically&nbsp;correct,&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;src&nbsp;or&nbsp;an&nbsp;error</span><br>
<span class="lineno">40</span><span class="comment" id="8410216">//&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="8410227">func</span>&nbsp;<span class="ident" id="8410232">format</span><span class="op" id="8410238">(</span><span class="ident" id="8410239">src</span>&nbsp;<span class="op" id="8410243">[</span><span class="op" id="8410244">]</span><span class="builtintype" id="8410245">byte</span><span class="op" id="8410249">,</span>&nbsp;<span class="ident" id="8410251">mode</span>&nbsp;<span class="ident" id="8410256"><a href="/go/printer/printer_test.go.html#8409986">checkMode</a></span><span class="op" id="8410265">)</span>&nbsp;<span class="op" id="8410267">(</span><span class="op" id="8410268">[</span><span class="op" id="8410269">]</span><span class="builtintype" id="8410270">byte</span><span class="op" id="8410274">,</span>&nbsp;<span class="builtintype" id="8410276">error</span><span class="op" id="8410281">)</span>&nbsp;<span class="op" id="8410283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410286">//&nbsp;parse&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410300">f</span><span class="op" id="8410301">,</span>&nbsp;<span class="ident" id="8410303">err</span>&nbsp;<span class="op" id="8410307">:=</span>&nbsp;<span class="ident" id="8410310"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8410316">.</span><span class="ident" id="8410317">ParseFile</span><span class="op" id="8410326">(</span><span class="ident" id="8410327"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8410331">,</span>&nbsp;<span class="string" id="8410333">&#34;&#34;</span><span class="op" id="8410335">,</span>&nbsp;<span class="ident" id="8410337"><a href="/go/printer/printer_test.go.html#8410239">src</a></span><span class="op" id="8410340">,</span>&nbsp;<span class="ident" id="8410342"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8410348">.</span><span class="ident" id="8410349">ParseComments</span><span class="op" id="8410362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410365">if</span>&nbsp;<span class="ident" id="8410368"><a href="/go/printer/printer_test.go.html#8410303">err</a></span>&nbsp;<span class="op" id="8410372">!=</span>&nbsp;<span class="ident" id="8410375">nil</span>&nbsp;<span class="op" id="8410379">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410383">return</span>&nbsp;<span class="ident" id="8410390">nil</span><span class="op" id="8410393">,</span>&nbsp;<span class="ident" id="8410395"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8410398">.</span><span class="ident" id="8410399">Errorf</span><span class="op" id="8410405">(</span><span class="string" id="8410406">&#34;parse:&nbsp;%s\n%s&#34;</span><span class="op" id="8410421">,</span>&nbsp;<span class="ident" id="8410423"><a href="/go/printer/printer_test.go.html#8410303">err</a></span><span class="op" id="8410426">,</span>&nbsp;<span class="ident" id="8410428"><a href="/go/printer/printer_test.go.html#8410239">src</a></span><span class="op" id="8410431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410438">//&nbsp;filter&nbsp;exports&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410470">if</span>&nbsp;<span class="ident" id="8410473"><a href="/go/printer/printer_test.go.html#8410251">mode</a></span><span class="op" id="8410477">&amp;</span><span class="ident" id="8410478"><a href="/go/printer/printer_test.go.html#8410011">export</a></span>&nbsp;<span class="op" id="8410485">!=</span>&nbsp;<span class="num" id="8410488">0</span>&nbsp;<span class="op" id="8410490">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410494"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8410497">.</span><span class="ident" id="8410498">FileExports</span><span class="op" id="8410509">(</span><span class="ident" id="8410510"><a href="/go/printer/printer_test.go.html#8410300">f</a></span><span class="op" id="8410511">)</span>&nbsp;<span class="comment" id="8410513">//&nbsp;ignore&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410532"><a href="/go/printer/printer_test.go.html#8410300">f</a></span><span class="op" id="8410533">.</span><span class="ident" id="8410534">Comments</span>&nbsp;<span class="op" id="8410543">=</span>&nbsp;<span class="ident" id="8410545">nil</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8410551">//&nbsp;don&#39;t&nbsp;print&nbsp;comments&nbsp;that&nbsp;are&nbsp;not&nbsp;in&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410600">//&nbsp;determine&nbsp;printer&nbsp;configuration</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410636">cfg</span>&nbsp;<span class="op" id="8410640">:=</span>&nbsp;<span class="ident" id="8410643"><a href="/go/printer/printer.go.html#6213576">Config</a></span><span class="op" id="8410649">{</span><span class="ident" id="8410650">Tabwidth</span><span class="op" id="8410658">:</span>&nbsp;<span class="ident" id="8410660"><a href="/go/printer/printer_test.go.html#8409870">tabwidth</a></span><span class="op" id="8410668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410671">if</span>&nbsp;<span class="ident" id="8410674"><a href="/go/printer/printer_test.go.html#8410251">mode</a></span><span class="op" id="8410678">&amp;</span><span class="ident" id="8410679"><a href="/go/printer/printer_test.go.html#8410041">rawFormat</a></span>&nbsp;<span class="op" id="8410689">!=</span>&nbsp;<span class="num" id="8410692">0</span>&nbsp;<span class="op" id="8410694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410698"><a href="/go/printer/printer_test.go.html#8410636">cfg</a></span><span class="op" id="8410701">.</span><span class="ident" id="8410702">Mode</span>&nbsp;<span class="op" id="8410707">|=</span>&nbsp;<span class="ident" id="8410710"><a href="/go/printer/printer.go.html#6213194">RawFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410725">//&nbsp;print&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410739">var</span>&nbsp;<span class="ident" id="8410743">buf</span>&nbsp;<span class="ident" id="8410747"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8410752">.</span><span class="ident" id="8410753">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410761">if</span>&nbsp;<span class="ident" id="8410764">err</span>&nbsp;<span class="op" id="8410768">:=</span>&nbsp;<span class="ident" id="8410771"><a href="/go/printer/printer_test.go.html#8410636">cfg</a></span><span class="op" id="8410774">.</span><span class="ident" id="8410775">Fprint</span><span class="op" id="8410781">(</span><span class="op" id="8410782">&amp;</span><span class="ident" id="8410783"><a href="/go/printer/printer_test.go.html#8410743">buf</a></span><span class="op" id="8410786">,</span>&nbsp;<span class="ident" id="8410788"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8410792">,</span>&nbsp;<span class="ident" id="8410794"><a href="/go/printer/printer_test.go.html#8410300">f</a></span><span class="op" id="8410795">)</span><span class="op" id="8410796">;</span>&nbsp;<span class="ident" id="8410798"><a href="/go/printer/printer_test.go.html#8410764">err</a></span>&nbsp;<span class="op" id="8410802">!=</span>&nbsp;<span class="ident" id="8410805">nil</span>&nbsp;<span class="op" id="8410809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410813">return</span>&nbsp;<span class="ident" id="8410820">nil</span><span class="op" id="8410823">,</span>&nbsp;<span class="ident" id="8410825"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8410828">.</span><span class="ident" id="8410829">Errorf</span><span class="op" id="8410835">(</span><span class="string" id="8410836">&#34;print:&nbsp;%s&#34;</span><span class="op" id="8410847">,</span>&nbsp;<span class="ident" id="8410849"><a href="/go/printer/printer_test.go.html#8410764">err</a></span><span class="op" id="8410852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410855">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410859">//&nbsp;make&nbsp;sure&nbsp;formatted&nbsp;output&nbsp;is&nbsp;syntactically&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8410915">res</span>&nbsp;<span class="op" id="8410919">:=</span>&nbsp;<span class="ident" id="8410922"><a href="/go/printer/printer_test.go.html#8410743">buf</a></span><span class="op" id="8410925">.</span><span class="ident" id="8410926">Bytes</span><span class="op" id="8410931">(</span><span class="op" id="8410932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410935">if</span>&nbsp;<span class="ident" id="8410938">_</span><span class="op" id="8410939">,</span>&nbsp;<span class="ident" id="8410941">err</span>&nbsp;<span class="op" id="8410945">:=</span>&nbsp;<span class="ident" id="8410948"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8410954">.</span><span class="ident" id="8410955">ParseFile</span><span class="op" id="8410964">(</span><span class="ident" id="8410965"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8410969">,</span>&nbsp;<span class="string" id="8410971">&#34;&#34;</span><span class="op" id="8410973">,</span>&nbsp;<span class="ident" id="8410975"><a href="/go/printer/printer_test.go.html#8410915">res</a></span><span class="op" id="8410978">,</span>&nbsp;<span class="num" id="8410980">0</span><span class="op" id="8410981">)</span><span class="op" id="8410982">;</span>&nbsp;<span class="ident" id="8410984"><a href="/go/printer/printer_test.go.html#8410941">err</a></span>&nbsp;<span class="op" id="8410988">!=</span>&nbsp;<span class="ident" id="8410991">nil</span>&nbsp;<span class="op" id="8410995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8410999">return</span>&nbsp;<span class="ident" id="8411006">nil</span><span class="op" id="8411009">,</span>&nbsp;<span class="ident" id="8411011"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8411014">.</span><span class="ident" id="8411015">Errorf</span><span class="op" id="8411021">(</span><span class="string" id="8411022">&#34;re-parse:&nbsp;%s\n%s&#34;</span><span class="op" id="8411040">,</span>&nbsp;<span class="ident" id="8411042"><a href="/go/printer/printer_test.go.html#8410941">err</a></span><span class="op" id="8411045">,</span>&nbsp;<span class="ident" id="8411047"><a href="/go/printer/printer_test.go.html#8410743">buf</a></span><span class="op" id="8411050">.</span><span class="ident" id="8411051">Bytes</span><span class="op" id="8411056">(</span><span class="op" id="8411057">)</span><span class="op" id="8411058">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411065">return</span>&nbsp;<span class="ident" id="8411072"><a href="/go/printer/printer_test.go.html#8410915">res</a></span><span class="op" id="8411075">,</span>&nbsp;<span class="ident" id="8411077">nil</span><br>
<span class="lineno"></span><span class="op" id="8411081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="8411084">//&nbsp;lineAt&nbsp;returns&nbsp;the&nbsp;line&nbsp;in&nbsp;text&nbsp;starting&nbsp;at&nbsp;offset&nbsp;offs.</span><br>
<span class="lineno"></span><span class="keyword" id="8411144">func</span>&nbsp;<span class="ident" id="8411149">lineAt</span><span class="op" id="8411155">(</span><span class="ident" id="8411156">text</span>&nbsp;<span class="op" id="8411161">[</span><span class="op" id="8411162">]</span><span class="builtintype" id="8411163">byte</span><span class="op" id="8411167">,</span>&nbsp;<span class="ident" id="8411169">offs</span>&nbsp;<span class="builtintype" id="8411174">int</span><span class="op" id="8411177">)</span>&nbsp;<span class="op" id="8411179">[</span><span class="op" id="8411180">]</span><span class="builtintype" id="8411181">byte</span>&nbsp;<span class="op" id="8411186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411189">i</span>&nbsp;<span class="op" id="8411191">:=</span>&nbsp;<span class="ident" id="8411194"><a href="/go/printer/printer_test.go.html#8411169">offs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411200">for</span>&nbsp;<span class="ident" id="8411204"><a href="/go/printer/printer_test.go.html#8411189">i</a></span>&nbsp;<span class="op" id="8411206">&lt;</span>&nbsp;<span class="builtinfunc" id="8411208">len</span><span class="op" id="8411211">(</span><span class="ident" id="8411212"><a href="/go/printer/printer_test.go.html#8411156">text</a></span><span class="op" id="8411216">)</span>&nbsp;<span class="op" id="8411218">&amp;&amp;</span>&nbsp;<span class="ident" id="8411221"><a href="/go/printer/printer_test.go.html#8411156">text</a></span><span class="op" id="8411225">[</span><span class="ident" id="8411226"><a href="/go/printer/printer_test.go.html#8411189">i</a></span><span class="op" id="8411227">]</span>&nbsp;<span class="op" id="8411229">!=</span>&nbsp;<span class="string" id="8411232">&#39;\n&#39;</span>&nbsp;<span class="op" id="8411237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411241"><a href="/go/printer/printer_test.go.html#8411189">i</a></span><span class="op" id="8411242">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411249">return</span>&nbsp;<span class="ident" id="8411256"><a href="/go/printer/printer_test.go.html#8411156">text</a></span><span class="op" id="8411260">[</span><span class="ident" id="8411261"><a href="/go/printer/printer_test.go.html#8411169">offs</a></span><span class="op" id="8411265">:</span><span class="ident" id="8411266"><a href="/go/printer/printer_test.go.html#8411189">i</a></span><span class="op" id="8411267">]</span><br>
<span class="lineno"></span><span class="op" id="8411269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8411272">//&nbsp;diff&nbsp;compares&nbsp;a&nbsp;and&nbsp;b.</span><br>
<span class="lineno">85</span><span class="keyword" id="8411298">func</span>&nbsp;<span class="ident" id="8411303">diff</span><span class="op" id="8411307">(</span><span class="ident" id="8411308">aname</span><span class="op" id="8411313">,</span>&nbsp;<span class="ident" id="8411315">bname</span>&nbsp;<span class="builtintype" id="8411321">string</span><span class="op" id="8411327">,</span>&nbsp;<span class="ident" id="8411329">a</span><span class="op" id="8411330">,</span>&nbsp;<span class="ident" id="8411332">b</span>&nbsp;<span class="op" id="8411334">[</span><span class="op" id="8411335">]</span><span class="builtintype" id="8411336">byte</span><span class="op" id="8411340">)</span>&nbsp;<span class="builtintype" id="8411342">error</span>&nbsp;<span class="op" id="8411348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411351">var</span>&nbsp;<span class="ident" id="8411355">buf</span>&nbsp;<span class="ident" id="8411359"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8411364">.</span><span class="ident" id="8411365">Buffer</span>&nbsp;<span class="comment" id="8411372">//&nbsp;holding&nbsp;long&nbsp;error&nbsp;message</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8411404">//&nbsp;compare&nbsp;lengths</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411424">if</span>&nbsp;<span class="builtinfunc" id="8411427">len</span><span class="op" id="8411430">(</span><span class="ident" id="8411431"><a href="/go/printer/printer_test.go.html#8411329">a</a></span><span class="op" id="8411432">)</span>&nbsp;<span class="op" id="8411434">!=</span>&nbsp;<span class="builtinfunc" id="8411437">len</span><span class="op" id="8411440">(</span><span class="ident" id="8411441"><a href="/go/printer/printer_test.go.html#8411332">b</a></span><span class="op" id="8411442">)</span>&nbsp;<span class="op" id="8411444">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411448"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8411451">.</span><span class="ident" id="8411452">Fprintf</span><span class="op" id="8411459">(</span><span class="op" id="8411460">&amp;</span><span class="ident" id="8411461"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411464">,</span>&nbsp;<span class="string" id="8411466">&#34;\nlength&nbsp;changed:&nbsp;len(%s)&nbsp;=&nbsp;%d,&nbsp;len(%s)&nbsp;=&nbsp;%d&#34;</span><span class="op" id="8411512">,</span>&nbsp;<span class="ident" id="8411514"><a href="/go/printer/printer_test.go.html#8411308">aname</a></span><span class="op" id="8411519">,</span>&nbsp;<span class="builtinfunc" id="8411521">len</span><span class="op" id="8411524">(</span><span class="ident" id="8411525"><a href="/go/printer/printer_test.go.html#8411329">a</a></span><span class="op" id="8411526">)</span><span class="op" id="8411527">,</span>&nbsp;<span class="ident" id="8411529"><a href="/go/printer/printer_test.go.html#8411315">bname</a></span><span class="op" id="8411534">,</span>&nbsp;<span class="builtinfunc" id="8411536">len</span><span class="op" id="8411539">(</span><span class="ident" id="8411540"><a href="/go/printer/printer_test.go.html#8411332">b</a></span><span class="op" id="8411541">)</span><span class="op" id="8411542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8411549">//&nbsp;compare&nbsp;contents</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411570">line</span>&nbsp;<span class="op" id="8411575">:=</span>&nbsp;<span class="num" id="8411578">1</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411581">offs</span>&nbsp;<span class="op" id="8411586">:=</span>&nbsp;<span class="num" id="8411589">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411592">for</span>&nbsp;<span class="ident" id="8411596">i</span>&nbsp;<span class="op" id="8411598">:=</span>&nbsp;<span class="num" id="8411601">0</span><span class="op" id="8411602">;</span>&nbsp;<span class="ident" id="8411604"><a href="/go/printer/printer_test.go.html#8411596">i</a></span>&nbsp;<span class="op" id="8411606">&lt;</span>&nbsp;<span class="builtinfunc" id="8411608">len</span><span class="op" id="8411611">(</span><span class="ident" id="8411612"><a href="/go/printer/printer_test.go.html#8411329">a</a></span><span class="op" id="8411613">)</span>&nbsp;<span class="op" id="8411615">&amp;&amp;</span>&nbsp;<span class="ident" id="8411618"><a href="/go/printer/printer_test.go.html#8411596">i</a></span>&nbsp;<span class="op" id="8411620">&lt;</span>&nbsp;<span class="builtinfunc" id="8411622">len</span><span class="op" id="8411625">(</span><span class="ident" id="8411626"><a href="/go/printer/printer_test.go.html#8411332">b</a></span><span class="op" id="8411627">)</span><span class="op" id="8411628">;</span>&nbsp;<span class="ident" id="8411630"><a href="/go/printer/printer_test.go.html#8411596">i</a></span><span class="op" id="8411631">++</span>&nbsp;<span class="op" id="8411634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411638">ch</span>&nbsp;<span class="op" id="8411641">:=</span>&nbsp;<span class="ident" id="8411644"><a href="/go/printer/printer_test.go.html#8411329">a</a></span><span class="op" id="8411645">[</span><span class="ident" id="8411646"><a href="/go/printer/printer_test.go.html#8411596">i</a></span><span class="op" id="8411647">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411651">if</span>&nbsp;<span class="ident" id="8411654"><a href="/go/printer/printer_test.go.html#8411638">ch</a></span>&nbsp;<span class="op" id="8411657">!=</span>&nbsp;<span class="ident" id="8411660"><a href="/go/printer/printer_test.go.html#8411332">b</a></span><span class="op" id="8411661">[</span><span class="ident" id="8411662"><a href="/go/printer/printer_test.go.html#8411596">i</a></span><span class="op" id="8411663">]</span>&nbsp;<span class="op" id="8411665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411670"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8411673">.</span><span class="ident" id="8411674">Fprintf</span><span class="op" id="8411681">(</span><span class="op" id="8411682">&amp;</span><span class="ident" id="8411683"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411686">,</span>&nbsp;<span class="string" id="8411688">&#34;\n%s:%d:%d:&nbsp;%s&#34;</span><span class="op" id="8411704">,</span>&nbsp;<span class="ident" id="8411706"><a href="/go/printer/printer_test.go.html#8411308">aname</a></span><span class="op" id="8411711">,</span>&nbsp;<span class="ident" id="8411713"><a href="/go/printer/printer_test.go.html#8411570">line</a></span><span class="op" id="8411717">,</span>&nbsp;<span class="ident" id="8411719"><a href="/go/printer/printer_test.go.html#8411596">i</a></span><span class="op" id="8411720">-</span><span class="ident" id="8411721"><a href="/go/printer/printer_test.go.html#8411581">offs</a></span><span class="op" id="8411725">+</span><span class="num" id="8411726">1</span><span class="op" id="8411727">,</span>&nbsp;<span class="ident" id="8411729"><a href="/go/printer/printer_test.go.html#8411149">lineAt</a></span><span class="op" id="8411735">(</span><span class="ident" id="8411736"><a href="/go/printer/printer_test.go.html#8411329">a</a></span><span class="op" id="8411737">,</span>&nbsp;<span class="ident" id="8411739"><a href="/go/printer/printer_test.go.html#8411581">offs</a></span><span class="op" id="8411743">)</span><span class="op" id="8411744">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411749"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8411752">.</span><span class="ident" id="8411753">Fprintf</span><span class="op" id="8411760">(</span><span class="op" id="8411761">&amp;</span><span class="ident" id="8411762"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411765">,</span>&nbsp;<span class="string" id="8411767">&#34;\n%s:%d:%d:&nbsp;%s&#34;</span><span class="op" id="8411783">,</span>&nbsp;<span class="ident" id="8411785"><a href="/go/printer/printer_test.go.html#8411315">bname</a></span><span class="op" id="8411790">,</span>&nbsp;<span class="ident" id="8411792"><a href="/go/printer/printer_test.go.html#8411570">line</a></span><span class="op" id="8411796">,</span>&nbsp;<span class="ident" id="8411798"><a href="/go/printer/printer_test.go.html#8411596">i</a></span><span class="op" id="8411799">-</span><span class="ident" id="8411800"><a href="/go/printer/printer_test.go.html#8411581">offs</a></span><span class="op" id="8411804">+</span><span class="num" id="8411805">1</span><span class="op" id="8411806">,</span>&nbsp;<span class="ident" id="8411808"><a href="/go/printer/printer_test.go.html#8411149">lineAt</a></span><span class="op" id="8411814">(</span><span class="ident" id="8411815"><a href="/go/printer/printer_test.go.html#8411332">b</a></span><span class="op" id="8411816">,</span>&nbsp;<span class="ident" id="8411818"><a href="/go/printer/printer_test.go.html#8411581">offs</a></span><span class="op" id="8411822">)</span><span class="op" id="8411823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411828"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8411831">.</span><span class="ident" id="8411832">Fprintf</span><span class="op" id="8411839">(</span><span class="op" id="8411840">&amp;</span><span class="ident" id="8411841"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411844">,</span>&nbsp;<span class="string" id="8411846">&#34;\n\n&#34;</span><span class="op" id="8411852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411857">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411869">if</span>&nbsp;<span class="ident" id="8411872"><a href="/go/printer/printer_test.go.html#8411638">ch</a></span>&nbsp;<span class="op" id="8411875">==</span>&nbsp;<span class="string" id="8411878">&#39;\n&#39;</span>&nbsp;<span class="op" id="8411883">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411888"><a href="/go/printer/printer_test.go.html#8411570">line</a></span><span class="op" id="8411892">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411898"><a href="/go/printer/printer_test.go.html#8411581">offs</a></span>&nbsp;<span class="op" id="8411903">=</span>&nbsp;<span class="ident" id="8411905"><a href="/go/printer/printer_test.go.html#8411596">i</a></span>&nbsp;<span class="op" id="8411907">+</span>&nbsp;<span class="num" id="8411909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411920">if</span>&nbsp;<span class="ident" id="8411923"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411926">.</span><span class="ident" id="8411927">Len</span><span class="op" id="8411930">(</span><span class="op" id="8411931">)</span>&nbsp;<span class="op" id="8411933">&gt;</span>&nbsp;<span class="num" id="8411935">0</span>&nbsp;<span class="op" id="8411937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411941">return</span>&nbsp;<span class="ident" id="8411948"><a href="/go/printer/printer_test.go.html#8409727">errors</a></span><span class="op" id="8411954">.</span><span class="ident" id="8411955">New</span><span class="op" id="8411958">(</span><span class="ident" id="8411959"><a href="/go/printer/printer_test.go.html#8411355">buf</a></span><span class="op" id="8411962">.</span><span class="ident" id="8411963">String</span><span class="op" id="8411969">(</span><span class="op" id="8411970">)</span><span class="op" id="8411971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411977">return</span>&nbsp;<span class="ident" id="8411984">nil</span><br>
<span class="lineno"></span><span class="op" id="8411988">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="8411991">func</span>&nbsp;<span class="ident" id="8411996">runcheck</span><span class="op" id="8412004">(</span><span class="ident" id="8412005">t</span>&nbsp;<span class="op" id="8412007">*</span><span class="ident" id="8412008"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8412015">.</span><span class="ident" id="8412016">T</span><span class="op" id="8412017">,</span>&nbsp;<span class="ident" id="8412019">source</span><span class="op" id="8412025">,</span>&nbsp;<span class="ident" id="8412027">golden</span>&nbsp;<span class="builtintype" id="8412034">string</span><span class="op" id="8412040">,</span>&nbsp;<span class="ident" id="8412042">mode</span>&nbsp;<span class="ident" id="8412047"><a href="/go/printer/printer_test.go.html#8409986">checkMode</a></span><span class="op" id="8412056">)</span>&nbsp;<span class="op" id="8412058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412061">src</span><span class="op" id="8412064">,</span>&nbsp;<span class="ident" id="8412066">err</span>&nbsp;<span class="op" id="8412070">:=</span>&nbsp;<span class="ident" id="8412073"><a href="/go/printer/printer_test.go.html#8409787">ioutil</a></span><span class="op" id="8412079">.</span><span class="ident" id="8412080">ReadFile</span><span class="op" id="8412088">(</span><span class="ident" id="8412089"><a href="/go/printer/printer_test.go.html#8412019">source</a></span><span class="op" id="8412095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412098">if</span>&nbsp;<span class="ident" id="8412101"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412105">!=</span>&nbsp;<span class="ident" id="8412108">nil</span>&nbsp;<span class="op" id="8412112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412116"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412117">.</span><span class="ident" id="8412118">Error</span><span class="op" id="8412123">(</span><span class="ident" id="8412124"><a href="/go/printer/printer_test.go.html#8412066">err</a></span><span class="op" id="8412127">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412131">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412143">res</span><span class="op" id="8412146">,</span>&nbsp;<span class="ident" id="8412148"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412152">:=</span>&nbsp;<span class="ident" id="8412155"><a href="/go/printer/printer_test.go.html#8410232">format</a></span><span class="op" id="8412161">(</span><span class="ident" id="8412162"><a href="/go/printer/printer_test.go.html#8412061">src</a></span><span class="op" id="8412165">,</span>&nbsp;<span class="ident" id="8412167"><a href="/go/printer/printer_test.go.html#8412042">mode</a></span><span class="op" id="8412171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412174">if</span>&nbsp;<span class="ident" id="8412177"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412181">!=</span>&nbsp;<span class="ident" id="8412184">nil</span>&nbsp;<span class="op" id="8412188">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412192"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412193">.</span><span class="ident" id="8412194">Error</span><span class="op" id="8412199">(</span><span class="ident" id="8412200"><a href="/go/printer/printer_test.go.html#8412066">err</a></span><span class="op" id="8412203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412207">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412219">//&nbsp;update&nbsp;golden&nbsp;files&nbsp;if&nbsp;necessary</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412256">if</span>&nbsp;<span class="op" id="8412259">*</span><span class="ident" id="8412260"><a href="/go/printer/printer_test.go.html#8409890">update</a></span>&nbsp;<span class="op" id="8412267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412271">if</span>&nbsp;<span class="ident" id="8412274">err</span>&nbsp;<span class="op" id="8412278">:=</span>&nbsp;<span class="ident" id="8412281"><a href="/go/printer/printer_test.go.html#8409787">ioutil</a></span><span class="op" id="8412287">.</span><span class="ident" id="8412288">WriteFile</span><span class="op" id="8412297">(</span><span class="ident" id="8412298"><a href="/go/printer/printer_test.go.html#8412027">golden</a></span><span class="op" id="8412304">,</span>&nbsp;<span class="ident" id="8412306"><a href="/go/printer/printer_test.go.html#8412143">res</a></span><span class="op" id="8412309">,</span>&nbsp;<span class="num" id="8412311">0644</span><span class="op" id="8412315">)</span><span class="op" id="8412316">;</span>&nbsp;<span class="ident" id="8412318"><a href="/go/printer/printer_test.go.html#8412274">err</a></span>&nbsp;<span class="op" id="8412322">!=</span>&nbsp;<span class="ident" id="8412325">nil</span>&nbsp;<span class="op" id="8412329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412334"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412335">.</span><span class="ident" id="8412336">Error</span><span class="op" id="8412341">(</span><span class="ident" id="8412342"><a href="/go/printer/printer_test.go.html#8412274">err</a></span><span class="op" id="8412345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412353">return</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412365">//&nbsp;get&nbsp;golden</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412380">gld</span><span class="op" id="8412383">,</span>&nbsp;<span class="ident" id="8412385"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412389">:=</span>&nbsp;<span class="ident" id="8412392"><a href="/go/printer/printer_test.go.html#8409787">ioutil</a></span><span class="op" id="8412398">.</span><span class="ident" id="8412399">ReadFile</span><span class="op" id="8412407">(</span><span class="ident" id="8412408"><a href="/go/printer/printer_test.go.html#8412027">golden</a></span><span class="op" id="8412414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412417">if</span>&nbsp;<span class="ident" id="8412420"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412424">!=</span>&nbsp;<span class="ident" id="8412427">nil</span>&nbsp;<span class="op" id="8412431">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412435"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412436">.</span><span class="ident" id="8412437">Error</span><span class="op" id="8412442">(</span><span class="ident" id="8412443"><a href="/go/printer/printer_test.go.html#8412066">err</a></span><span class="op" id="8412446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412450">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412462">//&nbsp;formatted&nbsp;source&nbsp;and&nbsp;golden&nbsp;must&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412511">if</span>&nbsp;<span class="ident" id="8412514">err</span>&nbsp;<span class="op" id="8412518">:=</span>&nbsp;<span class="ident" id="8412521"><a href="/go/printer/printer_test.go.html#8411303">diff</a></span><span class="op" id="8412525">(</span><span class="ident" id="8412526"><a href="/go/printer/printer_test.go.html#8412019">source</a></span><span class="op" id="8412532">,</span>&nbsp;<span class="ident" id="8412534"><a href="/go/printer/printer_test.go.html#8412027">golden</a></span><span class="op" id="8412540">,</span>&nbsp;<span class="ident" id="8412542"><a href="/go/printer/printer_test.go.html#8412143">res</a></span><span class="op" id="8412545">,</span>&nbsp;<span class="ident" id="8412547"><a href="/go/printer/printer_test.go.html#8412380">gld</a></span><span class="op" id="8412550">)</span><span class="op" id="8412551">;</span>&nbsp;<span class="ident" id="8412553"><a href="/go/printer/printer_test.go.html#8412514">err</a></span>&nbsp;<span class="op" id="8412557">!=</span>&nbsp;<span class="ident" id="8412560">nil</span>&nbsp;<span class="op" id="8412564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412568"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412569">.</span><span class="ident" id="8412570">Error</span><span class="op" id="8412575">(</span><span class="ident" id="8412576"><a href="/go/printer/printer_test.go.html#8412514">err</a></span><span class="op" id="8412579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412583">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412595">if</span>&nbsp;<span class="ident" id="8412598"><a href="/go/printer/printer_test.go.html#8412042">mode</a></span><span class="op" id="8412602">&amp;</span><span class="ident" id="8412603"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span>&nbsp;<span class="op" id="8412614">!=</span>&nbsp;<span class="num" id="8412617">0</span>&nbsp;<span class="op" id="8412619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412623">//&nbsp;formatting&nbsp;golden&nbsp;must&nbsp;be&nbsp;idempotent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412665">//&nbsp;(This&nbsp;is&nbsp;very&nbsp;difficult&nbsp;to&nbsp;achieve&nbsp;in&nbsp;general&nbsp;and&nbsp;for&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8412728">//&nbsp;it&nbsp;is&nbsp;only&nbsp;checked&nbsp;for&nbsp;files&nbsp;explicitly&nbsp;marked&nbsp;as&nbsp;such.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412790"><a href="/go/printer/printer_test.go.html#8412143">res</a></span><span class="op" id="8412793">,</span>&nbsp;<span class="ident" id="8412795"><a href="/go/printer/printer_test.go.html#8412066">err</a></span>&nbsp;<span class="op" id="8412799">=</span>&nbsp;<span class="ident" id="8412801"><a href="/go/printer/printer_test.go.html#8410232">format</a></span><span class="op" id="8412807">(</span><span class="ident" id="8412808"><a href="/go/printer/printer_test.go.html#8412380">gld</a></span><span class="op" id="8412811">,</span>&nbsp;<span class="ident" id="8412813"><a href="/go/printer/printer_test.go.html#8412042">mode</a></span><span class="op" id="8412817">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412821">if</span>&nbsp;<span class="ident" id="8412824">err</span>&nbsp;<span class="op" id="8412828">:=</span>&nbsp;<span class="ident" id="8412831"><a href="/go/printer/printer_test.go.html#8411303">diff</a></span><span class="op" id="8412835">(</span><span class="ident" id="8412836"><a href="/go/printer/printer_test.go.html#8412027">golden</a></span><span class="op" id="8412842">,</span>&nbsp;<span class="ident" id="8412844"><a href="/go/printer/printer_test.go.html#8409745">fmt</a></span><span class="op" id="8412847">.</span><span class="ident" id="8412848">Sprintf</span><span class="op" id="8412855">(</span><span class="string" id="8412856">&#34;format(%s)&#34;</span><span class="op" id="8412868">,</span>&nbsp;<span class="ident" id="8412870"><a href="/go/printer/printer_test.go.html#8412027">golden</a></span><span class="op" id="8412876">)</span><span class="op" id="8412877">,</span>&nbsp;<span class="ident" id="8412879"><a href="/go/printer/printer_test.go.html#8412380">gld</a></span><span class="op" id="8412882">,</span>&nbsp;<span class="ident" id="8412884"><a href="/go/printer/printer_test.go.html#8412143">res</a></span><span class="op" id="8412887">)</span><span class="op" id="8412888">;</span>&nbsp;<span class="ident" id="8412890"><a href="/go/printer/printer_test.go.html#8412824">err</a></span>&nbsp;<span class="op" id="8412894">!=</span>&nbsp;<span class="ident" id="8412897">nil</span>&nbsp;<span class="op" id="8412901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412906"><a href="/go/printer/printer_test.go.html#8412005">t</a></span><span class="op" id="8412907">.</span><span class="ident" id="8412908">Errorf</span><span class="op" id="8412914">(</span><span class="string" id="8412915">&#34;golden&nbsp;is&nbsp;not&nbsp;idempotent:&nbsp;%s&#34;</span><span class="op" id="8412945">,</span>&nbsp;<span class="ident" id="8412947"><a href="/go/printer/printer_test.go.html#8412824">err</a></span><span class="op" id="8412950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412957">}</span><br>
<span class="lineno"></span><span class="op" id="8412959">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="8412962">func</span>&nbsp;<span class="ident" id="8412967">check</span><span class="op" id="8412972">(</span><span class="ident" id="8412973">t</span>&nbsp;<span class="op" id="8412975">*</span><span class="ident" id="8412976"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8412983">.</span><span class="ident" id="8412984">T</span><span class="op" id="8412985">,</span>&nbsp;<span class="ident" id="8412987">source</span><span class="op" id="8412993">,</span>&nbsp;<span class="ident" id="8412995">golden</span>&nbsp;<span class="builtintype" id="8413002">string</span><span class="op" id="8413008">,</span>&nbsp;<span class="ident" id="8413010">mode</span>&nbsp;<span class="ident" id="8413015"><a href="/go/printer/printer_test.go.html#8409986">checkMode</a></span><span class="op" id="8413024">)</span>&nbsp;<span class="op" id="8413026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8413029">//&nbsp;run&nbsp;the&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413046">cc</span>&nbsp;<span class="op" id="8413049">:=</span>&nbsp;<span class="builtinfunc" id="8413052">make</span><span class="op" id="8413056">(</span><span class="keyword" id="8413057">chan</span>&nbsp;<span class="builtintype" id="8413062">int</span><span class="op" id="8413065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413068">go</span>&nbsp;<span class="keyword" id="8413071">func</span><span class="op" id="8413075">(</span><span class="op" id="8413076">)</span>&nbsp;<span class="op" id="8413078">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413082"><a href="/go/printer/printer_test.go.html#8411996">runcheck</a></span><span class="op" id="8413090">(</span><span class="ident" id="8413091"><a href="/go/printer/printer_test.go.html#8412973">t</a></span><span class="op" id="8413092">,</span>&nbsp;<span class="ident" id="8413094"><a href="/go/printer/printer_test.go.html#8412987">source</a></span><span class="op" id="8413100">,</span>&nbsp;<span class="ident" id="8413102"><a href="/go/printer/printer_test.go.html#8412995">golden</a></span><span class="op" id="8413108">,</span>&nbsp;<span class="ident" id="8413110"><a href="/go/printer/printer_test.go.html#8413010">mode</a></span><span class="op" id="8413114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413118"><a href="/go/printer/printer_test.go.html#8413046">cc</a></span>&nbsp;<span class="op" id="8413121">&lt;-</span>&nbsp;<span class="num" id="8413124">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413127">}</span><span class="op" id="8413128">(</span><span class="op" id="8413129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8413133">//&nbsp;wait&nbsp;with&nbsp;timeout</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413155">select</span>&nbsp;<span class="op" id="8413162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413165">case</span>&nbsp;<span class="op" id="8413170">&lt;-</span><span class="ident" id="8413172"><a href="/go/printer/printer_test.go.html#8409828">time</a></span><span class="op" id="8413176">.</span><span class="ident" id="8413177">After</span><span class="op" id="8413182">(</span><span class="num" id="8413183">10</span>&nbsp;<span class="op" id="8413186">*</span>&nbsp;<span class="ident" id="8413188"><a href="/go/printer/printer_test.go.html#8409828">time</a></span><span class="op" id="8413192">.</span><span class="ident" id="8413193">Second</span><span class="op" id="8413199">)</span><span class="op" id="8413200">:</span>&nbsp;<span class="comment" id="8413202">//&nbsp;plenty&nbsp;of&nbsp;a&nbsp;safety&nbsp;margin,&nbsp;even&nbsp;for&nbsp;very&nbsp;slow&nbsp;machines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8413262">//&nbsp;test&nbsp;running&nbsp;past&nbsp;time&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413294"><a href="/go/printer/printer_test.go.html#8412973">t</a></span><span class="op" id="8413295">.</span><span class="ident" id="8413296">Errorf</span><span class="op" id="8413302">(</span><span class="string" id="8413303">&#34;%s:&nbsp;running&nbsp;too&nbsp;slowly&#34;</span><span class="op" id="8413327">,</span>&nbsp;<span class="ident" id="8413329"><a href="/go/printer/printer_test.go.html#8412987">source</a></span><span class="op" id="8413335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413338">case</span>&nbsp;<span class="op" id="8413343">&lt;-</span><span class="ident" id="8413345"><a href="/go/printer/printer_test.go.html#8413046">cc</a></span><span class="op" id="8413347">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8413351">//&nbsp;test&nbsp;finished&nbsp;within&nbsp;allotted&nbsp;time&nbsp;margin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413397">}</span><br>
<span class="lineno"></span><span class="op" id="8413399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8413402">type</span>&nbsp;<span class="ident" id="8413407">entry</span>&nbsp;<span class="keyword" id="8413413">struct</span>&nbsp;<span class="op" id="8413420">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413423">source</span><span class="op" id="8413429">,</span>&nbsp;<span class="ident" id="8413431">golden</span>&nbsp;<span class="builtintype" id="8413438">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413446">mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8413461"><a href="/go/printer/printer_test.go.html#8409986">checkMode</a></span><br>
<span class="lineno"></span><span class="op" id="8413471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8413474">//&nbsp;Use&nbsp;go&nbsp;test&nbsp;-update&nbsp;to&nbsp;create/update&nbsp;the&nbsp;respective&nbsp;golden&nbsp;files.</span><br>
<span class="lineno">185</span><span class="keyword" id="8413543">var</span>&nbsp;<span class="ident" id="8413547">data</span>&nbsp;<span class="op" id="8413552">=</span>&nbsp;<span class="op" id="8413554">[</span><span class="op" id="8413555">]</span><span class="ident" id="8413556"><a href="/go/printer/printer_test.go.html#8413407">entry</a></span><span class="op" id="8413561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413564">{</span><span class="string" id="8413565">&#34;empty.input&#34;</span><span class="op" id="8413578">,</span>&nbsp;<span class="string" id="8413580">&#34;empty.golden&#34;</span><span class="op" id="8413594">,</span>&nbsp;<span class="ident" id="8413596"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8413606">}</span><span class="op" id="8413607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413610">{</span><span class="string" id="8413611">&#34;comments.input&#34;</span><span class="op" id="8413627">,</span>&nbsp;<span class="string" id="8413629">&#34;comments.golden&#34;</span><span class="op" id="8413646">,</span>&nbsp;<span class="num" id="8413648">0</span><span class="op" id="8413649">}</span><span class="op" id="8413650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413653">{</span><span class="string" id="8413654">&#34;comments.input&#34;</span><span class="op" id="8413670">,</span>&nbsp;<span class="string" id="8413672">&#34;comments.x&#34;</span><span class="op" id="8413684">,</span>&nbsp;<span class="ident" id="8413686"><a href="/go/printer/printer_test.go.html#8410011">export</a></span><span class="op" id="8413692">}</span><span class="op" id="8413693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413696">{</span><span class="string" id="8413697">&#34;comments2.input&#34;</span><span class="op" id="8413714">,</span>&nbsp;<span class="string" id="8413716">&#34;comments2.golden&#34;</span><span class="op" id="8413734">,</span>&nbsp;<span class="ident" id="8413736"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8413746">}</span><span class="op" id="8413747">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413750">{</span><span class="string" id="8413751">&#34;linebreaks.input&#34;</span><span class="op" id="8413769">,</span>&nbsp;<span class="string" id="8413771">&#34;linebreaks.golden&#34;</span><span class="op" id="8413790">,</span>&nbsp;<span class="ident" id="8413792"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8413802">}</span><span class="op" id="8413803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413806">{</span><span class="string" id="8413807">&#34;expressions.input&#34;</span><span class="op" id="8413826">,</span>&nbsp;<span class="string" id="8413828">&#34;expressions.golden&#34;</span><span class="op" id="8413848">,</span>&nbsp;<span class="ident" id="8413850"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8413860">}</span><span class="op" id="8413861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413864">{</span><span class="string" id="8413865">&#34;expressions.input&#34;</span><span class="op" id="8413884">,</span>&nbsp;<span class="string" id="8413886">&#34;expressions.raw&#34;</span><span class="op" id="8413903">,</span>&nbsp;<span class="ident" id="8413905"><a href="/go/printer/printer_test.go.html#8410041">rawFormat</a></span>&nbsp;<span class="op" id="8413915">|</span>&nbsp;<span class="ident" id="8413917"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8413927">}</span><span class="op" id="8413928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413931">{</span><span class="string" id="8413932">&#34;declarations.input&#34;</span><span class="op" id="8413952">,</span>&nbsp;<span class="string" id="8413954">&#34;declarations.golden&#34;</span><span class="op" id="8413975">,</span>&nbsp;<span class="num" id="8413977">0</span><span class="op" id="8413978">}</span><span class="op" id="8413979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413982">{</span><span class="string" id="8413983">&#34;statements.input&#34;</span><span class="op" id="8414001">,</span>&nbsp;<span class="string" id="8414003">&#34;statements.golden&#34;</span><span class="op" id="8414022">,</span>&nbsp;<span class="num" id="8414024">0</span><span class="op" id="8414025">}</span><span class="op" id="8414026">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414029">{</span><span class="string" id="8414030">&#34;slow.input&#34;</span><span class="op" id="8414042">,</span>&nbsp;<span class="string" id="8414044">&#34;slow.golden&#34;</span><span class="op" id="8414057">,</span>&nbsp;<span class="ident" id="8414059"><a href="/go/printer/printer_test.go.html#8410052">idempotent</a></span><span class="op" id="8414069">}</span><span class="op" id="8414070">,</span><br>
<span class="lineno"></span><span class="op" id="8414072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8414075">func</span>&nbsp;<span class="ident" id="8414080">TestFiles</span><span class="op" id="8414089">(</span><span class="ident" id="8414090">t</span>&nbsp;<span class="op" id="8414092">*</span><span class="ident" id="8414093"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8414100">.</span><span class="ident" id="8414101">T</span><span class="op" id="8414102">)</span>&nbsp;<span class="op" id="8414104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414107">for</span>&nbsp;<span class="ident" id="8414111">_</span><span class="op" id="8414112">,</span>&nbsp;<span class="ident" id="8414114">e</span>&nbsp;<span class="op" id="8414116">:=</span>&nbsp;<span class="keyword" id="8414119">range</span>&nbsp;<span class="ident" id="8414125"><a href="/go/printer/printer_test.go.html#8413547">data</a></span>&nbsp;<span class="op" id="8414130">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414134">source</span>&nbsp;<span class="op" id="8414141">:=</span>&nbsp;<span class="ident" id="8414144"><a href="/go/printer/printer_test.go.html#8409800">filepath</a></span><span class="op" id="8414152">.</span><span class="ident" id="8414153">Join</span><span class="op" id="8414157">(</span><span class="ident" id="8414158"><a href="/go/printer/printer_test.go.html#8409847">dataDir</a></span><span class="op" id="8414165">,</span>&nbsp;<span class="ident" id="8414167"><a href="/go/printer/printer_test.go.html#8414114">e</a></span><span class="op" id="8414168">.</span><span class="ident" id="8414169">source</span><span class="op" id="8414175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414179">golden</span>&nbsp;<span class="op" id="8414186">:=</span>&nbsp;<span class="ident" id="8414189"><a href="/go/printer/printer_test.go.html#8409800">filepath</a></span><span class="op" id="8414197">.</span><span class="ident" id="8414198">Join</span><span class="op" id="8414202">(</span><span class="ident" id="8414203"><a href="/go/printer/printer_test.go.html#8409847">dataDir</a></span><span class="op" id="8414210">,</span>&nbsp;<span class="ident" id="8414212"><a href="/go/printer/printer_test.go.html#8414114">e</a></span><span class="op" id="8414213">.</span><span class="ident" id="8414214">golden</span><span class="op" id="8414220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414224"><a href="/go/printer/printer_test.go.html#8412967">check</a></span><span class="op" id="8414229">(</span><span class="ident" id="8414230"><a href="/go/printer/printer_test.go.html#8414090">t</a></span><span class="op" id="8414231">,</span>&nbsp;<span class="ident" id="8414233"><a href="/go/printer/printer_test.go.html#8414134">source</a></span><span class="op" id="8414239">,</span>&nbsp;<span class="ident" id="8414241"><a href="/go/printer/printer_test.go.html#8414179">golden</a></span><span class="op" id="8414247">,</span>&nbsp;<span class="ident" id="8414249"><a href="/go/printer/printer_test.go.html#8414114">e</a></span><span class="op" id="8414250">.</span><span class="ident" id="8414251">mode</span><span class="op" id="8414255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8414259">//&nbsp;TODO(gri)&nbsp;check&nbsp;that&nbsp;golden&nbsp;is&nbsp;idempotent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8414306">//check(t,&nbsp;golden,&nbsp;golden,&nbsp;e.mode)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414342">}</span><br>
<span class="lineno"></span><span class="op" id="8414344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8414347">//&nbsp;TestLineComments,&nbsp;using&nbsp;a&nbsp;simple&nbsp;test&nbsp;case,&nbsp;checks&nbsp;that&nbsp;consecutive&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="8414423">//&nbsp;comments&nbsp;are&nbsp;properly&nbsp;terminated&nbsp;with&nbsp;a&nbsp;newline&nbsp;even&nbsp;if&nbsp;the&nbsp;AST&nbsp;position</span><br>
<span class="lineno">210</span><span class="comment" id="8414499">//&nbsp;information&nbsp;is&nbsp;incorrect.</span><br>
<span class="lineno"></span><span class="comment" id="8414528">//</span><br>
<span class="lineno"></span><span class="keyword" id="8414531">func</span>&nbsp;<span class="ident" id="8414536">TestLineComments</span><span class="op" id="8414552">(</span><span class="ident" id="8414553">t</span>&nbsp;<span class="op" id="8414555">*</span><span class="ident" id="8414556"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8414563">.</span><span class="ident" id="8414564">T</span><span class="op" id="8414565">)</span>&nbsp;<span class="op" id="8414567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414570">const</span>&nbsp;<span class="ident" id="8414576">src</span>&nbsp;<span class="op" id="8414580">=</span>&nbsp;<span class="string" id="8414582">`//&nbsp;comment&nbsp;1<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment&nbsp;2<br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment&nbsp;3<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsppackage&nbsp;main<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414643">fset</span>&nbsp;<span class="op" id="8414648">:=</span>&nbsp;<span class="ident" id="8414651"><a href="/go/printer/printer_test.go.html#8409775">token</a></span><span class="op" id="8414656">.</span><span class="ident" id="8414657">NewFileSet</span><span class="op" id="8414667">(</span><span class="op" id="8414668">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414671">f</span><span class="op" id="8414672">,</span>&nbsp;<span class="ident" id="8414674">err</span>&nbsp;<span class="op" id="8414678">:=</span>&nbsp;<span class="ident" id="8414681"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8414687">.</span><span class="ident" id="8414688">ParseFile</span><span class="op" id="8414697">(</span><span class="ident" id="8414698"><a href="/go/printer/printer_test.go.html#8414643">fset</a></span><span class="op" id="8414702">,</span>&nbsp;<span class="string" id="8414704">&#34;&#34;</span><span class="op" id="8414706">,</span>&nbsp;<span class="ident" id="8414708"><a href="/go/printer/printer_test.go.html#8414576">src</a></span><span class="op" id="8414711">,</span>&nbsp;<span class="ident" id="8414713"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8414719">.</span><span class="ident" id="8414720">ParseComments</span><span class="op" id="8414733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414736">if</span>&nbsp;<span class="ident" id="8414739"><a href="/go/printer/printer_test.go.html#8414674">err</a></span>&nbsp;<span class="op" id="8414743">!=</span>&nbsp;<span class="ident" id="8414746">nil</span>&nbsp;<span class="op" id="8414750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8414754">panic</span><span class="op" id="8414759">(</span><span class="ident" id="8414760"><a href="/go/printer/printer_test.go.html#8414674">err</a></span><span class="op" id="8414763">)</span>&nbsp;<span class="comment" id="8414765">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414787">var</span>&nbsp;<span class="ident" id="8414791">buf</span>&nbsp;<span class="ident" id="8414795"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8414800">.</span><span class="ident" id="8414801">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414809"><a href="/go/printer/printer_test.go.html#8414643">fset</a></span>&nbsp;<span class="op" id="8414814">=</span>&nbsp;<span class="ident" id="8414816"><a href="/go/printer/printer_test.go.html#8409775">token</a></span><span class="op" id="8414821">.</span><span class="ident" id="8414822">NewFileSet</span><span class="op" id="8414832">(</span><span class="op" id="8414833">)</span>&nbsp;<span class="comment" id="8414835">//&nbsp;use&nbsp;the&nbsp;wrong&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414862"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8414868">(</span><span class="op" id="8414869">&amp;</span><span class="ident" id="8414870"><a href="/go/printer/printer_test.go.html#8414791">buf</a></span><span class="op" id="8414873">,</span>&nbsp;<span class="ident" id="8414875"><a href="/go/printer/printer_test.go.html#8414643">fset</a></span><span class="op" id="8414879">,</span>&nbsp;<span class="ident" id="8414881"><a href="/go/printer/printer_test.go.html#8414671">f</a></span><span class="op" id="8414882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414886">nlines</span>&nbsp;<span class="op" id="8414893">:=</span>&nbsp;<span class="num" id="8414896">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414899">for</span>&nbsp;<span class="ident" id="8414903">_</span><span class="op" id="8414904">,</span>&nbsp;<span class="ident" id="8414906">ch</span>&nbsp;<span class="op" id="8414909">:=</span>&nbsp;<span class="keyword" id="8414912">range</span>&nbsp;<span class="ident" id="8414918"><a href="/go/printer/printer_test.go.html#8414791">buf</a></span><span class="op" id="8414921">.</span><span class="ident" id="8414922">Bytes</span><span class="op" id="8414927">(</span><span class="op" id="8414928">)</span>&nbsp;<span class="op" id="8414930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414934">if</span>&nbsp;<span class="ident" id="8414937"><a href="/go/printer/printer_test.go.html#8414906">ch</a></span>&nbsp;<span class="op" id="8414940">==</span>&nbsp;<span class="string" id="8414943">&#39;\n&#39;</span>&nbsp;<span class="op" id="8414948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414953"><a href="/go/printer/printer_test.go.html#8414886">nlines</a></span><span class="op" id="8414959">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414967">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414971">const</span>&nbsp;<span class="ident" id="8414977">expected</span>&nbsp;<span class="op" id="8414986">=</span>&nbsp;<span class="num" id="8414988">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414991">if</span>&nbsp;<span class="ident" id="8414994"><a href="/go/printer/printer_test.go.html#8414886">nlines</a></span>&nbsp;<span class="op" id="8415001">&lt;</span>&nbsp;<span class="ident" id="8415003"><a href="/go/printer/printer_test.go.html#8414977">expected</a></span>&nbsp;<span class="op" id="8415012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415016"><a href="/go/printer/printer_test.go.html#8414553">t</a></span><span class="op" id="8415017">.</span><span class="ident" id="8415018">Errorf</span><span class="op" id="8415024">(</span><span class="string" id="8415025">&#34;got&nbsp;%d,&nbsp;expected&nbsp;%d\n&#34;</span><span class="op" id="8415048">,</span>&nbsp;<span class="ident" id="8415050"><a href="/go/printer/printer_test.go.html#8414886">nlines</a></span><span class="op" id="8415056">,</span>&nbsp;<span class="ident" id="8415058"><a href="/go/printer/printer_test.go.html#8414977">expected</a></span><span class="op" id="8415066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415070"><a href="/go/printer/printer_test.go.html#8414553">t</a></span><span class="op" id="8415071">.</span><span class="ident" id="8415072">Errorf</span><span class="op" id="8415078">(</span><span class="string" id="8415079">&#34;result:\n%s&#34;</span><span class="op" id="8415092">,</span>&nbsp;<span class="ident" id="8415094"><a href="/go/printer/printer_test.go.html#8414791">buf</a></span><span class="op" id="8415097">.</span><span class="ident" id="8415098">Bytes</span><span class="op" id="8415103">(</span><span class="op" id="8415104">)</span><span class="op" id="8415105">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415108">}</span><br>
<span class="lineno"></span><span class="op" id="8415110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8415113">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;can&nbsp;be&nbsp;invoked&nbsp;during&nbsp;initialization.</span><br>
<span class="lineno"></span><span class="keyword" id="8415178">func</span>&nbsp;<span class="ident" id="8415183">init</span><span class="op" id="8415187">(</span><span class="op" id="8415188">)</span>&nbsp;<span class="op" id="8415190">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415193">const</span>&nbsp;<span class="ident" id="8415199">name</span>&nbsp;<span class="op" id="8415204">=</span>&nbsp;<span class="string" id="8415206">&#34;foobar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415216">var</span>&nbsp;<span class="ident" id="8415220">buf</span>&nbsp;<span class="ident" id="8415224"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8415229">.</span><span class="ident" id="8415230">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415238">if</span>&nbsp;<span class="ident" id="8415241">err</span>&nbsp;<span class="op" id="8415245">:=</span>&nbsp;<span class="ident" id="8415248"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8415254">(</span><span class="op" id="8415255">&amp;</span><span class="ident" id="8415256"><a href="/go/printer/printer_test.go.html#8415220">buf</a></span><span class="op" id="8415259">,</span>&nbsp;<span class="ident" id="8415261"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8415265">,</span>&nbsp;<span class="op" id="8415267">&amp;</span><span class="ident" id="8415268"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8415271">.</span><span class="ident" id="8415272">Ident</span><span class="op" id="8415277">{</span><span class="ident" id="8415278">Name</span><span class="op" id="8415282">:</span>&nbsp;<span class="ident" id="8415284"><a href="/go/printer/printer_test.go.html#8415199">name</a></span><span class="op" id="8415288">}</span><span class="op" id="8415289">)</span><span class="op" id="8415290">;</span>&nbsp;<span class="ident" id="8415292"><a href="/go/printer/printer_test.go.html#8415241">err</a></span>&nbsp;<span class="op" id="8415296">!=</span>&nbsp;<span class="ident" id="8415299">nil</span>&nbsp;<span class="op" id="8415303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8415307">panic</span><span class="op" id="8415312">(</span><span class="ident" id="8415313"><a href="/go/printer/printer_test.go.html#8415241">err</a></span><span class="op" id="8415316">)</span>&nbsp;<span class="comment" id="8415318">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415336">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8415339">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;the&nbsp;result&nbsp;contains&nbsp;additional&nbsp;information;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8415402">//&nbsp;ignore&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415416">if</span>&nbsp;<span class="ident" id="8415419">s</span>&nbsp;<span class="op" id="8415421">:=</span>&nbsp;<span class="ident" id="8415424"><a href="/go/printer/printer_test.go.html#8415220">buf</a></span><span class="op" id="8415427">.</span><span class="ident" id="8415428">String</span><span class="op" id="8415434">(</span><span class="op" id="8415435">)</span><span class="op" id="8415436">;</span>&nbsp;<span class="op" id="8415438">!</span><span class="ident" id="8415439"><a href="/go/printer/printer.go.html#6178937">debug</a></span>&nbsp;<span class="op" id="8415445">&amp;&amp;</span>&nbsp;<span class="ident" id="8415448"><a href="/go/printer/printer_test.go.html#8415419">s</a></span>&nbsp;<span class="op" id="8415450">!=</span>&nbsp;<span class="ident" id="8415453"><a href="/go/printer/printer_test.go.html#8415199">name</a></span>&nbsp;<span class="op" id="8415458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8415462">panic</span><span class="op" id="8415467">(</span><span class="string" id="8415468">&#34;got&nbsp;&#34;</span>&nbsp;<span class="op" id="8415475">+</span>&nbsp;<span class="ident" id="8415477"><a href="/go/printer/printer_test.go.html#8415419">s</a></span>&nbsp;<span class="op" id="8415479">+</span>&nbsp;<span class="string" id="8415481">&#34;,&nbsp;want&nbsp;&#34;</span>&nbsp;<span class="op" id="8415491">+</span>&nbsp;<span class="ident" id="8415493"><a href="/go/printer/printer_test.go.html#8415199">name</a></span><span class="op" id="8415497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415500">}</span><br>
<span class="lineno">255</span><span class="op" id="8415502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8415505">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;doesn&#39;t&nbsp;crash&nbsp;if&nbsp;the&nbsp;AST&nbsp;contains&nbsp;BadXXX&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="8415580">func</span>&nbsp;<span class="ident" id="8415585">TestBadNodes</span><span class="op" id="8415597">(</span><span class="ident" id="8415598">t</span>&nbsp;<span class="op" id="8415600">*</span><span class="ident" id="8415601"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8415608">.</span><span class="ident" id="8415609">T</span><span class="op" id="8415610">)</span>&nbsp;<span class="op" id="8415612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415615">const</span>&nbsp;<span class="ident" id="8415621">src</span>&nbsp;<span class="op" id="8415625">=</span>&nbsp;<span class="string" id="8415627">&#34;package&nbsp;p\n(&#34;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415643">const</span>&nbsp;<span class="ident" id="8415649">res</span>&nbsp;<span class="op" id="8415653">=</span>&nbsp;<span class="string" id="8415655">&#34;package&nbsp;p\nBadDecl\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415679">f</span><span class="op" id="8415680">,</span>&nbsp;<span class="ident" id="8415682">err</span>&nbsp;<span class="op" id="8415686">:=</span>&nbsp;<span class="ident" id="8415689"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8415695">.</span><span class="ident" id="8415696">ParseFile</span><span class="op" id="8415705">(</span><span class="ident" id="8415706"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8415710">,</span>&nbsp;<span class="string" id="8415712">&#34;&#34;</span><span class="op" id="8415714">,</span>&nbsp;<span class="ident" id="8415716"><a href="/go/printer/printer_test.go.html#8415621">src</a></span><span class="op" id="8415719">,</span>&nbsp;<span class="ident" id="8415721"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8415727">.</span><span class="ident" id="8415728">ParseComments</span><span class="op" id="8415741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415744">if</span>&nbsp;<span class="ident" id="8415747"><a href="/go/printer/printer_test.go.html#8415682">err</a></span>&nbsp;<span class="op" id="8415751">==</span>&nbsp;<span class="ident" id="8415754">nil</span>&nbsp;<span class="op" id="8415758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415762"><a href="/go/printer/printer_test.go.html#8415598">t</a></span><span class="op" id="8415763">.</span><span class="ident" id="8415764">Error</span><span class="op" id="8415769">(</span><span class="string" id="8415770">&#34;expected&nbsp;illegal&nbsp;program&#34;</span><span class="op" id="8415796">)</span>&nbsp;<span class="comment" id="8415798">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415816">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415819">var</span>&nbsp;<span class="ident" id="8415823">buf</span>&nbsp;<span class="ident" id="8415827"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8415832">.</span><span class="ident" id="8415833">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415841"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8415847">(</span><span class="op" id="8415848">&amp;</span><span class="ident" id="8415849"><a href="/go/printer/printer_test.go.html#8415823">buf</a></span><span class="op" id="8415852">,</span>&nbsp;<span class="ident" id="8415854"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8415858">,</span>&nbsp;<span class="ident" id="8415860"><a href="/go/printer/printer_test.go.html#8415679">f</a></span><span class="op" id="8415861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415864">if</span>&nbsp;<span class="ident" id="8415867"><a href="/go/printer/printer_test.go.html#8415823">buf</a></span><span class="op" id="8415870">.</span><span class="ident" id="8415871">String</span><span class="op" id="8415877">(</span><span class="op" id="8415878">)</span>&nbsp;<span class="op" id="8415880">!=</span>&nbsp;<span class="ident" id="8415883"><a href="/go/printer/printer_test.go.html#8415649">res</a></span>&nbsp;<span class="op" id="8415887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415891"><a href="/go/printer/printer_test.go.html#8415598">t</a></span><span class="op" id="8415892">.</span><span class="ident" id="8415893">Errorf</span><span class="op" id="8415899">(</span><span class="string" id="8415900">&#34;got&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8415921">,</span>&nbsp;<span class="ident" id="8415923"><a href="/go/printer/printer_test.go.html#8415823">buf</a></span><span class="op" id="8415926">.</span><span class="ident" id="8415927">String</span><span class="op" id="8415933">(</span><span class="op" id="8415934">)</span><span class="op" id="8415935">,</span>&nbsp;<span class="ident" id="8415937"><a href="/go/printer/printer_test.go.html#8415649">res</a></span><span class="op" id="8415940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415943">}</span><br>
<span class="lineno">270</span><span class="op" id="8415945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8415948">//&nbsp;testComment&nbsp;verifies&nbsp;that&nbsp;f&nbsp;can&nbsp;be&nbsp;parsed&nbsp;again&nbsp;after&nbsp;printing&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="8416017">//&nbsp;with&nbsp;its&nbsp;first&nbsp;comment&nbsp;set&nbsp;to&nbsp;comment&nbsp;at&nbsp;any&nbsp;possible&nbsp;source&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="8416089">func</span>&nbsp;<span class="ident" id="8416094">testComment</span><span class="op" id="8416105">(</span><span class="ident" id="8416106">t</span>&nbsp;<span class="op" id="8416108">*</span><span class="ident" id="8416109"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8416116">.</span><span class="ident" id="8416117">T</span><span class="op" id="8416118">,</span>&nbsp;<span class="ident" id="8416120">f</span>&nbsp;<span class="op" id="8416122">*</span><span class="ident" id="8416123"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8416126">.</span><span class="ident" id="8416127">File</span><span class="op" id="8416131">,</span>&nbsp;<span class="ident" id="8416133">srclen</span>&nbsp;<span class="builtintype" id="8416140">int</span><span class="op" id="8416143">,</span>&nbsp;<span class="ident" id="8416145">comment</span>&nbsp;<span class="op" id="8416153">*</span><span class="ident" id="8416154"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8416157">.</span><span class="ident" id="8416158">Comment</span><span class="op" id="8416165">)</span>&nbsp;<span class="op" id="8416167">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8416170"><a href="/go/printer/printer_test.go.html#8416120">f</a></span><span class="op" id="8416171">.</span><span class="ident" id="8416172">Comments</span><span class="op" id="8416180">[</span><span class="num" id="8416181">0</span><span class="op" id="8416182">]</span><span class="op" id="8416183">.</span><span class="ident" id="8416184">List</span><span class="op" id="8416188">[</span><span class="num" id="8416189">0</span><span class="op" id="8416190">]</span>&nbsp;<span class="op" id="8416192">=</span>&nbsp;<span class="ident" id="8416194"><a href="/go/printer/printer_test.go.html#8416145">comment</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8416203">var</span>&nbsp;<span class="ident" id="8416207">buf</span>&nbsp;<span class="ident" id="8416211"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8416216">.</span><span class="ident" id="8416217">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8416225">for</span>&nbsp;<span class="ident" id="8416229">offs</span>&nbsp;<span class="op" id="8416234">:=</span>&nbsp;<span class="num" id="8416237">0</span><span class="op" id="8416238">;</span>&nbsp;<span class="ident" id="8416240"><a href="/go/printer/printer_test.go.html#8416229">offs</a></span>&nbsp;<span class="op" id="8416245">&lt;=</span>&nbsp;<span class="ident" id="8416248"><a href="/go/printer/printer_test.go.html#8416133">srclen</a></span><span class="op" id="8416254">;</span>&nbsp;<span class="ident" id="8416256"><a href="/go/printer/printer_test.go.html#8416229">offs</a></span><span class="op" id="8416260">++</span>&nbsp;<span class="op" id="8416263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8416267"><a href="/go/printer/printer_test.go.html#8416207">buf</a></span><span class="op" id="8416270">.</span><span class="ident" id="8416271">Reset</span><span class="op" id="8416276">(</span><span class="op" id="8416277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8416281">//&nbsp;Printing&nbsp;f&nbsp;should&nbsp;result&nbsp;in&nbsp;a&nbsp;correct&nbsp;program&nbsp;no</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8416335">//&nbsp;matter&nbsp;what&nbsp;the&nbsp;(incorrect)&nbsp;comment&nbsp;position&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8416389">if</span>&nbsp;<span class="ident" id="8416392">err</span>&nbsp;<span class="op" id="8416396">:=</span>&nbsp;<span class="ident" id="8416399"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8416405">(</span><span class="op" id="8416406">&amp;</span><span class="ident" id="8416407"><a href="/go/printer/printer_test.go.html#8416207">buf</a></span><span class="op" id="8416410">,</span>&nbsp;<span class="ident" id="8416412"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8416416">,</span>&nbsp;<span class="ident" id="8416418"><a href="/go/printer/printer_test.go.html#8416120">f</a></span><span class="op" id="8416419">)</span><span class="op" id="8416420">;</span>&nbsp;<span class="ident" id="8416422"><a href="/go/printer/printer_test.go.html#8416392">err</a></span>&nbsp;<span class="op" id="8416426">!=</span>&nbsp;<span class="ident" id="8416429">nil</span>&nbsp;<span class="op" id="8416433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8416438"><a href="/go/printer/printer_test.go.html#8416106">t</a></span><span class="op" id="8416439">.</span><span class="ident" id="8416440">Error</span><span class="op" id="8416445">(</span><span class="ident" id="8416446"><a href="/go/printer/printer_test.go.html#8416392">err</a></span><span class="op" id="8416449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8416453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8416457">if</span>&nbsp;<span class="ident" id="8416460">_</span><span class="op" id="8416461">,</span>&nbsp;<span class="ident" id="8416463">err</span>&nbsp;<span class="op" id="8416467">:=</span>&nbsp;<span class="ident" id="8416470"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8416476">.</span><span class="ident" id="8416477">ParseFile</span><span class="op" id="8416486">(</span><span class="ident" id="8416487"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8416491">,</span>&nbsp;<span class="string" id="8416493">&#34;&#34;</span><span class="op" id="8416495">,</span>&nbsp;<span class="ident" id="8416497"><a href="/go/printer/printer_test.go.html#8416207">buf</a></span><span class="op" id="8416500">.</span><span class="ident" id="8416501">Bytes</span><span class="op" id="8416506">(</span><span class="op" id="8416507">)</span><span class="op" id="8416508">,</span>&nbsp;<span class="num" id="8416510">0</span><span class="op" id="8416511">)</span><span class="op" id="8416512">;</span>&nbsp;<span class="ident" id="8416514"><a href="/go/printer/printer_test.go.html#8416463">err</a></span>&nbsp;<span class="op" id="8416518">!=</span>&nbsp;<span class="ident" id="8416521">nil</span>&nbsp;<span class="op" id="8416525">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8416530"><a href="/go/printer/printer_test.go.html#8416106">t</a></span><span class="op" id="8416531">.</span><span class="ident" id="8416532">Fatalf</span><span class="op" id="8416538">(</span><span class="string" id="8416539">&#34;incorrect&nbsp;program&nbsp;for&nbsp;pos&nbsp;=&nbsp;%d:\n%s&#34;</span><span class="op" id="8416576">,</span>&nbsp;<span class="ident" id="8416578"><a href="/go/printer/printer_test.go.html#8416145">comment</a></span><span class="op" id="8416585">.</span><span class="ident" id="8416586">Slash</span><span class="op" id="8416591">,</span>&nbsp;<span class="ident" id="8416593"><a href="/go/printer/printer_test.go.html#8416207">buf</a></span><span class="op" id="8416596">.</span><span class="ident" id="8416597">String</span><span class="op" id="8416603">(</span><span class="op" id="8416604">)</span><span class="op" id="8416605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8416609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8416613">//&nbsp;Position&nbsp;information&nbsp;is&nbsp;just&nbsp;an&nbsp;offset.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8416658">//&nbsp;Move&nbsp;comment&nbsp;one&nbsp;byte&nbsp;down&nbsp;in&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8416705"><a href="/go/printer/printer_test.go.html#8416145">comment</a></span><span class="op" id="8416712">.</span><span class="ident" id="8416713">Slash</span><span class="op" id="8416718">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8416722">}</span><br>
<span class="lineno"></span><span class="op" id="8416724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8416727">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;produces&nbsp;a&nbsp;correct&nbsp;program</span><br>
<span class="lineno"></span><span class="comment" id="8416781">//&nbsp;even&nbsp;if&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;comments&nbsp;introducing&nbsp;newlines</span><br>
<span class="lineno">295</span><span class="comment" id="8416850">//&nbsp;is&nbsp;incorrect.</span><br>
<span class="lineno"></span><span class="keyword" id="8416867">func</span>&nbsp;<span class="ident" id="8416872">TestBadComments</span><span class="op" id="8416887">(</span><span class="ident" id="8416888">t</span>&nbsp;<span class="op" id="8416890">*</span><span class="ident" id="8416891"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8416898">.</span><span class="ident" id="8416899">T</span><span class="op" id="8416900">)</span>&nbsp;<span class="op" id="8416902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8416905">const</span>&nbsp;<span class="ident" id="8416911">src</span>&nbsp;<span class="op" id="8416915">=</span>&nbsp;<span class="string" id="8416917">`<br>
<span class="lineno"></span>//&nbsp;first&nbsp;comment&nbsp;-&nbsp;text&nbsp;and&nbsp;position&nbsp;changed&nbsp;by&nbsp;test<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno">300</span>import&nbsp;&#34;fmt&#34;<br>
<span class="lineno"></span>const&nbsp;pi&nbsp;=&nbsp;3.14&nbsp;//&nbsp;rough&nbsp;circle<br>
<span class="lineno"></span>var&nbsp;(<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspx,&nbsp;y,&nbsp;z&nbsp;int&nbsp;=&nbsp;1,&nbsp;2,&nbsp;3<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspu,&nbsp;v&nbsp;float64<br>
<span class="lineno">305</span>)<br>
<span class="lineno"></span>func&nbsp;fibo(n&nbsp;int)&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;n&nbsp;&lt;&nbsp;2&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;n&nbsp;/*&nbsp;seed&nbsp;values&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;fibo(n-1)&nbsp;+&nbsp;fibo(n-2)<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417171">f</span><span class="op" id="8417172">,</span>&nbsp;<span class="ident" id="8417174">err</span>&nbsp;<span class="op" id="8417178">:=</span>&nbsp;<span class="ident" id="8417181"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8417187">.</span><span class="ident" id="8417188">ParseFile</span><span class="op" id="8417197">(</span><span class="ident" id="8417198"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8417202">,</span>&nbsp;<span class="string" id="8417204">&#34;&#34;</span><span class="op" id="8417206">,</span>&nbsp;<span class="ident" id="8417208"><a href="/go/printer/printer_test.go.html#8416911">src</a></span><span class="op" id="8417211">,</span>&nbsp;<span class="ident" id="8417213"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8417219">.</span><span class="ident" id="8417220">ParseComments</span><span class="op" id="8417233">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417236">if</span>&nbsp;<span class="ident" id="8417239"><a href="/go/printer/printer_test.go.html#8417174">err</a></span>&nbsp;<span class="op" id="8417243">!=</span>&nbsp;<span class="ident" id="8417246">nil</span>&nbsp;<span class="op" id="8417250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417254"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417255">.</span><span class="ident" id="8417256">Error</span><span class="op" id="8417261">(</span><span class="ident" id="8417262"><a href="/go/printer/printer_test.go.html#8417174">err</a></span><span class="op" id="8417265">)</span>&nbsp;<span class="comment" id="8417267">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417289">comment</span>&nbsp;<span class="op" id="8417297">:=</span>&nbsp;<span class="ident" id="8417300"><a href="/go/printer/printer_test.go.html#8417171">f</a></span><span class="op" id="8417301">.</span><span class="ident" id="8417302">Comments</span><span class="op" id="8417310">[</span><span class="num" id="8417311">0</span><span class="op" id="8417312">]</span><span class="op" id="8417313">.</span><span class="ident" id="8417314">List</span><span class="op" id="8417318">[</span><span class="num" id="8417319">0</span><span class="op" id="8417320">]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417323">pos</span>&nbsp;<span class="op" id="8417327">:=</span>&nbsp;<span class="ident" id="8417330"><a href="/go/printer/printer_test.go.html#8417289">comment</a></span><span class="op" id="8417337">.</span><span class="ident" id="8417338">Pos</span><span class="op" id="8417341">(</span><span class="op" id="8417342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417345">if</span>&nbsp;<span class="ident" id="8417348"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8417352">.</span><span class="ident" id="8417353">Position</span><span class="op" id="8417361">(</span><span class="ident" id="8417362"><a href="/go/printer/printer_test.go.html#8417323">pos</a></span><span class="op" id="8417365">)</span><span class="op" id="8417366">.</span><span class="ident" id="8417367">Offset</span>&nbsp;<span class="op" id="8417374">!=</span>&nbsp;<span class="num" id="8417377">1</span>&nbsp;<span class="op" id="8417379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417383"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417384">.</span><span class="ident" id="8417385">Error</span><span class="op" id="8417390">(</span><span class="string" id="8417391">&#34;expected&nbsp;offset&nbsp;1&#34;</span><span class="op" id="8417410">)</span>&nbsp;<span class="comment" id="8417412">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417434"><a href="/go/printer/printer_test.go.html#8416094">testComment</a></span><span class="op" id="8417445">(</span><span class="ident" id="8417446"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417447">,</span>&nbsp;<span class="ident" id="8417449"><a href="/go/printer/printer_test.go.html#8417171">f</a></span><span class="op" id="8417450">,</span>&nbsp;<span class="builtinfunc" id="8417452">len</span><span class="op" id="8417455">(</span><span class="ident" id="8417456"><a href="/go/printer/printer_test.go.html#8416911">src</a></span><span class="op" id="8417459">)</span><span class="op" id="8417460">,</span>&nbsp;<span class="op" id="8417462">&amp;</span><span class="ident" id="8417463"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417466">.</span><span class="ident" id="8417467">Comment</span><span class="op" id="8417474">{</span><span class="ident" id="8417475">Slash</span><span class="op" id="8417480">:</span>&nbsp;<span class="ident" id="8417482"><a href="/go/printer/printer_test.go.html#8417323">pos</a></span><span class="op" id="8417485">,</span>&nbsp;<span class="ident" id="8417487">Text</span><span class="op" id="8417491">:</span>&nbsp;<span class="string" id="8417493">&#34;//-style&nbsp;comment&#34;</span><span class="op" id="8417511">}</span><span class="op" id="8417512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417515"><a href="/go/printer/printer_test.go.html#8416094">testComment</a></span><span class="op" id="8417526">(</span><span class="ident" id="8417527"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417528">,</span>&nbsp;<span class="ident" id="8417530"><a href="/go/printer/printer_test.go.html#8417171">f</a></span><span class="op" id="8417531">,</span>&nbsp;<span class="builtinfunc" id="8417533">len</span><span class="op" id="8417536">(</span><span class="ident" id="8417537"><a href="/go/printer/printer_test.go.html#8416911">src</a></span><span class="op" id="8417540">)</span><span class="op" id="8417541">,</span>&nbsp;<span class="op" id="8417543">&amp;</span><span class="ident" id="8417544"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417547">.</span><span class="ident" id="8417548">Comment</span><span class="op" id="8417555">{</span><span class="ident" id="8417556">Slash</span><span class="op" id="8417561">:</span>&nbsp;<span class="ident" id="8417563"><a href="/go/printer/printer_test.go.html#8417323">pos</a></span><span class="op" id="8417566">,</span>&nbsp;<span class="ident" id="8417568">Text</span><span class="op" id="8417572">:</span>&nbsp;<span class="string" id="8417574">&#34;/*-style&nbsp;comment&nbsp;*/&#34;</span><span class="op" id="8417595">}</span><span class="op" id="8417596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417599"><a href="/go/printer/printer_test.go.html#8416094">testComment</a></span><span class="op" id="8417610">(</span><span class="ident" id="8417611"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417612">,</span>&nbsp;<span class="ident" id="8417614"><a href="/go/printer/printer_test.go.html#8417171">f</a></span><span class="op" id="8417615">,</span>&nbsp;<span class="builtinfunc" id="8417617">len</span><span class="op" id="8417620">(</span><span class="ident" id="8417621"><a href="/go/printer/printer_test.go.html#8416911">src</a></span><span class="op" id="8417624">)</span><span class="op" id="8417625">,</span>&nbsp;<span class="op" id="8417627">&amp;</span><span class="ident" id="8417628"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417631">.</span><span class="ident" id="8417632">Comment</span><span class="op" id="8417639">{</span><span class="ident" id="8417640">Slash</span><span class="op" id="8417645">:</span>&nbsp;<span class="ident" id="8417647"><a href="/go/printer/printer_test.go.html#8417323">pos</a></span><span class="op" id="8417650">,</span>&nbsp;<span class="ident" id="8417652">Text</span><span class="op" id="8417656">:</span>&nbsp;<span class="string" id="8417658">&#34;/*-style&nbsp;\n&nbsp;comment&nbsp;*/&#34;</span><span class="op" id="8417682">}</span><span class="op" id="8417683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417686"><a href="/go/printer/printer_test.go.html#8416094">testComment</a></span><span class="op" id="8417697">(</span><span class="ident" id="8417698"><a href="/go/printer/printer_test.go.html#8416888">t</a></span><span class="op" id="8417699">,</span>&nbsp;<span class="ident" id="8417701"><a href="/go/printer/printer_test.go.html#8417171">f</a></span><span class="op" id="8417702">,</span>&nbsp;<span class="builtinfunc" id="8417704">len</span><span class="op" id="8417707">(</span><span class="ident" id="8417708"><a href="/go/printer/printer_test.go.html#8416911">src</a></span><span class="op" id="8417711">)</span><span class="op" id="8417712">,</span>&nbsp;<span class="op" id="8417714">&amp;</span><span class="ident" id="8417715"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417718">.</span><span class="ident" id="8417719">Comment</span><span class="op" id="8417726">{</span><span class="ident" id="8417727">Slash</span><span class="op" id="8417732">:</span>&nbsp;<span class="ident" id="8417734"><a href="/go/printer/printer_test.go.html#8417323">pos</a></span><span class="op" id="8417737">,</span>&nbsp;<span class="ident" id="8417739">Text</span><span class="op" id="8417743">:</span>&nbsp;<span class="string" id="8417745">&#34;/*-style&nbsp;comment&nbsp;\n\n\n&nbsp;*/&#34;</span><span class="op" id="8417773">}</span><span class="op" id="8417774">)</span><br>
<span class="lineno"></span><span class="op" id="8417776">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="8417779">type</span>&nbsp;<span class="ident" id="8417784">visitor</span>&nbsp;<span class="keyword" id="8417792">chan</span>&nbsp;<span class="op" id="8417797">*</span><span class="ident" id="8417798"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417801">.</span><span class="ident" id="8417802">Ident</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8417809">func</span>&nbsp;<span class="op" id="8417814">(</span><span class="ident" id="8417815">v</span>&nbsp;<span class="ident" id="8417817"><a href="/go/printer/printer_test.go.html#8417784">visitor</a></span><span class="op" id="8417824">)</span>&nbsp;<span class="ident" id="8417826">Visit</span><span class="op" id="8417831">(</span><span class="ident" id="8417832">n</span>&nbsp;<span class="ident" id="8417834"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417837">.</span><span class="ident" id="8417838">Node</span><span class="op" id="8417842">)</span>&nbsp;<span class="op" id="8417844">(</span><span class="ident" id="8417845">w</span>&nbsp;<span class="ident" id="8417847"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417850">.</span><span class="ident" id="8417851">Visitor</span><span class="op" id="8417858">)</span>&nbsp;<span class="op" id="8417860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417863">if</span>&nbsp;<span class="ident" id="8417866">ident</span><span class="op" id="8417871">,</span>&nbsp;<span class="ident" id="8417873">ok</span>&nbsp;<span class="op" id="8417876">:=</span>&nbsp;<span class="ident" id="8417879"><a href="/go/printer/printer_test.go.html#8417832">n</a></span><span class="op" id="8417880">.</span><span class="op" id="8417881">(</span><span class="op" id="8417882">*</span><span class="ident" id="8417883"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8417886">.</span><span class="ident" id="8417887">Ident</span><span class="op" id="8417892">)</span><span class="op" id="8417893">;</span>&nbsp;<span class="ident" id="8417895"><a href="/go/printer/printer_test.go.html#8417873">ok</a></span>&nbsp;<span class="op" id="8417898">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417902"><a href="/go/printer/printer_test.go.html#8417815">v</a></span>&nbsp;<span class="op" id="8417904">&lt;-</span>&nbsp;<span class="ident" id="8417907"><a href="/go/printer/printer_test.go.html#8417866">ident</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417917">return</span>&nbsp;<span class="ident" id="8417924"><a href="/go/printer/printer_test.go.html#8417815">v</a></span><br>
<span class="lineno"></span><span class="op" id="8417926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="8417929">//&nbsp;idents&nbsp;is&nbsp;an&nbsp;iterator&nbsp;that&nbsp;returns&nbsp;all&nbsp;idents&nbsp;in&nbsp;f&nbsp;via&nbsp;the&nbsp;result&nbsp;channel.</span><br>
<span class="lineno"></span><span class="keyword" id="8418007">func</span>&nbsp;<span class="ident" id="8418012">idents</span><span class="op" id="8418018">(</span><span class="ident" id="8418019">f</span>&nbsp;<span class="op" id="8418021">*</span><span class="ident" id="8418022"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8418025">.</span><span class="ident" id="8418026">File</span><span class="op" id="8418030">)</span>&nbsp;<span class="op" id="8418032">&lt;-</span><span class="keyword" id="8418034">chan</span>&nbsp;<span class="op" id="8418039">*</span><span class="ident" id="8418040"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8418043">.</span><span class="ident" id="8418044">Ident</span>&nbsp;<span class="op" id="8418050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418053">v</span>&nbsp;<span class="op" id="8418055">:=</span>&nbsp;<span class="builtinfunc" id="8418058">make</span><span class="op" id="8418062">(</span><span class="ident" id="8418063"><a href="/go/printer/printer_test.go.html#8417784">visitor</a></span><span class="op" id="8418070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418073">go</span>&nbsp;<span class="keyword" id="8418076">func</span><span class="op" id="8418080">(</span><span class="op" id="8418081">)</span>&nbsp;<span class="op" id="8418083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418087"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8418090">.</span><span class="ident" id="8418091">Walk</span><span class="op" id="8418095">(</span><span class="ident" id="8418096"><a href="/go/printer/printer_test.go.html#8418053">v</a></span><span class="op" id="8418097">,</span>&nbsp;<span class="ident" id="8418099"><a href="/go/printer/printer_test.go.html#8418019">f</a></span><span class="op" id="8418100">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8418104">close</span><span class="op" id="8418109">(</span><span class="ident" id="8418110"><a href="/go/printer/printer_test.go.html#8418053">v</a></span><span class="op" id="8418111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418114">}</span><span class="op" id="8418115">(</span><span class="op" id="8418116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418119">return</span>&nbsp;<span class="ident" id="8418126"><a href="/go/printer/printer_test.go.html#8418053">v</a></span><br>
<span class="lineno"></span><span class="op" id="8418128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="8418131">//&nbsp;identCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;identifiers&nbsp;found&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="keyword" id="8418191">func</span>&nbsp;<span class="ident" id="8418196">identCount</span><span class="op" id="8418206">(</span><span class="ident" id="8418207">f</span>&nbsp;<span class="op" id="8418209">*</span><span class="ident" id="8418210"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8418213">.</span><span class="ident" id="8418214">File</span><span class="op" id="8418218">)</span>&nbsp;<span class="builtintype" id="8418220">int</span>&nbsp;<span class="op" id="8418224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418227">n</span>&nbsp;<span class="op" id="8418229">:=</span>&nbsp;<span class="num" id="8418232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418235">for</span>&nbsp;<span class="keyword" id="8418239">range</span>&nbsp;<span class="ident" id="8418245"><a href="/go/printer/printer_test.go.html#8418012">idents</a></span><span class="op" id="8418251">(</span><span class="ident" id="8418252"><a href="/go/printer/printer_test.go.html#8418207">f</a></span><span class="op" id="8418253">)</span>&nbsp;<span class="op" id="8418255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418259"><a href="/go/printer/printer_test.go.html#8418227">n</a></span><span class="op" id="8418260">++</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418267">return</span>&nbsp;<span class="ident" id="8418274"><a href="/go/printer/printer_test.go.html#8418227">n</a></span><br>
<span class="lineno"></span><span class="op" id="8418276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8418279">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;SourcePos&nbsp;mode&nbsp;emits&nbsp;correct&nbsp;//line&nbsp;comments</span><br>
<span class="lineno">360</span><span class="comment" id="8418343">//&nbsp;by&nbsp;testing&nbsp;that&nbsp;position&nbsp;information&nbsp;for&nbsp;matching&nbsp;identifiers</span><br>
<span class="lineno"></span><span class="comment" id="8418408">//&nbsp;is&nbsp;maintained.</span><br>
<span class="lineno"></span><span class="keyword" id="8418426">func</span>&nbsp;<span class="ident" id="8418431">TestSourcePos</span><span class="op" id="8418444">(</span><span class="ident" id="8418445">t</span>&nbsp;<span class="op" id="8418447">*</span><span class="ident" id="8418448"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8418455">.</span><span class="ident" id="8418456">T</span><span class="op" id="8418457">)</span>&nbsp;<span class="op" id="8418459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418462">const</span>&nbsp;<span class="ident" id="8418468">src</span>&nbsp;<span class="op" id="8418472">=</span>&nbsp;<span class="string" id="8418474">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno">365</span>import&nbsp;(&nbsp;&#34;go/printer&#34;;&nbsp;&#34;math&#34;&nbsp;)<br>
<span class="lineno"></span>const&nbsp;pi&nbsp;=&nbsp;3.14;&nbsp;var&nbsp;x&nbsp;=&nbsp;0<br>
<span class="lineno"></span>type&nbsp;t&nbsp;struct{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;int;&nbsp;u,&nbsp;v,&nbsp;w&nbsp;float32&nbsp;}<br>
<span class="lineno"></span>func&nbsp;(t&nbsp;*t)&nbsp;foo(a,&nbsp;b,&nbsp;c&nbsp;int)&nbsp;int&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;a*t.x&nbsp;+&nbsp;b*t.y&nbsp;+<br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;two&nbsp;extra&nbsp;lines&nbsp;here<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc*t.z<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418699">//&nbsp;parse&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418718">f1</span><span class="op" id="8418720">,</span>&nbsp;<span class="ident" id="8418722">err</span>&nbsp;<span class="op" id="8418726">:=</span>&nbsp;<span class="ident" id="8418729"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8418735">.</span><span class="ident" id="8418736">ParseFile</span><span class="op" id="8418745">(</span><span class="ident" id="8418746"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8418750">,</span>&nbsp;<span class="string" id="8418752">&#34;src&#34;</span><span class="op" id="8418757">,</span>&nbsp;<span class="ident" id="8418759"><a href="/go/printer/printer_test.go.html#8418468">src</a></span><span class="op" id="8418762">,</span>&nbsp;<span class="ident" id="8418764"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8418770">.</span><span class="ident" id="8418771">ParseComments</span><span class="op" id="8418784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418787">if</span>&nbsp;<span class="ident" id="8418790"><a href="/go/printer/printer_test.go.html#8418722">err</a></span>&nbsp;<span class="op" id="8418794">!=</span>&nbsp;<span class="ident" id="8418797">nil</span>&nbsp;<span class="op" id="8418801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418805"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8418806">.</span><span class="ident" id="8418807">Fatal</span><span class="op" id="8418812">(</span><span class="ident" id="8418813"><a href="/go/printer/printer_test.go.html#8418722">err</a></span><span class="op" id="8418816">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418823">//&nbsp;pretty-print&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418849">var</span>&nbsp;<span class="ident" id="8418853">buf</span>&nbsp;<span class="ident" id="8418857"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8418862">.</span><span class="ident" id="8418863">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418871"><a href="/go/printer/printer_test.go.html#8418722">err</a></span>&nbsp;<span class="op" id="8418875">=</span>&nbsp;<span class="op" id="8418877">(</span><span class="op" id="8418878">&amp;</span><span class="ident" id="8418879"><a href="/go/printer/printer.go.html#6213576">Config</a></span><span class="op" id="8418885">{</span><span class="ident" id="8418886">Mode</span><span class="op" id="8418890">:</span>&nbsp;<span class="ident" id="8418892"><a href="/go/printer/printer.go.html#6213359">UseSpaces</a></span>&nbsp;<span class="op" id="8418902">|</span>&nbsp;<span class="ident" id="8418904"><a href="/go/printer/printer.go.html#6213431">SourcePos</a></span><span class="op" id="8418913">,</span>&nbsp;<span class="ident" id="8418915">Tabwidth</span><span class="op" id="8418923">:</span>&nbsp;<span class="num" id="8418925">8</span><span class="op" id="8418926">}</span><span class="op" id="8418927">)</span><span class="op" id="8418928">.</span><span class="ident" id="8418929">Fprint</span><span class="op" id="8418935">(</span><span class="op" id="8418936">&amp;</span><span class="ident" id="8418937"><a href="/go/printer/printer_test.go.html#8418853">buf</a></span><span class="op" id="8418940">,</span>&nbsp;<span class="ident" id="8418942"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8418946">,</span>&nbsp;<span class="ident" id="8418948"><a href="/go/printer/printer_test.go.html#8418718">f1</a></span><span class="op" id="8418950">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418953">if</span>&nbsp;<span class="ident" id="8418956"><a href="/go/printer/printer_test.go.html#8418722">err</a></span>&nbsp;<span class="op" id="8418960">!=</span>&nbsp;<span class="ident" id="8418963">nil</span>&nbsp;<span class="op" id="8418967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418971"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8418972">.</span><span class="ident" id="8418973">Fatal</span><span class="op" id="8418978">(</span><span class="ident" id="8418979"><a href="/go/printer/printer_test.go.html#8418722">err</a></span><span class="op" id="8418982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418989">//&nbsp;parse&nbsp;pretty&nbsp;printed&nbsp;original</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419023">//&nbsp;(//line&nbsp;comments&nbsp;must&nbsp;be&nbsp;interpreted&nbsp;even&nbsp;w/o&nbsp;parser.ParseComments&nbsp;set)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419099">f2</span><span class="op" id="8419101">,</span>&nbsp;<span class="ident" id="8419103"><a href="/go/printer/printer_test.go.html#8418722">err</a></span>&nbsp;<span class="op" id="8419107">:=</span>&nbsp;<span class="ident" id="8419110"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8419116">.</span><span class="ident" id="8419117">ParseFile</span><span class="op" id="8419126">(</span><span class="ident" id="8419127"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8419131">,</span>&nbsp;<span class="string" id="8419133">&#34;&#34;</span><span class="op" id="8419135">,</span>&nbsp;<span class="ident" id="8419137"><a href="/go/printer/printer_test.go.html#8418853">buf</a></span><span class="op" id="8419140">.</span><span class="ident" id="8419141">Bytes</span><span class="op" id="8419146">(</span><span class="op" id="8419147">)</span><span class="op" id="8419148">,</span>&nbsp;<span class="num" id="8419150">0</span><span class="op" id="8419151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419154">if</span>&nbsp;<span class="ident" id="8419157"><a href="/go/printer/printer_test.go.html#8418722">err</a></span>&nbsp;<span class="op" id="8419161">!=</span>&nbsp;<span class="ident" id="8419164">nil</span>&nbsp;<span class="op" id="8419168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419172"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419173">.</span><span class="ident" id="8419174">Fatalf</span><span class="op" id="8419180">(</span><span class="string" id="8419181">&#34;%s\n%s&#34;</span><span class="op" id="8419189">,</span>&nbsp;<span class="ident" id="8419191"><a href="/go/printer/printer_test.go.html#8418722">err</a></span><span class="op" id="8419194">,</span>&nbsp;<span class="ident" id="8419196"><a href="/go/printer/printer_test.go.html#8418853">buf</a></span><span class="op" id="8419199">.</span><span class="ident" id="8419200">Bytes</span><span class="op" id="8419205">(</span><span class="op" id="8419206">)</span><span class="op" id="8419207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419210">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419214">//&nbsp;At&nbsp;this&nbsp;point&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;identifiers&nbsp;in&nbsp;f2&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419285">//&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;corresponding&nbsp;identifiers&nbsp;in&nbsp;f1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419357">//&nbsp;number&nbsp;of&nbsp;identifiers&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0&nbsp;(test&nbsp;should&nbsp;run)&nbsp;and&nbsp;must&nbsp;match</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419428">n1</span>&nbsp;<span class="op" id="8419431">:=</span>&nbsp;<span class="ident" id="8419434"><a href="/go/printer/printer_test.go.html#8418196">identCount</a></span><span class="op" id="8419444">(</span><span class="ident" id="8419445"><a href="/go/printer/printer_test.go.html#8418718">f1</a></span><span class="op" id="8419447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419450">n2</span>&nbsp;<span class="op" id="8419453">:=</span>&nbsp;<span class="ident" id="8419456"><a href="/go/printer/printer_test.go.html#8418196">identCount</a></span><span class="op" id="8419466">(</span><span class="ident" id="8419467"><a href="/go/printer/printer_test.go.html#8419099">f2</a></span><span class="op" id="8419469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419472">if</span>&nbsp;<span class="ident" id="8419475"><a href="/go/printer/printer_test.go.html#8419428">n1</a></span>&nbsp;<span class="op" id="8419478">==</span>&nbsp;<span class="num" id="8419481">0</span>&nbsp;<span class="op" id="8419483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419487"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419488">.</span><span class="ident" id="8419489">Fatal</span><span class="op" id="8419494">(</span><span class="string" id="8419495">&#34;got&nbsp;no&nbsp;idents&#34;</span><span class="op" id="8419510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419513">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419516">if</span>&nbsp;<span class="ident" id="8419519"><a href="/go/printer/printer_test.go.html#8419450">n2</a></span>&nbsp;<span class="op" id="8419522">!=</span>&nbsp;<span class="ident" id="8419525"><a href="/go/printer/printer_test.go.html#8419428">n1</a></span>&nbsp;<span class="op" id="8419528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419532"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419533">.</span><span class="ident" id="8419534">Errorf</span><span class="op" id="8419540">(</span><span class="string" id="8419541">&#34;got&nbsp;%d&nbsp;idents;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8419565">,</span>&nbsp;<span class="ident" id="8419567"><a href="/go/printer/printer_test.go.html#8419450">n2</a></span><span class="op" id="8419569">,</span>&nbsp;<span class="ident" id="8419571"><a href="/go/printer/printer_test.go.html#8419428">n1</a></span><span class="op" id="8419573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419580">//&nbsp;verify&nbsp;that&nbsp;all&nbsp;identifiers&nbsp;have&nbsp;correct&nbsp;line&nbsp;information</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419642">i2range</span>&nbsp;<span class="op" id="8419650">:=</span>&nbsp;<span class="ident" id="8419653"><a href="/go/printer/printer_test.go.html#8418012">idents</a></span><span class="op" id="8419659">(</span><span class="ident" id="8419660"><a href="/go/printer/printer_test.go.html#8419099">f2</a></span><span class="op" id="8419662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419665">for</span>&nbsp;<span class="ident" id="8419669">i1</span>&nbsp;<span class="op" id="8419672">:=</span>&nbsp;<span class="keyword" id="8419675">range</span>&nbsp;<span class="ident" id="8419681"><a href="/go/printer/printer_test.go.html#8418012">idents</a></span><span class="op" id="8419687">(</span><span class="ident" id="8419688"><a href="/go/printer/printer_test.go.html#8418718">f1</a></span><span class="op" id="8419690">)</span>&nbsp;<span class="op" id="8419692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419696">i2</span>&nbsp;<span class="op" id="8419699">:=</span>&nbsp;<span class="op" id="8419702">&lt;-</span><span class="ident" id="8419704"><a href="/go/printer/printer_test.go.html#8419642">i2range</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419715">if</span>&nbsp;<span class="ident" id="8419718"><a href="/go/printer/printer_test.go.html#8419696">i2</a></span><span class="op" id="8419720">.</span><span class="ident" id="8419721">Name</span>&nbsp;<span class="op" id="8419726">!=</span>&nbsp;<span class="ident" id="8419729"><a href="/go/printer/printer_test.go.html#8419669">i1</a></span><span class="op" id="8419731">.</span><span class="ident" id="8419732">Name</span>&nbsp;<span class="op" id="8419737">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419742"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419743">.</span><span class="ident" id="8419744">Errorf</span><span class="op" id="8419750">(</span><span class="string" id="8419751">&#34;got&nbsp;ident&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8419774">,</span>&nbsp;<span class="ident" id="8419776"><a href="/go/printer/printer_test.go.html#8419696">i2</a></span><span class="op" id="8419778">.</span><span class="ident" id="8419779">Name</span><span class="op" id="8419783">,</span>&nbsp;<span class="ident" id="8419785"><a href="/go/printer/printer_test.go.html#8419669">i1</a></span><span class="op" id="8419787">.</span><span class="ident" id="8419788">Name</span><span class="op" id="8419792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419801">l1</span>&nbsp;<span class="op" id="8419804">:=</span>&nbsp;<span class="ident" id="8419807"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8419811">.</span><span class="ident" id="8419812">Position</span><span class="op" id="8419820">(</span><span class="ident" id="8419821"><a href="/go/printer/printer_test.go.html#8419669">i1</a></span><span class="op" id="8419823">.</span><span class="ident" id="8419824">Pos</span><span class="op" id="8419827">(</span><span class="op" id="8419828">)</span><span class="op" id="8419829">)</span><span class="op" id="8419830">.</span><span class="ident" id="8419831">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419838">l2</span>&nbsp;<span class="op" id="8419841">:=</span>&nbsp;<span class="ident" id="8419844"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8419848">.</span><span class="ident" id="8419849">Position</span><span class="op" id="8419857">(</span><span class="ident" id="8419858"><a href="/go/printer/printer_test.go.html#8419696">i2</a></span><span class="op" id="8419860">.</span><span class="ident" id="8419861">Pos</span><span class="op" id="8419864">(</span><span class="op" id="8419865">)</span><span class="op" id="8419866">)</span><span class="op" id="8419867">.</span><span class="ident" id="8419868">Line</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419875">if</span>&nbsp;<span class="ident" id="8419878"><a href="/go/printer/printer_test.go.html#8419838">l2</a></span>&nbsp;<span class="op" id="8419881">!=</span>&nbsp;<span class="ident" id="8419884"><a href="/go/printer/printer_test.go.html#8419801">l1</a></span>&nbsp;<span class="op" id="8419887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419892"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419893">.</span><span class="ident" id="8419894">Errorf</span><span class="op" id="8419900">(</span><span class="string" id="8419901">&#34;got&nbsp;line&nbsp;%d;&nbsp;want&nbsp;%d&nbsp;for&nbsp;%s&#34;</span><span class="op" id="8419930">,</span>&nbsp;<span class="ident" id="8419932"><a href="/go/printer/printer_test.go.html#8419838">l2</a></span><span class="op" id="8419934">,</span>&nbsp;<span class="ident" id="8419936"><a href="/go/printer/printer_test.go.html#8419801">l1</a></span><span class="op" id="8419938">,</span>&nbsp;<span class="ident" id="8419940"><a href="/go/printer/printer_test.go.html#8419669">i1</a></span><span class="op" id="8419942">.</span><span class="ident" id="8419943">Name</span><span class="op" id="8419947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419958">if</span>&nbsp;<span class="ident" id="8419961"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419962">.</span><span class="ident" id="8419963">Failed</span><span class="op" id="8419969">(</span><span class="op" id="8419970">)</span>&nbsp;<span class="op" id="8419972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419976"><a href="/go/printer/printer_test.go.html#8418445">t</a></span><span class="op" id="8419977">.</span><span class="ident" id="8419978">Logf</span><span class="op" id="8419982">(</span><span class="string" id="8419983">&#34;\n%s&#34;</span><span class="op" id="8419989">,</span>&nbsp;<span class="ident" id="8419991"><a href="/go/printer/printer_test.go.html#8418853">buf</a></span><span class="op" id="8419994">.</span><span class="ident" id="8419995">Bytes</span><span class="op" id="8420000">(</span><span class="op" id="8420001">)</span><span class="op" id="8420002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420005">}</span><br>
<span class="lineno"></span><span class="op" id="8420007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="keyword" id="8420010">var</span>&nbsp;<span class="ident" id="8420014">decls</span>&nbsp;<span class="op" id="8420020">=</span>&nbsp;<span class="op" id="8420022">[</span><span class="op" id="8420023">]</span><span class="builtintype" id="8420024">string</span><span class="op" id="8420030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420033">`import&nbsp;&#34;fmt&#34;`</span><span class="op" id="8420047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420050">&#34;const&nbsp;pi&nbsp;=&nbsp;3.1415\nconst&nbsp;e&nbsp;=&nbsp;2.71828\n\nvar&nbsp;x&nbsp;=&nbsp;pi&#34;</span><span class="op" id="8420102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420105">&#34;func&nbsp;sum(x,&nbsp;y&nbsp;int)&nbsp;int\t{&nbsp;return&nbsp;x&nbsp;+&nbsp;y&nbsp;}&#34;</span><span class="op" id="8420147">,</span><br>
<span class="lineno"></span><span class="op" id="8420149">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8420152">func</span>&nbsp;<span class="ident" id="8420157">TestDeclLists</span><span class="op" id="8420170">(</span><span class="ident" id="8420171">t</span>&nbsp;<span class="op" id="8420173">*</span><span class="ident" id="8420174"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8420181">.</span><span class="ident" id="8420182">T</span><span class="op" id="8420183">)</span>&nbsp;<span class="op" id="8420185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420188">for</span>&nbsp;<span class="ident" id="8420192">_</span><span class="op" id="8420193">,</span>&nbsp;<span class="ident" id="8420195">src</span>&nbsp;<span class="op" id="8420199">:=</span>&nbsp;<span class="keyword" id="8420202">range</span>&nbsp;<span class="ident" id="8420208"><a href="/go/printer/printer_test.go.html#8420014">decls</a></span>&nbsp;<span class="op" id="8420214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420218">file</span><span class="op" id="8420222">,</span>&nbsp;<span class="ident" id="8420224">err</span>&nbsp;<span class="op" id="8420228">:=</span>&nbsp;<span class="ident" id="8420231"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8420237">.</span><span class="ident" id="8420238">ParseFile</span><span class="op" id="8420247">(</span><span class="ident" id="8420248"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8420252">,</span>&nbsp;<span class="string" id="8420254">&#34;&#34;</span><span class="op" id="8420256">,</span>&nbsp;<span class="string" id="8420258">&#34;package&nbsp;p;&#34;</span><span class="op" id="8420270">+</span><span class="ident" id="8420271"><a href="/go/printer/printer_test.go.html#8420195">src</a></span><span class="op" id="8420274">,</span>&nbsp;<span class="ident" id="8420276"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8420282">.</span><span class="ident" id="8420283">ParseComments</span><span class="op" id="8420296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420300">if</span>&nbsp;<span class="ident" id="8420303"><a href="/go/printer/printer_test.go.html#8420224">err</a></span>&nbsp;<span class="op" id="8420307">!=</span>&nbsp;<span class="ident" id="8420310">nil</span>&nbsp;<span class="op" id="8420314">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8420319">panic</span><span class="op" id="8420324">(</span><span class="ident" id="8420325"><a href="/go/printer/printer_test.go.html#8420224">err</a></span><span class="op" id="8420328">)</span>&nbsp;<span class="comment" id="8420330">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420354">var</span>&nbsp;<span class="ident" id="8420358">buf</span>&nbsp;<span class="ident" id="8420362"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8420367">.</span><span class="ident" id="8420368">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420377"><a href="/go/printer/printer_test.go.html#8420224">err</a></span>&nbsp;<span class="op" id="8420381">=</span>&nbsp;<span class="ident" id="8420383"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8420389">(</span><span class="op" id="8420390">&amp;</span><span class="ident" id="8420391"><a href="/go/printer/printer_test.go.html#8420358">buf</a></span><span class="op" id="8420394">,</span>&nbsp;<span class="ident" id="8420396"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8420400">,</span>&nbsp;<span class="ident" id="8420402"><a href="/go/printer/printer_test.go.html#8420218">file</a></span><span class="op" id="8420406">.</span><span class="ident" id="8420407">Decls</span><span class="op" id="8420412">)</span>&nbsp;<span class="comment" id="8420414">//&nbsp;only&nbsp;print&nbsp;declarations</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420443">if</span>&nbsp;<span class="ident" id="8420446"><a href="/go/printer/printer_test.go.html#8420224">err</a></span>&nbsp;<span class="op" id="8420450">!=</span>&nbsp;<span class="ident" id="8420453">nil</span>&nbsp;<span class="op" id="8420457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8420462">panic</span><span class="op" id="8420467">(</span><span class="ident" id="8420468"><a href="/go/printer/printer_test.go.html#8420224">err</a></span><span class="op" id="8420471">)</span>&nbsp;<span class="comment" id="8420473">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420497">out</span>&nbsp;<span class="op" id="8420501">:=</span>&nbsp;<span class="ident" id="8420504"><a href="/go/printer/printer_test.go.html#8420358">buf</a></span><span class="op" id="8420507">.</span><span class="ident" id="8420508">String</span><span class="op" id="8420514">(</span><span class="op" id="8420515">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420519">if</span>&nbsp;<span class="ident" id="8420522"><a href="/go/printer/printer_test.go.html#8420497">out</a></span>&nbsp;<span class="op" id="8420526">!=</span>&nbsp;<span class="ident" id="8420529"><a href="/go/printer/printer_test.go.html#8420195">src</a></span>&nbsp;<span class="op" id="8420533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420538"><a href="/go/printer/printer_test.go.html#8420171">t</a></span><span class="op" id="8420539">.</span><span class="ident" id="8420540">Errorf</span><span class="op" id="8420546">(</span><span class="string" id="8420547">&#34;\ngot&nbsp;:&nbsp;%q\nwant:&nbsp;%q\n&#34;</span><span class="op" id="8420571">,</span>&nbsp;<span class="ident" id="8420573"><a href="/go/printer/printer_test.go.html#8420497">out</a></span><span class="op" id="8420576">,</span>&nbsp;<span class="ident" id="8420578"><a href="/go/printer/printer_test.go.html#8420195">src</a></span><span class="op" id="8420581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420588">}</span><br>
<span class="lineno"></span><span class="op" id="8420590">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="8420593">var</span>&nbsp;<span class="ident" id="8420597">stmts</span>&nbsp;<span class="op" id="8420603">=</span>&nbsp;<span class="op" id="8420605">[</span><span class="op" id="8420606">]</span><span class="builtintype" id="8420607">string</span><span class="op" id="8420613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420616">&#34;i&nbsp;:=&nbsp;0&#34;</span><span class="op" id="8420624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420627">&#34;select&nbsp;{}\nvar&nbsp;a,&nbsp;b&nbsp;=&nbsp;1,&nbsp;2\nreturn&nbsp;a&nbsp;+&nbsp;b&#34;</span><span class="op" id="8420669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8420672">&#34;go&nbsp;f()\ndefer&nbsp;func()&nbsp;{}()&#34;</span><span class="op" id="8420699">,</span><br>
<span class="lineno">460</span><span class="op" id="8420701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8420704">func</span>&nbsp;<span class="ident" id="8420709">TestStmtLists</span><span class="op" id="8420722">(</span><span class="ident" id="8420723">t</span>&nbsp;<span class="op" id="8420725">*</span><span class="ident" id="8420726"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8420733">.</span><span class="ident" id="8420734">T</span><span class="op" id="8420735">)</span>&nbsp;<span class="op" id="8420737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420740">for</span>&nbsp;<span class="ident" id="8420744">_</span><span class="op" id="8420745">,</span>&nbsp;<span class="ident" id="8420747">src</span>&nbsp;<span class="op" id="8420751">:=</span>&nbsp;<span class="keyword" id="8420754">range</span>&nbsp;<span class="ident" id="8420760"><a href="/go/printer/printer_test.go.html#8420597">stmts</a></span>&nbsp;<span class="op" id="8420766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420770">file</span><span class="op" id="8420774">,</span>&nbsp;<span class="ident" id="8420776">err</span>&nbsp;<span class="op" id="8420780">:=</span>&nbsp;<span class="ident" id="8420783"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8420789">.</span><span class="ident" id="8420790">ParseFile</span><span class="op" id="8420799">(</span><span class="ident" id="8420800"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8420804">,</span>&nbsp;<span class="string" id="8420806">&#34;&#34;</span><span class="op" id="8420808">,</span>&nbsp;<span class="string" id="8420810">&#34;package&nbsp;p;&nbsp;func&nbsp;_()&nbsp;{&#34;</span><span class="op" id="8420833">+</span><span class="ident" id="8420834"><a href="/go/printer/printer_test.go.html#8420747">src</a></span><span class="op" id="8420837">+</span><span class="string" id="8420838">&#34;}&#34;</span><span class="op" id="8420841">,</span>&nbsp;<span class="ident" id="8420843"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8420849">.</span><span class="ident" id="8420850">ParseComments</span><span class="op" id="8420863">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420867">if</span>&nbsp;<span class="ident" id="8420870"><a href="/go/printer/printer_test.go.html#8420776">err</a></span>&nbsp;<span class="op" id="8420874">!=</span>&nbsp;<span class="ident" id="8420877">nil</span>&nbsp;<span class="op" id="8420881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8420886">panic</span><span class="op" id="8420891">(</span><span class="ident" id="8420892"><a href="/go/printer/printer_test.go.html#8420776">err</a></span><span class="op" id="8420895">)</span>&nbsp;<span class="comment" id="8420897">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420921">var</span>&nbsp;<span class="ident" id="8420925">buf</span>&nbsp;<span class="ident" id="8420929"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8420934">.</span><span class="ident" id="8420935">Buffer</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420944"><a href="/go/printer/printer_test.go.html#8420776">err</a></span>&nbsp;<span class="op" id="8420948">=</span>&nbsp;<span class="ident" id="8420950"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8420956">(</span><span class="op" id="8420957">&amp;</span><span class="ident" id="8420958"><a href="/go/printer/printer_test.go.html#8420925">buf</a></span><span class="op" id="8420961">,</span>&nbsp;<span class="ident" id="8420963"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8420967">,</span>&nbsp;<span class="ident" id="8420969"><a href="/go/printer/printer_test.go.html#8420770">file</a></span><span class="op" id="8420973">.</span><span class="ident" id="8420974">Decls</span><span class="op" id="8420979">[</span><span class="num" id="8420980">0</span><span class="op" id="8420981">]</span><span class="op" id="8420982">.</span><span class="op" id="8420983">(</span><span class="op" id="8420984">*</span><span class="ident" id="8420985"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8420988">.</span><span class="ident" id="8420989">FuncDecl</span><span class="op" id="8420997">)</span><span class="op" id="8420998">.</span><span class="ident" id="8420999">Body</span><span class="op" id="8421003">.</span><span class="ident" id="8421004">List</span><span class="op" id="8421008">)</span>&nbsp;<span class="comment" id="8421010">//&nbsp;only&nbsp;print&nbsp;statements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421037">if</span>&nbsp;<span class="ident" id="8421040"><a href="/go/printer/printer_test.go.html#8420776">err</a></span>&nbsp;<span class="op" id="8421044">!=</span>&nbsp;<span class="ident" id="8421047">nil</span>&nbsp;<span class="op" id="8421051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8421056">panic</span><span class="op" id="8421061">(</span><span class="ident" id="8421062"><a href="/go/printer/printer_test.go.html#8420776">err</a></span><span class="op" id="8421065">)</span>&nbsp;<span class="comment" id="8421067">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421091">out</span>&nbsp;<span class="op" id="8421095">:=</span>&nbsp;<span class="ident" id="8421098"><a href="/go/printer/printer_test.go.html#8420925">buf</a></span><span class="op" id="8421101">.</span><span class="ident" id="8421102">String</span><span class="op" id="8421108">(</span><span class="op" id="8421109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421113">if</span>&nbsp;<span class="ident" id="8421116"><a href="/go/printer/printer_test.go.html#8421091">out</a></span>&nbsp;<span class="op" id="8421120">!=</span>&nbsp;<span class="ident" id="8421123"><a href="/go/printer/printer_test.go.html#8420747">src</a></span>&nbsp;<span class="op" id="8421127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421132"><a href="/go/printer/printer_test.go.html#8420723">t</a></span><span class="op" id="8421133">.</span><span class="ident" id="8421134">Errorf</span><span class="op" id="8421140">(</span><span class="string" id="8421141">&#34;\ngot&nbsp;:&nbsp;%q\nwant:&nbsp;%q\n&#34;</span><span class="op" id="8421165">,</span>&nbsp;<span class="ident" id="8421167"><a href="/go/printer/printer_test.go.html#8421091">out</a></span><span class="op" id="8421170">,</span>&nbsp;<span class="ident" id="8421172"><a href="/go/printer/printer_test.go.html#8420747">src</a></span><span class="op" id="8421175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421182">}</span><br>
<span class="lineno">480</span><span class="op" id="8421184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8421187">func</span>&nbsp;<span class="ident" id="8421192">TestBaseIndent</span><span class="op" id="8421206">(</span><span class="ident" id="8421207">t</span>&nbsp;<span class="op" id="8421209">*</span><span class="ident" id="8421210"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8421217">.</span><span class="ident" id="8421218">T</span><span class="op" id="8421219">)</span>&nbsp;<span class="op" id="8421221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8421224">//&nbsp;The&nbsp;testfile&nbsp;must&nbsp;not&nbsp;contain&nbsp;multi-line&nbsp;raw&nbsp;strings&nbsp;since&nbsp;those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8421293">//&nbsp;are&nbsp;not&nbsp;indented&nbsp;(because&nbsp;their&nbsp;values&nbsp;must&nbsp;not&nbsp;change)&nbsp;and&nbsp;make</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8421362">//&nbsp;this&nbsp;test&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421382">const</span>&nbsp;<span class="ident" id="8421388">filename</span>&nbsp;<span class="op" id="8421397">=</span>&nbsp;<span class="string" id="8421399">&#34;printer.go&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421413">src</span><span class="op" id="8421416">,</span>&nbsp;<span class="ident" id="8421418">err</span>&nbsp;<span class="op" id="8421422">:=</span>&nbsp;<span class="ident" id="8421425"><a href="/go/printer/printer_test.go.html#8409787">ioutil</a></span><span class="op" id="8421431">.</span><span class="ident" id="8421432">ReadFile</span><span class="op" id="8421440">(</span><span class="ident" id="8421441"><a href="/go/printer/printer_test.go.html#8421388">filename</a></span><span class="op" id="8421449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421452">if</span>&nbsp;<span class="ident" id="8421455"><a href="/go/printer/printer_test.go.html#8421418">err</a></span>&nbsp;<span class="op" id="8421459">!=</span>&nbsp;<span class="ident" id="8421462">nil</span>&nbsp;<span class="op" id="8421466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8421470">panic</span><span class="op" id="8421475">(</span><span class="ident" id="8421476"><a href="/go/printer/printer_test.go.html#8421418">err</a></span><span class="op" id="8421479">)</span>&nbsp;<span class="comment" id="8421481">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421503">file</span><span class="op" id="8421507">,</span>&nbsp;<span class="ident" id="8421509"><a href="/go/printer/printer_test.go.html#8421418">err</a></span>&nbsp;<span class="op" id="8421513">:=</span>&nbsp;<span class="ident" id="8421516"><a href="/go/printer/printer_test.go.html#8409762">parser</a></span><span class="op" id="8421522">.</span><span class="ident" id="8421523">ParseFile</span><span class="op" id="8421532">(</span><span class="ident" id="8421533"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8421537">,</span>&nbsp;<span class="ident" id="8421539"><a href="/go/printer/printer_test.go.html#8421388">filename</a></span><span class="op" id="8421547">,</span>&nbsp;<span class="ident" id="8421549"><a href="/go/printer/printer_test.go.html#8421413">src</a></span><span class="op" id="8421552">,</span>&nbsp;<span class="num" id="8421554">0</span><span class="op" id="8421555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421558">if</span>&nbsp;<span class="ident" id="8421561"><a href="/go/printer/printer_test.go.html#8421418">err</a></span>&nbsp;<span class="op" id="8421565">!=</span>&nbsp;<span class="ident" id="8421568">nil</span>&nbsp;<span class="op" id="8421572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8421576">panic</span><span class="op" id="8421581">(</span><span class="ident" id="8421582"><a href="/go/printer/printer_test.go.html#8421418">err</a></span><span class="op" id="8421585">)</span>&nbsp;<span class="comment" id="8421587">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421609">var</span>&nbsp;<span class="ident" id="8421613">buf</span>&nbsp;<span class="ident" id="8421617"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8421622">.</span><span class="ident" id="8421623">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421631">for</span>&nbsp;<span class="ident" id="8421635">indent</span>&nbsp;<span class="op" id="8421642">:=</span>&nbsp;<span class="num" id="8421645">0</span><span class="op" id="8421646">;</span>&nbsp;<span class="ident" id="8421648"><a href="/go/printer/printer_test.go.html#8421635">indent</a></span>&nbsp;<span class="op" id="8421655">&lt;</span>&nbsp;<span class="num" id="8421657">4</span><span class="op" id="8421658">;</span>&nbsp;<span class="ident" id="8421660"><a href="/go/printer/printer_test.go.html#8421635">indent</a></span><span class="op" id="8421666">++</span>&nbsp;<span class="op" id="8421669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421673"><a href="/go/printer/printer_test.go.html#8421613">buf</a></span><span class="op" id="8421676">.</span><span class="ident" id="8421677">Reset</span><span class="op" id="8421682">(</span><span class="op" id="8421683">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421687">(</span><span class="op" id="8421688">&amp;</span><span class="ident" id="8421689"><a href="/go/printer/printer.go.html#6213576">Config</a></span><span class="op" id="8421695">{</span><span class="ident" id="8421696">Tabwidth</span><span class="op" id="8421704">:</span>&nbsp;<span class="ident" id="8421706"><a href="/go/printer/printer_test.go.html#8409870">tabwidth</a></span><span class="op" id="8421714">,</span>&nbsp;<span class="ident" id="8421716">Indent</span><span class="op" id="8421722">:</span>&nbsp;<span class="ident" id="8421724"><a href="/go/printer/printer_test.go.html#8421635">indent</a></span><span class="op" id="8421730">}</span><span class="op" id="8421731">)</span><span class="op" id="8421732">.</span><span class="ident" id="8421733">Fprint</span><span class="op" id="8421739">(</span><span class="op" id="8421740">&amp;</span><span class="ident" id="8421741"><a href="/go/printer/printer_test.go.html#8421613">buf</a></span><span class="op" id="8421744">,</span>&nbsp;<span class="ident" id="8421746"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8421750">,</span>&nbsp;<span class="ident" id="8421752"><a href="/go/printer/printer_test.go.html#8421503">file</a></span><span class="op" id="8421756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8421760">//&nbsp;all&nbsp;code&nbsp;must&nbsp;be&nbsp;indented&nbsp;by&nbsp;at&nbsp;least&nbsp;&#39;indent&#39;&nbsp;tabs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421817">lines</span>&nbsp;<span class="op" id="8421823">:=</span>&nbsp;<span class="ident" id="8421826"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8421831">.</span><span class="ident" id="8421832">Split</span><span class="op" id="8421837">(</span><span class="ident" id="8421838"><a href="/go/printer/printer_test.go.html#8421613">buf</a></span><span class="op" id="8421841">.</span><span class="ident" id="8421842">Bytes</span><span class="op" id="8421847">(</span><span class="op" id="8421848">)</span><span class="op" id="8421849">,</span>&nbsp;<span class="op" id="8421851">[</span><span class="op" id="8421852">]</span><span class="builtintype" id="8421853">byte</span><span class="op" id="8421857">{</span><span class="string" id="8421858">&#39;\n&#39;</span><span class="op" id="8421862">}</span><span class="op" id="8421863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421867">for</span>&nbsp;<span class="ident" id="8421871">i</span><span class="op" id="8421872">,</span>&nbsp;<span class="ident" id="8421874">line</span>&nbsp;<span class="op" id="8421879">:=</span>&nbsp;<span class="keyword" id="8421882">range</span>&nbsp;<span class="ident" id="8421888"><a href="/go/printer/printer_test.go.html#8421817">lines</a></span>&nbsp;<span class="op" id="8421894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421899">if</span>&nbsp;<span class="builtinfunc" id="8421902">len</span><span class="op" id="8421905">(</span><span class="ident" id="8421906"><a href="/go/printer/printer_test.go.html#8421874">line</a></span><span class="op" id="8421910">)</span>&nbsp;<span class="op" id="8421912">==</span>&nbsp;<span class="num" id="8421915">0</span>&nbsp;<span class="op" id="8421917">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421923">continue</span>&nbsp;<span class="comment" id="8421932">//&nbsp;empty&nbsp;lines&nbsp;don&#39;t&nbsp;have&nbsp;indentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421978">n</span>&nbsp;<span class="op" id="8421980">:=</span>&nbsp;<span class="num" id="8421983">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421988">for</span>&nbsp;<span class="ident" id="8421992">j</span><span class="op" id="8421993">,</span>&nbsp;<span class="ident" id="8421995">b</span>&nbsp;<span class="op" id="8421997">:=</span>&nbsp;<span class="keyword" id="8422000">range</span>&nbsp;<span class="ident" id="8422006"><a href="/go/printer/printer_test.go.html#8421874">line</a></span>&nbsp;<span class="op" id="8422011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422017">if</span>&nbsp;<span class="ident" id="8422020"><a href="/go/printer/printer_test.go.html#8421995">b</a></span>&nbsp;<span class="op" id="8422022">!=</span>&nbsp;<span class="string" id="8422025">&#39;\t&#39;</span>&nbsp;<span class="op" id="8422030">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422037">//&nbsp;end&nbsp;of&nbsp;indentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422064"><a href="/go/printer/printer_test.go.html#8421978">n</a></span>&nbsp;<span class="op" id="8422066">=</span>&nbsp;<span class="ident" id="8422068"><a href="/go/printer/printer_test.go.html#8421992">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422075">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422090">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422095">if</span>&nbsp;<span class="ident" id="8422098"><a href="/go/printer/printer_test.go.html#8421978">n</a></span>&nbsp;<span class="op" id="8422100">&lt;</span>&nbsp;<span class="ident" id="8422102"><a href="/go/printer/printer_test.go.html#8421635">indent</a></span>&nbsp;<span class="op" id="8422109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422115"><a href="/go/printer/printer_test.go.html#8421207">t</a></span><span class="op" id="8422116">.</span><span class="ident" id="8422117">Errorf</span><span class="op" id="8422123">(</span><span class="string" id="8422124">&#34;line&nbsp;%d:&nbsp;got&nbsp;only&nbsp;%d&nbsp;tabs;&nbsp;want&nbsp;at&nbsp;least&nbsp;%d:&nbsp;%q&#34;</span><span class="op" id="8422173">,</span>&nbsp;<span class="ident" id="8422175"><a href="/go/printer/printer_test.go.html#8421871">i</a></span><span class="op" id="8422176">,</span>&nbsp;<span class="ident" id="8422178"><a href="/go/printer/printer_test.go.html#8421978">n</a></span><span class="op" id="8422179">,</span>&nbsp;<span class="ident" id="8422181"><a href="/go/printer/printer_test.go.html#8421635">indent</a></span><span class="op" id="8422187">,</span>&nbsp;<span class="ident" id="8422189"><a href="/go/printer/printer_test.go.html#8421874">line</a></span><span class="op" id="8422193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422205">}</span><br>
<span class="lineno">520</span><span class="op" id="8422207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8422210">//&nbsp;TestFuncType&nbsp;tests&nbsp;that&nbsp;an&nbsp;ast.FuncType&nbsp;with&nbsp;a&nbsp;nil&nbsp;Params&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="8422277">//&nbsp;can&nbsp;be&nbsp;printed&nbsp;(per&nbsp;go/ast&nbsp;specification).&nbsp;Test&nbsp;case&nbsp;for&nbsp;issue&nbsp;3870.</span><br>
<span class="lineno"></span><span class="keyword" id="8422349">func</span>&nbsp;<span class="ident" id="8422354">TestFuncType</span><span class="op" id="8422366">(</span><span class="ident" id="8422367">t</span>&nbsp;<span class="op" id="8422369">*</span><span class="ident" id="8422370"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8422377">.</span><span class="ident" id="8422378">T</span><span class="op" id="8422379">)</span>&nbsp;<span class="op" id="8422381">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422384">src</span>&nbsp;<span class="op" id="8422388">:=</span>&nbsp;<span class="op" id="8422391">&amp;</span><span class="ident" id="8422392"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422395">.</span><span class="ident" id="8422396">File</span><span class="op" id="8422400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422404">Name</span><span class="op" id="8422408">:</span>&nbsp;<span class="op" id="8422410">&amp;</span><span class="ident" id="8422411"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422414">.</span><span class="ident" id="8422415">Ident</span><span class="op" id="8422420">{</span><span class="ident" id="8422421">Name</span><span class="op" id="8422425">:</span>&nbsp;<span class="string" id="8422427">&#34;p&#34;</span><span class="op" id="8422430">}</span><span class="op" id="8422431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422435">Decls</span><span class="op" id="8422440">:</span>&nbsp;<span class="op" id="8422442">[</span><span class="op" id="8422443">]</span><span class="ident" id="8422444"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422447">.</span><span class="ident" id="8422448">Decl</span><span class="op" id="8422452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422457">&amp;</span><span class="ident" id="8422458"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422461">.</span><span class="ident" id="8422462">FuncDecl</span><span class="op" id="8422470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422476">Name</span><span class="op" id="8422480">:</span>&nbsp;<span class="op" id="8422482">&amp;</span><span class="ident" id="8422483"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422486">.</span><span class="ident" id="8422487">Ident</span><span class="op" id="8422492">{</span><span class="ident" id="8422493">Name</span><span class="op" id="8422497">:</span>&nbsp;<span class="string" id="8422499">&#34;f&#34;</span><span class="op" id="8422502">}</span><span class="op" id="8422503">,</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422509">Type</span><span class="op" id="8422513">:</span>&nbsp;<span class="op" id="8422515">&amp;</span><span class="ident" id="8422516"><a href="/go/printer/printer_test.go.html#8409752">ast</a></span><span class="op" id="8422519">.</span><span class="ident" id="8422520">FuncType</span><span class="op" id="8422528">{</span><span class="op" id="8422529">}</span><span class="op" id="8422530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422535">}</span><span class="op" id="8422536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422540">}</span><span class="op" id="8422541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422548">var</span>&nbsp;<span class="ident" id="8422552">buf</span>&nbsp;<span class="ident" id="8422556"><a href="/go/printer/printer_test.go.html#8409718">bytes</a></span><span class="op" id="8422561">.</span><span class="ident" id="8422562">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422570">if</span>&nbsp;<span class="ident" id="8422573">err</span>&nbsp;<span class="op" id="8422577">:=</span>&nbsp;<span class="ident" id="8422580"><a href="/go/printer/printer.go.html#6215998">Fprint</a></span><span class="op" id="8422586">(</span><span class="op" id="8422587">&amp;</span><span class="ident" id="8422588"><a href="/go/printer/printer_test.go.html#8422552">buf</a></span><span class="op" id="8422591">,</span>&nbsp;<span class="ident" id="8422593"><a href="/go/printer/printer_test.go.html#8409954">fset</a></span><span class="op" id="8422597">,</span>&nbsp;<span class="ident" id="8422599"><a href="/go/printer/printer_test.go.html#8422384">src</a></span><span class="op" id="8422602">)</span><span class="op" id="8422603">;</span>&nbsp;<span class="ident" id="8422605"><a href="/go/printer/printer_test.go.html#8422573">err</a></span>&nbsp;<span class="op" id="8422609">!=</span>&nbsp;<span class="ident" id="8422612">nil</span>&nbsp;<span class="op" id="8422616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422620"><a href="/go/printer/printer_test.go.html#8422367">t</a></span><span class="op" id="8422621">.</span><span class="ident" id="8422622">Fatal</span><span class="op" id="8422627">(</span><span class="ident" id="8422628"><a href="/go/printer/printer_test.go.html#8422573">err</a></span><span class="op" id="8422631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422637">got</span>&nbsp;<span class="op" id="8422641">:=</span>&nbsp;<span class="ident" id="8422644"><a href="/go/printer/printer_test.go.html#8422552">buf</a></span><span class="op" id="8422647">.</span><span class="ident" id="8422648">String</span><span class="op" id="8422654">(</span><span class="op" id="8422655">)</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422659">const</span>&nbsp;<span class="ident" id="8422665">want</span>&nbsp;<span class="op" id="8422670">=</span>&nbsp;<span class="string" id="8422672">`package&nbsp;p<br>
<span class="lineno"></span><br>
<span class="lineno"></span>func&nbsp;f()<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422697">if</span>&nbsp;<span class="ident" id="8422700"><a href="/go/printer/printer_test.go.html#8422637">got</a></span>&nbsp;<span class="op" id="8422704">!=</span>&nbsp;<span class="ident" id="8422707"><a href="/go/printer/printer_test.go.html#8422665">want</a></span>&nbsp;<span class="op" id="8422712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422716"><a href="/go/printer/printer_test.go.html#8422367">t</a></span><span class="op" id="8422717">.</span><span class="ident" id="8422718">Fatalf</span><span class="op" id="8422724">(</span><span class="string" id="8422725">&#34;got:\n%s\nwant:\n%s\n&#34;</span><span class="op" id="8422748">,</span>&nbsp;<span class="ident" id="8422750"><a href="/go/printer/printer_test.go.html#8422637">got</a></span><span class="op" id="8422753">,</span>&nbsp;<span class="ident" id="8422755"><a href="/go/printer/printer_test.go.html#8422665">want</a></span><span class="op" id="8422759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422762">}</span><br>
<span class="lineno"></span><span class="op" id="8422764">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="8422767">//&nbsp;TextX&nbsp;is&nbsp;a&nbsp;skeleton&nbsp;test&nbsp;that&nbsp;can&nbsp;be&nbsp;filled&nbsp;in&nbsp;for&nbsp;debugging&nbsp;one-off&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="8422846">//&nbsp;Do&nbsp;not&nbsp;remove.</span><br>
<span class="lineno"></span><span class="keyword" id="8422864">func</span>&nbsp;<span class="ident" id="8422869">TestX</span><span class="op" id="8422874">(</span><span class="ident" id="8422875">t</span>&nbsp;<span class="op" id="8422877">*</span><span class="ident" id="8422878"><a href="/go/printer/printer_test.go.html#8409817">testing</a></span><span class="op" id="8422885">.</span><span class="ident" id="8422886">T</span><span class="op" id="8422887">)</span>&nbsp;<span class="op" id="8422889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422892">const</span>&nbsp;<span class="ident" id="8422898">src</span>&nbsp;<span class="op" id="8422902">=</span>&nbsp;<span class="string" id="8422904">`<br>
<span class="lineno">555</span>package&nbsp;p<br>
<span class="lineno"></span>func&nbsp;_()&nbsp;{}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422931">_</span><span class="op" id="8422932">,</span>&nbsp;<span class="ident" id="8422934">err</span>&nbsp;<span class="op" id="8422938">:=</span>&nbsp;<span class="ident" id="8422941"><a href="/go/printer/printer_test.go.html#8410232">format</a></span><span class="op" id="8422947">(</span><span class="op" id="8422948">[</span><span class="op" id="8422949">]</span><span class="builtintype" id="8422950">byte</span><span class="op" id="8422954">(</span><span class="ident" id="8422955"><a href="/go/printer/printer_test.go.html#8422898">src</a></span><span class="op" id="8422958">)</span><span class="op" id="8422959">,</span>&nbsp;<span class="num" id="8422961">0</span><span class="op" id="8422962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422965">if</span>&nbsp;<span class="ident" id="8422968"><a href="/go/printer/printer_test.go.html#8422934">err</a></span>&nbsp;<span class="op" id="8422972">!=</span>&nbsp;<span class="ident" id="8422975">nil</span>&nbsp;<span class="op" id="8422979">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422983"><a href="/go/printer/printer_test.go.html#8422875">t</a></span><span class="op" id="8422984">.</span><span class="ident" id="8422985">Error</span><span class="op" id="8422990">(</span><span class="ident" id="8422991"><a href="/go/printer/printer_test.go.html#8422934">err</a></span><span class="op" id="8422994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422997">}</span><br>
<span class="lineno"></span><span class="op" id="8422999">}</span>
</div>
</body>
</html>
