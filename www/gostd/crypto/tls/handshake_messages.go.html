<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4481002">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4481057">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4481111">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4481162">package</span>&nbsp;<span class="ident" id="4481170">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4481175">import</span>&nbsp;<span class="string" id="4481182">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4481191">type</span>&nbsp;<span class="ident" id="4481196">clientHelloMsg</span>&nbsp;<span class="keyword" id="4481211">struct</span>&nbsp;<span class="op" id="4481218">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481221">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481241">[</span><span class="op" id="4481242">]</span><span class="builtintype" id="4481243">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481249">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4481269">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481277">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481297">[</span><span class="op" id="4481298">]</span><span class="builtintype" id="4481299">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481305">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481325">[</span><span class="op" id="4481326">]</span><span class="builtintype" id="4481327">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481333">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481353">[</span><span class="op" id="4481354">]</span><span class="builtintype" id="4481355">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481363">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4481383">[</span><span class="op" id="4481384">]</span><span class="builtintype" id="4481385">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481392">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4481412">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481418">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4481438">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481446">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4481466">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481472">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481492">[</span><span class="op" id="4481493">]</span><span class="ident" id="4481494">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481503">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481523">[</span><span class="op" id="4481524">]</span><span class="builtintype" id="4481525">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481532">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4481552">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481558">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481578">[</span><span class="op" id="4481579">]</span><span class="builtintype" id="4481580">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481587">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4481607">[</span><span class="op" id="4481608">]</span><span class="ident" id="4481609">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481627">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4481647">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481653">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481673">[</span><span class="op" id="4481674">]</span><span class="builtintype" id="4481675">string</span><br>
<span class="lineno"></span><span class="op" id="4481682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4481685">func</span>&nbsp;<span class="op" id="4481690">(</span><span class="ident" id="4481691">m</span>&nbsp;<span class="op" id="4481693">*</span><span class="ident" id="4481694">clientHelloMsg</span><span class="op" id="4481708">)</span>&nbsp;<span class="ident" id="4481710">equal</span><span class="op" id="4481715">(</span><span class="ident" id="4481716">i</span>&nbsp;<span class="keyword" id="4481718">interface</span><span class="op" id="4481727">{</span><span class="op" id="4481728">}</span><span class="op" id="4481729">)</span>&nbsp;<span class="builtintype" id="4481731">bool</span>&nbsp;<span class="op" id="4481736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481739">m1</span><span class="op" id="4481741">,</span>&nbsp;<span class="ident" id="4481743">ok</span>&nbsp;<span class="op" id="4481746">:=</span>&nbsp;<span class="ident" id="4481749">i</span><span class="op" id="4481750">.</span><span class="op" id="4481751">(</span><span class="op" id="4481752">*</span><span class="ident" id="4481753">clientHelloMsg</span><span class="op" id="4481767">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4481770">if</span>&nbsp;<span class="op" id="4481773">!</span><span class="ident" id="4481774">ok</span>&nbsp;<span class="op" id="4481777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4481781">return</span>&nbsp;<span class="builtintype" id="4481788">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4481795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4481799">return</span>&nbsp;<span class="ident" id="4481806">bytes</span><span class="op" id="4481811">.</span><span class="ident" id="4481812">Equal</span><span class="op" id="4481817">(</span><span class="ident" id="4481818">m</span><span class="op" id="4481819">.</span><span class="ident" id="4481820">raw</span><span class="op" id="4481823">,</span>&nbsp;<span class="ident" id="4481825">m1</span><span class="op" id="4481827">.</span><span class="ident" id="4481828">raw</span><span class="op" id="4481831">)</span>&nbsp;<span class="op" id="4481833">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481838">m</span><span class="op" id="4481839">.</span><span class="ident" id="4481840">vers</span>&nbsp;<span class="op" id="4481845">==</span>&nbsp;<span class="ident" id="4481848">m1</span><span class="op" id="4481850">.</span><span class="ident" id="4481851">vers</span>&nbsp;<span class="op" id="4481856">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481861">bytes</span><span class="op" id="4481866">.</span><span class="ident" id="4481867">Equal</span><span class="op" id="4481872">(</span><span class="ident" id="4481873">m</span><span class="op" id="4481874">.</span><span class="ident" id="4481875">random</span><span class="op" id="4481881">,</span>&nbsp;<span class="ident" id="4481883">m1</span><span class="op" id="4481885">.</span><span class="ident" id="4481886">random</span><span class="op" id="4481892">)</span>&nbsp;<span class="op" id="4481894">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481899">bytes</span><span class="op" id="4481904">.</span><span class="ident" id="4481905">Equal</span><span class="op" id="4481910">(</span><span class="ident" id="4481911">m</span><span class="op" id="4481912">.</span><span class="ident" id="4481913">sessionId</span><span class="op" id="4481922">,</span>&nbsp;<span class="ident" id="4481924">m1</span><span class="op" id="4481926">.</span><span class="ident" id="4481927">sessionId</span><span class="op" id="4481936">)</span>&nbsp;<span class="op" id="4481938">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481943">eqUint16s</span><span class="op" id="4481952">(</span><span class="ident" id="4481953">m</span><span class="op" id="4481954">.</span><span class="ident" id="4481955">cipherSuites</span><span class="op" id="4481967">,</span>&nbsp;<span class="ident" id="4481969">m1</span><span class="op" id="4481971">.</span><span class="ident" id="4481972">cipherSuites</span><span class="op" id="4481984">)</span>&nbsp;<span class="op" id="4481986">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481991">bytes</span><span class="op" id="4481996">.</span><span class="ident" id="4481997">Equal</span><span class="op" id="4482002">(</span><span class="ident" id="4482003">m</span><span class="op" id="4482004">.</span><span class="ident" id="4482005">compressionMethods</span><span class="op" id="4482023">,</span>&nbsp;<span class="ident" id="4482025">m1</span><span class="op" id="4482027">.</span><span class="ident" id="4482028">compressionMethods</span><span class="op" id="4482046">)</span>&nbsp;<span class="op" id="4482048">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482053">m</span><span class="op" id="4482054">.</span><span class="ident" id="4482055">nextProtoNeg</span>&nbsp;<span class="op" id="4482068">==</span>&nbsp;<span class="ident" id="4482071">m1</span><span class="op" id="4482073">.</span><span class="ident" id="4482074">nextProtoNeg</span>&nbsp;<span class="op" id="4482087">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482092">m</span><span class="op" id="4482093">.</span><span class="ident" id="4482094">serverName</span>&nbsp;<span class="op" id="4482105">==</span>&nbsp;<span class="ident" id="4482108">m1</span><span class="op" id="4482110">.</span><span class="ident" id="4482111">serverName</span>&nbsp;<span class="op" id="4482122">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482127">m</span><span class="op" id="4482128">.</span><span class="ident" id="4482129">ocspStapling</span>&nbsp;<span class="op" id="4482142">==</span>&nbsp;<span class="ident" id="4482145">m1</span><span class="op" id="4482147">.</span><span class="ident" id="4482148">ocspStapling</span>&nbsp;<span class="op" id="4482161">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482166">eqCurveIDs</span><span class="op" id="4482176">(</span><span class="ident" id="4482177">m</span><span class="op" id="4482178">.</span><span class="ident" id="4482179">supportedCurves</span><span class="op" id="4482194">,</span>&nbsp;<span class="ident" id="4482196">m1</span><span class="op" id="4482198">.</span><span class="ident" id="4482199">supportedCurves</span><span class="op" id="4482214">)</span>&nbsp;<span class="op" id="4482216">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482221">bytes</span><span class="op" id="4482226">.</span><span class="ident" id="4482227">Equal</span><span class="op" id="4482232">(</span><span class="ident" id="4482233">m</span><span class="op" id="4482234">.</span><span class="ident" id="4482235">supportedPoints</span><span class="op" id="4482250">,</span>&nbsp;<span class="ident" id="4482252">m1</span><span class="op" id="4482254">.</span><span class="ident" id="4482255">supportedPoints</span><span class="op" id="4482270">)</span>&nbsp;<span class="op" id="4482272">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482277">m</span><span class="op" id="4482278">.</span><span class="ident" id="4482279">ticketSupported</span>&nbsp;<span class="op" id="4482295">==</span>&nbsp;<span class="ident" id="4482298">m1</span><span class="op" id="4482300">.</span><span class="ident" id="4482301">ticketSupported</span>&nbsp;<span class="op" id="4482317">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482322">bytes</span><span class="op" id="4482327">.</span><span class="ident" id="4482328">Equal</span><span class="op" id="4482333">(</span><span class="ident" id="4482334">m</span><span class="op" id="4482335">.</span><span class="ident" id="4482336">sessionTicket</span><span class="op" id="4482349">,</span>&nbsp;<span class="ident" id="4482351">m1</span><span class="op" id="4482353">.</span><span class="ident" id="4482354">sessionTicket</span><span class="op" id="4482367">)</span>&nbsp;<span class="op" id="4482369">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482374">eqSignatureAndHashes</span><span class="op" id="4482394">(</span><span class="ident" id="4482395">m</span><span class="op" id="4482396">.</span><span class="ident" id="4482397">signatureAndHashes</span><span class="op" id="4482415">,</span>&nbsp;<span class="ident" id="4482417">m1</span><span class="op" id="4482419">.</span><span class="ident" id="4482420">signatureAndHashes</span><span class="op" id="4482438">)</span>&nbsp;<span class="op" id="4482440">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482445">m</span><span class="op" id="4482446">.</span><span class="ident" id="4482447">secureRenegotiation</span>&nbsp;<span class="op" id="4482467">==</span>&nbsp;<span class="ident" id="4482470">m1</span><span class="op" id="4482472">.</span><span class="ident" id="4482473">secureRenegotiation</span>&nbsp;<span class="op" id="4482493">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482498">eqStrings</span><span class="op" id="4482507">(</span><span class="ident" id="4482508">m</span><span class="op" id="4482509">.</span><span class="ident" id="4482510">alpnProtocols</span><span class="op" id="4482523">,</span>&nbsp;<span class="ident" id="4482525">m1</span><span class="op" id="4482527">.</span><span class="ident" id="4482528">alpnProtocols</span><span class="op" id="4482541">)</span><br>
<span class="lineno">50</span><span class="op" id="4482543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4482546">func</span>&nbsp;<span class="op" id="4482551">(</span><span class="ident" id="4482552">m</span>&nbsp;<span class="op" id="4482554">*</span><span class="ident" id="4482555">clientHelloMsg</span><span class="op" id="4482569">)</span>&nbsp;<span class="ident" id="4482571">marshal</span><span class="op" id="4482578">(</span><span class="op" id="4482579">)</span>&nbsp;<span class="op" id="4482581">[</span><span class="op" id="4482582">]</span><span class="builtintype" id="4482583">byte</span>&nbsp;<span class="op" id="4482588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482591">if</span>&nbsp;<span class="ident" id="4482594">m</span><span class="op" id="4482595">.</span><span class="ident" id="4482596">raw</span>&nbsp;<span class="op" id="4482600">!=</span>&nbsp;<span class="ident" id="4482603">nil</span>&nbsp;<span class="op" id="4482607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482611">return</span>&nbsp;<span class="ident" id="4482618">m</span><span class="op" id="4482619">.</span><span class="ident" id="4482620">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4482625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482629">length</span>&nbsp;<span class="op" id="4482636">:=</span>&nbsp;<span class="num" id="4482639">2</span>&nbsp;<span class="op" id="4482641">+</span>&nbsp;<span class="num" id="4482643">32</span>&nbsp;<span class="op" id="4482646">+</span>&nbsp;<span class="num" id="4482648">1</span>&nbsp;<span class="op" id="4482650">+</span>&nbsp;<span class="builtinfunc" id="4482652">len</span><span class="op" id="4482655">(</span><span class="ident" id="4482656">m</span><span class="op" id="4482657">.</span><span class="ident" id="4482658">sessionId</span><span class="op" id="4482667">)</span>&nbsp;<span class="op" id="4482669">+</span>&nbsp;<span class="num" id="4482671">2</span>&nbsp;<span class="op" id="4482673">+</span>&nbsp;<span class="builtinfunc" id="4482675">len</span><span class="op" id="4482678">(</span><span class="ident" id="4482679">m</span><span class="op" id="4482680">.</span><span class="ident" id="4482681">cipherSuites</span><span class="op" id="4482693">)</span><span class="op" id="4482694">*</span><span class="num" id="4482695">2</span>&nbsp;<span class="op" id="4482697">+</span>&nbsp;<span class="num" id="4482699">1</span>&nbsp;<span class="op" id="4482701">+</span>&nbsp;<span class="builtinfunc" id="4482703">len</span><span class="op" id="4482706">(</span><span class="ident" id="4482707">m</span><span class="op" id="4482708">.</span><span class="ident" id="4482709">compressionMethods</span><span class="op" id="4482727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482730">numExtensions</span>&nbsp;<span class="op" id="4482744">:=</span>&nbsp;<span class="num" id="4482747">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482750">extensionsLength</span>&nbsp;<span class="op" id="4482767">:=</span>&nbsp;<span class="num" id="4482770">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482773">if</span>&nbsp;<span class="ident" id="4482776">m</span><span class="op" id="4482777">.</span><span class="ident" id="4482778">nextProtoNeg</span>&nbsp;<span class="op" id="4482791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482795">numExtensions</span><span class="op" id="4482808">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4482812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482815">if</span>&nbsp;<span class="ident" id="4482818">m</span><span class="op" id="4482819">.</span><span class="ident" id="4482820">ocspStapling</span>&nbsp;<span class="op" id="4482833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482837">extensionsLength</span>&nbsp;<span class="op" id="4482854">+=</span>&nbsp;<span class="num" id="4482857">1</span>&nbsp;<span class="op" id="4482859">+</span>&nbsp;<span class="num" id="4482861">2</span>&nbsp;<span class="op" id="4482863">+</span>&nbsp;<span class="num" id="4482865">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482869">numExtensions</span><span class="op" id="4482882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4482886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482889">if</span>&nbsp;<span class="builtinfunc" id="4482892">len</span><span class="op" id="4482895">(</span><span class="ident" id="4482896">m</span><span class="op" id="4482897">.</span><span class="ident" id="4482898">serverName</span><span class="op" id="4482908">)</span>&nbsp;<span class="op" id="4482910">&gt;</span>&nbsp;<span class="num" id="4482912">0</span>&nbsp;<span class="op" id="4482914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482918">extensionsLength</span>&nbsp;<span class="op" id="4482935">+=</span>&nbsp;<span class="num" id="4482938">5</span>&nbsp;<span class="op" id="4482940">+</span>&nbsp;<span class="builtinfunc" id="4482942">len</span><span class="op" id="4482945">(</span><span class="ident" id="4482946">m</span><span class="op" id="4482947">.</span><span class="ident" id="4482948">serverName</span><span class="op" id="4482958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482962">numExtensions</span><span class="op" id="4482975">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4482979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4482982">if</span>&nbsp;<span class="builtinfunc" id="4482985">len</span><span class="op" id="4482988">(</span><span class="ident" id="4482989">m</span><span class="op" id="4482990">.</span><span class="ident" id="4482991">supportedCurves</span><span class="op" id="4483006">)</span>&nbsp;<span class="op" id="4483008">&gt;</span>&nbsp;<span class="num" id="4483010">0</span>&nbsp;<span class="op" id="4483012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483016">extensionsLength</span>&nbsp;<span class="op" id="4483033">+=</span>&nbsp;<span class="num" id="4483036">2</span>&nbsp;<span class="op" id="4483038">+</span>&nbsp;<span class="num" id="4483040">2</span><span class="op" id="4483041">*</span><span class="builtinfunc" id="4483042">len</span><span class="op" id="4483045">(</span><span class="ident" id="4483046">m</span><span class="op" id="4483047">.</span><span class="ident" id="4483048">supportedCurves</span><span class="op" id="4483063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483067">numExtensions</span><span class="op" id="4483080">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483084">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483087">if</span>&nbsp;<span class="builtinfunc" id="4483090">len</span><span class="op" id="4483093">(</span><span class="ident" id="4483094">m</span><span class="op" id="4483095">.</span><span class="ident" id="4483096">supportedPoints</span><span class="op" id="4483111">)</span>&nbsp;<span class="op" id="4483113">&gt;</span>&nbsp;<span class="num" id="4483115">0</span>&nbsp;<span class="op" id="4483117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483121">extensionsLength</span>&nbsp;<span class="op" id="4483138">+=</span>&nbsp;<span class="num" id="4483141">1</span>&nbsp;<span class="op" id="4483143">+</span>&nbsp;<span class="builtinfunc" id="4483145">len</span><span class="op" id="4483148">(</span><span class="ident" id="4483149">m</span><span class="op" id="4483150">.</span><span class="ident" id="4483151">supportedPoints</span><span class="op" id="4483166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483170">numExtensions</span><span class="op" id="4483183">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483190">if</span>&nbsp;<span class="ident" id="4483193">m</span><span class="op" id="4483194">.</span><span class="ident" id="4483195">ticketSupported</span>&nbsp;<span class="op" id="4483211">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483215">extensionsLength</span>&nbsp;<span class="op" id="4483232">+=</span>&nbsp;<span class="builtinfunc" id="4483235">len</span><span class="op" id="4483238">(</span><span class="ident" id="4483239">m</span><span class="op" id="4483240">.</span><span class="ident" id="4483241">sessionTicket</span><span class="op" id="4483254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483258">numExtensions</span><span class="op" id="4483271">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483278">if</span>&nbsp;<span class="builtinfunc" id="4483281">len</span><span class="op" id="4483284">(</span><span class="ident" id="4483285">m</span><span class="op" id="4483286">.</span><span class="ident" id="4483287">signatureAndHashes</span><span class="op" id="4483305">)</span>&nbsp;<span class="op" id="4483307">&gt;</span>&nbsp;<span class="num" id="4483309">0</span>&nbsp;<span class="op" id="4483311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483315">extensionsLength</span>&nbsp;<span class="op" id="4483332">+=</span>&nbsp;<span class="num" id="4483335">2</span>&nbsp;<span class="op" id="4483337">+</span>&nbsp;<span class="num" id="4483339">2</span><span class="op" id="4483340">*</span><span class="builtinfunc" id="4483341">len</span><span class="op" id="4483344">(</span><span class="ident" id="4483345">m</span><span class="op" id="4483346">.</span><span class="ident" id="4483347">signatureAndHashes</span><span class="op" id="4483365">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483369">numExtensions</span><span class="op" id="4483382">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483389">if</span>&nbsp;<span class="ident" id="4483392">m</span><span class="op" id="4483393">.</span><span class="ident" id="4483394">secureRenegotiation</span>&nbsp;<span class="op" id="4483414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483418">extensionsLength</span>&nbsp;<span class="op" id="4483435">+=</span>&nbsp;<span class="num" id="4483438">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483442">numExtensions</span><span class="op" id="4483455">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483462">if</span>&nbsp;<span class="builtinfunc" id="4483465">len</span><span class="op" id="4483468">(</span><span class="ident" id="4483469">m</span><span class="op" id="4483470">.</span><span class="ident" id="4483471">alpnProtocols</span><span class="op" id="4483484">)</span>&nbsp;<span class="op" id="4483486">&gt;</span>&nbsp;<span class="num" id="4483488">0</span>&nbsp;<span class="op" id="4483490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483494">extensionsLength</span>&nbsp;<span class="op" id="4483511">+=</span>&nbsp;<span class="num" id="4483514">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483518">for</span>&nbsp;<span class="ident" id="4483522">_</span><span class="op" id="4483523">,</span>&nbsp;<span class="ident" id="4483525">s</span>&nbsp;<span class="op" id="4483527">:=</span>&nbsp;<span class="keyword" id="4483530">range</span>&nbsp;<span class="ident" id="4483536">m</span><span class="op" id="4483537">.</span><span class="ident" id="4483538">alpnProtocols</span>&nbsp;<span class="op" id="4483552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483557">if</span>&nbsp;<span class="ident" id="4483560">l</span>&nbsp;<span class="op" id="4483562">:=</span>&nbsp;<span class="builtinfunc" id="4483565">len</span><span class="op" id="4483568">(</span><span class="ident" id="4483569">s</span><span class="op" id="4483570">)</span><span class="op" id="4483571">;</span>&nbsp;<span class="ident" id="4483573">l</span>&nbsp;<span class="op" id="4483575">==</span>&nbsp;<span class="num" id="4483578">0</span>&nbsp;<span class="op" id="4483580">||</span>&nbsp;<span class="ident" id="4483583">l</span>&nbsp;<span class="op" id="4483585">&gt;</span>&nbsp;<span class="num" id="4483587">255</span>&nbsp;<span class="op" id="4483591">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4483597">panic</span><span class="op" id="4483602">(</span><span class="string" id="4483603">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4483626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483636">extensionsLength</span><span class="op" id="4483652">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483658">extensionsLength</span>&nbsp;<span class="op" id="4483675">+=</span>&nbsp;<span class="builtinfunc" id="4483678">len</span><span class="op" id="4483681">(</span><span class="ident" id="4483682">s</span><span class="op" id="4483683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483687">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483691">numExtensions</span><span class="op" id="4483704">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483711">if</span>&nbsp;<span class="ident" id="4483714">numExtensions</span>&nbsp;<span class="op" id="4483728">&gt;</span>&nbsp;<span class="num" id="4483730">0</span>&nbsp;<span class="op" id="4483732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483736">extensionsLength</span>&nbsp;<span class="op" id="4483753">+=</span>&nbsp;<span class="num" id="4483756">4</span>&nbsp;<span class="op" id="4483758">*</span>&nbsp;<span class="ident" id="4483760">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483776">length</span>&nbsp;<span class="op" id="4483783">+=</span>&nbsp;<span class="num" id="4483786">2</span>&nbsp;<span class="op" id="4483788">+</span>&nbsp;<span class="ident" id="4483790">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483812">x</span>&nbsp;<span class="op" id="4483814">:=</span>&nbsp;<span class="builtinfunc" id="4483817">make</span><span class="op" id="4483821">(</span><span class="op" id="4483822">[</span><span class="op" id="4483823">]</span><span class="builtintype" id="4483824">byte</span><span class="op" id="4483828">,</span>&nbsp;<span class="num" id="4483830">4</span><span class="op" id="4483831">+</span><span class="ident" id="4483832">length</span><span class="op" id="4483838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483841">x</span><span class="op" id="4483842">[</span><span class="num" id="4483843">0</span><span class="op" id="4483844">]</span>&nbsp;<span class="op" id="4483846">=</span>&nbsp;<span class="ident" id="4483848">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483865">x</span><span class="op" id="4483866">[</span><span class="num" id="4483867">1</span><span class="op" id="4483868">]</span>&nbsp;<span class="op" id="4483870">=</span>&nbsp;<span class="builtintype" id="4483872">uint8</span><span class="op" id="4483877">(</span><span class="ident" id="4483878">length</span>&nbsp;<span class="op" id="4483885">&gt;&gt;</span>&nbsp;<span class="num" id="4483888">16</span><span class="op" id="4483890">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483893">x</span><span class="op" id="4483894">[</span><span class="num" id="4483895">2</span><span class="op" id="4483896">]</span>&nbsp;<span class="op" id="4483898">=</span>&nbsp;<span class="builtintype" id="4483900">uint8</span><span class="op" id="4483905">(</span><span class="ident" id="4483906">length</span>&nbsp;<span class="op" id="4483913">&gt;&gt;</span>&nbsp;<span class="num" id="4483916">8</span><span class="op" id="4483917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483920">x</span><span class="op" id="4483921">[</span><span class="num" id="4483922">3</span><span class="op" id="4483923">]</span>&nbsp;<span class="op" id="4483925">=</span>&nbsp;<span class="builtintype" id="4483927">uint8</span><span class="op" id="4483932">(</span><span class="ident" id="4483933">length</span><span class="op" id="4483939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483942">x</span><span class="op" id="4483943">[</span><span class="num" id="4483944">4</span><span class="op" id="4483945">]</span>&nbsp;<span class="op" id="4483947">=</span>&nbsp;<span class="builtintype" id="4483949">uint8</span><span class="op" id="4483954">(</span><span class="ident" id="4483955">m</span><span class="op" id="4483956">.</span><span class="ident" id="4483957">vers</span>&nbsp;<span class="op" id="4483962">&gt;&gt;</span>&nbsp;<span class="num" id="4483965">8</span><span class="op" id="4483966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483969">x</span><span class="op" id="4483970">[</span><span class="num" id="4483971">5</span><span class="op" id="4483972">]</span>&nbsp;<span class="op" id="4483974">=</span>&nbsp;<span class="builtintype" id="4483976">uint8</span><span class="op" id="4483981">(</span><span class="ident" id="4483982">m</span><span class="op" id="4483983">.</span><span class="ident" id="4483984">vers</span><span class="op" id="4483988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4483991">copy</span><span class="op" id="4483995">(</span><span class="ident" id="4483996">x</span><span class="op" id="4483997">[</span><span class="num" id="4483998">6</span><span class="op" id="4483999">:</span><span class="num" id="4484000">38</span><span class="op" id="4484002">]</span><span class="op" id="4484003">,</span>&nbsp;<span class="ident" id="4484005">m</span><span class="op" id="4484006">.</span><span class="ident" id="4484007">random</span><span class="op" id="4484013">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484016">x</span><span class="op" id="4484017">[</span><span class="num" id="4484018">38</span><span class="op" id="4484020">]</span>&nbsp;<span class="op" id="4484022">=</span>&nbsp;<span class="builtintype" id="4484024">uint8</span><span class="op" id="4484029">(</span><span class="builtinfunc" id="4484030">len</span><span class="op" id="4484033">(</span><span class="ident" id="4484034">m</span><span class="op" id="4484035">.</span><span class="ident" id="4484036">sessionId</span><span class="op" id="4484045">)</span><span class="op" id="4484046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4484049">copy</span><span class="op" id="4484053">(</span><span class="ident" id="4484054">x</span><span class="op" id="4484055">[</span><span class="num" id="4484056">39</span><span class="op" id="4484058">:</span><span class="num" id="4484059">39</span><span class="op" id="4484061">+</span><span class="builtinfunc" id="4484062">len</span><span class="op" id="4484065">(</span><span class="ident" id="4484066">m</span><span class="op" id="4484067">.</span><span class="ident" id="4484068">sessionId</span><span class="op" id="4484077">)</span><span class="op" id="4484078">]</span><span class="op" id="4484079">,</span>&nbsp;<span class="ident" id="4484081">m</span><span class="op" id="4484082">.</span><span class="ident" id="4484083">sessionId</span><span class="op" id="4484092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484095">y</span>&nbsp;<span class="op" id="4484097">:=</span>&nbsp;<span class="ident" id="4484100">x</span><span class="op" id="4484101">[</span><span class="num" id="4484102">39</span><span class="op" id="4484104">+</span><span class="builtinfunc" id="4484105">len</span><span class="op" id="4484108">(</span><span class="ident" id="4484109">m</span><span class="op" id="4484110">.</span><span class="ident" id="4484111">sessionId</span><span class="op" id="4484120">)</span><span class="op" id="4484121">:</span><span class="op" id="4484122">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484125">y</span><span class="op" id="4484126">[</span><span class="num" id="4484127">0</span><span class="op" id="4484128">]</span>&nbsp;<span class="op" id="4484130">=</span>&nbsp;<span class="builtintype" id="4484132">uint8</span><span class="op" id="4484137">(</span><span class="builtinfunc" id="4484138">len</span><span class="op" id="4484141">(</span><span class="ident" id="4484142">m</span><span class="op" id="4484143">.</span><span class="ident" id="4484144">cipherSuites</span><span class="op" id="4484156">)</span>&nbsp;<span class="op" id="4484158">&gt;&gt;</span>&nbsp;<span class="num" id="4484161">7</span><span class="op" id="4484162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484165">y</span><span class="op" id="4484166">[</span><span class="num" id="4484167">1</span><span class="op" id="4484168">]</span>&nbsp;<span class="op" id="4484170">=</span>&nbsp;<span class="builtintype" id="4484172">uint8</span><span class="op" id="4484177">(</span><span class="builtinfunc" id="4484178">len</span><span class="op" id="4484181">(</span><span class="ident" id="4484182">m</span><span class="op" id="4484183">.</span><span class="ident" id="4484184">cipherSuites</span><span class="op" id="4484196">)</span>&nbsp;<span class="op" id="4484198">&lt;&lt;</span>&nbsp;<span class="num" id="4484201">1</span><span class="op" id="4484202">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484205">for</span>&nbsp;<span class="ident" id="4484209">i</span><span class="op" id="4484210">,</span>&nbsp;<span class="ident" id="4484212">suite</span>&nbsp;<span class="op" id="4484218">:=</span>&nbsp;<span class="keyword" id="4484221">range</span>&nbsp;<span class="ident" id="4484227">m</span><span class="op" id="4484228">.</span><span class="ident" id="4484229">cipherSuites</span>&nbsp;<span class="op" id="4484242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484246">y</span><span class="op" id="4484247">[</span><span class="num" id="4484248">2</span><span class="op" id="4484249">+</span><span class="ident" id="4484250">i</span><span class="op" id="4484251">*</span><span class="num" id="4484252">2</span><span class="op" id="4484253">]</span>&nbsp;<span class="op" id="4484255">=</span>&nbsp;<span class="builtintype" id="4484257">uint8</span><span class="op" id="4484262">(</span><span class="ident" id="4484263">suite</span>&nbsp;<span class="op" id="4484269">&gt;&gt;</span>&nbsp;<span class="num" id="4484272">8</span><span class="op" id="4484273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484277">y</span><span class="op" id="4484278">[</span><span class="num" id="4484279">3</span><span class="op" id="4484280">+</span><span class="ident" id="4484281">i</span><span class="op" id="4484282">*</span><span class="num" id="4484283">2</span><span class="op" id="4484284">]</span>&nbsp;<span class="op" id="4484286">=</span>&nbsp;<span class="builtintype" id="4484288">uint8</span><span class="op" id="4484293">(</span><span class="ident" id="4484294">suite</span><span class="op" id="4484299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484305">z</span>&nbsp;<span class="op" id="4484307">:=</span>&nbsp;<span class="ident" id="4484310">y</span><span class="op" id="4484311">[</span><span class="num" id="4484312">2</span><span class="op" id="4484313">+</span><span class="builtinfunc" id="4484314">len</span><span class="op" id="4484317">(</span><span class="ident" id="4484318">m</span><span class="op" id="4484319">.</span><span class="ident" id="4484320">cipherSuites</span><span class="op" id="4484332">)</span><span class="op" id="4484333">*</span><span class="num" id="4484334">2</span><span class="op" id="4484335">:</span><span class="op" id="4484336">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484339">z</span><span class="op" id="4484340">[</span><span class="num" id="4484341">0</span><span class="op" id="4484342">]</span>&nbsp;<span class="op" id="4484344">=</span>&nbsp;<span class="builtintype" id="4484346">uint8</span><span class="op" id="4484351">(</span><span class="builtinfunc" id="4484352">len</span><span class="op" id="4484355">(</span><span class="ident" id="4484356">m</span><span class="op" id="4484357">.</span><span class="ident" id="4484358">compressionMethods</span><span class="op" id="4484376">)</span><span class="op" id="4484377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4484380">copy</span><span class="op" id="4484384">(</span><span class="ident" id="4484385">z</span><span class="op" id="4484386">[</span><span class="num" id="4484387">1</span><span class="op" id="4484388">:</span><span class="op" id="4484389">]</span><span class="op" id="4484390">,</span>&nbsp;<span class="ident" id="4484392">m</span><span class="op" id="4484393">.</span><span class="ident" id="4484394">compressionMethods</span><span class="op" id="4484412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484416">z</span>&nbsp;<span class="op" id="4484418">=</span>&nbsp;<span class="ident" id="4484420">z</span><span class="op" id="4484421">[</span><span class="num" id="4484422">1</span><span class="op" id="4484423">+</span><span class="builtinfunc" id="4484424">len</span><span class="op" id="4484427">(</span><span class="ident" id="4484428">m</span><span class="op" id="4484429">.</span><span class="ident" id="4484430">compressionMethods</span><span class="op" id="4484448">)</span><span class="op" id="4484449">:</span><span class="op" id="4484450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484453">if</span>&nbsp;<span class="ident" id="4484456">numExtensions</span>&nbsp;<span class="op" id="4484470">&gt;</span>&nbsp;<span class="num" id="4484472">0</span>&nbsp;<span class="op" id="4484474">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484478">z</span><span class="op" id="4484479">[</span><span class="num" id="4484480">0</span><span class="op" id="4484481">]</span>&nbsp;<span class="op" id="4484483">=</span>&nbsp;<span class="builtintype" id="4484485">byte</span><span class="op" id="4484489">(</span><span class="ident" id="4484490">extensionsLength</span>&nbsp;<span class="op" id="4484507">&gt;&gt;</span>&nbsp;<span class="num" id="4484510">8</span><span class="op" id="4484511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484515">z</span><span class="op" id="4484516">[</span><span class="num" id="4484517">1</span><span class="op" id="4484518">]</span>&nbsp;<span class="op" id="4484520">=</span>&nbsp;<span class="builtintype" id="4484522">byte</span><span class="op" id="4484526">(</span><span class="ident" id="4484527">extensionsLength</span><span class="op" id="4484543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484547">z</span>&nbsp;<span class="op" id="4484549">=</span>&nbsp;<span class="ident" id="4484551">z</span><span class="op" id="4484552">[</span><span class="num" id="4484553">2</span><span class="op" id="4484554">:</span><span class="op" id="4484555">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484561">if</span>&nbsp;<span class="ident" id="4484564">m</span><span class="op" id="4484565">.</span><span class="ident" id="4484566">nextProtoNeg</span>&nbsp;<span class="op" id="4484579">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484583">z</span><span class="op" id="4484584">[</span><span class="num" id="4484585">0</span><span class="op" id="4484586">]</span>&nbsp;<span class="op" id="4484588">=</span>&nbsp;<span class="builtintype" id="4484590">byte</span><span class="op" id="4484594">(</span><span class="ident" id="4484595">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4484617">&gt;&gt;</span>&nbsp;<span class="num" id="4484620">8</span><span class="op" id="4484621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484625">z</span><span class="op" id="4484626">[</span><span class="num" id="4484627">1</span><span class="op" id="4484628">]</span>&nbsp;<span class="op" id="4484630">=</span>&nbsp;<span class="builtintype" id="4484632">byte</span><span class="op" id="4484636">(</span><span class="ident" id="4484637">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4484659">&amp;</span>&nbsp;<span class="num" id="4484661">0xff</span><span class="op" id="4484665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484669">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484697">z</span>&nbsp;<span class="op" id="4484699">=</span>&nbsp;<span class="ident" id="4484701">z</span><span class="op" id="4484702">[</span><span class="num" id="4484703">4</span><span class="op" id="4484704">:</span><span class="op" id="4484705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484708">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484711">if</span>&nbsp;<span class="builtinfunc" id="4484714">len</span><span class="op" id="4484717">(</span><span class="ident" id="4484718">m</span><span class="op" id="4484719">.</span><span class="ident" id="4484720">serverName</span><span class="op" id="4484730">)</span>&nbsp;<span class="op" id="4484732">&gt;</span>&nbsp;<span class="num" id="4484734">0</span>&nbsp;<span class="op" id="4484736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484740">z</span><span class="op" id="4484741">[</span><span class="num" id="4484742">0</span><span class="op" id="4484743">]</span>&nbsp;<span class="op" id="4484745">=</span>&nbsp;<span class="builtintype" id="4484747">byte</span><span class="op" id="4484751">(</span><span class="ident" id="4484752">extensionServerName</span>&nbsp;<span class="op" id="4484772">&gt;&gt;</span>&nbsp;<span class="num" id="4484775">8</span><span class="op" id="4484776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484780">z</span><span class="op" id="4484781">[</span><span class="num" id="4484782">1</span><span class="op" id="4484783">]</span>&nbsp;<span class="op" id="4484785">=</span>&nbsp;<span class="builtintype" id="4484787">byte</span><span class="op" id="4484791">(</span><span class="ident" id="4484792">extensionServerName</span>&nbsp;<span class="op" id="4484812">&amp;</span>&nbsp;<span class="num" id="4484814">0xff</span><span class="op" id="4484818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484822">l</span>&nbsp;<span class="op" id="4484824">:=</span>&nbsp;<span class="builtinfunc" id="4484827">len</span><span class="op" id="4484830">(</span><span class="ident" id="4484831">m</span><span class="op" id="4484832">.</span><span class="ident" id="4484833">serverName</span><span class="op" id="4484843">)</span>&nbsp;<span class="op" id="4484845">+</span>&nbsp;<span class="num" id="4484847">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484851">z</span><span class="op" id="4484852">[</span><span class="num" id="4484853">2</span><span class="op" id="4484854">]</span>&nbsp;<span class="op" id="4484856">=</span>&nbsp;<span class="builtintype" id="4484858">byte</span><span class="op" id="4484862">(</span><span class="ident" id="4484863">l</span>&nbsp;<span class="op" id="4484865">&gt;&gt;</span>&nbsp;<span class="num" id="4484868">8</span><span class="op" id="4484869">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484873">z</span><span class="op" id="4484874">[</span><span class="num" id="4484875">3</span><span class="op" id="4484876">]</span>&nbsp;<span class="op" id="4484878">=</span>&nbsp;<span class="builtintype" id="4484880">byte</span><span class="op" id="4484884">(</span><span class="ident" id="4484885">l</span><span class="op" id="4484886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484890">z</span>&nbsp;<span class="op" id="4484892">=</span>&nbsp;<span class="ident" id="4484894">z</span><span class="op" id="4484895">[</span><span class="num" id="4484896">4</span><span class="op" id="4484897">:</span><span class="op" id="4484898">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484903">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484930">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484935">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484949">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484978">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485064">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485083">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485088">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485129">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485146">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485151">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485184">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485189">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485203">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485251">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485275">z</span><span class="op" id="4485276">[</span><span class="num" id="4485277">0</span><span class="op" id="4485278">]</span>&nbsp;<span class="op" id="4485280">=</span>&nbsp;<span class="builtintype" id="4485282">byte</span><span class="op" id="4485286">(</span><span class="op" id="4485287">(</span><span class="builtinfunc" id="4485288">len</span><span class="op" id="4485291">(</span><span class="ident" id="4485292">m</span><span class="op" id="4485293">.</span><span class="ident" id="4485294">serverName</span><span class="op" id="4485304">)</span>&nbsp;<span class="op" id="4485306">+</span>&nbsp;<span class="num" id="4485308">3</span><span class="op" id="4485309">)</span>&nbsp;<span class="op" id="4485311">&gt;&gt;</span>&nbsp;<span class="num" id="4485314">8</span><span class="op" id="4485315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485319">z</span><span class="op" id="4485320">[</span><span class="num" id="4485321">1</span><span class="op" id="4485322">]</span>&nbsp;<span class="op" id="4485324">=</span>&nbsp;<span class="builtintype" id="4485326">byte</span><span class="op" id="4485330">(</span><span class="builtinfunc" id="4485331">len</span><span class="op" id="4485334">(</span><span class="ident" id="4485335">m</span><span class="op" id="4485336">.</span><span class="ident" id="4485337">serverName</span><span class="op" id="4485347">)</span>&nbsp;<span class="op" id="4485349">+</span>&nbsp;<span class="num" id="4485351">3</span><span class="op" id="4485352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485356">z</span><span class="op" id="4485357">[</span><span class="num" id="4485358">3</span><span class="op" id="4485359">]</span>&nbsp;<span class="op" id="4485361">=</span>&nbsp;<span class="builtintype" id="4485363">byte</span><span class="op" id="4485367">(</span><span class="builtinfunc" id="4485368">len</span><span class="op" id="4485371">(</span><span class="ident" id="4485372">m</span><span class="op" id="4485373">.</span><span class="ident" id="4485374">serverName</span><span class="op" id="4485384">)</span>&nbsp;<span class="op" id="4485386">&gt;&gt;</span>&nbsp;<span class="num" id="4485389">8</span><span class="op" id="4485390">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485394">z</span><span class="op" id="4485395">[</span><span class="num" id="4485396">4</span><span class="op" id="4485397">]</span>&nbsp;<span class="op" id="4485399">=</span>&nbsp;<span class="builtintype" id="4485401">byte</span><span class="op" id="4485405">(</span><span class="builtinfunc" id="4485406">len</span><span class="op" id="4485409">(</span><span class="ident" id="4485410">m</span><span class="op" id="4485411">.</span><span class="ident" id="4485412">serverName</span><span class="op" id="4485422">)</span><span class="op" id="4485423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4485427">copy</span><span class="op" id="4485431">(</span><span class="ident" id="4485432">z</span><span class="op" id="4485433">[</span><span class="num" id="4485434">5</span><span class="op" id="4485435">:</span><span class="op" id="4485436">]</span><span class="op" id="4485437">,</span>&nbsp;<span class="op" id="4485439">[</span><span class="op" id="4485440">]</span><span class="builtintype" id="4485441">byte</span><span class="op" id="4485445">(</span><span class="ident" id="4485446">m</span><span class="op" id="4485447">.</span><span class="ident" id="4485448">serverName</span><span class="op" id="4485458">)</span><span class="op" id="4485459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485463">z</span>&nbsp;<span class="op" id="4485465">=</span>&nbsp;<span class="ident" id="4485467">z</span><span class="op" id="4485468">[</span><span class="ident" id="4485469">l</span><span class="op" id="4485470">:</span><span class="op" id="4485471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4485474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485477">if</span>&nbsp;<span class="ident" id="4485480">m</span><span class="op" id="4485481">.</span><span class="ident" id="4485482">ocspStapling</span>&nbsp;<span class="op" id="4485495">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485499">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485526">z</span><span class="op" id="4485527">[</span><span class="num" id="4485528">0</span><span class="op" id="4485529">]</span>&nbsp;<span class="op" id="4485531">=</span>&nbsp;<span class="builtintype" id="4485533">byte</span><span class="op" id="4485537">(</span><span class="ident" id="4485538">extensionStatusRequest</span>&nbsp;<span class="op" id="4485561">&gt;&gt;</span>&nbsp;<span class="num" id="4485564">8</span><span class="op" id="4485565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485569">z</span><span class="op" id="4485570">[</span><span class="num" id="4485571">1</span><span class="op" id="4485572">]</span>&nbsp;<span class="op" id="4485574">=</span>&nbsp;<span class="builtintype" id="4485576">byte</span><span class="op" id="4485580">(</span><span class="ident" id="4485581">extensionStatusRequest</span><span class="op" id="4485603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485607">z</span><span class="op" id="4485608">[</span><span class="num" id="4485609">2</span><span class="op" id="4485610">]</span>&nbsp;<span class="op" id="4485612">=</span>&nbsp;<span class="num" id="4485614">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485618">z</span><span class="op" id="4485619">[</span><span class="num" id="4485620">3</span><span class="op" id="4485621">]</span>&nbsp;<span class="op" id="4485623">=</span>&nbsp;<span class="num" id="4485625">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485629">z</span><span class="op" id="4485630">[</span><span class="num" id="4485631">4</span><span class="op" id="4485632">]</span>&nbsp;<span class="op" id="4485634">=</span>&nbsp;<span class="num" id="4485636">1</span>&nbsp;<span class="comment" id="4485638">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485653">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485703">z</span>&nbsp;<span class="op" id="4485705">=</span>&nbsp;<span class="ident" id="4485707">z</span><span class="op" id="4485708">[</span><span class="num" id="4485709">9</span><span class="op" id="4485710">:</span><span class="op" id="4485711">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4485714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485717">if</span>&nbsp;<span class="builtinfunc" id="4485720">len</span><span class="op" id="4485723">(</span><span class="ident" id="4485724">m</span><span class="op" id="4485725">.</span><span class="ident" id="4485726">supportedCurves</span><span class="op" id="4485741">)</span>&nbsp;<span class="op" id="4485743">&gt;</span>&nbsp;<span class="num" id="4485745">0</span>&nbsp;<span class="op" id="4485747">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485751">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485805">z</span><span class="op" id="4485806">[</span><span class="num" id="4485807">0</span><span class="op" id="4485808">]</span>&nbsp;<span class="op" id="4485810">=</span>&nbsp;<span class="builtintype" id="4485812">byte</span><span class="op" id="4485816">(</span><span class="ident" id="4485817">extensionSupportedCurves</span>&nbsp;<span class="op" id="4485842">&gt;&gt;</span>&nbsp;<span class="num" id="4485845">8</span><span class="op" id="4485846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485850">z</span><span class="op" id="4485851">[</span><span class="num" id="4485852">1</span><span class="op" id="4485853">]</span>&nbsp;<span class="op" id="4485855">=</span>&nbsp;<span class="builtintype" id="4485857">byte</span><span class="op" id="4485861">(</span><span class="ident" id="4485862">extensionSupportedCurves</span><span class="op" id="4485886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485890">l</span>&nbsp;<span class="op" id="4485892">:=</span>&nbsp;<span class="num" id="4485895">2</span>&nbsp;<span class="op" id="4485897">+</span>&nbsp;<span class="num" id="4485899">2</span><span class="op" id="4485900">*</span><span class="builtinfunc" id="4485901">len</span><span class="op" id="4485904">(</span><span class="ident" id="4485905">m</span><span class="op" id="4485906">.</span><span class="ident" id="4485907">supportedCurves</span><span class="op" id="4485922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485926">z</span><span class="op" id="4485927">[</span><span class="num" id="4485928">2</span><span class="op" id="4485929">]</span>&nbsp;<span class="op" id="4485931">=</span>&nbsp;<span class="builtintype" id="4485933">byte</span><span class="op" id="4485937">(</span><span class="ident" id="4485938">l</span>&nbsp;<span class="op" id="4485940">&gt;&gt;</span>&nbsp;<span class="num" id="4485943">8</span><span class="op" id="4485944">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485948">z</span><span class="op" id="4485949">[</span><span class="num" id="4485950">3</span><span class="op" id="4485951">]</span>&nbsp;<span class="op" id="4485953">=</span>&nbsp;<span class="builtintype" id="4485955">byte</span><span class="op" id="4485959">(</span><span class="ident" id="4485960">l</span><span class="op" id="4485961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485965">l</span>&nbsp;<span class="op" id="4485967">-=</span>&nbsp;<span class="num" id="4485970">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485974">z</span><span class="op" id="4485975">[</span><span class="num" id="4485976">4</span><span class="op" id="4485977">]</span>&nbsp;<span class="op" id="4485979">=</span>&nbsp;<span class="builtintype" id="4485981">byte</span><span class="op" id="4485985">(</span><span class="ident" id="4485986">l</span>&nbsp;<span class="op" id="4485988">&gt;&gt;</span>&nbsp;<span class="num" id="4485991">8</span><span class="op" id="4485992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485996">z</span><span class="op" id="4485997">[</span><span class="num" id="4485998">5</span><span class="op" id="4485999">]</span>&nbsp;<span class="op" id="4486001">=</span>&nbsp;<span class="builtintype" id="4486003">byte</span><span class="op" id="4486007">(</span><span class="ident" id="4486008">l</span><span class="op" id="4486009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486013">z</span>&nbsp;<span class="op" id="4486015">=</span>&nbsp;<span class="ident" id="4486017">z</span><span class="op" id="4486018">[</span><span class="num" id="4486019">6</span><span class="op" id="4486020">:</span><span class="op" id="4486021">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486025">for</span>&nbsp;<span class="ident" id="4486029">_</span><span class="op" id="4486030">,</span>&nbsp;<span class="ident" id="4486032">curve</span>&nbsp;<span class="op" id="4486038">:=</span>&nbsp;<span class="keyword" id="4486041">range</span>&nbsp;<span class="ident" id="4486047">m</span><span class="op" id="4486048">.</span><span class="ident" id="4486049">supportedCurves</span>&nbsp;<span class="op" id="4486065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486070">z</span><span class="op" id="4486071">[</span><span class="num" id="4486072">0</span><span class="op" id="4486073">]</span>&nbsp;<span class="op" id="4486075">=</span>&nbsp;<span class="builtintype" id="4486077">byte</span><span class="op" id="4486081">(</span><span class="ident" id="4486082">curve</span>&nbsp;<span class="op" id="4486088">&gt;&gt;</span>&nbsp;<span class="num" id="4486091">8</span><span class="op" id="4486092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486097">z</span><span class="op" id="4486098">[</span><span class="num" id="4486099">1</span><span class="op" id="4486100">]</span>&nbsp;<span class="op" id="4486102">=</span>&nbsp;<span class="builtintype" id="4486104">byte</span><span class="op" id="4486108">(</span><span class="ident" id="4486109">curve</span><span class="op" id="4486114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486119">z</span>&nbsp;<span class="op" id="4486121">=</span>&nbsp;<span class="ident" id="4486123">z</span><span class="op" id="4486124">[</span><span class="num" id="4486125">2</span><span class="op" id="4486126">:</span><span class="op" id="4486127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486131">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486137">if</span>&nbsp;<span class="builtinfunc" id="4486140">len</span><span class="op" id="4486143">(</span><span class="ident" id="4486144">m</span><span class="op" id="4486145">.</span><span class="ident" id="4486146">supportedPoints</span><span class="op" id="4486161">)</span>&nbsp;<span class="op" id="4486163">&gt;</span>&nbsp;<span class="num" id="4486165">0</span>&nbsp;<span class="op" id="4486167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4486171">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486225">z</span><span class="op" id="4486226">[</span><span class="num" id="4486227">0</span><span class="op" id="4486228">]</span>&nbsp;<span class="op" id="4486230">=</span>&nbsp;<span class="builtintype" id="4486232">byte</span><span class="op" id="4486236">(</span><span class="ident" id="4486237">extensionSupportedPoints</span>&nbsp;<span class="op" id="4486262">&gt;&gt;</span>&nbsp;<span class="num" id="4486265">8</span><span class="op" id="4486266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486270">z</span><span class="op" id="4486271">[</span><span class="num" id="4486272">1</span><span class="op" id="4486273">]</span>&nbsp;<span class="op" id="4486275">=</span>&nbsp;<span class="builtintype" id="4486277">byte</span><span class="op" id="4486281">(</span><span class="ident" id="4486282">extensionSupportedPoints</span><span class="op" id="4486306">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486310">l</span>&nbsp;<span class="op" id="4486312">:=</span>&nbsp;<span class="num" id="4486315">1</span>&nbsp;<span class="op" id="4486317">+</span>&nbsp;<span class="builtinfunc" id="4486319">len</span><span class="op" id="4486322">(</span><span class="ident" id="4486323">m</span><span class="op" id="4486324">.</span><span class="ident" id="4486325">supportedPoints</span><span class="op" id="4486340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486344">z</span><span class="op" id="4486345">[</span><span class="num" id="4486346">2</span><span class="op" id="4486347">]</span>&nbsp;<span class="op" id="4486349">=</span>&nbsp;<span class="builtintype" id="4486351">byte</span><span class="op" id="4486355">(</span><span class="ident" id="4486356">l</span>&nbsp;<span class="op" id="4486358">&gt;&gt;</span>&nbsp;<span class="num" id="4486361">8</span><span class="op" id="4486362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486366">z</span><span class="op" id="4486367">[</span><span class="num" id="4486368">3</span><span class="op" id="4486369">]</span>&nbsp;<span class="op" id="4486371">=</span>&nbsp;<span class="builtintype" id="4486373">byte</span><span class="op" id="4486377">(</span><span class="ident" id="4486378">l</span><span class="op" id="4486379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486383">l</span><span class="op" id="4486384">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486389">z</span><span class="op" id="4486390">[</span><span class="num" id="4486391">4</span><span class="op" id="4486392">]</span>&nbsp;<span class="op" id="4486394">=</span>&nbsp;<span class="builtintype" id="4486396">byte</span><span class="op" id="4486400">(</span><span class="ident" id="4486401">l</span><span class="op" id="4486402">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486406">z</span>&nbsp;<span class="op" id="4486408">=</span>&nbsp;<span class="ident" id="4486410">z</span><span class="op" id="4486411">[</span><span class="num" id="4486412">5</span><span class="op" id="4486413">:</span><span class="op" id="4486414">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486418">for</span>&nbsp;<span class="ident" id="4486422">_</span><span class="op" id="4486423">,</span>&nbsp;<span class="ident" id="4486425">pointFormat</span>&nbsp;<span class="op" id="4486437">:=</span>&nbsp;<span class="keyword" id="4486440">range</span>&nbsp;<span class="ident" id="4486446">m</span><span class="op" id="4486447">.</span><span class="ident" id="4486448">supportedPoints</span>&nbsp;<span class="op" id="4486464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486469">z</span><span class="op" id="4486470">[</span><span class="num" id="4486471">0</span><span class="op" id="4486472">]</span>&nbsp;<span class="op" id="4486474">=</span>&nbsp;<span class="builtintype" id="4486476">byte</span><span class="op" id="4486480">(</span><span class="ident" id="4486481">pointFormat</span><span class="op" id="4486492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486497">z</span>&nbsp;<span class="op" id="4486499">=</span>&nbsp;<span class="ident" id="4486501">z</span><span class="op" id="4486502">[</span><span class="num" id="4486503">1</span><span class="op" id="4486504">:</span><span class="op" id="4486505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486509">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486515">if</span>&nbsp;<span class="ident" id="4486518">m</span><span class="op" id="4486519">.</span><span class="ident" id="4486520">ticketSupported</span>&nbsp;<span class="op" id="4486536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4486540">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486592">z</span><span class="op" id="4486593">[</span><span class="num" id="4486594">0</span><span class="op" id="4486595">]</span>&nbsp;<span class="op" id="4486597">=</span>&nbsp;<span class="builtintype" id="4486599">byte</span><span class="op" id="4486603">(</span><span class="ident" id="4486604">extensionSessionTicket</span>&nbsp;<span class="op" id="4486627">&gt;&gt;</span>&nbsp;<span class="num" id="4486630">8</span><span class="op" id="4486631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486635">z</span><span class="op" id="4486636">[</span><span class="num" id="4486637">1</span><span class="op" id="4486638">]</span>&nbsp;<span class="op" id="4486640">=</span>&nbsp;<span class="builtintype" id="4486642">byte</span><span class="op" id="4486646">(</span><span class="ident" id="4486647">extensionSessionTicket</span><span class="op" id="4486669">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486673">l</span>&nbsp;<span class="op" id="4486675">:=</span>&nbsp;<span class="builtinfunc" id="4486678">len</span><span class="op" id="4486681">(</span><span class="ident" id="4486682">m</span><span class="op" id="4486683">.</span><span class="ident" id="4486684">sessionTicket</span><span class="op" id="4486697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486701">z</span><span class="op" id="4486702">[</span><span class="num" id="4486703">2</span><span class="op" id="4486704">]</span>&nbsp;<span class="op" id="4486706">=</span>&nbsp;<span class="builtintype" id="4486708">byte</span><span class="op" id="4486712">(</span><span class="ident" id="4486713">l</span>&nbsp;<span class="op" id="4486715">&gt;&gt;</span>&nbsp;<span class="num" id="4486718">8</span><span class="op" id="4486719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486723">z</span><span class="op" id="4486724">[</span><span class="num" id="4486725">3</span><span class="op" id="4486726">]</span>&nbsp;<span class="op" id="4486728">=</span>&nbsp;<span class="builtintype" id="4486730">byte</span><span class="op" id="4486734">(</span><span class="ident" id="4486735">l</span><span class="op" id="4486736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486740">z</span>&nbsp;<span class="op" id="4486742">=</span>&nbsp;<span class="ident" id="4486744">z</span><span class="op" id="4486745">[</span><span class="num" id="4486746">4</span><span class="op" id="4486747">:</span><span class="op" id="4486748">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4486752">copy</span><span class="op" id="4486756">(</span><span class="ident" id="4486757">z</span><span class="op" id="4486758">,</span>&nbsp;<span class="ident" id="4486760">m</span><span class="op" id="4486761">.</span><span class="ident" id="4486762">sessionTicket</span><span class="op" id="4486775">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486779">z</span>&nbsp;<span class="op" id="4486781">=</span>&nbsp;<span class="ident" id="4486783">z</span><span class="op" id="4486784">[</span><span class="builtinfunc" id="4486785">len</span><span class="op" id="4486788">(</span><span class="ident" id="4486789">m</span><span class="op" id="4486790">.</span><span class="ident" id="4486791">sessionTicket</span><span class="op" id="4486804">)</span><span class="op" id="4486805">:</span><span class="op" id="4486806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486812">if</span>&nbsp;<span class="builtinfunc" id="4486815">len</span><span class="op" id="4486818">(</span><span class="ident" id="4486819">m</span><span class="op" id="4486820">.</span><span class="ident" id="4486821">signatureAndHashes</span><span class="op" id="4486839">)</span>&nbsp;<span class="op" id="4486841">&gt;</span>&nbsp;<span class="num" id="4486843">0</span>&nbsp;<span class="op" id="4486845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4486849">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486908">z</span><span class="op" id="4486909">[</span><span class="num" id="4486910">0</span><span class="op" id="4486911">]</span>&nbsp;<span class="op" id="4486913">=</span>&nbsp;<span class="builtintype" id="4486915">byte</span><span class="op" id="4486919">(</span><span class="ident" id="4486920">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4486949">&gt;&gt;</span>&nbsp;<span class="num" id="4486952">8</span><span class="op" id="4486953">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486957">z</span><span class="op" id="4486958">[</span><span class="num" id="4486959">1</span><span class="op" id="4486960">]</span>&nbsp;<span class="op" id="4486962">=</span>&nbsp;<span class="builtintype" id="4486964">byte</span><span class="op" id="4486968">(</span><span class="ident" id="4486969">extensionSignatureAlgorithms</span><span class="op" id="4486997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487001">l</span>&nbsp;<span class="op" id="4487003">:=</span>&nbsp;<span class="num" id="4487006">2</span>&nbsp;<span class="op" id="4487008">+</span>&nbsp;<span class="num" id="4487010">2</span><span class="op" id="4487011">*</span><span class="builtinfunc" id="4487012">len</span><span class="op" id="4487015">(</span><span class="ident" id="4487016">m</span><span class="op" id="4487017">.</span><span class="ident" id="4487018">signatureAndHashes</span><span class="op" id="4487036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487040">z</span><span class="op" id="4487041">[</span><span class="num" id="4487042">2</span><span class="op" id="4487043">]</span>&nbsp;<span class="op" id="4487045">=</span>&nbsp;<span class="builtintype" id="4487047">byte</span><span class="op" id="4487051">(</span><span class="ident" id="4487052">l</span>&nbsp;<span class="op" id="4487054">&gt;&gt;</span>&nbsp;<span class="num" id="4487057">8</span><span class="op" id="4487058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487062">z</span><span class="op" id="4487063">[</span><span class="num" id="4487064">3</span><span class="op" id="4487065">]</span>&nbsp;<span class="op" id="4487067">=</span>&nbsp;<span class="builtintype" id="4487069">byte</span><span class="op" id="4487073">(</span><span class="ident" id="4487074">l</span><span class="op" id="4487075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487079">z</span>&nbsp;<span class="op" id="4487081">=</span>&nbsp;<span class="ident" id="4487083">z</span><span class="op" id="4487084">[</span><span class="num" id="4487085">4</span><span class="op" id="4487086">:</span><span class="op" id="4487087">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487092">l</span>&nbsp;<span class="op" id="4487094">-=</span>&nbsp;<span class="num" id="4487097">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487101">z</span><span class="op" id="4487102">[</span><span class="num" id="4487103">0</span><span class="op" id="4487104">]</span>&nbsp;<span class="op" id="4487106">=</span>&nbsp;<span class="builtintype" id="4487108">byte</span><span class="op" id="4487112">(</span><span class="ident" id="4487113">l</span>&nbsp;<span class="op" id="4487115">&gt;&gt;</span>&nbsp;<span class="num" id="4487118">8</span><span class="op" id="4487119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487123">z</span><span class="op" id="4487124">[</span><span class="num" id="4487125">1</span><span class="op" id="4487126">]</span>&nbsp;<span class="op" id="4487128">=</span>&nbsp;<span class="builtintype" id="4487130">byte</span><span class="op" id="4487134">(</span><span class="ident" id="4487135">l</span><span class="op" id="4487136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487140">z</span>&nbsp;<span class="op" id="4487142">=</span>&nbsp;<span class="ident" id="4487144">z</span><span class="op" id="4487145">[</span><span class="num" id="4487146">2</span><span class="op" id="4487147">:</span><span class="op" id="4487148">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487152">for</span>&nbsp;<span class="ident" id="4487156">_</span><span class="op" id="4487157">,</span>&nbsp;<span class="ident" id="4487159">sigAndHash</span>&nbsp;<span class="op" id="4487170">:=</span>&nbsp;<span class="keyword" id="4487173">range</span>&nbsp;<span class="ident" id="4487179">m</span><span class="op" id="4487180">.</span><span class="ident" id="4487181">signatureAndHashes</span>&nbsp;<span class="op" id="4487200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487205">z</span><span class="op" id="4487206">[</span><span class="num" id="4487207">0</span><span class="op" id="4487208">]</span>&nbsp;<span class="op" id="4487210">=</span>&nbsp;<span class="ident" id="4487212">sigAndHash</span><span class="op" id="4487222">.</span><span class="ident" id="4487223">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487231">z</span><span class="op" id="4487232">[</span><span class="num" id="4487233">1</span><span class="op" id="4487234">]</span>&nbsp;<span class="op" id="4487236">=</span>&nbsp;<span class="ident" id="4487238">sigAndHash</span><span class="op" id="4487248">.</span><span class="ident" id="4487249">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487262">z</span>&nbsp;<span class="op" id="4487264">=</span>&nbsp;<span class="ident" id="4487266">z</span><span class="op" id="4487267">[</span><span class="num" id="4487268">2</span><span class="op" id="4487269">:</span><span class="op" id="4487270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487274">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487280">if</span>&nbsp;<span class="ident" id="4487283">m</span><span class="op" id="4487284">.</span><span class="ident" id="4487285">secureRenegotiation</span>&nbsp;<span class="op" id="4487305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487309">z</span><span class="op" id="4487310">[</span><span class="num" id="4487311">0</span><span class="op" id="4487312">]</span>&nbsp;<span class="op" id="4487314">=</span>&nbsp;<span class="builtintype" id="4487316">byte</span><span class="op" id="4487320">(</span><span class="ident" id="4487321">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4487348">&gt;&gt;</span>&nbsp;<span class="num" id="4487351">8</span><span class="op" id="4487352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487356">z</span><span class="op" id="4487357">[</span><span class="num" id="4487358">1</span><span class="op" id="4487359">]</span>&nbsp;<span class="op" id="4487361">=</span>&nbsp;<span class="builtintype" id="4487363">byte</span><span class="op" id="4487367">(</span><span class="ident" id="4487368">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4487395">&amp;</span>&nbsp;<span class="num" id="4487397">0xff</span><span class="op" id="4487401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487405">z</span><span class="op" id="4487406">[</span><span class="num" id="4487407">2</span><span class="op" id="4487408">]</span>&nbsp;<span class="op" id="4487410">=</span>&nbsp;<span class="num" id="4487412">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487416">z</span><span class="op" id="4487417">[</span><span class="num" id="4487418">3</span><span class="op" id="4487419">]</span>&nbsp;<span class="op" id="4487421">=</span>&nbsp;<span class="num" id="4487423">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487427">z</span>&nbsp;<span class="op" id="4487429">=</span>&nbsp;<span class="ident" id="4487431">z</span><span class="op" id="4487432">[</span><span class="num" id="4487433">5</span><span class="op" id="4487434">:</span><span class="op" id="4487435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487441">if</span>&nbsp;<span class="builtinfunc" id="4487444">len</span><span class="op" id="4487447">(</span><span class="ident" id="4487448">m</span><span class="op" id="4487449">.</span><span class="ident" id="4487450">alpnProtocols</span><span class="op" id="4487463">)</span>&nbsp;<span class="op" id="4487465">&gt;</span>&nbsp;<span class="num" id="4487467">0</span>&nbsp;<span class="op" id="4487469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487473">z</span><span class="op" id="4487474">[</span><span class="num" id="4487475">0</span><span class="op" id="4487476">]</span>&nbsp;<span class="op" id="4487478">=</span>&nbsp;<span class="builtintype" id="4487480">byte</span><span class="op" id="4487484">(</span><span class="ident" id="4487485">extensionALPN</span>&nbsp;<span class="op" id="4487499">&gt;&gt;</span>&nbsp;<span class="num" id="4487502">8</span><span class="op" id="4487503">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487507">z</span><span class="op" id="4487508">[</span><span class="num" id="4487509">1</span><span class="op" id="4487510">]</span>&nbsp;<span class="op" id="4487512">=</span>&nbsp;<span class="builtintype" id="4487514">byte</span><span class="op" id="4487518">(</span><span class="ident" id="4487519">extensionALPN</span>&nbsp;<span class="op" id="4487533">&amp;</span>&nbsp;<span class="num" id="4487535">0xff</span><span class="op" id="4487539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487543">lengths</span>&nbsp;<span class="op" id="4487551">:=</span>&nbsp;<span class="ident" id="4487554">z</span><span class="op" id="4487555">[</span><span class="num" id="4487556">2</span><span class="op" id="4487557">:</span><span class="op" id="4487558">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487562">z</span>&nbsp;<span class="op" id="4487564">=</span>&nbsp;<span class="ident" id="4487566">z</span><span class="op" id="4487567">[</span><span class="num" id="4487568">6</span><span class="op" id="4487569">:</span><span class="op" id="4487570">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487575">stringsLength</span>&nbsp;<span class="op" id="4487589">:=</span>&nbsp;<span class="num" id="4487592">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487596">for</span>&nbsp;<span class="ident" id="4487600">_</span><span class="op" id="4487601">,</span>&nbsp;<span class="ident" id="4487603">s</span>&nbsp;<span class="op" id="4487605">:=</span>&nbsp;<span class="keyword" id="4487608">range</span>&nbsp;<span class="ident" id="4487614">m</span><span class="op" id="4487615">.</span><span class="ident" id="4487616">alpnProtocols</span>&nbsp;<span class="op" id="4487630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487635">l</span>&nbsp;<span class="op" id="4487637">:=</span>&nbsp;<span class="builtinfunc" id="4487640">len</span><span class="op" id="4487643">(</span><span class="ident" id="4487644">s</span><span class="op" id="4487645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487650">z</span><span class="op" id="4487651">[</span><span class="num" id="4487652">0</span><span class="op" id="4487653">]</span>&nbsp;<span class="op" id="4487655">=</span>&nbsp;<span class="builtintype" id="4487657">byte</span><span class="op" id="4487661">(</span><span class="ident" id="4487662">l</span><span class="op" id="4487663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4487668">copy</span><span class="op" id="4487672">(</span><span class="ident" id="4487673">z</span><span class="op" id="4487674">[</span><span class="num" id="4487675">1</span><span class="op" id="4487676">:</span><span class="op" id="4487677">]</span><span class="op" id="4487678">,</span>&nbsp;<span class="ident" id="4487680">s</span><span class="op" id="4487681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487686">z</span>&nbsp;<span class="op" id="4487688">=</span>&nbsp;<span class="ident" id="4487690">z</span><span class="op" id="4487691">[</span><span class="num" id="4487692">1</span><span class="op" id="4487693">+</span><span class="ident" id="4487694">l</span><span class="op" id="4487695">:</span><span class="op" id="4487696">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487701">stringsLength</span>&nbsp;<span class="op" id="4487715">+=</span>&nbsp;<span class="num" id="4487718">1</span>&nbsp;<span class="op" id="4487720">+</span>&nbsp;<span class="ident" id="4487722">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487731">lengths</span><span class="op" id="4487738">[</span><span class="num" id="4487739">2</span><span class="op" id="4487740">]</span>&nbsp;<span class="op" id="4487742">=</span>&nbsp;<span class="builtintype" id="4487744">byte</span><span class="op" id="4487748">(</span><span class="ident" id="4487749">stringsLength</span>&nbsp;<span class="op" id="4487763">&gt;&gt;</span>&nbsp;<span class="num" id="4487766">8</span><span class="op" id="4487767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487771">lengths</span><span class="op" id="4487778">[</span><span class="num" id="4487779">3</span><span class="op" id="4487780">]</span>&nbsp;<span class="op" id="4487782">=</span>&nbsp;<span class="builtintype" id="4487784">byte</span><span class="op" id="4487788">(</span><span class="ident" id="4487789">stringsLength</span><span class="op" id="4487802">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487806">stringsLength</span>&nbsp;<span class="op" id="4487820">+=</span>&nbsp;<span class="num" id="4487823">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487827">lengths</span><span class="op" id="4487834">[</span><span class="num" id="4487835">0</span><span class="op" id="4487836">]</span>&nbsp;<span class="op" id="4487838">=</span>&nbsp;<span class="builtintype" id="4487840">byte</span><span class="op" id="4487844">(</span><span class="ident" id="4487845">stringsLength</span>&nbsp;<span class="op" id="4487859">&gt;&gt;</span>&nbsp;<span class="num" id="4487862">8</span><span class="op" id="4487863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487867">lengths</span><span class="op" id="4487874">[</span><span class="num" id="4487875">1</span><span class="op" id="4487876">]</span>&nbsp;<span class="op" id="4487878">=</span>&nbsp;<span class="builtintype" id="4487880">byte</span><span class="op" id="4487884">(</span><span class="ident" id="4487885">stringsLength</span><span class="op" id="4487898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487905">m</span><span class="op" id="4487906">.</span><span class="ident" id="4487907">raw</span>&nbsp;<span class="op" id="4487911">=</span>&nbsp;<span class="ident" id="4487913">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487917">return</span>&nbsp;<span class="ident" id="4487924">x</span><br>
<span class="lineno"></span><span class="op" id="4487926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4487929">func</span>&nbsp;<span class="op" id="4487934">(</span><span class="ident" id="4487935">m</span>&nbsp;<span class="op" id="4487937">*</span><span class="ident" id="4487938">clientHelloMsg</span><span class="op" id="4487952">)</span>&nbsp;<span class="ident" id="4487954">unmarshal</span><span class="op" id="4487963">(</span><span class="ident" id="4487964">data</span>&nbsp;<span class="op" id="4487969">[</span><span class="op" id="4487970">]</span><span class="builtintype" id="4487971">byte</span><span class="op" id="4487975">)</span>&nbsp;<span class="builtintype" id="4487977">bool</span>&nbsp;<span class="op" id="4487982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487985">if</span>&nbsp;<span class="builtinfunc" id="4487988">len</span><span class="op" id="4487991">(</span><span class="ident" id="4487992">data</span><span class="op" id="4487996">)</span>&nbsp;<span class="op" id="4487998">&lt;</span>&nbsp;<span class="num" id="4488000">42</span>&nbsp;<span class="op" id="4488003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488007">return</span>&nbsp;<span class="builtintype" id="4488014">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488024">m</span><span class="op" id="4488025">.</span><span class="ident" id="4488026">raw</span>&nbsp;<span class="op" id="4488030">=</span>&nbsp;<span class="ident" id="4488032">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488038">m</span><span class="op" id="4488039">.</span><span class="ident" id="4488040">vers</span>&nbsp;<span class="op" id="4488045">=</span>&nbsp;<span class="builtintype" id="4488047">uint16</span><span class="op" id="4488053">(</span><span class="ident" id="4488054">data</span><span class="op" id="4488058">[</span><span class="num" id="4488059">4</span><span class="op" id="4488060">]</span><span class="op" id="4488061">)</span><span class="op" id="4488062">&lt;&lt;</span><span class="num" id="4488064">8</span>&nbsp;<span class="op" id="4488066">|</span>&nbsp;<span class="builtintype" id="4488068">uint16</span><span class="op" id="4488074">(</span><span class="ident" id="4488075">data</span><span class="op" id="4488079">[</span><span class="num" id="4488080">5</span><span class="op" id="4488081">]</span><span class="op" id="4488082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488085">m</span><span class="op" id="4488086">.</span><span class="ident" id="4488087">random</span>&nbsp;<span class="op" id="4488094">=</span>&nbsp;<span class="ident" id="4488096">data</span><span class="op" id="4488100">[</span><span class="num" id="4488101">6</span><span class="op" id="4488102">:</span><span class="num" id="4488103">38</span><span class="op" id="4488105">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488108">sessionIdLen</span>&nbsp;<span class="op" id="4488121">:=</span>&nbsp;<span class="builtintype" id="4488124">int</span><span class="op" id="4488127">(</span><span class="ident" id="4488128">data</span><span class="op" id="4488132">[</span><span class="num" id="4488133">38</span><span class="op" id="4488135">]</span><span class="op" id="4488136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488139">if</span>&nbsp;<span class="ident" id="4488142">sessionIdLen</span>&nbsp;<span class="op" id="4488155">&gt;</span>&nbsp;<span class="num" id="4488157">32</span>&nbsp;<span class="op" id="4488160">||</span>&nbsp;<span class="builtinfunc" id="4488163">len</span><span class="op" id="4488166">(</span><span class="ident" id="4488167">data</span><span class="op" id="4488171">)</span>&nbsp;<span class="op" id="4488173">&lt;</span>&nbsp;<span class="num" id="4488175">39</span><span class="op" id="4488177">+</span><span class="ident" id="4488178">sessionIdLen</span>&nbsp;<span class="op" id="4488191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488195">return</span>&nbsp;<span class="builtintype" id="4488202">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488212">m</span><span class="op" id="4488213">.</span><span class="ident" id="4488214">sessionId</span>&nbsp;<span class="op" id="4488224">=</span>&nbsp;<span class="ident" id="4488226">data</span><span class="op" id="4488230">[</span><span class="num" id="4488231">39</span>&nbsp;<span class="op" id="4488234">:</span>&nbsp;<span class="num" id="4488236">39</span><span class="op" id="4488238">+</span><span class="ident" id="4488239">sessionIdLen</span><span class="op" id="4488251">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488254">data</span>&nbsp;<span class="op" id="4488259">=</span>&nbsp;<span class="ident" id="4488261">data</span><span class="op" id="4488265">[</span><span class="num" id="4488266">39</span><span class="op" id="4488268">+</span><span class="ident" id="4488269">sessionIdLen</span><span class="op" id="4488281">:</span><span class="op" id="4488282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488285">if</span>&nbsp;<span class="builtinfunc" id="4488288">len</span><span class="op" id="4488291">(</span><span class="ident" id="4488292">data</span><span class="op" id="4488296">)</span>&nbsp;<span class="op" id="4488298">&lt;</span>&nbsp;<span class="num" id="4488300">2</span>&nbsp;<span class="op" id="4488302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488306">return</span>&nbsp;<span class="builtintype" id="4488313">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4488323">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4488396">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488443">cipherSuiteLen</span>&nbsp;<span class="op" id="4488458">:=</span>&nbsp;<span class="builtintype" id="4488461">int</span><span class="op" id="4488464">(</span><span class="ident" id="4488465">data</span><span class="op" id="4488469">[</span><span class="num" id="4488470">0</span><span class="op" id="4488471">]</span><span class="op" id="4488472">)</span><span class="op" id="4488473">&lt;&lt;</span><span class="num" id="4488475">8</span>&nbsp;<span class="op" id="4488477">|</span>&nbsp;<span class="builtintype" id="4488479">int</span><span class="op" id="4488482">(</span><span class="ident" id="4488483">data</span><span class="op" id="4488487">[</span><span class="num" id="4488488">1</span><span class="op" id="4488489">]</span><span class="op" id="4488490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488493">if</span>&nbsp;<span class="ident" id="4488496">cipherSuiteLen</span><span class="op" id="4488510">%</span><span class="num" id="4488511">2</span>&nbsp;<span class="op" id="4488513">==</span>&nbsp;<span class="num" id="4488516">1</span>&nbsp;<span class="op" id="4488518">||</span>&nbsp;<span class="builtinfunc" id="4488521">len</span><span class="op" id="4488524">(</span><span class="ident" id="4488525">data</span><span class="op" id="4488529">)</span>&nbsp;<span class="op" id="4488531">&lt;</span>&nbsp;<span class="num" id="4488533">2</span><span class="op" id="4488534">+</span><span class="ident" id="4488535">cipherSuiteLen</span>&nbsp;<span class="op" id="4488550">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488554">return</span>&nbsp;<span class="builtintype" id="4488561">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488571">numCipherSuites</span>&nbsp;<span class="op" id="4488587">:=</span>&nbsp;<span class="ident" id="4488590">cipherSuiteLen</span>&nbsp;<span class="op" id="4488605">/</span>&nbsp;<span class="num" id="4488607">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488610">m</span><span class="op" id="4488611">.</span><span class="ident" id="4488612">cipherSuites</span>&nbsp;<span class="op" id="4488625">=</span>&nbsp;<span class="builtinfunc" id="4488627">make</span><span class="op" id="4488631">(</span><span class="op" id="4488632">[</span><span class="op" id="4488633">]</span><span class="builtintype" id="4488634">uint16</span><span class="op" id="4488640">,</span>&nbsp;<span class="ident" id="4488642">numCipherSuites</span><span class="op" id="4488657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488660">for</span>&nbsp;<span class="ident" id="4488664">i</span>&nbsp;<span class="op" id="4488666">:=</span>&nbsp;<span class="num" id="4488669">0</span><span class="op" id="4488670">;</span>&nbsp;<span class="ident" id="4488672">i</span>&nbsp;<span class="op" id="4488674">&lt;</span>&nbsp;<span class="ident" id="4488676">numCipherSuites</span><span class="op" id="4488691">;</span>&nbsp;<span class="ident" id="4488693">i</span><span class="op" id="4488694">++</span>&nbsp;<span class="op" id="4488697">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488701">m</span><span class="op" id="4488702">.</span><span class="ident" id="4488703">cipherSuites</span><span class="op" id="4488715">[</span><span class="ident" id="4488716">i</span><span class="op" id="4488717">]</span>&nbsp;<span class="op" id="4488719">=</span>&nbsp;<span class="builtintype" id="4488721">uint16</span><span class="op" id="4488727">(</span><span class="ident" id="4488728">data</span><span class="op" id="4488732">[</span><span class="num" id="4488733">2</span><span class="op" id="4488734">+</span><span class="num" id="4488735">2</span><span class="op" id="4488736">*</span><span class="ident" id="4488737">i</span><span class="op" id="4488738">]</span><span class="op" id="4488739">)</span><span class="op" id="4488740">&lt;&lt;</span><span class="num" id="4488742">8</span>&nbsp;<span class="op" id="4488744">|</span>&nbsp;<span class="builtintype" id="4488746">uint16</span><span class="op" id="4488752">(</span><span class="ident" id="4488753">data</span><span class="op" id="4488757">[</span><span class="num" id="4488758">3</span><span class="op" id="4488759">+</span><span class="num" id="4488760">2</span><span class="op" id="4488761">*</span><span class="ident" id="4488762">i</span><span class="op" id="4488763">]</span><span class="op" id="4488764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488768">if</span>&nbsp;<span class="ident" id="4488771">m</span><span class="op" id="4488772">.</span><span class="ident" id="4488773">cipherSuites</span><span class="op" id="4488785">[</span><span class="ident" id="4488786">i</span><span class="op" id="4488787">]</span>&nbsp;<span class="op" id="4488789">==</span>&nbsp;<span class="ident" id="4488792">scsvRenegotiation</span>&nbsp;<span class="op" id="4488810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488815">m</span><span class="op" id="4488816">.</span><span class="ident" id="4488817">secureRenegotiation</span>&nbsp;<span class="op" id="4488837">=</span>&nbsp;<span class="builtintype" id="4488839">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488849">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488852">data</span>&nbsp;<span class="op" id="4488857">=</span>&nbsp;<span class="ident" id="4488859">data</span><span class="op" id="4488863">[</span><span class="num" id="4488864">2</span><span class="op" id="4488865">+</span><span class="ident" id="4488866">cipherSuiteLen</span><span class="op" id="4488880">:</span><span class="op" id="4488881">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488884">if</span>&nbsp;<span class="builtinfunc" id="4488887">len</span><span class="op" id="4488890">(</span><span class="ident" id="4488891">data</span><span class="op" id="4488895">)</span>&nbsp;<span class="op" id="4488897">&lt;</span>&nbsp;<span class="num" id="4488899">1</span>&nbsp;<span class="op" id="4488901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488905">return</span>&nbsp;<span class="builtintype" id="4488912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488922">compressionMethodsLen</span>&nbsp;<span class="op" id="4488944">:=</span>&nbsp;<span class="builtintype" id="4488947">int</span><span class="op" id="4488950">(</span><span class="ident" id="4488951">data</span><span class="op" id="4488955">[</span><span class="num" id="4488956">0</span><span class="op" id="4488957">]</span><span class="op" id="4488958">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488961">if</span>&nbsp;<span class="builtinfunc" id="4488964">len</span><span class="op" id="4488967">(</span><span class="ident" id="4488968">data</span><span class="op" id="4488972">)</span>&nbsp;<span class="op" id="4488974">&lt;</span>&nbsp;<span class="num" id="4488976">1</span><span class="op" id="4488977">+</span><span class="ident" id="4488978">compressionMethodsLen</span>&nbsp;<span class="op" id="4489000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489004">return</span>&nbsp;<span class="builtintype" id="4489011">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489021">m</span><span class="op" id="4489022">.</span><span class="ident" id="4489023">compressionMethods</span>&nbsp;<span class="op" id="4489042">=</span>&nbsp;<span class="ident" id="4489044">data</span><span class="op" id="4489048">[</span><span class="num" id="4489049">1</span>&nbsp;<span class="op" id="4489051">:</span>&nbsp;<span class="num" id="4489053">1</span><span class="op" id="4489054">+</span><span class="ident" id="4489055">compressionMethodsLen</span><span class="op" id="4489076">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489080">data</span>&nbsp;<span class="op" id="4489085">=</span>&nbsp;<span class="ident" id="4489087">data</span><span class="op" id="4489091">[</span><span class="num" id="4489092">1</span><span class="op" id="4489093">+</span><span class="ident" id="4489094">compressionMethodsLen</span><span class="op" id="4489115">:</span><span class="op" id="4489116">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489120">m</span><span class="op" id="4489121">.</span><span class="ident" id="4489122">nextProtoNeg</span>&nbsp;<span class="op" id="4489135">=</span>&nbsp;<span class="builtintype" id="4489137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489144">m</span><span class="op" id="4489145">.</span><span class="ident" id="4489146">serverName</span>&nbsp;<span class="op" id="4489157">=</span>&nbsp;<span class="string" id="4489159">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489163">m</span><span class="op" id="4489164">.</span><span class="ident" id="4489165">ocspStapling</span>&nbsp;<span class="op" id="4489178">=</span>&nbsp;<span class="builtintype" id="4489180">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489187">m</span><span class="op" id="4489188">.</span><span class="ident" id="4489189">ticketSupported</span>&nbsp;<span class="op" id="4489205">=</span>&nbsp;<span class="builtintype" id="4489207">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489214">m</span><span class="op" id="4489215">.</span><span class="ident" id="4489216">sessionTicket</span>&nbsp;<span class="op" id="4489230">=</span>&nbsp;<span class="ident" id="4489232">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489237">m</span><span class="op" id="4489238">.</span><span class="ident" id="4489239">signatureAndHashes</span>&nbsp;<span class="op" id="4489258">=</span>&nbsp;<span class="ident" id="4489260">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489265">m</span><span class="op" id="4489266">.</span><span class="ident" id="4489267">alpnProtocols</span>&nbsp;<span class="op" id="4489281">=</span>&nbsp;<span class="ident" id="4489283">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489289">if</span>&nbsp;<span class="builtinfunc" id="4489292">len</span><span class="op" id="4489295">(</span><span class="ident" id="4489296">data</span><span class="op" id="4489300">)</span>&nbsp;<span class="op" id="4489302">==</span>&nbsp;<span class="num" id="4489305">0</span>&nbsp;<span class="op" id="4489307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4489311">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489369">return</span>&nbsp;<span class="builtintype" id="4489376">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489385">if</span>&nbsp;<span class="builtinfunc" id="4489388">len</span><span class="op" id="4489391">(</span><span class="ident" id="4489392">data</span><span class="op" id="4489396">)</span>&nbsp;<span class="op" id="4489398">&lt;</span>&nbsp;<span class="num" id="4489400">2</span>&nbsp;<span class="op" id="4489402">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489406">return</span>&nbsp;<span class="builtintype" id="4489413">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489424">extensionsLength</span>&nbsp;<span class="op" id="4489441">:=</span>&nbsp;<span class="builtintype" id="4489444">int</span><span class="op" id="4489447">(</span><span class="ident" id="4489448">data</span><span class="op" id="4489452">[</span><span class="num" id="4489453">0</span><span class="op" id="4489454">]</span><span class="op" id="4489455">)</span><span class="op" id="4489456">&lt;&lt;</span><span class="num" id="4489458">8</span>&nbsp;<span class="op" id="4489460">|</span>&nbsp;<span class="builtintype" id="4489462">int</span><span class="op" id="4489465">(</span><span class="ident" id="4489466">data</span><span class="op" id="4489470">[</span><span class="num" id="4489471">1</span><span class="op" id="4489472">]</span><span class="op" id="4489473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489476">data</span>&nbsp;<span class="op" id="4489481">=</span>&nbsp;<span class="ident" id="4489483">data</span><span class="op" id="4489487">[</span><span class="num" id="4489488">2</span><span class="op" id="4489489">:</span><span class="op" id="4489490">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489493">if</span>&nbsp;<span class="ident" id="4489496">extensionsLength</span>&nbsp;<span class="op" id="4489513">!=</span>&nbsp;<span class="builtinfunc" id="4489516">len</span><span class="op" id="4489519">(</span><span class="ident" id="4489520">data</span><span class="op" id="4489524">)</span>&nbsp;<span class="op" id="4489526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489530">return</span>&nbsp;<span class="builtintype" id="4489537">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489548">for</span>&nbsp;<span class="builtinfunc" id="4489552">len</span><span class="op" id="4489555">(</span><span class="ident" id="4489556">data</span><span class="op" id="4489560">)</span>&nbsp;<span class="op" id="4489562">!=</span>&nbsp;<span class="num" id="4489565">0</span>&nbsp;<span class="op" id="4489567">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489571">if</span>&nbsp;<span class="builtinfunc" id="4489574">len</span><span class="op" id="4489577">(</span><span class="ident" id="4489578">data</span><span class="op" id="4489582">)</span>&nbsp;<span class="op" id="4489584">&lt;</span>&nbsp;<span class="num" id="4489586">4</span>&nbsp;<span class="op" id="4489588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489593">return</span>&nbsp;<span class="builtintype" id="4489600">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489612">extension</span>&nbsp;<span class="op" id="4489622">:=</span>&nbsp;<span class="builtintype" id="4489625">uint16</span><span class="op" id="4489631">(</span><span class="ident" id="4489632">data</span><span class="op" id="4489636">[</span><span class="num" id="4489637">0</span><span class="op" id="4489638">]</span><span class="op" id="4489639">)</span><span class="op" id="4489640">&lt;&lt;</span><span class="num" id="4489642">8</span>&nbsp;<span class="op" id="4489644">|</span>&nbsp;<span class="builtintype" id="4489646">uint16</span><span class="op" id="4489652">(</span><span class="ident" id="4489653">data</span><span class="op" id="4489657">[</span><span class="num" id="4489658">1</span><span class="op" id="4489659">]</span><span class="op" id="4489660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489664">length</span>&nbsp;<span class="op" id="4489671">:=</span>&nbsp;<span class="builtintype" id="4489674">int</span><span class="op" id="4489677">(</span><span class="ident" id="4489678">data</span><span class="op" id="4489682">[</span><span class="num" id="4489683">2</span><span class="op" id="4489684">]</span><span class="op" id="4489685">)</span><span class="op" id="4489686">&lt;&lt;</span><span class="num" id="4489688">8</span>&nbsp;<span class="op" id="4489690">|</span>&nbsp;<span class="builtintype" id="4489692">int</span><span class="op" id="4489695">(</span><span class="ident" id="4489696">data</span><span class="op" id="4489700">[</span><span class="num" id="4489701">3</span><span class="op" id="4489702">]</span><span class="op" id="4489703">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489707">data</span>&nbsp;<span class="op" id="4489712">=</span>&nbsp;<span class="ident" id="4489714">data</span><span class="op" id="4489718">[</span><span class="num" id="4489719">4</span><span class="op" id="4489720">:</span><span class="op" id="4489721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489725">if</span>&nbsp;<span class="builtinfunc" id="4489728">len</span><span class="op" id="4489731">(</span><span class="ident" id="4489732">data</span><span class="op" id="4489736">)</span>&nbsp;<span class="op" id="4489738">&lt;</span>&nbsp;<span class="ident" id="4489740">length</span>&nbsp;<span class="op" id="4489747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489752">return</span>&nbsp;<span class="builtintype" id="4489759">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489772">switch</span>&nbsp;<span class="ident" id="4489779">extension</span>&nbsp;<span class="op" id="4489789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489793">case</span>&nbsp;<span class="ident" id="4489798">extensionServerName</span><span class="op" id="4489817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489822">if</span>&nbsp;<span class="ident" id="4489825">length</span>&nbsp;<span class="op" id="4489832">&lt;</span>&nbsp;<span class="num" id="4489834">2</span>&nbsp;<span class="op" id="4489836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489842">return</span>&nbsp;<span class="builtintype" id="4489849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4489858">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489863">numNames</span>&nbsp;<span class="op" id="4489872">:=</span>&nbsp;<span class="builtintype" id="4489875">int</span><span class="op" id="4489878">(</span><span class="ident" id="4489879">data</span><span class="op" id="4489883">[</span><span class="num" id="4489884">0</span><span class="op" id="4489885">]</span><span class="op" id="4489886">)</span><span class="op" id="4489887">&lt;&lt;</span><span class="num" id="4489889">8</span>&nbsp;<span class="op" id="4489891">|</span>&nbsp;<span class="builtintype" id="4489893">int</span><span class="op" id="4489896">(</span><span class="ident" id="4489897">data</span><span class="op" id="4489901">[</span><span class="num" id="4489902">1</span><span class="op" id="4489903">]</span><span class="op" id="4489904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489909">d</span>&nbsp;<span class="op" id="4489911">:=</span>&nbsp;<span class="ident" id="4489914">data</span><span class="op" id="4489918">[</span><span class="num" id="4489919">2</span><span class="op" id="4489920">:</span><span class="op" id="4489921">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489926">for</span>&nbsp;<span class="ident" id="4489930">i</span>&nbsp;<span class="op" id="4489932">:=</span>&nbsp;<span class="num" id="4489935">0</span><span class="op" id="4489936">;</span>&nbsp;<span class="ident" id="4489938">i</span>&nbsp;<span class="op" id="4489940">&lt;</span>&nbsp;<span class="ident" id="4489942">numNames</span><span class="op" id="4489950">;</span>&nbsp;<span class="ident" id="4489952">i</span><span class="op" id="4489953">++</span>&nbsp;<span class="op" id="4489956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489962">if</span>&nbsp;<span class="builtinfunc" id="4489965">len</span><span class="op" id="4489968">(</span><span class="ident" id="4489969">d</span><span class="op" id="4489970">)</span>&nbsp;<span class="op" id="4489972">&lt;</span>&nbsp;<span class="num" id="4489974">3</span>&nbsp;<span class="op" id="4489976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489983">return</span>&nbsp;<span class="builtintype" id="4489990">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490006">nameType</span>&nbsp;<span class="op" id="4490015">:=</span>&nbsp;<span class="ident" id="4490018">d</span><span class="op" id="4490019">[</span><span class="num" id="4490020">0</span><span class="op" id="4490021">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490027">nameLen</span>&nbsp;<span class="op" id="4490035">:=</span>&nbsp;<span class="builtintype" id="4490038">int</span><span class="op" id="4490041">(</span><span class="ident" id="4490042">d</span><span class="op" id="4490043">[</span><span class="num" id="4490044">1</span><span class="op" id="4490045">]</span><span class="op" id="4490046">)</span><span class="op" id="4490047">&lt;&lt;</span><span class="num" id="4490049">8</span>&nbsp;<span class="op" id="4490051">|</span>&nbsp;<span class="builtintype" id="4490053">int</span><span class="op" id="4490056">(</span><span class="ident" id="4490057">d</span><span class="op" id="4490058">[</span><span class="num" id="4490059">2</span><span class="op" id="4490060">]</span><span class="op" id="4490061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490067">d</span>&nbsp;<span class="op" id="4490069">=</span>&nbsp;<span class="ident" id="4490071">d</span><span class="op" id="4490072">[</span><span class="num" id="4490073">3</span><span class="op" id="4490074">:</span><span class="op" id="4490075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490081">if</span>&nbsp;<span class="builtinfunc" id="4490084">len</span><span class="op" id="4490087">(</span><span class="ident" id="4490088">d</span><span class="op" id="4490089">)</span>&nbsp;<span class="op" id="4490091">&lt;</span>&nbsp;<span class="ident" id="4490093">nameLen</span>&nbsp;<span class="op" id="4490101">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490108">return</span>&nbsp;<span class="builtintype" id="4490115">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490131">if</span>&nbsp;<span class="ident" id="4490134">nameType</span>&nbsp;<span class="op" id="4490143">==</span>&nbsp;<span class="num" id="4490146">0</span>&nbsp;<span class="op" id="4490148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490155">m</span><span class="op" id="4490156">.</span><span class="ident" id="4490157">serverName</span>&nbsp;<span class="op" id="4490168">=</span>&nbsp;<span class="builtintype" id="4490170">string</span><span class="op" id="4490176">(</span><span class="ident" id="4490177">d</span><span class="op" id="4490178">[</span><span class="num" id="4490179">0</span><span class="op" id="4490180">:</span><span class="ident" id="4490181">nameLen</span><span class="op" id="4490188">]</span><span class="op" id="4490189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490196">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490212">d</span>&nbsp;<span class="op" id="4490214">=</span>&nbsp;<span class="ident" id="4490216">d</span><span class="op" id="4490217">[</span><span class="ident" id="4490218">nameLen</span><span class="op" id="4490225">:</span><span class="op" id="4490226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490235">case</span>&nbsp;<span class="ident" id="4490240">extensionNextProtoNeg</span><span class="op" id="4490261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490266">if</span>&nbsp;<span class="ident" id="4490269">length</span>&nbsp;<span class="op" id="4490276">&gt;</span>&nbsp;<span class="num" id="4490278">0</span>&nbsp;<span class="op" id="4490280">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490286">return</span>&nbsp;<span class="builtintype" id="4490293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490307">m</span><span class="op" id="4490308">.</span><span class="ident" id="4490309">nextProtoNeg</span>&nbsp;<span class="op" id="4490322">=</span>&nbsp;<span class="builtintype" id="4490324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490331">case</span>&nbsp;<span class="ident" id="4490336">extensionStatusRequest</span><span class="op" id="4490358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490363">m</span><span class="op" id="4490364">.</span><span class="ident" id="4490365">ocspStapling</span>&nbsp;<span class="op" id="4490378">=</span>&nbsp;<span class="ident" id="4490380">length</span>&nbsp;<span class="op" id="4490387">&gt;</span>&nbsp;<span class="num" id="4490389">0</span>&nbsp;<span class="op" id="4490391">&amp;&amp;</span>&nbsp;<span class="ident" id="4490394">data</span><span class="op" id="4490398">[</span><span class="num" id="4490399">0</span><span class="op" id="4490400">]</span>&nbsp;<span class="op" id="4490402">==</span>&nbsp;<span class="ident" id="4490405">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490422">case</span>&nbsp;<span class="ident" id="4490427">extensionSupportedCurves</span><span class="op" id="4490451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4490456">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490511">if</span>&nbsp;<span class="ident" id="4490514">length</span>&nbsp;<span class="op" id="4490521">&lt;</span>&nbsp;<span class="num" id="4490523">2</span>&nbsp;<span class="op" id="4490525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490531">return</span>&nbsp;<span class="builtintype" id="4490538">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490547">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490552">l</span>&nbsp;<span class="op" id="4490554">:=</span>&nbsp;<span class="builtintype" id="4490557">int</span><span class="op" id="4490560">(</span><span class="ident" id="4490561">data</span><span class="op" id="4490565">[</span><span class="num" id="4490566">0</span><span class="op" id="4490567">]</span><span class="op" id="4490568">)</span><span class="op" id="4490569">&lt;&lt;</span><span class="num" id="4490571">8</span>&nbsp;<span class="op" id="4490573">|</span>&nbsp;<span class="builtintype" id="4490575">int</span><span class="op" id="4490578">(</span><span class="ident" id="4490579">data</span><span class="op" id="4490583">[</span><span class="num" id="4490584">1</span><span class="op" id="4490585">]</span><span class="op" id="4490586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490591">if</span>&nbsp;<span class="ident" id="4490594">l</span><span class="op" id="4490595">%</span><span class="num" id="4490596">2</span>&nbsp;<span class="op" id="4490598">==</span>&nbsp;<span class="num" id="4490601">1</span>&nbsp;<span class="op" id="4490603">||</span>&nbsp;<span class="ident" id="4490606">length</span>&nbsp;<span class="op" id="4490613">!=</span>&nbsp;<span class="ident" id="4490616">l</span><span class="op" id="4490617">+</span><span class="num" id="4490618">2</span>&nbsp;<span class="op" id="4490620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490626">return</span>&nbsp;<span class="builtintype" id="4490633">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490647">numCurves</span>&nbsp;<span class="op" id="4490657">:=</span>&nbsp;<span class="ident" id="4490660">l</span>&nbsp;<span class="op" id="4490662">/</span>&nbsp;<span class="num" id="4490664">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490669">m</span><span class="op" id="4490670">.</span><span class="ident" id="4490671">supportedCurves</span>&nbsp;<span class="op" id="4490687">=</span>&nbsp;<span class="builtinfunc" id="4490689">make</span><span class="op" id="4490693">(</span><span class="op" id="4490694">[</span><span class="op" id="4490695">]</span><span class="ident" id="4490696">CurveID</span><span class="op" id="4490703">,</span>&nbsp;<span class="ident" id="4490705">numCurves</span><span class="op" id="4490714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490719">d</span>&nbsp;<span class="op" id="4490721">:=</span>&nbsp;<span class="ident" id="4490724">data</span><span class="op" id="4490728">[</span><span class="num" id="4490729">2</span><span class="op" id="4490730">:</span><span class="op" id="4490731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490736">for</span>&nbsp;<span class="ident" id="4490740">i</span>&nbsp;<span class="op" id="4490742">:=</span>&nbsp;<span class="num" id="4490745">0</span><span class="op" id="4490746">;</span>&nbsp;<span class="ident" id="4490748">i</span>&nbsp;<span class="op" id="4490750">&lt;</span>&nbsp;<span class="ident" id="4490752">numCurves</span><span class="op" id="4490761">;</span>&nbsp;<span class="ident" id="4490763">i</span><span class="op" id="4490764">++</span>&nbsp;<span class="op" id="4490767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490773">m</span><span class="op" id="4490774">.</span><span class="ident" id="4490775">supportedCurves</span><span class="op" id="4490790">[</span><span class="ident" id="4490791">i</span><span class="op" id="4490792">]</span>&nbsp;<span class="op" id="4490794">=</span>&nbsp;<span class="ident" id="4490796">CurveID</span><span class="op" id="4490803">(</span><span class="ident" id="4490804">d</span><span class="op" id="4490805">[</span><span class="num" id="4490806">0</span><span class="op" id="4490807">]</span><span class="op" id="4490808">)</span><span class="op" id="4490809">&lt;&lt;</span><span class="num" id="4490811">8</span>&nbsp;<span class="op" id="4490813">|</span>&nbsp;<span class="ident" id="4490815">CurveID</span><span class="op" id="4490822">(</span><span class="ident" id="4490823">d</span><span class="op" id="4490824">[</span><span class="num" id="4490825">1</span><span class="op" id="4490826">]</span><span class="op" id="4490827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490833">d</span>&nbsp;<span class="op" id="4490835">=</span>&nbsp;<span class="ident" id="4490837">d</span><span class="op" id="4490838">[</span><span class="num" id="4490839">2</span><span class="op" id="4490840">:</span><span class="op" id="4490841">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490850">case</span>&nbsp;<span class="ident" id="4490855">extensionSupportedPoints</span><span class="op" id="4490879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4490884">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490939">if</span>&nbsp;<span class="ident" id="4490942">length</span>&nbsp;<span class="op" id="4490949">&lt;</span>&nbsp;<span class="num" id="4490951">1</span>&nbsp;<span class="op" id="4490953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4490959">return</span>&nbsp;<span class="builtintype" id="4490966">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4490975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4490980">l</span>&nbsp;<span class="op" id="4490982">:=</span>&nbsp;<span class="builtintype" id="4490985">int</span><span class="op" id="4490988">(</span><span class="ident" id="4490989">data</span><span class="op" id="4490993">[</span><span class="num" id="4490994">0</span><span class="op" id="4490995">]</span><span class="op" id="4490996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491001">if</span>&nbsp;<span class="ident" id="4491004">length</span>&nbsp;<span class="op" id="4491011">!=</span>&nbsp;<span class="ident" id="4491014">l</span><span class="op" id="4491015">+</span><span class="num" id="4491016">1</span>&nbsp;<span class="op" id="4491018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491024">return</span>&nbsp;<span class="builtintype" id="4491031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491040">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491045">m</span><span class="op" id="4491046">.</span><span class="ident" id="4491047">supportedPoints</span>&nbsp;<span class="op" id="4491063">=</span>&nbsp;<span class="builtinfunc" id="4491065">make</span><span class="op" id="4491069">(</span><span class="op" id="4491070">[</span><span class="op" id="4491071">]</span><span class="builtintype" id="4491072">uint8</span><span class="op" id="4491077">,</span>&nbsp;<span class="ident" id="4491079">l</span><span class="op" id="4491080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4491085">copy</span><span class="op" id="4491089">(</span><span class="ident" id="4491090">m</span><span class="op" id="4491091">.</span><span class="ident" id="4491092">supportedPoints</span><span class="op" id="4491107">,</span>&nbsp;<span class="ident" id="4491109">data</span><span class="op" id="4491113">[</span><span class="num" id="4491114">1</span><span class="op" id="4491115">:</span><span class="op" id="4491116">]</span><span class="op" id="4491117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491121">case</span>&nbsp;<span class="ident" id="4491126">extensionSessionTicket</span><span class="op" id="4491148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4491153">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491206">m</span><span class="op" id="4491207">.</span><span class="ident" id="4491208">ticketSupported</span>&nbsp;<span class="op" id="4491224">=</span>&nbsp;<span class="builtintype" id="4491226">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491234">m</span><span class="op" id="4491235">.</span><span class="ident" id="4491236">sessionTicket</span>&nbsp;<span class="op" id="4491250">=</span>&nbsp;<span class="ident" id="4491252">data</span><span class="op" id="4491256">[</span><span class="op" id="4491257">:</span><span class="ident" id="4491258">length</span><span class="op" id="4491264">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491268">case</span>&nbsp;<span class="ident" id="4491273">extensionSignatureAlgorithms</span><span class="op" id="4491301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4491306">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491366">if</span>&nbsp;<span class="ident" id="4491369">length</span>&nbsp;<span class="op" id="4491376">&lt;</span>&nbsp;<span class="num" id="4491378">2</span>&nbsp;<span class="op" id="4491380">||</span>&nbsp;<span class="ident" id="4491383">length</span><span class="op" id="4491389">&amp;</span><span class="num" id="4491390">1</span>&nbsp;<span class="op" id="4491392">!=</span>&nbsp;<span class="num" id="4491395">0</span>&nbsp;<span class="op" id="4491397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491403">return</span>&nbsp;<span class="builtintype" id="4491410">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491424">l</span>&nbsp;<span class="op" id="4491426">:=</span>&nbsp;<span class="builtintype" id="4491429">int</span><span class="op" id="4491432">(</span><span class="ident" id="4491433">data</span><span class="op" id="4491437">[</span><span class="num" id="4491438">0</span><span class="op" id="4491439">]</span><span class="op" id="4491440">)</span><span class="op" id="4491441">&lt;&lt;</span><span class="num" id="4491443">8</span>&nbsp;<span class="op" id="4491445">|</span>&nbsp;<span class="builtintype" id="4491447">int</span><span class="op" id="4491450">(</span><span class="ident" id="4491451">data</span><span class="op" id="4491455">[</span><span class="num" id="4491456">1</span><span class="op" id="4491457">]</span><span class="op" id="4491458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491463">if</span>&nbsp;<span class="ident" id="4491466">l</span>&nbsp;<span class="op" id="4491468">!=</span>&nbsp;<span class="ident" id="4491471">length</span><span class="op" id="4491477">-</span><span class="num" id="4491478">2</span>&nbsp;<span class="op" id="4491480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491486">return</span>&nbsp;<span class="builtintype" id="4491493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491502">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491507">n</span>&nbsp;<span class="op" id="4491509">:=</span>&nbsp;<span class="ident" id="4491512">l</span>&nbsp;<span class="op" id="4491514">/</span>&nbsp;<span class="num" id="4491516">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491521">d</span>&nbsp;<span class="op" id="4491523">:=</span>&nbsp;<span class="ident" id="4491526">data</span><span class="op" id="4491530">[</span><span class="num" id="4491531">2</span><span class="op" id="4491532">:</span><span class="op" id="4491533">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491538">m</span><span class="op" id="4491539">.</span><span class="ident" id="4491540">signatureAndHashes</span>&nbsp;<span class="op" id="4491559">=</span>&nbsp;<span class="builtinfunc" id="4491561">make</span><span class="op" id="4491565">(</span><span class="op" id="4491566">[</span><span class="op" id="4491567">]</span><span class="ident" id="4491568">signatureAndHash</span><span class="op" id="4491584">,</span>&nbsp;<span class="ident" id="4491586">n</span><span class="op" id="4491587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491592">for</span>&nbsp;<span class="ident" id="4491596">i</span>&nbsp;<span class="op" id="4491598">:=</span>&nbsp;<span class="keyword" id="4491601">range</span>&nbsp;<span class="ident" id="4491607">m</span><span class="op" id="4491608">.</span><span class="ident" id="4491609">signatureAndHashes</span>&nbsp;<span class="op" id="4491628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491634">m</span><span class="op" id="4491635">.</span><span class="ident" id="4491636">signatureAndHashes</span><span class="op" id="4491654">[</span><span class="ident" id="4491655">i</span><span class="op" id="4491656">]</span><span class="op" id="4491657">.</span><span class="ident" id="4491658">hash</span>&nbsp;<span class="op" id="4491663">=</span>&nbsp;<span class="ident" id="4491665">d</span><span class="op" id="4491666">[</span><span class="num" id="4491667">0</span><span class="op" id="4491668">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491674">m</span><span class="op" id="4491675">.</span><span class="ident" id="4491676">signatureAndHashes</span><span class="op" id="4491694">[</span><span class="ident" id="4491695">i</span><span class="op" id="4491696">]</span><span class="op" id="4491697">.</span><span class="ident" id="4491698">signature</span>&nbsp;<span class="op" id="4491708">=</span>&nbsp;<span class="ident" id="4491710">d</span><span class="op" id="4491711">[</span><span class="num" id="4491712">1</span><span class="op" id="4491713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491719">d</span>&nbsp;<span class="op" id="4491721">=</span>&nbsp;<span class="ident" id="4491723">d</span><span class="op" id="4491724">[</span><span class="num" id="4491725">2</span><span class="op" id="4491726">:</span><span class="op" id="4491727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491736">case</span>&nbsp;<span class="ident" id="4491741">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4491768">+</span>&nbsp;<span class="num" id="4491770">1</span><span class="op" id="4491771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491776">if</span>&nbsp;<span class="ident" id="4491779">length</span>&nbsp;<span class="op" id="4491786">!=</span>&nbsp;<span class="num" id="4491789">1</span>&nbsp;<span class="op" id="4491791">||</span>&nbsp;<span class="ident" id="4491794">data</span><span class="op" id="4491798">[</span><span class="num" id="4491799">0</span><span class="op" id="4491800">]</span>&nbsp;<span class="op" id="4491802">!=</span>&nbsp;<span class="num" id="4491805">0</span>&nbsp;<span class="op" id="4491807">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491813">return</span>&nbsp;<span class="builtintype" id="4491820">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491834">m</span><span class="op" id="4491835">.</span><span class="ident" id="4491836">secureRenegotiation</span>&nbsp;<span class="op" id="4491856">=</span>&nbsp;<span class="builtintype" id="4491858">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491865">case</span>&nbsp;<span class="ident" id="4491870">extensionALPN</span><span class="op" id="4491883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491888">if</span>&nbsp;<span class="ident" id="4491891">length</span>&nbsp;<span class="op" id="4491898">&lt;</span>&nbsp;<span class="num" id="4491900">2</span>&nbsp;<span class="op" id="4491902">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491908">return</span>&nbsp;<span class="builtintype" id="4491915">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4491924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4491929">l</span>&nbsp;<span class="op" id="4491931">:=</span>&nbsp;<span class="builtintype" id="4491934">int</span><span class="op" id="4491937">(</span><span class="ident" id="4491938">data</span><span class="op" id="4491942">[</span><span class="num" id="4491943">0</span><span class="op" id="4491944">]</span><span class="op" id="4491945">)</span><span class="op" id="4491946">&lt;&lt;</span><span class="num" id="4491948">8</span>&nbsp;<span class="op" id="4491950">|</span>&nbsp;<span class="builtintype" id="4491952">int</span><span class="op" id="4491955">(</span><span class="ident" id="4491956">data</span><span class="op" id="4491960">[</span><span class="num" id="4491961">1</span><span class="op" id="4491962">]</span><span class="op" id="4491963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491968">if</span>&nbsp;<span class="ident" id="4491971">l</span>&nbsp;<span class="op" id="4491973">!=</span>&nbsp;<span class="ident" id="4491976">length</span><span class="op" id="4491982">-</span><span class="num" id="4491983">2</span>&nbsp;<span class="op" id="4491985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4491991">return</span>&nbsp;<span class="builtintype" id="4491998">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492012">d</span>&nbsp;<span class="op" id="4492014">:=</span>&nbsp;<span class="ident" id="4492017">data</span><span class="op" id="4492021">[</span><span class="num" id="4492022">2</span><span class="op" id="4492023">:</span><span class="ident" id="4492024">length</span><span class="op" id="4492030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492035">for</span>&nbsp;<span class="builtinfunc" id="4492039">len</span><span class="op" id="4492042">(</span><span class="ident" id="4492043">d</span><span class="op" id="4492044">)</span>&nbsp;<span class="op" id="4492046">!=</span>&nbsp;<span class="num" id="4492049">0</span>&nbsp;<span class="op" id="4492051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492057">stringLen</span>&nbsp;<span class="op" id="4492067">:=</span>&nbsp;<span class="builtintype" id="4492070">int</span><span class="op" id="4492073">(</span><span class="ident" id="4492074">d</span><span class="op" id="4492075">[</span><span class="num" id="4492076">0</span><span class="op" id="4492077">]</span><span class="op" id="4492078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492084">d</span>&nbsp;<span class="op" id="4492086">=</span>&nbsp;<span class="ident" id="4492088">d</span><span class="op" id="4492089">[</span><span class="num" id="4492090">1</span><span class="op" id="4492091">:</span><span class="op" id="4492092">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492098">if</span>&nbsp;<span class="ident" id="4492101">stringLen</span>&nbsp;<span class="op" id="4492111">==</span>&nbsp;<span class="num" id="4492114">0</span>&nbsp;<span class="op" id="4492116">||</span>&nbsp;<span class="ident" id="4492119">stringLen</span>&nbsp;<span class="op" id="4492129">&gt;</span>&nbsp;<span class="builtinfunc" id="4492131">len</span><span class="op" id="4492134">(</span><span class="ident" id="4492135">d</span><span class="op" id="4492136">)</span>&nbsp;<span class="op" id="4492138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492145">return</span>&nbsp;<span class="builtintype" id="4492152">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492168">m</span><span class="op" id="4492169">.</span><span class="ident" id="4492170">alpnProtocols</span>&nbsp;<span class="op" id="4492184">=</span>&nbsp;<span class="builtinfunc" id="4492186">append</span><span class="op" id="4492192">(</span><span class="ident" id="4492193">m</span><span class="op" id="4492194">.</span><span class="ident" id="4492195">alpnProtocols</span><span class="op" id="4492208">,</span>&nbsp;<span class="builtintype" id="4492210">string</span><span class="op" id="4492216">(</span><span class="ident" id="4492217">d</span><span class="op" id="4492218">[</span><span class="op" id="4492219">:</span><span class="ident" id="4492220">stringLen</span><span class="op" id="4492229">]</span><span class="op" id="4492230">)</span><span class="op" id="4492231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492237">d</span>&nbsp;<span class="op" id="4492239">=</span>&nbsp;<span class="ident" id="4492241">d</span><span class="op" id="4492242">[</span><span class="ident" id="4492243">stringLen</span><span class="op" id="4492252">:</span><span class="op" id="4492253">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492266">data</span>&nbsp;<span class="op" id="4492271">=</span>&nbsp;<span class="ident" id="4492273">data</span><span class="op" id="4492277">[</span><span class="ident" id="4492278">length</span><span class="op" id="4492284">:</span><span class="op" id="4492285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492292">return</span>&nbsp;<span class="builtintype" id="4492299">true</span><br>
<span class="lineno"></span><span class="op" id="4492304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4492307">type</span>&nbsp;<span class="ident" id="4492312">serverHelloMsg</span>&nbsp;<span class="keyword" id="4492327">struct</span>&nbsp;<span class="op" id="4492334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492337">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4492357">[</span><span class="op" id="4492358">]</span><span class="builtintype" id="4492359">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492365">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492385">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492393">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4492413">[</span><span class="op" id="4492414">]</span><span class="builtintype" id="4492415">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492421">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4492441">[</span><span class="op" id="4492442">]</span><span class="builtintype" id="4492443">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492449">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492469">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492477">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492497">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492504">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492524">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492530">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4492550">[</span><span class="op" id="4492551">]</span><span class="builtintype" id="4492552">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492560">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492580">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492586">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492606">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492612">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4492632">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492638">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4492658">string</span><br>
<span class="lineno"></span><span class="op" id="4492665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4492668">func</span>&nbsp;<span class="op" id="4492673">(</span><span class="ident" id="4492674">m</span>&nbsp;<span class="op" id="4492676">*</span><span class="ident" id="4492677">serverHelloMsg</span><span class="op" id="4492691">)</span>&nbsp;<span class="ident" id="4492693">equal</span><span class="op" id="4492698">(</span><span class="ident" id="4492699">i</span>&nbsp;<span class="keyword" id="4492701">interface</span><span class="op" id="4492710">{</span><span class="op" id="4492711">}</span><span class="op" id="4492712">)</span>&nbsp;<span class="builtintype" id="4492714">bool</span>&nbsp;<span class="op" id="4492719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492722">m1</span><span class="op" id="4492724">,</span>&nbsp;<span class="ident" id="4492726">ok</span>&nbsp;<span class="op" id="4492729">:=</span>&nbsp;<span class="ident" id="4492732">i</span><span class="op" id="4492733">.</span><span class="op" id="4492734">(</span><span class="op" id="4492735">*</span><span class="ident" id="4492736">serverHelloMsg</span><span class="op" id="4492750">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492753">if</span>&nbsp;<span class="op" id="4492756">!</span><span class="ident" id="4492757">ok</span>&nbsp;<span class="op" id="4492760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492764">return</span>&nbsp;<span class="builtintype" id="4492771">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4492778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4492782">return</span>&nbsp;<span class="ident" id="4492789">bytes</span><span class="op" id="4492794">.</span><span class="ident" id="4492795">Equal</span><span class="op" id="4492800">(</span><span class="ident" id="4492801">m</span><span class="op" id="4492802">.</span><span class="ident" id="4492803">raw</span><span class="op" id="4492806">,</span>&nbsp;<span class="ident" id="4492808">m1</span><span class="op" id="4492810">.</span><span class="ident" id="4492811">raw</span><span class="op" id="4492814">)</span>&nbsp;<span class="op" id="4492816">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492821">m</span><span class="op" id="4492822">.</span><span class="ident" id="4492823">vers</span>&nbsp;<span class="op" id="4492828">==</span>&nbsp;<span class="ident" id="4492831">m1</span><span class="op" id="4492833">.</span><span class="ident" id="4492834">vers</span>&nbsp;<span class="op" id="4492839">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492844">bytes</span><span class="op" id="4492849">.</span><span class="ident" id="4492850">Equal</span><span class="op" id="4492855">(</span><span class="ident" id="4492856">m</span><span class="op" id="4492857">.</span><span class="ident" id="4492858">random</span><span class="op" id="4492864">,</span>&nbsp;<span class="ident" id="4492866">m1</span><span class="op" id="4492868">.</span><span class="ident" id="4492869">random</span><span class="op" id="4492875">)</span>&nbsp;<span class="op" id="4492877">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492882">bytes</span><span class="op" id="4492887">.</span><span class="ident" id="4492888">Equal</span><span class="op" id="4492893">(</span><span class="ident" id="4492894">m</span><span class="op" id="4492895">.</span><span class="ident" id="4492896">sessionId</span><span class="op" id="4492905">,</span>&nbsp;<span class="ident" id="4492907">m1</span><span class="op" id="4492909">.</span><span class="ident" id="4492910">sessionId</span><span class="op" id="4492919">)</span>&nbsp;<span class="op" id="4492921">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492926">m</span><span class="op" id="4492927">.</span><span class="ident" id="4492928">cipherSuite</span>&nbsp;<span class="op" id="4492940">==</span>&nbsp;<span class="ident" id="4492943">m1</span><span class="op" id="4492945">.</span><span class="ident" id="4492946">cipherSuite</span>&nbsp;<span class="op" id="4492958">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4492963">m</span><span class="op" id="4492964">.</span><span class="ident" id="4492965">compressionMethod</span>&nbsp;<span class="op" id="4492983">==</span>&nbsp;<span class="ident" id="4492986">m1</span><span class="op" id="4492988">.</span><span class="ident" id="4492989">compressionMethod</span>&nbsp;<span class="op" id="4493007">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493012">m</span><span class="op" id="4493013">.</span><span class="ident" id="4493014">nextProtoNeg</span>&nbsp;<span class="op" id="4493027">==</span>&nbsp;<span class="ident" id="4493030">m1</span><span class="op" id="4493032">.</span><span class="ident" id="4493033">nextProtoNeg</span>&nbsp;<span class="op" id="4493046">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493051">eqStrings</span><span class="op" id="4493060">(</span><span class="ident" id="4493061">m</span><span class="op" id="4493062">.</span><span class="ident" id="4493063">nextProtos</span><span class="op" id="4493073">,</span>&nbsp;<span class="ident" id="4493075">m1</span><span class="op" id="4493077">.</span><span class="ident" id="4493078">nextProtos</span><span class="op" id="4493088">)</span>&nbsp;<span class="op" id="4493090">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493095">m</span><span class="op" id="4493096">.</span><span class="ident" id="4493097">ocspStapling</span>&nbsp;<span class="op" id="4493110">==</span>&nbsp;<span class="ident" id="4493113">m1</span><span class="op" id="4493115">.</span><span class="ident" id="4493116">ocspStapling</span>&nbsp;<span class="op" id="4493129">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493134">m</span><span class="op" id="4493135">.</span><span class="ident" id="4493136">ticketSupported</span>&nbsp;<span class="op" id="4493152">==</span>&nbsp;<span class="ident" id="4493155">m1</span><span class="op" id="4493157">.</span><span class="ident" id="4493158">ticketSupported</span>&nbsp;<span class="op" id="4493174">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493179">m</span><span class="op" id="4493180">.</span><span class="ident" id="4493181">secureRenegotiation</span>&nbsp;<span class="op" id="4493201">==</span>&nbsp;<span class="ident" id="4493204">m1</span><span class="op" id="4493206">.</span><span class="ident" id="4493207">secureRenegotiation</span>&nbsp;<span class="op" id="4493227">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493232">m</span><span class="op" id="4493233">.</span><span class="ident" id="4493234">alpnProtocol</span>&nbsp;<span class="op" id="4493247">==</span>&nbsp;<span class="ident" id="4493250">m1</span><span class="op" id="4493252">.</span><span class="ident" id="4493253">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4493266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4493269">func</span>&nbsp;<span class="op" id="4493274">(</span><span class="ident" id="4493275">m</span>&nbsp;<span class="op" id="4493277">*</span><span class="ident" id="4493278">serverHelloMsg</span><span class="op" id="4493292">)</span>&nbsp;<span class="ident" id="4493294">marshal</span><span class="op" id="4493301">(</span><span class="op" id="4493302">)</span>&nbsp;<span class="op" id="4493304">[</span><span class="op" id="4493305">]</span><span class="builtintype" id="4493306">byte</span>&nbsp;<span class="op" id="4493311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493314">if</span>&nbsp;<span class="ident" id="4493317">m</span><span class="op" id="4493318">.</span><span class="ident" id="4493319">raw</span>&nbsp;<span class="op" id="4493323">!=</span>&nbsp;<span class="ident" id="4493326">nil</span>&nbsp;<span class="op" id="4493330">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493334">return</span>&nbsp;<span class="ident" id="4493341">m</span><span class="op" id="4493342">.</span><span class="ident" id="4493343">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493352">length</span>&nbsp;<span class="op" id="4493359">:=</span>&nbsp;<span class="num" id="4493362">38</span>&nbsp;<span class="op" id="4493365">+</span>&nbsp;<span class="builtinfunc" id="4493367">len</span><span class="op" id="4493370">(</span><span class="ident" id="4493371">m</span><span class="op" id="4493372">.</span><span class="ident" id="4493373">sessionId</span><span class="op" id="4493382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493385">numExtensions</span>&nbsp;<span class="op" id="4493399">:=</span>&nbsp;<span class="num" id="4493402">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493405">extensionsLength</span>&nbsp;<span class="op" id="4493422">:=</span>&nbsp;<span class="num" id="4493425">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493429">nextProtoLen</span>&nbsp;<span class="op" id="4493442">:=</span>&nbsp;<span class="num" id="4493445">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493448">if</span>&nbsp;<span class="ident" id="4493451">m</span><span class="op" id="4493452">.</span><span class="ident" id="4493453">nextProtoNeg</span>&nbsp;<span class="op" id="4493466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493470">numExtensions</span><span class="op" id="4493483">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493488">for</span>&nbsp;<span class="ident" id="4493492">_</span><span class="op" id="4493493">,</span>&nbsp;<span class="ident" id="4493495">v</span>&nbsp;<span class="op" id="4493497">:=</span>&nbsp;<span class="keyword" id="4493500">range</span>&nbsp;<span class="ident" id="4493506">m</span><span class="op" id="4493507">.</span><span class="ident" id="4493508">nextProtos</span>&nbsp;<span class="op" id="4493519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493524">nextProtoLen</span>&nbsp;<span class="op" id="4493537">+=</span>&nbsp;<span class="builtinfunc" id="4493540">len</span><span class="op" id="4493543">(</span><span class="ident" id="4493544">v</span><span class="op" id="4493545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493553">nextProtoLen</span>&nbsp;<span class="op" id="4493566">+=</span>&nbsp;<span class="builtinfunc" id="4493569">len</span><span class="op" id="4493572">(</span><span class="ident" id="4493573">m</span><span class="op" id="4493574">.</span><span class="ident" id="4493575">nextProtos</span><span class="op" id="4493585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493589">extensionsLength</span>&nbsp;<span class="op" id="4493606">+=</span>&nbsp;<span class="ident" id="4493609">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493626">if</span>&nbsp;<span class="ident" id="4493629">m</span><span class="op" id="4493630">.</span><span class="ident" id="4493631">ocspStapling</span>&nbsp;<span class="op" id="4493644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493648">numExtensions</span><span class="op" id="4493661">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493668">if</span>&nbsp;<span class="ident" id="4493671">m</span><span class="op" id="4493672">.</span><span class="ident" id="4493673">ticketSupported</span>&nbsp;<span class="op" id="4493689">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493693">numExtensions</span><span class="op" id="4493706">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493713">if</span>&nbsp;<span class="ident" id="4493716">m</span><span class="op" id="4493717">.</span><span class="ident" id="4493718">secureRenegotiation</span>&nbsp;<span class="op" id="4493738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493742">extensionsLength</span>&nbsp;<span class="op" id="4493759">+=</span>&nbsp;<span class="num" id="4493762">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493766">numExtensions</span><span class="op" id="4493779">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493786">if</span>&nbsp;<span class="ident" id="4493789">alpnLen</span>&nbsp;<span class="op" id="4493797">:=</span>&nbsp;<span class="builtinfunc" id="4493800">len</span><span class="op" id="4493803">(</span><span class="ident" id="4493804">m</span><span class="op" id="4493805">.</span><span class="ident" id="4493806">alpnProtocol</span><span class="op" id="4493818">)</span><span class="op" id="4493819">;</span>&nbsp;<span class="ident" id="4493821">alpnLen</span>&nbsp;<span class="op" id="4493829">&gt;</span>&nbsp;<span class="num" id="4493831">0</span>&nbsp;<span class="op" id="4493833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493837">if</span>&nbsp;<span class="ident" id="4493840">alpnLen</span>&nbsp;<span class="op" id="4493848">&gt;=</span>&nbsp;<span class="num" id="4493851">256</span>&nbsp;<span class="op" id="4493855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4493860">panic</span><span class="op" id="4493865">(</span><span class="string" id="4493866">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4493889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493893">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493897">extensionsLength</span>&nbsp;<span class="op" id="4493914">+=</span>&nbsp;<span class="num" id="4493917">2</span>&nbsp;<span class="op" id="4493919">+</span>&nbsp;<span class="num" id="4493921">1</span>&nbsp;<span class="op" id="4493923">+</span>&nbsp;<span class="ident" id="4493925">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493935">numExtensions</span><span class="op" id="4493948">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4493952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4493956">if</span>&nbsp;<span class="ident" id="4493959">numExtensions</span>&nbsp;<span class="op" id="4493973">&gt;</span>&nbsp;<span class="num" id="4493975">0</span>&nbsp;<span class="op" id="4493977">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4493981">extensionsLength</span>&nbsp;<span class="op" id="4493998">+=</span>&nbsp;<span class="num" id="4494001">4</span>&nbsp;<span class="op" id="4494003">*</span>&nbsp;<span class="ident" id="4494005">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494021">length</span>&nbsp;<span class="op" id="4494028">+=</span>&nbsp;<span class="num" id="4494031">2</span>&nbsp;<span class="op" id="4494033">+</span>&nbsp;<span class="ident" id="4494035">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4494053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494057">x</span>&nbsp;<span class="op" id="4494059">:=</span>&nbsp;<span class="builtinfunc" id="4494062">make</span><span class="op" id="4494066">(</span><span class="op" id="4494067">[</span><span class="op" id="4494068">]</span><span class="builtintype" id="4494069">byte</span><span class="op" id="4494073">,</span>&nbsp;<span class="num" id="4494075">4</span><span class="op" id="4494076">+</span><span class="ident" id="4494077">length</span><span class="op" id="4494083">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494086">x</span><span class="op" id="4494087">[</span><span class="num" id="4494088">0</span><span class="op" id="4494089">]</span>&nbsp;<span class="op" id="4494091">=</span>&nbsp;<span class="ident" id="4494093">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494110">x</span><span class="op" id="4494111">[</span><span class="num" id="4494112">1</span><span class="op" id="4494113">]</span>&nbsp;<span class="op" id="4494115">=</span>&nbsp;<span class="builtintype" id="4494117">uint8</span><span class="op" id="4494122">(</span><span class="ident" id="4494123">length</span>&nbsp;<span class="op" id="4494130">&gt;&gt;</span>&nbsp;<span class="num" id="4494133">16</span><span class="op" id="4494135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494138">x</span><span class="op" id="4494139">[</span><span class="num" id="4494140">2</span><span class="op" id="4494141">]</span>&nbsp;<span class="op" id="4494143">=</span>&nbsp;<span class="builtintype" id="4494145">uint8</span><span class="op" id="4494150">(</span><span class="ident" id="4494151">length</span>&nbsp;<span class="op" id="4494158">&gt;&gt;</span>&nbsp;<span class="num" id="4494161">8</span><span class="op" id="4494162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494165">x</span><span class="op" id="4494166">[</span><span class="num" id="4494167">3</span><span class="op" id="4494168">]</span>&nbsp;<span class="op" id="4494170">=</span>&nbsp;<span class="builtintype" id="4494172">uint8</span><span class="op" id="4494177">(</span><span class="ident" id="4494178">length</span><span class="op" id="4494184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494187">x</span><span class="op" id="4494188">[</span><span class="num" id="4494189">4</span><span class="op" id="4494190">]</span>&nbsp;<span class="op" id="4494192">=</span>&nbsp;<span class="builtintype" id="4494194">uint8</span><span class="op" id="4494199">(</span><span class="ident" id="4494200">m</span><span class="op" id="4494201">.</span><span class="ident" id="4494202">vers</span>&nbsp;<span class="op" id="4494207">&gt;&gt;</span>&nbsp;<span class="num" id="4494210">8</span><span class="op" id="4494211">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494214">x</span><span class="op" id="4494215">[</span><span class="num" id="4494216">5</span><span class="op" id="4494217">]</span>&nbsp;<span class="op" id="4494219">=</span>&nbsp;<span class="builtintype" id="4494221">uint8</span><span class="op" id="4494226">(</span><span class="ident" id="4494227">m</span><span class="op" id="4494228">.</span><span class="ident" id="4494229">vers</span><span class="op" id="4494233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4494236">copy</span><span class="op" id="4494240">(</span><span class="ident" id="4494241">x</span><span class="op" id="4494242">[</span><span class="num" id="4494243">6</span><span class="op" id="4494244">:</span><span class="num" id="4494245">38</span><span class="op" id="4494247">]</span><span class="op" id="4494248">,</span>&nbsp;<span class="ident" id="4494250">m</span><span class="op" id="4494251">.</span><span class="ident" id="4494252">random</span><span class="op" id="4494258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494261">x</span><span class="op" id="4494262">[</span><span class="num" id="4494263">38</span><span class="op" id="4494265">]</span>&nbsp;<span class="op" id="4494267">=</span>&nbsp;<span class="builtintype" id="4494269">uint8</span><span class="op" id="4494274">(</span><span class="builtinfunc" id="4494275">len</span><span class="op" id="4494278">(</span><span class="ident" id="4494279">m</span><span class="op" id="4494280">.</span><span class="ident" id="4494281">sessionId</span><span class="op" id="4494290">)</span><span class="op" id="4494291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4494294">copy</span><span class="op" id="4494298">(</span><span class="ident" id="4494299">x</span><span class="op" id="4494300">[</span><span class="num" id="4494301">39</span><span class="op" id="4494303">:</span><span class="num" id="4494304">39</span><span class="op" id="4494306">+</span><span class="builtinfunc" id="4494307">len</span><span class="op" id="4494310">(</span><span class="ident" id="4494311">m</span><span class="op" id="4494312">.</span><span class="ident" id="4494313">sessionId</span><span class="op" id="4494322">)</span><span class="op" id="4494323">]</span><span class="op" id="4494324">,</span>&nbsp;<span class="ident" id="4494326">m</span><span class="op" id="4494327">.</span><span class="ident" id="4494328">sessionId</span><span class="op" id="4494337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494340">z</span>&nbsp;<span class="op" id="4494342">:=</span>&nbsp;<span class="ident" id="4494345">x</span><span class="op" id="4494346">[</span><span class="num" id="4494347">39</span><span class="op" id="4494349">+</span><span class="builtinfunc" id="4494350">len</span><span class="op" id="4494353">(</span><span class="ident" id="4494354">m</span><span class="op" id="4494355">.</span><span class="ident" id="4494356">sessionId</span><span class="op" id="4494365">)</span><span class="op" id="4494366">:</span><span class="op" id="4494367">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494370">z</span><span class="op" id="4494371">[</span><span class="num" id="4494372">0</span><span class="op" id="4494373">]</span>&nbsp;<span class="op" id="4494375">=</span>&nbsp;<span class="builtintype" id="4494377">uint8</span><span class="op" id="4494382">(</span><span class="ident" id="4494383">m</span><span class="op" id="4494384">.</span><span class="ident" id="4494385">cipherSuite</span>&nbsp;<span class="op" id="4494397">&gt;&gt;</span>&nbsp;<span class="num" id="4494400">8</span><span class="op" id="4494401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494404">z</span><span class="op" id="4494405">[</span><span class="num" id="4494406">1</span><span class="op" id="4494407">]</span>&nbsp;<span class="op" id="4494409">=</span>&nbsp;<span class="builtintype" id="4494411">uint8</span><span class="op" id="4494416">(</span><span class="ident" id="4494417">m</span><span class="op" id="4494418">.</span><span class="ident" id="4494419">cipherSuite</span><span class="op" id="4494430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494433">z</span><span class="op" id="4494434">[</span><span class="num" id="4494435">2</span><span class="op" id="4494436">]</span>&nbsp;<span class="op" id="4494438">=</span>&nbsp;<span class="builtintype" id="4494440">uint8</span><span class="op" id="4494445">(</span><span class="ident" id="4494446">m</span><span class="op" id="4494447">.</span><span class="ident" id="4494448">compressionMethod</span><span class="op" id="4494465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494469">z</span>&nbsp;<span class="op" id="4494471">=</span>&nbsp;<span class="ident" id="4494473">z</span><span class="op" id="4494474">[</span><span class="num" id="4494475">3</span><span class="op" id="4494476">:</span><span class="op" id="4494477">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4494480">if</span>&nbsp;<span class="ident" id="4494483">numExtensions</span>&nbsp;<span class="op" id="4494497">&gt;</span>&nbsp;<span class="num" id="4494499">0</span>&nbsp;<span class="op" id="4494501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494505">z</span><span class="op" id="4494506">[</span><span class="num" id="4494507">0</span><span class="op" id="4494508">]</span>&nbsp;<span class="op" id="4494510">=</span>&nbsp;<span class="builtintype" id="4494512">byte</span><span class="op" id="4494516">(</span><span class="ident" id="4494517">extensionsLength</span>&nbsp;<span class="op" id="4494534">&gt;&gt;</span>&nbsp;<span class="num" id="4494537">8</span><span class="op" id="4494538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494542">z</span><span class="op" id="4494543">[</span><span class="num" id="4494544">1</span><span class="op" id="4494545">]</span>&nbsp;<span class="op" id="4494547">=</span>&nbsp;<span class="builtintype" id="4494549">byte</span><span class="op" id="4494553">(</span><span class="ident" id="4494554">extensionsLength</span><span class="op" id="4494570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494574">z</span>&nbsp;<span class="op" id="4494576">=</span>&nbsp;<span class="ident" id="4494578">z</span><span class="op" id="4494579">[</span><span class="num" id="4494580">2</span><span class="op" id="4494581">:</span><span class="op" id="4494582">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4494585">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4494588">if</span>&nbsp;<span class="ident" id="4494591">m</span><span class="op" id="4494592">.</span><span class="ident" id="4494593">nextProtoNeg</span>&nbsp;<span class="op" id="4494606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494610">z</span><span class="op" id="4494611">[</span><span class="num" id="4494612">0</span><span class="op" id="4494613">]</span>&nbsp;<span class="op" id="4494615">=</span>&nbsp;<span class="builtintype" id="4494617">byte</span><span class="op" id="4494621">(</span><span class="ident" id="4494622">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4494644">&gt;&gt;</span>&nbsp;<span class="num" id="4494647">8</span><span class="op" id="4494648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494652">z</span><span class="op" id="4494653">[</span><span class="num" id="4494654">1</span><span class="op" id="4494655">]</span>&nbsp;<span class="op" id="4494657">=</span>&nbsp;<span class="builtintype" id="4494659">byte</span><span class="op" id="4494663">(</span><span class="ident" id="4494664">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4494686">&amp;</span>&nbsp;<span class="num" id="4494688">0xff</span><span class="op" id="4494692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494696">z</span><span class="op" id="4494697">[</span><span class="num" id="4494698">2</span><span class="op" id="4494699">]</span>&nbsp;<span class="op" id="4494701">=</span>&nbsp;<span class="builtintype" id="4494703">byte</span><span class="op" id="4494707">(</span><span class="ident" id="4494708">nextProtoLen</span>&nbsp;<span class="op" id="4494721">&gt;&gt;</span>&nbsp;<span class="num" id="4494724">8</span><span class="op" id="4494725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494729">z</span><span class="op" id="4494730">[</span><span class="num" id="4494731">3</span><span class="op" id="4494732">]</span>&nbsp;<span class="op" id="4494734">=</span>&nbsp;<span class="builtintype" id="4494736">byte</span><span class="op" id="4494740">(</span><span class="ident" id="4494741">nextProtoLen</span><span class="op" id="4494753">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494757">z</span>&nbsp;<span class="op" id="4494759">=</span>&nbsp;<span class="ident" id="4494761">z</span><span class="op" id="4494762">[</span><span class="num" id="4494763">4</span><span class="op" id="4494764">:</span><span class="op" id="4494765">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4494770">for</span>&nbsp;<span class="ident" id="4494774">_</span><span class="op" id="4494775">,</span>&nbsp;<span class="ident" id="4494777">v</span>&nbsp;<span class="op" id="4494779">:=</span>&nbsp;<span class="keyword" id="4494782">range</span>&nbsp;<span class="ident" id="4494788">m</span><span class="op" id="4494789">.</span><span class="ident" id="4494790">nextProtos</span>&nbsp;<span class="op" id="4494801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494806">l</span>&nbsp;<span class="op" id="4494808">:=</span>&nbsp;<span class="builtinfunc" id="4494811">len</span><span class="op" id="4494814">(</span><span class="ident" id="4494815">v</span><span class="op" id="4494816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4494821">if</span>&nbsp;<span class="ident" id="4494824">l</span>&nbsp;<span class="op" id="4494826">&gt;</span>&nbsp;<span class="num" id="4494828">255</span>&nbsp;<span class="op" id="4494832">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494838">l</span>&nbsp;<span class="op" id="4494840">=</span>&nbsp;<span class="num" id="4494842">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4494849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494854">z</span><span class="op" id="4494855">[</span><span class="num" id="4494856">0</span><span class="op" id="4494857">]</span>&nbsp;<span class="op" id="4494859">=</span>&nbsp;<span class="builtintype" id="4494861">byte</span><span class="op" id="4494865">(</span><span class="ident" id="4494866">l</span><span class="op" id="4494867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4494872">copy</span><span class="op" id="4494876">(</span><span class="ident" id="4494877">z</span><span class="op" id="4494878">[</span><span class="num" id="4494879">1</span><span class="op" id="4494880">:</span><span class="op" id="4494881">]</span><span class="op" id="4494882">,</span>&nbsp;<span class="op" id="4494884">[</span><span class="op" id="4494885">]</span><span class="builtintype" id="4494886">byte</span><span class="op" id="4494890">(</span><span class="ident" id="4494891">v</span><span class="op" id="4494892">[</span><span class="num" id="4494893">0</span><span class="op" id="4494894">:</span><span class="ident" id="4494895">l</span><span class="op" id="4494896">]</span><span class="op" id="4494897">)</span><span class="op" id="4494898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494903">z</span>&nbsp;<span class="op" id="4494905">=</span>&nbsp;<span class="ident" id="4494907">z</span><span class="op" id="4494908">[</span><span class="num" id="4494909">1</span><span class="op" id="4494910">+</span><span class="ident" id="4494911">l</span><span class="op" id="4494912">:</span><span class="op" id="4494913">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4494917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4494920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4494923">if</span>&nbsp;<span class="ident" id="4494926">m</span><span class="op" id="4494927">.</span><span class="ident" id="4494928">ocspStapling</span>&nbsp;<span class="op" id="4494941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494945">z</span><span class="op" id="4494946">[</span><span class="num" id="4494947">0</span><span class="op" id="4494948">]</span>&nbsp;<span class="op" id="4494950">=</span>&nbsp;<span class="builtintype" id="4494952">byte</span><span class="op" id="4494956">(</span><span class="ident" id="4494957">extensionStatusRequest</span>&nbsp;<span class="op" id="4494980">&gt;&gt;</span>&nbsp;<span class="num" id="4494983">8</span><span class="op" id="4494984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4494988">z</span><span class="op" id="4494989">[</span><span class="num" id="4494990">1</span><span class="op" id="4494991">]</span>&nbsp;<span class="op" id="4494993">=</span>&nbsp;<span class="builtintype" id="4494995">byte</span><span class="op" id="4494999">(</span><span class="ident" id="4495000">extensionStatusRequest</span><span class="op" id="4495022">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495026">z</span>&nbsp;<span class="op" id="4495028">=</span>&nbsp;<span class="ident" id="4495030">z</span><span class="op" id="4495031">[</span><span class="num" id="4495032">4</span><span class="op" id="4495033">:</span><span class="op" id="4495034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495040">if</span>&nbsp;<span class="ident" id="4495043">m</span><span class="op" id="4495044">.</span><span class="ident" id="4495045">ticketSupported</span>&nbsp;<span class="op" id="4495061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495065">z</span><span class="op" id="4495066">[</span><span class="num" id="4495067">0</span><span class="op" id="4495068">]</span>&nbsp;<span class="op" id="4495070">=</span>&nbsp;<span class="builtintype" id="4495072">byte</span><span class="op" id="4495076">(</span><span class="ident" id="4495077">extensionSessionTicket</span>&nbsp;<span class="op" id="4495100">&gt;&gt;</span>&nbsp;<span class="num" id="4495103">8</span><span class="op" id="4495104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495108">z</span><span class="op" id="4495109">[</span><span class="num" id="4495110">1</span><span class="op" id="4495111">]</span>&nbsp;<span class="op" id="4495113">=</span>&nbsp;<span class="builtintype" id="4495115">byte</span><span class="op" id="4495119">(</span><span class="ident" id="4495120">extensionSessionTicket</span><span class="op" id="4495142">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495146">z</span>&nbsp;<span class="op" id="4495148">=</span>&nbsp;<span class="ident" id="4495150">z</span><span class="op" id="4495151">[</span><span class="num" id="4495152">4</span><span class="op" id="4495153">:</span><span class="op" id="4495154">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495160">if</span>&nbsp;<span class="ident" id="4495163">m</span><span class="op" id="4495164">.</span><span class="ident" id="4495165">secureRenegotiation</span>&nbsp;<span class="op" id="4495185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495189">z</span><span class="op" id="4495190">[</span><span class="num" id="4495191">0</span><span class="op" id="4495192">]</span>&nbsp;<span class="op" id="4495194">=</span>&nbsp;<span class="builtintype" id="4495196">byte</span><span class="op" id="4495200">(</span><span class="ident" id="4495201">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4495228">&gt;&gt;</span>&nbsp;<span class="num" id="4495231">8</span><span class="op" id="4495232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495236">z</span><span class="op" id="4495237">[</span><span class="num" id="4495238">1</span><span class="op" id="4495239">]</span>&nbsp;<span class="op" id="4495241">=</span>&nbsp;<span class="builtintype" id="4495243">byte</span><span class="op" id="4495247">(</span><span class="ident" id="4495248">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4495275">&amp;</span>&nbsp;<span class="num" id="4495277">0xff</span><span class="op" id="4495281">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495285">z</span><span class="op" id="4495286">[</span><span class="num" id="4495287">2</span><span class="op" id="4495288">]</span>&nbsp;<span class="op" id="4495290">=</span>&nbsp;<span class="num" id="4495292">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495296">z</span><span class="op" id="4495297">[</span><span class="num" id="4495298">3</span><span class="op" id="4495299">]</span>&nbsp;<span class="op" id="4495301">=</span>&nbsp;<span class="num" id="4495303">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495307">z</span>&nbsp;<span class="op" id="4495309">=</span>&nbsp;<span class="ident" id="4495311">z</span><span class="op" id="4495312">[</span><span class="num" id="4495313">5</span><span class="op" id="4495314">:</span><span class="op" id="4495315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495321">if</span>&nbsp;<span class="ident" id="4495324">alpnLen</span>&nbsp;<span class="op" id="4495332">:=</span>&nbsp;<span class="builtinfunc" id="4495335">len</span><span class="op" id="4495338">(</span><span class="ident" id="4495339">m</span><span class="op" id="4495340">.</span><span class="ident" id="4495341">alpnProtocol</span><span class="op" id="4495353">)</span><span class="op" id="4495354">;</span>&nbsp;<span class="ident" id="4495356">alpnLen</span>&nbsp;<span class="op" id="4495364">&gt;</span>&nbsp;<span class="num" id="4495366">0</span>&nbsp;<span class="op" id="4495368">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495372">z</span><span class="op" id="4495373">[</span><span class="num" id="4495374">0</span><span class="op" id="4495375">]</span>&nbsp;<span class="op" id="4495377">=</span>&nbsp;<span class="builtintype" id="4495379">byte</span><span class="op" id="4495383">(</span><span class="ident" id="4495384">extensionALPN</span>&nbsp;<span class="op" id="4495398">&gt;&gt;</span>&nbsp;<span class="num" id="4495401">8</span><span class="op" id="4495402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495406">z</span><span class="op" id="4495407">[</span><span class="num" id="4495408">1</span><span class="op" id="4495409">]</span>&nbsp;<span class="op" id="4495411">=</span>&nbsp;<span class="builtintype" id="4495413">byte</span><span class="op" id="4495417">(</span><span class="ident" id="4495418">extensionALPN</span>&nbsp;<span class="op" id="4495432">&amp;</span>&nbsp;<span class="num" id="4495434">0xff</span><span class="op" id="4495438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495442">l</span>&nbsp;<span class="op" id="4495444">:=</span>&nbsp;<span class="num" id="4495447">2</span>&nbsp;<span class="op" id="4495449">+</span>&nbsp;<span class="num" id="4495451">1</span>&nbsp;<span class="op" id="4495453">+</span>&nbsp;<span class="ident" id="4495455">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495465">z</span><span class="op" id="4495466">[</span><span class="num" id="4495467">2</span><span class="op" id="4495468">]</span>&nbsp;<span class="op" id="4495470">=</span>&nbsp;<span class="builtintype" id="4495472">byte</span><span class="op" id="4495476">(</span><span class="ident" id="4495477">l</span>&nbsp;<span class="op" id="4495479">&gt;&gt;</span>&nbsp;<span class="num" id="4495482">8</span><span class="op" id="4495483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495487">z</span><span class="op" id="4495488">[</span><span class="num" id="4495489">3</span><span class="op" id="4495490">]</span>&nbsp;<span class="op" id="4495492">=</span>&nbsp;<span class="builtintype" id="4495494">byte</span><span class="op" id="4495498">(</span><span class="ident" id="4495499">l</span><span class="op" id="4495500">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495504">l</span>&nbsp;<span class="op" id="4495506">-=</span>&nbsp;<span class="num" id="4495509">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495513">z</span><span class="op" id="4495514">[</span><span class="num" id="4495515">4</span><span class="op" id="4495516">]</span>&nbsp;<span class="op" id="4495518">=</span>&nbsp;<span class="builtintype" id="4495520">byte</span><span class="op" id="4495524">(</span><span class="ident" id="4495525">l</span>&nbsp;<span class="op" id="4495527">&gt;&gt;</span>&nbsp;<span class="num" id="4495530">8</span><span class="op" id="4495531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495535">z</span><span class="op" id="4495536">[</span><span class="num" id="4495537">5</span><span class="op" id="4495538">]</span>&nbsp;<span class="op" id="4495540">=</span>&nbsp;<span class="builtintype" id="4495542">byte</span><span class="op" id="4495546">(</span><span class="ident" id="4495547">l</span><span class="op" id="4495548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495552">l</span>&nbsp;<span class="op" id="4495554">-=</span>&nbsp;<span class="num" id="4495557">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495561">z</span><span class="op" id="4495562">[</span><span class="num" id="4495563">6</span><span class="op" id="4495564">]</span>&nbsp;<span class="op" id="4495566">=</span>&nbsp;<span class="builtintype" id="4495568">byte</span><span class="op" id="4495572">(</span><span class="ident" id="4495573">l</span><span class="op" id="4495574">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4495578">copy</span><span class="op" id="4495582">(</span><span class="ident" id="4495583">z</span><span class="op" id="4495584">[</span><span class="num" id="4495585">7</span><span class="op" id="4495586">:</span><span class="op" id="4495587">]</span><span class="op" id="4495588">,</span>&nbsp;<span class="op" id="4495590">[</span><span class="op" id="4495591">]</span><span class="builtintype" id="4495592">byte</span><span class="op" id="4495596">(</span><span class="ident" id="4495597">m</span><span class="op" id="4495598">.</span><span class="ident" id="4495599">alpnProtocol</span><span class="op" id="4495611">)</span><span class="op" id="4495612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495616">z</span>&nbsp;<span class="op" id="4495618">=</span>&nbsp;<span class="ident" id="4495620">z</span><span class="op" id="4495621">[</span><span class="num" id="4495622">7</span><span class="op" id="4495623">+</span><span class="ident" id="4495624">alpnLen</span><span class="op" id="4495631">:</span><span class="op" id="4495632">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495639">m</span><span class="op" id="4495640">.</span><span class="ident" id="4495641">raw</span>&nbsp;<span class="op" id="4495645">=</span>&nbsp;<span class="ident" id="4495647">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495651">return</span>&nbsp;<span class="ident" id="4495658">x</span><br>
<span class="lineno"></span><span class="op" id="4495660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4495663">func</span>&nbsp;<span class="op" id="4495668">(</span><span class="ident" id="4495669">m</span>&nbsp;<span class="op" id="4495671">*</span><span class="ident" id="4495672">serverHelloMsg</span><span class="op" id="4495686">)</span>&nbsp;<span class="ident" id="4495688">unmarshal</span><span class="op" id="4495697">(</span><span class="ident" id="4495698">data</span>&nbsp;<span class="op" id="4495703">[</span><span class="op" id="4495704">]</span><span class="builtintype" id="4495705">byte</span><span class="op" id="4495709">)</span>&nbsp;<span class="builtintype" id="4495711">bool</span>&nbsp;<span class="op" id="4495716">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495719">if</span>&nbsp;<span class="builtinfunc" id="4495722">len</span><span class="op" id="4495725">(</span><span class="ident" id="4495726">data</span><span class="op" id="4495730">)</span>&nbsp;<span class="op" id="4495732">&lt;</span>&nbsp;<span class="num" id="4495734">42</span>&nbsp;<span class="op" id="4495737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495741">return</span>&nbsp;<span class="builtintype" id="4495748">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495758">m</span><span class="op" id="4495759">.</span><span class="ident" id="4495760">raw</span>&nbsp;<span class="op" id="4495764">=</span>&nbsp;<span class="ident" id="4495766">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495772">m</span><span class="op" id="4495773">.</span><span class="ident" id="4495774">vers</span>&nbsp;<span class="op" id="4495779">=</span>&nbsp;<span class="builtintype" id="4495781">uint16</span><span class="op" id="4495787">(</span><span class="ident" id="4495788">data</span><span class="op" id="4495792">[</span><span class="num" id="4495793">4</span><span class="op" id="4495794">]</span><span class="op" id="4495795">)</span><span class="op" id="4495796">&lt;&lt;</span><span class="num" id="4495798">8</span>&nbsp;<span class="op" id="4495800">|</span>&nbsp;<span class="builtintype" id="4495802">uint16</span><span class="op" id="4495808">(</span><span class="ident" id="4495809">data</span><span class="op" id="4495813">[</span><span class="num" id="4495814">5</span><span class="op" id="4495815">]</span><span class="op" id="4495816">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495819">m</span><span class="op" id="4495820">.</span><span class="ident" id="4495821">random</span>&nbsp;<span class="op" id="4495828">=</span>&nbsp;<span class="ident" id="4495830">data</span><span class="op" id="4495834">[</span><span class="num" id="4495835">6</span><span class="op" id="4495836">:</span><span class="num" id="4495837">38</span><span class="op" id="4495839">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495842">sessionIdLen</span>&nbsp;<span class="op" id="4495855">:=</span>&nbsp;<span class="builtintype" id="4495858">int</span><span class="op" id="4495861">(</span><span class="ident" id="4495862">data</span><span class="op" id="4495866">[</span><span class="num" id="4495867">38</span><span class="op" id="4495869">]</span><span class="op" id="4495870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495873">if</span>&nbsp;<span class="ident" id="4495876">sessionIdLen</span>&nbsp;<span class="op" id="4495889">&gt;</span>&nbsp;<span class="num" id="4495891">32</span>&nbsp;<span class="op" id="4495894">||</span>&nbsp;<span class="builtinfunc" id="4495897">len</span><span class="op" id="4495900">(</span><span class="ident" id="4495901">data</span><span class="op" id="4495905">)</span>&nbsp;<span class="op" id="4495907">&lt;</span>&nbsp;<span class="num" id="4495909">39</span><span class="op" id="4495911">+</span><span class="ident" id="4495912">sessionIdLen</span>&nbsp;<span class="op" id="4495925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4495929">return</span>&nbsp;<span class="builtintype" id="4495936">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4495943">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495946">m</span><span class="op" id="4495947">.</span><span class="ident" id="4495948">sessionId</span>&nbsp;<span class="op" id="4495958">=</span>&nbsp;<span class="ident" id="4495960">data</span><span class="op" id="4495964">[</span><span class="num" id="4495965">39</span>&nbsp;<span class="op" id="4495968">:</span>&nbsp;<span class="num" id="4495970">39</span><span class="op" id="4495972">+</span><span class="ident" id="4495973">sessionIdLen</span><span class="op" id="4495985">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4495988">data</span>&nbsp;<span class="op" id="4495993">=</span>&nbsp;<span class="ident" id="4495995">data</span><span class="op" id="4495999">[</span><span class="num" id="4496000">39</span><span class="op" id="4496002">+</span><span class="ident" id="4496003">sessionIdLen</span><span class="op" id="4496015">:</span><span class="op" id="4496016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496019">if</span>&nbsp;<span class="builtinfunc" id="4496022">len</span><span class="op" id="4496025">(</span><span class="ident" id="4496026">data</span><span class="op" id="4496030">)</span>&nbsp;<span class="op" id="4496032">&lt;</span>&nbsp;<span class="num" id="4496034">3</span>&nbsp;<span class="op" id="4496036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496040">return</span>&nbsp;<span class="builtintype" id="4496047">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496054">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496057">m</span><span class="op" id="4496058">.</span><span class="ident" id="4496059">cipherSuite</span>&nbsp;<span class="op" id="4496071">=</span>&nbsp;<span class="builtintype" id="4496073">uint16</span><span class="op" id="4496079">(</span><span class="ident" id="4496080">data</span><span class="op" id="4496084">[</span><span class="num" id="4496085">0</span><span class="op" id="4496086">]</span><span class="op" id="4496087">)</span><span class="op" id="4496088">&lt;&lt;</span><span class="num" id="4496090">8</span>&nbsp;<span class="op" id="4496092">|</span>&nbsp;<span class="builtintype" id="4496094">uint16</span><span class="op" id="4496100">(</span><span class="ident" id="4496101">data</span><span class="op" id="4496105">[</span><span class="num" id="4496106">1</span><span class="op" id="4496107">]</span><span class="op" id="4496108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496111">m</span><span class="op" id="4496112">.</span><span class="ident" id="4496113">compressionMethod</span>&nbsp;<span class="op" id="4496131">=</span>&nbsp;<span class="ident" id="4496133">data</span><span class="op" id="4496137">[</span><span class="num" id="4496138">2</span><span class="op" id="4496139">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496142">data</span>&nbsp;<span class="op" id="4496147">=</span>&nbsp;<span class="ident" id="4496149">data</span><span class="op" id="4496153">[</span><span class="num" id="4496154">3</span><span class="op" id="4496155">:</span><span class="op" id="4496156">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496160">m</span><span class="op" id="4496161">.</span><span class="ident" id="4496162">nextProtoNeg</span>&nbsp;<span class="op" id="4496175">=</span>&nbsp;<span class="builtintype" id="4496177">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496184">m</span><span class="op" id="4496185">.</span><span class="ident" id="4496186">nextProtos</span>&nbsp;<span class="op" id="4496197">=</span>&nbsp;<span class="ident" id="4496199">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496204">m</span><span class="op" id="4496205">.</span><span class="ident" id="4496206">ocspStapling</span>&nbsp;<span class="op" id="4496219">=</span>&nbsp;<span class="builtintype" id="4496221">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496228">m</span><span class="op" id="4496229">.</span><span class="ident" id="4496230">ticketSupported</span>&nbsp;<span class="op" id="4496246">=</span>&nbsp;<span class="builtintype" id="4496248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496255">m</span><span class="op" id="4496256">.</span><span class="ident" id="4496257">alpnProtocol</span>&nbsp;<span class="op" id="4496270">=</span>&nbsp;<span class="string" id="4496272">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496277">if</span>&nbsp;<span class="builtinfunc" id="4496280">len</span><span class="op" id="4496283">(</span><span class="ident" id="4496284">data</span><span class="op" id="4496288">)</span>&nbsp;<span class="op" id="4496290">==</span>&nbsp;<span class="num" id="4496293">0</span>&nbsp;<span class="op" id="4496295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4496299">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496357">return</span>&nbsp;<span class="builtintype" id="4496364">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496373">if</span>&nbsp;<span class="builtinfunc" id="4496376">len</span><span class="op" id="4496379">(</span><span class="ident" id="4496380">data</span><span class="op" id="4496384">)</span>&nbsp;<span class="op" id="4496386">&lt;</span>&nbsp;<span class="num" id="4496388">2</span>&nbsp;<span class="op" id="4496390">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496394">return</span>&nbsp;<span class="builtintype" id="4496401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496412">extensionsLength</span>&nbsp;<span class="op" id="4496429">:=</span>&nbsp;<span class="builtintype" id="4496432">int</span><span class="op" id="4496435">(</span><span class="ident" id="4496436">data</span><span class="op" id="4496440">[</span><span class="num" id="4496441">0</span><span class="op" id="4496442">]</span><span class="op" id="4496443">)</span><span class="op" id="4496444">&lt;&lt;</span><span class="num" id="4496446">8</span>&nbsp;<span class="op" id="4496448">|</span>&nbsp;<span class="builtintype" id="4496450">int</span><span class="op" id="4496453">(</span><span class="ident" id="4496454">data</span><span class="op" id="4496458">[</span><span class="num" id="4496459">1</span><span class="op" id="4496460">]</span><span class="op" id="4496461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496464">data</span>&nbsp;<span class="op" id="4496469">=</span>&nbsp;<span class="ident" id="4496471">data</span><span class="op" id="4496475">[</span><span class="num" id="4496476">2</span><span class="op" id="4496477">:</span><span class="op" id="4496478">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496481">if</span>&nbsp;<span class="builtinfunc" id="4496484">len</span><span class="op" id="4496487">(</span><span class="ident" id="4496488">data</span><span class="op" id="4496492">)</span>&nbsp;<span class="op" id="4496494">!=</span>&nbsp;<span class="ident" id="4496497">extensionsLength</span>&nbsp;<span class="op" id="4496514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496518">return</span>&nbsp;<span class="builtintype" id="4496525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496536">for</span>&nbsp;<span class="builtinfunc" id="4496540">len</span><span class="op" id="4496543">(</span><span class="ident" id="4496544">data</span><span class="op" id="4496548">)</span>&nbsp;<span class="op" id="4496550">!=</span>&nbsp;<span class="num" id="4496553">0</span>&nbsp;<span class="op" id="4496555">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496559">if</span>&nbsp;<span class="builtinfunc" id="4496562">len</span><span class="op" id="4496565">(</span><span class="ident" id="4496566">data</span><span class="op" id="4496570">)</span>&nbsp;<span class="op" id="4496572">&lt;</span>&nbsp;<span class="num" id="4496574">4</span>&nbsp;<span class="op" id="4496576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496581">return</span>&nbsp;<span class="builtintype" id="4496588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496600">extension</span>&nbsp;<span class="op" id="4496610">:=</span>&nbsp;<span class="builtintype" id="4496613">uint16</span><span class="op" id="4496619">(</span><span class="ident" id="4496620">data</span><span class="op" id="4496624">[</span><span class="num" id="4496625">0</span><span class="op" id="4496626">]</span><span class="op" id="4496627">)</span><span class="op" id="4496628">&lt;&lt;</span><span class="num" id="4496630">8</span>&nbsp;<span class="op" id="4496632">|</span>&nbsp;<span class="builtintype" id="4496634">uint16</span><span class="op" id="4496640">(</span><span class="ident" id="4496641">data</span><span class="op" id="4496645">[</span><span class="num" id="4496646">1</span><span class="op" id="4496647">]</span><span class="op" id="4496648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496652">length</span>&nbsp;<span class="op" id="4496659">:=</span>&nbsp;<span class="builtintype" id="4496662">int</span><span class="op" id="4496665">(</span><span class="ident" id="4496666">data</span><span class="op" id="4496670">[</span><span class="num" id="4496671">2</span><span class="op" id="4496672">]</span><span class="op" id="4496673">)</span><span class="op" id="4496674">&lt;&lt;</span><span class="num" id="4496676">8</span>&nbsp;<span class="op" id="4496678">|</span>&nbsp;<span class="builtintype" id="4496680">int</span><span class="op" id="4496683">(</span><span class="ident" id="4496684">data</span><span class="op" id="4496688">[</span><span class="num" id="4496689">3</span><span class="op" id="4496690">]</span><span class="op" id="4496691">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496695">data</span>&nbsp;<span class="op" id="4496700">=</span>&nbsp;<span class="ident" id="4496702">data</span><span class="op" id="4496706">[</span><span class="num" id="4496707">4</span><span class="op" id="4496708">:</span><span class="op" id="4496709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496713">if</span>&nbsp;<span class="builtinfunc" id="4496716">len</span><span class="op" id="4496719">(</span><span class="ident" id="4496720">data</span><span class="op" id="4496724">)</span>&nbsp;<span class="op" id="4496726">&lt;</span>&nbsp;<span class="ident" id="4496728">length</span>&nbsp;<span class="op" id="4496735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496740">return</span>&nbsp;<span class="builtintype" id="4496747">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496760">switch</span>&nbsp;<span class="ident" id="4496767">extension</span>&nbsp;<span class="op" id="4496777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496781">case</span>&nbsp;<span class="ident" id="4496786">extensionNextProtoNeg</span><span class="op" id="4496807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496812">m</span><span class="op" id="4496813">.</span><span class="ident" id="4496814">nextProtoNeg</span>&nbsp;<span class="op" id="4496827">=</span>&nbsp;<span class="builtintype" id="4496829">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496837">d</span>&nbsp;<span class="op" id="4496839">:=</span>&nbsp;<span class="ident" id="4496842">data</span><span class="op" id="4496846">[</span><span class="op" id="4496847">:</span><span class="ident" id="4496848">length</span><span class="op" id="4496854">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496859">for</span>&nbsp;<span class="builtinfunc" id="4496863">len</span><span class="op" id="4496866">(</span><span class="ident" id="4496867">d</span><span class="op" id="4496868">)</span>&nbsp;<span class="op" id="4496870">&gt;</span>&nbsp;<span class="num" id="4496872">0</span>&nbsp;<span class="op" id="4496874">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496880">l</span>&nbsp;<span class="op" id="4496882">:=</span>&nbsp;<span class="builtintype" id="4496885">int</span><span class="op" id="4496888">(</span><span class="ident" id="4496889">d</span><span class="op" id="4496890">[</span><span class="num" id="4496891">0</span><span class="op" id="4496892">]</span><span class="op" id="4496893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496899">d</span>&nbsp;<span class="op" id="4496901">=</span>&nbsp;<span class="ident" id="4496903">d</span><span class="op" id="4496904">[</span><span class="num" id="4496905">1</span><span class="op" id="4496906">:</span><span class="op" id="4496907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496913">if</span>&nbsp;<span class="ident" id="4496916">l</span>&nbsp;<span class="op" id="4496918">==</span>&nbsp;<span class="num" id="4496921">0</span>&nbsp;<span class="op" id="4496923">||</span>&nbsp;<span class="ident" id="4496926">l</span>&nbsp;<span class="op" id="4496928">&gt;</span>&nbsp;<span class="builtinfunc" id="4496930">len</span><span class="op" id="4496933">(</span><span class="ident" id="4496934">d</span><span class="op" id="4496935">)</span>&nbsp;<span class="op" id="4496937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4496944">return</span>&nbsp;<span class="builtintype" id="4496951">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4496961">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4496967">m</span><span class="op" id="4496968">.</span><span class="ident" id="4496969">nextProtos</span>&nbsp;<span class="op" id="4496980">=</span>&nbsp;<span class="builtinfunc" id="4496982">append</span><span class="op" id="4496988">(</span><span class="ident" id="4496989">m</span><span class="op" id="4496990">.</span><span class="ident" id="4496991">nextProtos</span><span class="op" id="4497001">,</span>&nbsp;<span class="builtintype" id="4497003">string</span><span class="op" id="4497009">(</span><span class="ident" id="4497010">d</span><span class="op" id="4497011">[</span><span class="op" id="4497012">:</span><span class="ident" id="4497013">l</span><span class="op" id="4497014">]</span><span class="op" id="4497015">)</span><span class="op" id="4497016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497022">d</span>&nbsp;<span class="op" id="4497024">=</span>&nbsp;<span class="ident" id="4497026">d</span><span class="op" id="4497027">[</span><span class="ident" id="4497028">l</span><span class="op" id="4497029">:</span><span class="op" id="4497030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497039">case</span>&nbsp;<span class="ident" id="4497044">extensionStatusRequest</span><span class="op" id="4497066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497071">if</span>&nbsp;<span class="ident" id="4497074">length</span>&nbsp;<span class="op" id="4497081">&gt;</span>&nbsp;<span class="num" id="4497083">0</span>&nbsp;<span class="op" id="4497085">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497091">return</span>&nbsp;<span class="builtintype" id="4497098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497112">m</span><span class="op" id="4497113">.</span><span class="ident" id="4497114">ocspStapling</span>&nbsp;<span class="op" id="4497127">=</span>&nbsp;<span class="builtintype" id="4497129">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497136">case</span>&nbsp;<span class="ident" id="4497141">extensionSessionTicket</span><span class="op" id="4497163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497168">if</span>&nbsp;<span class="ident" id="4497171">length</span>&nbsp;<span class="op" id="4497178">&gt;</span>&nbsp;<span class="num" id="4497180">0</span>&nbsp;<span class="op" id="4497182">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497188">return</span>&nbsp;<span class="builtintype" id="4497195">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497209">m</span><span class="op" id="4497210">.</span><span class="ident" id="4497211">ticketSupported</span>&nbsp;<span class="op" id="4497227">=</span>&nbsp;<span class="builtintype" id="4497229">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497236">case</span>&nbsp;<span class="ident" id="4497241">extensionRenegotiationInfo</span><span class="op" id="4497267">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497272">if</span>&nbsp;<span class="ident" id="4497275">length</span>&nbsp;<span class="op" id="4497282">!=</span>&nbsp;<span class="num" id="4497285">1</span>&nbsp;<span class="op" id="4497287">||</span>&nbsp;<span class="ident" id="4497290">data</span><span class="op" id="4497294">[</span><span class="num" id="4497295">0</span><span class="op" id="4497296">]</span>&nbsp;<span class="op" id="4497298">!=</span>&nbsp;<span class="num" id="4497301">0</span>&nbsp;<span class="op" id="4497303">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497309">return</span>&nbsp;<span class="builtintype" id="4497316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497330">m</span><span class="op" id="4497331">.</span><span class="ident" id="4497332">secureRenegotiation</span>&nbsp;<span class="op" id="4497352">=</span>&nbsp;<span class="builtintype" id="4497354">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497361">case</span>&nbsp;<span class="ident" id="4497366">extensionALPN</span><span class="op" id="4497379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497384">d</span>&nbsp;<span class="op" id="4497386">:=</span>&nbsp;<span class="ident" id="4497389">data</span><span class="op" id="4497393">[</span><span class="op" id="4497394">:</span><span class="ident" id="4497395">length</span><span class="op" id="4497401">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497406">if</span>&nbsp;<span class="builtinfunc" id="4497409">len</span><span class="op" id="4497412">(</span><span class="ident" id="4497413">d</span><span class="op" id="4497414">)</span>&nbsp;<span class="op" id="4497416">&lt;</span>&nbsp;<span class="num" id="4497418">3</span>&nbsp;<span class="op" id="4497420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497426">return</span>&nbsp;<span class="builtintype" id="4497433">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497447">l</span>&nbsp;<span class="op" id="4497449">:=</span>&nbsp;<span class="builtintype" id="4497452">int</span><span class="op" id="4497455">(</span><span class="ident" id="4497456">d</span><span class="op" id="4497457">[</span><span class="num" id="4497458">0</span><span class="op" id="4497459">]</span><span class="op" id="4497460">)</span><span class="op" id="4497461">&lt;&lt;</span><span class="num" id="4497463">8</span>&nbsp;<span class="op" id="4497465">|</span>&nbsp;<span class="builtintype" id="4497467">int</span><span class="op" id="4497470">(</span><span class="ident" id="4497471">d</span><span class="op" id="4497472">[</span><span class="num" id="4497473">1</span><span class="op" id="4497474">]</span><span class="op" id="4497475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497480">if</span>&nbsp;<span class="ident" id="4497483">l</span>&nbsp;<span class="op" id="4497485">!=</span>&nbsp;<span class="builtinfunc" id="4497488">len</span><span class="op" id="4497491">(</span><span class="ident" id="4497492">d</span><span class="op" id="4497493">)</span><span class="op" id="4497494">-</span><span class="num" id="4497495">2</span>&nbsp;<span class="op" id="4497497">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497503">return</span>&nbsp;<span class="builtintype" id="4497510">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497524">d</span>&nbsp;<span class="op" id="4497526">=</span>&nbsp;<span class="ident" id="4497528">d</span><span class="op" id="4497529">[</span><span class="num" id="4497530">2</span><span class="op" id="4497531">:</span><span class="op" id="4497532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497537">l</span>&nbsp;<span class="op" id="4497539">=</span>&nbsp;<span class="builtintype" id="4497541">int</span><span class="op" id="4497544">(</span><span class="ident" id="4497545">d</span><span class="op" id="4497546">[</span><span class="num" id="4497547">0</span><span class="op" id="4497548">]</span><span class="op" id="4497549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497554">if</span>&nbsp;<span class="ident" id="4497557">l</span>&nbsp;<span class="op" id="4497559">!=</span>&nbsp;<span class="builtinfunc" id="4497562">len</span><span class="op" id="4497565">(</span><span class="ident" id="4497566">d</span><span class="op" id="4497567">)</span><span class="op" id="4497568">-</span><span class="num" id="4497569">1</span>&nbsp;<span class="op" id="4497571">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497577">return</span>&nbsp;<span class="builtintype" id="4497584">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497598">d</span>&nbsp;<span class="op" id="4497600">=</span>&nbsp;<span class="ident" id="4497602">d</span><span class="op" id="4497603">[</span><span class="num" id="4497604">1</span><span class="op" id="4497605">:</span><span class="op" id="4497606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497611">m</span><span class="op" id="4497612">.</span><span class="ident" id="4497613">alpnProtocol</span>&nbsp;<span class="op" id="4497626">=</span>&nbsp;<span class="builtintype" id="4497628">string</span><span class="op" id="4497634">(</span><span class="ident" id="4497635">d</span><span class="op" id="4497636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497640">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497644">data</span>&nbsp;<span class="op" id="4497649">=</span>&nbsp;<span class="ident" id="4497651">data</span><span class="op" id="4497655">[</span><span class="ident" id="4497656">length</span><span class="op" id="4497662">:</span><span class="op" id="4497663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497670">return</span>&nbsp;<span class="builtintype" id="4497677">true</span><br>
<span class="lineno"></span><span class="op" id="4497682">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4497685">type</span>&nbsp;<span class="ident" id="4497690">certificateMsg</span>&nbsp;<span class="keyword" id="4497705">struct</span>&nbsp;<span class="op" id="4497712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497715">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497728">[</span><span class="op" id="4497729">]</span><span class="builtintype" id="4497730">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497736">certificates</span>&nbsp;<span class="op" id="4497749">[</span><span class="op" id="4497750">]</span><span class="op" id="4497751">[</span><span class="op" id="4497752">]</span><span class="builtintype" id="4497753">byte</span><br>
<span class="lineno"></span><span class="op" id="4497758">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4497761">func</span>&nbsp;<span class="op" id="4497766">(</span><span class="ident" id="4497767">m</span>&nbsp;<span class="op" id="4497769">*</span><span class="ident" id="4497770">certificateMsg</span><span class="op" id="4497784">)</span>&nbsp;<span class="ident" id="4497786">equal</span><span class="op" id="4497791">(</span><span class="ident" id="4497792">i</span>&nbsp;<span class="keyword" id="4497794">interface</span><span class="op" id="4497803">{</span><span class="op" id="4497804">}</span><span class="op" id="4497805">)</span>&nbsp;<span class="builtintype" id="4497807">bool</span>&nbsp;<span class="op" id="4497812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497815">m1</span><span class="op" id="4497817">,</span>&nbsp;<span class="ident" id="4497819">ok</span>&nbsp;<span class="op" id="4497822">:=</span>&nbsp;<span class="ident" id="4497825">i</span><span class="op" id="4497826">.</span><span class="op" id="4497827">(</span><span class="op" id="4497828">*</span><span class="ident" id="4497829">certificateMsg</span><span class="op" id="4497843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497846">if</span>&nbsp;<span class="op" id="4497849">!</span><span class="ident" id="4497850">ok</span>&nbsp;<span class="op" id="4497853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497857">return</span>&nbsp;<span class="builtintype" id="4497864">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4497871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4497875">return</span>&nbsp;<span class="ident" id="4497882">bytes</span><span class="op" id="4497887">.</span><span class="ident" id="4497888">Equal</span><span class="op" id="4497893">(</span><span class="ident" id="4497894">m</span><span class="op" id="4497895">.</span><span class="ident" id="4497896">raw</span><span class="op" id="4497899">,</span>&nbsp;<span class="ident" id="4497901">m1</span><span class="op" id="4497903">.</span><span class="ident" id="4497904">raw</span><span class="op" id="4497907">)</span>&nbsp;<span class="op" id="4497909">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4497914">eqByteSlices</span><span class="op" id="4497926">(</span><span class="ident" id="4497927">m</span><span class="op" id="4497928">.</span><span class="ident" id="4497929">certificates</span><span class="op" id="4497941">,</span>&nbsp;<span class="ident" id="4497943">m1</span><span class="op" id="4497945">.</span><span class="ident" id="4497946">certificates</span><span class="op" id="4497958">)</span><br>
<span class="lineno"></span><span class="op" id="4497960">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4497963">func</span>&nbsp;<span class="op" id="4497968">(</span><span class="ident" id="4497969">m</span>&nbsp;<span class="op" id="4497971">*</span><span class="ident" id="4497972">certificateMsg</span><span class="op" id="4497986">)</span>&nbsp;<span class="ident" id="4497988">marshal</span><span class="op" id="4497995">(</span><span class="op" id="4497996">)</span>&nbsp;<span class="op" id="4497998">(</span><span class="ident" id="4497999">x</span>&nbsp;<span class="op" id="4498001">[</span><span class="op" id="4498002">]</span><span class="builtintype" id="4498003">byte</span><span class="op" id="4498007">)</span>&nbsp;<span class="op" id="4498009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498012">if</span>&nbsp;<span class="ident" id="4498015">m</span><span class="op" id="4498016">.</span><span class="ident" id="4498017">raw</span>&nbsp;<span class="op" id="4498021">!=</span>&nbsp;<span class="ident" id="4498024">nil</span>&nbsp;<span class="op" id="4498028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498032">return</span>&nbsp;<span class="ident" id="4498039">m</span><span class="op" id="4498040">.</span><span class="ident" id="4498041">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498046">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498050">var</span>&nbsp;<span class="ident" id="4498054">i</span>&nbsp;<span class="builtintype" id="4498056">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498061">for</span>&nbsp;<span class="ident" id="4498065">_</span><span class="op" id="4498066">,</span>&nbsp;<span class="ident" id="4498068">slice</span>&nbsp;<span class="op" id="4498074">:=</span>&nbsp;<span class="keyword" id="4498077">range</span>&nbsp;<span class="ident" id="4498083">m</span><span class="op" id="4498084">.</span><span class="ident" id="4498085">certificates</span>&nbsp;<span class="op" id="4498098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498102">i</span>&nbsp;<span class="op" id="4498104">+=</span>&nbsp;<span class="builtinfunc" id="4498107">len</span><span class="op" id="4498110">(</span><span class="ident" id="4498111">slice</span><span class="op" id="4498116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498119">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498123">length</span>&nbsp;<span class="op" id="4498130">:=</span>&nbsp;<span class="num" id="4498133">3</span>&nbsp;<span class="op" id="4498135">+</span>&nbsp;<span class="num" id="4498137">3</span><span class="op" id="4498138">*</span><span class="builtinfunc" id="4498139">len</span><span class="op" id="4498142">(</span><span class="ident" id="4498143">m</span><span class="op" id="4498144">.</span><span class="ident" id="4498145">certificates</span><span class="op" id="4498157">)</span>&nbsp;<span class="op" id="4498159">+</span>&nbsp;<span class="ident" id="4498161">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498164">x</span>&nbsp;<span class="op" id="4498166">=</span>&nbsp;<span class="builtinfunc" id="4498168">make</span><span class="op" id="4498172">(</span><span class="op" id="4498173">[</span><span class="op" id="4498174">]</span><span class="builtintype" id="4498175">byte</span><span class="op" id="4498179">,</span>&nbsp;<span class="num" id="4498181">4</span><span class="op" id="4498182">+</span><span class="ident" id="4498183">length</span><span class="op" id="4498189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498192">x</span><span class="op" id="4498193">[</span><span class="num" id="4498194">0</span><span class="op" id="4498195">]</span>&nbsp;<span class="op" id="4498197">=</span>&nbsp;<span class="ident" id="4498199">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498216">x</span><span class="op" id="4498217">[</span><span class="num" id="4498218">1</span><span class="op" id="4498219">]</span>&nbsp;<span class="op" id="4498221">=</span>&nbsp;<span class="builtintype" id="4498223">uint8</span><span class="op" id="4498228">(</span><span class="ident" id="4498229">length</span>&nbsp;<span class="op" id="4498236">&gt;&gt;</span>&nbsp;<span class="num" id="4498239">16</span><span class="op" id="4498241">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498244">x</span><span class="op" id="4498245">[</span><span class="num" id="4498246">2</span><span class="op" id="4498247">]</span>&nbsp;<span class="op" id="4498249">=</span>&nbsp;<span class="builtintype" id="4498251">uint8</span><span class="op" id="4498256">(</span><span class="ident" id="4498257">length</span>&nbsp;<span class="op" id="4498264">&gt;&gt;</span>&nbsp;<span class="num" id="4498267">8</span><span class="op" id="4498268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498271">x</span><span class="op" id="4498272">[</span><span class="num" id="4498273">3</span><span class="op" id="4498274">]</span>&nbsp;<span class="op" id="4498276">=</span>&nbsp;<span class="builtintype" id="4498278">uint8</span><span class="op" id="4498283">(</span><span class="ident" id="4498284">length</span><span class="op" id="4498290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498294">certificateOctets</span>&nbsp;<span class="op" id="4498312">:=</span>&nbsp;<span class="ident" id="4498315">length</span>&nbsp;<span class="op" id="4498322">-</span>&nbsp;<span class="num" id="4498324">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498327">x</span><span class="op" id="4498328">[</span><span class="num" id="4498329">4</span><span class="op" id="4498330">]</span>&nbsp;<span class="op" id="4498332">=</span>&nbsp;<span class="builtintype" id="4498334">uint8</span><span class="op" id="4498339">(</span><span class="ident" id="4498340">certificateOctets</span>&nbsp;<span class="op" id="4498358">&gt;&gt;</span>&nbsp;<span class="num" id="4498361">16</span><span class="op" id="4498363">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498366">x</span><span class="op" id="4498367">[</span><span class="num" id="4498368">5</span><span class="op" id="4498369">]</span>&nbsp;<span class="op" id="4498371">=</span>&nbsp;<span class="builtintype" id="4498373">uint8</span><span class="op" id="4498378">(</span><span class="ident" id="4498379">certificateOctets</span>&nbsp;<span class="op" id="4498397">&gt;&gt;</span>&nbsp;<span class="num" id="4498400">8</span><span class="op" id="4498401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498404">x</span><span class="op" id="4498405">[</span><span class="num" id="4498406">6</span><span class="op" id="4498407">]</span>&nbsp;<span class="op" id="4498409">=</span>&nbsp;<span class="builtintype" id="4498411">uint8</span><span class="op" id="4498416">(</span><span class="ident" id="4498417">certificateOctets</span><span class="op" id="4498434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498438">y</span>&nbsp;<span class="op" id="4498440">:=</span>&nbsp;<span class="ident" id="4498443">x</span><span class="op" id="4498444">[</span><span class="num" id="4498445">7</span><span class="op" id="4498446">:</span><span class="op" id="4498447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498450">for</span>&nbsp;<span class="ident" id="4498454">_</span><span class="op" id="4498455">,</span>&nbsp;<span class="ident" id="4498457">slice</span>&nbsp;<span class="op" id="4498463">:=</span>&nbsp;<span class="keyword" id="4498466">range</span>&nbsp;<span class="ident" id="4498472">m</span><span class="op" id="4498473">.</span><span class="ident" id="4498474">certificates</span>&nbsp;<span class="op" id="4498487">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498491">y</span><span class="op" id="4498492">[</span><span class="num" id="4498493">0</span><span class="op" id="4498494">]</span>&nbsp;<span class="op" id="4498496">=</span>&nbsp;<span class="builtintype" id="4498498">uint8</span><span class="op" id="4498503">(</span><span class="builtinfunc" id="4498504">len</span><span class="op" id="4498507">(</span><span class="ident" id="4498508">slice</span><span class="op" id="4498513">)</span>&nbsp;<span class="op" id="4498515">&gt;&gt;</span>&nbsp;<span class="num" id="4498518">16</span><span class="op" id="4498520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498524">y</span><span class="op" id="4498525">[</span><span class="num" id="4498526">1</span><span class="op" id="4498527">]</span>&nbsp;<span class="op" id="4498529">=</span>&nbsp;<span class="builtintype" id="4498531">uint8</span><span class="op" id="4498536">(</span><span class="builtinfunc" id="4498537">len</span><span class="op" id="4498540">(</span><span class="ident" id="4498541">slice</span><span class="op" id="4498546">)</span>&nbsp;<span class="op" id="4498548">&gt;&gt;</span>&nbsp;<span class="num" id="4498551">8</span><span class="op" id="4498552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498556">y</span><span class="op" id="4498557">[</span><span class="num" id="4498558">2</span><span class="op" id="4498559">]</span>&nbsp;<span class="op" id="4498561">=</span>&nbsp;<span class="builtintype" id="4498563">uint8</span><span class="op" id="4498568">(</span><span class="builtinfunc" id="4498569">len</span><span class="op" id="4498572">(</span><span class="ident" id="4498573">slice</span><span class="op" id="4498578">)</span><span class="op" id="4498579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4498583">copy</span><span class="op" id="4498587">(</span><span class="ident" id="4498588">y</span><span class="op" id="4498589">[</span><span class="num" id="4498590">3</span><span class="op" id="4498591">:</span><span class="op" id="4498592">]</span><span class="op" id="4498593">,</span>&nbsp;<span class="ident" id="4498595">slice</span><span class="op" id="4498600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498604">y</span>&nbsp;<span class="op" id="4498606">=</span>&nbsp;<span class="ident" id="4498608">y</span><span class="op" id="4498609">[</span><span class="num" id="4498610">3</span><span class="op" id="4498611">+</span><span class="builtinfunc" id="4498612">len</span><span class="op" id="4498615">(</span><span class="ident" id="4498616">slice</span><span class="op" id="4498621">)</span><span class="op" id="4498622">:</span><span class="op" id="4498623">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498630">m</span><span class="op" id="4498631">.</span><span class="ident" id="4498632">raw</span>&nbsp;<span class="op" id="4498636">=</span>&nbsp;<span class="ident" id="4498638">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498641">return</span><br>
<span class="lineno"></span><span class="op" id="4498648">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4498651">func</span>&nbsp;<span class="op" id="4498656">(</span><span class="ident" id="4498657">m</span>&nbsp;<span class="op" id="4498659">*</span><span class="ident" id="4498660">certificateMsg</span><span class="op" id="4498674">)</span>&nbsp;<span class="ident" id="4498676">unmarshal</span><span class="op" id="4498685">(</span><span class="ident" id="4498686">data</span>&nbsp;<span class="op" id="4498691">[</span><span class="op" id="4498692">]</span><span class="builtintype" id="4498693">byte</span><span class="op" id="4498697">)</span>&nbsp;<span class="builtintype" id="4498699">bool</span>&nbsp;<span class="op" id="4498704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498707">if</span>&nbsp;<span class="builtinfunc" id="4498710">len</span><span class="op" id="4498713">(</span><span class="ident" id="4498714">data</span><span class="op" id="4498718">)</span>&nbsp;<span class="op" id="4498720">&lt;</span>&nbsp;<span class="num" id="4498722">7</span>&nbsp;<span class="op" id="4498724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498728">return</span>&nbsp;<span class="builtintype" id="4498735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498742">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498746">m</span><span class="op" id="4498747">.</span><span class="ident" id="4498748">raw</span>&nbsp;<span class="op" id="4498752">=</span>&nbsp;<span class="ident" id="4498754">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498760">certsLen</span>&nbsp;<span class="op" id="4498769">:=</span>&nbsp;<span class="builtintype" id="4498772">uint32</span><span class="op" id="4498778">(</span><span class="ident" id="4498779">data</span><span class="op" id="4498783">[</span><span class="num" id="4498784">4</span><span class="op" id="4498785">]</span><span class="op" id="4498786">)</span><span class="op" id="4498787">&lt;&lt;</span><span class="num" id="4498789">16</span>&nbsp;<span class="op" id="4498792">|</span>&nbsp;<span class="builtintype" id="4498794">uint32</span><span class="op" id="4498800">(</span><span class="ident" id="4498801">data</span><span class="op" id="4498805">[</span><span class="num" id="4498806">5</span><span class="op" id="4498807">]</span><span class="op" id="4498808">)</span><span class="op" id="4498809">&lt;&lt;</span><span class="num" id="4498811">8</span>&nbsp;<span class="op" id="4498813">|</span>&nbsp;<span class="builtintype" id="4498815">uint32</span><span class="op" id="4498821">(</span><span class="ident" id="4498822">data</span><span class="op" id="4498826">[</span><span class="num" id="4498827">6</span><span class="op" id="4498828">]</span><span class="op" id="4498829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498832">if</span>&nbsp;<span class="builtintype" id="4498835">uint32</span><span class="op" id="4498841">(</span><span class="builtinfunc" id="4498842">len</span><span class="op" id="4498845">(</span><span class="ident" id="4498846">data</span><span class="op" id="4498850">)</span><span class="op" id="4498851">)</span>&nbsp;<span class="op" id="4498853">!=</span>&nbsp;<span class="ident" id="4498856">certsLen</span><span class="op" id="4498864">+</span><span class="num" id="4498865">7</span>&nbsp;<span class="op" id="4498867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498871">return</span>&nbsp;<span class="builtintype" id="4498878">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498889">numCerts</span>&nbsp;<span class="op" id="4498898">:=</span>&nbsp;<span class="num" id="4498901">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498904">d</span>&nbsp;<span class="op" id="4498906">:=</span>&nbsp;<span class="ident" id="4498909">data</span><span class="op" id="4498913">[</span><span class="num" id="4498914">7</span><span class="op" id="4498915">:</span><span class="op" id="4498916">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498919">for</span>&nbsp;<span class="ident" id="4498923">certsLen</span>&nbsp;<span class="op" id="4498932">&gt;</span>&nbsp;<span class="num" id="4498934">0</span>&nbsp;<span class="op" id="4498936">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498940">if</span>&nbsp;<span class="builtinfunc" id="4498943">len</span><span class="op" id="4498946">(</span><span class="ident" id="4498947">d</span><span class="op" id="4498948">)</span>&nbsp;<span class="op" id="4498950">&lt;</span>&nbsp;<span class="num" id="4498952">4</span>&nbsp;<span class="op" id="4498954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4498959">return</span>&nbsp;<span class="builtintype" id="4498966">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4498974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4498978">certLen</span>&nbsp;<span class="op" id="4498986">:=</span>&nbsp;<span class="builtintype" id="4498989">uint32</span><span class="op" id="4498995">(</span><span class="ident" id="4498996">d</span><span class="op" id="4498997">[</span><span class="num" id="4498998">0</span><span class="op" id="4498999">]</span><span class="op" id="4499000">)</span><span class="op" id="4499001">&lt;&lt;</span><span class="num" id="4499003">16</span>&nbsp;<span class="op" id="4499006">|</span>&nbsp;<span class="builtintype" id="4499008">uint32</span><span class="op" id="4499014">(</span><span class="ident" id="4499015">d</span><span class="op" id="4499016">[</span><span class="num" id="4499017">1</span><span class="op" id="4499018">]</span><span class="op" id="4499019">)</span><span class="op" id="4499020">&lt;&lt;</span><span class="num" id="4499022">8</span>&nbsp;<span class="op" id="4499024">|</span>&nbsp;<span class="builtintype" id="4499026">uint32</span><span class="op" id="4499032">(</span><span class="ident" id="4499033">d</span><span class="op" id="4499034">[</span><span class="num" id="4499035">2</span><span class="op" id="4499036">]</span><span class="op" id="4499037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499041">if</span>&nbsp;<span class="builtintype" id="4499044">uint32</span><span class="op" id="4499050">(</span><span class="builtinfunc" id="4499051">len</span><span class="op" id="4499054">(</span><span class="ident" id="4499055">d</span><span class="op" id="4499056">)</span><span class="op" id="4499057">)</span>&nbsp;<span class="op" id="4499059">&lt;</span>&nbsp;<span class="num" id="4499061">3</span><span class="op" id="4499062">+</span><span class="ident" id="4499063">certLen</span>&nbsp;<span class="op" id="4499071">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499076">return</span>&nbsp;<span class="builtintype" id="4499083">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499095">d</span>&nbsp;<span class="op" id="4499097">=</span>&nbsp;<span class="ident" id="4499099">d</span><span class="op" id="4499100">[</span><span class="num" id="4499101">3</span><span class="op" id="4499102">+</span><span class="ident" id="4499103">certLen</span><span class="op" id="4499110">:</span><span class="op" id="4499111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499115">certsLen</span>&nbsp;<span class="op" id="4499124">-=</span>&nbsp;<span class="num" id="4499127">3</span>&nbsp;<span class="op" id="4499129">+</span>&nbsp;<span class="ident" id="4499131">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499141">numCerts</span><span class="op" id="4499149">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499157">m</span><span class="op" id="4499158">.</span><span class="ident" id="4499159">certificates</span>&nbsp;<span class="op" id="4499172">=</span>&nbsp;<span class="builtinfunc" id="4499174">make</span><span class="op" id="4499178">(</span><span class="op" id="4499179">[</span><span class="op" id="4499180">]</span><span class="op" id="4499181">[</span><span class="op" id="4499182">]</span><span class="builtintype" id="4499183">byte</span><span class="op" id="4499187">,</span>&nbsp;<span class="ident" id="4499189">numCerts</span><span class="op" id="4499197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499200">d</span>&nbsp;<span class="op" id="4499202">=</span>&nbsp;<span class="ident" id="4499204">data</span><span class="op" id="4499208">[</span><span class="num" id="4499209">7</span><span class="op" id="4499210">:</span><span class="op" id="4499211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499214">for</span>&nbsp;<span class="ident" id="4499218">i</span>&nbsp;<span class="op" id="4499220">:=</span>&nbsp;<span class="num" id="4499223">0</span><span class="op" id="4499224">;</span>&nbsp;<span class="ident" id="4499226">i</span>&nbsp;<span class="op" id="4499228">&lt;</span>&nbsp;<span class="ident" id="4499230">numCerts</span><span class="op" id="4499238">;</span>&nbsp;<span class="ident" id="4499240">i</span><span class="op" id="4499241">++</span>&nbsp;<span class="op" id="4499244">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499248">certLen</span>&nbsp;<span class="op" id="4499256">:=</span>&nbsp;<span class="builtintype" id="4499259">uint32</span><span class="op" id="4499265">(</span><span class="ident" id="4499266">d</span><span class="op" id="4499267">[</span><span class="num" id="4499268">0</span><span class="op" id="4499269">]</span><span class="op" id="4499270">)</span><span class="op" id="4499271">&lt;&lt;</span><span class="num" id="4499273">16</span>&nbsp;<span class="op" id="4499276">|</span>&nbsp;<span class="builtintype" id="4499278">uint32</span><span class="op" id="4499284">(</span><span class="ident" id="4499285">d</span><span class="op" id="4499286">[</span><span class="num" id="4499287">1</span><span class="op" id="4499288">]</span><span class="op" id="4499289">)</span><span class="op" id="4499290">&lt;&lt;</span><span class="num" id="4499292">8</span>&nbsp;<span class="op" id="4499294">|</span>&nbsp;<span class="builtintype" id="4499296">uint32</span><span class="op" id="4499302">(</span><span class="ident" id="4499303">d</span><span class="op" id="4499304">[</span><span class="num" id="4499305">2</span><span class="op" id="4499306">]</span><span class="op" id="4499307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499311">m</span><span class="op" id="4499312">.</span><span class="ident" id="4499313">certificates</span><span class="op" id="4499325">[</span><span class="ident" id="4499326">i</span><span class="op" id="4499327">]</span>&nbsp;<span class="op" id="4499329">=</span>&nbsp;<span class="ident" id="4499331">d</span><span class="op" id="4499332">[</span><span class="num" id="4499333">3</span>&nbsp;<span class="op" id="4499335">:</span>&nbsp;<span class="num" id="4499337">3</span><span class="op" id="4499338">+</span><span class="ident" id="4499339">certLen</span><span class="op" id="4499346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499350">d</span>&nbsp;<span class="op" id="4499352">=</span>&nbsp;<span class="ident" id="4499354">d</span><span class="op" id="4499355">[</span><span class="num" id="4499356">3</span><span class="op" id="4499357">+</span><span class="ident" id="4499358">certLen</span><span class="op" id="4499365">:</span><span class="op" id="4499366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499373">return</span>&nbsp;<span class="builtintype" id="4499380">true</span><br>
<span class="lineno"></span><span class="op" id="4499385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499388">type</span>&nbsp;<span class="ident" id="4499393">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4499414">struct</span>&nbsp;<span class="op" id="4499421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499424">raw</span>&nbsp;<span class="op" id="4499428">[</span><span class="op" id="4499429">]</span><span class="builtintype" id="4499430">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499436">key</span>&nbsp;<span class="op" id="4499440">[</span><span class="op" id="4499441">]</span><span class="builtintype" id="4499442">byte</span><br>
<span class="lineno"></span><span class="op" id="4499447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499450">func</span>&nbsp;<span class="op" id="4499455">(</span><span class="ident" id="4499456">m</span>&nbsp;<span class="op" id="4499458">*</span><span class="ident" id="4499459">serverKeyExchangeMsg</span><span class="op" id="4499479">)</span>&nbsp;<span class="ident" id="4499481">equal</span><span class="op" id="4499486">(</span><span class="ident" id="4499487">i</span>&nbsp;<span class="keyword" id="4499489">interface</span><span class="op" id="4499498">{</span><span class="op" id="4499499">}</span><span class="op" id="4499500">)</span>&nbsp;<span class="builtintype" id="4499502">bool</span>&nbsp;<span class="op" id="4499507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499510">m1</span><span class="op" id="4499512">,</span>&nbsp;<span class="ident" id="4499514">ok</span>&nbsp;<span class="op" id="4499517">:=</span>&nbsp;<span class="ident" id="4499520">i</span><span class="op" id="4499521">.</span><span class="op" id="4499522">(</span><span class="op" id="4499523">*</span><span class="ident" id="4499524">serverKeyExchangeMsg</span><span class="op" id="4499544">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499547">if</span>&nbsp;<span class="op" id="4499550">!</span><span class="ident" id="4499551">ok</span>&nbsp;<span class="op" id="4499554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499558">return</span>&nbsp;<span class="builtintype" id="4499565">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499576">return</span>&nbsp;<span class="ident" id="4499583">bytes</span><span class="op" id="4499588">.</span><span class="ident" id="4499589">Equal</span><span class="op" id="4499594">(</span><span class="ident" id="4499595">m</span><span class="op" id="4499596">.</span><span class="ident" id="4499597">raw</span><span class="op" id="4499600">,</span>&nbsp;<span class="ident" id="4499602">m1</span><span class="op" id="4499604">.</span><span class="ident" id="4499605">raw</span><span class="op" id="4499608">)</span>&nbsp;<span class="op" id="4499610">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499615">bytes</span><span class="op" id="4499620">.</span><span class="ident" id="4499621">Equal</span><span class="op" id="4499626">(</span><span class="ident" id="4499627">m</span><span class="op" id="4499628">.</span><span class="ident" id="4499629">key</span><span class="op" id="4499632">,</span>&nbsp;<span class="ident" id="4499634">m1</span><span class="op" id="4499636">.</span><span class="ident" id="4499637">key</span><span class="op" id="4499640">)</span><br>
<span class="lineno"></span><span class="op" id="4499642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499645">func</span>&nbsp;<span class="op" id="4499650">(</span><span class="ident" id="4499651">m</span>&nbsp;<span class="op" id="4499653">*</span><span class="ident" id="4499654">serverKeyExchangeMsg</span><span class="op" id="4499674">)</span>&nbsp;<span class="ident" id="4499676">marshal</span><span class="op" id="4499683">(</span><span class="op" id="4499684">)</span>&nbsp;<span class="op" id="4499686">[</span><span class="op" id="4499687">]</span><span class="builtintype" id="4499688">byte</span>&nbsp;<span class="op" id="4499693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499696">if</span>&nbsp;<span class="ident" id="4499699">m</span><span class="op" id="4499700">.</span><span class="ident" id="4499701">raw</span>&nbsp;<span class="op" id="4499705">!=</span>&nbsp;<span class="ident" id="4499708">nil</span>&nbsp;<span class="op" id="4499712">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499716">return</span>&nbsp;<span class="ident" id="4499723">m</span><span class="op" id="4499724">.</span><span class="ident" id="4499725">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4499730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499733">length</span>&nbsp;<span class="op" id="4499740">:=</span>&nbsp;<span class="builtinfunc" id="4499743">len</span><span class="op" id="4499746">(</span><span class="ident" id="4499747">m</span><span class="op" id="4499748">.</span><span class="ident" id="4499749">key</span><span class="op" id="4499752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499755">x</span>&nbsp;<span class="op" id="4499757">:=</span>&nbsp;<span class="builtinfunc" id="4499760">make</span><span class="op" id="4499764">(</span><span class="op" id="4499765">[</span><span class="op" id="4499766">]</span><span class="builtintype" id="4499767">byte</span><span class="op" id="4499771">,</span>&nbsp;<span class="ident" id="4499773">length</span><span class="op" id="4499779">+</span><span class="num" id="4499780">4</span><span class="op" id="4499781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499784">x</span><span class="op" id="4499785">[</span><span class="num" id="4499786">0</span><span class="op" id="4499787">]</span>&nbsp;<span class="op" id="4499789">=</span>&nbsp;<span class="ident" id="4499791">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499814">x</span><span class="op" id="4499815">[</span><span class="num" id="4499816">1</span><span class="op" id="4499817">]</span>&nbsp;<span class="op" id="4499819">=</span>&nbsp;<span class="builtintype" id="4499821">uint8</span><span class="op" id="4499826">(</span><span class="ident" id="4499827">length</span>&nbsp;<span class="op" id="4499834">&gt;&gt;</span>&nbsp;<span class="num" id="4499837">16</span><span class="op" id="4499839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499842">x</span><span class="op" id="4499843">[</span><span class="num" id="4499844">2</span><span class="op" id="4499845">]</span>&nbsp;<span class="op" id="4499847">=</span>&nbsp;<span class="builtintype" id="4499849">uint8</span><span class="op" id="4499854">(</span><span class="ident" id="4499855">length</span>&nbsp;<span class="op" id="4499862">&gt;&gt;</span>&nbsp;<span class="num" id="4499865">8</span><span class="op" id="4499866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499869">x</span><span class="op" id="4499870">[</span><span class="num" id="4499871">3</span><span class="op" id="4499872">]</span>&nbsp;<span class="op" id="4499874">=</span>&nbsp;<span class="builtintype" id="4499876">uint8</span><span class="op" id="4499881">(</span><span class="ident" id="4499882">length</span><span class="op" id="4499888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4499891">copy</span><span class="op" id="4499895">(</span><span class="ident" id="4499896">x</span><span class="op" id="4499897">[</span><span class="num" id="4499898">4</span><span class="op" id="4499899">:</span><span class="op" id="4499900">]</span><span class="op" id="4499901">,</span>&nbsp;<span class="ident" id="4499903">m</span><span class="op" id="4499904">.</span><span class="ident" id="4499905">key</span><span class="op" id="4499908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499912">m</span><span class="op" id="4499913">.</span><span class="ident" id="4499914">raw</span>&nbsp;<span class="op" id="4499918">=</span>&nbsp;<span class="ident" id="4499920">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4499923">return</span>&nbsp;<span class="ident" id="4499930">x</span><br>
<span class="lineno"></span><span class="op" id="4499932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499935">func</span>&nbsp;<span class="op" id="4499940">(</span><span class="ident" id="4499941">m</span>&nbsp;<span class="op" id="4499943">*</span><span class="ident" id="4499944">serverKeyExchangeMsg</span><span class="op" id="4499964">)</span>&nbsp;<span class="ident" id="4499966">unmarshal</span><span class="op" id="4499975">(</span><span class="ident" id="4499976">data</span>&nbsp;<span class="op" id="4499981">[</span><span class="op" id="4499982">]</span><span class="builtintype" id="4499983">byte</span><span class="op" id="4499987">)</span>&nbsp;<span class="builtintype" id="4499989">bool</span>&nbsp;<span class="op" id="4499994">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4499997">m</span><span class="op" id="4499998">.</span><span class="ident" id="4499999">raw</span>&nbsp;<span class="op" id="4500003">=</span>&nbsp;<span class="ident" id="4500005">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500011">if</span>&nbsp;<span class="builtinfunc" id="4500014">len</span><span class="op" id="4500017">(</span><span class="ident" id="4500018">data</span><span class="op" id="4500022">)</span>&nbsp;<span class="op" id="4500024">&lt;</span>&nbsp;<span class="num" id="4500026">4</span>&nbsp;<span class="op" id="4500028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500032">return</span>&nbsp;<span class="builtintype" id="4500039">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500049">m</span><span class="op" id="4500050">.</span><span class="ident" id="4500051">key</span>&nbsp;<span class="op" id="4500055">=</span>&nbsp;<span class="ident" id="4500057">data</span><span class="op" id="4500061">[</span><span class="num" id="4500062">4</span><span class="op" id="4500063">:</span><span class="op" id="4500064">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500067">return</span>&nbsp;<span class="builtintype" id="4500074">true</span><br>
<span class="lineno"></span><span class="op" id="4500079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500082">type</span>&nbsp;<span class="ident" id="4500087">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4500108">struct</span>&nbsp;<span class="op" id="4500115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500118">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4500129">[</span><span class="op" id="4500130">]</span><span class="builtintype" id="4500131">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500137">statusType</span>&nbsp;<span class="builtintype" id="4500148">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500155">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4500166">[</span><span class="op" id="4500167">]</span><span class="builtintype" id="4500168">byte</span><br>
<span class="lineno"></span><span class="op" id="4500173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500176">func</span>&nbsp;<span class="op" id="4500181">(</span><span class="ident" id="4500182">m</span>&nbsp;<span class="op" id="4500184">*</span><span class="ident" id="4500185">certificateStatusMsg</span><span class="op" id="4500205">)</span>&nbsp;<span class="ident" id="4500207">equal</span><span class="op" id="4500212">(</span><span class="ident" id="4500213">i</span>&nbsp;<span class="keyword" id="4500215">interface</span><span class="op" id="4500224">{</span><span class="op" id="4500225">}</span><span class="op" id="4500226">)</span>&nbsp;<span class="builtintype" id="4500228">bool</span>&nbsp;<span class="op" id="4500233">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500236">m1</span><span class="op" id="4500238">,</span>&nbsp;<span class="ident" id="4500240">ok</span>&nbsp;<span class="op" id="4500243">:=</span>&nbsp;<span class="ident" id="4500246">i</span><span class="op" id="4500247">.</span><span class="op" id="4500248">(</span><span class="op" id="4500249">*</span><span class="ident" id="4500250">certificateStatusMsg</span><span class="op" id="4500270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500273">if</span>&nbsp;<span class="op" id="4500276">!</span><span class="ident" id="4500277">ok</span>&nbsp;<span class="op" id="4500280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500284">return</span>&nbsp;<span class="builtintype" id="4500291">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500302">return</span>&nbsp;<span class="ident" id="4500309">bytes</span><span class="op" id="4500314">.</span><span class="ident" id="4500315">Equal</span><span class="op" id="4500320">(</span><span class="ident" id="4500321">m</span><span class="op" id="4500322">.</span><span class="ident" id="4500323">raw</span><span class="op" id="4500326">,</span>&nbsp;<span class="ident" id="4500328">m1</span><span class="op" id="4500330">.</span><span class="ident" id="4500331">raw</span><span class="op" id="4500334">)</span>&nbsp;<span class="op" id="4500336">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500341">m</span><span class="op" id="4500342">.</span><span class="ident" id="4500343">statusType</span>&nbsp;<span class="op" id="4500354">==</span>&nbsp;<span class="ident" id="4500357">m1</span><span class="op" id="4500359">.</span><span class="ident" id="4500360">statusType</span>&nbsp;<span class="op" id="4500371">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500376">bytes</span><span class="op" id="4500381">.</span><span class="ident" id="4500382">Equal</span><span class="op" id="4500387">(</span><span class="ident" id="4500388">m</span><span class="op" id="4500389">.</span><span class="ident" id="4500390">response</span><span class="op" id="4500398">,</span>&nbsp;<span class="ident" id="4500400">m1</span><span class="op" id="4500402">.</span><span class="ident" id="4500403">response</span><span class="op" id="4500411">)</span><br>
<span class="lineno"></span><span class="op" id="4500413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4500416">func</span>&nbsp;<span class="op" id="4500421">(</span><span class="ident" id="4500422">m</span>&nbsp;<span class="op" id="4500424">*</span><span class="ident" id="4500425">certificateStatusMsg</span><span class="op" id="4500445">)</span>&nbsp;<span class="ident" id="4500447">marshal</span><span class="op" id="4500454">(</span><span class="op" id="4500455">)</span>&nbsp;<span class="op" id="4500457">[</span><span class="op" id="4500458">]</span><span class="builtintype" id="4500459">byte</span>&nbsp;<span class="op" id="4500464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500467">if</span>&nbsp;<span class="ident" id="4500470">m</span><span class="op" id="4500471">.</span><span class="ident" id="4500472">raw</span>&nbsp;<span class="op" id="4500476">!=</span>&nbsp;<span class="ident" id="4500479">nil</span>&nbsp;<span class="op" id="4500483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500487">return</span>&nbsp;<span class="ident" id="4500494">m</span><span class="op" id="4500495">.</span><span class="ident" id="4500496">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500505">var</span>&nbsp;<span class="ident" id="4500509">x</span>&nbsp;<span class="op" id="4500511">[</span><span class="op" id="4500512">]</span><span class="builtintype" id="4500513">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500519">if</span>&nbsp;<span class="ident" id="4500522">m</span><span class="op" id="4500523">.</span><span class="ident" id="4500524">statusType</span>&nbsp;<span class="op" id="4500535">==</span>&nbsp;<span class="ident" id="4500538">statusTypeOCSP</span>&nbsp;<span class="op" id="4500553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500557">x</span>&nbsp;<span class="op" id="4500559">=</span>&nbsp;<span class="builtinfunc" id="4500561">make</span><span class="op" id="4500565">(</span><span class="op" id="4500566">[</span><span class="op" id="4500567">]</span><span class="builtintype" id="4500568">byte</span><span class="op" id="4500572">,</span>&nbsp;<span class="num" id="4500574">4</span><span class="op" id="4500575">+</span><span class="num" id="4500576">4</span><span class="op" id="4500577">+</span><span class="builtinfunc" id="4500578">len</span><span class="op" id="4500581">(</span><span class="ident" id="4500582">m</span><span class="op" id="4500583">.</span><span class="ident" id="4500584">response</span><span class="op" id="4500592">)</span><span class="op" id="4500593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500597">x</span><span class="op" id="4500598">[</span><span class="num" id="4500599">0</span><span class="op" id="4500600">]</span>&nbsp;<span class="op" id="4500602">=</span>&nbsp;<span class="ident" id="4500604">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500628">l</span>&nbsp;<span class="op" id="4500630">:=</span>&nbsp;<span class="builtinfunc" id="4500633">len</span><span class="op" id="4500636">(</span><span class="ident" id="4500637">m</span><span class="op" id="4500638">.</span><span class="ident" id="4500639">response</span><span class="op" id="4500647">)</span>&nbsp;<span class="op" id="4500649">+</span>&nbsp;<span class="num" id="4500651">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500655">x</span><span class="op" id="4500656">[</span><span class="num" id="4500657">1</span><span class="op" id="4500658">]</span>&nbsp;<span class="op" id="4500660">=</span>&nbsp;<span class="builtintype" id="4500662">byte</span><span class="op" id="4500666">(</span><span class="ident" id="4500667">l</span>&nbsp;<span class="op" id="4500669">&gt;&gt;</span>&nbsp;<span class="num" id="4500672">16</span><span class="op" id="4500674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500678">x</span><span class="op" id="4500679">[</span><span class="num" id="4500680">2</span><span class="op" id="4500681">]</span>&nbsp;<span class="op" id="4500683">=</span>&nbsp;<span class="builtintype" id="4500685">byte</span><span class="op" id="4500689">(</span><span class="ident" id="4500690">l</span>&nbsp;<span class="op" id="4500692">&gt;&gt;</span>&nbsp;<span class="num" id="4500695">8</span><span class="op" id="4500696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500700">x</span><span class="op" id="4500701">[</span><span class="num" id="4500702">3</span><span class="op" id="4500703">]</span>&nbsp;<span class="op" id="4500705">=</span>&nbsp;<span class="builtintype" id="4500707">byte</span><span class="op" id="4500711">(</span><span class="ident" id="4500712">l</span><span class="op" id="4500713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500717">x</span><span class="op" id="4500718">[</span><span class="num" id="4500719">4</span><span class="op" id="4500720">]</span>&nbsp;<span class="op" id="4500722">=</span>&nbsp;<span class="ident" id="4500724">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500742">l</span>&nbsp;<span class="op" id="4500744">-=</span>&nbsp;<span class="num" id="4500747">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500751">x</span><span class="op" id="4500752">[</span><span class="num" id="4500753">5</span><span class="op" id="4500754">]</span>&nbsp;<span class="op" id="4500756">=</span>&nbsp;<span class="builtintype" id="4500758">byte</span><span class="op" id="4500762">(</span><span class="ident" id="4500763">l</span>&nbsp;<span class="op" id="4500765">&gt;&gt;</span>&nbsp;<span class="num" id="4500768">16</span><span class="op" id="4500770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500774">x</span><span class="op" id="4500775">[</span><span class="num" id="4500776">6</span><span class="op" id="4500777">]</span>&nbsp;<span class="op" id="4500779">=</span>&nbsp;<span class="builtintype" id="4500781">byte</span><span class="op" id="4500785">(</span><span class="ident" id="4500786">l</span>&nbsp;<span class="op" id="4500788">&gt;&gt;</span>&nbsp;<span class="num" id="4500791">8</span><span class="op" id="4500792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500796">x</span><span class="op" id="4500797">[</span><span class="num" id="4500798">7</span><span class="op" id="4500799">]</span>&nbsp;<span class="op" id="4500801">=</span>&nbsp;<span class="builtintype" id="4500803">byte</span><span class="op" id="4500807">(</span><span class="ident" id="4500808">l</span><span class="op" id="4500809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4500813">copy</span><span class="op" id="4500817">(</span><span class="ident" id="4500818">x</span><span class="op" id="4500819">[</span><span class="num" id="4500820">8</span><span class="op" id="4500821">:</span><span class="op" id="4500822">]</span><span class="op" id="4500823">,</span>&nbsp;<span class="ident" id="4500825">m</span><span class="op" id="4500826">.</span><span class="ident" id="4500827">response</span><span class="op" id="4500835">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500838">}</span>&nbsp;<span class="keyword" id="4500840">else</span>&nbsp;<span class="op" id="4500845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500849">x</span>&nbsp;<span class="op" id="4500851">=</span>&nbsp;<span class="op" id="4500853">[</span><span class="op" id="4500854">]</span><span class="builtintype" id="4500855">byte</span><span class="op" id="4500859">{</span><span class="ident" id="4500860">typeCertificateStatus</span><span class="op" id="4500881">,</span>&nbsp;<span class="num" id="4500883">0</span><span class="op" id="4500884">,</span>&nbsp;<span class="num" id="4500886">0</span><span class="op" id="4500887">,</span>&nbsp;<span class="num" id="4500889">1</span><span class="op" id="4500890">,</span>&nbsp;<span class="ident" id="4500892">m</span><span class="op" id="4500893">.</span><span class="ident" id="4500894">statusType</span><span class="op" id="4500904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4500907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500911">m</span><span class="op" id="4500912">.</span><span class="ident" id="4500913">raw</span>&nbsp;<span class="op" id="4500917">=</span>&nbsp;<span class="ident" id="4500919">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4500922">return</span>&nbsp;<span class="ident" id="4500929">x</span><br>
<span class="lineno"></span><span class="op" id="4500931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4500934">func</span>&nbsp;<span class="op" id="4500939">(</span><span class="ident" id="4500940">m</span>&nbsp;<span class="op" id="4500942">*</span><span class="ident" id="4500943">certificateStatusMsg</span><span class="op" id="4500963">)</span>&nbsp;<span class="ident" id="4500965">unmarshal</span><span class="op" id="4500974">(</span><span class="ident" id="4500975">data</span>&nbsp;<span class="op" id="4500980">[</span><span class="op" id="4500981">]</span><span class="builtintype" id="4500982">byte</span><span class="op" id="4500986">)</span>&nbsp;<span class="builtintype" id="4500988">bool</span>&nbsp;<span class="op" id="4500993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4500996">m</span><span class="op" id="4500997">.</span><span class="ident" id="4500998">raw</span>&nbsp;<span class="op" id="4501002">=</span>&nbsp;<span class="ident" id="4501004">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501010">if</span>&nbsp;<span class="builtinfunc" id="4501013">len</span><span class="op" id="4501016">(</span><span class="ident" id="4501017">data</span><span class="op" id="4501021">)</span>&nbsp;<span class="op" id="4501023">&lt;</span>&nbsp;<span class="num" id="4501025">5</span>&nbsp;<span class="op" id="4501027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501031">return</span>&nbsp;<span class="builtintype" id="4501038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501048">m</span><span class="op" id="4501049">.</span><span class="ident" id="4501050">statusType</span>&nbsp;<span class="op" id="4501061">=</span>&nbsp;<span class="ident" id="4501063">data</span><span class="op" id="4501067">[</span><span class="num" id="4501068">4</span><span class="op" id="4501069">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501073">m</span><span class="op" id="4501074">.</span><span class="ident" id="4501075">response</span>&nbsp;<span class="op" id="4501084">=</span>&nbsp;<span class="ident" id="4501086">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501091">if</span>&nbsp;<span class="ident" id="4501094">m</span><span class="op" id="4501095">.</span><span class="ident" id="4501096">statusType</span>&nbsp;<span class="op" id="4501107">==</span>&nbsp;<span class="ident" id="4501110">statusTypeOCSP</span>&nbsp;<span class="op" id="4501125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501129">if</span>&nbsp;<span class="builtinfunc" id="4501132">len</span><span class="op" id="4501135">(</span><span class="ident" id="4501136">data</span><span class="op" id="4501140">)</span>&nbsp;<span class="op" id="4501142">&lt;</span>&nbsp;<span class="num" id="4501144">8</span>&nbsp;<span class="op" id="4501146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501151">return</span>&nbsp;<span class="builtintype" id="4501158">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501166">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501170">respLen</span>&nbsp;<span class="op" id="4501178">:=</span>&nbsp;<span class="builtintype" id="4501181">uint32</span><span class="op" id="4501187">(</span><span class="ident" id="4501188">data</span><span class="op" id="4501192">[</span><span class="num" id="4501193">5</span><span class="op" id="4501194">]</span><span class="op" id="4501195">)</span><span class="op" id="4501196">&lt;&lt;</span><span class="num" id="4501198">16</span>&nbsp;<span class="op" id="4501201">|</span>&nbsp;<span class="builtintype" id="4501203">uint32</span><span class="op" id="4501209">(</span><span class="ident" id="4501210">data</span><span class="op" id="4501214">[</span><span class="num" id="4501215">6</span><span class="op" id="4501216">]</span><span class="op" id="4501217">)</span><span class="op" id="4501218">&lt;&lt;</span><span class="num" id="4501220">8</span>&nbsp;<span class="op" id="4501222">|</span>&nbsp;<span class="builtintype" id="4501224">uint32</span><span class="op" id="4501230">(</span><span class="ident" id="4501231">data</span><span class="op" id="4501235">[</span><span class="num" id="4501236">7</span><span class="op" id="4501237">]</span><span class="op" id="4501238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501242">if</span>&nbsp;<span class="builtintype" id="4501245">uint32</span><span class="op" id="4501251">(</span><span class="builtinfunc" id="4501252">len</span><span class="op" id="4501255">(</span><span class="ident" id="4501256">data</span><span class="op" id="4501260">)</span><span class="op" id="4501261">)</span>&nbsp;<span class="op" id="4501263">!=</span>&nbsp;<span class="num" id="4501266">4</span><span class="op" id="4501267">+</span><span class="num" id="4501268">4</span><span class="op" id="4501269">+</span><span class="ident" id="4501270">respLen</span>&nbsp;<span class="op" id="4501278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501283">return</span>&nbsp;<span class="builtintype" id="4501290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501302">m</span><span class="op" id="4501303">.</span><span class="ident" id="4501304">response</span>&nbsp;<span class="op" id="4501313">=</span>&nbsp;<span class="ident" id="4501315">data</span><span class="op" id="4501319">[</span><span class="num" id="4501320">8</span><span class="op" id="4501321">:</span><span class="op" id="4501322">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501328">return</span>&nbsp;<span class="builtintype" id="4501335">true</span><br>
<span class="lineno"></span><span class="op" id="4501340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4501343">type</span>&nbsp;<span class="ident" id="4501348">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4501367">struct</span><span class="op" id="4501373">{</span><span class="op" id="4501374">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4501377">func</span>&nbsp;<span class="op" id="4501382">(</span><span class="ident" id="4501383">m</span>&nbsp;<span class="op" id="4501385">*</span><span class="ident" id="4501386">serverHelloDoneMsg</span><span class="op" id="4501404">)</span>&nbsp;<span class="ident" id="4501406">equal</span><span class="op" id="4501411">(</span><span class="ident" id="4501412">i</span>&nbsp;<span class="keyword" id="4501414">interface</span><span class="op" id="4501423">{</span><span class="op" id="4501424">}</span><span class="op" id="4501425">)</span>&nbsp;<span class="builtintype" id="4501427">bool</span>&nbsp;<span class="op" id="4501432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501435">_</span><span class="op" id="4501436">,</span>&nbsp;<span class="ident" id="4501438">ok</span>&nbsp;<span class="op" id="4501441">:=</span>&nbsp;<span class="ident" id="4501444">i</span><span class="op" id="4501445">.</span><span class="op" id="4501446">(</span><span class="op" id="4501447">*</span><span class="ident" id="4501448">serverHelloDoneMsg</span><span class="op" id="4501466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501469">return</span>&nbsp;<span class="ident" id="4501476">ok</span><br>
<span class="lineno"></span><span class="op" id="4501479">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4501482">func</span>&nbsp;<span class="op" id="4501487">(</span><span class="ident" id="4501488">m</span>&nbsp;<span class="op" id="4501490">*</span><span class="ident" id="4501491">serverHelloDoneMsg</span><span class="op" id="4501509">)</span>&nbsp;<span class="ident" id="4501511">marshal</span><span class="op" id="4501518">(</span><span class="op" id="4501519">)</span>&nbsp;<span class="op" id="4501521">[</span><span class="op" id="4501522">]</span><span class="builtintype" id="4501523">byte</span>&nbsp;<span class="op" id="4501528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501531">x</span>&nbsp;<span class="op" id="4501533">:=</span>&nbsp;<span class="builtinfunc" id="4501536">make</span><span class="op" id="4501540">(</span><span class="op" id="4501541">[</span><span class="op" id="4501542">]</span><span class="builtintype" id="4501543">byte</span><span class="op" id="4501547">,</span>&nbsp;<span class="num" id="4501549">4</span><span class="op" id="4501550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501553">x</span><span class="op" id="4501554">[</span><span class="num" id="4501555">0</span><span class="op" id="4501556">]</span>&nbsp;<span class="op" id="4501558">=</span>&nbsp;<span class="ident" id="4501560">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501581">return</span>&nbsp;<span class="ident" id="4501588">x</span><br>
<span class="lineno">920</span><span class="op" id="4501590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4501593">func</span>&nbsp;<span class="op" id="4501598">(</span><span class="ident" id="4501599">m</span>&nbsp;<span class="op" id="4501601">*</span><span class="ident" id="4501602">serverHelloDoneMsg</span><span class="op" id="4501620">)</span>&nbsp;<span class="ident" id="4501622">unmarshal</span><span class="op" id="4501631">(</span><span class="ident" id="4501632">data</span>&nbsp;<span class="op" id="4501637">[</span><span class="op" id="4501638">]</span><span class="builtintype" id="4501639">byte</span><span class="op" id="4501643">)</span>&nbsp;<span class="builtintype" id="4501645">bool</span>&nbsp;<span class="op" id="4501650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501653">return</span>&nbsp;<span class="builtinfunc" id="4501660">len</span><span class="op" id="4501663">(</span><span class="ident" id="4501664">data</span><span class="op" id="4501668">)</span>&nbsp;<span class="op" id="4501670">==</span>&nbsp;<span class="num" id="4501673">4</span><br>
<span class="lineno"></span><span class="op" id="4501675">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4501678">type</span>&nbsp;<span class="ident" id="4501683">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4501704">struct</span>&nbsp;<span class="op" id="4501711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501714">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4501725">[</span><span class="op" id="4501726">]</span><span class="builtintype" id="4501727">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501733">ciphertext</span>&nbsp;<span class="op" id="4501744">[</span><span class="op" id="4501745">]</span><span class="builtintype" id="4501746">byte</span><br>
<span class="lineno"></span><span class="op" id="4501751">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4501754">func</span>&nbsp;<span class="op" id="4501759">(</span><span class="ident" id="4501760">m</span>&nbsp;<span class="op" id="4501762">*</span><span class="ident" id="4501763">clientKeyExchangeMsg</span><span class="op" id="4501783">)</span>&nbsp;<span class="ident" id="4501785">equal</span><span class="op" id="4501790">(</span><span class="ident" id="4501791">i</span>&nbsp;<span class="keyword" id="4501793">interface</span><span class="op" id="4501802">{</span><span class="op" id="4501803">}</span><span class="op" id="4501804">)</span>&nbsp;<span class="builtintype" id="4501806">bool</span>&nbsp;<span class="op" id="4501811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501814">m1</span><span class="op" id="4501816">,</span>&nbsp;<span class="ident" id="4501818">ok</span>&nbsp;<span class="op" id="4501821">:=</span>&nbsp;<span class="ident" id="4501824">i</span><span class="op" id="4501825">.</span><span class="op" id="4501826">(</span><span class="op" id="4501827">*</span><span class="ident" id="4501828">clientKeyExchangeMsg</span><span class="op" id="4501848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501851">if</span>&nbsp;<span class="op" id="4501854">!</span><span class="ident" id="4501855">ok</span>&nbsp;<span class="op" id="4501858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501862">return</span>&nbsp;<span class="builtintype" id="4501869">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4501876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4501880">return</span>&nbsp;<span class="ident" id="4501887">bytes</span><span class="op" id="4501892">.</span><span class="ident" id="4501893">Equal</span><span class="op" id="4501898">(</span><span class="ident" id="4501899">m</span><span class="op" id="4501900">.</span><span class="ident" id="4501901">raw</span><span class="op" id="4501904">,</span>&nbsp;<span class="ident" id="4501906">m1</span><span class="op" id="4501908">.</span><span class="ident" id="4501909">raw</span><span class="op" id="4501912">)</span>&nbsp;<span class="op" id="4501914">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4501919">bytes</span><span class="op" id="4501924">.</span><span class="ident" id="4501925">Equal</span><span class="op" id="4501930">(</span><span class="ident" id="4501931">m</span><span class="op" id="4501932">.</span><span class="ident" id="4501933">ciphertext</span><span class="op" id="4501943">,</span>&nbsp;<span class="ident" id="4501945">m1</span><span class="op" id="4501947">.</span><span class="ident" id="4501948">ciphertext</span><span class="op" id="4501958">)</span><br>
<span class="lineno"></span><span class="op" id="4501960">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4501963">func</span>&nbsp;<span class="op" id="4501968">(</span><span class="ident" id="4501969">m</span>&nbsp;<span class="op" id="4501971">*</span><span class="ident" id="4501972">clientKeyExchangeMsg</span><span class="op" id="4501992">)</span>&nbsp;<span class="ident" id="4501994">marshal</span><span class="op" id="4502001">(</span><span class="op" id="4502002">)</span>&nbsp;<span class="op" id="4502004">[</span><span class="op" id="4502005">]</span><span class="builtintype" id="4502006">byte</span>&nbsp;<span class="op" id="4502011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502014">if</span>&nbsp;<span class="ident" id="4502017">m</span><span class="op" id="4502018">.</span><span class="ident" id="4502019">raw</span>&nbsp;<span class="op" id="4502023">!=</span>&nbsp;<span class="ident" id="4502026">nil</span>&nbsp;<span class="op" id="4502030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502034">return</span>&nbsp;<span class="ident" id="4502041">m</span><span class="op" id="4502042">.</span><span class="ident" id="4502043">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502048">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502051">length</span>&nbsp;<span class="op" id="4502058">:=</span>&nbsp;<span class="builtinfunc" id="4502061">len</span><span class="op" id="4502064">(</span><span class="ident" id="4502065">m</span><span class="op" id="4502066">.</span><span class="ident" id="4502067">ciphertext</span><span class="op" id="4502077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502080">x</span>&nbsp;<span class="op" id="4502082">:=</span>&nbsp;<span class="builtinfunc" id="4502085">make</span><span class="op" id="4502089">(</span><span class="op" id="4502090">[</span><span class="op" id="4502091">]</span><span class="builtintype" id="4502092">byte</span><span class="op" id="4502096">,</span>&nbsp;<span class="ident" id="4502098">length</span><span class="op" id="4502104">+</span><span class="num" id="4502105">4</span><span class="op" id="4502106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502109">x</span><span class="op" id="4502110">[</span><span class="num" id="4502111">0</span><span class="op" id="4502112">]</span>&nbsp;<span class="op" id="4502114">=</span>&nbsp;<span class="ident" id="4502116">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502139">x</span><span class="op" id="4502140">[</span><span class="num" id="4502141">1</span><span class="op" id="4502142">]</span>&nbsp;<span class="op" id="4502144">=</span>&nbsp;<span class="builtintype" id="4502146">uint8</span><span class="op" id="4502151">(</span><span class="ident" id="4502152">length</span>&nbsp;<span class="op" id="4502159">&gt;&gt;</span>&nbsp;<span class="num" id="4502162">16</span><span class="op" id="4502164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502167">x</span><span class="op" id="4502168">[</span><span class="num" id="4502169">2</span><span class="op" id="4502170">]</span>&nbsp;<span class="op" id="4502172">=</span>&nbsp;<span class="builtintype" id="4502174">uint8</span><span class="op" id="4502179">(</span><span class="ident" id="4502180">length</span>&nbsp;<span class="op" id="4502187">&gt;&gt;</span>&nbsp;<span class="num" id="4502190">8</span><span class="op" id="4502191">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502194">x</span><span class="op" id="4502195">[</span><span class="num" id="4502196">3</span><span class="op" id="4502197">]</span>&nbsp;<span class="op" id="4502199">=</span>&nbsp;<span class="builtintype" id="4502201">uint8</span><span class="op" id="4502206">(</span><span class="ident" id="4502207">length</span><span class="op" id="4502213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4502216">copy</span><span class="op" id="4502220">(</span><span class="ident" id="4502221">x</span><span class="op" id="4502222">[</span><span class="num" id="4502223">4</span><span class="op" id="4502224">:</span><span class="op" id="4502225">]</span><span class="op" id="4502226">,</span>&nbsp;<span class="ident" id="4502228">m</span><span class="op" id="4502229">.</span><span class="ident" id="4502230">ciphertext</span><span class="op" id="4502240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502244">m</span><span class="op" id="4502245">.</span><span class="ident" id="4502246">raw</span>&nbsp;<span class="op" id="4502250">=</span>&nbsp;<span class="ident" id="4502252">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502255">return</span>&nbsp;<span class="ident" id="4502262">x</span><br>
<span class="lineno">955</span><span class="op" id="4502264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4502267">func</span>&nbsp;<span class="op" id="4502272">(</span><span class="ident" id="4502273">m</span>&nbsp;<span class="op" id="4502275">*</span><span class="ident" id="4502276">clientKeyExchangeMsg</span><span class="op" id="4502296">)</span>&nbsp;<span class="ident" id="4502298">unmarshal</span><span class="op" id="4502307">(</span><span class="ident" id="4502308">data</span>&nbsp;<span class="op" id="4502313">[</span><span class="op" id="4502314">]</span><span class="builtintype" id="4502315">byte</span><span class="op" id="4502319">)</span>&nbsp;<span class="builtintype" id="4502321">bool</span>&nbsp;<span class="op" id="4502326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502329">m</span><span class="op" id="4502330">.</span><span class="ident" id="4502331">raw</span>&nbsp;<span class="op" id="4502335">=</span>&nbsp;<span class="ident" id="4502337">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502343">if</span>&nbsp;<span class="builtinfunc" id="4502346">len</span><span class="op" id="4502349">(</span><span class="ident" id="4502350">data</span><span class="op" id="4502354">)</span>&nbsp;<span class="op" id="4502356">&lt;</span>&nbsp;<span class="num" id="4502358">4</span>&nbsp;<span class="op" id="4502360">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502364">return</span>&nbsp;<span class="builtintype" id="4502371">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502381">l</span>&nbsp;<span class="op" id="4502383">:=</span>&nbsp;<span class="builtintype" id="4502386">int</span><span class="op" id="4502389">(</span><span class="ident" id="4502390">data</span><span class="op" id="4502394">[</span><span class="num" id="4502395">1</span><span class="op" id="4502396">]</span><span class="op" id="4502397">)</span><span class="op" id="4502398">&lt;&lt;</span><span class="num" id="4502400">16</span>&nbsp;<span class="op" id="4502403">|</span>&nbsp;<span class="builtintype" id="4502405">int</span><span class="op" id="4502408">(</span><span class="ident" id="4502409">data</span><span class="op" id="4502413">[</span><span class="num" id="4502414">2</span><span class="op" id="4502415">]</span><span class="op" id="4502416">)</span><span class="op" id="4502417">&lt;&lt;</span><span class="num" id="4502419">8</span>&nbsp;<span class="op" id="4502421">|</span>&nbsp;<span class="builtintype" id="4502423">int</span><span class="op" id="4502426">(</span><span class="ident" id="4502427">data</span><span class="op" id="4502431">[</span><span class="num" id="4502432">3</span><span class="op" id="4502433">]</span><span class="op" id="4502434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502437">if</span>&nbsp;<span class="ident" id="4502440">l</span>&nbsp;<span class="op" id="4502442">!=</span>&nbsp;<span class="builtinfunc" id="4502445">len</span><span class="op" id="4502448">(</span><span class="ident" id="4502449">data</span><span class="op" id="4502453">)</span><span class="op" id="4502454">-</span><span class="num" id="4502455">4</span>&nbsp;<span class="op" id="4502457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502461">return</span>&nbsp;<span class="builtintype" id="4502468">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502478">m</span><span class="op" id="4502479">.</span><span class="ident" id="4502480">ciphertext</span>&nbsp;<span class="op" id="4502491">=</span>&nbsp;<span class="ident" id="4502493">data</span><span class="op" id="4502497">[</span><span class="num" id="4502498">4</span><span class="op" id="4502499">:</span><span class="op" id="4502500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502503">return</span>&nbsp;<span class="builtintype" id="4502510">true</span><br>
<span class="lineno"></span><span class="op" id="4502515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4502518">type</span>&nbsp;<span class="ident" id="4502523">finishedMsg</span>&nbsp;<span class="keyword" id="4502535">struct</span>&nbsp;<span class="op" id="4502542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502545">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4502556">[</span><span class="op" id="4502557">]</span><span class="builtintype" id="4502558">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502564">verifyData</span>&nbsp;<span class="op" id="4502575">[</span><span class="op" id="4502576">]</span><span class="builtintype" id="4502577">byte</span><br>
<span class="lineno"></span><span class="op" id="4502582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4502585">func</span>&nbsp;<span class="op" id="4502590">(</span><span class="ident" id="4502591">m</span>&nbsp;<span class="op" id="4502593">*</span><span class="ident" id="4502594">finishedMsg</span><span class="op" id="4502605">)</span>&nbsp;<span class="ident" id="4502607">equal</span><span class="op" id="4502612">(</span><span class="ident" id="4502613">i</span>&nbsp;<span class="keyword" id="4502615">interface</span><span class="op" id="4502624">{</span><span class="op" id="4502625">}</span><span class="op" id="4502626">)</span>&nbsp;<span class="builtintype" id="4502628">bool</span>&nbsp;<span class="op" id="4502633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502636">m1</span><span class="op" id="4502638">,</span>&nbsp;<span class="ident" id="4502640">ok</span>&nbsp;<span class="op" id="4502643">:=</span>&nbsp;<span class="ident" id="4502646">i</span><span class="op" id="4502647">.</span><span class="op" id="4502648">(</span><span class="op" id="4502649">*</span><span class="ident" id="4502650">finishedMsg</span><span class="op" id="4502661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502664">if</span>&nbsp;<span class="op" id="4502667">!</span><span class="ident" id="4502668">ok</span>&nbsp;<span class="op" id="4502671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502675">return</span>&nbsp;<span class="builtintype" id="4502682">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502689">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502693">return</span>&nbsp;<span class="ident" id="4502700">bytes</span><span class="op" id="4502705">.</span><span class="ident" id="4502706">Equal</span><span class="op" id="4502711">(</span><span class="ident" id="4502712">m</span><span class="op" id="4502713">.</span><span class="ident" id="4502714">raw</span><span class="op" id="4502717">,</span>&nbsp;<span class="ident" id="4502719">m1</span><span class="op" id="4502721">.</span><span class="ident" id="4502722">raw</span><span class="op" id="4502725">)</span>&nbsp;<span class="op" id="4502727">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502732">bytes</span><span class="op" id="4502737">.</span><span class="ident" id="4502738">Equal</span><span class="op" id="4502743">(</span><span class="ident" id="4502744">m</span><span class="op" id="4502745">.</span><span class="ident" id="4502746">verifyData</span><span class="op" id="4502756">,</span>&nbsp;<span class="ident" id="4502758">m1</span><span class="op" id="4502760">.</span><span class="ident" id="4502761">verifyData</span><span class="op" id="4502771">)</span><br>
<span class="lineno"></span><span class="op" id="4502773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4502776">func</span>&nbsp;<span class="op" id="4502781">(</span><span class="ident" id="4502782">m</span>&nbsp;<span class="op" id="4502784">*</span><span class="ident" id="4502785">finishedMsg</span><span class="op" id="4502796">)</span>&nbsp;<span class="ident" id="4502798">marshal</span><span class="op" id="4502805">(</span><span class="op" id="4502806">)</span>&nbsp;<span class="op" id="4502808">(</span><span class="ident" id="4502809">x</span>&nbsp;<span class="op" id="4502811">[</span><span class="op" id="4502812">]</span><span class="builtintype" id="4502813">byte</span><span class="op" id="4502817">)</span>&nbsp;<span class="op" id="4502819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502822">if</span>&nbsp;<span class="ident" id="4502825">m</span><span class="op" id="4502826">.</span><span class="ident" id="4502827">raw</span>&nbsp;<span class="op" id="4502831">!=</span>&nbsp;<span class="ident" id="4502834">nil</span>&nbsp;<span class="op" id="4502838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502842">return</span>&nbsp;<span class="ident" id="4502849">m</span><span class="op" id="4502850">.</span><span class="ident" id="4502851">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4502856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502860">x</span>&nbsp;<span class="op" id="4502862">=</span>&nbsp;<span class="builtinfunc" id="4502864">make</span><span class="op" id="4502868">(</span><span class="op" id="4502869">[</span><span class="op" id="4502870">]</span><span class="builtintype" id="4502871">byte</span><span class="op" id="4502875">,</span>&nbsp;<span class="num" id="4502877">4</span><span class="op" id="4502878">+</span><span class="builtinfunc" id="4502879">len</span><span class="op" id="4502882">(</span><span class="ident" id="4502883">m</span><span class="op" id="4502884">.</span><span class="ident" id="4502885">verifyData</span><span class="op" id="4502895">)</span><span class="op" id="4502896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502899">x</span><span class="op" id="4502900">[</span><span class="num" id="4502901">0</span><span class="op" id="4502902">]</span>&nbsp;<span class="op" id="4502904">=</span>&nbsp;<span class="ident" id="4502906">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502920">x</span><span class="op" id="4502921">[</span><span class="num" id="4502922">3</span><span class="op" id="4502923">]</span>&nbsp;<span class="op" id="4502925">=</span>&nbsp;<span class="builtintype" id="4502927">byte</span><span class="op" id="4502931">(</span><span class="builtinfunc" id="4502932">len</span><span class="op" id="4502935">(</span><span class="ident" id="4502936">m</span><span class="op" id="4502937">.</span><span class="ident" id="4502938">verifyData</span><span class="op" id="4502948">)</span><span class="op" id="4502949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4502952">copy</span><span class="op" id="4502956">(</span><span class="ident" id="4502957">x</span><span class="op" id="4502958">[</span><span class="num" id="4502959">4</span><span class="op" id="4502960">:</span><span class="op" id="4502961">]</span><span class="op" id="4502962">,</span>&nbsp;<span class="ident" id="4502964">m</span><span class="op" id="4502965">.</span><span class="ident" id="4502966">verifyData</span><span class="op" id="4502976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4502979">m</span><span class="op" id="4502980">.</span><span class="ident" id="4502981">raw</span>&nbsp;<span class="op" id="4502985">=</span>&nbsp;<span class="ident" id="4502987">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4502990">return</span><br>
<span class="lineno"></span><span class="op" id="4502997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503000">func</span>&nbsp;<span class="op" id="4503005">(</span><span class="ident" id="4503006">m</span>&nbsp;<span class="op" id="4503008">*</span><span class="ident" id="4503009">finishedMsg</span><span class="op" id="4503020">)</span>&nbsp;<span class="ident" id="4503022">unmarshal</span><span class="op" id="4503031">(</span><span class="ident" id="4503032">data</span>&nbsp;<span class="op" id="4503037">[</span><span class="op" id="4503038">]</span><span class="builtintype" id="4503039">byte</span><span class="op" id="4503043">)</span>&nbsp;<span class="builtintype" id="4503045">bool</span>&nbsp;<span class="op" id="4503050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503053">m</span><span class="op" id="4503054">.</span><span class="ident" id="4503055">raw</span>&nbsp;<span class="op" id="4503059">=</span>&nbsp;<span class="ident" id="4503061">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503067">if</span>&nbsp;<span class="builtinfunc" id="4503070">len</span><span class="op" id="4503073">(</span><span class="ident" id="4503074">data</span><span class="op" id="4503078">)</span>&nbsp;<span class="op" id="4503080">&lt;</span>&nbsp;<span class="num" id="4503082">4</span>&nbsp;<span class="op" id="4503084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503088">return</span>&nbsp;<span class="builtintype" id="4503095">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503105">m</span><span class="op" id="4503106">.</span><span class="ident" id="4503107">verifyData</span>&nbsp;<span class="op" id="4503118">=</span>&nbsp;<span class="ident" id="4503120">data</span><span class="op" id="4503124">[</span><span class="num" id="4503125">4</span><span class="op" id="4503126">:</span><span class="op" id="4503127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503130">return</span>&nbsp;<span class="builtintype" id="4503137">true</span><br>
<span class="lineno">1005</span><span class="op" id="4503142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503145">type</span>&nbsp;<span class="ident" id="4503150">nextProtoMsg</span>&nbsp;<span class="keyword" id="4503163">struct</span>&nbsp;<span class="op" id="4503170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503173">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4503179">[</span><span class="op" id="4503180">]</span><span class="builtintype" id="4503181">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503187">proto</span>&nbsp;<span class="builtintype" id="4503193">string</span><br>
<span class="lineno">1010</span><span class="op" id="4503200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503203">func</span>&nbsp;<span class="op" id="4503208">(</span><span class="ident" id="4503209">m</span>&nbsp;<span class="op" id="4503211">*</span><span class="ident" id="4503212">nextProtoMsg</span><span class="op" id="4503224">)</span>&nbsp;<span class="ident" id="4503226">equal</span><span class="op" id="4503231">(</span><span class="ident" id="4503232">i</span>&nbsp;<span class="keyword" id="4503234">interface</span><span class="op" id="4503243">{</span><span class="op" id="4503244">}</span><span class="op" id="4503245">)</span>&nbsp;<span class="builtintype" id="4503247">bool</span>&nbsp;<span class="op" id="4503252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503255">m1</span><span class="op" id="4503257">,</span>&nbsp;<span class="ident" id="4503259">ok</span>&nbsp;<span class="op" id="4503262">:=</span>&nbsp;<span class="ident" id="4503265">i</span><span class="op" id="4503266">.</span><span class="op" id="4503267">(</span><span class="op" id="4503268">*</span><span class="ident" id="4503269">nextProtoMsg</span><span class="op" id="4503281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503284">if</span>&nbsp;<span class="op" id="4503287">!</span><span class="ident" id="4503288">ok</span>&nbsp;<span class="op" id="4503291">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503295">return</span>&nbsp;<span class="builtintype" id="4503302">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503313">return</span>&nbsp;<span class="ident" id="4503320">bytes</span><span class="op" id="4503325">.</span><span class="ident" id="4503326">Equal</span><span class="op" id="4503331">(</span><span class="ident" id="4503332">m</span><span class="op" id="4503333">.</span><span class="ident" id="4503334">raw</span><span class="op" id="4503337">,</span>&nbsp;<span class="ident" id="4503339">m1</span><span class="op" id="4503341">.</span><span class="ident" id="4503342">raw</span><span class="op" id="4503345">)</span>&nbsp;<span class="op" id="4503347">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503352">m</span><span class="op" id="4503353">.</span><span class="ident" id="4503354">proto</span>&nbsp;<span class="op" id="4503360">==</span>&nbsp;<span class="ident" id="4503363">m1</span><span class="op" id="4503365">.</span><span class="ident" id="4503366">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4503372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4503375">func</span>&nbsp;<span class="op" id="4503380">(</span><span class="ident" id="4503381">m</span>&nbsp;<span class="op" id="4503383">*</span><span class="ident" id="4503384">nextProtoMsg</span><span class="op" id="4503396">)</span>&nbsp;<span class="ident" id="4503398">marshal</span><span class="op" id="4503405">(</span><span class="op" id="4503406">)</span>&nbsp;<span class="op" id="4503408">[</span><span class="op" id="4503409">]</span><span class="builtintype" id="4503410">byte</span>&nbsp;<span class="op" id="4503415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503418">if</span>&nbsp;<span class="ident" id="4503421">m</span><span class="op" id="4503422">.</span><span class="ident" id="4503423">raw</span>&nbsp;<span class="op" id="4503427">!=</span>&nbsp;<span class="ident" id="4503430">nil</span>&nbsp;<span class="op" id="4503434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503438">return</span>&nbsp;<span class="ident" id="4503445">m</span><span class="op" id="4503446">.</span><span class="ident" id="4503447">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503455">l</span>&nbsp;<span class="op" id="4503457">:=</span>&nbsp;<span class="builtinfunc" id="4503460">len</span><span class="op" id="4503463">(</span><span class="ident" id="4503464">m</span><span class="op" id="4503465">.</span><span class="ident" id="4503466">proto</span><span class="op" id="4503471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503474">if</span>&nbsp;<span class="ident" id="4503477">l</span>&nbsp;<span class="op" id="4503479">&gt;</span>&nbsp;<span class="num" id="4503481">255</span>&nbsp;<span class="op" id="4503485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503489">l</span>&nbsp;<span class="op" id="4503491">=</span>&nbsp;<span class="num" id="4503493">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503498">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503502">padding</span>&nbsp;<span class="op" id="4503510">:=</span>&nbsp;<span class="num" id="4503513">32</span>&nbsp;<span class="op" id="4503516">-</span>&nbsp;<span class="op" id="4503518">(</span><span class="ident" id="4503519">l</span><span class="op" id="4503520">+</span><span class="num" id="4503521">2</span><span class="op" id="4503522">)</span><span class="op" id="4503523">%</span><span class="num" id="4503524">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503528">length</span>&nbsp;<span class="op" id="4503535">:=</span>&nbsp;<span class="ident" id="4503538">l</span>&nbsp;<span class="op" id="4503540">+</span>&nbsp;<span class="ident" id="4503542">padding</span>&nbsp;<span class="op" id="4503550">+</span>&nbsp;<span class="num" id="4503552">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503555">x</span>&nbsp;<span class="op" id="4503557">:=</span>&nbsp;<span class="builtinfunc" id="4503560">make</span><span class="op" id="4503564">(</span><span class="op" id="4503565">[</span><span class="op" id="4503566">]</span><span class="builtintype" id="4503567">byte</span><span class="op" id="4503571">,</span>&nbsp;<span class="ident" id="4503573">length</span><span class="op" id="4503579">+</span><span class="num" id="4503580">4</span><span class="op" id="4503581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503584">x</span><span class="op" id="4503585">[</span><span class="num" id="4503586">0</span><span class="op" id="4503587">]</span>&nbsp;<span class="op" id="4503589">=</span>&nbsp;<span class="ident" id="4503591">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503609">x</span><span class="op" id="4503610">[</span><span class="num" id="4503611">1</span><span class="op" id="4503612">]</span>&nbsp;<span class="op" id="4503614">=</span>&nbsp;<span class="builtintype" id="4503616">uint8</span><span class="op" id="4503621">(</span><span class="ident" id="4503622">length</span>&nbsp;<span class="op" id="4503629">&gt;&gt;</span>&nbsp;<span class="num" id="4503632">16</span><span class="op" id="4503634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503637">x</span><span class="op" id="4503638">[</span><span class="num" id="4503639">2</span><span class="op" id="4503640">]</span>&nbsp;<span class="op" id="4503642">=</span>&nbsp;<span class="builtintype" id="4503644">uint8</span><span class="op" id="4503649">(</span><span class="ident" id="4503650">length</span>&nbsp;<span class="op" id="4503657">&gt;&gt;</span>&nbsp;<span class="num" id="4503660">8</span><span class="op" id="4503661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503664">x</span><span class="op" id="4503665">[</span><span class="num" id="4503666">3</span><span class="op" id="4503667">]</span>&nbsp;<span class="op" id="4503669">=</span>&nbsp;<span class="builtintype" id="4503671">uint8</span><span class="op" id="4503676">(</span><span class="ident" id="4503677">length</span><span class="op" id="4503683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503687">y</span>&nbsp;<span class="op" id="4503689">:=</span>&nbsp;<span class="ident" id="4503692">x</span><span class="op" id="4503693">[</span><span class="num" id="4503694">4</span><span class="op" id="4503695">:</span><span class="op" id="4503696">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503699">y</span><span class="op" id="4503700">[</span><span class="num" id="4503701">0</span><span class="op" id="4503702">]</span>&nbsp;<span class="op" id="4503704">=</span>&nbsp;<span class="builtintype" id="4503706">byte</span><span class="op" id="4503710">(</span><span class="ident" id="4503711">l</span><span class="op" id="4503712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4503715">copy</span><span class="op" id="4503719">(</span><span class="ident" id="4503720">y</span><span class="op" id="4503721">[</span><span class="num" id="4503722">1</span><span class="op" id="4503723">:</span><span class="op" id="4503724">]</span><span class="op" id="4503725">,</span>&nbsp;<span class="op" id="4503727">[</span><span class="op" id="4503728">]</span><span class="builtintype" id="4503729">byte</span><span class="op" id="4503733">(</span><span class="ident" id="4503734">m</span><span class="op" id="4503735">.</span><span class="ident" id="4503736">proto</span><span class="op" id="4503741">[</span><span class="num" id="4503742">0</span><span class="op" id="4503743">:</span><span class="ident" id="4503744">l</span><span class="op" id="4503745">]</span><span class="op" id="4503746">)</span><span class="op" id="4503747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503750">y</span>&nbsp;<span class="op" id="4503752">=</span>&nbsp;<span class="ident" id="4503754">y</span><span class="op" id="4503755">[</span><span class="num" id="4503756">1</span><span class="op" id="4503757">+</span><span class="ident" id="4503758">l</span><span class="op" id="4503759">:</span><span class="op" id="4503760">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503763">y</span><span class="op" id="4503764">[</span><span class="num" id="4503765">0</span><span class="op" id="4503766">]</span>&nbsp;<span class="op" id="4503768">=</span>&nbsp;<span class="builtintype" id="4503770">byte</span><span class="op" id="4503774">(</span><span class="ident" id="4503775">padding</span><span class="op" id="4503782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503786">m</span><span class="op" id="4503787">.</span><span class="ident" id="4503788">raw</span>&nbsp;<span class="op" id="4503792">=</span>&nbsp;<span class="ident" id="4503794">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503798">return</span>&nbsp;<span class="ident" id="4503805">x</span><br>
<span class="lineno"></span><span class="op" id="4503807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4503810">func</span>&nbsp;<span class="op" id="4503815">(</span><span class="ident" id="4503816">m</span>&nbsp;<span class="op" id="4503818">*</span><span class="ident" id="4503819">nextProtoMsg</span><span class="op" id="4503831">)</span>&nbsp;<span class="ident" id="4503833">unmarshal</span><span class="op" id="4503842">(</span><span class="ident" id="4503843">data</span>&nbsp;<span class="op" id="4503848">[</span><span class="op" id="4503849">]</span><span class="builtintype" id="4503850">byte</span><span class="op" id="4503854">)</span>&nbsp;<span class="builtintype" id="4503856">bool</span>&nbsp;<span class="op" id="4503861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503864">m</span><span class="op" id="4503865">.</span><span class="ident" id="4503866">raw</span>&nbsp;<span class="op" id="4503870">=</span>&nbsp;<span class="ident" id="4503872">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503879">if</span>&nbsp;<span class="builtinfunc" id="4503882">len</span><span class="op" id="4503885">(</span><span class="ident" id="4503886">data</span><span class="op" id="4503890">)</span>&nbsp;<span class="op" id="4503892">&lt;</span>&nbsp;<span class="num" id="4503894">5</span>&nbsp;<span class="op" id="4503896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503900">return</span>&nbsp;<span class="builtintype" id="4503907">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4503914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503917">data</span>&nbsp;<span class="op" id="4503922">=</span>&nbsp;<span class="ident" id="4503924">data</span><span class="op" id="4503928">[</span><span class="num" id="4503929">4</span><span class="op" id="4503930">:</span><span class="op" id="4503931">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503934">protoLen</span>&nbsp;<span class="op" id="4503943">:=</span>&nbsp;<span class="builtintype" id="4503946">int</span><span class="op" id="4503949">(</span><span class="ident" id="4503950">data</span><span class="op" id="4503954">[</span><span class="num" id="4503955">0</span><span class="op" id="4503956">]</span><span class="op" id="4503957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4503960">data</span>&nbsp;<span class="op" id="4503965">=</span>&nbsp;<span class="ident" id="4503967">data</span><span class="op" id="4503971">[</span><span class="num" id="4503972">1</span><span class="op" id="4503973">:</span><span class="op" id="4503974">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4503977">if</span>&nbsp;<span class="builtinfunc" id="4503980">len</span><span class="op" id="4503983">(</span><span class="ident" id="4503984">data</span><span class="op" id="4503988">)</span>&nbsp;<span class="op" id="4503990">&lt;</span>&nbsp;<span class="ident" id="4503992">protoLen</span>&nbsp;<span class="op" id="4504001">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504005">return</span>&nbsp;<span class="builtintype" id="4504012">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4504019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504022">m</span><span class="op" id="4504023">.</span><span class="ident" id="4504024">proto</span>&nbsp;<span class="op" id="4504030">=</span>&nbsp;<span class="builtintype" id="4504032">string</span><span class="op" id="4504038">(</span><span class="ident" id="4504039">data</span><span class="op" id="4504043">[</span><span class="num" id="4504044">0</span><span class="op" id="4504045">:</span><span class="ident" id="4504046">protoLen</span><span class="op" id="4504054">]</span><span class="op" id="4504055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504058">data</span>&nbsp;<span class="op" id="4504063">=</span>&nbsp;<span class="ident" id="4504065">data</span><span class="op" id="4504069">[</span><span class="ident" id="4504070">protoLen</span><span class="op" id="4504078">:</span><span class="op" id="4504079">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504083">if</span>&nbsp;<span class="builtinfunc" id="4504086">len</span><span class="op" id="4504089">(</span><span class="ident" id="4504090">data</span><span class="op" id="4504094">)</span>&nbsp;<span class="op" id="4504096">&lt;</span>&nbsp;<span class="num" id="4504098">1</span>&nbsp;<span class="op" id="4504100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504104">return</span>&nbsp;<span class="builtintype" id="4504111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4504118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504121">paddingLen</span>&nbsp;<span class="op" id="4504132">:=</span>&nbsp;<span class="builtintype" id="4504135">int</span><span class="op" id="4504138">(</span><span class="ident" id="4504139">data</span><span class="op" id="4504143">[</span><span class="num" id="4504144">0</span><span class="op" id="4504145">]</span><span class="op" id="4504146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504149">data</span>&nbsp;<span class="op" id="4504154">=</span>&nbsp;<span class="ident" id="4504156">data</span><span class="op" id="4504160">[</span><span class="num" id="4504161">1</span><span class="op" id="4504162">:</span><span class="op" id="4504163">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504166">if</span>&nbsp;<span class="builtinfunc" id="4504169">len</span><span class="op" id="4504172">(</span><span class="ident" id="4504173">data</span><span class="op" id="4504177">)</span>&nbsp;<span class="op" id="4504179">!=</span>&nbsp;<span class="ident" id="4504182">paddingLen</span>&nbsp;<span class="op" id="4504193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504197">return</span>&nbsp;<span class="builtintype" id="4504204">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4504211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504215">return</span>&nbsp;<span class="builtintype" id="4504222">true</span><br>
<span class="lineno">1075</span><span class="op" id="4504227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4504230">type</span>&nbsp;<span class="ident" id="4504235">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4504257">struct</span>&nbsp;<span class="op" id="4504264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504267">raw</span>&nbsp;<span class="op" id="4504271">[</span><span class="op" id="4504272">]</span><span class="builtintype" id="4504273">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4504279">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4504350">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4504423">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504432">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4504452">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504459">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504482">[</span><span class="op" id="4504483">]</span><span class="builtintype" id="4504484">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504490">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504513">[</span><span class="op" id="4504514">]</span><span class="ident" id="4504515">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504533">certificateAuthorities</span>&nbsp;<span class="op" id="4504556">[</span><span class="op" id="4504557">]</span><span class="op" id="4504558">[</span><span class="op" id="4504559">]</span><span class="builtintype" id="4504560">byte</span><br>
<span class="lineno"></span><span class="op" id="4504565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4504568">func</span>&nbsp;<span class="op" id="4504573">(</span><span class="ident" id="4504574">m</span>&nbsp;<span class="op" id="4504576">*</span><span class="ident" id="4504577">certificateRequestMsg</span><span class="op" id="4504598">)</span>&nbsp;<span class="ident" id="4504600">equal</span><span class="op" id="4504605">(</span><span class="ident" id="4504606">i</span>&nbsp;<span class="keyword" id="4504608">interface</span><span class="op" id="4504617">{</span><span class="op" id="4504618">}</span><span class="op" id="4504619">)</span>&nbsp;<span class="builtintype" id="4504621">bool</span>&nbsp;<span class="op" id="4504626">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504629">m1</span><span class="op" id="4504631">,</span>&nbsp;<span class="ident" id="4504633">ok</span>&nbsp;<span class="op" id="4504636">:=</span>&nbsp;<span class="ident" id="4504639">i</span><span class="op" id="4504640">.</span><span class="op" id="4504641">(</span><span class="op" id="4504642">*</span><span class="ident" id="4504643">certificateRequestMsg</span><span class="op" id="4504664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504667">if</span>&nbsp;<span class="op" id="4504670">!</span><span class="ident" id="4504671">ok</span>&nbsp;<span class="op" id="4504674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504678">return</span>&nbsp;<span class="builtintype" id="4504685">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4504692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504696">return</span>&nbsp;<span class="ident" id="4504703">bytes</span><span class="op" id="4504708">.</span><span class="ident" id="4504709">Equal</span><span class="op" id="4504714">(</span><span class="ident" id="4504715">m</span><span class="op" id="4504716">.</span><span class="ident" id="4504717">raw</span><span class="op" id="4504720">,</span>&nbsp;<span class="ident" id="4504722">m1</span><span class="op" id="4504724">.</span><span class="ident" id="4504725">raw</span><span class="op" id="4504728">)</span>&nbsp;<span class="op" id="4504730">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504735">bytes</span><span class="op" id="4504740">.</span><span class="ident" id="4504741">Equal</span><span class="op" id="4504746">(</span><span class="ident" id="4504747">m</span><span class="op" id="4504748">.</span><span class="ident" id="4504749">certificateTypes</span><span class="op" id="4504765">,</span>&nbsp;<span class="ident" id="4504767">m1</span><span class="op" id="4504769">.</span><span class="ident" id="4504770">certificateTypes</span><span class="op" id="4504786">)</span>&nbsp;<span class="op" id="4504788">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504793">eqByteSlices</span><span class="op" id="4504805">(</span><span class="ident" id="4504806">m</span><span class="op" id="4504807">.</span><span class="ident" id="4504808">certificateAuthorities</span><span class="op" id="4504830">,</span>&nbsp;<span class="ident" id="4504832">m1</span><span class="op" id="4504834">.</span><span class="ident" id="4504835">certificateAuthorities</span><span class="op" id="4504857">)</span>&nbsp;<span class="op" id="4504859">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4504864">eqSignatureAndHashes</span><span class="op" id="4504884">(</span><span class="ident" id="4504885">m</span><span class="op" id="4504886">.</span><span class="ident" id="4504887">signatureAndHashes</span><span class="op" id="4504905">,</span>&nbsp;<span class="ident" id="4504907">m1</span><span class="op" id="4504909">.</span><span class="ident" id="4504910">signatureAndHashes</span><span class="op" id="4504928">)</span><br>
<span class="lineno"></span><span class="op" id="4504930">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4504933">func</span>&nbsp;<span class="op" id="4504938">(</span><span class="ident" id="4504939">m</span>&nbsp;<span class="op" id="4504941">*</span><span class="ident" id="4504942">certificateRequestMsg</span><span class="op" id="4504963">)</span>&nbsp;<span class="ident" id="4504965">marshal</span><span class="op" id="4504972">(</span><span class="op" id="4504973">)</span>&nbsp;<span class="op" id="4504975">(</span><span class="ident" id="4504976">x</span>&nbsp;<span class="op" id="4504978">[</span><span class="op" id="4504979">]</span><span class="builtintype" id="4504980">byte</span><span class="op" id="4504984">)</span>&nbsp;<span class="op" id="4504986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4504989">if</span>&nbsp;<span class="ident" id="4504992">m</span><span class="op" id="4504993">.</span><span class="ident" id="4504994">raw</span>&nbsp;<span class="op" id="4504998">!=</span>&nbsp;<span class="ident" id="4505001">nil</span>&nbsp;<span class="op" id="4505005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505009">return</span>&nbsp;<span class="ident" id="4505016">m</span><span class="op" id="4505017">.</span><span class="ident" id="4505018">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505023">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4505027">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505084">length</span>&nbsp;<span class="op" id="4505091">:=</span>&nbsp;<span class="num" id="4505094">1</span>&nbsp;<span class="op" id="4505096">+</span>&nbsp;<span class="builtinfunc" id="4505098">len</span><span class="op" id="4505101">(</span><span class="ident" id="4505102">m</span><span class="op" id="4505103">.</span><span class="ident" id="4505104">certificateTypes</span><span class="op" id="4505120">)</span>&nbsp;<span class="op" id="4505122">+</span>&nbsp;<span class="num" id="4505124">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505127">casLength</span>&nbsp;<span class="op" id="4505137">:=</span>&nbsp;<span class="num" id="4505140">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505143">for</span>&nbsp;<span class="ident" id="4505147">_</span><span class="op" id="4505148">,</span>&nbsp;<span class="ident" id="4505150">ca</span>&nbsp;<span class="op" id="4505153">:=</span>&nbsp;<span class="keyword" id="4505156">range</span>&nbsp;<span class="ident" id="4505162">m</span><span class="op" id="4505163">.</span><span class="ident" id="4505164">certificateAuthorities</span>&nbsp;<span class="op" id="4505187">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505191">casLength</span>&nbsp;<span class="op" id="4505201">+=</span>&nbsp;<span class="num" id="4505204">2</span>&nbsp;<span class="op" id="4505206">+</span>&nbsp;<span class="builtinfunc" id="4505208">len</span><span class="op" id="4505211">(</span><span class="ident" id="4505212">ca</span><span class="op" id="4505214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505220">length</span>&nbsp;<span class="op" id="4505227">+=</span>&nbsp;<span class="ident" id="4505230">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505242">if</span>&nbsp;<span class="ident" id="4505245">m</span><span class="op" id="4505246">.</span><span class="ident" id="4505247">hasSignatureAndHash</span>&nbsp;<span class="op" id="4505267">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505271">length</span>&nbsp;<span class="op" id="4505278">+=</span>&nbsp;<span class="num" id="4505281">2</span>&nbsp;<span class="op" id="4505283">+</span>&nbsp;<span class="num" id="4505285">2</span><span class="op" id="4505286">*</span><span class="builtinfunc" id="4505287">len</span><span class="op" id="4505290">(</span><span class="ident" id="4505291">m</span><span class="op" id="4505292">.</span><span class="ident" id="4505293">signatureAndHashes</span><span class="op" id="4505311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505318">x</span>&nbsp;<span class="op" id="4505320">=</span>&nbsp;<span class="builtinfunc" id="4505322">make</span><span class="op" id="4505326">(</span><span class="op" id="4505327">[</span><span class="op" id="4505328">]</span><span class="builtintype" id="4505329">byte</span><span class="op" id="4505333">,</span>&nbsp;<span class="num" id="4505335">4</span><span class="op" id="4505336">+</span><span class="ident" id="4505337">length</span><span class="op" id="4505343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505346">x</span><span class="op" id="4505347">[</span><span class="num" id="4505348">0</span><span class="op" id="4505349">]</span>&nbsp;<span class="op" id="4505351">=</span>&nbsp;<span class="ident" id="4505353">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505377">x</span><span class="op" id="4505378">[</span><span class="num" id="4505379">1</span><span class="op" id="4505380">]</span>&nbsp;<span class="op" id="4505382">=</span>&nbsp;<span class="builtintype" id="4505384">uint8</span><span class="op" id="4505389">(</span><span class="ident" id="4505390">length</span>&nbsp;<span class="op" id="4505397">&gt;&gt;</span>&nbsp;<span class="num" id="4505400">16</span><span class="op" id="4505402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505405">x</span><span class="op" id="4505406">[</span><span class="num" id="4505407">2</span><span class="op" id="4505408">]</span>&nbsp;<span class="op" id="4505410">=</span>&nbsp;<span class="builtintype" id="4505412">uint8</span><span class="op" id="4505417">(</span><span class="ident" id="4505418">length</span>&nbsp;<span class="op" id="4505425">&gt;&gt;</span>&nbsp;<span class="num" id="4505428">8</span><span class="op" id="4505429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505432">x</span><span class="op" id="4505433">[</span><span class="num" id="4505434">3</span><span class="op" id="4505435">]</span>&nbsp;<span class="op" id="4505437">=</span>&nbsp;<span class="builtintype" id="4505439">uint8</span><span class="op" id="4505444">(</span><span class="ident" id="4505445">length</span><span class="op" id="4505451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505455">x</span><span class="op" id="4505456">[</span><span class="num" id="4505457">4</span><span class="op" id="4505458">]</span>&nbsp;<span class="op" id="4505460">=</span>&nbsp;<span class="builtintype" id="4505462">uint8</span><span class="op" id="4505467">(</span><span class="builtinfunc" id="4505468">len</span><span class="op" id="4505471">(</span><span class="ident" id="4505472">m</span><span class="op" id="4505473">.</span><span class="ident" id="4505474">certificateTypes</span><span class="op" id="4505490">)</span><span class="op" id="4505491">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4505495">copy</span><span class="op" id="4505499">(</span><span class="ident" id="4505500">x</span><span class="op" id="4505501">[</span><span class="num" id="4505502">5</span><span class="op" id="4505503">:</span><span class="op" id="4505504">]</span><span class="op" id="4505505">,</span>&nbsp;<span class="ident" id="4505507">m</span><span class="op" id="4505508">.</span><span class="ident" id="4505509">certificateTypes</span><span class="op" id="4505525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505528">y</span>&nbsp;<span class="op" id="4505530">:=</span>&nbsp;<span class="ident" id="4505533">x</span><span class="op" id="4505534">[</span><span class="num" id="4505535">5</span><span class="op" id="4505536">+</span><span class="builtinfunc" id="4505537">len</span><span class="op" id="4505540">(</span><span class="ident" id="4505541">m</span><span class="op" id="4505542">.</span><span class="ident" id="4505543">certificateTypes</span><span class="op" id="4505559">)</span><span class="op" id="4505560">:</span><span class="op" id="4505561">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505565">if</span>&nbsp;<span class="ident" id="4505568">m</span><span class="op" id="4505569">.</span><span class="ident" id="4505570">hasSignatureAndHash</span>&nbsp;<span class="op" id="4505590">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505594">n</span>&nbsp;<span class="op" id="4505596">:=</span>&nbsp;<span class="builtinfunc" id="4505599">len</span><span class="op" id="4505602">(</span><span class="ident" id="4505603">m</span><span class="op" id="4505604">.</span><span class="ident" id="4505605">signatureAndHashes</span><span class="op" id="4505623">)</span>&nbsp;<span class="op" id="4505625">*</span>&nbsp;<span class="num" id="4505627">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505631">y</span><span class="op" id="4505632">[</span><span class="num" id="4505633">0</span><span class="op" id="4505634">]</span>&nbsp;<span class="op" id="4505636">=</span>&nbsp;<span class="builtintype" id="4505638">uint8</span><span class="op" id="4505643">(</span><span class="ident" id="4505644">n</span>&nbsp;<span class="op" id="4505646">&gt;&gt;</span>&nbsp;<span class="num" id="4505649">8</span><span class="op" id="4505650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505654">y</span><span class="op" id="4505655">[</span><span class="num" id="4505656">1</span><span class="op" id="4505657">]</span>&nbsp;<span class="op" id="4505659">=</span>&nbsp;<span class="builtintype" id="4505661">uint8</span><span class="op" id="4505666">(</span><span class="ident" id="4505667">n</span><span class="op" id="4505668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505672">y</span>&nbsp;<span class="op" id="4505674">=</span>&nbsp;<span class="ident" id="4505676">y</span><span class="op" id="4505677">[</span><span class="num" id="4505678">2</span><span class="op" id="4505679">:</span><span class="op" id="4505680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505684">for</span>&nbsp;<span class="ident" id="4505688">_</span><span class="op" id="4505689">,</span>&nbsp;<span class="ident" id="4505691">sigAndHash</span>&nbsp;<span class="op" id="4505702">:=</span>&nbsp;<span class="keyword" id="4505705">range</span>&nbsp;<span class="ident" id="4505711">m</span><span class="op" id="4505712">.</span><span class="ident" id="4505713">signatureAndHashes</span>&nbsp;<span class="op" id="4505732">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505737">y</span><span class="op" id="4505738">[</span><span class="num" id="4505739">0</span><span class="op" id="4505740">]</span>&nbsp;<span class="op" id="4505742">=</span>&nbsp;<span class="ident" id="4505744">sigAndHash</span><span class="op" id="4505754">.</span><span class="ident" id="4505755">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505763">y</span><span class="op" id="4505764">[</span><span class="num" id="4505765">1</span><span class="op" id="4505766">]</span>&nbsp;<span class="op" id="4505768">=</span>&nbsp;<span class="ident" id="4505770">sigAndHash</span><span class="op" id="4505780">.</span><span class="ident" id="4505781">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505794">y</span>&nbsp;<span class="op" id="4505796">=</span>&nbsp;<span class="ident" id="4505798">y</span><span class="op" id="4505799">[</span><span class="num" id="4505800">2</span><span class="op" id="4505801">:</span><span class="op" id="4505802">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4505809">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505813">y</span><span class="op" id="4505814">[</span><span class="num" id="4505815">0</span><span class="op" id="4505816">]</span>&nbsp;<span class="op" id="4505818">=</span>&nbsp;<span class="builtintype" id="4505820">uint8</span><span class="op" id="4505825">(</span><span class="ident" id="4505826">casLength</span>&nbsp;<span class="op" id="4505836">&gt;&gt;</span>&nbsp;<span class="num" id="4505839">8</span><span class="op" id="4505840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505843">y</span><span class="op" id="4505844">[</span><span class="num" id="4505845">1</span><span class="op" id="4505846">]</span>&nbsp;<span class="op" id="4505848">=</span>&nbsp;<span class="builtintype" id="4505850">uint8</span><span class="op" id="4505855">(</span><span class="ident" id="4505856">casLength</span><span class="op" id="4505865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505868">y</span>&nbsp;<span class="op" id="4505870">=</span>&nbsp;<span class="ident" id="4505872">y</span><span class="op" id="4505873">[</span><span class="num" id="4505874">2</span><span class="op" id="4505875">:</span><span class="op" id="4505876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4505879">for</span>&nbsp;<span class="ident" id="4505883">_</span><span class="op" id="4505884">,</span>&nbsp;<span class="ident" id="4505886">ca</span>&nbsp;<span class="op" id="4505889">:=</span>&nbsp;<span class="keyword" id="4505892">range</span>&nbsp;<span class="ident" id="4505898">m</span><span class="op" id="4505899">.</span><span class="ident" id="4505900">certificateAuthorities</span>&nbsp;<span class="op" id="4505923">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505927">y</span><span class="op" id="4505928">[</span><span class="num" id="4505929">0</span><span class="op" id="4505930">]</span>&nbsp;<span class="op" id="4505932">=</span>&nbsp;<span class="builtintype" id="4505934">uint8</span><span class="op" id="4505939">(</span><span class="builtinfunc" id="4505940">len</span><span class="op" id="4505943">(</span><span class="ident" id="4505944">ca</span><span class="op" id="4505946">)</span>&nbsp;<span class="op" id="4505948">&gt;&gt;</span>&nbsp;<span class="num" id="4505951">8</span><span class="op" id="4505952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505956">y</span><span class="op" id="4505957">[</span><span class="num" id="4505958">1</span><span class="op" id="4505959">]</span>&nbsp;<span class="op" id="4505961">=</span>&nbsp;<span class="builtintype" id="4505963">uint8</span><span class="op" id="4505968">(</span><span class="builtinfunc" id="4505969">len</span><span class="op" id="4505972">(</span><span class="ident" id="4505973">ca</span><span class="op" id="4505975">)</span><span class="op" id="4505976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4505980">y</span>&nbsp;<span class="op" id="4505982">=</span>&nbsp;<span class="ident" id="4505984">y</span><span class="op" id="4505985">[</span><span class="num" id="4505986">2</span><span class="op" id="4505987">:</span><span class="op" id="4505988">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4505992">copy</span><span class="op" id="4505996">(</span><span class="ident" id="4505997">y</span><span class="op" id="4505998">,</span>&nbsp;<span class="ident" id="4506000">ca</span><span class="op" id="4506002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506006">y</span>&nbsp;<span class="op" id="4506008">=</span>&nbsp;<span class="ident" id="4506010">y</span><span class="op" id="4506011">[</span><span class="builtinfunc" id="4506012">len</span><span class="op" id="4506015">(</span><span class="ident" id="4506016">ca</span><span class="op" id="4506018">)</span><span class="op" id="4506019">:</span><span class="op" id="4506020">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506027">m</span><span class="op" id="4506028">.</span><span class="ident" id="4506029">raw</span>&nbsp;<span class="op" id="4506033">=</span>&nbsp;<span class="ident" id="4506035">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506038">return</span><br>
<span class="lineno"></span><span class="op" id="4506045">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4506048">func</span>&nbsp;<span class="op" id="4506053">(</span><span class="ident" id="4506054">m</span>&nbsp;<span class="op" id="4506056">*</span><span class="ident" id="4506057">certificateRequestMsg</span><span class="op" id="4506078">)</span>&nbsp;<span class="ident" id="4506080">unmarshal</span><span class="op" id="4506089">(</span><span class="ident" id="4506090">data</span>&nbsp;<span class="op" id="4506095">[</span><span class="op" id="4506096">]</span><span class="builtintype" id="4506097">byte</span><span class="op" id="4506101">)</span>&nbsp;<span class="builtintype" id="4506103">bool</span>&nbsp;<span class="op" id="4506108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506111">m</span><span class="op" id="4506112">.</span><span class="ident" id="4506113">raw</span>&nbsp;<span class="op" id="4506117">=</span>&nbsp;<span class="ident" id="4506119">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506126">if</span>&nbsp;<span class="builtinfunc" id="4506129">len</span><span class="op" id="4506132">(</span><span class="ident" id="4506133">data</span><span class="op" id="4506137">)</span>&nbsp;<span class="op" id="4506139">&lt;</span>&nbsp;<span class="num" id="4506141">5</span>&nbsp;<span class="op" id="4506143">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506147">return</span>&nbsp;<span class="builtintype" id="4506154">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506165">length</span>&nbsp;<span class="op" id="4506172">:=</span>&nbsp;<span class="builtintype" id="4506175">uint32</span><span class="op" id="4506181">(</span><span class="ident" id="4506182">data</span><span class="op" id="4506186">[</span><span class="num" id="4506187">1</span><span class="op" id="4506188">]</span><span class="op" id="4506189">)</span><span class="op" id="4506190">&lt;&lt;</span><span class="num" id="4506192">16</span>&nbsp;<span class="op" id="4506195">|</span>&nbsp;<span class="builtintype" id="4506197">uint32</span><span class="op" id="4506203">(</span><span class="ident" id="4506204">data</span><span class="op" id="4506208">[</span><span class="num" id="4506209">2</span><span class="op" id="4506210">]</span><span class="op" id="4506211">)</span><span class="op" id="4506212">&lt;&lt;</span><span class="num" id="4506214">8</span>&nbsp;<span class="op" id="4506216">|</span>&nbsp;<span class="builtintype" id="4506218">uint32</span><span class="op" id="4506224">(</span><span class="ident" id="4506225">data</span><span class="op" id="4506229">[</span><span class="num" id="4506230">3</span><span class="op" id="4506231">]</span><span class="op" id="4506232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506235">if</span>&nbsp;<span class="builtintype" id="4506238">uint32</span><span class="op" id="4506244">(</span><span class="builtinfunc" id="4506245">len</span><span class="op" id="4506248">(</span><span class="ident" id="4506249">data</span><span class="op" id="4506253">)</span><span class="op" id="4506254">)</span><span class="op" id="4506255">-</span><span class="num" id="4506256">4</span>&nbsp;<span class="op" id="4506258">!=</span>&nbsp;<span class="ident" id="4506261">length</span>&nbsp;<span class="op" id="4506268">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506272">return</span>&nbsp;<span class="builtintype" id="4506279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506290">numCertTypes</span>&nbsp;<span class="op" id="4506303">:=</span>&nbsp;<span class="builtintype" id="4506306">int</span><span class="op" id="4506309">(</span><span class="ident" id="4506310">data</span><span class="op" id="4506314">[</span><span class="num" id="4506315">4</span><span class="op" id="4506316">]</span><span class="op" id="4506317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506320">data</span>&nbsp;<span class="op" id="4506325">=</span>&nbsp;<span class="ident" id="4506327">data</span><span class="op" id="4506331">[</span><span class="num" id="4506332">5</span><span class="op" id="4506333">:</span><span class="op" id="4506334">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506337">if</span>&nbsp;<span class="ident" id="4506340">numCertTypes</span>&nbsp;<span class="op" id="4506353">==</span>&nbsp;<span class="num" id="4506356">0</span>&nbsp;<span class="op" id="4506358">||</span>&nbsp;<span class="builtinfunc" id="4506361">len</span><span class="op" id="4506364">(</span><span class="ident" id="4506365">data</span><span class="op" id="4506369">)</span>&nbsp;<span class="op" id="4506371">&lt;=</span>&nbsp;<span class="ident" id="4506374">numCertTypes</span>&nbsp;<span class="op" id="4506387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506391">return</span>&nbsp;<span class="builtintype" id="4506398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506409">m</span><span class="op" id="4506410">.</span><span class="ident" id="4506411">certificateTypes</span>&nbsp;<span class="op" id="4506428">=</span>&nbsp;<span class="builtinfunc" id="4506430">make</span><span class="op" id="4506434">(</span><span class="op" id="4506435">[</span><span class="op" id="4506436">]</span><span class="builtintype" id="4506437">byte</span><span class="op" id="4506441">,</span>&nbsp;<span class="ident" id="4506443">numCertTypes</span><span class="op" id="4506455">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506458">if</span>&nbsp;<span class="builtinfunc" id="4506461">copy</span><span class="op" id="4506465">(</span><span class="ident" id="4506466">m</span><span class="op" id="4506467">.</span><span class="ident" id="4506468">certificateTypes</span><span class="op" id="4506484">,</span>&nbsp;<span class="ident" id="4506486">data</span><span class="op" id="4506490">)</span>&nbsp;<span class="op" id="4506492">!=</span>&nbsp;<span class="ident" id="4506495">numCertTypes</span>&nbsp;<span class="op" id="4506508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506512">return</span>&nbsp;<span class="builtintype" id="4506519">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506530">data</span>&nbsp;<span class="op" id="4506535">=</span>&nbsp;<span class="ident" id="4506537">data</span><span class="op" id="4506541">[</span><span class="ident" id="4506542">numCertTypes</span><span class="op" id="4506554">:</span><span class="op" id="4506555">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506559">if</span>&nbsp;<span class="ident" id="4506562">m</span><span class="op" id="4506563">.</span><span class="ident" id="4506564">hasSignatureAndHash</span>&nbsp;<span class="op" id="4506584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506588">if</span>&nbsp;<span class="builtinfunc" id="4506591">len</span><span class="op" id="4506594">(</span><span class="ident" id="4506595">data</span><span class="op" id="4506599">)</span>&nbsp;<span class="op" id="4506601">&lt;</span>&nbsp;<span class="num" id="4506603">2</span>&nbsp;<span class="op" id="4506605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506610">return</span>&nbsp;<span class="builtintype" id="4506617">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506625">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506629">sigAndHashLen</span>&nbsp;<span class="op" id="4506643">:=</span>&nbsp;<span class="builtintype" id="4506646">uint16</span><span class="op" id="4506652">(</span><span class="ident" id="4506653">data</span><span class="op" id="4506657">[</span><span class="num" id="4506658">0</span><span class="op" id="4506659">]</span><span class="op" id="4506660">)</span><span class="op" id="4506661">&lt;&lt;</span><span class="num" id="4506663">8</span>&nbsp;<span class="op" id="4506665">|</span>&nbsp;<span class="builtintype" id="4506667">uint16</span><span class="op" id="4506673">(</span><span class="ident" id="4506674">data</span><span class="op" id="4506678">[</span><span class="num" id="4506679">1</span><span class="op" id="4506680">]</span><span class="op" id="4506681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506685">data</span>&nbsp;<span class="op" id="4506690">=</span>&nbsp;<span class="ident" id="4506692">data</span><span class="op" id="4506696">[</span><span class="num" id="4506697">2</span><span class="op" id="4506698">:</span><span class="op" id="4506699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506703">if</span>&nbsp;<span class="ident" id="4506706">sigAndHashLen</span><span class="op" id="4506719">&amp;</span><span class="num" id="4506720">1</span>&nbsp;<span class="op" id="4506722">!=</span>&nbsp;<span class="num" id="4506725">0</span>&nbsp;<span class="op" id="4506727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506732">return</span>&nbsp;<span class="builtintype" id="4506739">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506747">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506751">if</span>&nbsp;<span class="builtinfunc" id="4506754">len</span><span class="op" id="4506757">(</span><span class="ident" id="4506758">data</span><span class="op" id="4506762">)</span>&nbsp;<span class="op" id="4506764">&lt;</span>&nbsp;<span class="builtintype" id="4506766">int</span><span class="op" id="4506769">(</span><span class="ident" id="4506770">sigAndHashLen</span><span class="op" id="4506783">)</span>&nbsp;<span class="op" id="4506785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506790">return</span>&nbsp;<span class="builtintype" id="4506797">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4506805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506809">numSigAndHash</span>&nbsp;<span class="op" id="4506823">:=</span>&nbsp;<span class="ident" id="4506826">sigAndHashLen</span>&nbsp;<span class="op" id="4506840">/</span>&nbsp;<span class="num" id="4506842">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506846">m</span><span class="op" id="4506847">.</span><span class="ident" id="4506848">signatureAndHashes</span>&nbsp;<span class="op" id="4506867">=</span>&nbsp;<span class="builtinfunc" id="4506869">make</span><span class="op" id="4506873">(</span><span class="op" id="4506874">[</span><span class="op" id="4506875">]</span><span class="ident" id="4506876">signatureAndHash</span><span class="op" id="4506892">,</span>&nbsp;<span class="ident" id="4506894">numSigAndHash</span><span class="op" id="4506907">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4506911">for</span>&nbsp;<span class="ident" id="4506915">i</span>&nbsp;<span class="op" id="4506917">:=</span>&nbsp;<span class="keyword" id="4506920">range</span>&nbsp;<span class="ident" id="4506926">m</span><span class="op" id="4506927">.</span><span class="ident" id="4506928">signatureAndHashes</span>&nbsp;<span class="op" id="4506947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506952">m</span><span class="op" id="4506953">.</span><span class="ident" id="4506954">signatureAndHashes</span><span class="op" id="4506972">[</span><span class="ident" id="4506973">i</span><span class="op" id="4506974">]</span><span class="op" id="4506975">.</span><span class="ident" id="4506976">hash</span>&nbsp;<span class="op" id="4506981">=</span>&nbsp;<span class="ident" id="4506983">data</span><span class="op" id="4506987">[</span><span class="num" id="4506988">0</span><span class="op" id="4506989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4506994">m</span><span class="op" id="4506995">.</span><span class="ident" id="4506996">signatureAndHashes</span><span class="op" id="4507014">[</span><span class="ident" id="4507015">i</span><span class="op" id="4507016">]</span><span class="op" id="4507017">.</span><span class="ident" id="4507018">signature</span>&nbsp;<span class="op" id="4507028">=</span>&nbsp;<span class="ident" id="4507030">data</span><span class="op" id="4507034">[</span><span class="num" id="4507035">1</span><span class="op" id="4507036">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507041">data</span>&nbsp;<span class="op" id="4507046">=</span>&nbsp;<span class="ident" id="4507048">data</span><span class="op" id="4507052">[</span><span class="num" id="4507053">2</span><span class="op" id="4507054">:</span><span class="op" id="4507055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507059">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507066">if</span>&nbsp;<span class="builtinfunc" id="4507069">len</span><span class="op" id="4507072">(</span><span class="ident" id="4507073">data</span><span class="op" id="4507077">)</span>&nbsp;<span class="op" id="4507079">&lt;</span>&nbsp;<span class="num" id="4507081">2</span>&nbsp;<span class="op" id="4507083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507087">return</span>&nbsp;<span class="builtintype" id="4507094">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507101">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507104">casLength</span>&nbsp;<span class="op" id="4507114">:=</span>&nbsp;<span class="builtintype" id="4507117">uint16</span><span class="op" id="4507123">(</span><span class="ident" id="4507124">data</span><span class="op" id="4507128">[</span><span class="num" id="4507129">0</span><span class="op" id="4507130">]</span><span class="op" id="4507131">)</span><span class="op" id="4507132">&lt;&lt;</span><span class="num" id="4507134">8</span>&nbsp;<span class="op" id="4507136">|</span>&nbsp;<span class="builtintype" id="4507138">uint16</span><span class="op" id="4507144">(</span><span class="ident" id="4507145">data</span><span class="op" id="4507149">[</span><span class="num" id="4507150">1</span><span class="op" id="4507151">]</span><span class="op" id="4507152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507155">data</span>&nbsp;<span class="op" id="4507160">=</span>&nbsp;<span class="ident" id="4507162">data</span><span class="op" id="4507166">[</span><span class="num" id="4507167">2</span><span class="op" id="4507168">:</span><span class="op" id="4507169">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507172">if</span>&nbsp;<span class="builtinfunc" id="4507175">len</span><span class="op" id="4507178">(</span><span class="ident" id="4507179">data</span><span class="op" id="4507183">)</span>&nbsp;<span class="op" id="4507185">&lt;</span>&nbsp;<span class="builtintype" id="4507187">int</span><span class="op" id="4507190">(</span><span class="ident" id="4507191">casLength</span><span class="op" id="4507200">)</span>&nbsp;<span class="op" id="4507202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507206">return</span>&nbsp;<span class="builtintype" id="4507213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507220">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507223">cas</span>&nbsp;<span class="op" id="4507227">:=</span>&nbsp;<span class="builtinfunc" id="4507230">make</span><span class="op" id="4507234">(</span><span class="op" id="4507235">[</span><span class="op" id="4507236">]</span><span class="builtintype" id="4507237">byte</span><span class="op" id="4507241">,</span>&nbsp;<span class="ident" id="4507243">casLength</span><span class="op" id="4507252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4507255">copy</span><span class="op" id="4507259">(</span><span class="ident" id="4507260">cas</span><span class="op" id="4507263">,</span>&nbsp;<span class="ident" id="4507265">data</span><span class="op" id="4507269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507272">data</span>&nbsp;<span class="op" id="4507277">=</span>&nbsp;<span class="ident" id="4507279">data</span><span class="op" id="4507283">[</span><span class="ident" id="4507284">casLength</span><span class="op" id="4507293">:</span><span class="op" id="4507294">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507298">m</span><span class="op" id="4507299">.</span><span class="ident" id="4507300">certificateAuthorities</span>&nbsp;<span class="op" id="4507323">=</span>&nbsp;<span class="ident" id="4507325">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507330">for</span>&nbsp;<span class="builtinfunc" id="4507334">len</span><span class="op" id="4507337">(</span><span class="ident" id="4507338">cas</span><span class="op" id="4507341">)</span>&nbsp;<span class="op" id="4507343">&gt;</span>&nbsp;<span class="num" id="4507345">0</span>&nbsp;<span class="op" id="4507347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507351">if</span>&nbsp;<span class="builtinfunc" id="4507354">len</span><span class="op" id="4507357">(</span><span class="ident" id="4507358">cas</span><span class="op" id="4507361">)</span>&nbsp;<span class="op" id="4507363">&lt;</span>&nbsp;<span class="num" id="4507365">2</span>&nbsp;<span class="op" id="4507367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507372">return</span>&nbsp;<span class="builtintype" id="4507379">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507391">caLen</span>&nbsp;<span class="op" id="4507397">:=</span>&nbsp;<span class="builtintype" id="4507400">uint16</span><span class="op" id="4507406">(</span><span class="ident" id="4507407">cas</span><span class="op" id="4507410">[</span><span class="num" id="4507411">0</span><span class="op" id="4507412">]</span><span class="op" id="4507413">)</span><span class="op" id="4507414">&lt;&lt;</span><span class="num" id="4507416">8</span>&nbsp;<span class="op" id="4507418">|</span>&nbsp;<span class="builtintype" id="4507420">uint16</span><span class="op" id="4507426">(</span><span class="ident" id="4507427">cas</span><span class="op" id="4507430">[</span><span class="num" id="4507431">1</span><span class="op" id="4507432">]</span><span class="op" id="4507433">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507437">cas</span>&nbsp;<span class="op" id="4507441">=</span>&nbsp;<span class="ident" id="4507443">cas</span><span class="op" id="4507446">[</span><span class="num" id="4507447">2</span><span class="op" id="4507448">:</span><span class="op" id="4507449">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507454">if</span>&nbsp;<span class="builtinfunc" id="4507457">len</span><span class="op" id="4507460">(</span><span class="ident" id="4507461">cas</span><span class="op" id="4507464">)</span>&nbsp;<span class="op" id="4507466">&lt;</span>&nbsp;<span class="builtintype" id="4507468">int</span><span class="op" id="4507471">(</span><span class="ident" id="4507472">caLen</span><span class="op" id="4507477">)</span>&nbsp;<span class="op" id="4507479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507484">return</span>&nbsp;<span class="builtintype" id="4507491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507499">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507504">m</span><span class="op" id="4507505">.</span><span class="ident" id="4507506">certificateAuthorities</span>&nbsp;<span class="op" id="4507529">=</span>&nbsp;<span class="builtinfunc" id="4507531">append</span><span class="op" id="4507537">(</span><span class="ident" id="4507538">m</span><span class="op" id="4507539">.</span><span class="ident" id="4507540">certificateAuthorities</span><span class="op" id="4507562">,</span>&nbsp;<span class="ident" id="4507564">cas</span><span class="op" id="4507567">[</span><span class="op" id="4507568">:</span><span class="ident" id="4507569">caLen</span><span class="op" id="4507574">]</span><span class="op" id="4507575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507579">cas</span>&nbsp;<span class="op" id="4507583">=</span>&nbsp;<span class="ident" id="4507585">cas</span><span class="op" id="4507588">[</span><span class="ident" id="4507589">caLen</span><span class="op" id="4507594">:</span><span class="op" id="4507595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507601">if</span>&nbsp;<span class="builtinfunc" id="4507604">len</span><span class="op" id="4507607">(</span><span class="ident" id="4507608">data</span><span class="op" id="4507612">)</span>&nbsp;<span class="op" id="4507614">&gt;</span>&nbsp;<span class="num" id="4507616">0</span>&nbsp;<span class="op" id="4507618">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507622">return</span>&nbsp;<span class="builtintype" id="4507629">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507640">return</span>&nbsp;<span class="builtintype" id="4507647">true</span><br>
<span class="lineno"></span><span class="op" id="4507652">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4507655">type</span>&nbsp;<span class="ident" id="4507660">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4507681">struct</span>&nbsp;<span class="op" id="4507688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507691">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507711">[</span><span class="op" id="4507712">]</span><span class="builtintype" id="4507713">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507719">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4507739">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507745">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507765">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507783">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507803">[</span><span class="op" id="4507804">]</span><span class="builtintype" id="4507805">byte</span><br>
<span class="lineno"></span><span class="op" id="4507810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4507813">func</span>&nbsp;<span class="op" id="4507818">(</span><span class="ident" id="4507819">m</span>&nbsp;<span class="op" id="4507821">*</span><span class="ident" id="4507822">certificateVerifyMsg</span><span class="op" id="4507842">)</span>&nbsp;<span class="ident" id="4507844">equal</span><span class="op" id="4507849">(</span><span class="ident" id="4507850">i</span>&nbsp;<span class="keyword" id="4507852">interface</span><span class="op" id="4507861">{</span><span class="op" id="4507862">}</span><span class="op" id="4507863">)</span>&nbsp;<span class="builtintype" id="4507865">bool</span>&nbsp;<span class="op" id="4507870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507873">m1</span><span class="op" id="4507875">,</span>&nbsp;<span class="ident" id="4507877">ok</span>&nbsp;<span class="op" id="4507880">:=</span>&nbsp;<span class="ident" id="4507883">i</span><span class="op" id="4507884">.</span><span class="op" id="4507885">(</span><span class="op" id="4507886">*</span><span class="ident" id="4507887">certificateVerifyMsg</span><span class="op" id="4507907">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507910">if</span>&nbsp;<span class="op" id="4507913">!</span><span class="ident" id="4507914">ok</span>&nbsp;<span class="op" id="4507917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507921">return</span>&nbsp;<span class="builtintype" id="4507928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4507935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4507939">return</span>&nbsp;<span class="ident" id="4507946">bytes</span><span class="op" id="4507951">.</span><span class="ident" id="4507952">Equal</span><span class="op" id="4507957">(</span><span class="ident" id="4507958">m</span><span class="op" id="4507959">.</span><span class="ident" id="4507960">raw</span><span class="op" id="4507963">,</span>&nbsp;<span class="ident" id="4507965">m1</span><span class="op" id="4507967">.</span><span class="ident" id="4507968">raw</span><span class="op" id="4507971">)</span>&nbsp;<span class="op" id="4507973">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4507978">m</span><span class="op" id="4507979">.</span><span class="ident" id="4507980">hasSignatureAndHash</span>&nbsp;<span class="op" id="4508000">==</span>&nbsp;<span class="ident" id="4508003">m1</span><span class="op" id="4508005">.</span><span class="ident" id="4508006">hasSignatureAndHash</span>&nbsp;<span class="op" id="4508026">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508031">m</span><span class="op" id="4508032">.</span><span class="ident" id="4508033">signatureAndHash</span><span class="op" id="4508049">.</span><span class="ident" id="4508050">hash</span>&nbsp;<span class="op" id="4508055">==</span>&nbsp;<span class="ident" id="4508058">m1</span><span class="op" id="4508060">.</span><span class="ident" id="4508061">signatureAndHash</span><span class="op" id="4508077">.</span><span class="ident" id="4508078">hash</span>&nbsp;<span class="op" id="4508083">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508088">m</span><span class="op" id="4508089">.</span><span class="ident" id="4508090">signatureAndHash</span><span class="op" id="4508106">.</span><span class="ident" id="4508107">signature</span>&nbsp;<span class="op" id="4508117">==</span>&nbsp;<span class="ident" id="4508120">m1</span><span class="op" id="4508122">.</span><span class="ident" id="4508123">signatureAndHash</span><span class="op" id="4508139">.</span><span class="ident" id="4508140">signature</span>&nbsp;<span class="op" id="4508150">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508155">bytes</span><span class="op" id="4508160">.</span><span class="ident" id="4508161">Equal</span><span class="op" id="4508166">(</span><span class="ident" id="4508167">m</span><span class="op" id="4508168">.</span><span class="ident" id="4508169">signature</span><span class="op" id="4508178">,</span>&nbsp;<span class="ident" id="4508180">m1</span><span class="op" id="4508182">.</span><span class="ident" id="4508183">signature</span><span class="op" id="4508192">)</span><br>
<span class="lineno"></span><span class="op" id="4508194">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4508197">func</span>&nbsp;<span class="op" id="4508202">(</span><span class="ident" id="4508203">m</span>&nbsp;<span class="op" id="4508205">*</span><span class="ident" id="4508206">certificateVerifyMsg</span><span class="op" id="4508226">)</span>&nbsp;<span class="ident" id="4508228">marshal</span><span class="op" id="4508235">(</span><span class="op" id="4508236">)</span>&nbsp;<span class="op" id="4508238">(</span><span class="ident" id="4508239">x</span>&nbsp;<span class="op" id="4508241">[</span><span class="op" id="4508242">]</span><span class="builtintype" id="4508243">byte</span><span class="op" id="4508247">)</span>&nbsp;<span class="op" id="4508249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508252">if</span>&nbsp;<span class="ident" id="4508255">m</span><span class="op" id="4508256">.</span><span class="ident" id="4508257">raw</span>&nbsp;<span class="op" id="4508261">!=</span>&nbsp;<span class="ident" id="4508264">nil</span>&nbsp;<span class="op" id="4508268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508272">return</span>&nbsp;<span class="ident" id="4508279">m</span><span class="op" id="4508280">.</span><span class="ident" id="4508281">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508286">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4508290">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508347">siglength</span>&nbsp;<span class="op" id="4508357">:=</span>&nbsp;<span class="builtinfunc" id="4508360">len</span><span class="op" id="4508363">(</span><span class="ident" id="4508364">m</span><span class="op" id="4508365">.</span><span class="ident" id="4508366">signature</span><span class="op" id="4508375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508378">length</span>&nbsp;<span class="op" id="4508385">:=</span>&nbsp;<span class="num" id="4508388">2</span>&nbsp;<span class="op" id="4508390">+</span>&nbsp;<span class="ident" id="4508392">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508403">if</span>&nbsp;<span class="ident" id="4508406">m</span><span class="op" id="4508407">.</span><span class="ident" id="4508408">hasSignatureAndHash</span>&nbsp;<span class="op" id="4508428">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508432">length</span>&nbsp;<span class="op" id="4508439">+=</span>&nbsp;<span class="num" id="4508442">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508448">x</span>&nbsp;<span class="op" id="4508450">=</span>&nbsp;<span class="builtinfunc" id="4508452">make</span><span class="op" id="4508456">(</span><span class="op" id="4508457">[</span><span class="op" id="4508458">]</span><span class="builtintype" id="4508459">byte</span><span class="op" id="4508463">,</span>&nbsp;<span class="num" id="4508465">4</span><span class="op" id="4508466">+</span><span class="ident" id="4508467">length</span><span class="op" id="4508473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508476">x</span><span class="op" id="4508477">[</span><span class="num" id="4508478">0</span><span class="op" id="4508479">]</span>&nbsp;<span class="op" id="4508481">=</span>&nbsp;<span class="ident" id="4508483">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508506">x</span><span class="op" id="4508507">[</span><span class="num" id="4508508">1</span><span class="op" id="4508509">]</span>&nbsp;<span class="op" id="4508511">=</span>&nbsp;<span class="builtintype" id="4508513">uint8</span><span class="op" id="4508518">(</span><span class="ident" id="4508519">length</span>&nbsp;<span class="op" id="4508526">&gt;&gt;</span>&nbsp;<span class="num" id="4508529">16</span><span class="op" id="4508531">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508534">x</span><span class="op" id="4508535">[</span><span class="num" id="4508536">2</span><span class="op" id="4508537">]</span>&nbsp;<span class="op" id="4508539">=</span>&nbsp;<span class="builtintype" id="4508541">uint8</span><span class="op" id="4508546">(</span><span class="ident" id="4508547">length</span>&nbsp;<span class="op" id="4508554">&gt;&gt;</span>&nbsp;<span class="num" id="4508557">8</span><span class="op" id="4508558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508561">x</span><span class="op" id="4508562">[</span><span class="num" id="4508563">3</span><span class="op" id="4508564">]</span>&nbsp;<span class="op" id="4508566">=</span>&nbsp;<span class="builtintype" id="4508568">uint8</span><span class="op" id="4508573">(</span><span class="ident" id="4508574">length</span><span class="op" id="4508580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508583">y</span>&nbsp;<span class="op" id="4508585">:=</span>&nbsp;<span class="ident" id="4508588">x</span><span class="op" id="4508589">[</span><span class="num" id="4508590">4</span><span class="op" id="4508591">:</span><span class="op" id="4508592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508595">if</span>&nbsp;<span class="ident" id="4508598">m</span><span class="op" id="4508599">.</span><span class="ident" id="4508600">hasSignatureAndHash</span>&nbsp;<span class="op" id="4508620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508624">y</span><span class="op" id="4508625">[</span><span class="num" id="4508626">0</span><span class="op" id="4508627">]</span>&nbsp;<span class="op" id="4508629">=</span>&nbsp;<span class="ident" id="4508631">m</span><span class="op" id="4508632">.</span><span class="ident" id="4508633">signatureAndHash</span><span class="op" id="4508649">.</span><span class="ident" id="4508650">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508657">y</span><span class="op" id="4508658">[</span><span class="num" id="4508659">1</span><span class="op" id="4508660">]</span>&nbsp;<span class="op" id="4508662">=</span>&nbsp;<span class="ident" id="4508664">m</span><span class="op" id="4508665">.</span><span class="ident" id="4508666">signatureAndHash</span><span class="op" id="4508682">.</span><span class="ident" id="4508683">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508695">y</span>&nbsp;<span class="op" id="4508697">=</span>&nbsp;<span class="ident" id="4508699">y</span><span class="op" id="4508700">[</span><span class="num" id="4508701">2</span><span class="op" id="4508702">:</span><span class="op" id="4508703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508709">y</span><span class="op" id="4508710">[</span><span class="num" id="4508711">0</span><span class="op" id="4508712">]</span>&nbsp;<span class="op" id="4508714">=</span>&nbsp;<span class="builtintype" id="4508716">uint8</span><span class="op" id="4508721">(</span><span class="ident" id="4508722">siglength</span>&nbsp;<span class="op" id="4508732">&gt;&gt;</span>&nbsp;<span class="num" id="4508735">8</span><span class="op" id="4508736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508739">y</span><span class="op" id="4508740">[</span><span class="num" id="4508741">1</span><span class="op" id="4508742">]</span>&nbsp;<span class="op" id="4508744">=</span>&nbsp;<span class="builtintype" id="4508746">uint8</span><span class="op" id="4508751">(</span><span class="ident" id="4508752">siglength</span><span class="op" id="4508761">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4508764">copy</span><span class="op" id="4508768">(</span><span class="ident" id="4508769">y</span><span class="op" id="4508770">[</span><span class="num" id="4508771">2</span><span class="op" id="4508772">:</span><span class="op" id="4508773">]</span><span class="op" id="4508774">,</span>&nbsp;<span class="ident" id="4508776">m</span><span class="op" id="4508777">.</span><span class="ident" id="4508778">signature</span><span class="op" id="4508787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508791">m</span><span class="op" id="4508792">.</span><span class="ident" id="4508793">raw</span>&nbsp;<span class="op" id="4508797">=</span>&nbsp;<span class="ident" id="4508799">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508803">return</span><br>
<span class="lineno">1285</span><span class="op" id="4508810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4508813">func</span>&nbsp;<span class="op" id="4508818">(</span><span class="ident" id="4508819">m</span>&nbsp;<span class="op" id="4508821">*</span><span class="ident" id="4508822">certificateVerifyMsg</span><span class="op" id="4508842">)</span>&nbsp;<span class="ident" id="4508844">unmarshal</span><span class="op" id="4508853">(</span><span class="ident" id="4508854">data</span>&nbsp;<span class="op" id="4508859">[</span><span class="op" id="4508860">]</span><span class="builtintype" id="4508861">byte</span><span class="op" id="4508865">)</span>&nbsp;<span class="builtintype" id="4508867">bool</span>&nbsp;<span class="op" id="4508872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508875">m</span><span class="op" id="4508876">.</span><span class="ident" id="4508877">raw</span>&nbsp;<span class="op" id="4508881">=</span>&nbsp;<span class="ident" id="4508883">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508890">if</span>&nbsp;<span class="builtinfunc" id="4508893">len</span><span class="op" id="4508896">(</span><span class="ident" id="4508897">data</span><span class="op" id="4508901">)</span>&nbsp;<span class="op" id="4508903">&lt;</span>&nbsp;<span class="num" id="4508905">6</span>&nbsp;<span class="op" id="4508907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508911">return</span>&nbsp;<span class="builtintype" id="4508918">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4508925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4508929">length</span>&nbsp;<span class="op" id="4508936">:=</span>&nbsp;<span class="builtintype" id="4508939">uint32</span><span class="op" id="4508945">(</span><span class="ident" id="4508946">data</span><span class="op" id="4508950">[</span><span class="num" id="4508951">1</span><span class="op" id="4508952">]</span><span class="op" id="4508953">)</span><span class="op" id="4508954">&lt;&lt;</span><span class="num" id="4508956">16</span>&nbsp;<span class="op" id="4508959">|</span>&nbsp;<span class="builtintype" id="4508961">uint32</span><span class="op" id="4508967">(</span><span class="ident" id="4508968">data</span><span class="op" id="4508972">[</span><span class="num" id="4508973">2</span><span class="op" id="4508974">]</span><span class="op" id="4508975">)</span><span class="op" id="4508976">&lt;&lt;</span><span class="num" id="4508978">8</span>&nbsp;<span class="op" id="4508980">|</span>&nbsp;<span class="builtintype" id="4508982">uint32</span><span class="op" id="4508988">(</span><span class="ident" id="4508989">data</span><span class="op" id="4508993">[</span><span class="num" id="4508994">3</span><span class="op" id="4508995">]</span><span class="op" id="4508996">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4508999">if</span>&nbsp;<span class="builtintype" id="4509002">uint32</span><span class="op" id="4509008">(</span><span class="builtinfunc" id="4509009">len</span><span class="op" id="4509012">(</span><span class="ident" id="4509013">data</span><span class="op" id="4509017">)</span><span class="op" id="4509018">)</span><span class="op" id="4509019">-</span><span class="num" id="4509020">4</span>&nbsp;<span class="op" id="4509022">!=</span>&nbsp;<span class="ident" id="4509025">length</span>&nbsp;<span class="op" id="4509032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509036">return</span>&nbsp;<span class="builtintype" id="4509043">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509054">data</span>&nbsp;<span class="op" id="4509059">=</span>&nbsp;<span class="ident" id="4509061">data</span><span class="op" id="4509065">[</span><span class="num" id="4509066">4</span><span class="op" id="4509067">:</span><span class="op" id="4509068">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509071">if</span>&nbsp;<span class="ident" id="4509074">m</span><span class="op" id="4509075">.</span><span class="ident" id="4509076">hasSignatureAndHash</span>&nbsp;<span class="op" id="4509096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509100">m</span><span class="op" id="4509101">.</span><span class="ident" id="4509102">signatureAndHash</span><span class="op" id="4509118">.</span><span class="ident" id="4509119">hash</span>&nbsp;<span class="op" id="4509124">=</span>&nbsp;<span class="ident" id="4509126">data</span><span class="op" id="4509130">[</span><span class="num" id="4509131">0</span><span class="op" id="4509132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509136">m</span><span class="op" id="4509137">.</span><span class="ident" id="4509138">signatureAndHash</span><span class="op" id="4509154">.</span><span class="ident" id="4509155">signature</span>&nbsp;<span class="op" id="4509165">=</span>&nbsp;<span class="ident" id="4509167">data</span><span class="op" id="4509171">[</span><span class="num" id="4509172">1</span><span class="op" id="4509173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509177">data</span>&nbsp;<span class="op" id="4509182">=</span>&nbsp;<span class="ident" id="4509184">data</span><span class="op" id="4509188">[</span><span class="num" id="4509189">2</span><span class="op" id="4509190">:</span><span class="op" id="4509191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509194">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509198">if</span>&nbsp;<span class="builtinfunc" id="4509201">len</span><span class="op" id="4509204">(</span><span class="ident" id="4509205">data</span><span class="op" id="4509209">)</span>&nbsp;<span class="op" id="4509211">&lt;</span>&nbsp;<span class="num" id="4509213">2</span>&nbsp;<span class="op" id="4509215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509219">return</span>&nbsp;<span class="builtintype" id="4509226">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509236">siglength</span>&nbsp;<span class="op" id="4509246">:=</span>&nbsp;<span class="builtintype" id="4509249">int</span><span class="op" id="4509252">(</span><span class="ident" id="4509253">data</span><span class="op" id="4509257">[</span><span class="num" id="4509258">0</span><span class="op" id="4509259">]</span><span class="op" id="4509260">)</span><span class="op" id="4509261">&lt;&lt;</span><span class="num" id="4509263">8</span>&nbsp;<span class="op" id="4509265">+</span>&nbsp;<span class="builtintype" id="4509267">int</span><span class="op" id="4509270">(</span><span class="ident" id="4509271">data</span><span class="op" id="4509275">[</span><span class="num" id="4509276">1</span><span class="op" id="4509277">]</span><span class="op" id="4509278">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509281">data</span>&nbsp;<span class="op" id="4509286">=</span>&nbsp;<span class="ident" id="4509288">data</span><span class="op" id="4509292">[</span><span class="num" id="4509293">2</span><span class="op" id="4509294">:</span><span class="op" id="4509295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509298">if</span>&nbsp;<span class="builtinfunc" id="4509301">len</span><span class="op" id="4509304">(</span><span class="ident" id="4509305">data</span><span class="op" id="4509309">)</span>&nbsp;<span class="op" id="4509311">!=</span>&nbsp;<span class="ident" id="4509314">siglength</span>&nbsp;<span class="op" id="4509324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509328">return</span>&nbsp;<span class="builtintype" id="4509335">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509346">m</span><span class="op" id="4509347">.</span><span class="ident" id="4509348">signature</span>&nbsp;<span class="op" id="4509358">=</span>&nbsp;<span class="ident" id="4509360">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509367">return</span>&nbsp;<span class="builtintype" id="4509374">true</span><br>
<span class="lineno"></span><span class="op" id="4509379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4509382">type</span>&nbsp;<span class="ident" id="4509387">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4509407">struct</span>&nbsp;<span class="op" id="4509414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509417">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509424">[</span><span class="op" id="4509425">]</span><span class="builtintype" id="4509426">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509432">ticket</span>&nbsp;<span class="op" id="4509439">[</span><span class="op" id="4509440">]</span><span class="builtintype" id="4509441">byte</span><br>
<span class="lineno"></span><span class="op" id="4509446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4509449">func</span>&nbsp;<span class="op" id="4509454">(</span><span class="ident" id="4509455">m</span>&nbsp;<span class="op" id="4509457">*</span><span class="ident" id="4509458">newSessionTicketMsg</span><span class="op" id="4509477">)</span>&nbsp;<span class="ident" id="4509479">equal</span><span class="op" id="4509484">(</span><span class="ident" id="4509485">i</span>&nbsp;<span class="keyword" id="4509487">interface</span><span class="op" id="4509496">{</span><span class="op" id="4509497">}</span><span class="op" id="4509498">)</span>&nbsp;<span class="builtintype" id="4509500">bool</span>&nbsp;<span class="op" id="4509505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509508">m1</span><span class="op" id="4509510">,</span>&nbsp;<span class="ident" id="4509512">ok</span>&nbsp;<span class="op" id="4509515">:=</span>&nbsp;<span class="ident" id="4509518">i</span><span class="op" id="4509519">.</span><span class="op" id="4509520">(</span><span class="op" id="4509521">*</span><span class="ident" id="4509522">newSessionTicketMsg</span><span class="op" id="4509541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509544">if</span>&nbsp;<span class="op" id="4509547">!</span><span class="ident" id="4509548">ok</span>&nbsp;<span class="op" id="4509551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509555">return</span>&nbsp;<span class="builtintype" id="4509562">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509569">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509573">return</span>&nbsp;<span class="ident" id="4509580">bytes</span><span class="op" id="4509585">.</span><span class="ident" id="4509586">Equal</span><span class="op" id="4509591">(</span><span class="ident" id="4509592">m</span><span class="op" id="4509593">.</span><span class="ident" id="4509594">raw</span><span class="op" id="4509597">,</span>&nbsp;<span class="ident" id="4509599">m1</span><span class="op" id="4509601">.</span><span class="ident" id="4509602">raw</span><span class="op" id="4509605">)</span>&nbsp;<span class="op" id="4509607">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509612">bytes</span><span class="op" id="4509617">.</span><span class="ident" id="4509618">Equal</span><span class="op" id="4509623">(</span><span class="ident" id="4509624">m</span><span class="op" id="4509625">.</span><span class="ident" id="4509626">ticket</span><span class="op" id="4509632">,</span>&nbsp;<span class="ident" id="4509634">m1</span><span class="op" id="4509636">.</span><span class="ident" id="4509637">ticket</span><span class="op" id="4509643">)</span><br>
<span class="lineno"></span><span class="op" id="4509645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4509648">func</span>&nbsp;<span class="op" id="4509653">(</span><span class="ident" id="4509654">m</span>&nbsp;<span class="op" id="4509656">*</span><span class="ident" id="4509657">newSessionTicketMsg</span><span class="op" id="4509676">)</span>&nbsp;<span class="ident" id="4509678">marshal</span><span class="op" id="4509685">(</span><span class="op" id="4509686">)</span>&nbsp;<span class="op" id="4509688">(</span><span class="ident" id="4509689">x</span>&nbsp;<span class="op" id="4509691">[</span><span class="op" id="4509692">]</span><span class="builtintype" id="4509693">byte</span><span class="op" id="4509697">)</span>&nbsp;<span class="op" id="4509699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509702">if</span>&nbsp;<span class="ident" id="4509705">m</span><span class="op" id="4509706">.</span><span class="ident" id="4509707">raw</span>&nbsp;<span class="op" id="4509711">!=</span>&nbsp;<span class="ident" id="4509714">nil</span>&nbsp;<span class="op" id="4509718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4509722">return</span>&nbsp;<span class="ident" id="4509729">m</span><span class="op" id="4509730">.</span><span class="ident" id="4509731">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4509736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4509740">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509795">ticketLen</span>&nbsp;<span class="op" id="4509805">:=</span>&nbsp;<span class="builtinfunc" id="4509808">len</span><span class="op" id="4509811">(</span><span class="ident" id="4509812">m</span><span class="op" id="4509813">.</span><span class="ident" id="4509814">ticket</span><span class="op" id="4509820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509823">length</span>&nbsp;<span class="op" id="4509830">:=</span>&nbsp;<span class="num" id="4509833">2</span>&nbsp;<span class="op" id="4509835">+</span>&nbsp;<span class="num" id="4509837">4</span>&nbsp;<span class="op" id="4509839">+</span>&nbsp;<span class="ident" id="4509841">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509852">x</span>&nbsp;<span class="op" id="4509854">=</span>&nbsp;<span class="builtinfunc" id="4509856">make</span><span class="op" id="4509860">(</span><span class="op" id="4509861">[</span><span class="op" id="4509862">]</span><span class="builtintype" id="4509863">byte</span><span class="op" id="4509867">,</span>&nbsp;<span class="num" id="4509869">4</span><span class="op" id="4509870">+</span><span class="ident" id="4509871">length</span><span class="op" id="4509877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509880">x</span><span class="op" id="4509881">[</span><span class="num" id="4509882">0</span><span class="op" id="4509883">]</span>&nbsp;<span class="op" id="4509885">=</span>&nbsp;<span class="ident" id="4509887">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509909">x</span><span class="op" id="4509910">[</span><span class="num" id="4509911">1</span><span class="op" id="4509912">]</span>&nbsp;<span class="op" id="4509914">=</span>&nbsp;<span class="builtintype" id="4509916">uint8</span><span class="op" id="4509921">(</span><span class="ident" id="4509922">length</span>&nbsp;<span class="op" id="4509929">&gt;&gt;</span>&nbsp;<span class="num" id="4509932">16</span><span class="op" id="4509934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509937">x</span><span class="op" id="4509938">[</span><span class="num" id="4509939">2</span><span class="op" id="4509940">]</span>&nbsp;<span class="op" id="4509942">=</span>&nbsp;<span class="builtintype" id="4509944">uint8</span><span class="op" id="4509949">(</span><span class="ident" id="4509950">length</span>&nbsp;<span class="op" id="4509957">&gt;&gt;</span>&nbsp;<span class="num" id="4509960">8</span><span class="op" id="4509961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509964">x</span><span class="op" id="4509965">[</span><span class="num" id="4509966">3</span><span class="op" id="4509967">]</span>&nbsp;<span class="op" id="4509969">=</span>&nbsp;<span class="builtintype" id="4509971">uint8</span><span class="op" id="4509976">(</span><span class="ident" id="4509977">length</span><span class="op" id="4509983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4509986">x</span><span class="op" id="4509987">[</span><span class="num" id="4509988">8</span><span class="op" id="4509989">]</span>&nbsp;<span class="op" id="4509991">=</span>&nbsp;<span class="builtintype" id="4509993">uint8</span><span class="op" id="4509998">(</span><span class="ident" id="4509999">ticketLen</span>&nbsp;<span class="op" id="4510009">&gt;&gt;</span>&nbsp;<span class="num" id="4510012">8</span><span class="op" id="4510013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510016">x</span><span class="op" id="4510017">[</span><span class="num" id="4510018">9</span><span class="op" id="4510019">]</span>&nbsp;<span class="op" id="4510021">=</span>&nbsp;<span class="builtintype" id="4510023">uint8</span><span class="op" id="4510028">(</span><span class="ident" id="4510029">ticketLen</span><span class="op" id="4510038">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4510041">copy</span><span class="op" id="4510045">(</span><span class="ident" id="4510046">x</span><span class="op" id="4510047">[</span><span class="num" id="4510048">10</span><span class="op" id="4510050">:</span><span class="op" id="4510051">]</span><span class="op" id="4510052">,</span>&nbsp;<span class="ident" id="4510054">m</span><span class="op" id="4510055">.</span><span class="ident" id="4510056">ticket</span><span class="op" id="4510062">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510066">m</span><span class="op" id="4510067">.</span><span class="ident" id="4510068">raw</span>&nbsp;<span class="op" id="4510072">=</span>&nbsp;<span class="ident" id="4510074">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510078">return</span><br>
<span class="lineno">1355</span><span class="op" id="4510085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4510088">func</span>&nbsp;<span class="op" id="4510093">(</span><span class="ident" id="4510094">m</span>&nbsp;<span class="op" id="4510096">*</span><span class="ident" id="4510097">newSessionTicketMsg</span><span class="op" id="4510116">)</span>&nbsp;<span class="ident" id="4510118">unmarshal</span><span class="op" id="4510127">(</span><span class="ident" id="4510128">data</span>&nbsp;<span class="op" id="4510133">[</span><span class="op" id="4510134">]</span><span class="builtintype" id="4510135">byte</span><span class="op" id="4510139">)</span>&nbsp;<span class="builtintype" id="4510141">bool</span>&nbsp;<span class="op" id="4510146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510149">m</span><span class="op" id="4510150">.</span><span class="ident" id="4510151">raw</span>&nbsp;<span class="op" id="4510155">=</span>&nbsp;<span class="ident" id="4510157">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510164">if</span>&nbsp;<span class="builtinfunc" id="4510167">len</span><span class="op" id="4510170">(</span><span class="ident" id="4510171">data</span><span class="op" id="4510175">)</span>&nbsp;<span class="op" id="4510177">&lt;</span>&nbsp;<span class="num" id="4510179">10</span>&nbsp;<span class="op" id="4510182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510186">return</span>&nbsp;<span class="builtintype" id="4510193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510204">length</span>&nbsp;<span class="op" id="4510211">:=</span>&nbsp;<span class="builtintype" id="4510214">uint32</span><span class="op" id="4510220">(</span><span class="ident" id="4510221">data</span><span class="op" id="4510225">[</span><span class="num" id="4510226">1</span><span class="op" id="4510227">]</span><span class="op" id="4510228">)</span><span class="op" id="4510229">&lt;&lt;</span><span class="num" id="4510231">16</span>&nbsp;<span class="op" id="4510234">|</span>&nbsp;<span class="builtintype" id="4510236">uint32</span><span class="op" id="4510242">(</span><span class="ident" id="4510243">data</span><span class="op" id="4510247">[</span><span class="num" id="4510248">2</span><span class="op" id="4510249">]</span><span class="op" id="4510250">)</span><span class="op" id="4510251">&lt;&lt;</span><span class="num" id="4510253">8</span>&nbsp;<span class="op" id="4510255">|</span>&nbsp;<span class="builtintype" id="4510257">uint32</span><span class="op" id="4510263">(</span><span class="ident" id="4510264">data</span><span class="op" id="4510268">[</span><span class="num" id="4510269">3</span><span class="op" id="4510270">]</span><span class="op" id="4510271">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510274">if</span>&nbsp;<span class="builtintype" id="4510277">uint32</span><span class="op" id="4510283">(</span><span class="builtinfunc" id="4510284">len</span><span class="op" id="4510287">(</span><span class="ident" id="4510288">data</span><span class="op" id="4510292">)</span><span class="op" id="4510293">)</span><span class="op" id="4510294">-</span><span class="num" id="4510295">4</span>&nbsp;<span class="op" id="4510297">!=</span>&nbsp;<span class="ident" id="4510300">length</span>&nbsp;<span class="op" id="4510307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510311">return</span>&nbsp;<span class="builtintype" id="4510318">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510329">ticketLen</span>&nbsp;<span class="op" id="4510339">:=</span>&nbsp;<span class="builtintype" id="4510342">int</span><span class="op" id="4510345">(</span><span class="ident" id="4510346">data</span><span class="op" id="4510350">[</span><span class="num" id="4510351">8</span><span class="op" id="4510352">]</span><span class="op" id="4510353">)</span><span class="op" id="4510354">&lt;&lt;</span><span class="num" id="4510356">8</span>&nbsp;<span class="op" id="4510358">+</span>&nbsp;<span class="builtintype" id="4510360">int</span><span class="op" id="4510363">(</span><span class="ident" id="4510364">data</span><span class="op" id="4510368">[</span><span class="num" id="4510369">9</span><span class="op" id="4510370">]</span><span class="op" id="4510371">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510374">if</span>&nbsp;<span class="builtinfunc" id="4510377">len</span><span class="op" id="4510380">(</span><span class="ident" id="4510381">data</span><span class="op" id="4510385">)</span><span class="op" id="4510386">-</span><span class="num" id="4510387">10</span>&nbsp;<span class="op" id="4510390">!=</span>&nbsp;<span class="ident" id="4510393">ticketLen</span>&nbsp;<span class="op" id="4510403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510407">return</span>&nbsp;<span class="builtintype" id="4510414">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4510425">m</span><span class="op" id="4510426">.</span><span class="ident" id="4510427">ticket</span>&nbsp;<span class="op" id="4510434">=</span>&nbsp;<span class="ident" id="4510436">data</span><span class="op" id="4510440">[</span><span class="num" id="4510441">10</span><span class="op" id="4510443">:</span><span class="op" id="4510444">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510448">return</span>&nbsp;<span class="builtintype" id="4510455">true</span><br>
<span class="lineno"></span><span class="op" id="4510460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4510463">func</span>&nbsp;<span class="ident" id="4510468">eqUint16s</span><span class="op" id="4510477">(</span><span class="ident" id="4510478">x</span><span class="op" id="4510479">,</span>&nbsp;<span class="ident" id="4510481">y</span>&nbsp;<span class="op" id="4510483">[</span><span class="op" id="4510484">]</span><span class="builtintype" id="4510485">uint16</span><span class="op" id="4510491">)</span>&nbsp;<span class="builtintype" id="4510493">bool</span>&nbsp;<span class="op" id="4510498">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510501">if</span>&nbsp;<span class="builtinfunc" id="4510504">len</span><span class="op" id="4510507">(</span><span class="ident" id="4510508">x</span><span class="op" id="4510509">)</span>&nbsp;<span class="op" id="4510511">!=</span>&nbsp;<span class="builtinfunc" id="4510514">len</span><span class="op" id="4510517">(</span><span class="ident" id="4510518">y</span><span class="op" id="4510519">)</span>&nbsp;<span class="op" id="4510521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510525">return</span>&nbsp;<span class="builtintype" id="4510532">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510542">for</span>&nbsp;<span class="ident" id="4510546">i</span><span class="op" id="4510547">,</span>&nbsp;<span class="ident" id="4510549">v</span>&nbsp;<span class="op" id="4510551">:=</span>&nbsp;<span class="keyword" id="4510554">range</span>&nbsp;<span class="ident" id="4510560">x</span>&nbsp;<span class="op" id="4510562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510566">if</span>&nbsp;<span class="ident" id="4510569">y</span><span class="op" id="4510570">[</span><span class="ident" id="4510571">i</span><span class="op" id="4510572">]</span>&nbsp;<span class="op" id="4510574">!=</span>&nbsp;<span class="ident" id="4510577">v</span>&nbsp;<span class="op" id="4510579">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510584">return</span>&nbsp;<span class="builtintype" id="4510591">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510605">return</span>&nbsp;<span class="builtintype" id="4510612">true</span><br>
<span class="lineno"></span><span class="op" id="4510617">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4510620">func</span>&nbsp;<span class="ident" id="4510625">eqCurveIDs</span><span class="op" id="4510635">(</span><span class="ident" id="4510636">x</span><span class="op" id="4510637">,</span>&nbsp;<span class="ident" id="4510639">y</span>&nbsp;<span class="op" id="4510641">[</span><span class="op" id="4510642">]</span><span class="ident" id="4510643">CurveID</span><span class="op" id="4510650">)</span>&nbsp;<span class="builtintype" id="4510652">bool</span>&nbsp;<span class="op" id="4510657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510660">if</span>&nbsp;<span class="builtinfunc" id="4510663">len</span><span class="op" id="4510666">(</span><span class="ident" id="4510667">x</span><span class="op" id="4510668">)</span>&nbsp;<span class="op" id="4510670">!=</span>&nbsp;<span class="builtinfunc" id="4510673">len</span><span class="op" id="4510676">(</span><span class="ident" id="4510677">y</span><span class="op" id="4510678">)</span>&nbsp;<span class="op" id="4510680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510684">return</span>&nbsp;<span class="builtintype" id="4510691">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510698">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510701">for</span>&nbsp;<span class="ident" id="4510705">i</span><span class="op" id="4510706">,</span>&nbsp;<span class="ident" id="4510708">v</span>&nbsp;<span class="op" id="4510710">:=</span>&nbsp;<span class="keyword" id="4510713">range</span>&nbsp;<span class="ident" id="4510719">x</span>&nbsp;<span class="op" id="4510721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510725">if</span>&nbsp;<span class="ident" id="4510728">y</span><span class="op" id="4510729">[</span><span class="ident" id="4510730">i</span><span class="op" id="4510731">]</span>&nbsp;<span class="op" id="4510733">!=</span>&nbsp;<span class="ident" id="4510736">v</span>&nbsp;<span class="op" id="4510738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510743">return</span>&nbsp;<span class="builtintype" id="4510750">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510761">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510764">return</span>&nbsp;<span class="builtintype" id="4510771">true</span><br>
<span class="lineno"></span><span class="op" id="4510776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4510779">func</span>&nbsp;<span class="ident" id="4510784">eqStrings</span><span class="op" id="4510793">(</span><span class="ident" id="4510794">x</span><span class="op" id="4510795">,</span>&nbsp;<span class="ident" id="4510797">y</span>&nbsp;<span class="op" id="4510799">[</span><span class="op" id="4510800">]</span><span class="builtintype" id="4510801">string</span><span class="op" id="4510807">)</span>&nbsp;<span class="builtintype" id="4510809">bool</span>&nbsp;<span class="op" id="4510814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510817">if</span>&nbsp;<span class="builtinfunc" id="4510820">len</span><span class="op" id="4510823">(</span><span class="ident" id="4510824">x</span><span class="op" id="4510825">)</span>&nbsp;<span class="op" id="4510827">!=</span>&nbsp;<span class="builtinfunc" id="4510830">len</span><span class="op" id="4510833">(</span><span class="ident" id="4510834">y</span><span class="op" id="4510835">)</span>&nbsp;<span class="op" id="4510837">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510841">return</span>&nbsp;<span class="builtintype" id="4510848">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510858">for</span>&nbsp;<span class="ident" id="4510862">i</span><span class="op" id="4510863">,</span>&nbsp;<span class="ident" id="4510865">v</span>&nbsp;<span class="op" id="4510867">:=</span>&nbsp;<span class="keyword" id="4510870">range</span>&nbsp;<span class="ident" id="4510876">x</span>&nbsp;<span class="op" id="4510878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510882">if</span>&nbsp;<span class="ident" id="4510885">y</span><span class="op" id="4510886">[</span><span class="ident" id="4510887">i</span><span class="op" id="4510888">]</span>&nbsp;<span class="op" id="4510890">!=</span>&nbsp;<span class="ident" id="4510893">v</span>&nbsp;<span class="op" id="4510895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510900">return</span>&nbsp;<span class="builtintype" id="4510907">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4510918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510921">return</span>&nbsp;<span class="builtintype" id="4510928">true</span><br>
<span class="lineno"></span><span class="op" id="4510933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4510936">func</span>&nbsp;<span class="ident" id="4510941">eqByteSlices</span><span class="op" id="4510953">(</span><span class="ident" id="4510954">x</span><span class="op" id="4510955">,</span>&nbsp;<span class="ident" id="4510957">y</span>&nbsp;<span class="op" id="4510959">[</span><span class="op" id="4510960">]</span><span class="op" id="4510961">[</span><span class="op" id="4510962">]</span><span class="builtintype" id="4510963">byte</span><span class="op" id="4510967">)</span>&nbsp;<span class="builtintype" id="4510969">bool</span>&nbsp;<span class="op" id="4510974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4510977">if</span>&nbsp;<span class="builtinfunc" id="4510980">len</span><span class="op" id="4510983">(</span><span class="ident" id="4510984">x</span><span class="op" id="4510985">)</span>&nbsp;<span class="op" id="4510987">!=</span>&nbsp;<span class="builtinfunc" id="4510990">len</span><span class="op" id="4510993">(</span><span class="ident" id="4510994">y</span><span class="op" id="4510995">)</span>&nbsp;<span class="op" id="4510997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511001">return</span>&nbsp;<span class="builtintype" id="4511008">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511018">for</span>&nbsp;<span class="ident" id="4511022">i</span><span class="op" id="4511023">,</span>&nbsp;<span class="ident" id="4511025">v</span>&nbsp;<span class="op" id="4511027">:=</span>&nbsp;<span class="keyword" id="4511030">range</span>&nbsp;<span class="ident" id="4511036">x</span>&nbsp;<span class="op" id="4511038">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511042">if</span>&nbsp;<span class="op" id="4511045">!</span><span class="ident" id="4511046">bytes</span><span class="op" id="4511051">.</span><span class="ident" id="4511052">Equal</span><span class="op" id="4511057">(</span><span class="ident" id="4511058">v</span><span class="op" id="4511059">,</span>&nbsp;<span class="ident" id="4511061">y</span><span class="op" id="4511062">[</span><span class="ident" id="4511063">i</span><span class="op" id="4511064">]</span><span class="op" id="4511065">)</span>&nbsp;<span class="op" id="4511067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511072">return</span>&nbsp;<span class="builtintype" id="4511079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511093">return</span>&nbsp;<span class="builtintype" id="4511100">true</span><br>
<span class="lineno">1425</span><span class="op" id="4511105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4511108">func</span>&nbsp;<span class="ident" id="4511113">eqSignatureAndHashes</span><span class="op" id="4511133">(</span><span class="ident" id="4511134">x</span><span class="op" id="4511135">,</span>&nbsp;<span class="ident" id="4511137">y</span>&nbsp;<span class="op" id="4511139">[</span><span class="op" id="4511140">]</span><span class="ident" id="4511141">signatureAndHash</span><span class="op" id="4511157">)</span>&nbsp;<span class="builtintype" id="4511159">bool</span>&nbsp;<span class="op" id="4511164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511167">if</span>&nbsp;<span class="builtinfunc" id="4511170">len</span><span class="op" id="4511173">(</span><span class="ident" id="4511174">x</span><span class="op" id="4511175">)</span>&nbsp;<span class="op" id="4511177">!=</span>&nbsp;<span class="builtinfunc" id="4511180">len</span><span class="op" id="4511183">(</span><span class="ident" id="4511184">y</span><span class="op" id="4511185">)</span>&nbsp;<span class="op" id="4511187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511191">return</span>&nbsp;<span class="builtintype" id="4511198">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511208">for</span>&nbsp;<span class="ident" id="4511212">i</span><span class="op" id="4511213">,</span>&nbsp;<span class="ident" id="4511215">v</span>&nbsp;<span class="op" id="4511217">:=</span>&nbsp;<span class="keyword" id="4511220">range</span>&nbsp;<span class="ident" id="4511226">x</span>&nbsp;<span class="op" id="4511228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4511232">v2</span>&nbsp;<span class="op" id="4511235">:=</span>&nbsp;<span class="ident" id="4511238">y</span><span class="op" id="4511239">[</span><span class="ident" id="4511240">i</span><span class="op" id="4511241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511245">if</span>&nbsp;<span class="ident" id="4511248">v</span><span class="op" id="4511249">.</span><span class="ident" id="4511250">hash</span>&nbsp;<span class="op" id="4511255">!=</span>&nbsp;<span class="ident" id="4511258">v2</span><span class="op" id="4511260">.</span><span class="ident" id="4511261">hash</span>&nbsp;<span class="op" id="4511266">||</span>&nbsp;<span class="ident" id="4511269">v</span><span class="op" id="4511270">.</span><span class="ident" id="4511271">signature</span>&nbsp;<span class="op" id="4511281">!=</span>&nbsp;<span class="ident" id="4511284">v2</span><span class="op" id="4511286">.</span><span class="ident" id="4511287">signature</span>&nbsp;<span class="op" id="4511297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511302">return</span>&nbsp;<span class="builtintype" id="4511309">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4511320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4511323">return</span>&nbsp;<span class="builtintype" id="4511330">true</span><br>
<span class="lineno"></span><span class="op" id="4511335">}</span>
</div>
</body>
</html>
