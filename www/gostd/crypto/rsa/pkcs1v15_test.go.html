<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8480429">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8480484">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8480538">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8480589">package</span>&nbsp;<span class="ident" id="8480597">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8480602">import</span>&nbsp;<span class="op" id="8480609">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480612">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480621">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480631">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480646">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480661">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480680">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480696">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480702">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480714">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8480725">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8480741">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8480744">func</span>&nbsp;<span class="ident" id="8480749">decodeBase64</span><span class="op" id="8480761">(</span><span class="ident" id="8480762">in</span>&nbsp;<span class="builtintype" id="8480765">string</span><span class="op" id="8480771">)</span>&nbsp;<span class="op" id="8480773">[</span><span class="op" id="8480774">]</span><span class="builtintype" id="8480775">byte</span>&nbsp;<span class="op" id="8480780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480783">out</span>&nbsp;<span class="op" id="8480787">:=</span>&nbsp;<span class="builtinfunc" id="8480790">make</span><span class="op" id="8480794">(</span><span class="op" id="8480795">[</span><span class="op" id="8480796">]</span><span class="builtintype" id="8480797">byte</span><span class="op" id="8480801">,</span>&nbsp;<span class="ident" id="8480803">base64</span><span class="op" id="8480809">.</span><span class="ident" id="8480810">StdEncoding</span><span class="op" id="8480821">.</span><span class="ident" id="8480822">DecodedLen</span><span class="op" id="8480832">(</span><span class="builtinfunc" id="8480833">len</span><span class="op" id="8480836">(</span><span class="ident" id="8480837">in</span><span class="op" id="8480839">)</span><span class="op" id="8480840">)</span><span class="op" id="8480841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480844">n</span><span class="op" id="8480845">,</span>&nbsp;<span class="ident" id="8480847">err</span>&nbsp;<span class="op" id="8480851">:=</span>&nbsp;<span class="ident" id="8480854">base64</span><span class="op" id="8480860">.</span><span class="ident" id="8480861">StdEncoding</span><span class="op" id="8480872">.</span><span class="ident" id="8480873">Decode</span><span class="op" id="8480879">(</span><span class="ident" id="8480880">out</span><span class="op" id="8480883">,</span>&nbsp;<span class="op" id="8480885">[</span><span class="op" id="8480886">]</span><span class="builtintype" id="8480887">byte</span><span class="op" id="8480891">(</span><span class="ident" id="8480892">in</span><span class="op" id="8480894">)</span><span class="op" id="8480895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480898">if</span>&nbsp;<span class="ident" id="8480901">err</span>&nbsp;<span class="op" id="8480905">!=</span>&nbsp;<span class="ident" id="8480908">nil</span>&nbsp;<span class="op" id="8480912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480916">return</span>&nbsp;<span class="ident" id="8480923">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480931">return</span>&nbsp;<span class="ident" id="8480938">out</span><span class="op" id="8480941">[</span><span class="num" id="8480942">0</span><span class="op" id="8480943">:</span><span class="ident" id="8480944">n</span><span class="op" id="8480945">]</span><br>
<span class="lineno"></span><span class="op" id="8480947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8480950">type</span>&nbsp;<span class="ident" id="8480955">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8480975">struct</span>&nbsp;<span class="op" id="8480982">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480985">in</span><span class="op" id="8480987">,</span>&nbsp;<span class="ident" id="8480989">out</span>&nbsp;<span class="builtintype" id="8480993">string</span><br>
<span class="lineno"></span><span class="op" id="8481000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8481003">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8481077">var</span>&nbsp;<span class="ident" id="8481081">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8481102">=</span>&nbsp;<span class="op" id="8481104">[</span><span class="op" id="8481105">]</span><span class="ident" id="8481106">DecryptPKCS1v15Test</span><span class="op" id="8481125">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481132">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8481222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481226">&#34;x&#34;</span><span class="op" id="8481229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481232">}</span><span class="op" id="8481233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481236">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481240">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8481330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481334">&#34;testing.&#34;</span><span class="op" id="8481344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481347">}</span><span class="op" id="8481348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481355">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8481445">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481449">&#34;testing.\n&#34;</span><span class="op" id="8481461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481464">}</span><span class="op" id="8481465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481472">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8481562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8481566">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8481621">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481624">}</span><span class="op" id="8481625">,</span><br>
<span class="lineno"></span><span class="op" id="8481627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8481630">func</span>&nbsp;<span class="ident" id="8481635">TestDecryptPKCS1v15</span><span class="op" id="8481654">(</span><span class="ident" id="8481655">t</span>&nbsp;<span class="op" id="8481657">*</span><span class="ident" id="8481658">testing</span><span class="op" id="8481665">.</span><span class="ident" id="8481666">T</span><span class="op" id="8481667">)</span>&nbsp;<span class="op" id="8481669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481672">for</span>&nbsp;<span class="ident" id="8481676">i</span><span class="op" id="8481677">,</span>&nbsp;<span class="ident" id="8481679">test</span>&nbsp;<span class="op" id="8481684">:=</span>&nbsp;<span class="keyword" id="8481687">range</span>&nbsp;<span class="ident" id="8481693">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8481714">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481718">out</span><span class="op" id="8481721">,</span>&nbsp;<span class="ident" id="8481723">err</span>&nbsp;<span class="op" id="8481727">:=</span>&nbsp;<span class="ident" id="8481730">DecryptPKCS1v15</span><span class="op" id="8481745">(</span><span class="ident" id="8481746">nil</span><span class="op" id="8481749">,</span>&nbsp;<span class="ident" id="8481751">rsaPrivateKey</span><span class="op" id="8481764">,</span>&nbsp;<span class="ident" id="8481766">decodeBase64</span><span class="op" id="8481778">(</span><span class="ident" id="8481779">test</span><span class="op" id="8481783">.</span><span class="ident" id="8481784">in</span><span class="op" id="8481786">)</span><span class="op" id="8481787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481791">if</span>&nbsp;<span class="ident" id="8481794">err</span>&nbsp;<span class="op" id="8481798">!=</span>&nbsp;<span class="ident" id="8481801">nil</span>&nbsp;<span class="op" id="8481805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481810">t</span><span class="op" id="8481811">.</span><span class="ident" id="8481812">Errorf</span><span class="op" id="8481818">(</span><span class="string" id="8481819">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8481841">,</span>&nbsp;<span class="ident" id="8481843">i</span><span class="op" id="8481844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481852">want</span>&nbsp;<span class="op" id="8481857">:=</span>&nbsp;<span class="op" id="8481860">[</span><span class="op" id="8481861">]</span><span class="builtintype" id="8481862">byte</span><span class="op" id="8481866">(</span><span class="ident" id="8481867">test</span><span class="op" id="8481871">.</span><span class="ident" id="8481872">out</span><span class="op" id="8481875">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481879">if</span>&nbsp;<span class="op" id="8481882">!</span><span class="ident" id="8481883">bytes</span><span class="op" id="8481888">.</span><span class="ident" id="8481889">Equal</span><span class="op" id="8481894">(</span><span class="ident" id="8481895">out</span><span class="op" id="8481898">,</span>&nbsp;<span class="ident" id="8481900">want</span><span class="op" id="8481904">)</span>&nbsp;<span class="op" id="8481906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481911">t</span><span class="op" id="8481912">.</span><span class="ident" id="8481913">Errorf</span><span class="op" id="8481919">(</span><span class="string" id="8481920">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8481942">,</span>&nbsp;<span class="ident" id="8481944">i</span><span class="op" id="8481945">,</span>&nbsp;<span class="ident" id="8481947">out</span><span class="op" id="8481950">,</span>&nbsp;<span class="ident" id="8481952">want</span><span class="op" id="8481956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481963">}</span><br>
<span class="lineno"></span><span class="op" id="8481965">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8481968">func</span>&nbsp;<span class="ident" id="8481973">TestEncryptPKCS1v15</span><span class="op" id="8481992">(</span><span class="ident" id="8481993">t</span>&nbsp;<span class="op" id="8481995">*</span><span class="ident" id="8481996">testing</span><span class="op" id="8482003">.</span><span class="ident" id="8482004">T</span><span class="op" id="8482005">)</span>&nbsp;<span class="op" id="8482007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482010">random</span>&nbsp;<span class="op" id="8482017">:=</span>&nbsp;<span class="ident" id="8482020">rand</span><span class="op" id="8482024">.</span><span class="ident" id="8482025">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482033">k</span>&nbsp;<span class="op" id="8482035">:=</span>&nbsp;<span class="op" id="8482038">(</span><span class="ident" id="8482039">rsaPrivateKey</span><span class="op" id="8482052">.</span><span class="ident" id="8482053">N</span><span class="op" id="8482054">.</span><span class="ident" id="8482055">BitLen</span><span class="op" id="8482061">(</span><span class="op" id="8482062">)</span>&nbsp;<span class="op" id="8482064">+</span>&nbsp;<span class="num" id="8482066">7</span><span class="op" id="8482067">)</span>&nbsp;<span class="op" id="8482069">/</span>&nbsp;<span class="num" id="8482071">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482075">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8482093">:=</span>&nbsp;<span class="keyword" id="8482096">func</span><span class="op" id="8482100">(</span><span class="ident" id="8482101">in</span>&nbsp;<span class="op" id="8482104">[</span><span class="op" id="8482105">]</span><span class="builtintype" id="8482106">byte</span><span class="op" id="8482110">,</span>&nbsp;<span class="ident" id="8482112">blind</span>&nbsp;<span class="builtintype" id="8482118">bool</span><span class="op" id="8482122">)</span>&nbsp;<span class="builtintype" id="8482124">bool</span>&nbsp;<span class="op" id="8482129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482133">if</span>&nbsp;<span class="builtinfunc" id="8482136">len</span><span class="op" id="8482139">(</span><span class="ident" id="8482140">in</span><span class="op" id="8482142">)</span>&nbsp;<span class="op" id="8482144">&gt;</span>&nbsp;<span class="ident" id="8482146">k</span><span class="op" id="8482147">-</span><span class="num" id="8482148">11</span>&nbsp;<span class="op" id="8482151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482156">in</span>&nbsp;<span class="op" id="8482159">=</span>&nbsp;<span class="ident" id="8482161">in</span><span class="op" id="8482163">[</span><span class="num" id="8482164">0</span>&nbsp;<span class="op" id="8482166">:</span>&nbsp;<span class="ident" id="8482168">k</span><span class="op" id="8482169">-</span><span class="num" id="8482170">11</span><span class="op" id="8482172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482181">ciphertext</span><span class="op" id="8482191">,</span>&nbsp;<span class="ident" id="8482193">err</span>&nbsp;<span class="op" id="8482197">:=</span>&nbsp;<span class="ident" id="8482200">EncryptPKCS1v15</span><span class="op" id="8482215">(</span><span class="ident" id="8482216">random</span><span class="op" id="8482222">,</span>&nbsp;<span class="op" id="8482224">&amp;</span><span class="ident" id="8482225">rsaPrivateKey</span><span class="op" id="8482238">.</span><span class="ident" id="8482239">PublicKey</span><span class="op" id="8482248">,</span>&nbsp;<span class="ident" id="8482250">in</span><span class="op" id="8482252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482256">if</span>&nbsp;<span class="ident" id="8482259">err</span>&nbsp;<span class="op" id="8482263">!=</span>&nbsp;<span class="ident" id="8482266">nil</span>&nbsp;<span class="op" id="8482270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482275">t</span><span class="op" id="8482276">.</span><span class="ident" id="8482277">Errorf</span><span class="op" id="8482283">(</span><span class="string" id="8482284">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8482306">,</span>&nbsp;<span class="ident" id="8482308">err</span><span class="op" id="8482311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482316">return</span>&nbsp;<span class="builtintype" id="8482323">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482331">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482336">var</span>&nbsp;<span class="ident" id="8482340">rand</span>&nbsp;<span class="ident" id="8482345">io</span><span class="op" id="8482347">.</span><span class="ident" id="8482348">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482357">if</span>&nbsp;<span class="op" id="8482360">!</span><span class="ident" id="8482361">blind</span>&nbsp;<span class="op" id="8482367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482372">rand</span>&nbsp;<span class="op" id="8482377">=</span>&nbsp;<span class="ident" id="8482379">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482385">}</span>&nbsp;<span class="keyword" id="8482387">else</span>&nbsp;<span class="op" id="8482392">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482397">rand</span>&nbsp;<span class="op" id="8482402">=</span>&nbsp;<span class="ident" id="8482404">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482417">plaintext</span><span class="op" id="8482426">,</span>&nbsp;<span class="ident" id="8482428">err</span>&nbsp;<span class="op" id="8482432">:=</span>&nbsp;<span class="ident" id="8482435">DecryptPKCS1v15</span><span class="op" id="8482450">(</span><span class="ident" id="8482451">rand</span><span class="op" id="8482455">,</span>&nbsp;<span class="ident" id="8482457">rsaPrivateKey</span><span class="op" id="8482470">,</span>&nbsp;<span class="ident" id="8482472">ciphertext</span><span class="op" id="8482482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482486">if</span>&nbsp;<span class="ident" id="8482489">err</span>&nbsp;<span class="op" id="8482493">!=</span>&nbsp;<span class="ident" id="8482496">nil</span>&nbsp;<span class="op" id="8482500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482505">t</span><span class="op" id="8482506">.</span><span class="ident" id="8482507">Errorf</span><span class="op" id="8482513">(</span><span class="string" id="8482514">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8482536">,</span>&nbsp;<span class="ident" id="8482538">err</span><span class="op" id="8482541">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482546">return</span>&nbsp;<span class="builtintype" id="8482553">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482566">if</span>&nbsp;<span class="op" id="8482569">!</span><span class="ident" id="8482570">bytes</span><span class="op" id="8482575">.</span><span class="ident" id="8482576">Equal</span><span class="op" id="8482581">(</span><span class="ident" id="8482582">plaintext</span><span class="op" id="8482591">,</span>&nbsp;<span class="ident" id="8482593">in</span><span class="op" id="8482595">)</span>&nbsp;<span class="op" id="8482597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482602">t</span><span class="op" id="8482603">.</span><span class="ident" id="8482604">Errorf</span><span class="op" id="8482610">(</span><span class="string" id="8482611">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8482637">,</span>&nbsp;<span class="ident" id="8482639">plaintext</span><span class="op" id="8482648">,</span>&nbsp;<span class="ident" id="8482650">in</span><span class="op" id="8482652">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482657">return</span>&nbsp;<span class="builtintype" id="8482664">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482676">return</span>&nbsp;<span class="builtintype" id="8482683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482693">config</span>&nbsp;<span class="op" id="8482700">:=</span>&nbsp;<span class="builtinfunc" id="8482703">new</span><span class="op" id="8482706">(</span><span class="ident" id="8482707">quick</span><span class="op" id="8482712">.</span><span class="ident" id="8482713">Config</span><span class="op" id="8482719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482722">if</span>&nbsp;<span class="ident" id="8482725">testing</span><span class="op" id="8482732">.</span><span class="ident" id="8482733">Short</span><span class="op" id="8482738">(</span><span class="op" id="8482739">)</span>&nbsp;<span class="op" id="8482741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482745">config</span><span class="op" id="8482751">.</span><span class="ident" id="8482752">MaxCount</span>&nbsp;<span class="op" id="8482761">=</span>&nbsp;<span class="num" id="8482763">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482770">quick</span><span class="op" id="8482775">.</span><span class="ident" id="8482776">Check</span><span class="op" id="8482781">(</span><span class="ident" id="8482782">tryEncryptDecrypt</span><span class="op" id="8482799">,</span>&nbsp;<span class="ident" id="8482801">config</span><span class="op" id="8482807">)</span><br>
<span class="lineno">105</span><span class="op" id="8482809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8482812">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8482886">var</span>&nbsp;<span class="ident" id="8482890">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8482921">=</span>&nbsp;<span class="op" id="8482923">[</span><span class="op" id="8482924">]</span><span class="ident" id="8482925">DecryptPKCS1v15Test</span><span class="op" id="8482944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482947">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8482951">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8483041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483045">&#34;1234&#34;</span><span class="op" id="8483051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483054">}</span><span class="op" id="8483055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483062">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8483152">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483156">&#34;FAIL&#34;</span><span class="op" id="8483162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483165">}</span><span class="op" id="8483166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483173">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8483263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483267">&#34;abcd&#34;</span><span class="op" id="8483273">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483276">}</span><span class="op" id="8483277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483284">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8483374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8483378">&#34;FAIL&#34;</span><span class="op" id="8483384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483387">}</span><span class="op" id="8483388">,</span><br>
<span class="lineno">125</span><span class="op" id="8483390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8483393">func</span>&nbsp;<span class="ident" id="8483398">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8483427">(</span><span class="ident" id="8483428">t</span>&nbsp;<span class="op" id="8483430">*</span><span class="ident" id="8483431">testing</span><span class="op" id="8483438">.</span><span class="ident" id="8483439">T</span><span class="op" id="8483440">)</span>&nbsp;<span class="op" id="8483442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483445">for</span>&nbsp;<span class="ident" id="8483449">i</span><span class="op" id="8483450">,</span>&nbsp;<span class="ident" id="8483452">test</span>&nbsp;<span class="op" id="8483457">:=</span>&nbsp;<span class="keyword" id="8483460">range</span>&nbsp;<span class="ident" id="8483466">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8483497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483501">key</span>&nbsp;<span class="op" id="8483505">:=</span>&nbsp;<span class="op" id="8483508">[</span><span class="op" id="8483509">]</span><span class="builtintype" id="8483510">byte</span><span class="op" id="8483514">(</span><span class="string" id="8483515">&#34;FAIL&#34;</span><span class="op" id="8483521">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483525">err</span>&nbsp;<span class="op" id="8483529">:=</span>&nbsp;<span class="ident" id="8483532">DecryptPKCS1v15SessionKey</span><span class="op" id="8483557">(</span><span class="ident" id="8483558">nil</span><span class="op" id="8483561">,</span>&nbsp;<span class="ident" id="8483563">rsaPrivateKey</span><span class="op" id="8483576">,</span>&nbsp;<span class="ident" id="8483578">decodeBase64</span><span class="op" id="8483590">(</span><span class="ident" id="8483591">test</span><span class="op" id="8483595">.</span><span class="ident" id="8483596">in</span><span class="op" id="8483598">)</span><span class="op" id="8483599">,</span>&nbsp;<span class="ident" id="8483601">key</span><span class="op" id="8483604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483608">if</span>&nbsp;<span class="ident" id="8483611">err</span>&nbsp;<span class="op" id="8483615">!=</span>&nbsp;<span class="ident" id="8483618">nil</span>&nbsp;<span class="op" id="8483622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483627">t</span><span class="op" id="8483628">.</span><span class="ident" id="8483629">Errorf</span><span class="op" id="8483635">(</span><span class="string" id="8483636">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8483658">,</span>&nbsp;<span class="ident" id="8483660">i</span><span class="op" id="8483661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483669">want</span>&nbsp;<span class="op" id="8483674">:=</span>&nbsp;<span class="op" id="8483677">[</span><span class="op" id="8483678">]</span><span class="builtintype" id="8483679">byte</span><span class="op" id="8483683">(</span><span class="ident" id="8483684">test</span><span class="op" id="8483688">.</span><span class="ident" id="8483689">out</span><span class="op" id="8483692">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483696">if</span>&nbsp;<span class="op" id="8483699">!</span><span class="ident" id="8483700">bytes</span><span class="op" id="8483705">.</span><span class="ident" id="8483706">Equal</span><span class="op" id="8483711">(</span><span class="ident" id="8483712">key</span><span class="op" id="8483715">,</span>&nbsp;<span class="ident" id="8483717">want</span><span class="op" id="8483721">)</span>&nbsp;<span class="op" id="8483723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483728">t</span><span class="op" id="8483729">.</span><span class="ident" id="8483730">Errorf</span><span class="op" id="8483736">(</span><span class="string" id="8483737">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8483759">,</span>&nbsp;<span class="ident" id="8483761">i</span><span class="op" id="8483762">,</span>&nbsp;<span class="ident" id="8483764">key</span><span class="op" id="8483767">,</span>&nbsp;<span class="ident" id="8483769">want</span><span class="op" id="8483773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483780">}</span><br>
<span class="lineno"></span><span class="op" id="8483782">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8483785">func</span>&nbsp;<span class="ident" id="8483790">TestNonZeroRandomBytes</span><span class="op" id="8483812">(</span><span class="ident" id="8483813">t</span>&nbsp;<span class="op" id="8483815">*</span><span class="ident" id="8483816">testing</span><span class="op" id="8483823">.</span><span class="ident" id="8483824">T</span><span class="op" id="8483825">)</span>&nbsp;<span class="op" id="8483827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483830">random</span>&nbsp;<span class="op" id="8483837">:=</span>&nbsp;<span class="ident" id="8483840">rand</span><span class="op" id="8483844">.</span><span class="ident" id="8483845">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483854">b</span>&nbsp;<span class="op" id="8483856">:=</span>&nbsp;<span class="builtinfunc" id="8483859">make</span><span class="op" id="8483863">(</span><span class="op" id="8483864">[</span><span class="op" id="8483865">]</span><span class="builtintype" id="8483866">byte</span><span class="op" id="8483870">,</span>&nbsp;<span class="num" id="8483872">512</span><span class="op" id="8483875">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483878">err</span>&nbsp;<span class="op" id="8483882">:=</span>&nbsp;<span class="ident" id="8483885">nonZeroRandomBytes</span><span class="op" id="8483903">(</span><span class="ident" id="8483904">b</span><span class="op" id="8483905">,</span>&nbsp;<span class="ident" id="8483907">random</span><span class="op" id="8483913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483916">if</span>&nbsp;<span class="ident" id="8483919">err</span>&nbsp;<span class="op" id="8483923">!=</span>&nbsp;<span class="ident" id="8483926">nil</span>&nbsp;<span class="op" id="8483930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483934">t</span><span class="op" id="8483935">.</span><span class="ident" id="8483936">Errorf</span><span class="op" id="8483942">(</span><span class="string" id="8483943">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8483963">,</span>&nbsp;<span class="ident" id="8483965">err</span><span class="op" id="8483968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483974">for</span>&nbsp;<span class="ident" id="8483978">_</span><span class="op" id="8483979">,</span>&nbsp;<span class="ident" id="8483981">b</span>&nbsp;<span class="op" id="8483983">:=</span>&nbsp;<span class="keyword" id="8483986">range</span>&nbsp;<span class="ident" id="8483992">b</span>&nbsp;<span class="op" id="8483994">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483998">if</span>&nbsp;<span class="ident" id="8484001">b</span>&nbsp;<span class="op" id="8484003">==</span>&nbsp;<span class="num" id="8484006">0</span>&nbsp;<span class="op" id="8484008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484013">t</span><span class="op" id="8484014">.</span><span class="ident" id="8484015">Errorf</span><span class="op" id="8484021">(</span><span class="string" id="8484022">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8484040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8484045">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484057">}</span><br>
<span class="lineno">155</span><span class="op" id="8484059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8484062">type</span>&nbsp;<span class="ident" id="8484067">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8484084">struct</span>&nbsp;<span class="op" id="8484091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484094">in</span><span class="op" id="8484096">,</span>&nbsp;<span class="ident" id="8484098">out</span>&nbsp;<span class="builtintype" id="8484102">string</span><br>
<span class="lineno"></span><span class="op" id="8484109">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8484112">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8484151">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8484218">var</span>&nbsp;<span class="ident" id="8484222">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8484240">=</span>&nbsp;<span class="op" id="8484242">[</span><span class="op" id="8484243">]</span><span class="ident" id="8484244">signPKCS1v15Test</span><span class="op" id="8484260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484263">{</span><span class="string" id="8484264">&#34;Test.\n&#34;</span><span class="op" id="8484273">,</span>&nbsp;<span class="string" id="8484275">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8484405">}</span><span class="op" id="8484406">,</span><br>
<span class="lineno">165</span><span class="op" id="8484408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8484411">func</span>&nbsp;<span class="ident" id="8484416">TestSignPKCS1v15</span><span class="op" id="8484432">(</span><span class="ident" id="8484433">t</span>&nbsp;<span class="op" id="8484435">*</span><span class="ident" id="8484436">testing</span><span class="op" id="8484443">.</span><span class="ident" id="8484444">T</span><span class="op" id="8484445">)</span>&nbsp;<span class="op" id="8484447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8484450">for</span>&nbsp;<span class="ident" id="8484454">i</span><span class="op" id="8484455">,</span>&nbsp;<span class="ident" id="8484457">test</span>&nbsp;<span class="op" id="8484462">:=</span>&nbsp;<span class="keyword" id="8484465">range</span>&nbsp;<span class="ident" id="8484471">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8484489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484493">h</span>&nbsp;<span class="op" id="8484495">:=</span>&nbsp;<span class="ident" id="8484498">sha1</span><span class="op" id="8484502">.</span><span class="ident" id="8484503">New</span><span class="op" id="8484506">(</span><span class="op" id="8484507">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484511">h</span><span class="op" id="8484512">.</span><span class="ident" id="8484513">Write</span><span class="op" id="8484518">(</span><span class="op" id="8484519">[</span><span class="op" id="8484520">]</span><span class="builtintype" id="8484521">byte</span><span class="op" id="8484525">(</span><span class="ident" id="8484526">test</span><span class="op" id="8484530">.</span><span class="ident" id="8484531">in</span><span class="op" id="8484533">)</span><span class="op" id="8484534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484538">digest</span>&nbsp;<span class="op" id="8484545">:=</span>&nbsp;<span class="ident" id="8484548">h</span><span class="op" id="8484549">.</span><span class="ident" id="8484550">Sum</span><span class="op" id="8484553">(</span><span class="ident" id="8484554">nil</span><span class="op" id="8484557">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484562">s</span><span class="op" id="8484563">,</span>&nbsp;<span class="ident" id="8484565">err</span>&nbsp;<span class="op" id="8484569">:=</span>&nbsp;<span class="ident" id="8484572">SignPKCS1v15</span><span class="op" id="8484584">(</span><span class="ident" id="8484585">nil</span><span class="op" id="8484588">,</span>&nbsp;<span class="ident" id="8484590">rsaPrivateKey</span><span class="op" id="8484603">,</span>&nbsp;<span class="ident" id="8484605">crypto</span><span class="op" id="8484611">.</span><span class="ident" id="8484612">SHA1</span><span class="op" id="8484616">,</span>&nbsp;<span class="ident" id="8484618">digest</span><span class="op" id="8484624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8484628">if</span>&nbsp;<span class="ident" id="8484631">err</span>&nbsp;<span class="op" id="8484635">!=</span>&nbsp;<span class="ident" id="8484638">nil</span>&nbsp;<span class="op" id="8484642">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484647">t</span><span class="op" id="8484648">.</span><span class="ident" id="8484649">Errorf</span><span class="op" id="8484655">(</span><span class="string" id="8484656">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8484664">,</span>&nbsp;<span class="ident" id="8484666">i</span><span class="op" id="8484667">,</span>&nbsp;<span class="ident" id="8484669">err</span><span class="op" id="8484672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484681">expected</span><span class="op" id="8484689">,</span>&nbsp;<span class="ident" id="8484691">_</span>&nbsp;<span class="op" id="8484693">:=</span>&nbsp;<span class="ident" id="8484696">hex</span><span class="op" id="8484699">.</span><span class="ident" id="8484700">DecodeString</span><span class="op" id="8484712">(</span><span class="ident" id="8484713">test</span><span class="op" id="8484717">.</span><span class="ident" id="8484718">out</span><span class="op" id="8484721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8484725">if</span>&nbsp;<span class="op" id="8484728">!</span><span class="ident" id="8484729">bytes</span><span class="op" id="8484734">.</span><span class="ident" id="8484735">Equal</span><span class="op" id="8484740">(</span><span class="ident" id="8484741">s</span><span class="op" id="8484742">,</span>&nbsp;<span class="ident" id="8484744">expected</span><span class="op" id="8484752">)</span>&nbsp;<span class="op" id="8484754">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484759">t</span><span class="op" id="8484760">.</span><span class="ident" id="8484761">Errorf</span><span class="op" id="8484767">(</span><span class="string" id="8484768">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8484790">,</span>&nbsp;<span class="ident" id="8484792">i</span><span class="op" id="8484793">,</span>&nbsp;<span class="ident" id="8484795">s</span><span class="op" id="8484796">,</span>&nbsp;<span class="ident" id="8484798">expected</span><span class="op" id="8484806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8484813">}</span><br>
<span class="lineno"></span><span class="op" id="8484815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8484818">func</span>&nbsp;<span class="ident" id="8484823">TestVerifyPKCS1v15</span><span class="op" id="8484841">(</span><span class="ident" id="8484842">t</span>&nbsp;<span class="op" id="8484844">*</span><span class="ident" id="8484845">testing</span><span class="op" id="8484852">.</span><span class="ident" id="8484853">T</span><span class="op" id="8484854">)</span>&nbsp;<span class="op" id="8484856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8484859">for</span>&nbsp;<span class="ident" id="8484863">i</span><span class="op" id="8484864">,</span>&nbsp;<span class="ident" id="8484866">test</span>&nbsp;<span class="op" id="8484871">:=</span>&nbsp;<span class="keyword" id="8484874">range</span>&nbsp;<span class="ident" id="8484880">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8484898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484902">h</span>&nbsp;<span class="op" id="8484904">:=</span>&nbsp;<span class="ident" id="8484907">sha1</span><span class="op" id="8484911">.</span><span class="ident" id="8484912">New</span><span class="op" id="8484915">(</span><span class="op" id="8484916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484920">h</span><span class="op" id="8484921">.</span><span class="ident" id="8484922">Write</span><span class="op" id="8484927">(</span><span class="op" id="8484928">[</span><span class="op" id="8484929">]</span><span class="builtintype" id="8484930">byte</span><span class="op" id="8484934">(</span><span class="ident" id="8484935">test</span><span class="op" id="8484939">.</span><span class="ident" id="8484940">in</span><span class="op" id="8484942">)</span><span class="op" id="8484943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484947">digest</span>&nbsp;<span class="op" id="8484954">:=</span>&nbsp;<span class="ident" id="8484957">h</span><span class="op" id="8484958">.</span><span class="ident" id="8484959">Sum</span><span class="op" id="8484962">(</span><span class="ident" id="8484963">nil</span><span class="op" id="8484966">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8484971">sig</span><span class="op" id="8484974">,</span>&nbsp;<span class="ident" id="8484976">_</span>&nbsp;<span class="op" id="8484978">:=</span>&nbsp;<span class="ident" id="8484981">hex</span><span class="op" id="8484984">.</span><span class="ident" id="8484985">DecodeString</span><span class="op" id="8484997">(</span><span class="ident" id="8484998">test</span><span class="op" id="8485002">.</span><span class="ident" id="8485003">out</span><span class="op" id="8485006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485011">err</span>&nbsp;<span class="op" id="8485015">:=</span>&nbsp;<span class="ident" id="8485018">VerifyPKCS1v15</span><span class="op" id="8485032">(</span><span class="op" id="8485033">&amp;</span><span class="ident" id="8485034">rsaPrivateKey</span><span class="op" id="8485047">.</span><span class="ident" id="8485048">PublicKey</span><span class="op" id="8485057">,</span>&nbsp;<span class="ident" id="8485059">crypto</span><span class="op" id="8485065">.</span><span class="ident" id="8485066">SHA1</span><span class="op" id="8485070">,</span>&nbsp;<span class="ident" id="8485072">digest</span><span class="op" id="8485078">,</span>&nbsp;<span class="ident" id="8485080">sig</span><span class="op" id="8485083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8485087">if</span>&nbsp;<span class="ident" id="8485090">err</span>&nbsp;<span class="op" id="8485094">!=</span>&nbsp;<span class="ident" id="8485097">nil</span>&nbsp;<span class="op" id="8485101">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485106">t</span><span class="op" id="8485107">.</span><span class="ident" id="8485108">Errorf</span><span class="op" id="8485114">(</span><span class="string" id="8485115">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8485123">,</span>&nbsp;<span class="ident" id="8485125">i</span><span class="op" id="8485126">,</span>&nbsp;<span class="ident" id="8485128">err</span><span class="op" id="8485131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485138">}</span><br>
<span class="lineno"></span><span class="op" id="8485140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8485143">func</span>&nbsp;<span class="ident" id="8485148">TestOverlongMessagePKCS1v15</span><span class="op" id="8485175">(</span><span class="ident" id="8485176">t</span>&nbsp;<span class="op" id="8485178">*</span><span class="ident" id="8485179">testing</span><span class="op" id="8485186">.</span><span class="ident" id="8485187">T</span><span class="op" id="8485188">)</span>&nbsp;<span class="op" id="8485190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485193">ciphertext</span>&nbsp;<span class="op" id="8485204">:=</span>&nbsp;<span class="ident" id="8485207">decodeBase64</span><span class="op" id="8485219">(</span><span class="string" id="8485220">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8485312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485315">_</span><span class="op" id="8485316">,</span>&nbsp;<span class="ident" id="8485318">err</span>&nbsp;<span class="op" id="8485322">:=</span>&nbsp;<span class="ident" id="8485325">DecryptPKCS1v15</span><span class="op" id="8485340">(</span><span class="ident" id="8485341">nil</span><span class="op" id="8485344">,</span>&nbsp;<span class="ident" id="8485346">rsaPrivateKey</span><span class="op" id="8485359">,</span>&nbsp;<span class="ident" id="8485361">ciphertext</span><span class="op" id="8485371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8485374">if</span>&nbsp;<span class="ident" id="8485377">err</span>&nbsp;<span class="op" id="8485381">==</span>&nbsp;<span class="ident" id="8485384">nil</span>&nbsp;<span class="op" id="8485388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485392">t</span><span class="op" id="8485393">.</span><span class="ident" id="8485394">Error</span><span class="op" id="8485399">(</span><span class="string" id="8485400">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8485444">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485447">}</span><br>
<span class="lineno"></span><span class="op" id="8485449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8485452">func</span>&nbsp;<span class="ident" id="8485457">TestUnpaddedSignature</span><span class="op" id="8485478">(</span><span class="ident" id="8485479">t</span>&nbsp;<span class="op" id="8485481">*</span><span class="ident" id="8485482">testing</span><span class="op" id="8485489">.</span><span class="ident" id="8485490">T</span><span class="op" id="8485491">)</span>&nbsp;<span class="op" id="8485493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485496">msg</span>&nbsp;<span class="op" id="8485500">:=</span>&nbsp;<span class="op" id="8485503">[</span><span class="op" id="8485504">]</span><span class="builtintype" id="8485505">byte</span><span class="op" id="8485509">(</span><span class="string" id="8485510">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8485542">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485545">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485587">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485638">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485703">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485707">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485780">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485790">expectedSig</span>&nbsp;<span class="op" id="8485802">:=</span>&nbsp;<span class="ident" id="8485805">decodeBase64</span><span class="op" id="8485817">(</span><span class="string" id="8485818">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8485908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485912">sig</span><span class="op" id="8485915">,</span>&nbsp;<span class="ident" id="8485917">err</span>&nbsp;<span class="op" id="8485921">:=</span>&nbsp;<span class="ident" id="8485924">SignPKCS1v15</span><span class="op" id="8485936">(</span><span class="ident" id="8485937">nil</span><span class="op" id="8485940">,</span>&nbsp;<span class="ident" id="8485942">rsaPrivateKey</span><span class="op" id="8485955">,</span>&nbsp;<span class="ident" id="8485957">crypto</span><span class="op" id="8485963">.</span><span class="ident" id="8485964">Hash</span><span class="op" id="8485968">(</span><span class="num" id="8485969">0</span><span class="op" id="8485970">)</span><span class="op" id="8485971">,</span>&nbsp;<span class="ident" id="8485973">msg</span><span class="op" id="8485976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8485979">if</span>&nbsp;<span class="ident" id="8485982">err</span>&nbsp;<span class="op" id="8485986">!=</span>&nbsp;<span class="ident" id="8485989">nil</span>&nbsp;<span class="op" id="8485993">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485997">t</span><span class="op" id="8485998">.</span><span class="ident" id="8485999">Fatalf</span><span class="op" id="8486005">(</span><span class="string" id="8486006">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8486031">,</span>&nbsp;<span class="ident" id="8486033">err</span><span class="op" id="8486036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486042">if</span>&nbsp;<span class="op" id="8486045">!</span><span class="ident" id="8486046">bytes</span><span class="op" id="8486051">.</span><span class="ident" id="8486052">Equal</span><span class="op" id="8486057">(</span><span class="ident" id="8486058">sig</span><span class="op" id="8486061">,</span>&nbsp;<span class="ident" id="8486063">expectedSig</span><span class="op" id="8486074">)</span>&nbsp;<span class="op" id="8486076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486080">t</span><span class="op" id="8486081">.</span><span class="ident" id="8486082">Fatalf</span><span class="op" id="8486088">(</span><span class="string" id="8486089">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8486139">,</span>&nbsp;<span class="ident" id="8486141">sig</span><span class="op" id="8486144">,</span>&nbsp;<span class="ident" id="8486146">expectedSig</span><span class="op" id="8486157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486160">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486163">if</span>&nbsp;<span class="ident" id="8486166">err</span>&nbsp;<span class="op" id="8486170">:=</span>&nbsp;<span class="ident" id="8486173">VerifyPKCS1v15</span><span class="op" id="8486187">(</span><span class="op" id="8486188">&amp;</span><span class="ident" id="8486189">rsaPrivateKey</span><span class="op" id="8486202">.</span><span class="ident" id="8486203">PublicKey</span><span class="op" id="8486212">,</span>&nbsp;<span class="ident" id="8486214">crypto</span><span class="op" id="8486220">.</span><span class="ident" id="8486221">Hash</span><span class="op" id="8486225">(</span><span class="num" id="8486226">0</span><span class="op" id="8486227">)</span><span class="op" id="8486228">,</span>&nbsp;<span class="ident" id="8486230">msg</span><span class="op" id="8486233">,</span>&nbsp;<span class="ident" id="8486235">sig</span><span class="op" id="8486238">)</span><span class="op" id="8486239">;</span>&nbsp;<span class="ident" id="8486241">err</span>&nbsp;<span class="op" id="8486245">!=</span>&nbsp;<span class="ident" id="8486248">nil</span>&nbsp;<span class="op" id="8486252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486256">t</span><span class="op" id="8486257">.</span><span class="ident" id="8486258">Fatalf</span><span class="op" id="8486264">(</span><span class="string" id="8486265">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8486297">,</span>&nbsp;<span class="ident" id="8486299">err</span><span class="op" id="8486302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486305">}</span><br>
<span class="lineno"></span><span class="op" id="8486307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8486310">func</span>&nbsp;<span class="ident" id="8486315">TestShortSessionKey</span><span class="op" id="8486334">(</span><span class="ident" id="8486335">t</span>&nbsp;<span class="op" id="8486337">*</span><span class="ident" id="8486338">testing</span><span class="op" id="8486345">.</span><span class="ident" id="8486346">T</span><span class="op" id="8486347">)</span>&nbsp;<span class="op" id="8486349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8486352">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8486418">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486484">ciphertext</span><span class="op" id="8486494">,</span>&nbsp;<span class="ident" id="8486496">err</span>&nbsp;<span class="op" id="8486500">:=</span>&nbsp;<span class="ident" id="8486503">EncryptPKCS1v15</span><span class="op" id="8486518">(</span><span class="ident" id="8486519">rand</span><span class="op" id="8486523">.</span><span class="ident" id="8486524">Reader</span><span class="op" id="8486530">,</span>&nbsp;<span class="op" id="8486532">&amp;</span><span class="ident" id="8486533">rsaPrivateKey</span><span class="op" id="8486546">.</span><span class="ident" id="8486547">PublicKey</span><span class="op" id="8486556">,</span>&nbsp;<span class="op" id="8486558">[</span><span class="op" id="8486559">]</span><span class="builtintype" id="8486560">byte</span><span class="op" id="8486564">{</span><span class="num" id="8486565">1</span><span class="op" id="8486566">}</span><span class="op" id="8486567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486570">if</span>&nbsp;<span class="ident" id="8486573">err</span>&nbsp;<span class="op" id="8486577">!=</span>&nbsp;<span class="ident" id="8486580">nil</span>&nbsp;<span class="op" id="8486584">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486588">t</span><span class="op" id="8486589">.</span><span class="ident" id="8486590">Fatalf</span><span class="op" id="8486596">(</span><span class="string" id="8486597">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8486634">,</span>&nbsp;<span class="ident" id="8486636">err</span><span class="op" id="8486639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486646">var</span>&nbsp;<span class="ident" id="8486650">key</span>&nbsp;<span class="op" id="8486654">[</span><span class="num" id="8486655">32</span><span class="op" id="8486657">]</span><span class="builtintype" id="8486658">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486664">if</span>&nbsp;<span class="ident" id="8486667">err</span>&nbsp;<span class="op" id="8486671">:=</span>&nbsp;<span class="ident" id="8486674">DecryptPKCS1v15SessionKey</span><span class="op" id="8486699">(</span><span class="ident" id="8486700">nil</span><span class="op" id="8486703">,</span>&nbsp;<span class="ident" id="8486705">rsaPrivateKey</span><span class="op" id="8486718">,</span>&nbsp;<span class="ident" id="8486720">ciphertext</span><span class="op" id="8486730">,</span>&nbsp;<span class="ident" id="8486732">key</span><span class="op" id="8486735">[</span><span class="op" id="8486736">:</span><span class="op" id="8486737">]</span><span class="op" id="8486738">)</span><span class="op" id="8486739">;</span>&nbsp;<span class="ident" id="8486741">err</span>&nbsp;<span class="op" id="8486745">!=</span>&nbsp;<span class="ident" id="8486748">nil</span>&nbsp;<span class="op" id="8486752">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486756">t</span><span class="op" id="8486757">.</span><span class="ident" id="8486758">Fatalf</span><span class="op" id="8486764">(</span><span class="string" id="8486765">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8486802">,</span>&nbsp;<span class="ident" id="8486804">err</span><span class="op" id="8486807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486814">for</span>&nbsp;<span class="ident" id="8486818">_</span><span class="op" id="8486819">,</span>&nbsp;<span class="ident" id="8486821">v</span>&nbsp;<span class="op" id="8486823">:=</span>&nbsp;<span class="keyword" id="8486826">range</span>&nbsp;<span class="ident" id="8486832">key</span>&nbsp;<span class="op" id="8486836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486840">if</span>&nbsp;<span class="ident" id="8486843">v</span>&nbsp;<span class="op" id="8486845">!=</span>&nbsp;<span class="num" id="8486848">0</span>&nbsp;<span class="op" id="8486850">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486855">t</span><span class="op" id="8486856">.</span><span class="ident" id="8486857">Fatal</span><span class="op" id="8486862">(</span><span class="string" id="8486863">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8486909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486916">}</span><br>
<span class="lineno"></span><span class="op" id="8486918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8486921">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8487000">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8487035">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8487103">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8487171">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8487239">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8487307">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8487375">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8487443">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8487487">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8487521">var</span>&nbsp;<span class="ident" id="8487525">rsaPrivateKey</span>&nbsp;<span class="op" id="8487539">=</span>&nbsp;<span class="op" id="8487541">&amp;</span><span class="ident" id="8487542">PrivateKey</span><span class="op" id="8487552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487555">PublicKey</span><span class="op" id="8487564">:</span>&nbsp;<span class="ident" id="8487566">PublicKey</span><span class="op" id="8487575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487579">N</span><span class="op" id="8487580">:</span>&nbsp;<span class="ident" id="8487582">fromBase10</span><span class="op" id="8487592">(</span><span class="string" id="8487593">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8487749">)</span><span class="op" id="8487750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487754">E</span><span class="op" id="8487755">:</span>&nbsp;<span class="num" id="8487757">65537</span><span class="op" id="8487762">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487765">}</span><span class="op" id="8487766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487769">D</span><span class="op" id="8487770">:</span>&nbsp;<span class="ident" id="8487772">fromBase10</span><span class="op" id="8487782">(</span><span class="string" id="8487783">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8487939">)</span><span class="op" id="8487940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487943">Primes</span><span class="op" id="8487949">:</span>&nbsp;<span class="op" id="8487951">[</span><span class="op" id="8487952">]</span><span class="op" id="8487953">*</span><span class="ident" id="8487954">big</span><span class="op" id="8487957">.</span><span class="ident" id="8487958">Int</span><span class="op" id="8487961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487965">fromBase10</span><span class="op" id="8487975">(</span><span class="string" id="8487976">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8488055">)</span><span class="op" id="8488056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488060">fromBase10</span><span class="op" id="8488070">(</span><span class="string" id="8488071">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8488150">)</span><span class="op" id="8488151">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488154">}</span><span class="op" id="8488155">,</span><br>
<span class="lineno"></span><span class="op" id="8488157">}</span>
</div>
</body>
</html>
