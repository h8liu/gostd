<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6050297">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6050353">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6050407">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6050458">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6050526">package</span>&nbsp;<span class="ident" id="6050534">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6050544">import</span>&nbsp;<span class="op" id="6050551">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6050554">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6050573">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6050583">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6050590">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6050596">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6050601">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6050604">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6050659">type</span>&nbsp;<span class="ident" id="6050664">FileHeader</span>&nbsp;<span class="keyword" id="6050675">struct</span>&nbsp;<span class="op" id="6050682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050685">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6050697">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050705">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6050717">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050725">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050737">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050745">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6050757">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050762">LoadAddress</span>&nbsp;<span class="ident" id="6050774">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050782">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050794">uint64</span><br>
<span class="lineno"></span><span class="op" id="6050801">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6050804">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6050852">type</span>&nbsp;<span class="ident" id="6050857">File</span>&nbsp;<span class="keyword" id="6050862">struct</span>&nbsp;<span class="op" id="6050869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050872">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050884">Sections</span>&nbsp;<span class="op" id="6050893">[</span><span class="op" id="6050894">]</span><span class="op" id="6050895">*</span><span class="ident" id="6050896">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050905">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6050914">io</span><span class="op" id="6050916">.</span><span class="ident" id="6050917">Closer</span><br>
<span class="lineno"></span><span class="op" id="6050924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6050927">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6050995">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6051057">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6051085">type</span>&nbsp;<span class="ident" id="6051090">SectionHeader</span>&nbsp;<span class="keyword" id="6051104">struct</span>&nbsp;<span class="op" id="6051111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051114">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6051121">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051129">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6051136">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051144">Offset</span>&nbsp;<span class="builtintype" id="6051151">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6051158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6051161">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6051226">type</span>&nbsp;<span class="ident" id="6051231">Section</span>&nbsp;<span class="keyword" id="6051239">struct</span>&nbsp;<span class="op" id="6051246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051249">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051265">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051303">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051343">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051378">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051426">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051476">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051500">io</span><span class="op" id="6051502">.</span><span class="ident" id="6051503">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051513">sr</span>&nbsp;<span class="op" id="6051516">*</span><span class="ident" id="6051517">io</span><span class="op" id="6051519">.</span><span class="ident" id="6051520">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6051534">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6051537">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6051605">func</span>&nbsp;<span class="op" id="6051610">(</span><span class="ident" id="6051611">s</span>&nbsp;<span class="op" id="6051613">*</span><span class="ident" id="6051614">Section</span><span class="op" id="6051621">)</span>&nbsp;<span class="ident" id="6051623">Data</span><span class="op" id="6051627">(</span><span class="op" id="6051628">)</span>&nbsp;<span class="op" id="6051630">(</span><span class="op" id="6051631">[</span><span class="op" id="6051632">]</span><span class="builtintype" id="6051633">byte</span><span class="op" id="6051637">,</span>&nbsp;<span class="builtintype" id="6051639">error</span><span class="op" id="6051644">)</span>&nbsp;<span class="op" id="6051646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051649">dat</span>&nbsp;<span class="op" id="6051653">:=</span>&nbsp;<span class="builtinfunc" id="6051656">make</span><span class="op" id="6051660">(</span><span class="op" id="6051661">[</span><span class="op" id="6051662">]</span><span class="builtintype" id="6051663">byte</span><span class="op" id="6051667">,</span>&nbsp;<span class="ident" id="6051669">s</span><span class="op" id="6051670">.</span><span class="ident" id="6051671">sr</span><span class="op" id="6051673">.</span><span class="ident" id="6051674">Size</span><span class="op" id="6051678">(</span><span class="op" id="6051679">)</span><span class="op" id="6051680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051683">n</span><span class="op" id="6051684">,</span>&nbsp;<span class="ident" id="6051686">err</span>&nbsp;<span class="op" id="6051690">:=</span>&nbsp;<span class="ident" id="6051693">s</span><span class="op" id="6051694">.</span><span class="ident" id="6051695">sr</span><span class="op" id="6051697">.</span><span class="ident" id="6051698">ReadAt</span><span class="op" id="6051704">(</span><span class="ident" id="6051705">dat</span><span class="op" id="6051708">,</span>&nbsp;<span class="num" id="6051710">0</span><span class="op" id="6051711">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051714">if</span>&nbsp;<span class="ident" id="6051717">n</span>&nbsp;<span class="op" id="6051719">==</span>&nbsp;<span class="builtinfunc" id="6051722">len</span><span class="op" id="6051725">(</span><span class="ident" id="6051726">dat</span><span class="op" id="6051729">)</span>&nbsp;<span class="op" id="6051731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051735">err</span>&nbsp;<span class="op" id="6051739">=</span>&nbsp;<span class="ident" id="6051741">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051749">return</span>&nbsp;<span class="ident" id="6051756">dat</span><span class="op" id="6051759">[</span><span class="num" id="6051760">0</span><span class="op" id="6051761">:</span><span class="ident" id="6051762">n</span><span class="op" id="6051763">]</span><span class="op" id="6051764">,</span>&nbsp;<span class="ident" id="6051766">err</span><br>
<span class="lineno"></span><span class="op" id="6051770">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6051773">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6051840">func</span>&nbsp;<span class="op" id="6051845">(</span><span class="ident" id="6051846">s</span>&nbsp;<span class="op" id="6051848">*</span><span class="ident" id="6051849">Section</span><span class="op" id="6051856">)</span>&nbsp;<span class="ident" id="6051858">Open</span><span class="op" id="6051862">(</span><span class="op" id="6051863">)</span>&nbsp;<span class="ident" id="6051865">io</span><span class="op" id="6051867">.</span><span class="ident" id="6051868">ReadSeeker</span>&nbsp;<span class="op" id="6051879">{</span>&nbsp;<span class="keyword" id="6051881">return</span>&nbsp;<span class="ident" id="6051888">io</span><span class="op" id="6051890">.</span><span class="ident" id="6051891">NewSectionReader</span><span class="op" id="6051907">(</span><span class="ident" id="6051908">s</span><span class="op" id="6051909">.</span><span class="ident" id="6051910">sr</span><span class="op" id="6051912">,</span>&nbsp;<span class="num" id="6051914">0</span><span class="op" id="6051915">,</span>&nbsp;<span class="num" id="6051917">1</span><span class="op" id="6051918">&lt;&lt;</span><span class="num" id="6051920">63</span><span class="op" id="6051922">-</span><span class="num" id="6051923">1</span><span class="op" id="6051924">)</span>&nbsp;<span class="op" id="6051926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6051929">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6052001">type</span>&nbsp;<span class="ident" id="6052006">Sym</span>&nbsp;<span class="keyword" id="6052010">struct</span>&nbsp;<span class="op" id="6052017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052020">Value</span>&nbsp;<span class="ident" id="6052026">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052034">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6052040">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052046">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6052052">string</span><br>
<span class="lineno"></span><span class="op" id="6052059">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6052062">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6052093">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6052156">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6052207">type</span>&nbsp;<span class="ident" id="6052212">formatError</span>&nbsp;<span class="keyword" id="6052224">struct</span>&nbsp;<span class="op" id="6052231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052234">off</span>&nbsp;<span class="builtintype" id="6052238">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052243">msg</span>&nbsp;<span class="builtintype" id="6052247">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052255">val</span>&nbsp;<span class="keyword" id="6052259">interface</span><span class="op" id="6052268">{</span><span class="op" id="6052269">}</span><br>
<span class="lineno"></span><span class="op" id="6052271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6052274">func</span>&nbsp;<span class="op" id="6052279">(</span><span class="ident" id="6052280">e</span>&nbsp;<span class="op" id="6052282">*</span><span class="ident" id="6052283">formatError</span><span class="op" id="6052294">)</span>&nbsp;<span class="ident" id="6052296">Error</span><span class="op" id="6052301">(</span><span class="op" id="6052302">)</span>&nbsp;<span class="builtintype" id="6052304">string</span>&nbsp;<span class="op" id="6052311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052314">msg</span>&nbsp;<span class="op" id="6052318">:=</span>&nbsp;<span class="ident" id="6052321">e</span><span class="op" id="6052322">.</span><span class="ident" id="6052323">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052328">if</span>&nbsp;<span class="ident" id="6052331">e</span><span class="op" id="6052332">.</span><span class="ident" id="6052333">val</span>&nbsp;<span class="op" id="6052337">!=</span>&nbsp;<span class="ident" id="6052340">nil</span>&nbsp;<span class="op" id="6052344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052348">msg</span>&nbsp;<span class="op" id="6052352">+=</span>&nbsp;<span class="ident" id="6052355">fmt</span><span class="op" id="6052358">.</span><span class="ident" id="6052359">Sprintf</span><span class="op" id="6052366">(</span><span class="string" id="6052367">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6052374">,</span>&nbsp;<span class="ident" id="6052376">e</span><span class="op" id="6052377">.</span><span class="ident" id="6052378">val</span><span class="op" id="6052381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052387">msg</span>&nbsp;<span class="op" id="6052391">+=</span>&nbsp;<span class="ident" id="6052394">fmt</span><span class="op" id="6052397">.</span><span class="ident" id="6052398">Sprintf</span><span class="op" id="6052405">(</span><span class="string" id="6052406">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6052430">,</span>&nbsp;<span class="ident" id="6052432">e</span><span class="op" id="6052433">.</span><span class="ident" id="6052434">off</span><span class="op" id="6052437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052440">return</span>&nbsp;<span class="ident" id="6052447">msg</span><br>
<span class="lineno">95</span><span class="op" id="6052451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6052454">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6052547">func</span>&nbsp;<span class="ident" id="6052552">Open</span><span class="op" id="6052556">(</span><span class="ident" id="6052557">name</span>&nbsp;<span class="builtintype" id="6052562">string</span><span class="op" id="6052568">)</span>&nbsp;<span class="op" id="6052570">(</span><span class="op" id="6052571">*</span><span class="ident" id="6052572">File</span><span class="op" id="6052576">,</span>&nbsp;<span class="builtintype" id="6052578">error</span><span class="op" id="6052583">)</span>&nbsp;<span class="op" id="6052585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052588">f</span><span class="op" id="6052589">,</span>&nbsp;<span class="ident" id="6052591">err</span>&nbsp;<span class="op" id="6052595">:=</span>&nbsp;<span class="ident" id="6052598">os</span><span class="op" id="6052600">.</span><span class="ident" id="6052601">Open</span><span class="op" id="6052605">(</span><span class="ident" id="6052606">name</span><span class="op" id="6052610">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052613">if</span>&nbsp;<span class="ident" id="6052616">err</span>&nbsp;<span class="op" id="6052620">!=</span>&nbsp;<span class="ident" id="6052623">nil</span>&nbsp;<span class="op" id="6052627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052631">return</span>&nbsp;<span class="ident" id="6052638">nil</span><span class="op" id="6052641">,</span>&nbsp;<span class="ident" id="6052643">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052651">ff</span><span class="op" id="6052653">,</span>&nbsp;<span class="ident" id="6052655">err</span>&nbsp;<span class="op" id="6052659">:=</span>&nbsp;<span class="ident" id="6052662">NewFile</span><span class="op" id="6052669">(</span><span class="ident" id="6052670">f</span><span class="op" id="6052671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052674">if</span>&nbsp;<span class="ident" id="6052677">err</span>&nbsp;<span class="op" id="6052681">!=</span>&nbsp;<span class="ident" id="6052684">nil</span>&nbsp;<span class="op" id="6052688">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052692">f</span><span class="op" id="6052693">.</span><span class="ident" id="6052694">Close</span><span class="op" id="6052699">(</span><span class="op" id="6052700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052704">return</span>&nbsp;<span class="ident" id="6052711">nil</span><span class="op" id="6052714">,</span>&nbsp;<span class="ident" id="6052716">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052724">ff</span><span class="op" id="6052726">.</span><span class="ident" id="6052727">closer</span>&nbsp;<span class="op" id="6052734">=</span>&nbsp;<span class="ident" id="6052736">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052739">return</span>&nbsp;<span class="ident" id="6052746">ff</span><span class="op" id="6052748">,</span>&nbsp;<span class="ident" id="6052750">nil</span><br>
<span class="lineno">110</span><span class="op" id="6052754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6052757">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6052783">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6052850">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6052874">func</span>&nbsp;<span class="op" id="6052879">(</span><span class="ident" id="6052880">f</span>&nbsp;<span class="op" id="6052882">*</span><span class="ident" id="6052883">File</span><span class="op" id="6052887">)</span>&nbsp;<span class="ident" id="6052889">Close</span><span class="op" id="6052894">(</span><span class="op" id="6052895">)</span>&nbsp;<span class="builtintype" id="6052897">error</span>&nbsp;<span class="op" id="6052903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052906">var</span>&nbsp;<span class="ident" id="6052910">err</span>&nbsp;<span class="builtintype" id="6052914">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052921">if</span>&nbsp;<span class="ident" id="6052924">f</span><span class="op" id="6052925">.</span><span class="ident" id="6052926">closer</span>&nbsp;<span class="op" id="6052933">!=</span>&nbsp;<span class="ident" id="6052936">nil</span>&nbsp;<span class="op" id="6052940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052944">err</span>&nbsp;<span class="op" id="6052948">=</span>&nbsp;<span class="ident" id="6052950">f</span><span class="op" id="6052951">.</span><span class="ident" id="6052952">closer</span><span class="op" id="6052958">.</span><span class="ident" id="6052959">Close</span><span class="op" id="6052964">(</span><span class="op" id="6052965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052969">f</span><span class="op" id="6052970">.</span><span class="ident" id="6052971">closer</span>&nbsp;<span class="op" id="6052978">=</span>&nbsp;<span class="ident" id="6052980">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052988">return</span>&nbsp;<span class="ident" id="6052995">err</span><br>
<span class="lineno"></span><span class="op" id="6052999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6053002">func</span>&nbsp;<span class="ident" id="6053007">parseMagic</span><span class="op" id="6053017">(</span><span class="ident" id="6053018">magic</span>&nbsp;<span class="op" id="6053024">[</span><span class="op" id="6053025">]</span><span class="builtintype" id="6053026">byte</span><span class="op" id="6053030">)</span>&nbsp;<span class="op" id="6053032">(</span><span class="builtintype" id="6053033">uint32</span><span class="op" id="6053039">,</span>&nbsp;<span class="builtintype" id="6053041">error</span><span class="op" id="6053046">)</span>&nbsp;<span class="op" id="6053048">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053051">m</span>&nbsp;<span class="op" id="6053053">:=</span>&nbsp;<span class="ident" id="6053056">binary</span><span class="op" id="6053062">.</span><span class="ident" id="6053063">BigEndian</span><span class="op" id="6053072">.</span><span class="ident" id="6053073">Uint32</span><span class="op" id="6053079">(</span><span class="ident" id="6053080">magic</span><span class="op" id="6053085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053088">switch</span>&nbsp;<span class="ident" id="6053095">m</span>&nbsp;<span class="op" id="6053097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053100">case</span>&nbsp;<span class="ident" id="6053105">Magic386</span><span class="op" id="6053113">,</span>&nbsp;<span class="ident" id="6053115">MagicAMD64</span><span class="op" id="6053125">,</span>&nbsp;<span class="ident" id="6053127">MagicARM</span><span class="op" id="6053135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053139">return</span>&nbsp;<span class="ident" id="6053146">m</span><span class="op" id="6053147">,</span>&nbsp;<span class="ident" id="6053149">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053154">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053157">return</span>&nbsp;<span class="num" id="6053164">0</span><span class="op" id="6053165">,</span>&nbsp;<span class="op" id="6053167">&amp;</span><span class="ident" id="6053168">formatError</span><span class="op" id="6053179">{</span><span class="num" id="6053180">0</span><span class="op" id="6053181">,</span>&nbsp;<span class="string" id="6053183">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6053201">,</span>&nbsp;<span class="ident" id="6053203">magic</span><span class="op" id="6053208">}</span><br>
<span class="lineno"></span><span class="op" id="6053210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6053213">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6053298">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6053371">func</span>&nbsp;<span class="ident" id="6053376">NewFile</span><span class="op" id="6053383">(</span><span class="ident" id="6053384">r</span>&nbsp;<span class="ident" id="6053386">io</span><span class="op" id="6053388">.</span><span class="ident" id="6053389">ReaderAt</span><span class="op" id="6053397">)</span>&nbsp;<span class="op" id="6053399">(</span><span class="op" id="6053400">*</span><span class="ident" id="6053401">File</span><span class="op" id="6053405">,</span>&nbsp;<span class="builtintype" id="6053407">error</span><span class="op" id="6053412">)</span>&nbsp;<span class="op" id="6053414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053417">sr</span>&nbsp;<span class="op" id="6053420">:=</span>&nbsp;<span class="ident" id="6053423">io</span><span class="op" id="6053425">.</span><span class="ident" id="6053426">NewSectionReader</span><span class="op" id="6053442">(</span><span class="ident" id="6053443">r</span><span class="op" id="6053444">,</span>&nbsp;<span class="num" id="6053446">0</span><span class="op" id="6053447">,</span>&nbsp;<span class="num" id="6053449">1</span><span class="op" id="6053450">&lt;&lt;</span><span class="num" id="6053452">63</span><span class="op" id="6053454">-</span><span class="num" id="6053455">1</span><span class="op" id="6053456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6053459">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053492">var</span>&nbsp;<span class="ident" id="6053496">magic</span>&nbsp;<span class="op" id="6053502">[</span><span class="num" id="6053503">4</span><span class="op" id="6053504">]</span><span class="builtintype" id="6053505">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053511">if</span>&nbsp;<span class="ident" id="6053514">_</span><span class="op" id="6053515">,</span>&nbsp;<span class="ident" id="6053517">err</span>&nbsp;<span class="op" id="6053521">:=</span>&nbsp;<span class="ident" id="6053524">r</span><span class="op" id="6053525">.</span><span class="ident" id="6053526">ReadAt</span><span class="op" id="6053532">(</span><span class="ident" id="6053533">magic</span><span class="op" id="6053538">[</span><span class="op" id="6053539">:</span><span class="op" id="6053540">]</span><span class="op" id="6053541">,</span>&nbsp;<span class="num" id="6053543">0</span><span class="op" id="6053544">)</span><span class="op" id="6053545">;</span>&nbsp;<span class="ident" id="6053547">err</span>&nbsp;<span class="op" id="6053551">!=</span>&nbsp;<span class="ident" id="6053554">nil</span>&nbsp;<span class="op" id="6053558">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053562">return</span>&nbsp;<span class="ident" id="6053569">nil</span><span class="op" id="6053572">,</span>&nbsp;<span class="ident" id="6053574">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053582">_</span><span class="op" id="6053583">,</span>&nbsp;<span class="ident" id="6053585">err</span>&nbsp;<span class="op" id="6053589">:=</span>&nbsp;<span class="ident" id="6053592">parseMagic</span><span class="op" id="6053602">(</span><span class="ident" id="6053603">magic</span><span class="op" id="6053608">[</span><span class="op" id="6053609">:</span><span class="op" id="6053610">]</span><span class="op" id="6053611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053614">if</span>&nbsp;<span class="ident" id="6053617">err</span>&nbsp;<span class="op" id="6053621">!=</span>&nbsp;<span class="ident" id="6053624">nil</span>&nbsp;<span class="op" id="6053628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053632">return</span>&nbsp;<span class="ident" id="6053639">nil</span><span class="op" id="6053642">,</span>&nbsp;<span class="ident" id="6053644">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053653">ph</span>&nbsp;<span class="op" id="6053656">:=</span>&nbsp;<span class="builtinfunc" id="6053659">new</span><span class="op" id="6053662">(</span><span class="ident" id="6053663">prog</span><span class="op" id="6053667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053670">if</span>&nbsp;<span class="ident" id="6053673">err</span>&nbsp;<span class="op" id="6053677">:=</span>&nbsp;<span class="ident" id="6053680">binary</span><span class="op" id="6053686">.</span><span class="ident" id="6053687">Read</span><span class="op" id="6053691">(</span><span class="ident" id="6053692">sr</span><span class="op" id="6053694">,</span>&nbsp;<span class="ident" id="6053696">binary</span><span class="op" id="6053702">.</span><span class="ident" id="6053703">BigEndian</span><span class="op" id="6053712">,</span>&nbsp;<span class="ident" id="6053714">ph</span><span class="op" id="6053716">)</span><span class="op" id="6053717">;</span>&nbsp;<span class="ident" id="6053719">err</span>&nbsp;<span class="op" id="6053723">!=</span>&nbsp;<span class="ident" id="6053726">nil</span>&nbsp;<span class="op" id="6053730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053734">return</span>&nbsp;<span class="ident" id="6053741">nil</span><span class="op" id="6053744">,</span>&nbsp;<span class="ident" id="6053746">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053755">f</span>&nbsp;<span class="op" id="6053757">:=</span>&nbsp;<span class="op" id="6053760">&amp;</span><span class="ident" id="6053761">File</span><span class="op" id="6053765">{</span><span class="ident" id="6053766">FileHeader</span><span class="op" id="6053776">:</span>&nbsp;<span class="ident" id="6053778">FileHeader</span><span class="op" id="6053788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053792">Magic</span><span class="op" id="6053797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6053805">ph</span><span class="op" id="6053807">.</span><span class="ident" id="6053808">Magic</span><span class="op" id="6053813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053817">Bss</span><span class="op" id="6053820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6053830">ph</span><span class="op" id="6053832">.</span><span class="ident" id="6053833">Bss</span><span class="op" id="6053836">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053840">Entry</span><span class="op" id="6053845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6053853">uint64</span><span class="op" id="6053859">(</span><span class="ident" id="6053860">ph</span><span class="op" id="6053862">.</span><span class="ident" id="6053863">Entry</span><span class="op" id="6053868">)</span><span class="op" id="6053869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053873">PtrSize</span><span class="op" id="6053880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6053886">4</span><span class="op" id="6053887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053891">LoadAddress</span><span class="op" id="6053902">:</span>&nbsp;<span class="num" id="6053904">0x1000</span><span class="op" id="6053910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053914">HdrSize</span><span class="op" id="6053921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6053927">4</span>&nbsp;<span class="op" id="6053929">*</span>&nbsp;<span class="num" id="6053931">8</span><span class="op" id="6053932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053935">}</span><span class="op" id="6053936">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053940">if</span>&nbsp;<span class="ident" id="6053943">ph</span><span class="op" id="6053945">.</span><span class="ident" id="6053946">Magic</span><span class="op" id="6053951">&amp;</span><span class="ident" id="6053952">Magic64</span>&nbsp;<span class="op" id="6053960">!=</span>&nbsp;<span class="num" id="6053963">0</span>&nbsp;<span class="op" id="6053965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053969">if</span>&nbsp;<span class="ident" id="6053972">err</span>&nbsp;<span class="op" id="6053976">:=</span>&nbsp;<span class="ident" id="6053979">binary</span><span class="op" id="6053985">.</span><span class="ident" id="6053986">Read</span><span class="op" id="6053990">(</span><span class="ident" id="6053991">sr</span><span class="op" id="6053993">,</span>&nbsp;<span class="ident" id="6053995">binary</span><span class="op" id="6054001">.</span><span class="ident" id="6054002">BigEndian</span><span class="op" id="6054011">,</span>&nbsp;<span class="op" id="6054013">&amp;</span><span class="ident" id="6054014">f</span><span class="op" id="6054015">.</span><span class="ident" id="6054016">Entry</span><span class="op" id="6054021">)</span><span class="op" id="6054022">;</span>&nbsp;<span class="ident" id="6054024">err</span>&nbsp;<span class="op" id="6054028">!=</span>&nbsp;<span class="ident" id="6054031">nil</span>&nbsp;<span class="op" id="6054035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054040">return</span>&nbsp;<span class="ident" id="6054047">nil</span><span class="op" id="6054050">,</span>&nbsp;<span class="ident" id="6054052">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054058">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054062">f</span><span class="op" id="6054063">.</span><span class="ident" id="6054064">PtrSize</span>&nbsp;<span class="op" id="6054072">=</span>&nbsp;<span class="num" id="6054074">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054078">f</span><span class="op" id="6054079">.</span><span class="ident" id="6054080">LoadAddress</span>&nbsp;<span class="op" id="6054092">=</span>&nbsp;<span class="num" id="6054094">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054105">f</span><span class="op" id="6054106">.</span><span class="ident" id="6054107">HdrSize</span>&nbsp;<span class="op" id="6054115">+=</span>&nbsp;<span class="num" id="6054118">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054125">var</span>&nbsp;<span class="ident" id="6054129">sects</span>&nbsp;<span class="op" id="6054135">=</span>&nbsp;<span class="op" id="6054137">[</span><span class="op" id="6054138">]</span><span class="keyword" id="6054139">struct</span>&nbsp;<span class="op" id="6054146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054150">name</span>&nbsp;<span class="builtintype" id="6054155">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054164">size</span>&nbsp;<span class="builtintype" id="6054169">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054177">}</span><span class="op" id="6054178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054182">{</span><span class="string" id="6054183">&#34;text&#34;</span><span class="op" id="6054189">,</span>&nbsp;<span class="ident" id="6054191">ph</span><span class="op" id="6054193">.</span><span class="ident" id="6054194">Text</span><span class="op" id="6054198">}</span><span class="op" id="6054199">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054203">{</span><span class="string" id="6054204">&#34;data&#34;</span><span class="op" id="6054210">,</span>&nbsp;<span class="ident" id="6054212">ph</span><span class="op" id="6054214">.</span><span class="ident" id="6054215">Data</span><span class="op" id="6054219">}</span><span class="op" id="6054220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054224">{</span><span class="string" id="6054225">&#34;syms&#34;</span><span class="op" id="6054231">,</span>&nbsp;<span class="ident" id="6054233">ph</span><span class="op" id="6054235">.</span><span class="ident" id="6054236">Syms</span><span class="op" id="6054240">}</span><span class="op" id="6054241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054245">{</span><span class="string" id="6054246">&#34;spsz&#34;</span><span class="op" id="6054252">,</span>&nbsp;<span class="ident" id="6054254">ph</span><span class="op" id="6054256">.</span><span class="ident" id="6054257">Spsz</span><span class="op" id="6054261">}</span><span class="op" id="6054262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054266">{</span><span class="string" id="6054267">&#34;pcsz&#34;</span><span class="op" id="6054273">,</span>&nbsp;<span class="ident" id="6054275">ph</span><span class="op" id="6054277">.</span><span class="ident" id="6054278">Pcsz</span><span class="op" id="6054282">}</span><span class="op" id="6054283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054286">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054290">f</span><span class="op" id="6054291">.</span><span class="ident" id="6054292">Sections</span>&nbsp;<span class="op" id="6054301">=</span>&nbsp;<span class="builtinfunc" id="6054303">make</span><span class="op" id="6054307">(</span><span class="op" id="6054308">[</span><span class="op" id="6054309">]</span><span class="op" id="6054310">*</span><span class="ident" id="6054311">Section</span><span class="op" id="6054318">,</span>&nbsp;<span class="num" id="6054320">5</span><span class="op" id="6054321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054325">off</span>&nbsp;<span class="op" id="6054329">:=</span>&nbsp;<span class="builtintype" id="6054332">uint32</span><span class="op" id="6054338">(</span><span class="ident" id="6054339">f</span><span class="op" id="6054340">.</span><span class="ident" id="6054341">HdrSize</span><span class="op" id="6054348">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054352">for</span>&nbsp;<span class="ident" id="6054356">i</span><span class="op" id="6054357">,</span>&nbsp;<span class="ident" id="6054359">sect</span>&nbsp;<span class="op" id="6054364">:=</span>&nbsp;<span class="keyword" id="6054367">range</span>&nbsp;<span class="ident" id="6054373">sects</span>&nbsp;<span class="op" id="6054379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054383">s</span>&nbsp;<span class="op" id="6054385">:=</span>&nbsp;<span class="builtinfunc" id="6054388">new</span><span class="op" id="6054391">(</span><span class="ident" id="6054392">Section</span><span class="op" id="6054399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054403">s</span><span class="op" id="6054404">.</span><span class="ident" id="6054405">SectionHeader</span>&nbsp;<span class="op" id="6054419">=</span>&nbsp;<span class="ident" id="6054421">SectionHeader</span><span class="op" id="6054434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054439">Name</span><span class="op" id="6054443">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6054447">sect</span><span class="op" id="6054451">.</span><span class="ident" id="6054452">name</span><span class="op" id="6054456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054461">Size</span><span class="op" id="6054465">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6054469">sect</span><span class="op" id="6054473">.</span><span class="ident" id="6054474">size</span><span class="op" id="6054478">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054483">Offset</span><span class="op" id="6054489">:</span>&nbsp;<span class="ident" id="6054491">off</span><span class="op" id="6054494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054502">off</span>&nbsp;<span class="op" id="6054506">+=</span>&nbsp;<span class="ident" id="6054509">sect</span><span class="op" id="6054513">.</span><span class="ident" id="6054514">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054521">s</span><span class="op" id="6054522">.</span><span class="ident" id="6054523">sr</span>&nbsp;<span class="op" id="6054526">=</span>&nbsp;<span class="ident" id="6054528">io</span><span class="op" id="6054530">.</span><span class="ident" id="6054531">NewSectionReader</span><span class="op" id="6054547">(</span><span class="ident" id="6054548">r</span><span class="op" id="6054549">,</span>&nbsp;<span class="ident" id="6054551">int64</span><span class="op" id="6054556">(</span><span class="ident" id="6054557">s</span><span class="op" id="6054558">.</span><span class="ident" id="6054559">Offset</span><span class="op" id="6054565">)</span><span class="op" id="6054566">,</span>&nbsp;<span class="ident" id="6054568">int64</span><span class="op" id="6054573">(</span><span class="ident" id="6054574">s</span><span class="op" id="6054575">.</span><span class="ident" id="6054576">Size</span><span class="op" id="6054580">)</span><span class="op" id="6054581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054585">s</span><span class="op" id="6054586">.</span><span class="ident" id="6054587">ReaderAt</span>&nbsp;<span class="op" id="6054596">=</span>&nbsp;<span class="ident" id="6054598">s</span><span class="op" id="6054599">.</span><span class="ident" id="6054600">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054605">f</span><span class="op" id="6054606">.</span><span class="ident" id="6054607">Sections</span><span class="op" id="6054615">[</span><span class="ident" id="6054616">i</span><span class="op" id="6054617">]</span>&nbsp;<span class="op" id="6054619">=</span>&nbsp;<span class="ident" id="6054621">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054628">return</span>&nbsp;<span class="ident" id="6054635">f</span><span class="op" id="6054636">,</span>&nbsp;<span class="ident" id="6054638">nil</span><br>
<span class="lineno"></span><span class="op" id="6054642">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6054645">func</span>&nbsp;<span class="ident" id="6054650">walksymtab</span><span class="op" id="6054660">(</span><span class="ident" id="6054661">data</span>&nbsp;<span class="op" id="6054666">[</span><span class="op" id="6054667">]</span><span class="builtintype" id="6054668">byte</span><span class="op" id="6054672">,</span>&nbsp;<span class="ident" id="6054674">ptrsz</span>&nbsp;<span class="builtintype" id="6054680">int</span><span class="op" id="6054683">,</span>&nbsp;<span class="ident" id="6054685">fn</span>&nbsp;<span class="keyword" id="6054688">func</span><span class="op" id="6054692">(</span><span class="ident" id="6054693">sym</span><span class="op" id="6054696">)</span>&nbsp;<span class="builtintype" id="6054698">error</span><span class="op" id="6054703">)</span>&nbsp;<span class="builtintype" id="6054705">error</span>&nbsp;<span class="op" id="6054711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054714">var</span>&nbsp;<span class="ident" id="6054718">order</span>&nbsp;<span class="ident" id="6054724">binary</span><span class="op" id="6054730">.</span><span class="ident" id="6054731">ByteOrder</span>&nbsp;<span class="op" id="6054741">=</span>&nbsp;<span class="ident" id="6054743">binary</span><span class="op" id="6054749">.</span><span class="ident" id="6054750">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054761">var</span>&nbsp;<span class="ident" id="6054765">s</span>&nbsp;<span class="ident" id="6054767">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054772">p</span>&nbsp;<span class="op" id="6054774">:=</span>&nbsp;<span class="ident" id="6054777">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054783">for</span>&nbsp;<span class="builtinfunc" id="6054787">len</span><span class="op" id="6054790">(</span><span class="ident" id="6054791">p</span><span class="op" id="6054792">)</span>&nbsp;<span class="op" id="6054794">&gt;=</span>&nbsp;<span class="num" id="6054797">4</span>&nbsp;<span class="op" id="6054799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6054803">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054828">if</span>&nbsp;<span class="builtinfunc" id="6054831">len</span><span class="op" id="6054834">(</span><span class="ident" id="6054835">p</span><span class="op" id="6054836">)</span>&nbsp;<span class="op" id="6054838">&lt;</span>&nbsp;<span class="ident" id="6054840">ptrsz</span>&nbsp;<span class="op" id="6054846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054851">return</span>&nbsp;<span class="op" id="6054858">&amp;</span><span class="ident" id="6054859">formatError</span><span class="op" id="6054870">{</span><span class="builtinfunc" id="6054871">len</span><span class="op" id="6054874">(</span><span class="ident" id="6054875">data</span><span class="op" id="6054879">)</span><span class="op" id="6054880">,</span>&nbsp;<span class="string" id="6054882">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6054898">,</span>&nbsp;<span class="ident" id="6054900">nil</span><span class="op" id="6054903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054907">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6054911">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054934">if</span>&nbsp;<span class="ident" id="6054937">ptrsz</span>&nbsp;<span class="op" id="6054943">==</span>&nbsp;<span class="num" id="6054946">8</span>&nbsp;<span class="op" id="6054948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054953">s</span><span class="op" id="6054954">.</span><span class="ident" id="6054955">value</span>&nbsp;<span class="op" id="6054961">=</span>&nbsp;<span class="ident" id="6054963">order</span><span class="op" id="6054968">.</span><span class="ident" id="6054969">Uint64</span><span class="op" id="6054975">(</span><span class="ident" id="6054976">p</span><span class="op" id="6054977">[</span><span class="num" id="6054978">0</span><span class="op" id="6054979">:</span><span class="num" id="6054980">8</span><span class="op" id="6054981">]</span><span class="op" id="6054982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054987">p</span>&nbsp;<span class="op" id="6054989">=</span>&nbsp;<span class="ident" id="6054991">p</span><span class="op" id="6054992">[</span><span class="num" id="6054993">8</span><span class="op" id="6054994">:</span><span class="op" id="6054995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054999">}</span>&nbsp;<span class="keyword" id="6055001">else</span>&nbsp;<span class="op" id="6055006">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055011">s</span><span class="op" id="6055012">.</span><span class="ident" id="6055013">value</span>&nbsp;<span class="op" id="6055019">=</span>&nbsp;<span class="ident" id="6055021">uint64</span><span class="op" id="6055027">(</span><span class="ident" id="6055028">order</span><span class="op" id="6055033">.</span><span class="ident" id="6055034">Uint32</span><span class="op" id="6055040">(</span><span class="ident" id="6055041">p</span><span class="op" id="6055042">[</span><span class="num" id="6055043">0</span><span class="op" id="6055044">:</span><span class="num" id="6055045">4</span><span class="op" id="6055046">]</span><span class="op" id="6055047">)</span><span class="op" id="6055048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055053">p</span>&nbsp;<span class="op" id="6055055">=</span>&nbsp;<span class="ident" id="6055057">p</span><span class="op" id="6055058">[</span><span class="num" id="6055059">4</span><span class="op" id="6055060">:</span><span class="op" id="6055061">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055070">var</span>&nbsp;<span class="ident" id="6055074">typ</span>&nbsp;<span class="builtintype" id="6055078">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055085">typ</span>&nbsp;<span class="op" id="6055089">=</span>&nbsp;<span class="ident" id="6055091">p</span><span class="op" id="6055092">[</span><span class="num" id="6055093">0</span><span class="op" id="6055094">]</span>&nbsp;<span class="op" id="6055096">&amp;</span>&nbsp;<span class="num" id="6055098">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055105">s</span><span class="op" id="6055106">.</span><span class="ident" id="6055107">typ</span>&nbsp;<span class="op" id="6055111">=</span>&nbsp;<span class="ident" id="6055113">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055119">p</span>&nbsp;<span class="op" id="6055121">=</span>&nbsp;<span class="ident" id="6055123">p</span><span class="op" id="6055124">[</span><span class="num" id="6055125">1</span><span class="op" id="6055126">:</span><span class="op" id="6055127">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6055132">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055143">var</span>&nbsp;<span class="ident" id="6055147">i</span>&nbsp;<span class="builtintype" id="6055149">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055155">var</span>&nbsp;<span class="ident" id="6055159">nnul</span>&nbsp;<span class="builtintype" id="6055164">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055170">for</span>&nbsp;<span class="ident" id="6055174">i</span>&nbsp;<span class="op" id="6055176">=</span>&nbsp;<span class="num" id="6055178">0</span><span class="op" id="6055179">;</span>&nbsp;<span class="ident" id="6055181">i</span>&nbsp;<span class="op" id="6055183">&lt;</span>&nbsp;<span class="builtinfunc" id="6055185">len</span><span class="op" id="6055188">(</span><span class="ident" id="6055189">p</span><span class="op" id="6055190">)</span><span class="op" id="6055191">;</span>&nbsp;<span class="ident" id="6055193">i</span><span class="op" id="6055194">++</span>&nbsp;<span class="op" id="6055197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055202">if</span>&nbsp;<span class="ident" id="6055205">p</span><span class="op" id="6055206">[</span><span class="ident" id="6055207">i</span><span class="op" id="6055208">]</span>&nbsp;<span class="op" id="6055210">==</span>&nbsp;<span class="num" id="6055213">0</span>&nbsp;<span class="op" id="6055215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055221">nnul</span>&nbsp;<span class="op" id="6055226">=</span>&nbsp;<span class="num" id="6055228">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055234">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055251">switch</span>&nbsp;<span class="ident" id="6055258">typ</span>&nbsp;<span class="op" id="6055262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055266">case</span>&nbsp;<span class="string" id="6055271">&#39;z&#39;</span><span class="op" id="6055274">,</span>&nbsp;<span class="string" id="6055276">&#39;Z&#39;</span><span class="op" id="6055279">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055284">p</span>&nbsp;<span class="op" id="6055286">=</span>&nbsp;<span class="ident" id="6055288">p</span><span class="op" id="6055289">[</span><span class="ident" id="6055290">i</span><span class="op" id="6055291">+</span><span class="ident" id="6055292">nnul</span><span class="op" id="6055296">:</span><span class="op" id="6055297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055302">for</span>&nbsp;<span class="ident" id="6055306">i</span>&nbsp;<span class="op" id="6055308">=</span>&nbsp;<span class="num" id="6055310">0</span><span class="op" id="6055311">;</span>&nbsp;<span class="ident" id="6055313">i</span><span class="op" id="6055314">+</span><span class="num" id="6055315">2</span>&nbsp;<span class="op" id="6055317">&lt;=</span>&nbsp;<span class="builtinfunc" id="6055320">len</span><span class="op" id="6055323">(</span><span class="ident" id="6055324">p</span><span class="op" id="6055325">)</span><span class="op" id="6055326">;</span>&nbsp;<span class="ident" id="6055328">i</span>&nbsp;<span class="op" id="6055330">+=</span>&nbsp;<span class="num" id="6055333">2</span>&nbsp;<span class="op" id="6055335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055341">if</span>&nbsp;<span class="ident" id="6055344">p</span><span class="op" id="6055345">[</span><span class="ident" id="6055346">i</span><span class="op" id="6055347">]</span>&nbsp;<span class="op" id="6055349">==</span>&nbsp;<span class="num" id="6055352">0</span>&nbsp;<span class="op" id="6055354">&amp;&amp;</span>&nbsp;<span class="ident" id="6055357">p</span><span class="op" id="6055358">[</span><span class="ident" id="6055359">i</span><span class="op" id="6055360">+</span><span class="num" id="6055361">1</span><span class="op" id="6055362">]</span>&nbsp;<span class="op" id="6055364">==</span>&nbsp;<span class="num" id="6055367">0</span>&nbsp;<span class="op" id="6055369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055376">nnul</span>&nbsp;<span class="op" id="6055381">=</span>&nbsp;<span class="num" id="6055383">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055390">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055413">if</span>&nbsp;<span class="builtinfunc" id="6055416">len</span><span class="op" id="6055419">(</span><span class="ident" id="6055420">p</span><span class="op" id="6055421">)</span>&nbsp;<span class="op" id="6055423">&lt;</span>&nbsp;<span class="ident" id="6055425">i</span><span class="op" id="6055426">+</span><span class="ident" id="6055427">nnul</span>&nbsp;<span class="op" id="6055432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055437">return</span>&nbsp;<span class="op" id="6055444">&amp;</span><span class="ident" id="6055445">formatError</span><span class="op" id="6055456">{</span><span class="builtinfunc" id="6055457">len</span><span class="op" id="6055460">(</span><span class="ident" id="6055461">data</span><span class="op" id="6055465">)</span><span class="op" id="6055466">,</span>&nbsp;<span class="string" id="6055468">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6055484">,</span>&nbsp;<span class="ident" id="6055486">nil</span><span class="op" id="6055489">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055497">s</span><span class="op" id="6055498">.</span><span class="ident" id="6055499">name</span>&nbsp;<span class="op" id="6055504">=</span>&nbsp;<span class="ident" id="6055506">p</span><span class="op" id="6055507">[</span><span class="num" id="6055508">0</span><span class="op" id="6055509">:</span><span class="ident" id="6055510">i</span><span class="op" id="6055511">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055515">i</span>&nbsp;<span class="op" id="6055517">+=</span>&nbsp;<span class="ident" id="6055520">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055527">p</span>&nbsp;<span class="op" id="6055529">=</span>&nbsp;<span class="ident" id="6055531">p</span><span class="op" id="6055532">[</span><span class="ident" id="6055533">i</span><span class="op" id="6055534">:</span><span class="op" id="6055535">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055540">fn</span><span class="op" id="6055542">(</span><span class="ident" id="6055543">s</span><span class="op" id="6055544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055550">return</span>&nbsp;<span class="ident" id="6055557">nil</span><br>
<span class="lineno"></span><span class="op" id="6055561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6055564">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6055613">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6055655">func</span>&nbsp;<span class="ident" id="6055660">newTable</span><span class="op" id="6055668">(</span><span class="ident" id="6055669">symtab</span>&nbsp;<span class="op" id="6055676">[</span><span class="op" id="6055677">]</span><span class="builtintype" id="6055678">byte</span><span class="op" id="6055682">,</span>&nbsp;<span class="ident" id="6055684">ptrsz</span>&nbsp;<span class="builtintype" id="6055690">int</span><span class="op" id="6055693">)</span>&nbsp;<span class="op" id="6055695">(</span><span class="op" id="6055696">[</span><span class="op" id="6055697">]</span><span class="ident" id="6055698">Sym</span><span class="op" id="6055701">,</span>&nbsp;<span class="builtintype" id="6055703">error</span><span class="op" id="6055708">)</span>&nbsp;<span class="op" id="6055710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055713">var</span>&nbsp;<span class="ident" id="6055717">n</span>&nbsp;<span class="builtintype" id="6055719">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055724">err</span>&nbsp;<span class="op" id="6055728">:=</span>&nbsp;<span class="ident" id="6055731">walksymtab</span><span class="op" id="6055741">(</span><span class="ident" id="6055742">symtab</span><span class="op" id="6055748">,</span>&nbsp;<span class="ident" id="6055750">ptrsz</span><span class="op" id="6055755">,</span>&nbsp;<span class="keyword" id="6055757">func</span><span class="op" id="6055761">(</span><span class="ident" id="6055762">s</span>&nbsp;<span class="ident" id="6055764">sym</span><span class="op" id="6055767">)</span>&nbsp;<span class="builtintype" id="6055769">error</span>&nbsp;<span class="op" id="6055775">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055779">n</span><span class="op" id="6055780">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055785">return</span>&nbsp;<span class="ident" id="6055792">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055797">}</span><span class="op" id="6055798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055801">if</span>&nbsp;<span class="ident" id="6055804">err</span>&nbsp;<span class="op" id="6055808">!=</span>&nbsp;<span class="ident" id="6055811">nil</span>&nbsp;<span class="op" id="6055815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055819">return</span>&nbsp;<span class="ident" id="6055826">nil</span><span class="op" id="6055829">,</span>&nbsp;<span class="ident" id="6055831">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055840">fname</span>&nbsp;<span class="op" id="6055846">:=</span>&nbsp;<span class="builtinfunc" id="6055849">make</span><span class="op" id="6055853">(</span><span class="keyword" id="6055854">map</span><span class="op" id="6055857">[</span><span class="builtintype" id="6055858">uint16</span><span class="op" id="6055864">]</span><span class="builtintype" id="6055865">string</span><span class="op" id="6055871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055874">syms</span>&nbsp;<span class="op" id="6055879">:=</span>&nbsp;<span class="builtinfunc" id="6055882">make</span><span class="op" id="6055886">(</span><span class="op" id="6055887">[</span><span class="op" id="6055888">]</span><span class="ident" id="6055889">Sym</span><span class="op" id="6055892">,</span>&nbsp;<span class="num" id="6055894">0</span><span class="op" id="6055895">,</span>&nbsp;<span class="ident" id="6055897">n</span><span class="op" id="6055898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055901">err</span>&nbsp;<span class="op" id="6055905">=</span>&nbsp;<span class="ident" id="6055907">walksymtab</span><span class="op" id="6055917">(</span><span class="ident" id="6055918">symtab</span><span class="op" id="6055924">,</span>&nbsp;<span class="ident" id="6055926">ptrsz</span><span class="op" id="6055931">,</span>&nbsp;<span class="keyword" id="6055933">func</span><span class="op" id="6055937">(</span><span class="ident" id="6055938">s</span>&nbsp;<span class="ident" id="6055940">sym</span><span class="op" id="6055943">)</span>&nbsp;<span class="builtintype" id="6055945">error</span>&nbsp;<span class="op" id="6055951">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055955">n</span>&nbsp;<span class="op" id="6055957">:=</span>&nbsp;<span class="builtinfunc" id="6055960">len</span><span class="op" id="6055963">(</span><span class="ident" id="6055964">syms</span><span class="op" id="6055968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055972">syms</span>&nbsp;<span class="op" id="6055977">=</span>&nbsp;<span class="ident" id="6055979">syms</span><span class="op" id="6055983">[</span><span class="num" id="6055984">0</span>&nbsp;<span class="op" id="6055986">:</span>&nbsp;<span class="ident" id="6055988">n</span><span class="op" id="6055989">+</span><span class="num" id="6055990">1</span><span class="op" id="6055991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055995">ts</span>&nbsp;<span class="op" id="6055998">:=</span>&nbsp;<span class="op" id="6056001">&amp;</span><span class="ident" id="6056002">syms</span><span class="op" id="6056006">[</span><span class="ident" id="6056007">n</span><span class="op" id="6056008">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056012">ts</span><span class="op" id="6056014">.</span><span class="ident" id="6056015">Type</span>&nbsp;<span class="op" id="6056020">=</span>&nbsp;<span class="builtintype" id="6056022">rune</span><span class="op" id="6056026">(</span><span class="ident" id="6056027">s</span><span class="op" id="6056028">.</span><span class="ident" id="6056029">typ</span><span class="op" id="6056032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056036">ts</span><span class="op" id="6056038">.</span><span class="ident" id="6056039">Value</span>&nbsp;<span class="op" id="6056045">=</span>&nbsp;<span class="ident" id="6056047">s</span><span class="op" id="6056048">.</span><span class="ident" id="6056049">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056057">switch</span>&nbsp;<span class="ident" id="6056064">s</span><span class="op" id="6056065">.</span><span class="ident" id="6056066">typ</span>&nbsp;<span class="op" id="6056070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056074">default</span><span class="op" id="6056081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056086">ts</span><span class="op" id="6056088">.</span><span class="ident" id="6056089">Name</span>&nbsp;<span class="op" id="6056094">=</span>&nbsp;<span class="builtintype" id="6056096">string</span><span class="op" id="6056102">(</span><span class="ident" id="6056103">s</span><span class="op" id="6056104">.</span><span class="ident" id="6056105">name</span><span class="op" id="6056109">[</span><span class="op" id="6056110">:</span><span class="op" id="6056111">]</span><span class="op" id="6056112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056116">case</span>&nbsp;<span class="string" id="6056121">&#39;z&#39;</span><span class="op" id="6056124">,</span>&nbsp;<span class="string" id="6056126">&#39;Z&#39;</span><span class="op" id="6056129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056134">for</span>&nbsp;<span class="ident" id="6056138">i</span>&nbsp;<span class="op" id="6056140">:=</span>&nbsp;<span class="num" id="6056143">0</span><span class="op" id="6056144">;</span>&nbsp;<span class="ident" id="6056146">i</span>&nbsp;<span class="op" id="6056148">&lt;</span>&nbsp;<span class="builtinfunc" id="6056150">len</span><span class="op" id="6056153">(</span><span class="ident" id="6056154">s</span><span class="op" id="6056155">.</span><span class="ident" id="6056156">name</span><span class="op" id="6056160">)</span><span class="op" id="6056161">;</span>&nbsp;<span class="ident" id="6056163">i</span>&nbsp;<span class="op" id="6056165">+=</span>&nbsp;<span class="num" id="6056168">2</span>&nbsp;<span class="op" id="6056170">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056176">eltIdx</span>&nbsp;<span class="op" id="6056183">:=</span>&nbsp;<span class="ident" id="6056186">binary</span><span class="op" id="6056192">.</span><span class="ident" id="6056193">BigEndian</span><span class="op" id="6056202">.</span><span class="ident" id="6056203">Uint16</span><span class="op" id="6056209">(</span><span class="ident" id="6056210">s</span><span class="op" id="6056211">.</span><span class="ident" id="6056212">name</span><span class="op" id="6056216">[</span><span class="ident" id="6056217">i</span>&nbsp;<span class="op" id="6056219">:</span>&nbsp;<span class="ident" id="6056221">i</span><span class="op" id="6056222">+</span><span class="num" id="6056223">2</span><span class="op" id="6056224">]</span><span class="op" id="6056225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056231">elt</span><span class="op" id="6056234">,</span>&nbsp;<span class="ident" id="6056236">ok</span>&nbsp;<span class="op" id="6056239">:=</span>&nbsp;<span class="ident" id="6056242">fname</span><span class="op" id="6056247">[</span><span class="ident" id="6056248">eltIdx</span><span class="op" id="6056254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056260">if</span>&nbsp;<span class="op" id="6056263">!</span><span class="ident" id="6056264">ok</span>&nbsp;<span class="op" id="6056267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056274">return</span>&nbsp;<span class="op" id="6056281">&amp;</span><span class="ident" id="6056282">formatError</span><span class="op" id="6056293">{</span><span class="op" id="6056294">-</span><span class="num" id="6056295">1</span><span class="op" id="6056296">,</span>&nbsp;<span class="string" id="6056298">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6056317">,</span>&nbsp;<span class="ident" id="6056319">eltIdx</span><span class="op" id="6056325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056331">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056337">if</span>&nbsp;<span class="ident" id="6056340">n</span>&nbsp;<span class="op" id="6056342">:=</span>&nbsp;<span class="builtinfunc" id="6056345">len</span><span class="op" id="6056348">(</span><span class="ident" id="6056349">ts</span><span class="op" id="6056351">.</span><span class="ident" id="6056352">Name</span><span class="op" id="6056356">)</span><span class="op" id="6056357">;</span>&nbsp;<span class="ident" id="6056359">n</span>&nbsp;<span class="op" id="6056361">&gt;</span>&nbsp;<span class="num" id="6056363">0</span>&nbsp;<span class="op" id="6056365">&amp;&amp;</span>&nbsp;<span class="ident" id="6056368">ts</span><span class="op" id="6056370">.</span><span class="ident" id="6056371">Name</span><span class="op" id="6056375">[</span><span class="ident" id="6056376">n</span><span class="op" id="6056377">-</span><span class="num" id="6056378">1</span><span class="op" id="6056379">]</span>&nbsp;<span class="op" id="6056381">!=</span>&nbsp;<span class="string" id="6056384">&#39;/&#39;</span>&nbsp;<span class="op" id="6056388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056395">ts</span><span class="op" id="6056397">.</span><span class="ident" id="6056398">Name</span>&nbsp;<span class="op" id="6056403">+=</span>&nbsp;<span class="string" id="6056406">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056420">ts</span><span class="op" id="6056422">.</span><span class="ident" id="6056423">Name</span>&nbsp;<span class="op" id="6056428">+=</span>&nbsp;<span class="ident" id="6056431">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056438">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056446">switch</span>&nbsp;<span class="ident" id="6056453">s</span><span class="op" id="6056454">.</span><span class="ident" id="6056455">typ</span>&nbsp;<span class="op" id="6056459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056463">case</span>&nbsp;<span class="string" id="6056468">&#39;f&#39;</span><span class="op" id="6056471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056476">fname</span><span class="op" id="6056481">[</span><span class="builtintype" id="6056482">uint16</span><span class="op" id="6056488">(</span><span class="ident" id="6056489">s</span><span class="op" id="6056490">.</span><span class="ident" id="6056491">value</span><span class="op" id="6056496">)</span><span class="op" id="6056497">]</span>&nbsp;<span class="op" id="6056499">=</span>&nbsp;<span class="ident" id="6056501">ts</span><span class="op" id="6056503">.</span><span class="ident" id="6056504">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056511">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056515">return</span>&nbsp;<span class="ident" id="6056522">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056527">}</span><span class="op" id="6056528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056531">if</span>&nbsp;<span class="ident" id="6056534">err</span>&nbsp;<span class="op" id="6056538">!=</span>&nbsp;<span class="ident" id="6056541">nil</span>&nbsp;<span class="op" id="6056545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056549">return</span>&nbsp;<span class="ident" id="6056556">nil</span><span class="op" id="6056559">,</span>&nbsp;<span class="ident" id="6056561">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056566">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056570">return</span>&nbsp;<span class="ident" id="6056577">syms</span><span class="op" id="6056581">,</span>&nbsp;<span class="ident" id="6056583">nil</span><br>
<span class="lineno"></span><span class="op" id="6056587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6056590">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6056633">func</span>&nbsp;<span class="op" id="6056638">(</span><span class="ident" id="6056639">f</span>&nbsp;<span class="op" id="6056641">*</span><span class="ident" id="6056642">File</span><span class="op" id="6056646">)</span>&nbsp;<span class="ident" id="6056648">Symbols</span><span class="op" id="6056655">(</span><span class="op" id="6056656">)</span>&nbsp;<span class="op" id="6056658">(</span><span class="op" id="6056659">[</span><span class="op" id="6056660">]</span><span class="ident" id="6056661">Sym</span><span class="op" id="6056664">,</span>&nbsp;<span class="builtintype" id="6056666">error</span><span class="op" id="6056671">)</span>&nbsp;<span class="op" id="6056673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056676">symtabSection</span>&nbsp;<span class="op" id="6056690">:=</span>&nbsp;<span class="ident" id="6056693">f</span><span class="op" id="6056694">.</span><span class="ident" id="6056695">Section</span><span class="op" id="6056702">(</span><span class="string" id="6056703">&#34;syms&#34;</span><span class="op" id="6056709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056712">if</span>&nbsp;<span class="ident" id="6056715">symtabSection</span>&nbsp;<span class="op" id="6056729">==</span>&nbsp;<span class="ident" id="6056732">nil</span>&nbsp;<span class="op" id="6056736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056740">return</span>&nbsp;<span class="ident" id="6056747">nil</span><span class="op" id="6056750">,</span>&nbsp;<span class="ident" id="6056752">errors</span><span class="op" id="6056758">.</span><span class="ident" id="6056759">New</span><span class="op" id="6056762">(</span><span class="string" id="6056763">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6056782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056785">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056789">symtab</span><span class="op" id="6056795">,</span>&nbsp;<span class="ident" id="6056797">err</span>&nbsp;<span class="op" id="6056801">:=</span>&nbsp;<span class="ident" id="6056804">symtabSection</span><span class="op" id="6056817">.</span><span class="ident" id="6056818">Data</span><span class="op" id="6056822">(</span><span class="op" id="6056823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056826">if</span>&nbsp;<span class="ident" id="6056829">err</span>&nbsp;<span class="op" id="6056833">!=</span>&nbsp;<span class="ident" id="6056836">nil</span>&nbsp;<span class="op" id="6056840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056844">return</span>&nbsp;<span class="ident" id="6056851">nil</span><span class="op" id="6056854">,</span>&nbsp;<span class="ident" id="6056856">errors</span><span class="op" id="6056862">.</span><span class="ident" id="6056863">New</span><span class="op" id="6056866">(</span><span class="string" id="6056867">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6056895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056898">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056902">return</span>&nbsp;<span class="ident" id="6056909">newTable</span><span class="op" id="6056917">(</span><span class="ident" id="6056918">symtab</span><span class="op" id="6056924">,</span>&nbsp;<span class="ident" id="6056926">f</span><span class="op" id="6056927">.</span><span class="ident" id="6056928">PtrSize</span><span class="op" id="6056935">)</span><br>
<span class="lineno"></span><span class="op" id="6056937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6056940">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6057008">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6057027">func</span>&nbsp;<span class="op" id="6057032">(</span><span class="ident" id="6057033">f</span>&nbsp;<span class="op" id="6057035">*</span><span class="ident" id="6057036">File</span><span class="op" id="6057040">)</span>&nbsp;<span class="ident" id="6057042">Section</span><span class="op" id="6057049">(</span><span class="ident" id="6057050">name</span>&nbsp;<span class="builtintype" id="6057055">string</span><span class="op" id="6057061">)</span>&nbsp;<span class="op" id="6057063">*</span><span class="ident" id="6057064">Section</span>&nbsp;<span class="op" id="6057072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057075">for</span>&nbsp;<span class="ident" id="6057079">_</span><span class="op" id="6057080">,</span>&nbsp;<span class="ident" id="6057082">s</span>&nbsp;<span class="op" id="6057084">:=</span>&nbsp;<span class="keyword" id="6057087">range</span>&nbsp;<span class="ident" id="6057093">f</span><span class="op" id="6057094">.</span><span class="ident" id="6057095">Sections</span>&nbsp;<span class="op" id="6057104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057108">if</span>&nbsp;<span class="ident" id="6057111">s</span><span class="op" id="6057112">.</span><span class="ident" id="6057113">Name</span>&nbsp;<span class="op" id="6057118">==</span>&nbsp;<span class="ident" id="6057121">name</span>&nbsp;<span class="op" id="6057126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057131">return</span>&nbsp;<span class="ident" id="6057138">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057148">return</span>&nbsp;<span class="ident" id="6057155">nil</span><br>
<span class="lineno"></span><span class="op" id="6057159">}</span>
</div>
</body>
</html>
