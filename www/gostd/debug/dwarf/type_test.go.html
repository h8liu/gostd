<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/dwarf</h2>
<ul>
<li><a href="/gostd/debug/dwarf/buf.go.html">buf.go</a></li>
<li><a href="/gostd/debug/dwarf/const.go.html">const.go</a></li>
<li><a href="/gostd/debug/dwarf/entry.go.html">entry.go</a></li>
<li><a href="/gostd/debug/dwarf/open.go.html">open.go</a></li>
<li><a href="/gostd/debug/dwarf/type.go.html">type.go</a></li>
<li><a href="/gostd/debug/dwarf/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/debug/dwarf/typeunit.go.html">typeunit.go</a></li>
<li><a href="/gostd/debug/dwarf/unit.go.html">unit.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="160699">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="160755">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="160809">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="160860">package</span>&nbsp;<span class="ident" id="160868">dwarf_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="160880">import</span>&nbsp;<span class="op" id="160887">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="160890">.</span>&nbsp;<span class="string" id="160892">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="160907">&#34;debug/elf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="160920">&#34;debug/macho&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="160935">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="160945">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="160948">var</span>&nbsp;<span class="ident" id="160952">typedefTests</span>&nbsp;<span class="op" id="160965">=</span>&nbsp;<span class="keyword" id="160967">map</span><span class="op" id="160970">[</span><span class="builtintype" id="160971">string</span><span class="op" id="160977">]</span><span class="builtintype" id="160978">string</span><span class="op" id="160984">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="160987">&#34;t_ptr_volatile_int&#34;</span><span class="op" id="161007">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161028">&#34;*volatile&nbsp;int&#34;</span><span class="op" id="161043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161046">&#34;t_ptr_const_char&#34;</span><span class="op" id="161064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161087">&#34;*const&nbsp;char&#34;</span><span class="op" id="161100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161103">&#34;t_long&#34;</span><span class="op" id="161111">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161144">&#34;long&nbsp;int&#34;</span><span class="op" id="161154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161157">&#34;t_ushort&#34;</span><span class="op" id="161167">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161198">&#34;short&nbsp;unsigned&nbsp;int&#34;</span><span class="op" id="161218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161221">&#34;t_func_int_of_float_double&#34;</span><span class="op" id="161249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161262">&#34;func(float,&nbsp;double)&nbsp;int&#34;</span><span class="op" id="161287">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161290">&#34;t_ptr_func_int_of_float_double&#34;</span><span class="op" id="161322">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161331">&#34;*func(float,&nbsp;double)&nbsp;int&#34;</span><span class="op" id="161357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161360">&#34;t_ptr_func_int_of_float_complex&#34;</span><span class="op" id="161393">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161401">&#34;*func(complex&nbsp;float)&nbsp;int&#34;</span><span class="op" id="161427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161430">&#34;t_ptr_func_int_of_double_complex&#34;</span><span class="op" id="161464">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161471">&#34;*func(complex&nbsp;double)&nbsp;int&#34;</span><span class="op" id="161498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161501">&#34;t_ptr_func_int_of_long_double_complex&#34;</span><span class="op" id="161540">:</span>&nbsp;<span class="string" id="161542">&#34;*func(complex&nbsp;long&nbsp;double)&nbsp;int&#34;</span><span class="op" id="161574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161577">&#34;t_func_ptr_int_of_char_schar_uchar&#34;</span><span class="op" id="161613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161618">&#34;func(char,&nbsp;signed&nbsp;char,&nbsp;unsigned&nbsp;char)&nbsp;*int&#34;</span><span class="op" id="161663">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161666">&#34;t_func_void_of_char&#34;</span><span class="op" id="161687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161707">&#34;func(char)&nbsp;void&#34;</span><span class="op" id="161724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161727">&#34;t_func_void_of_void&#34;</span><span class="op" id="161748">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161768">&#34;func()&nbsp;void&#34;</span><span class="op" id="161781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161784">&#34;t_func_void_of_ptr_char_dots&#34;</span><span class="op" id="161814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161825">&#34;func(*char,&nbsp;...)&nbsp;void&#34;</span><span class="op" id="161848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="161851">&#34;t_my_struct&#34;</span><span class="op" id="161864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="161892">&#34;struct&nbsp;my_struct&nbsp;{vi&nbsp;volatile&nbsp;int@0;&nbsp;x&nbsp;char@4&nbsp;:&nbsp;1@7;&nbsp;y&nbsp;int@4&nbsp;:&nbsp;4@27;&nbsp;z&nbsp;[0]int@8;&nbsp;array&nbsp;[40]long&nbsp;long&nbsp;int@8;&nbsp;zz&nbsp;[0]int@328}&#34;</span><span class="op" id="162016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162019">&#34;t_my_struct1&#34;</span><span class="op" id="162033">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162060">&#34;struct&nbsp;my_struct1&nbsp;{zz&nbsp;[1]int@0}&#34;</span><span class="op" id="162093">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162096">&#34;t_my_union&#34;</span><span class="op" id="162108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162137">&#34;union&nbsp;my_union&nbsp;{vi&nbsp;volatile&nbsp;int@0;&nbsp;x&nbsp;char@0&nbsp;:&nbsp;1@7;&nbsp;y&nbsp;int@0&nbsp;:&nbsp;4@28;&nbsp;array&nbsp;[40]long&nbsp;long&nbsp;int@0}&#34;</span><span class="op" id="162232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162235">&#34;t_my_enum&#34;</span><span class="op" id="162246">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162276">&#34;enum&nbsp;my_enum&nbsp;{e1=1;&nbsp;e2=2;&nbsp;e3=-5;&nbsp;e4=1000000000000000}&#34;</span><span class="op" id="162331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162334">&#34;t_my_list&#34;</span><span class="op" id="162345">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162375">&#34;struct&nbsp;list&nbsp;{val&nbsp;short&nbsp;int@0;&nbsp;next&nbsp;*t_my_list@8}&#34;</span><span class="op" id="162425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162428">&#34;t_my_tree&#34;</span><span class="op" id="162439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162469">&#34;struct&nbsp;tree&nbsp;{left&nbsp;*struct&nbsp;tree@0;&nbsp;right&nbsp;*struct&nbsp;tree@8;&nbsp;val&nbsp;long&nbsp;long&nbsp;unsigned&nbsp;int@16}&#34;</span><span class="op" id="162557">,</span><br>
<span class="lineno"></span><span class="op" id="162559">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="162562">//&nbsp;As&nbsp;Apple&nbsp;converts&nbsp;gcc&nbsp;to&nbsp;a&nbsp;clang-based&nbsp;front&nbsp;end</span><br>
<span class="lineno"></span><span class="comment" id="162614">//&nbsp;they&nbsp;keep&nbsp;breaking&nbsp;the&nbsp;DWARF&nbsp;output.&nbsp;&nbsp;This&nbsp;map&nbsp;lists&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="162674">//&nbsp;conversion&nbsp;from&nbsp;real&nbsp;answer&nbsp;to&nbsp;Apple&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="162722">var</span>&nbsp;<span class="ident" id="162726">machoBug</span>&nbsp;<span class="op" id="162735">=</span>&nbsp;<span class="keyword" id="162737">map</span><span class="op" id="162740">[</span><span class="builtintype" id="162741">string</span><span class="op" id="162747">]</span><span class="builtintype" id="162748">string</span><span class="op" id="162754">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162757">&#34;func(*char,&nbsp;...)&nbsp;void&#34;</span><span class="op" id="162780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="162814">&#34;func(*char)&nbsp;void&#34;</span><span class="op" id="162832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="162835">&#34;enum&nbsp;my_enum&nbsp;{e1=1;&nbsp;e2=2;&nbsp;e3=-5;&nbsp;e4=1000000000000000}&#34;</span><span class="op" id="162890">:</span>&nbsp;<span class="string" id="162892">&#34;enum&nbsp;my_enum&nbsp;{e1=1;&nbsp;e2=2;&nbsp;e3=-5;&nbsp;e4=-1530494976}&#34;</span><span class="op" id="162942">,</span><br>
<span class="lineno"></span><span class="op" id="162944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="162947">func</span>&nbsp;<span class="ident" id="162952">elfData</span><span class="op" id="162959">(</span><span class="ident" id="162960">t</span>&nbsp;<span class="op" id="162962">*</span><span class="ident" id="162963">testing</span><span class="op" id="162970">.</span><span class="ident" id="162971">T</span><span class="op" id="162972">,</span>&nbsp;<span class="ident" id="162974">name</span>&nbsp;<span class="builtintype" id="162979">string</span><span class="op" id="162985">)</span>&nbsp;<span class="op" id="162987">*</span><span class="ident" id="162988">Data</span>&nbsp;<span class="op" id="162993">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="162996">f</span><span class="op" id="162997">,</span>&nbsp;<span class="ident" id="162999">err</span>&nbsp;<span class="op" id="163003">:=</span>&nbsp;<span class="ident" id="163006">elf</span><span class="op" id="163009">.</span><span class="ident" id="163010">Open</span><span class="op" id="163014">(</span><span class="ident" id="163015">name</span><span class="op" id="163019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163022">if</span>&nbsp;<span class="ident" id="163025">err</span>&nbsp;<span class="op" id="163029">!=</span>&nbsp;<span class="ident" id="163032">nil</span>&nbsp;<span class="op" id="163036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163040">t</span><span class="op" id="163041">.</span><span class="ident" id="163042">Fatal</span><span class="op" id="163047">(</span><span class="ident" id="163048">err</span><span class="op" id="163051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163058">d</span><span class="op" id="163059">,</span>&nbsp;<span class="ident" id="163061">err</span>&nbsp;<span class="op" id="163065">:=</span>&nbsp;<span class="ident" id="163068">f</span><span class="op" id="163069">.</span><span class="ident" id="163070">DWARF</span><span class="op" id="163075">(</span><span class="op" id="163076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163079">if</span>&nbsp;<span class="ident" id="163082">err</span>&nbsp;<span class="op" id="163086">!=</span>&nbsp;<span class="ident" id="163089">nil</span>&nbsp;<span class="op" id="163093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163097">t</span><span class="op" id="163098">.</span><span class="ident" id="163099">Fatal</span><span class="op" id="163104">(</span><span class="ident" id="163105">err</span><span class="op" id="163108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163114">return</span>&nbsp;<span class="ident" id="163121">d</span><br>
<span class="lineno">55</span><span class="op" id="163123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="163126">func</span>&nbsp;<span class="ident" id="163131">machoData</span><span class="op" id="163140">(</span><span class="ident" id="163141">t</span>&nbsp;<span class="op" id="163143">*</span><span class="ident" id="163144">testing</span><span class="op" id="163151">.</span><span class="ident" id="163152">T</span><span class="op" id="163153">,</span>&nbsp;<span class="ident" id="163155">name</span>&nbsp;<span class="builtintype" id="163160">string</span><span class="op" id="163166">)</span>&nbsp;<span class="op" id="163168">*</span><span class="ident" id="163169">Data</span>&nbsp;<span class="op" id="163174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163177">f</span><span class="op" id="163178">,</span>&nbsp;<span class="ident" id="163180">err</span>&nbsp;<span class="op" id="163184">:=</span>&nbsp;<span class="ident" id="163187">macho</span><span class="op" id="163192">.</span><span class="ident" id="163193">Open</span><span class="op" id="163197">(</span><span class="ident" id="163198">name</span><span class="op" id="163202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163205">if</span>&nbsp;<span class="ident" id="163208">err</span>&nbsp;<span class="op" id="163212">!=</span>&nbsp;<span class="ident" id="163215">nil</span>&nbsp;<span class="op" id="163219">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163223">t</span><span class="op" id="163224">.</span><span class="ident" id="163225">Fatal</span><span class="op" id="163230">(</span><span class="ident" id="163231">err</span><span class="op" id="163234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163241">d</span><span class="op" id="163242">,</span>&nbsp;<span class="ident" id="163244">err</span>&nbsp;<span class="op" id="163248">:=</span>&nbsp;<span class="ident" id="163251">f</span><span class="op" id="163252">.</span><span class="ident" id="163253">DWARF</span><span class="op" id="163258">(</span><span class="op" id="163259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163262">if</span>&nbsp;<span class="ident" id="163265">err</span>&nbsp;<span class="op" id="163269">!=</span>&nbsp;<span class="ident" id="163272">nil</span>&nbsp;<span class="op" id="163276">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163280">t</span><span class="op" id="163281">.</span><span class="ident" id="163282">Fatal</span><span class="op" id="163287">(</span><span class="ident" id="163288">err</span><span class="op" id="163291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163297">return</span>&nbsp;<span class="ident" id="163304">d</span><br>
<span class="lineno"></span><span class="op" id="163306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="163309">func</span>&nbsp;<span class="ident" id="163314">TestTypedefsELF</span><span class="op" id="163329">(</span><span class="ident" id="163330">t</span>&nbsp;<span class="op" id="163332">*</span><span class="ident" id="163333">testing</span><span class="op" id="163340">.</span><span class="ident" id="163341">T</span><span class="op" id="163342">)</span>&nbsp;<span class="op" id="163344">{</span>&nbsp;<span class="ident" id="163346">testTypedefs</span><span class="op" id="163358">(</span><span class="ident" id="163359">t</span><span class="op" id="163360">,</span>&nbsp;<span class="ident" id="163362">elfData</span><span class="op" id="163369">(</span><span class="ident" id="163370">t</span><span class="op" id="163371">,</span>&nbsp;<span class="string" id="163373">&#34;testdata/typedef.elf&#34;</span><span class="op" id="163395">)</span><span class="op" id="163396">,</span>&nbsp;<span class="string" id="163398">&#34;elf&#34;</span><span class="op" id="163403">)</span>&nbsp;<span class="op" id="163405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="163408">func</span>&nbsp;<span class="ident" id="163413">TestTypedefsMachO</span><span class="op" id="163430">(</span><span class="ident" id="163431">t</span>&nbsp;<span class="op" id="163433">*</span><span class="ident" id="163434">testing</span><span class="op" id="163441">.</span><span class="ident" id="163442">T</span><span class="op" id="163443">)</span>&nbsp;<span class="op" id="163445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163448">testTypedefs</span><span class="op" id="163460">(</span><span class="ident" id="163461">t</span><span class="op" id="163462">,</span>&nbsp;<span class="ident" id="163464">machoData</span><span class="op" id="163473">(</span><span class="ident" id="163474">t</span><span class="op" id="163475">,</span>&nbsp;<span class="string" id="163477">&#34;testdata/typedef.macho&#34;</span><span class="op" id="163501">)</span><span class="op" id="163502">,</span>&nbsp;<span class="string" id="163504">&#34;macho&#34;</span><span class="op" id="163511">)</span><br>
<span class="lineno"></span><span class="op" id="163513">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="163516">func</span>&nbsp;<span class="ident" id="163521">TestTypedefsELFDwarf4</span><span class="op" id="163542">(</span><span class="ident" id="163543">t</span>&nbsp;<span class="op" id="163545">*</span><span class="ident" id="163546">testing</span><span class="op" id="163553">.</span><span class="ident" id="163554">T</span><span class="op" id="163555">)</span>&nbsp;<span class="op" id="163557">{</span>&nbsp;<span class="ident" id="163559">testTypedefs</span><span class="op" id="163571">(</span><span class="ident" id="163572">t</span><span class="op" id="163573">,</span>&nbsp;<span class="ident" id="163575">elfData</span><span class="op" id="163582">(</span><span class="ident" id="163583">t</span><span class="op" id="163584">,</span>&nbsp;<span class="string" id="163586">&#34;testdata/typedef.elf4&#34;</span><span class="op" id="163609">)</span><span class="op" id="163610">,</span>&nbsp;<span class="string" id="163612">&#34;elf&#34;</span><span class="op" id="163617">)</span>&nbsp;<span class="op" id="163619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="163622">func</span>&nbsp;<span class="ident" id="163627">testTypedefs</span><span class="op" id="163639">(</span><span class="ident" id="163640">t</span>&nbsp;<span class="op" id="163642">*</span><span class="ident" id="163643">testing</span><span class="op" id="163650">.</span><span class="ident" id="163651">T</span><span class="op" id="163652">,</span>&nbsp;<span class="ident" id="163654">d</span>&nbsp;<span class="op" id="163656">*</span><span class="ident" id="163657">Data</span><span class="op" id="163661">,</span>&nbsp;<span class="ident" id="163663">kind</span>&nbsp;<span class="builtintype" id="163668">string</span><span class="op" id="163674">)</span>&nbsp;<span class="op" id="163676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163679">r</span>&nbsp;<span class="op" id="163681">:=</span>&nbsp;<span class="ident" id="163684">d</span><span class="op" id="163685">.</span><span class="ident" id="163686">Reader</span><span class="op" id="163692">(</span><span class="op" id="163693">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163696">seen</span>&nbsp;<span class="op" id="163701">:=</span>&nbsp;<span class="builtinfunc" id="163704">make</span><span class="op" id="163708">(</span><span class="keyword" id="163709">map</span><span class="op" id="163712">[</span><span class="builtintype" id="163713">string</span><span class="op" id="163719">]</span><span class="builtintype" id="163720">bool</span><span class="op" id="163724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163727">for</span>&nbsp;<span class="op" id="163731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163735">e</span><span class="op" id="163736">,</span>&nbsp;<span class="ident" id="163738">err</span>&nbsp;<span class="op" id="163742">:=</span>&nbsp;<span class="ident" id="163745">r</span><span class="op" id="163746">.</span><span class="ident" id="163747">Next</span><span class="op" id="163751">(</span><span class="op" id="163752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163756">if</span>&nbsp;<span class="ident" id="163759">err</span>&nbsp;<span class="op" id="163763">!=</span>&nbsp;<span class="ident" id="163766">nil</span>&nbsp;<span class="op" id="163770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163775">t</span><span class="op" id="163776">.</span><span class="ident" id="163777">Fatal</span><span class="op" id="163782">(</span><span class="string" id="163783">&#34;r.Next:&#34;</span><span class="op" id="163792">,</span>&nbsp;<span class="ident" id="163794">err</span><span class="op" id="163797">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163805">if</span>&nbsp;<span class="ident" id="163808">e</span>&nbsp;<span class="op" id="163810">==</span>&nbsp;<span class="ident" id="163813">nil</span>&nbsp;<span class="op" id="163817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163822">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163834">if</span>&nbsp;<span class="ident" id="163837">e</span><span class="op" id="163838">.</span><span class="ident" id="163839">Tag</span>&nbsp;<span class="op" id="163843">==</span>&nbsp;<span class="ident" id="163846">TagTypedef</span>&nbsp;<span class="op" id="163857">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163862">typ</span><span class="op" id="163865">,</span>&nbsp;<span class="ident" id="163867">err</span>&nbsp;<span class="op" id="163871">:=</span>&nbsp;<span class="ident" id="163874">d</span><span class="op" id="163875">.</span><span class="ident" id="163876">Type</span><span class="op" id="163880">(</span><span class="ident" id="163881">e</span><span class="op" id="163882">.</span><span class="ident" id="163883">Offset</span><span class="op" id="163889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163894">if</span>&nbsp;<span class="ident" id="163897">err</span>&nbsp;<span class="op" id="163901">!=</span>&nbsp;<span class="ident" id="163904">nil</span>&nbsp;<span class="op" id="163908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163914">t</span><span class="op" id="163915">.</span><span class="ident" id="163916">Fatal</span><span class="op" id="163921">(</span><span class="string" id="163922">&#34;d.Type:&#34;</span><span class="op" id="163931">,</span>&nbsp;<span class="ident" id="163933">err</span><span class="op" id="163936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="163941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="163946">t1</span>&nbsp;<span class="op" id="163949">:=</span>&nbsp;<span class="ident" id="163952">typ</span><span class="op" id="163955">.</span><span class="op" id="163956">(</span><span class="op" id="163957">*</span><span class="ident" id="163958">TypedefType</span><span class="op" id="163969">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163974">var</span>&nbsp;<span class="ident" id="163978">typstr</span>&nbsp;<span class="builtintype" id="163985">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="163995">if</span>&nbsp;<span class="ident" id="163998">ts</span><span class="op" id="164000">,</span>&nbsp;<span class="ident" id="164002">ok</span>&nbsp;<span class="op" id="164005">:=</span>&nbsp;<span class="ident" id="164008">t1</span><span class="op" id="164010">.</span><span class="ident" id="164011">Type</span><span class="op" id="164015">.</span><span class="op" id="164016">(</span><span class="op" id="164017">*</span><span class="ident" id="164018">StructType</span><span class="op" id="164028">)</span><span class="op" id="164029">;</span>&nbsp;<span class="ident" id="164031">ok</span>&nbsp;<span class="op" id="164034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164040">typstr</span>&nbsp;<span class="op" id="164047">=</span>&nbsp;<span class="ident" id="164049">ts</span><span class="op" id="164051">.</span><span class="ident" id="164052">Defn</span><span class="op" id="164056">(</span><span class="op" id="164057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164062">}</span>&nbsp;<span class="keyword" id="164064">else</span>&nbsp;<span class="op" id="164069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164075">typstr</span>&nbsp;<span class="op" id="164082">=</span>&nbsp;<span class="ident" id="164084">t1</span><span class="op" id="164086">.</span><span class="ident" id="164087">Type</span><span class="op" id="164091">.</span><span class="ident" id="164092">String</span><span class="op" id="164098">(</span><span class="op" id="164099">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164110">if</span>&nbsp;<span class="ident" id="164113">want</span><span class="op" id="164117">,</span>&nbsp;<span class="ident" id="164119">ok</span>&nbsp;<span class="op" id="164122">:=</span>&nbsp;<span class="ident" id="164125">typedefTests</span><span class="op" id="164137">[</span><span class="ident" id="164138">t1</span><span class="op" id="164140">.</span><span class="ident" id="164141">Name</span><span class="op" id="164145">]</span><span class="op" id="164146">;</span>&nbsp;<span class="ident" id="164148">ok</span>&nbsp;<span class="op" id="164151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164157">if</span>&nbsp;<span class="ident" id="164160">seen</span><span class="op" id="164164">[</span><span class="ident" id="164165">t1</span><span class="op" id="164167">.</span><span class="ident" id="164168">Name</span><span class="op" id="164172">]</span>&nbsp;<span class="op" id="164174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164181">t</span><span class="op" id="164182">.</span><span class="ident" id="164183">Errorf</span><span class="op" id="164189">(</span><span class="string" id="164190">&#34;multiple&nbsp;definitions&nbsp;for&nbsp;%s&#34;</span><span class="op" id="164219">,</span>&nbsp;<span class="ident" id="164221">t1</span><span class="op" id="164223">.</span><span class="ident" id="164224">Name</span><span class="op" id="164228">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164240">seen</span><span class="op" id="164244">[</span><span class="ident" id="164245">t1</span><span class="op" id="164247">.</span><span class="ident" id="164248">Name</span><span class="op" id="164252">]</span>&nbsp;<span class="op" id="164254">=</span>&nbsp;<span class="builtintype" id="164256">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164265">if</span>&nbsp;<span class="ident" id="164268">typstr</span>&nbsp;<span class="op" id="164275">!=</span>&nbsp;<span class="ident" id="164278">want</span>&nbsp;<span class="op" id="164283">&amp;&amp;</span>&nbsp;<span class="op" id="164286">(</span><span class="ident" id="164287">kind</span>&nbsp;<span class="op" id="164292">!=</span>&nbsp;<span class="string" id="164295">&#34;macho&#34;</span>&nbsp;<span class="op" id="164303">||</span>&nbsp;<span class="ident" id="164306">typstr</span>&nbsp;<span class="op" id="164313">!=</span>&nbsp;<span class="ident" id="164316">machoBug</span><span class="op" id="164324">[</span><span class="ident" id="164325">want</span><span class="op" id="164329">]</span><span class="op" id="164330">)</span>&nbsp;<span class="op" id="164332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164339">t</span><span class="op" id="164340">.</span><span class="ident" id="164341">Errorf</span><span class="op" id="164347">(</span><span class="string" id="164348">&#34;%s:\n\thave&nbsp;%s\n\twant&nbsp;%s&#34;</span><span class="op" id="164375">,</span>&nbsp;<span class="ident" id="164377">t1</span><span class="op" id="164379">.</span><span class="ident" id="164380">Name</span><span class="op" id="164384">,</span>&nbsp;<span class="ident" id="164386">typstr</span><span class="op" id="164392">,</span>&nbsp;<span class="ident" id="164394">want</span><span class="op" id="164398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164404">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164417">if</span>&nbsp;<span class="ident" id="164420">e</span><span class="op" id="164421">.</span><span class="ident" id="164422">Tag</span>&nbsp;<span class="op" id="164426">!=</span>&nbsp;<span class="ident" id="164429">TagCompileUnit</span>&nbsp;<span class="op" id="164444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164449">r</span><span class="op" id="164450">.</span><span class="ident" id="164451">SkipChildren</span><span class="op" id="164463">(</span><span class="op" id="164464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164468">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164475">for</span>&nbsp;<span class="ident" id="164479">k</span>&nbsp;<span class="op" id="164481">:=</span>&nbsp;<span class="keyword" id="164484">range</span>&nbsp;<span class="ident" id="164490">typedefTests</span>&nbsp;<span class="op" id="164503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="164507">if</span>&nbsp;<span class="op" id="164510">!</span><span class="ident" id="164511">seen</span><span class="op" id="164515">[</span><span class="ident" id="164516">k</span><span class="op" id="164517">]</span>&nbsp;<span class="op" id="164519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="164524">t</span><span class="op" id="164525">.</span><span class="ident" id="164526">Errorf</span><span class="op" id="164532">(</span><span class="string" id="164533">&#34;missing&nbsp;%s&#34;</span><span class="op" id="164545">,</span>&nbsp;<span class="ident" id="164547">k</span><span class="op" id="164548">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="164555">}</span><br>
<span class="lineno"></span><span class="op" id="164557">}</span>
</div>
</body>
</html>
