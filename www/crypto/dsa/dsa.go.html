<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4269918">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4269973">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4270027">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4270078">//&nbsp;Package&nbsp;dsa&nbsp;implements&nbsp;the&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4270163">package</span>&nbsp;<span class="ident" id="4270171">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270176">import</span>&nbsp;<span class="op" id="4270183">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4270186">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4270196">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4270202">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4270213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270216">//&nbsp;Parameters&nbsp;represents&nbsp;the&nbsp;domain&nbsp;parameters&nbsp;for&nbsp;a&nbsp;key.&nbsp;These&nbsp;parameters&nbsp;can</span><br>
<span class="lineno">15</span><span class="comment" id="4270295">//&nbsp;be&nbsp;shared&nbsp;across&nbsp;many&nbsp;keys.&nbsp;The&nbsp;bit&nbsp;length&nbsp;of&nbsp;Q&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="4270371">type</span>&nbsp;<span class="ident" id="4270376">Parameters</span>&nbsp;<span class="keyword" id="4270387">struct</span>&nbsp;<span class="op" id="4270394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270397">P</span><span class="op" id="4270398">,</span>&nbsp;<span class="ident" id="4270400">Q</span><span class="op" id="4270401">,</span>&nbsp;<span class="ident" id="4270403">G</span>&nbsp;<span class="op" id="4270405">*</span><span class="ident" id="4270406"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4270409">.</span><span class="ident" id="4270410">Int</span><br>
<span class="lineno"></span><span class="op" id="4270414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4270417">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4270459">type</span>&nbsp;<span class="ident" id="4270464">PublicKey</span>&nbsp;<span class="keyword" id="4270474">struct</span>&nbsp;<span class="op" id="4270481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270484"><a href="/crypto/dsa/dsa.go.html#4270376">Parameters</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270496">Y</span>&nbsp;<span class="op" id="4270498">*</span><span class="ident" id="4270499"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4270502">.</span><span class="ident" id="4270503">Int</span><br>
<span class="lineno"></span><span class="op" id="4270507">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4270510">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4270554">type</span>&nbsp;<span class="ident" id="4270559">PrivateKey</span>&nbsp;<span class="keyword" id="4270570">struct</span>&nbsp;<span class="op" id="4270577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270580"><a href="/crypto/dsa/dsa.go.html#4270464">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270591">X</span>&nbsp;<span class="op" id="4270593">*</span><span class="ident" id="4270594"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4270597">.</span><span class="ident" id="4270598">Int</span><br>
<span class="lineno">30</span><span class="op" id="4270602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270605">//&nbsp;ErrInvalidPublicKey&nbsp;results&nbsp;when&nbsp;a&nbsp;public&nbsp;key&nbsp;is&nbsp;not&nbsp;usable&nbsp;by&nbsp;this&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4270682">//&nbsp;FIPS&nbsp;is&nbsp;quite&nbsp;strict&nbsp;about&nbsp;the&nbsp;format&nbsp;of&nbsp;DSA&nbsp;keys,&nbsp;but&nbsp;other&nbsp;code&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4270758">//&nbsp;less&nbsp;so.&nbsp;Thus,&nbsp;when&nbsp;using&nbsp;keys&nbsp;which&nbsp;may&nbsp;have&nbsp;been&nbsp;generated&nbsp;by&nbsp;other&nbsp;code,</span><br>
<span class="lineno">35</span><span class="comment" id="4270837">//&nbsp;this&nbsp;error&nbsp;must&nbsp;be&nbsp;handled.</span><br>
<span class="lineno"></span><span class="keyword" id="4270868">var</span>&nbsp;<span class="ident" id="4270872">ErrInvalidPublicKey</span>&nbsp;<span class="op" id="4270892">=</span>&nbsp;<span class="ident" id="4270894"><a href="/crypto/dsa/dsa.go.html#4270186">errors</a></span><span class="op" id="4270900">.</span><span class="ident" id="4270901">New</span><span class="op" id="4270904">(</span><span class="string" id="4270905">&#34;crypto/dsa:&nbsp;invalid&nbsp;public&nbsp;key&#34;</span><span class="op" id="4270937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270940">//&nbsp;ParameterSizes&nbsp;is&nbsp;a&nbsp;enumeration&nbsp;of&nbsp;the&nbsp;acceptable&nbsp;bit&nbsp;lengths&nbsp;of&nbsp;the&nbsp;primes</span><br>
<span class="lineno"></span><span class="comment" id="4271019">//&nbsp;in&nbsp;a&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters.&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno">40</span><span class="keyword" id="4271079">type</span>&nbsp;<span class="ident" id="4271084">ParameterSizes</span>&nbsp;<span class="builtintype" id="4271099">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271104">const</span>&nbsp;<span class="op" id="4271110">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271113">L1024N160</span>&nbsp;<span class="ident" id="4271123"><a href="/crypto/dsa/dsa.go.html#4271084">ParameterSizes</a></span>&nbsp;<span class="op" id="4271138">=</span>&nbsp;<span class="ident" id="4271140">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271146">L2048N224</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271157">L2048N256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271168">L3072N256</span><br>
<span class="lineno"></span><span class="op" id="4271178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4271181">//&nbsp;numMRTests&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;Miller-Rabin&nbsp;primality&nbsp;tests&nbsp;that&nbsp;we&nbsp;perform.&nbsp;We</span><br>
<span class="lineno">50</span><span class="comment" id="4271261">//&nbsp;pick&nbsp;the&nbsp;largest&nbsp;recommended&nbsp;number&nbsp;from&nbsp;table&nbsp;C.1&nbsp;of&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4271330">const</span>&nbsp;<span class="ident" id="4271336">numMRTests</span>&nbsp;<span class="op" id="4271347">=</span>&nbsp;<span class="num" id="4271349">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4271353">//&nbsp;GenerateParameters&nbsp;puts&nbsp;a&nbsp;random,&nbsp;valid&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters&nbsp;into&nbsp;params.</span><br>
<span class="lineno"></span><span class="comment" id="4271431">//&nbsp;This&nbsp;function&nbsp;takes&nbsp;many&nbsp;seconds,&nbsp;even&nbsp;on&nbsp;fast&nbsp;machines.</span><br>
<span class="lineno">55</span><span class="keyword" id="4271491">func</span>&nbsp;<span class="ident" id="4271496">GenerateParameters</span><span class="op" id="4271514">(</span><span class="ident" id="4271515">params</span>&nbsp;<span class="op" id="4271522">*</span><span class="ident" id="4271523"><a href="/crypto/dsa/dsa.go.html#4270376">Parameters</a></span><span class="op" id="4271533">,</span>&nbsp;<span class="ident" id="4271535">rand</span>&nbsp;<span class="ident" id="4271540"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4271542">.</span><span class="ident" id="4271543">Reader</span><span class="op" id="4271549">,</span>&nbsp;<span class="ident" id="4271551">sizes</span>&nbsp;<span class="ident" id="4271557"><a href="/crypto/dsa/dsa.go.html#4271084">ParameterSizes</a></span><span class="op" id="4271571">)</span>&nbsp;<span class="op" id="4271573">(</span><span class="ident" id="4271574">err</span>&nbsp;<span class="builtintype" id="4271578">error</span><span class="op" id="4271583">)</span>&nbsp;<span class="op" id="4271585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271588">//&nbsp;This&nbsp;function&nbsp;doesn&#39;t&nbsp;follow&nbsp;FIPS&nbsp;186-3&nbsp;exactly&nbsp;in&nbsp;that&nbsp;it&nbsp;doesn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271659">//&nbsp;use&nbsp;a&nbsp;verification&nbsp;seed&nbsp;to&nbsp;generate&nbsp;the&nbsp;primes.&nbsp;The&nbsp;verification</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271728">//&nbsp;seed&nbsp;doesn&#39;t&nbsp;appear&nbsp;to&nbsp;be&nbsp;exported&nbsp;or&nbsp;used&nbsp;by&nbsp;other&nbsp;code&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271793">//&nbsp;omitting&nbsp;it&nbsp;makes&nbsp;the&nbsp;code&nbsp;cleaner.</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271834">var</span>&nbsp;<span class="ident" id="4271838">L</span><span class="op" id="4271839">,</span>&nbsp;<span class="ident" id="4271841">N</span>&nbsp;<span class="builtintype" id="4271843">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271848">switch</span>&nbsp;<span class="ident" id="4271855"><a href="/crypto/dsa/dsa.go.html#4271551">sizes</a></span>&nbsp;<span class="op" id="4271861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271864">case</span>&nbsp;<span class="ident" id="4271869"><a href="/crypto/dsa/dsa.go.html#4271113">L1024N160</a></span><span class="op" id="4271878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271882"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span>&nbsp;<span class="op" id="4271884">=</span>&nbsp;<span class="num" id="4271886">1024</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271893"><a href="/crypto/dsa/dsa.go.html#4271841">N</a></span>&nbsp;<span class="op" id="4271895">=</span>&nbsp;<span class="num" id="4271897">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271902">case</span>&nbsp;<span class="ident" id="4271907"><a href="/crypto/dsa/dsa.go.html#4271146">L2048N224</a></span><span class="op" id="4271916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271920"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span>&nbsp;<span class="op" id="4271922">=</span>&nbsp;<span class="num" id="4271924">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271931"><a href="/crypto/dsa/dsa.go.html#4271841">N</a></span>&nbsp;<span class="op" id="4271933">=</span>&nbsp;<span class="num" id="4271935">224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271940">case</span>&nbsp;<span class="ident" id="4271945"><a href="/crypto/dsa/dsa.go.html#4271157">L2048N256</a></span><span class="op" id="4271954">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271958"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span>&nbsp;<span class="op" id="4271960">=</span>&nbsp;<span class="num" id="4271962">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271969"><a href="/crypto/dsa/dsa.go.html#4271841">N</a></span>&nbsp;<span class="op" id="4271971">=</span>&nbsp;<span class="num" id="4271973">256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271978">case</span>&nbsp;<span class="ident" id="4271983"><a href="/crypto/dsa/dsa.go.html#4271168">L3072N256</a></span><span class="op" id="4271992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271996"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span>&nbsp;<span class="op" id="4271998">=</span>&nbsp;<span class="num" id="4272000">3072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272007"><a href="/crypto/dsa/dsa.go.html#4271841">N</a></span>&nbsp;<span class="op" id="4272009">=</span>&nbsp;<span class="num" id="4272011">256</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272016">default</span><span class="op" id="4272023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272027">return</span>&nbsp;<span class="ident" id="4272034"><a href="/crypto/dsa/dsa.go.html#4270186">errors</a></span><span class="op" id="4272040">.</span><span class="ident" id="4272041">New</span><span class="op" id="4272044">(</span><span class="string" id="4272045">&#34;crypto/dsa:&nbsp;invalid&nbsp;ParameterSizes&#34;</span><span class="op" id="4272081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272088">qBytes</span>&nbsp;<span class="op" id="4272095">:=</span>&nbsp;<span class="builtinfunc" id="4272098">make</span><span class="op" id="4272102">(</span><span class="op" id="4272103">[</span><span class="op" id="4272104">]</span><span class="builtintype" id="4272105">byte</span><span class="op" id="4272109">,</span>&nbsp;<span class="ident" id="4272111"><a href="/crypto/dsa/dsa.go.html#4271841">N</a></span><span class="op" id="4272112">/</span><span class="num" id="4272113">8</span><span class="op" id="4272114">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272117">pBytes</span>&nbsp;<span class="op" id="4272124">:=</span>&nbsp;<span class="builtinfunc" id="4272127">make</span><span class="op" id="4272131">(</span><span class="op" id="4272132">[</span><span class="op" id="4272133">]</span><span class="builtintype" id="4272134">byte</span><span class="op" id="4272138">,</span>&nbsp;<span class="ident" id="4272140"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span><span class="op" id="4272141">/</span><span class="num" id="4272142">8</span><span class="op" id="4272143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272147">q</span>&nbsp;<span class="op" id="4272149">:=</span>&nbsp;<span class="builtinfunc" id="4272152">new</span><span class="op" id="4272155">(</span><span class="ident" id="4272156"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272159">.</span><span class="ident" id="4272160">Int</span><span class="op" id="4272163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272166">p</span>&nbsp;<span class="op" id="4272168">:=</span>&nbsp;<span class="builtinfunc" id="4272171">new</span><span class="op" id="4272174">(</span><span class="ident" id="4272175"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272178">.</span><span class="ident" id="4272179">Int</span><span class="op" id="4272182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272185">rem</span>&nbsp;<span class="op" id="4272189">:=</span>&nbsp;<span class="builtinfunc" id="4272192">new</span><span class="op" id="4272195">(</span><span class="ident" id="4272196"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272199">.</span><span class="ident" id="4272200">Int</span><span class="op" id="4272203">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272206">one</span>&nbsp;<span class="op" id="4272210">:=</span>&nbsp;<span class="builtinfunc" id="4272213">new</span><span class="op" id="4272216">(</span><span class="ident" id="4272217"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272220">.</span><span class="ident" id="4272221">Int</span><span class="op" id="4272224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272227"><a href="/crypto/dsa/dsa.go.html#4272206">one</a></span><span class="op" id="4272230">.</span><span class="ident" id="4272231">SetInt64</span><span class="op" id="4272239">(</span><span class="num" id="4272240">1</span><span class="op" id="4272241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4272244">GeneratePrimes</span><span class="op" id="4272258">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272261">for</span>&nbsp;<span class="op" id="4272265">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272269">_</span><span class="op" id="4272270">,</span>&nbsp;<span class="ident" id="4272272"><a href="/crypto/dsa/dsa.go.html#4271574">err</a></span>&nbsp;<span class="op" id="4272276">=</span>&nbsp;<span class="ident" id="4272278"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4272280">.</span><span class="ident" id="4272281">ReadFull</span><span class="op" id="4272289">(</span><span class="ident" id="4272290"><a href="/crypto/dsa/dsa.go.html#4271535">rand</a></span><span class="op" id="4272294">,</span>&nbsp;<span class="ident" id="4272296"><a href="/crypto/dsa/dsa.go.html#4272088">qBytes</a></span><span class="op" id="4272302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272306">if</span>&nbsp;<span class="ident" id="4272309"><a href="/crypto/dsa/dsa.go.html#4271574">err</a></span>&nbsp;<span class="op" id="4272313">!=</span>&nbsp;<span class="ident" id="4272316">nil</span>&nbsp;<span class="op" id="4272320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272339"><a href="/crypto/dsa/dsa.go.html#4272088">qBytes</a></span><span class="op" id="4272345">[</span><span class="builtinfunc" id="4272346">len</span><span class="op" id="4272349">(</span><span class="ident" id="4272350"><a href="/crypto/dsa/dsa.go.html#4272088">qBytes</a></span><span class="op" id="4272356">)</span><span class="op" id="4272357">-</span><span class="num" id="4272358">1</span><span class="op" id="4272359">]</span>&nbsp;<span class="op" id="4272361">|=</span>&nbsp;<span class="num" id="4272364">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272368"><a href="/crypto/dsa/dsa.go.html#4272088">qBytes</a></span><span class="op" id="4272374">[</span><span class="num" id="4272375">0</span><span class="op" id="4272376">]</span>&nbsp;<span class="op" id="4272378">|=</span>&nbsp;<span class="num" id="4272381">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272388"><a href="/crypto/dsa/dsa.go.html#4272147">q</a></span><span class="op" id="4272389">.</span><span class="ident" id="4272390">SetBytes</span><span class="op" id="4272398">(</span><span class="ident" id="4272399"><a href="/crypto/dsa/dsa.go.html#4272088">qBytes</a></span><span class="op" id="4272405">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272410">if</span>&nbsp;<span class="op" id="4272413">!</span><span class="ident" id="4272414"><a href="/crypto/dsa/dsa.go.html#4272147">q</a></span><span class="op" id="4272415">.</span><span class="ident" id="4272416">ProbablyPrime</span><span class="op" id="4272429">(</span><span class="ident" id="4272430"><a href="/crypto/dsa/dsa.go.html#4271336">numMRTests</a></span><span class="op" id="4272440">)</span>&nbsp;<span class="op" id="4272442">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272447">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272463">for</span>&nbsp;<span class="ident" id="4272467">i</span>&nbsp;<span class="op" id="4272469">:=</span>&nbsp;<span class="num" id="4272472">0</span><span class="op" id="4272473">;</span>&nbsp;<span class="ident" id="4272475"><a href="/crypto/dsa/dsa.go.html#4272467">i</a></span>&nbsp;<span class="op" id="4272477">&lt;</span>&nbsp;<span class="num" id="4272479">4</span><span class="op" id="4272480">*</span><span class="ident" id="4272481"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span><span class="op" id="4272482">;</span>&nbsp;<span class="ident" id="4272484"><a href="/crypto/dsa/dsa.go.html#4272467">i</a></span><span class="op" id="4272485">++</span>&nbsp;<span class="op" id="4272488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272493">_</span><span class="op" id="4272494">,</span>&nbsp;<span class="ident" id="4272496"><a href="/crypto/dsa/dsa.go.html#4271574">err</a></span>&nbsp;<span class="op" id="4272500">=</span>&nbsp;<span class="ident" id="4272502"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4272504">.</span><span class="ident" id="4272505">ReadFull</span><span class="op" id="4272513">(</span><span class="ident" id="4272514"><a href="/crypto/dsa/dsa.go.html#4271535">rand</a></span><span class="op" id="4272518">,</span>&nbsp;<span class="ident" id="4272520"><a href="/crypto/dsa/dsa.go.html#4272117">pBytes</a></span><span class="op" id="4272526">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272531">if</span>&nbsp;<span class="ident" id="4272534"><a href="/crypto/dsa/dsa.go.html#4271574">err</a></span>&nbsp;<span class="op" id="4272538">!=</span>&nbsp;<span class="ident" id="4272541">nil</span>&nbsp;<span class="op" id="4272545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272567"><a href="/crypto/dsa/dsa.go.html#4272117">pBytes</a></span><span class="op" id="4272573">[</span><span class="builtinfunc" id="4272574">len</span><span class="op" id="4272577">(</span><span class="ident" id="4272578"><a href="/crypto/dsa/dsa.go.html#4272117">pBytes</a></span><span class="op" id="4272584">)</span><span class="op" id="4272585">-</span><span class="num" id="4272586">1</span><span class="op" id="4272587">]</span>&nbsp;<span class="op" id="4272589">|=</span>&nbsp;<span class="num" id="4272592">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272597"><a href="/crypto/dsa/dsa.go.html#4272117">pBytes</a></span><span class="op" id="4272603">[</span><span class="num" id="4272604">0</span><span class="op" id="4272605">]</span>&nbsp;<span class="op" id="4272607">|=</span>&nbsp;<span class="num" id="4272610">0x80</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272619"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272620">.</span><span class="ident" id="4272621">SetBytes</span><span class="op" id="4272629">(</span><span class="ident" id="4272630"><a href="/crypto/dsa/dsa.go.html#4272117">pBytes</a></span><span class="op" id="4272636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272641"><a href="/crypto/dsa/dsa.go.html#4272185">rem</a></span><span class="op" id="4272644">.</span><span class="ident" id="4272645">Mod</span><span class="op" id="4272648">(</span><span class="ident" id="4272649"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272650">,</span>&nbsp;<span class="ident" id="4272652"><a href="/crypto/dsa/dsa.go.html#4272147">q</a></span><span class="op" id="4272653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272658"><a href="/crypto/dsa/dsa.go.html#4272185">rem</a></span><span class="op" id="4272661">.</span><span class="ident" id="4272662">Sub</span><span class="op" id="4272665">(</span><span class="ident" id="4272666"><a href="/crypto/dsa/dsa.go.html#4272185">rem</a></span><span class="op" id="4272669">,</span>&nbsp;<span class="ident" id="4272671"><a href="/crypto/dsa/dsa.go.html#4272206">one</a></span><span class="op" id="4272674">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272679"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272680">.</span><span class="ident" id="4272681">Sub</span><span class="op" id="4272684">(</span><span class="ident" id="4272685"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272686">,</span>&nbsp;<span class="ident" id="4272688"><a href="/crypto/dsa/dsa.go.html#4272185">rem</a></span><span class="op" id="4272691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272696">if</span>&nbsp;<span class="ident" id="4272699"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272700">.</span><span class="ident" id="4272701">BitLen</span><span class="op" id="4272707">(</span><span class="op" id="4272708">)</span>&nbsp;<span class="op" id="4272710">&lt;</span>&nbsp;<span class="ident" id="4272712"><a href="/crypto/dsa/dsa.go.html#4271838">L</a></span>&nbsp;<span class="op" id="4272714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272720">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272738">if</span>&nbsp;<span class="op" id="4272741">!</span><span class="ident" id="4272742"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272743">.</span><span class="ident" id="4272744">ProbablyPrime</span><span class="op" id="4272757">(</span><span class="ident" id="4272758"><a href="/crypto/dsa/dsa.go.html#4271336">numMRTests</a></span><span class="op" id="4272768">)</span>&nbsp;<span class="op" id="4272770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272776">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272794"><a href="/crypto/dsa/dsa.go.html#4271515">params</a></span><span class="op" id="4272800">.</span><span class="ident" id="4272801">P</span>&nbsp;<span class="op" id="4272803">=</span>&nbsp;<span class="ident" id="4272805"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272810"><a href="/crypto/dsa/dsa.go.html#4271515">params</a></span><span class="op" id="4272816">.</span><span class="ident" id="4272817">Q</span>&nbsp;<span class="op" id="4272819">=</span>&nbsp;<span class="ident" id="4272821"><a href="/crypto/dsa/dsa.go.html#4272147">q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272826">break</span>&nbsp;<span class="ident" id="4272832">GeneratePrimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272856">h</span>&nbsp;<span class="op" id="4272858">:=</span>&nbsp;<span class="builtinfunc" id="4272861">new</span><span class="op" id="4272864">(</span><span class="ident" id="4272865"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272868">.</span><span class="ident" id="4272869">Int</span><span class="op" id="4272872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272875"><a href="/crypto/dsa/dsa.go.html#4272856">h</a></span><span class="op" id="4272876">.</span><span class="ident" id="4272877">SetInt64</span><span class="op" id="4272885">(</span><span class="num" id="4272886">2</span><span class="op" id="4272887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272890">g</span>&nbsp;<span class="op" id="4272892">:=</span>&nbsp;<span class="builtinfunc" id="4272895">new</span><span class="op" id="4272898">(</span><span class="ident" id="4272899"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272902">.</span><span class="ident" id="4272903">Int</span><span class="op" id="4272906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272910">pm1</span>&nbsp;<span class="op" id="4272914">:=</span>&nbsp;<span class="builtinfunc" id="4272917">new</span><span class="op" id="4272920">(</span><span class="ident" id="4272921"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272924">.</span><span class="ident" id="4272925">Int</span><span class="op" id="4272928">)</span><span class="op" id="4272929">.</span><span class="ident" id="4272930">Sub</span><span class="op" id="4272933">(</span><span class="ident" id="4272934"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272935">,</span>&nbsp;<span class="ident" id="4272937"><a href="/crypto/dsa/dsa.go.html#4272206">one</a></span><span class="op" id="4272940">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272943">e</span>&nbsp;<span class="op" id="4272945">:=</span>&nbsp;<span class="builtinfunc" id="4272948">new</span><span class="op" id="4272951">(</span><span class="ident" id="4272952"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4272955">.</span><span class="ident" id="4272956">Int</span><span class="op" id="4272959">)</span><span class="op" id="4272960">.</span><span class="ident" id="4272961">Div</span><span class="op" id="4272964">(</span><span class="ident" id="4272965"><a href="/crypto/dsa/dsa.go.html#4272910">pm1</a></span><span class="op" id="4272968">,</span>&nbsp;<span class="ident" id="4272970"><a href="/crypto/dsa/dsa.go.html#4272147">q</a></span><span class="op" id="4272971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272975">for</span>&nbsp;<span class="op" id="4272979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272983"><a href="/crypto/dsa/dsa.go.html#4272890">g</a></span><span class="op" id="4272984">.</span><span class="ident" id="4272985">Exp</span><span class="op" id="4272988">(</span><span class="ident" id="4272989"><a href="/crypto/dsa/dsa.go.html#4272856">h</a></span><span class="op" id="4272990">,</span>&nbsp;<span class="ident" id="4272992"><a href="/crypto/dsa/dsa.go.html#4272943">e</a></span><span class="op" id="4272993">,</span>&nbsp;<span class="ident" id="4272995"><a href="/crypto/dsa/dsa.go.html#4272166">p</a></span><span class="op" id="4272996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273000">if</span>&nbsp;<span class="ident" id="4273003"><a href="/crypto/dsa/dsa.go.html#4272890">g</a></span><span class="op" id="4273004">.</span><span class="ident" id="4273005">Cmp</span><span class="op" id="4273008">(</span><span class="ident" id="4273009"><a href="/crypto/dsa/dsa.go.html#4272206">one</a></span><span class="op" id="4273012">)</span>&nbsp;<span class="op" id="4273014">==</span>&nbsp;<span class="num" id="4273017">0</span>&nbsp;<span class="op" id="4273019">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273024"><a href="/crypto/dsa/dsa.go.html#4272856">h</a></span><span class="op" id="4273025">.</span><span class="ident" id="4273026">Add</span><span class="op" id="4273029">(</span><span class="ident" id="4273030"><a href="/crypto/dsa/dsa.go.html#4272856">h</a></span><span class="op" id="4273031">,</span>&nbsp;<span class="ident" id="4273033"><a href="/crypto/dsa/dsa.go.html#4272206">one</a></span><span class="op" id="4273036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273041">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273057"><a href="/crypto/dsa/dsa.go.html#4271515">params</a></span><span class="op" id="4273063">.</span><span class="ident" id="4273064">G</span>&nbsp;<span class="op" id="4273066">=</span>&nbsp;<span class="ident" id="4273068"><a href="/crypto/dsa/dsa.go.html#4272890">g</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273080">}</span><br>
<span class="lineno"></span><span class="op" id="4273082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4273085">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&amp;private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;Parameters&nbsp;of&nbsp;the</span><br>
<span class="lineno">150</span><span class="comment" id="4273159">//&nbsp;PrivateKey&nbsp;must&nbsp;already&nbsp;be&nbsp;valid&nbsp;(see&nbsp;GenerateParameters).</span><br>
<span class="lineno"></span><span class="keyword" id="4273221">func</span>&nbsp;<span class="ident" id="4273226">GenerateKey</span><span class="op" id="4273237">(</span><span class="ident" id="4273238">priv</span>&nbsp;<span class="op" id="4273243">*</span><span class="ident" id="4273244"><a href="/crypto/dsa/dsa.go.html#4270559">PrivateKey</a></span><span class="op" id="4273254">,</span>&nbsp;<span class="ident" id="4273256">rand</span>&nbsp;<span class="ident" id="4273261"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4273263">.</span><span class="ident" id="4273264">Reader</span><span class="op" id="4273270">)</span>&nbsp;<span class="builtintype" id="4273272">error</span>&nbsp;<span class="op" id="4273278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273281">if</span>&nbsp;<span class="ident" id="4273284"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273288">.</span><span class="ident" id="4273289">P</span>&nbsp;<span class="op" id="4273291">==</span>&nbsp;<span class="ident" id="4273294">nil</span>&nbsp;<span class="op" id="4273298">||</span>&nbsp;<span class="ident" id="4273301"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273305">.</span><span class="ident" id="4273306">Q</span>&nbsp;<span class="op" id="4273308">==</span>&nbsp;<span class="ident" id="4273311">nil</span>&nbsp;<span class="op" id="4273315">||</span>&nbsp;<span class="ident" id="4273318"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273322">.</span><span class="ident" id="4273323">G</span>&nbsp;<span class="op" id="4273325">==</span>&nbsp;<span class="ident" id="4273328">nil</span>&nbsp;<span class="op" id="4273332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273336">return</span>&nbsp;<span class="ident" id="4273343"><a href="/crypto/dsa/dsa.go.html#4270186">errors</a></span><span class="op" id="4273349">.</span><span class="ident" id="4273350">New</span><span class="op" id="4273353">(</span><span class="string" id="4273354">&#34;crypto/dsa:&nbsp;parameters&nbsp;not&nbsp;set&nbsp;up&nbsp;before&nbsp;generating&nbsp;key&#34;</span><span class="op" id="4273411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273414">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273418">x</span>&nbsp;<span class="op" id="4273420">:=</span>&nbsp;<span class="builtinfunc" id="4273423">new</span><span class="op" id="4273426">(</span><span class="ident" id="4273427"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4273430">.</span><span class="ident" id="4273431">Int</span><span class="op" id="4273434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273437">xBytes</span>&nbsp;<span class="op" id="4273444">:=</span>&nbsp;<span class="builtinfunc" id="4273447">make</span><span class="op" id="4273451">(</span><span class="op" id="4273452">[</span><span class="op" id="4273453">]</span><span class="builtintype" id="4273454">byte</span><span class="op" id="4273458">,</span>&nbsp;<span class="ident" id="4273460"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273464">.</span><span class="ident" id="4273465">Q</span><span class="op" id="4273466">.</span><span class="ident" id="4273467">BitLen</span><span class="op" id="4273473">(</span><span class="op" id="4273474">)</span><span class="op" id="4273475">/</span><span class="num" id="4273476">8</span><span class="op" id="4273477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273481">for</span>&nbsp;<span class="op" id="4273485">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273489">_</span><span class="op" id="4273490">,</span>&nbsp;<span class="ident" id="4273492">err</span>&nbsp;<span class="op" id="4273496">:=</span>&nbsp;<span class="ident" id="4273499"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4273501">.</span><span class="ident" id="4273502">ReadFull</span><span class="op" id="4273510">(</span><span class="ident" id="4273511"><a href="/crypto/dsa/dsa.go.html#4273256">rand</a></span><span class="op" id="4273515">,</span>&nbsp;<span class="ident" id="4273517"><a href="/crypto/dsa/dsa.go.html#4273437">xBytes</a></span><span class="op" id="4273523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273527">if</span>&nbsp;<span class="ident" id="4273530"><a href="/crypto/dsa/dsa.go.html#4273492">err</a></span>&nbsp;<span class="op" id="4273534">!=</span>&nbsp;<span class="ident" id="4273537">nil</span>&nbsp;<span class="op" id="4273541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273546">return</span>&nbsp;<span class="ident" id="4273553"><a href="/crypto/dsa/dsa.go.html#4273492">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273563"><a href="/crypto/dsa/dsa.go.html#4273418">x</a></span><span class="op" id="4273564">.</span><span class="ident" id="4273565">SetBytes</span><span class="op" id="4273573">(</span><span class="ident" id="4273574"><a href="/crypto/dsa/dsa.go.html#4273437">xBytes</a></span><span class="op" id="4273580">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273584">if</span>&nbsp;<span class="ident" id="4273587"><a href="/crypto/dsa/dsa.go.html#4273418">x</a></span><span class="op" id="4273588">.</span><span class="ident" id="4273589">Sign</span><span class="op" id="4273593">(</span><span class="op" id="4273594">)</span>&nbsp;<span class="op" id="4273596">!=</span>&nbsp;<span class="num" id="4273599">0</span>&nbsp;<span class="op" id="4273601">&amp;&amp;</span>&nbsp;<span class="ident" id="4273604"><a href="/crypto/dsa/dsa.go.html#4273418">x</a></span><span class="op" id="4273605">.</span><span class="ident" id="4273606">Cmp</span><span class="op" id="4273609">(</span><span class="ident" id="4273610"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273614">.</span><span class="ident" id="4273615">Q</span><span class="op" id="4273616">)</span>&nbsp;<span class="op" id="4273618">&lt;</span>&nbsp;<span class="num" id="4273620">0</span>&nbsp;<span class="op" id="4273622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273627">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273642"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273646">.</span><span class="ident" id="4273647">X</span>&nbsp;<span class="op" id="4273649">=</span>&nbsp;<span class="ident" id="4273651"><a href="/crypto/dsa/dsa.go.html#4273418">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273654"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273658">.</span><span class="ident" id="4273659">Y</span>&nbsp;<span class="op" id="4273661">=</span>&nbsp;<span class="builtinfunc" id="4273663">new</span><span class="op" id="4273666">(</span><span class="ident" id="4273667"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4273670">.</span><span class="ident" id="4273671">Int</span><span class="op" id="4273674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273677"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273681">.</span><span class="ident" id="4273682">Y</span><span class="op" id="4273683">.</span><span class="ident" id="4273684">Exp</span><span class="op" id="4273687">(</span><span class="ident" id="4273688"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273692">.</span><span class="ident" id="4273693">G</span><span class="op" id="4273694">,</span>&nbsp;<span class="ident" id="4273696"><a href="/crypto/dsa/dsa.go.html#4273418">x</a></span><span class="op" id="4273697">,</span>&nbsp;<span class="ident" id="4273699"><a href="/crypto/dsa/dsa.go.html#4273238">priv</a></span><span class="op" id="4273703">.</span><span class="ident" id="4273704">P</span><span class="op" id="4273705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273708">return</span>&nbsp;<span class="ident" id="4273715">nil</span><br>
<span class="lineno"></span><span class="op" id="4273719">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4273722">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="4273799">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="4273877">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4273948">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">180</span><span class="keyword" id="4273986">func</span>&nbsp;<span class="ident" id="4273991">fermatInverse</span><span class="op" id="4274004">(</span><span class="ident" id="4274005">k</span><span class="op" id="4274006">,</span>&nbsp;<span class="ident" id="4274008">P</span>&nbsp;<span class="op" id="4274010">*</span><span class="ident" id="4274011"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274014">.</span><span class="ident" id="4274015">Int</span><span class="op" id="4274018">)</span>&nbsp;<span class="op" id="4274020">*</span><span class="ident" id="4274021"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274024">.</span><span class="ident" id="4274025">Int</span>&nbsp;<span class="op" id="4274029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274032">two</span>&nbsp;<span class="op" id="4274036">:=</span>&nbsp;<span class="ident" id="4274039"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274042">.</span><span class="ident" id="4274043">NewInt</span><span class="op" id="4274049">(</span><span class="num" id="4274050">2</span><span class="op" id="4274051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274054">pMinus2</span>&nbsp;<span class="op" id="4274062">:=</span>&nbsp;<span class="builtinfunc" id="4274065">new</span><span class="op" id="4274068">(</span><span class="ident" id="4274069"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274072">.</span><span class="ident" id="4274073">Int</span><span class="op" id="4274076">)</span><span class="op" id="4274077">.</span><span class="ident" id="4274078">Sub</span><span class="op" id="4274081">(</span><span class="ident" id="4274082"><a href="/crypto/dsa/dsa.go.html#4274008">P</a></span><span class="op" id="4274083">,</span>&nbsp;<span class="ident" id="4274085"><a href="/crypto/dsa/dsa.go.html#4274032">two</a></span><span class="op" id="4274088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274091">return</span>&nbsp;<span class="builtinfunc" id="4274098">new</span><span class="op" id="4274101">(</span><span class="ident" id="4274102"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274105">.</span><span class="ident" id="4274106">Int</span><span class="op" id="4274109">)</span><span class="op" id="4274110">.</span><span class="ident" id="4274111">Exp</span><span class="op" id="4274114">(</span><span class="ident" id="4274115"><a href="/crypto/dsa/dsa.go.html#4274005">k</a></span><span class="op" id="4274116">,</span>&nbsp;<span class="ident" id="4274118"><a href="/crypto/dsa/dsa.go.html#4274054">pMinus2</a></span><span class="op" id="4274125">,</span>&nbsp;<span class="ident" id="4274127"><a href="/crypto/dsa/dsa.go.html#4274008">P</a></span><span class="op" id="4274128">)</span><br>
<span class="lineno"></span><span class="op" id="4274130">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="comment" id="4274133">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4274213">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4274291">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4274370">//&nbsp;rand.</span><br>
<span class="lineno">190</span><span class="comment" id="4274379">//</span><br>
<span class="lineno"></span><span class="comment" id="4274382">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="4274462">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4274537">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4274559">func</span>&nbsp;<span class="ident" id="4274564">Sign</span><span class="op" id="4274568">(</span><span class="ident" id="4274569">rand</span>&nbsp;<span class="ident" id="4274574"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4274576">.</span><span class="ident" id="4274577">Reader</span><span class="op" id="4274583">,</span>&nbsp;<span class="ident" id="4274585">priv</span>&nbsp;<span class="op" id="4274590">*</span><span class="ident" id="4274591"><a href="/crypto/dsa/dsa.go.html#4270559">PrivateKey</a></span><span class="op" id="4274601">,</span>&nbsp;<span class="ident" id="4274603">hash</span>&nbsp;<span class="op" id="4274608">[</span><span class="op" id="4274609">]</span><span class="builtintype" id="4274610">byte</span><span class="op" id="4274614">)</span>&nbsp;<span class="op" id="4274616">(</span><span class="ident" id="4274617">r</span><span class="op" id="4274618">,</span>&nbsp;<span class="ident" id="4274620">s</span>&nbsp;<span class="op" id="4274622">*</span><span class="ident" id="4274623"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274626">.</span><span class="ident" id="4274627">Int</span><span class="op" id="4274630">,</span>&nbsp;<span class="ident" id="4274632">err</span>&nbsp;<span class="builtintype" id="4274636">error</span><span class="op" id="4274641">)</span>&nbsp;<span class="op" id="4274643">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4274646">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274675">n</span>&nbsp;<span class="op" id="4274677">:=</span>&nbsp;<span class="ident" id="4274680"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4274684">.</span><span class="ident" id="4274685">Q</span><span class="op" id="4274686">.</span><span class="ident" id="4274687">BitLen</span><span class="op" id="4274693">(</span><span class="op" id="4274694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274697">if</span>&nbsp;<span class="ident" id="4274700"><a href="/crypto/dsa/dsa.go.html#4274675">n</a></span><span class="op" id="4274701">&amp;</span><span class="num" id="4274702">7</span>&nbsp;<span class="op" id="4274704">!=</span>&nbsp;<span class="num" id="4274707">0</span>&nbsp;<span class="op" id="4274709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274713"><a href="/crypto/dsa/dsa.go.html#4274632">err</a></span>&nbsp;<span class="op" id="4274717">=</span>&nbsp;<span class="ident" id="4274719"><a href="/crypto/dsa/dsa.go.html#4270872">ErrInvalidPublicKey</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274752"><a href="/crypto/dsa/dsa.go.html#4274675">n</a></span>&nbsp;<span class="op" id="4274754">&gt;&gt;=</span>&nbsp;<span class="num" id="4274758">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274762">for</span>&nbsp;<span class="op" id="4274766">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274770">k</span>&nbsp;<span class="op" id="4274772">:=</span>&nbsp;<span class="builtinfunc" id="4274775">new</span><span class="op" id="4274778">(</span><span class="ident" id="4274779"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4274782">.</span><span class="ident" id="4274783">Int</span><span class="op" id="4274786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274790">buf</span>&nbsp;<span class="op" id="4274794">:=</span>&nbsp;<span class="builtinfunc" id="4274797">make</span><span class="op" id="4274801">(</span><span class="op" id="4274802">[</span><span class="op" id="4274803">]</span><span class="builtintype" id="4274804">byte</span><span class="op" id="4274808">,</span>&nbsp;<span class="ident" id="4274810"><a href="/crypto/dsa/dsa.go.html#4274675">n</a></span><span class="op" id="4274811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274815">for</span>&nbsp;<span class="op" id="4274819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274824">_</span><span class="op" id="4274825">,</span>&nbsp;<span class="ident" id="4274827"><a href="/crypto/dsa/dsa.go.html#4274632">err</a></span>&nbsp;<span class="op" id="4274831">=</span>&nbsp;<span class="ident" id="4274833"><a href="/crypto/dsa/dsa.go.html#4270196">io</a></span><span class="op" id="4274835">.</span><span class="ident" id="4274836">ReadFull</span><span class="op" id="4274844">(</span><span class="ident" id="4274845"><a href="/crypto/dsa/dsa.go.html#4274569">rand</a></span><span class="op" id="4274849">,</span>&nbsp;<span class="ident" id="4274851"><a href="/crypto/dsa/dsa.go.html#4274790">buf</a></span><span class="op" id="4274854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274859">if</span>&nbsp;<span class="ident" id="4274862"><a href="/crypto/dsa/dsa.go.html#4274632">err</a></span>&nbsp;<span class="op" id="4274866">!=</span>&nbsp;<span class="ident" id="4274869">nil</span>&nbsp;<span class="op" id="4274873">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274879">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274894"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4274895">.</span><span class="ident" id="4274896">SetBytes</span><span class="op" id="4274904">(</span><span class="ident" id="4274905"><a href="/crypto/dsa/dsa.go.html#4274790">buf</a></span><span class="op" id="4274908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274913">if</span>&nbsp;<span class="ident" id="4274916"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4274917">.</span><span class="ident" id="4274918">Sign</span><span class="op" id="4274922">(</span><span class="op" id="4274923">)</span>&nbsp;<span class="op" id="4274925">&gt;</span>&nbsp;<span class="num" id="4274927">0</span>&nbsp;<span class="op" id="4274929">&amp;&amp;</span>&nbsp;<span class="ident" id="4274932"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4274933">.</span><span class="ident" id="4274934">Cmp</span><span class="op" id="4274937">(</span><span class="ident" id="4274938"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4274942">.</span><span class="ident" id="4274943">Q</span><span class="op" id="4274944">)</span>&nbsp;<span class="op" id="4274946">&lt;</span>&nbsp;<span class="num" id="4274948">0</span>&nbsp;<span class="op" id="4274950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274956">break</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274974">kInv</span>&nbsp;<span class="op" id="4274979">:=</span>&nbsp;<span class="ident" id="4274982"><a href="/crypto/dsa/dsa.go.html#4273991">fermatInverse</a></span><span class="op" id="4274995">(</span><span class="ident" id="4274996"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4274997">,</span>&nbsp;<span class="ident" id="4274999"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275003">.</span><span class="ident" id="4275004">Q</span><span class="op" id="4275005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275010"><a href="/crypto/dsa/dsa.go.html#4274617">r</a></span>&nbsp;<span class="op" id="4275012">=</span>&nbsp;<span class="builtinfunc" id="4275014">new</span><span class="op" id="4275017">(</span><span class="ident" id="4275018"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275021">.</span><span class="ident" id="4275022">Int</span><span class="op" id="4275025">)</span><span class="op" id="4275026">.</span><span class="ident" id="4275027">Exp</span><span class="op" id="4275030">(</span><span class="ident" id="4275031"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275035">.</span><span class="ident" id="4275036">G</span><span class="op" id="4275037">,</span>&nbsp;<span class="ident" id="4275039"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4275040">,</span>&nbsp;<span class="ident" id="4275042"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275046">.</span><span class="ident" id="4275047">P</span><span class="op" id="4275048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275052"><a href="/crypto/dsa/dsa.go.html#4274617">r</a></span><span class="op" id="4275053">.</span><span class="ident" id="4275054">Mod</span><span class="op" id="4275057">(</span><span class="ident" id="4275058"><a href="/crypto/dsa/dsa.go.html#4274617">r</a></span><span class="op" id="4275059">,</span>&nbsp;<span class="ident" id="4275061"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275065">.</span><span class="ident" id="4275066">Q</span><span class="op" id="4275067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275072">if</span>&nbsp;<span class="ident" id="4275075"><a href="/crypto/dsa/dsa.go.html#4274617">r</a></span><span class="op" id="4275076">.</span><span class="ident" id="4275077">Sign</span><span class="op" id="4275081">(</span><span class="op" id="4275082">)</span>&nbsp;<span class="op" id="4275084">==</span>&nbsp;<span class="num" id="4275087">0</span>&nbsp;<span class="op" id="4275089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275094">continue</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275110">z</span>&nbsp;<span class="op" id="4275112">:=</span>&nbsp;<span class="ident" id="4275115"><a href="/crypto/dsa/dsa.go.html#4274770">k</a></span><span class="op" id="4275116">.</span><span class="ident" id="4275117">SetBytes</span><span class="op" id="4275125">(</span><span class="ident" id="4275126"><a href="/crypto/dsa/dsa.go.html#4274603">hash</a></span><span class="op" id="4275130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275135"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span>&nbsp;<span class="op" id="4275137">=</span>&nbsp;<span class="builtinfunc" id="4275139">new</span><span class="op" id="4275142">(</span><span class="ident" id="4275143"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275146">.</span><span class="ident" id="4275147">Int</span><span class="op" id="4275150">)</span><span class="op" id="4275151">.</span><span class="ident" id="4275152">Mul</span><span class="op" id="4275155">(</span><span class="ident" id="4275156"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275160">.</span><span class="ident" id="4275161">X</span><span class="op" id="4275162">,</span>&nbsp;<span class="ident" id="4275164"><a href="/crypto/dsa/dsa.go.html#4274617">r</a></span><span class="op" id="4275165">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275169"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275170">.</span><span class="ident" id="4275171">Add</span><span class="op" id="4275174">(</span><span class="ident" id="4275175"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275176">,</span>&nbsp;<span class="ident" id="4275178"><a href="/crypto/dsa/dsa.go.html#4275110">z</a></span><span class="op" id="4275179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275183"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275184">.</span><span class="ident" id="4275185">Mod</span><span class="op" id="4275188">(</span><span class="ident" id="4275189"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275190">,</span>&nbsp;<span class="ident" id="4275192"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275196">.</span><span class="ident" id="4275197">Q</span><span class="op" id="4275198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275202"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275203">.</span><span class="ident" id="4275204">Mul</span><span class="op" id="4275207">(</span><span class="ident" id="4275208"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275209">,</span>&nbsp;<span class="ident" id="4275211"><a href="/crypto/dsa/dsa.go.html#4274974">kInv</a></span><span class="op" id="4275215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275219"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275220">.</span><span class="ident" id="4275221">Mod</span><span class="op" id="4275224">(</span><span class="ident" id="4275225"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275226">,</span>&nbsp;<span class="ident" id="4275228"><a href="/crypto/dsa/dsa.go.html#4274585">priv</a></span><span class="op" id="4275232">.</span><span class="ident" id="4275233">Q</span><span class="op" id="4275234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275239">if</span>&nbsp;<span class="ident" id="4275242"><a href="/crypto/dsa/dsa.go.html#4274620">s</a></span><span class="op" id="4275243">.</span><span class="ident" id="4275244">Sign</span><span class="op" id="4275248">(</span><span class="op" id="4275249">)</span>&nbsp;<span class="op" id="4275251">!=</span>&nbsp;<span class="num" id="4275254">0</span>&nbsp;<span class="op" id="4275256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275261">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275276">return</span><br>
<span class="lineno"></span><span class="op" id="4275283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4275286">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="4275365">//&nbsp;reports&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno">245</span><span class="comment" id="4275408">//</span><br>
<span class="lineno"></span><span class="comment" id="4275411">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="4275491">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4275566">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4275588">func</span>&nbsp;<span class="ident" id="4275593">Verify</span><span class="op" id="4275599">(</span><span class="ident" id="4275600">pub</span>&nbsp;<span class="op" id="4275604">*</span><span class="ident" id="4275605"><a href="/crypto/dsa/dsa.go.html#4270464">PublicKey</a></span><span class="op" id="4275614">,</span>&nbsp;<span class="ident" id="4275616">hash</span>&nbsp;<span class="op" id="4275621">[</span><span class="op" id="4275622">]</span><span class="builtintype" id="4275623">byte</span><span class="op" id="4275627">,</span>&nbsp;<span class="ident" id="4275629">r</span><span class="op" id="4275630">,</span>&nbsp;<span class="ident" id="4275632">s</span>&nbsp;<span class="op" id="4275634">*</span><span class="ident" id="4275635"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275638">.</span><span class="ident" id="4275639">Int</span><span class="op" id="4275642">)</span>&nbsp;<span class="builtintype" id="4275644">bool</span>&nbsp;<span class="op" id="4275649">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4275652">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275681">if</span>&nbsp;<span class="ident" id="4275684"><a href="/crypto/dsa/dsa.go.html#4275629">r</a></span><span class="op" id="4275685">.</span><span class="ident" id="4275686">Sign</span><span class="op" id="4275690">(</span><span class="op" id="4275691">)</span>&nbsp;<span class="op" id="4275693">&lt;</span>&nbsp;<span class="num" id="4275695">1</span>&nbsp;<span class="op" id="4275697">||</span>&nbsp;<span class="ident" id="4275700"><a href="/crypto/dsa/dsa.go.html#4275629">r</a></span><span class="op" id="4275701">.</span><span class="ident" id="4275702">Cmp</span><span class="op" id="4275705">(</span><span class="ident" id="4275706"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4275709">.</span><span class="ident" id="4275710">Q</span><span class="op" id="4275711">)</span>&nbsp;<span class="op" id="4275713">&gt;=</span>&nbsp;<span class="num" id="4275716">0</span>&nbsp;<span class="op" id="4275718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275722">return</span>&nbsp;<span class="builtintype" id="4275729">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275736">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275739">if</span>&nbsp;<span class="ident" id="4275742"><a href="/crypto/dsa/dsa.go.html#4275632">s</a></span><span class="op" id="4275743">.</span><span class="ident" id="4275744">Sign</span><span class="op" id="4275748">(</span><span class="op" id="4275749">)</span>&nbsp;<span class="op" id="4275751">&lt;</span>&nbsp;<span class="num" id="4275753">1</span>&nbsp;<span class="op" id="4275755">||</span>&nbsp;<span class="ident" id="4275758"><a href="/crypto/dsa/dsa.go.html#4275632">s</a></span><span class="op" id="4275759">.</span><span class="ident" id="4275760">Cmp</span><span class="op" id="4275763">(</span><span class="ident" id="4275764"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4275767">.</span><span class="ident" id="4275768">Q</span><span class="op" id="4275769">)</span>&nbsp;<span class="op" id="4275771">&gt;=</span>&nbsp;<span class="num" id="4275774">0</span>&nbsp;<span class="op" id="4275776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275780">return</span>&nbsp;<span class="builtintype" id="4275787">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275798">w</span>&nbsp;<span class="op" id="4275800">:=</span>&nbsp;<span class="builtinfunc" id="4275803">new</span><span class="op" id="4275806">(</span><span class="ident" id="4275807"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275810">.</span><span class="ident" id="4275811">Int</span><span class="op" id="4275814">)</span><span class="op" id="4275815">.</span><span class="ident" id="4275816">ModInverse</span><span class="op" id="4275826">(</span><span class="ident" id="4275827"><a href="/crypto/dsa/dsa.go.html#4275632">s</a></span><span class="op" id="4275828">,</span>&nbsp;<span class="ident" id="4275830"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4275833">.</span><span class="ident" id="4275834">Q</span><span class="op" id="4275835">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275839">n</span>&nbsp;<span class="op" id="4275841">:=</span>&nbsp;<span class="ident" id="4275844"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4275847">.</span><span class="ident" id="4275848">Q</span><span class="op" id="4275849">.</span><span class="ident" id="4275850">BitLen</span><span class="op" id="4275856">(</span><span class="op" id="4275857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275860">if</span>&nbsp;<span class="ident" id="4275863"><a href="/crypto/dsa/dsa.go.html#4275839">n</a></span><span class="op" id="4275864">&amp;</span><span class="num" id="4275865">7</span>&nbsp;<span class="op" id="4275867">!=</span>&nbsp;<span class="num" id="4275870">0</span>&nbsp;<span class="op" id="4275872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275876">return</span>&nbsp;<span class="builtintype" id="4275883">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275890">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275893">z</span>&nbsp;<span class="op" id="4275895">:=</span>&nbsp;<span class="builtinfunc" id="4275898">new</span><span class="op" id="4275901">(</span><span class="ident" id="4275902"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275905">.</span><span class="ident" id="4275906">Int</span><span class="op" id="4275909">)</span><span class="op" id="4275910">.</span><span class="ident" id="4275911">SetBytes</span><span class="op" id="4275919">(</span><span class="ident" id="4275920"><a href="/crypto/dsa/dsa.go.html#4275616">hash</a></span><span class="op" id="4275924">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275928">u1</span>&nbsp;<span class="op" id="4275931">:=</span>&nbsp;<span class="builtinfunc" id="4275934">new</span><span class="op" id="4275937">(</span><span class="ident" id="4275938"><a href="/crypto/dsa/dsa.go.html#4270202">big</a></span><span class="op" id="4275941">.</span><span class="ident" id="4275942">Int</span><span class="op" id="4275945">)</span><span class="op" id="4275946">.</span><span class="ident" id="4275947">Mul</span><span class="op" id="4275950">(</span><span class="ident" id="4275951"><a href="/crypto/dsa/dsa.go.html#4275893">z</a></span><span class="op" id="4275952">,</span>&nbsp;<span class="ident" id="4275954"><a href="/crypto/dsa/dsa.go.html#4275798">w</a></span><span class="op" id="4275955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275958"><a href="/crypto/dsa/dsa.go.html#4275928">u1</a></span><span class="op" id="4275960">.</span><span class="ident" id="4275961">Mod</span><span class="op" id="4275964">(</span><span class="ident" id="4275965"><a href="/crypto/dsa/dsa.go.html#4275928">u1</a></span><span class="op" id="4275967">,</span>&nbsp;<span class="ident" id="4275969"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4275972">.</span><span class="ident" id="4275973">Q</span><span class="op" id="4275974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275977">u2</span>&nbsp;<span class="op" id="4275980">:=</span>&nbsp;<span class="ident" id="4275983"><a href="/crypto/dsa/dsa.go.html#4275798">w</a></span><span class="op" id="4275984">.</span><span class="ident" id="4275985">Mul</span><span class="op" id="4275988">(</span><span class="ident" id="4275989"><a href="/crypto/dsa/dsa.go.html#4275629">r</a></span><span class="op" id="4275990">,</span>&nbsp;<span class="ident" id="4275992"><a href="/crypto/dsa/dsa.go.html#4275798">w</a></span><span class="op" id="4275993">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275996"><a href="/crypto/dsa/dsa.go.html#4275977">u2</a></span><span class="op" id="4275998">.</span><span class="ident" id="4275999">Mod</span><span class="op" id="4276002">(</span><span class="ident" id="4276003"><a href="/crypto/dsa/dsa.go.html#4275977">u2</a></span><span class="op" id="4276005">,</span>&nbsp;<span class="ident" id="4276007"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276010">.</span><span class="ident" id="4276011">Q</span><span class="op" id="4276012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276015">v</span>&nbsp;<span class="op" id="4276017">:=</span>&nbsp;<span class="ident" id="4276020"><a href="/crypto/dsa/dsa.go.html#4275928">u1</a></span><span class="op" id="4276022">.</span><span class="ident" id="4276023">Exp</span><span class="op" id="4276026">(</span><span class="ident" id="4276027"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276030">.</span><span class="ident" id="4276031">G</span><span class="op" id="4276032">,</span>&nbsp;<span class="ident" id="4276034"><a href="/crypto/dsa/dsa.go.html#4275928">u1</a></span><span class="op" id="4276036">,</span>&nbsp;<span class="ident" id="4276038"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276041">.</span><span class="ident" id="4276042">P</span><span class="op" id="4276043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276046"><a href="/crypto/dsa/dsa.go.html#4275977">u2</a></span><span class="op" id="4276048">.</span><span class="ident" id="4276049">Exp</span><span class="op" id="4276052">(</span><span class="ident" id="4276053"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276056">.</span><span class="ident" id="4276057">Y</span><span class="op" id="4276058">,</span>&nbsp;<span class="ident" id="4276060"><a href="/crypto/dsa/dsa.go.html#4275977">u2</a></span><span class="op" id="4276062">,</span>&nbsp;<span class="ident" id="4276064"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276067">.</span><span class="ident" id="4276068">P</span><span class="op" id="4276069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276072"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276073">.</span><span class="ident" id="4276074">Mul</span><span class="op" id="4276077">(</span><span class="ident" id="4276078"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276079">,</span>&nbsp;<span class="ident" id="4276081"><a href="/crypto/dsa/dsa.go.html#4275977">u2</a></span><span class="op" id="4276083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276086"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276087">.</span><span class="ident" id="4276088">Mod</span><span class="op" id="4276091">(</span><span class="ident" id="4276092"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276093">,</span>&nbsp;<span class="ident" id="4276095"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276098">.</span><span class="ident" id="4276099">P</span><span class="op" id="4276100">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276103"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276104">.</span><span class="ident" id="4276105">Mod</span><span class="op" id="4276108">(</span><span class="ident" id="4276109"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276110">,</span>&nbsp;<span class="ident" id="4276112"><a href="/crypto/dsa/dsa.go.html#4275600">pub</a></span><span class="op" id="4276115">.</span><span class="ident" id="4276116">Q</span><span class="op" id="4276117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276121">return</span>&nbsp;<span class="ident" id="4276128"><a href="/crypto/dsa/dsa.go.html#4276015">v</a></span><span class="op" id="4276129">.</span><span class="ident" id="4276130">Cmp</span><span class="op" id="4276133">(</span><span class="ident" id="4276134"><a href="/crypto/dsa/dsa.go.html#4275629">r</a></span><span class="op" id="4276135">)</span>&nbsp;<span class="op" id="4276137">==</span>&nbsp;<span class="num" id="4276140">0</span><br>
<span class="lineno"></span><span class="op" id="4276142">}</span>
</div>
</body>
</html>
