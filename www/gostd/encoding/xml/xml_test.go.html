<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8278947">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8279003">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8279057">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8279108">package</span>&nbsp;<span class="ident" id="8279116">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8279121">import</span>&nbsp;<span class="op" id="8279128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279131">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279140">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279147">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279153">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279164">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279175">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279186">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8279201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8279204">const</span>&nbsp;<span class="ident" id="8279210">testInput</span>&nbsp;<span class="op" id="8279220">=</span>&nbsp;<span class="string" id="8279222">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="8279439">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8279442">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="8279451">+</span>&nbsp;<span class="string" id="8279453">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8279743">var</span>&nbsp;<span class="ident" id="8279747">testEntity</span>&nbsp;<span class="op" id="8279758">=</span>&nbsp;<span class="keyword" id="8279760">map</span><span class="op" id="8279763">[</span><span class="builtintype" id="8279764">string</span><span class="op" id="8279770">]</span><span class="builtintype" id="8279771">string</span><span class="op" id="8279777">{</span><span class="string" id="8279778">&#34;何&#34;</span><span class="op" id="8279783">:</span>&nbsp;<span class="string" id="8279785">&#34;What&#34;</span><span class="op" id="8279791">,</span>&nbsp;<span class="string" id="8279793">&#34;is-it&#34;</span><span class="op" id="8279800">:</span>&nbsp;<span class="string" id="8279802">&#34;is&nbsp;it?&#34;</span><span class="op" id="8279810">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8279813">var</span>&nbsp;<span class="ident" id="8279817">rawTokens</span>&nbsp;<span class="op" id="8279827">=</span>&nbsp;<span class="op" id="8279829">[</span><span class="op" id="8279830">]</span><span class="ident" id="8279831">Token</span><span class="op" id="8279836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8279839">CharData</span><span class="op" id="8279847">(</span><span class="string" id="8279848">&#34;\n&#34;</span><span class="op" id="8279852">)</span><span class="op" id="8279853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8279856">ProcInst</span><span class="op" id="8279864">{</span><span class="string" id="8279865">&#34;xml&#34;</span><span class="op" id="8279870">,</span>&nbsp;<span class="op" id="8279872">[</span><span class="op" id="8279873">]</span><span class="builtintype" id="8279874">byte</span><span class="op" id="8279878">(</span><span class="string" id="8279879">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8279911">)</span><span class="op" id="8279912">}</span><span class="op" id="8279913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8279916">CharData</span><span class="op" id="8279924">(</span><span class="string" id="8279925">&#34;\n&#34;</span><span class="op" id="8279929">)</span><span class="op" id="8279930">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8279933">Directive</span><span class="op" id="8279942">(</span><span class="string" id="8279943">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8280065">)</span><span class="op" id="8280066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280069">CharData</span><span class="op" id="8280077">(</span><span class="string" id="8280078">&#34;\n&#34;</span><span class="op" id="8280082">)</span><span class="op" id="8280083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280086">StartElement</span><span class="op" id="8280098">{</span><span class="ident" id="8280099">Name</span><span class="op" id="8280103">{</span><span class="string" id="8280104">&#34;&#34;</span><span class="op" id="8280106">,</span>&nbsp;<span class="string" id="8280108">&#34;body&#34;</span><span class="op" id="8280114">}</span><span class="op" id="8280115">,</span>&nbsp;<span class="op" id="8280117">[</span><span class="op" id="8280118">]</span><span class="ident" id="8280119">Attr</span><span class="op" id="8280123">{</span><span class="op" id="8280124">{</span><span class="ident" id="8280125">Name</span><span class="op" id="8280129">{</span><span class="string" id="8280130">&#34;xmlns&#34;</span><span class="op" id="8280137">,</span>&nbsp;<span class="string" id="8280139">&#34;foo&#34;</span><span class="op" id="8280144">}</span><span class="op" id="8280145">,</span>&nbsp;<span class="string" id="8280147">&#34;ns1&#34;</span><span class="op" id="8280152">}</span><span class="op" id="8280153">,</span>&nbsp;<span class="op" id="8280155">{</span><span class="ident" id="8280156">Name</span><span class="op" id="8280160">{</span><span class="string" id="8280161">&#34;&#34;</span><span class="op" id="8280163">,</span>&nbsp;<span class="string" id="8280165">&#34;xmlns&#34;</span><span class="op" id="8280172">}</span><span class="op" id="8280173">,</span>&nbsp;<span class="string" id="8280175">&#34;ns2&#34;</span><span class="op" id="8280180">}</span><span class="op" id="8280181">,</span>&nbsp;<span class="op" id="8280183">{</span><span class="ident" id="8280184">Name</span><span class="op" id="8280188">{</span><span class="string" id="8280189">&#34;xmlns&#34;</span><span class="op" id="8280196">,</span>&nbsp;<span class="string" id="8280198">&#34;tag&#34;</span><span class="op" id="8280203">}</span><span class="op" id="8280204">,</span>&nbsp;<span class="string" id="8280206">&#34;ns3&#34;</span><span class="op" id="8280211">}</span><span class="op" id="8280212">}</span><span class="op" id="8280213">}</span><span class="op" id="8280214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280217">CharData</span><span class="op" id="8280225">(</span><span class="string" id="8280226">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280232">)</span><span class="op" id="8280233">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280236">StartElement</span><span class="op" id="8280248">{</span><span class="ident" id="8280249">Name</span><span class="op" id="8280253">{</span><span class="string" id="8280254">&#34;&#34;</span><span class="op" id="8280256">,</span>&nbsp;<span class="string" id="8280258">&#34;hello&#34;</span><span class="op" id="8280265">}</span><span class="op" id="8280266">,</span>&nbsp;<span class="op" id="8280268">[</span><span class="op" id="8280269">]</span><span class="ident" id="8280270">Attr</span><span class="op" id="8280274">{</span><span class="op" id="8280275">{</span><span class="ident" id="8280276">Name</span><span class="op" id="8280280">{</span><span class="string" id="8280281">&#34;&#34;</span><span class="op" id="8280283">,</span>&nbsp;<span class="string" id="8280285">&#34;lang&#34;</span><span class="op" id="8280291">}</span><span class="op" id="8280292">,</span>&nbsp;<span class="string" id="8280294">&#34;en&#34;</span><span class="op" id="8280298">}</span><span class="op" id="8280299">}</span><span class="op" id="8280300">}</span><span class="op" id="8280301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280304">CharData</span><span class="op" id="8280312">(</span><span class="string" id="8280313">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8280336">)</span><span class="op" id="8280337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280340">EndElement</span><span class="op" id="8280350">{</span><span class="ident" id="8280351">Name</span><span class="op" id="8280355">{</span><span class="string" id="8280356">&#34;&#34;</span><span class="op" id="8280358">,</span>&nbsp;<span class="string" id="8280360">&#34;hello&#34;</span><span class="op" id="8280367">}</span><span class="op" id="8280368">}</span><span class="op" id="8280369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280372">CharData</span><span class="op" id="8280380">(</span><span class="string" id="8280381">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280387">)</span><span class="op" id="8280388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280391">StartElement</span><span class="op" id="8280403">{</span><span class="ident" id="8280404">Name</span><span class="op" id="8280408">{</span><span class="string" id="8280409">&#34;&#34;</span><span class="op" id="8280411">,</span>&nbsp;<span class="string" id="8280413">&#34;query&#34;</span><span class="op" id="8280420">}</span><span class="op" id="8280421">,</span>&nbsp;<span class="op" id="8280423">[</span><span class="op" id="8280424">]</span><span class="ident" id="8280425">Attr</span><span class="op" id="8280429">{</span><span class="op" id="8280430">}</span><span class="op" id="8280431">}</span><span class="op" id="8280432">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280435">CharData</span><span class="op" id="8280443">(</span><span class="string" id="8280444">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8280457">)</span><span class="op" id="8280458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280461">EndElement</span><span class="op" id="8280471">{</span><span class="ident" id="8280472">Name</span><span class="op" id="8280476">{</span><span class="string" id="8280477">&#34;&#34;</span><span class="op" id="8280479">,</span>&nbsp;<span class="string" id="8280481">&#34;query&#34;</span><span class="op" id="8280488">}</span><span class="op" id="8280489">}</span><span class="op" id="8280490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280493">CharData</span><span class="op" id="8280501">(</span><span class="string" id="8280502">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280508">)</span><span class="op" id="8280509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280512">StartElement</span><span class="op" id="8280524">{</span><span class="ident" id="8280525">Name</span><span class="op" id="8280529">{</span><span class="string" id="8280530">&#34;&#34;</span><span class="op" id="8280532">,</span>&nbsp;<span class="string" id="8280534">&#34;goodbye&#34;</span><span class="op" id="8280543">}</span><span class="op" id="8280544">,</span>&nbsp;<span class="op" id="8280546">[</span><span class="op" id="8280547">]</span><span class="ident" id="8280548">Attr</span><span class="op" id="8280552">{</span><span class="op" id="8280553">}</span><span class="op" id="8280554">}</span><span class="op" id="8280555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280558">EndElement</span><span class="op" id="8280568">{</span><span class="ident" id="8280569">Name</span><span class="op" id="8280573">{</span><span class="string" id="8280574">&#34;&#34;</span><span class="op" id="8280576">,</span>&nbsp;<span class="string" id="8280578">&#34;goodbye&#34;</span><span class="op" id="8280587">}</span><span class="op" id="8280588">}</span><span class="op" id="8280589">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280592">CharData</span><span class="op" id="8280600">(</span><span class="string" id="8280601">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280607">)</span><span class="op" id="8280608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280611">StartElement</span><span class="op" id="8280623">{</span><span class="ident" id="8280624">Name</span><span class="op" id="8280628">{</span><span class="string" id="8280629">&#34;&#34;</span><span class="op" id="8280631">,</span>&nbsp;<span class="string" id="8280633">&#34;outer&#34;</span><span class="op" id="8280640">}</span><span class="op" id="8280641">,</span>&nbsp;<span class="op" id="8280643">[</span><span class="op" id="8280644">]</span><span class="ident" id="8280645">Attr</span><span class="op" id="8280649">{</span><span class="op" id="8280650">{</span><span class="ident" id="8280651">Name</span><span class="op" id="8280655">{</span><span class="string" id="8280656">&#34;foo&#34;</span><span class="op" id="8280661">,</span>&nbsp;<span class="string" id="8280663">&#34;attr&#34;</span><span class="op" id="8280669">}</span><span class="op" id="8280670">,</span>&nbsp;<span class="string" id="8280672">&#34;value&#34;</span><span class="op" id="8280679">}</span><span class="op" id="8280680">,</span>&nbsp;<span class="op" id="8280682">{</span><span class="ident" id="8280683">Name</span><span class="op" id="8280687">{</span><span class="string" id="8280688">&#34;xmlns&#34;</span><span class="op" id="8280695">,</span>&nbsp;<span class="string" id="8280697">&#34;tag&#34;</span><span class="op" id="8280702">}</span><span class="op" id="8280703">,</span>&nbsp;<span class="string" id="8280705">&#34;ns4&#34;</span><span class="op" id="8280710">}</span><span class="op" id="8280711">}</span><span class="op" id="8280712">}</span><span class="op" id="8280713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280716">CharData</span><span class="op" id="8280724">(</span><span class="string" id="8280725">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8280733">)</span><span class="op" id="8280734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280737">StartElement</span><span class="op" id="8280749">{</span><span class="ident" id="8280750">Name</span><span class="op" id="8280754">{</span><span class="string" id="8280755">&#34;&#34;</span><span class="op" id="8280757">,</span>&nbsp;<span class="string" id="8280759">&#34;inner&#34;</span><span class="op" id="8280766">}</span><span class="op" id="8280767">,</span>&nbsp;<span class="op" id="8280769">[</span><span class="op" id="8280770">]</span><span class="ident" id="8280771">Attr</span><span class="op" id="8280775">{</span><span class="op" id="8280776">}</span><span class="op" id="8280777">}</span><span class="op" id="8280778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280781">EndElement</span><span class="op" id="8280791">{</span><span class="ident" id="8280792">Name</span><span class="op" id="8280796">{</span><span class="string" id="8280797">&#34;&#34;</span><span class="op" id="8280799">,</span>&nbsp;<span class="string" id="8280801">&#34;inner&#34;</span><span class="op" id="8280808">}</span><span class="op" id="8280809">}</span><span class="op" id="8280810">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280813">CharData</span><span class="op" id="8280821">(</span><span class="string" id="8280822">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280828">)</span><span class="op" id="8280829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280832">EndElement</span><span class="op" id="8280842">{</span><span class="ident" id="8280843">Name</span><span class="op" id="8280847">{</span><span class="string" id="8280848">&#34;&#34;</span><span class="op" id="8280850">,</span>&nbsp;<span class="string" id="8280852">&#34;outer&#34;</span><span class="op" id="8280859">}</span><span class="op" id="8280860">}</span><span class="op" id="8280861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280864">CharData</span><span class="op" id="8280872">(</span><span class="string" id="8280873">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280879">)</span><span class="op" id="8280880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280883">StartElement</span><span class="op" id="8280895">{</span><span class="ident" id="8280896">Name</span><span class="op" id="8280900">{</span><span class="string" id="8280901">&#34;tag&#34;</span><span class="op" id="8280906">,</span>&nbsp;<span class="string" id="8280908">&#34;name&#34;</span><span class="op" id="8280914">}</span><span class="op" id="8280915">,</span>&nbsp;<span class="op" id="8280917">[</span><span class="op" id="8280918">]</span><span class="ident" id="8280919">Attr</span><span class="op" id="8280923">{</span><span class="op" id="8280924">}</span><span class="op" id="8280925">}</span><span class="op" id="8280926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280929">CharData</span><span class="op" id="8280937">(</span><span class="string" id="8280938">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8280946">)</span><span class="op" id="8280947">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280950">CharData</span><span class="op" id="8280958">(</span><span class="string" id="8280959">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8280976">)</span><span class="op" id="8280977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280980">CharData</span><span class="op" id="8280988">(</span><span class="string" id="8280989">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8280995">)</span><span class="op" id="8280996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8280999">EndElement</span><span class="op" id="8281009">{</span><span class="ident" id="8281010">Name</span><span class="op" id="8281014">{</span><span class="string" id="8281015">&#34;tag&#34;</span><span class="op" id="8281020">,</span>&nbsp;<span class="string" id="8281022">&#34;name&#34;</span><span class="op" id="8281028">}</span><span class="op" id="8281029">}</span><span class="op" id="8281030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281033">CharData</span><span class="op" id="8281041">(</span><span class="string" id="8281042">&#34;\n&#34;</span><span class="op" id="8281046">)</span><span class="op" id="8281047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281050">EndElement</span><span class="op" id="8281060">{</span><span class="ident" id="8281061">Name</span><span class="op" id="8281065">{</span><span class="string" id="8281066">&#34;&#34;</span><span class="op" id="8281068">,</span>&nbsp;<span class="string" id="8281070">&#34;body&#34;</span><span class="op" id="8281076">}</span><span class="op" id="8281077">}</span><span class="op" id="8281078">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281081">Comment</span><span class="op" id="8281088">(</span><span class="string" id="8281089">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8281114">)</span><span class="op" id="8281115">,</span><br>
<span class="lineno"></span><span class="op" id="8281117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8281120">var</span>&nbsp;<span class="ident" id="8281124">cookedTokens</span>&nbsp;<span class="op" id="8281137">=</span>&nbsp;<span class="op" id="8281139">[</span><span class="op" id="8281140">]</span><span class="ident" id="8281141">Token</span><span class="op" id="8281146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281149">CharData</span><span class="op" id="8281157">(</span><span class="string" id="8281158">&#34;\n&#34;</span><span class="op" id="8281162">)</span><span class="op" id="8281163">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281166">ProcInst</span><span class="op" id="8281174">{</span><span class="string" id="8281175">&#34;xml&#34;</span><span class="op" id="8281180">,</span>&nbsp;<span class="op" id="8281182">[</span><span class="op" id="8281183">]</span><span class="builtintype" id="8281184">byte</span><span class="op" id="8281188">(</span><span class="string" id="8281189">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8281221">)</span><span class="op" id="8281222">}</span><span class="op" id="8281223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281226">CharData</span><span class="op" id="8281234">(</span><span class="string" id="8281235">&#34;\n&#34;</span><span class="op" id="8281239">)</span><span class="op" id="8281240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281243">Directive</span><span class="op" id="8281252">(</span><span class="string" id="8281253">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8281375">)</span><span class="op" id="8281376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281379">CharData</span><span class="op" id="8281387">(</span><span class="string" id="8281388">&#34;\n&#34;</span><span class="op" id="8281392">)</span><span class="op" id="8281393">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281396">StartElement</span><span class="op" id="8281408">{</span><span class="ident" id="8281409">Name</span><span class="op" id="8281413">{</span><span class="string" id="8281414">&#34;ns2&#34;</span><span class="op" id="8281419">,</span>&nbsp;<span class="string" id="8281421">&#34;body&#34;</span><span class="op" id="8281427">}</span><span class="op" id="8281428">,</span>&nbsp;<span class="op" id="8281430">[</span><span class="op" id="8281431">]</span><span class="ident" id="8281432">Attr</span><span class="op" id="8281436">{</span><span class="op" id="8281437">{</span><span class="ident" id="8281438">Name</span><span class="op" id="8281442">{</span><span class="string" id="8281443">&#34;xmlns&#34;</span><span class="op" id="8281450">,</span>&nbsp;<span class="string" id="8281452">&#34;foo&#34;</span><span class="op" id="8281457">}</span><span class="op" id="8281458">,</span>&nbsp;<span class="string" id="8281460">&#34;ns1&#34;</span><span class="op" id="8281465">}</span><span class="op" id="8281466">,</span>&nbsp;<span class="op" id="8281468">{</span><span class="ident" id="8281469">Name</span><span class="op" id="8281473">{</span><span class="string" id="8281474">&#34;&#34;</span><span class="op" id="8281476">,</span>&nbsp;<span class="string" id="8281478">&#34;xmlns&#34;</span><span class="op" id="8281485">}</span><span class="op" id="8281486">,</span>&nbsp;<span class="string" id="8281488">&#34;ns2&#34;</span><span class="op" id="8281493">}</span><span class="op" id="8281494">,</span>&nbsp;<span class="op" id="8281496">{</span><span class="ident" id="8281497">Name</span><span class="op" id="8281501">{</span><span class="string" id="8281502">&#34;xmlns&#34;</span><span class="op" id="8281509">,</span>&nbsp;<span class="string" id="8281511">&#34;tag&#34;</span><span class="op" id="8281516">}</span><span class="op" id="8281517">,</span>&nbsp;<span class="string" id="8281519">&#34;ns3&#34;</span><span class="op" id="8281524">}</span><span class="op" id="8281525">}</span><span class="op" id="8281526">}</span><span class="op" id="8281527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281530">CharData</span><span class="op" id="8281538">(</span><span class="string" id="8281539">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8281545">)</span><span class="op" id="8281546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281549">StartElement</span><span class="op" id="8281561">{</span><span class="ident" id="8281562">Name</span><span class="op" id="8281566">{</span><span class="string" id="8281567">&#34;ns2&#34;</span><span class="op" id="8281572">,</span>&nbsp;<span class="string" id="8281574">&#34;hello&#34;</span><span class="op" id="8281581">}</span><span class="op" id="8281582">,</span>&nbsp;<span class="op" id="8281584">[</span><span class="op" id="8281585">]</span><span class="ident" id="8281586">Attr</span><span class="op" id="8281590">{</span><span class="op" id="8281591">{</span><span class="ident" id="8281592">Name</span><span class="op" id="8281596">{</span><span class="string" id="8281597">&#34;&#34;</span><span class="op" id="8281599">,</span>&nbsp;<span class="string" id="8281601">&#34;lang&#34;</span><span class="op" id="8281607">}</span><span class="op" id="8281608">,</span>&nbsp;<span class="string" id="8281610">&#34;en&#34;</span><span class="op" id="8281614">}</span><span class="op" id="8281615">}</span><span class="op" id="8281616">}</span><span class="op" id="8281617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281620">CharData</span><span class="op" id="8281628">(</span><span class="string" id="8281629">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8281652">)</span><span class="op" id="8281653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281656">EndElement</span><span class="op" id="8281666">{</span><span class="ident" id="8281667">Name</span><span class="op" id="8281671">{</span><span class="string" id="8281672">&#34;ns2&#34;</span><span class="op" id="8281677">,</span>&nbsp;<span class="string" id="8281679">&#34;hello&#34;</span><span class="op" id="8281686">}</span><span class="op" id="8281687">}</span><span class="op" id="8281688">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281691">CharData</span><span class="op" id="8281699">(</span><span class="string" id="8281700">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8281706">)</span><span class="op" id="8281707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281710">StartElement</span><span class="op" id="8281722">{</span><span class="ident" id="8281723">Name</span><span class="op" id="8281727">{</span><span class="string" id="8281728">&#34;ns2&#34;</span><span class="op" id="8281733">,</span>&nbsp;<span class="string" id="8281735">&#34;query&#34;</span><span class="op" id="8281742">}</span><span class="op" id="8281743">,</span>&nbsp;<span class="op" id="8281745">[</span><span class="op" id="8281746">]</span><span class="ident" id="8281747">Attr</span><span class="op" id="8281751">{</span><span class="op" id="8281752">}</span><span class="op" id="8281753">}</span><span class="op" id="8281754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281757">CharData</span><span class="op" id="8281765">(</span><span class="string" id="8281766">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8281779">)</span><span class="op" id="8281780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281783">EndElement</span><span class="op" id="8281793">{</span><span class="ident" id="8281794">Name</span><span class="op" id="8281798">{</span><span class="string" id="8281799">&#34;ns2&#34;</span><span class="op" id="8281804">,</span>&nbsp;<span class="string" id="8281806">&#34;query&#34;</span><span class="op" id="8281813">}</span><span class="op" id="8281814">}</span><span class="op" id="8281815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281818">CharData</span><span class="op" id="8281826">(</span><span class="string" id="8281827">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8281833">)</span><span class="op" id="8281834">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281837">StartElement</span><span class="op" id="8281849">{</span><span class="ident" id="8281850">Name</span><span class="op" id="8281854">{</span><span class="string" id="8281855">&#34;ns2&#34;</span><span class="op" id="8281860">,</span>&nbsp;<span class="string" id="8281862">&#34;goodbye&#34;</span><span class="op" id="8281871">}</span><span class="op" id="8281872">,</span>&nbsp;<span class="op" id="8281874">[</span><span class="op" id="8281875">]</span><span class="ident" id="8281876">Attr</span><span class="op" id="8281880">{</span><span class="op" id="8281881">}</span><span class="op" id="8281882">}</span><span class="op" id="8281883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281886">EndElement</span><span class="op" id="8281896">{</span><span class="ident" id="8281897">Name</span><span class="op" id="8281901">{</span><span class="string" id="8281902">&#34;ns2&#34;</span><span class="op" id="8281907">,</span>&nbsp;<span class="string" id="8281909">&#34;goodbye&#34;</span><span class="op" id="8281918">}</span><span class="op" id="8281919">}</span><span class="op" id="8281920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281923">CharData</span><span class="op" id="8281931">(</span><span class="string" id="8281932">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8281938">)</span><span class="op" id="8281939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281942">StartElement</span><span class="op" id="8281954">{</span><span class="ident" id="8281955">Name</span><span class="op" id="8281959">{</span><span class="string" id="8281960">&#34;ns2&#34;</span><span class="op" id="8281965">,</span>&nbsp;<span class="string" id="8281967">&#34;outer&#34;</span><span class="op" id="8281974">}</span><span class="op" id="8281975">,</span>&nbsp;<span class="op" id="8281977">[</span><span class="op" id="8281978">]</span><span class="ident" id="8281979">Attr</span><span class="op" id="8281983">{</span><span class="op" id="8281984">{</span><span class="ident" id="8281985">Name</span><span class="op" id="8281989">{</span><span class="string" id="8281990">&#34;ns1&#34;</span><span class="op" id="8281995">,</span>&nbsp;<span class="string" id="8281997">&#34;attr&#34;</span><span class="op" id="8282003">}</span><span class="op" id="8282004">,</span>&nbsp;<span class="string" id="8282006">&#34;value&#34;</span><span class="op" id="8282013">}</span><span class="op" id="8282014">,</span>&nbsp;<span class="op" id="8282016">{</span><span class="ident" id="8282017">Name</span><span class="op" id="8282021">{</span><span class="string" id="8282022">&#34;xmlns&#34;</span><span class="op" id="8282029">,</span>&nbsp;<span class="string" id="8282031">&#34;tag&#34;</span><span class="op" id="8282036">}</span><span class="op" id="8282037">,</span>&nbsp;<span class="string" id="8282039">&#34;ns4&#34;</span><span class="op" id="8282044">}</span><span class="op" id="8282045">}</span><span class="op" id="8282046">}</span><span class="op" id="8282047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282050">CharData</span><span class="op" id="8282058">(</span><span class="string" id="8282059">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8282067">)</span><span class="op" id="8282068">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282071">StartElement</span><span class="op" id="8282083">{</span><span class="ident" id="8282084">Name</span><span class="op" id="8282088">{</span><span class="string" id="8282089">&#34;ns2&#34;</span><span class="op" id="8282094">,</span>&nbsp;<span class="string" id="8282096">&#34;inner&#34;</span><span class="op" id="8282103">}</span><span class="op" id="8282104">,</span>&nbsp;<span class="op" id="8282106">[</span><span class="op" id="8282107">]</span><span class="ident" id="8282108">Attr</span><span class="op" id="8282112">{</span><span class="op" id="8282113">}</span><span class="op" id="8282114">}</span><span class="op" id="8282115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282118">EndElement</span><span class="op" id="8282128">{</span><span class="ident" id="8282129">Name</span><span class="op" id="8282133">{</span><span class="string" id="8282134">&#34;ns2&#34;</span><span class="op" id="8282139">,</span>&nbsp;<span class="string" id="8282141">&#34;inner&#34;</span><span class="op" id="8282148">}</span><span class="op" id="8282149">}</span><span class="op" id="8282150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282153">CharData</span><span class="op" id="8282161">(</span><span class="string" id="8282162">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8282168">)</span><span class="op" id="8282169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282172">EndElement</span><span class="op" id="8282182">{</span><span class="ident" id="8282183">Name</span><span class="op" id="8282187">{</span><span class="string" id="8282188">&#34;ns2&#34;</span><span class="op" id="8282193">,</span>&nbsp;<span class="string" id="8282195">&#34;outer&#34;</span><span class="op" id="8282202">}</span><span class="op" id="8282203">}</span><span class="op" id="8282204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282207">CharData</span><span class="op" id="8282215">(</span><span class="string" id="8282216">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8282222">)</span><span class="op" id="8282223">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282226">StartElement</span><span class="op" id="8282238">{</span><span class="ident" id="8282239">Name</span><span class="op" id="8282243">{</span><span class="string" id="8282244">&#34;ns3&#34;</span><span class="op" id="8282249">,</span>&nbsp;<span class="string" id="8282251">&#34;name&#34;</span><span class="op" id="8282257">}</span><span class="op" id="8282258">,</span>&nbsp;<span class="op" id="8282260">[</span><span class="op" id="8282261">]</span><span class="ident" id="8282262">Attr</span><span class="op" id="8282266">{</span><span class="op" id="8282267">}</span><span class="op" id="8282268">}</span><span class="op" id="8282269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282272">CharData</span><span class="op" id="8282280">(</span><span class="string" id="8282281">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8282289">)</span><span class="op" id="8282290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282293">CharData</span><span class="op" id="8282301">(</span><span class="string" id="8282302">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8282319">)</span><span class="op" id="8282320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282323">CharData</span><span class="op" id="8282331">(</span><span class="string" id="8282332">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8282338">)</span><span class="op" id="8282339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282342">EndElement</span><span class="op" id="8282352">{</span><span class="ident" id="8282353">Name</span><span class="op" id="8282357">{</span><span class="string" id="8282358">&#34;ns3&#34;</span><span class="op" id="8282363">,</span>&nbsp;<span class="string" id="8282365">&#34;name&#34;</span><span class="op" id="8282371">}</span><span class="op" id="8282372">}</span><span class="op" id="8282373">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282376">CharData</span><span class="op" id="8282384">(</span><span class="string" id="8282385">&#34;\n&#34;</span><span class="op" id="8282389">)</span><span class="op" id="8282390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282393">EndElement</span><span class="op" id="8282403">{</span><span class="ident" id="8282404">Name</span><span class="op" id="8282408">{</span><span class="string" id="8282409">&#34;ns2&#34;</span><span class="op" id="8282414">,</span>&nbsp;<span class="string" id="8282416">&#34;body&#34;</span><span class="op" id="8282422">}</span><span class="op" id="8282423">}</span><span class="op" id="8282424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282427">Comment</span><span class="op" id="8282434">(</span><span class="string" id="8282435">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8282460">)</span><span class="op" id="8282461">,</span><br>
<span class="lineno"></span><span class="op" id="8282463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8282466">const</span>&nbsp;<span class="ident" id="8282472">testInputAltEncoding</span>&nbsp;<span class="op" id="8282493">=</span>&nbsp;<span class="string" id="8282495">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8282569">var</span>&nbsp;<span class="ident" id="8282573">rawTokensAltEncoding</span>&nbsp;<span class="op" id="8282594">=</span>&nbsp;<span class="op" id="8282596">[</span><span class="op" id="8282597">]</span><span class="ident" id="8282598">Token</span><span class="op" id="8282603">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282606">CharData</span><span class="op" id="8282614">(</span><span class="string" id="8282615">&#34;\n&#34;</span><span class="op" id="8282619">)</span><span class="op" id="8282620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282623">ProcInst</span><span class="op" id="8282631">{</span><span class="string" id="8282632">&#34;xml&#34;</span><span class="op" id="8282637">,</span>&nbsp;<span class="op" id="8282639">[</span><span class="op" id="8282640">]</span><span class="builtintype" id="8282641">byte</span><span class="op" id="8282645">(</span><span class="string" id="8282646">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="8282692">)</span><span class="op" id="8282693">}</span><span class="op" id="8282694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282697">CharData</span><span class="op" id="8282705">(</span><span class="string" id="8282706">&#34;\n&#34;</span><span class="op" id="8282710">)</span><span class="op" id="8282711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282714">StartElement</span><span class="op" id="8282726">{</span><span class="ident" id="8282727">Name</span><span class="op" id="8282731">{</span><span class="string" id="8282732">&#34;&#34;</span><span class="op" id="8282734">,</span>&nbsp;<span class="string" id="8282736">&#34;tag&#34;</span><span class="op" id="8282741">}</span><span class="op" id="8282742">,</span>&nbsp;<span class="op" id="8282744">[</span><span class="op" id="8282745">]</span><span class="ident" id="8282746">Attr</span><span class="op" id="8282750">{</span><span class="op" id="8282751">}</span><span class="op" id="8282752">}</span><span class="op" id="8282753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282756">CharData</span><span class="op" id="8282764">(</span><span class="string" id="8282765">&#34;value&#34;</span><span class="op" id="8282772">)</span><span class="op" id="8282773">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8282776">EndElement</span><span class="op" id="8282786">{</span><span class="ident" id="8282787">Name</span><span class="op" id="8282791">{</span><span class="string" id="8282792">&#34;&#34;</span><span class="op" id="8282794">,</span>&nbsp;<span class="string" id="8282796">&#34;tag&#34;</span><span class="op" id="8282801">}</span><span class="op" id="8282802">}</span><span class="op" id="8282803">,</span><br>
<span class="lineno"></span><span class="op" id="8282805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8282808">var</span>&nbsp;<span class="ident" id="8282812">xmlInput</span>&nbsp;<span class="op" id="8282821">=</span>&nbsp;<span class="op" id="8282823">[</span><span class="op" id="8282824">]</span><span class="builtintype" id="8282825">string</span><span class="op" id="8282831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8282834">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282859">&#34;&lt;&#34;</span><span class="op" id="8282862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282865">&#34;&lt;t&#34;</span><span class="op" id="8282869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282872">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="8282877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282880">&#34;&lt;t/&#34;</span><span class="op" id="8282885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282888">&#34;&lt;!&#34;</span><span class="op" id="8282892">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282895">&#34;&lt;!-&#34;</span><span class="op" id="8282900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282903">&#34;&lt;!--&#34;</span><span class="op" id="8282909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282912">&#34;&lt;!--c-&#34;</span><span class="op" id="8282920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282923">&#34;&lt;!--c--&#34;</span><span class="op" id="8282932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282935">&#34;&lt;!d&#34;</span><span class="op" id="8282940">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282943">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="8282950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282953">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="8282961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282964">&#34;&lt;?&#34;</span><span class="op" id="8282968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282971">&#34;&lt;?p&#34;</span><span class="op" id="8282976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282979">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="8282985">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282988">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="8282995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8282998">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="8283006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283009">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="8283018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283021">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="8283030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283033">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="8283043">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283046">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="8283062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283065">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="8283082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283085">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="8283103">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283107">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283131">&#34;&lt;&gt;&#34;</span><span class="op" id="8283135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283138">&#34;&lt;t/a&#34;</span><span class="op" id="8283144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283147">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="8283154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283157">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="8283164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283167">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283213">&#34;&lt;/0&gt;&#34;</span><span class="op" id="8283219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283222">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="8283232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283235">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="8283246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283249">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="8283260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283263">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="8283279">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283282">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="8283289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283292">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="8283300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283303">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="8283312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283315">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283369">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="8283378">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283381">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="8283389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283392">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="8283401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8283404">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="8283421">,</span><br>
<span class="lineno"></span><span class="op" id="8283423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8283426">func</span>&nbsp;<span class="ident" id="8283431">TestRawToken</span><span class="op" id="8283443">(</span><span class="ident" id="8283444">t</span>&nbsp;<span class="op" id="8283446">*</span><span class="ident" id="8283447">testing</span><span class="op" id="8283454">.</span><span class="ident" id="8283455">T</span><span class="op" id="8283456">)</span>&nbsp;<span class="op" id="8283458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283461">d</span>&nbsp;<span class="op" id="8283463">:=</span>&nbsp;<span class="ident" id="8283466">NewDecoder</span><span class="op" id="8283476">(</span><span class="ident" id="8283477">strings</span><span class="op" id="8283484">.</span><span class="ident" id="8283485">NewReader</span><span class="op" id="8283494">(</span><span class="ident" id="8283495">testInput</span><span class="op" id="8283504">)</span><span class="op" id="8283505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283508">d</span><span class="op" id="8283509">.</span><span class="ident" id="8283510">Entity</span>&nbsp;<span class="op" id="8283517">=</span>&nbsp;<span class="ident" id="8283519">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283531">testRawToken</span><span class="op" id="8283543">(</span><span class="ident" id="8283544">t</span><span class="op" id="8283545">,</span>&nbsp;<span class="ident" id="8283547">d</span><span class="op" id="8283548">,</span>&nbsp;<span class="ident" id="8283550">testInput</span><span class="op" id="8283559">,</span>&nbsp;<span class="ident" id="8283561">rawTokens</span><span class="op" id="8283570">)</span><br>
<span class="lineno"></span><span class="op" id="8283572">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8283575">const</span>&nbsp;<span class="ident" id="8283581">nonStrictInput</span>&nbsp;<span class="op" id="8283596">=</span>&nbsp;<span class="string" id="8283598">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283760">var</span>&nbsp;<span class="ident" id="8283764">nonStringEntity</span>&nbsp;<span class="op" id="8283780">=</span>&nbsp;<span class="keyword" id="8283782">map</span><span class="op" id="8283785">[</span><span class="builtintype" id="8283786">string</span><span class="op" id="8283792">]</span><span class="builtintype" id="8283793">string</span><span class="op" id="8283799">{</span><span class="string" id="8283800">&#34;&#34;</span><span class="op" id="8283802">:</span>&nbsp;<span class="string" id="8283804">&#34;oops!&#34;</span><span class="op" id="8283811">,</span>&nbsp;<span class="string" id="8283813">&#34;0a&#34;</span><span class="op" id="8283817">:</span>&nbsp;<span class="string" id="8283819">&#34;oops!&#34;</span><span class="op" id="8283826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283829">var</span>&nbsp;<span class="ident" id="8283833">nonStrictTokens</span>&nbsp;<span class="op" id="8283849">=</span>&nbsp;<span class="op" id="8283851">[</span><span class="op" id="8283852">]</span><span class="ident" id="8283853">Token</span><span class="op" id="8283858">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283861">CharData</span><span class="op" id="8283869">(</span><span class="string" id="8283870">&#34;\n&#34;</span><span class="op" id="8283874">)</span><span class="op" id="8283875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283878">StartElement</span><span class="op" id="8283890">{</span><span class="ident" id="8283891">Name</span><span class="op" id="8283895">{</span><span class="string" id="8283896">&#34;&#34;</span><span class="op" id="8283898">,</span>&nbsp;<span class="string" id="8283900">&#34;tag&#34;</span><span class="op" id="8283905">}</span><span class="op" id="8283906">,</span>&nbsp;<span class="op" id="8283908">[</span><span class="op" id="8283909">]</span><span class="ident" id="8283910">Attr</span><span class="op" id="8283914">{</span><span class="op" id="8283915">}</span><span class="op" id="8283916">}</span><span class="op" id="8283917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283920">CharData</span><span class="op" id="8283928">(</span><span class="string" id="8283929">&#34;non&amp;entity&#34;</span><span class="op" id="8283941">)</span><span class="op" id="8283942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283945">EndElement</span><span class="op" id="8283955">{</span><span class="ident" id="8283956">Name</span><span class="op" id="8283960">{</span><span class="string" id="8283961">&#34;&#34;</span><span class="op" id="8283963">,</span>&nbsp;<span class="string" id="8283965">&#34;tag&#34;</span><span class="op" id="8283970">}</span><span class="op" id="8283971">}</span><span class="op" id="8283972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283975">CharData</span><span class="op" id="8283983">(</span><span class="string" id="8283984">&#34;\n&#34;</span><span class="op" id="8283988">)</span><span class="op" id="8283989">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8283992">StartElement</span><span class="op" id="8284004">{</span><span class="ident" id="8284005">Name</span><span class="op" id="8284009">{</span><span class="string" id="8284010">&#34;&#34;</span><span class="op" id="8284012">,</span>&nbsp;<span class="string" id="8284014">&#34;tag&#34;</span><span class="op" id="8284019">}</span><span class="op" id="8284020">,</span>&nbsp;<span class="op" id="8284022">[</span><span class="op" id="8284023">]</span><span class="ident" id="8284024">Attr</span><span class="op" id="8284028">{</span><span class="op" id="8284029">}</span><span class="op" id="8284030">}</span><span class="op" id="8284031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284034">CharData</span><span class="op" id="8284042">(</span><span class="string" id="8284043">&#34;&amp;unknown;entity&#34;</span><span class="op" id="8284060">)</span><span class="op" id="8284061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284064">EndElement</span><span class="op" id="8284074">{</span><span class="ident" id="8284075">Name</span><span class="op" id="8284079">{</span><span class="string" id="8284080">&#34;&#34;</span><span class="op" id="8284082">,</span>&nbsp;<span class="string" id="8284084">&#34;tag&#34;</span><span class="op" id="8284089">}</span><span class="op" id="8284090">}</span><span class="op" id="8284091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284094">CharData</span><span class="op" id="8284102">(</span><span class="string" id="8284103">&#34;\n&#34;</span><span class="op" id="8284107">)</span><span class="op" id="8284108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284111">StartElement</span><span class="op" id="8284123">{</span><span class="ident" id="8284124">Name</span><span class="op" id="8284128">{</span><span class="string" id="8284129">&#34;&#34;</span><span class="op" id="8284131">,</span>&nbsp;<span class="string" id="8284133">&#34;tag&#34;</span><span class="op" id="8284138">}</span><span class="op" id="8284139">,</span>&nbsp;<span class="op" id="8284141">[</span><span class="op" id="8284142">]</span><span class="ident" id="8284143">Attr</span><span class="op" id="8284147">{</span><span class="op" id="8284148">}</span><span class="op" id="8284149">}</span><span class="op" id="8284150">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284153">CharData</span><span class="op" id="8284161">(</span><span class="string" id="8284162">&#34;&amp;#123&#34;</span><span class="op" id="8284169">)</span><span class="op" id="8284170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284173">EndElement</span><span class="op" id="8284183">{</span><span class="ident" id="8284184">Name</span><span class="op" id="8284188">{</span><span class="string" id="8284189">&#34;&#34;</span><span class="op" id="8284191">,</span>&nbsp;<span class="string" id="8284193">&#34;tag&#34;</span><span class="op" id="8284198">}</span><span class="op" id="8284199">}</span><span class="op" id="8284200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284203">CharData</span><span class="op" id="8284211">(</span><span class="string" id="8284212">&#34;\n&#34;</span><span class="op" id="8284216">)</span><span class="op" id="8284217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284220">StartElement</span><span class="op" id="8284232">{</span><span class="ident" id="8284233">Name</span><span class="op" id="8284237">{</span><span class="string" id="8284238">&#34;&#34;</span><span class="op" id="8284240">,</span>&nbsp;<span class="string" id="8284242">&#34;tag&#34;</span><span class="op" id="8284247">}</span><span class="op" id="8284248">,</span>&nbsp;<span class="op" id="8284250">[</span><span class="op" id="8284251">]</span><span class="ident" id="8284252">Attr</span><span class="op" id="8284256">{</span><span class="op" id="8284257">}</span><span class="op" id="8284258">}</span><span class="op" id="8284259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284262">CharData</span><span class="op" id="8284270">(</span><span class="string" id="8284271">&#34;&amp;#zzz;&#34;</span><span class="op" id="8284279">)</span><span class="op" id="8284280">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284283">EndElement</span><span class="op" id="8284293">{</span><span class="ident" id="8284294">Name</span><span class="op" id="8284298">{</span><span class="string" id="8284299">&#34;&#34;</span><span class="op" id="8284301">,</span>&nbsp;<span class="string" id="8284303">&#34;tag&#34;</span><span class="op" id="8284308">}</span><span class="op" id="8284309">}</span><span class="op" id="8284310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284313">CharData</span><span class="op" id="8284321">(</span><span class="string" id="8284322">&#34;\n&#34;</span><span class="op" id="8284326">)</span><span class="op" id="8284327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284330">StartElement</span><span class="op" id="8284342">{</span><span class="ident" id="8284343">Name</span><span class="op" id="8284347">{</span><span class="string" id="8284348">&#34;&#34;</span><span class="op" id="8284350">,</span>&nbsp;<span class="string" id="8284352">&#34;tag&#34;</span><span class="op" id="8284357">}</span><span class="op" id="8284358">,</span>&nbsp;<span class="op" id="8284360">[</span><span class="op" id="8284361">]</span><span class="ident" id="8284362">Attr</span><span class="op" id="8284366">{</span><span class="op" id="8284367">}</span><span class="op" id="8284368">}</span><span class="op" id="8284369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284372">CharData</span><span class="op" id="8284380">(</span><span class="string" id="8284381">&#34;&amp;なまえ3;&#34;</span><span class="op" id="8284395">)</span><span class="op" id="8284396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284399">EndElement</span><span class="op" id="8284409">{</span><span class="ident" id="8284410">Name</span><span class="op" id="8284414">{</span><span class="string" id="8284415">&#34;&#34;</span><span class="op" id="8284417">,</span>&nbsp;<span class="string" id="8284419">&#34;tag&#34;</span><span class="op" id="8284424">}</span><span class="op" id="8284425">}</span><span class="op" id="8284426">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284429">CharData</span><span class="op" id="8284437">(</span><span class="string" id="8284438">&#34;\n&#34;</span><span class="op" id="8284442">)</span><span class="op" id="8284443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284446">StartElement</span><span class="op" id="8284458">{</span><span class="ident" id="8284459">Name</span><span class="op" id="8284463">{</span><span class="string" id="8284464">&#34;&#34;</span><span class="op" id="8284466">,</span>&nbsp;<span class="string" id="8284468">&#34;tag&#34;</span><span class="op" id="8284473">}</span><span class="op" id="8284474">,</span>&nbsp;<span class="op" id="8284476">[</span><span class="op" id="8284477">]</span><span class="ident" id="8284478">Attr</span><span class="op" id="8284482">{</span><span class="op" id="8284483">}</span><span class="op" id="8284484">}</span><span class="op" id="8284485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284488">CharData</span><span class="op" id="8284496">(</span><span class="string" id="8284497">&#34;&amp;lt-gt;&#34;</span><span class="op" id="8284506">)</span><span class="op" id="8284507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284510">EndElement</span><span class="op" id="8284520">{</span><span class="ident" id="8284521">Name</span><span class="op" id="8284525">{</span><span class="string" id="8284526">&#34;&#34;</span><span class="op" id="8284528">,</span>&nbsp;<span class="string" id="8284530">&#34;tag&#34;</span><span class="op" id="8284535">}</span><span class="op" id="8284536">}</span><span class="op" id="8284537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284540">CharData</span><span class="op" id="8284548">(</span><span class="string" id="8284549">&#34;\n&#34;</span><span class="op" id="8284553">)</span><span class="op" id="8284554">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284557">StartElement</span><span class="op" id="8284569">{</span><span class="ident" id="8284570">Name</span><span class="op" id="8284574">{</span><span class="string" id="8284575">&#34;&#34;</span><span class="op" id="8284577">,</span>&nbsp;<span class="string" id="8284579">&#34;tag&#34;</span><span class="op" id="8284584">}</span><span class="op" id="8284585">,</span>&nbsp;<span class="op" id="8284587">[</span><span class="op" id="8284588">]</span><span class="ident" id="8284589">Attr</span><span class="op" id="8284593">{</span><span class="op" id="8284594">}</span><span class="op" id="8284595">}</span><span class="op" id="8284596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284599">CharData</span><span class="op" id="8284607">(</span><span class="string" id="8284608">&#34;&amp;;&#34;</span><span class="op" id="8284612">)</span><span class="op" id="8284613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284616">EndElement</span><span class="op" id="8284626">{</span><span class="ident" id="8284627">Name</span><span class="op" id="8284631">{</span><span class="string" id="8284632">&#34;&#34;</span><span class="op" id="8284634">,</span>&nbsp;<span class="string" id="8284636">&#34;tag&#34;</span><span class="op" id="8284641">}</span><span class="op" id="8284642">}</span><span class="op" id="8284643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284646">CharData</span><span class="op" id="8284654">(</span><span class="string" id="8284655">&#34;\n&#34;</span><span class="op" id="8284659">)</span><span class="op" id="8284660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284663">StartElement</span><span class="op" id="8284675">{</span><span class="ident" id="8284676">Name</span><span class="op" id="8284680">{</span><span class="string" id="8284681">&#34;&#34;</span><span class="op" id="8284683">,</span>&nbsp;<span class="string" id="8284685">&#34;tag&#34;</span><span class="op" id="8284690">}</span><span class="op" id="8284691">,</span>&nbsp;<span class="op" id="8284693">[</span><span class="op" id="8284694">]</span><span class="ident" id="8284695">Attr</span><span class="op" id="8284699">{</span><span class="op" id="8284700">}</span><span class="op" id="8284701">}</span><span class="op" id="8284702">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284705">CharData</span><span class="op" id="8284713">(</span><span class="string" id="8284714">&#34;&amp;0a;&#34;</span><span class="op" id="8284720">)</span><span class="op" id="8284721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284724">EndElement</span><span class="op" id="8284734">{</span><span class="ident" id="8284735">Name</span><span class="op" id="8284739">{</span><span class="string" id="8284740">&#34;&#34;</span><span class="op" id="8284742">,</span>&nbsp;<span class="string" id="8284744">&#34;tag&#34;</span><span class="op" id="8284749">}</span><span class="op" id="8284750">}</span><span class="op" id="8284751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284754">CharData</span><span class="op" id="8284762">(</span><span class="string" id="8284763">&#34;\n&#34;</span><span class="op" id="8284767">)</span><span class="op" id="8284768">,</span><br>
<span class="lineno"></span><span class="op" id="8284770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8284773">func</span>&nbsp;<span class="ident" id="8284778">TestNonStrictRawToken</span><span class="op" id="8284799">(</span><span class="ident" id="8284800">t</span>&nbsp;<span class="op" id="8284802">*</span><span class="ident" id="8284803">testing</span><span class="op" id="8284810">.</span><span class="ident" id="8284811">T</span><span class="op" id="8284812">)</span>&nbsp;<span class="op" id="8284814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284817">d</span>&nbsp;<span class="op" id="8284819">:=</span>&nbsp;<span class="ident" id="8284822">NewDecoder</span><span class="op" id="8284832">(</span><span class="ident" id="8284833">strings</span><span class="op" id="8284840">.</span><span class="ident" id="8284841">NewReader</span><span class="op" id="8284850">(</span><span class="ident" id="8284851">nonStrictInput</span><span class="op" id="8284865">)</span><span class="op" id="8284866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284869">d</span><span class="op" id="8284870">.</span><span class="ident" id="8284871">Strict</span>&nbsp;<span class="op" id="8284878">=</span>&nbsp;<span class="builtintype" id="8284880">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284887">testRawToken</span><span class="op" id="8284899">(</span><span class="ident" id="8284900">t</span><span class="op" id="8284901">,</span>&nbsp;<span class="ident" id="8284903">d</span><span class="op" id="8284904">,</span>&nbsp;<span class="ident" id="8284906">nonStrictInput</span><span class="op" id="8284920">,</span>&nbsp;<span class="ident" id="8284922">nonStrictTokens</span><span class="op" id="8284937">)</span><br>
<span class="lineno"></span><span class="op" id="8284939">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="8284942">type</span>&nbsp;<span class="ident" id="8284947">downCaser</span>&nbsp;<span class="keyword" id="8284957">struct</span>&nbsp;<span class="op" id="8284964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284967">t</span>&nbsp;<span class="op" id="8284969">*</span><span class="ident" id="8284970">testing</span><span class="op" id="8284977">.</span><span class="ident" id="8284978">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8284981">r</span>&nbsp;<span class="ident" id="8284983">io</span><span class="op" id="8284985">.</span><span class="ident" id="8284986">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="8284997">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="8285000">func</span>&nbsp;<span class="op" id="8285005">(</span><span class="ident" id="8285006">d</span>&nbsp;<span class="op" id="8285008">*</span><span class="ident" id="8285009">downCaser</span><span class="op" id="8285018">)</span>&nbsp;<span class="ident" id="8285020">ReadByte</span><span class="op" id="8285028">(</span><span class="op" id="8285029">)</span>&nbsp;<span class="op" id="8285031">(</span><span class="ident" id="8285032">c</span>&nbsp;<span class="builtintype" id="8285034">byte</span><span class="op" id="8285038">,</span>&nbsp;<span class="ident" id="8285040">err</span>&nbsp;<span class="builtintype" id="8285044">error</span><span class="op" id="8285049">)</span>&nbsp;<span class="op" id="8285051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285054">c</span><span class="op" id="8285055">,</span>&nbsp;<span class="ident" id="8285057">err</span>&nbsp;<span class="op" id="8285061">=</span>&nbsp;<span class="ident" id="8285063">d</span><span class="op" id="8285064">.</span><span class="ident" id="8285065">r</span><span class="op" id="8285066">.</span><span class="ident" id="8285067">ReadByte</span><span class="op" id="8285075">(</span><span class="op" id="8285076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285079">if</span>&nbsp;<span class="ident" id="8285082">c</span>&nbsp;<span class="op" id="8285084">&gt;=</span>&nbsp;<span class="string" id="8285087">&#39;A&#39;</span>&nbsp;<span class="op" id="8285091">&amp;&amp;</span>&nbsp;<span class="ident" id="8285094">c</span>&nbsp;<span class="op" id="8285096">&lt;=</span>&nbsp;<span class="string" id="8285099">&#39;Z&#39;</span>&nbsp;<span class="op" id="8285103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285107">c</span>&nbsp;<span class="op" id="8285109">+=</span>&nbsp;<span class="string" id="8285112">&#39;a&#39;</span>&nbsp;<span class="op" id="8285116">-</span>&nbsp;<span class="string" id="8285118">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285126">return</span><br>
<span class="lineno"></span><span class="op" id="8285133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8285136">func</span>&nbsp;<span class="op" id="8285141">(</span><span class="ident" id="8285142">d</span>&nbsp;<span class="op" id="8285144">*</span><span class="ident" id="8285145">downCaser</span><span class="op" id="8285154">)</span>&nbsp;<span class="ident" id="8285156">Read</span><span class="op" id="8285160">(</span><span class="ident" id="8285161">p</span>&nbsp;<span class="op" id="8285163">[</span><span class="op" id="8285164">]</span><span class="builtintype" id="8285165">byte</span><span class="op" id="8285169">)</span>&nbsp;<span class="op" id="8285171">(</span><span class="builtintype" id="8285172">int</span><span class="op" id="8285175">,</span>&nbsp;<span class="builtintype" id="8285177">error</span><span class="op" id="8285182">)</span>&nbsp;<span class="op" id="8285184">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285187">d</span><span class="op" id="8285188">.</span><span class="ident" id="8285189">t</span><span class="op" id="8285190">.</span><span class="ident" id="8285191">Fatalf</span><span class="op" id="8285197">(</span><span class="string" id="8285198">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="8285240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8285243">panic</span><span class="op" id="8285248">(</span><span class="string" id="8285249">&#34;unreachable&#34;</span><span class="op" id="8285262">)</span><br>
<span class="lineno"></span><span class="op" id="8285264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8285267">func</span>&nbsp;<span class="ident" id="8285272">TestRawTokenAltEncoding</span><span class="op" id="8285295">(</span><span class="ident" id="8285296">t</span>&nbsp;<span class="op" id="8285298">*</span><span class="ident" id="8285299">testing</span><span class="op" id="8285306">.</span><span class="ident" id="8285307">T</span><span class="op" id="8285308">)</span>&nbsp;<span class="op" id="8285310">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285313">d</span>&nbsp;<span class="op" id="8285315">:=</span>&nbsp;<span class="ident" id="8285318">NewDecoder</span><span class="op" id="8285328">(</span><span class="ident" id="8285329">strings</span><span class="op" id="8285336">.</span><span class="ident" id="8285337">NewReader</span><span class="op" id="8285346">(</span><span class="ident" id="8285347">testInputAltEncoding</span><span class="op" id="8285367">)</span><span class="op" id="8285368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285371">d</span><span class="op" id="8285372">.</span><span class="ident" id="8285373">CharsetReader</span>&nbsp;<span class="op" id="8285387">=</span>&nbsp;<span class="keyword" id="8285389">func</span><span class="op" id="8285393">(</span><span class="ident" id="8285394">charset</span>&nbsp;<span class="builtintype" id="8285402">string</span><span class="op" id="8285408">,</span>&nbsp;<span class="ident" id="8285410">input</span>&nbsp;<span class="ident" id="8285416">io</span><span class="op" id="8285418">.</span><span class="ident" id="8285419">Reader</span><span class="op" id="8285425">)</span>&nbsp;<span class="op" id="8285427">(</span><span class="ident" id="8285428">io</span><span class="op" id="8285430">.</span><span class="ident" id="8285431">Reader</span><span class="op" id="8285437">,</span>&nbsp;<span class="builtintype" id="8285439">error</span><span class="op" id="8285444">)</span>&nbsp;<span class="op" id="8285446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285450">if</span>&nbsp;<span class="ident" id="8285453">charset</span>&nbsp;<span class="op" id="8285461">!=</span>&nbsp;<span class="string" id="8285464">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="8285486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285491">t</span><span class="op" id="8285492">.</span><span class="ident" id="8285493">Fatalf</span><span class="op" id="8285499">(</span><span class="string" id="8285500">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="8285523">,</span>&nbsp;<span class="ident" id="8285525">charset</span><span class="op" id="8285532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285536">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285540">return</span>&nbsp;<span class="op" id="8285547">&amp;</span><span class="ident" id="8285548">downCaser</span><span class="op" id="8285557">{</span><span class="ident" id="8285558">t</span><span class="op" id="8285559">,</span>&nbsp;<span class="ident" id="8285561">input</span><span class="op" id="8285566">.</span><span class="op" id="8285567">(</span><span class="ident" id="8285568">io</span><span class="op" id="8285570">.</span><span class="ident" id="8285571">ByteReader</span><span class="op" id="8285581">)</span><span class="op" id="8285582">}</span><span class="op" id="8285583">,</span>&nbsp;<span class="builtintype" id="8285585">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285593">testRawToken</span><span class="op" id="8285605">(</span><span class="ident" id="8285606">t</span><span class="op" id="8285607">,</span>&nbsp;<span class="ident" id="8285609">d</span><span class="op" id="8285610">,</span>&nbsp;<span class="ident" id="8285612">testInputAltEncoding</span><span class="op" id="8285632">,</span>&nbsp;<span class="ident" id="8285634">rawTokensAltEncoding</span><span class="op" id="8285654">)</span><br>
<span class="lineno"></span><span class="op" id="8285656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="8285659">func</span>&nbsp;<span class="ident" id="8285664">TestRawTokenAltEncodingNoConverter</span><span class="op" id="8285698">(</span><span class="ident" id="8285699">t</span>&nbsp;<span class="op" id="8285701">*</span><span class="ident" id="8285702">testing</span><span class="op" id="8285709">.</span><span class="ident" id="8285710">T</span><span class="op" id="8285711">)</span>&nbsp;<span class="op" id="8285713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285716">d</span>&nbsp;<span class="op" id="8285718">:=</span>&nbsp;<span class="ident" id="8285721">NewDecoder</span><span class="op" id="8285731">(</span><span class="ident" id="8285732">strings</span><span class="op" id="8285739">.</span><span class="ident" id="8285740">NewReader</span><span class="op" id="8285749">(</span><span class="ident" id="8285750">testInputAltEncoding</span><span class="op" id="8285770">)</span><span class="op" id="8285771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285774">token</span><span class="op" id="8285779">,</span>&nbsp;<span class="ident" id="8285781">err</span>&nbsp;<span class="op" id="8285785">:=</span>&nbsp;<span class="ident" id="8285788">d</span><span class="op" id="8285789">.</span><span class="ident" id="8285790">RawToken</span><span class="op" id="8285798">(</span><span class="op" id="8285799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285802">if</span>&nbsp;<span class="ident" id="8285805">token</span>&nbsp;<span class="op" id="8285811">==</span>&nbsp;<span class="builtintype" id="8285814">nil</span>&nbsp;<span class="op" id="8285818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285822">t</span><span class="op" id="8285823">.</span><span class="ident" id="8285824">Fatalf</span><span class="op" id="8285830">(</span><span class="string" id="8285831">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8285872">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285878">if</span>&nbsp;<span class="ident" id="8285881">err</span>&nbsp;<span class="op" id="8285885">!=</span>&nbsp;<span class="builtintype" id="8285888">nil</span>&nbsp;<span class="op" id="8285892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285896">t</span><span class="op" id="8285897">.</span><span class="ident" id="8285898">Fatal</span><span class="op" id="8285903">(</span><span class="ident" id="8285904">err</span><span class="op" id="8285907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8285910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285913">token</span><span class="op" id="8285918">,</span>&nbsp;<span class="ident" id="8285920">err</span>&nbsp;<span class="op" id="8285924">=</span>&nbsp;<span class="ident" id="8285926">d</span><span class="op" id="8285927">.</span><span class="ident" id="8285928">RawToken</span><span class="op" id="8285936">(</span><span class="op" id="8285937">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8285940">if</span>&nbsp;<span class="ident" id="8285943">token</span>&nbsp;<span class="op" id="8285949">!=</span>&nbsp;<span class="builtintype" id="8285952">nil</span>&nbsp;<span class="op" id="8285956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8285960">t</span><span class="op" id="8285961">.</span><span class="ident" id="8285962">Errorf</span><span class="op" id="8285968">(</span><span class="string" id="8285969">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8286000">,</span>&nbsp;<span class="ident" id="8286002">token</span><span class="op" id="8286007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286013">if</span>&nbsp;<span class="ident" id="8286016">err</span>&nbsp;<span class="op" id="8286020">==</span>&nbsp;<span class="builtintype" id="8286023">nil</span>&nbsp;<span class="op" id="8286027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286031">t</span><span class="op" id="8286032">.</span><span class="ident" id="8286033">Fatalf</span><span class="op" id="8286039">(</span><span class="string" id="8286040">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8286083">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286089">const</span>&nbsp;<span class="ident" id="8286095">encoding</span>&nbsp;<span class="op" id="8286104">=</span>&nbsp;<span class="string" id="8286106">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286129">if</span>&nbsp;<span class="op" id="8286132">!</span><span class="ident" id="8286133">strings</span><span class="op" id="8286140">.</span><span class="ident" id="8286141">Contains</span><span class="op" id="8286149">(</span><span class="ident" id="8286150">err</span><span class="op" id="8286153">.</span><span class="ident" id="8286154">Error</span><span class="op" id="8286159">(</span><span class="op" id="8286160">)</span><span class="op" id="8286161">,</span>&nbsp;<span class="ident" id="8286163">encoding</span><span class="op" id="8286171">)</span>&nbsp;<span class="op" id="8286173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286177">t</span><span class="op" id="8286178">.</span><span class="ident" id="8286179">Errorf</span><span class="op" id="8286185">(</span><span class="string" id="8286186">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8286231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286236">encoding</span><span class="op" id="8286244">,</span>&nbsp;<span class="ident" id="8286246">err</span><span class="op" id="8286249">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286252">}</span><br>
<span class="lineno"></span><span class="op" id="8286254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8286257">func</span>&nbsp;<span class="ident" id="8286262">testRawToken</span><span class="op" id="8286274">(</span><span class="ident" id="8286275">t</span>&nbsp;<span class="op" id="8286277">*</span><span class="ident" id="8286278">testing</span><span class="op" id="8286285">.</span><span class="ident" id="8286286">T</span><span class="op" id="8286287">,</span>&nbsp;<span class="ident" id="8286289">d</span>&nbsp;<span class="op" id="8286291">*</span><span class="ident" id="8286292">Decoder</span><span class="op" id="8286299">,</span>&nbsp;<span class="ident" id="8286301">raw</span>&nbsp;<span class="builtintype" id="8286305">string</span><span class="op" id="8286311">,</span>&nbsp;<span class="ident" id="8286313">rawTokens</span>&nbsp;<span class="op" id="8286323">[</span><span class="op" id="8286324">]</span><span class="ident" id="8286325">Token</span><span class="op" id="8286330">)</span>&nbsp;<span class="op" id="8286332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286335">lastEnd</span>&nbsp;<span class="op" id="8286343">:=</span>&nbsp;<span class="builtintype" id="8286346">int64</span><span class="op" id="8286351">(</span><span class="num" id="8286352">0</span><span class="op" id="8286353">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286356">for</span>&nbsp;<span class="ident" id="8286360">i</span><span class="op" id="8286361">,</span>&nbsp;<span class="ident" id="8286363">want</span>&nbsp;<span class="op" id="8286368">:=</span>&nbsp;<span class="keyword" id="8286371">range</span>&nbsp;<span class="ident" id="8286377">rawTokens</span>&nbsp;<span class="op" id="8286387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286391">start</span>&nbsp;<span class="op" id="8286397">:=</span>&nbsp;<span class="ident" id="8286400">d</span><span class="op" id="8286401">.</span><span class="ident" id="8286402">InputOffset</span><span class="op" id="8286413">(</span><span class="op" id="8286414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286418">have</span><span class="op" id="8286422">,</span>&nbsp;<span class="ident" id="8286424">err</span>&nbsp;<span class="op" id="8286428">:=</span>&nbsp;<span class="ident" id="8286431">d</span><span class="op" id="8286432">.</span><span class="ident" id="8286433">RawToken</span><span class="op" id="8286441">(</span><span class="op" id="8286442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286446">end</span>&nbsp;<span class="op" id="8286450">:=</span>&nbsp;<span class="ident" id="8286453">d</span><span class="op" id="8286454">.</span><span class="ident" id="8286455">InputOffset</span><span class="op" id="8286466">(</span><span class="op" id="8286467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286471">if</span>&nbsp;<span class="ident" id="8286474">err</span>&nbsp;<span class="op" id="8286478">!=</span>&nbsp;<span class="builtintype" id="8286481">nil</span>&nbsp;<span class="op" id="8286485">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286490">t</span><span class="op" id="8286491">.</span><span class="ident" id="8286492">Fatalf</span><span class="op" id="8286498">(</span><span class="string" id="8286499">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8286531">,</span>&nbsp;<span class="ident" id="8286533">i</span><span class="op" id="8286534">,</span>&nbsp;<span class="ident" id="8286536">err</span><span class="op" id="8286539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286547">if</span>&nbsp;<span class="op" id="8286550">!</span><span class="ident" id="8286551">reflect</span><span class="op" id="8286558">.</span><span class="ident" id="8286559">DeepEqual</span><span class="op" id="8286568">(</span><span class="ident" id="8286569">have</span><span class="op" id="8286573">,</span>&nbsp;<span class="ident" id="8286575">want</span><span class="op" id="8286579">)</span>&nbsp;<span class="op" id="8286581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286586">var</span>&nbsp;<span class="ident" id="8286590">shave</span><span class="op" id="8286595">,</span>&nbsp;<span class="ident" id="8286597">swant</span>&nbsp;<span class="builtintype" id="8286603">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286613">if</span>&nbsp;<span class="ident" id="8286616">_</span><span class="op" id="8286617">,</span>&nbsp;<span class="ident" id="8286619">ok</span>&nbsp;<span class="op" id="8286622">:=</span>&nbsp;<span class="ident" id="8286625">have</span><span class="op" id="8286629">.</span><span class="op" id="8286630">(</span><span class="ident" id="8286631">CharData</span><span class="op" id="8286639">)</span><span class="op" id="8286640">;</span>&nbsp;<span class="ident" id="8286642">ok</span>&nbsp;<span class="op" id="8286645">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286651">shave</span>&nbsp;<span class="op" id="8286657">=</span>&nbsp;<span class="ident" id="8286659">fmt</span><span class="op" id="8286662">.</span><span class="ident" id="8286663">Sprintf</span><span class="op" id="8286670">(</span><span class="string" id="8286671">&#34;CharData(%q)&#34;</span><span class="op" id="8286685">,</span>&nbsp;<span class="ident" id="8286687">have</span><span class="op" id="8286691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286696">}</span>&nbsp;<span class="keyword" id="8286698">else</span>&nbsp;<span class="op" id="8286703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286709">shave</span>&nbsp;<span class="op" id="8286715">=</span>&nbsp;<span class="ident" id="8286717">fmt</span><span class="op" id="8286720">.</span><span class="ident" id="8286721">Sprintf</span><span class="op" id="8286728">(</span><span class="string" id="8286729">&#34;%#v&#34;</span><span class="op" id="8286734">,</span>&nbsp;<span class="ident" id="8286736">have</span><span class="op" id="8286740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286750">if</span>&nbsp;<span class="ident" id="8286753">_</span><span class="op" id="8286754">,</span>&nbsp;<span class="ident" id="8286756">ok</span>&nbsp;<span class="op" id="8286759">:=</span>&nbsp;<span class="ident" id="8286762">want</span><span class="op" id="8286766">.</span><span class="op" id="8286767">(</span><span class="ident" id="8286768">CharData</span><span class="op" id="8286776">)</span><span class="op" id="8286777">;</span>&nbsp;<span class="ident" id="8286779">ok</span>&nbsp;<span class="op" id="8286782">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286788">swant</span>&nbsp;<span class="op" id="8286794">=</span>&nbsp;<span class="ident" id="8286796">fmt</span><span class="op" id="8286799">.</span><span class="ident" id="8286800">Sprintf</span><span class="op" id="8286807">(</span><span class="string" id="8286808">&#34;CharData(%q)&#34;</span><span class="op" id="8286822">,</span>&nbsp;<span class="ident" id="8286824">want</span><span class="op" id="8286828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286833">}</span>&nbsp;<span class="keyword" id="8286835">else</span>&nbsp;<span class="op" id="8286840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286846">swant</span>&nbsp;<span class="op" id="8286852">=</span>&nbsp;<span class="ident" id="8286854">fmt</span><span class="op" id="8286857">.</span><span class="ident" id="8286858">Sprintf</span><span class="op" id="8286865">(</span><span class="string" id="8286866">&#34;%#v&#34;</span><span class="op" id="8286871">,</span>&nbsp;<span class="ident" id="8286873">want</span><span class="op" id="8286877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8286887">t</span><span class="op" id="8286888">.</span><span class="ident" id="8286889">Errorf</span><span class="op" id="8286895">(</span><span class="string" id="8286896">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8286920">,</span>&nbsp;<span class="ident" id="8286922">i</span><span class="op" id="8286923">,</span>&nbsp;<span class="ident" id="8286925">shave</span><span class="op" id="8286930">,</span>&nbsp;<span class="ident" id="8286932">swant</span><span class="op" id="8286937">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8286941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8286946">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8286997">switch</span>&nbsp;<span class="op" id="8287004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287008">case</span>&nbsp;<span class="ident" id="8287013">start</span>&nbsp;<span class="op" id="8287019">&lt;</span>&nbsp;<span class="ident" id="8287021">lastEnd</span><span class="op" id="8287028">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287033">t</span><span class="op" id="8287034">.</span><span class="ident" id="8287035">Errorf</span><span class="op" id="8287041">(</span><span class="string" id="8287042">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="8287102">,</span>&nbsp;<span class="ident" id="8287104">i</span><span class="op" id="8287105">,</span>&nbsp;<span class="ident" id="8287107">start</span><span class="op" id="8287112">,</span>&nbsp;<span class="ident" id="8287114">end</span><span class="op" id="8287117">,</span>&nbsp;<span class="ident" id="8287119">have</span><span class="op" id="8287123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287127">case</span>&nbsp;<span class="ident" id="8287132">start</span>&nbsp;<span class="op" id="8287138">&gt;=</span>&nbsp;<span class="ident" id="8287141">end</span><span class="op" id="8287144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8287149">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287200">if</span>&nbsp;<span class="ident" id="8287203">start</span>&nbsp;<span class="op" id="8287209">==</span>&nbsp;<span class="ident" id="8287212">end</span>&nbsp;<span class="op" id="8287216">&amp;&amp;</span>&nbsp;<span class="ident" id="8287219">end</span>&nbsp;<span class="op" id="8287223">==</span>&nbsp;<span class="ident" id="8287226">lastEnd</span>&nbsp;<span class="op" id="8287234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287240">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287254">t</span><span class="op" id="8287255">.</span><span class="ident" id="8287256">Errorf</span><span class="op" id="8287262">(</span><span class="string" id="8287263">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="8287307">,</span>&nbsp;<span class="ident" id="8287309">i</span><span class="op" id="8287310">,</span>&nbsp;<span class="ident" id="8287312">start</span><span class="op" id="8287317">,</span>&nbsp;<span class="ident" id="8287319">end</span><span class="op" id="8287322">,</span>&nbsp;<span class="ident" id="8287324">have</span><span class="op" id="8287328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287332">case</span>&nbsp;<span class="ident" id="8287337">end</span>&nbsp;<span class="op" id="8287341">&gt;</span>&nbsp;<span class="builtintype" id="8287343">int64</span><span class="op" id="8287348">(</span><span class="builtinfunc" id="8287349">len</span><span class="op" id="8287352">(</span><span class="ident" id="8287353">raw</span><span class="op" id="8287356">)</span><span class="op" id="8287357">)</span><span class="op" id="8287358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287363">t</span><span class="op" id="8287364">.</span><span class="ident" id="8287365">Errorf</span><span class="op" id="8287371">(</span><span class="string" id="8287372">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="8287428">,</span>&nbsp;<span class="ident" id="8287430">i</span><span class="op" id="8287431">,</span>&nbsp;<span class="ident" id="8287433">start</span><span class="op" id="8287438">,</span>&nbsp;<span class="ident" id="8287440">end</span><span class="op" id="8287443">,</span>&nbsp;<span class="ident" id="8287445">have</span><span class="op" id="8287449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287453">default</span><span class="op" id="8287460">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287465">text</span>&nbsp;<span class="op" id="8287470">:=</span>&nbsp;<span class="ident" id="8287473">raw</span><span class="op" id="8287476">[</span><span class="ident" id="8287477">start</span><span class="op" id="8287482">:</span><span class="ident" id="8287483">end</span><span class="op" id="8287486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8287491">if</span>&nbsp;<span class="ident" id="8287494">strings</span><span class="op" id="8287501">.</span><span class="ident" id="8287502">ContainsAny</span><span class="op" id="8287513">(</span><span class="ident" id="8287514">text</span><span class="op" id="8287518">,</span>&nbsp;<span class="string" id="8287520">&#34;&lt;&gt;&#34;</span><span class="op" id="8287524">)</span>&nbsp;<span class="op" id="8287526">&amp;&amp;</span>&nbsp;<span class="op" id="8287529">(</span><span class="op" id="8287530">!</span><span class="ident" id="8287531">strings</span><span class="op" id="8287538">.</span><span class="ident" id="8287539">HasPrefix</span><span class="op" id="8287548">(</span><span class="ident" id="8287549">text</span><span class="op" id="8287553">,</span>&nbsp;<span class="string" id="8287555">&#34;&lt;&#34;</span><span class="op" id="8287558">)</span>&nbsp;<span class="op" id="8287560">||</span>&nbsp;<span class="op" id="8287563">!</span><span class="ident" id="8287564">strings</span><span class="op" id="8287571">.</span><span class="ident" id="8287572">HasSuffix</span><span class="op" id="8287581">(</span><span class="ident" id="8287582">text</span><span class="op" id="8287586">,</span>&nbsp;<span class="string" id="8287588">&#34;&gt;&#34;</span><span class="op" id="8287591">)</span><span class="op" id="8287592">)</span>&nbsp;<span class="op" id="8287594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287600">t</span><span class="op" id="8287601">.</span><span class="ident" id="8287602">Errorf</span><span class="op" id="8287608">(</span><span class="string" id="8287609">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="8287652">,</span>&nbsp;<span class="ident" id="8287654">i</span><span class="op" id="8287655">,</span>&nbsp;<span class="ident" id="8287657">text</span><span class="op" id="8287661">,</span>&nbsp;<span class="ident" id="8287663">have</span><span class="op" id="8287667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287676">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8287680">lastEnd</span>&nbsp;<span class="op" id="8287688">=</span>&nbsp;<span class="ident" id="8287690">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8287695">}</span><br>
<span class="lineno"></span><span class="op" id="8287697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8287700">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="8287771">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="8287839">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8287897">var</span>&nbsp;<span class="ident" id="8287901">nestedDirectivesInput</span>&nbsp;<span class="op" id="8287923">=</span>&nbsp;<span class="string" id="8287925">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8288191">var</span>&nbsp;<span class="ident" id="8288195">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8288218">=</span>&nbsp;<span class="op" id="8288220">[</span><span class="op" id="8288221">]</span><span class="ident" id="8288222">Token</span><span class="op" id="8288227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288230">CharData</span><span class="op" id="8288238">(</span><span class="string" id="8288239">&#34;\n&#34;</span><span class="op" id="8288243">)</span><span class="op" id="8288244">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288247">Directive</span><span class="op" id="8288256">(</span><span class="string" id="8288257">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8288328">)</span><span class="op" id="8288329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288332">CharData</span><span class="op" id="8288340">(</span><span class="string" id="8288341">&#34;\n&#34;</span><span class="op" id="8288345">)</span><span class="op" id="8288346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288349">Directive</span><span class="op" id="8288358">(</span><span class="string" id="8288359">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="8288388">)</span><span class="op" id="8288389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288392">CharData</span><span class="op" id="8288400">(</span><span class="string" id="8288401">&#34;\n&#34;</span><span class="op" id="8288405">)</span><span class="op" id="8288406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288409">Directive</span><span class="op" id="8288418">(</span><span class="string" id="8288419">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="8288448">)</span><span class="op" id="8288449">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288452">CharData</span><span class="op" id="8288460">(</span><span class="string" id="8288461">&#34;\n&#34;</span><span class="op" id="8288465">)</span><span class="op" id="8288466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288469">Directive</span><span class="op" id="8288478">(</span><span class="string" id="8288479">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="8288508">)</span><span class="op" id="8288509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288512">CharData</span><span class="op" id="8288520">(</span><span class="string" id="8288521">&#34;\n&#34;</span><span class="op" id="8288525">)</span><span class="op" id="8288526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288529">Directive</span><span class="op" id="8288538">(</span><span class="string" id="8288539">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="8288568">)</span><span class="op" id="8288569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288572">CharData</span><span class="op" id="8288580">(</span><span class="string" id="8288581">&#34;\n&#34;</span><span class="op" id="8288585">)</span><span class="op" id="8288586">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288589">Directive</span><span class="op" id="8288598">(</span><span class="string" id="8288599">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="8288629">)</span><span class="op" id="8288630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288633">CharData</span><span class="op" id="8288641">(</span><span class="string" id="8288642">&#34;\n&#34;</span><span class="op" id="8288646">)</span><span class="op" id="8288647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288650">Directive</span><span class="op" id="8288659">(</span><span class="string" id="8288660">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="8288690">)</span><span class="op" id="8288691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288694">CharData</span><span class="op" id="8288702">(</span><span class="string" id="8288703">&#34;\n&#34;</span><span class="op" id="8288707">)</span><span class="op" id="8288708">,</span><br>
<span class="lineno"></span><span class="op" id="8288710">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="8288713">func</span>&nbsp;<span class="ident" id="8288718">TestNestedDirectives</span><span class="op" id="8288738">(</span><span class="ident" id="8288739">t</span>&nbsp;<span class="op" id="8288741">*</span><span class="ident" id="8288742">testing</span><span class="op" id="8288749">.</span><span class="ident" id="8288750">T</span><span class="op" id="8288751">)</span>&nbsp;<span class="op" id="8288753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288756">d</span>&nbsp;<span class="op" id="8288758">:=</span>&nbsp;<span class="ident" id="8288761">NewDecoder</span><span class="op" id="8288771">(</span><span class="ident" id="8288772">strings</span><span class="op" id="8288779">.</span><span class="ident" id="8288780">NewReader</span><span class="op" id="8288789">(</span><span class="ident" id="8288790">nestedDirectivesInput</span><span class="op" id="8288811">)</span><span class="op" id="8288812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288816">for</span>&nbsp;<span class="ident" id="8288820">i</span><span class="op" id="8288821">,</span>&nbsp;<span class="ident" id="8288823">want</span>&nbsp;<span class="op" id="8288828">:=</span>&nbsp;<span class="keyword" id="8288831">range</span>&nbsp;<span class="ident" id="8288837">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8288860">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288864">have</span><span class="op" id="8288868">,</span>&nbsp;<span class="ident" id="8288870">err</span>&nbsp;<span class="op" id="8288874">:=</span>&nbsp;<span class="ident" id="8288877">d</span><span class="op" id="8288878">.</span><span class="ident" id="8288879">Token</span><span class="op" id="8288884">(</span><span class="op" id="8288885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288889">if</span>&nbsp;<span class="ident" id="8288892">err</span>&nbsp;<span class="op" id="8288896">!=</span>&nbsp;<span class="builtintype" id="8288899">nil</span>&nbsp;<span class="op" id="8288903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8288908">t</span><span class="op" id="8288909">.</span><span class="ident" id="8288910">Fatalf</span><span class="op" id="8288916">(</span><span class="string" id="8288917">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8288949">,</span>&nbsp;<span class="ident" id="8288951">i</span><span class="op" id="8288952">,</span>&nbsp;<span class="ident" id="8288954">err</span><span class="op" id="8288957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8288961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8288965">if</span>&nbsp;<span class="op" id="8288968">!</span><span class="ident" id="8288969">reflect</span><span class="op" id="8288976">.</span><span class="ident" id="8288977">DeepEqual</span><span class="op" id="8288986">(</span><span class="ident" id="8288987">have</span><span class="op" id="8288991">,</span>&nbsp;<span class="ident" id="8288993">want</span><span class="op" id="8288997">)</span>&nbsp;<span class="op" id="8288999">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289004">t</span><span class="op" id="8289005">.</span><span class="ident" id="8289006">Errorf</span><span class="op" id="8289012">(</span><span class="string" id="8289013">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8289038">,</span>&nbsp;<span class="ident" id="8289040">i</span><span class="op" id="8289041">,</span>&nbsp;<span class="ident" id="8289043">have</span><span class="op" id="8289047">,</span>&nbsp;<span class="ident" id="8289049">want</span><span class="op" id="8289053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289060">}</span><br>
<span class="lineno"></span><span class="op" id="8289062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="8289065">func</span>&nbsp;<span class="ident" id="8289070">TestToken</span><span class="op" id="8289079">(</span><span class="ident" id="8289080">t</span>&nbsp;<span class="op" id="8289082">*</span><span class="ident" id="8289083">testing</span><span class="op" id="8289090">.</span><span class="ident" id="8289091">T</span><span class="op" id="8289092">)</span>&nbsp;<span class="op" id="8289094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289097">d</span>&nbsp;<span class="op" id="8289099">:=</span>&nbsp;<span class="ident" id="8289102">NewDecoder</span><span class="op" id="8289112">(</span><span class="ident" id="8289113">strings</span><span class="op" id="8289120">.</span><span class="ident" id="8289121">NewReader</span><span class="op" id="8289130">(</span><span class="ident" id="8289131">testInput</span><span class="op" id="8289140">)</span><span class="op" id="8289141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289144">d</span><span class="op" id="8289145">.</span><span class="ident" id="8289146">Entity</span>&nbsp;<span class="op" id="8289153">=</span>&nbsp;<span class="ident" id="8289155">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289168">for</span>&nbsp;<span class="ident" id="8289172">i</span><span class="op" id="8289173">,</span>&nbsp;<span class="ident" id="8289175">want</span>&nbsp;<span class="op" id="8289180">:=</span>&nbsp;<span class="keyword" id="8289183">range</span>&nbsp;<span class="ident" id="8289189">cookedTokens</span>&nbsp;<span class="op" id="8289202">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289206">have</span><span class="op" id="8289210">,</span>&nbsp;<span class="ident" id="8289212">err</span>&nbsp;<span class="op" id="8289216">:=</span>&nbsp;<span class="ident" id="8289219">d</span><span class="op" id="8289220">.</span><span class="ident" id="8289221">Token</span><span class="op" id="8289226">(</span><span class="op" id="8289227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289231">if</span>&nbsp;<span class="ident" id="8289234">err</span>&nbsp;<span class="op" id="8289238">!=</span>&nbsp;<span class="builtintype" id="8289241">nil</span>&nbsp;<span class="op" id="8289245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289250">t</span><span class="op" id="8289251">.</span><span class="ident" id="8289252">Fatalf</span><span class="op" id="8289258">(</span><span class="string" id="8289259">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8289291">,</span>&nbsp;<span class="ident" id="8289293">i</span><span class="op" id="8289294">,</span>&nbsp;<span class="ident" id="8289296">err</span><span class="op" id="8289299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289307">if</span>&nbsp;<span class="op" id="8289310">!</span><span class="ident" id="8289311">reflect</span><span class="op" id="8289318">.</span><span class="ident" id="8289319">DeepEqual</span><span class="op" id="8289328">(</span><span class="ident" id="8289329">have</span><span class="op" id="8289333">,</span>&nbsp;<span class="ident" id="8289335">want</span><span class="op" id="8289339">)</span>&nbsp;<span class="op" id="8289341">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289346">t</span><span class="op" id="8289347">.</span><span class="ident" id="8289348">Errorf</span><span class="op" id="8289354">(</span><span class="string" id="8289355">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8289380">,</span>&nbsp;<span class="ident" id="8289382">i</span><span class="op" id="8289383">,</span>&nbsp;<span class="ident" id="8289385">have</span><span class="op" id="8289389">,</span>&nbsp;<span class="ident" id="8289391">want</span><span class="op" id="8289395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289402">}</span><br>
<span class="lineno"></span><span class="op" id="8289404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="8289407">func</span>&nbsp;<span class="ident" id="8289412">TestSyntax</span><span class="op" id="8289422">(</span><span class="ident" id="8289423">t</span>&nbsp;<span class="op" id="8289425">*</span><span class="ident" id="8289426">testing</span><span class="op" id="8289433">.</span><span class="ident" id="8289434">T</span><span class="op" id="8289435">)</span>&nbsp;<span class="op" id="8289437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289440">for</span>&nbsp;<span class="ident" id="8289444">i</span>&nbsp;<span class="op" id="8289446">:=</span>&nbsp;<span class="keyword" id="8289449">range</span>&nbsp;<span class="ident" id="8289455">xmlInput</span>&nbsp;<span class="op" id="8289464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289468">d</span>&nbsp;<span class="op" id="8289470">:=</span>&nbsp;<span class="ident" id="8289473">NewDecoder</span><span class="op" id="8289483">(</span><span class="ident" id="8289484">strings</span><span class="op" id="8289491">.</span><span class="ident" id="8289492">NewReader</span><span class="op" id="8289501">(</span><span class="ident" id="8289502">xmlInput</span><span class="op" id="8289510">[</span><span class="ident" id="8289511">i</span><span class="op" id="8289512">]</span><span class="op" id="8289513">)</span><span class="op" id="8289514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289518">var</span>&nbsp;<span class="ident" id="8289522">err</span>&nbsp;<span class="builtintype" id="8289526">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289534">for</span>&nbsp;<span class="ident" id="8289538">_</span><span class="op" id="8289539">,</span>&nbsp;<span class="ident" id="8289541">err</span>&nbsp;<span class="op" id="8289545">=</span>&nbsp;<span class="ident" id="8289547">d</span><span class="op" id="8289548">.</span><span class="ident" id="8289549">Token</span><span class="op" id="8289554">(</span><span class="op" id="8289555">)</span><span class="op" id="8289556">;</span>&nbsp;<span class="ident" id="8289558">err</span>&nbsp;<span class="op" id="8289562">==</span>&nbsp;<span class="builtintype" id="8289565">nil</span><span class="op" id="8289568">;</span>&nbsp;<span class="ident" id="8289570">_</span><span class="op" id="8289571">,</span>&nbsp;<span class="ident" id="8289573">err</span>&nbsp;<span class="op" id="8289577">=</span>&nbsp;<span class="ident" id="8289579">d</span><span class="op" id="8289580">.</span><span class="ident" id="8289581">Token</span><span class="op" id="8289586">(</span><span class="op" id="8289587">)</span>&nbsp;<span class="op" id="8289589">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8289597">if</span>&nbsp;<span class="ident" id="8289600">_</span><span class="op" id="8289601">,</span>&nbsp;<span class="ident" id="8289603">ok</span>&nbsp;<span class="op" id="8289606">:=</span>&nbsp;<span class="ident" id="8289609">err</span><span class="op" id="8289612">.</span><span class="op" id="8289613">(</span><span class="op" id="8289614">*</span><span class="ident" id="8289615">SyntaxError</span><span class="op" id="8289626">)</span><span class="op" id="8289627">;</span>&nbsp;<span class="op" id="8289629">!</span><span class="ident" id="8289630">ok</span>&nbsp;<span class="op" id="8289633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289638">t</span><span class="op" id="8289639">.</span><span class="ident" id="8289640">Fatalf</span><span class="op" id="8289646">(</span><span class="string" id="8289647">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="8289697">,</span>&nbsp;<span class="ident" id="8289699">xmlInput</span><span class="op" id="8289707">[</span><span class="ident" id="8289708">i</span><span class="op" id="8289709">]</span><span class="op" id="8289710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8289717">}</span><br>
<span class="lineno">400</span><span class="op" id="8289719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8289722">type</span>&nbsp;<span class="ident" id="8289727">allScalars</span>&nbsp;<span class="keyword" id="8289738">struct</span>&nbsp;<span class="op" id="8289745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289748">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289758">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289764">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289774">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289780">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289790">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289796">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289806">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289812">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289822">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289827">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289837">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289843">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289853">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289860">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289870">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289877">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289887">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289894">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289904">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289909">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289919">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289926">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289936">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289944">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289954">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289962">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289972">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289980">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8289990">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8289999">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290009">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290018">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290028">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290037">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290047">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290055">PtrString</span>&nbsp;<span class="op" id="8290065">*</span><span class="builtintype" id="8290066">string</span><br>
<span class="lineno"></span><span class="op" id="8290073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8290076">var</span>&nbsp;<span class="ident" id="8290080">all</span>&nbsp;<span class="op" id="8290084">=</span>&nbsp;<span class="ident" id="8290086">allScalars</span><span class="op" id="8290096">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290099">True1</span><span class="op" id="8290104">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290110">true</span><span class="op" id="8290114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290117">True2</span><span class="op" id="8290122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290128">true</span><span class="op" id="8290132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290135">False1</span><span class="op" id="8290141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290146">false</span><span class="op" id="8290151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290154">False2</span><span class="op" id="8290160">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8290165">false</span><span class="op" id="8290170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290173">Int</span><span class="op" id="8290176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290184">1</span><span class="op" id="8290185">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290188">Int8</span><span class="op" id="8290192">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290199">-</span><span class="num" id="8290200">2</span><span class="op" id="8290201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290204">Int16</span><span class="op" id="8290209">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290215">3</span><span class="op" id="8290216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290219">Int32</span><span class="op" id="8290224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8290230">-</span><span class="num" id="8290231">4</span><span class="op" id="8290232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290235">Int64</span><span class="op" id="8290240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290246">5</span><span class="op" id="8290247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290250">Uint</span><span class="op" id="8290254">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290261">6</span><span class="op" id="8290262">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290265">Uint8</span><span class="op" id="8290270">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290276">7</span><span class="op" id="8290277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290280">Uint16</span><span class="op" id="8290286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290291">8</span><span class="op" id="8290292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290295">Uint32</span><span class="op" id="8290301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290306">9</span><span class="op" id="8290307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290310">Uint64</span><span class="op" id="8290316">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8290321">10</span><span class="op" id="8290323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290326">Uintptr</span><span class="op" id="8290333">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8290337">11</span><span class="op" id="8290339">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290342">Float32</span><span class="op" id="8290349">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8290353">13.0</span><span class="op" id="8290357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290360">Float64</span><span class="op" id="8290367">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8290371">14.0</span><span class="op" id="8290375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290378">String</span><span class="op" id="8290384">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8290389">&#34;15&#34;</span><span class="op" id="8290393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290396">PtrString</span><span class="op" id="8290405">:</span>&nbsp;<span class="op" id="8290407">&amp;</span><span class="ident" id="8290408">sixteen</span><span class="op" id="8290415">,</span><br>
<span class="lineno"></span><span class="op" id="8290417">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8290420">var</span>&nbsp;<span class="ident" id="8290424">sixteen</span>&nbsp;<span class="op" id="8290432">=</span>&nbsp;<span class="string" id="8290434">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8290440">const</span>&nbsp;<span class="ident" id="8290446">testScalarsInput</span>&nbsp;<span class="op" id="8290463">=</span>&nbsp;<span class="string" id="8290465">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="8290901">func</span>&nbsp;<span class="ident" id="8290906">TestAllScalars</span><span class="op" id="8290920">(</span><span class="ident" id="8290921">t</span>&nbsp;<span class="op" id="8290923">*</span><span class="ident" id="8290924">testing</span><span class="op" id="8290931">.</span><span class="ident" id="8290932">T</span><span class="op" id="8290933">)</span>&nbsp;<span class="op" id="8290935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8290938">var</span>&nbsp;<span class="ident" id="8290942">a</span>&nbsp;<span class="ident" id="8290944">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8290956">err</span>&nbsp;<span class="op" id="8290960">:=</span>&nbsp;<span class="ident" id="8290963">Unmarshal</span><span class="op" id="8290972">(</span><span class="op" id="8290973">[</span><span class="op" id="8290974">]</span><span class="builtintype" id="8290975">byte</span><span class="op" id="8290979">(</span><span class="ident" id="8290980">testScalarsInput</span><span class="op" id="8290996">)</span><span class="op" id="8290997">,</span>&nbsp;<span class="op" id="8290999">&amp;</span><span class="ident" id="8291000">a</span><span class="op" id="8291001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291005">if</span>&nbsp;<span class="ident" id="8291008">err</span>&nbsp;<span class="op" id="8291012">!=</span>&nbsp;<span class="builtintype" id="8291015">nil</span>&nbsp;<span class="op" id="8291019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291023">t</span><span class="op" id="8291024">.</span><span class="ident" id="8291025">Fatal</span><span class="op" id="8291030">(</span><span class="ident" id="8291031">err</span><span class="op" id="8291034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291040">if</span>&nbsp;<span class="op" id="8291043">!</span><span class="ident" id="8291044">reflect</span><span class="op" id="8291051">.</span><span class="ident" id="8291052">DeepEqual</span><span class="op" id="8291061">(</span><span class="ident" id="8291062">a</span><span class="op" id="8291063">,</span>&nbsp;<span class="ident" id="8291065">all</span><span class="op" id="8291068">)</span>&nbsp;<span class="op" id="8291070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291074">t</span><span class="op" id="8291075">.</span><span class="ident" id="8291076">Errorf</span><span class="op" id="8291082">(</span><span class="string" id="8291083">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="8291102">,</span>&nbsp;<span class="ident" id="8291104">a</span><span class="op" id="8291105">,</span>&nbsp;<span class="ident" id="8291107">all</span><span class="op" id="8291110">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291113">}</span><br>
<span class="lineno"></span><span class="op" id="8291115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291118">type</span>&nbsp;<span class="ident" id="8291123">item</span>&nbsp;<span class="keyword" id="8291128">struct</span>&nbsp;<span class="op" id="8291135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291138">Field_a</span>&nbsp;<span class="builtintype" id="8291146">string</span><br>
<span class="lineno">485</span><span class="op" id="8291153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291156">func</span>&nbsp;<span class="ident" id="8291161">TestIssue569</span><span class="op" id="8291173">(</span><span class="ident" id="8291174">t</span>&nbsp;<span class="op" id="8291176">*</span><span class="ident" id="8291177">testing</span><span class="op" id="8291184">.</span><span class="ident" id="8291185">T</span><span class="op" id="8291186">)</span>&nbsp;<span class="op" id="8291188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291191">data</span>&nbsp;<span class="op" id="8291196">:=</span>&nbsp;<span class="string" id="8291199">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291239">var</span>&nbsp;<span class="ident" id="8291243">i</span>&nbsp;<span class="ident" id="8291245">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291251">err</span>&nbsp;<span class="op" id="8291255">:=</span>&nbsp;<span class="ident" id="8291258">Unmarshal</span><span class="op" id="8291267">(</span><span class="op" id="8291268">[</span><span class="op" id="8291269">]</span><span class="builtintype" id="8291270">byte</span><span class="op" id="8291274">(</span><span class="ident" id="8291275">data</span><span class="op" id="8291279">)</span><span class="op" id="8291280">,</span>&nbsp;<span class="op" id="8291282">&amp;</span><span class="ident" id="8291283">i</span><span class="op" id="8291284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291288">if</span>&nbsp;<span class="ident" id="8291291">err</span>&nbsp;<span class="op" id="8291295">!=</span>&nbsp;<span class="builtintype" id="8291298">nil</span>&nbsp;<span class="op" id="8291302">||</span>&nbsp;<span class="ident" id="8291305">i</span><span class="op" id="8291306">.</span><span class="ident" id="8291307">Field_a</span>&nbsp;<span class="op" id="8291315">!=</span>&nbsp;<span class="string" id="8291318">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8291325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291329">t</span><span class="op" id="8291330">.</span><span class="ident" id="8291331">Fatal</span><span class="op" id="8291336">(</span><span class="string" id="8291337">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="8291353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291356">}</span><br>
<span class="lineno">495</span><span class="op" id="8291358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291361">func</span>&nbsp;<span class="ident" id="8291366">TestUnquotedAttrs</span><span class="op" id="8291383">(</span><span class="ident" id="8291384">t</span>&nbsp;<span class="op" id="8291386">*</span><span class="ident" id="8291387">testing</span><span class="op" id="8291394">.</span><span class="ident" id="8291395">T</span><span class="op" id="8291396">)</span>&nbsp;<span class="op" id="8291398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291401">data</span>&nbsp;<span class="op" id="8291406">:=</span>&nbsp;<span class="string" id="8291409">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291435">d</span>&nbsp;<span class="op" id="8291437">:=</span>&nbsp;<span class="ident" id="8291440">NewDecoder</span><span class="op" id="8291450">(</span><span class="ident" id="8291451">strings</span><span class="op" id="8291458">.</span><span class="ident" id="8291459">NewReader</span><span class="op" id="8291468">(</span><span class="ident" id="8291469">data</span><span class="op" id="8291473">)</span><span class="op" id="8291474">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291477">d</span><span class="op" id="8291478">.</span><span class="ident" id="8291479">Strict</span>&nbsp;<span class="op" id="8291486">=</span>&nbsp;<span class="builtintype" id="8291488">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291495">token</span><span class="op" id="8291500">,</span>&nbsp;<span class="ident" id="8291502">err</span>&nbsp;<span class="op" id="8291506">:=</span>&nbsp;<span class="ident" id="8291509">d</span><span class="op" id="8291510">.</span><span class="ident" id="8291511">Token</span><span class="op" id="8291516">(</span><span class="op" id="8291517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291520">if</span>&nbsp;<span class="ident" id="8291523">_</span><span class="op" id="8291524">,</span>&nbsp;<span class="ident" id="8291526">ok</span>&nbsp;<span class="op" id="8291529">:=</span>&nbsp;<span class="ident" id="8291532">err</span><span class="op" id="8291535">.</span><span class="op" id="8291536">(</span><span class="op" id="8291537">*</span><span class="ident" id="8291538">SyntaxError</span><span class="op" id="8291549">)</span><span class="op" id="8291550">;</span>&nbsp;<span class="ident" id="8291552">ok</span>&nbsp;<span class="op" id="8291555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291559">t</span><span class="op" id="8291560">.</span><span class="ident" id="8291561">Errorf</span><span class="op" id="8291567">(</span><span class="string" id="8291568">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8291590">,</span>&nbsp;<span class="ident" id="8291592">err</span><span class="op" id="8291595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291598">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291601">if</span>&nbsp;<span class="ident" id="8291604">token</span><span class="op" id="8291609">.</span><span class="op" id="8291610">(</span><span class="ident" id="8291611">StartElement</span><span class="op" id="8291623">)</span><span class="op" id="8291624">.</span><span class="ident" id="8291625">Name</span><span class="op" id="8291629">.</span><span class="ident" id="8291630">Local</span>&nbsp;<span class="op" id="8291636">!=</span>&nbsp;<span class="string" id="8291639">&#34;tag&#34;</span>&nbsp;<span class="op" id="8291645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291649">t</span><span class="op" id="8291650">.</span><span class="ident" id="8291651">Errorf</span><span class="op" id="8291657">(</span><span class="string" id="8291658">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8291683">,</span>&nbsp;<span class="ident" id="8291685">token</span><span class="op" id="8291690">.</span><span class="op" id="8291691">(</span><span class="ident" id="8291692">StartElement</span><span class="op" id="8291704">)</span><span class="op" id="8291705">.</span><span class="ident" id="8291706">Name</span><span class="op" id="8291710">.</span><span class="ident" id="8291711">Local</span><span class="op" id="8291716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291722">attr</span>&nbsp;<span class="op" id="8291727">:=</span>&nbsp;<span class="ident" id="8291730">token</span><span class="op" id="8291735">.</span><span class="op" id="8291736">(</span><span class="ident" id="8291737">StartElement</span><span class="op" id="8291749">)</span><span class="op" id="8291750">.</span><span class="ident" id="8291751">Attr</span><span class="op" id="8291755">[</span><span class="num" id="8291756">0</span><span class="op" id="8291757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291760">if</span>&nbsp;<span class="ident" id="8291763">attr</span><span class="op" id="8291767">.</span><span class="ident" id="8291768">Value</span>&nbsp;<span class="op" id="8291774">!=</span>&nbsp;<span class="string" id="8291777">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="8291789">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291793">t</span><span class="op" id="8291794">.</span><span class="ident" id="8291795">Errorf</span><span class="op" id="8291801">(</span><span class="string" id="8291802">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8291834">,</span>&nbsp;<span class="ident" id="8291836">attr</span><span class="op" id="8291840">.</span><span class="ident" id="8291841">Value</span><span class="op" id="8291846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8291852">if</span>&nbsp;<span class="ident" id="8291855">attr</span><span class="op" id="8291859">.</span><span class="ident" id="8291860">Name</span><span class="op" id="8291864">.</span><span class="ident" id="8291865">Local</span>&nbsp;<span class="op" id="8291871">!=</span>&nbsp;<span class="string" id="8291874">&#34;attr&#34;</span>&nbsp;<span class="op" id="8291881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291885">t</span><span class="op" id="8291886">.</span><span class="ident" id="8291887">Errorf</span><span class="op" id="8291893">(</span><span class="string" id="8291894">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8291925">,</span>&nbsp;<span class="ident" id="8291927">attr</span><span class="op" id="8291931">.</span><span class="ident" id="8291932">Name</span><span class="op" id="8291936">.</span><span class="ident" id="8291937">Local</span><span class="op" id="8291942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8291945">}</span><br>
<span class="lineno">515</span><span class="op" id="8291947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8291950">func</span>&nbsp;<span class="ident" id="8291955">TestValuelessAttrs</span><span class="op" id="8291973">(</span><span class="ident" id="8291974">t</span>&nbsp;<span class="op" id="8291976">*</span><span class="ident" id="8291977">testing</span><span class="op" id="8291984">.</span><span class="ident" id="8291985">T</span><span class="op" id="8291986">)</span>&nbsp;<span class="op" id="8291988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8291991">tests</span>&nbsp;<span class="op" id="8291997">:=</span>&nbsp;<span class="op" id="8292000">[</span><span class="op" id="8292001">]</span><span class="op" id="8292002">[</span><span class="num" id="8292003">3</span><span class="op" id="8292004">]</span><span class="builtintype" id="8292005">string</span><span class="op" id="8292011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292015">{</span><span class="string" id="8292016">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="8292028">,</span>&nbsp;<span class="string" id="8292030">&#34;p&#34;</span><span class="op" id="8292033">,</span>&nbsp;<span class="string" id="8292035">&#34;nowrap&#34;</span><span class="op" id="8292043">}</span><span class="op" id="8292044">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292048">{</span><span class="string" id="8292049">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="8292062">,</span>&nbsp;<span class="string" id="8292064">&#34;p&#34;</span><span class="op" id="8292067">,</span>&nbsp;<span class="string" id="8292069">&#34;nowrap&#34;</span><span class="op" id="8292077">}</span><span class="op" id="8292078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292082">{</span><span class="string" id="8292083">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="8292101">,</span>&nbsp;<span class="string" id="8292103">&#34;input&#34;</span><span class="op" id="8292110">,</span>&nbsp;<span class="string" id="8292112">&#34;checked&#34;</span><span class="op" id="8292121">}</span><span class="op" id="8292122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292126">{</span><span class="string" id="8292127">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="8292146">,</span>&nbsp;<span class="string" id="8292148">&#34;input&#34;</span><span class="op" id="8292155">,</span>&nbsp;<span class="string" id="8292157">&#34;checked&#34;</span><span class="op" id="8292166">}</span><span class="op" id="8292167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292173">for</span>&nbsp;<span class="ident" id="8292177">_</span><span class="op" id="8292178">,</span>&nbsp;<span class="ident" id="8292180">test</span>&nbsp;<span class="op" id="8292185">:=</span>&nbsp;<span class="keyword" id="8292188">range</span>&nbsp;<span class="ident" id="8292194">tests</span>&nbsp;<span class="op" id="8292200">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292204">d</span>&nbsp;<span class="op" id="8292206">:=</span>&nbsp;<span class="ident" id="8292209">NewDecoder</span><span class="op" id="8292219">(</span><span class="ident" id="8292220">strings</span><span class="op" id="8292227">.</span><span class="ident" id="8292228">NewReader</span><span class="op" id="8292237">(</span><span class="ident" id="8292238">test</span><span class="op" id="8292242">[</span><span class="num" id="8292243">0</span><span class="op" id="8292244">]</span><span class="op" id="8292245">)</span><span class="op" id="8292246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292250">d</span><span class="op" id="8292251">.</span><span class="ident" id="8292252">Strict</span>&nbsp;<span class="op" id="8292259">=</span>&nbsp;<span class="builtintype" id="8292261">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292269">token</span><span class="op" id="8292274">,</span>&nbsp;<span class="ident" id="8292276">err</span>&nbsp;<span class="op" id="8292280">:=</span>&nbsp;<span class="ident" id="8292283">d</span><span class="op" id="8292284">.</span><span class="ident" id="8292285">Token</span><span class="op" id="8292290">(</span><span class="op" id="8292291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292295">if</span>&nbsp;<span class="ident" id="8292298">_</span><span class="op" id="8292299">,</span>&nbsp;<span class="ident" id="8292301">ok</span>&nbsp;<span class="op" id="8292304">:=</span>&nbsp;<span class="ident" id="8292307">err</span><span class="op" id="8292310">.</span><span class="op" id="8292311">(</span><span class="op" id="8292312">*</span><span class="ident" id="8292313">SyntaxError</span><span class="op" id="8292324">)</span><span class="op" id="8292325">;</span>&nbsp;<span class="ident" id="8292327">ok</span>&nbsp;<span class="op" id="8292330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292335">t</span><span class="op" id="8292336">.</span><span class="ident" id="8292337">Errorf</span><span class="op" id="8292343">(</span><span class="string" id="8292344">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8292366">,</span>&nbsp;<span class="ident" id="8292368">err</span><span class="op" id="8292371">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292379">if</span>&nbsp;<span class="ident" id="8292382">token</span><span class="op" id="8292387">.</span><span class="op" id="8292388">(</span><span class="ident" id="8292389">StartElement</span><span class="op" id="8292401">)</span><span class="op" id="8292402">.</span><span class="ident" id="8292403">Name</span><span class="op" id="8292407">.</span><span class="ident" id="8292408">Local</span>&nbsp;<span class="op" id="8292414">!=</span>&nbsp;<span class="ident" id="8292417">test</span><span class="op" id="8292421">[</span><span class="num" id="8292422">1</span><span class="op" id="8292423">]</span>&nbsp;<span class="op" id="8292425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292430">t</span><span class="op" id="8292431">.</span><span class="ident" id="8292432">Errorf</span><span class="op" id="8292438">(</span><span class="string" id="8292439">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8292464">,</span>&nbsp;<span class="ident" id="8292466">token</span><span class="op" id="8292471">.</span><span class="op" id="8292472">(</span><span class="ident" id="8292473">StartElement</span><span class="op" id="8292485">)</span><span class="op" id="8292486">.</span><span class="ident" id="8292487">Name</span><span class="op" id="8292491">.</span><span class="ident" id="8292492">Local</span><span class="op" id="8292497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292505">attr</span>&nbsp;<span class="op" id="8292510">:=</span>&nbsp;<span class="ident" id="8292513">token</span><span class="op" id="8292518">.</span><span class="op" id="8292519">(</span><span class="ident" id="8292520">StartElement</span><span class="op" id="8292532">)</span><span class="op" id="8292533">.</span><span class="ident" id="8292534">Attr</span><span class="op" id="8292538">[</span><span class="num" id="8292539">0</span><span class="op" id="8292540">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292544">if</span>&nbsp;<span class="ident" id="8292547">attr</span><span class="op" id="8292551">.</span><span class="ident" id="8292552">Value</span>&nbsp;<span class="op" id="8292558">!=</span>&nbsp;<span class="ident" id="8292561">test</span><span class="op" id="8292565">[</span><span class="num" id="8292566">2</span><span class="op" id="8292567">]</span>&nbsp;<span class="op" id="8292569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292574">t</span><span class="op" id="8292575">.</span><span class="ident" id="8292576">Errorf</span><span class="op" id="8292582">(</span><span class="string" id="8292583">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8292615">,</span>&nbsp;<span class="ident" id="8292617">attr</span><span class="op" id="8292621">.</span><span class="ident" id="8292622">Value</span><span class="op" id="8292627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292635">if</span>&nbsp;<span class="ident" id="8292638">attr</span><span class="op" id="8292642">.</span><span class="ident" id="8292643">Name</span><span class="op" id="8292647">.</span><span class="ident" id="8292648">Local</span>&nbsp;<span class="op" id="8292654">!=</span>&nbsp;<span class="ident" id="8292657">test</span><span class="op" id="8292661">[</span><span class="num" id="8292662">2</span><span class="op" id="8292663">]</span>&nbsp;<span class="op" id="8292665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292670">t</span><span class="op" id="8292671">.</span><span class="ident" id="8292672">Errorf</span><span class="op" id="8292678">(</span><span class="string" id="8292679">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8292710">,</span>&nbsp;<span class="ident" id="8292712">attr</span><span class="op" id="8292716">.</span><span class="ident" id="8292717">Name</span><span class="op" id="8292721">.</span><span class="ident" id="8292722">Local</span><span class="op" id="8292727">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292734">}</span><br>
<span class="lineno"></span><span class="op" id="8292736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8292739">func</span>&nbsp;<span class="ident" id="8292744">TestCopyTokenCharData</span><span class="op" id="8292765">(</span><span class="ident" id="8292766">t</span>&nbsp;<span class="op" id="8292768">*</span><span class="ident" id="8292769">testing</span><span class="op" id="8292776">.</span><span class="ident" id="8292777">T</span><span class="op" id="8292778">)</span>&nbsp;<span class="op" id="8292780">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292783">data</span>&nbsp;<span class="op" id="8292788">:=</span>&nbsp;<span class="op" id="8292791">[</span><span class="op" id="8292792">]</span><span class="builtintype" id="8292793">byte</span><span class="op" id="8292797">(</span><span class="string" id="8292798">&#34;same&nbsp;data&#34;</span><span class="op" id="8292809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292812">var</span>&nbsp;<span class="ident" id="8292816">tok1</span>&nbsp;<span class="ident" id="8292821">Token</span>&nbsp;<span class="op" id="8292827">=</span>&nbsp;<span class="ident" id="8292829">CharData</span><span class="op" id="8292837">(</span><span class="ident" id="8292838">data</span><span class="op" id="8292842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292845">tok2</span>&nbsp;<span class="op" id="8292850">:=</span>&nbsp;<span class="ident" id="8292853">CopyToken</span><span class="op" id="8292862">(</span><span class="ident" id="8292863">tok1</span><span class="op" id="8292867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292870">if</span>&nbsp;<span class="op" id="8292873">!</span><span class="ident" id="8292874">reflect</span><span class="op" id="8292881">.</span><span class="ident" id="8292882">DeepEqual</span><span class="op" id="8292891">(</span><span class="ident" id="8292892">tok1</span><span class="op" id="8292896">,</span>&nbsp;<span class="ident" id="8292898">tok2</span><span class="op" id="8292902">)</span>&nbsp;<span class="op" id="8292904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292908">t</span><span class="op" id="8292909">.</span><span class="ident" id="8292910">Error</span><span class="op" id="8292915">(</span><span class="string" id="8292916">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="8292949">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8292952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8292955">data</span><span class="op" id="8292959">[</span><span class="num" id="8292960">1</span><span class="op" id="8292961">]</span>&nbsp;<span class="op" id="8292963">=</span>&nbsp;<span class="string" id="8292965">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8292970">if</span>&nbsp;<span class="ident" id="8292973">reflect</span><span class="op" id="8292980">.</span><span class="ident" id="8292981">DeepEqual</span><span class="op" id="8292990">(</span><span class="ident" id="8292991">tok1</span><span class="op" id="8292995">,</span>&nbsp;<span class="ident" id="8292997">tok2</span><span class="op" id="8293001">)</span>&nbsp;<span class="op" id="8293003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293007">t</span><span class="op" id="8293008">.</span><span class="ident" id="8293009">Error</span><span class="op" id="8293014">(</span><span class="string" id="8293015">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8293054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293057">}</span><br>
<span class="lineno">555</span><span class="op" id="8293059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293062">func</span>&nbsp;<span class="ident" id="8293067">TestCopyTokenStartElement</span><span class="op" id="8293092">(</span><span class="ident" id="8293093">t</span>&nbsp;<span class="op" id="8293095">*</span><span class="ident" id="8293096">testing</span><span class="op" id="8293103">.</span><span class="ident" id="8293104">T</span><span class="op" id="8293105">)</span>&nbsp;<span class="op" id="8293107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293110">elt</span>&nbsp;<span class="op" id="8293114">:=</span>&nbsp;<span class="ident" id="8293117">StartElement</span><span class="op" id="8293129">{</span><span class="ident" id="8293130">Name</span><span class="op" id="8293134">{</span><span class="string" id="8293135">&#34;&#34;</span><span class="op" id="8293137">,</span>&nbsp;<span class="string" id="8293139">&#34;hello&#34;</span><span class="op" id="8293146">}</span><span class="op" id="8293147">,</span>&nbsp;<span class="op" id="8293149">[</span><span class="op" id="8293150">]</span><span class="ident" id="8293151">Attr</span><span class="op" id="8293155">{</span><span class="op" id="8293156">{</span><span class="ident" id="8293157">Name</span><span class="op" id="8293161">{</span><span class="string" id="8293162">&#34;&#34;</span><span class="op" id="8293164">,</span>&nbsp;<span class="string" id="8293166">&#34;lang&#34;</span><span class="op" id="8293172">}</span><span class="op" id="8293173">,</span>&nbsp;<span class="string" id="8293175">&#34;en&#34;</span><span class="op" id="8293179">}</span><span class="op" id="8293180">}</span><span class="op" id="8293181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293184">var</span>&nbsp;<span class="ident" id="8293188">tok1</span>&nbsp;<span class="ident" id="8293193">Token</span>&nbsp;<span class="op" id="8293199">=</span>&nbsp;<span class="ident" id="8293201">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293206">tok2</span>&nbsp;<span class="op" id="8293211">:=</span>&nbsp;<span class="ident" id="8293214">CopyToken</span><span class="op" id="8293223">(</span><span class="ident" id="8293224">tok1</span><span class="op" id="8293228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293231">if</span>&nbsp;<span class="ident" id="8293234">tok1</span><span class="op" id="8293238">.</span><span class="op" id="8293239">(</span><span class="ident" id="8293240">StartElement</span><span class="op" id="8293252">)</span><span class="op" id="8293253">.</span><span class="ident" id="8293254">Attr</span><span class="op" id="8293258">[</span><span class="num" id="8293259">0</span><span class="op" id="8293260">]</span><span class="op" id="8293261">.</span><span class="ident" id="8293262">Value</span>&nbsp;<span class="op" id="8293268">!=</span>&nbsp;<span class="string" id="8293271">&#34;en&#34;</span>&nbsp;<span class="op" id="8293276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293280">t</span><span class="op" id="8293281">.</span><span class="ident" id="8293282">Error</span><span class="op" id="8293287">(</span><span class="string" id="8293288">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="8293317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293323">if</span>&nbsp;<span class="op" id="8293326">!</span><span class="ident" id="8293327">reflect</span><span class="op" id="8293334">.</span><span class="ident" id="8293335">DeepEqual</span><span class="op" id="8293344">(</span><span class="ident" id="8293345">tok1</span><span class="op" id="8293349">,</span>&nbsp;<span class="ident" id="8293351">tok2</span><span class="op" id="8293355">)</span>&nbsp;<span class="op" id="8293357">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293361">t</span><span class="op" id="8293362">.</span><span class="ident" id="8293363">Error</span><span class="op" id="8293368">(</span><span class="string" id="8293369">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="8293410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293416">tok1</span><span class="op" id="8293420">.</span><span class="op" id="8293421">(</span><span class="ident" id="8293422">StartElement</span><span class="op" id="8293434">)</span><span class="op" id="8293435">.</span><span class="ident" id="8293436">Attr</span><span class="op" id="8293440">[</span><span class="num" id="8293441">0</span><span class="op" id="8293442">]</span>&nbsp;<span class="op" id="8293444">=</span>&nbsp;<span class="ident" id="8293446">Attr</span><span class="op" id="8293450">{</span><span class="ident" id="8293451">Name</span><span class="op" id="8293455">{</span><span class="string" id="8293456">&#34;&#34;</span><span class="op" id="8293458">,</span>&nbsp;<span class="string" id="8293460">&#34;lang&#34;</span><span class="op" id="8293466">}</span><span class="op" id="8293467">,</span>&nbsp;<span class="string" id="8293469">&#34;de&#34;</span><span class="op" id="8293473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293476">if</span>&nbsp;<span class="ident" id="8293479">reflect</span><span class="op" id="8293486">.</span><span class="ident" id="8293487">DeepEqual</span><span class="op" id="8293496">(</span><span class="ident" id="8293497">tok1</span><span class="op" id="8293501">,</span>&nbsp;<span class="ident" id="8293503">tok2</span><span class="op" id="8293507">)</span>&nbsp;<span class="op" id="8293509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293513">t</span><span class="op" id="8293514">.</span><span class="ident" id="8293515">Error</span><span class="op" id="8293520">(</span><span class="string" id="8293521">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8293560">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293563">}</span><br>
<span class="lineno"></span><span class="op" id="8293565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293568">func</span>&nbsp;<span class="ident" id="8293573">TestSyntaxErrorLineNum</span><span class="op" id="8293595">(</span><span class="ident" id="8293596">t</span>&nbsp;<span class="op" id="8293598">*</span><span class="ident" id="8293599">testing</span><span class="op" id="8293606">.</span><span class="ident" id="8293607">T</span><span class="op" id="8293608">)</span>&nbsp;<span class="op" id="8293610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293613">testInput</span>&nbsp;<span class="op" id="8293623">:=</span>&nbsp;<span class="string" id="8293626">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293654">d</span>&nbsp;<span class="op" id="8293656">:=</span>&nbsp;<span class="ident" id="8293659">NewDecoder</span><span class="op" id="8293669">(</span><span class="ident" id="8293670">strings</span><span class="op" id="8293677">.</span><span class="ident" id="8293678">NewReader</span><span class="op" id="8293687">(</span><span class="ident" id="8293688">testInput</span><span class="op" id="8293697">)</span><span class="op" id="8293698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293701">var</span>&nbsp;<span class="ident" id="8293705">err</span>&nbsp;<span class="builtintype" id="8293709">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293716">for</span>&nbsp;<span class="ident" id="8293720">_</span><span class="op" id="8293721">,</span>&nbsp;<span class="ident" id="8293723">err</span>&nbsp;<span class="op" id="8293727">=</span>&nbsp;<span class="ident" id="8293729">d</span><span class="op" id="8293730">.</span><span class="ident" id="8293731">Token</span><span class="op" id="8293736">(</span><span class="op" id="8293737">)</span><span class="op" id="8293738">;</span>&nbsp;<span class="ident" id="8293740">err</span>&nbsp;<span class="op" id="8293744">==</span>&nbsp;<span class="builtintype" id="8293747">nil</span><span class="op" id="8293750">;</span>&nbsp;<span class="ident" id="8293752">_</span><span class="op" id="8293753">,</span>&nbsp;<span class="ident" id="8293755">err</span>&nbsp;<span class="op" id="8293759">=</span>&nbsp;<span class="ident" id="8293761">d</span><span class="op" id="8293762">.</span><span class="ident" id="8293763">Token</span><span class="op" id="8293768">(</span><span class="op" id="8293769">)</span>&nbsp;<span class="op" id="8293771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293777">synerr</span><span class="op" id="8293783">,</span>&nbsp;<span class="ident" id="8293785">ok</span>&nbsp;<span class="op" id="8293788">:=</span>&nbsp;<span class="ident" id="8293791">err</span><span class="op" id="8293794">.</span><span class="op" id="8293795">(</span><span class="op" id="8293796">*</span><span class="ident" id="8293797">SyntaxError</span><span class="op" id="8293808">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293811">if</span>&nbsp;<span class="op" id="8293814">!</span><span class="ident" id="8293815">ok</span>&nbsp;<span class="op" id="8293818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293822">t</span><span class="op" id="8293823">.</span><span class="ident" id="8293824">Error</span><span class="op" id="8293829">(</span><span class="string" id="8293830">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="8293853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8293859">if</span>&nbsp;<span class="ident" id="8293862">synerr</span><span class="op" id="8293868">.</span><span class="ident" id="8293869">Line</span>&nbsp;<span class="op" id="8293874">!=</span>&nbsp;<span class="num" id="8293877">3</span>&nbsp;<span class="op" id="8293879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293883">t</span><span class="op" id="8293884">.</span><span class="ident" id="8293885">Error</span><span class="op" id="8293890">(</span><span class="string" id="8293891">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="8293937">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8293940">}</span><br>
<span class="lineno"></span><span class="op" id="8293942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8293945">func</span>&nbsp;<span class="ident" id="8293950">TestTrailingRawToken</span><span class="op" id="8293970">(</span><span class="ident" id="8293971">t</span>&nbsp;<span class="op" id="8293973">*</span><span class="ident" id="8293974">testing</span><span class="op" id="8293981">.</span><span class="ident" id="8293982">T</span><span class="op" id="8293983">)</span>&nbsp;<span class="op" id="8293985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8293988">input</span>&nbsp;<span class="op" id="8293994">:=</span>&nbsp;<span class="string" id="8293997">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294014">d</span>&nbsp;<span class="op" id="8294016">:=</span>&nbsp;<span class="ident" id="8294019">NewDecoder</span><span class="op" id="8294029">(</span><span class="ident" id="8294030">strings</span><span class="op" id="8294037">.</span><span class="ident" id="8294038">NewReader</span><span class="op" id="8294047">(</span><span class="ident" id="8294048">input</span><span class="op" id="8294053">)</span><span class="op" id="8294054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294057">var</span>&nbsp;<span class="ident" id="8294061">err</span>&nbsp;<span class="builtintype" id="8294065">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294072">for</span>&nbsp;<span class="ident" id="8294076">_</span><span class="op" id="8294077">,</span>&nbsp;<span class="ident" id="8294079">err</span>&nbsp;<span class="op" id="8294083">=</span>&nbsp;<span class="ident" id="8294085">d</span><span class="op" id="8294086">.</span><span class="ident" id="8294087">RawToken</span><span class="op" id="8294095">(</span><span class="op" id="8294096">)</span><span class="op" id="8294097">;</span>&nbsp;<span class="ident" id="8294099">err</span>&nbsp;<span class="op" id="8294103">==</span>&nbsp;<span class="builtintype" id="8294106">nil</span><span class="op" id="8294109">;</span>&nbsp;<span class="ident" id="8294111">_</span><span class="op" id="8294112">,</span>&nbsp;<span class="ident" id="8294114">err</span>&nbsp;<span class="op" id="8294118">=</span>&nbsp;<span class="ident" id="8294120">d</span><span class="op" id="8294121">.</span><span class="ident" id="8294122">RawToken</span><span class="op" id="8294130">(</span><span class="op" id="8294131">)</span>&nbsp;<span class="op" id="8294133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294139">if</span>&nbsp;<span class="ident" id="8294142">err</span>&nbsp;<span class="op" id="8294146">!=</span>&nbsp;<span class="ident" id="8294149">io</span><span class="op" id="8294151">.</span><span class="ident" id="8294152">EOF</span>&nbsp;<span class="op" id="8294156">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294160">t</span><span class="op" id="8294161">.</span><span class="ident" id="8294162">Fatalf</span><span class="op" id="8294168">(</span><span class="string" id="8294169">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8294207">,</span>&nbsp;<span class="ident" id="8294209">err</span><span class="op" id="8294212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294215">}</span><br>
<span class="lineno"></span><span class="op" id="8294217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8294220">func</span>&nbsp;<span class="ident" id="8294225">TestTrailingToken</span><span class="op" id="8294242">(</span><span class="ident" id="8294243">t</span>&nbsp;<span class="op" id="8294245">*</span><span class="ident" id="8294246">testing</span><span class="op" id="8294253">.</span><span class="ident" id="8294254">T</span><span class="op" id="8294255">)</span>&nbsp;<span class="op" id="8294257">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294260">input</span>&nbsp;<span class="op" id="8294266">:=</span>&nbsp;<span class="string" id="8294269">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294286">d</span>&nbsp;<span class="op" id="8294288">:=</span>&nbsp;<span class="ident" id="8294291">NewDecoder</span><span class="op" id="8294301">(</span><span class="ident" id="8294302">strings</span><span class="op" id="8294309">.</span><span class="ident" id="8294310">NewReader</span><span class="op" id="8294319">(</span><span class="ident" id="8294320">input</span><span class="op" id="8294325">)</span><span class="op" id="8294326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294329">var</span>&nbsp;<span class="ident" id="8294333">err</span>&nbsp;<span class="builtintype" id="8294337">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294344">for</span>&nbsp;<span class="ident" id="8294348">_</span><span class="op" id="8294349">,</span>&nbsp;<span class="ident" id="8294351">err</span>&nbsp;<span class="op" id="8294355">=</span>&nbsp;<span class="ident" id="8294357">d</span><span class="op" id="8294358">.</span><span class="ident" id="8294359">Token</span><span class="op" id="8294364">(</span><span class="op" id="8294365">)</span><span class="op" id="8294366">;</span>&nbsp;<span class="ident" id="8294368">err</span>&nbsp;<span class="op" id="8294372">==</span>&nbsp;<span class="builtintype" id="8294375">nil</span><span class="op" id="8294378">;</span>&nbsp;<span class="ident" id="8294380">_</span><span class="op" id="8294381">,</span>&nbsp;<span class="ident" id="8294383">err</span>&nbsp;<span class="op" id="8294387">=</span>&nbsp;<span class="ident" id="8294389">d</span><span class="op" id="8294390">.</span><span class="ident" id="8294391">Token</span><span class="op" id="8294396">(</span><span class="op" id="8294397">)</span>&nbsp;<span class="op" id="8294399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294402">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294405">if</span>&nbsp;<span class="ident" id="8294408">err</span>&nbsp;<span class="op" id="8294412">!=</span>&nbsp;<span class="ident" id="8294415">io</span><span class="op" id="8294417">.</span><span class="ident" id="8294418">EOF</span>&nbsp;<span class="op" id="8294422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294426">t</span><span class="op" id="8294427">.</span><span class="ident" id="8294428">Fatalf</span><span class="op" id="8294434">(</span><span class="string" id="8294435">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8294470">,</span>&nbsp;<span class="ident" id="8294472">err</span><span class="op" id="8294475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294478">}</span><br>
<span class="lineno"></span><span class="op" id="8294480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="8294483">func</span>&nbsp;<span class="ident" id="8294488">TestEntityInsideCDATA</span><span class="op" id="8294509">(</span><span class="ident" id="8294510">t</span>&nbsp;<span class="op" id="8294512">*</span><span class="ident" id="8294513">testing</span><span class="op" id="8294520">.</span><span class="ident" id="8294521">T</span><span class="op" id="8294522">)</span>&nbsp;<span class="op" id="8294524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294527">input</span>&nbsp;<span class="op" id="8294533">:=</span>&nbsp;<span class="string" id="8294536">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294575">d</span>&nbsp;<span class="op" id="8294577">:=</span>&nbsp;<span class="ident" id="8294580">NewDecoder</span><span class="op" id="8294590">(</span><span class="ident" id="8294591">strings</span><span class="op" id="8294598">.</span><span class="ident" id="8294599">NewReader</span><span class="op" id="8294608">(</span><span class="ident" id="8294609">input</span><span class="op" id="8294614">)</span><span class="op" id="8294615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294618">var</span>&nbsp;<span class="ident" id="8294622">err</span>&nbsp;<span class="builtintype" id="8294626">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294633">for</span>&nbsp;<span class="ident" id="8294637">_</span><span class="op" id="8294638">,</span>&nbsp;<span class="ident" id="8294640">err</span>&nbsp;<span class="op" id="8294644">=</span>&nbsp;<span class="ident" id="8294646">d</span><span class="op" id="8294647">.</span><span class="ident" id="8294648">Token</span><span class="op" id="8294653">(</span><span class="op" id="8294654">)</span><span class="op" id="8294655">;</span>&nbsp;<span class="ident" id="8294657">err</span>&nbsp;<span class="op" id="8294661">==</span>&nbsp;<span class="builtintype" id="8294664">nil</span><span class="op" id="8294667">;</span>&nbsp;<span class="ident" id="8294669">_</span><span class="op" id="8294670">,</span>&nbsp;<span class="ident" id="8294672">err</span>&nbsp;<span class="op" id="8294676">=</span>&nbsp;<span class="ident" id="8294678">d</span><span class="op" id="8294679">.</span><span class="ident" id="8294680">Token</span><span class="op" id="8294685">(</span><span class="op" id="8294686">)</span>&nbsp;<span class="op" id="8294688">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8294694">if</span>&nbsp;<span class="ident" id="8294697">err</span>&nbsp;<span class="op" id="8294701">!=</span>&nbsp;<span class="ident" id="8294704">io</span><span class="op" id="8294706">.</span><span class="ident" id="8294707">EOF</span>&nbsp;<span class="op" id="8294711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294715">t</span><span class="op" id="8294716">.</span><span class="ident" id="8294717">Fatalf</span><span class="op" id="8294723">(</span><span class="string" id="8294724">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8294759">,</span>&nbsp;<span class="ident" id="8294761">err</span><span class="op" id="8294764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294767">}</span><br>
<span class="lineno"></span><span class="op" id="8294769">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="8294772">var</span>&nbsp;<span class="ident" id="8294776">characterTests</span>&nbsp;<span class="op" id="8294791">=</span>&nbsp;<span class="op" id="8294793">[</span><span class="op" id="8294794">]</span><span class="keyword" id="8294795">struct</span>&nbsp;<span class="op" id="8294802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294805">in</span>&nbsp;&nbsp;<span class="builtintype" id="8294809">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8294817">err</span>&nbsp;<span class="builtintype" id="8294821">string</span><br>
<span class="lineno"></span><span class="op" id="8294828">}</span><span class="op" id="8294829">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294832">{</span><span class="string" id="8294833">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="8294845">,</span>&nbsp;<span class="string" id="8294847">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="8294878">}</span><span class="op" id="8294879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294882">{</span><span class="string" id="8294883">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="8294918">,</span>&nbsp;<span class="string" id="8294920">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="8294951">}</span><span class="op" id="8294952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8294955">{</span><span class="string" id="8294956">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="8294976">,</span>&nbsp;<span class="string" id="8294978">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="8295009">}</span><span class="op" id="8295010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295013">{</span><span class="string" id="8295014">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="8295073">,</span>&nbsp;<span class="string" id="8295075">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="8295106">}</span><span class="op" id="8295107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295110">{</span><span class="string" id="8295111">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="8295169">,</span>&nbsp;<span class="string" id="8295171">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="8295207">}</span><span class="op" id="8295208">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295211">{</span><span class="string" id="8295212">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8295234">,</span>&nbsp;<span class="string" id="8295236">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8295282">}</span><span class="op" id="8295283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295286">{</span><span class="string" id="8295287">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8295306">,</span>&nbsp;<span class="string" id="8295308">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8295351">}</span><span class="op" id="8295352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295355">{</span><span class="string" id="8295356">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="8295383">,</span>&nbsp;<span class="string" id="8295385">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="8295420">}</span><span class="op" id="8295421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295424">{</span><span class="string" id="8295425">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="8295445">,</span>&nbsp;<span class="string" id="8295447">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="8295481">}</span><span class="op" id="8295482">,</span><br>
<span class="lineno"></span><span class="op" id="8295484">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="8295487">func</span>&nbsp;<span class="ident" id="8295492">TestDisallowedCharacters</span><span class="op" id="8295516">(</span><span class="ident" id="8295517">t</span>&nbsp;<span class="op" id="8295519">*</span><span class="ident" id="8295520">testing</span><span class="op" id="8295527">.</span><span class="ident" id="8295528">T</span><span class="op" id="8295529">)</span>&nbsp;<span class="op" id="8295531">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295535">for</span>&nbsp;<span class="ident" id="8295539">i</span><span class="op" id="8295540">,</span>&nbsp;<span class="ident" id="8295542">tt</span>&nbsp;<span class="op" id="8295545">:=</span>&nbsp;<span class="keyword" id="8295548">range</span>&nbsp;<span class="ident" id="8295554">characterTests</span>&nbsp;<span class="op" id="8295569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295573">d</span>&nbsp;<span class="op" id="8295575">:=</span>&nbsp;<span class="ident" id="8295578">NewDecoder</span><span class="op" id="8295588">(</span><span class="ident" id="8295589">strings</span><span class="op" id="8295596">.</span><span class="ident" id="8295597">NewReader</span><span class="op" id="8295606">(</span><span class="ident" id="8295607">tt</span><span class="op" id="8295609">.</span><span class="ident" id="8295610">in</span><span class="op" id="8295612">)</span><span class="op" id="8295613">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295617">var</span>&nbsp;<span class="ident" id="8295621">err</span>&nbsp;<span class="builtintype" id="8295625">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295634">for</span>&nbsp;<span class="ident" id="8295638">err</span>&nbsp;<span class="op" id="8295642">==</span>&nbsp;<span class="builtintype" id="8295645">nil</span>&nbsp;<span class="op" id="8295649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295654">_</span><span class="op" id="8295655">,</span>&nbsp;<span class="ident" id="8295657">err</span>&nbsp;<span class="op" id="8295661">=</span>&nbsp;<span class="ident" id="8295663">d</span><span class="op" id="8295664">.</span><span class="ident" id="8295665">Token</span><span class="op" id="8295670">(</span><span class="op" id="8295671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295675">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295679">synerr</span><span class="op" id="8295685">,</span>&nbsp;<span class="ident" id="8295687">ok</span>&nbsp;<span class="op" id="8295690">:=</span>&nbsp;<span class="ident" id="8295693">err</span><span class="op" id="8295696">.</span><span class="op" id="8295697">(</span><span class="op" id="8295698">*</span><span class="ident" id="8295699">SyntaxError</span><span class="op" id="8295710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295714">if</span>&nbsp;<span class="op" id="8295717">!</span><span class="ident" id="8295718">ok</span>&nbsp;<span class="op" id="8295721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295726">t</span><span class="op" id="8295727">.</span><span class="ident" id="8295728">Fatalf</span><span class="op" id="8295734">(</span><span class="string" id="8295735">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="8295785">,</span>&nbsp;<span class="ident" id="8295787">i</span><span class="op" id="8295788">,</span>&nbsp;<span class="ident" id="8295790">err</span><span class="op" id="8295793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8295801">if</span>&nbsp;<span class="ident" id="8295804">synerr</span><span class="op" id="8295810">.</span><span class="ident" id="8295811">Msg</span>&nbsp;<span class="op" id="8295815">!=</span>&nbsp;<span class="ident" id="8295818">tt</span><span class="op" id="8295820">.</span><span class="ident" id="8295821">err</span>&nbsp;<span class="op" id="8295825">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295830">t</span><span class="op" id="8295831">.</span><span class="ident" id="8295832">Fatalf</span><span class="op" id="8295838">(</span><span class="string" id="8295839">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8295883">,</span>&nbsp;<span class="ident" id="8295885">i</span><span class="op" id="8295886">,</span>&nbsp;<span class="ident" id="8295888">tt</span><span class="op" id="8295890">.</span><span class="ident" id="8295891">err</span><span class="op" id="8295894">,</span>&nbsp;<span class="ident" id="8295896">synerr</span><span class="op" id="8295902">.</span><span class="ident" id="8295903">Msg</span><span class="op" id="8295906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8295913">}</span><br>
<span class="lineno"></span><span class="op" id="8295915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="8295918">type</span>&nbsp;<span class="ident" id="8295923">procInstEncodingTest</span>&nbsp;<span class="keyword" id="8295944">struct</span>&nbsp;<span class="op" id="8295951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8295954">expect</span><span class="op" id="8295960">,</span>&nbsp;<span class="ident" id="8295962">got</span>&nbsp;<span class="builtintype" id="8295966">string</span><br>
<span class="lineno"></span><span class="op" id="8295973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8295976">var</span>&nbsp;<span class="ident" id="8295980">procInstTests</span>&nbsp;<span class="op" id="8295994">=</span>&nbsp;<span class="op" id="8295996">[</span><span class="op" id="8295997">]</span><span class="keyword" id="8295998">struct</span>&nbsp;<span class="op" id="8296005">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296008">input</span><span class="op" id="8296013">,</span>&nbsp;<span class="ident" id="8296015">expect</span>&nbsp;<span class="builtintype" id="8296022">string</span><br>
<span class="lineno"></span><span class="op" id="8296029">}</span><span class="op" id="8296030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296033">{</span><span class="string" id="8296034">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="8296066">,</span>&nbsp;<span class="string" id="8296068">&#34;utf-8&#34;</span><span class="op" id="8296075">}</span><span class="op" id="8296076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296079">{</span><span class="string" id="8296080">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="8296112">,</span>&nbsp;<span class="string" id="8296114">&#34;utf-8&#34;</span><span class="op" id="8296121">}</span><span class="op" id="8296122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296125">{</span><span class="string" id="8296126">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="8296159">,</span>&nbsp;<span class="string" id="8296161">&#34;utf-8&#34;</span><span class="op" id="8296168">}</span><span class="op" id="8296169">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296172">{</span><span class="string" id="8296173">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="8296203">,</span>&nbsp;<span class="string" id="8296205">&#34;&#34;</span><span class="op" id="8296207">}</span><span class="op" id="8296208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296211">{</span><span class="string" id="8296212">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="8296229">,</span>&nbsp;<span class="string" id="8296231">&#34;FOO&#34;</span><span class="op" id="8296236">}</span><span class="op" id="8296237">,</span><br>
<span class="lineno"></span><span class="op" id="8296239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8296242">func</span>&nbsp;<span class="ident" id="8296247">TestProcInstEncoding</span><span class="op" id="8296267">(</span><span class="ident" id="8296268">t</span>&nbsp;<span class="op" id="8296270">*</span><span class="ident" id="8296271">testing</span><span class="op" id="8296278">.</span><span class="ident" id="8296279">T</span><span class="op" id="8296280">)</span>&nbsp;<span class="op" id="8296282">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296285">for</span>&nbsp;<span class="ident" id="8296289">_</span><span class="op" id="8296290">,</span>&nbsp;<span class="ident" id="8296292">test</span>&nbsp;<span class="op" id="8296297">:=</span>&nbsp;<span class="keyword" id="8296300">range</span>&nbsp;<span class="ident" id="8296306">procInstTests</span>&nbsp;<span class="op" id="8296320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296324">got</span>&nbsp;<span class="op" id="8296328">:=</span>&nbsp;<span class="ident" id="8296331">procInstEncoding</span><span class="op" id="8296347">(</span><span class="ident" id="8296348">test</span><span class="op" id="8296352">.</span><span class="ident" id="8296353">input</span><span class="op" id="8296358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8296362">if</span>&nbsp;<span class="ident" id="8296365">got</span>&nbsp;<span class="op" id="8296369">!=</span>&nbsp;<span class="ident" id="8296372">test</span><span class="op" id="8296376">.</span><span class="ident" id="8296377">expect</span>&nbsp;<span class="op" id="8296384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296389">t</span><span class="op" id="8296390">.</span><span class="ident" id="8296391">Errorf</span><span class="op" id="8296397">(</span><span class="string" id="8296398">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8296434">,</span>&nbsp;<span class="ident" id="8296436">test</span><span class="op" id="8296440">.</span><span class="ident" id="8296441">input</span><span class="op" id="8296446">,</span>&nbsp;<span class="ident" id="8296448">got</span><span class="op" id="8296451">,</span>&nbsp;<span class="ident" id="8296453">test</span><span class="op" id="8296457">.</span><span class="ident" id="8296458">expect</span><span class="op" id="8296464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296468">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8296471">}</span><br>
<span class="lineno"></span><span class="op" id="8296473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8296476">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="8296537">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8296572">var</span>&nbsp;<span class="ident" id="8296576">directivesWithCommentsInput</span>&nbsp;<span class="op" id="8296604">=</span>&nbsp;<span class="string" id="8296606">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8296842">var</span>&nbsp;<span class="ident" id="8296846">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8296875">=</span>&nbsp;<span class="op" id="8296877">[</span><span class="op" id="8296878">]</span><span class="ident" id="8296879">Token</span><span class="op" id="8296884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296887">CharData</span><span class="op" id="8296895">(</span><span class="string" id="8296896">&#34;\n&#34;</span><span class="op" id="8296900">)</span><span class="op" id="8296901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296904">Directive</span><span class="op" id="8296913">(</span><span class="string" id="8296914">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8296985">)</span><span class="op" id="8296986">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8296989">CharData</span><span class="op" id="8296997">(</span><span class="string" id="8296998">&#34;\n&#34;</span><span class="op" id="8297002">)</span><span class="op" id="8297003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297006">Directive</span><span class="op" id="8297015">(</span><span class="string" id="8297016">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8297049">)</span><span class="op" id="8297050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297053">CharData</span><span class="op" id="8297061">(</span><span class="string" id="8297062">&#34;\n&#34;</span><span class="op" id="8297066">)</span><span class="op" id="8297067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297070">Directive</span><span class="op" id="8297079">(</span><span class="string" id="8297080">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8297125">)</span><span class="op" id="8297126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297129">CharData</span><span class="op" id="8297137">(</span><span class="string" id="8297138">&#34;\n&#34;</span><span class="op" id="8297142">)</span><span class="op" id="8297143">,</span><br>
<span class="lineno">695</span><span class="op" id="8297145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8297148">func</span>&nbsp;<span class="ident" id="8297153">TestDirectivesWithComments</span><span class="op" id="8297179">(</span><span class="ident" id="8297180">t</span>&nbsp;<span class="op" id="8297182">*</span><span class="ident" id="8297183">testing</span><span class="op" id="8297190">.</span><span class="ident" id="8297191">T</span><span class="op" id="8297192">)</span>&nbsp;<span class="op" id="8297194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297197">d</span>&nbsp;<span class="op" id="8297199">:=</span>&nbsp;<span class="ident" id="8297202">NewDecoder</span><span class="op" id="8297212">(</span><span class="ident" id="8297213">strings</span><span class="op" id="8297220">.</span><span class="ident" id="8297221">NewReader</span><span class="op" id="8297230">(</span><span class="ident" id="8297231">directivesWithCommentsInput</span><span class="op" id="8297258">)</span><span class="op" id="8297259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297263">for</span>&nbsp;<span class="ident" id="8297267">i</span><span class="op" id="8297268">,</span>&nbsp;<span class="ident" id="8297270">want</span>&nbsp;<span class="op" id="8297275">:=</span>&nbsp;<span class="keyword" id="8297278">range</span>&nbsp;<span class="ident" id="8297284">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8297313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297317">have</span><span class="op" id="8297321">,</span>&nbsp;<span class="ident" id="8297323">err</span>&nbsp;<span class="op" id="8297327">:=</span>&nbsp;<span class="ident" id="8297330">d</span><span class="op" id="8297331">.</span><span class="ident" id="8297332">Token</span><span class="op" id="8297337">(</span><span class="op" id="8297338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297342">if</span>&nbsp;<span class="ident" id="8297345">err</span>&nbsp;<span class="op" id="8297349">!=</span>&nbsp;<span class="builtintype" id="8297352">nil</span>&nbsp;<span class="op" id="8297356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297361">t</span><span class="op" id="8297362">.</span><span class="ident" id="8297363">Fatalf</span><span class="op" id="8297369">(</span><span class="string" id="8297370">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8297402">,</span>&nbsp;<span class="ident" id="8297404">i</span><span class="op" id="8297405">,</span>&nbsp;<span class="ident" id="8297407">err</span><span class="op" id="8297410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297414">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297418">if</span>&nbsp;<span class="op" id="8297421">!</span><span class="ident" id="8297422">reflect</span><span class="op" id="8297429">.</span><span class="ident" id="8297430">DeepEqual</span><span class="op" id="8297439">(</span><span class="ident" id="8297440">have</span><span class="op" id="8297444">,</span>&nbsp;<span class="ident" id="8297446">want</span><span class="op" id="8297450">)</span>&nbsp;<span class="op" id="8297452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297457">t</span><span class="op" id="8297458">.</span><span class="ident" id="8297459">Errorf</span><span class="op" id="8297465">(</span><span class="string" id="8297466">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8297491">,</span>&nbsp;<span class="ident" id="8297493">i</span><span class="op" id="8297494">,</span>&nbsp;<span class="ident" id="8297496">have</span><span class="op" id="8297500">,</span>&nbsp;<span class="ident" id="8297502">want</span><span class="op" id="8297506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297513">}</span><br>
<span class="lineno"></span><span class="op" id="8297515">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="8297518">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="8297572">type</span>&nbsp;<span class="ident" id="8297577">errWriter</span>&nbsp;<span class="keyword" id="8297587">struct</span><span class="op" id="8297593">{</span><span class="op" id="8297594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8297597">func</span>&nbsp;<span class="op" id="8297602">(</span><span class="ident" id="8297603">errWriter</span><span class="op" id="8297612">)</span>&nbsp;<span class="ident" id="8297614">Write</span><span class="op" id="8297619">(</span><span class="ident" id="8297620">p</span>&nbsp;<span class="op" id="8297622">[</span><span class="op" id="8297623">]</span><span class="builtintype" id="8297624">byte</span><span class="op" id="8297628">)</span>&nbsp;<span class="op" id="8297630">(</span><span class="ident" id="8297631">n</span>&nbsp;<span class="builtintype" id="8297633">int</span><span class="op" id="8297636">,</span>&nbsp;<span class="ident" id="8297638">err</span>&nbsp;<span class="builtintype" id="8297642">error</span><span class="op" id="8297647">)</span>&nbsp;<span class="op" id="8297649">{</span>&nbsp;<span class="keyword" id="8297651">return</span>&nbsp;<span class="num" id="8297658">0</span><span class="op" id="8297659">,</span>&nbsp;<span class="ident" id="8297661">fmt</span><span class="op" id="8297664">.</span><span class="ident" id="8297665">Errorf</span><span class="op" id="8297671">(</span><span class="string" id="8297672">&#34;unwritable&#34;</span><span class="op" id="8297684">)</span>&nbsp;<span class="op" id="8297686">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="8297689">func</span>&nbsp;<span class="ident" id="8297694">TestEscapeTextIOErrors</span><span class="op" id="8297716">(</span><span class="ident" id="8297717">t</span>&nbsp;<span class="op" id="8297719">*</span><span class="ident" id="8297720">testing</span><span class="op" id="8297727">.</span><span class="ident" id="8297728">T</span><span class="op" id="8297729">)</span>&nbsp;<span class="op" id="8297731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297734">expectErr</span>&nbsp;<span class="op" id="8297744">:=</span>&nbsp;<span class="string" id="8297747">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297761">err</span>&nbsp;<span class="op" id="8297765">:=</span>&nbsp;<span class="ident" id="8297768">EscapeText</span><span class="op" id="8297778">(</span><span class="ident" id="8297779">errWriter</span><span class="op" id="8297788">{</span><span class="op" id="8297789">}</span><span class="op" id="8297790">,</span>&nbsp;<span class="op" id="8297792">[</span><span class="op" id="8297793">]</span><span class="builtintype" id="8297794">byte</span><span class="op" id="8297798">{</span><span class="string" id="8297799">&#39;A&#39;</span><span class="op" id="8297802">}</span><span class="op" id="8297803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8297807">if</span>&nbsp;<span class="ident" id="8297810">err</span>&nbsp;<span class="op" id="8297814">==</span>&nbsp;<span class="builtintype" id="8297817">nil</span>&nbsp;<span class="op" id="8297821">||</span>&nbsp;<span class="ident" id="8297824">err</span><span class="op" id="8297827">.</span><span class="ident" id="8297828">Error</span><span class="op" id="8297833">(</span><span class="op" id="8297834">)</span>&nbsp;<span class="op" id="8297836">!=</span>&nbsp;<span class="ident" id="8297839">expectErr</span>&nbsp;<span class="op" id="8297849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297853">t</span><span class="op" id="8297854">.</span><span class="ident" id="8297855">Errorf</span><span class="op" id="8297861">(</span><span class="string" id="8297862">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8297880">,</span>&nbsp;<span class="ident" id="8297882">err</span><span class="op" id="8297885">,</span>&nbsp;<span class="ident" id="8297887">expectErr</span><span class="op" id="8297896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8297899">}</span><br>
<span class="lineno"></span><span class="op" id="8297901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="8297904">func</span>&nbsp;<span class="ident" id="8297909">TestEscapeTextInvalidChar</span><span class="op" id="8297934">(</span><span class="ident" id="8297935">t</span>&nbsp;<span class="op" id="8297937">*</span><span class="ident" id="8297938">testing</span><span class="op" id="8297945">.</span><span class="ident" id="8297946">T</span><span class="op" id="8297947">)</span>&nbsp;<span class="op" id="8297949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297952">input</span>&nbsp;<span class="op" id="8297958">:=</span>&nbsp;<span class="op" id="8297961">[</span><span class="op" id="8297962">]</span><span class="builtintype" id="8297963">byte</span><span class="op" id="8297967">(</span><span class="string" id="8297968">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="8297995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8297998">expected</span>&nbsp;<span class="op" id="8298007">:=</span>&nbsp;<span class="string" id="8298010">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298042">buff</span>&nbsp;<span class="op" id="8298047">:=</span>&nbsp;<span class="builtinfunc" id="8298050">new</span><span class="op" id="8298053">(</span><span class="ident" id="8298054">bytes</span><span class="op" id="8298059">.</span><span class="ident" id="8298060">Buffer</span><span class="op" id="8298066">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298069">if</span>&nbsp;<span class="ident" id="8298072">err</span>&nbsp;<span class="op" id="8298076">:=</span>&nbsp;<span class="ident" id="8298079">EscapeText</span><span class="op" id="8298089">(</span><span class="ident" id="8298090">buff</span><span class="op" id="8298094">,</span>&nbsp;<span class="ident" id="8298096">input</span><span class="op" id="8298101">)</span><span class="op" id="8298102">;</span>&nbsp;<span class="ident" id="8298104">err</span>&nbsp;<span class="op" id="8298108">!=</span>&nbsp;<span class="builtintype" id="8298111">nil</span>&nbsp;<span class="op" id="8298115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298119">t</span><span class="op" id="8298120">.</span><span class="ident" id="8298121">Fatalf</span><span class="op" id="8298127">(</span><span class="string" id="8298128">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8298147">,</span>&nbsp;<span class="ident" id="8298149">err</span><span class="op" id="8298152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298158">text</span>&nbsp;<span class="op" id="8298163">:=</span>&nbsp;<span class="ident" id="8298166">buff</span><span class="op" id="8298170">.</span><span class="ident" id="8298171">String</span><span class="op" id="8298177">(</span><span class="op" id="8298178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298182">if</span>&nbsp;<span class="ident" id="8298185">text</span>&nbsp;<span class="op" id="8298190">!=</span>&nbsp;<span class="ident" id="8298193">expected</span>&nbsp;<span class="op" id="8298202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298206">t</span><span class="op" id="8298207">.</span><span class="ident" id="8298208">Errorf</span><span class="op" id="8298214">(</span><span class="string" id="8298215">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8298233">,</span>&nbsp;<span class="ident" id="8298235">text</span><span class="op" id="8298239">,</span>&nbsp;<span class="ident" id="8298241">expected</span><span class="op" id="8298249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298252">}</span><br>
<span class="lineno"></span><span class="op" id="8298254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="8298257">func</span>&nbsp;<span class="ident" id="8298262">TestIssue5880</span><span class="op" id="8298275">(</span><span class="ident" id="8298276">t</span>&nbsp;<span class="op" id="8298278">*</span><span class="ident" id="8298279">testing</span><span class="op" id="8298286">.</span><span class="ident" id="8298287">T</span><span class="op" id="8298288">)</span>&nbsp;<span class="op" id="8298290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298293">type</span>&nbsp;<span class="ident" id="8298298">T</span>&nbsp;<span class="op" id="8298300">[</span><span class="op" id="8298301">]</span><span class="builtintype" id="8298302">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298308">data</span><span class="op" id="8298312">,</span>&nbsp;<span class="ident" id="8298314">err</span>&nbsp;<span class="op" id="8298318">:=</span>&nbsp;<span class="ident" id="8298321">Marshal</span><span class="op" id="8298328">(</span><span class="ident" id="8298329">T</span><span class="op" id="8298330">{</span><span class="num" id="8298331">192</span><span class="op" id="8298334">,</span>&nbsp;<span class="num" id="8298336">168</span><span class="op" id="8298339">,</span>&nbsp;<span class="num" id="8298341">0</span><span class="op" id="8298342">,</span>&nbsp;<span class="num" id="8298344">1</span><span class="op" id="8298345">}</span><span class="op" id="8298346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298349">if</span>&nbsp;<span class="ident" id="8298352">err</span>&nbsp;<span class="op" id="8298356">!=</span>&nbsp;<span class="builtintype" id="8298359">nil</span>&nbsp;<span class="op" id="8298363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298367">t</span><span class="op" id="8298368">.</span><span class="ident" id="8298369">Errorf</span><span class="op" id="8298375">(</span><span class="string" id="8298376">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8298395">,</span>&nbsp;<span class="ident" id="8298397">err</span><span class="op" id="8298400">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8298406">if</span>&nbsp;<span class="op" id="8298409">!</span><span class="ident" id="8298410">utf8</span><span class="op" id="8298414">.</span><span class="ident" id="8298415">Valid</span><span class="op" id="8298420">(</span><span class="ident" id="8298421">data</span><span class="op" id="8298425">)</span>&nbsp;<span class="op" id="8298427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8298431">t</span><span class="op" id="8298432">.</span><span class="ident" id="8298433">Errorf</span><span class="op" id="8298439">(</span><span class="string" id="8298440">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="8298477">,</span>&nbsp;<span class="ident" id="8298479">data</span><span class="op" id="8298483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8298486">}</span><br>
<span class="lineno"></span><span class="op" id="8298488">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
