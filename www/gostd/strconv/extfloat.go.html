<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html" class="current">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2088907">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2088962">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2089016">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2089067">package</span>&nbsp;<span class="ident" id="2089075">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089084">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2089155">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2089218">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2089290">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2089314">type</span>&nbsp;<span class="ident" id="2089319">extFloat</span>&nbsp;<span class="keyword" id="2089328">struct</span>&nbsp;<span class="op" id="2089335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089338">mant</span>&nbsp;<span class="ident" id="2089343">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089351">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2089356">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089361">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2089366">bool</span><br>
<span class="lineno">15</span><span class="op" id="2089371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089374">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2089429">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2089476">const</span>&nbsp;<span class="op" id="2089482">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089485">firstPowerOfTen</span>&nbsp;<span class="op" id="2089501">=</span>&nbsp;<span class="op" id="2089503">-</span><span class="num" id="2089504">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089509">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2089525">=</span>&nbsp;<span class="num" id="2089527">8</span><br>
<span class="lineno"></span><span class="op" id="2089529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2089532">var</span>&nbsp;<span class="ident" id="2089536">smallPowersOfTen</span>&nbsp;<span class="op" id="2089553">=</span>&nbsp;<span class="op" id="2089555">[</span><span class="op" id="2089556">...</span><span class="op" id="2089559">]</span><span class="ident" id="2089560">extFloat</span><span class="op" id="2089568">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089571">{</span><span class="num" id="2089572">1</span>&nbsp;<span class="op" id="2089574">&lt;&lt;</span>&nbsp;<span class="num" id="2089577">63</span><span class="op" id="2089579">,</span>&nbsp;<span class="op" id="2089581">-</span><span class="num" id="2089582">63</span><span class="op" id="2089584">,</span>&nbsp;<span class="builtintype" id="2089586">false</span><span class="op" id="2089591">}</span><span class="op" id="2089592">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089601">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089607">{</span><span class="num" id="2089608">0xa</span>&nbsp;<span class="op" id="2089612">&lt;&lt;</span>&nbsp;<span class="num" id="2089615">60</span><span class="op" id="2089617">,</span>&nbsp;<span class="op" id="2089619">-</span><span class="num" id="2089620">60</span><span class="op" id="2089622">,</span>&nbsp;<span class="builtintype" id="2089624">false</span><span class="op" id="2089629">}</span><span class="op" id="2089630">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089637">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089645">{</span><span class="num" id="2089646">0x64</span>&nbsp;<span class="op" id="2089651">&lt;&lt;</span>&nbsp;<span class="num" id="2089654">57</span><span class="op" id="2089656">,</span>&nbsp;<span class="op" id="2089658">-</span><span class="num" id="2089659">57</span><span class="op" id="2089661">,</span>&nbsp;<span class="builtintype" id="2089663">false</span><span class="op" id="2089668">}</span><span class="op" id="2089669">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089675">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089683">{</span><span class="num" id="2089684">0x3e8</span>&nbsp;<span class="op" id="2089690">&lt;&lt;</span>&nbsp;<span class="num" id="2089693">54</span><span class="op" id="2089695">,</span>&nbsp;<span class="op" id="2089697">-</span><span class="num" id="2089698">54</span><span class="op" id="2089700">,</span>&nbsp;<span class="builtintype" id="2089702">false</span><span class="op" id="2089707">}</span><span class="op" id="2089708">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089713">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089721">{</span><span class="num" id="2089722">0x2710</span>&nbsp;<span class="op" id="2089729">&lt;&lt;</span>&nbsp;<span class="num" id="2089732">50</span><span class="op" id="2089734">,</span>&nbsp;<span class="op" id="2089736">-</span><span class="num" id="2089737">50</span><span class="op" id="2089739">,</span>&nbsp;<span class="builtintype" id="2089741">false</span><span class="op" id="2089746">}</span><span class="op" id="2089747">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2089751">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089759">{</span><span class="num" id="2089760">0x186a0</span>&nbsp;<span class="op" id="2089768">&lt;&lt;</span>&nbsp;<span class="num" id="2089771">47</span><span class="op" id="2089773">,</span>&nbsp;<span class="op" id="2089775">-</span><span class="num" id="2089776">47</span><span class="op" id="2089778">,</span>&nbsp;<span class="builtintype" id="2089780">false</span><span class="op" id="2089785">}</span><span class="op" id="2089786">,</span>&nbsp;&nbsp;<span class="comment" id="2089789">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089797">{</span><span class="num" id="2089798">0xf4240</span>&nbsp;<span class="op" id="2089806">&lt;&lt;</span>&nbsp;<span class="num" id="2089809">44</span><span class="op" id="2089811">,</span>&nbsp;<span class="op" id="2089813">-</span><span class="num" id="2089814">44</span><span class="op" id="2089816">,</span>&nbsp;<span class="builtintype" id="2089818">false</span><span class="op" id="2089823">}</span><span class="op" id="2089824">,</span>&nbsp;&nbsp;<span class="comment" id="2089827">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089835">{</span><span class="num" id="2089836">0x989680</span>&nbsp;<span class="op" id="2089845">&lt;&lt;</span>&nbsp;<span class="num" id="2089848">40</span><span class="op" id="2089850">,</span>&nbsp;<span class="op" id="2089852">-</span><span class="num" id="2089853">40</span><span class="op" id="2089855">,</span>&nbsp;<span class="builtintype" id="2089857">false</span><span class="op" id="2089862">}</span><span class="op" id="2089863">,</span>&nbsp;<span class="comment" id="2089865">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2089872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2089875">var</span>&nbsp;<span class="ident" id="2089879">powersOfTen</span>&nbsp;<span class="op" id="2089891">=</span>&nbsp;<span class="op" id="2089893">[</span><span class="op" id="2089894">...</span><span class="op" id="2089897">]</span><span class="ident" id="2089898">extFloat</span><span class="op" id="2089906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089909">{</span><span class="num" id="2089910">0xfa8fd5a0081c0288</span><span class="op" id="2089928">,</span>&nbsp;<span class="op" id="2089930">-</span><span class="num" id="2089931">1220</span><span class="op" id="2089935">,</span>&nbsp;<span class="builtintype" id="2089937">false</span><span class="op" id="2089942">}</span><span class="op" id="2089943">,</span>&nbsp;<span class="comment" id="2089945">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089957">{</span><span class="num" id="2089958">0xbaaee17fa23ebf76</span><span class="op" id="2089976">,</span>&nbsp;<span class="op" id="2089978">-</span><span class="num" id="2089979">1193</span><span class="op" id="2089983">,</span>&nbsp;<span class="builtintype" id="2089985">false</span><span class="op" id="2089990">}</span><span class="op" id="2089991">,</span>&nbsp;<span class="comment" id="2089993">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090005">{</span><span class="num" id="2090006">0x8b16fb203055ac76</span><span class="op" id="2090024">,</span>&nbsp;<span class="op" id="2090026">-</span><span class="num" id="2090027">1166</span><span class="op" id="2090031">,</span>&nbsp;<span class="builtintype" id="2090033">false</span><span class="op" id="2090038">}</span><span class="op" id="2090039">,</span>&nbsp;<span class="comment" id="2090041">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090053">{</span><span class="num" id="2090054">0xcf42894a5dce35ea</span><span class="op" id="2090072">,</span>&nbsp;<span class="op" id="2090074">-</span><span class="num" id="2090075">1140</span><span class="op" id="2090079">,</span>&nbsp;<span class="builtintype" id="2090081">false</span><span class="op" id="2090086">}</span><span class="op" id="2090087">,</span>&nbsp;<span class="comment" id="2090089">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090101">{</span><span class="num" id="2090102">0x9a6bb0aa55653b2d</span><span class="op" id="2090120">,</span>&nbsp;<span class="op" id="2090122">-</span><span class="num" id="2090123">1113</span><span class="op" id="2090127">,</span>&nbsp;<span class="builtintype" id="2090129">false</span><span class="op" id="2090134">}</span><span class="op" id="2090135">,</span>&nbsp;<span class="comment" id="2090137">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090149">{</span><span class="num" id="2090150">0xe61acf033d1a45df</span><span class="op" id="2090168">,</span>&nbsp;<span class="op" id="2090170">-</span><span class="num" id="2090171">1087</span><span class="op" id="2090175">,</span>&nbsp;<span class="builtintype" id="2090177">false</span><span class="op" id="2090182">}</span><span class="op" id="2090183">,</span>&nbsp;<span class="comment" id="2090185">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090197">{</span><span class="num" id="2090198">0xab70fe17c79ac6ca</span><span class="op" id="2090216">,</span>&nbsp;<span class="op" id="2090218">-</span><span class="num" id="2090219">1060</span><span class="op" id="2090223">,</span>&nbsp;<span class="builtintype" id="2090225">false</span><span class="op" id="2090230">}</span><span class="op" id="2090231">,</span>&nbsp;<span class="comment" id="2090233">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090245">{</span><span class="num" id="2090246">0xff77b1fcbebcdc4f</span><span class="op" id="2090264">,</span>&nbsp;<span class="op" id="2090266">-</span><span class="num" id="2090267">1034</span><span class="op" id="2090271">,</span>&nbsp;<span class="builtintype" id="2090273">false</span><span class="op" id="2090278">}</span><span class="op" id="2090279">,</span>&nbsp;<span class="comment" id="2090281">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090293">{</span><span class="num" id="2090294">0xbe5691ef416bd60c</span><span class="op" id="2090312">,</span>&nbsp;<span class="op" id="2090314">-</span><span class="num" id="2090315">1007</span><span class="op" id="2090319">,</span>&nbsp;<span class="builtintype" id="2090321">false</span><span class="op" id="2090326">}</span><span class="op" id="2090327">,</span>&nbsp;<span class="comment" id="2090329">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090341">{</span><span class="num" id="2090342">0x8dd01fad907ffc3c</span><span class="op" id="2090360">,</span>&nbsp;<span class="op" id="2090362">-</span><span class="num" id="2090363">980</span><span class="op" id="2090366">,</span>&nbsp;<span class="builtintype" id="2090368">false</span><span class="op" id="2090373">}</span><span class="op" id="2090374">,</span>&nbsp;&nbsp;<span class="comment" id="2090377">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090389">{</span><span class="num" id="2090390">0xd3515c2831559a83</span><span class="op" id="2090408">,</span>&nbsp;<span class="op" id="2090410">-</span><span class="num" id="2090411">954</span><span class="op" id="2090414">,</span>&nbsp;<span class="builtintype" id="2090416">false</span><span class="op" id="2090421">}</span><span class="op" id="2090422">,</span>&nbsp;&nbsp;<span class="comment" id="2090425">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090437">{</span><span class="num" id="2090438">0x9d71ac8fada6c9b5</span><span class="op" id="2090456">,</span>&nbsp;<span class="op" id="2090458">-</span><span class="num" id="2090459">927</span><span class="op" id="2090462">,</span>&nbsp;<span class="builtintype" id="2090464">false</span><span class="op" id="2090469">}</span><span class="op" id="2090470">,</span>&nbsp;&nbsp;<span class="comment" id="2090473">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090485">{</span><span class="num" id="2090486">0xea9c227723ee8bcb</span><span class="op" id="2090504">,</span>&nbsp;<span class="op" id="2090506">-</span><span class="num" id="2090507">901</span><span class="op" id="2090510">,</span>&nbsp;<span class="builtintype" id="2090512">false</span><span class="op" id="2090517">}</span><span class="op" id="2090518">,</span>&nbsp;&nbsp;<span class="comment" id="2090521">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090533">{</span><span class="num" id="2090534">0xaecc49914078536d</span><span class="op" id="2090552">,</span>&nbsp;<span class="op" id="2090554">-</span><span class="num" id="2090555">874</span><span class="op" id="2090558">,</span>&nbsp;<span class="builtintype" id="2090560">false</span><span class="op" id="2090565">}</span><span class="op" id="2090566">,</span>&nbsp;&nbsp;<span class="comment" id="2090569">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090581">{</span><span class="num" id="2090582">0x823c12795db6ce57</span><span class="op" id="2090600">,</span>&nbsp;<span class="op" id="2090602">-</span><span class="num" id="2090603">847</span><span class="op" id="2090606">,</span>&nbsp;<span class="builtintype" id="2090608">false</span><span class="op" id="2090613">}</span><span class="op" id="2090614">,</span>&nbsp;&nbsp;<span class="comment" id="2090617">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090629">{</span><span class="num" id="2090630">0xc21094364dfb5637</span><span class="op" id="2090648">,</span>&nbsp;<span class="op" id="2090650">-</span><span class="num" id="2090651">821</span><span class="op" id="2090654">,</span>&nbsp;<span class="builtintype" id="2090656">false</span><span class="op" id="2090661">}</span><span class="op" id="2090662">,</span>&nbsp;&nbsp;<span class="comment" id="2090665">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090677">{</span><span class="num" id="2090678">0x9096ea6f3848984f</span><span class="op" id="2090696">,</span>&nbsp;<span class="op" id="2090698">-</span><span class="num" id="2090699">794</span><span class="op" id="2090702">,</span>&nbsp;<span class="builtintype" id="2090704">false</span><span class="op" id="2090709">}</span><span class="op" id="2090710">,</span>&nbsp;&nbsp;<span class="comment" id="2090713">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090725">{</span><span class="num" id="2090726">0xd77485cb25823ac7</span><span class="op" id="2090744">,</span>&nbsp;<span class="op" id="2090746">-</span><span class="num" id="2090747">768</span><span class="op" id="2090750">,</span>&nbsp;<span class="builtintype" id="2090752">false</span><span class="op" id="2090757">}</span><span class="op" id="2090758">,</span>&nbsp;&nbsp;<span class="comment" id="2090761">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090773">{</span><span class="num" id="2090774">0xa086cfcd97bf97f4</span><span class="op" id="2090792">,</span>&nbsp;<span class="op" id="2090794">-</span><span class="num" id="2090795">741</span><span class="op" id="2090798">,</span>&nbsp;<span class="builtintype" id="2090800">false</span><span class="op" id="2090805">}</span><span class="op" id="2090806">,</span>&nbsp;&nbsp;<span class="comment" id="2090809">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090821">{</span><span class="num" id="2090822">0xef340a98172aace5</span><span class="op" id="2090840">,</span>&nbsp;<span class="op" id="2090842">-</span><span class="num" id="2090843">715</span><span class="op" id="2090846">,</span>&nbsp;<span class="builtintype" id="2090848">false</span><span class="op" id="2090853">}</span><span class="op" id="2090854">,</span>&nbsp;&nbsp;<span class="comment" id="2090857">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090869">{</span><span class="num" id="2090870">0xb23867fb2a35b28e</span><span class="op" id="2090888">,</span>&nbsp;<span class="op" id="2090890">-</span><span class="num" id="2090891">688</span><span class="op" id="2090894">,</span>&nbsp;<span class="builtintype" id="2090896">false</span><span class="op" id="2090901">}</span><span class="op" id="2090902">,</span>&nbsp;&nbsp;<span class="comment" id="2090905">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090917">{</span><span class="num" id="2090918">0x84c8d4dfd2c63f3b</span><span class="op" id="2090936">,</span>&nbsp;<span class="op" id="2090938">-</span><span class="num" id="2090939">661</span><span class="op" id="2090942">,</span>&nbsp;<span class="builtintype" id="2090944">false</span><span class="op" id="2090949">}</span><span class="op" id="2090950">,</span>&nbsp;&nbsp;<span class="comment" id="2090953">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090965">{</span><span class="num" id="2090966">0xc5dd44271ad3cdba</span><span class="op" id="2090984">,</span>&nbsp;<span class="op" id="2090986">-</span><span class="num" id="2090987">635</span><span class="op" id="2090990">,</span>&nbsp;<span class="builtintype" id="2090992">false</span><span class="op" id="2090997">}</span><span class="op" id="2090998">,</span>&nbsp;&nbsp;<span class="comment" id="2091001">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091013">{</span><span class="num" id="2091014">0x936b9fcebb25c996</span><span class="op" id="2091032">,</span>&nbsp;<span class="op" id="2091034">-</span><span class="num" id="2091035">608</span><span class="op" id="2091038">,</span>&nbsp;<span class="builtintype" id="2091040">false</span><span class="op" id="2091045">}</span><span class="op" id="2091046">,</span>&nbsp;&nbsp;<span class="comment" id="2091049">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091061">{</span><span class="num" id="2091062">0xdbac6c247d62a584</span><span class="op" id="2091080">,</span>&nbsp;<span class="op" id="2091082">-</span><span class="num" id="2091083">582</span><span class="op" id="2091086">,</span>&nbsp;<span class="builtintype" id="2091088">false</span><span class="op" id="2091093">}</span><span class="op" id="2091094">,</span>&nbsp;&nbsp;<span class="comment" id="2091097">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091109">{</span><span class="num" id="2091110">0xa3ab66580d5fdaf6</span><span class="op" id="2091128">,</span>&nbsp;<span class="op" id="2091130">-</span><span class="num" id="2091131">555</span><span class="op" id="2091134">,</span>&nbsp;<span class="builtintype" id="2091136">false</span><span class="op" id="2091141">}</span><span class="op" id="2091142">,</span>&nbsp;&nbsp;<span class="comment" id="2091145">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091157">{</span><span class="num" id="2091158">0xf3e2f893dec3f126</span><span class="op" id="2091176">,</span>&nbsp;<span class="op" id="2091178">-</span><span class="num" id="2091179">529</span><span class="op" id="2091182">,</span>&nbsp;<span class="builtintype" id="2091184">false</span><span class="op" id="2091189">}</span><span class="op" id="2091190">,</span>&nbsp;&nbsp;<span class="comment" id="2091193">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091205">{</span><span class="num" id="2091206">0xb5b5ada8aaff80b8</span><span class="op" id="2091224">,</span>&nbsp;<span class="op" id="2091226">-</span><span class="num" id="2091227">502</span><span class="op" id="2091230">,</span>&nbsp;<span class="builtintype" id="2091232">false</span><span class="op" id="2091237">}</span><span class="op" id="2091238">,</span>&nbsp;&nbsp;<span class="comment" id="2091241">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091253">{</span><span class="num" id="2091254">0x87625f056c7c4a8b</span><span class="op" id="2091272">,</span>&nbsp;<span class="op" id="2091274">-</span><span class="num" id="2091275">475</span><span class="op" id="2091278">,</span>&nbsp;<span class="builtintype" id="2091280">false</span><span class="op" id="2091285">}</span><span class="op" id="2091286">,</span>&nbsp;&nbsp;<span class="comment" id="2091289">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091301">{</span><span class="num" id="2091302">0xc9bcff6034c13053</span><span class="op" id="2091320">,</span>&nbsp;<span class="op" id="2091322">-</span><span class="num" id="2091323">449</span><span class="op" id="2091326">,</span>&nbsp;<span class="builtintype" id="2091328">false</span><span class="op" id="2091333">}</span><span class="op" id="2091334">,</span>&nbsp;&nbsp;<span class="comment" id="2091337">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091349">{</span><span class="num" id="2091350">0x964e858c91ba2655</span><span class="op" id="2091368">,</span>&nbsp;<span class="op" id="2091370">-</span><span class="num" id="2091371">422</span><span class="op" id="2091374">,</span>&nbsp;<span class="builtintype" id="2091376">false</span><span class="op" id="2091381">}</span><span class="op" id="2091382">,</span>&nbsp;&nbsp;<span class="comment" id="2091385">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091397">{</span><span class="num" id="2091398">0xdff9772470297ebd</span><span class="op" id="2091416">,</span>&nbsp;<span class="op" id="2091418">-</span><span class="num" id="2091419">396</span><span class="op" id="2091422">,</span>&nbsp;<span class="builtintype" id="2091424">false</span><span class="op" id="2091429">}</span><span class="op" id="2091430">,</span>&nbsp;&nbsp;<span class="comment" id="2091433">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091445">{</span><span class="num" id="2091446">0xa6dfbd9fb8e5b88f</span><span class="op" id="2091464">,</span>&nbsp;<span class="op" id="2091466">-</span><span class="num" id="2091467">369</span><span class="op" id="2091470">,</span>&nbsp;<span class="builtintype" id="2091472">false</span><span class="op" id="2091477">}</span><span class="op" id="2091478">,</span>&nbsp;&nbsp;<span class="comment" id="2091481">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091492">{</span><span class="num" id="2091493">0xf8a95fcf88747d94</span><span class="op" id="2091511">,</span>&nbsp;<span class="op" id="2091513">-</span><span class="num" id="2091514">343</span><span class="op" id="2091517">,</span>&nbsp;<span class="builtintype" id="2091519">false</span><span class="op" id="2091524">}</span><span class="op" id="2091525">,</span>&nbsp;&nbsp;<span class="comment" id="2091528">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091539">{</span><span class="num" id="2091540">0xb94470938fa89bcf</span><span class="op" id="2091558">,</span>&nbsp;<span class="op" id="2091560">-</span><span class="num" id="2091561">316</span><span class="op" id="2091564">,</span>&nbsp;<span class="builtintype" id="2091566">false</span><span class="op" id="2091571">}</span><span class="op" id="2091572">,</span>&nbsp;&nbsp;<span class="comment" id="2091575">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091586">{</span><span class="num" id="2091587">0x8a08f0f8bf0f156b</span><span class="op" id="2091605">,</span>&nbsp;<span class="op" id="2091607">-</span><span class="num" id="2091608">289</span><span class="op" id="2091611">,</span>&nbsp;<span class="builtintype" id="2091613">false</span><span class="op" id="2091618">}</span><span class="op" id="2091619">,</span>&nbsp;&nbsp;<span class="comment" id="2091622">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091633">{</span><span class="num" id="2091634">0xcdb02555653131b6</span><span class="op" id="2091652">,</span>&nbsp;<span class="op" id="2091654">-</span><span class="num" id="2091655">263</span><span class="op" id="2091658">,</span>&nbsp;<span class="builtintype" id="2091660">false</span><span class="op" id="2091665">}</span><span class="op" id="2091666">,</span>&nbsp;&nbsp;<span class="comment" id="2091669">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091680">{</span><span class="num" id="2091681">0x993fe2c6d07b7fac</span><span class="op" id="2091699">,</span>&nbsp;<span class="op" id="2091701">-</span><span class="num" id="2091702">236</span><span class="op" id="2091705">,</span>&nbsp;<span class="builtintype" id="2091707">false</span><span class="op" id="2091712">}</span><span class="op" id="2091713">,</span>&nbsp;&nbsp;<span class="comment" id="2091716">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091727">{</span><span class="num" id="2091728">0xe45c10c42a2b3b06</span><span class="op" id="2091746">,</span>&nbsp;<span class="op" id="2091748">-</span><span class="num" id="2091749">210</span><span class="op" id="2091752">,</span>&nbsp;<span class="builtintype" id="2091754">false</span><span class="op" id="2091759">}</span><span class="op" id="2091760">,</span>&nbsp;&nbsp;<span class="comment" id="2091763">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091774">{</span><span class="num" id="2091775">0xaa242499697392d3</span><span class="op" id="2091793">,</span>&nbsp;<span class="op" id="2091795">-</span><span class="num" id="2091796">183</span><span class="op" id="2091799">,</span>&nbsp;<span class="builtintype" id="2091801">false</span><span class="op" id="2091806">}</span><span class="op" id="2091807">,</span>&nbsp;&nbsp;<span class="comment" id="2091810">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091821">{</span><span class="num" id="2091822">0xfd87b5f28300ca0e</span><span class="op" id="2091840">,</span>&nbsp;<span class="op" id="2091842">-</span><span class="num" id="2091843">157</span><span class="op" id="2091846">,</span>&nbsp;<span class="builtintype" id="2091848">false</span><span class="op" id="2091853">}</span><span class="op" id="2091854">,</span>&nbsp;&nbsp;<span class="comment" id="2091857">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091868">{</span><span class="num" id="2091869">0xbce5086492111aeb</span><span class="op" id="2091887">,</span>&nbsp;<span class="op" id="2091889">-</span><span class="num" id="2091890">130</span><span class="op" id="2091893">,</span>&nbsp;<span class="builtintype" id="2091895">false</span><span class="op" id="2091900">}</span><span class="op" id="2091901">,</span>&nbsp;&nbsp;<span class="comment" id="2091904">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091915">{</span><span class="num" id="2091916">0x8cbccc096f5088cc</span><span class="op" id="2091934">,</span>&nbsp;<span class="op" id="2091936">-</span><span class="num" id="2091937">103</span><span class="op" id="2091940">,</span>&nbsp;<span class="builtintype" id="2091942">false</span><span class="op" id="2091947">}</span><span class="op" id="2091948">,</span>&nbsp;&nbsp;<span class="comment" id="2091951">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091962">{</span><span class="num" id="2091963">0xd1b71758e219652c</span><span class="op" id="2091981">,</span>&nbsp;<span class="op" id="2091983">-</span><span class="num" id="2091984">77</span><span class="op" id="2091986">,</span>&nbsp;<span class="builtintype" id="2091988">false</span><span class="op" id="2091993">}</span><span class="op" id="2091994">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2091998">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092008">{</span><span class="num" id="2092009">0x9c40000000000000</span><span class="op" id="2092027">,</span>&nbsp;<span class="op" id="2092029">-</span><span class="num" id="2092030">50</span><span class="op" id="2092032">,</span>&nbsp;<span class="builtintype" id="2092034">false</span><span class="op" id="2092039">}</span><span class="op" id="2092040">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092044">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092053">{</span><span class="num" id="2092054">0xe8d4a51000000000</span><span class="op" id="2092072">,</span>&nbsp;<span class="op" id="2092074">-</span><span class="num" id="2092075">24</span><span class="op" id="2092077">,</span>&nbsp;<span class="builtintype" id="2092079">false</span><span class="op" id="2092084">}</span><span class="op" id="2092085">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092089">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092099">{</span><span class="num" id="2092100">0xad78ebc5ac620000</span><span class="op" id="2092118">,</span>&nbsp;<span class="num" id="2092120">3</span><span class="op" id="2092121">,</span>&nbsp;<span class="builtintype" id="2092123">false</span><span class="op" id="2092128">}</span><span class="op" id="2092129">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092135">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092145">{</span><span class="num" id="2092146">0x813f3978f8940984</span><span class="op" id="2092164">,</span>&nbsp;<span class="num" id="2092166">30</span><span class="op" id="2092168">,</span>&nbsp;<span class="builtintype" id="2092170">false</span><span class="op" id="2092175">}</span><span class="op" id="2092176">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092181">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092191">{</span><span class="num" id="2092192">0xc097ce7bc90715b3</span><span class="op" id="2092210">,</span>&nbsp;<span class="num" id="2092212">56</span><span class="op" id="2092214">,</span>&nbsp;<span class="builtintype" id="2092216">false</span><span class="op" id="2092221">}</span><span class="op" id="2092222">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092227">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092237">{</span><span class="num" id="2092238">0x8f7e32ce7bea5c70</span><span class="op" id="2092256">,</span>&nbsp;<span class="num" id="2092258">83</span><span class="op" id="2092260">,</span>&nbsp;<span class="builtintype" id="2092262">false</span><span class="op" id="2092267">}</span><span class="op" id="2092268">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092273">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092283">{</span><span class="num" id="2092284">0xd5d238a4abe98068</span><span class="op" id="2092302">,</span>&nbsp;<span class="num" id="2092304">109</span><span class="op" id="2092307">,</span>&nbsp;<span class="builtintype" id="2092309">false</span><span class="op" id="2092314">}</span><span class="op" id="2092315">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092319">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092329">{</span><span class="num" id="2092330">0x9f4f2726179a2245</span><span class="op" id="2092348">,</span>&nbsp;<span class="num" id="2092350">136</span><span class="op" id="2092353">,</span>&nbsp;<span class="builtintype" id="2092355">false</span><span class="op" id="2092360">}</span><span class="op" id="2092361">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092365">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092375">{</span><span class="num" id="2092376">0xed63a231d4c4fb27</span><span class="op" id="2092394">,</span>&nbsp;<span class="num" id="2092396">162</span><span class="op" id="2092399">,</span>&nbsp;<span class="builtintype" id="2092401">false</span><span class="op" id="2092406">}</span><span class="op" id="2092407">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092411">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092421">{</span><span class="num" id="2092422">0xb0de65388cc8ada8</span><span class="op" id="2092440">,</span>&nbsp;<span class="num" id="2092442">189</span><span class="op" id="2092445">,</span>&nbsp;<span class="builtintype" id="2092447">false</span><span class="op" id="2092452">}</span><span class="op" id="2092453">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092457">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092467">{</span><span class="num" id="2092468">0x83c7088e1aab65db</span><span class="op" id="2092486">,</span>&nbsp;<span class="num" id="2092488">216</span><span class="op" id="2092491">,</span>&nbsp;<span class="builtintype" id="2092493">false</span><span class="op" id="2092498">}</span><span class="op" id="2092499">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092503">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092513">{</span><span class="num" id="2092514">0xc45d1df942711d9a</span><span class="op" id="2092532">,</span>&nbsp;<span class="num" id="2092534">242</span><span class="op" id="2092537">,</span>&nbsp;<span class="builtintype" id="2092539">false</span><span class="op" id="2092544">}</span><span class="op" id="2092545">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092549">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092559">{</span><span class="num" id="2092560">0x924d692ca61be758</span><span class="op" id="2092578">,</span>&nbsp;<span class="num" id="2092580">269</span><span class="op" id="2092583">,</span>&nbsp;<span class="builtintype" id="2092585">false</span><span class="op" id="2092590">}</span><span class="op" id="2092591">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092595">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092606">{</span><span class="num" id="2092607">0xda01ee641a708dea</span><span class="op" id="2092625">,</span>&nbsp;<span class="num" id="2092627">295</span><span class="op" id="2092630">,</span>&nbsp;<span class="builtintype" id="2092632">false</span><span class="op" id="2092637">}</span><span class="op" id="2092638">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092642">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092653">{</span><span class="num" id="2092654">0xa26da3999aef774a</span><span class="op" id="2092672">,</span>&nbsp;<span class="num" id="2092674">322</span><span class="op" id="2092677">,</span>&nbsp;<span class="builtintype" id="2092679">false</span><span class="op" id="2092684">}</span><span class="op" id="2092685">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092689">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092700">{</span><span class="num" id="2092701">0xf209787bb47d6b85</span><span class="op" id="2092719">,</span>&nbsp;<span class="num" id="2092721">348</span><span class="op" id="2092724">,</span>&nbsp;<span class="builtintype" id="2092726">false</span><span class="op" id="2092731">}</span><span class="op" id="2092732">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092736">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092747">{</span><span class="num" id="2092748">0xb454e4a179dd1877</span><span class="op" id="2092766">,</span>&nbsp;<span class="num" id="2092768">375</span><span class="op" id="2092771">,</span>&nbsp;<span class="builtintype" id="2092773">false</span><span class="op" id="2092778">}</span><span class="op" id="2092779">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092783">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092794">{</span><span class="num" id="2092795">0x865b86925b9bc5c2</span><span class="op" id="2092813">,</span>&nbsp;<span class="num" id="2092815">402</span><span class="op" id="2092818">,</span>&nbsp;<span class="builtintype" id="2092820">false</span><span class="op" id="2092825">}</span><span class="op" id="2092826">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092830">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092841">{</span><span class="num" id="2092842">0xc83553c5c8965d3d</span><span class="op" id="2092860">,</span>&nbsp;<span class="num" id="2092862">428</span><span class="op" id="2092865">,</span>&nbsp;<span class="builtintype" id="2092867">false</span><span class="op" id="2092872">}</span><span class="op" id="2092873">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092877">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092888">{</span><span class="num" id="2092889">0x952ab45cfa97a0b3</span><span class="op" id="2092907">,</span>&nbsp;<span class="num" id="2092909">455</span><span class="op" id="2092912">,</span>&nbsp;<span class="builtintype" id="2092914">false</span><span class="op" id="2092919">}</span><span class="op" id="2092920">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092924">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092935">{</span><span class="num" id="2092936">0xde469fbd99a05fe3</span><span class="op" id="2092954">,</span>&nbsp;<span class="num" id="2092956">481</span><span class="op" id="2092959">,</span>&nbsp;<span class="builtintype" id="2092961">false</span><span class="op" id="2092966">}</span><span class="op" id="2092967">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2092971">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092982">{</span><span class="num" id="2092983">0xa59bc234db398c25</span><span class="op" id="2093001">,</span>&nbsp;<span class="num" id="2093003">508</span><span class="op" id="2093006">,</span>&nbsp;<span class="builtintype" id="2093008">false</span><span class="op" id="2093013">}</span><span class="op" id="2093014">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093018">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093029">{</span><span class="num" id="2093030">0xf6c69a72a3989f5c</span><span class="op" id="2093048">,</span>&nbsp;<span class="num" id="2093050">534</span><span class="op" id="2093053">,</span>&nbsp;<span class="builtintype" id="2093055">false</span><span class="op" id="2093060">}</span><span class="op" id="2093061">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093065">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093076">{</span><span class="num" id="2093077">0xb7dcbf5354e9bece</span><span class="op" id="2093095">,</span>&nbsp;<span class="num" id="2093097">561</span><span class="op" id="2093100">,</span>&nbsp;<span class="builtintype" id="2093102">false</span><span class="op" id="2093107">}</span><span class="op" id="2093108">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093112">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093123">{</span><span class="num" id="2093124">0x88fcf317f22241e2</span><span class="op" id="2093142">,</span>&nbsp;<span class="num" id="2093144">588</span><span class="op" id="2093147">,</span>&nbsp;<span class="builtintype" id="2093149">false</span><span class="op" id="2093154">}</span><span class="op" id="2093155">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093159">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093170">{</span><span class="num" id="2093171">0xcc20ce9bd35c78a5</span><span class="op" id="2093189">,</span>&nbsp;<span class="num" id="2093191">614</span><span class="op" id="2093194">,</span>&nbsp;<span class="builtintype" id="2093196">false</span><span class="op" id="2093201">}</span><span class="op" id="2093202">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093206">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093217">{</span><span class="num" id="2093218">0x98165af37b2153df</span><span class="op" id="2093236">,</span>&nbsp;<span class="num" id="2093238">641</span><span class="op" id="2093241">,</span>&nbsp;<span class="builtintype" id="2093243">false</span><span class="op" id="2093248">}</span><span class="op" id="2093249">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093253">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093264">{</span><span class="num" id="2093265">0xe2a0b5dc971f303a</span><span class="op" id="2093283">,</span>&nbsp;<span class="num" id="2093285">667</span><span class="op" id="2093288">,</span>&nbsp;<span class="builtintype" id="2093290">false</span><span class="op" id="2093295">}</span><span class="op" id="2093296">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093300">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093311">{</span><span class="num" id="2093312">0xa8d9d1535ce3b396</span><span class="op" id="2093330">,</span>&nbsp;<span class="num" id="2093332">694</span><span class="op" id="2093335">,</span>&nbsp;<span class="builtintype" id="2093337">false</span><span class="op" id="2093342">}</span><span class="op" id="2093343">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093347">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093358">{</span><span class="num" id="2093359">0xfb9b7cd9a4a7443c</span><span class="op" id="2093377">,</span>&nbsp;<span class="num" id="2093379">720</span><span class="op" id="2093382">,</span>&nbsp;<span class="builtintype" id="2093384">false</span><span class="op" id="2093389">}</span><span class="op" id="2093390">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093394">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093405">{</span><span class="num" id="2093406">0xbb764c4ca7a44410</span><span class="op" id="2093424">,</span>&nbsp;<span class="num" id="2093426">747</span><span class="op" id="2093429">,</span>&nbsp;<span class="builtintype" id="2093431">false</span><span class="op" id="2093436">}</span><span class="op" id="2093437">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093441">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093452">{</span><span class="num" id="2093453">0x8bab8eefb6409c1a</span><span class="op" id="2093471">,</span>&nbsp;<span class="num" id="2093473">774</span><span class="op" id="2093476">,</span>&nbsp;<span class="builtintype" id="2093478">false</span><span class="op" id="2093483">}</span><span class="op" id="2093484">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093488">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093499">{</span><span class="num" id="2093500">0xd01fef10a657842c</span><span class="op" id="2093518">,</span>&nbsp;<span class="num" id="2093520">800</span><span class="op" id="2093523">,</span>&nbsp;<span class="builtintype" id="2093525">false</span><span class="op" id="2093530">}</span><span class="op" id="2093531">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093535">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093546">{</span><span class="num" id="2093547">0x9b10a4e5e9913129</span><span class="op" id="2093565">,</span>&nbsp;<span class="num" id="2093567">827</span><span class="op" id="2093570">,</span>&nbsp;<span class="builtintype" id="2093572">false</span><span class="op" id="2093577">}</span><span class="op" id="2093578">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093582">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093593">{</span><span class="num" id="2093594">0xe7109bfba19c0c9d</span><span class="op" id="2093612">,</span>&nbsp;<span class="num" id="2093614">853</span><span class="op" id="2093617">,</span>&nbsp;<span class="builtintype" id="2093619">false</span><span class="op" id="2093624">}</span><span class="op" id="2093625">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093629">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093640">{</span><span class="num" id="2093641">0xac2820d9623bf429</span><span class="op" id="2093659">,</span>&nbsp;<span class="num" id="2093661">880</span><span class="op" id="2093664">,</span>&nbsp;<span class="builtintype" id="2093666">false</span><span class="op" id="2093671">}</span><span class="op" id="2093672">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093676">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093687">{</span><span class="num" id="2093688">0x80444b5e7aa7cf85</span><span class="op" id="2093706">,</span>&nbsp;<span class="num" id="2093708">907</span><span class="op" id="2093711">,</span>&nbsp;<span class="builtintype" id="2093713">false</span><span class="op" id="2093718">}</span><span class="op" id="2093719">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093723">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093734">{</span><span class="num" id="2093735">0xbf21e44003acdd2d</span><span class="op" id="2093753">,</span>&nbsp;<span class="num" id="2093755">933</span><span class="op" id="2093758">,</span>&nbsp;<span class="builtintype" id="2093760">false</span><span class="op" id="2093765">}</span><span class="op" id="2093766">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093770">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093781">{</span><span class="num" id="2093782">0x8e679c2f5e44ff8f</span><span class="op" id="2093800">,</span>&nbsp;<span class="num" id="2093802">960</span><span class="op" id="2093805">,</span>&nbsp;<span class="builtintype" id="2093807">false</span><span class="op" id="2093812">}</span><span class="op" id="2093813">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093817">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093828">{</span><span class="num" id="2093829">0xd433179d9c8cb841</span><span class="op" id="2093847">,</span>&nbsp;<span class="num" id="2093849">986</span><span class="op" id="2093852">,</span>&nbsp;<span class="builtintype" id="2093854">false</span><span class="op" id="2093859">}</span><span class="op" id="2093860">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2093864">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093875">{</span><span class="num" id="2093876">0x9e19db92b4e31ba9</span><span class="op" id="2093894">,</span>&nbsp;<span class="num" id="2093896">1013</span><span class="op" id="2093900">,</span>&nbsp;<span class="builtintype" id="2093902">false</span><span class="op" id="2093907">}</span><span class="op" id="2093908">,</span>&nbsp;&nbsp;<span class="comment" id="2093911">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093922">{</span><span class="num" id="2093923">0xeb96bf6ebadf77d9</span><span class="op" id="2093941">,</span>&nbsp;<span class="num" id="2093943">1039</span><span class="op" id="2093947">,</span>&nbsp;<span class="builtintype" id="2093949">false</span><span class="op" id="2093954">}</span><span class="op" id="2093955">,</span>&nbsp;&nbsp;<span class="comment" id="2093958">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093969">{</span><span class="num" id="2093970">0xaf87023b9bf0ee6b</span><span class="op" id="2093988">,</span>&nbsp;<span class="num" id="2093990">1066</span><span class="op" id="2093994">,</span>&nbsp;<span class="builtintype" id="2093996">false</span><span class="op" id="2094001">}</span><span class="op" id="2094002">,</span>&nbsp;&nbsp;<span class="comment" id="2094005">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2094015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2094018">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2094086">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2094149">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2094184">func</span>&nbsp;<span class="op" id="2094189">(</span><span class="ident" id="2094190">f</span>&nbsp;<span class="op" id="2094192">*</span><span class="ident" id="2094193">extFloat</span><span class="op" id="2094201">)</span>&nbsp;<span class="ident" id="2094203">floatBits</span><span class="op" id="2094212">(</span><span class="ident" id="2094213">flt</span>&nbsp;<span class="op" id="2094217">*</span><span class="ident" id="2094218">floatInfo</span><span class="op" id="2094227">)</span>&nbsp;<span class="op" id="2094229">(</span><span class="ident" id="2094230">bits</span>&nbsp;<span class="ident" id="2094235">uint64</span><span class="op" id="2094241">,</span>&nbsp;<span class="ident" id="2094243">overflow</span>&nbsp;<span class="builtintype" id="2094252">bool</span><span class="op" id="2094256">)</span>&nbsp;<span class="op" id="2094258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094261">f</span><span class="op" id="2094262">.</span><span class="ident" id="2094263">Normalize</span><span class="op" id="2094272">(</span><span class="op" id="2094273">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094277">exp</span>&nbsp;<span class="op" id="2094281">:=</span>&nbsp;<span class="ident" id="2094284">f</span><span class="op" id="2094285">.</span><span class="ident" id="2094286">exp</span>&nbsp;<span class="op" id="2094290">+</span>&nbsp;<span class="num" id="2094292">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094297">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094321">if</span>&nbsp;<span class="ident" id="2094324">exp</span>&nbsp;<span class="op" id="2094328">&lt;</span>&nbsp;<span class="ident" id="2094330">flt</span><span class="op" id="2094333">.</span><span class="ident" id="2094334">bias</span><span class="op" id="2094338">+</span><span class="num" id="2094339">1</span>&nbsp;<span class="op" id="2094341">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094345">n</span>&nbsp;<span class="op" id="2094347">:=</span>&nbsp;<span class="ident" id="2094350">flt</span><span class="op" id="2094353">.</span><span class="ident" id="2094354">bias</span>&nbsp;<span class="op" id="2094359">+</span>&nbsp;<span class="num" id="2094361">1</span>&nbsp;<span class="op" id="2094363">-</span>&nbsp;<span class="ident" id="2094365">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094371">f</span><span class="op" id="2094372">.</span><span class="ident" id="2094373">mant</span>&nbsp;<span class="op" id="2094378">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2094382">uint</span><span class="op" id="2094386">(</span><span class="ident" id="2094387">n</span><span class="op" id="2094388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094392">exp</span>&nbsp;<span class="op" id="2094396">+=</span>&nbsp;<span class="ident" id="2094399">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094406">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094464">mant</span>&nbsp;<span class="op" id="2094469">:=</span>&nbsp;<span class="ident" id="2094472">f</span><span class="op" id="2094473">.</span><span class="ident" id="2094474">mant</span>&nbsp;<span class="op" id="2094479">&gt;&gt;</span>&nbsp;<span class="op" id="2094482">(</span><span class="num" id="2094483">63</span>&nbsp;<span class="op" id="2094486">-</span>&nbsp;<span class="ident" id="2094488">flt</span><span class="op" id="2094491">.</span><span class="ident" id="2094492">mantbits</span><span class="op" id="2094500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094503">if</span>&nbsp;<span class="ident" id="2094506">f</span><span class="op" id="2094507">.</span><span class="ident" id="2094508">mant</span><span class="op" id="2094512">&amp;</span><span class="op" id="2094513">(</span><span class="num" id="2094514">1</span><span class="op" id="2094515">&lt;&lt;</span><span class="op" id="2094517">(</span><span class="num" id="2094518">62</span><span class="op" id="2094520">-</span><span class="ident" id="2094521">flt</span><span class="op" id="2094524">.</span><span class="ident" id="2094525">mantbits</span><span class="op" id="2094533">)</span><span class="op" id="2094534">)</span>&nbsp;<span class="op" id="2094536">!=</span>&nbsp;<span class="num" id="2094539">0</span>&nbsp;<span class="op" id="2094541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094545">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094560">mant</span>&nbsp;<span class="op" id="2094565">+=</span>&nbsp;<span class="num" id="2094568">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094575">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094624">if</span>&nbsp;<span class="ident" id="2094627">mant</span>&nbsp;<span class="op" id="2094632">==</span>&nbsp;<span class="num" id="2094635">2</span><span class="op" id="2094636">&lt;&lt;</span><span class="ident" id="2094638">flt</span><span class="op" id="2094641">.</span><span class="ident" id="2094642">mantbits</span>&nbsp;<span class="op" id="2094651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094655">mant</span>&nbsp;<span class="op" id="2094660">&gt;&gt;=</span>&nbsp;<span class="num" id="2094664">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094668">exp</span><span class="op" id="2094671">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094679">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094695">if</span>&nbsp;<span class="ident" id="2094698">exp</span><span class="op" id="2094701">-</span><span class="ident" id="2094702">flt</span><span class="op" id="2094705">.</span><span class="ident" id="2094706">bias</span>&nbsp;<span class="op" id="2094711">&gt;=</span>&nbsp;<span class="num" id="2094714">1</span><span class="op" id="2094715">&lt;&lt;</span><span class="ident" id="2094717">flt</span><span class="op" id="2094720">.</span><span class="ident" id="2094721">expbits</span><span class="op" id="2094728">-</span><span class="num" id="2094729">1</span>&nbsp;<span class="op" id="2094731">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094735">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094746">mant</span>&nbsp;<span class="op" id="2094751">=</span>&nbsp;<span class="num" id="2094753">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094757">exp</span>&nbsp;<span class="op" id="2094761">=</span>&nbsp;<span class="num" id="2094763">1</span><span class="op" id="2094764">&lt;&lt;</span><span class="ident" id="2094766">flt</span><span class="op" id="2094769">.</span><span class="ident" id="2094770">expbits</span>&nbsp;<span class="op" id="2094778">-</span>&nbsp;<span class="num" id="2094780">1</span>&nbsp;<span class="op" id="2094782">+</span>&nbsp;<span class="ident" id="2094784">flt</span><span class="op" id="2094787">.</span><span class="ident" id="2094788">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094795">overflow</span>&nbsp;<span class="op" id="2094804">=</span>&nbsp;<span class="builtintype" id="2094806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094812">}</span>&nbsp;<span class="keyword" id="2094814">else</span>&nbsp;<span class="keyword" id="2094819">if</span>&nbsp;<span class="ident" id="2094822">mant</span><span class="op" id="2094826">&amp;</span><span class="op" id="2094827">(</span><span class="num" id="2094828">1</span><span class="op" id="2094829">&lt;&lt;</span><span class="ident" id="2094831">flt</span><span class="op" id="2094834">.</span><span class="ident" id="2094835">mantbits</span><span class="op" id="2094843">)</span>&nbsp;<span class="op" id="2094845">==</span>&nbsp;<span class="num" id="2094848">0</span>&nbsp;<span class="op" id="2094850">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094854">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094873">exp</span>&nbsp;<span class="op" id="2094877">=</span>&nbsp;<span class="ident" id="2094879">flt</span><span class="op" id="2094882">.</span><span class="ident" id="2094883">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094892">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094911">bits</span>&nbsp;<span class="op" id="2094916">=</span>&nbsp;<span class="ident" id="2094918">mant</span>&nbsp;<span class="op" id="2094923">&amp;</span>&nbsp;<span class="op" id="2094925">(</span><span class="ident" id="2094926">uint64</span><span class="op" id="2094932">(</span><span class="num" id="2094933">1</span><span class="op" id="2094934">)</span><span class="op" id="2094935">&lt;&lt;</span><span class="ident" id="2094937">flt</span><span class="op" id="2094940">.</span><span class="ident" id="2094941">mantbits</span>&nbsp;<span class="op" id="2094950">-</span>&nbsp;<span class="num" id="2094952">1</span><span class="op" id="2094953">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094956">bits</span>&nbsp;<span class="op" id="2094961">|=</span>&nbsp;<span class="ident" id="2094964">uint64</span><span class="op" id="2094970">(</span><span class="op" id="2094971">(</span><span class="ident" id="2094972">exp</span><span class="op" id="2094975">-</span><span class="ident" id="2094976">flt</span><span class="op" id="2094979">.</span><span class="ident" id="2094980">bias</span><span class="op" id="2094984">)</span><span class="op" id="2094985">&amp;</span><span class="op" id="2094986">(</span><span class="num" id="2094987">1</span><span class="op" id="2094988">&lt;&lt;</span><span class="ident" id="2094990">flt</span><span class="op" id="2094993">.</span><span class="ident" id="2094994">expbits</span><span class="op" id="2095001">-</span><span class="num" id="2095002">1</span><span class="op" id="2095003">)</span><span class="op" id="2095004">)</span>&nbsp;<span class="op" id="2095006">&lt;&lt;</span>&nbsp;<span class="ident" id="2095009">flt</span><span class="op" id="2095012">.</span><span class="ident" id="2095013">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095023">if</span>&nbsp;<span class="ident" id="2095026">f</span><span class="op" id="2095027">.</span><span class="ident" id="2095028">neg</span>&nbsp;<span class="op" id="2095032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095036">bits</span>&nbsp;<span class="op" id="2095041">|=</span>&nbsp;<span class="num" id="2095044">1</span>&nbsp;<span class="op" id="2095046">&lt;&lt;</span>&nbsp;<span class="op" id="2095049">(</span><span class="ident" id="2095050">flt</span><span class="op" id="2095053">.</span><span class="ident" id="2095054">mantbits</span>&nbsp;<span class="op" id="2095063">+</span>&nbsp;<span class="ident" id="2095065">flt</span><span class="op" id="2095068">.</span><span class="ident" id="2095069">expbits</span><span class="op" id="2095076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095082">return</span><br>
<span class="lineno">170</span><span class="op" id="2095089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2095092">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2095150">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2095213">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2095273">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2095344">func</span>&nbsp;<span class="op" id="2095349">(</span><span class="ident" id="2095350">f</span>&nbsp;<span class="op" id="2095352">*</span><span class="ident" id="2095353">extFloat</span><span class="op" id="2095361">)</span>&nbsp;<span class="ident" id="2095363">AssignComputeBounds</span><span class="op" id="2095382">(</span><span class="ident" id="2095383">mant</span>&nbsp;<span class="ident" id="2095388">uint64</span><span class="op" id="2095394">,</span>&nbsp;<span class="ident" id="2095396">exp</span>&nbsp;<span class="builtintype" id="2095400">int</span><span class="op" id="2095403">,</span>&nbsp;<span class="ident" id="2095405">neg</span>&nbsp;<span class="builtintype" id="2095409">bool</span><span class="op" id="2095413">,</span>&nbsp;<span class="ident" id="2095415">flt</span>&nbsp;<span class="op" id="2095419">*</span><span class="ident" id="2095420">floatInfo</span><span class="op" id="2095429">)</span>&nbsp;<span class="op" id="2095431">(</span><span class="ident" id="2095432">lower</span><span class="op" id="2095437">,</span>&nbsp;<span class="ident" id="2095439">upper</span>&nbsp;<span class="ident" id="2095445">extFloat</span><span class="op" id="2095453">)</span>&nbsp;<span class="op" id="2095455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095458">f</span><span class="op" id="2095459">.</span><span class="ident" id="2095460">mant</span>&nbsp;<span class="op" id="2095465">=</span>&nbsp;<span class="ident" id="2095467">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095473">f</span><span class="op" id="2095474">.</span><span class="ident" id="2095475">exp</span>&nbsp;<span class="op" id="2095479">=</span>&nbsp;<span class="ident" id="2095481">exp</span>&nbsp;<span class="op" id="2095485">-</span>&nbsp;<span class="builtintype" id="2095487">int</span><span class="op" id="2095490">(</span><span class="ident" id="2095491">flt</span><span class="op" id="2095494">.</span><span class="ident" id="2095495">mantbits</span><span class="op" id="2095503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095506">f</span><span class="op" id="2095507">.</span><span class="ident" id="2095508">neg</span>&nbsp;<span class="op" id="2095512">=</span>&nbsp;<span class="ident" id="2095514">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095519">if</span>&nbsp;<span class="ident" id="2095522">f</span><span class="op" id="2095523">.</span><span class="ident" id="2095524">exp</span>&nbsp;<span class="op" id="2095528">&lt;=</span>&nbsp;<span class="num" id="2095531">0</span>&nbsp;<span class="op" id="2095533">&amp;&amp;</span>&nbsp;<span class="ident" id="2095536">mant</span>&nbsp;<span class="op" id="2095541">==</span>&nbsp;<span class="op" id="2095544">(</span><span class="ident" id="2095545">mant</span><span class="op" id="2095549">&gt;&gt;</span><span class="builtintype" id="2095551">uint</span><span class="op" id="2095555">(</span><span class="op" id="2095556">-</span><span class="ident" id="2095557">f</span><span class="op" id="2095558">.</span><span class="ident" id="2095559">exp</span><span class="op" id="2095562">)</span><span class="op" id="2095563">)</span><span class="op" id="2095564">&lt;&lt;</span><span class="builtintype" id="2095566">uint</span><span class="op" id="2095570">(</span><span class="op" id="2095571">-</span><span class="ident" id="2095572">f</span><span class="op" id="2095573">.</span><span class="ident" id="2095574">exp</span><span class="op" id="2095577">)</span>&nbsp;<span class="op" id="2095579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2095583">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095605">f</span><span class="op" id="2095606">.</span><span class="ident" id="2095607">mant</span>&nbsp;<span class="op" id="2095612">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2095616">uint</span><span class="op" id="2095620">(</span><span class="op" id="2095621">-</span><span class="ident" id="2095622">f</span><span class="op" id="2095623">.</span><span class="ident" id="2095624">exp</span><span class="op" id="2095627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095631">f</span><span class="op" id="2095632">.</span><span class="ident" id="2095633">exp</span>&nbsp;<span class="op" id="2095637">=</span>&nbsp;<span class="num" id="2095639">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095643">return</span>&nbsp;<span class="op" id="2095650">*</span><span class="ident" id="2095651">f</span><span class="op" id="2095652">,</span>&nbsp;<span class="op" id="2095654">*</span><span class="ident" id="2095655">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095661">expBiased</span>&nbsp;<span class="op" id="2095671">:=</span>&nbsp;<span class="ident" id="2095674">exp</span>&nbsp;<span class="op" id="2095678">-</span>&nbsp;<span class="ident" id="2095680">flt</span><span class="op" id="2095683">.</span><span class="ident" id="2095684">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095691">upper</span>&nbsp;<span class="op" id="2095697">=</span>&nbsp;<span class="ident" id="2095699">extFloat</span><span class="op" id="2095707">{</span><span class="ident" id="2095708">mant</span><span class="op" id="2095712">:</span>&nbsp;<span class="num" id="2095714">2</span><span class="op" id="2095715">*</span><span class="ident" id="2095716">f</span><span class="op" id="2095717">.</span><span class="ident" id="2095718">mant</span>&nbsp;<span class="op" id="2095723">+</span>&nbsp;<span class="num" id="2095725">1</span><span class="op" id="2095726">,</span>&nbsp;<span class="ident" id="2095728">exp</span><span class="op" id="2095731">:</span>&nbsp;<span class="ident" id="2095733">f</span><span class="op" id="2095734">.</span><span class="ident" id="2095735">exp</span>&nbsp;<span class="op" id="2095739">-</span>&nbsp;<span class="num" id="2095741">1</span><span class="op" id="2095742">,</span>&nbsp;<span class="ident" id="2095744">neg</span><span class="op" id="2095747">:</span>&nbsp;<span class="ident" id="2095749">f</span><span class="op" id="2095750">.</span><span class="ident" id="2095751">neg</span><span class="op" id="2095754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095757">if</span>&nbsp;<span class="ident" id="2095760">mant</span>&nbsp;<span class="op" id="2095765">!=</span>&nbsp;<span class="num" id="2095768">1</span><span class="op" id="2095769">&lt;&lt;</span><span class="ident" id="2095771">flt</span><span class="op" id="2095774">.</span><span class="ident" id="2095775">mantbits</span>&nbsp;<span class="op" id="2095784">||</span>&nbsp;<span class="ident" id="2095787">expBiased</span>&nbsp;<span class="op" id="2095797">==</span>&nbsp;<span class="num" id="2095800">1</span>&nbsp;<span class="op" id="2095802">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095806">lower</span>&nbsp;<span class="op" id="2095812">=</span>&nbsp;<span class="ident" id="2095814">extFloat</span><span class="op" id="2095822">{</span><span class="ident" id="2095823">mant</span><span class="op" id="2095827">:</span>&nbsp;<span class="num" id="2095829">2</span><span class="op" id="2095830">*</span><span class="ident" id="2095831">f</span><span class="op" id="2095832">.</span><span class="ident" id="2095833">mant</span>&nbsp;<span class="op" id="2095838">-</span>&nbsp;<span class="num" id="2095840">1</span><span class="op" id="2095841">,</span>&nbsp;<span class="ident" id="2095843">exp</span><span class="op" id="2095846">:</span>&nbsp;<span class="ident" id="2095848">f</span><span class="op" id="2095849">.</span><span class="ident" id="2095850">exp</span>&nbsp;<span class="op" id="2095854">-</span>&nbsp;<span class="num" id="2095856">1</span><span class="op" id="2095857">,</span>&nbsp;<span class="ident" id="2095859">neg</span><span class="op" id="2095862">:</span>&nbsp;<span class="ident" id="2095864">f</span><span class="op" id="2095865">.</span><span class="ident" id="2095866">neg</span><span class="op" id="2095869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095872">}</span>&nbsp;<span class="keyword" id="2095874">else</span>&nbsp;<span class="op" id="2095879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095883">lower</span>&nbsp;<span class="op" id="2095889">=</span>&nbsp;<span class="ident" id="2095891">extFloat</span><span class="op" id="2095899">{</span><span class="ident" id="2095900">mant</span><span class="op" id="2095904">:</span>&nbsp;<span class="num" id="2095906">4</span><span class="op" id="2095907">*</span><span class="ident" id="2095908">f</span><span class="op" id="2095909">.</span><span class="ident" id="2095910">mant</span>&nbsp;<span class="op" id="2095915">-</span>&nbsp;<span class="num" id="2095917">1</span><span class="op" id="2095918">,</span>&nbsp;<span class="ident" id="2095920">exp</span><span class="op" id="2095923">:</span>&nbsp;<span class="ident" id="2095925">f</span><span class="op" id="2095926">.</span><span class="ident" id="2095927">exp</span>&nbsp;<span class="op" id="2095931">-</span>&nbsp;<span class="num" id="2095933">2</span><span class="op" id="2095934">,</span>&nbsp;<span class="ident" id="2095936">neg</span><span class="op" id="2095939">:</span>&nbsp;<span class="ident" id="2095941">f</span><span class="op" id="2095942">.</span><span class="ident" id="2095943">neg</span><span class="op" id="2095946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095952">return</span><br>
<span class="lineno">195</span><span class="op" id="2095959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2095962">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2096031">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2096102">func</span>&nbsp;<span class="op" id="2096107">(</span><span class="ident" id="2096108">f</span>&nbsp;<span class="op" id="2096110">*</span><span class="ident" id="2096111">extFloat</span><span class="op" id="2096119">)</span>&nbsp;<span class="ident" id="2096121">Normalize</span><span class="op" id="2096130">(</span><span class="op" id="2096131">)</span>&nbsp;<span class="op" id="2096133">(</span><span class="ident" id="2096134">shift</span>&nbsp;<span class="builtintype" id="2096140">uint</span><span class="op" id="2096144">)</span>&nbsp;<span class="op" id="2096146">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096149">mant</span><span class="op" id="2096153">,</span>&nbsp;<span class="ident" id="2096155">exp</span>&nbsp;<span class="op" id="2096159">:=</span>&nbsp;<span class="ident" id="2096162">f</span><span class="op" id="2096163">.</span><span class="ident" id="2096164">mant</span><span class="op" id="2096168">,</span>&nbsp;<span class="ident" id="2096170">f</span><span class="op" id="2096171">.</span><span class="ident" id="2096172">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096177">if</span>&nbsp;<span class="ident" id="2096180">mant</span>&nbsp;<span class="op" id="2096185">==</span>&nbsp;<span class="num" id="2096188">0</span>&nbsp;<span class="op" id="2096190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096194">return</span>&nbsp;<span class="num" id="2096201">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096207">if</span>&nbsp;<span class="ident" id="2096210">mant</span><span class="op" id="2096214">&gt;&gt;</span><span class="op" id="2096216">(</span><span class="num" id="2096217">64</span><span class="op" id="2096219">-</span><span class="num" id="2096220">32</span><span class="op" id="2096222">)</span>&nbsp;<span class="op" id="2096224">==</span>&nbsp;<span class="num" id="2096227">0</span>&nbsp;<span class="op" id="2096229">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096233">mant</span>&nbsp;<span class="op" id="2096238">&lt;&lt;=</span>&nbsp;<span class="num" id="2096242">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096247">exp</span>&nbsp;<span class="op" id="2096251">-=</span>&nbsp;<span class="num" id="2096254">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096261">if</span>&nbsp;<span class="ident" id="2096264">mant</span><span class="op" id="2096268">&gt;&gt;</span><span class="op" id="2096270">(</span><span class="num" id="2096271">64</span><span class="op" id="2096273">-</span><span class="num" id="2096274">16</span><span class="op" id="2096276">)</span>&nbsp;<span class="op" id="2096278">==</span>&nbsp;<span class="num" id="2096281">0</span>&nbsp;<span class="op" id="2096283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096287">mant</span>&nbsp;<span class="op" id="2096292">&lt;&lt;=</span>&nbsp;<span class="num" id="2096296">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096301">exp</span>&nbsp;<span class="op" id="2096305">-=</span>&nbsp;<span class="num" id="2096308">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096315">if</span>&nbsp;<span class="ident" id="2096318">mant</span><span class="op" id="2096322">&gt;&gt;</span><span class="op" id="2096324">(</span><span class="num" id="2096325">64</span><span class="op" id="2096327">-</span><span class="num" id="2096328">8</span><span class="op" id="2096329">)</span>&nbsp;<span class="op" id="2096331">==</span>&nbsp;<span class="num" id="2096334">0</span>&nbsp;<span class="op" id="2096336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096340">mant</span>&nbsp;<span class="op" id="2096345">&lt;&lt;=</span>&nbsp;<span class="num" id="2096349">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096353">exp</span>&nbsp;<span class="op" id="2096357">-=</span>&nbsp;<span class="num" id="2096360">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096366">if</span>&nbsp;<span class="ident" id="2096369">mant</span><span class="op" id="2096373">&gt;&gt;</span><span class="op" id="2096375">(</span><span class="num" id="2096376">64</span><span class="op" id="2096378">-</span><span class="num" id="2096379">4</span><span class="op" id="2096380">)</span>&nbsp;<span class="op" id="2096382">==</span>&nbsp;<span class="num" id="2096385">0</span>&nbsp;<span class="op" id="2096387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096391">mant</span>&nbsp;<span class="op" id="2096396">&lt;&lt;=</span>&nbsp;<span class="num" id="2096400">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096404">exp</span>&nbsp;<span class="op" id="2096408">-=</span>&nbsp;<span class="num" id="2096411">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096414">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096417">if</span>&nbsp;<span class="ident" id="2096420">mant</span><span class="op" id="2096424">&gt;&gt;</span><span class="op" id="2096426">(</span><span class="num" id="2096427">64</span><span class="op" id="2096429">-</span><span class="num" id="2096430">2</span><span class="op" id="2096431">)</span>&nbsp;<span class="op" id="2096433">==</span>&nbsp;<span class="num" id="2096436">0</span>&nbsp;<span class="op" id="2096438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096442">mant</span>&nbsp;<span class="op" id="2096447">&lt;&lt;=</span>&nbsp;<span class="num" id="2096451">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096455">exp</span>&nbsp;<span class="op" id="2096459">-=</span>&nbsp;<span class="num" id="2096462">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096468">if</span>&nbsp;<span class="ident" id="2096471">mant</span><span class="op" id="2096475">&gt;&gt;</span><span class="op" id="2096477">(</span><span class="num" id="2096478">64</span><span class="op" id="2096480">-</span><span class="num" id="2096481">1</span><span class="op" id="2096482">)</span>&nbsp;<span class="op" id="2096484">==</span>&nbsp;<span class="num" id="2096487">0</span>&nbsp;<span class="op" id="2096489">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096493">mant</span>&nbsp;<span class="op" id="2096498">&lt;&lt;=</span>&nbsp;<span class="num" id="2096502">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096506">exp</span>&nbsp;<span class="op" id="2096510">-=</span>&nbsp;<span class="num" id="2096513">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096519">shift</span>&nbsp;<span class="op" id="2096525">=</span>&nbsp;<span class="builtintype" id="2096527">uint</span><span class="op" id="2096531">(</span><span class="ident" id="2096532">f</span><span class="op" id="2096533">.</span><span class="ident" id="2096534">exp</span>&nbsp;<span class="op" id="2096538">-</span>&nbsp;<span class="ident" id="2096540">exp</span><span class="op" id="2096543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096546">f</span><span class="op" id="2096547">.</span><span class="ident" id="2096548">mant</span><span class="op" id="2096552">,</span>&nbsp;<span class="ident" id="2096554">f</span><span class="op" id="2096555">.</span><span class="ident" id="2096556">exp</span>&nbsp;<span class="op" id="2096560">=</span>&nbsp;<span class="ident" id="2096562">mant</span><span class="op" id="2096566">,</span>&nbsp;<span class="ident" id="2096568">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096573">return</span><br>
<span class="lineno"></span><span class="op" id="2096580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2096583">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2096655">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2096678">func</span>&nbsp;<span class="op" id="2096683">(</span><span class="ident" id="2096684">f</span>&nbsp;<span class="op" id="2096686">*</span><span class="ident" id="2096687">extFloat</span><span class="op" id="2096695">)</span>&nbsp;<span class="ident" id="2096697">Multiply</span><span class="op" id="2096705">(</span><span class="ident" id="2096706">g</span>&nbsp;<span class="ident" id="2096708">extFloat</span><span class="op" id="2096716">)</span>&nbsp;<span class="op" id="2096718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096721">fhi</span><span class="op" id="2096724">,</span>&nbsp;<span class="ident" id="2096726">flo</span>&nbsp;<span class="op" id="2096730">:=</span>&nbsp;<span class="ident" id="2096733">f</span><span class="op" id="2096734">.</span><span class="ident" id="2096735">mant</span><span class="op" id="2096739">&gt;&gt;</span><span class="num" id="2096741">32</span><span class="op" id="2096743">,</span>&nbsp;<span class="ident" id="2096745">uint64</span><span class="op" id="2096751">(</span><span class="builtintype" id="2096752">uint32</span><span class="op" id="2096758">(</span><span class="ident" id="2096759">f</span><span class="op" id="2096760">.</span><span class="ident" id="2096761">mant</span><span class="op" id="2096765">)</span><span class="op" id="2096766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096769">ghi</span><span class="op" id="2096772">,</span>&nbsp;<span class="ident" id="2096774">glo</span>&nbsp;<span class="op" id="2096778">:=</span>&nbsp;<span class="ident" id="2096781">g</span><span class="op" id="2096782">.</span><span class="ident" id="2096783">mant</span><span class="op" id="2096787">&gt;&gt;</span><span class="num" id="2096789">32</span><span class="op" id="2096791">,</span>&nbsp;<span class="ident" id="2096793">uint64</span><span class="op" id="2096799">(</span><span class="builtintype" id="2096800">uint32</span><span class="op" id="2096806">(</span><span class="ident" id="2096807">g</span><span class="op" id="2096808">.</span><span class="ident" id="2096809">mant</span><span class="op" id="2096813">)</span><span class="op" id="2096814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2096818">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096838">cross1</span>&nbsp;<span class="op" id="2096845">:=</span>&nbsp;<span class="ident" id="2096848">fhi</span>&nbsp;<span class="op" id="2096852">*</span>&nbsp;<span class="ident" id="2096854">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096859">cross2</span>&nbsp;<span class="op" id="2096866">:=</span>&nbsp;<span class="ident" id="2096869">flo</span>&nbsp;<span class="op" id="2096873">*</span>&nbsp;<span class="ident" id="2096875">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2096881">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096950">f</span><span class="op" id="2096951">.</span><span class="ident" id="2096952">mant</span>&nbsp;<span class="op" id="2096957">=</span>&nbsp;<span class="ident" id="2096959">fhi</span><span class="op" id="2096962">*</span><span class="ident" id="2096963">ghi</span>&nbsp;<span class="op" id="2096967">+</span>&nbsp;<span class="op" id="2096969">(</span><span class="ident" id="2096970">cross1</span>&nbsp;<span class="op" id="2096977">&gt;&gt;</span>&nbsp;<span class="num" id="2096980">32</span><span class="op" id="2096982">)</span>&nbsp;<span class="op" id="2096984">+</span>&nbsp;<span class="op" id="2096986">(</span><span class="ident" id="2096987">cross2</span>&nbsp;<span class="op" id="2096994">&gt;&gt;</span>&nbsp;<span class="num" id="2096997">32</span><span class="op" id="2096999">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097002">rem</span>&nbsp;<span class="op" id="2097006">:=</span>&nbsp;<span class="ident" id="2097009">uint64</span><span class="op" id="2097015">(</span><span class="builtintype" id="2097016">uint32</span><span class="op" id="2097022">(</span><span class="ident" id="2097023">cross1</span><span class="op" id="2097029">)</span><span class="op" id="2097030">)</span>&nbsp;<span class="op" id="2097032">+</span>&nbsp;<span class="ident" id="2097034">uint64</span><span class="op" id="2097040">(</span><span class="builtintype" id="2097041">uint32</span><span class="op" id="2097047">(</span><span class="ident" id="2097048">cross2</span><span class="op" id="2097054">)</span><span class="op" id="2097055">)</span>&nbsp;<span class="op" id="2097057">+</span>&nbsp;<span class="op" id="2097059">(</span><span class="op" id="2097060">(</span><span class="ident" id="2097061">flo</span>&nbsp;<span class="op" id="2097065">*</span>&nbsp;<span class="ident" id="2097067">glo</span><span class="op" id="2097070">)</span>&nbsp;<span class="op" id="2097072">&gt;&gt;</span>&nbsp;<span class="num" id="2097075">32</span><span class="op" id="2097077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2097080">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097094">rem</span>&nbsp;<span class="op" id="2097098">+=</span>&nbsp;<span class="op" id="2097101">(</span><span class="num" id="2097102">1</span>&nbsp;<span class="op" id="2097104">&lt;&lt;</span>&nbsp;<span class="num" id="2097107">31</span><span class="op" id="2097109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097113">f</span><span class="op" id="2097114">.</span><span class="ident" id="2097115">mant</span>&nbsp;<span class="op" id="2097120">+=</span>&nbsp;<span class="op" id="2097123">(</span><span class="ident" id="2097124">rem</span>&nbsp;<span class="op" id="2097128">&gt;&gt;</span>&nbsp;<span class="num" id="2097131">32</span><span class="op" id="2097133">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097136">f</span><span class="op" id="2097137">.</span><span class="ident" id="2097138">exp</span>&nbsp;<span class="op" id="2097142">=</span>&nbsp;<span class="ident" id="2097144">f</span><span class="op" id="2097145">.</span><span class="ident" id="2097146">exp</span>&nbsp;<span class="op" id="2097150">+</span>&nbsp;<span class="ident" id="2097152">g</span><span class="op" id="2097153">.</span><span class="ident" id="2097154">exp</span>&nbsp;<span class="op" id="2097158">+</span>&nbsp;<span class="num" id="2097160">64</span><br>
<span class="lineno"></span><span class="op" id="2097163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2097166">var</span>&nbsp;<span class="ident" id="2097170">uint64pow10</span>&nbsp;<span class="op" id="2097182">=</span>&nbsp;<span class="op" id="2097184">[</span><span class="op" id="2097185">...</span><span class="op" id="2097188">]</span><span class="ident" id="2097189">uint64</span><span class="op" id="2097195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2097198">1</span><span class="op" id="2097199">,</span>&nbsp;<span class="num" id="2097201">1e1</span><span class="op" id="2097204">,</span>&nbsp;<span class="num" id="2097206">1e2</span><span class="op" id="2097209">,</span>&nbsp;<span class="num" id="2097211">1e3</span><span class="op" id="2097214">,</span>&nbsp;<span class="num" id="2097216">1e4</span><span class="op" id="2097219">,</span>&nbsp;<span class="num" id="2097221">1e5</span><span class="op" id="2097224">,</span>&nbsp;<span class="num" id="2097226">1e6</span><span class="op" id="2097229">,</span>&nbsp;<span class="num" id="2097231">1e7</span><span class="op" id="2097234">,</span>&nbsp;<span class="num" id="2097236">1e8</span><span class="op" id="2097239">,</span>&nbsp;<span class="num" id="2097241">1e9</span><span class="op" id="2097244">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2097247">1e10</span><span class="op" id="2097251">,</span>&nbsp;<span class="num" id="2097253">1e11</span><span class="op" id="2097257">,</span>&nbsp;<span class="num" id="2097259">1e12</span><span class="op" id="2097263">,</span>&nbsp;<span class="num" id="2097265">1e13</span><span class="op" id="2097269">,</span>&nbsp;<span class="num" id="2097271">1e14</span><span class="op" id="2097275">,</span>&nbsp;<span class="num" id="2097277">1e15</span><span class="op" id="2097281">,</span>&nbsp;<span class="num" id="2097283">1e16</span><span class="op" id="2097287">,</span>&nbsp;<span class="num" id="2097289">1e17</span><span class="op" id="2097293">,</span>&nbsp;<span class="num" id="2097295">1e18</span><span class="op" id="2097299">,</span>&nbsp;<span class="num" id="2097301">1e19</span><span class="op" id="2097305">,</span><br>
<span class="lineno"></span><span class="op" id="2097307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2097310">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2097378">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2097448">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2097511">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2097540">func</span>&nbsp;<span class="op" id="2097545">(</span><span class="ident" id="2097546">f</span>&nbsp;<span class="op" id="2097548">*</span><span class="ident" id="2097549">extFloat</span><span class="op" id="2097557">)</span>&nbsp;<span class="ident" id="2097559">AssignDecimal</span><span class="op" id="2097572">(</span><span class="ident" id="2097573">mantissa</span>&nbsp;<span class="ident" id="2097582">uint64</span><span class="op" id="2097588">,</span>&nbsp;<span class="ident" id="2097590">exp10</span>&nbsp;<span class="builtintype" id="2097596">int</span><span class="op" id="2097599">,</span>&nbsp;<span class="ident" id="2097601">neg</span>&nbsp;<span class="builtintype" id="2097605">bool</span><span class="op" id="2097609">,</span>&nbsp;<span class="ident" id="2097611">trunc</span>&nbsp;<span class="builtintype" id="2097617">bool</span><span class="op" id="2097621">,</span>&nbsp;<span class="ident" id="2097623">flt</span>&nbsp;<span class="op" id="2097627">*</span><span class="ident" id="2097628">floatInfo</span><span class="op" id="2097637">)</span>&nbsp;<span class="op" id="2097639">(</span><span class="ident" id="2097640">ok</span>&nbsp;<span class="builtintype" id="2097643">bool</span><span class="op" id="2097647">)</span>&nbsp;<span class="op" id="2097649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097652">const</span>&nbsp;<span class="ident" id="2097658">uint64digits</span>&nbsp;<span class="op" id="2097671">=</span>&nbsp;<span class="num" id="2097673">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097677">const</span>&nbsp;<span class="ident" id="2097683">errorscale</span>&nbsp;<span class="op" id="2097694">=</span>&nbsp;<span class="num" id="2097696">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097699">errors</span>&nbsp;<span class="op" id="2097706">:=</span>&nbsp;<span class="num" id="2097709">0</span>&nbsp;<span class="comment" id="2097711">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097769">if</span>&nbsp;<span class="ident" id="2097772">trunc</span>&nbsp;<span class="op" id="2097778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2097782">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097821">errors</span>&nbsp;<span class="op" id="2097828">+=</span>&nbsp;<span class="ident" id="2097831">errorscale</span>&nbsp;<span class="op" id="2097842">/</span>&nbsp;<span class="num" id="2097844">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2097847">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097851">f</span><span class="op" id="2097852">.</span><span class="ident" id="2097853">mant</span>&nbsp;<span class="op" id="2097858">=</span>&nbsp;<span class="ident" id="2097860">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097870">f</span><span class="op" id="2097871">.</span><span class="ident" id="2097872">exp</span>&nbsp;<span class="op" id="2097876">=</span>&nbsp;<span class="num" id="2097878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097881">f</span><span class="op" id="2097882">.</span><span class="ident" id="2097883">neg</span>&nbsp;<span class="op" id="2097887">=</span>&nbsp;<span class="ident" id="2097889">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2097895">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097926">i</span>&nbsp;<span class="op" id="2097928">:=</span>&nbsp;<span class="op" id="2097931">(</span><span class="ident" id="2097932">exp10</span>&nbsp;<span class="op" id="2097938">-</span>&nbsp;<span class="ident" id="2097940">firstPowerOfTen</span><span class="op" id="2097955">)</span>&nbsp;<span class="op" id="2097957">/</span>&nbsp;<span class="ident" id="2097959">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097975">if</span>&nbsp;<span class="ident" id="2097978">exp10</span>&nbsp;<span class="op" id="2097984">&lt;</span>&nbsp;<span class="ident" id="2097986">firstPowerOfTen</span>&nbsp;<span class="op" id="2098002">||</span>&nbsp;<span class="ident" id="2098005">i</span>&nbsp;<span class="op" id="2098007">&gt;=</span>&nbsp;<span class="builtinfunc" id="2098010">len</span><span class="op" id="2098013">(</span><span class="ident" id="2098014">powersOfTen</span><span class="op" id="2098025">)</span>&nbsp;<span class="op" id="2098027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2098031">return</span>&nbsp;<span class="builtintype" id="2098038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2098045">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098048">adjExp</span>&nbsp;<span class="op" id="2098055">:=</span>&nbsp;<span class="op" id="2098058">(</span><span class="ident" id="2098059">exp10</span>&nbsp;<span class="op" id="2098065">-</span>&nbsp;<span class="ident" id="2098067">firstPowerOfTen</span><span class="op" id="2098082">)</span>&nbsp;<span class="op" id="2098084">%</span>&nbsp;<span class="ident" id="2098086">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098103">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2098131">if</span>&nbsp;<span class="ident" id="2098134">adjExp</span>&nbsp;<span class="op" id="2098141">&lt;</span>&nbsp;<span class="ident" id="2098143">uint64digits</span>&nbsp;<span class="op" id="2098156">&amp;&amp;</span>&nbsp;<span class="ident" id="2098159">mantissa</span>&nbsp;<span class="op" id="2098168">&lt;</span>&nbsp;<span class="ident" id="2098170">uint64pow10</span><span class="op" id="2098181">[</span><span class="ident" id="2098182">uint64digits</span><span class="op" id="2098194">-</span><span class="ident" id="2098195">adjExp</span><span class="op" id="2098201">]</span>&nbsp;<span class="op" id="2098203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098207">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098250">f</span><span class="op" id="2098251">.</span><span class="ident" id="2098252">mant</span>&nbsp;<span class="op" id="2098257">*=</span>&nbsp;<span class="ident" id="2098260">uint64pow10</span><span class="op" id="2098271">[</span><span class="ident" id="2098272">adjExp</span><span class="op" id="2098278">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098282">f</span><span class="op" id="2098283">.</span><span class="ident" id="2098284">Normalize</span><span class="op" id="2098293">(</span><span class="op" id="2098294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2098297">}</span>&nbsp;<span class="keyword" id="2098299">else</span>&nbsp;<span class="op" id="2098304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098308">f</span><span class="op" id="2098309">.</span><span class="ident" id="2098310">Normalize</span><span class="op" id="2098319">(</span><span class="op" id="2098320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098324">f</span><span class="op" id="2098325">.</span><span class="ident" id="2098326">Multiply</span><span class="op" id="2098334">(</span><span class="ident" id="2098335">smallPowersOfTen</span><span class="op" id="2098351">[</span><span class="ident" id="2098352">adjExp</span><span class="op" id="2098358">]</span><span class="op" id="2098359">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098363">errors</span>&nbsp;<span class="op" id="2098370">+=</span>&nbsp;<span class="ident" id="2098373">errorscale</span>&nbsp;<span class="op" id="2098384">/</span>&nbsp;<span class="num" id="2098386">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2098389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098393">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098438">f</span><span class="op" id="2098439">.</span><span class="ident" id="2098440">Multiply</span><span class="op" id="2098448">(</span><span class="ident" id="2098449">powersOfTen</span><span class="op" id="2098460">[</span><span class="ident" id="2098461">i</span><span class="op" id="2098462">]</span><span class="op" id="2098463">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2098466">if</span>&nbsp;<span class="ident" id="2098469">errors</span>&nbsp;<span class="op" id="2098476">&gt;</span>&nbsp;<span class="num" id="2098478">0</span>&nbsp;<span class="op" id="2098480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098484">errors</span>&nbsp;<span class="op" id="2098491">+=</span>&nbsp;<span class="num" id="2098494">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2098497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098500">errors</span>&nbsp;<span class="op" id="2098507">+=</span>&nbsp;<span class="ident" id="2098510">errorscale</span>&nbsp;<span class="op" id="2098521">/</span>&nbsp;<span class="num" id="2098523">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098527">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098541">shift</span>&nbsp;<span class="op" id="2098547">:=</span>&nbsp;<span class="ident" id="2098550">f</span><span class="op" id="2098551">.</span><span class="ident" id="2098552">Normalize</span><span class="op" id="2098561">(</span><span class="op" id="2098562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098565">errors</span>&nbsp;<span class="op" id="2098572">&lt;&lt;=</span>&nbsp;<span class="ident" id="2098576">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098584">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098634">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098701">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098769">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098838">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098842">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2098899">denormalExp</span>&nbsp;<span class="op" id="2098911">:=</span>&nbsp;<span class="ident" id="2098914">flt</span><span class="op" id="2098917">.</span><span class="ident" id="2098918">bias</span>&nbsp;<span class="op" id="2098923">-</span>&nbsp;<span class="num" id="2098925">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2098929">var</span>&nbsp;<span class="ident" id="2098933">extrabits</span>&nbsp;<span class="builtintype" id="2098943">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2098949">if</span>&nbsp;<span class="ident" id="2098952">f</span><span class="op" id="2098953">.</span><span class="ident" id="2098954">exp</span>&nbsp;<span class="op" id="2098958">&lt;=</span>&nbsp;<span class="ident" id="2098961">denormalExp</span>&nbsp;<span class="op" id="2098973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2098977">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2099031">extrabits</span>&nbsp;<span class="op" id="2099041">=</span>&nbsp;<span class="builtintype" id="2099043">uint</span><span class="op" id="2099047">(</span><span class="num" id="2099048">63</span>&nbsp;<span class="op" id="2099051">-</span>&nbsp;<span class="ident" id="2099053">flt</span><span class="op" id="2099056">.</span><span class="ident" id="2099057">mantbits</span>&nbsp;<span class="op" id="2099066">+</span>&nbsp;<span class="num" id="2099068">1</span>&nbsp;<span class="op" id="2099070">+</span>&nbsp;<span class="builtintype" id="2099072">uint</span><span class="op" id="2099076">(</span><span class="ident" id="2099077">denormalExp</span><span class="op" id="2099088">-</span><span class="ident" id="2099089">f</span><span class="op" id="2099090">.</span><span class="ident" id="2099091">exp</span><span class="op" id="2099094">)</span><span class="op" id="2099095">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2099098">}</span>&nbsp;<span class="keyword" id="2099100">else</span>&nbsp;<span class="op" id="2099105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2099109">extrabits</span>&nbsp;<span class="op" id="2099119">=</span>&nbsp;<span class="builtintype" id="2099121">uint</span><span class="op" id="2099125">(</span><span class="num" id="2099126">63</span>&nbsp;<span class="op" id="2099129">-</span>&nbsp;<span class="ident" id="2099131">flt</span><span class="op" id="2099134">.</span><span class="ident" id="2099135">mantbits</span><span class="op" id="2099143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2099146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2099150">halfway</span>&nbsp;<span class="op" id="2099158">:=</span>&nbsp;<span class="ident" id="2099161">uint64</span><span class="op" id="2099167">(</span><span class="num" id="2099168">1</span><span class="op" id="2099169">)</span>&nbsp;<span class="op" id="2099171">&lt;&lt;</span>&nbsp;<span class="op" id="2099174">(</span><span class="ident" id="2099175">extrabits</span>&nbsp;<span class="op" id="2099185">-</span>&nbsp;<span class="num" id="2099187">1</span><span class="op" id="2099188">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2099191">mant_extra</span>&nbsp;<span class="op" id="2099202">:=</span>&nbsp;<span class="ident" id="2099205">f</span><span class="op" id="2099206">.</span><span class="ident" id="2099207">mant</span>&nbsp;<span class="op" id="2099212">&amp;</span>&nbsp;<span class="op" id="2099214">(</span><span class="num" id="2099215">1</span><span class="op" id="2099216">&lt;&lt;</span><span class="ident" id="2099218">extrabits</span>&nbsp;<span class="op" id="2099228">-</span>&nbsp;<span class="num" id="2099230">1</span><span class="op" id="2099231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2099235">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2099301">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2099366">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2099408">if</span>&nbsp;<span class="ident" id="2099411">int64</span><span class="op" id="2099416">(</span><span class="ident" id="2099417">halfway</span><span class="op" id="2099424">)</span><span class="op" id="2099425">-</span><span class="ident" id="2099426">int64</span><span class="op" id="2099431">(</span><span class="ident" id="2099432">errors</span><span class="op" id="2099438">)</span>&nbsp;<span class="op" id="2099440">&lt;</span>&nbsp;<span class="ident" id="2099442">int64</span><span class="op" id="2099447">(</span><span class="ident" id="2099448">mant_extra</span><span class="op" id="2099458">)</span>&nbsp;<span class="op" id="2099460">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2099465">int64</span><span class="op" id="2099470">(</span><span class="ident" id="2099471">mant_extra</span><span class="op" id="2099481">)</span>&nbsp;<span class="op" id="2099483">&lt;</span>&nbsp;<span class="ident" id="2099485">int64</span><span class="op" id="2099490">(</span><span class="ident" id="2099491">halfway</span><span class="op" id="2099498">)</span><span class="op" id="2099499">+</span><span class="ident" id="2099500">int64</span><span class="op" id="2099505">(</span><span class="ident" id="2099506">errors</span><span class="op" id="2099512">)</span>&nbsp;<span class="op" id="2099514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2099518">return</span>&nbsp;<span class="builtintype" id="2099525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2099532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2099535">return</span>&nbsp;<span class="builtintype" id="2099542">true</span><br>
<span class="lineno">330</span><span class="op" id="2099547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2099550">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2099620">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2099687">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2099753">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2099814">func</span>&nbsp;<span class="op" id="2099819">(</span><span class="ident" id="2099820">f</span>&nbsp;<span class="op" id="2099822">*</span><span class="ident" id="2099823">extFloat</span><span class="op" id="2099831">)</span>&nbsp;<span class="ident" id="2099833">frexp10</span><span class="op" id="2099840">(</span><span class="op" id="2099841">)</span>&nbsp;<span class="op" id="2099843">(</span><span class="ident" id="2099844">exp10</span><span class="op" id="2099849">,</span>&nbsp;<span class="ident" id="2099851">index</span>&nbsp;<span class="builtintype" id="2099857">int</span><span class="op" id="2099860">)</span>&nbsp;<span class="op" id="2099862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2099865">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2099934">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100004">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100073">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100146">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100157">const</span>&nbsp;<span class="ident" id="2100163">expMin</span>&nbsp;<span class="op" id="2100170">=</span>&nbsp;<span class="op" id="2100172">-</span><span class="num" id="2100173">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100177">const</span>&nbsp;<span class="ident" id="2100183">expMax</span>&nbsp;<span class="op" id="2100190">=</span>&nbsp;<span class="op" id="2100192">-</span><span class="num" id="2100193">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100197">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100260">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100291">approxExp10</span>&nbsp;<span class="op" id="2100303">:=</span>&nbsp;<span class="op" id="2100306">(</span><span class="op" id="2100307">(</span><span class="ident" id="2100308">expMin</span><span class="op" id="2100314">+</span><span class="ident" id="2100315">expMax</span><span class="op" id="2100321">)</span><span class="op" id="2100322">/</span><span class="num" id="2100323">2</span>&nbsp;<span class="op" id="2100325">-</span>&nbsp;<span class="ident" id="2100327">f</span><span class="op" id="2100328">.</span><span class="ident" id="2100329">exp</span><span class="op" id="2100332">)</span>&nbsp;<span class="op" id="2100334">*</span>&nbsp;<span class="num" id="2100336">28</span>&nbsp;<span class="op" id="2100339">/</span>&nbsp;<span class="num" id="2100341">93</span>&nbsp;<span class="comment" id="2100344">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100382">i</span>&nbsp;<span class="op" id="2100384">:=</span>&nbsp;<span class="op" id="2100387">(</span><span class="ident" id="2100388">approxExp10</span>&nbsp;<span class="op" id="2100400">-</span>&nbsp;<span class="ident" id="2100402">firstPowerOfTen</span><span class="op" id="2100417">)</span>&nbsp;<span class="op" id="2100419">/</span>&nbsp;<span class="ident" id="2100421">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2100436">Loop</span><span class="op" id="2100440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100443">for</span>&nbsp;<span class="op" id="2100447">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100451">exp</span>&nbsp;<span class="op" id="2100455">:=</span>&nbsp;<span class="ident" id="2100458">f</span><span class="op" id="2100459">.</span><span class="ident" id="2100460">exp</span>&nbsp;<span class="op" id="2100464">+</span>&nbsp;<span class="ident" id="2100466">powersOfTen</span><span class="op" id="2100477">[</span><span class="ident" id="2100478">i</span><span class="op" id="2100479">]</span><span class="op" id="2100480">.</span><span class="ident" id="2100481">exp</span>&nbsp;<span class="op" id="2100485">+</span>&nbsp;<span class="num" id="2100487">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100492">switch</span>&nbsp;<span class="op" id="2100499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100503">case</span>&nbsp;<span class="ident" id="2100508">exp</span>&nbsp;<span class="op" id="2100512">&lt;</span>&nbsp;<span class="ident" id="2100514">expMin</span><span class="op" id="2100520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100525">i</span><span class="op" id="2100526">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100531">case</span>&nbsp;<span class="ident" id="2100536">exp</span>&nbsp;<span class="op" id="2100540">&gt;</span>&nbsp;<span class="ident" id="2100542">expMax</span><span class="op" id="2100548">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100553">i</span><span class="op" id="2100554">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100559">default</span><span class="op" id="2100566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100571">break</span>&nbsp;<span class="ident" id="2100577">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2100584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2100587">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100590">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2100654">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100717">f</span><span class="op" id="2100718">.</span><span class="ident" id="2100719">Multiply</span><span class="op" id="2100727">(</span><span class="ident" id="2100728">powersOfTen</span><span class="op" id="2100739">[</span><span class="ident" id="2100740">i</span><span class="op" id="2100741">]</span><span class="op" id="2100742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100746">return</span>&nbsp;<span class="op" id="2100753">-</span><span class="op" id="2100754">(</span><span class="ident" id="2100755">firstPowerOfTen</span>&nbsp;<span class="op" id="2100771">+</span>&nbsp;<span class="ident" id="2100773">i</span><span class="op" id="2100774">*</span><span class="ident" id="2100775">stepPowerOfTen</span><span class="op" id="2100789">)</span><span class="op" id="2100790">,</span>&nbsp;<span class="ident" id="2100792">i</span><br>
<span class="lineno">365</span><span class="op" id="2100794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2100797">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2100865">func</span>&nbsp;<span class="ident" id="2100870">frexp10Many</span><span class="op" id="2100881">(</span><span class="ident" id="2100882">a</span><span class="op" id="2100883">,</span>&nbsp;<span class="ident" id="2100885">b</span><span class="op" id="2100886">,</span>&nbsp;<span class="ident" id="2100888">c</span>&nbsp;<span class="op" id="2100890">*</span><span class="ident" id="2100891">extFloat</span><span class="op" id="2100899">)</span>&nbsp;<span class="op" id="2100901">(</span><span class="ident" id="2100902">exp10</span>&nbsp;<span class="builtintype" id="2100908">int</span><span class="op" id="2100911">)</span>&nbsp;<span class="op" id="2100913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100916">exp10</span><span class="op" id="2100921">,</span>&nbsp;<span class="ident" id="2100923">i</span>&nbsp;<span class="op" id="2100925">:=</span>&nbsp;<span class="ident" id="2100928">c</span><span class="op" id="2100929">.</span><span class="ident" id="2100930">frexp10</span><span class="op" id="2100937">(</span><span class="op" id="2100938">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100941">a</span><span class="op" id="2100942">.</span><span class="ident" id="2100943">Multiply</span><span class="op" id="2100951">(</span><span class="ident" id="2100952">powersOfTen</span><span class="op" id="2100963">[</span><span class="ident" id="2100964">i</span><span class="op" id="2100965">]</span><span class="op" id="2100966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2100969">b</span><span class="op" id="2100970">.</span><span class="ident" id="2100971">Multiply</span><span class="op" id="2100979">(</span><span class="ident" id="2100980">powersOfTen</span><span class="op" id="2100991">[</span><span class="ident" id="2100992">i</span><span class="op" id="2100993">]</span><span class="op" id="2100994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2100997">return</span><br>
<span class="lineno"></span><span class="op" id="2101004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2101007">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2101066">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2101122">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2101161">func</span>&nbsp;<span class="op" id="2101166">(</span><span class="ident" id="2101167">f</span>&nbsp;<span class="op" id="2101169">*</span><span class="ident" id="2101170">extFloat</span><span class="op" id="2101178">)</span>&nbsp;<span class="ident" id="2101180">FixedDecimal</span><span class="op" id="2101192">(</span><span class="ident" id="2101193">d</span>&nbsp;<span class="op" id="2101195">*</span><span class="ident" id="2101196">decimalSlice</span><span class="op" id="2101208">,</span>&nbsp;<span class="ident" id="2101210">n</span>&nbsp;<span class="builtintype" id="2101212">int</span><span class="op" id="2101215">)</span>&nbsp;<span class="builtintype" id="2101217">bool</span>&nbsp;<span class="op" id="2101222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2101225">if</span>&nbsp;<span class="ident" id="2101228">f</span><span class="op" id="2101229">.</span><span class="ident" id="2101230">mant</span>&nbsp;<span class="op" id="2101235">==</span>&nbsp;<span class="num" id="2101238">0</span>&nbsp;<span class="op" id="2101240">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101244">d</span><span class="op" id="2101245">.</span><span class="ident" id="2101246">nd</span>&nbsp;<span class="op" id="2101249">=</span>&nbsp;<span class="num" id="2101251">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101255">d</span><span class="op" id="2101256">.</span><span class="ident" id="2101257">dp</span>&nbsp;<span class="op" id="2101260">=</span>&nbsp;<span class="num" id="2101262">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101266">d</span><span class="op" id="2101267">.</span><span class="ident" id="2101268">neg</span>&nbsp;<span class="op" id="2101272">=</span>&nbsp;<span class="ident" id="2101274">f</span><span class="op" id="2101275">.</span><span class="ident" id="2101276">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2101282">return</span>&nbsp;<span class="builtintype" id="2101289">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2101295">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2101298">if</span>&nbsp;<span class="ident" id="2101301">n</span>&nbsp;<span class="op" id="2101303">==</span>&nbsp;<span class="num" id="2101306">0</span>&nbsp;<span class="op" id="2101308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2101312">panic</span><span class="op" id="2101317">(</span><span class="string" id="2101318">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2101385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2101388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2101391">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2101456">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101479">f</span><span class="op" id="2101480">.</span><span class="ident" id="2101481">Normalize</span><span class="op" id="2101490">(</span><span class="op" id="2101491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101494">exp10</span><span class="op" id="2101499">,</span>&nbsp;<span class="ident" id="2101501">_</span>&nbsp;<span class="op" id="2101503">:=</span>&nbsp;<span class="ident" id="2101506">f</span><span class="op" id="2101507">.</span><span class="ident" id="2101508">frexp10</span><span class="op" id="2101515">(</span><span class="op" id="2101516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101520">shift</span>&nbsp;<span class="op" id="2101526">:=</span>&nbsp;<span class="builtintype" id="2101529">uint</span><span class="op" id="2101533">(</span><span class="op" id="2101534">-</span><span class="ident" id="2101535">f</span><span class="op" id="2101536">.</span><span class="ident" id="2101537">exp</span><span class="op" id="2101540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101543">integer</span>&nbsp;<span class="op" id="2101551">:=</span>&nbsp;<span class="builtintype" id="2101554">uint32</span><span class="op" id="2101560">(</span><span class="ident" id="2101561">f</span><span class="op" id="2101562">.</span><span class="ident" id="2101563">mant</span>&nbsp;<span class="op" id="2101568">&gt;&gt;</span>&nbsp;<span class="ident" id="2101571">shift</span><span class="op" id="2101576">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101579">fraction</span>&nbsp;<span class="op" id="2101588">:=</span>&nbsp;<span class="ident" id="2101591">f</span><span class="op" id="2101592">.</span><span class="ident" id="2101593">mant</span>&nbsp;<span class="op" id="2101598">-</span>&nbsp;<span class="op" id="2101600">(</span><span class="ident" id="2101601">uint64</span><span class="op" id="2101607">(</span><span class="ident" id="2101608">integer</span><span class="op" id="2101615">)</span>&nbsp;<span class="op" id="2101617">&lt;&lt;</span>&nbsp;<span class="ident" id="2101620">shift</span><span class="op" id="2101625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101628"></span>&nbsp;<span class="op" id="2101631">:=</span>&nbsp;<span class="ident" id="2101634">uint64</span><span class="op" id="2101640">(</span><span class="num" id="2101641">1</span><span class="op" id="2101642">)</span>&nbsp;<span class="comment" id="2101644">//&nbsp;&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2101701">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101734">needed</span>&nbsp;<span class="op" id="2101741">:=</span>&nbsp;<span class="ident" id="2101744">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2101753">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101792">integerDigits</span>&nbsp;<span class="op" id="2101806">:=</span>&nbsp;<span class="num" id="2101809">0</span>&nbsp;<span class="comment" id="2101811">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101856">pow10</span>&nbsp;<span class="op" id="2101862">:=</span>&nbsp;<span class="ident" id="2101865">uint64</span><span class="op" id="2101871">(</span><span class="num" id="2101872">1</span><span class="op" id="2101873">)</span>&nbsp;<span class="comment" id="2101875">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2101919">for</span>&nbsp;<span class="ident" id="2101923">i</span><span class="op" id="2101924">,</span>&nbsp;<span class="ident" id="2101926">pow</span>&nbsp;<span class="op" id="2101930">:=</span>&nbsp;<span class="num" id="2101933">0</span><span class="op" id="2101934">,</span>&nbsp;<span class="ident" id="2101936">uint64</span><span class="op" id="2101942">(</span><span class="num" id="2101943">1</span><span class="op" id="2101944">)</span><span class="op" id="2101945">;</span>&nbsp;<span class="ident" id="2101947">i</span>&nbsp;<span class="op" id="2101949">&lt;</span>&nbsp;<span class="num" id="2101951">20</span><span class="op" id="2101953">;</span>&nbsp;<span class="ident" id="2101955">i</span><span class="op" id="2101956">++</span>&nbsp;<span class="op" id="2101959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2101963">if</span>&nbsp;<span class="ident" id="2101966">pow</span>&nbsp;<span class="op" id="2101970">&gt;</span>&nbsp;<span class="ident" id="2101972">uint64</span><span class="op" id="2101978">(</span><span class="ident" id="2101979">integer</span><span class="op" id="2101986">)</span>&nbsp;<span class="op" id="2101988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2101993">integerDigits</span>&nbsp;<span class="op" id="2102007">=</span>&nbsp;<span class="ident" id="2102009">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102014">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102026">pow</span>&nbsp;<span class="op" id="2102030">*=</span>&nbsp;<span class="num" id="2102033">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102040">rest</span>&nbsp;<span class="op" id="2102045">:=</span>&nbsp;<span class="ident" id="2102048">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102057">if</span>&nbsp;<span class="ident" id="2102060">integerDigits</span>&nbsp;<span class="op" id="2102074">&gt;</span>&nbsp;<span class="ident" id="2102076">needed</span>&nbsp;<span class="op" id="2102083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2102087">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102150">pow10</span>&nbsp;<span class="op" id="2102156">=</span>&nbsp;<span class="ident" id="2102158">uint64pow10</span><span class="op" id="2102169">[</span><span class="ident" id="2102170">integerDigits</span><span class="op" id="2102183">-</span><span class="ident" id="2102184">needed</span><span class="op" id="2102190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102194">integer</span>&nbsp;<span class="op" id="2102202">/=</span>&nbsp;<span class="builtintype" id="2102205">uint32</span><span class="op" id="2102211">(</span><span class="ident" id="2102212">pow10</span><span class="op" id="2102217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102221">rest</span>&nbsp;<span class="op" id="2102226">-=</span>&nbsp;<span class="ident" id="2102229">integer</span>&nbsp;<span class="op" id="2102237">*</span>&nbsp;<span class="builtintype" id="2102239">uint32</span><span class="op" id="2102245">(</span><span class="ident" id="2102246">pow10</span><span class="op" id="2102251">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102254">}</span>&nbsp;<span class="keyword" id="2102256">else</span>&nbsp;<span class="op" id="2102261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102265">rest</span>&nbsp;<span class="op" id="2102270">=</span>&nbsp;<span class="num" id="2102272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2102279">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102344">var</span>&nbsp;<span class="ident" id="2102348">buf</span>&nbsp;<span class="op" id="2102352">[</span><span class="num" id="2102353">32</span><span class="op" id="2102355">]</span><span class="builtintype" id="2102356">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102362">pos</span>&nbsp;<span class="op" id="2102366">:=</span>&nbsp;<span class="builtinfunc" id="2102369">len</span><span class="op" id="2102372">(</span><span class="ident" id="2102373">buf</span><span class="op" id="2102376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102379">for</span>&nbsp;<span class="ident" id="2102383">v</span>&nbsp;<span class="op" id="2102385">:=</span>&nbsp;<span class="ident" id="2102388">integer</span><span class="op" id="2102395">;</span>&nbsp;<span class="ident" id="2102397">v</span>&nbsp;<span class="op" id="2102399">&gt;</span>&nbsp;<span class="num" id="2102401">0</span><span class="op" id="2102402">;</span>&nbsp;<span class="op" id="2102404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102408">v1</span>&nbsp;<span class="op" id="2102411">:=</span>&nbsp;<span class="ident" id="2102414">v</span>&nbsp;<span class="op" id="2102416">/</span>&nbsp;<span class="num" id="2102418">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102423">v</span>&nbsp;<span class="op" id="2102425">-=</span>&nbsp;<span class="num" id="2102428">10</span>&nbsp;<span class="op" id="2102431">*</span>&nbsp;<span class="ident" id="2102433">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102438">pos</span><span class="op" id="2102441">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102446">buf</span><span class="op" id="2102449">[</span><span class="ident" id="2102450">pos</span><span class="op" id="2102453">]</span>&nbsp;<span class="op" id="2102455">=</span>&nbsp;<span class="builtintype" id="2102457">byte</span><span class="op" id="2102461">(</span><span class="ident" id="2102462">v</span>&nbsp;<span class="op" id="2102464">+</span>&nbsp;<span class="string" id="2102466">&#39;0&#39;</span><span class="op" id="2102469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102473">v</span>&nbsp;<span class="op" id="2102475">=</span>&nbsp;<span class="ident" id="2102477">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102484">for</span>&nbsp;<span class="ident" id="2102488">i</span>&nbsp;<span class="op" id="2102490">:=</span>&nbsp;<span class="ident" id="2102493">pos</span><span class="op" id="2102496">;</span>&nbsp;<span class="ident" id="2102498">i</span>&nbsp;<span class="op" id="2102500">&lt;</span>&nbsp;<span class="builtinfunc" id="2102502">len</span><span class="op" id="2102505">(</span><span class="ident" id="2102506">buf</span><span class="op" id="2102509">)</span><span class="op" id="2102510">;</span>&nbsp;<span class="ident" id="2102512">i</span><span class="op" id="2102513">++</span>&nbsp;<span class="op" id="2102516">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102520">d</span><span class="op" id="2102521">.</span><span class="ident" id="2102522">d</span><span class="op" id="2102523">[</span><span class="ident" id="2102524">i</span><span class="op" id="2102525">-</span><span class="ident" id="2102526">pos</span><span class="op" id="2102529">]</span>&nbsp;<span class="op" id="2102531">=</span>&nbsp;<span class="ident" id="2102533">buf</span><span class="op" id="2102536">[</span><span class="ident" id="2102537">i</span><span class="op" id="2102538">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102544">nd</span>&nbsp;<span class="op" id="2102547">:=</span>&nbsp;<span class="builtinfunc" id="2102550">len</span><span class="op" id="2102553">(</span><span class="ident" id="2102554">buf</span><span class="op" id="2102557">)</span>&nbsp;<span class="op" id="2102559">-</span>&nbsp;<span class="ident" id="2102561">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102566">d</span><span class="op" id="2102567">.</span><span class="ident" id="2102568">nd</span>&nbsp;<span class="op" id="2102571">=</span>&nbsp;<span class="ident" id="2102573">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102577">d</span><span class="op" id="2102578">.</span><span class="ident" id="2102579">dp</span>&nbsp;<span class="op" id="2102582">=</span>&nbsp;<span class="ident" id="2102584">integerDigits</span>&nbsp;<span class="op" id="2102598">+</span>&nbsp;<span class="ident" id="2102600">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102607">needed</span>&nbsp;<span class="op" id="2102614">-=</span>&nbsp;<span class="ident" id="2102617">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102622">if</span>&nbsp;<span class="ident" id="2102625">needed</span>&nbsp;<span class="op" id="2102632">&gt;</span>&nbsp;<span class="num" id="2102634">0</span>&nbsp;<span class="op" id="2102636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102640">if</span>&nbsp;<span class="ident" id="2102643">rest</span>&nbsp;<span class="op" id="2102648">!=</span>&nbsp;<span class="num" id="2102651">0</span>&nbsp;<span class="op" id="2102653">||</span>&nbsp;<span class="ident" id="2102656">pow10</span>&nbsp;<span class="op" id="2102662">!=</span>&nbsp;<span class="num" id="2102665">1</span>&nbsp;<span class="op" id="2102667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2102672">panic</span><span class="op" id="2102677">(</span><span class="string" id="2102678">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2102729">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2102733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2102737">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2102802">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102842">for</span>&nbsp;<span class="ident" id="2102846">needed</span>&nbsp;<span class="op" id="2102853">&gt;</span>&nbsp;<span class="num" id="2102855">0</span>&nbsp;<span class="op" id="2102857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102862">fraction</span>&nbsp;<span class="op" id="2102871">*=</span>&nbsp;<span class="num" id="2102874">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2102880"></span>&nbsp;<span class="op" id="2102883">*=</span>&nbsp;<span class="num" id="2102886">10</span>&nbsp;<span class="comment" id="2102889">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2102941">if</span>&nbsp;<span class="num" id="2102944">2</span><span class="op" id="2102945">*</span><span class="ident" id="2102946"></span>&nbsp;<span class="op" id="2102949">&gt;</span>&nbsp;<span class="num" id="2102951">1</span><span class="op" id="2102952">&lt;&lt;</span><span class="ident" id="2102954">shift</span>&nbsp;<span class="op" id="2102960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2102966">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2103040">return</span>&nbsp;<span class="builtintype" id="2103047">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2103056">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103061">digit</span>&nbsp;<span class="op" id="2103067">:=</span>&nbsp;<span class="ident" id="2103070">fraction</span>&nbsp;<span class="op" id="2103079">&gt;&gt;</span>&nbsp;<span class="ident" id="2103082">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103091">d</span><span class="op" id="2103092">.</span><span class="ident" id="2103093">d</span><span class="op" id="2103094">[</span><span class="ident" id="2103095">nd</span><span class="op" id="2103097">]</span>&nbsp;<span class="op" id="2103099">=</span>&nbsp;<span class="builtintype" id="2103101">byte</span><span class="op" id="2103105">(</span><span class="ident" id="2103106">digit</span>&nbsp;<span class="op" id="2103112">+</span>&nbsp;<span class="string" id="2103114">&#39;0&#39;</span><span class="op" id="2103117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103122">fraction</span>&nbsp;<span class="op" id="2103131">-=</span>&nbsp;<span class="ident" id="2103134">digit</span>&nbsp;<span class="op" id="2103140">&lt;&lt;</span>&nbsp;<span class="ident" id="2103143">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103152">nd</span><span class="op" id="2103154">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103160">needed</span><span class="op" id="2103166">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2103171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103175">d</span><span class="op" id="2103176">.</span><span class="ident" id="2103177">nd</span>&nbsp;<span class="op" id="2103180">=</span>&nbsp;<span class="ident" id="2103182">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2103186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103190">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103272">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103356">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103371">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103375">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103407">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103458">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103511">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103597">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103601">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103647">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103678">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103731">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103735">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103805">ok</span>&nbsp;<span class="op" id="2103808">:=</span>&nbsp;<span class="ident" id="2103811">adjustLastDigitFixed</span><span class="op" id="2103831">(</span><span class="ident" id="2103832">d</span><span class="op" id="2103833">,</span>&nbsp;<span class="ident" id="2103835">uint64</span><span class="op" id="2103841">(</span><span class="ident" id="2103842">rest</span><span class="op" id="2103846">)</span><span class="op" id="2103847">&lt;&lt;</span><span class="ident" id="2103849">shift</span><span class="op" id="2103854">|</span><span class="ident" id="2103855">fraction</span><span class="op" id="2103863">,</span>&nbsp;<span class="ident" id="2103865">pow10</span><span class="op" id="2103870">,</span>&nbsp;<span class="ident" id="2103872">shift</span><span class="op" id="2103877">,</span>&nbsp;<span class="ident" id="2103879"></span><span class="op" id="2103881">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2103884">if</span>&nbsp;<span class="op" id="2103887">!</span><span class="ident" id="2103888">ok</span>&nbsp;<span class="op" id="2103891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2103895">return</span>&nbsp;<span class="builtintype" id="2103902">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2103909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2103912">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2103937">for</span>&nbsp;<span class="ident" id="2103941">i</span>&nbsp;<span class="op" id="2103943">:=</span>&nbsp;<span class="ident" id="2103946">d</span><span class="op" id="2103947">.</span><span class="ident" id="2103948">nd</span>&nbsp;<span class="op" id="2103951">-</span>&nbsp;<span class="num" id="2103953">1</span><span class="op" id="2103954">;</span>&nbsp;<span class="ident" id="2103956">i</span>&nbsp;<span class="op" id="2103958">&gt;=</span>&nbsp;<span class="num" id="2103961">0</span><span class="op" id="2103962">;</span>&nbsp;<span class="ident" id="2103964">i</span><span class="op" id="2103965">--</span>&nbsp;<span class="op" id="2103968">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2103972">if</span>&nbsp;<span class="ident" id="2103975">d</span><span class="op" id="2103976">.</span><span class="ident" id="2103977">d</span><span class="op" id="2103978">[</span><span class="ident" id="2103979">i</span><span class="op" id="2103980">]</span>&nbsp;<span class="op" id="2103982">!=</span>&nbsp;<span class="string" id="2103985">&#39;0&#39;</span>&nbsp;<span class="op" id="2103989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2103994">d</span><span class="op" id="2103995">.</span><span class="ident" id="2103996">nd</span>&nbsp;<span class="op" id="2103999">=</span>&nbsp;<span class="ident" id="2104001">i</span>&nbsp;<span class="op" id="2104003">+</span>&nbsp;<span class="num" id="2104005">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104010">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104021">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104024">return</span>&nbsp;<span class="builtintype" id="2104031">true</span><br>
<span class="lineno"></span><span class="op" id="2104036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2104039">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2104122">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2104202">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2104280">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2104301">//</span><br>
<span class="lineno"></span><span class="comment" id="2104304">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2104389">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2104474">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2104514">func</span>&nbsp;<span class="ident" id="2104519">adjustLastDigitFixed</span><span class="op" id="2104539">(</span><span class="ident" id="2104540">d</span>&nbsp;<span class="op" id="2104542">*</span><span class="ident" id="2104543">decimalSlice</span><span class="op" id="2104555">,</span>&nbsp;<span class="ident" id="2104557">num</span><span class="op" id="2104560">,</span>&nbsp;<span class="ident" id="2104562">den</span>&nbsp;<span class="ident" id="2104566">uint64</span><span class="op" id="2104572">,</span>&nbsp;<span class="ident" id="2104574">shift</span>&nbsp;<span class="builtintype" id="2104580">uint</span><span class="op" id="2104584">,</span>&nbsp;<span class="ident" id="2104586"></span>&nbsp;<span class="ident" id="2104589">uint64</span><span class="op" id="2104595">)</span>&nbsp;<span class="builtintype" id="2104597">bool</span>&nbsp;<span class="op" id="2104602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104605">if</span>&nbsp;<span class="ident" id="2104608">num</span>&nbsp;<span class="op" id="2104612">&gt;</span>&nbsp;<span class="ident" id="2104614">den</span><span class="op" id="2104617">&lt;&lt;</span><span class="ident" id="2104619">shift</span>&nbsp;<span class="op" id="2104625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2104629">panic</span><span class="op" id="2104634">(</span><span class="string" id="2104635">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2104686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104689">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104692">if</span>&nbsp;<span class="num" id="2104695">2</span><span class="op" id="2104696">*</span><span class="ident" id="2104697"></span>&nbsp;<span class="op" id="2104700">&gt;</span>&nbsp;<span class="ident" id="2104702">den</span><span class="op" id="2104705">&lt;&lt;</span><span class="ident" id="2104707">shift</span>&nbsp;<span class="op" id="2104713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2104717">panic</span><span class="op" id="2104722">(</span><span class="string" id="2104723">&#34;strconv:&nbsp;&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2104753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104759">if</span>&nbsp;<span class="num" id="2104762">2</span><span class="op" id="2104763">*</span><span class="op" id="2104764">(</span><span class="ident" id="2104765">num</span><span class="op" id="2104768">+</span><span class="ident" id="2104769"></span><span class="op" id="2104771">)</span>&nbsp;<span class="op" id="2104773">&lt;</span>&nbsp;<span class="ident" id="2104775">den</span><span class="op" id="2104778">&lt;&lt;</span><span class="ident" id="2104780">shift</span>&nbsp;<span class="op" id="2104786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104790">return</span>&nbsp;<span class="builtintype" id="2104797">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104806">if</span>&nbsp;<span class="num" id="2104809">2</span><span class="op" id="2104810">*</span><span class="op" id="2104811">(</span><span class="ident" id="2104812">num</span><span class="op" id="2104815">-</span><span class="ident" id="2104816"></span><span class="op" id="2104818">)</span>&nbsp;<span class="op" id="2104820">&gt;</span>&nbsp;<span class="ident" id="2104822">den</span><span class="op" id="2104825">&lt;&lt;</span><span class="ident" id="2104827">shift</span>&nbsp;<span class="op" id="2104833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2104837">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2104860">i</span>&nbsp;<span class="op" id="2104862">:=</span>&nbsp;<span class="ident" id="2104865">d</span><span class="op" id="2104866">.</span><span class="ident" id="2104867">nd</span>&nbsp;<span class="op" id="2104870">-</span>&nbsp;<span class="num" id="2104872">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104876">for</span>&nbsp;<span class="op" id="2104880">;</span>&nbsp;<span class="ident" id="2104882">i</span>&nbsp;<span class="op" id="2104884">&gt;=</span>&nbsp;<span class="num" id="2104887">0</span><span class="op" id="2104888">;</span>&nbsp;<span class="ident" id="2104890">i</span><span class="op" id="2104891">--</span>&nbsp;<span class="op" id="2104894">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104899">if</span>&nbsp;<span class="ident" id="2104902">d</span><span class="op" id="2104903">.</span><span class="ident" id="2104904">d</span><span class="op" id="2104905">[</span><span class="ident" id="2104906">i</span><span class="op" id="2104907">]</span>&nbsp;<span class="op" id="2104909">==</span>&nbsp;<span class="string" id="2104912">&#39;9&#39;</span>&nbsp;<span class="op" id="2104916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2104922">d</span><span class="op" id="2104923">.</span><span class="ident" id="2104924">nd</span><span class="op" id="2104926">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104932">}</span>&nbsp;<span class="keyword" id="2104934">else</span>&nbsp;<span class="op" id="2104939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104945">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104954">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2104958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2104962">if</span>&nbsp;<span class="ident" id="2104965">i</span>&nbsp;<span class="op" id="2104967">&lt;</span>&nbsp;<span class="num" id="2104969">0</span>&nbsp;<span class="op" id="2104971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2104976">d</span><span class="op" id="2104977">.</span><span class="ident" id="2104978">d</span><span class="op" id="2104979">[</span><span class="num" id="2104980">0</span><span class="op" id="2104981">]</span>&nbsp;<span class="op" id="2104983">=</span>&nbsp;<span class="string" id="2104985">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2104992">d</span><span class="op" id="2104993">.</span><span class="ident" id="2104994">nd</span>&nbsp;<span class="op" id="2104997">=</span>&nbsp;<span class="num" id="2104999">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105004">d</span><span class="op" id="2105005">.</span><span class="ident" id="2105006">dp</span><span class="op" id="2105008">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105013">}</span>&nbsp;<span class="keyword" id="2105015">else</span>&nbsp;<span class="op" id="2105020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105025">d</span><span class="op" id="2105026">.</span><span class="ident" id="2105027">d</span><span class="op" id="2105028">[</span><span class="ident" id="2105029">i</span><span class="op" id="2105030">]</span><span class="op" id="2105031">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105040">return</span>&nbsp;<span class="builtintype" id="2105047">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105053">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105056">return</span>&nbsp;<span class="builtintype" id="2105063">false</span><br>
<span class="lineno"></span><span class="op" id="2105069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2105072">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2105144">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2105218">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2105296">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2105326">func</span>&nbsp;<span class="op" id="2105331">(</span><span class="ident" id="2105332">f</span>&nbsp;<span class="op" id="2105334">*</span><span class="ident" id="2105335">extFloat</span><span class="op" id="2105343">)</span>&nbsp;<span class="ident" id="2105345">ShortestDecimal</span><span class="op" id="2105360">(</span><span class="ident" id="2105361">d</span>&nbsp;<span class="op" id="2105363">*</span><span class="ident" id="2105364">decimalSlice</span><span class="op" id="2105376">,</span>&nbsp;<span class="ident" id="2105378">lower</span><span class="op" id="2105383">,</span>&nbsp;<span class="ident" id="2105385">upper</span>&nbsp;<span class="op" id="2105391">*</span><span class="ident" id="2105392">extFloat</span><span class="op" id="2105400">)</span>&nbsp;<span class="builtintype" id="2105402">bool</span>&nbsp;<span class="op" id="2105407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105410">if</span>&nbsp;<span class="ident" id="2105413">f</span><span class="op" id="2105414">.</span><span class="ident" id="2105415">mant</span>&nbsp;<span class="op" id="2105420">==</span>&nbsp;<span class="num" id="2105423">0</span>&nbsp;<span class="op" id="2105425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105429">d</span><span class="op" id="2105430">.</span><span class="ident" id="2105431">nd</span>&nbsp;<span class="op" id="2105434">=</span>&nbsp;<span class="num" id="2105436">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105440">d</span><span class="op" id="2105441">.</span><span class="ident" id="2105442">dp</span>&nbsp;<span class="op" id="2105445">=</span>&nbsp;<span class="num" id="2105447">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105451">d</span><span class="op" id="2105452">.</span><span class="ident" id="2105453">neg</span>&nbsp;<span class="op" id="2105457">=</span>&nbsp;<span class="ident" id="2105459">f</span><span class="op" id="2105460">.</span><span class="ident" id="2105461">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105467">return</span>&nbsp;<span class="builtintype" id="2105474">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105483">if</span>&nbsp;<span class="ident" id="2105486">f</span><span class="op" id="2105487">.</span><span class="ident" id="2105488">exp</span>&nbsp;<span class="op" id="2105492">==</span>&nbsp;<span class="num" id="2105495">0</span>&nbsp;<span class="op" id="2105497">&amp;&amp;</span>&nbsp;<span class="op" id="2105500">*</span><span class="ident" id="2105501">lower</span>&nbsp;<span class="op" id="2105507">==</span>&nbsp;<span class="op" id="2105510">*</span><span class="ident" id="2105511">f</span>&nbsp;<span class="op" id="2105513">&amp;&amp;</span>&nbsp;<span class="op" id="2105516">*</span><span class="ident" id="2105517">lower</span>&nbsp;<span class="op" id="2105523">==</span>&nbsp;<span class="op" id="2105526">*</span><span class="ident" id="2105527">upper</span>&nbsp;<span class="op" id="2105533">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2105537">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105560">var</span>&nbsp;<span class="ident" id="2105564">buf</span>&nbsp;<span class="op" id="2105568">[</span><span class="num" id="2105569">24</span><span class="op" id="2105571">]</span><span class="builtintype" id="2105572">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105579">n</span>&nbsp;<span class="op" id="2105581">:=</span>&nbsp;<span class="builtinfunc" id="2105584">len</span><span class="op" id="2105587">(</span><span class="ident" id="2105588">buf</span><span class="op" id="2105591">)</span>&nbsp;<span class="op" id="2105593">-</span>&nbsp;<span class="num" id="2105595">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105599">for</span>&nbsp;<span class="ident" id="2105603">v</span>&nbsp;<span class="op" id="2105605">:=</span>&nbsp;<span class="ident" id="2105608">f</span><span class="op" id="2105609">.</span><span class="ident" id="2105610">mant</span><span class="op" id="2105614">;</span>&nbsp;<span class="ident" id="2105616">v</span>&nbsp;<span class="op" id="2105618">&gt;</span>&nbsp;<span class="num" id="2105620">0</span><span class="op" id="2105621">;</span>&nbsp;<span class="op" id="2105623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105628">v1</span>&nbsp;<span class="op" id="2105631">:=</span>&nbsp;<span class="ident" id="2105634">v</span>&nbsp;<span class="op" id="2105636">/</span>&nbsp;<span class="num" id="2105638">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105644">v</span>&nbsp;<span class="op" id="2105646">-=</span>&nbsp;<span class="num" id="2105649">10</span>&nbsp;<span class="op" id="2105652">*</span>&nbsp;<span class="ident" id="2105654">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105660">buf</span><span class="op" id="2105663">[</span><span class="ident" id="2105664">n</span><span class="op" id="2105665">]</span>&nbsp;<span class="op" id="2105667">=</span>&nbsp;<span class="builtintype" id="2105669">byte</span><span class="op" id="2105673">(</span><span class="ident" id="2105674">v</span>&nbsp;<span class="op" id="2105676">+</span>&nbsp;<span class="string" id="2105678">&#39;0&#39;</span><span class="op" id="2105681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105686">n</span><span class="op" id="2105687">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105693">v</span>&nbsp;<span class="op" id="2105695">=</span>&nbsp;<span class="ident" id="2105697">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105702">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105706">nd</span>&nbsp;<span class="op" id="2105709">:=</span>&nbsp;<span class="builtinfunc" id="2105712">len</span><span class="op" id="2105715">(</span><span class="ident" id="2105716">buf</span><span class="op" id="2105719">)</span>&nbsp;<span class="op" id="2105721">-</span>&nbsp;<span class="ident" id="2105723">n</span>&nbsp;<span class="op" id="2105725">-</span>&nbsp;<span class="num" id="2105727">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105731">for</span>&nbsp;<span class="ident" id="2105735">i</span>&nbsp;<span class="op" id="2105737">:=</span>&nbsp;<span class="num" id="2105740">0</span><span class="op" id="2105741">;</span>&nbsp;<span class="ident" id="2105743">i</span>&nbsp;<span class="op" id="2105745">&lt;</span>&nbsp;<span class="ident" id="2105747">nd</span><span class="op" id="2105749">;</span>&nbsp;<span class="ident" id="2105751">i</span><span class="op" id="2105752">++</span>&nbsp;<span class="op" id="2105755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105760">d</span><span class="op" id="2105761">.</span><span class="ident" id="2105762">d</span><span class="op" id="2105763">[</span><span class="ident" id="2105764">i</span><span class="op" id="2105765">]</span>&nbsp;<span class="op" id="2105767">=</span>&nbsp;<span class="ident" id="2105769">buf</span><span class="op" id="2105772">[</span><span class="ident" id="2105773">n</span><span class="op" id="2105774">+</span><span class="num" id="2105775">1</span><span class="op" id="2105776">+</span><span class="ident" id="2105777">i</span><span class="op" id="2105778">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105786">d</span><span class="op" id="2105787">.</span><span class="ident" id="2105788">nd</span><span class="op" id="2105790">,</span>&nbsp;<span class="ident" id="2105792">d</span><span class="op" id="2105793">.</span><span class="ident" id="2105794">dp</span>&nbsp;<span class="op" id="2105797">=</span>&nbsp;<span class="ident" id="2105799">nd</span><span class="op" id="2105801">,</span>&nbsp;<span class="ident" id="2105803">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105808">for</span>&nbsp;<span class="ident" id="2105812">d</span><span class="op" id="2105813">.</span><span class="ident" id="2105814">nd</span>&nbsp;<span class="op" id="2105817">&gt;</span>&nbsp;<span class="num" id="2105819">0</span>&nbsp;<span class="op" id="2105821">&amp;&amp;</span>&nbsp;<span class="ident" id="2105824">d</span><span class="op" id="2105825">.</span><span class="ident" id="2105826">d</span><span class="op" id="2105827">[</span><span class="ident" id="2105828">d</span><span class="op" id="2105829">.</span><span class="ident" id="2105830">nd</span><span class="op" id="2105832">-</span><span class="num" id="2105833">1</span><span class="op" id="2105834">]</span>&nbsp;<span class="op" id="2105836">==</span>&nbsp;<span class="string" id="2105839">&#39;0&#39;</span>&nbsp;<span class="op" id="2105843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105848">d</span><span class="op" id="2105849">.</span><span class="ident" id="2105850">nd</span><span class="op" id="2105852">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105861">if</span>&nbsp;<span class="ident" id="2105864">d</span><span class="op" id="2105865">.</span><span class="ident" id="2105866">nd</span>&nbsp;<span class="op" id="2105869">==</span>&nbsp;<span class="num" id="2105872">0</span>&nbsp;<span class="op" id="2105874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105879">d</span><span class="op" id="2105880">.</span><span class="ident" id="2105881">dp</span>&nbsp;<span class="op" id="2105884">=</span>&nbsp;<span class="num" id="2105886">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105894">d</span><span class="op" id="2105895">.</span><span class="ident" id="2105896">neg</span>&nbsp;<span class="op" id="2105900">=</span>&nbsp;<span class="ident" id="2105902">f</span><span class="op" id="2105903">.</span><span class="ident" id="2105904">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105910">return</span>&nbsp;<span class="builtintype" id="2105917">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2105923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105926">upper</span><span class="op" id="2105931">.</span><span class="ident" id="2105932">Normalize</span><span class="op" id="2105941">(</span><span class="op" id="2105942">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2105945">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2105971">if</span>&nbsp;<span class="ident" id="2105974">f</span><span class="op" id="2105975">.</span><span class="ident" id="2105976">exp</span>&nbsp;<span class="op" id="2105980">&gt;</span>&nbsp;<span class="ident" id="2105982">upper</span><span class="op" id="2105987">.</span><span class="ident" id="2105988">exp</span>&nbsp;<span class="op" id="2105992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2105996">f</span><span class="op" id="2105997">.</span><span class="ident" id="2105998">mant</span>&nbsp;<span class="op" id="2106003">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2106007">uint</span><span class="op" id="2106011">(</span><span class="ident" id="2106012">f</span><span class="op" id="2106013">.</span><span class="ident" id="2106014">exp</span>&nbsp;<span class="op" id="2106018">-</span>&nbsp;<span class="ident" id="2106020">upper</span><span class="op" id="2106025">.</span><span class="ident" id="2106026">exp</span><span class="op" id="2106029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106033">f</span><span class="op" id="2106034">.</span><span class="ident" id="2106035">exp</span>&nbsp;<span class="op" id="2106039">=</span>&nbsp;<span class="ident" id="2106041">upper</span><span class="op" id="2106046">.</span><span class="ident" id="2106047">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2106052">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106055">if</span>&nbsp;<span class="ident" id="2106058">lower</span><span class="op" id="2106063">.</span><span class="ident" id="2106064">exp</span>&nbsp;<span class="op" id="2106068">&gt;</span>&nbsp;<span class="ident" id="2106070">upper</span><span class="op" id="2106075">.</span><span class="ident" id="2106076">exp</span>&nbsp;<span class="op" id="2106080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106084">lower</span><span class="op" id="2106089">.</span><span class="ident" id="2106090">mant</span>&nbsp;<span class="op" id="2106095">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2106099">uint</span><span class="op" id="2106103">(</span><span class="ident" id="2106104">lower</span><span class="op" id="2106109">.</span><span class="ident" id="2106110">exp</span>&nbsp;<span class="op" id="2106114">-</span>&nbsp;<span class="ident" id="2106116">upper</span><span class="op" id="2106121">.</span><span class="ident" id="2106122">exp</span><span class="op" id="2106125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106129">lower</span><span class="op" id="2106134">.</span><span class="ident" id="2106135">exp</span>&nbsp;<span class="op" id="2106139">=</span>&nbsp;<span class="ident" id="2106141">upper</span><span class="op" id="2106146">.</span><span class="ident" id="2106147">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2106152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106156">exp10</span>&nbsp;<span class="op" id="2106162">:=</span>&nbsp;<span class="ident" id="2106165">frexp10Many</span><span class="op" id="2106176">(</span><span class="ident" id="2106177">lower</span><span class="op" id="2106182">,</span>&nbsp;<span class="ident" id="2106184">f</span><span class="op" id="2106185">,</span>&nbsp;<span class="ident" id="2106187">upper</span><span class="op" id="2106192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106195">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106275">upper</span><span class="op" id="2106280">.</span><span class="ident" id="2106281">mant</span><span class="op" id="2106285">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106289">lower</span><span class="op" id="2106294">.</span><span class="ident" id="2106295">mant</span><span class="op" id="2106299">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106304">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106375">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106421">shift</span>&nbsp;<span class="op" id="2106427">:=</span>&nbsp;<span class="builtintype" id="2106430">uint</span><span class="op" id="2106434">(</span><span class="op" id="2106435">-</span><span class="ident" id="2106436">upper</span><span class="op" id="2106441">.</span><span class="ident" id="2106442">exp</span><span class="op" id="2106445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106448">integer</span>&nbsp;<span class="op" id="2106456">:=</span>&nbsp;<span class="builtintype" id="2106459">uint32</span><span class="op" id="2106465">(</span><span class="ident" id="2106466">upper</span><span class="op" id="2106471">.</span><span class="ident" id="2106472">mant</span>&nbsp;<span class="op" id="2106477">&gt;&gt;</span>&nbsp;<span class="ident" id="2106480">shift</span><span class="op" id="2106485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106488">fraction</span>&nbsp;<span class="op" id="2106497">:=</span>&nbsp;<span class="ident" id="2106500">upper</span><span class="op" id="2106505">.</span><span class="ident" id="2106506">mant</span>&nbsp;<span class="op" id="2106511">-</span>&nbsp;<span class="op" id="2106513">(</span><span class="ident" id="2106514">uint64</span><span class="op" id="2106520">(</span><span class="ident" id="2106521">integer</span><span class="op" id="2106528">)</span>&nbsp;<span class="op" id="2106530">&lt;&lt;</span>&nbsp;<span class="ident" id="2106533">shift</span><span class="op" id="2106538">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106542">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106607">allowance</span>&nbsp;<span class="op" id="2106617">:=</span>&nbsp;<span class="ident" id="2106620">upper</span><span class="op" id="2106625">.</span><span class="ident" id="2106626">mant</span>&nbsp;<span class="op" id="2106631">-</span>&nbsp;<span class="ident" id="2106633">lower</span><span class="op" id="2106638">.</span><span class="ident" id="2106639">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106645">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106700">targetDiff</span>&nbsp;<span class="op" id="2106711">:=</span>&nbsp;<span class="ident" id="2106714">upper</span><span class="op" id="2106719">.</span><span class="ident" id="2106720">mant</span>&nbsp;<span class="op" id="2106725">-</span>&nbsp;<span class="ident" id="2106727">f</span><span class="op" id="2106728">.</span><span class="ident" id="2106729">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2106736">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106785">var</span>&nbsp;<span class="ident" id="2106789">integerDigits</span>&nbsp;<span class="builtintype" id="2106803">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106808">for</span>&nbsp;<span class="ident" id="2106812">i</span><span class="op" id="2106813">,</span>&nbsp;<span class="ident" id="2106815">pow</span>&nbsp;<span class="op" id="2106819">:=</span>&nbsp;<span class="num" id="2106822">0</span><span class="op" id="2106823">,</span>&nbsp;<span class="ident" id="2106825">uint64</span><span class="op" id="2106831">(</span><span class="num" id="2106832">1</span><span class="op" id="2106833">)</span><span class="op" id="2106834">;</span>&nbsp;<span class="ident" id="2106836">i</span>&nbsp;<span class="op" id="2106838">&lt;</span>&nbsp;<span class="num" id="2106840">20</span><span class="op" id="2106842">;</span>&nbsp;<span class="ident" id="2106844">i</span><span class="op" id="2106845">++</span>&nbsp;<span class="op" id="2106848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106852">if</span>&nbsp;<span class="ident" id="2106855">pow</span>&nbsp;<span class="op" id="2106859">&gt;</span>&nbsp;<span class="ident" id="2106861">uint64</span><span class="op" id="2106867">(</span><span class="ident" id="2106868">integer</span><span class="op" id="2106875">)</span>&nbsp;<span class="op" id="2106877">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106882">integerDigits</span>&nbsp;<span class="op" id="2106896">=</span>&nbsp;<span class="ident" id="2106898">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106903">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2106911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106915">pow</span>&nbsp;<span class="op" id="2106919">*=</span>&nbsp;<span class="num" id="2106922">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2106926">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2106929">for</span>&nbsp;<span class="ident" id="2106933">i</span>&nbsp;<span class="op" id="2106935">:=</span>&nbsp;<span class="num" id="2106938">0</span><span class="op" id="2106939">;</span>&nbsp;<span class="ident" id="2106941">i</span>&nbsp;<span class="op" id="2106943">&lt;</span>&nbsp;<span class="ident" id="2106945">integerDigits</span><span class="op" id="2106958">;</span>&nbsp;<span class="ident" id="2106960">i</span><span class="op" id="2106961">++</span>&nbsp;<span class="op" id="2106964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2106968">pow</span>&nbsp;<span class="op" id="2106972">:=</span>&nbsp;<span class="ident" id="2106975">uint64pow10</span><span class="op" id="2106986">[</span><span class="ident" id="2106987">integerDigits</span><span class="op" id="2107000">-</span><span class="ident" id="2107001">i</span><span class="op" id="2107002">-</span><span class="num" id="2107003">1</span><span class="op" id="2107004">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107008">digit</span>&nbsp;<span class="op" id="2107014">:=</span>&nbsp;<span class="ident" id="2107017">integer</span>&nbsp;<span class="op" id="2107025">/</span>&nbsp;<span class="builtintype" id="2107027">uint32</span><span class="op" id="2107033">(</span><span class="ident" id="2107034">pow</span><span class="op" id="2107037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107041">d</span><span class="op" id="2107042">.</span><span class="ident" id="2107043">d</span><span class="op" id="2107044">[</span><span class="ident" id="2107045">i</span><span class="op" id="2107046">]</span>&nbsp;<span class="op" id="2107048">=</span>&nbsp;<span class="builtintype" id="2107050">byte</span><span class="op" id="2107054">(</span><span class="ident" id="2107055">digit</span>&nbsp;<span class="op" id="2107061">+</span>&nbsp;<span class="string" id="2107063">&#39;0&#39;</span><span class="op" id="2107066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107070">integer</span>&nbsp;<span class="op" id="2107078">-=</span>&nbsp;<span class="ident" id="2107081">digit</span>&nbsp;<span class="op" id="2107087">*</span>&nbsp;<span class="builtintype" id="2107089">uint32</span><span class="op" id="2107095">(</span><span class="ident" id="2107096">pow</span><span class="op" id="2107099">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107103">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2107141">if</span>&nbsp;<span class="ident" id="2107144">currentDiff</span>&nbsp;<span class="op" id="2107156">:=</span>&nbsp;<span class="ident" id="2107159">uint64</span><span class="op" id="2107165">(</span><span class="ident" id="2107166">integer</span><span class="op" id="2107173">)</span><span class="op" id="2107174">&lt;&lt;</span><span class="ident" id="2107176">shift</span>&nbsp;<span class="op" id="2107182">+</span>&nbsp;<span class="ident" id="2107184">fraction</span><span class="op" id="2107192">;</span>&nbsp;<span class="ident" id="2107194">currentDiff</span>&nbsp;<span class="op" id="2107206">&lt;</span>&nbsp;<span class="ident" id="2107208">allowance</span>&nbsp;<span class="op" id="2107218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107223">d</span><span class="op" id="2107224">.</span><span class="ident" id="2107225">nd</span>&nbsp;<span class="op" id="2107228">=</span>&nbsp;<span class="ident" id="2107230">i</span>&nbsp;<span class="op" id="2107232">+</span>&nbsp;<span class="num" id="2107234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107239">d</span><span class="op" id="2107240">.</span><span class="ident" id="2107241">dp</span>&nbsp;<span class="op" id="2107244">=</span>&nbsp;<span class="ident" id="2107246">integerDigits</span>&nbsp;<span class="op" id="2107260">+</span>&nbsp;<span class="ident" id="2107262">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107271">d</span><span class="op" id="2107272">.</span><span class="ident" id="2107273">neg</span>&nbsp;<span class="op" id="2107277">=</span>&nbsp;<span class="ident" id="2107279">f</span><span class="op" id="2107280">.</span><span class="ident" id="2107281">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107288">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107358">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2107396">return</span>&nbsp;<span class="ident" id="2107403">adjustLastDigit</span><span class="op" id="2107418">(</span><span class="ident" id="2107419">d</span><span class="op" id="2107420">,</span>&nbsp;<span class="ident" id="2107422">currentDiff</span><span class="op" id="2107433">,</span>&nbsp;<span class="ident" id="2107435">targetDiff</span><span class="op" id="2107445">,</span>&nbsp;<span class="ident" id="2107447">allowance</span><span class="op" id="2107456">,</span>&nbsp;<span class="ident" id="2107458">pow</span><span class="op" id="2107461">&lt;&lt;</span><span class="ident" id="2107463">shift</span><span class="op" id="2107468">,</span>&nbsp;<span class="num" id="2107470">2</span><span class="op" id="2107471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2107475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2107478">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107481">d</span><span class="op" id="2107482">.</span><span class="ident" id="2107483">nd</span>&nbsp;<span class="op" id="2107486">=</span>&nbsp;<span class="ident" id="2107488">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107503">d</span><span class="op" id="2107504">.</span><span class="ident" id="2107505">dp</span>&nbsp;<span class="op" id="2107508">=</span>&nbsp;<span class="ident" id="2107510">d</span><span class="op" id="2107511">.</span><span class="ident" id="2107512">nd</span>&nbsp;<span class="op" id="2107515">+</span>&nbsp;<span class="ident" id="2107517">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107524">d</span><span class="op" id="2107525">.</span><span class="ident" id="2107526">neg</span>&nbsp;<span class="op" id="2107530">=</span>&nbsp;<span class="ident" id="2107532">f</span><span class="op" id="2107533">.</span><span class="ident" id="2107534">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107540">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107614">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2107690">var</span>&nbsp;<span class="ident" id="2107694">digit</span>&nbsp;<span class="builtintype" id="2107700">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107705">multiplier</span>&nbsp;<span class="op" id="2107716">:=</span>&nbsp;<span class="ident" id="2107719">uint64</span><span class="op" id="2107725">(</span><span class="num" id="2107726">1</span><span class="op" id="2107727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2107730">for</span>&nbsp;<span class="op" id="2107734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107738">fraction</span>&nbsp;<span class="op" id="2107747">*=</span>&nbsp;<span class="num" id="2107750">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107755">multiplier</span>&nbsp;<span class="op" id="2107766">*=</span>&nbsp;<span class="num" id="2107769">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107774">digit</span>&nbsp;<span class="op" id="2107780">=</span>&nbsp;<span class="builtintype" id="2107782">int</span><span class="op" id="2107785">(</span><span class="ident" id="2107786">fraction</span>&nbsp;<span class="op" id="2107795">&gt;&gt;</span>&nbsp;<span class="ident" id="2107798">shift</span><span class="op" id="2107803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107807">d</span><span class="op" id="2107808">.</span><span class="ident" id="2107809">d</span><span class="op" id="2107810">[</span><span class="ident" id="2107811">d</span><span class="op" id="2107812">.</span><span class="ident" id="2107813">nd</span><span class="op" id="2107815">]</span>&nbsp;<span class="op" id="2107817">=</span>&nbsp;<span class="builtintype" id="2107819">byte</span><span class="op" id="2107823">(</span><span class="ident" id="2107824">digit</span>&nbsp;<span class="op" id="2107830">+</span>&nbsp;<span class="string" id="2107832">&#39;0&#39;</span><span class="op" id="2107835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107839">d</span><span class="op" id="2107840">.</span><span class="ident" id="2107841">nd</span><span class="op" id="2107843">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2107848">fraction</span>&nbsp;<span class="op" id="2107857">-=</span>&nbsp;<span class="ident" id="2107860">uint64</span><span class="op" id="2107866">(</span><span class="ident" id="2107867">digit</span><span class="op" id="2107872">)</span>&nbsp;<span class="op" id="2107874">&lt;&lt;</span>&nbsp;<span class="ident" id="2107877">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2107885">if</span>&nbsp;<span class="ident" id="2107888">fraction</span>&nbsp;<span class="op" id="2107897">&lt;</span>&nbsp;<span class="ident" id="2107899">allowance</span><span class="op" id="2107908">*</span><span class="ident" id="2107909">multiplier</span>&nbsp;<span class="op" id="2107920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107925">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2107998">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2108075">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108124">return</span>&nbsp;<span class="ident" id="2108131">adjustLastDigit</span><span class="op" id="2108146">(</span><span class="ident" id="2108147">d</span><span class="op" id="2108148">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2108154">fraction</span><span class="op" id="2108162">,</span>&nbsp;<span class="ident" id="2108164">targetDiff</span><span class="op" id="2108174">*</span><span class="ident" id="2108175">multiplier</span><span class="op" id="2108185">,</span>&nbsp;<span class="ident" id="2108187">allowance</span><span class="op" id="2108196">*</span><span class="ident" id="2108197">multiplier</span><span class="op" id="2108207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2108213">1</span><span class="op" id="2108214">&lt;&lt;</span><span class="ident" id="2108216">shift</span><span class="op" id="2108221">,</span>&nbsp;<span class="ident" id="2108223">multiplier</span><span class="op" id="2108233">*</span><span class="num" id="2108234">2</span><span class="op" id="2108235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2108239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2108242">}</span><br>
<span class="lineno"></span><span class="op" id="2108244">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2108247">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2108315">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*.</span><br>
<span class="lineno"></span><span class="comment" id="2108383">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2108451">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*.</span><br>
<span class="lineno">645</span><span class="keyword" id="2108511">func</span>&nbsp;<span class="ident" id="2108516">adjustLastDigit</span><span class="op" id="2108531">(</span><span class="ident" id="2108532">d</span>&nbsp;<span class="op" id="2108534">*</span><span class="ident" id="2108535">decimalSlice</span><span class="op" id="2108547">,</span>&nbsp;<span class="ident" id="2108549">currentDiff</span><span class="op" id="2108560">,</span>&nbsp;<span class="ident" id="2108562">targetDiff</span><span class="op" id="2108572">,</span>&nbsp;<span class="ident" id="2108574">maxDiff</span><span class="op" id="2108581">,</span>&nbsp;<span class="ident" id="2108583">ulpDecimal</span><span class="op" id="2108593">,</span>&nbsp;<span class="ident" id="2108595">ulpBinary</span>&nbsp;<span class="ident" id="2108605">uint64</span><span class="op" id="2108611">)</span>&nbsp;<span class="builtintype" id="2108613">bool</span>&nbsp;<span class="op" id="2108618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108621">if</span>&nbsp;<span class="ident" id="2108624">ulpDecimal</span>&nbsp;<span class="op" id="2108635">&lt;</span>&nbsp;<span class="num" id="2108637">2</span><span class="op" id="2108638">*</span><span class="ident" id="2108639">ulpBinary</span>&nbsp;<span class="op" id="2108649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2108653">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108685">return</span>&nbsp;<span class="builtintype" id="2108692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2108699">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108702">for</span>&nbsp;<span class="ident" id="2108706">currentDiff</span><span class="op" id="2108717">+</span><span class="ident" id="2108718">ulpDecimal</span><span class="op" id="2108728">/</span><span class="num" id="2108729">2</span><span class="op" id="2108730">+</span><span class="ident" id="2108731">ulpBinary</span>&nbsp;<span class="op" id="2108741">&lt;</span>&nbsp;<span class="ident" id="2108743">targetDiff</span>&nbsp;<span class="op" id="2108754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2108758">d</span><span class="op" id="2108759">.</span><span class="ident" id="2108760">d</span><span class="op" id="2108761">[</span><span class="ident" id="2108762">d</span><span class="op" id="2108763">.</span><span class="ident" id="2108764">nd</span><span class="op" id="2108766">-</span><span class="num" id="2108767">1</span><span class="op" id="2108768">]</span><span class="op" id="2108769">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2108774">currentDiff</span>&nbsp;<span class="op" id="2108786">+=</span>&nbsp;<span class="ident" id="2108789">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2108801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108804">if</span>&nbsp;<span class="ident" id="2108807">currentDiff</span><span class="op" id="2108818">+</span><span class="ident" id="2108819">ulpDecimal</span>&nbsp;<span class="op" id="2108830">&lt;=</span>&nbsp;<span class="ident" id="2108833">targetDiff</span><span class="op" id="2108843">+</span><span class="ident" id="2108844">ulpDecimal</span><span class="op" id="2108854">/</span><span class="num" id="2108855">2</span><span class="op" id="2108856">+</span><span class="ident" id="2108857">ulpBinary</span>&nbsp;<span class="op" id="2108867">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2108871">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108924">return</span>&nbsp;<span class="builtintype" id="2108931">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2108938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2108941">if</span>&nbsp;<span class="ident" id="2108944">currentDiff</span>&nbsp;<span class="op" id="2108956">&lt;</span>&nbsp;<span class="ident" id="2108958">ulpBinary</span>&nbsp;<span class="op" id="2108968">||</span>&nbsp;<span class="ident" id="2108971">currentDiff</span>&nbsp;<span class="op" id="2108983">&gt;</span>&nbsp;<span class="ident" id="2108985">maxDiff</span><span class="op" id="2108992">-</span><span class="ident" id="2108993">ulpBinary</span>&nbsp;<span class="op" id="2109003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2109007">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2109028">return</span>&nbsp;<span class="builtintype" id="2109035">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2109042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2109045">if</span>&nbsp;<span class="ident" id="2109048">d</span><span class="op" id="2109049">.</span><span class="ident" id="2109050">nd</span>&nbsp;<span class="op" id="2109053">==</span>&nbsp;<span class="num" id="2109056">1</span>&nbsp;<span class="op" id="2109058">&amp;&amp;</span>&nbsp;<span class="ident" id="2109061">d</span><span class="op" id="2109062">.</span><span class="ident" id="2109063">d</span><span class="op" id="2109064">[</span><span class="num" id="2109065">0</span><span class="op" id="2109066">]</span>&nbsp;<span class="op" id="2109068">==</span>&nbsp;<span class="string" id="2109071">&#39;0&#39;</span>&nbsp;<span class="op" id="2109075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2109079">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2109122">d</span><span class="op" id="2109123">.</span><span class="ident" id="2109124">nd</span>&nbsp;<span class="op" id="2109127">=</span>&nbsp;<span class="num" id="2109129">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2109133">d</span><span class="op" id="2109134">.</span><span class="ident" id="2109135">dp</span>&nbsp;<span class="op" id="2109138">=</span>&nbsp;<span class="num" id="2109140">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2109143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2109146">return</span>&nbsp;<span class="builtintype" id="2109153">true</span><br>
<span class="lineno"></span><span class="op" id="2109158">}</span>
</div>
</body>
</html>
