<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2547342">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2547397">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2547451">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2547502">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2547525">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2547571">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2547609">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2547674">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2547731">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547776">package</span>&nbsp;<span class="ident" id="2547784">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547793">import</span>&nbsp;<span class="string" id="2547800">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2547810">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2547829">//sys&nbsp;&nbsp;&nbsp;&nbsp;open(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547897">func</span>&nbsp;<span class="ident" id="2547902">Open</span><span class="op" id="2547906">(</span><span class="ident" id="2547907">path</span>&nbsp;<span class="builtintype" id="2547912">string</span><span class="op" id="2547918">,</span>&nbsp;<span class="ident" id="2547920">mode</span>&nbsp;<span class="builtintype" id="2547925">int</span><span class="op" id="2547928">,</span>&nbsp;<span class="ident" id="2547930">perm</span>&nbsp;<span class="builtintype" id="2547935">uint32</span><span class="op" id="2547941">)</span>&nbsp;<span class="op" id="2547943">(</span><span class="ident" id="2547944">fd</span>&nbsp;<span class="builtintype" id="2547947">int</span><span class="op" id="2547950">,</span>&nbsp;<span class="ident" id="2547952">err</span>&nbsp;<span class="builtintype" id="2547956">error</span><span class="op" id="2547961">)</span>&nbsp;<span class="op" id="2547963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2547966">return</span>&nbsp;<span class="ident" id="2547973">open</span><span class="op" id="2547977">(</span><span class="ident" id="2547978">path</span><span class="op" id="2547982">,</span>&nbsp;<span class="ident" id="2547984">mode</span><span class="op" id="2547988">|</span><span class="ident" id="2547989">O_LARGEFILE</span><span class="op" id="2548000">,</span>&nbsp;<span class="ident" id="2548002">perm</span><span class="op" id="2548006">)</span><br>
<span class="lineno"></span><span class="op" id="2548008">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2548011">//sys&nbsp;&nbsp;&nbsp;&nbsp;openat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548093">func</span>&nbsp;<span class="ident" id="2548098">Openat</span><span class="op" id="2548104">(</span><span class="ident" id="2548105">dirfd</span>&nbsp;<span class="builtintype" id="2548111">int</span><span class="op" id="2548114">,</span>&nbsp;<span class="ident" id="2548116">path</span>&nbsp;<span class="builtintype" id="2548121">string</span><span class="op" id="2548127">,</span>&nbsp;<span class="ident" id="2548129">flags</span>&nbsp;<span class="builtintype" id="2548135">int</span><span class="op" id="2548138">,</span>&nbsp;<span class="ident" id="2548140">mode</span>&nbsp;<span class="builtintype" id="2548145">uint32</span><span class="op" id="2548151">)</span>&nbsp;<span class="op" id="2548153">(</span><span class="ident" id="2548154">fd</span>&nbsp;<span class="builtintype" id="2548157">int</span><span class="op" id="2548160">,</span>&nbsp;<span class="ident" id="2548162">err</span>&nbsp;<span class="builtintype" id="2548166">error</span><span class="op" id="2548171">)</span>&nbsp;<span class="op" id="2548173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548176">return</span>&nbsp;<span class="ident" id="2548183">openat</span><span class="op" id="2548189">(</span><span class="ident" id="2548190">dirfd</span><span class="op" id="2548195">,</span>&nbsp;<span class="ident" id="2548197">path</span><span class="op" id="2548201">,</span>&nbsp;<span class="ident" id="2548203">flags</span><span class="op" id="2548208">|</span><span class="ident" id="2548209">O_LARGEFILE</span><span class="op" id="2548220">,</span>&nbsp;<span class="ident" id="2548222">mode</span><span class="op" id="2548226">)</span><br>
<span class="lineno">30</span><span class="op" id="2548228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2548231">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;pipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548271">func</span>&nbsp;<span class="ident" id="2548276">Pipe</span><span class="op" id="2548280">(</span><span class="ident" id="2548281">p</span>&nbsp;<span class="op" id="2548283">[</span><span class="op" id="2548284">]</span><span class="builtintype" id="2548285">int</span><span class="op" id="2548288">)</span>&nbsp;<span class="op" id="2548290">(</span><span class="ident" id="2548291">err</span>&nbsp;<span class="builtintype" id="2548295">error</span><span class="op" id="2548300">)</span>&nbsp;<span class="op" id="2548302">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548305">if</span>&nbsp;<span class="builtinfunc" id="2548308">len</span><span class="op" id="2548311">(</span><span class="ident" id="2548312">p</span><span class="op" id="2548313">)</span>&nbsp;<span class="op" id="2548315">!=</span>&nbsp;<span class="num" id="2548318">2</span>&nbsp;<span class="op" id="2548320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548324">return</span>&nbsp;<span class="ident" id="2548331">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2548339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548342">var</span>&nbsp;<span class="ident" id="2548346">pp</span>&nbsp;<span class="op" id="2548349">[</span><span class="num" id="2548350">2</span><span class="op" id="2548351">]</span><span class="ident" id="2548352">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548360">err</span>&nbsp;<span class="op" id="2548364">=</span>&nbsp;<span class="ident" id="2548366">pipe</span><span class="op" id="2548370">(</span><span class="op" id="2548371">&amp;</span><span class="ident" id="2548372">pp</span><span class="op" id="2548374">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548377">p</span><span class="op" id="2548378">[</span><span class="num" id="2548379">0</span><span class="op" id="2548380">]</span>&nbsp;<span class="op" id="2548382">=</span>&nbsp;<span class="builtintype" id="2548384">int</span><span class="op" id="2548387">(</span><span class="ident" id="2548388">pp</span><span class="op" id="2548390">[</span><span class="num" id="2548391">0</span><span class="op" id="2548392">]</span><span class="op" id="2548393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548396">p</span><span class="op" id="2548397">[</span><span class="num" id="2548398">1</span><span class="op" id="2548399">]</span>&nbsp;<span class="op" id="2548401">=</span>&nbsp;<span class="builtintype" id="2548403">int</span><span class="op" id="2548406">(</span><span class="ident" id="2548407">pp</span><span class="op" id="2548409">[</span><span class="num" id="2548410">1</span><span class="op" id="2548411">]</span><span class="op" id="2548412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548415">return</span><br>
<span class="lineno"></span><span class="op" id="2548422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2548425">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548477">func</span>&nbsp;<span class="ident" id="2548482">Pipe2</span><span class="op" id="2548487">(</span><span class="ident" id="2548488">p</span>&nbsp;<span class="op" id="2548490">[</span><span class="op" id="2548491">]</span><span class="builtintype" id="2548492">int</span><span class="op" id="2548495">,</span>&nbsp;<span class="ident" id="2548497">flags</span>&nbsp;<span class="builtintype" id="2548503">int</span><span class="op" id="2548506">)</span>&nbsp;<span class="op" id="2548508">(</span><span class="ident" id="2548509">err</span>&nbsp;<span class="builtintype" id="2548513">error</span><span class="op" id="2548518">)</span>&nbsp;<span class="op" id="2548520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548523">if</span>&nbsp;<span class="builtinfunc" id="2548526">len</span><span class="op" id="2548529">(</span><span class="ident" id="2548530">p</span><span class="op" id="2548531">)</span>&nbsp;<span class="op" id="2548533">!=</span>&nbsp;<span class="num" id="2548536">2</span>&nbsp;<span class="op" id="2548538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548542">return</span>&nbsp;<span class="ident" id="2548549">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2548557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548560">var</span>&nbsp;<span class="ident" id="2548564">pp</span>&nbsp;<span class="op" id="2548567">[</span><span class="num" id="2548568">2</span><span class="op" id="2548569">]</span><span class="ident" id="2548570">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548578">err</span>&nbsp;<span class="op" id="2548582">=</span>&nbsp;<span class="ident" id="2548584">pipe2</span><span class="op" id="2548589">(</span><span class="op" id="2548590">&amp;</span><span class="ident" id="2548591">pp</span><span class="op" id="2548593">,</span>&nbsp;<span class="ident" id="2548595">flags</span><span class="op" id="2548600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548603">p</span><span class="op" id="2548604">[</span><span class="num" id="2548605">0</span><span class="op" id="2548606">]</span>&nbsp;<span class="op" id="2548608">=</span>&nbsp;<span class="builtintype" id="2548610">int</span><span class="op" id="2548613">(</span><span class="ident" id="2548614">pp</span><span class="op" id="2548616">[</span><span class="num" id="2548617">0</span><span class="op" id="2548618">]</span><span class="op" id="2548619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2548622">p</span><span class="op" id="2548623">[</span><span class="num" id="2548624">1</span><span class="op" id="2548625">]</span>&nbsp;<span class="op" id="2548627">=</span>&nbsp;<span class="builtintype" id="2548629">int</span><span class="op" id="2548632">(</span><span class="ident" id="2548633">pp</span><span class="op" id="2548635">[</span><span class="num" id="2548636">1</span><span class="op" id="2548637">]</span><span class="op" id="2548638">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548641">return</span><br>
<span class="lineno"></span><span class="op" id="2548648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2548651">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2548709">func</span>&nbsp;<span class="ident" id="2548714">Utimes</span><span class="op" id="2548720">(</span><span class="ident" id="2548721">path</span>&nbsp;<span class="builtintype" id="2548726">string</span><span class="op" id="2548732">,</span>&nbsp;<span class="ident" id="2548734">tv</span>&nbsp;<span class="op" id="2548737">[</span><span class="op" id="2548738">]</span><span class="ident" id="2548739">Timeval</span><span class="op" id="2548746">)</span>&nbsp;<span class="op" id="2548748">(</span><span class="ident" id="2548749">err</span>&nbsp;<span class="builtintype" id="2548753">error</span><span class="op" id="2548758">)</span>&nbsp;<span class="op" id="2548760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548763">if</span>&nbsp;<span class="builtinfunc" id="2548766">len</span><span class="op" id="2548769">(</span><span class="ident" id="2548770">tv</span><span class="op" id="2548772">)</span>&nbsp;<span class="op" id="2548774">!=</span>&nbsp;<span class="num" id="2548777">2</span>&nbsp;<span class="op" id="2548779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548783">return</span>&nbsp;<span class="ident" id="2548790">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2548798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548801">return</span>&nbsp;<span class="ident" id="2548808">utimes</span><span class="op" id="2548814">(</span><span class="ident" id="2548815">path</span><span class="op" id="2548819">,</span>&nbsp;<span class="op" id="2548821">(</span><span class="op" id="2548822">*</span><span class="op" id="2548823">[</span><span class="num" id="2548824">2</span><span class="op" id="2548825">]</span><span class="ident" id="2548826">Timeval</span><span class="op" id="2548833">)</span><span class="op" id="2548834">(</span><span class="ident" id="2548835">unsafe</span><span class="op" id="2548841">.</span><span class="ident" id="2548842">Pointer</span><span class="op" id="2548849">(</span><span class="op" id="2548850">&amp;</span><span class="ident" id="2548851">tv</span><span class="op" id="2548853">[</span><span class="num" id="2548854">0</span><span class="op" id="2548855">]</span><span class="op" id="2548856">)</span><span class="op" id="2548857">)</span><span class="op" id="2548858">)</span><br>
<span class="lineno">65</span><span class="op" id="2548860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2548863">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548936">func</span>&nbsp;<span class="ident" id="2548941">UtimesNano</span><span class="op" id="2548951">(</span><span class="ident" id="2548952">path</span>&nbsp;<span class="builtintype" id="2548957">string</span><span class="op" id="2548963">,</span>&nbsp;<span class="ident" id="2548965">ts</span>&nbsp;<span class="op" id="2548968">[</span><span class="op" id="2548969">]</span><span class="ident" id="2548970">Timespec</span><span class="op" id="2548978">)</span>&nbsp;<span class="op" id="2548980">(</span><span class="ident" id="2548981">err</span>&nbsp;<span class="builtintype" id="2548985">error</span><span class="op" id="2548990">)</span>&nbsp;<span class="op" id="2548992">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2548995">if</span>&nbsp;<span class="builtinfunc" id="2548998">len</span><span class="op" id="2549001">(</span><span class="ident" id="2549002">ts</span><span class="op" id="2549004">)</span>&nbsp;<span class="op" id="2549006">!=</span>&nbsp;<span class="num" id="2549009">2</span>&nbsp;<span class="op" id="2549011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549015">return</span>&nbsp;<span class="ident" id="2549022">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2549030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549033">err</span>&nbsp;<span class="op" id="2549037">=</span>&nbsp;<span class="ident" id="2549039">utimensat</span><span class="op" id="2549048">(</span><span class="ident" id="2549049">_AT_FDCWD</span><span class="op" id="2549058">,</span>&nbsp;<span class="ident" id="2549060">path</span><span class="op" id="2549064">,</span>&nbsp;<span class="op" id="2549066">(</span><span class="op" id="2549067">*</span><span class="op" id="2549068">[</span><span class="num" id="2549069">2</span><span class="op" id="2549070">]</span><span class="ident" id="2549071">Timespec</span><span class="op" id="2549079">)</span><span class="op" id="2549080">(</span><span class="ident" id="2549081">unsafe</span><span class="op" id="2549087">.</span><span class="ident" id="2549088">Pointer</span><span class="op" id="2549095">(</span><span class="op" id="2549096">&amp;</span><span class="ident" id="2549097">ts</span><span class="op" id="2549099">[</span><span class="num" id="2549100">0</span><span class="op" id="2549101">]</span><span class="op" id="2549102">)</span><span class="op" id="2549103">)</span><span class="op" id="2549104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549107">if</span>&nbsp;<span class="ident" id="2549110">err</span>&nbsp;<span class="op" id="2549114">!=</span>&nbsp;<span class="ident" id="2549117">ENOSYS</span>&nbsp;<span class="op" id="2549124">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549128">return</span>&nbsp;<span class="ident" id="2549135">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2549140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2549143">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2549218">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549281">var</span>&nbsp;<span class="ident" id="2549285">tv</span>&nbsp;<span class="op" id="2549288">[</span><span class="num" id="2549289">2</span><span class="op" id="2549290">]</span><span class="ident" id="2549291">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549300">for</span>&nbsp;<span class="ident" id="2549304">i</span>&nbsp;<span class="op" id="2549306">:=</span>&nbsp;<span class="num" id="2549309">0</span><span class="op" id="2549310">;</span>&nbsp;<span class="ident" id="2549312">i</span>&nbsp;<span class="op" id="2549314">&lt;</span>&nbsp;<span class="num" id="2549316">2</span><span class="op" id="2549317">;</span>&nbsp;<span class="ident" id="2549319">i</span><span class="op" id="2549320">++</span>&nbsp;<span class="op" id="2549323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549327">tv</span><span class="op" id="2549329">[</span><span class="ident" id="2549330">i</span><span class="op" id="2549331">]</span><span class="op" id="2549332">.</span><span class="ident" id="2549333">Sec</span>&nbsp;<span class="op" id="2549337">=</span>&nbsp;<span class="ident" id="2549339">ts</span><span class="op" id="2549341">[</span><span class="ident" id="2549342">i</span><span class="op" id="2549343">]</span><span class="op" id="2549344">.</span><span class="ident" id="2549345">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549351">tv</span><span class="op" id="2549353">[</span><span class="ident" id="2549354">i</span><span class="op" id="2549355">]</span><span class="op" id="2549356">.</span><span class="ident" id="2549357">Usec</span>&nbsp;<span class="op" id="2549362">=</span>&nbsp;<span class="ident" id="2549364">ts</span><span class="op" id="2549366">[</span><span class="ident" id="2549367">i</span><span class="op" id="2549368">]</span><span class="op" id="2549369">.</span><span class="ident" id="2549370">Nsec</span>&nbsp;<span class="op" id="2549375">/</span>&nbsp;<span class="num" id="2549377">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2549383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549386">return</span>&nbsp;<span class="ident" id="2549393">utimes</span><span class="op" id="2549399">(</span><span class="ident" id="2549400">path</span><span class="op" id="2549404">,</span>&nbsp;<span class="op" id="2549406">(</span><span class="op" id="2549407">*</span><span class="op" id="2549408">[</span><span class="num" id="2549409">2</span><span class="op" id="2549410">]</span><span class="ident" id="2549411">Timeval</span><span class="op" id="2549418">)</span><span class="op" id="2549419">(</span><span class="ident" id="2549420">unsafe</span><span class="op" id="2549426">.</span><span class="ident" id="2549427">Pointer</span><span class="op" id="2549434">(</span><span class="op" id="2549435">&amp;</span><span class="ident" id="2549436">tv</span><span class="op" id="2549438">[</span><span class="num" id="2549439">0</span><span class="op" id="2549440">]</span><span class="op" id="2549441">)</span><span class="op" id="2549442">)</span><span class="op" id="2549443">)</span><br>
<span class="lineno">85</span><span class="op" id="2549445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2549448">//sys&nbsp;&nbsp;&nbsp;&nbsp;futimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549519">func</span>&nbsp;<span class="ident" id="2549524">Futimesat</span><span class="op" id="2549533">(</span><span class="ident" id="2549534">dirfd</span>&nbsp;<span class="builtintype" id="2549540">int</span><span class="op" id="2549543">,</span>&nbsp;<span class="ident" id="2549545">path</span>&nbsp;<span class="builtintype" id="2549550">string</span><span class="op" id="2549556">,</span>&nbsp;<span class="ident" id="2549558">tv</span>&nbsp;<span class="op" id="2549561">[</span><span class="op" id="2549562">]</span><span class="ident" id="2549563">Timeval</span><span class="op" id="2549570">)</span>&nbsp;<span class="op" id="2549572">(</span><span class="ident" id="2549573">err</span>&nbsp;<span class="builtintype" id="2549577">error</span><span class="op" id="2549582">)</span>&nbsp;<span class="op" id="2549584">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549587">if</span>&nbsp;<span class="builtinfunc" id="2549590">len</span><span class="op" id="2549593">(</span><span class="ident" id="2549594">tv</span><span class="op" id="2549596">)</span>&nbsp;<span class="op" id="2549598">!=</span>&nbsp;<span class="num" id="2549601">2</span>&nbsp;<span class="op" id="2549603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549607">return</span>&nbsp;<span class="ident" id="2549614">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2549622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549625">pathp</span><span class="op" id="2549630">,</span>&nbsp;<span class="ident" id="2549632">err</span>&nbsp;<span class="op" id="2549636">:=</span>&nbsp;<span class="ident" id="2549639">BytePtrFromString</span><span class="op" id="2549656">(</span><span class="ident" id="2549657">path</span><span class="op" id="2549661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549664">if</span>&nbsp;<span class="ident" id="2549667">err</span>&nbsp;<span class="op" id="2549671">!=</span>&nbsp;<span class="builtintype" id="2549674">nil</span>&nbsp;<span class="op" id="2549678">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549682">return</span>&nbsp;<span class="ident" id="2549689">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2549694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549697">err</span>&nbsp;<span class="op" id="2549701">=</span>&nbsp;<span class="ident" id="2549703">futimesat</span><span class="op" id="2549712">(</span><span class="ident" id="2549713">dirfd</span><span class="op" id="2549718">,</span>&nbsp;<span class="ident" id="2549720">pathp</span><span class="op" id="2549725">,</span>&nbsp;<span class="op" id="2549727">(</span><span class="op" id="2549728">*</span><span class="op" id="2549729">[</span><span class="num" id="2549730">2</span><span class="op" id="2549731">]</span><span class="ident" id="2549732">Timeval</span><span class="op" id="2549739">)</span><span class="op" id="2549740">(</span><span class="ident" id="2549741">unsafe</span><span class="op" id="2549747">.</span><span class="ident" id="2549748">Pointer</span><span class="op" id="2549755">(</span><span class="op" id="2549756">&amp;</span><span class="ident" id="2549757">tv</span><span class="op" id="2549759">[</span><span class="num" id="2549760">0</span><span class="op" id="2549761">]</span><span class="op" id="2549762">)</span><span class="op" id="2549763">)</span><span class="op" id="2549764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2549767">use</span><span class="op" id="2549770">(</span><span class="ident" id="2549771">unsafe</span><span class="op" id="2549777">.</span><span class="ident" id="2549778">Pointer</span><span class="op" id="2549785">(</span><span class="ident" id="2549786">pathp</span><span class="op" id="2549791">)</span><span class="op" id="2549792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549795">return</span>&nbsp;<span class="ident" id="2549802">err</span><br>
<span class="lineno">100</span><span class="op" id="2549806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549809">func</span>&nbsp;<span class="ident" id="2549814">Futimes</span><span class="op" id="2549821">(</span><span class="ident" id="2549822">fd</span>&nbsp;<span class="builtintype" id="2549825">int</span><span class="op" id="2549828">,</span>&nbsp;<span class="ident" id="2549830">tv</span>&nbsp;<span class="op" id="2549833">[</span><span class="op" id="2549834">]</span><span class="ident" id="2549835">Timeval</span><span class="op" id="2549842">)</span>&nbsp;<span class="op" id="2549844">(</span><span class="ident" id="2549845">err</span>&nbsp;<span class="builtintype" id="2549849">error</span><span class="op" id="2549854">)</span>&nbsp;<span class="op" id="2549856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2549859">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2549918">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2549948">return</span>&nbsp;<span class="ident" id="2549955">Utimes</span><span class="op" id="2549961">(</span><span class="string" id="2549962">&#34;/proc/self/fd/&#34;</span><span class="op" id="2549978">+</span><span class="ident" id="2549979">itoa</span><span class="op" id="2549983">(</span><span class="ident" id="2549984">fd</span><span class="op" id="2549986">)</span><span class="op" id="2549987">,</span>&nbsp;<span class="ident" id="2549989">tv</span><span class="op" id="2549991">)</span><br>
<span class="lineno"></span><span class="op" id="2549993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549996">const</span>&nbsp;<span class="ident" id="2550002">ImplementsGetwd</span>&nbsp;<span class="op" id="2550018">=</span>&nbsp;<span class="builtintype" id="2550020">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2550026">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550071">func</span>&nbsp;<span class="ident" id="2550076">Getwd</span><span class="op" id="2550081">(</span><span class="op" id="2550082">)</span>&nbsp;<span class="op" id="2550084">(</span><span class="ident" id="2550085">wd</span>&nbsp;<span class="builtintype" id="2550088">string</span><span class="op" id="2550094">,</span>&nbsp;<span class="ident" id="2550096">err</span>&nbsp;<span class="builtintype" id="2550100">error</span><span class="op" id="2550105">)</span>&nbsp;<span class="op" id="2550107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550110">var</span>&nbsp;<span class="ident" id="2550114">buf</span>&nbsp;<span class="op" id="2550118">[</span><span class="ident" id="2550119">PathMax</span><span class="op" id="2550126">]</span><span class="builtintype" id="2550127">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550133">n</span><span class="op" id="2550134">,</span>&nbsp;<span class="ident" id="2550136">err</span>&nbsp;<span class="op" id="2550140">:=</span>&nbsp;<span class="ident" id="2550143">Getcwd</span><span class="op" id="2550149">(</span><span class="ident" id="2550150">buf</span><span class="op" id="2550153">[</span><span class="num" id="2550154">0</span><span class="op" id="2550155">:</span><span class="op" id="2550156">]</span><span class="op" id="2550157">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550160">if</span>&nbsp;<span class="ident" id="2550163">err</span>&nbsp;<span class="op" id="2550167">!=</span>&nbsp;<span class="builtintype" id="2550170">nil</span>&nbsp;<span class="op" id="2550174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550178">return</span>&nbsp;<span class="string" id="2550185">&#34;&#34;</span><span class="op" id="2550187">,</span>&nbsp;<span class="ident" id="2550189">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2550197">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550271">if</span>&nbsp;<span class="ident" id="2550274">n</span>&nbsp;<span class="op" id="2550276">&lt;</span>&nbsp;<span class="num" id="2550278">1</span>&nbsp;<span class="op" id="2550280">||</span>&nbsp;<span class="ident" id="2550283">n</span>&nbsp;<span class="op" id="2550285">&gt;</span>&nbsp;<span class="builtinfunc" id="2550287">len</span><span class="op" id="2550290">(</span><span class="ident" id="2550291">buf</span><span class="op" id="2550294">)</span>&nbsp;<span class="op" id="2550296">||</span>&nbsp;<span class="ident" id="2550299">buf</span><span class="op" id="2550302">[</span><span class="ident" id="2550303">n</span><span class="op" id="2550304">-</span><span class="num" id="2550305">1</span><span class="op" id="2550306">]</span>&nbsp;<span class="op" id="2550308">!=</span>&nbsp;<span class="num" id="2550311">0</span>&nbsp;<span class="op" id="2550313">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550317">return</span>&nbsp;<span class="string" id="2550324">&#34;&#34;</span><span class="op" id="2550326">,</span>&nbsp;<span class="ident" id="2550328">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550339">return</span>&nbsp;<span class="builtintype" id="2550346">string</span><span class="op" id="2550352">(</span><span class="ident" id="2550353">buf</span><span class="op" id="2550356">[</span><span class="num" id="2550357">0</span>&nbsp;<span class="op" id="2550359">:</span>&nbsp;<span class="ident" id="2550361">n</span><span class="op" id="2550362">-</span><span class="num" id="2550363">1</span><span class="op" id="2550364">]</span><span class="op" id="2550365">)</span><span class="op" id="2550366">,</span>&nbsp;<span class="builtintype" id="2550368">nil</span><br>
<span class="lineno"></span><span class="op" id="2550372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2550375">func</span>&nbsp;<span class="ident" id="2550380">Getgroups</span><span class="op" id="2550389">(</span><span class="op" id="2550390">)</span>&nbsp;<span class="op" id="2550392">(</span><span class="ident" id="2550393">gids</span>&nbsp;<span class="op" id="2550398">[</span><span class="op" id="2550399">]</span><span class="builtintype" id="2550400">int</span><span class="op" id="2550403">,</span>&nbsp;<span class="ident" id="2550405">err</span>&nbsp;<span class="builtintype" id="2550409">error</span><span class="op" id="2550414">)</span>&nbsp;<span class="op" id="2550416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550419">n</span><span class="op" id="2550420">,</span>&nbsp;<span class="ident" id="2550422">err</span>&nbsp;<span class="op" id="2550426">:=</span>&nbsp;<span class="ident" id="2550429">getgroups</span><span class="op" id="2550438">(</span><span class="num" id="2550439">0</span><span class="op" id="2550440">,</span>&nbsp;<span class="builtintype" id="2550442">nil</span><span class="op" id="2550445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550448">if</span>&nbsp;<span class="ident" id="2550451">err</span>&nbsp;<span class="op" id="2550455">!=</span>&nbsp;<span class="builtintype" id="2550458">nil</span>&nbsp;<span class="op" id="2550462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550466">return</span>&nbsp;<span class="builtintype" id="2550473">nil</span><span class="op" id="2550476">,</span>&nbsp;<span class="ident" id="2550478">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550483">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550486">if</span>&nbsp;<span class="ident" id="2550489">n</span>&nbsp;<span class="op" id="2550491">==</span>&nbsp;<span class="num" id="2550494">0</span>&nbsp;<span class="op" id="2550496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550500">return</span>&nbsp;<span class="builtintype" id="2550507">nil</span><span class="op" id="2550510">,</span>&nbsp;<span class="builtintype" id="2550512">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2550521">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550575">if</span>&nbsp;<span class="ident" id="2550578">n</span>&nbsp;<span class="op" id="2550580">&lt;</span>&nbsp;<span class="num" id="2550582">0</span>&nbsp;<span class="op" id="2550584">||</span>&nbsp;<span class="ident" id="2550587">n</span>&nbsp;<span class="op" id="2550589">&gt;</span>&nbsp;<span class="num" id="2550591">1</span><span class="op" id="2550592">&lt;&lt;</span><span class="num" id="2550594">20</span>&nbsp;<span class="op" id="2550597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550601">return</span>&nbsp;<span class="builtintype" id="2550608">nil</span><span class="op" id="2550611">,</span>&nbsp;<span class="ident" id="2550613">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550625">a</span>&nbsp;<span class="op" id="2550627">:=</span>&nbsp;<span class="builtinfunc" id="2550630">make</span><span class="op" id="2550634">(</span><span class="op" id="2550635">[</span><span class="op" id="2550636">]</span><span class="ident" id="2550637">_Gid_t</span><span class="op" id="2550643">,</span>&nbsp;<span class="ident" id="2550645">n</span><span class="op" id="2550646">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550649">n</span><span class="op" id="2550650">,</span>&nbsp;<span class="ident" id="2550652">err</span>&nbsp;<span class="op" id="2550656">=</span>&nbsp;<span class="ident" id="2550658">getgroups</span><span class="op" id="2550667">(</span><span class="ident" id="2550668">n</span><span class="op" id="2550669">,</span>&nbsp;<span class="op" id="2550671">&amp;</span><span class="ident" id="2550672">a</span><span class="op" id="2550673">[</span><span class="num" id="2550674">0</span><span class="op" id="2550675">]</span><span class="op" id="2550676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550679">if</span>&nbsp;<span class="ident" id="2550682">err</span>&nbsp;<span class="op" id="2550686">!=</span>&nbsp;<span class="builtintype" id="2550689">nil</span>&nbsp;<span class="op" id="2550693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550697">return</span>&nbsp;<span class="builtintype" id="2550704">nil</span><span class="op" id="2550707">,</span>&nbsp;<span class="ident" id="2550709">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550717">gids</span>&nbsp;<span class="op" id="2550722">=</span>&nbsp;<span class="builtinfunc" id="2550724">make</span><span class="op" id="2550728">(</span><span class="op" id="2550729">[</span><span class="op" id="2550730">]</span><span class="builtintype" id="2550731">int</span><span class="op" id="2550734">,</span>&nbsp;<span class="ident" id="2550736">n</span><span class="op" id="2550737">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550740">for</span>&nbsp;<span class="ident" id="2550744">i</span><span class="op" id="2550745">,</span>&nbsp;<span class="ident" id="2550747">v</span>&nbsp;<span class="op" id="2550749">:=</span>&nbsp;<span class="keyword" id="2550752">range</span>&nbsp;<span class="ident" id="2550758">a</span><span class="op" id="2550759">[</span><span class="num" id="2550760">0</span><span class="op" id="2550761">:</span><span class="ident" id="2550762">n</span><span class="op" id="2550763">]</span>&nbsp;<span class="op" id="2550765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550769">gids</span><span class="op" id="2550773">[</span><span class="ident" id="2550774">i</span><span class="op" id="2550775">]</span>&nbsp;<span class="op" id="2550777">=</span>&nbsp;<span class="builtintype" id="2550779">int</span><span class="op" id="2550782">(</span><span class="ident" id="2550783">v</span><span class="op" id="2550784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550790">return</span><br>
<span class="lineno"></span><span class="op" id="2550797">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2550800">func</span>&nbsp;<span class="ident" id="2550805">Setgroups</span><span class="op" id="2550814">(</span><span class="ident" id="2550815">gids</span>&nbsp;<span class="op" id="2550820">[</span><span class="op" id="2550821">]</span><span class="builtintype" id="2550822">int</span><span class="op" id="2550825">)</span>&nbsp;<span class="op" id="2550827">(</span><span class="ident" id="2550828">err</span>&nbsp;<span class="builtintype" id="2550832">error</span><span class="op" id="2550837">)</span>&nbsp;<span class="op" id="2550839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550842">if</span>&nbsp;<span class="builtinfunc" id="2550845">len</span><span class="op" id="2550848">(</span><span class="ident" id="2550849">gids</span><span class="op" id="2550853">)</span>&nbsp;<span class="op" id="2550855">==</span>&nbsp;<span class="num" id="2550858">0</span>&nbsp;<span class="op" id="2550860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550864">return</span>&nbsp;<span class="ident" id="2550871">setgroups</span><span class="op" id="2550880">(</span><span class="num" id="2550881">0</span><span class="op" id="2550882">,</span>&nbsp;<span class="builtintype" id="2550884">nil</span><span class="op" id="2550887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550890">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550894">a</span>&nbsp;<span class="op" id="2550896">:=</span>&nbsp;<span class="builtinfunc" id="2550899">make</span><span class="op" id="2550903">(</span><span class="op" id="2550904">[</span><span class="op" id="2550905">]</span><span class="ident" id="2550906">_Gid_t</span><span class="op" id="2550912">,</span>&nbsp;<span class="builtinfunc" id="2550914">len</span><span class="op" id="2550917">(</span><span class="ident" id="2550918">gids</span><span class="op" id="2550922">)</span><span class="op" id="2550923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550926">for</span>&nbsp;<span class="ident" id="2550930">i</span><span class="op" id="2550931">,</span>&nbsp;<span class="ident" id="2550933">v</span>&nbsp;<span class="op" id="2550935">:=</span>&nbsp;<span class="keyword" id="2550938">range</span>&nbsp;<span class="ident" id="2550944">gids</span>&nbsp;<span class="op" id="2550949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550953">a</span><span class="op" id="2550954">[</span><span class="ident" id="2550955">i</span><span class="op" id="2550956">]</span>&nbsp;<span class="op" id="2550958">=</span>&nbsp;<span class="ident" id="2550960">_Gid_t</span><span class="op" id="2550966">(</span><span class="ident" id="2550967">v</span><span class="op" id="2550968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550971">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2550974">return</span>&nbsp;<span class="ident" id="2550981">setgroups</span><span class="op" id="2550990">(</span><span class="builtinfunc" id="2550991">len</span><span class="op" id="2550994">(</span><span class="ident" id="2550995">a</span><span class="op" id="2550996">)</span><span class="op" id="2550997">,</span>&nbsp;<span class="op" id="2550999">&amp;</span><span class="ident" id="2551000">a</span><span class="op" id="2551001">[</span><span class="num" id="2551002">0</span><span class="op" id="2551003">]</span><span class="op" id="2551004">)</span><br>
<span class="lineno"></span><span class="op" id="2551006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551009">type</span>&nbsp;<span class="ident" id="2551014">WaitStatus</span>&nbsp;<span class="builtintype" id="2551025">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2551033">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2551088">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2551147">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2551197">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2551251">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2551302">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2551357">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2551412">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551452">const</span>&nbsp;<span class="op" id="2551458">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2551461">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2551469">=</span>&nbsp;<span class="num" id="2551471">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2551477">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2551485">=</span>&nbsp;<span class="num" id="2551487">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2551493">exited</span>&nbsp;&nbsp;<span class="op" id="2551501">=</span>&nbsp;<span class="num" id="2551503">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2551509">stopped</span>&nbsp;<span class="op" id="2551517">=</span>&nbsp;<span class="num" id="2551519">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2551525">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2551533">=</span>&nbsp;<span class="num" id="2551535">8</span><br>
<span class="lineno">180</span><span class="op" id="2551537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551540">func</span>&nbsp;<span class="op" id="2551545">(</span><span class="ident" id="2551546">w</span>&nbsp;<span class="ident" id="2551548">WaitStatus</span><span class="op" id="2551558">)</span>&nbsp;<span class="ident" id="2551560">Exited</span><span class="op" id="2551566">(</span><span class="op" id="2551567">)</span>&nbsp;<span class="builtintype" id="2551569">bool</span>&nbsp;<span class="op" id="2551574">{</span>&nbsp;<span class="keyword" id="2551576">return</span>&nbsp;<span class="ident" id="2551583">w</span><span class="op" id="2551584">&amp;</span><span class="ident" id="2551585">mask</span>&nbsp;<span class="op" id="2551590">==</span>&nbsp;<span class="ident" id="2551593">exited</span>&nbsp;<span class="op" id="2551600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551603">func</span>&nbsp;<span class="op" id="2551608">(</span><span class="ident" id="2551609">w</span>&nbsp;<span class="ident" id="2551611">WaitStatus</span><span class="op" id="2551621">)</span>&nbsp;<span class="ident" id="2551623">Signaled</span><span class="op" id="2551631">(</span><span class="op" id="2551632">)</span>&nbsp;<span class="builtintype" id="2551634">bool</span>&nbsp;<span class="op" id="2551639">{</span>&nbsp;<span class="keyword" id="2551641">return</span>&nbsp;<span class="ident" id="2551648">w</span><span class="op" id="2551649">&amp;</span><span class="ident" id="2551650">mask</span>&nbsp;<span class="op" id="2551655">!=</span>&nbsp;<span class="ident" id="2551658">stopped</span>&nbsp;<span class="op" id="2551666">&amp;&amp;</span>&nbsp;<span class="ident" id="2551669">w</span><span class="op" id="2551670">&amp;</span><span class="ident" id="2551671">mask</span>&nbsp;<span class="op" id="2551676">!=</span>&nbsp;<span class="ident" id="2551679">exited</span>&nbsp;<span class="op" id="2551686">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2551689">func</span>&nbsp;<span class="op" id="2551694">(</span><span class="ident" id="2551695">w</span>&nbsp;<span class="ident" id="2551697">WaitStatus</span><span class="op" id="2551707">)</span>&nbsp;<span class="ident" id="2551709">Stopped</span><span class="op" id="2551716">(</span><span class="op" id="2551717">)</span>&nbsp;<span class="builtintype" id="2551719">bool</span>&nbsp;<span class="op" id="2551724">{</span>&nbsp;<span class="keyword" id="2551726">return</span>&nbsp;<span class="ident" id="2551733">w</span><span class="op" id="2551734">&amp;</span><span class="num" id="2551735">0xFF</span>&nbsp;<span class="op" id="2551740">==</span>&nbsp;<span class="ident" id="2551743">stopped</span>&nbsp;<span class="op" id="2551751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551754">func</span>&nbsp;<span class="op" id="2551759">(</span><span class="ident" id="2551760">w</span>&nbsp;<span class="ident" id="2551762">WaitStatus</span><span class="op" id="2551772">)</span>&nbsp;<span class="ident" id="2551774">Continued</span><span class="op" id="2551783">(</span><span class="op" id="2551784">)</span>&nbsp;<span class="builtintype" id="2551786">bool</span>&nbsp;<span class="op" id="2551791">{</span>&nbsp;<span class="keyword" id="2551793">return</span>&nbsp;<span class="ident" id="2551800">w</span>&nbsp;<span class="op" id="2551802">==</span>&nbsp;<span class="num" id="2551805">0xFFFF</span>&nbsp;<span class="op" id="2551812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2551815">func</span>&nbsp;<span class="op" id="2551820">(</span><span class="ident" id="2551821">w</span>&nbsp;<span class="ident" id="2551823">WaitStatus</span><span class="op" id="2551833">)</span>&nbsp;<span class="ident" id="2551835">CoreDump</span><span class="op" id="2551843">(</span><span class="op" id="2551844">)</span>&nbsp;<span class="builtintype" id="2551846">bool</span>&nbsp;<span class="op" id="2551851">{</span>&nbsp;<span class="keyword" id="2551853">return</span>&nbsp;<span class="ident" id="2551860">w</span><span class="op" id="2551861">.</span><span class="ident" id="2551862">Signaled</span><span class="op" id="2551870">(</span><span class="op" id="2551871">)</span>&nbsp;<span class="op" id="2551873">&amp;&amp;</span>&nbsp;<span class="ident" id="2551876">w</span><span class="op" id="2551877">&amp;</span><span class="ident" id="2551878">core</span>&nbsp;<span class="op" id="2551883">!=</span>&nbsp;<span class="num" id="2551886">0</span>&nbsp;<span class="op" id="2551888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551891">func</span>&nbsp;<span class="op" id="2551896">(</span><span class="ident" id="2551897">w</span>&nbsp;<span class="ident" id="2551899">WaitStatus</span><span class="op" id="2551909">)</span>&nbsp;<span class="ident" id="2551911">ExitStatus</span><span class="op" id="2551921">(</span><span class="op" id="2551922">)</span>&nbsp;<span class="builtintype" id="2551924">int</span>&nbsp;<span class="op" id="2551928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2551931">if</span>&nbsp;<span class="op" id="2551934">!</span><span class="ident" id="2551935">w</span><span class="op" id="2551936">.</span><span class="ident" id="2551937">Exited</span><span class="op" id="2551943">(</span><span class="op" id="2551944">)</span>&nbsp;<span class="op" id="2551946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2551950">return</span>&nbsp;<span class="op" id="2551957">-</span><span class="num" id="2551958">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2551961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2551964">return</span>&nbsp;<span class="builtintype" id="2551971">int</span><span class="op" id="2551974">(</span><span class="ident" id="2551975">w</span><span class="op" id="2551976">&gt;&gt;</span><span class="ident" id="2551978">shift</span><span class="op" id="2551983">)</span>&nbsp;<span class="op" id="2551985">&amp;</span>&nbsp;<span class="num" id="2551987">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2551992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551995">func</span>&nbsp;<span class="op" id="2552000">(</span><span class="ident" id="2552001">w</span>&nbsp;<span class="ident" id="2552003">WaitStatus</span><span class="op" id="2552013">)</span>&nbsp;<span class="ident" id="2552015">Signal</span><span class="op" id="2552021">(</span><span class="op" id="2552022">)</span>&nbsp;<span class="ident" id="2552024">Signal</span>&nbsp;<span class="op" id="2552031">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552034">if</span>&nbsp;<span class="op" id="2552037">!</span><span class="ident" id="2552038">w</span><span class="op" id="2552039">.</span><span class="ident" id="2552040">Signaled</span><span class="op" id="2552048">(</span><span class="op" id="2552049">)</span>&nbsp;<span class="op" id="2552051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552055">return</span>&nbsp;<span class="op" id="2552062">-</span><span class="num" id="2552063">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552069">return</span>&nbsp;<span class="ident" id="2552076">Signal</span><span class="op" id="2552082">(</span><span class="ident" id="2552083">w</span>&nbsp;<span class="op" id="2552085">&amp;</span>&nbsp;<span class="ident" id="2552087">mask</span><span class="op" id="2552091">)</span><br>
<span class="lineno"></span><span class="op" id="2552093">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2552096">func</span>&nbsp;<span class="op" id="2552101">(</span><span class="ident" id="2552102">w</span>&nbsp;<span class="ident" id="2552104">WaitStatus</span><span class="op" id="2552114">)</span>&nbsp;<span class="ident" id="2552116">StopSignal</span><span class="op" id="2552126">(</span><span class="op" id="2552127">)</span>&nbsp;<span class="ident" id="2552129">Signal</span>&nbsp;<span class="op" id="2552136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552139">if</span>&nbsp;<span class="op" id="2552142">!</span><span class="ident" id="2552143">w</span><span class="op" id="2552144">.</span><span class="ident" id="2552145">Stopped</span><span class="op" id="2552152">(</span><span class="op" id="2552153">)</span>&nbsp;<span class="op" id="2552155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552159">return</span>&nbsp;<span class="op" id="2552166">-</span><span class="num" id="2552167">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552170">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552173">return</span>&nbsp;<span class="ident" id="2552180">Signal</span><span class="op" id="2552186">(</span><span class="ident" id="2552187">w</span><span class="op" id="2552188">&gt;&gt;</span><span class="ident" id="2552190">shift</span><span class="op" id="2552195">)</span>&nbsp;<span class="op" id="2552197">&amp;</span>&nbsp;<span class="num" id="2552199">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2552204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552207">func</span>&nbsp;<span class="op" id="2552212">(</span><span class="ident" id="2552213">w</span>&nbsp;<span class="ident" id="2552215">WaitStatus</span><span class="op" id="2552225">)</span>&nbsp;<span class="ident" id="2552227">TrapCause</span><span class="op" id="2552236">(</span><span class="op" id="2552237">)</span>&nbsp;<span class="builtintype" id="2552239">int</span>&nbsp;<span class="op" id="2552243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552246">if</span>&nbsp;<span class="ident" id="2552249">w</span><span class="op" id="2552250">.</span><span class="ident" id="2552251">StopSignal</span><span class="op" id="2552261">(</span><span class="op" id="2552262">)</span>&nbsp;<span class="op" id="2552264">!=</span>&nbsp;<span class="ident" id="2552267">SIGTRAP</span>&nbsp;<span class="op" id="2552275">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552279">return</span>&nbsp;<span class="op" id="2552286">-</span><span class="num" id="2552287">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552293">return</span>&nbsp;<span class="builtintype" id="2552300">int</span><span class="op" id="2552303">(</span><span class="ident" id="2552304">w</span><span class="op" id="2552305">&gt;&gt;</span><span class="ident" id="2552307">shift</span><span class="op" id="2552312">)</span>&nbsp;<span class="op" id="2552314">&gt;&gt;</span>&nbsp;<span class="num" id="2552317">8</span><br>
<span class="lineno"></span><span class="op" id="2552319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2552322">//sys&nbsp;&nbsp;&nbsp;&nbsp;wait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552412">func</span>&nbsp;<span class="ident" id="2552417">Wait4</span><span class="op" id="2552422">(</span><span class="ident" id="2552423">pid</span>&nbsp;<span class="builtintype" id="2552427">int</span><span class="op" id="2552430">,</span>&nbsp;<span class="ident" id="2552432">wstatus</span>&nbsp;<span class="op" id="2552440">*</span><span class="ident" id="2552441">WaitStatus</span><span class="op" id="2552451">,</span>&nbsp;<span class="ident" id="2552453">options</span>&nbsp;<span class="builtintype" id="2552461">int</span><span class="op" id="2552464">,</span>&nbsp;<span class="ident" id="2552466">rusage</span>&nbsp;<span class="op" id="2552473">*</span><span class="ident" id="2552474">Rusage</span><span class="op" id="2552480">)</span>&nbsp;<span class="op" id="2552482">(</span><span class="ident" id="2552483">wpid</span>&nbsp;<span class="builtintype" id="2552488">int</span><span class="op" id="2552491">,</span>&nbsp;<span class="ident" id="2552493">err</span>&nbsp;<span class="builtintype" id="2552497">error</span><span class="op" id="2552502">)</span>&nbsp;<span class="op" id="2552504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552507">var</span>&nbsp;<span class="ident" id="2552511">status</span>&nbsp;<span class="ident" id="2552518">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552526">wpid</span><span class="op" id="2552530">,</span>&nbsp;<span class="ident" id="2552532">err</span>&nbsp;<span class="op" id="2552536">=</span>&nbsp;<span class="ident" id="2552538">wait4</span><span class="op" id="2552543">(</span><span class="ident" id="2552544">pid</span><span class="op" id="2552547">,</span>&nbsp;<span class="op" id="2552549">&amp;</span><span class="ident" id="2552550">status</span><span class="op" id="2552556">,</span>&nbsp;<span class="ident" id="2552558">options</span><span class="op" id="2552565">,</span>&nbsp;<span class="ident" id="2552567">rusage</span><span class="op" id="2552573">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552576">if</span>&nbsp;<span class="ident" id="2552579">wstatus</span>&nbsp;<span class="op" id="2552587">!=</span>&nbsp;<span class="builtintype" id="2552590">nil</span>&nbsp;<span class="op" id="2552594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552598">*</span><span class="ident" id="2552599">wstatus</span>&nbsp;<span class="op" id="2552607">=</span>&nbsp;<span class="ident" id="2552609">WaitStatus</span><span class="op" id="2552619">(</span><span class="ident" id="2552620">status</span><span class="op" id="2552626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552632">return</span><br>
<span class="lineno"></span><span class="op" id="2552639">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2552642">func</span>&nbsp;<span class="ident" id="2552647">Mkfifo</span><span class="op" id="2552653">(</span><span class="ident" id="2552654">path</span>&nbsp;<span class="builtintype" id="2552659">string</span><span class="op" id="2552665">,</span>&nbsp;<span class="ident" id="2552667">mode</span>&nbsp;<span class="builtintype" id="2552672">uint32</span><span class="op" id="2552678">)</span>&nbsp;<span class="op" id="2552680">(</span><span class="ident" id="2552681">err</span>&nbsp;<span class="builtintype" id="2552685">error</span><span class="op" id="2552690">)</span>&nbsp;<span class="op" id="2552692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552695">return</span>&nbsp;<span class="ident" id="2552702">Mknod</span><span class="op" id="2552707">(</span><span class="ident" id="2552708">path</span><span class="op" id="2552712">,</span>&nbsp;<span class="ident" id="2552714">mode</span><span class="op" id="2552718">|</span><span class="ident" id="2552719">S_IFIFO</span><span class="op" id="2552726">,</span>&nbsp;<span class="num" id="2552728">0</span><span class="op" id="2552729">)</span><br>
<span class="lineno"></span><span class="op" id="2552731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2552734">func</span>&nbsp;<span class="op" id="2552739">(</span><span class="ident" id="2552740">sa</span>&nbsp;<span class="op" id="2552743">*</span><span class="ident" id="2552744">SockaddrInet4</span><span class="op" id="2552757">)</span>&nbsp;<span class="ident" id="2552759">sockaddr</span><span class="op" id="2552767">(</span><span class="op" id="2552768">)</span>&nbsp;<span class="op" id="2552770">(</span><span class="ident" id="2552771">unsafe</span><span class="op" id="2552777">.</span><span class="ident" id="2552778">Pointer</span><span class="op" id="2552785">,</span>&nbsp;<span class="ident" id="2552787">_Socklen</span><span class="op" id="2552795">,</span>&nbsp;<span class="builtintype" id="2552797">error</span><span class="op" id="2552802">)</span>&nbsp;<span class="op" id="2552804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552807">if</span>&nbsp;<span class="ident" id="2552810">sa</span><span class="op" id="2552812">.</span><span class="ident" id="2552813">Port</span>&nbsp;<span class="op" id="2552818">&lt;</span>&nbsp;<span class="num" id="2552820">0</span>&nbsp;<span class="op" id="2552822">||</span>&nbsp;<span class="ident" id="2552825">sa</span><span class="op" id="2552827">.</span><span class="ident" id="2552828">Port</span>&nbsp;<span class="op" id="2552833">&gt;</span>&nbsp;<span class="num" id="2552835">0xFFFF</span>&nbsp;<span class="op" id="2552842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552846">return</span>&nbsp;<span class="builtintype" id="2552853">nil</span><span class="op" id="2552856">,</span>&nbsp;<span class="num" id="2552858">0</span><span class="op" id="2552859">,</span>&nbsp;<span class="ident" id="2552861">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2552869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552872">sa</span><span class="op" id="2552874">.</span><span class="ident" id="2552875">raw</span><span class="op" id="2552878">.</span><span class="ident" id="2552879">Family</span>&nbsp;<span class="op" id="2552886">=</span>&nbsp;<span class="ident" id="2552888">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552897">p</span>&nbsp;<span class="op" id="2552899">:=</span>&nbsp;<span class="op" id="2552902">(</span><span class="op" id="2552903">*</span><span class="op" id="2552904">[</span><span class="num" id="2552905">2</span><span class="op" id="2552906">]</span><span class="builtintype" id="2552907">byte</span><span class="op" id="2552911">)</span><span class="op" id="2552912">(</span><span class="ident" id="2552913">unsafe</span><span class="op" id="2552919">.</span><span class="ident" id="2552920">Pointer</span><span class="op" id="2552927">(</span><span class="op" id="2552928">&amp;</span><span class="ident" id="2552929">sa</span><span class="op" id="2552931">.</span><span class="ident" id="2552932">raw</span><span class="op" id="2552935">.</span><span class="ident" id="2552936">Port</span><span class="op" id="2552940">)</span><span class="op" id="2552941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552944">p</span><span class="op" id="2552945">[</span><span class="num" id="2552946">0</span><span class="op" id="2552947">]</span>&nbsp;<span class="op" id="2552949">=</span>&nbsp;<span class="builtintype" id="2552951">byte</span><span class="op" id="2552955">(</span><span class="ident" id="2552956">sa</span><span class="op" id="2552958">.</span><span class="ident" id="2552959">Port</span>&nbsp;<span class="op" id="2552964">&gt;&gt;</span>&nbsp;<span class="num" id="2552967">8</span><span class="op" id="2552968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552971">p</span><span class="op" id="2552972">[</span><span class="num" id="2552973">1</span><span class="op" id="2552974">]</span>&nbsp;<span class="op" id="2552976">=</span>&nbsp;<span class="builtintype" id="2552978">byte</span><span class="op" id="2552982">(</span><span class="ident" id="2552983">sa</span><span class="op" id="2552985">.</span><span class="ident" id="2552986">Port</span><span class="op" id="2552990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2552993">for</span>&nbsp;<span class="ident" id="2552997">i</span>&nbsp;<span class="op" id="2552999">:=</span>&nbsp;<span class="num" id="2553002">0</span><span class="op" id="2553003">;</span>&nbsp;<span class="ident" id="2553005">i</span>&nbsp;<span class="op" id="2553007">&lt;</span>&nbsp;<span class="builtinfunc" id="2553009">len</span><span class="op" id="2553012">(</span><span class="ident" id="2553013">sa</span><span class="op" id="2553015">.</span><span class="ident" id="2553016">Addr</span><span class="op" id="2553020">)</span><span class="op" id="2553021">;</span>&nbsp;<span class="ident" id="2553023">i</span><span class="op" id="2553024">++</span>&nbsp;<span class="op" id="2553027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553031">sa</span><span class="op" id="2553033">.</span><span class="ident" id="2553034">raw</span><span class="op" id="2553037">.</span><span class="ident" id="2553038">Addr</span><span class="op" id="2553042">[</span><span class="ident" id="2553043">i</span><span class="op" id="2553044">]</span>&nbsp;<span class="op" id="2553046">=</span>&nbsp;<span class="ident" id="2553048">sa</span><span class="op" id="2553050">.</span><span class="ident" id="2553051">Addr</span><span class="op" id="2553055">[</span><span class="ident" id="2553056">i</span><span class="op" id="2553057">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553063">return</span>&nbsp;<span class="ident" id="2553070">unsafe</span><span class="op" id="2553076">.</span><span class="ident" id="2553077">Pointer</span><span class="op" id="2553084">(</span><span class="op" id="2553085">&amp;</span><span class="ident" id="2553086">sa</span><span class="op" id="2553088">.</span><span class="ident" id="2553089">raw</span><span class="op" id="2553092">)</span><span class="op" id="2553093">,</span>&nbsp;<span class="ident" id="2553095">SizeofSockaddrInet4</span><span class="op" id="2553114">,</span>&nbsp;<span class="builtintype" id="2553116">nil</span><br>
<span class="lineno"></span><span class="op" id="2553120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553123">func</span>&nbsp;<span class="op" id="2553128">(</span><span class="ident" id="2553129">sa</span>&nbsp;<span class="op" id="2553132">*</span><span class="ident" id="2553133">SockaddrInet6</span><span class="op" id="2553146">)</span>&nbsp;<span class="ident" id="2553148">sockaddr</span><span class="op" id="2553156">(</span><span class="op" id="2553157">)</span>&nbsp;<span class="op" id="2553159">(</span><span class="ident" id="2553160">unsafe</span><span class="op" id="2553166">.</span><span class="ident" id="2553167">Pointer</span><span class="op" id="2553174">,</span>&nbsp;<span class="ident" id="2553176">_Socklen</span><span class="op" id="2553184">,</span>&nbsp;<span class="builtintype" id="2553186">error</span><span class="op" id="2553191">)</span>&nbsp;<span class="op" id="2553193">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553196">if</span>&nbsp;<span class="ident" id="2553199">sa</span><span class="op" id="2553201">.</span><span class="ident" id="2553202">Port</span>&nbsp;<span class="op" id="2553207">&lt;</span>&nbsp;<span class="num" id="2553209">0</span>&nbsp;<span class="op" id="2553211">||</span>&nbsp;<span class="ident" id="2553214">sa</span><span class="op" id="2553216">.</span><span class="ident" id="2553217">Port</span>&nbsp;<span class="op" id="2553222">&gt;</span>&nbsp;<span class="num" id="2553224">0xFFFF</span>&nbsp;<span class="op" id="2553231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553235">return</span>&nbsp;<span class="builtintype" id="2553242">nil</span><span class="op" id="2553245">,</span>&nbsp;<span class="num" id="2553247">0</span><span class="op" id="2553248">,</span>&nbsp;<span class="ident" id="2553250">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553261">sa</span><span class="op" id="2553263">.</span><span class="ident" id="2553264">raw</span><span class="op" id="2553267">.</span><span class="ident" id="2553268">Family</span>&nbsp;<span class="op" id="2553275">=</span>&nbsp;<span class="ident" id="2553277">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553287">p</span>&nbsp;<span class="op" id="2553289">:=</span>&nbsp;<span class="op" id="2553292">(</span><span class="op" id="2553293">*</span><span class="op" id="2553294">[</span><span class="num" id="2553295">2</span><span class="op" id="2553296">]</span><span class="builtintype" id="2553297">byte</span><span class="op" id="2553301">)</span><span class="op" id="2553302">(</span><span class="ident" id="2553303">unsafe</span><span class="op" id="2553309">.</span><span class="ident" id="2553310">Pointer</span><span class="op" id="2553317">(</span><span class="op" id="2553318">&amp;</span><span class="ident" id="2553319">sa</span><span class="op" id="2553321">.</span><span class="ident" id="2553322">raw</span><span class="op" id="2553325">.</span><span class="ident" id="2553326">Port</span><span class="op" id="2553330">)</span><span class="op" id="2553331">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553334">p</span><span class="op" id="2553335">[</span><span class="num" id="2553336">0</span><span class="op" id="2553337">]</span>&nbsp;<span class="op" id="2553339">=</span>&nbsp;<span class="builtintype" id="2553341">byte</span><span class="op" id="2553345">(</span><span class="ident" id="2553346">sa</span><span class="op" id="2553348">.</span><span class="ident" id="2553349">Port</span>&nbsp;<span class="op" id="2553354">&gt;&gt;</span>&nbsp;<span class="num" id="2553357">8</span><span class="op" id="2553358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553361">p</span><span class="op" id="2553362">[</span><span class="num" id="2553363">1</span><span class="op" id="2553364">]</span>&nbsp;<span class="op" id="2553366">=</span>&nbsp;<span class="builtintype" id="2553368">byte</span><span class="op" id="2553372">(</span><span class="ident" id="2553373">sa</span><span class="op" id="2553375">.</span><span class="ident" id="2553376">Port</span><span class="op" id="2553380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553383">sa</span><span class="op" id="2553385">.</span><span class="ident" id="2553386">raw</span><span class="op" id="2553389">.</span><span class="ident" id="2553390">Scope_id</span>&nbsp;<span class="op" id="2553399">=</span>&nbsp;<span class="ident" id="2553401">sa</span><span class="op" id="2553403">.</span><span class="ident" id="2553404">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553412">for</span>&nbsp;<span class="ident" id="2553416">i</span>&nbsp;<span class="op" id="2553418">:=</span>&nbsp;<span class="num" id="2553421">0</span><span class="op" id="2553422">;</span>&nbsp;<span class="ident" id="2553424">i</span>&nbsp;<span class="op" id="2553426">&lt;</span>&nbsp;<span class="builtinfunc" id="2553428">len</span><span class="op" id="2553431">(</span><span class="ident" id="2553432">sa</span><span class="op" id="2553434">.</span><span class="ident" id="2553435">Addr</span><span class="op" id="2553439">)</span><span class="op" id="2553440">;</span>&nbsp;<span class="ident" id="2553442">i</span><span class="op" id="2553443">++</span>&nbsp;<span class="op" id="2553446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553450">sa</span><span class="op" id="2553452">.</span><span class="ident" id="2553453">raw</span><span class="op" id="2553456">.</span><span class="ident" id="2553457">Addr</span><span class="op" id="2553461">[</span><span class="ident" id="2553462">i</span><span class="op" id="2553463">]</span>&nbsp;<span class="op" id="2553465">=</span>&nbsp;<span class="ident" id="2553467">sa</span><span class="op" id="2553469">.</span><span class="ident" id="2553470">Addr</span><span class="op" id="2553474">[</span><span class="ident" id="2553475">i</span><span class="op" id="2553476">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553482">return</span>&nbsp;<span class="ident" id="2553489">unsafe</span><span class="op" id="2553495">.</span><span class="ident" id="2553496">Pointer</span><span class="op" id="2553503">(</span><span class="op" id="2553504">&amp;</span><span class="ident" id="2553505">sa</span><span class="op" id="2553507">.</span><span class="ident" id="2553508">raw</span><span class="op" id="2553511">)</span><span class="op" id="2553512">,</span>&nbsp;<span class="ident" id="2553514">SizeofSockaddrInet6</span><span class="op" id="2553533">,</span>&nbsp;<span class="builtintype" id="2553535">nil</span><br>
<span class="lineno"></span><span class="op" id="2553539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553542">func</span>&nbsp;<span class="op" id="2553547">(</span><span class="ident" id="2553548">sa</span>&nbsp;<span class="op" id="2553551">*</span><span class="ident" id="2553552">SockaddrUnix</span><span class="op" id="2553564">)</span>&nbsp;<span class="ident" id="2553566">sockaddr</span><span class="op" id="2553574">(</span><span class="op" id="2553575">)</span>&nbsp;<span class="op" id="2553577">(</span><span class="ident" id="2553578">unsafe</span><span class="op" id="2553584">.</span><span class="ident" id="2553585">Pointer</span><span class="op" id="2553592">,</span>&nbsp;<span class="ident" id="2553594">_Socklen</span><span class="op" id="2553602">,</span>&nbsp;<span class="builtintype" id="2553604">error</span><span class="op" id="2553609">)</span>&nbsp;<span class="op" id="2553611">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553614">name</span>&nbsp;<span class="op" id="2553619">:=</span>&nbsp;<span class="ident" id="2553622">sa</span><span class="op" id="2553624">.</span><span class="ident" id="2553625">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553631">n</span>&nbsp;<span class="op" id="2553633">:=</span>&nbsp;<span class="builtinfunc" id="2553636">len</span><span class="op" id="2553639">(</span><span class="ident" id="2553640">name</span><span class="op" id="2553644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553647">if</span>&nbsp;<span class="ident" id="2553650">n</span>&nbsp;<span class="op" id="2553652">&gt;=</span>&nbsp;<span class="builtinfunc" id="2553655">len</span><span class="op" id="2553658">(</span><span class="ident" id="2553659">sa</span><span class="op" id="2553661">.</span><span class="ident" id="2553662">raw</span><span class="op" id="2553665">.</span><span class="ident" id="2553666">Path</span><span class="op" id="2553670">)</span>&nbsp;<span class="op" id="2553672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553676">return</span>&nbsp;<span class="builtintype" id="2553683">nil</span><span class="op" id="2553686">,</span>&nbsp;<span class="num" id="2553688">0</span><span class="op" id="2553689">,</span>&nbsp;<span class="ident" id="2553691">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553699">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553702">sa</span><span class="op" id="2553704">.</span><span class="ident" id="2553705">raw</span><span class="op" id="2553708">.</span><span class="ident" id="2553709">Family</span>&nbsp;<span class="op" id="2553716">=</span>&nbsp;<span class="ident" id="2553718">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553727">for</span>&nbsp;<span class="ident" id="2553731">i</span>&nbsp;<span class="op" id="2553733">:=</span>&nbsp;<span class="num" id="2553736">0</span><span class="op" id="2553737">;</span>&nbsp;<span class="ident" id="2553739">i</span>&nbsp;<span class="op" id="2553741">&lt;</span>&nbsp;<span class="ident" id="2553743">n</span><span class="op" id="2553744">;</span>&nbsp;<span class="ident" id="2553746">i</span><span class="op" id="2553747">++</span>&nbsp;<span class="op" id="2553750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553754">sa</span><span class="op" id="2553756">.</span><span class="ident" id="2553757">raw</span><span class="op" id="2553760">.</span><span class="ident" id="2553761">Path</span><span class="op" id="2553765">[</span><span class="ident" id="2553766">i</span><span class="op" id="2553767">]</span>&nbsp;<span class="op" id="2553769">=</span>&nbsp;<span class="builtintype" id="2553771">int8</span><span class="op" id="2553775">(</span><span class="ident" id="2553776">name</span><span class="op" id="2553780">[</span><span class="ident" id="2553781">i</span><span class="op" id="2553782">]</span><span class="op" id="2553783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2553789">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553831">sl</span>&nbsp;<span class="op" id="2553834">:=</span>&nbsp;<span class="ident" id="2553837">_Socklen</span><span class="op" id="2553845">(</span><span class="num" id="2553846">2</span><span class="op" id="2553847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553850">if</span>&nbsp;<span class="ident" id="2553853">n</span>&nbsp;<span class="op" id="2553855">&gt;</span>&nbsp;<span class="num" id="2553857">0</span>&nbsp;<span class="op" id="2553859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553863">sl</span>&nbsp;<span class="op" id="2553866">+=</span>&nbsp;<span class="ident" id="2553869">_Socklen</span><span class="op" id="2553877">(</span><span class="ident" id="2553878">n</span><span class="op" id="2553879">)</span>&nbsp;<span class="op" id="2553881">+</span>&nbsp;<span class="num" id="2553883">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2553889">if</span>&nbsp;<span class="ident" id="2553892">sa</span><span class="op" id="2553894">.</span><span class="ident" id="2553895">raw</span><span class="op" id="2553898">.</span><span class="ident" id="2553899">Path</span><span class="op" id="2553903">[</span><span class="num" id="2553904">0</span><span class="op" id="2553905">]</span>&nbsp;<span class="op" id="2553907">==</span>&nbsp;<span class="string" id="2553910">&#39;@&#39;</span>&nbsp;<span class="op" id="2553914">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553918">sa</span><span class="op" id="2553920">.</span><span class="ident" id="2553921">raw</span><span class="op" id="2553924">.</span><span class="ident" id="2553925">Path</span><span class="op" id="2553929">[</span><span class="num" id="2553930">0</span><span class="op" id="2553931">]</span>&nbsp;<span class="op" id="2553933">=</span>&nbsp;<span class="num" id="2553935">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2553939">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553991">sl</span><span class="op" id="2553993">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2553997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554001">return</span>&nbsp;<span class="ident" id="2554008">unsafe</span><span class="op" id="2554014">.</span><span class="ident" id="2554015">Pointer</span><span class="op" id="2554022">(</span><span class="op" id="2554023">&amp;</span><span class="ident" id="2554024">sa</span><span class="op" id="2554026">.</span><span class="ident" id="2554027">raw</span><span class="op" id="2554030">)</span><span class="op" id="2554031">,</span>&nbsp;<span class="ident" id="2554033">sl</span><span class="op" id="2554035">,</span>&nbsp;<span class="builtintype" id="2554037">nil</span><br>
<span class="lineno"></span><span class="op" id="2554041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554044">type</span>&nbsp;<span class="ident" id="2554049">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2554067">struct</span>&nbsp;<span class="op" id="2554074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554077">Protocol</span>&nbsp;<span class="builtintype" id="2554086">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554094">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2554103">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554108">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2554117">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554125">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2554134">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554141">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2554150">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554157">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2554166">[</span><span class="num" id="2554167">8</span><span class="op" id="2554168">]</span><span class="builtintype" id="2554169">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554175">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554184">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2554205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554208">func</span>&nbsp;<span class="op" id="2554213">(</span><span class="ident" id="2554214">sa</span>&nbsp;<span class="op" id="2554217">*</span><span class="ident" id="2554218">SockaddrLinklayer</span><span class="op" id="2554235">)</span>&nbsp;<span class="ident" id="2554237">sockaddr</span><span class="op" id="2554245">(</span><span class="op" id="2554246">)</span>&nbsp;<span class="op" id="2554248">(</span><span class="ident" id="2554249">unsafe</span><span class="op" id="2554255">.</span><span class="ident" id="2554256">Pointer</span><span class="op" id="2554263">,</span>&nbsp;<span class="ident" id="2554265">_Socklen</span><span class="op" id="2554273">,</span>&nbsp;<span class="builtintype" id="2554275">error</span><span class="op" id="2554280">)</span>&nbsp;<span class="op" id="2554282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554285">if</span>&nbsp;<span class="ident" id="2554288">sa</span><span class="op" id="2554290">.</span><span class="ident" id="2554291">Ifindex</span>&nbsp;<span class="op" id="2554299">&lt;</span>&nbsp;<span class="num" id="2554301">0</span>&nbsp;<span class="op" id="2554303">||</span>&nbsp;<span class="ident" id="2554306">sa</span><span class="op" id="2554308">.</span><span class="ident" id="2554309">Ifindex</span>&nbsp;<span class="op" id="2554317">&gt;</span>&nbsp;<span class="num" id="2554319">0x7fffffff</span>&nbsp;<span class="op" id="2554330">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554334">return</span>&nbsp;<span class="builtintype" id="2554341">nil</span><span class="op" id="2554344">,</span>&nbsp;<span class="num" id="2554346">0</span><span class="op" id="2554347">,</span>&nbsp;<span class="ident" id="2554349">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2554357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554360">sa</span><span class="op" id="2554362">.</span><span class="ident" id="2554363">raw</span><span class="op" id="2554366">.</span><span class="ident" id="2554367">Family</span>&nbsp;<span class="op" id="2554374">=</span>&nbsp;<span class="ident" id="2554376">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554387">sa</span><span class="op" id="2554389">.</span><span class="ident" id="2554390">raw</span><span class="op" id="2554393">.</span><span class="ident" id="2554394">Protocol</span>&nbsp;<span class="op" id="2554403">=</span>&nbsp;<span class="ident" id="2554405">sa</span><span class="op" id="2554407">.</span><span class="ident" id="2554408">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554418">sa</span><span class="op" id="2554420">.</span><span class="ident" id="2554421">raw</span><span class="op" id="2554424">.</span><span class="ident" id="2554425">Ifindex</span>&nbsp;<span class="op" id="2554433">=</span>&nbsp;<span class="builtintype" id="2554435">int32</span><span class="op" id="2554440">(</span><span class="ident" id="2554441">sa</span><span class="op" id="2554443">.</span><span class="ident" id="2554444">Ifindex</span><span class="op" id="2554451">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554454">sa</span><span class="op" id="2554456">.</span><span class="ident" id="2554457">raw</span><span class="op" id="2554460">.</span><span class="ident" id="2554461">Hatype</span>&nbsp;<span class="op" id="2554468">=</span>&nbsp;<span class="ident" id="2554470">sa</span><span class="op" id="2554472">.</span><span class="ident" id="2554473">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554481">sa</span><span class="op" id="2554483">.</span><span class="ident" id="2554484">raw</span><span class="op" id="2554487">.</span><span class="ident" id="2554488">Pkttype</span>&nbsp;<span class="op" id="2554496">=</span>&nbsp;<span class="ident" id="2554498">sa</span><span class="op" id="2554500">.</span><span class="ident" id="2554501">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554510">sa</span><span class="op" id="2554512">.</span><span class="ident" id="2554513">raw</span><span class="op" id="2554516">.</span><span class="ident" id="2554517">Halen</span>&nbsp;<span class="op" id="2554523">=</span>&nbsp;<span class="ident" id="2554525">sa</span><span class="op" id="2554527">.</span><span class="ident" id="2554528">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554535">for</span>&nbsp;<span class="ident" id="2554539">i</span>&nbsp;<span class="op" id="2554541">:=</span>&nbsp;<span class="num" id="2554544">0</span><span class="op" id="2554545">;</span>&nbsp;<span class="ident" id="2554547">i</span>&nbsp;<span class="op" id="2554549">&lt;</span>&nbsp;<span class="builtinfunc" id="2554551">len</span><span class="op" id="2554554">(</span><span class="ident" id="2554555">sa</span><span class="op" id="2554557">.</span><span class="ident" id="2554558">Addr</span><span class="op" id="2554562">)</span><span class="op" id="2554563">;</span>&nbsp;<span class="ident" id="2554565">i</span><span class="op" id="2554566">++</span>&nbsp;<span class="op" id="2554569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554573">sa</span><span class="op" id="2554575">.</span><span class="ident" id="2554576">raw</span><span class="op" id="2554579">.</span><span class="ident" id="2554580">Addr</span><span class="op" id="2554584">[</span><span class="ident" id="2554585">i</span><span class="op" id="2554586">]</span>&nbsp;<span class="op" id="2554588">=</span>&nbsp;<span class="ident" id="2554590">sa</span><span class="op" id="2554592">.</span><span class="ident" id="2554593">Addr</span><span class="op" id="2554597">[</span><span class="ident" id="2554598">i</span><span class="op" id="2554599">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2554602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554605">return</span>&nbsp;<span class="ident" id="2554612">unsafe</span><span class="op" id="2554618">.</span><span class="ident" id="2554619">Pointer</span><span class="op" id="2554626">(</span><span class="op" id="2554627">&amp;</span><span class="ident" id="2554628">sa</span><span class="op" id="2554630">.</span><span class="ident" id="2554631">raw</span><span class="op" id="2554634">)</span><span class="op" id="2554635">,</span>&nbsp;<span class="ident" id="2554637">SizeofSockaddrLinklayer</span><span class="op" id="2554660">,</span>&nbsp;<span class="builtintype" id="2554662">nil</span><br>
<span class="lineno"></span><span class="op" id="2554666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554669">type</span>&nbsp;<span class="ident" id="2554674">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2554690">struct</span>&nbsp;<span class="op" id="2554697">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554700">Family</span>&nbsp;<span class="builtintype" id="2554707">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554715">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2554722">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554730">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2554737">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554745">Groups</span>&nbsp;<span class="builtintype" id="2554752">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554760">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554767">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2554786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554789">func</span>&nbsp;<span class="op" id="2554794">(</span><span class="ident" id="2554795">sa</span>&nbsp;<span class="op" id="2554798">*</span><span class="ident" id="2554799">SockaddrNetlink</span><span class="op" id="2554814">)</span>&nbsp;<span class="ident" id="2554816">sockaddr</span><span class="op" id="2554824">(</span><span class="op" id="2554825">)</span>&nbsp;<span class="op" id="2554827">(</span><span class="ident" id="2554828">unsafe</span><span class="op" id="2554834">.</span><span class="ident" id="2554835">Pointer</span><span class="op" id="2554842">,</span>&nbsp;<span class="ident" id="2554844">_Socklen</span><span class="op" id="2554852">,</span>&nbsp;<span class="builtintype" id="2554854">error</span><span class="op" id="2554859">)</span>&nbsp;<span class="op" id="2554861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554864">sa</span><span class="op" id="2554866">.</span><span class="ident" id="2554867">raw</span><span class="op" id="2554870">.</span><span class="ident" id="2554871">Family</span>&nbsp;<span class="op" id="2554878">=</span>&nbsp;<span class="ident" id="2554880">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554892">sa</span><span class="op" id="2554894">.</span><span class="ident" id="2554895">raw</span><span class="op" id="2554898">.</span><span class="ident" id="2554899">Pad</span>&nbsp;<span class="op" id="2554903">=</span>&nbsp;<span class="ident" id="2554905">sa</span><span class="op" id="2554907">.</span><span class="ident" id="2554908">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554913">sa</span><span class="op" id="2554915">.</span><span class="ident" id="2554916">raw</span><span class="op" id="2554919">.</span><span class="ident" id="2554920">Pid</span>&nbsp;<span class="op" id="2554924">=</span>&nbsp;<span class="ident" id="2554926">sa</span><span class="op" id="2554928">.</span><span class="ident" id="2554929">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2554934">sa</span><span class="op" id="2554936">.</span><span class="ident" id="2554937">raw</span><span class="op" id="2554940">.</span><span class="ident" id="2554941">Groups</span>&nbsp;<span class="op" id="2554948">=</span>&nbsp;<span class="ident" id="2554950">sa</span><span class="op" id="2554952">.</span><span class="ident" id="2554953">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554961">return</span>&nbsp;<span class="ident" id="2554968">unsafe</span><span class="op" id="2554974">.</span><span class="ident" id="2554975">Pointer</span><span class="op" id="2554982">(</span><span class="op" id="2554983">&amp;</span><span class="ident" id="2554984">sa</span><span class="op" id="2554986">.</span><span class="ident" id="2554987">raw</span><span class="op" id="2554990">)</span><span class="op" id="2554991">,</span>&nbsp;<span class="ident" id="2554993">SizeofSockaddrNetlink</span><span class="op" id="2555014">,</span>&nbsp;<span class="builtintype" id="2555016">nil</span><br>
<span class="lineno"></span><span class="op" id="2555020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2555023">func</span>&nbsp;<span class="ident" id="2555028">anyToSockaddr</span><span class="op" id="2555041">(</span><span class="ident" id="2555042">rsa</span>&nbsp;<span class="op" id="2555046">*</span><span class="ident" id="2555047">RawSockaddrAny</span><span class="op" id="2555061">)</span>&nbsp;<span class="op" id="2555063">(</span><span class="ident" id="2555064">Sockaddr</span><span class="op" id="2555072">,</span>&nbsp;<span class="builtintype" id="2555074">error</span><span class="op" id="2555079">)</span>&nbsp;<span class="op" id="2555081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555084">switch</span>&nbsp;<span class="ident" id="2555091">rsa</span><span class="op" id="2555094">.</span><span class="ident" id="2555095">Addr</span><span class="op" id="2555099">.</span><span class="ident" id="2555100">Family</span>&nbsp;<span class="op" id="2555107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555110">case</span>&nbsp;<span class="ident" id="2555115">AF_NETLINK</span><span class="op" id="2555125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555129">pp</span>&nbsp;<span class="op" id="2555132">:=</span>&nbsp;<span class="op" id="2555135">(</span><span class="op" id="2555136">*</span><span class="ident" id="2555137">RawSockaddrNetlink</span><span class="op" id="2555155">)</span><span class="op" id="2555156">(</span><span class="ident" id="2555157">unsafe</span><span class="op" id="2555163">.</span><span class="ident" id="2555164">Pointer</span><span class="op" id="2555171">(</span><span class="ident" id="2555172">rsa</span><span class="op" id="2555175">)</span><span class="op" id="2555176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555180">sa</span>&nbsp;<span class="op" id="2555183">:=</span>&nbsp;<span class="builtinfunc" id="2555186">new</span><span class="op" id="2555189">(</span><span class="ident" id="2555190">SockaddrNetlink</span><span class="op" id="2555205">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555209">sa</span><span class="op" id="2555211">.</span><span class="ident" id="2555212">Family</span>&nbsp;<span class="op" id="2555219">=</span>&nbsp;<span class="ident" id="2555221">pp</span><span class="op" id="2555223">.</span><span class="ident" id="2555224">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555233">sa</span><span class="op" id="2555235">.</span><span class="ident" id="2555236">Pad</span>&nbsp;<span class="op" id="2555240">=</span>&nbsp;<span class="ident" id="2555242">pp</span><span class="op" id="2555244">.</span><span class="ident" id="2555245">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555251">sa</span><span class="op" id="2555253">.</span><span class="ident" id="2555254">Pid</span>&nbsp;<span class="op" id="2555258">=</span>&nbsp;<span class="ident" id="2555260">pp</span><span class="op" id="2555262">.</span><span class="ident" id="2555263">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555269">sa</span><span class="op" id="2555271">.</span><span class="ident" id="2555272">Groups</span>&nbsp;<span class="op" id="2555279">=</span>&nbsp;<span class="ident" id="2555281">pp</span><span class="op" id="2555283">.</span><span class="ident" id="2555284">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555293">return</span>&nbsp;<span class="ident" id="2555300">sa</span><span class="op" id="2555302">,</span>&nbsp;<span class="builtintype" id="2555304">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555310">case</span>&nbsp;<span class="ident" id="2555315">AF_PACKET</span><span class="op" id="2555324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555328">pp</span>&nbsp;<span class="op" id="2555331">:=</span>&nbsp;<span class="op" id="2555334">(</span><span class="op" id="2555335">*</span><span class="ident" id="2555336">RawSockaddrLinklayer</span><span class="op" id="2555356">)</span><span class="op" id="2555357">(</span><span class="ident" id="2555358">unsafe</span><span class="op" id="2555364">.</span><span class="ident" id="2555365">Pointer</span><span class="op" id="2555372">(</span><span class="ident" id="2555373">rsa</span><span class="op" id="2555376">)</span><span class="op" id="2555377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555381">sa</span>&nbsp;<span class="op" id="2555384">:=</span>&nbsp;<span class="builtinfunc" id="2555387">new</span><span class="op" id="2555390">(</span><span class="ident" id="2555391">SockaddrLinklayer</span><span class="op" id="2555408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555412">sa</span><span class="op" id="2555414">.</span><span class="ident" id="2555415">Protocol</span>&nbsp;<span class="op" id="2555424">=</span>&nbsp;<span class="ident" id="2555426">pp</span><span class="op" id="2555428">.</span><span class="ident" id="2555429">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555440">sa</span><span class="op" id="2555442">.</span><span class="ident" id="2555443">Ifindex</span>&nbsp;<span class="op" id="2555451">=</span>&nbsp;<span class="builtintype" id="2555453">int</span><span class="op" id="2555456">(</span><span class="ident" id="2555457">pp</span><span class="op" id="2555459">.</span><span class="ident" id="2555460">Ifindex</span><span class="op" id="2555467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555471">sa</span><span class="op" id="2555473">.</span><span class="ident" id="2555474">Hatype</span>&nbsp;<span class="op" id="2555481">=</span>&nbsp;<span class="ident" id="2555483">pp</span><span class="op" id="2555485">.</span><span class="ident" id="2555486">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555495">sa</span><span class="op" id="2555497">.</span><span class="ident" id="2555498">Pkttype</span>&nbsp;<span class="op" id="2555506">=</span>&nbsp;<span class="ident" id="2555508">pp</span><span class="op" id="2555510">.</span><span class="ident" id="2555511">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555521">sa</span><span class="op" id="2555523">.</span><span class="ident" id="2555524">Halen</span>&nbsp;<span class="op" id="2555530">=</span>&nbsp;<span class="ident" id="2555532">pp</span><span class="op" id="2555534">.</span><span class="ident" id="2555535">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555543">for</span>&nbsp;<span class="ident" id="2555547">i</span>&nbsp;<span class="op" id="2555549">:=</span>&nbsp;<span class="num" id="2555552">0</span><span class="op" id="2555553">;</span>&nbsp;<span class="ident" id="2555555">i</span>&nbsp;<span class="op" id="2555557">&lt;</span>&nbsp;<span class="builtinfunc" id="2555559">len</span><span class="op" id="2555562">(</span><span class="ident" id="2555563">sa</span><span class="op" id="2555565">.</span><span class="ident" id="2555566">Addr</span><span class="op" id="2555570">)</span><span class="op" id="2555571">;</span>&nbsp;<span class="ident" id="2555573">i</span><span class="op" id="2555574">++</span>&nbsp;<span class="op" id="2555577">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555582">sa</span><span class="op" id="2555584">.</span><span class="ident" id="2555585">Addr</span><span class="op" id="2555589">[</span><span class="ident" id="2555590">i</span><span class="op" id="2555591">]</span>&nbsp;<span class="op" id="2555593">=</span>&nbsp;<span class="ident" id="2555595">pp</span><span class="op" id="2555597">.</span><span class="ident" id="2555598">Addr</span><span class="op" id="2555602">[</span><span class="ident" id="2555603">i</span><span class="op" id="2555604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555612">return</span>&nbsp;<span class="ident" id="2555619">sa</span><span class="op" id="2555621">,</span>&nbsp;<span class="builtintype" id="2555623">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555629">case</span>&nbsp;<span class="ident" id="2555634">AF_UNIX</span><span class="op" id="2555641">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555645">pp</span>&nbsp;<span class="op" id="2555648">:=</span>&nbsp;<span class="op" id="2555651">(</span><span class="op" id="2555652">*</span><span class="ident" id="2555653">RawSockaddrUnix</span><span class="op" id="2555668">)</span><span class="op" id="2555669">(</span><span class="ident" id="2555670">unsafe</span><span class="op" id="2555676">.</span><span class="ident" id="2555677">Pointer</span><span class="op" id="2555684">(</span><span class="ident" id="2555685">rsa</span><span class="op" id="2555688">)</span><span class="op" id="2555689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555693">sa</span>&nbsp;<span class="op" id="2555696">:=</span>&nbsp;<span class="builtinfunc" id="2555699">new</span><span class="op" id="2555702">(</span><span class="ident" id="2555703">SockaddrUnix</span><span class="op" id="2555715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555719">if</span>&nbsp;<span class="ident" id="2555722">pp</span><span class="op" id="2555724">.</span><span class="ident" id="2555725">Path</span><span class="op" id="2555729">[</span><span class="num" id="2555730">0</span><span class="op" id="2555731">]</span>&nbsp;<span class="op" id="2555733">==</span>&nbsp;<span class="num" id="2555736">0</span>&nbsp;<span class="op" id="2555738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555743">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555780">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555832">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555873">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555915">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2555955">pp</span><span class="op" id="2555957">.</span><span class="ident" id="2555958">Path</span><span class="op" id="2555962">[</span><span class="num" id="2555963">0</span><span class="op" id="2555964">]</span>&nbsp;<span class="op" id="2555966">=</span>&nbsp;<span class="string" id="2555968">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2555974">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2555979">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2556009">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2556062">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2556115">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2556169">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556205">n</span>&nbsp;<span class="op" id="2556207">:=</span>&nbsp;<span class="num" id="2556210">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556214">for</span>&nbsp;<span class="ident" id="2556218">n</span>&nbsp;<span class="op" id="2556220">&lt;</span>&nbsp;<span class="builtinfunc" id="2556222">len</span><span class="op" id="2556225">(</span><span class="ident" id="2556226">pp</span><span class="op" id="2556228">.</span><span class="ident" id="2556229">Path</span><span class="op" id="2556233">)</span>&nbsp;<span class="op" id="2556235">&amp;&amp;</span>&nbsp;<span class="ident" id="2556238">pp</span><span class="op" id="2556240">.</span><span class="ident" id="2556241">Path</span><span class="op" id="2556245">[</span><span class="ident" id="2556246">n</span><span class="op" id="2556247">]</span>&nbsp;<span class="op" id="2556249">!=</span>&nbsp;<span class="num" id="2556252">0</span>&nbsp;<span class="op" id="2556254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556259">n</span><span class="op" id="2556260">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2556265">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556269">bytes</span>&nbsp;<span class="op" id="2556275">:=</span>&nbsp;<span class="op" id="2556278">(</span><span class="op" id="2556279">*</span><span class="op" id="2556280">[</span><span class="num" id="2556281">10000</span><span class="op" id="2556286">]</span><span class="builtintype" id="2556287">byte</span><span class="op" id="2556291">)</span><span class="op" id="2556292">(</span><span class="ident" id="2556293">unsafe</span><span class="op" id="2556299">.</span><span class="ident" id="2556300">Pointer</span><span class="op" id="2556307">(</span><span class="op" id="2556308">&amp;</span><span class="ident" id="2556309">pp</span><span class="op" id="2556311">.</span><span class="ident" id="2556312">Path</span><span class="op" id="2556316">[</span><span class="num" id="2556317">0</span><span class="op" id="2556318">]</span><span class="op" id="2556319">)</span><span class="op" id="2556320">)</span><span class="op" id="2556321">[</span><span class="num" id="2556322">0</span><span class="op" id="2556323">:</span><span class="ident" id="2556324">n</span><span class="op" id="2556325">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556329">sa</span><span class="op" id="2556331">.</span><span class="ident" id="2556332">Name</span>&nbsp;<span class="op" id="2556337">=</span>&nbsp;<span class="builtintype" id="2556339">string</span><span class="op" id="2556345">(</span><span class="ident" id="2556346">bytes</span><span class="op" id="2556351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556355">return</span>&nbsp;<span class="ident" id="2556362">sa</span><span class="op" id="2556364">,</span>&nbsp;<span class="builtintype" id="2556366">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556372">case</span>&nbsp;<span class="ident" id="2556377">AF_INET</span><span class="op" id="2556384">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556388">pp</span>&nbsp;<span class="op" id="2556391">:=</span>&nbsp;<span class="op" id="2556394">(</span><span class="op" id="2556395">*</span><span class="ident" id="2556396">RawSockaddrInet4</span><span class="op" id="2556412">)</span><span class="op" id="2556413">(</span><span class="ident" id="2556414">unsafe</span><span class="op" id="2556420">.</span><span class="ident" id="2556421">Pointer</span><span class="op" id="2556428">(</span><span class="ident" id="2556429">rsa</span><span class="op" id="2556432">)</span><span class="op" id="2556433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556437">sa</span>&nbsp;<span class="op" id="2556440">:=</span>&nbsp;<span class="builtinfunc" id="2556443">new</span><span class="op" id="2556446">(</span><span class="ident" id="2556447">SockaddrInet4</span><span class="op" id="2556460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556464">p</span>&nbsp;<span class="op" id="2556466">:=</span>&nbsp;<span class="op" id="2556469">(</span><span class="op" id="2556470">*</span><span class="op" id="2556471">[</span><span class="num" id="2556472">2</span><span class="op" id="2556473">]</span><span class="builtintype" id="2556474">byte</span><span class="op" id="2556478">)</span><span class="op" id="2556479">(</span><span class="ident" id="2556480">unsafe</span><span class="op" id="2556486">.</span><span class="ident" id="2556487">Pointer</span><span class="op" id="2556494">(</span><span class="op" id="2556495">&amp;</span><span class="ident" id="2556496">pp</span><span class="op" id="2556498">.</span><span class="ident" id="2556499">Port</span><span class="op" id="2556503">)</span><span class="op" id="2556504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556508">sa</span><span class="op" id="2556510">.</span><span class="ident" id="2556511">Port</span>&nbsp;<span class="op" id="2556516">=</span>&nbsp;<span class="builtintype" id="2556518">int</span><span class="op" id="2556521">(</span><span class="ident" id="2556522">p</span><span class="op" id="2556523">[</span><span class="num" id="2556524">0</span><span class="op" id="2556525">]</span><span class="op" id="2556526">)</span><span class="op" id="2556527">&lt;&lt;</span><span class="num" id="2556529">8</span>&nbsp;<span class="op" id="2556531">+</span>&nbsp;<span class="builtintype" id="2556533">int</span><span class="op" id="2556536">(</span><span class="ident" id="2556537">p</span><span class="op" id="2556538">[</span><span class="num" id="2556539">1</span><span class="op" id="2556540">]</span><span class="op" id="2556541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556545">for</span>&nbsp;<span class="ident" id="2556549">i</span>&nbsp;<span class="op" id="2556551">:=</span>&nbsp;<span class="num" id="2556554">0</span><span class="op" id="2556555">;</span>&nbsp;<span class="ident" id="2556557">i</span>&nbsp;<span class="op" id="2556559">&lt;</span>&nbsp;<span class="builtinfunc" id="2556561">len</span><span class="op" id="2556564">(</span><span class="ident" id="2556565">sa</span><span class="op" id="2556567">.</span><span class="ident" id="2556568">Addr</span><span class="op" id="2556572">)</span><span class="op" id="2556573">;</span>&nbsp;<span class="ident" id="2556575">i</span><span class="op" id="2556576">++</span>&nbsp;<span class="op" id="2556579">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556584">sa</span><span class="op" id="2556586">.</span><span class="ident" id="2556587">Addr</span><span class="op" id="2556591">[</span><span class="ident" id="2556592">i</span><span class="op" id="2556593">]</span>&nbsp;<span class="op" id="2556595">=</span>&nbsp;<span class="ident" id="2556597">pp</span><span class="op" id="2556599">.</span><span class="ident" id="2556600">Addr</span><span class="op" id="2556604">[</span><span class="ident" id="2556605">i</span><span class="op" id="2556606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2556610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556614">return</span>&nbsp;<span class="ident" id="2556621">sa</span><span class="op" id="2556623">,</span>&nbsp;<span class="builtintype" id="2556625">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556631">case</span>&nbsp;<span class="ident" id="2556636">AF_INET6</span><span class="op" id="2556644">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556648">pp</span>&nbsp;<span class="op" id="2556651">:=</span>&nbsp;<span class="op" id="2556654">(</span><span class="op" id="2556655">*</span><span class="ident" id="2556656">RawSockaddrInet6</span><span class="op" id="2556672">)</span><span class="op" id="2556673">(</span><span class="ident" id="2556674">unsafe</span><span class="op" id="2556680">.</span><span class="ident" id="2556681">Pointer</span><span class="op" id="2556688">(</span><span class="ident" id="2556689">rsa</span><span class="op" id="2556692">)</span><span class="op" id="2556693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556697">sa</span>&nbsp;<span class="op" id="2556700">:=</span>&nbsp;<span class="builtinfunc" id="2556703">new</span><span class="op" id="2556706">(</span><span class="ident" id="2556707">SockaddrInet6</span><span class="op" id="2556720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556724">p</span>&nbsp;<span class="op" id="2556726">:=</span>&nbsp;<span class="op" id="2556729">(</span><span class="op" id="2556730">*</span><span class="op" id="2556731">[</span><span class="num" id="2556732">2</span><span class="op" id="2556733">]</span><span class="builtintype" id="2556734">byte</span><span class="op" id="2556738">)</span><span class="op" id="2556739">(</span><span class="ident" id="2556740">unsafe</span><span class="op" id="2556746">.</span><span class="ident" id="2556747">Pointer</span><span class="op" id="2556754">(</span><span class="op" id="2556755">&amp;</span><span class="ident" id="2556756">pp</span><span class="op" id="2556758">.</span><span class="ident" id="2556759">Port</span><span class="op" id="2556763">)</span><span class="op" id="2556764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556768">sa</span><span class="op" id="2556770">.</span><span class="ident" id="2556771">Port</span>&nbsp;<span class="op" id="2556776">=</span>&nbsp;<span class="builtintype" id="2556778">int</span><span class="op" id="2556781">(</span><span class="ident" id="2556782">p</span><span class="op" id="2556783">[</span><span class="num" id="2556784">0</span><span class="op" id="2556785">]</span><span class="op" id="2556786">)</span><span class="op" id="2556787">&lt;&lt;</span><span class="num" id="2556789">8</span>&nbsp;<span class="op" id="2556791">+</span>&nbsp;<span class="builtintype" id="2556793">int</span><span class="op" id="2556796">(</span><span class="ident" id="2556797">p</span><span class="op" id="2556798">[</span><span class="num" id="2556799">1</span><span class="op" id="2556800">]</span><span class="op" id="2556801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556805">sa</span><span class="op" id="2556807">.</span><span class="ident" id="2556808">ZoneId</span>&nbsp;<span class="op" id="2556815">=</span>&nbsp;<span class="ident" id="2556817">pp</span><span class="op" id="2556819">.</span><span class="ident" id="2556820">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556831">for</span>&nbsp;<span class="ident" id="2556835">i</span>&nbsp;<span class="op" id="2556837">:=</span>&nbsp;<span class="num" id="2556840">0</span><span class="op" id="2556841">;</span>&nbsp;<span class="ident" id="2556843">i</span>&nbsp;<span class="op" id="2556845">&lt;</span>&nbsp;<span class="builtinfunc" id="2556847">len</span><span class="op" id="2556850">(</span><span class="ident" id="2556851">sa</span><span class="op" id="2556853">.</span><span class="ident" id="2556854">Addr</span><span class="op" id="2556858">)</span><span class="op" id="2556859">;</span>&nbsp;<span class="ident" id="2556861">i</span><span class="op" id="2556862">++</span>&nbsp;<span class="op" id="2556865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2556870">sa</span><span class="op" id="2556872">.</span><span class="ident" id="2556873">Addr</span><span class="op" id="2556877">[</span><span class="ident" id="2556878">i</span><span class="op" id="2556879">]</span>&nbsp;<span class="op" id="2556881">=</span>&nbsp;<span class="ident" id="2556883">pp</span><span class="op" id="2556885">.</span><span class="ident" id="2556886">Addr</span><span class="op" id="2556890">[</span><span class="ident" id="2556891">i</span><span class="op" id="2556892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2556896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556900">return</span>&nbsp;<span class="ident" id="2556907">sa</span><span class="op" id="2556909">,</span>&nbsp;<span class="builtintype" id="2556911">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2556916">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2556919">return</span>&nbsp;<span class="builtintype" id="2556926">nil</span><span class="op" id="2556929">,</span>&nbsp;<span class="ident" id="2556931">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2556944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2556947">func</span>&nbsp;<span class="ident" id="2556952">Accept</span><span class="op" id="2556958">(</span><span class="ident" id="2556959">fd</span>&nbsp;<span class="builtintype" id="2556962">int</span><span class="op" id="2556965">)</span>&nbsp;<span class="op" id="2556967">(</span><span class="ident" id="2556968">nfd</span>&nbsp;<span class="builtintype" id="2556972">int</span><span class="op" id="2556975">,</span>&nbsp;<span class="ident" id="2556977">sa</span>&nbsp;<span class="ident" id="2556980">Sockaddr</span><span class="op" id="2556988">,</span>&nbsp;<span class="ident" id="2556990">err</span>&nbsp;<span class="builtintype" id="2556994">error</span><span class="op" id="2556999">)</span>&nbsp;<span class="op" id="2557001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557004">var</span>&nbsp;<span class="ident" id="2557008">rsa</span>&nbsp;<span class="ident" id="2557012">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557028">var</span>&nbsp;<span class="builtinfunc" id="2557032">len</span>&nbsp;<span class="ident" id="2557036">_Socklen</span>&nbsp;<span class="op" id="2557045">=</span>&nbsp;<span class="ident" id="2557047">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557066">nfd</span><span class="op" id="2557069">,</span>&nbsp;<span class="ident" id="2557071">err</span>&nbsp;<span class="op" id="2557075">=</span>&nbsp;<span class="ident" id="2557077">accept</span><span class="op" id="2557083">(</span><span class="ident" id="2557084">fd</span><span class="op" id="2557086">,</span>&nbsp;<span class="op" id="2557088">&amp;</span><span class="ident" id="2557089">rsa</span><span class="op" id="2557092">,</span>&nbsp;<span class="op" id="2557094">&amp;</span><span class="builtinfunc" id="2557095">len</span><span class="op" id="2557098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557101">if</span>&nbsp;<span class="ident" id="2557104">err</span>&nbsp;<span class="op" id="2557108">!=</span>&nbsp;<span class="builtintype" id="2557111">nil</span>&nbsp;<span class="op" id="2557115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557119">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557127">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557130">sa</span><span class="op" id="2557132">,</span>&nbsp;<span class="ident" id="2557134">err</span>&nbsp;<span class="op" id="2557138">=</span>&nbsp;<span class="ident" id="2557140">anyToSockaddr</span><span class="op" id="2557153">(</span><span class="op" id="2557154">&amp;</span><span class="ident" id="2557155">rsa</span><span class="op" id="2557158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557161">if</span>&nbsp;<span class="ident" id="2557164">err</span>&nbsp;<span class="op" id="2557168">!=</span>&nbsp;<span class="builtintype" id="2557171">nil</span>&nbsp;<span class="op" id="2557175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557179">Close</span><span class="op" id="2557184">(</span><span class="ident" id="2557185">nfd</span><span class="op" id="2557188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557192">nfd</span>&nbsp;<span class="op" id="2557196">=</span>&nbsp;<span class="num" id="2557198">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557201">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557204">return</span><br>
<span class="lineno"></span><span class="op" id="2557211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2557214">func</span>&nbsp;<span class="ident" id="2557219">Accept4</span><span class="op" id="2557226">(</span><span class="ident" id="2557227">fd</span>&nbsp;<span class="builtintype" id="2557230">int</span><span class="op" id="2557233">,</span>&nbsp;<span class="ident" id="2557235">flags</span>&nbsp;<span class="builtintype" id="2557241">int</span><span class="op" id="2557244">)</span>&nbsp;<span class="op" id="2557246">(</span><span class="ident" id="2557247">nfd</span>&nbsp;<span class="builtintype" id="2557251">int</span><span class="op" id="2557254">,</span>&nbsp;<span class="ident" id="2557256">sa</span>&nbsp;<span class="ident" id="2557259">Sockaddr</span><span class="op" id="2557267">,</span>&nbsp;<span class="ident" id="2557269">err</span>&nbsp;<span class="builtintype" id="2557273">error</span><span class="op" id="2557278">)</span>&nbsp;<span class="op" id="2557280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557283">var</span>&nbsp;<span class="ident" id="2557287">rsa</span>&nbsp;<span class="ident" id="2557291">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557307">var</span>&nbsp;<span class="builtinfunc" id="2557311">len</span>&nbsp;<span class="ident" id="2557315">_Socklen</span>&nbsp;<span class="op" id="2557324">=</span>&nbsp;<span class="ident" id="2557326">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557345">nfd</span><span class="op" id="2557348">,</span>&nbsp;<span class="ident" id="2557350">err</span>&nbsp;<span class="op" id="2557354">=</span>&nbsp;<span class="ident" id="2557356">accept4</span><span class="op" id="2557363">(</span><span class="ident" id="2557364">fd</span><span class="op" id="2557366">,</span>&nbsp;<span class="op" id="2557368">&amp;</span><span class="ident" id="2557369">rsa</span><span class="op" id="2557372">,</span>&nbsp;<span class="op" id="2557374">&amp;</span><span class="builtinfunc" id="2557375">len</span><span class="op" id="2557378">,</span>&nbsp;<span class="ident" id="2557380">flags</span><span class="op" id="2557385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557388">if</span>&nbsp;<span class="ident" id="2557391">err</span>&nbsp;<span class="op" id="2557395">!=</span>&nbsp;<span class="builtintype" id="2557398">nil</span>&nbsp;<span class="op" id="2557402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557414">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557417">if</span>&nbsp;<span class="builtinfunc" id="2557420">len</span>&nbsp;<span class="op" id="2557424">&gt;</span>&nbsp;<span class="ident" id="2557426">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2557444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2557448">panic</span><span class="op" id="2557453">(</span><span class="string" id="2557454">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2557480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557486">sa</span><span class="op" id="2557488">,</span>&nbsp;<span class="ident" id="2557490">err</span>&nbsp;<span class="op" id="2557494">=</span>&nbsp;<span class="ident" id="2557496">anyToSockaddr</span><span class="op" id="2557509">(</span><span class="op" id="2557510">&amp;</span><span class="ident" id="2557511">rsa</span><span class="op" id="2557514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557517">if</span>&nbsp;<span class="ident" id="2557520">err</span>&nbsp;<span class="op" id="2557524">!=</span>&nbsp;<span class="builtintype" id="2557527">nil</span>&nbsp;<span class="op" id="2557531">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557535">Close</span><span class="op" id="2557540">(</span><span class="ident" id="2557541">nfd</span><span class="op" id="2557544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557548">nfd</span>&nbsp;<span class="op" id="2557552">=</span>&nbsp;<span class="num" id="2557554">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557560">return</span><br>
<span class="lineno"></span><span class="op" id="2557567">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2557570">func</span>&nbsp;<span class="ident" id="2557575">Getsockname</span><span class="op" id="2557586">(</span><span class="ident" id="2557587">fd</span>&nbsp;<span class="builtintype" id="2557590">int</span><span class="op" id="2557593">)</span>&nbsp;<span class="op" id="2557595">(</span><span class="ident" id="2557596">sa</span>&nbsp;<span class="ident" id="2557599">Sockaddr</span><span class="op" id="2557607">,</span>&nbsp;<span class="ident" id="2557609">err</span>&nbsp;<span class="builtintype" id="2557613">error</span><span class="op" id="2557618">)</span>&nbsp;<span class="op" id="2557620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557623">var</span>&nbsp;<span class="ident" id="2557627">rsa</span>&nbsp;<span class="ident" id="2557631">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557647">var</span>&nbsp;<span class="builtinfunc" id="2557651">len</span>&nbsp;<span class="ident" id="2557655">_Socklen</span>&nbsp;<span class="op" id="2557664">=</span>&nbsp;<span class="ident" id="2557666">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557685">if</span>&nbsp;<span class="ident" id="2557688">err</span>&nbsp;<span class="op" id="2557692">=</span>&nbsp;<span class="ident" id="2557694">getsockname</span><span class="op" id="2557705">(</span><span class="ident" id="2557706">fd</span><span class="op" id="2557708">,</span>&nbsp;<span class="op" id="2557710">&amp;</span><span class="ident" id="2557711">rsa</span><span class="op" id="2557714">,</span>&nbsp;<span class="op" id="2557716">&amp;</span><span class="builtinfunc" id="2557717">len</span><span class="op" id="2557720">)</span><span class="op" id="2557721">;</span>&nbsp;<span class="ident" id="2557723">err</span>&nbsp;<span class="op" id="2557727">!=</span>&nbsp;<span class="builtintype" id="2557730">nil</span>&nbsp;<span class="op" id="2557734">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557738">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2557746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557749">return</span>&nbsp;<span class="ident" id="2557756">anyToSockaddr</span><span class="op" id="2557769">(</span><span class="op" id="2557770">&amp;</span><span class="ident" id="2557771">rsa</span><span class="op" id="2557774">)</span><br>
<span class="lineno"></span><span class="op" id="2557776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2557779">func</span>&nbsp;<span class="ident" id="2557784">GetsockoptInet4Addr</span><span class="op" id="2557803">(</span><span class="ident" id="2557804">fd</span><span class="op" id="2557806">,</span>&nbsp;<span class="ident" id="2557808">level</span><span class="op" id="2557813">,</span>&nbsp;<span class="ident" id="2557815">opt</span>&nbsp;<span class="builtintype" id="2557819">int</span><span class="op" id="2557822">)</span>&nbsp;<span class="op" id="2557824">(</span><span class="ident" id="2557825">value</span>&nbsp;<span class="op" id="2557831">[</span><span class="num" id="2557832">4</span><span class="op" id="2557833">]</span><span class="builtintype" id="2557834">byte</span><span class="op" id="2557838">,</span>&nbsp;<span class="ident" id="2557840">err</span>&nbsp;<span class="builtintype" id="2557844">error</span><span class="op" id="2557849">)</span>&nbsp;<span class="op" id="2557851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557854">vallen</span>&nbsp;<span class="op" id="2557861">:=</span>&nbsp;<span class="ident" id="2557864">_Socklen</span><span class="op" id="2557872">(</span><span class="num" id="2557873">4</span><span class="op" id="2557874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2557877">err</span>&nbsp;<span class="op" id="2557881">=</span>&nbsp;<span class="ident" id="2557883">getsockopt</span><span class="op" id="2557893">(</span><span class="ident" id="2557894">fd</span><span class="op" id="2557896">,</span>&nbsp;<span class="ident" id="2557898">level</span><span class="op" id="2557903">,</span>&nbsp;<span class="ident" id="2557905">opt</span><span class="op" id="2557908">,</span>&nbsp;<span class="ident" id="2557910">unsafe</span><span class="op" id="2557916">.</span><span class="ident" id="2557917">Pointer</span><span class="op" id="2557924">(</span><span class="op" id="2557925">&amp;</span><span class="ident" id="2557926">value</span><span class="op" id="2557931">[</span><span class="num" id="2557932">0</span><span class="op" id="2557933">]</span><span class="op" id="2557934">)</span><span class="op" id="2557935">,</span>&nbsp;<span class="op" id="2557937">&amp;</span><span class="ident" id="2557938">vallen</span><span class="op" id="2557944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2557947">return</span>&nbsp;<span class="ident" id="2557954">value</span><span class="op" id="2557959">,</span>&nbsp;<span class="ident" id="2557961">err</span><br>
<span class="lineno"></span><span class="op" id="2557965">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2557968">func</span>&nbsp;<span class="ident" id="2557973">GetsockoptIPMreq</span><span class="op" id="2557989">(</span><span class="ident" id="2557990">fd</span><span class="op" id="2557992">,</span>&nbsp;<span class="ident" id="2557994">level</span><span class="op" id="2557999">,</span>&nbsp;<span class="ident" id="2558001">opt</span>&nbsp;<span class="builtintype" id="2558005">int</span><span class="op" id="2558008">)</span>&nbsp;<span class="op" id="2558010">(</span><span class="op" id="2558011">*</span><span class="ident" id="2558012">IPMreq</span><span class="op" id="2558018">,</span>&nbsp;<span class="builtintype" id="2558020">error</span><span class="op" id="2558025">)</span>&nbsp;<span class="op" id="2558027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558030">var</span>&nbsp;<span class="ident" id="2558034">value</span>&nbsp;<span class="ident" id="2558040">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558048">vallen</span>&nbsp;<span class="op" id="2558055">:=</span>&nbsp;<span class="ident" id="2558058">_Socklen</span><span class="op" id="2558066">(</span><span class="ident" id="2558067">SizeofIPMreq</span><span class="op" id="2558079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558082">err</span>&nbsp;<span class="op" id="2558086">:=</span>&nbsp;<span class="ident" id="2558089">getsockopt</span><span class="op" id="2558099">(</span><span class="ident" id="2558100">fd</span><span class="op" id="2558102">,</span>&nbsp;<span class="ident" id="2558104">level</span><span class="op" id="2558109">,</span>&nbsp;<span class="ident" id="2558111">opt</span><span class="op" id="2558114">,</span>&nbsp;<span class="ident" id="2558116">unsafe</span><span class="op" id="2558122">.</span><span class="ident" id="2558123">Pointer</span><span class="op" id="2558130">(</span><span class="op" id="2558131">&amp;</span><span class="ident" id="2558132">value</span><span class="op" id="2558137">)</span><span class="op" id="2558138">,</span>&nbsp;<span class="op" id="2558140">&amp;</span><span class="ident" id="2558141">vallen</span><span class="op" id="2558147">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558150">return</span>&nbsp;<span class="op" id="2558157">&amp;</span><span class="ident" id="2558158">value</span><span class="op" id="2558163">,</span>&nbsp;<span class="ident" id="2558165">err</span><br>
<span class="lineno"></span><span class="op" id="2558169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2558172">func</span>&nbsp;<span class="ident" id="2558177">GetsockoptIPMreqn</span><span class="op" id="2558194">(</span><span class="ident" id="2558195">fd</span><span class="op" id="2558197">,</span>&nbsp;<span class="ident" id="2558199">level</span><span class="op" id="2558204">,</span>&nbsp;<span class="ident" id="2558206">opt</span>&nbsp;<span class="builtintype" id="2558210">int</span><span class="op" id="2558213">)</span>&nbsp;<span class="op" id="2558215">(</span><span class="op" id="2558216">*</span><span class="ident" id="2558217">IPMreqn</span><span class="op" id="2558224">,</span>&nbsp;<span class="builtintype" id="2558226">error</span><span class="op" id="2558231">)</span>&nbsp;<span class="op" id="2558233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558236">var</span>&nbsp;<span class="ident" id="2558240">value</span>&nbsp;<span class="ident" id="2558246">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558255">vallen</span>&nbsp;<span class="op" id="2558262">:=</span>&nbsp;<span class="ident" id="2558265">_Socklen</span><span class="op" id="2558273">(</span><span class="ident" id="2558274">SizeofIPMreqn</span><span class="op" id="2558287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558290">err</span>&nbsp;<span class="op" id="2558294">:=</span>&nbsp;<span class="ident" id="2558297">getsockopt</span><span class="op" id="2558307">(</span><span class="ident" id="2558308">fd</span><span class="op" id="2558310">,</span>&nbsp;<span class="ident" id="2558312">level</span><span class="op" id="2558317">,</span>&nbsp;<span class="ident" id="2558319">opt</span><span class="op" id="2558322">,</span>&nbsp;<span class="ident" id="2558324">unsafe</span><span class="op" id="2558330">.</span><span class="ident" id="2558331">Pointer</span><span class="op" id="2558338">(</span><span class="op" id="2558339">&amp;</span><span class="ident" id="2558340">value</span><span class="op" id="2558345">)</span><span class="op" id="2558346">,</span>&nbsp;<span class="op" id="2558348">&amp;</span><span class="ident" id="2558349">vallen</span><span class="op" id="2558355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558358">return</span>&nbsp;<span class="op" id="2558365">&amp;</span><span class="ident" id="2558366">value</span><span class="op" id="2558371">,</span>&nbsp;<span class="ident" id="2558373">err</span><br>
<span class="lineno"></span><span class="op" id="2558377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2558380">func</span>&nbsp;<span class="ident" id="2558385">GetsockoptIPv6Mreq</span><span class="op" id="2558403">(</span><span class="ident" id="2558404">fd</span><span class="op" id="2558406">,</span>&nbsp;<span class="ident" id="2558408">level</span><span class="op" id="2558413">,</span>&nbsp;<span class="ident" id="2558415">opt</span>&nbsp;<span class="builtintype" id="2558419">int</span><span class="op" id="2558422">)</span>&nbsp;<span class="op" id="2558424">(</span><span class="op" id="2558425">*</span><span class="ident" id="2558426">IPv6Mreq</span><span class="op" id="2558434">,</span>&nbsp;<span class="builtintype" id="2558436">error</span><span class="op" id="2558441">)</span>&nbsp;<span class="op" id="2558443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558446">var</span>&nbsp;<span class="ident" id="2558450">value</span>&nbsp;<span class="ident" id="2558456">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558466">vallen</span>&nbsp;<span class="op" id="2558473">:=</span>&nbsp;<span class="ident" id="2558476">_Socklen</span><span class="op" id="2558484">(</span><span class="ident" id="2558485">SizeofIPv6Mreq</span><span class="op" id="2558499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558502">err</span>&nbsp;<span class="op" id="2558506">:=</span>&nbsp;<span class="ident" id="2558509">getsockopt</span><span class="op" id="2558519">(</span><span class="ident" id="2558520">fd</span><span class="op" id="2558522">,</span>&nbsp;<span class="ident" id="2558524">level</span><span class="op" id="2558529">,</span>&nbsp;<span class="ident" id="2558531">opt</span><span class="op" id="2558534">,</span>&nbsp;<span class="ident" id="2558536">unsafe</span><span class="op" id="2558542">.</span><span class="ident" id="2558543">Pointer</span><span class="op" id="2558550">(</span><span class="op" id="2558551">&amp;</span><span class="ident" id="2558552">value</span><span class="op" id="2558557">)</span><span class="op" id="2558558">,</span>&nbsp;<span class="op" id="2558560">&amp;</span><span class="ident" id="2558561">vallen</span><span class="op" id="2558567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558570">return</span>&nbsp;<span class="op" id="2558577">&amp;</span><span class="ident" id="2558578">value</span><span class="op" id="2558583">,</span>&nbsp;<span class="ident" id="2558585">err</span><br>
<span class="lineno">470</span><span class="op" id="2558589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2558592">func</span>&nbsp;<span class="ident" id="2558597">GetsockoptIPv6MTUInfo</span><span class="op" id="2558618">(</span><span class="ident" id="2558619">fd</span><span class="op" id="2558621">,</span>&nbsp;<span class="ident" id="2558623">level</span><span class="op" id="2558628">,</span>&nbsp;<span class="ident" id="2558630">opt</span>&nbsp;<span class="builtintype" id="2558634">int</span><span class="op" id="2558637">)</span>&nbsp;<span class="op" id="2558639">(</span><span class="op" id="2558640">*</span><span class="ident" id="2558641">IPv6MTUInfo</span><span class="op" id="2558652">,</span>&nbsp;<span class="builtintype" id="2558654">error</span><span class="op" id="2558659">)</span>&nbsp;<span class="op" id="2558661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558664">var</span>&nbsp;<span class="ident" id="2558668">value</span>&nbsp;<span class="ident" id="2558674">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558687">vallen</span>&nbsp;<span class="op" id="2558694">:=</span>&nbsp;<span class="ident" id="2558697">_Socklen</span><span class="op" id="2558705">(</span><span class="ident" id="2558706">SizeofIPv6MTUInfo</span><span class="op" id="2558723">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558726">err</span>&nbsp;<span class="op" id="2558730">:=</span>&nbsp;<span class="ident" id="2558733">getsockopt</span><span class="op" id="2558743">(</span><span class="ident" id="2558744">fd</span><span class="op" id="2558746">,</span>&nbsp;<span class="ident" id="2558748">level</span><span class="op" id="2558753">,</span>&nbsp;<span class="ident" id="2558755">opt</span><span class="op" id="2558758">,</span>&nbsp;<span class="ident" id="2558760">unsafe</span><span class="op" id="2558766">.</span><span class="ident" id="2558767">Pointer</span><span class="op" id="2558774">(</span><span class="op" id="2558775">&amp;</span><span class="ident" id="2558776">value</span><span class="op" id="2558781">)</span><span class="op" id="2558782">,</span>&nbsp;<span class="op" id="2558784">&amp;</span><span class="ident" id="2558785">vallen</span><span class="op" id="2558791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558794">return</span>&nbsp;<span class="op" id="2558801">&amp;</span><span class="ident" id="2558802">value</span><span class="op" id="2558807">,</span>&nbsp;<span class="ident" id="2558809">err</span><br>
<span class="lineno"></span><span class="op" id="2558813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2558816">func</span>&nbsp;<span class="ident" id="2558821">GetsockoptICMPv6Filter</span><span class="op" id="2558843">(</span><span class="ident" id="2558844">fd</span><span class="op" id="2558846">,</span>&nbsp;<span class="ident" id="2558848">level</span><span class="op" id="2558853">,</span>&nbsp;<span class="ident" id="2558855">opt</span>&nbsp;<span class="builtintype" id="2558859">int</span><span class="op" id="2558862">)</span>&nbsp;<span class="op" id="2558864">(</span><span class="op" id="2558865">*</span><span class="ident" id="2558866">ICMPv6Filter</span><span class="op" id="2558878">,</span>&nbsp;<span class="builtintype" id="2558880">error</span><span class="op" id="2558885">)</span>&nbsp;<span class="op" id="2558887">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2558890">var</span>&nbsp;<span class="ident" id="2558894">value</span>&nbsp;<span class="ident" id="2558900">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558914">vallen</span>&nbsp;<span class="op" id="2558921">:=</span>&nbsp;<span class="ident" id="2558924">_Socklen</span><span class="op" id="2558932">(</span><span class="ident" id="2558933">SizeofICMPv6Filter</span><span class="op" id="2558951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2558954">err</span>&nbsp;<span class="op" id="2558958">:=</span>&nbsp;<span class="ident" id="2558961">getsockopt</span><span class="op" id="2558971">(</span><span class="ident" id="2558972">fd</span><span class="op" id="2558974">,</span>&nbsp;<span class="ident" id="2558976">level</span><span class="op" id="2558981">,</span>&nbsp;<span class="ident" id="2558983">opt</span><span class="op" id="2558986">,</span>&nbsp;<span class="ident" id="2558988">unsafe</span><span class="op" id="2558994">.</span><span class="ident" id="2558995">Pointer</span><span class="op" id="2559002">(</span><span class="op" id="2559003">&amp;</span><span class="ident" id="2559004">value</span><span class="op" id="2559009">)</span><span class="op" id="2559010">,</span>&nbsp;<span class="op" id="2559012">&amp;</span><span class="ident" id="2559013">vallen</span><span class="op" id="2559019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559022">return</span>&nbsp;<span class="op" id="2559029">&amp;</span><span class="ident" id="2559030">value</span><span class="op" id="2559035">,</span>&nbsp;<span class="ident" id="2559037">err</span><br>
<span class="lineno"></span><span class="op" id="2559041">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2559044">func</span>&nbsp;<span class="ident" id="2559049">GetsockoptUcred</span><span class="op" id="2559064">(</span><span class="ident" id="2559065">fd</span><span class="op" id="2559067">,</span>&nbsp;<span class="ident" id="2559069">level</span><span class="op" id="2559074">,</span>&nbsp;<span class="ident" id="2559076">opt</span>&nbsp;<span class="builtintype" id="2559080">int</span><span class="op" id="2559083">)</span>&nbsp;<span class="op" id="2559085">(</span><span class="op" id="2559086">*</span><span class="ident" id="2559087">Ucred</span><span class="op" id="2559092">,</span>&nbsp;<span class="builtintype" id="2559094">error</span><span class="op" id="2559099">)</span>&nbsp;<span class="op" id="2559101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559104">var</span>&nbsp;<span class="ident" id="2559108">value</span>&nbsp;<span class="ident" id="2559114">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559121">vallen</span>&nbsp;<span class="op" id="2559128">:=</span>&nbsp;<span class="ident" id="2559131">_Socklen</span><span class="op" id="2559139">(</span><span class="ident" id="2559140">SizeofUcred</span><span class="op" id="2559151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559154">err</span>&nbsp;<span class="op" id="2559158">:=</span>&nbsp;<span class="ident" id="2559161">getsockopt</span><span class="op" id="2559171">(</span><span class="ident" id="2559172">fd</span><span class="op" id="2559174">,</span>&nbsp;<span class="ident" id="2559176">level</span><span class="op" id="2559181">,</span>&nbsp;<span class="ident" id="2559183">opt</span><span class="op" id="2559186">,</span>&nbsp;<span class="ident" id="2559188">unsafe</span><span class="op" id="2559194">.</span><span class="ident" id="2559195">Pointer</span><span class="op" id="2559202">(</span><span class="op" id="2559203">&amp;</span><span class="ident" id="2559204">value</span><span class="op" id="2559209">)</span><span class="op" id="2559210">,</span>&nbsp;<span class="op" id="2559212">&amp;</span><span class="ident" id="2559213">vallen</span><span class="op" id="2559219">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559222">return</span>&nbsp;<span class="op" id="2559229">&amp;</span><span class="ident" id="2559230">value</span><span class="op" id="2559235">,</span>&nbsp;<span class="ident" id="2559237">err</span><br>
<span class="lineno"></span><span class="op" id="2559241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2559244">func</span>&nbsp;<span class="ident" id="2559249">SetsockoptIPMreqn</span><span class="op" id="2559266">(</span><span class="ident" id="2559267">fd</span><span class="op" id="2559269">,</span>&nbsp;<span class="ident" id="2559271">level</span><span class="op" id="2559276">,</span>&nbsp;<span class="ident" id="2559278">opt</span>&nbsp;<span class="builtintype" id="2559282">int</span><span class="op" id="2559285">,</span>&nbsp;<span class="ident" id="2559287">mreq</span>&nbsp;<span class="op" id="2559292">*</span><span class="ident" id="2559293">IPMreqn</span><span class="op" id="2559300">)</span>&nbsp;<span class="op" id="2559302">(</span><span class="ident" id="2559303">err</span>&nbsp;<span class="builtintype" id="2559307">error</span><span class="op" id="2559312">)</span>&nbsp;<span class="op" id="2559314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559317">return</span>&nbsp;<span class="ident" id="2559324">setsockopt</span><span class="op" id="2559334">(</span><span class="ident" id="2559335">fd</span><span class="op" id="2559337">,</span>&nbsp;<span class="ident" id="2559339">level</span><span class="op" id="2559344">,</span>&nbsp;<span class="ident" id="2559346">opt</span><span class="op" id="2559349">,</span>&nbsp;<span class="ident" id="2559351">unsafe</span><span class="op" id="2559357">.</span><span class="ident" id="2559358">Pointer</span><span class="op" id="2559365">(</span><span class="ident" id="2559366">mreq</span><span class="op" id="2559370">)</span><span class="op" id="2559371">,</span>&nbsp;<span class="ident" id="2559373">unsafe</span><span class="op" id="2559379">.</span><span class="ident" id="2559380">Sizeof</span><span class="op" id="2559386">(</span><span class="op" id="2559387">*</span><span class="ident" id="2559388">mreq</span><span class="op" id="2559392">)</span><span class="op" id="2559393">)</span><br>
<span class="lineno">495</span><span class="op" id="2559395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2559398">func</span>&nbsp;<span class="ident" id="2559403">Recvmsg</span><span class="op" id="2559410">(</span><span class="ident" id="2559411">fd</span>&nbsp;<span class="builtintype" id="2559414">int</span><span class="op" id="2559417">,</span>&nbsp;<span class="ident" id="2559419">p</span><span class="op" id="2559420">,</span>&nbsp;<span class="ident" id="2559422">oob</span>&nbsp;<span class="op" id="2559426">[</span><span class="op" id="2559427">]</span><span class="builtintype" id="2559428">byte</span><span class="op" id="2559432">,</span>&nbsp;<span class="ident" id="2559434">flags</span>&nbsp;<span class="builtintype" id="2559440">int</span><span class="op" id="2559443">)</span>&nbsp;<span class="op" id="2559445">(</span><span class="ident" id="2559446">n</span><span class="op" id="2559447">,</span>&nbsp;<span class="ident" id="2559449">oobn</span>&nbsp;<span class="builtintype" id="2559454">int</span><span class="op" id="2559457">,</span>&nbsp;<span class="ident" id="2559459">recvflags</span>&nbsp;<span class="builtintype" id="2559469">int</span><span class="op" id="2559472">,</span>&nbsp;<span class="ident" id="2559474">from</span>&nbsp;<span class="ident" id="2559479">Sockaddr</span><span class="op" id="2559487">,</span>&nbsp;<span class="ident" id="2559489">err</span>&nbsp;<span class="builtintype" id="2559493">error</span><span class="op" id="2559498">)</span>&nbsp;<span class="op" id="2559500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559503">var</span>&nbsp;<span class="ident" id="2559507">msg</span>&nbsp;<span class="ident" id="2559511">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559519">var</span>&nbsp;<span class="ident" id="2559523">rsa</span>&nbsp;<span class="ident" id="2559527">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559543">msg</span><span class="op" id="2559546">.</span><span class="ident" id="2559547">Name</span>&nbsp;<span class="op" id="2559552">=</span>&nbsp;<span class="op" id="2559554">(</span><span class="op" id="2559555">*</span><span class="builtintype" id="2559556">byte</span><span class="op" id="2559560">)</span><span class="op" id="2559561">(</span><span class="ident" id="2559562">unsafe</span><span class="op" id="2559568">.</span><span class="ident" id="2559569">Pointer</span><span class="op" id="2559576">(</span><span class="op" id="2559577">&amp;</span><span class="ident" id="2559578">rsa</span><span class="op" id="2559581">)</span><span class="op" id="2559582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559585">msg</span><span class="op" id="2559588">.</span><span class="ident" id="2559589">Namelen</span>&nbsp;<span class="op" id="2559597">=</span>&nbsp;<span class="builtintype" id="2559599">uint32</span><span class="op" id="2559605">(</span><span class="ident" id="2559606">SizeofSockaddrAny</span><span class="op" id="2559623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559626">var</span>&nbsp;<span class="ident" id="2559630">iov</span>&nbsp;<span class="ident" id="2559634">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559641">if</span>&nbsp;<span class="builtinfunc" id="2559644">len</span><span class="op" id="2559647">(</span><span class="ident" id="2559648">p</span><span class="op" id="2559649">)</span>&nbsp;<span class="op" id="2559651">&gt;</span>&nbsp;<span class="num" id="2559653">0</span>&nbsp;<span class="op" id="2559655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559659">iov</span><span class="op" id="2559662">.</span><span class="ident" id="2559663">Base</span>&nbsp;<span class="op" id="2559668">=</span>&nbsp;<span class="op" id="2559670">(</span><span class="op" id="2559671">*</span><span class="builtintype" id="2559672">byte</span><span class="op" id="2559676">)</span><span class="op" id="2559677">(</span><span class="ident" id="2559678">unsafe</span><span class="op" id="2559684">.</span><span class="ident" id="2559685">Pointer</span><span class="op" id="2559692">(</span><span class="op" id="2559693">&amp;</span><span class="ident" id="2559694">p</span><span class="op" id="2559695">[</span><span class="num" id="2559696">0</span><span class="op" id="2559697">]</span><span class="op" id="2559698">)</span><span class="op" id="2559699">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559703">iov</span><span class="op" id="2559706">.</span><span class="ident" id="2559707">SetLen</span><span class="op" id="2559713">(</span><span class="builtinfunc" id="2559714">len</span><span class="op" id="2559717">(</span><span class="ident" id="2559718">p</span><span class="op" id="2559719">)</span><span class="op" id="2559720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2559723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559726">var</span>&nbsp;<span class="ident" id="2559730">dummy</span>&nbsp;<span class="builtintype" id="2559736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559742">if</span>&nbsp;<span class="builtinfunc" id="2559745">len</span><span class="op" id="2559748">(</span><span class="ident" id="2559749">oob</span><span class="op" id="2559752">)</span>&nbsp;<span class="op" id="2559754">&gt;</span>&nbsp;<span class="num" id="2559756">0</span>&nbsp;<span class="op" id="2559758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2559762">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559800">if</span>&nbsp;<span class="builtinfunc" id="2559803">len</span><span class="op" id="2559806">(</span><span class="ident" id="2559807">p</span><span class="op" id="2559808">)</span>&nbsp;<span class="op" id="2559810">==</span>&nbsp;<span class="num" id="2559813">0</span>&nbsp;<span class="op" id="2559815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559820">iov</span><span class="op" id="2559823">.</span><span class="ident" id="2559824">Base</span>&nbsp;<span class="op" id="2559829">=</span>&nbsp;<span class="op" id="2559831">&amp;</span><span class="ident" id="2559832">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559841">iov</span><span class="op" id="2559844">.</span><span class="ident" id="2559845">SetLen</span><span class="op" id="2559851">(</span><span class="num" id="2559852">1</span><span class="op" id="2559853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2559857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559861">msg</span><span class="op" id="2559864">.</span><span class="ident" id="2559865">Control</span>&nbsp;<span class="op" id="2559873">=</span>&nbsp;<span class="op" id="2559875">(</span><span class="op" id="2559876">*</span><span class="builtintype" id="2559877">byte</span><span class="op" id="2559881">)</span><span class="op" id="2559882">(</span><span class="ident" id="2559883">unsafe</span><span class="op" id="2559889">.</span><span class="ident" id="2559890">Pointer</span><span class="op" id="2559897">(</span><span class="op" id="2559898">&amp;</span><span class="ident" id="2559899">oob</span><span class="op" id="2559902">[</span><span class="num" id="2559903">0</span><span class="op" id="2559904">]</span><span class="op" id="2559905">)</span><span class="op" id="2559906">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559910">msg</span><span class="op" id="2559913">.</span><span class="ident" id="2559914">SetControllen</span><span class="op" id="2559927">(</span><span class="builtinfunc" id="2559928">len</span><span class="op" id="2559931">(</span><span class="ident" id="2559932">oob</span><span class="op" id="2559935">)</span><span class="op" id="2559936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2559939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559942">msg</span><span class="op" id="2559945">.</span><span class="ident" id="2559946">Iov</span>&nbsp;<span class="op" id="2559950">=</span>&nbsp;<span class="op" id="2559952">&amp;</span><span class="ident" id="2559953">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2559958">msg</span><span class="op" id="2559961">.</span><span class="ident" id="2559962">Iovlen</span>&nbsp;<span class="op" id="2559969">=</span>&nbsp;<span class="num" id="2559971">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2559974">if</span>&nbsp;<span class="ident" id="2559977">n</span><span class="op" id="2559978">,</span>&nbsp;<span class="ident" id="2559980">err</span>&nbsp;<span class="op" id="2559984">=</span>&nbsp;<span class="ident" id="2559986">recvmsg</span><span class="op" id="2559993">(</span><span class="ident" id="2559994">fd</span><span class="op" id="2559996">,</span>&nbsp;<span class="op" id="2559998">&amp;</span><span class="ident" id="2559999">msg</span><span class="op" id="2560002">,</span>&nbsp;<span class="ident" id="2560004">flags</span><span class="op" id="2560009">)</span><span class="op" id="2560010">;</span>&nbsp;<span class="ident" id="2560012">err</span>&nbsp;<span class="op" id="2560016">!=</span>&nbsp;<span class="builtintype" id="2560019">nil</span>&nbsp;<span class="op" id="2560023">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560027">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560038">oobn</span>&nbsp;<span class="op" id="2560043">=</span>&nbsp;<span class="builtintype" id="2560045">int</span><span class="op" id="2560048">(</span><span class="ident" id="2560049">msg</span><span class="op" id="2560052">.</span><span class="ident" id="2560053">Controllen</span><span class="op" id="2560063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560066">recvflags</span>&nbsp;<span class="op" id="2560076">=</span>&nbsp;<span class="builtintype" id="2560078">int</span><span class="op" id="2560081">(</span><span class="ident" id="2560082">msg</span><span class="op" id="2560085">.</span><span class="ident" id="2560086">Flags</span><span class="op" id="2560091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560094">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560160">if</span>&nbsp;<span class="ident" id="2560163">rsa</span><span class="op" id="2560166">.</span><span class="ident" id="2560167">Addr</span><span class="op" id="2560171">.</span><span class="ident" id="2560172">Family</span>&nbsp;<span class="op" id="2560179">!=</span>&nbsp;<span class="ident" id="2560182">AF_UNSPEC</span>&nbsp;<span class="op" id="2560192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560196">from</span><span class="op" id="2560200">,</span>&nbsp;<span class="ident" id="2560202">err</span>&nbsp;<span class="op" id="2560206">=</span>&nbsp;<span class="ident" id="2560208">anyToSockaddr</span><span class="op" id="2560221">(</span><span class="op" id="2560222">&amp;</span><span class="ident" id="2560223">rsa</span><span class="op" id="2560226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560232">return</span><br>
<span class="lineno"></span><span class="op" id="2560239">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2560242">func</span>&nbsp;<span class="ident" id="2560247">Sendmsg</span><span class="op" id="2560254">(</span><span class="ident" id="2560255">fd</span>&nbsp;<span class="builtintype" id="2560258">int</span><span class="op" id="2560261">,</span>&nbsp;<span class="ident" id="2560263">p</span><span class="op" id="2560264">,</span>&nbsp;<span class="ident" id="2560266">oob</span>&nbsp;<span class="op" id="2560270">[</span><span class="op" id="2560271">]</span><span class="builtintype" id="2560272">byte</span><span class="op" id="2560276">,</span>&nbsp;<span class="ident" id="2560278">to</span>&nbsp;<span class="ident" id="2560281">Sockaddr</span><span class="op" id="2560289">,</span>&nbsp;<span class="ident" id="2560291">flags</span>&nbsp;<span class="builtintype" id="2560297">int</span><span class="op" id="2560300">)</span>&nbsp;<span class="op" id="2560302">(</span><span class="ident" id="2560303">err</span>&nbsp;<span class="builtintype" id="2560307">error</span><span class="op" id="2560312">)</span>&nbsp;<span class="op" id="2560314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560317">_</span><span class="op" id="2560318">,</span>&nbsp;<span class="ident" id="2560320">err</span>&nbsp;<span class="op" id="2560324">=</span>&nbsp;<span class="ident" id="2560326">SendmsgN</span><span class="op" id="2560334">(</span><span class="ident" id="2560335">fd</span><span class="op" id="2560337">,</span>&nbsp;<span class="ident" id="2560339">p</span><span class="op" id="2560340">,</span>&nbsp;<span class="ident" id="2560342">oob</span><span class="op" id="2560345">,</span>&nbsp;<span class="ident" id="2560347">to</span><span class="op" id="2560349">,</span>&nbsp;<span class="ident" id="2560351">flags</span><span class="op" id="2560356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560359">return</span><br>
<span class="lineno"></span><span class="op" id="2560366">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2560369">func</span>&nbsp;<span class="ident" id="2560374">SendmsgN</span><span class="op" id="2560382">(</span><span class="ident" id="2560383">fd</span>&nbsp;<span class="builtintype" id="2560386">int</span><span class="op" id="2560389">,</span>&nbsp;<span class="ident" id="2560391">p</span><span class="op" id="2560392">,</span>&nbsp;<span class="ident" id="2560394">oob</span>&nbsp;<span class="op" id="2560398">[</span><span class="op" id="2560399">]</span><span class="builtintype" id="2560400">byte</span><span class="op" id="2560404">,</span>&nbsp;<span class="ident" id="2560406">to</span>&nbsp;<span class="ident" id="2560409">Sockaddr</span><span class="op" id="2560417">,</span>&nbsp;<span class="ident" id="2560419">flags</span>&nbsp;<span class="builtintype" id="2560425">int</span><span class="op" id="2560428">)</span>&nbsp;<span class="op" id="2560430">(</span><span class="ident" id="2560431">n</span>&nbsp;<span class="builtintype" id="2560433">int</span><span class="op" id="2560436">,</span>&nbsp;<span class="ident" id="2560438">err</span>&nbsp;<span class="builtintype" id="2560442">error</span><span class="op" id="2560447">)</span>&nbsp;<span class="op" id="2560449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560452">var</span>&nbsp;<span class="ident" id="2560456">ptr</span>&nbsp;<span class="ident" id="2560460">unsafe</span><span class="op" id="2560466">.</span><span class="ident" id="2560467">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560476">var</span>&nbsp;<span class="ident" id="2560480">salen</span>&nbsp;<span class="ident" id="2560486">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560496">if</span>&nbsp;<span class="ident" id="2560499">to</span>&nbsp;<span class="op" id="2560502">!=</span>&nbsp;<span class="builtintype" id="2560505">nil</span>&nbsp;<span class="op" id="2560509">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560513">var</span>&nbsp;<span class="ident" id="2560517">err</span>&nbsp;<span class="builtintype" id="2560521">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560529">ptr</span><span class="op" id="2560532">,</span>&nbsp;<span class="ident" id="2560534">salen</span><span class="op" id="2560539">,</span>&nbsp;<span class="ident" id="2560541">err</span>&nbsp;<span class="op" id="2560545">=</span>&nbsp;<span class="ident" id="2560547">to</span><span class="op" id="2560549">.</span><span class="ident" id="2560550">sockaddr</span><span class="op" id="2560558">(</span><span class="op" id="2560559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560563">if</span>&nbsp;<span class="ident" id="2560566">err</span>&nbsp;<span class="op" id="2560570">!=</span>&nbsp;<span class="builtintype" id="2560573">nil</span>&nbsp;<span class="op" id="2560577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560582">return</span>&nbsp;<span class="num" id="2560589">0</span><span class="op" id="2560590">,</span>&nbsp;<span class="ident" id="2560592">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560598">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560604">var</span>&nbsp;<span class="ident" id="2560608">msg</span>&nbsp;<span class="ident" id="2560612">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560620">msg</span><span class="op" id="2560623">.</span><span class="ident" id="2560624">Name</span>&nbsp;<span class="op" id="2560629">=</span>&nbsp;<span class="op" id="2560631">(</span><span class="op" id="2560632">*</span><span class="builtintype" id="2560633">byte</span><span class="op" id="2560637">)</span><span class="op" id="2560638">(</span><span class="ident" id="2560639">unsafe</span><span class="op" id="2560645">.</span><span class="ident" id="2560646">Pointer</span><span class="op" id="2560653">(</span><span class="ident" id="2560654">ptr</span><span class="op" id="2560657">)</span><span class="op" id="2560658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560661">msg</span><span class="op" id="2560664">.</span><span class="ident" id="2560665">Namelen</span>&nbsp;<span class="op" id="2560673">=</span>&nbsp;<span class="builtintype" id="2560675">uint32</span><span class="op" id="2560681">(</span><span class="ident" id="2560682">salen</span><span class="op" id="2560687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560690">var</span>&nbsp;<span class="ident" id="2560694">iov</span>&nbsp;<span class="ident" id="2560698">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560705">if</span>&nbsp;<span class="builtinfunc" id="2560708">len</span><span class="op" id="2560711">(</span><span class="ident" id="2560712">p</span><span class="op" id="2560713">)</span>&nbsp;<span class="op" id="2560715">&gt;</span>&nbsp;<span class="num" id="2560717">0</span>&nbsp;<span class="op" id="2560719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560723">iov</span><span class="op" id="2560726">.</span><span class="ident" id="2560727">Base</span>&nbsp;<span class="op" id="2560732">=</span>&nbsp;<span class="op" id="2560734">(</span><span class="op" id="2560735">*</span><span class="builtintype" id="2560736">byte</span><span class="op" id="2560740">)</span><span class="op" id="2560741">(</span><span class="ident" id="2560742">unsafe</span><span class="op" id="2560748">.</span><span class="ident" id="2560749">Pointer</span><span class="op" id="2560756">(</span><span class="op" id="2560757">&amp;</span><span class="ident" id="2560758">p</span><span class="op" id="2560759">[</span><span class="num" id="2560760">0</span><span class="op" id="2560761">]</span><span class="op" id="2560762">)</span><span class="op" id="2560763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560767">iov</span><span class="op" id="2560770">.</span><span class="ident" id="2560771">SetLen</span><span class="op" id="2560777">(</span><span class="builtinfunc" id="2560778">len</span><span class="op" id="2560781">(</span><span class="ident" id="2560782">p</span><span class="op" id="2560783">)</span><span class="op" id="2560784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560790">var</span>&nbsp;<span class="ident" id="2560794">dummy</span>&nbsp;<span class="builtintype" id="2560800">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560806">if</span>&nbsp;<span class="builtinfunc" id="2560809">len</span><span class="op" id="2560812">(</span><span class="ident" id="2560813">oob</span><span class="op" id="2560816">)</span>&nbsp;<span class="op" id="2560818">&gt;</span>&nbsp;<span class="num" id="2560820">0</span>&nbsp;<span class="op" id="2560822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560826">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2560861">if</span>&nbsp;<span class="builtinfunc" id="2560864">len</span><span class="op" id="2560867">(</span><span class="ident" id="2560868">p</span><span class="op" id="2560869">)</span>&nbsp;<span class="op" id="2560871">==</span>&nbsp;<span class="num" id="2560874">0</span>&nbsp;<span class="op" id="2560876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560881">iov</span><span class="op" id="2560884">.</span><span class="ident" id="2560885">Base</span>&nbsp;<span class="op" id="2560890">=</span>&nbsp;<span class="op" id="2560892">&amp;</span><span class="ident" id="2560893">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560902">iov</span><span class="op" id="2560905">.</span><span class="ident" id="2560906">SetLen</span><span class="op" id="2560912">(</span><span class="num" id="2560913">1</span><span class="op" id="2560914">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560922">msg</span><span class="op" id="2560925">.</span><span class="ident" id="2560926">Control</span>&nbsp;<span class="op" id="2560934">=</span>&nbsp;<span class="op" id="2560936">(</span><span class="op" id="2560937">*</span><span class="builtintype" id="2560938">byte</span><span class="op" id="2560942">)</span><span class="op" id="2560943">(</span><span class="ident" id="2560944">unsafe</span><span class="op" id="2560950">.</span><span class="ident" id="2560951">Pointer</span><span class="op" id="2560958">(</span><span class="op" id="2560959">&amp;</span><span class="ident" id="2560960">oob</span><span class="op" id="2560963">[</span><span class="num" id="2560964">0</span><span class="op" id="2560965">]</span><span class="op" id="2560966">)</span><span class="op" id="2560967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2560971">msg</span><span class="op" id="2560974">.</span><span class="ident" id="2560975">SetControllen</span><span class="op" id="2560988">(</span><span class="builtinfunc" id="2560989">len</span><span class="op" id="2560992">(</span><span class="ident" id="2560993">oob</span><span class="op" id="2560996">)</span><span class="op" id="2560997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2561003">msg</span><span class="op" id="2561006">.</span><span class="ident" id="2561007">Iov</span>&nbsp;<span class="op" id="2561011">=</span>&nbsp;<span class="op" id="2561013">&amp;</span><span class="ident" id="2561014">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2561019">msg</span><span class="op" id="2561022">.</span><span class="ident" id="2561023">Iovlen</span>&nbsp;<span class="op" id="2561030">=</span>&nbsp;<span class="num" id="2561032">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561035">if</span>&nbsp;<span class="ident" id="2561038">n</span><span class="op" id="2561039">,</span>&nbsp;<span class="ident" id="2561041">err</span>&nbsp;<span class="op" id="2561045">=</span>&nbsp;<span class="ident" id="2561047">sendmsg</span><span class="op" id="2561054">(</span><span class="ident" id="2561055">fd</span><span class="op" id="2561057">,</span>&nbsp;<span class="op" id="2561059">&amp;</span><span class="ident" id="2561060">msg</span><span class="op" id="2561063">,</span>&nbsp;<span class="ident" id="2561065">flags</span><span class="op" id="2561070">)</span><span class="op" id="2561071">;</span>&nbsp;<span class="ident" id="2561073">err</span>&nbsp;<span class="op" id="2561077">!=</span>&nbsp;<span class="builtintype" id="2561080">nil</span>&nbsp;<span class="op" id="2561084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561088">return</span>&nbsp;<span class="num" id="2561095">0</span><span class="op" id="2561096">,</span>&nbsp;<span class="ident" id="2561098">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561106">if</span>&nbsp;<span class="builtinfunc" id="2561109">len</span><span class="op" id="2561112">(</span><span class="ident" id="2561113">oob</span><span class="op" id="2561116">)</span>&nbsp;<span class="op" id="2561118">&gt;</span>&nbsp;<span class="num" id="2561120">0</span>&nbsp;<span class="op" id="2561122">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2561125">len</span><span class="op" id="2561128">(</span><span class="ident" id="2561129">p</span><span class="op" id="2561130">)</span>&nbsp;<span class="op" id="2561132">==</span>&nbsp;<span class="num" id="2561135">0</span>&nbsp;<span class="op" id="2561137">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2561141">n</span>&nbsp;<span class="op" id="2561143">=</span>&nbsp;<span class="num" id="2561145">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561151">return</span>&nbsp;<span class="ident" id="2561158">n</span><span class="op" id="2561159">,</span>&nbsp;<span class="builtintype" id="2561161">nil</span><br>
<span class="lineno"></span><span class="op" id="2561165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2561168">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2561231">func</span>&nbsp;<span class="ident" id="2561236">BindToDevice</span><span class="op" id="2561248">(</span><span class="ident" id="2561249">fd</span>&nbsp;<span class="builtintype" id="2561252">int</span><span class="op" id="2561255">,</span>&nbsp;<span class="ident" id="2561257">device</span>&nbsp;<span class="builtintype" id="2561264">string</span><span class="op" id="2561270">)</span>&nbsp;<span class="op" id="2561272">(</span><span class="ident" id="2561273">err</span>&nbsp;<span class="builtintype" id="2561277">error</span><span class="op" id="2561282">)</span>&nbsp;<span class="op" id="2561284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561287">return</span>&nbsp;<span class="ident" id="2561294">SetsockoptString</span><span class="op" id="2561310">(</span><span class="ident" id="2561311">fd</span><span class="op" id="2561313">,</span>&nbsp;<span class="ident" id="2561315">SOL_SOCKET</span><span class="op" id="2561325">,</span>&nbsp;<span class="ident" id="2561327">SO_BINDTODEVICE</span><span class="op" id="2561342">,</span>&nbsp;<span class="ident" id="2561344">device</span><span class="op" id="2561350">)</span><br>
<span class="lineno"></span><span class="op" id="2561352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2561355">//sys&nbsp;&nbsp;&nbsp;&nbsp;ptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561431">func</span>&nbsp;<span class="ident" id="2561436">ptracePeek</span><span class="op" id="2561446">(</span><span class="ident" id="2561447">req</span>&nbsp;<span class="builtintype" id="2561451">int</span><span class="op" id="2561454">,</span>&nbsp;<span class="ident" id="2561456">pid</span>&nbsp;<span class="builtintype" id="2561460">int</span><span class="op" id="2561463">,</span>&nbsp;<span class="ident" id="2561465">addr</span>&nbsp;<span class="builtintype" id="2561470">uintptr</span><span class="op" id="2561477">,</span>&nbsp;<span class="ident" id="2561479">out</span>&nbsp;<span class="op" id="2561483">[</span><span class="op" id="2561484">]</span><span class="builtintype" id="2561485">byte</span><span class="op" id="2561489">)</span>&nbsp;<span class="op" id="2561491">(</span><span class="ident" id="2561492">count</span>&nbsp;<span class="builtintype" id="2561498">int</span><span class="op" id="2561501">,</span>&nbsp;<span class="ident" id="2561503">err</span>&nbsp;<span class="builtintype" id="2561507">error</span><span class="op" id="2561512">)</span>&nbsp;<span class="op" id="2561514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561517">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561580">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561620">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561672">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2561735">var</span>&nbsp;<span class="ident" id="2561739">buf</span>&nbsp;<span class="op" id="2561743">[</span><span class="ident" id="2561744">sizeofPtr</span><span class="op" id="2561753">]</span><span class="builtintype" id="2561754">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561761">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561820">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561879">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561935">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561993">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562007">n</span>&nbsp;<span class="op" id="2562009">:=</span>&nbsp;<span class="num" id="2562012">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562015">if</span>&nbsp;<span class="ident" id="2562018">addr</span><span class="op" id="2562022">%</span><span class="ident" id="2562023">sizeofPtr</span>&nbsp;<span class="op" id="2562033">!=</span>&nbsp;<span class="num" id="2562036">0</span>&nbsp;<span class="op" id="2562038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562042">err</span>&nbsp;<span class="op" id="2562046">=</span>&nbsp;<span class="ident" id="2562048">ptrace</span><span class="op" id="2562054">(</span><span class="ident" id="2562055">req</span><span class="op" id="2562058">,</span>&nbsp;<span class="ident" id="2562060">pid</span><span class="op" id="2562063">,</span>&nbsp;<span class="ident" id="2562065">addr</span><span class="op" id="2562069">-</span><span class="ident" id="2562070">addr</span><span class="op" id="2562074">%</span><span class="ident" id="2562075">sizeofPtr</span><span class="op" id="2562084">,</span>&nbsp;<span class="builtintype" id="2562086">uintptr</span><span class="op" id="2562093">(</span><span class="ident" id="2562094">unsafe</span><span class="op" id="2562100">.</span><span class="ident" id="2562101">Pointer</span><span class="op" id="2562108">(</span><span class="op" id="2562109">&amp;</span><span class="ident" id="2562110">buf</span><span class="op" id="2562113">[</span><span class="num" id="2562114">0</span><span class="op" id="2562115">]</span><span class="op" id="2562116">)</span><span class="op" id="2562117">)</span><span class="op" id="2562118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562122">if</span>&nbsp;<span class="ident" id="2562125">err</span>&nbsp;<span class="op" id="2562129">!=</span>&nbsp;<span class="builtintype" id="2562132">nil</span>&nbsp;<span class="op" id="2562136">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562141">return</span>&nbsp;<span class="num" id="2562148">0</span><span class="op" id="2562149">,</span>&nbsp;<span class="ident" id="2562151">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562161">n</span>&nbsp;<span class="op" id="2562163">+=</span>&nbsp;<span class="builtinfunc" id="2562166">copy</span><span class="op" id="2562170">(</span><span class="ident" id="2562171">out</span><span class="op" id="2562174">,</span>&nbsp;<span class="ident" id="2562176">buf</span><span class="op" id="2562179">[</span><span class="ident" id="2562180">addr</span><span class="op" id="2562184">%</span><span class="ident" id="2562185">sizeofPtr</span><span class="op" id="2562194">:</span><span class="op" id="2562195">]</span><span class="op" id="2562196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562200">out</span>&nbsp;<span class="op" id="2562204">=</span>&nbsp;<span class="ident" id="2562206">out</span><span class="op" id="2562209">[</span><span class="ident" id="2562210">n</span><span class="op" id="2562211">:</span><span class="op" id="2562212">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562215">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562219">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562234">for</span>&nbsp;<span class="builtinfunc" id="2562238">len</span><span class="op" id="2562241">(</span><span class="ident" id="2562242">out</span><span class="op" id="2562245">)</span>&nbsp;<span class="op" id="2562247">&gt;</span>&nbsp;<span class="num" id="2562249">0</span>&nbsp;<span class="op" id="2562251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562255">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562310">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562377">err</span>&nbsp;<span class="op" id="2562381">=</span>&nbsp;<span class="ident" id="2562383">ptrace</span><span class="op" id="2562389">(</span><span class="ident" id="2562390">req</span><span class="op" id="2562393">,</span>&nbsp;<span class="ident" id="2562395">pid</span><span class="op" id="2562398">,</span>&nbsp;<span class="ident" id="2562400">addr</span><span class="op" id="2562404">+</span><span class="builtintype" id="2562405">uintptr</span><span class="op" id="2562412">(</span><span class="ident" id="2562413">n</span><span class="op" id="2562414">)</span><span class="op" id="2562415">,</span>&nbsp;<span class="builtintype" id="2562417">uintptr</span><span class="op" id="2562424">(</span><span class="ident" id="2562425">unsafe</span><span class="op" id="2562431">.</span><span class="ident" id="2562432">Pointer</span><span class="op" id="2562439">(</span><span class="op" id="2562440">&amp;</span><span class="ident" id="2562441">buf</span><span class="op" id="2562444">[</span><span class="num" id="2562445">0</span><span class="op" id="2562446">]</span><span class="op" id="2562447">)</span><span class="op" id="2562448">)</span><span class="op" id="2562449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562453">if</span>&nbsp;<span class="ident" id="2562456">err</span>&nbsp;<span class="op" id="2562460">!=</span>&nbsp;<span class="builtintype" id="2562463">nil</span>&nbsp;<span class="op" id="2562467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562472">return</span>&nbsp;<span class="ident" id="2562479">n</span><span class="op" id="2562480">,</span>&nbsp;<span class="ident" id="2562482">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562492">copied</span>&nbsp;<span class="op" id="2562499">:=</span>&nbsp;<span class="builtinfunc" id="2562502">copy</span><span class="op" id="2562506">(</span><span class="ident" id="2562507">out</span><span class="op" id="2562510">,</span>&nbsp;<span class="ident" id="2562512">buf</span><span class="op" id="2562515">[</span><span class="num" id="2562516">0</span><span class="op" id="2562517">:</span><span class="op" id="2562518">]</span><span class="op" id="2562519">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562523">n</span>&nbsp;<span class="op" id="2562525">+=</span>&nbsp;<span class="ident" id="2562528">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562537">out</span>&nbsp;<span class="op" id="2562541">=</span>&nbsp;<span class="ident" id="2562543">out</span><span class="op" id="2562546">[</span><span class="ident" id="2562547">copied</span><span class="op" id="2562553">:</span><span class="op" id="2562554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562561">return</span>&nbsp;<span class="ident" id="2562568">n</span><span class="op" id="2562569">,</span>&nbsp;<span class="builtintype" id="2562571">nil</span><br>
<span class="lineno">620</span><span class="op" id="2562575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2562578">func</span>&nbsp;<span class="ident" id="2562583">PtracePeekText</span><span class="op" id="2562597">(</span><span class="ident" id="2562598">pid</span>&nbsp;<span class="builtintype" id="2562602">int</span><span class="op" id="2562605">,</span>&nbsp;<span class="ident" id="2562607">addr</span>&nbsp;<span class="builtintype" id="2562612">uintptr</span><span class="op" id="2562619">,</span>&nbsp;<span class="ident" id="2562621">out</span>&nbsp;<span class="op" id="2562625">[</span><span class="op" id="2562626">]</span><span class="builtintype" id="2562627">byte</span><span class="op" id="2562631">)</span>&nbsp;<span class="op" id="2562633">(</span><span class="ident" id="2562634">count</span>&nbsp;<span class="builtintype" id="2562640">int</span><span class="op" id="2562643">,</span>&nbsp;<span class="ident" id="2562645">err</span>&nbsp;<span class="builtintype" id="2562649">error</span><span class="op" id="2562654">)</span>&nbsp;<span class="op" id="2562656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562659">return</span>&nbsp;<span class="ident" id="2562666">ptracePeek</span><span class="op" id="2562676">(</span><span class="ident" id="2562677">PTRACE_PEEKTEXT</span><span class="op" id="2562692">,</span>&nbsp;<span class="ident" id="2562694">pid</span><span class="op" id="2562697">,</span>&nbsp;<span class="ident" id="2562699">addr</span><span class="op" id="2562703">,</span>&nbsp;<span class="ident" id="2562705">out</span><span class="op" id="2562708">)</span><br>
<span class="lineno"></span><span class="op" id="2562710">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2562713">func</span>&nbsp;<span class="ident" id="2562718">PtracePeekData</span><span class="op" id="2562732">(</span><span class="ident" id="2562733">pid</span>&nbsp;<span class="builtintype" id="2562737">int</span><span class="op" id="2562740">,</span>&nbsp;<span class="ident" id="2562742">addr</span>&nbsp;<span class="builtintype" id="2562747">uintptr</span><span class="op" id="2562754">,</span>&nbsp;<span class="ident" id="2562756">out</span>&nbsp;<span class="op" id="2562760">[</span><span class="op" id="2562761">]</span><span class="builtintype" id="2562762">byte</span><span class="op" id="2562766">)</span>&nbsp;<span class="op" id="2562768">(</span><span class="ident" id="2562769">count</span>&nbsp;<span class="builtintype" id="2562775">int</span><span class="op" id="2562778">,</span>&nbsp;<span class="ident" id="2562780">err</span>&nbsp;<span class="builtintype" id="2562784">error</span><span class="op" id="2562789">)</span>&nbsp;<span class="op" id="2562791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2562794">return</span>&nbsp;<span class="ident" id="2562801">ptracePeek</span><span class="op" id="2562811">(</span><span class="ident" id="2562812">PTRACE_PEEKDATA</span><span class="op" id="2562827">,</span>&nbsp;<span class="ident" id="2562829">pid</span><span class="op" id="2562832">,</span>&nbsp;<span class="ident" id="2562834">addr</span><span class="op" id="2562838">,</span>&nbsp;<span class="ident" id="2562840">out</span><span class="op" id="2562843">)</span><br>
<span class="lineno"></span><span class="op" id="2562845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2562848">func</span>&nbsp;<span class="ident" id="2562853">ptracePoke</span><span class="op" id="2562863">(</span><span class="ident" id="2562864">pokeReq</span>&nbsp;<span class="builtintype" id="2562872">int</span><span class="op" id="2562875">,</span>&nbsp;<span class="ident" id="2562877">peekReq</span>&nbsp;<span class="builtintype" id="2562885">int</span><span class="op" id="2562888">,</span>&nbsp;<span class="ident" id="2562890">pid</span>&nbsp;<span class="builtintype" id="2562894">int</span><span class="op" id="2562897">,</span>&nbsp;<span class="ident" id="2562899">addr</span>&nbsp;<span class="builtintype" id="2562904">uintptr</span><span class="op" id="2562911">,</span>&nbsp;<span class="ident" id="2562913">data</span>&nbsp;<span class="op" id="2562918">[</span><span class="op" id="2562919">]</span><span class="builtintype" id="2562920">byte</span><span class="op" id="2562924">)</span>&nbsp;<span class="op" id="2562926">(</span><span class="ident" id="2562927">count</span>&nbsp;<span class="builtintype" id="2562933">int</span><span class="op" id="2562936">,</span>&nbsp;<span class="ident" id="2562938">err</span>&nbsp;<span class="builtintype" id="2562942">error</span><span class="op" id="2562947">)</span>&nbsp;<span class="op" id="2562949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562952">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2563013">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2563070">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563088">n</span>&nbsp;<span class="op" id="2563090">:=</span>&nbsp;<span class="num" id="2563093">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563096">if</span>&nbsp;<span class="ident" id="2563099">addr</span><span class="op" id="2563103">%</span><span class="ident" id="2563104">sizeofPtr</span>&nbsp;<span class="op" id="2563114">!=</span>&nbsp;<span class="num" id="2563117">0</span>&nbsp;<span class="op" id="2563119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563123">var</span>&nbsp;<span class="ident" id="2563127">buf</span>&nbsp;<span class="op" id="2563131">[</span><span class="ident" id="2563132">sizeofPtr</span><span class="op" id="2563141">]</span><span class="builtintype" id="2563142">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563149">err</span>&nbsp;<span class="op" id="2563153">=</span>&nbsp;<span class="ident" id="2563155">ptrace</span><span class="op" id="2563161">(</span><span class="ident" id="2563162">peekReq</span><span class="op" id="2563169">,</span>&nbsp;<span class="ident" id="2563171">pid</span><span class="op" id="2563174">,</span>&nbsp;<span class="ident" id="2563176">addr</span><span class="op" id="2563180">-</span><span class="ident" id="2563181">addr</span><span class="op" id="2563185">%</span><span class="ident" id="2563186">sizeofPtr</span><span class="op" id="2563195">,</span>&nbsp;<span class="builtintype" id="2563197">uintptr</span><span class="op" id="2563204">(</span><span class="ident" id="2563205">unsafe</span><span class="op" id="2563211">.</span><span class="ident" id="2563212">Pointer</span><span class="op" id="2563219">(</span><span class="op" id="2563220">&amp;</span><span class="ident" id="2563221">buf</span><span class="op" id="2563224">[</span><span class="num" id="2563225">0</span><span class="op" id="2563226">]</span><span class="op" id="2563227">)</span><span class="op" id="2563228">)</span><span class="op" id="2563229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563233">if</span>&nbsp;<span class="ident" id="2563236">err</span>&nbsp;<span class="op" id="2563240">!=</span>&nbsp;<span class="builtintype" id="2563243">nil</span>&nbsp;<span class="op" id="2563247">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563252">return</span>&nbsp;<span class="num" id="2563259">0</span><span class="op" id="2563260">,</span>&nbsp;<span class="ident" id="2563262">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563272">n</span>&nbsp;<span class="op" id="2563274">+=</span>&nbsp;<span class="builtinfunc" id="2563277">copy</span><span class="op" id="2563281">(</span><span class="ident" id="2563282">buf</span><span class="op" id="2563285">[</span><span class="ident" id="2563286">addr</span><span class="op" id="2563290">%</span><span class="ident" id="2563291">sizeofPtr</span><span class="op" id="2563300">:</span><span class="op" id="2563301">]</span><span class="op" id="2563302">,</span>&nbsp;<span class="ident" id="2563304">data</span><span class="op" id="2563308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563312">word</span>&nbsp;<span class="op" id="2563317">:=</span>&nbsp;<span class="op" id="2563320">*</span><span class="op" id="2563321">(</span><span class="op" id="2563322">(</span><span class="op" id="2563323">*</span><span class="builtintype" id="2563324">uintptr</span><span class="op" id="2563331">)</span><span class="op" id="2563332">(</span><span class="ident" id="2563333">unsafe</span><span class="op" id="2563339">.</span><span class="ident" id="2563340">Pointer</span><span class="op" id="2563347">(</span><span class="op" id="2563348">&amp;</span><span class="ident" id="2563349">buf</span><span class="op" id="2563352">[</span><span class="num" id="2563353">0</span><span class="op" id="2563354">]</span><span class="op" id="2563355">)</span><span class="op" id="2563356">)</span><span class="op" id="2563357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563361">err</span>&nbsp;<span class="op" id="2563365">=</span>&nbsp;<span class="ident" id="2563367">ptrace</span><span class="op" id="2563373">(</span><span class="ident" id="2563374">pokeReq</span><span class="op" id="2563381">,</span>&nbsp;<span class="ident" id="2563383">pid</span><span class="op" id="2563386">,</span>&nbsp;<span class="ident" id="2563388">addr</span><span class="op" id="2563392">-</span><span class="ident" id="2563393">addr</span><span class="op" id="2563397">%</span><span class="ident" id="2563398">sizeofPtr</span><span class="op" id="2563407">,</span>&nbsp;<span class="ident" id="2563409">word</span><span class="op" id="2563413">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563417">if</span>&nbsp;<span class="ident" id="2563420">err</span>&nbsp;<span class="op" id="2563424">!=</span>&nbsp;<span class="builtintype" id="2563427">nil</span>&nbsp;<span class="op" id="2563431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563436">return</span>&nbsp;<span class="num" id="2563443">0</span><span class="op" id="2563444">,</span>&nbsp;<span class="ident" id="2563446">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563456">data</span>&nbsp;<span class="op" id="2563461">=</span>&nbsp;<span class="ident" id="2563463">data</span><span class="op" id="2563467">[</span><span class="ident" id="2563468">n</span><span class="op" id="2563469">:</span><span class="op" id="2563470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563473">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2563477">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563491">for</span>&nbsp;<span class="builtinfunc" id="2563495">len</span><span class="op" id="2563498">(</span><span class="ident" id="2563499">data</span><span class="op" id="2563503">)</span>&nbsp;<span class="op" id="2563505">&gt;</span>&nbsp;<span class="ident" id="2563507">sizeofPtr</span>&nbsp;<span class="op" id="2563517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563521">word</span>&nbsp;<span class="op" id="2563526">:=</span>&nbsp;<span class="op" id="2563529">*</span><span class="op" id="2563530">(</span><span class="op" id="2563531">(</span><span class="op" id="2563532">*</span><span class="builtintype" id="2563533">uintptr</span><span class="op" id="2563540">)</span><span class="op" id="2563541">(</span><span class="ident" id="2563542">unsafe</span><span class="op" id="2563548">.</span><span class="ident" id="2563549">Pointer</span><span class="op" id="2563556">(</span><span class="op" id="2563557">&amp;</span><span class="ident" id="2563558">data</span><span class="op" id="2563562">[</span><span class="num" id="2563563">0</span><span class="op" id="2563564">]</span><span class="op" id="2563565">)</span><span class="op" id="2563566">)</span><span class="op" id="2563567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563571">err</span>&nbsp;<span class="op" id="2563575">=</span>&nbsp;<span class="ident" id="2563577">ptrace</span><span class="op" id="2563583">(</span><span class="ident" id="2563584">pokeReq</span><span class="op" id="2563591">,</span>&nbsp;<span class="ident" id="2563593">pid</span><span class="op" id="2563596">,</span>&nbsp;<span class="ident" id="2563598">addr</span><span class="op" id="2563602">+</span><span class="builtintype" id="2563603">uintptr</span><span class="op" id="2563610">(</span><span class="ident" id="2563611">n</span><span class="op" id="2563612">)</span><span class="op" id="2563613">,</span>&nbsp;<span class="ident" id="2563615">word</span><span class="op" id="2563619">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563623">if</span>&nbsp;<span class="ident" id="2563626">err</span>&nbsp;<span class="op" id="2563630">!=</span>&nbsp;<span class="builtintype" id="2563633">nil</span>&nbsp;<span class="op" id="2563637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563642">return</span>&nbsp;<span class="ident" id="2563649">n</span><span class="op" id="2563650">,</span>&nbsp;<span class="ident" id="2563652">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563662">n</span>&nbsp;<span class="op" id="2563664">+=</span>&nbsp;<span class="ident" id="2563667">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563679">data</span>&nbsp;<span class="op" id="2563684">=</span>&nbsp;<span class="ident" id="2563686">data</span><span class="op" id="2563690">[</span><span class="ident" id="2563691">sizeofPtr</span><span class="op" id="2563700">:</span><span class="op" id="2563701">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2563708">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563727">if</span>&nbsp;<span class="builtinfunc" id="2563730">len</span><span class="op" id="2563733">(</span><span class="ident" id="2563734">data</span><span class="op" id="2563738">)</span>&nbsp;<span class="op" id="2563740">&gt;</span>&nbsp;<span class="num" id="2563742">0</span>&nbsp;<span class="op" id="2563744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563748">var</span>&nbsp;<span class="ident" id="2563752">buf</span>&nbsp;<span class="op" id="2563756">[</span><span class="ident" id="2563757">sizeofPtr</span><span class="op" id="2563766">]</span><span class="builtintype" id="2563767">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563774">err</span>&nbsp;<span class="op" id="2563778">=</span>&nbsp;<span class="ident" id="2563780">ptrace</span><span class="op" id="2563786">(</span><span class="ident" id="2563787">peekReq</span><span class="op" id="2563794">,</span>&nbsp;<span class="ident" id="2563796">pid</span><span class="op" id="2563799">,</span>&nbsp;<span class="ident" id="2563801">addr</span><span class="op" id="2563805">+</span><span class="builtintype" id="2563806">uintptr</span><span class="op" id="2563813">(</span><span class="ident" id="2563814">n</span><span class="op" id="2563815">)</span><span class="op" id="2563816">,</span>&nbsp;<span class="builtintype" id="2563818">uintptr</span><span class="op" id="2563825">(</span><span class="ident" id="2563826">unsafe</span><span class="op" id="2563832">.</span><span class="ident" id="2563833">Pointer</span><span class="op" id="2563840">(</span><span class="op" id="2563841">&amp;</span><span class="ident" id="2563842">buf</span><span class="op" id="2563845">[</span><span class="num" id="2563846">0</span><span class="op" id="2563847">]</span><span class="op" id="2563848">)</span><span class="op" id="2563849">)</span><span class="op" id="2563850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563854">if</span>&nbsp;<span class="ident" id="2563857">err</span>&nbsp;<span class="op" id="2563861">!=</span>&nbsp;<span class="builtintype" id="2563864">nil</span>&nbsp;<span class="op" id="2563868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2563873">return</span>&nbsp;<span class="ident" id="2563880">n</span><span class="op" id="2563881">,</span>&nbsp;<span class="ident" id="2563883">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2563893">copy</span><span class="op" id="2563897">(</span><span class="ident" id="2563898">buf</span><span class="op" id="2563901">[</span><span class="num" id="2563902">0</span><span class="op" id="2563903">:</span><span class="op" id="2563904">]</span><span class="op" id="2563905">,</span>&nbsp;<span class="ident" id="2563907">data</span><span class="op" id="2563911">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563915">word</span>&nbsp;<span class="op" id="2563920">:=</span>&nbsp;<span class="op" id="2563923">*</span><span class="op" id="2563924">(</span><span class="op" id="2563925">(</span><span class="op" id="2563926">*</span><span class="builtintype" id="2563927">uintptr</span><span class="op" id="2563934">)</span><span class="op" id="2563935">(</span><span class="ident" id="2563936">unsafe</span><span class="op" id="2563942">.</span><span class="ident" id="2563943">Pointer</span><span class="op" id="2563950">(</span><span class="op" id="2563951">&amp;</span><span class="ident" id="2563952">buf</span><span class="op" id="2563955">[</span><span class="num" id="2563956">0</span><span class="op" id="2563957">]</span><span class="op" id="2563958">)</span><span class="op" id="2563959">)</span><span class="op" id="2563960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2563964">err</span>&nbsp;<span class="op" id="2563968">=</span>&nbsp;<span class="ident" id="2563970">ptrace</span><span class="op" id="2563976">(</span><span class="ident" id="2563977">pokeReq</span><span class="op" id="2563984">,</span>&nbsp;<span class="ident" id="2563986">pid</span><span class="op" id="2563989">,</span>&nbsp;<span class="ident" id="2563991">addr</span><span class="op" id="2563995">+</span><span class="builtintype" id="2563996">uintptr</span><span class="op" id="2564003">(</span><span class="ident" id="2564004">n</span><span class="op" id="2564005">)</span><span class="op" id="2564006">,</span>&nbsp;<span class="ident" id="2564008">word</span><span class="op" id="2564012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564016">if</span>&nbsp;<span class="ident" id="2564019">err</span>&nbsp;<span class="op" id="2564023">!=</span>&nbsp;<span class="builtintype" id="2564026">nil</span>&nbsp;<span class="op" id="2564030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564035">return</span>&nbsp;<span class="ident" id="2564042">n</span><span class="op" id="2564043">,</span>&nbsp;<span class="ident" id="2564045">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564051">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2564055">n</span>&nbsp;<span class="op" id="2564057">+=</span>&nbsp;<span class="builtinfunc" id="2564060">len</span><span class="op" id="2564063">(</span><span class="ident" id="2564064">data</span><span class="op" id="2564068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564075">return</span>&nbsp;<span class="ident" id="2564082">n</span><span class="op" id="2564083">,</span>&nbsp;<span class="builtintype" id="2564085">nil</span><br>
<span class="lineno"></span><span class="op" id="2564089">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2564092">func</span>&nbsp;<span class="ident" id="2564097">PtracePokeText</span><span class="op" id="2564111">(</span><span class="ident" id="2564112">pid</span>&nbsp;<span class="builtintype" id="2564116">int</span><span class="op" id="2564119">,</span>&nbsp;<span class="ident" id="2564121">addr</span>&nbsp;<span class="builtintype" id="2564126">uintptr</span><span class="op" id="2564133">,</span>&nbsp;<span class="ident" id="2564135">data</span>&nbsp;<span class="op" id="2564140">[</span><span class="op" id="2564141">]</span><span class="builtintype" id="2564142">byte</span><span class="op" id="2564146">)</span>&nbsp;<span class="op" id="2564148">(</span><span class="ident" id="2564149">count</span>&nbsp;<span class="builtintype" id="2564155">int</span><span class="op" id="2564158">,</span>&nbsp;<span class="ident" id="2564160">err</span>&nbsp;<span class="builtintype" id="2564164">error</span><span class="op" id="2564169">)</span>&nbsp;<span class="op" id="2564171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564174">return</span>&nbsp;<span class="ident" id="2564181">ptracePoke</span><span class="op" id="2564191">(</span><span class="ident" id="2564192">PTRACE_POKETEXT</span><span class="op" id="2564207">,</span>&nbsp;<span class="ident" id="2564209">PTRACE_PEEKTEXT</span><span class="op" id="2564224">,</span>&nbsp;<span class="ident" id="2564226">pid</span><span class="op" id="2564229">,</span>&nbsp;<span class="ident" id="2564231">addr</span><span class="op" id="2564235">,</span>&nbsp;<span class="ident" id="2564237">data</span><span class="op" id="2564241">)</span><br>
<span class="lineno"></span><span class="op" id="2564243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2564246">func</span>&nbsp;<span class="ident" id="2564251">PtracePokeData</span><span class="op" id="2564265">(</span><span class="ident" id="2564266">pid</span>&nbsp;<span class="builtintype" id="2564270">int</span><span class="op" id="2564273">,</span>&nbsp;<span class="ident" id="2564275">addr</span>&nbsp;<span class="builtintype" id="2564280">uintptr</span><span class="op" id="2564287">,</span>&nbsp;<span class="ident" id="2564289">data</span>&nbsp;<span class="op" id="2564294">[</span><span class="op" id="2564295">]</span><span class="builtintype" id="2564296">byte</span><span class="op" id="2564300">)</span>&nbsp;<span class="op" id="2564302">(</span><span class="ident" id="2564303">count</span>&nbsp;<span class="builtintype" id="2564309">int</span><span class="op" id="2564312">,</span>&nbsp;<span class="ident" id="2564314">err</span>&nbsp;<span class="builtintype" id="2564318">error</span><span class="op" id="2564323">)</span>&nbsp;<span class="op" id="2564325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564328">return</span>&nbsp;<span class="ident" id="2564335">ptracePoke</span><span class="op" id="2564345">(</span><span class="ident" id="2564346">PTRACE_POKEDATA</span><span class="op" id="2564361">,</span>&nbsp;<span class="ident" id="2564363">PTRACE_PEEKDATA</span><span class="op" id="2564378">,</span>&nbsp;<span class="ident" id="2564380">pid</span><span class="op" id="2564383">,</span>&nbsp;<span class="ident" id="2564385">addr</span><span class="op" id="2564389">,</span>&nbsp;<span class="ident" id="2564391">data</span><span class="op" id="2564395">)</span><br>
<span class="lineno"></span><span class="op" id="2564397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2564400">func</span>&nbsp;<span class="ident" id="2564405">PtraceGetRegs</span><span class="op" id="2564418">(</span><span class="ident" id="2564419">pid</span>&nbsp;<span class="builtintype" id="2564423">int</span><span class="op" id="2564426">,</span>&nbsp;<span class="ident" id="2564428">regsout</span>&nbsp;<span class="op" id="2564436">*</span><span class="ident" id="2564437">PtraceRegs</span><span class="op" id="2564447">)</span>&nbsp;<span class="op" id="2564449">(</span><span class="ident" id="2564450">err</span>&nbsp;<span class="builtintype" id="2564454">error</span><span class="op" id="2564459">)</span>&nbsp;<span class="op" id="2564461">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564464">return</span>&nbsp;<span class="ident" id="2564471">ptrace</span><span class="op" id="2564477">(</span><span class="ident" id="2564478">PTRACE_GETREGS</span><span class="op" id="2564492">,</span>&nbsp;<span class="ident" id="2564494">pid</span><span class="op" id="2564497">,</span>&nbsp;<span class="num" id="2564499">0</span><span class="op" id="2564500">,</span>&nbsp;<span class="builtintype" id="2564502">uintptr</span><span class="op" id="2564509">(</span><span class="ident" id="2564510">unsafe</span><span class="op" id="2564516">.</span><span class="ident" id="2564517">Pointer</span><span class="op" id="2564524">(</span><span class="ident" id="2564525">regsout</span><span class="op" id="2564532">)</span><span class="op" id="2564533">)</span><span class="op" id="2564534">)</span><br>
<span class="lineno"></span><span class="op" id="2564536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2564539">func</span>&nbsp;<span class="ident" id="2564544">PtraceSetRegs</span><span class="op" id="2564557">(</span><span class="ident" id="2564558">pid</span>&nbsp;<span class="builtintype" id="2564562">int</span><span class="op" id="2564565">,</span>&nbsp;<span class="ident" id="2564567">regs</span>&nbsp;<span class="op" id="2564572">*</span><span class="ident" id="2564573">PtraceRegs</span><span class="op" id="2564583">)</span>&nbsp;<span class="op" id="2564585">(</span><span class="ident" id="2564586">err</span>&nbsp;<span class="builtintype" id="2564590">error</span><span class="op" id="2564595">)</span>&nbsp;<span class="op" id="2564597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564600">return</span>&nbsp;<span class="ident" id="2564607">ptrace</span><span class="op" id="2564613">(</span><span class="ident" id="2564614">PTRACE_SETREGS</span><span class="op" id="2564628">,</span>&nbsp;<span class="ident" id="2564630">pid</span><span class="op" id="2564633">,</span>&nbsp;<span class="num" id="2564635">0</span><span class="op" id="2564636">,</span>&nbsp;<span class="builtintype" id="2564638">uintptr</span><span class="op" id="2564645">(</span><span class="ident" id="2564646">unsafe</span><span class="op" id="2564652">.</span><span class="ident" id="2564653">Pointer</span><span class="op" id="2564660">(</span><span class="ident" id="2564661">regs</span><span class="op" id="2564665">)</span><span class="op" id="2564666">)</span><span class="op" id="2564667">)</span><br>
<span class="lineno">695</span><span class="op" id="2564669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2564672">func</span>&nbsp;<span class="ident" id="2564677">PtraceSetOptions</span><span class="op" id="2564693">(</span><span class="ident" id="2564694">pid</span>&nbsp;<span class="builtintype" id="2564698">int</span><span class="op" id="2564701">,</span>&nbsp;<span class="ident" id="2564703">options</span>&nbsp;<span class="builtintype" id="2564711">int</span><span class="op" id="2564714">)</span>&nbsp;<span class="op" id="2564716">(</span><span class="ident" id="2564717">err</span>&nbsp;<span class="builtintype" id="2564721">error</span><span class="op" id="2564726">)</span>&nbsp;<span class="op" id="2564728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564731">return</span>&nbsp;<span class="ident" id="2564738">ptrace</span><span class="op" id="2564744">(</span><span class="ident" id="2564745">PTRACE_SETOPTIONS</span><span class="op" id="2564762">,</span>&nbsp;<span class="ident" id="2564764">pid</span><span class="op" id="2564767">,</span>&nbsp;<span class="num" id="2564769">0</span><span class="op" id="2564770">,</span>&nbsp;<span class="builtintype" id="2564772">uintptr</span><span class="op" id="2564779">(</span><span class="ident" id="2564780">options</span><span class="op" id="2564787">)</span><span class="op" id="2564788">)</span><br>
<span class="lineno"></span><span class="op" id="2564790">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2564793">func</span>&nbsp;<span class="ident" id="2564798">PtraceGetEventMsg</span><span class="op" id="2564815">(</span><span class="ident" id="2564816">pid</span>&nbsp;<span class="builtintype" id="2564820">int</span><span class="op" id="2564823">)</span>&nbsp;<span class="op" id="2564825">(</span><span class="ident" id="2564826">msg</span>&nbsp;<span class="builtintype" id="2564830">uint</span><span class="op" id="2564834">,</span>&nbsp;<span class="ident" id="2564836">err</span>&nbsp;<span class="builtintype" id="2564840">error</span><span class="op" id="2564845">)</span>&nbsp;<span class="op" id="2564847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564850">var</span>&nbsp;<span class="ident" id="2564854">data</span>&nbsp;<span class="ident" id="2564859">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2564868">err</span>&nbsp;<span class="op" id="2564872">=</span>&nbsp;<span class="ident" id="2564874">ptrace</span><span class="op" id="2564880">(</span><span class="ident" id="2564881">PTRACE_GETEVENTMSG</span><span class="op" id="2564899">,</span>&nbsp;<span class="ident" id="2564901">pid</span><span class="op" id="2564904">,</span>&nbsp;<span class="num" id="2564906">0</span><span class="op" id="2564907">,</span>&nbsp;<span class="builtintype" id="2564909">uintptr</span><span class="op" id="2564916">(</span><span class="ident" id="2564917">unsafe</span><span class="op" id="2564923">.</span><span class="ident" id="2564924">Pointer</span><span class="op" id="2564931">(</span><span class="op" id="2564932">&amp;</span><span class="ident" id="2564933">data</span><span class="op" id="2564937">)</span><span class="op" id="2564938">)</span><span class="op" id="2564939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2564942">msg</span>&nbsp;<span class="op" id="2564946">=</span>&nbsp;<span class="builtintype" id="2564948">uint</span><span class="op" id="2564952">(</span><span class="ident" id="2564953">data</span><span class="op" id="2564957">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2564960">return</span><br>
<span class="lineno"></span><span class="op" id="2564967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2564970">func</span>&nbsp;<span class="ident" id="2564975">PtraceCont</span><span class="op" id="2564985">(</span><span class="ident" id="2564986">pid</span>&nbsp;<span class="builtintype" id="2564990">int</span><span class="op" id="2564993">,</span>&nbsp;<span class="ident" id="2564995">signal</span>&nbsp;<span class="builtintype" id="2565002">int</span><span class="op" id="2565005">)</span>&nbsp;<span class="op" id="2565007">(</span><span class="ident" id="2565008">err</span>&nbsp;<span class="builtintype" id="2565012">error</span><span class="op" id="2565017">)</span>&nbsp;<span class="op" id="2565019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565022">return</span>&nbsp;<span class="ident" id="2565029">ptrace</span><span class="op" id="2565035">(</span><span class="ident" id="2565036">PTRACE_CONT</span><span class="op" id="2565047">,</span>&nbsp;<span class="ident" id="2565049">pid</span><span class="op" id="2565052">,</span>&nbsp;<span class="num" id="2565054">0</span><span class="op" id="2565055">,</span>&nbsp;<span class="builtintype" id="2565057">uintptr</span><span class="op" id="2565064">(</span><span class="ident" id="2565065">signal</span><span class="op" id="2565071">)</span><span class="op" id="2565072">)</span><br>
<span class="lineno">710</span><span class="op" id="2565074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565077">func</span>&nbsp;<span class="ident" id="2565082">PtraceSyscall</span><span class="op" id="2565095">(</span><span class="ident" id="2565096">pid</span>&nbsp;<span class="builtintype" id="2565100">int</span><span class="op" id="2565103">,</span>&nbsp;<span class="ident" id="2565105">signal</span>&nbsp;<span class="builtintype" id="2565112">int</span><span class="op" id="2565115">)</span>&nbsp;<span class="op" id="2565117">(</span><span class="ident" id="2565118">err</span>&nbsp;<span class="builtintype" id="2565122">error</span><span class="op" id="2565127">)</span>&nbsp;<span class="op" id="2565129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565132">return</span>&nbsp;<span class="ident" id="2565139">ptrace</span><span class="op" id="2565145">(</span><span class="ident" id="2565146">PTRACE_SYSCALL</span><span class="op" id="2565160">,</span>&nbsp;<span class="ident" id="2565162">pid</span><span class="op" id="2565165">,</span>&nbsp;<span class="num" id="2565167">0</span><span class="op" id="2565168">,</span>&nbsp;<span class="builtintype" id="2565170">uintptr</span><span class="op" id="2565177">(</span><span class="ident" id="2565178">signal</span><span class="op" id="2565184">)</span><span class="op" id="2565185">)</span><br>
<span class="lineno"></span><span class="op" id="2565187">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2565190">func</span>&nbsp;<span class="ident" id="2565195">PtraceSingleStep</span><span class="op" id="2565211">(</span><span class="ident" id="2565212">pid</span>&nbsp;<span class="builtintype" id="2565216">int</span><span class="op" id="2565219">)</span>&nbsp;<span class="op" id="2565221">(</span><span class="ident" id="2565222">err</span>&nbsp;<span class="builtintype" id="2565226">error</span><span class="op" id="2565231">)</span>&nbsp;<span class="op" id="2565233">{</span>&nbsp;<span class="keyword" id="2565235">return</span>&nbsp;<span class="ident" id="2565242">ptrace</span><span class="op" id="2565248">(</span><span class="ident" id="2565249">PTRACE_SINGLESTEP</span><span class="op" id="2565266">,</span>&nbsp;<span class="ident" id="2565268">pid</span><span class="op" id="2565271">,</span>&nbsp;<span class="num" id="2565273">0</span><span class="op" id="2565274">,</span>&nbsp;<span class="num" id="2565276">0</span><span class="op" id="2565277">)</span>&nbsp;<span class="op" id="2565279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565282">func</span>&nbsp;<span class="ident" id="2565287">PtraceAttach</span><span class="op" id="2565299">(</span><span class="ident" id="2565300">pid</span>&nbsp;<span class="builtintype" id="2565304">int</span><span class="op" id="2565307">)</span>&nbsp;<span class="op" id="2565309">(</span><span class="ident" id="2565310">err</span>&nbsp;<span class="builtintype" id="2565314">error</span><span class="op" id="2565319">)</span>&nbsp;<span class="op" id="2565321">{</span>&nbsp;<span class="keyword" id="2565323">return</span>&nbsp;<span class="ident" id="2565330">ptrace</span><span class="op" id="2565336">(</span><span class="ident" id="2565337">PTRACE_ATTACH</span><span class="op" id="2565350">,</span>&nbsp;<span class="ident" id="2565352">pid</span><span class="op" id="2565355">,</span>&nbsp;<span class="num" id="2565357">0</span><span class="op" id="2565358">,</span>&nbsp;<span class="num" id="2565360">0</span><span class="op" id="2565361">)</span>&nbsp;<span class="op" id="2565363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2565366">func</span>&nbsp;<span class="ident" id="2565371">PtraceDetach</span><span class="op" id="2565383">(</span><span class="ident" id="2565384">pid</span>&nbsp;<span class="builtintype" id="2565388">int</span><span class="op" id="2565391">)</span>&nbsp;<span class="op" id="2565393">(</span><span class="ident" id="2565394">err</span>&nbsp;<span class="builtintype" id="2565398">error</span><span class="op" id="2565403">)</span>&nbsp;<span class="op" id="2565405">{</span>&nbsp;<span class="keyword" id="2565407">return</span>&nbsp;<span class="ident" id="2565414">ptrace</span><span class="op" id="2565420">(</span><span class="ident" id="2565421">PTRACE_DETACH</span><span class="op" id="2565434">,</span>&nbsp;<span class="ident" id="2565436">pid</span><span class="op" id="2565439">,</span>&nbsp;<span class="num" id="2565441">0</span><span class="op" id="2565442">,</span>&nbsp;<span class="num" id="2565444">0</span><span class="op" id="2565445">)</span>&nbsp;<span class="op" id="2565447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2565450">//sys&nbsp;&nbsp;&nbsp;&nbsp;reboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565523">func</span>&nbsp;<span class="ident" id="2565528">Reboot</span><span class="op" id="2565534">(</span><span class="ident" id="2565535">cmd</span>&nbsp;<span class="builtintype" id="2565539">int</span><span class="op" id="2565542">)</span>&nbsp;<span class="op" id="2565544">(</span><span class="ident" id="2565545">err</span>&nbsp;<span class="builtintype" id="2565549">error</span><span class="op" id="2565554">)</span>&nbsp;<span class="op" id="2565556">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565559">return</span>&nbsp;<span class="ident" id="2565566">reboot</span><span class="op" id="2565572">(</span><span class="ident" id="2565573">LINUX_REBOOT_MAGIC1</span><span class="op" id="2565592">,</span>&nbsp;<span class="ident" id="2565594">LINUX_REBOOT_MAGIC2</span><span class="op" id="2565613">,</span>&nbsp;<span class="ident" id="2565615">cmd</span><span class="op" id="2565618">,</span>&nbsp;<span class="string" id="2565620">&#34;&#34;</span><span class="op" id="2565622">)</span><br>
<span class="lineno"></span><span class="op" id="2565624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565627">func</span>&nbsp;<span class="ident" id="2565632">clen</span><span class="op" id="2565636">(</span><span class="ident" id="2565637">n</span>&nbsp;<span class="op" id="2565639">[</span><span class="op" id="2565640">]</span><span class="builtintype" id="2565641">byte</span><span class="op" id="2565645">)</span>&nbsp;<span class="builtintype" id="2565647">int</span>&nbsp;<span class="op" id="2565651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565654">for</span>&nbsp;<span class="ident" id="2565658">i</span>&nbsp;<span class="op" id="2565660">:=</span>&nbsp;<span class="num" id="2565663">0</span><span class="op" id="2565664">;</span>&nbsp;<span class="ident" id="2565666">i</span>&nbsp;<span class="op" id="2565668">&lt;</span>&nbsp;<span class="builtinfunc" id="2565670">len</span><span class="op" id="2565673">(</span><span class="ident" id="2565674">n</span><span class="op" id="2565675">)</span><span class="op" id="2565676">;</span>&nbsp;<span class="ident" id="2565678">i</span><span class="op" id="2565679">++</span>&nbsp;<span class="op" id="2565682">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565686">if</span>&nbsp;<span class="ident" id="2565689">n</span><span class="op" id="2565690">[</span><span class="ident" id="2565691">i</span><span class="op" id="2565692">]</span>&nbsp;<span class="op" id="2565694">==</span>&nbsp;<span class="num" id="2565697">0</span>&nbsp;<span class="op" id="2565699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565704">return</span>&nbsp;<span class="ident" id="2565711">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2565715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2565718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565721">return</span>&nbsp;<span class="builtinfunc" id="2565728">len</span><span class="op" id="2565731">(</span><span class="ident" id="2565732">n</span><span class="op" id="2565733">)</span><br>
<span class="lineno">735</span><span class="op" id="2565735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565738">func</span>&nbsp;<span class="ident" id="2565743">ReadDirent</span><span class="op" id="2565753">(</span><span class="ident" id="2565754">fd</span>&nbsp;<span class="builtintype" id="2565757">int</span><span class="op" id="2565760">,</span>&nbsp;<span class="ident" id="2565762">buf</span>&nbsp;<span class="op" id="2565766">[</span><span class="op" id="2565767">]</span><span class="builtintype" id="2565768">byte</span><span class="op" id="2565772">)</span>&nbsp;<span class="op" id="2565774">(</span><span class="ident" id="2565775">n</span>&nbsp;<span class="builtintype" id="2565777">int</span><span class="op" id="2565780">,</span>&nbsp;<span class="ident" id="2565782">err</span>&nbsp;<span class="builtintype" id="2565786">error</span><span class="op" id="2565791">)</span>&nbsp;<span class="op" id="2565793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565796">return</span>&nbsp;<span class="ident" id="2565803">Getdents</span><span class="op" id="2565811">(</span><span class="ident" id="2565812">fd</span><span class="op" id="2565814">,</span>&nbsp;<span class="ident" id="2565816">buf</span><span class="op" id="2565819">)</span><br>
<span class="lineno"></span><span class="op" id="2565821">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2565824">func</span>&nbsp;<span class="ident" id="2565829">ParseDirent</span><span class="op" id="2565840">(</span><span class="ident" id="2565841">buf</span>&nbsp;<span class="op" id="2565845">[</span><span class="op" id="2565846">]</span><span class="builtintype" id="2565847">byte</span><span class="op" id="2565851">,</span>&nbsp;<span class="ident" id="2565853">max</span>&nbsp;<span class="builtintype" id="2565857">int</span><span class="op" id="2565860">,</span>&nbsp;<span class="ident" id="2565862">names</span>&nbsp;<span class="op" id="2565868">[</span><span class="op" id="2565869">]</span><span class="builtintype" id="2565870">string</span><span class="op" id="2565876">)</span>&nbsp;<span class="op" id="2565878">(</span><span class="ident" id="2565879">consumed</span>&nbsp;<span class="builtintype" id="2565888">int</span><span class="op" id="2565891">,</span>&nbsp;<span class="ident" id="2565893">count</span>&nbsp;<span class="builtintype" id="2565899">int</span><span class="op" id="2565902">,</span>&nbsp;<span class="ident" id="2565904">newnames</span>&nbsp;<span class="op" id="2565913">[</span><span class="op" id="2565914">]</span><span class="builtintype" id="2565915">string</span><span class="op" id="2565921">)</span>&nbsp;<span class="op" id="2565923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2565926">origlen</span>&nbsp;<span class="op" id="2565934">:=</span>&nbsp;<span class="builtinfunc" id="2565937">len</span><span class="op" id="2565940">(</span><span class="ident" id="2565941">buf</span><span class="op" id="2565944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2565947">count</span>&nbsp;<span class="op" id="2565953">=</span>&nbsp;<span class="num" id="2565955">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2565958">for</span>&nbsp;<span class="ident" id="2565962">max</span>&nbsp;<span class="op" id="2565966">!=</span>&nbsp;<span class="num" id="2565969">0</span>&nbsp;<span class="op" id="2565971">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2565974">len</span><span class="op" id="2565977">(</span><span class="ident" id="2565978">buf</span><span class="op" id="2565981">)</span>&nbsp;<span class="op" id="2565983">&gt;</span>&nbsp;<span class="num" id="2565985">0</span>&nbsp;<span class="op" id="2565987">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2565991">dirent</span>&nbsp;<span class="op" id="2565998">:=</span>&nbsp;<span class="op" id="2566001">(</span><span class="op" id="2566002">*</span><span class="ident" id="2566003">Dirent</span><span class="op" id="2566009">)</span><span class="op" id="2566010">(</span><span class="ident" id="2566011">unsafe</span><span class="op" id="2566017">.</span><span class="ident" id="2566018">Pointer</span><span class="op" id="2566025">(</span><span class="op" id="2566026">&amp;</span><span class="ident" id="2566027">buf</span><span class="op" id="2566030">[</span><span class="num" id="2566031">0</span><span class="op" id="2566032">]</span><span class="op" id="2566033">)</span><span class="op" id="2566034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566038">buf</span>&nbsp;<span class="op" id="2566042">=</span>&nbsp;<span class="ident" id="2566044">buf</span><span class="op" id="2566047">[</span><span class="ident" id="2566048">dirent</span><span class="op" id="2566054">.</span><span class="ident" id="2566055">Reclen</span><span class="op" id="2566061">:</span><span class="op" id="2566062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566066">if</span>&nbsp;<span class="ident" id="2566069">dirent</span><span class="op" id="2566075">.</span><span class="ident" id="2566076">Ino</span>&nbsp;<span class="op" id="2566080">==</span>&nbsp;<span class="num" id="2566083">0</span>&nbsp;<span class="op" id="2566085">{</span>&nbsp;<span class="comment" id="2566087">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566119">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2566130">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566134">bytes</span>&nbsp;<span class="op" id="2566140">:=</span>&nbsp;<span class="op" id="2566143">(</span><span class="op" id="2566144">*</span><span class="op" id="2566145">[</span><span class="num" id="2566146">10000</span><span class="op" id="2566151">]</span><span class="builtintype" id="2566152">byte</span><span class="op" id="2566156">)</span><span class="op" id="2566157">(</span><span class="ident" id="2566158">unsafe</span><span class="op" id="2566164">.</span><span class="ident" id="2566165">Pointer</span><span class="op" id="2566172">(</span><span class="op" id="2566173">&amp;</span><span class="ident" id="2566174">dirent</span><span class="op" id="2566180">.</span><span class="ident" id="2566181">Name</span><span class="op" id="2566185">[</span><span class="num" id="2566186">0</span><span class="op" id="2566187">]</span><span class="op" id="2566188">)</span><span class="op" id="2566189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566193">var</span>&nbsp;<span class="ident" id="2566197">name</span>&nbsp;<span class="op" id="2566202">=</span>&nbsp;<span class="builtintype" id="2566204">string</span><span class="op" id="2566210">(</span><span class="ident" id="2566211">bytes</span><span class="op" id="2566216">[</span><span class="num" id="2566217">0</span><span class="op" id="2566218">:</span><span class="ident" id="2566219">clen</span><span class="op" id="2566223">(</span><span class="ident" id="2566224">bytes</span><span class="op" id="2566229">[</span><span class="op" id="2566230">:</span><span class="op" id="2566231">]</span><span class="op" id="2566232">)</span><span class="op" id="2566233">]</span><span class="op" id="2566234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566238">if</span>&nbsp;<span class="ident" id="2566241">name</span>&nbsp;<span class="op" id="2566246">==</span>&nbsp;<span class="string" id="2566249">&#34;.&#34;</span>&nbsp;<span class="op" id="2566253">||</span>&nbsp;<span class="ident" id="2566256">name</span>&nbsp;<span class="op" id="2566261">==</span>&nbsp;<span class="string" id="2566264">&#34;..&#34;</span>&nbsp;<span class="op" id="2566269">{</span>&nbsp;<span class="comment" id="2566271">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566291">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2566302">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566306">max</span><span class="op" id="2566309">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566314">count</span><span class="op" id="2566319">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566324">names</span>&nbsp;<span class="op" id="2566330">=</span>&nbsp;<span class="builtinfunc" id="2566332">append</span><span class="op" id="2566338">(</span><span class="ident" id="2566339">names</span><span class="op" id="2566344">,</span>&nbsp;<span class="ident" id="2566346">name</span><span class="op" id="2566350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2566353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566356">return</span>&nbsp;<span class="ident" id="2566363">origlen</span>&nbsp;<span class="op" id="2566371">-</span>&nbsp;<span class="builtinfunc" id="2566373">len</span><span class="op" id="2566376">(</span><span class="ident" id="2566377">buf</span><span class="op" id="2566380">)</span><span class="op" id="2566381">,</span>&nbsp;<span class="ident" id="2566383">count</span><span class="op" id="2566388">,</span>&nbsp;<span class="ident" id="2566390">names</span><br>
<span class="lineno">760</span><span class="op" id="2566396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2566399">//sys&nbsp;&nbsp;&nbsp;&nbsp;mount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566496">func</span>&nbsp;<span class="ident" id="2566501">Mount</span><span class="op" id="2566506">(</span><span class="ident" id="2566507">source</span>&nbsp;<span class="builtintype" id="2566514">string</span><span class="op" id="2566520">,</span>&nbsp;<span class="ident" id="2566522">target</span>&nbsp;<span class="builtintype" id="2566529">string</span><span class="op" id="2566535">,</span>&nbsp;<span class="ident" id="2566537">fstype</span>&nbsp;<span class="builtintype" id="2566544">string</span><span class="op" id="2566550">,</span>&nbsp;<span class="ident" id="2566552">flags</span>&nbsp;<span class="builtintype" id="2566558">uintptr</span><span class="op" id="2566565">,</span>&nbsp;<span class="ident" id="2566567">data</span>&nbsp;<span class="builtintype" id="2566572">string</span><span class="op" id="2566578">)</span>&nbsp;<span class="op" id="2566580">(</span><span class="ident" id="2566581">err</span>&nbsp;<span class="builtintype" id="2566585">error</span><span class="op" id="2566590">)</span>&nbsp;<span class="op" id="2566592">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2566595">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2566660">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566712">if</span>&nbsp;<span class="ident" id="2566715">data</span>&nbsp;<span class="op" id="2566720">==</span>&nbsp;<span class="string" id="2566723">&#34;&#34;</span>&nbsp;<span class="op" id="2566726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566730">return</span>&nbsp;<span class="ident" id="2566737">mount</span><span class="op" id="2566742">(</span><span class="ident" id="2566743">source</span><span class="op" id="2566749">,</span>&nbsp;<span class="ident" id="2566751">target</span><span class="op" id="2566757">,</span>&nbsp;<span class="ident" id="2566759">fstype</span><span class="op" id="2566765">,</span>&nbsp;<span class="ident" id="2566767">flags</span><span class="op" id="2566772">,</span>&nbsp;<span class="builtintype" id="2566774">nil</span><span class="op" id="2566777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2566780">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566783">datap</span><span class="op" id="2566788">,</span>&nbsp;<span class="ident" id="2566790">err</span>&nbsp;<span class="op" id="2566794">:=</span>&nbsp;<span class="ident" id="2566797">BytePtrFromString</span><span class="op" id="2566814">(</span><span class="ident" id="2566815">data</span><span class="op" id="2566819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566822">if</span>&nbsp;<span class="ident" id="2566825">err</span>&nbsp;<span class="op" id="2566829">!=</span>&nbsp;<span class="builtintype" id="2566832">nil</span>&nbsp;<span class="op" id="2566836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566840">return</span>&nbsp;<span class="ident" id="2566847">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2566852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566855">err</span>&nbsp;<span class="op" id="2566859">=</span>&nbsp;<span class="ident" id="2566861">mount</span><span class="op" id="2566866">(</span><span class="ident" id="2566867">source</span><span class="op" id="2566873">,</span>&nbsp;<span class="ident" id="2566875">target</span><span class="op" id="2566881">,</span>&nbsp;<span class="ident" id="2566883">fstype</span><span class="op" id="2566889">,</span>&nbsp;<span class="ident" id="2566891">flags</span><span class="op" id="2566896">,</span>&nbsp;<span class="ident" id="2566898">datap</span><span class="op" id="2566903">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2566906">use</span><span class="op" id="2566909">(</span><span class="ident" id="2566910">unsafe</span><span class="op" id="2566916">.</span><span class="ident" id="2566917">Pointer</span><span class="op" id="2566924">(</span><span class="ident" id="2566925">datap</span><span class="op" id="2566930">)</span><span class="op" id="2566931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2566934">return</span>&nbsp;<span class="ident" id="2566941">err</span><br>
<span class="lineno"></span><span class="op" id="2566945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2566948">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2566958">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2566970">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2566985">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2567009">//sys&nbsp;&nbsp;&nbsp;&nbsp;Access(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567060">//sys&nbsp;&nbsp;&nbsp;&nbsp;Acct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567096">//sys&nbsp;&nbsp;&nbsp;&nbsp;Adjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567146">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2567183">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567233">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567271">//sys&nbsp;&nbsp;&nbsp;&nbsp;Close(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567303">//sys&nbsp;&nbsp;&nbsp;&nbsp;Creat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567361">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2567404">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567451">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567509">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567559">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567610">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2567684">//sys&nbsp;&nbsp;&nbsp;&nbsp;EpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567760">//sys&nbsp;&nbsp;&nbsp;&nbsp;Exit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2567798">//sys&nbsp;&nbsp;&nbsp;&nbsp;Faccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567874">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567945">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2567978">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568024">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568099">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568179">//sys&nbsp;&nbsp;&nbsp;&nbsp;fcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568238">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2568274">//sys&nbsp;&nbsp;&nbsp;&nbsp;Flock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568315">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568347">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2568418">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568465">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2568493">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2568520">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2568549">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568609">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568664">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Gettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2568691">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568765">//sys&nbsp;&nbsp;&nbsp;&nbsp;InotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568852">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568894">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568946">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2569020">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Kill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569066">//sys&nbsp;&nbsp;&nbsp;&nbsp;Klogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2569133">//sys&nbsp;&nbsp;&nbsp;&nbsp;Link(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569188">//sys&nbsp;&nbsp;&nbsp;&nbsp;Listxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569250">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2569300">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569363">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569422">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569494">//sys&nbsp;&nbsp;&nbsp;&nbsp;Nanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569558">//sys&nbsp;&nbsp;&nbsp;&nbsp;Pause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2569584">//sys&nbsp;&nbsp;&nbsp;&nbsp;PivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2569660">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2569758">//sys&nbsp;&nbsp;&nbsp;&nbsp;read(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569806">//sys&nbsp;&nbsp;&nbsp;&nbsp;Readlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569865">//sys&nbsp;&nbsp;&nbsp;&nbsp;Removexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2569921">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2569978">//sys&nbsp;&nbsp;&nbsp;&nbsp;Renameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570065">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570102">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570144">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2570184">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570231">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570269">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Settimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2570316">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2570331">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2570411">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2570486">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570557">func</span>&nbsp;<span class="ident" id="2570562">Setuid</span><span class="op" id="2570568">(</span><span class="ident" id="2570569">uid</span>&nbsp;<span class="builtintype" id="2570573">int</span><span class="op" id="2570576">)</span>&nbsp;<span class="op" id="2570578">(</span><span class="ident" id="2570579">err</span>&nbsp;<span class="builtintype" id="2570583">error</span><span class="op" id="2570588">)</span>&nbsp;<span class="op" id="2570590">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570593">return</span>&nbsp;<span class="ident" id="2570600">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2570611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570614">func</span>&nbsp;<span class="ident" id="2570619">Setgid</span><span class="op" id="2570625">(</span><span class="ident" id="2570626">uid</span>&nbsp;<span class="builtintype" id="2570630">int</span><span class="op" id="2570633">)</span>&nbsp;<span class="op" id="2570635">(</span><span class="ident" id="2570636">err</span>&nbsp;<span class="builtintype" id="2570640">error</span><span class="op" id="2570645">)</span>&nbsp;<span class="op" id="2570647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570650">return</span>&nbsp;<span class="ident" id="2570657">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2570668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2570671">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570731">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570808">//sys&nbsp;&nbsp;&nbsp;&nbsp;Symlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2570866">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sync()</span><br>
<span class="lineno"></span><span class="comment" id="2570879">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Sysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570924">//sys&nbsp;&nbsp;&nbsp;&nbsp;Tee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2570993">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Tgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571051">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Times(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2571102">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Umask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2571140">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Uname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571180">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571218">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571269">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2571335">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571372">//sys&nbsp;&nbsp;&nbsp;&nbsp;Ustat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571420">//sys&nbsp;&nbsp;&nbsp;&nbsp;Utime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571471">//sys&nbsp;&nbsp;&nbsp;&nbsp;write(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2571520">//sys&nbsp;&nbsp;&nbsp;&nbsp;exitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2571570">//sys&nbsp;&nbsp;&nbsp;&nbsp;readlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2571639">//sys&nbsp;&nbsp;&nbsp;&nbsp;writelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2571711">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2571767">//sys&nbsp;&nbsp;&nbsp;&nbsp;munmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2571823">var</span>&nbsp;<span class="ident" id="2571827">mapper</span>&nbsp;<span class="op" id="2571834">=</span>&nbsp;<span class="op" id="2571836">&amp;</span><span class="ident" id="2571837">mmapper</span><span class="op" id="2571844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571847">active</span><span class="op" id="2571853">:</span>&nbsp;<span class="builtinfunc" id="2571855">make</span><span class="op" id="2571859">(</span><span class="keyword" id="2571860">map</span><span class="op" id="2571863">[</span><span class="op" id="2571864">*</span><span class="builtintype" id="2571865">byte</span><span class="op" id="2571869">]</span><span class="op" id="2571870">[</span><span class="op" id="2571871">]</span><span class="builtintype" id="2571872">byte</span><span class="op" id="2571876">)</span><span class="op" id="2571877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571880">mmap</span><span class="op" id="2571884">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2571888">mmap</span><span class="op" id="2571892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571895">munmap</span><span class="op" id="2571901">:</span>&nbsp;<span class="ident" id="2571903">munmap</span><span class="op" id="2571909">,</span><br>
<span class="lineno">890</span><span class="op" id="2571911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571914">func</span>&nbsp;<span class="ident" id="2571919">Mmap</span><span class="op" id="2571923">(</span><span class="ident" id="2571924">fd</span>&nbsp;<span class="builtintype" id="2571927">int</span><span class="op" id="2571930">,</span>&nbsp;<span class="ident" id="2571932">offset</span>&nbsp;<span class="builtintype" id="2571939">int64</span><span class="op" id="2571944">,</span>&nbsp;<span class="ident" id="2571946">length</span>&nbsp;<span class="builtintype" id="2571953">int</span><span class="op" id="2571956">,</span>&nbsp;<span class="ident" id="2571958">prot</span>&nbsp;<span class="builtintype" id="2571963">int</span><span class="op" id="2571966">,</span>&nbsp;<span class="ident" id="2571968">flags</span>&nbsp;<span class="builtintype" id="2571974">int</span><span class="op" id="2571977">)</span>&nbsp;<span class="op" id="2571979">(</span><span class="ident" id="2571980">data</span>&nbsp;<span class="op" id="2571985">[</span><span class="op" id="2571986">]</span><span class="builtintype" id="2571987">byte</span><span class="op" id="2571991">,</span>&nbsp;<span class="ident" id="2571993">err</span>&nbsp;<span class="builtintype" id="2571997">error</span><span class="op" id="2572002">)</span>&nbsp;<span class="op" id="2572004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572007">return</span>&nbsp;<span class="ident" id="2572014">mapper</span><span class="op" id="2572020">.</span><span class="ident" id="2572021">Mmap</span><span class="op" id="2572025">(</span><span class="ident" id="2572026">fd</span><span class="op" id="2572028">,</span>&nbsp;<span class="ident" id="2572030">offset</span><span class="op" id="2572036">,</span>&nbsp;<span class="ident" id="2572038">length</span><span class="op" id="2572044">,</span>&nbsp;<span class="ident" id="2572046">prot</span><span class="op" id="2572050">,</span>&nbsp;<span class="ident" id="2572052">flags</span><span class="op" id="2572057">)</span><br>
<span class="lineno"></span><span class="op" id="2572059">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2572062">func</span>&nbsp;<span class="ident" id="2572067">Munmap</span><span class="op" id="2572073">(</span><span class="ident" id="2572074">b</span>&nbsp;<span class="op" id="2572076">[</span><span class="op" id="2572077">]</span><span class="builtintype" id="2572078">byte</span><span class="op" id="2572082">)</span>&nbsp;<span class="op" id="2572084">(</span><span class="ident" id="2572085">err</span>&nbsp;<span class="builtintype" id="2572089">error</span><span class="op" id="2572094">)</span>&nbsp;<span class="op" id="2572096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572099">return</span>&nbsp;<span class="ident" id="2572106">mapper</span><span class="op" id="2572112">.</span><span class="ident" id="2572113">Munmap</span><span class="op" id="2572119">(</span><span class="ident" id="2572120">b</span><span class="op" id="2572121">)</span><br>
<span class="lineno"></span><span class="op" id="2572123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2572126">//sys&nbsp;&nbsp;&nbsp;&nbsp;Madvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2572174">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2572221">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2572255">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2572291">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2572329">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2572361">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2572385">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2572395">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2572409">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2572418">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2572431">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2572438">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2572448">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2572458">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2572473">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2572489">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2572507">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2572523">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2572532">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2572548">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2572564">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2572579">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2572593">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2572609">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2572620">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2572630">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2572643">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2572656">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2572670">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2572678">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2572694">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2572707">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2572716">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2572733">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2572749">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2572766">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2572783">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2572796">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2572807">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2572819">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2572832">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2572847">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2572858">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2572870">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2572879">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2572892">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2572905">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2572918">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2572928">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2572941">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2572955">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2572972">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2572988">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2573001">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2573010">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2573026">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2573037">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2573050">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2573059">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2573072">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2573084">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2573100">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2573112">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2573122">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2573140">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2573155">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2573167">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2573177">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2573187">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2573197">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2573207">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2573217">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2573226">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2573240">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2573254">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2573269">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2573277">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2573286">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2573295">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2573307">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2573317">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2573328">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2573343">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2573355">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2573368">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2573377">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2573395">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2573409">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2573427">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2573442">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2573458">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2573475">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2573493">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2573508">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2573524">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2573542">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2573565">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2573588">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2573608">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2573625">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2573646">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2573668">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2573688">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2573705">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2573719">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2573731">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2573741">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2573751">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2573760">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2573774">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2573790">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2573807">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2573824">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2573841">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2573850">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2573860">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2573869">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2573879">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2573894">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2573906">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2573917">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2573927">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2573936">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2573951">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2573966">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2573985">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2574001">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2574017">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2574028">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2574048">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2574059">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2574070">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2574080">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2574093">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2574102">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2574113">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2574125">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2574136">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2574146">//&nbsp;_Sysctl</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
