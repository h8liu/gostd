<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4795629">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4795685">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4795739">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4795790">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="4795861">package</span>&nbsp;<span class="ident" id="4795869">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4795876">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4795939">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="4795994">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796070">const</span>&nbsp;<span class="op" id="4796076">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796079">replacementChar</span>&nbsp;<span class="op" id="4796095">=</span>&nbsp;<span class="string" id="4796097">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4796110">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796144">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4796160">=</span>&nbsp;<span class="string" id="4796162">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="4796175">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="4796212">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796215">const</span>&nbsp;<span class="op" id="4796221">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4796224">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4796278">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4796331">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796376">surr1</span>&nbsp;<span class="op" id="4796382">=</span>&nbsp;<span class="num" id="4796384">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796392">surr2</span>&nbsp;<span class="op" id="4796398">=</span>&nbsp;<span class="num" id="4796400">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796408">surr3</span>&nbsp;<span class="op" id="4796414">=</span>&nbsp;<span class="num" id="4796416">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796425">surrSelf</span>&nbsp;<span class="op" id="4796434">=</span>&nbsp;<span class="num" id="4796436">0x10000</span><br>
<span class="lineno"></span><span class="op" id="4796444">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4796447">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="4796511">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="4796546">func</span>&nbsp;<span class="ident" id="4796551">IsSurrogate</span><span class="op" id="4796562">(</span><span class="ident" id="4796563">r</span>&nbsp;<span class="builtintype" id="4796565">rune</span><span class="op" id="4796569">)</span>&nbsp;<span class="builtintype" id="4796571">bool</span>&nbsp;<span class="op" id="4796576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796579">return</span>&nbsp;<span class="ident" id="4796586">surr1</span>&nbsp;<span class="op" id="4796592">&lt;=</span>&nbsp;<span class="ident" id="4796595">r</span>&nbsp;<span class="op" id="4796597">&amp;&amp;</span>&nbsp;<span class="ident" id="4796600">r</span>&nbsp;<span class="op" id="4796602">&lt;</span>&nbsp;<span class="ident" id="4796604">surr3</span><br>
<span class="lineno"></span><span class="op" id="4796610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4796613">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="4796676">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4796748">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4796794">func</span>&nbsp;<span class="ident" id="4796799">DecodeRune</span><span class="op" id="4796809">(</span><span class="ident" id="4796810">r1</span><span class="op" id="4796812">,</span>&nbsp;<span class="ident" id="4796814">r2</span>&nbsp;<span class="builtintype" id="4796817">rune</span><span class="op" id="4796821">)</span>&nbsp;<span class="builtintype" id="4796823">rune</span>&nbsp;<span class="op" id="4796828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796831">if</span>&nbsp;<span class="ident" id="4796834">surr1</span>&nbsp;<span class="op" id="4796840">&lt;=</span>&nbsp;<span class="ident" id="4796843">r1</span>&nbsp;<span class="op" id="4796846">&amp;&amp;</span>&nbsp;<span class="ident" id="4796849">r1</span>&nbsp;<span class="op" id="4796852">&lt;</span>&nbsp;<span class="ident" id="4796854">surr2</span>&nbsp;<span class="op" id="4796860">&amp;&amp;</span>&nbsp;<span class="ident" id="4796863">surr2</span>&nbsp;<span class="op" id="4796869">&lt;=</span>&nbsp;<span class="ident" id="4796872">r2</span>&nbsp;<span class="op" id="4796875">&amp;&amp;</span>&nbsp;<span class="ident" id="4796878">r2</span>&nbsp;<span class="op" id="4796881">&lt;</span>&nbsp;<span class="ident" id="4796883">surr3</span>&nbsp;<span class="op" id="4796889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796893">return</span>&nbsp;<span class="op" id="4796900">(</span><span class="ident" id="4796901">r1</span><span class="op" id="4796903">-</span><span class="ident" id="4796904">surr1</span><span class="op" id="4796909">)</span><span class="op" id="4796910">&lt;&lt;</span><span class="num" id="4796912">10</span>&nbsp;<span class="op" id="4796915">|</span>&nbsp;<span class="op" id="4796917">(</span><span class="ident" id="4796918">r2</span>&nbsp;<span class="op" id="4796921">-</span>&nbsp;<span class="ident" id="4796923">surr2</span><span class="op" id="4796928">)</span>&nbsp;<span class="op" id="4796930">+</span>&nbsp;<span class="num" id="4796932">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796944">return</span>&nbsp;<span class="ident" id="4796951">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="4796967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4796970">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4797045">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="4797121">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4797159">func</span>&nbsp;<span class="ident" id="4797164">EncodeRune</span><span class="op" id="4797174">(</span><span class="ident" id="4797175">r</span>&nbsp;<span class="builtintype" id="4797177">rune</span><span class="op" id="4797181">)</span>&nbsp;<span class="op" id="4797183">(</span><span class="ident" id="4797184">r1</span><span class="op" id="4797186">,</span>&nbsp;<span class="ident" id="4797188">r2</span>&nbsp;<span class="builtintype" id="4797191">rune</span><span class="op" id="4797195">)</span>&nbsp;<span class="op" id="4797197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797200">if</span>&nbsp;<span class="ident" id="4797203">r</span>&nbsp;<span class="op" id="4797205">&lt;</span>&nbsp;<span class="ident" id="4797207">surrSelf</span>&nbsp;<span class="op" id="4797216">||</span>&nbsp;<span class="ident" id="4797219">r</span>&nbsp;<span class="op" id="4797221">&gt;</span>&nbsp;<span class="ident" id="4797223">maxRune</span>&nbsp;<span class="op" id="4797231">||</span>&nbsp;<span class="ident" id="4797234">IsSurrogate</span><span class="op" id="4797245">(</span><span class="ident" id="4797246">r</span><span class="op" id="4797247">)</span>&nbsp;<span class="op" id="4797249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797253">return</span>&nbsp;<span class="ident" id="4797260">replacementChar</span><span class="op" id="4797275">,</span>&nbsp;<span class="ident" id="4797277">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797297">r</span>&nbsp;<span class="op" id="4797299">-=</span>&nbsp;<span class="ident" id="4797302">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797312">return</span>&nbsp;<span class="ident" id="4797319">surr1</span>&nbsp;<span class="op" id="4797325">+</span>&nbsp;<span class="op" id="4797327">(</span><span class="ident" id="4797328">r</span><span class="op" id="4797329">&gt;&gt;</span><span class="num" id="4797331">10</span><span class="op" id="4797333">)</span><span class="op" id="4797334">&amp;</span><span class="num" id="4797335">0x3ff</span><span class="op" id="4797340">,</span>&nbsp;<span class="ident" id="4797342">surr2</span>&nbsp;<span class="op" id="4797348">+</span>&nbsp;<span class="ident" id="4797350">r</span><span class="op" id="4797351">&amp;</span><span class="num" id="4797352">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="4797358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4797361">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4797437">func</span>&nbsp;<span class="ident" id="4797442">Encode</span><span class="op" id="4797448">(</span><span class="ident" id="4797449">s</span>&nbsp;<span class="op" id="4797451">[</span><span class="op" id="4797452">]</span><span class="builtintype" id="4797453">rune</span><span class="op" id="4797457">)</span>&nbsp;<span class="op" id="4797459">[</span><span class="op" id="4797460">]</span><span class="builtintype" id="4797461">uint16</span>&nbsp;<span class="op" id="4797468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797471">n</span>&nbsp;<span class="op" id="4797473">:=</span>&nbsp;<span class="builtinfunc" id="4797476">len</span><span class="op" id="4797479">(</span><span class="ident" id="4797480">s</span><span class="op" id="4797481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797484">for</span>&nbsp;<span class="ident" id="4797488">_</span><span class="op" id="4797489">,</span>&nbsp;<span class="ident" id="4797491">v</span>&nbsp;<span class="op" id="4797493">:=</span>&nbsp;<span class="keyword" id="4797496">range</span>&nbsp;<span class="ident" id="4797502">s</span>&nbsp;<span class="op" id="4797504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797508">if</span>&nbsp;<span class="ident" id="4797511">v</span>&nbsp;<span class="op" id="4797513">&gt;=</span>&nbsp;<span class="ident" id="4797516">surrSelf</span>&nbsp;<span class="op" id="4797525">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797530">n</span><span class="op" id="4797531">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797543">a</span>&nbsp;<span class="op" id="4797545">:=</span>&nbsp;<span class="builtinfunc" id="4797548">make</span><span class="op" id="4797552">(</span><span class="op" id="4797553">[</span><span class="op" id="4797554">]</span><span class="builtintype" id="4797555">uint16</span><span class="op" id="4797561">,</span>&nbsp;<span class="ident" id="4797563">n</span><span class="op" id="4797564">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797567">n</span>&nbsp;<span class="op" id="4797569">=</span>&nbsp;<span class="num" id="4797571">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797574">for</span>&nbsp;<span class="ident" id="4797578">_</span><span class="op" id="4797579">,</span>&nbsp;<span class="ident" id="4797581">v</span>&nbsp;<span class="op" id="4797583">:=</span>&nbsp;<span class="keyword" id="4797586">range</span>&nbsp;<span class="ident" id="4797592">s</span>&nbsp;<span class="op" id="4797594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797598">switch</span>&nbsp;<span class="op" id="4797605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797609">case</span>&nbsp;<span class="ident" id="4797614">v</span>&nbsp;<span class="op" id="4797616">&lt;</span>&nbsp;<span class="num" id="4797618">0</span><span class="op" id="4797619">,</span>&nbsp;<span class="ident" id="4797621">surr1</span>&nbsp;<span class="op" id="4797627">&lt;=</span>&nbsp;<span class="ident" id="4797630">v</span>&nbsp;<span class="op" id="4797632">&amp;&amp;</span>&nbsp;<span class="ident" id="4797635">v</span>&nbsp;<span class="op" id="4797637">&lt;</span>&nbsp;<span class="ident" id="4797639">surr3</span><span class="op" id="4797644">,</span>&nbsp;<span class="ident" id="4797646">v</span>&nbsp;<span class="op" id="4797648">&gt;</span>&nbsp;<span class="ident" id="4797650">maxRune</span><span class="op" id="4797657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797662">v</span>&nbsp;<span class="op" id="4797664">=</span>&nbsp;<span class="ident" id="4797666">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797685">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797699">case</span>&nbsp;<span class="ident" id="4797704">v</span>&nbsp;<span class="op" id="4797706">&lt;</span>&nbsp;<span class="ident" id="4797708">surrSelf</span><span class="op" id="4797716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797721">a</span><span class="op" id="4797722">[</span><span class="ident" id="4797723">n</span><span class="op" id="4797724">]</span>&nbsp;<span class="op" id="4797726">=</span>&nbsp;<span class="builtintype" id="4797728">uint16</span><span class="op" id="4797734">(</span><span class="ident" id="4797735">v</span><span class="op" id="4797736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797741">n</span><span class="op" id="4797742">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797747">default</span><span class="op" id="4797754">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797759">r1</span><span class="op" id="4797761">,</span>&nbsp;<span class="ident" id="4797763">r2</span>&nbsp;<span class="op" id="4797766">:=</span>&nbsp;<span class="ident" id="4797769">EncodeRune</span><span class="op" id="4797779">(</span><span class="ident" id="4797780">v</span><span class="op" id="4797781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797786">a</span><span class="op" id="4797787">[</span><span class="ident" id="4797788">n</span><span class="op" id="4797789">]</span>&nbsp;<span class="op" id="4797791">=</span>&nbsp;<span class="builtintype" id="4797793">uint16</span><span class="op" id="4797799">(</span><span class="ident" id="4797800">r1</span><span class="op" id="4797802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797807">a</span><span class="op" id="4797808">[</span><span class="ident" id="4797809">n</span><span class="op" id="4797810">+</span><span class="num" id="4797811">1</span><span class="op" id="4797812">]</span>&nbsp;<span class="op" id="4797814">=</span>&nbsp;<span class="builtintype" id="4797816">uint16</span><span class="op" id="4797822">(</span><span class="ident" id="4797823">r2</span><span class="op" id="4797825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797830">n</span>&nbsp;<span class="op" id="4797832">+=</span>&nbsp;<span class="num" id="4797835">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797839">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797845">return</span>&nbsp;<span class="ident" id="4797852">a</span><span class="op" id="4797853">[</span><span class="num" id="4797854">0</span><span class="op" id="4797855">:</span><span class="ident" id="4797856">n</span><span class="op" id="4797857">]</span><br>
<span class="lineno"></span><span class="op" id="4797859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4797862">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="4797924">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4797953">func</span>&nbsp;<span class="ident" id="4797958">Decode</span><span class="op" id="4797964">(</span><span class="ident" id="4797965">s</span>&nbsp;<span class="op" id="4797967">[</span><span class="op" id="4797968">]</span><span class="builtintype" id="4797969">uint16</span><span class="op" id="4797975">)</span>&nbsp;<span class="op" id="4797977">[</span><span class="op" id="4797978">]</span><span class="builtintype" id="4797979">rune</span>&nbsp;<span class="op" id="4797984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797987">a</span>&nbsp;<span class="op" id="4797989">:=</span>&nbsp;<span class="builtinfunc" id="4797992">make</span><span class="op" id="4797996">(</span><span class="op" id="4797997">[</span><span class="op" id="4797998">]</span><span class="builtintype" id="4797999">rune</span><span class="op" id="4798003">,</span>&nbsp;<span class="builtinfunc" id="4798005">len</span><span class="op" id="4798008">(</span><span class="ident" id="4798009">s</span><span class="op" id="4798010">)</span><span class="op" id="4798011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798014">n</span>&nbsp;<span class="op" id="4798016">:=</span>&nbsp;<span class="num" id="4798019">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798022">for</span>&nbsp;<span class="ident" id="4798026">i</span>&nbsp;<span class="op" id="4798028">:=</span>&nbsp;<span class="num" id="4798031">0</span><span class="op" id="4798032">;</span>&nbsp;<span class="ident" id="4798034">i</span>&nbsp;<span class="op" id="4798036">&lt;</span>&nbsp;<span class="builtinfunc" id="4798038">len</span><span class="op" id="4798041">(</span><span class="ident" id="4798042">s</span><span class="op" id="4798043">)</span><span class="op" id="4798044">;</span>&nbsp;<span class="ident" id="4798046">i</span><span class="op" id="4798047">++</span>&nbsp;<span class="op" id="4798050">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798054">switch</span>&nbsp;<span class="ident" id="4798061">r</span>&nbsp;<span class="op" id="4798063">:=</span>&nbsp;<span class="ident" id="4798066">s</span><span class="op" id="4798067">[</span><span class="ident" id="4798068">i</span><span class="op" id="4798069">]</span><span class="op" id="4798070">;</span>&nbsp;<span class="op" id="4798072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798076">case</span>&nbsp;<span class="ident" id="4798081">surr1</span>&nbsp;<span class="op" id="4798087">&lt;=</span>&nbsp;<span class="ident" id="4798090">r</span>&nbsp;<span class="op" id="4798092">&amp;&amp;</span>&nbsp;<span class="ident" id="4798095">r</span>&nbsp;<span class="op" id="4798097">&lt;</span>&nbsp;<span class="ident" id="4798099">surr2</span>&nbsp;<span class="op" id="4798105">&amp;&amp;</span>&nbsp;<span class="ident" id="4798108">i</span><span class="op" id="4798109">+</span><span class="num" id="4798110">1</span>&nbsp;<span class="op" id="4798112">&lt;</span>&nbsp;<span class="builtinfunc" id="4798114">len</span><span class="op" id="4798117">(</span><span class="ident" id="4798118">s</span><span class="op" id="4798119">)</span>&nbsp;<span class="op" id="4798121">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798127">surr2</span>&nbsp;<span class="op" id="4798133">&lt;=</span>&nbsp;<span class="ident" id="4798136">s</span><span class="op" id="4798137">[</span><span class="ident" id="4798138">i</span><span class="op" id="4798139">+</span><span class="num" id="4798140">1</span><span class="op" id="4798141">]</span>&nbsp;<span class="op" id="4798143">&amp;&amp;</span>&nbsp;<span class="ident" id="4798146">s</span><span class="op" id="4798147">[</span><span class="ident" id="4798148">i</span><span class="op" id="4798149">+</span><span class="num" id="4798150">1</span><span class="op" id="4798151">]</span>&nbsp;<span class="op" id="4798153">&lt;</span>&nbsp;<span class="ident" id="4798155">surr3</span><span class="op" id="4798160">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4798165">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798196">a</span><span class="op" id="4798197">[</span><span class="ident" id="4798198">n</span><span class="op" id="4798199">]</span>&nbsp;<span class="op" id="4798201">=</span>&nbsp;<span class="ident" id="4798203">DecodeRune</span><span class="op" id="4798213">(</span><span class="builtintype" id="4798214">rune</span><span class="op" id="4798218">(</span><span class="ident" id="4798219">r</span><span class="op" id="4798220">)</span><span class="op" id="4798221">,</span>&nbsp;<span class="builtintype" id="4798223">rune</span><span class="op" id="4798227">(</span><span class="ident" id="4798228">s</span><span class="op" id="4798229">[</span><span class="ident" id="4798230">i</span><span class="op" id="4798231">+</span><span class="num" id="4798232">1</span><span class="op" id="4798233">]</span><span class="op" id="4798234">)</span><span class="op" id="4798235">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798240">i</span><span class="op" id="4798241">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798247">n</span><span class="op" id="4798248">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798253">case</span>&nbsp;<span class="ident" id="4798258">surr1</span>&nbsp;<span class="op" id="4798264">&lt;=</span>&nbsp;<span class="ident" id="4798267">r</span>&nbsp;<span class="op" id="4798269">&amp;&amp;</span>&nbsp;<span class="ident" id="4798272">r</span>&nbsp;<span class="op" id="4798274">&lt;</span>&nbsp;<span class="ident" id="4798276">surr3</span><span class="op" id="4798281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4798286">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798319">a</span><span class="op" id="4798320">[</span><span class="ident" id="4798321">n</span><span class="op" id="4798322">]</span>&nbsp;<span class="op" id="4798324">=</span>&nbsp;<span class="ident" id="4798326">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798345">n</span><span class="op" id="4798346">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798351">default</span><span class="op" id="4798358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4798363">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798381">a</span><span class="op" id="4798382">[</span><span class="ident" id="4798383">n</span><span class="op" id="4798384">]</span>&nbsp;<span class="op" id="4798386">=</span>&nbsp;<span class="builtintype" id="4798388">rune</span><span class="op" id="4798392">(</span><span class="ident" id="4798393">r</span><span class="op" id="4798394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798399">n</span><span class="op" id="4798400">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798411">return</span>&nbsp;<span class="ident" id="4798418">a</span><span class="op" id="4798419">[</span><span class="num" id="4798420">0</span><span class="op" id="4798421">:</span><span class="ident" id="4798422">n</span><span class="op" id="4798423">]</span><br>
<span class="lineno"></span><span class="op" id="4798425">}</span>
</div>
</body>
</html>
