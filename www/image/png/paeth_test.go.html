<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8107892">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8107947">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8108001">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8108052">package</span>&nbsp;<span class="ident" id="8108060">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8108065">import</span>&nbsp;<span class="op" id="8108072">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8108075">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8108084">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8108097">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8108107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8108110">func</span>&nbsp;<span class="ident" id="8108115">slowAbs</span><span class="op" id="8108122">(</span><span class="ident" id="8108123">x</span>&nbsp;<span class="builtintype" id="8108125">int</span><span class="op" id="8108128">)</span>&nbsp;<span class="builtintype" id="8108130">int</span>&nbsp;<span class="op" id="8108134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108137">if</span>&nbsp;<span class="ident" id="8108140">x</span>&nbsp;<span class="op" id="8108142">&lt;</span>&nbsp;<span class="num" id="8108144">0</span>&nbsp;<span class="op" id="8108146">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108150">return</span>&nbsp;<span class="op" id="8108157">-</span><span class="ident" id="8108158">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8108161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108164">return</span>&nbsp;<span class="ident" id="8108171">x</span><br>
<span class="lineno"></span><span class="op" id="8108173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="8108176">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="8108248">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="8108322">func</span>&nbsp;<span class="ident" id="8108327">slowPaeth</span><span class="op" id="8108336">(</span><span class="ident" id="8108337">a</span><span class="op" id="8108338">,</span>&nbsp;<span class="ident" id="8108340">b</span><span class="op" id="8108341">,</span>&nbsp;<span class="ident" id="8108343">c</span>&nbsp;<span class="builtintype" id="8108345">uint8</span><span class="op" id="8108350">)</span>&nbsp;<span class="builtintype" id="8108352">uint8</span>&nbsp;<span class="op" id="8108358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108361">p</span>&nbsp;<span class="op" id="8108363">:=</span>&nbsp;<span class="builtintype" id="8108366">int</span><span class="op" id="8108369">(</span><span class="ident" id="8108370">a</span><span class="op" id="8108371">)</span>&nbsp;<span class="op" id="8108373">+</span>&nbsp;<span class="builtintype" id="8108375">int</span><span class="op" id="8108378">(</span><span class="ident" id="8108379">b</span><span class="op" id="8108380">)</span>&nbsp;<span class="op" id="8108382">-</span>&nbsp;<span class="builtintype" id="8108384">int</span><span class="op" id="8108387">(</span><span class="ident" id="8108388">c</span><span class="op" id="8108389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108392">pa</span>&nbsp;<span class="op" id="8108395">:=</span>&nbsp;<span class="ident" id="8108398">slowAbs</span><span class="op" id="8108405">(</span><span class="ident" id="8108406">p</span>&nbsp;<span class="op" id="8108408">-</span>&nbsp;<span class="builtintype" id="8108410">int</span><span class="op" id="8108413">(</span><span class="ident" id="8108414">a</span><span class="op" id="8108415">)</span><span class="op" id="8108416">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108419">pb</span>&nbsp;<span class="op" id="8108422">:=</span>&nbsp;<span class="ident" id="8108425">slowAbs</span><span class="op" id="8108432">(</span><span class="ident" id="8108433">p</span>&nbsp;<span class="op" id="8108435">-</span>&nbsp;<span class="builtintype" id="8108437">int</span><span class="op" id="8108440">(</span><span class="ident" id="8108441">b</span><span class="op" id="8108442">)</span><span class="op" id="8108443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108446">pc</span>&nbsp;<span class="op" id="8108449">:=</span>&nbsp;<span class="ident" id="8108452">slowAbs</span><span class="op" id="8108459">(</span><span class="ident" id="8108460">p</span>&nbsp;<span class="op" id="8108462">-</span>&nbsp;<span class="builtintype" id="8108464">int</span><span class="op" id="8108467">(</span><span class="ident" id="8108468">c</span><span class="op" id="8108469">)</span><span class="op" id="8108470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108473">if</span>&nbsp;<span class="ident" id="8108476">pa</span>&nbsp;<span class="op" id="8108479">&lt;=</span>&nbsp;<span class="ident" id="8108482">pb</span>&nbsp;<span class="op" id="8108485">&amp;&amp;</span>&nbsp;<span class="ident" id="8108488">pa</span>&nbsp;<span class="op" id="8108491">&lt;=</span>&nbsp;<span class="ident" id="8108494">pc</span>&nbsp;<span class="op" id="8108497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108501">return</span>&nbsp;<span class="ident" id="8108508">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8108511">}</span>&nbsp;<span class="keyword" id="8108513">else</span>&nbsp;<span class="keyword" id="8108518">if</span>&nbsp;<span class="ident" id="8108521">pb</span>&nbsp;<span class="op" id="8108524">&lt;=</span>&nbsp;<span class="ident" id="8108527">pc</span>&nbsp;<span class="op" id="8108530">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108534">return</span>&nbsp;<span class="ident" id="8108541">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8108544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108547">return</span>&nbsp;<span class="ident" id="8108554">c</span><br>
<span class="lineno"></span><span class="op" id="8108556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="8108559">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="8108635">func</span>&nbsp;<span class="ident" id="8108640">slowFilterPaeth</span><span class="op" id="8108655">(</span><span class="ident" id="8108656">cdat</span><span class="op" id="8108660">,</span>&nbsp;<span class="ident" id="8108662">pdat</span>&nbsp;<span class="op" id="8108667">[</span><span class="op" id="8108668">]</span><span class="builtintype" id="8108669">byte</span><span class="op" id="8108673">,</span>&nbsp;<span class="ident" id="8108675">bytesPerPixel</span>&nbsp;<span class="builtintype" id="8108689">int</span><span class="op" id="8108692">)</span>&nbsp;<span class="op" id="8108694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108697">for</span>&nbsp;<span class="ident" id="8108701">i</span>&nbsp;<span class="op" id="8108703">:=</span>&nbsp;<span class="num" id="8108706">0</span><span class="op" id="8108707">;</span>&nbsp;<span class="ident" id="8108709">i</span>&nbsp;<span class="op" id="8108711">&lt;</span>&nbsp;<span class="ident" id="8108713">bytesPerPixel</span><span class="op" id="8108726">;</span>&nbsp;<span class="ident" id="8108728">i</span><span class="op" id="8108729">++</span>&nbsp;<span class="op" id="8108732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108736">cdat</span><span class="op" id="8108740">[</span><span class="ident" id="8108741">i</span><span class="op" id="8108742">]</span>&nbsp;<span class="op" id="8108744">+=</span>&nbsp;<span class="ident" id="8108747">paeth</span><span class="op" id="8108752">(</span><span class="num" id="8108753">0</span><span class="op" id="8108754">,</span>&nbsp;<span class="ident" id="8108756">pdat</span><span class="op" id="8108760">[</span><span class="ident" id="8108761">i</span><span class="op" id="8108762">]</span><span class="op" id="8108763">,</span>&nbsp;<span class="num" id="8108765">0</span><span class="op" id="8108766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8108769">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108772">for</span>&nbsp;<span class="ident" id="8108776">i</span>&nbsp;<span class="op" id="8108778">:=</span>&nbsp;<span class="ident" id="8108781">bytesPerPixel</span><span class="op" id="8108794">;</span>&nbsp;<span class="ident" id="8108796">i</span>&nbsp;<span class="op" id="8108798">&lt;</span>&nbsp;<span class="builtinfunc" id="8108800">len</span><span class="op" id="8108803">(</span><span class="ident" id="8108804">cdat</span><span class="op" id="8108808">)</span><span class="op" id="8108809">;</span>&nbsp;<span class="ident" id="8108811">i</span><span class="op" id="8108812">++</span>&nbsp;<span class="op" id="8108815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8108819">cdat</span><span class="op" id="8108823">[</span><span class="ident" id="8108824">i</span><span class="op" id="8108825">]</span>&nbsp;<span class="op" id="8108827">+=</span>&nbsp;<span class="ident" id="8108830">paeth</span><span class="op" id="8108835">(</span><span class="ident" id="8108836">cdat</span><span class="op" id="8108840">[</span><span class="ident" id="8108841">i</span><span class="op" id="8108842">-</span><span class="ident" id="8108843">bytesPerPixel</span><span class="op" id="8108856">]</span><span class="op" id="8108857">,</span>&nbsp;<span class="ident" id="8108859">pdat</span><span class="op" id="8108863">[</span><span class="ident" id="8108864">i</span><span class="op" id="8108865">]</span><span class="op" id="8108866">,</span>&nbsp;<span class="ident" id="8108868">pdat</span><span class="op" id="8108872">[</span><span class="ident" id="8108873">i</span><span class="op" id="8108874">-</span><span class="ident" id="8108875">bytesPerPixel</span><span class="op" id="8108888">]</span><span class="op" id="8108889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8108892">}</span><br>
<span class="lineno"></span><span class="op" id="8108894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="8108897">func</span>&nbsp;<span class="ident" id="8108902">TestPaeth</span><span class="op" id="8108911">(</span><span class="ident" id="8108912">t</span>&nbsp;<span class="op" id="8108914">*</span><span class="ident" id="8108915">testing</span><span class="op" id="8108922">.</span><span class="ident" id="8108923">T</span><span class="op" id="8108924">)</span>&nbsp;<span class="op" id="8108926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108929">for</span>&nbsp;<span class="ident" id="8108933">a</span>&nbsp;<span class="op" id="8108935">:=</span>&nbsp;<span class="num" id="8108938">0</span><span class="op" id="8108939">;</span>&nbsp;<span class="ident" id="8108941">a</span>&nbsp;<span class="op" id="8108943">&lt;</span>&nbsp;<span class="num" id="8108945">256</span><span class="op" id="8108948">;</span>&nbsp;<span class="ident" id="8108950">a</span>&nbsp;<span class="op" id="8108952">+=</span>&nbsp;<span class="num" id="8108955">15</span>&nbsp;<span class="op" id="8108958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108962">for</span>&nbsp;<span class="ident" id="8108966">b</span>&nbsp;<span class="op" id="8108968">:=</span>&nbsp;<span class="num" id="8108971">0</span><span class="op" id="8108972">;</span>&nbsp;<span class="ident" id="8108974">b</span>&nbsp;<span class="op" id="8108976">&lt;</span>&nbsp;<span class="num" id="8108978">256</span><span class="op" id="8108981">;</span>&nbsp;<span class="ident" id="8108983">b</span>&nbsp;<span class="op" id="8108985">+=</span>&nbsp;<span class="num" id="8108988">15</span>&nbsp;<span class="op" id="8108991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8108996">for</span>&nbsp;<span class="ident" id="8109000">c</span>&nbsp;<span class="op" id="8109002">:=</span>&nbsp;<span class="num" id="8109005">0</span><span class="op" id="8109006">;</span>&nbsp;<span class="ident" id="8109008">c</span>&nbsp;<span class="op" id="8109010">&lt;</span>&nbsp;<span class="num" id="8109012">256</span><span class="op" id="8109015">;</span>&nbsp;<span class="ident" id="8109017">c</span>&nbsp;<span class="op" id="8109019">+=</span>&nbsp;<span class="num" id="8109022">15</span>&nbsp;<span class="op" id="8109025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109031">got</span>&nbsp;<span class="op" id="8109035">:=</span>&nbsp;<span class="ident" id="8109038">paeth</span><span class="op" id="8109043">(</span><span class="builtintype" id="8109044">uint8</span><span class="op" id="8109049">(</span><span class="ident" id="8109050">a</span><span class="op" id="8109051">)</span><span class="op" id="8109052">,</span>&nbsp;<span class="builtintype" id="8109054">uint8</span><span class="op" id="8109059">(</span><span class="ident" id="8109060">b</span><span class="op" id="8109061">)</span><span class="op" id="8109062">,</span>&nbsp;<span class="builtintype" id="8109064">uint8</span><span class="op" id="8109069">(</span><span class="ident" id="8109070">c</span><span class="op" id="8109071">)</span><span class="op" id="8109072">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109078">want</span>&nbsp;<span class="op" id="8109083">:=</span>&nbsp;<span class="ident" id="8109086">slowPaeth</span><span class="op" id="8109095">(</span><span class="builtintype" id="8109096">uint8</span><span class="op" id="8109101">(</span><span class="ident" id="8109102">a</span><span class="op" id="8109103">)</span><span class="op" id="8109104">,</span>&nbsp;<span class="builtintype" id="8109106">uint8</span><span class="op" id="8109111">(</span><span class="ident" id="8109112">b</span><span class="op" id="8109113">)</span><span class="op" id="8109114">,</span>&nbsp;<span class="builtintype" id="8109116">uint8</span><span class="op" id="8109121">(</span><span class="ident" id="8109122">c</span><span class="op" id="8109123">)</span><span class="op" id="8109124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109130">if</span>&nbsp;<span class="ident" id="8109133">got</span>&nbsp;<span class="op" id="8109137">!=</span>&nbsp;<span class="ident" id="8109140">want</span>&nbsp;<span class="op" id="8109145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109152">t</span><span class="op" id="8109153">.</span><span class="ident" id="8109154">Errorf</span><span class="op" id="8109160">(</span><span class="string" id="8109161">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8109200">,</span>&nbsp;<span class="ident" id="8109202">a</span><span class="op" id="8109203">,</span>&nbsp;<span class="ident" id="8109205">b</span><span class="op" id="8109206">,</span>&nbsp;<span class="ident" id="8109208">c</span><span class="op" id="8109209">,</span>&nbsp;<span class="ident" id="8109211">got</span><span class="op" id="8109214">,</span>&nbsp;<span class="ident" id="8109216">want</span><span class="op" id="8109220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109231">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109238">}</span><br>
<span class="lineno"></span><span class="op" id="8109240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8109243">func</span>&nbsp;<span class="ident" id="8109248">BenchmarkPaeth</span><span class="op" id="8109262">(</span><span class="ident" id="8109263">b</span>&nbsp;<span class="op" id="8109265">*</span><span class="ident" id="8109266">testing</span><span class="op" id="8109273">.</span><span class="ident" id="8109274">B</span><span class="op" id="8109275">)</span>&nbsp;<span class="op" id="8109277">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109280">for</span>&nbsp;<span class="ident" id="8109284">i</span>&nbsp;<span class="op" id="8109286">:=</span>&nbsp;<span class="num" id="8109289">0</span><span class="op" id="8109290">;</span>&nbsp;<span class="ident" id="8109292">i</span>&nbsp;<span class="op" id="8109294">&lt;</span>&nbsp;<span class="ident" id="8109296">b</span><span class="op" id="8109297">.</span><span class="ident" id="8109298">N</span><span class="op" id="8109299">;</span>&nbsp;<span class="ident" id="8109301">i</span><span class="op" id="8109302">++</span>&nbsp;<span class="op" id="8109305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109309">paeth</span><span class="op" id="8109314">(</span><span class="builtintype" id="8109315">uint8</span><span class="op" id="8109320">(</span><span class="ident" id="8109321">i</span><span class="op" id="8109322">&gt;&gt;</span><span class="num" id="8109324">16</span><span class="op" id="8109326">)</span><span class="op" id="8109327">,</span>&nbsp;<span class="builtintype" id="8109329">uint8</span><span class="op" id="8109334">(</span><span class="ident" id="8109335">i</span><span class="op" id="8109336">&gt;&gt;</span><span class="num" id="8109338">8</span><span class="op" id="8109339">)</span><span class="op" id="8109340">,</span>&nbsp;<span class="builtintype" id="8109342">uint8</span><span class="op" id="8109347">(</span><span class="ident" id="8109348">i</span><span class="op" id="8109349">)</span><span class="op" id="8109350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109353">}</span><br>
<span class="lineno"></span><span class="op" id="8109355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8109358">func</span>&nbsp;<span class="ident" id="8109363">TestPaethDecode</span><span class="op" id="8109378">(</span><span class="ident" id="8109379">t</span>&nbsp;<span class="op" id="8109381">*</span><span class="ident" id="8109382">testing</span><span class="op" id="8109389">.</span><span class="ident" id="8109390">T</span><span class="op" id="8109391">)</span>&nbsp;<span class="op" id="8109393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109396">pdat0</span>&nbsp;<span class="op" id="8109402">:=</span>&nbsp;<span class="builtinfunc" id="8109405">make</span><span class="op" id="8109409">(</span><span class="op" id="8109410">[</span><span class="op" id="8109411">]</span><span class="builtintype" id="8109412">byte</span><span class="op" id="8109416">,</span>&nbsp;<span class="num" id="8109418">32</span><span class="op" id="8109420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109423">pdat1</span>&nbsp;<span class="op" id="8109429">:=</span>&nbsp;<span class="builtinfunc" id="8109432">make</span><span class="op" id="8109436">(</span><span class="op" id="8109437">[</span><span class="op" id="8109438">]</span><span class="builtintype" id="8109439">byte</span><span class="op" id="8109443">,</span>&nbsp;<span class="num" id="8109445">32</span><span class="op" id="8109447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109450">pdat2</span>&nbsp;<span class="op" id="8109456">:=</span>&nbsp;<span class="builtinfunc" id="8109459">make</span><span class="op" id="8109463">(</span><span class="op" id="8109464">[</span><span class="op" id="8109465">]</span><span class="builtintype" id="8109466">byte</span><span class="op" id="8109470">,</span>&nbsp;<span class="num" id="8109472">32</span><span class="op" id="8109474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109477">cdat0</span>&nbsp;<span class="op" id="8109483">:=</span>&nbsp;<span class="builtinfunc" id="8109486">make</span><span class="op" id="8109490">(</span><span class="op" id="8109491">[</span><span class="op" id="8109492">]</span><span class="builtintype" id="8109493">byte</span><span class="op" id="8109497">,</span>&nbsp;<span class="num" id="8109499">32</span><span class="op" id="8109501">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109504">cdat1</span>&nbsp;<span class="op" id="8109510">:=</span>&nbsp;<span class="builtinfunc" id="8109513">make</span><span class="op" id="8109517">(</span><span class="op" id="8109518">[</span><span class="op" id="8109519">]</span><span class="builtintype" id="8109520">byte</span><span class="op" id="8109524">,</span>&nbsp;<span class="num" id="8109526">32</span><span class="op" id="8109528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109531">cdat2</span>&nbsp;<span class="op" id="8109537">:=</span>&nbsp;<span class="builtinfunc" id="8109540">make</span><span class="op" id="8109544">(</span><span class="op" id="8109545">[</span><span class="op" id="8109546">]</span><span class="builtintype" id="8109547">byte</span><span class="op" id="8109551">,</span>&nbsp;<span class="num" id="8109553">32</span><span class="op" id="8109555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109558">r</span>&nbsp;<span class="op" id="8109560">:=</span>&nbsp;<span class="ident" id="8109563">rand</span><span class="op" id="8109567">.</span><span class="ident" id="8109568">New</span><span class="op" id="8109571">(</span><span class="ident" id="8109572">rand</span><span class="op" id="8109576">.</span><span class="ident" id="8109577">NewSource</span><span class="op" id="8109586">(</span><span class="num" id="8109587">1</span><span class="op" id="8109588">)</span><span class="op" id="8109589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109592">for</span>&nbsp;<span class="ident" id="8109596">bytesPerPixel</span>&nbsp;<span class="op" id="8109610">:=</span>&nbsp;<span class="num" id="8109613">1</span><span class="op" id="8109614">;</span>&nbsp;<span class="ident" id="8109616">bytesPerPixel</span>&nbsp;<span class="op" id="8109630">&lt;=</span>&nbsp;<span class="num" id="8109633">8</span><span class="op" id="8109634">;</span>&nbsp;<span class="ident" id="8109636">bytesPerPixel</span><span class="op" id="8109649">++</span>&nbsp;<span class="op" id="8109652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109656">for</span>&nbsp;<span class="ident" id="8109660">i</span>&nbsp;<span class="op" id="8109662">:=</span>&nbsp;<span class="num" id="8109665">0</span><span class="op" id="8109666">;</span>&nbsp;<span class="ident" id="8109668">i</span>&nbsp;<span class="op" id="8109670">&lt;</span>&nbsp;<span class="num" id="8109672">100</span><span class="op" id="8109675">;</span>&nbsp;<span class="ident" id="8109677">i</span><span class="op" id="8109678">++</span>&nbsp;<span class="op" id="8109681">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109686">for</span>&nbsp;<span class="ident" id="8109690">j</span>&nbsp;<span class="op" id="8109692">:=</span>&nbsp;<span class="keyword" id="8109695">range</span>&nbsp;<span class="ident" id="8109701">pdat0</span>&nbsp;<span class="op" id="8109707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109713">pdat0</span><span class="op" id="8109718">[</span><span class="ident" id="8109719">j</span><span class="op" id="8109720">]</span>&nbsp;<span class="op" id="8109722">=</span>&nbsp;<span class="builtintype" id="8109724">uint8</span><span class="op" id="8109729">(</span><span class="ident" id="8109730">r</span><span class="op" id="8109731">.</span><span class="ident" id="8109732">Uint32</span><span class="op" id="8109738">(</span><span class="op" id="8109739">)</span><span class="op" id="8109740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109746">cdat0</span><span class="op" id="8109751">[</span><span class="ident" id="8109752">j</span><span class="op" id="8109753">]</span>&nbsp;<span class="op" id="8109755">=</span>&nbsp;<span class="builtintype" id="8109757">uint8</span><span class="op" id="8109762">(</span><span class="ident" id="8109763">r</span><span class="op" id="8109764">.</span><span class="ident" id="8109765">Uint32</span><span class="op" id="8109771">(</span><span class="op" id="8109772">)</span><span class="op" id="8109773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8109783">copy</span><span class="op" id="8109787">(</span><span class="ident" id="8109788">pdat1</span><span class="op" id="8109793">,</span>&nbsp;<span class="ident" id="8109795">pdat0</span><span class="op" id="8109800">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8109805">copy</span><span class="op" id="8109809">(</span><span class="ident" id="8109810">pdat2</span><span class="op" id="8109815">,</span>&nbsp;<span class="ident" id="8109817">pdat0</span><span class="op" id="8109822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8109827">copy</span><span class="op" id="8109831">(</span><span class="ident" id="8109832">cdat1</span><span class="op" id="8109837">,</span>&nbsp;<span class="ident" id="8109839">cdat0</span><span class="op" id="8109844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8109849">copy</span><span class="op" id="8109853">(</span><span class="ident" id="8109854">cdat2</span><span class="op" id="8109859">,</span>&nbsp;<span class="ident" id="8109861">cdat0</span><span class="op" id="8109866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109871">filterPaeth</span><span class="op" id="8109882">(</span><span class="ident" id="8109883">cdat1</span><span class="op" id="8109888">,</span>&nbsp;<span class="ident" id="8109890">pdat1</span><span class="op" id="8109895">,</span>&nbsp;<span class="ident" id="8109897">bytesPerPixel</span><span class="op" id="8109910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109915">slowFilterPaeth</span><span class="op" id="8109930">(</span><span class="ident" id="8109931">cdat2</span><span class="op" id="8109936">,</span>&nbsp;<span class="ident" id="8109938">pdat2</span><span class="op" id="8109943">,</span>&nbsp;<span class="ident" id="8109945">bytesPerPixel</span><span class="op" id="8109958">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109963">if</span>&nbsp;<span class="op" id="8109966">!</span><span class="ident" id="8109967">bytes</span><span class="op" id="8109972">.</span><span class="ident" id="8109973">Equal</span><span class="op" id="8109978">(</span><span class="ident" id="8109979">cdat1</span><span class="op" id="8109984">,</span>&nbsp;<span class="ident" id="8109986">cdat2</span><span class="op" id="8109991">)</span>&nbsp;<span class="op" id="8109993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109999">t</span><span class="op" id="8110000">.</span><span class="ident" id="8110001">Errorf</span><span class="op" id="8110007">(</span><span class="string" id="8110008">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="8110075">,</span>&nbsp;<span class="ident" id="8110077">bytesPerPixel</span><span class="op" id="8110090">,</span>&nbsp;<span class="ident" id="8110092">pdat0</span><span class="op" id="8110097">,</span>&nbsp;<span class="ident" id="8110099">cdat0</span><span class="op" id="8110104">,</span>&nbsp;<span class="ident" id="8110106">cdat1</span><span class="op" id="8110111">,</span>&nbsp;<span class="ident" id="8110113">cdat2</span><span class="op" id="8110118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8110124">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110137">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110140">}</span><br>
<span class="lineno"></span><span class="op" id="8110142">}</span>
</div>
</body>
</html>
