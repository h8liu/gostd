<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6616772">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6616827">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6616881">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6616932">package</span>&nbsp;<span class="ident" id="6616940">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6616945">import</span>&nbsp;<span class="op" id="6616952">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6616955">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6616971">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6616981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6616984">type</span>&nbsp;<span class="ident" id="6616989">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="6617018">struct</span>&nbsp;<span class="op" id="6617025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617028">in</span><span class="op" id="6617030">,</span>&nbsp;<span class="ident" id="6617032">out1</span><span class="op" id="6617036">,</span>&nbsp;<span class="ident" id="6617038">out2</span>&nbsp;<span class="builtintype" id="6617043">string</span><br>
<span class="lineno"></span><span class="op" id="6617050">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6617053">var</span>&nbsp;<span class="ident" id="6617057">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6617087">=</span>&nbsp;<span class="op" id="6617089">[</span><span class="op" id="6617090">]</span><span class="ident" id="6617091">testSplitPreMasterSecretTest</span><span class="op" id="6617119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617122">{</span><span class="string" id="6617123">&#34;&#34;</span><span class="op" id="6617125">,</span>&nbsp;<span class="string" id="6617127">&#34;&#34;</span><span class="op" id="6617129">,</span>&nbsp;<span class="string" id="6617131">&#34;&#34;</span><span class="op" id="6617133">}</span><span class="op" id="6617134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617137">{</span><span class="string" id="6617138">&#34;00&#34;</span><span class="op" id="6617142">,</span>&nbsp;<span class="string" id="6617144">&#34;00&#34;</span><span class="op" id="6617148">,</span>&nbsp;<span class="string" id="6617150">&#34;00&#34;</span><span class="op" id="6617154">}</span><span class="op" id="6617155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617158">{</span><span class="string" id="6617159">&#34;0011&#34;</span><span class="op" id="6617165">,</span>&nbsp;<span class="string" id="6617167">&#34;00&#34;</span><span class="op" id="6617171">,</span>&nbsp;<span class="string" id="6617173">&#34;11&#34;</span><span class="op" id="6617177">}</span><span class="op" id="6617178">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617181">{</span><span class="string" id="6617182">&#34;001122&#34;</span><span class="op" id="6617190">,</span>&nbsp;<span class="string" id="6617192">&#34;0011&#34;</span><span class="op" id="6617198">,</span>&nbsp;<span class="string" id="6617200">&#34;1122&#34;</span><span class="op" id="6617206">}</span><span class="op" id="6617207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617210">{</span><span class="string" id="6617211">&#34;00112233&#34;</span><span class="op" id="6617221">,</span>&nbsp;<span class="string" id="6617223">&#34;0011&#34;</span><span class="op" id="6617229">,</span>&nbsp;<span class="string" id="6617231">&#34;2233&#34;</span><span class="op" id="6617237">}</span><span class="op" id="6617238">,</span><br>
<span class="lineno"></span><span class="op" id="6617240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6617243">func</span>&nbsp;<span class="ident" id="6617248">TestSplitPreMasterSecret</span><span class="op" id="6617272">(</span><span class="ident" id="6617273">t</span>&nbsp;<span class="op" id="6617275">*</span><span class="ident" id="6617276">testing</span><span class="op" id="6617283">.</span><span class="ident" id="6617284">T</span><span class="op" id="6617285">)</span>&nbsp;<span class="op" id="6617287">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6617290">for</span>&nbsp;<span class="ident" id="6617294">i</span><span class="op" id="6617295">,</span>&nbsp;<span class="ident" id="6617297">test</span>&nbsp;<span class="op" id="6617302">:=</span>&nbsp;<span class="keyword" id="6617305">range</span>&nbsp;<span class="ident" id="6617311">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6617341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617345">in</span><span class="op" id="6617347">,</span>&nbsp;<span class="ident" id="6617349">_</span>&nbsp;<span class="op" id="6617351">:=</span>&nbsp;<span class="ident" id="6617354">hex</span><span class="op" id="6617357">.</span><span class="ident" id="6617358">DecodeString</span><span class="op" id="6617370">(</span><span class="ident" id="6617371">test</span><span class="op" id="6617375">.</span><span class="ident" id="6617376">in</span><span class="op" id="6617378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617382">out1</span><span class="op" id="6617386">,</span>&nbsp;<span class="ident" id="6617388">out2</span>&nbsp;<span class="op" id="6617393">:=</span>&nbsp;<span class="ident" id="6617396">splitPreMasterSecret</span><span class="op" id="6617416">(</span><span class="ident" id="6617417">in</span><span class="op" id="6617419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617423">s1</span>&nbsp;<span class="op" id="6617426">:=</span>&nbsp;<span class="ident" id="6617429">hex</span><span class="op" id="6617432">.</span><span class="ident" id="6617433">EncodeToString</span><span class="op" id="6617447">(</span><span class="ident" id="6617448">out1</span><span class="op" id="6617452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617456">s2</span>&nbsp;<span class="op" id="6617459">:=</span>&nbsp;<span class="ident" id="6617462">hex</span><span class="op" id="6617465">.</span><span class="ident" id="6617466">EncodeToString</span><span class="op" id="6617480">(</span><span class="ident" id="6617481">out2</span><span class="op" id="6617485">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6617489">if</span>&nbsp;<span class="ident" id="6617492">s1</span>&nbsp;<span class="op" id="6617495">!=</span>&nbsp;<span class="ident" id="6617498">test</span><span class="op" id="6617502">.</span><span class="ident" id="6617503">out1</span>&nbsp;<span class="op" id="6617508">||</span>&nbsp;<span class="ident" id="6617511">s2</span>&nbsp;<span class="op" id="6617514">!=</span>&nbsp;<span class="ident" id="6617517">test</span><span class="op" id="6617521">.</span><span class="ident" id="6617522">out2</span>&nbsp;<span class="op" id="6617527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617532">t</span><span class="op" id="6617533">.</span><span class="ident" id="6617534">Errorf</span><span class="op" id="6617540">(</span><span class="string" id="6617541">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="6617576">,</span>&nbsp;<span class="ident" id="6617578">i</span><span class="op" id="6617579">,</span>&nbsp;<span class="ident" id="6617581">s1</span><span class="op" id="6617583">,</span>&nbsp;<span class="ident" id="6617585">s2</span><span class="op" id="6617587">,</span>&nbsp;<span class="ident" id="6617589">test</span><span class="op" id="6617593">.</span><span class="ident" id="6617594">out1</span><span class="op" id="6617598">,</span>&nbsp;<span class="ident" id="6617600">test</span><span class="op" id="6617604">.</span><span class="ident" id="6617605">out2</span><span class="op" id="6617609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6617616">}</span><br>
<span class="lineno"></span><span class="op" id="6617618">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6617621">type</span>&nbsp;<span class="ident" id="6617626">testKeysFromTest</span>&nbsp;<span class="keyword" id="6617643">struct</span>&nbsp;<span class="op" id="6617650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617653">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617680">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617688">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617715">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617723">clientRandom</span><span class="op" id="6617735">,</span>&nbsp;<span class="ident" id="6617737">serverRandom</span>&nbsp;<span class="builtintype" id="6617750">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617758">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617785">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617793">clientMAC</span><span class="op" id="6617802">,</span>&nbsp;<span class="ident" id="6617804">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617820">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617828">clientKey</span><span class="op" id="6617837">,</span>&nbsp;<span class="ident" id="6617839">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617855">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617863">macLen</span><span class="op" id="6617869">,</span>&nbsp;<span class="ident" id="6617871">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6617890">int</span><br>
<span class="lineno"></span><span class="op" id="6617894">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6617897">func</span>&nbsp;<span class="ident" id="6617902">TestKeysFromPreMasterSecret</span><span class="op" id="6617929">(</span><span class="ident" id="6617930">t</span>&nbsp;<span class="op" id="6617932">*</span><span class="ident" id="6617933">testing</span><span class="op" id="6617940">.</span><span class="ident" id="6617941">T</span><span class="op" id="6617942">)</span>&nbsp;<span class="op" id="6617944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6617947">for</span>&nbsp;<span class="ident" id="6617951">i</span><span class="op" id="6617952">,</span>&nbsp;<span class="ident" id="6617954">test</span>&nbsp;<span class="op" id="6617959">:=</span>&nbsp;<span class="keyword" id="6617962">range</span>&nbsp;<span class="ident" id="6617968">testKeysFromTests</span>&nbsp;<span class="op" id="6617986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6617990">in</span><span class="op" id="6617992">,</span>&nbsp;<span class="ident" id="6617994">_</span>&nbsp;<span class="op" id="6617996">:=</span>&nbsp;<span class="ident" id="6617999">hex</span><span class="op" id="6618002">.</span><span class="ident" id="6618003">DecodeString</span><span class="op" id="6618015">(</span><span class="ident" id="6618016">test</span><span class="op" id="6618020">.</span><span class="ident" id="6618021">preMasterSecret</span><span class="op" id="6618036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618040">clientRandom</span><span class="op" id="6618052">,</span>&nbsp;<span class="ident" id="6618054">_</span>&nbsp;<span class="op" id="6618056">:=</span>&nbsp;<span class="ident" id="6618059">hex</span><span class="op" id="6618062">.</span><span class="ident" id="6618063">DecodeString</span><span class="op" id="6618075">(</span><span class="ident" id="6618076">test</span><span class="op" id="6618080">.</span><span class="ident" id="6618081">clientRandom</span><span class="op" id="6618093">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618097">serverRandom</span><span class="op" id="6618109">,</span>&nbsp;<span class="ident" id="6618111">_</span>&nbsp;<span class="op" id="6618113">:=</span>&nbsp;<span class="ident" id="6618116">hex</span><span class="op" id="6618119">.</span><span class="ident" id="6618120">DecodeString</span><span class="op" id="6618132">(</span><span class="ident" id="6618133">test</span><span class="op" id="6618137">.</span><span class="ident" id="6618138">serverRandom</span><span class="op" id="6618150">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618155">masterSecret</span>&nbsp;<span class="op" id="6618168">:=</span>&nbsp;<span class="ident" id="6618171">masterFromPreMasterSecret</span><span class="op" id="6618196">(</span><span class="ident" id="6618197">test</span><span class="op" id="6618201">.</span><span class="ident" id="6618202">version</span><span class="op" id="6618209">,</span>&nbsp;<span class="ident" id="6618211">in</span><span class="op" id="6618213">,</span>&nbsp;<span class="ident" id="6618215">clientRandom</span><span class="op" id="6618227">,</span>&nbsp;<span class="ident" id="6618229">serverRandom</span><span class="op" id="6618241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6618245">if</span>&nbsp;<span class="ident" id="6618248">s</span>&nbsp;<span class="op" id="6618250">:=</span>&nbsp;<span class="ident" id="6618253">hex</span><span class="op" id="6618256">.</span><span class="ident" id="6618257">EncodeToString</span><span class="op" id="6618271">(</span><span class="ident" id="6618272">masterSecret</span><span class="op" id="6618284">)</span><span class="op" id="6618285">;</span>&nbsp;<span class="ident" id="6618287">s</span>&nbsp;<span class="op" id="6618289">!=</span>&nbsp;<span class="ident" id="6618292">test</span><span class="op" id="6618296">.</span><span class="ident" id="6618297">masterSecret</span>&nbsp;<span class="op" id="6618310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618315">t</span><span class="op" id="6618316">.</span><span class="ident" id="6618317">Errorf</span><span class="op" id="6618323">(</span><span class="string" id="6618324">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6618360">,</span>&nbsp;<span class="ident" id="6618362">i</span><span class="op" id="6618363">,</span>&nbsp;<span class="ident" id="6618365">s</span><span class="op" id="6618366">,</span>&nbsp;<span class="ident" id="6618368">test</span><span class="op" id="6618372">.</span><span class="ident" id="6618373">masterSecret</span><span class="op" id="6618385">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6618390">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6618401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618406">clientMAC</span><span class="op" id="6618415">,</span>&nbsp;<span class="ident" id="6618417">serverMAC</span><span class="op" id="6618426">,</span>&nbsp;<span class="ident" id="6618428">clientKey</span><span class="op" id="6618437">,</span>&nbsp;<span class="ident" id="6618439">serverKey</span><span class="op" id="6618448">,</span>&nbsp;<span class="ident" id="6618450">_</span><span class="op" id="6618451">,</span>&nbsp;<span class="ident" id="6618453">_</span>&nbsp;<span class="op" id="6618455">:=</span>&nbsp;<span class="ident" id="6618458">keysFromMasterSecret</span><span class="op" id="6618478">(</span><span class="ident" id="6618479">test</span><span class="op" id="6618483">.</span><span class="ident" id="6618484">version</span><span class="op" id="6618491">,</span>&nbsp;<span class="ident" id="6618493">masterSecret</span><span class="op" id="6618505">,</span>&nbsp;<span class="ident" id="6618507">clientRandom</span><span class="op" id="6618519">,</span>&nbsp;<span class="ident" id="6618521">serverRandom</span><span class="op" id="6618533">,</span>&nbsp;<span class="ident" id="6618535">test</span><span class="op" id="6618539">.</span><span class="ident" id="6618540">macLen</span><span class="op" id="6618546">,</span>&nbsp;<span class="ident" id="6618548">test</span><span class="op" id="6618552">.</span><span class="ident" id="6618553">keyLen</span><span class="op" id="6618559">,</span>&nbsp;<span class="num" id="6618561">0</span><span class="op" id="6618562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618566">clientMACString</span>&nbsp;<span class="op" id="6618582">:=</span>&nbsp;<span class="ident" id="6618585">hex</span><span class="op" id="6618588">.</span><span class="ident" id="6618589">EncodeToString</span><span class="op" id="6618603">(</span><span class="ident" id="6618604">clientMAC</span><span class="op" id="6618613">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618617">serverMACString</span>&nbsp;<span class="op" id="6618633">:=</span>&nbsp;<span class="ident" id="6618636">hex</span><span class="op" id="6618639">.</span><span class="ident" id="6618640">EncodeToString</span><span class="op" id="6618654">(</span><span class="ident" id="6618655">serverMAC</span><span class="op" id="6618664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618668">clientKeyString</span>&nbsp;<span class="op" id="6618684">:=</span>&nbsp;<span class="ident" id="6618687">hex</span><span class="op" id="6618690">.</span><span class="ident" id="6618691">EncodeToString</span><span class="op" id="6618705">(</span><span class="ident" id="6618706">clientKey</span><span class="op" id="6618715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618719">serverKeyString</span>&nbsp;<span class="op" id="6618735">:=</span>&nbsp;<span class="ident" id="6618738">hex</span><span class="op" id="6618741">.</span><span class="ident" id="6618742">EncodeToString</span><span class="op" id="6618756">(</span><span class="ident" id="6618757">serverKey</span><span class="op" id="6618766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6618770">if</span>&nbsp;<span class="ident" id="6618773">clientMACString</span>&nbsp;<span class="op" id="6618789">!=</span>&nbsp;<span class="ident" id="6618792">test</span><span class="op" id="6618796">.</span><span class="ident" id="6618797">clientMAC</span>&nbsp;<span class="op" id="6618807">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618813">serverMACString</span>&nbsp;<span class="op" id="6618829">!=</span>&nbsp;<span class="ident" id="6618832">test</span><span class="op" id="6618836">.</span><span class="ident" id="6618837">serverMAC</span>&nbsp;<span class="op" id="6618847">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618853">clientKeyString</span>&nbsp;<span class="op" id="6618869">!=</span>&nbsp;<span class="ident" id="6618872">test</span><span class="op" id="6618876">.</span><span class="ident" id="6618877">clientKey</span>&nbsp;<span class="op" id="6618887">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618893">serverKeyString</span>&nbsp;<span class="op" id="6618909">!=</span>&nbsp;<span class="ident" id="6618912">test</span><span class="op" id="6618916">.</span><span class="ident" id="6618917">serverKey</span>&nbsp;<span class="op" id="6618927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6618932">t</span><span class="op" id="6618933">.</span><span class="ident" id="6618934">Errorf</span><span class="op" id="6618940">(</span><span class="string" id="6618941">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="6618992">,</span>&nbsp;<span class="ident" id="6618994">i</span><span class="op" id="6618995">,</span>&nbsp;<span class="ident" id="6618997">clientMACString</span><span class="op" id="6619012">,</span>&nbsp;<span class="ident" id="6619014">serverMACString</span><span class="op" id="6619029">,</span>&nbsp;<span class="ident" id="6619031">clientKeyString</span><span class="op" id="6619046">,</span>&nbsp;<span class="ident" id="6619048">serverKeyString</span><span class="op" id="6619063">,</span>&nbsp;<span class="ident" id="6619065">test</span><span class="op" id="6619069">.</span><span class="ident" id="6619070">clientMAC</span><span class="op" id="6619079">,</span>&nbsp;<span class="ident" id="6619081">test</span><span class="op" id="6619085">.</span><span class="ident" id="6619086">serverMAC</span><span class="op" id="6619095">,</span>&nbsp;<span class="ident" id="6619097">test</span><span class="op" id="6619101">.</span><span class="ident" id="6619102">clientKey</span><span class="op" id="6619111">,</span>&nbsp;<span class="ident" id="6619113">test</span><span class="op" id="6619117">.</span><span class="ident" id="6619118">serverKey</span><span class="op" id="6619127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6619131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6619134">}</span><br>
<span class="lineno">70</span><span class="op" id="6619136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6619139">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="6619224">var</span>&nbsp;<span class="ident" id="6619228">testKeysFromTests</span>&nbsp;<span class="op" id="6619246">=</span>&nbsp;<span class="op" id="6619248">[</span><span class="op" id="6619249">]</span><span class="ident" id="6619250">testKeysFromTest</span><span class="op" id="6619266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6619269">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6619273">VersionTLS10</span><span class="op" id="6619285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619289">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="6619387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619391">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="6619457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619461">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="6619527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619531">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="6619629">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619633">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="6619675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619679">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="6619721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619725">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="6619759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619763">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="6619797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6619801">20</span><span class="op" id="6619803">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6619807">16</span><span class="op" id="6619809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6619812">}</span><span class="op" id="6619813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6619816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6619820">VersionTLS10</span><span class="op" id="6619832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619836">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="6619934">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6619938">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="6620004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620008">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="6620074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620078">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="6620176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620180">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="6620222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620226">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="6620268">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620272">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="6620306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620310">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="6620344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6620348">20</span><span class="op" id="6620350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6620354">16</span><span class="op" id="6620356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6620359">}</span><span class="op" id="6620360">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6620363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6620367">VersionTLS10</span><span class="op" id="6620379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620383">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6620641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620645">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6620711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620715">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6620781">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620785">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="6620883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620887">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="6620929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620933">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="6620975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6620979">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="6621013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621017">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="6621051">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6621055">20</span><span class="op" id="6621057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6621061">16</span><span class="op" id="6621063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6621066">}</span><span class="op" id="6621067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6621070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6621074">VersionSSL30</span><span class="op" id="6621086">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621090">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6621348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621352">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6621418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621422">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6621488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621492">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="6621590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621594">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="6621636">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621640">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="6621682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621686">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="6621720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6621724">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="6621758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6621762">20</span><span class="op" id="6621764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6621768">16</span><span class="op" id="6621770">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6621773">}</span><span class="op" id="6621774">,</span><br>
<span class="lineno"></span><span class="op" id="6621776">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
