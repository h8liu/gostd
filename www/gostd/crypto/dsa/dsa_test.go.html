<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7807856">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7807911">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7807965">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7808016">package</span>&nbsp;<span class="ident" id="7808024">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7808029">import</span>&nbsp;<span class="op" id="7808036">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808039">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808054">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808066">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7808076">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7808079">func</span>&nbsp;<span class="ident" id="7808084">testSignAndVerify</span><span class="op" id="7808101">(</span><span class="ident" id="7808102">t</span>&nbsp;<span class="op" id="7808104">*</span><span class="ident" id="7808105">testing</span><span class="op" id="7808112">.</span><span class="ident" id="7808113">T</span><span class="op" id="7808114">,</span>&nbsp;<span class="ident" id="7808116">i</span>&nbsp;<span class="builtintype" id="7808118">int</span><span class="op" id="7808121">,</span>&nbsp;<span class="ident" id="7808123">priv</span>&nbsp;<span class="op" id="7808128">*</span><span class="ident" id="7808129">PrivateKey</span><span class="op" id="7808139">)</span>&nbsp;<span class="op" id="7808141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808144">hashed</span>&nbsp;<span class="op" id="7808151">:=</span>&nbsp;<span class="op" id="7808154">[</span><span class="op" id="7808155">]</span><span class="builtintype" id="7808156">byte</span><span class="op" id="7808160">(</span><span class="string" id="7808161">&#34;testing&#34;</span><span class="op" id="7808170">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808173">r</span><span class="op" id="7808174">,</span>&nbsp;<span class="ident" id="7808176">s</span><span class="op" id="7808177">,</span>&nbsp;<span class="ident" id="7808179">err</span>&nbsp;<span class="op" id="7808183">:=</span>&nbsp;<span class="ident" id="7808186">Sign</span><span class="op" id="7808190">(</span><span class="ident" id="7808191">rand</span><span class="op" id="7808195">.</span><span class="ident" id="7808196">Reader</span><span class="op" id="7808202">,</span>&nbsp;<span class="ident" id="7808204">priv</span><span class="op" id="7808208">,</span>&nbsp;<span class="ident" id="7808210">hashed</span><span class="op" id="7808216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808219">if</span>&nbsp;<span class="ident" id="7808222">err</span>&nbsp;<span class="op" id="7808226">!=</span>&nbsp;<span class="ident" id="7808229">nil</span>&nbsp;<span class="op" id="7808233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808237">t</span><span class="op" id="7808238">.</span><span class="ident" id="7808239">Errorf</span><span class="op" id="7808245">(</span><span class="string" id="7808246">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7808269">,</span>&nbsp;<span class="ident" id="7808271">i</span><span class="op" id="7808272">,</span>&nbsp;<span class="ident" id="7808274">err</span><span class="op" id="7808277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808281">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808289">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808293">if</span>&nbsp;<span class="op" id="7808296">!</span><span class="ident" id="7808297">Verify</span><span class="op" id="7808303">(</span><span class="op" id="7808304">&amp;</span><span class="ident" id="7808305">priv</span><span class="op" id="7808309">.</span><span class="ident" id="7808310">PublicKey</span><span class="op" id="7808319">,</span>&nbsp;<span class="ident" id="7808321">hashed</span><span class="op" id="7808327">,</span>&nbsp;<span class="ident" id="7808329">r</span><span class="op" id="7808330">,</span>&nbsp;<span class="ident" id="7808332">s</span><span class="op" id="7808333">)</span>&nbsp;<span class="op" id="7808335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808339">t</span><span class="op" id="7808340">.</span><span class="ident" id="7808341">Errorf</span><span class="op" id="7808347">(</span><span class="string" id="7808348">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7808367">,</span>&nbsp;<span class="ident" id="7808369">i</span><span class="op" id="7808370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808373">}</span><br>
<span class="lineno"></span><span class="op" id="7808375">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7808378">func</span>&nbsp;<span class="ident" id="7808383">testParameterGeneration</span><span class="op" id="7808406">(</span><span class="ident" id="7808407">t</span>&nbsp;<span class="op" id="7808409">*</span><span class="ident" id="7808410">testing</span><span class="op" id="7808417">.</span><span class="ident" id="7808418">T</span><span class="op" id="7808419">,</span>&nbsp;<span class="ident" id="7808421">sizes</span>&nbsp;<span class="ident" id="7808427">ParameterSizes</span><span class="op" id="7808441">,</span>&nbsp;<span class="ident" id="7808443">L</span><span class="op" id="7808444">,</span>&nbsp;<span class="ident" id="7808446">N</span>&nbsp;<span class="builtintype" id="7808448">int</span><span class="op" id="7808451">)</span>&nbsp;<span class="op" id="7808453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808456">var</span>&nbsp;<span class="ident" id="7808460">priv</span>&nbsp;<span class="ident" id="7808465">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808477">params</span>&nbsp;<span class="op" id="7808484">:=</span>&nbsp;<span class="op" id="7808487">&amp;</span><span class="ident" id="7808488">priv</span><span class="op" id="7808492">.</span><span class="ident" id="7808493">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808506">err</span>&nbsp;<span class="op" id="7808510">:=</span>&nbsp;<span class="ident" id="7808513">GenerateParameters</span><span class="op" id="7808531">(</span><span class="ident" id="7808532">params</span><span class="op" id="7808538">,</span>&nbsp;<span class="ident" id="7808540">rand</span><span class="op" id="7808544">.</span><span class="ident" id="7808545">Reader</span><span class="op" id="7808551">,</span>&nbsp;<span class="ident" id="7808553">sizes</span><span class="op" id="7808558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808561">if</span>&nbsp;<span class="ident" id="7808564">err</span>&nbsp;<span class="op" id="7808568">!=</span>&nbsp;<span class="ident" id="7808571">nil</span>&nbsp;<span class="op" id="7808575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808579">t</span><span class="op" id="7808580">.</span><span class="ident" id="7808581">Errorf</span><span class="op" id="7808587">(</span><span class="string" id="7808588">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="7808596">,</span>&nbsp;<span class="builtintype" id="7808598">int</span><span class="op" id="7808601">(</span><span class="ident" id="7808602">sizes</span><span class="op" id="7808607">)</span><span class="op" id="7808608">,</span>&nbsp;<span class="ident" id="7808610">err</span><span class="op" id="7808613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808617">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808625">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808629">if</span>&nbsp;<span class="ident" id="7808632">params</span><span class="op" id="7808638">.</span><span class="ident" id="7808639">P</span><span class="op" id="7808640">.</span><span class="ident" id="7808641">BitLen</span><span class="op" id="7808647">(</span><span class="op" id="7808648">)</span>&nbsp;<span class="op" id="7808650">!=</span>&nbsp;<span class="ident" id="7808653">L</span>&nbsp;<span class="op" id="7808655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808659">t</span><span class="op" id="7808660">.</span><span class="ident" id="7808661">Errorf</span><span class="op" id="7808667">(</span><span class="string" id="7808668">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7808702">,</span>&nbsp;<span class="builtintype" id="7808704">int</span><span class="op" id="7808707">(</span><span class="ident" id="7808708">sizes</span><span class="op" id="7808713">)</span><span class="op" id="7808714">,</span>&nbsp;<span class="ident" id="7808716">params</span><span class="op" id="7808722">.</span><span class="ident" id="7808723">P</span><span class="op" id="7808724">.</span><span class="ident" id="7808725">BitLen</span><span class="op" id="7808731">(</span><span class="op" id="7808732">)</span><span class="op" id="7808733">,</span>&nbsp;<span class="ident" id="7808735">L</span><span class="op" id="7808736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808743">if</span>&nbsp;<span class="ident" id="7808746">params</span><span class="op" id="7808752">.</span><span class="ident" id="7808753">Q</span><span class="op" id="7808754">.</span><span class="ident" id="7808755">BitLen</span><span class="op" id="7808761">(</span><span class="op" id="7808762">)</span>&nbsp;<span class="op" id="7808764">!=</span>&nbsp;<span class="ident" id="7808767">N</span>&nbsp;<span class="op" id="7808769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808773">t</span><span class="op" id="7808774">.</span><span class="ident" id="7808775">Errorf</span><span class="op" id="7808781">(</span><span class="string" id="7808782">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7808811">,</span>&nbsp;<span class="builtintype" id="7808813">int</span><span class="op" id="7808816">(</span><span class="ident" id="7808817">sizes</span><span class="op" id="7808822">)</span><span class="op" id="7808823">,</span>&nbsp;<span class="ident" id="7808825">params</span><span class="op" id="7808831">.</span><span class="ident" id="7808832">Q</span><span class="op" id="7808833">.</span><span class="ident" id="7808834">BitLen</span><span class="op" id="7808840">(</span><span class="op" id="7808841">)</span><span class="op" id="7808842">,</span>&nbsp;<span class="ident" id="7808844">L</span><span class="op" id="7808845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808852">one</span>&nbsp;<span class="op" id="7808856">:=</span>&nbsp;<span class="builtinfunc" id="7808859">new</span><span class="op" id="7808862">(</span><span class="ident" id="7808863">big</span><span class="op" id="7808866">.</span><span class="ident" id="7808867">Int</span><span class="op" id="7808870">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808873">one</span><span class="op" id="7808876">.</span><span class="ident" id="7808877">SetInt64</span><span class="op" id="7808885">(</span><span class="num" id="7808886">1</span><span class="op" id="7808887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808890">pm1</span>&nbsp;<span class="op" id="7808894">:=</span>&nbsp;<span class="builtinfunc" id="7808897">new</span><span class="op" id="7808900">(</span><span class="ident" id="7808901">big</span><span class="op" id="7808904">.</span><span class="ident" id="7808905">Int</span><span class="op" id="7808908">)</span><span class="op" id="7808909">.</span><span class="ident" id="7808910">Sub</span><span class="op" id="7808913">(</span><span class="ident" id="7808914">params</span><span class="op" id="7808920">.</span><span class="ident" id="7808921">P</span><span class="op" id="7808922">,</span>&nbsp;<span class="ident" id="7808924">one</span><span class="op" id="7808927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808930">quo</span><span class="op" id="7808933">,</span>&nbsp;<span class="ident" id="7808935">rem</span>&nbsp;<span class="op" id="7808939">:=</span>&nbsp;<span class="builtinfunc" id="7808942">new</span><span class="op" id="7808945">(</span><span class="ident" id="7808946">big</span><span class="op" id="7808949">.</span><span class="ident" id="7808950">Int</span><span class="op" id="7808953">)</span><span class="op" id="7808954">.</span><span class="ident" id="7808955">DivMod</span><span class="op" id="7808961">(</span><span class="ident" id="7808962">pm1</span><span class="op" id="7808965">,</span>&nbsp;<span class="ident" id="7808967">params</span><span class="op" id="7808973">.</span><span class="ident" id="7808974">Q</span><span class="op" id="7808975">,</span>&nbsp;<span class="builtinfunc" id="7808977">new</span><span class="op" id="7808980">(</span><span class="ident" id="7808981">big</span><span class="op" id="7808984">.</span><span class="ident" id="7808985">Int</span><span class="op" id="7808988">)</span><span class="op" id="7808989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808992">if</span>&nbsp;<span class="ident" id="7808995">rem</span><span class="op" id="7808998">.</span><span class="ident" id="7808999">Sign</span><span class="op" id="7809003">(</span><span class="op" id="7809004">)</span>&nbsp;<span class="op" id="7809006">!=</span>&nbsp;<span class="num" id="7809009">0</span>&nbsp;<span class="op" id="7809011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809015">t</span><span class="op" id="7809016">.</span><span class="ident" id="7809017">Errorf</span><span class="op" id="7809023">(</span><span class="string" id="7809024">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="7809044">,</span>&nbsp;<span class="builtintype" id="7809046">int</span><span class="op" id="7809049">(</span><span class="ident" id="7809050">sizes</span><span class="op" id="7809055">)</span><span class="op" id="7809056">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7809059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809062">x</span>&nbsp;<span class="op" id="7809064">:=</span>&nbsp;<span class="builtinfunc" id="7809067">new</span><span class="op" id="7809070">(</span><span class="ident" id="7809071">big</span><span class="op" id="7809074">.</span><span class="ident" id="7809075">Int</span><span class="op" id="7809078">)</span><span class="op" id="7809079">.</span><span class="ident" id="7809080">Exp</span><span class="op" id="7809083">(</span><span class="ident" id="7809084">params</span><span class="op" id="7809090">.</span><span class="ident" id="7809091">G</span><span class="op" id="7809092">,</span>&nbsp;<span class="ident" id="7809094">quo</span><span class="op" id="7809097">,</span>&nbsp;<span class="ident" id="7809099">params</span><span class="op" id="7809105">.</span><span class="ident" id="7809106">P</span><span class="op" id="7809107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7809110">if</span>&nbsp;<span class="ident" id="7809113">x</span><span class="op" id="7809114">.</span><span class="ident" id="7809115">Cmp</span><span class="op" id="7809118">(</span><span class="ident" id="7809119">one</span><span class="op" id="7809122">)</span>&nbsp;<span class="op" id="7809124">==</span>&nbsp;<span class="num" id="7809127">0</span>&nbsp;<span class="op" id="7809129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809133">t</span><span class="op" id="7809134">.</span><span class="ident" id="7809135">Errorf</span><span class="op" id="7809141">(</span><span class="string" id="7809142">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="7809165">,</span>&nbsp;<span class="builtintype" id="7809167">int</span><span class="op" id="7809170">(</span><span class="ident" id="7809171">sizes</span><span class="op" id="7809176">)</span><span class="op" id="7809177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7809180">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809184">err</span>&nbsp;<span class="op" id="7809188">=</span>&nbsp;<span class="ident" id="7809190">GenerateKey</span><span class="op" id="7809201">(</span><span class="op" id="7809202">&amp;</span><span class="ident" id="7809203">priv</span><span class="op" id="7809207">,</span>&nbsp;<span class="ident" id="7809209">rand</span><span class="op" id="7809213">.</span><span class="ident" id="7809214">Reader</span><span class="op" id="7809220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7809223">if</span>&nbsp;<span class="ident" id="7809226">err</span>&nbsp;<span class="op" id="7809230">!=</span>&nbsp;<span class="ident" id="7809233">nil</span>&nbsp;<span class="op" id="7809237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809241">t</span><span class="op" id="7809242">.</span><span class="ident" id="7809243">Errorf</span><span class="op" id="7809249">(</span><span class="string" id="7809250">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7809276">,</span>&nbsp;<span class="ident" id="7809278">err</span><span class="op" id="7809281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7809285">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7809293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809297">testSignAndVerify</span><span class="op" id="7809314">(</span><span class="ident" id="7809315">t</span><span class="op" id="7809316">,</span>&nbsp;<span class="builtintype" id="7809318">int</span><span class="op" id="7809321">(</span><span class="ident" id="7809322">sizes</span><span class="op" id="7809327">)</span><span class="op" id="7809328">,</span>&nbsp;<span class="op" id="7809330">&amp;</span><span class="ident" id="7809331">priv</span><span class="op" id="7809335">)</span><br>
<span class="lineno"></span><span class="op" id="7809337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7809340">func</span>&nbsp;<span class="ident" id="7809345">TestParameterGeneration</span><span class="op" id="7809368">(</span><span class="ident" id="7809369">t</span>&nbsp;<span class="op" id="7809371">*</span><span class="ident" id="7809372">testing</span><span class="op" id="7809379">.</span><span class="ident" id="7809380">T</span><span class="op" id="7809381">)</span>&nbsp;<span class="op" id="7809383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7809386">if</span>&nbsp;<span class="ident" id="7809389">testing</span><span class="op" id="7809396">.</span><span class="ident" id="7809397">Short</span><span class="op" id="7809402">(</span><span class="op" id="7809403">)</span>&nbsp;<span class="op" id="7809405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809409">t</span><span class="op" id="7809410">.</span><span class="ident" id="7809411">Skip</span><span class="op" id="7809415">(</span><span class="string" id="7809416">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7809466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7809469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809473">testParameterGeneration</span><span class="op" id="7809496">(</span><span class="ident" id="7809497">t</span><span class="op" id="7809498">,</span>&nbsp;<span class="ident" id="7809500">L1024N160</span><span class="op" id="7809509">,</span>&nbsp;<span class="num" id="7809511">1024</span><span class="op" id="7809515">,</span>&nbsp;<span class="num" id="7809517">160</span><span class="op" id="7809520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809523">testParameterGeneration</span><span class="op" id="7809546">(</span><span class="ident" id="7809547">t</span><span class="op" id="7809548">,</span>&nbsp;<span class="ident" id="7809550">L2048N224</span><span class="op" id="7809559">,</span>&nbsp;<span class="num" id="7809561">2048</span><span class="op" id="7809565">,</span>&nbsp;<span class="num" id="7809567">224</span><span class="op" id="7809570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809573">testParameterGeneration</span><span class="op" id="7809596">(</span><span class="ident" id="7809597">t</span><span class="op" id="7809598">,</span>&nbsp;<span class="ident" id="7809600">L2048N256</span><span class="op" id="7809609">,</span>&nbsp;<span class="num" id="7809611">2048</span><span class="op" id="7809615">,</span>&nbsp;<span class="num" id="7809617">256</span><span class="op" id="7809620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809623">testParameterGeneration</span><span class="op" id="7809646">(</span><span class="ident" id="7809647">t</span><span class="op" id="7809648">,</span>&nbsp;<span class="ident" id="7809650">L3072N256</span><span class="op" id="7809659">,</span>&nbsp;<span class="num" id="7809661">3072</span><span class="op" id="7809665">,</span>&nbsp;<span class="num" id="7809667">256</span><span class="op" id="7809670">)</span><br>
<span class="lineno"></span><span class="op" id="7809672">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7809675">func</span>&nbsp;<span class="ident" id="7809680">TestSignAndVerify</span><span class="op" id="7809697">(</span><span class="ident" id="7809698">t</span>&nbsp;<span class="op" id="7809700">*</span><span class="ident" id="7809701">testing</span><span class="op" id="7809708">.</span><span class="ident" id="7809709">T</span><span class="op" id="7809710">)</span>&nbsp;<span class="op" id="7809712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7809715">var</span>&nbsp;<span class="ident" id="7809719">priv</span>&nbsp;<span class="ident" id="7809724">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7809736">priv</span><span class="op" id="7809740">.</span><span class="ident" id="7809741">P</span><span class="op" id="7809742">,</span>&nbsp;<span class="ident" id="7809744">_</span>&nbsp;<span class="op" id="7809746">=</span>&nbsp;<span class="builtinfunc" id="7809748">new</span><span class="op" id="7809751">(</span><span class="ident" id="7809752">big</span><span class="op" id="7809755">.</span><span class="ident" id="7809756">Int</span><span class="op" id="7809759">)</span><span class="op" id="7809760">.</span><span class="ident" id="7809761">SetString</span><span class="op" id="7809770">(</span><span class="string" id="7809771">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="7810029">,</span>&nbsp;<span class="num" id="7810031">16</span><span class="op" id="7810033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7810036">priv</span><span class="op" id="7810040">.</span><span class="ident" id="7810041">Q</span><span class="op" id="7810042">,</span>&nbsp;<span class="ident" id="7810044">_</span>&nbsp;<span class="op" id="7810046">=</span>&nbsp;<span class="builtinfunc" id="7810048">new</span><span class="op" id="7810051">(</span><span class="ident" id="7810052">big</span><span class="op" id="7810055">.</span><span class="ident" id="7810056">Int</span><span class="op" id="7810059">)</span><span class="op" id="7810060">.</span><span class="ident" id="7810061">SetString</span><span class="op" id="7810070">(</span><span class="string" id="7810071">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="7810113">,</span>&nbsp;<span class="num" id="7810115">16</span><span class="op" id="7810117">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7810120">priv</span><span class="op" id="7810124">.</span><span class="ident" id="7810125">G</span><span class="op" id="7810126">,</span>&nbsp;<span class="ident" id="7810128">_</span>&nbsp;<span class="op" id="7810130">=</span>&nbsp;<span class="builtinfunc" id="7810132">new</span><span class="op" id="7810135">(</span><span class="ident" id="7810136">big</span><span class="op" id="7810139">.</span><span class="ident" id="7810140">Int</span><span class="op" id="7810143">)</span><span class="op" id="7810144">.</span><span class="ident" id="7810145">SetString</span><span class="op" id="7810154">(</span><span class="string" id="7810155">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="7810413">,</span>&nbsp;<span class="num" id="7810415">16</span><span class="op" id="7810417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7810420">priv</span><span class="op" id="7810424">.</span><span class="ident" id="7810425">Y</span><span class="op" id="7810426">,</span>&nbsp;<span class="ident" id="7810428">_</span>&nbsp;<span class="op" id="7810430">=</span>&nbsp;<span class="builtinfunc" id="7810432">new</span><span class="op" id="7810435">(</span><span class="ident" id="7810436">big</span><span class="op" id="7810439">.</span><span class="ident" id="7810440">Int</span><span class="op" id="7810443">)</span><span class="op" id="7810444">.</span><span class="ident" id="7810445">SetString</span><span class="op" id="7810454">(</span><span class="string" id="7810455">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="7810713">,</span>&nbsp;<span class="num" id="7810715">16</span><span class="op" id="7810717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7810720">priv</span><span class="op" id="7810724">.</span><span class="ident" id="7810725">X</span><span class="op" id="7810726">,</span>&nbsp;<span class="ident" id="7810728">_</span>&nbsp;<span class="op" id="7810730">=</span>&nbsp;<span class="builtinfunc" id="7810732">new</span><span class="op" id="7810735">(</span><span class="ident" id="7810736">big</span><span class="op" id="7810739">.</span><span class="ident" id="7810740">Int</span><span class="op" id="7810743">)</span><span class="op" id="7810744">.</span><span class="ident" id="7810745">SetString</span><span class="op" id="7810754">(</span><span class="string" id="7810755">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="7810797">,</span>&nbsp;<span class="num" id="7810799">16</span><span class="op" id="7810801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7810805">testSignAndVerify</span><span class="op" id="7810822">(</span><span class="ident" id="7810823">t</span><span class="op" id="7810824">,</span>&nbsp;<span class="num" id="7810826">0</span><span class="op" id="7810827">,</span>&nbsp;<span class="op" id="7810829">&amp;</span><span class="ident" id="7810830">priv</span><span class="op" id="7810834">)</span><br>
<span class="lineno">85</span><span class="op" id="7810836">}</span>
</div>
</body>
</html>
