<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2883747">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2883802">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2883856">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2883907">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2883980">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2884060">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2884136">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2884177">//</span><br>
<span class="lineno">10</span><span class="comment" id="2884180">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2884249">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2884316">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2884334">//</span><br>
<span class="lineno"></span><span class="comment" id="2884337">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2884410">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2884468">package</span>&nbsp;<span class="ident" id="2884476">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2884485">import</span>&nbsp;<span class="op" id="2884492">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2884495">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2884506">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2884517">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2884525">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2884534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2884537">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2884581">//</span><br>
<span class="lineno"></span><span class="comment" id="2884584">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2884647">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2884706">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2884765">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2884817">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2884879">type</span>&nbsp;<span class="ident" id="2884884">Type</span>&nbsp;<span class="keyword" id="2884889">interface</span>&nbsp;<span class="op" id="2884899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884902">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884940">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884995">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885035">Align</span><span class="op" id="2885040">(</span><span class="op" id="2885041">)</span>&nbsp;<span class="builtintype" id="2885043">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885049">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885109">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885157">FieldAlign</span><span class="op" id="2885167">(</span><span class="op" id="2885168">)</span>&nbsp;<span class="builtintype" id="2885170">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885176">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885237">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885294">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885298">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885372">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885441">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885445">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885515">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885584">Method</span><span class="op" id="2885590">(</span><span class="builtintype" id="2885591">int</span><span class="op" id="2885594">)</span>&nbsp;<span class="ident" id="2885596">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885605">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885670">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885735">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885739">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885813">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885882">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885886">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885956">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886025">MethodByName</span><span class="op" id="2886037">(</span><span class="builtintype" id="2886038">string</span><span class="op" id="2886044">)</span>&nbsp;<span class="op" id="2886046">(</span><span class="ident" id="2886047">Method</span><span class="op" id="2886053">,</span>&nbsp;<span class="builtintype" id="2886055">bool</span><span class="op" id="2886059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886063">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886133">NumMethod</span><span class="op" id="2886142">(</span><span class="op" id="2886143">)</span>&nbsp;<span class="builtintype" id="2886145">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886151">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886204">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886254">Name</span><span class="op" id="2886258">(</span><span class="op" id="2886259">)</span>&nbsp;<span class="builtintype" id="2886261">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886270">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886344">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886413">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886495">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886542">PkgPath</span><span class="op" id="2886549">(</span><span class="op" id="2886550">)</span>&nbsp;<span class="builtintype" id="2886552">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886561">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886614">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886679">Size</span><span class="op" id="2886683">(</span><span class="op" id="2886684">)</span>&nbsp;<span class="builtintype" id="2886686">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886696">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886752">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886814">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886873">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886937">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886969">String</span><span class="op" id="2886975">(</span><span class="op" id="2886976">)</span>&nbsp;<span class="builtintype" id="2886978">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886987">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887036">Kind</span><span class="op" id="2887040">(</span><span class="op" id="2887041">)</span>&nbsp;<span class="ident" id="2887043">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887050">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887123">Implements</span><span class="op" id="2887133">(</span><span class="ident" id="2887134">u</span>&nbsp;<span class="ident" id="2887136">Type</span><span class="op" id="2887140">)</span>&nbsp;<span class="builtintype" id="2887142">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887149">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887227">AssignableTo</span><span class="op" id="2887239">(</span><span class="ident" id="2887240">u</span>&nbsp;<span class="ident" id="2887242">Type</span><span class="op" id="2887246">)</span>&nbsp;<span class="builtintype" id="2887248">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887255">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887335">ConvertibleTo</span><span class="op" id="2887348">(</span><span class="ident" id="2887349">u</span>&nbsp;<span class="ident" id="2887351">Type</span><span class="op" id="2887355">)</span>&nbsp;<span class="builtintype" id="2887357">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887364">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887431">Comparable</span><span class="op" id="2887441">(</span><span class="op" id="2887442">)</span>&nbsp;<span class="builtintype" id="2887444">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887451">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887513">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887556">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887560">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887600">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887621">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887645">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887691">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887710">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887724">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887740">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887813">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887860">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887911">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887968">Bits</span><span class="op" id="2887972">(</span><span class="op" id="2887973">)</span>&nbsp;<span class="builtintype" id="2887975">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887981">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888029">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888075">ChanDir</span><span class="op" id="2888082">(</span><span class="op" id="2888083">)</span>&nbsp;<span class="ident" id="2888085">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888095">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888166">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888244">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888274">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888278">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888349">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888353">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888372">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888414">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888462">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888489">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888493">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888547">IsVariadic</span><span class="op" id="2888557">(</span><span class="op" id="2888558">)</span>&nbsp;<span class="builtintype" id="2888560">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888567">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888607">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888680">Elem</span><span class="op" id="2888684">(</span><span class="op" id="2888685">)</span>&nbsp;<span class="ident" id="2888687">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888694">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888740">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888788">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888844">Field</span><span class="op" id="2888849">(</span><span class="ident" id="2888850">i</span>&nbsp;<span class="builtintype" id="2888852">int</span><span class="op" id="2888855">)</span>&nbsp;<span class="ident" id="2888857">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888871">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888927">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888989">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889024">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889072">FieldByIndex</span><span class="op" id="2889084">(</span><span class="ident" id="2889085">index</span>&nbsp;<span class="op" id="2889091">[</span><span class="op" id="2889092">]</span><span class="builtintype" id="2889093">int</span><span class="op" id="2889096">)</span>&nbsp;<span class="ident" id="2889098">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889112">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889173">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889226">FieldByName</span><span class="op" id="2889237">(</span><span class="ident" id="2889238">name</span>&nbsp;<span class="builtintype" id="2889243">string</span><span class="op" id="2889249">)</span>&nbsp;<span class="op" id="2889251">(</span><span class="ident" id="2889252">StructField</span><span class="op" id="2889263">,</span>&nbsp;<span class="builtintype" id="2889265">bool</span><span class="op" id="2889269">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889273">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889336">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889402">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889427">FieldByNameFunc</span><span class="op" id="2889442">(</span><span class="ident" id="2889443">match</span>&nbsp;<span class="keyword" id="2889449">func</span><span class="op" id="2889453">(</span><span class="builtintype" id="2889454">string</span><span class="op" id="2889460">)</span>&nbsp;<span class="builtintype" id="2889462">bool</span><span class="op" id="2889466">)</span>&nbsp;<span class="op" id="2889468">(</span><span class="ident" id="2889469">StructField</span><span class="op" id="2889480">,</span>&nbsp;<span class="builtintype" id="2889482">bool</span><span class="op" id="2889486">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889490">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889557">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889603">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889656">In</span><span class="op" id="2889658">(</span><span class="ident" id="2889659">i</span>&nbsp;<span class="builtintype" id="2889661">int</span><span class="op" id="2889664">)</span>&nbsp;<span class="ident" id="2889666">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889673">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889712">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889757">Key</span><span class="op" id="2889760">(</span><span class="op" id="2889761">)</span>&nbsp;<span class="ident" id="2889763">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889770">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889810">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889857">Len</span><span class="op" id="2889860">(</span><span class="op" id="2889861">)</span>&nbsp;<span class="builtintype" id="2889863">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889869">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889919">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889967">NumField</span><span class="op" id="2889975">(</span><span class="op" id="2889976">)</span>&nbsp;<span class="builtintype" id="2889978">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889984">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890043">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890089">NumIn</span><span class="op" id="2890094">(</span><span class="op" id="2890095">)</span>&nbsp;<span class="builtintype" id="2890097">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890103">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890164">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890210">NumOut</span><span class="op" id="2890216">(</span><span class="op" id="2890217">)</span>&nbsp;<span class="builtintype" id="2890219">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890225">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890294">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890340">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890394">Out</span><span class="op" id="2890397">(</span><span class="ident" id="2890398">i</span>&nbsp;<span class="builtintype" id="2890400">int</span><span class="op" id="2890403">)</span>&nbsp;<span class="ident" id="2890405">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890412">common</span><span class="op" id="2890418">(</span><span class="op" id="2890419">)</span>&nbsp;<span class="op" id="2890421">*</span><span class="ident" id="2890422">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890429">uncommon</span><span class="op" id="2890437">(</span><span class="op" id="2890438">)</span>&nbsp;<span class="op" id="2890440">*</span><span class="ident" id="2890441">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2890454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2890457">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2890544">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2890617">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2890694">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2890766">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2890829">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2890916">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2890964">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891159">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2891230">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2891268">type</span>&nbsp;<span class="ident" id="2891273">Kind</span>&nbsp;<span class="builtintype" id="2891278">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2891284">const</span>&nbsp;<span class="op" id="2891290">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891293">Invalid</span>&nbsp;<span class="ident" id="2891301">Kind</span>&nbsp;<span class="op" id="2891306">=</span>&nbsp;<span class="ident" id="2891308">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891314">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891320">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891325">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891331">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891338">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891345">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891352">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891358">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891365">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891373">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891381">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891389">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891398">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891407">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891416">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891427">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891439">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891446">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891452">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891458">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891469">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891474">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891479">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891486">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891494">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891502">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2891516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891519">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2891573">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2891633">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2891696">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2891762">type</span>&nbsp;<span class="ident" id="2891767">rtype</span>&nbsp;<span class="keyword" id="2891773">struct</span>&nbsp;<span class="op" id="2891780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891783">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2891797">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891806">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2891820">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2891838">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891890">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2891904">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2891922">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891941">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2891955">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2891973">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892014">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2892028">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892046">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892091">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2892105">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892123">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892145">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2892159">*</span><span class="ident" id="2892160">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892177">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892225">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2892239">[</span><span class="num" id="2892240">2</span><span class="op" id="2892241">]</span><span class="ident" id="2892242">unsafe</span><span class="op" id="2892248">.</span><span class="ident" id="2892249">Pointer</span>&nbsp;<span class="comment" id="2892257">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2892285">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2892299">*</span><span class="builtintype" id="2892300">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892317">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2892368">*</span><span class="ident" id="2892369">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892400">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892433">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2892447">*</span><span class="ident" id="2892448">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892465">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892533">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2892547">unsafe</span><span class="op" id="2892553">.</span><span class="ident" id="2892554">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892565">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2892590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2892593">type</span>&nbsp;<span class="ident" id="2892598">typeAlg</span>&nbsp;<span class="keyword" id="2892606">struct</span>&nbsp;<span class="op" id="2892613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892616">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892662">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892702">hash</span>&nbsp;<span class="keyword" id="2892707">func</span><span class="op" id="2892711">(</span><span class="ident" id="2892712">unsafe</span><span class="op" id="2892718">.</span><span class="ident" id="2892719">Pointer</span><span class="op" id="2892726">,</span>&nbsp;<span class="builtintype" id="2892728">uintptr</span><span class="op" id="2892735">,</span>&nbsp;<span class="builtintype" id="2892737">uintptr</span><span class="op" id="2892744">)</span>&nbsp;<span class="builtintype" id="2892746">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892755">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892803">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892855">equal</span>&nbsp;<span class="keyword" id="2892861">func</span><span class="op" id="2892865">(</span><span class="ident" id="2892866">unsafe</span><span class="op" id="2892872">.</span><span class="ident" id="2892873">Pointer</span><span class="op" id="2892880">,</span>&nbsp;<span class="ident" id="2892882">unsafe</span><span class="op" id="2892888">.</span><span class="ident" id="2892889">Pointer</span><span class="op" id="2892896">,</span>&nbsp;<span class="builtintype" id="2892898">uintptr</span><span class="op" id="2892905">)</span>&nbsp;<span class="builtintype" id="2892907">bool</span><br>
<span class="lineno"></span><span class="op" id="2892912">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2892915">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2892947">type</span>&nbsp;<span class="ident" id="2892952">method</span>&nbsp;<span class="keyword" id="2892959">struct</span>&nbsp;<span class="op" id="2892966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892969">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2892977">*</span><span class="builtintype" id="2892978">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2892992">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893011">pkgPath</span>&nbsp;<span class="op" id="2893019">*</span><span class="builtintype" id="2893020">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2893034">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893084">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2893092">*</span><span class="ident" id="2893093">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2893107">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893142">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2893150">*</span><span class="ident" id="2893151">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2893165">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893209">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2893217">unsafe</span><span class="op" id="2893223">.</span><span class="ident" id="2893224">Pointer</span>&nbsp;<span class="comment" id="2893232">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893282">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2893290">unsafe</span><span class="op" id="2893296">.</span><span class="ident" id="2893297">Pointer</span>&nbsp;<span class="comment" id="2893305">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2893339">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2893342">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2893406">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2893478">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2893546">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2893594">type</span>&nbsp;<span class="ident" id="2893599">uncommonType</span>&nbsp;<span class="keyword" id="2893612">struct</span>&nbsp;<span class="op" id="2893619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893622">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2893630">*</span><span class="builtintype" id="2893631">string</span>&nbsp;&nbsp;<span class="comment" id="2893639">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893656">pkgPath</span>&nbsp;<span class="op" id="2893664">*</span><span class="builtintype" id="2893665">string</span>&nbsp;&nbsp;<span class="comment" id="2893673">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893730">methods</span>&nbsp;<span class="op" id="2893738">[</span><span class="op" id="2893739">]</span><span class="ident" id="2893740">method</span>&nbsp;<span class="comment" id="2893747">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2893779">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2893782">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2893832">type</span>&nbsp;<span class="ident" id="2893837">ChanDir</span>&nbsp;<span class="builtintype" id="2893845">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2893850">const</span>&nbsp;<span class="op" id="2893856">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893859">RecvDir</span>&nbsp;<span class="ident" id="2893867">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2893887">=</span>&nbsp;<span class="num" id="2893889">1</span>&nbsp;<span class="op" id="2893891">&lt;&lt;</span>&nbsp;<span class="ident" id="2893894">iota</span>&nbsp;<span class="comment" id="2893899">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893910">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2893950">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893961">BothDir</span>&nbsp;<span class="op" id="2893969">=</span>&nbsp;<span class="ident" id="2893971">RecvDir</span>&nbsp;<span class="op" id="2893979">|</span>&nbsp;<span class="ident" id="2893981">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2894001">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2894009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2894012">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2894056">type</span>&nbsp;<span class="ident" id="2894061">arrayType</span>&nbsp;<span class="keyword" id="2894071">struct</span>&nbsp;<span class="op" id="2894078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894081">rtype</span>&nbsp;<span class="string" id="2894087">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894106">elem</span>&nbsp;&nbsp;<span class="op" id="2894112">*</span><span class="ident" id="2894113">rtype</span>&nbsp;<span class="comment" id="2894119">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894142">slice</span>&nbsp;<span class="op" id="2894148">*</span><span class="ident" id="2894149">rtype</span>&nbsp;<span class="comment" id="2894155">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2894170">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2894176">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2894184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2894187">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2894226">type</span>&nbsp;<span class="ident" id="2894231">chanType</span>&nbsp;<span class="keyword" id="2894240">struct</span>&nbsp;<span class="op" id="2894247">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894250">rtype</span>&nbsp;<span class="string" id="2894256">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894274">elem</span>&nbsp;&nbsp;<span class="op" id="2894280">*</span><span class="ident" id="2894281">rtype</span>&nbsp;&nbsp;<span class="comment" id="2894288">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894313">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2894319">uintptr</span>&nbsp;<span class="comment" id="2894327">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2894358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2894361">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2894401">type</span>&nbsp;<span class="ident" id="2894406">funcType</span>&nbsp;<span class="keyword" id="2894415">struct</span>&nbsp;<span class="op" id="2894422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894425">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2894435">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894453">dotdotdot</span>&nbsp;<span class="builtintype" id="2894463">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2894472">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894504">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2894514">[</span><span class="op" id="2894515">]</span><span class="op" id="2894516">*</span><span class="ident" id="2894517">rtype</span>&nbsp;<span class="comment" id="2894523">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894549">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2894559">[</span><span class="op" id="2894560">]</span><span class="op" id="2894561">*</span><span class="ident" id="2894562">rtype</span>&nbsp;<span class="comment" id="2894568">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2894594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2894597">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2894649">type</span>&nbsp;<span class="ident" id="2894654">imethod</span>&nbsp;<span class="keyword" id="2894662">struct</span>&nbsp;<span class="op" id="2894669">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894672">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2894680">*</span><span class="builtintype" id="2894681">string</span>&nbsp;<span class="comment" id="2894688">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894707">pkgPath</span>&nbsp;<span class="op" id="2894715">*</span><span class="builtintype" id="2894716">string</span>&nbsp;<span class="comment" id="2894723">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894773">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2894781">*</span><span class="ident" id="2894782">rtype</span>&nbsp;&nbsp;<span class="comment" id="2894789">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2894816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2894819">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2894866">type</span>&nbsp;<span class="ident" id="2894871">interfaceType</span>&nbsp;<span class="keyword" id="2894885">struct</span>&nbsp;<span class="op" id="2894892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894895">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2894903">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894926">methods</span>&nbsp;<span class="op" id="2894934">[</span><span class="op" id="2894935">]</span><span class="ident" id="2894936">imethod</span>&nbsp;<span class="comment" id="2894944">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2894962">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2894965">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2894999">type</span>&nbsp;<span class="ident" id="2895004">mapType</span>&nbsp;<span class="keyword" id="2895012">struct</span>&nbsp;<span class="op" id="2895019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895022">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2895036">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895053">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895067">*</span><span class="ident" id="2895068">rtype</span>&nbsp;<span class="comment" id="2895074">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895091">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895105">*</span><span class="ident" id="2895106">rtype</span>&nbsp;<span class="comment" id="2895112">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895141">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895155">*</span><span class="ident" id="2895156">rtype</span>&nbsp;<span class="comment" id="2895162">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895192">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895206">*</span><span class="ident" id="2895207">rtype</span>&nbsp;<span class="comment" id="2895213">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895237">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2895251">uint8</span>&nbsp;&nbsp;<span class="comment" id="2895258">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895279">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2895293">uint8</span>&nbsp;&nbsp;<span class="comment" id="2895300">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895343">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2895357">uint8</span>&nbsp;&nbsp;<span class="comment" id="2895364">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895387">indirectvalue</span>&nbsp;<span class="builtintype" id="2895401">uint8</span>&nbsp;&nbsp;<span class="comment" id="2895408">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895455">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2895469">uint16</span>&nbsp;<span class="comment" id="2895476">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2895494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2895497">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2895535">type</span>&nbsp;<span class="ident" id="2895540">ptrType</span>&nbsp;<span class="keyword" id="2895548">struct</span>&nbsp;<span class="op" id="2895555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895558">rtype</span>&nbsp;<span class="string" id="2895564">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895581">elem</span>&nbsp;&nbsp;<span class="op" id="2895587">*</span><span class="ident" id="2895588">rtype</span>&nbsp;<span class="comment" id="2895594">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2895631">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2895634">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2895672">type</span>&nbsp;<span class="ident" id="2895677">sliceType</span>&nbsp;<span class="keyword" id="2895687">struct</span>&nbsp;<span class="op" id="2895694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895697">rtype</span>&nbsp;<span class="string" id="2895703">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895722">elem</span>&nbsp;&nbsp;<span class="op" id="2895728">*</span><span class="ident" id="2895729">rtype</span>&nbsp;<span class="comment" id="2895735">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2895757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2895760">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2895776">type</span>&nbsp;<span class="ident" id="2895781">structField</span>&nbsp;<span class="keyword" id="2895793">struct</span>&nbsp;<span class="op" id="2895800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895803">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895811">*</span><span class="builtintype" id="2895812">string</span>&nbsp;<span class="comment" id="2895819">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895847">pkgPath</span>&nbsp;<span class="op" id="2895855">*</span><span class="builtintype" id="2895856">string</span>&nbsp;<span class="comment" id="2895863">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895913">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895921">*</span><span class="ident" id="2895922">rtype</span>&nbsp;&nbsp;<span class="comment" id="2895929">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895947">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2895955">*</span><span class="builtintype" id="2895956">string</span>&nbsp;<span class="comment" id="2895963">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895981">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2895989">uintptr</span>&nbsp;<span class="comment" id="2895997">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2896035">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2896038">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2896078">type</span>&nbsp;<span class="ident" id="2896083">structType</span>&nbsp;<span class="keyword" id="2896094">struct</span>&nbsp;<span class="op" id="2896101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896104">rtype</span>&nbsp;&nbsp;<span class="string" id="2896111">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896131">fields</span>&nbsp;<span class="op" id="2896138">[</span><span class="op" id="2896139">]</span><span class="ident" id="2896140">structField</span>&nbsp;<span class="comment" id="2896152">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2896172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2896175">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2896331">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2896369">type</span>&nbsp;<span class="ident" id="2896374">Method</span>&nbsp;<span class="keyword" id="2896381">struct</span>&nbsp;<span class="op" id="2896388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896391">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896420">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896493">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896563">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896632">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896653">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896714">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2896722">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896730">PkgPath</span>&nbsp;<span class="builtintype" id="2896738">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896747">Type</span>&nbsp;&nbsp;<span class="ident" id="2896753">Type</span>&nbsp;&nbsp;<span class="comment" id="2896759">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896775">Func</span>&nbsp;&nbsp;<span class="ident" id="2896781">Value</span>&nbsp;<span class="comment" id="2896787">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896828">Index</span>&nbsp;<span class="builtintype" id="2896834">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2896840">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2896865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2896868">const</span>&nbsp;<span class="op" id="2896874">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896877">kindDirectIface</span>&nbsp;<span class="op" id="2896893">=</span>&nbsp;<span class="num" id="2896895">1</span>&nbsp;<span class="op" id="2896897">&lt;&lt;</span>&nbsp;<span class="num" id="2896900">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896903">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2896919">=</span>&nbsp;<span class="num" id="2896921">1</span>&nbsp;<span class="op" id="2896923">&lt;&lt;</span>&nbsp;<span class="num" id="2896926">6</span>&nbsp;<span class="comment" id="2896928">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896961">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2896977">=</span>&nbsp;<span class="num" id="2896979">1</span>&nbsp;<span class="op" id="2896981">&lt;&lt;</span>&nbsp;<span class="num" id="2896984">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896987">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2897003">=</span>&nbsp;<span class="op" id="2897005">(</span><span class="num" id="2897006">1</span>&nbsp;<span class="op" id="2897008">&lt;&lt;</span>&nbsp;<span class="num" id="2897011">5</span><span class="op" id="2897012">)</span>&nbsp;<span class="op" id="2897014">-</span>&nbsp;<span class="num" id="2897016">1</span><br>
<span class="lineno"></span><span class="op" id="2897018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2897021">func</span>&nbsp;<span class="op" id="2897026">(</span><span class="ident" id="2897027">k</span>&nbsp;<span class="ident" id="2897029">Kind</span><span class="op" id="2897033">)</span>&nbsp;<span class="ident" id="2897035">String</span><span class="op" id="2897041">(</span><span class="op" id="2897042">)</span>&nbsp;<span class="builtintype" id="2897044">string</span>&nbsp;<span class="op" id="2897051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897054">if</span>&nbsp;<span class="builtintype" id="2897057">int</span><span class="op" id="2897060">(</span><span class="ident" id="2897061">k</span><span class="op" id="2897062">)</span>&nbsp;<span class="op" id="2897064">&lt;</span>&nbsp;<span class="builtinfunc" id="2897066">len</span><span class="op" id="2897069">(</span><span class="ident" id="2897070">kindNames</span><span class="op" id="2897079">)</span>&nbsp;<span class="op" id="2897081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897085">return</span>&nbsp;<span class="ident" id="2897092">kindNames</span><span class="op" id="2897101">[</span><span class="ident" id="2897102">k</span><span class="op" id="2897103">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897109">return</span>&nbsp;<span class="string" id="2897116">&#34;kind&#34;</span>&nbsp;<span class="op" id="2897123">+</span>&nbsp;<span class="ident" id="2897125">strconv</span><span class="op" id="2897132">.</span><span class="ident" id="2897133">Itoa</span><span class="op" id="2897137">(</span><span class="builtintype" id="2897138">int</span><span class="op" id="2897141">(</span><span class="ident" id="2897142">k</span><span class="op" id="2897143">)</span><span class="op" id="2897144">)</span><br>
<span class="lineno">410</span><span class="op" id="2897146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2897149">var</span>&nbsp;<span class="ident" id="2897153">kindNames</span>&nbsp;<span class="op" id="2897163">=</span>&nbsp;<span class="op" id="2897165">[</span><span class="op" id="2897166">]</span><span class="builtintype" id="2897167">string</span><span class="op" id="2897173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897176">Invalid</span><span class="op" id="2897183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897191">&#34;invalid&#34;</span><span class="op" id="2897200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897203">Bool</span><span class="op" id="2897207">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897218">&#34;bool&#34;</span><span class="op" id="2897224">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897227">Int</span><span class="op" id="2897230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897242">&#34;int&#34;</span><span class="op" id="2897247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897250">Int8</span><span class="op" id="2897254">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897265">&#34;int8&#34;</span><span class="op" id="2897271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897274">Int16</span><span class="op" id="2897279">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897289">&#34;int16&#34;</span><span class="op" id="2897296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897299">Int32</span><span class="op" id="2897304">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897314">&#34;int32&#34;</span><span class="op" id="2897321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897324">Int64</span><span class="op" id="2897329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897339">&#34;int64&#34;</span><span class="op" id="2897346">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897349">Uint</span><span class="op" id="2897353">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897364">&#34;uint&#34;</span><span class="op" id="2897370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897373">Uint8</span><span class="op" id="2897378">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897388">&#34;uint8&#34;</span><span class="op" id="2897395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897398">Uint16</span><span class="op" id="2897404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897413">&#34;uint16&#34;</span><span class="op" id="2897421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897424">Uint32</span><span class="op" id="2897430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897439">&#34;uint32&#34;</span><span class="op" id="2897447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897450">Uint64</span><span class="op" id="2897456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897465">&#34;uint64&#34;</span><span class="op" id="2897473">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897476">Uintptr</span><span class="op" id="2897483">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897491">&#34;uintptr&#34;</span><span class="op" id="2897500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897503">Float32</span><span class="op" id="2897510">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897518">&#34;float32&#34;</span><span class="op" id="2897527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897530">Float64</span><span class="op" id="2897537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897545">&#34;float64&#34;</span><span class="op" id="2897554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897557">Complex64</span><span class="op" id="2897566">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897572">&#34;complex64&#34;</span><span class="op" id="2897583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897586">Complex128</span><span class="op" id="2897596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897601">&#34;complex128&#34;</span><span class="op" id="2897613">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897616">Array</span><span class="op" id="2897621">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897631">&#34;array&#34;</span><span class="op" id="2897638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897641">Chan</span><span class="op" id="2897645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897656">&#34;chan&#34;</span><span class="op" id="2897662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897665">Func</span><span class="op" id="2897669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897680">&#34;func&#34;</span><span class="op" id="2897686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897689">Interface</span><span class="op" id="2897698">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897704">&#34;interface&#34;</span><span class="op" id="2897715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897718">Map</span><span class="op" id="2897721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897733">&#34;map&#34;</span><span class="op" id="2897738">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897741">Ptr</span><span class="op" id="2897744">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897756">&#34;ptr&#34;</span><span class="op" id="2897761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897764">Slice</span><span class="op" id="2897769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897779">&#34;slice&#34;</span><span class="op" id="2897786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897789">String</span><span class="op" id="2897795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897804">&#34;string&#34;</span><span class="op" id="2897812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897815">Struct</span><span class="op" id="2897821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2897830">&#34;struct&#34;</span><span class="op" id="2897838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897841">UnsafePointer</span><span class="op" id="2897854">:</span>&nbsp;<span class="string" id="2897856">&#34;unsafe.Pointer&#34;</span><span class="op" id="2897872">,</span><br>
<span class="lineno">440</span><span class="op" id="2897874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2897877">func</span>&nbsp;<span class="op" id="2897882">(</span><span class="ident" id="2897883">t</span>&nbsp;<span class="op" id="2897885">*</span><span class="ident" id="2897886">uncommonType</span><span class="op" id="2897898">)</span>&nbsp;<span class="ident" id="2897900">uncommon</span><span class="op" id="2897908">(</span><span class="op" id="2897909">)</span>&nbsp;<span class="op" id="2897911">*</span><span class="ident" id="2897912">uncommonType</span>&nbsp;<span class="op" id="2897925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897928">return</span>&nbsp;<span class="ident" id="2897935">t</span><br>
<span class="lineno"></span><span class="op" id="2897937">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2897940">func</span>&nbsp;<span class="op" id="2897945">(</span><span class="ident" id="2897946">t</span>&nbsp;<span class="op" id="2897948">*</span><span class="ident" id="2897949">uncommonType</span><span class="op" id="2897961">)</span>&nbsp;<span class="ident" id="2897963">PkgPath</span><span class="op" id="2897970">(</span><span class="op" id="2897971">)</span>&nbsp;<span class="builtintype" id="2897973">string</span>&nbsp;<span class="op" id="2897980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897983">if</span>&nbsp;<span class="ident" id="2897986">t</span>&nbsp;<span class="op" id="2897988">==</span>&nbsp;<span class="ident" id="2897991">nil</span>&nbsp;<span class="op" id="2897995">||</span>&nbsp;<span class="ident" id="2897998">t</span><span class="op" id="2897999">.</span><span class="ident" id="2898000">pkgPath</span>&nbsp;<span class="op" id="2898008">==</span>&nbsp;<span class="ident" id="2898011">nil</span>&nbsp;<span class="op" id="2898015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898019">return</span>&nbsp;<span class="string" id="2898026">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898030">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898033">return</span>&nbsp;<span class="op" id="2898040">*</span><span class="ident" id="2898041">t</span><span class="op" id="2898042">.</span><span class="ident" id="2898043">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2898051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898054">func</span>&nbsp;<span class="op" id="2898059">(</span><span class="ident" id="2898060">t</span>&nbsp;<span class="op" id="2898062">*</span><span class="ident" id="2898063">uncommonType</span><span class="op" id="2898075">)</span>&nbsp;<span class="ident" id="2898077">Name</span><span class="op" id="2898081">(</span><span class="op" id="2898082">)</span>&nbsp;<span class="builtintype" id="2898084">string</span>&nbsp;<span class="op" id="2898091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898094">if</span>&nbsp;<span class="ident" id="2898097">t</span>&nbsp;<span class="op" id="2898099">==</span>&nbsp;<span class="ident" id="2898102">nil</span>&nbsp;<span class="op" id="2898106">||</span>&nbsp;<span class="ident" id="2898109">t</span><span class="op" id="2898110">.</span><span class="ident" id="2898111">name</span>&nbsp;<span class="op" id="2898116">==</span>&nbsp;<span class="ident" id="2898119">nil</span>&nbsp;<span class="op" id="2898123">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898127">return</span>&nbsp;<span class="string" id="2898134">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898141">return</span>&nbsp;<span class="op" id="2898148">*</span><span class="ident" id="2898149">t</span><span class="op" id="2898150">.</span><span class="ident" id="2898151">name</span><br>
<span class="lineno"></span><span class="op" id="2898156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2898159">func</span>&nbsp;<span class="op" id="2898164">(</span><span class="ident" id="2898165">t</span>&nbsp;<span class="op" id="2898167">*</span><span class="ident" id="2898168">rtype</span><span class="op" id="2898173">)</span>&nbsp;<span class="ident" id="2898175">String</span><span class="op" id="2898181">(</span><span class="op" id="2898182">)</span>&nbsp;<span class="builtintype" id="2898184">string</span>&nbsp;<span class="op" id="2898191">{</span>&nbsp;<span class="keyword" id="2898193">return</span>&nbsp;<span class="op" id="2898200">*</span><span class="ident" id="2898201">t</span><span class="op" id="2898202">.</span><span class="builtintype" id="2898203">string</span>&nbsp;<span class="op" id="2898210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898213">func</span>&nbsp;<span class="op" id="2898218">(</span><span class="ident" id="2898219">t</span>&nbsp;<span class="op" id="2898221">*</span><span class="ident" id="2898222">rtype</span><span class="op" id="2898227">)</span>&nbsp;<span class="ident" id="2898229">Size</span><span class="op" id="2898233">(</span><span class="op" id="2898234">)</span>&nbsp;<span class="builtintype" id="2898236">uintptr</span>&nbsp;<span class="op" id="2898244">{</span>&nbsp;<span class="keyword" id="2898246">return</span>&nbsp;<span class="ident" id="2898253">t</span><span class="op" id="2898254">.</span><span class="ident" id="2898255">size</span>&nbsp;<span class="op" id="2898260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898263">func</span>&nbsp;<span class="op" id="2898268">(</span><span class="ident" id="2898269">t</span>&nbsp;<span class="op" id="2898271">*</span><span class="ident" id="2898272">rtype</span><span class="op" id="2898277">)</span>&nbsp;<span class="ident" id="2898279">Bits</span><span class="op" id="2898283">(</span><span class="op" id="2898284">)</span>&nbsp;<span class="builtintype" id="2898286">int</span>&nbsp;<span class="op" id="2898290">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898293">if</span>&nbsp;<span class="ident" id="2898296">t</span>&nbsp;<span class="op" id="2898298">==</span>&nbsp;<span class="ident" id="2898301">nil</span>&nbsp;<span class="op" id="2898305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2898309">panic</span><span class="op" id="2898314">(</span><span class="string" id="2898315">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2898342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898348">k</span>&nbsp;<span class="op" id="2898350">:=</span>&nbsp;<span class="ident" id="2898353">t</span><span class="op" id="2898354">.</span><span class="ident" id="2898355">Kind</span><span class="op" id="2898359">(</span><span class="op" id="2898360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898363">if</span>&nbsp;<span class="ident" id="2898366">k</span>&nbsp;<span class="op" id="2898368">&lt;</span>&nbsp;<span class="ident" id="2898370">Int</span>&nbsp;<span class="op" id="2898374">||</span>&nbsp;<span class="ident" id="2898377">k</span>&nbsp;<span class="op" id="2898379">&gt;</span>&nbsp;<span class="ident" id="2898381">Complex128</span>&nbsp;<span class="op" id="2898392">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2898396">panic</span><span class="op" id="2898401">(</span><span class="string" id="2898402">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2898442">+</span>&nbsp;<span class="ident" id="2898444">t</span><span class="op" id="2898445">.</span><span class="ident" id="2898446">String</span><span class="op" id="2898452">(</span><span class="op" id="2898453">)</span><span class="op" id="2898454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898460">return</span>&nbsp;<span class="builtintype" id="2898467">int</span><span class="op" id="2898470">(</span><span class="ident" id="2898471">t</span><span class="op" id="2898472">.</span><span class="ident" id="2898473">size</span><span class="op" id="2898477">)</span>&nbsp;<span class="op" id="2898479">*</span>&nbsp;<span class="num" id="2898481">8</span><br>
<span class="lineno"></span><span class="op" id="2898483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2898486">func</span>&nbsp;<span class="op" id="2898491">(</span><span class="ident" id="2898492">t</span>&nbsp;<span class="op" id="2898494">*</span><span class="ident" id="2898495">rtype</span><span class="op" id="2898500">)</span>&nbsp;<span class="ident" id="2898502">Align</span><span class="op" id="2898507">(</span><span class="op" id="2898508">)</span>&nbsp;<span class="builtintype" id="2898510">int</span>&nbsp;<span class="op" id="2898514">{</span>&nbsp;<span class="keyword" id="2898516">return</span>&nbsp;<span class="builtintype" id="2898523">int</span><span class="op" id="2898526">(</span><span class="ident" id="2898527">t</span><span class="op" id="2898528">.</span><span class="ident" id="2898529">align</span><span class="op" id="2898534">)</span>&nbsp;<span class="op" id="2898536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898539">func</span>&nbsp;<span class="op" id="2898544">(</span><span class="ident" id="2898545">t</span>&nbsp;<span class="op" id="2898547">*</span><span class="ident" id="2898548">rtype</span><span class="op" id="2898553">)</span>&nbsp;<span class="ident" id="2898555">FieldAlign</span><span class="op" id="2898565">(</span><span class="op" id="2898566">)</span>&nbsp;<span class="builtintype" id="2898568">int</span>&nbsp;<span class="op" id="2898572">{</span>&nbsp;<span class="keyword" id="2898574">return</span>&nbsp;<span class="builtintype" id="2898581">int</span><span class="op" id="2898584">(</span><span class="ident" id="2898585">t</span><span class="op" id="2898586">.</span><span class="ident" id="2898587">fieldAlign</span><span class="op" id="2898597">)</span>&nbsp;<span class="op" id="2898599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898602">func</span>&nbsp;<span class="op" id="2898607">(</span><span class="ident" id="2898608">t</span>&nbsp;<span class="op" id="2898610">*</span><span class="ident" id="2898611">rtype</span><span class="op" id="2898616">)</span>&nbsp;<span class="ident" id="2898618">Kind</span><span class="op" id="2898622">(</span><span class="op" id="2898623">)</span>&nbsp;<span class="ident" id="2898625">Kind</span>&nbsp;<span class="op" id="2898630">{</span>&nbsp;<span class="keyword" id="2898632">return</span>&nbsp;<span class="ident" id="2898639">Kind</span><span class="op" id="2898643">(</span><span class="ident" id="2898644">t</span><span class="op" id="2898645">.</span><span class="ident" id="2898646">kind</span>&nbsp;<span class="op" id="2898651">&amp;</span>&nbsp;<span class="ident" id="2898653">kindMask</span><span class="op" id="2898661">)</span>&nbsp;<span class="op" id="2898663">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2898666">func</span>&nbsp;<span class="op" id="2898671">(</span><span class="ident" id="2898672">t</span>&nbsp;<span class="op" id="2898674">*</span><span class="ident" id="2898675">rtype</span><span class="op" id="2898680">)</span>&nbsp;<span class="ident" id="2898682">pointers</span><span class="op" id="2898690">(</span><span class="op" id="2898691">)</span>&nbsp;<span class="builtintype" id="2898693">bool</span>&nbsp;<span class="op" id="2898698">{</span>&nbsp;<span class="keyword" id="2898700">return</span>&nbsp;<span class="ident" id="2898707">t</span><span class="op" id="2898708">.</span><span class="ident" id="2898709">kind</span><span class="op" id="2898713">&amp;</span><span class="ident" id="2898714">kindNoPointers</span>&nbsp;<span class="op" id="2898729">==</span>&nbsp;<span class="num" id="2898732">0</span>&nbsp;<span class="op" id="2898734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2898737">func</span>&nbsp;<span class="op" id="2898742">(</span><span class="ident" id="2898743">t</span>&nbsp;<span class="op" id="2898745">*</span><span class="ident" id="2898746">rtype</span><span class="op" id="2898751">)</span>&nbsp;<span class="ident" id="2898753">common</span><span class="op" id="2898759">(</span><span class="op" id="2898760">)</span>&nbsp;<span class="op" id="2898762">*</span><span class="ident" id="2898763">rtype</span>&nbsp;<span class="op" id="2898769">{</span>&nbsp;<span class="keyword" id="2898771">return</span>&nbsp;<span class="ident" id="2898778">t</span>&nbsp;<span class="op" id="2898780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2898783">func</span>&nbsp;<span class="op" id="2898788">(</span><span class="ident" id="2898789">t</span>&nbsp;<span class="op" id="2898791">*</span><span class="ident" id="2898792">uncommonType</span><span class="op" id="2898804">)</span>&nbsp;<span class="ident" id="2898806">Method</span><span class="op" id="2898812">(</span><span class="ident" id="2898813">i</span>&nbsp;<span class="builtintype" id="2898815">int</span><span class="op" id="2898818">)</span>&nbsp;<span class="op" id="2898820">(</span><span class="ident" id="2898821">m</span>&nbsp;<span class="ident" id="2898823">Method</span><span class="op" id="2898829">)</span>&nbsp;<span class="op" id="2898831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898834">if</span>&nbsp;<span class="ident" id="2898837">t</span>&nbsp;<span class="op" id="2898839">==</span>&nbsp;<span class="ident" id="2898842">nil</span>&nbsp;<span class="op" id="2898846">||</span>&nbsp;<span class="ident" id="2898849">i</span>&nbsp;<span class="op" id="2898851">&lt;</span>&nbsp;<span class="num" id="2898853">0</span>&nbsp;<span class="op" id="2898855">||</span>&nbsp;<span class="ident" id="2898858">i</span>&nbsp;<span class="op" id="2898860">&gt;=</span>&nbsp;<span class="builtinfunc" id="2898863">len</span><span class="op" id="2898866">(</span><span class="ident" id="2898867">t</span><span class="op" id="2898868">.</span><span class="ident" id="2898869">methods</span><span class="op" id="2898876">)</span>&nbsp;<span class="op" id="2898878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2898882">panic</span><span class="op" id="2898887">(</span><span class="string" id="2898888">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2898924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898930">p</span>&nbsp;<span class="op" id="2898932">:=</span>&nbsp;<span class="op" id="2898935">&amp;</span><span class="ident" id="2898936">t</span><span class="op" id="2898937">.</span><span class="ident" id="2898938">methods</span><span class="op" id="2898945">[</span><span class="ident" id="2898946">i</span><span class="op" id="2898947">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898950">if</span>&nbsp;<span class="ident" id="2898953">p</span><span class="op" id="2898954">.</span><span class="ident" id="2898955">name</span>&nbsp;<span class="op" id="2898960">!=</span>&nbsp;<span class="ident" id="2898963">nil</span>&nbsp;<span class="op" id="2898967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898971">m</span><span class="op" id="2898972">.</span><span class="ident" id="2898973">Name</span>&nbsp;<span class="op" id="2898978">=</span>&nbsp;<span class="op" id="2898980">*</span><span class="ident" id="2898981">p</span><span class="op" id="2898982">.</span><span class="ident" id="2898983">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898992">fl</span>&nbsp;<span class="op" id="2898995">:=</span>&nbsp;<span class="ident" id="2898998">flag</span><span class="op" id="2899002">(</span><span class="ident" id="2899003">Func</span><span class="op" id="2899007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899010">if</span>&nbsp;<span class="ident" id="2899013">p</span><span class="op" id="2899014">.</span><span class="ident" id="2899015">pkgPath</span>&nbsp;<span class="op" id="2899023">!=</span>&nbsp;<span class="ident" id="2899026">nil</span>&nbsp;<span class="op" id="2899030">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899034">m</span><span class="op" id="2899035">.</span><span class="ident" id="2899036">PkgPath</span>&nbsp;<span class="op" id="2899044">=</span>&nbsp;<span class="op" id="2899046">*</span><span class="ident" id="2899047">p</span><span class="op" id="2899048">.</span><span class="ident" id="2899049">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899059">fl</span>&nbsp;<span class="op" id="2899062">|=</span>&nbsp;<span class="ident" id="2899065">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899076">mt</span>&nbsp;<span class="op" id="2899079">:=</span>&nbsp;<span class="ident" id="2899082">p</span><span class="op" id="2899083">.</span><span class="ident" id="2899084">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899089">m</span><span class="op" id="2899090">.</span><span class="ident" id="2899091">Type</span>&nbsp;<span class="op" id="2899096">=</span>&nbsp;<span class="ident" id="2899098">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899102">fn</span>&nbsp;<span class="op" id="2899105">:=</span>&nbsp;<span class="ident" id="2899108">unsafe</span><span class="op" id="2899114">.</span><span class="ident" id="2899115">Pointer</span><span class="op" id="2899122">(</span><span class="op" id="2899123">&amp;</span><span class="ident" id="2899124">p</span><span class="op" id="2899125">.</span><span class="ident" id="2899126">tfn</span><span class="op" id="2899129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899132">m</span><span class="op" id="2899133">.</span><span class="ident" id="2899134">Func</span>&nbsp;<span class="op" id="2899139">=</span>&nbsp;<span class="ident" id="2899141">Value</span><span class="op" id="2899146">{</span><span class="ident" id="2899147">mt</span><span class="op" id="2899149">,</span>&nbsp;<span class="ident" id="2899151">fn</span><span class="op" id="2899153">,</span>&nbsp;<span class="ident" id="2899155">fl</span><span class="op" id="2899157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899160">m</span><span class="op" id="2899161">.</span><span class="ident" id="2899162">Index</span>&nbsp;<span class="op" id="2899168">=</span>&nbsp;<span class="ident" id="2899170">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899173">return</span><br>
<span class="lineno"></span><span class="op" id="2899180">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2899183">func</span>&nbsp;<span class="op" id="2899188">(</span><span class="ident" id="2899189">t</span>&nbsp;<span class="op" id="2899191">*</span><span class="ident" id="2899192">uncommonType</span><span class="op" id="2899204">)</span>&nbsp;<span class="ident" id="2899206">NumMethod</span><span class="op" id="2899215">(</span><span class="op" id="2899216">)</span>&nbsp;<span class="builtintype" id="2899218">int</span>&nbsp;<span class="op" id="2899222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899225">if</span>&nbsp;<span class="ident" id="2899228">t</span>&nbsp;<span class="op" id="2899230">==</span>&nbsp;<span class="ident" id="2899233">nil</span>&nbsp;<span class="op" id="2899237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899241">return</span>&nbsp;<span class="num" id="2899248">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899251">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899254">return</span>&nbsp;<span class="builtinfunc" id="2899261">len</span><span class="op" id="2899264">(</span><span class="ident" id="2899265">t</span><span class="op" id="2899266">.</span><span class="ident" id="2899267">methods</span><span class="op" id="2899274">)</span><br>
<span class="lineno"></span><span class="op" id="2899276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2899279">func</span>&nbsp;<span class="op" id="2899284">(</span><span class="ident" id="2899285">t</span>&nbsp;<span class="op" id="2899287">*</span><span class="ident" id="2899288">uncommonType</span><span class="op" id="2899300">)</span>&nbsp;<span class="ident" id="2899302">MethodByName</span><span class="op" id="2899314">(</span><span class="ident" id="2899315">name</span>&nbsp;<span class="builtintype" id="2899320">string</span><span class="op" id="2899326">)</span>&nbsp;<span class="op" id="2899328">(</span><span class="ident" id="2899329">m</span>&nbsp;<span class="ident" id="2899331">Method</span><span class="op" id="2899337">,</span>&nbsp;<span class="ident" id="2899339">ok</span>&nbsp;<span class="builtintype" id="2899342">bool</span><span class="op" id="2899346">)</span>&nbsp;<span class="op" id="2899348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899351">if</span>&nbsp;<span class="ident" id="2899354">t</span>&nbsp;<span class="op" id="2899356">==</span>&nbsp;<span class="ident" id="2899359">nil</span>&nbsp;<span class="op" id="2899363">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899367">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899378">var</span>&nbsp;<span class="ident" id="2899382">p</span>&nbsp;<span class="op" id="2899384">*</span><span class="ident" id="2899385">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899393">for</span>&nbsp;<span class="ident" id="2899397">i</span>&nbsp;<span class="op" id="2899399">:=</span>&nbsp;<span class="keyword" id="2899402">range</span>&nbsp;<span class="ident" id="2899408">t</span><span class="op" id="2899409">.</span><span class="ident" id="2899410">methods</span>&nbsp;<span class="op" id="2899418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899422">p</span>&nbsp;<span class="op" id="2899424">=</span>&nbsp;<span class="op" id="2899426">&amp;</span><span class="ident" id="2899427">t</span><span class="op" id="2899428">.</span><span class="ident" id="2899429">methods</span><span class="op" id="2899436">[</span><span class="ident" id="2899437">i</span><span class="op" id="2899438">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899442">if</span>&nbsp;<span class="ident" id="2899445">p</span><span class="op" id="2899446">.</span><span class="ident" id="2899447">name</span>&nbsp;<span class="op" id="2899452">!=</span>&nbsp;<span class="ident" id="2899455">nil</span>&nbsp;<span class="op" id="2899459">&amp;&amp;</span>&nbsp;<span class="op" id="2899462">*</span><span class="ident" id="2899463">p</span><span class="op" id="2899464">.</span><span class="ident" id="2899465">name</span>&nbsp;<span class="op" id="2899470">==</span>&nbsp;<span class="ident" id="2899473">name</span>&nbsp;<span class="op" id="2899478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899483">return</span>&nbsp;<span class="ident" id="2899490">t</span><span class="op" id="2899491">.</span><span class="ident" id="2899492">Method</span><span class="op" id="2899498">(</span><span class="ident" id="2899499">i</span><span class="op" id="2899500">)</span><span class="op" id="2899501">,</span>&nbsp;<span class="builtintype" id="2899503">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899516">return</span><br>
<span class="lineno">525</span><span class="op" id="2899523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2899526">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2899576">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2899631">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2899669">func</span>&nbsp;<span class="op" id="2899674">(</span><span class="ident" id="2899675">t</span>&nbsp;<span class="op" id="2899677">*</span><span class="ident" id="2899678">rtype</span><span class="op" id="2899683">)</span>&nbsp;<span class="ident" id="2899685">NumMethod</span><span class="op" id="2899694">(</span><span class="op" id="2899695">)</span>&nbsp;<span class="builtintype" id="2899697">int</span>&nbsp;<span class="op" id="2899701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899704">if</span>&nbsp;<span class="ident" id="2899707">t</span><span class="op" id="2899708">.</span><span class="ident" id="2899709">Kind</span><span class="op" id="2899713">(</span><span class="op" id="2899714">)</span>&nbsp;<span class="op" id="2899716">==</span>&nbsp;<span class="ident" id="2899719">Interface</span>&nbsp;<span class="op" id="2899729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899733">tt</span>&nbsp;<span class="op" id="2899736">:=</span>&nbsp;<span class="op" id="2899739">(</span><span class="op" id="2899740">*</span><span class="ident" id="2899741">interfaceType</span><span class="op" id="2899754">)</span><span class="op" id="2899755">(</span><span class="ident" id="2899756">unsafe</span><span class="op" id="2899762">.</span><span class="ident" id="2899763">Pointer</span><span class="op" id="2899770">(</span><span class="ident" id="2899771">t</span><span class="op" id="2899772">)</span><span class="op" id="2899773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899777">return</span>&nbsp;<span class="ident" id="2899784">tt</span><span class="op" id="2899786">.</span><span class="ident" id="2899787">NumMethod</span><span class="op" id="2899796">(</span><span class="op" id="2899797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899800">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899803">return</span>&nbsp;<span class="ident" id="2899810">t</span><span class="op" id="2899811">.</span><span class="ident" id="2899812">uncommonType</span><span class="op" id="2899824">.</span><span class="ident" id="2899825">NumMethod</span><span class="op" id="2899834">(</span><span class="op" id="2899835">)</span><br>
<span class="lineno"></span><span class="op" id="2899837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2899840">func</span>&nbsp;<span class="op" id="2899845">(</span><span class="ident" id="2899846">t</span>&nbsp;<span class="op" id="2899848">*</span><span class="ident" id="2899849">rtype</span><span class="op" id="2899854">)</span>&nbsp;<span class="ident" id="2899856">Method</span><span class="op" id="2899862">(</span><span class="ident" id="2899863">i</span>&nbsp;<span class="builtintype" id="2899865">int</span><span class="op" id="2899868">)</span>&nbsp;<span class="op" id="2899870">(</span><span class="ident" id="2899871">m</span>&nbsp;<span class="ident" id="2899873">Method</span><span class="op" id="2899879">)</span>&nbsp;<span class="op" id="2899881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899884">if</span>&nbsp;<span class="ident" id="2899887">t</span><span class="op" id="2899888">.</span><span class="ident" id="2899889">Kind</span><span class="op" id="2899893">(</span><span class="op" id="2899894">)</span>&nbsp;<span class="op" id="2899896">==</span>&nbsp;<span class="ident" id="2899899">Interface</span>&nbsp;<span class="op" id="2899909">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899913">tt</span>&nbsp;<span class="op" id="2899916">:=</span>&nbsp;<span class="op" id="2899919">(</span><span class="op" id="2899920">*</span><span class="ident" id="2899921">interfaceType</span><span class="op" id="2899934">)</span><span class="op" id="2899935">(</span><span class="ident" id="2899936">unsafe</span><span class="op" id="2899942">.</span><span class="ident" id="2899943">Pointer</span><span class="op" id="2899950">(</span><span class="ident" id="2899951">t</span><span class="op" id="2899952">)</span><span class="op" id="2899953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899957">return</span>&nbsp;<span class="ident" id="2899964">tt</span><span class="op" id="2899966">.</span><span class="ident" id="2899967">Method</span><span class="op" id="2899973">(</span><span class="ident" id="2899974">i</span><span class="op" id="2899975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899981">return</span>&nbsp;<span class="ident" id="2899988">t</span><span class="op" id="2899989">.</span><span class="ident" id="2899990">uncommonType</span><span class="op" id="2900002">.</span><span class="ident" id="2900003">Method</span><span class="op" id="2900009">(</span><span class="ident" id="2900010">i</span><span class="op" id="2900011">)</span><br>
<span class="lineno"></span><span class="op" id="2900013">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2900016">func</span>&nbsp;<span class="op" id="2900021">(</span><span class="ident" id="2900022">t</span>&nbsp;<span class="op" id="2900024">*</span><span class="ident" id="2900025">rtype</span><span class="op" id="2900030">)</span>&nbsp;<span class="ident" id="2900032">MethodByName</span><span class="op" id="2900044">(</span><span class="ident" id="2900045">name</span>&nbsp;<span class="builtintype" id="2900050">string</span><span class="op" id="2900056">)</span>&nbsp;<span class="op" id="2900058">(</span><span class="ident" id="2900059">m</span>&nbsp;<span class="ident" id="2900061">Method</span><span class="op" id="2900067">,</span>&nbsp;<span class="ident" id="2900069">ok</span>&nbsp;<span class="builtintype" id="2900072">bool</span><span class="op" id="2900076">)</span>&nbsp;<span class="op" id="2900078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900081">if</span>&nbsp;<span class="ident" id="2900084">t</span><span class="op" id="2900085">.</span><span class="ident" id="2900086">Kind</span><span class="op" id="2900090">(</span><span class="op" id="2900091">)</span>&nbsp;<span class="op" id="2900093">==</span>&nbsp;<span class="ident" id="2900096">Interface</span>&nbsp;<span class="op" id="2900106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900110">tt</span>&nbsp;<span class="op" id="2900113">:=</span>&nbsp;<span class="op" id="2900116">(</span><span class="op" id="2900117">*</span><span class="ident" id="2900118">interfaceType</span><span class="op" id="2900131">)</span><span class="op" id="2900132">(</span><span class="ident" id="2900133">unsafe</span><span class="op" id="2900139">.</span><span class="ident" id="2900140">Pointer</span><span class="op" id="2900147">(</span><span class="ident" id="2900148">t</span><span class="op" id="2900149">)</span><span class="op" id="2900150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900154">return</span>&nbsp;<span class="ident" id="2900161">tt</span><span class="op" id="2900163">.</span><span class="ident" id="2900164">MethodByName</span><span class="op" id="2900176">(</span><span class="ident" id="2900177">name</span><span class="op" id="2900181">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900187">return</span>&nbsp;<span class="ident" id="2900194">t</span><span class="op" id="2900195">.</span><span class="ident" id="2900196">uncommonType</span><span class="op" id="2900208">.</span><span class="ident" id="2900209">MethodByName</span><span class="op" id="2900221">(</span><span class="ident" id="2900222">name</span><span class="op" id="2900226">)</span><br>
<span class="lineno"></span><span class="op" id="2900228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2900231">func</span>&nbsp;<span class="op" id="2900236">(</span><span class="ident" id="2900237">t</span>&nbsp;<span class="op" id="2900239">*</span><span class="ident" id="2900240">rtype</span><span class="op" id="2900245">)</span>&nbsp;<span class="ident" id="2900247">PkgPath</span><span class="op" id="2900254">(</span><span class="op" id="2900255">)</span>&nbsp;<span class="builtintype" id="2900257">string</span>&nbsp;<span class="op" id="2900264">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900267">return</span>&nbsp;<span class="ident" id="2900274">t</span><span class="op" id="2900275">.</span><span class="ident" id="2900276">uncommonType</span><span class="op" id="2900288">.</span><span class="ident" id="2900289">PkgPath</span><span class="op" id="2900296">(</span><span class="op" id="2900297">)</span><br>
<span class="lineno"></span><span class="op" id="2900299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2900302">func</span>&nbsp;<span class="op" id="2900307">(</span><span class="ident" id="2900308">t</span>&nbsp;<span class="op" id="2900310">*</span><span class="ident" id="2900311">rtype</span><span class="op" id="2900316">)</span>&nbsp;<span class="ident" id="2900318">Name</span><span class="op" id="2900322">(</span><span class="op" id="2900323">)</span>&nbsp;<span class="builtintype" id="2900325">string</span>&nbsp;<span class="op" id="2900332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900335">return</span>&nbsp;<span class="ident" id="2900342">t</span><span class="op" id="2900343">.</span><span class="ident" id="2900344">uncommonType</span><span class="op" id="2900356">.</span><span class="ident" id="2900357">Name</span><span class="op" id="2900361">(</span><span class="op" id="2900362">)</span><br>
<span class="lineno">560</span><span class="op" id="2900364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2900367">func</span>&nbsp;<span class="op" id="2900372">(</span><span class="ident" id="2900373">t</span>&nbsp;<span class="op" id="2900375">*</span><span class="ident" id="2900376">rtype</span><span class="op" id="2900381">)</span>&nbsp;<span class="ident" id="2900383">ChanDir</span><span class="op" id="2900390">(</span><span class="op" id="2900391">)</span>&nbsp;<span class="ident" id="2900393">ChanDir</span>&nbsp;<span class="op" id="2900401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900404">if</span>&nbsp;<span class="ident" id="2900407">t</span><span class="op" id="2900408">.</span><span class="ident" id="2900409">Kind</span><span class="op" id="2900413">(</span><span class="op" id="2900414">)</span>&nbsp;<span class="op" id="2900416">!=</span>&nbsp;<span class="ident" id="2900419">Chan</span>&nbsp;<span class="op" id="2900424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2900428">panic</span><span class="op" id="2900433">(</span><span class="string" id="2900434">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2900469">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900475">tt</span>&nbsp;<span class="op" id="2900478">:=</span>&nbsp;<span class="op" id="2900481">(</span><span class="op" id="2900482">*</span><span class="ident" id="2900483">chanType</span><span class="op" id="2900491">)</span><span class="op" id="2900492">(</span><span class="ident" id="2900493">unsafe</span><span class="op" id="2900499">.</span><span class="ident" id="2900500">Pointer</span><span class="op" id="2900507">(</span><span class="ident" id="2900508">t</span><span class="op" id="2900509">)</span><span class="op" id="2900510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900513">return</span>&nbsp;<span class="ident" id="2900520">ChanDir</span><span class="op" id="2900527">(</span><span class="ident" id="2900528">tt</span><span class="op" id="2900530">.</span><span class="ident" id="2900531">dir</span><span class="op" id="2900534">)</span><br>
<span class="lineno"></span><span class="op" id="2900536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2900539">func</span>&nbsp;<span class="op" id="2900544">(</span><span class="ident" id="2900545">t</span>&nbsp;<span class="op" id="2900547">*</span><span class="ident" id="2900548">rtype</span><span class="op" id="2900553">)</span>&nbsp;<span class="ident" id="2900555">IsVariadic</span><span class="op" id="2900565">(</span><span class="op" id="2900566">)</span>&nbsp;<span class="builtintype" id="2900568">bool</span>&nbsp;<span class="op" id="2900573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900576">if</span>&nbsp;<span class="ident" id="2900579">t</span><span class="op" id="2900580">.</span><span class="ident" id="2900581">Kind</span><span class="op" id="2900585">(</span><span class="op" id="2900586">)</span>&nbsp;<span class="op" id="2900588">!=</span>&nbsp;<span class="ident" id="2900591">Func</span>&nbsp;<span class="op" id="2900596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2900600">panic</span><span class="op" id="2900605">(</span><span class="string" id="2900606">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2900644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900650">tt</span>&nbsp;<span class="op" id="2900653">:=</span>&nbsp;<span class="op" id="2900656">(</span><span class="op" id="2900657">*</span><span class="ident" id="2900658">funcType</span><span class="op" id="2900666">)</span><span class="op" id="2900667">(</span><span class="ident" id="2900668">unsafe</span><span class="op" id="2900674">.</span><span class="ident" id="2900675">Pointer</span><span class="op" id="2900682">(</span><span class="ident" id="2900683">t</span><span class="op" id="2900684">)</span><span class="op" id="2900685">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900688">return</span>&nbsp;<span class="ident" id="2900695">tt</span><span class="op" id="2900697">.</span><span class="ident" id="2900698">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2900708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2900711">func</span>&nbsp;<span class="op" id="2900716">(</span><span class="ident" id="2900717">t</span>&nbsp;<span class="op" id="2900719">*</span><span class="ident" id="2900720">rtype</span><span class="op" id="2900725">)</span>&nbsp;<span class="ident" id="2900727">Elem</span><span class="op" id="2900731">(</span><span class="op" id="2900732">)</span>&nbsp;<span class="ident" id="2900734">Type</span>&nbsp;<span class="op" id="2900739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900742">switch</span>&nbsp;<span class="ident" id="2900749">t</span><span class="op" id="2900750">.</span><span class="ident" id="2900751">Kind</span><span class="op" id="2900755">(</span><span class="op" id="2900756">)</span>&nbsp;<span class="op" id="2900758">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900761">case</span>&nbsp;<span class="ident" id="2900766">Array</span><span class="op" id="2900771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900775">tt</span>&nbsp;<span class="op" id="2900778">:=</span>&nbsp;<span class="op" id="2900781">(</span><span class="op" id="2900782">*</span><span class="ident" id="2900783">arrayType</span><span class="op" id="2900792">)</span><span class="op" id="2900793">(</span><span class="ident" id="2900794">unsafe</span><span class="op" id="2900800">.</span><span class="ident" id="2900801">Pointer</span><span class="op" id="2900808">(</span><span class="ident" id="2900809">t</span><span class="op" id="2900810">)</span><span class="op" id="2900811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900815">return</span>&nbsp;<span class="ident" id="2900822">toType</span><span class="op" id="2900828">(</span><span class="ident" id="2900829">tt</span><span class="op" id="2900831">.</span><span class="ident" id="2900832">elem</span><span class="op" id="2900836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900839">case</span>&nbsp;<span class="ident" id="2900844">Chan</span><span class="op" id="2900848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900852">tt</span>&nbsp;<span class="op" id="2900855">:=</span>&nbsp;<span class="op" id="2900858">(</span><span class="op" id="2900859">*</span><span class="ident" id="2900860">chanType</span><span class="op" id="2900868">)</span><span class="op" id="2900869">(</span><span class="ident" id="2900870">unsafe</span><span class="op" id="2900876">.</span><span class="ident" id="2900877">Pointer</span><span class="op" id="2900884">(</span><span class="ident" id="2900885">t</span><span class="op" id="2900886">)</span><span class="op" id="2900887">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900891">return</span>&nbsp;<span class="ident" id="2900898">toType</span><span class="op" id="2900904">(</span><span class="ident" id="2900905">tt</span><span class="op" id="2900907">.</span><span class="ident" id="2900908">elem</span><span class="op" id="2900912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900915">case</span>&nbsp;<span class="ident" id="2900920">Map</span><span class="op" id="2900923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900927">tt</span>&nbsp;<span class="op" id="2900930">:=</span>&nbsp;<span class="op" id="2900933">(</span><span class="op" id="2900934">*</span><span class="ident" id="2900935">mapType</span><span class="op" id="2900942">)</span><span class="op" id="2900943">(</span><span class="ident" id="2900944">unsafe</span><span class="op" id="2900950">.</span><span class="ident" id="2900951">Pointer</span><span class="op" id="2900958">(</span><span class="ident" id="2900959">t</span><span class="op" id="2900960">)</span><span class="op" id="2900961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900965">return</span>&nbsp;<span class="ident" id="2900972">toType</span><span class="op" id="2900978">(</span><span class="ident" id="2900979">tt</span><span class="op" id="2900981">.</span><span class="ident" id="2900982">elem</span><span class="op" id="2900986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900989">case</span>&nbsp;<span class="ident" id="2900994">Ptr</span><span class="op" id="2900997">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901001">tt</span>&nbsp;<span class="op" id="2901004">:=</span>&nbsp;<span class="op" id="2901007">(</span><span class="op" id="2901008">*</span><span class="ident" id="2901009">ptrType</span><span class="op" id="2901016">)</span><span class="op" id="2901017">(</span><span class="ident" id="2901018">unsafe</span><span class="op" id="2901024">.</span><span class="ident" id="2901025">Pointer</span><span class="op" id="2901032">(</span><span class="ident" id="2901033">t</span><span class="op" id="2901034">)</span><span class="op" id="2901035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901039">return</span>&nbsp;<span class="ident" id="2901046">toType</span><span class="op" id="2901052">(</span><span class="ident" id="2901053">tt</span><span class="op" id="2901055">.</span><span class="ident" id="2901056">elem</span><span class="op" id="2901060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901063">case</span>&nbsp;<span class="ident" id="2901068">Slice</span><span class="op" id="2901073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901077">tt</span>&nbsp;<span class="op" id="2901080">:=</span>&nbsp;<span class="op" id="2901083">(</span><span class="op" id="2901084">*</span><span class="ident" id="2901085">sliceType</span><span class="op" id="2901094">)</span><span class="op" id="2901095">(</span><span class="ident" id="2901096">unsafe</span><span class="op" id="2901102">.</span><span class="ident" id="2901103">Pointer</span><span class="op" id="2901110">(</span><span class="ident" id="2901111">t</span><span class="op" id="2901112">)</span><span class="op" id="2901113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901117">return</span>&nbsp;<span class="ident" id="2901124">toType</span><span class="op" id="2901130">(</span><span class="ident" id="2901131">tt</span><span class="op" id="2901133">.</span><span class="ident" id="2901134">elem</span><span class="op" id="2901138">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901144">panic</span><span class="op" id="2901149">(</span><span class="string" id="2901150">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2901181">)</span><br>
<span class="lineno"></span><span class="op" id="2901183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2901186">func</span>&nbsp;<span class="op" id="2901191">(</span><span class="ident" id="2901192">t</span>&nbsp;<span class="op" id="2901194">*</span><span class="ident" id="2901195">rtype</span><span class="op" id="2901200">)</span>&nbsp;<span class="ident" id="2901202">Field</span><span class="op" id="2901207">(</span><span class="ident" id="2901208">i</span>&nbsp;<span class="builtintype" id="2901210">int</span><span class="op" id="2901213">)</span>&nbsp;<span class="ident" id="2901215">StructField</span>&nbsp;<span class="op" id="2901227">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901230">if</span>&nbsp;<span class="ident" id="2901233">t</span><span class="op" id="2901234">.</span><span class="ident" id="2901235">Kind</span><span class="op" id="2901239">(</span><span class="op" id="2901240">)</span>&nbsp;<span class="op" id="2901242">!=</span>&nbsp;<span class="ident" id="2901245">Struct</span>&nbsp;<span class="op" id="2901252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901256">panic</span><span class="op" id="2901261">(</span><span class="string" id="2901262">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2901297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901303">tt</span>&nbsp;<span class="op" id="2901306">:=</span>&nbsp;<span class="op" id="2901309">(</span><span class="op" id="2901310">*</span><span class="ident" id="2901311">structType</span><span class="op" id="2901321">)</span><span class="op" id="2901322">(</span><span class="ident" id="2901323">unsafe</span><span class="op" id="2901329">.</span><span class="ident" id="2901330">Pointer</span><span class="op" id="2901337">(</span><span class="ident" id="2901338">t</span><span class="op" id="2901339">)</span><span class="op" id="2901340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901343">return</span>&nbsp;<span class="ident" id="2901350">tt</span><span class="op" id="2901352">.</span><span class="ident" id="2901353">Field</span><span class="op" id="2901358">(</span><span class="ident" id="2901359">i</span><span class="op" id="2901360">)</span><br>
<span class="lineno">605</span><span class="op" id="2901362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2901365">func</span>&nbsp;<span class="op" id="2901370">(</span><span class="ident" id="2901371">t</span>&nbsp;<span class="op" id="2901373">*</span><span class="ident" id="2901374">rtype</span><span class="op" id="2901379">)</span>&nbsp;<span class="ident" id="2901381">FieldByIndex</span><span class="op" id="2901393">(</span><span class="ident" id="2901394">index</span>&nbsp;<span class="op" id="2901400">[</span><span class="op" id="2901401">]</span><span class="builtintype" id="2901402">int</span><span class="op" id="2901405">)</span>&nbsp;<span class="ident" id="2901407">StructField</span>&nbsp;<span class="op" id="2901419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901422">if</span>&nbsp;<span class="ident" id="2901425">t</span><span class="op" id="2901426">.</span><span class="ident" id="2901427">Kind</span><span class="op" id="2901431">(</span><span class="op" id="2901432">)</span>&nbsp;<span class="op" id="2901434">!=</span>&nbsp;<span class="ident" id="2901437">Struct</span>&nbsp;<span class="op" id="2901444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901448">panic</span><span class="op" id="2901453">(</span><span class="string" id="2901454">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2901496">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901502">tt</span>&nbsp;<span class="op" id="2901505">:=</span>&nbsp;<span class="op" id="2901508">(</span><span class="op" id="2901509">*</span><span class="ident" id="2901510">structType</span><span class="op" id="2901520">)</span><span class="op" id="2901521">(</span><span class="ident" id="2901522">unsafe</span><span class="op" id="2901528">.</span><span class="ident" id="2901529">Pointer</span><span class="op" id="2901536">(</span><span class="ident" id="2901537">t</span><span class="op" id="2901538">)</span><span class="op" id="2901539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901542">return</span>&nbsp;<span class="ident" id="2901549">tt</span><span class="op" id="2901551">.</span><span class="ident" id="2901552">FieldByIndex</span><span class="op" id="2901564">(</span><span class="ident" id="2901565">index</span><span class="op" id="2901570">)</span><br>
<span class="lineno"></span><span class="op" id="2901572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2901575">func</span>&nbsp;<span class="op" id="2901580">(</span><span class="ident" id="2901581">t</span>&nbsp;<span class="op" id="2901583">*</span><span class="ident" id="2901584">rtype</span><span class="op" id="2901589">)</span>&nbsp;<span class="ident" id="2901591">FieldByName</span><span class="op" id="2901602">(</span><span class="ident" id="2901603">name</span>&nbsp;<span class="builtintype" id="2901608">string</span><span class="op" id="2901614">)</span>&nbsp;<span class="op" id="2901616">(</span><span class="ident" id="2901617">StructField</span><span class="op" id="2901628">,</span>&nbsp;<span class="builtintype" id="2901630">bool</span><span class="op" id="2901634">)</span>&nbsp;<span class="op" id="2901636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901639">if</span>&nbsp;<span class="ident" id="2901642">t</span><span class="op" id="2901643">.</span><span class="ident" id="2901644">Kind</span><span class="op" id="2901648">(</span><span class="op" id="2901649">)</span>&nbsp;<span class="op" id="2901651">!=</span>&nbsp;<span class="ident" id="2901654">Struct</span>&nbsp;<span class="op" id="2901661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901665">panic</span><span class="op" id="2901670">(</span><span class="string" id="2901671">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2901712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901718">tt</span>&nbsp;<span class="op" id="2901721">:=</span>&nbsp;<span class="op" id="2901724">(</span><span class="op" id="2901725">*</span><span class="ident" id="2901726">structType</span><span class="op" id="2901736">)</span><span class="op" id="2901737">(</span><span class="ident" id="2901738">unsafe</span><span class="op" id="2901744">.</span><span class="ident" id="2901745">Pointer</span><span class="op" id="2901752">(</span><span class="ident" id="2901753">t</span><span class="op" id="2901754">)</span><span class="op" id="2901755">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901758">return</span>&nbsp;<span class="ident" id="2901765">tt</span><span class="op" id="2901767">.</span><span class="ident" id="2901768">FieldByName</span><span class="op" id="2901779">(</span><span class="ident" id="2901780">name</span><span class="op" id="2901784">)</span><br>
<span class="lineno"></span><span class="op" id="2901786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2901789">func</span>&nbsp;<span class="op" id="2901794">(</span><span class="ident" id="2901795">t</span>&nbsp;<span class="op" id="2901797">*</span><span class="ident" id="2901798">rtype</span><span class="op" id="2901803">)</span>&nbsp;<span class="ident" id="2901805">FieldByNameFunc</span><span class="op" id="2901820">(</span><span class="ident" id="2901821">match</span>&nbsp;<span class="keyword" id="2901827">func</span><span class="op" id="2901831">(</span><span class="builtintype" id="2901832">string</span><span class="op" id="2901838">)</span>&nbsp;<span class="builtintype" id="2901840">bool</span><span class="op" id="2901844">)</span>&nbsp;<span class="op" id="2901846">(</span><span class="ident" id="2901847">StructField</span><span class="op" id="2901858">,</span>&nbsp;<span class="builtintype" id="2901860">bool</span><span class="op" id="2901864">)</span>&nbsp;<span class="op" id="2901866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901869">if</span>&nbsp;<span class="ident" id="2901872">t</span><span class="op" id="2901873">.</span><span class="ident" id="2901874">Kind</span><span class="op" id="2901878">(</span><span class="op" id="2901879">)</span>&nbsp;<span class="op" id="2901881">!=</span>&nbsp;<span class="ident" id="2901884">Struct</span>&nbsp;<span class="op" id="2901891">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901895">panic</span><span class="op" id="2901900">(</span><span class="string" id="2901901">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2901946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901952">tt</span>&nbsp;<span class="op" id="2901955">:=</span>&nbsp;<span class="op" id="2901958">(</span><span class="op" id="2901959">*</span><span class="ident" id="2901960">structType</span><span class="op" id="2901970">)</span><span class="op" id="2901971">(</span><span class="ident" id="2901972">unsafe</span><span class="op" id="2901978">.</span><span class="ident" id="2901979">Pointer</span><span class="op" id="2901986">(</span><span class="ident" id="2901987">t</span><span class="op" id="2901988">)</span><span class="op" id="2901989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901992">return</span>&nbsp;<span class="ident" id="2901999">tt</span><span class="op" id="2902001">.</span><span class="ident" id="2902002">FieldByNameFunc</span><span class="op" id="2902017">(</span><span class="ident" id="2902018">match</span><span class="op" id="2902023">)</span><br>
<span class="lineno"></span><span class="op" id="2902025">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2902028">func</span>&nbsp;<span class="op" id="2902033">(</span><span class="ident" id="2902034">t</span>&nbsp;<span class="op" id="2902036">*</span><span class="ident" id="2902037">rtype</span><span class="op" id="2902042">)</span>&nbsp;<span class="ident" id="2902044">In</span><span class="op" id="2902046">(</span><span class="ident" id="2902047">i</span>&nbsp;<span class="builtintype" id="2902049">int</span><span class="op" id="2902052">)</span>&nbsp;<span class="ident" id="2902054">Type</span>&nbsp;<span class="op" id="2902059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902062">if</span>&nbsp;<span class="ident" id="2902065">t</span><span class="op" id="2902066">.</span><span class="ident" id="2902067">Kind</span><span class="op" id="2902071">(</span><span class="op" id="2902072">)</span>&nbsp;<span class="op" id="2902074">!=</span>&nbsp;<span class="ident" id="2902077">Func</span>&nbsp;<span class="op" id="2902082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902086">panic</span><span class="op" id="2902091">(</span><span class="string" id="2902092">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2902122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902125">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902128">tt</span>&nbsp;<span class="op" id="2902131">:=</span>&nbsp;<span class="op" id="2902134">(</span><span class="op" id="2902135">*</span><span class="ident" id="2902136">funcType</span><span class="op" id="2902144">)</span><span class="op" id="2902145">(</span><span class="ident" id="2902146">unsafe</span><span class="op" id="2902152">.</span><span class="ident" id="2902153">Pointer</span><span class="op" id="2902160">(</span><span class="ident" id="2902161">t</span><span class="op" id="2902162">)</span><span class="op" id="2902163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902166">return</span>&nbsp;<span class="ident" id="2902173">toType</span><span class="op" id="2902179">(</span><span class="ident" id="2902180">tt</span><span class="op" id="2902182">.</span><span class="ident" id="2902183">in</span><span class="op" id="2902185">[</span><span class="ident" id="2902186">i</span><span class="op" id="2902187">]</span><span class="op" id="2902188">)</span><br>
<span class="lineno"></span><span class="op" id="2902190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2902193">func</span>&nbsp;<span class="op" id="2902198">(</span><span class="ident" id="2902199">t</span>&nbsp;<span class="op" id="2902201">*</span><span class="ident" id="2902202">rtype</span><span class="op" id="2902207">)</span>&nbsp;<span class="ident" id="2902209">Key</span><span class="op" id="2902212">(</span><span class="op" id="2902213">)</span>&nbsp;<span class="ident" id="2902215">Type</span>&nbsp;<span class="op" id="2902220">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902223">if</span>&nbsp;<span class="ident" id="2902226">t</span><span class="op" id="2902227">.</span><span class="ident" id="2902228">Kind</span><span class="op" id="2902232">(</span><span class="op" id="2902233">)</span>&nbsp;<span class="op" id="2902235">!=</span>&nbsp;<span class="ident" id="2902238">Map</span>&nbsp;<span class="op" id="2902242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902246">panic</span><span class="op" id="2902251">(</span><span class="string" id="2902252">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2902282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902288">tt</span>&nbsp;<span class="op" id="2902291">:=</span>&nbsp;<span class="op" id="2902294">(</span><span class="op" id="2902295">*</span><span class="ident" id="2902296">mapType</span><span class="op" id="2902303">)</span><span class="op" id="2902304">(</span><span class="ident" id="2902305">unsafe</span><span class="op" id="2902311">.</span><span class="ident" id="2902312">Pointer</span><span class="op" id="2902319">(</span><span class="ident" id="2902320">t</span><span class="op" id="2902321">)</span><span class="op" id="2902322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902325">return</span>&nbsp;<span class="ident" id="2902332">toType</span><span class="op" id="2902338">(</span><span class="ident" id="2902339">tt</span><span class="op" id="2902341">.</span><span class="ident" id="2902342">key</span><span class="op" id="2902345">)</span><br>
<span class="lineno">645</span><span class="op" id="2902347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2902350">func</span>&nbsp;<span class="op" id="2902355">(</span><span class="ident" id="2902356">t</span>&nbsp;<span class="op" id="2902358">*</span><span class="ident" id="2902359">rtype</span><span class="op" id="2902364">)</span>&nbsp;<span class="ident" id="2902366">Len</span><span class="op" id="2902369">(</span><span class="op" id="2902370">)</span>&nbsp;<span class="builtintype" id="2902372">int</span>&nbsp;<span class="op" id="2902376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902379">if</span>&nbsp;<span class="ident" id="2902382">t</span><span class="op" id="2902383">.</span><span class="ident" id="2902384">Kind</span><span class="op" id="2902388">(</span><span class="op" id="2902389">)</span>&nbsp;<span class="op" id="2902391">!=</span>&nbsp;<span class="ident" id="2902394">Array</span>&nbsp;<span class="op" id="2902400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902404">panic</span><span class="op" id="2902409">(</span><span class="string" id="2902410">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2902442">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902448">tt</span>&nbsp;<span class="op" id="2902451">:=</span>&nbsp;<span class="op" id="2902454">(</span><span class="op" id="2902455">*</span><span class="ident" id="2902456">arrayType</span><span class="op" id="2902465">)</span><span class="op" id="2902466">(</span><span class="ident" id="2902467">unsafe</span><span class="op" id="2902473">.</span><span class="ident" id="2902474">Pointer</span><span class="op" id="2902481">(</span><span class="ident" id="2902482">t</span><span class="op" id="2902483">)</span><span class="op" id="2902484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902487">return</span>&nbsp;<span class="builtintype" id="2902494">int</span><span class="op" id="2902497">(</span><span class="ident" id="2902498">tt</span><span class="op" id="2902500">.</span><span class="builtinfunc" id="2902501">len</span><span class="op" id="2902504">)</span><br>
<span class="lineno"></span><span class="op" id="2902506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2902509">func</span>&nbsp;<span class="op" id="2902514">(</span><span class="ident" id="2902515">t</span>&nbsp;<span class="op" id="2902517">*</span><span class="ident" id="2902518">rtype</span><span class="op" id="2902523">)</span>&nbsp;<span class="ident" id="2902525">NumField</span><span class="op" id="2902533">(</span><span class="op" id="2902534">)</span>&nbsp;<span class="builtintype" id="2902536">int</span>&nbsp;<span class="op" id="2902540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902543">if</span>&nbsp;<span class="ident" id="2902546">t</span><span class="op" id="2902547">.</span><span class="ident" id="2902548">Kind</span><span class="op" id="2902552">(</span><span class="op" id="2902553">)</span>&nbsp;<span class="op" id="2902555">!=</span>&nbsp;<span class="ident" id="2902558">Struct</span>&nbsp;<span class="op" id="2902565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902569">panic</span><span class="op" id="2902574">(</span><span class="string" id="2902575">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2902613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902619">tt</span>&nbsp;<span class="op" id="2902622">:=</span>&nbsp;<span class="op" id="2902625">(</span><span class="op" id="2902626">*</span><span class="ident" id="2902627">structType</span><span class="op" id="2902637">)</span><span class="op" id="2902638">(</span><span class="ident" id="2902639">unsafe</span><span class="op" id="2902645">.</span><span class="ident" id="2902646">Pointer</span><span class="op" id="2902653">(</span><span class="ident" id="2902654">t</span><span class="op" id="2902655">)</span><span class="op" id="2902656">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902659">return</span>&nbsp;<span class="builtinfunc" id="2902666">len</span><span class="op" id="2902669">(</span><span class="ident" id="2902670">tt</span><span class="op" id="2902672">.</span><span class="ident" id="2902673">fields</span><span class="op" id="2902679">)</span><br>
<span class="lineno"></span><span class="op" id="2902681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2902684">func</span>&nbsp;<span class="op" id="2902689">(</span><span class="ident" id="2902690">t</span>&nbsp;<span class="op" id="2902692">*</span><span class="ident" id="2902693">rtype</span><span class="op" id="2902698">)</span>&nbsp;<span class="ident" id="2902700">NumIn</span><span class="op" id="2902705">(</span><span class="op" id="2902706">)</span>&nbsp;<span class="builtintype" id="2902708">int</span>&nbsp;<span class="op" id="2902712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902715">if</span>&nbsp;<span class="ident" id="2902718">t</span><span class="op" id="2902719">.</span><span class="ident" id="2902720">Kind</span><span class="op" id="2902724">(</span><span class="op" id="2902725">)</span>&nbsp;<span class="op" id="2902727">!=</span>&nbsp;<span class="ident" id="2902730">Func</span>&nbsp;<span class="op" id="2902735">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902739">panic</span><span class="op" id="2902744">(</span><span class="string" id="2902745">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2902778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902784">tt</span>&nbsp;<span class="op" id="2902787">:=</span>&nbsp;<span class="op" id="2902790">(</span><span class="op" id="2902791">*</span><span class="ident" id="2902792">funcType</span><span class="op" id="2902800">)</span><span class="op" id="2902801">(</span><span class="ident" id="2902802">unsafe</span><span class="op" id="2902808">.</span><span class="ident" id="2902809">Pointer</span><span class="op" id="2902816">(</span><span class="ident" id="2902817">t</span><span class="op" id="2902818">)</span><span class="op" id="2902819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902822">return</span>&nbsp;<span class="builtinfunc" id="2902829">len</span><span class="op" id="2902832">(</span><span class="ident" id="2902833">tt</span><span class="op" id="2902835">.</span><span class="ident" id="2902836">in</span><span class="op" id="2902838">)</span><br>
<span class="lineno"></span><span class="op" id="2902840">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2902843">func</span>&nbsp;<span class="op" id="2902848">(</span><span class="ident" id="2902849">t</span>&nbsp;<span class="op" id="2902851">*</span><span class="ident" id="2902852">rtype</span><span class="op" id="2902857">)</span>&nbsp;<span class="ident" id="2902859">NumOut</span><span class="op" id="2902865">(</span><span class="op" id="2902866">)</span>&nbsp;<span class="builtintype" id="2902868">int</span>&nbsp;<span class="op" id="2902872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902875">if</span>&nbsp;<span class="ident" id="2902878">t</span><span class="op" id="2902879">.</span><span class="ident" id="2902880">Kind</span><span class="op" id="2902884">(</span><span class="op" id="2902885">)</span>&nbsp;<span class="op" id="2902887">!=</span>&nbsp;<span class="ident" id="2902890">Func</span>&nbsp;<span class="op" id="2902895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2902899">panic</span><span class="op" id="2902904">(</span><span class="string" id="2902905">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2902939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902942">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902945">tt</span>&nbsp;<span class="op" id="2902948">:=</span>&nbsp;<span class="op" id="2902951">(</span><span class="op" id="2902952">*</span><span class="ident" id="2902953">funcType</span><span class="op" id="2902961">)</span><span class="op" id="2902962">(</span><span class="ident" id="2902963">unsafe</span><span class="op" id="2902969">.</span><span class="ident" id="2902970">Pointer</span><span class="op" id="2902977">(</span><span class="ident" id="2902978">t</span><span class="op" id="2902979">)</span><span class="op" id="2902980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902983">return</span>&nbsp;<span class="builtinfunc" id="2902990">len</span><span class="op" id="2902993">(</span><span class="ident" id="2902994">tt</span><span class="op" id="2902996">.</span><span class="ident" id="2902997">out</span><span class="op" id="2903000">)</span><br>
<span class="lineno"></span><span class="op" id="2903002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2903005">func</span>&nbsp;<span class="op" id="2903010">(</span><span class="ident" id="2903011">t</span>&nbsp;<span class="op" id="2903013">*</span><span class="ident" id="2903014">rtype</span><span class="op" id="2903019">)</span>&nbsp;<span class="ident" id="2903021">Out</span><span class="op" id="2903024">(</span><span class="ident" id="2903025">i</span>&nbsp;<span class="builtintype" id="2903027">int</span><span class="op" id="2903030">)</span>&nbsp;<span class="ident" id="2903032">Type</span>&nbsp;<span class="op" id="2903037">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903040">if</span>&nbsp;<span class="ident" id="2903043">t</span><span class="op" id="2903044">.</span><span class="ident" id="2903045">Kind</span><span class="op" id="2903049">(</span><span class="op" id="2903050">)</span>&nbsp;<span class="op" id="2903052">!=</span>&nbsp;<span class="ident" id="2903055">Func</span>&nbsp;<span class="op" id="2903060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2903064">panic</span><span class="op" id="2903069">(</span><span class="string" id="2903070">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2903101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903107">tt</span>&nbsp;<span class="op" id="2903110">:=</span>&nbsp;<span class="op" id="2903113">(</span><span class="op" id="2903114">*</span><span class="ident" id="2903115">funcType</span><span class="op" id="2903123">)</span><span class="op" id="2903124">(</span><span class="ident" id="2903125">unsafe</span><span class="op" id="2903131">.</span><span class="ident" id="2903132">Pointer</span><span class="op" id="2903139">(</span><span class="ident" id="2903140">t</span><span class="op" id="2903141">)</span><span class="op" id="2903142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903145">return</span>&nbsp;<span class="ident" id="2903152">toType</span><span class="op" id="2903158">(</span><span class="ident" id="2903159">tt</span><span class="op" id="2903161">.</span><span class="ident" id="2903162">out</span><span class="op" id="2903165">[</span><span class="ident" id="2903166">i</span><span class="op" id="2903167">]</span><span class="op" id="2903168">)</span><br>
<span class="lineno">685</span><span class="op" id="2903170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2903173">func</span>&nbsp;<span class="op" id="2903178">(</span><span class="ident" id="2903179">d</span>&nbsp;<span class="ident" id="2903181">ChanDir</span><span class="op" id="2903188">)</span>&nbsp;<span class="ident" id="2903190">String</span><span class="op" id="2903196">(</span><span class="op" id="2903197">)</span>&nbsp;<span class="builtintype" id="2903199">string</span>&nbsp;<span class="op" id="2903206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903209">switch</span>&nbsp;<span class="ident" id="2903216">d</span>&nbsp;<span class="op" id="2903218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903221">case</span>&nbsp;<span class="ident" id="2903226">SendDir</span><span class="op" id="2903233">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903237">return</span>&nbsp;<span class="string" id="2903244">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903254">case</span>&nbsp;<span class="ident" id="2903259">RecvDir</span><span class="op" id="2903266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903270">return</span>&nbsp;<span class="string" id="2903277">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903287">case</span>&nbsp;<span class="ident" id="2903292">BothDir</span><span class="op" id="2903299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903303">return</span>&nbsp;<span class="string" id="2903310">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903321">return</span>&nbsp;<span class="string" id="2903328">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2903338">+</span>&nbsp;<span class="ident" id="2903340">strconv</span><span class="op" id="2903347">.</span><span class="ident" id="2903348">Itoa</span><span class="op" id="2903352">(</span><span class="builtintype" id="2903353">int</span><span class="op" id="2903356">(</span><span class="ident" id="2903357">d</span><span class="op" id="2903358">)</span><span class="op" id="2903359">)</span><br>
<span class="lineno"></span><span class="op" id="2903361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2903364">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2903424">func</span>&nbsp;<span class="op" id="2903429">(</span><span class="ident" id="2903430">t</span>&nbsp;<span class="op" id="2903432">*</span><span class="ident" id="2903433">interfaceType</span><span class="op" id="2903446">)</span>&nbsp;<span class="ident" id="2903448">Method</span><span class="op" id="2903454">(</span><span class="ident" id="2903455">i</span>&nbsp;<span class="builtintype" id="2903457">int</span><span class="op" id="2903460">)</span>&nbsp;<span class="op" id="2903462">(</span><span class="ident" id="2903463">m</span>&nbsp;<span class="ident" id="2903465">Method</span><span class="op" id="2903471">)</span>&nbsp;<span class="op" id="2903473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903476">if</span>&nbsp;<span class="ident" id="2903479">i</span>&nbsp;<span class="op" id="2903481">&lt;</span>&nbsp;<span class="num" id="2903483">0</span>&nbsp;<span class="op" id="2903485">||</span>&nbsp;<span class="ident" id="2903488">i</span>&nbsp;<span class="op" id="2903490">&gt;=</span>&nbsp;<span class="builtinfunc" id="2903493">len</span><span class="op" id="2903496">(</span><span class="ident" id="2903497">t</span><span class="op" id="2903498">.</span><span class="ident" id="2903499">methods</span><span class="op" id="2903506">)</span>&nbsp;<span class="op" id="2903508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903512">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903523">p</span>&nbsp;<span class="op" id="2903525">:=</span>&nbsp;<span class="op" id="2903528">&amp;</span><span class="ident" id="2903529">t</span><span class="op" id="2903530">.</span><span class="ident" id="2903531">methods</span><span class="op" id="2903538">[</span><span class="ident" id="2903539">i</span><span class="op" id="2903540">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903543">m</span><span class="op" id="2903544">.</span><span class="ident" id="2903545">Name</span>&nbsp;<span class="op" id="2903550">=</span>&nbsp;<span class="op" id="2903552">*</span><span class="ident" id="2903553">p</span><span class="op" id="2903554">.</span><span class="ident" id="2903555">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903561">if</span>&nbsp;<span class="ident" id="2903564">p</span><span class="op" id="2903565">.</span><span class="ident" id="2903566">pkgPath</span>&nbsp;<span class="op" id="2903574">!=</span>&nbsp;<span class="ident" id="2903577">nil</span>&nbsp;<span class="op" id="2903581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903585">m</span><span class="op" id="2903586">.</span><span class="ident" id="2903587">PkgPath</span>&nbsp;<span class="op" id="2903595">=</span>&nbsp;<span class="op" id="2903597">*</span><span class="ident" id="2903598">p</span><span class="op" id="2903599">.</span><span class="ident" id="2903600">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903612">m</span><span class="op" id="2903613">.</span><span class="ident" id="2903614">Type</span>&nbsp;<span class="op" id="2903619">=</span>&nbsp;<span class="ident" id="2903621">toType</span><span class="op" id="2903627">(</span><span class="ident" id="2903628">p</span><span class="op" id="2903629">.</span><span class="ident" id="2903630">typ</span><span class="op" id="2903633">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903636">m</span><span class="op" id="2903637">.</span><span class="ident" id="2903638">Index</span>&nbsp;<span class="op" id="2903644">=</span>&nbsp;<span class="ident" id="2903646">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903649">return</span><br>
<span class="lineno"></span><span class="op" id="2903656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2903659">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2903738">func</span>&nbsp;<span class="op" id="2903743">(</span><span class="ident" id="2903744">t</span>&nbsp;<span class="op" id="2903746">*</span><span class="ident" id="2903747">interfaceType</span><span class="op" id="2903760">)</span>&nbsp;<span class="ident" id="2903762">NumMethod</span><span class="op" id="2903771">(</span><span class="op" id="2903772">)</span>&nbsp;<span class="builtintype" id="2903774">int</span>&nbsp;<span class="op" id="2903778">{</span>&nbsp;<span class="keyword" id="2903780">return</span>&nbsp;<span class="builtinfunc" id="2903787">len</span><span class="op" id="2903790">(</span><span class="ident" id="2903791">t</span><span class="op" id="2903792">.</span><span class="ident" id="2903793">methods</span><span class="op" id="2903800">)</span>&nbsp;<span class="op" id="2903802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2903805">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2903874">func</span>&nbsp;<span class="op" id="2903879">(</span><span class="ident" id="2903880">t</span>&nbsp;<span class="op" id="2903882">*</span><span class="ident" id="2903883">interfaceType</span><span class="op" id="2903896">)</span>&nbsp;<span class="ident" id="2903898">MethodByName</span><span class="op" id="2903910">(</span><span class="ident" id="2903911">name</span>&nbsp;<span class="builtintype" id="2903916">string</span><span class="op" id="2903922">)</span>&nbsp;<span class="op" id="2903924">(</span><span class="ident" id="2903925">m</span>&nbsp;<span class="ident" id="2903927">Method</span><span class="op" id="2903933">,</span>&nbsp;<span class="ident" id="2903935">ok</span>&nbsp;<span class="builtintype" id="2903938">bool</span><span class="op" id="2903942">)</span>&nbsp;<span class="op" id="2903944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903947">if</span>&nbsp;<span class="ident" id="2903950">t</span>&nbsp;<span class="op" id="2903952">==</span>&nbsp;<span class="ident" id="2903955">nil</span>&nbsp;<span class="op" id="2903959">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903963">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903974">var</span>&nbsp;<span class="ident" id="2903978">p</span>&nbsp;<span class="op" id="2903980">*</span><span class="ident" id="2903981">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903990">for</span>&nbsp;<span class="ident" id="2903994">i</span>&nbsp;<span class="op" id="2903996">:=</span>&nbsp;<span class="keyword" id="2903999">range</span>&nbsp;<span class="ident" id="2904005">t</span><span class="op" id="2904006">.</span><span class="ident" id="2904007">methods</span>&nbsp;<span class="op" id="2904015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904019">p</span>&nbsp;<span class="op" id="2904021">=</span>&nbsp;<span class="op" id="2904023">&amp;</span><span class="ident" id="2904024">t</span><span class="op" id="2904025">.</span><span class="ident" id="2904026">methods</span><span class="op" id="2904033">[</span><span class="ident" id="2904034">i</span><span class="op" id="2904035">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904039">if</span>&nbsp;<span class="op" id="2904042">*</span><span class="ident" id="2904043">p</span><span class="op" id="2904044">.</span><span class="ident" id="2904045">name</span>&nbsp;<span class="op" id="2904050">==</span>&nbsp;<span class="ident" id="2904053">name</span>&nbsp;<span class="op" id="2904058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904063">return</span>&nbsp;<span class="ident" id="2904070">t</span><span class="op" id="2904071">.</span><span class="ident" id="2904072">Method</span><span class="op" id="2904078">(</span><span class="ident" id="2904079">i</span><span class="op" id="2904080">)</span><span class="op" id="2904081">,</span>&nbsp;<span class="builtintype" id="2904083">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904096">return</span><br>
<span class="lineno">730</span><span class="op" id="2904103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2904106">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2904161">type</span>&nbsp;<span class="ident" id="2904166">StructField</span>&nbsp;<span class="keyword" id="2904178">struct</span>&nbsp;<span class="op" id="2904185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904188">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904216">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904289">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904357">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904418">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2904426">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904434">PkgPath</span>&nbsp;<span class="builtintype" id="2904442">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904451">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2904461">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2904471">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904486">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2904496">StructTag</span>&nbsp;<span class="comment" id="2904506">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904527">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2904537">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2904547">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904582">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2904592">[</span><span class="op" id="2904593">]</span><span class="builtintype" id="2904594">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2904602">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904643">Anonymous</span>&nbsp;<span class="builtintype" id="2904653">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2904663">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2904687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2904690">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2904742">//</span><br>
<span class="lineno">750</span><span class="comment" id="2904745">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2904798">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2904847">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2904907">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2904972">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2905038">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2905082">type</span>&nbsp;<span class="ident" id="2905087">StructTag</span>&nbsp;<span class="builtintype" id="2905097">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2905105">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2905169">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2905238">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2905301">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2905336">func</span>&nbsp;<span class="op" id="2905341">(</span><span class="ident" id="2905342">tag</span>&nbsp;<span class="ident" id="2905346">StructTag</span><span class="op" id="2905355">)</span>&nbsp;<span class="ident" id="2905357">Get</span><span class="op" id="2905360">(</span><span class="ident" id="2905361">key</span>&nbsp;<span class="builtintype" id="2905365">string</span><span class="op" id="2905371">)</span>&nbsp;<span class="builtintype" id="2905373">string</span>&nbsp;<span class="op" id="2905380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905383">for</span>&nbsp;<span class="ident" id="2905387">tag</span>&nbsp;<span class="op" id="2905391">!=</span>&nbsp;<span class="string" id="2905394">&#34;&#34;</span>&nbsp;<span class="op" id="2905397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905401">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905425">i</span>&nbsp;<span class="op" id="2905427">:=</span>&nbsp;<span class="num" id="2905430">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905434">for</span>&nbsp;<span class="ident" id="2905438">i</span>&nbsp;<span class="op" id="2905440">&lt;</span>&nbsp;<span class="builtinfunc" id="2905442">len</span><span class="op" id="2905445">(</span><span class="ident" id="2905446">tag</span><span class="op" id="2905449">)</span>&nbsp;<span class="op" id="2905451">&amp;&amp;</span>&nbsp;<span class="ident" id="2905454">tag</span><span class="op" id="2905457">[</span><span class="ident" id="2905458">i</span><span class="op" id="2905459">]</span>&nbsp;<span class="op" id="2905461">==</span>&nbsp;<span class="string" id="2905464">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2905468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905473">i</span><span class="op" id="2905474">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905483">tag</span>&nbsp;<span class="op" id="2905487">=</span>&nbsp;<span class="ident" id="2905489">tag</span><span class="op" id="2905492">[</span><span class="ident" id="2905493">i</span><span class="op" id="2905494">:</span><span class="op" id="2905495">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905499">if</span>&nbsp;<span class="ident" id="2905502">tag</span>&nbsp;<span class="op" id="2905506">==</span>&nbsp;<span class="string" id="2905509">&#34;&#34;</span>&nbsp;<span class="op" id="2905512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905517">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905530">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905550">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905592">i</span>&nbsp;<span class="op" id="2905594">=</span>&nbsp;<span class="num" id="2905596">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905600">for</span>&nbsp;<span class="ident" id="2905604">i</span>&nbsp;<span class="op" id="2905606">&lt;</span>&nbsp;<span class="builtinfunc" id="2905608">len</span><span class="op" id="2905611">(</span><span class="ident" id="2905612">tag</span><span class="op" id="2905615">)</span>&nbsp;<span class="op" id="2905617">&amp;&amp;</span>&nbsp;<span class="ident" id="2905620">tag</span><span class="op" id="2905623">[</span><span class="ident" id="2905624">i</span><span class="op" id="2905625">]</span>&nbsp;<span class="op" id="2905627">!=</span>&nbsp;<span class="string" id="2905630">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2905634">&amp;&amp;</span>&nbsp;<span class="ident" id="2905637">tag</span><span class="op" id="2905640">[</span><span class="ident" id="2905641">i</span><span class="op" id="2905642">]</span>&nbsp;<span class="op" id="2905644">!=</span>&nbsp;<span class="string" id="2905647">&#39;:&#39;</span>&nbsp;<span class="op" id="2905651">&amp;&amp;</span>&nbsp;<span class="ident" id="2905654">tag</span><span class="op" id="2905657">[</span><span class="ident" id="2905658">i</span><span class="op" id="2905659">]</span>&nbsp;<span class="op" id="2905661">!=</span>&nbsp;<span class="string" id="2905664">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2905668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905673">i</span><span class="op" id="2905674">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905679">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905683">if</span>&nbsp;<span class="ident" id="2905686">i</span><span class="op" id="2905687">+</span><span class="num" id="2905688">1</span>&nbsp;<span class="op" id="2905690">&gt;=</span>&nbsp;<span class="builtinfunc" id="2905693">len</span><span class="op" id="2905696">(</span><span class="ident" id="2905697">tag</span><span class="op" id="2905700">)</span>&nbsp;<span class="op" id="2905702">||</span>&nbsp;<span class="ident" id="2905705">tag</span><span class="op" id="2905708">[</span><span class="ident" id="2905709">i</span><span class="op" id="2905710">]</span>&nbsp;<span class="op" id="2905712">!=</span>&nbsp;<span class="string" id="2905715">&#39;:&#39;</span>&nbsp;<span class="op" id="2905719">||</span>&nbsp;<span class="ident" id="2905722">tag</span><span class="op" id="2905725">[</span><span class="ident" id="2905726">i</span><span class="op" id="2905727">+</span><span class="num" id="2905728">1</span><span class="op" id="2905729">]</span>&nbsp;<span class="op" id="2905731">!=</span>&nbsp;<span class="string" id="2905734">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2905738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905743">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905755">name</span>&nbsp;<span class="op" id="2905760">:=</span>&nbsp;<span class="builtintype" id="2905763">string</span><span class="op" id="2905769">(</span><span class="ident" id="2905770">tag</span><span class="op" id="2905773">[</span><span class="op" id="2905774">:</span><span class="ident" id="2905775">i</span><span class="op" id="2905776">]</span><span class="op" id="2905777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905781">tag</span>&nbsp;<span class="op" id="2905785">=</span>&nbsp;<span class="ident" id="2905787">tag</span><span class="op" id="2905790">[</span><span class="ident" id="2905791">i</span><span class="op" id="2905792">+</span><span class="num" id="2905793">1</span><span class="op" id="2905794">:</span><span class="op" id="2905795">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905800">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905838">i</span>&nbsp;<span class="op" id="2905840">=</span>&nbsp;<span class="num" id="2905842">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905846">for</span>&nbsp;<span class="ident" id="2905850">i</span>&nbsp;<span class="op" id="2905852">&lt;</span>&nbsp;<span class="builtinfunc" id="2905854">len</span><span class="op" id="2905857">(</span><span class="ident" id="2905858">tag</span><span class="op" id="2905861">)</span>&nbsp;<span class="op" id="2905863">&amp;&amp;</span>&nbsp;<span class="ident" id="2905866">tag</span><span class="op" id="2905869">[</span><span class="ident" id="2905870">i</span><span class="op" id="2905871">]</span>&nbsp;<span class="op" id="2905873">!=</span>&nbsp;<span class="string" id="2905876">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2905880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905885">if</span>&nbsp;<span class="ident" id="2905888">tag</span><span class="op" id="2905891">[</span><span class="ident" id="2905892">i</span><span class="op" id="2905893">]</span>&nbsp;<span class="op" id="2905895">==</span>&nbsp;<span class="string" id="2905898">&#39;\\&#39;</span>&nbsp;<span class="op" id="2905903">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905909">i</span><span class="op" id="2905910">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905921">i</span><span class="op" id="2905922">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905931">if</span>&nbsp;<span class="ident" id="2905934">i</span>&nbsp;<span class="op" id="2905936">&gt;=</span>&nbsp;<span class="builtinfunc" id="2905939">len</span><span class="op" id="2905942">(</span><span class="ident" id="2905943">tag</span><span class="op" id="2905946">)</span>&nbsp;<span class="op" id="2905948">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905953">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905965">qvalue</span>&nbsp;<span class="op" id="2905972">:=</span>&nbsp;<span class="builtintype" id="2905975">string</span><span class="op" id="2905981">(</span><span class="ident" id="2905982">tag</span><span class="op" id="2905985">[</span><span class="op" id="2905986">:</span><span class="ident" id="2905987">i</span><span class="op" id="2905988">+</span><span class="num" id="2905989">1</span><span class="op" id="2905990">]</span><span class="op" id="2905991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905995">tag</span>&nbsp;<span class="op" id="2905999">=</span>&nbsp;<span class="ident" id="2906001">tag</span><span class="op" id="2906004">[</span><span class="ident" id="2906005">i</span><span class="op" id="2906006">+</span><span class="num" id="2906007">1</span><span class="op" id="2906008">:</span><span class="op" id="2906009">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906014">if</span>&nbsp;<span class="ident" id="2906017">key</span>&nbsp;<span class="op" id="2906021">==</span>&nbsp;<span class="ident" id="2906024">name</span>&nbsp;<span class="op" id="2906029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906034">value</span><span class="op" id="2906039">,</span>&nbsp;<span class="ident" id="2906041">_</span>&nbsp;<span class="op" id="2906043">:=</span>&nbsp;<span class="ident" id="2906046">strconv</span><span class="op" id="2906053">.</span><span class="ident" id="2906054">Unquote</span><span class="op" id="2906061">(</span><span class="ident" id="2906062">qvalue</span><span class="op" id="2906068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906073">return</span>&nbsp;<span class="ident" id="2906080">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906091">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906094">return</span>&nbsp;<span class="string" id="2906101">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2906104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2906107">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2906147">func</span>&nbsp;<span class="op" id="2906152">(</span><span class="ident" id="2906153">t</span>&nbsp;<span class="op" id="2906155">*</span><span class="ident" id="2906156">structType</span><span class="op" id="2906166">)</span>&nbsp;<span class="ident" id="2906168">Field</span><span class="op" id="2906173">(</span><span class="ident" id="2906174">i</span>&nbsp;<span class="builtintype" id="2906176">int</span><span class="op" id="2906179">)</span>&nbsp;<span class="op" id="2906181">(</span><span class="ident" id="2906182">f</span>&nbsp;<span class="ident" id="2906184">StructField</span><span class="op" id="2906195">)</span>&nbsp;<span class="op" id="2906197">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906200">if</span>&nbsp;<span class="ident" id="2906203">i</span>&nbsp;<span class="op" id="2906205">&lt;</span>&nbsp;<span class="num" id="2906207">0</span>&nbsp;<span class="op" id="2906209">||</span>&nbsp;<span class="ident" id="2906212">i</span>&nbsp;<span class="op" id="2906214">&gt;=</span>&nbsp;<span class="builtinfunc" id="2906217">len</span><span class="op" id="2906220">(</span><span class="ident" id="2906221">t</span><span class="op" id="2906222">.</span><span class="ident" id="2906223">fields</span><span class="op" id="2906229">)</span>&nbsp;<span class="op" id="2906231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906235">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906246">p</span>&nbsp;<span class="op" id="2906248">:=</span>&nbsp;<span class="op" id="2906251">&amp;</span><span class="ident" id="2906252">t</span><span class="op" id="2906253">.</span><span class="ident" id="2906254">fields</span><span class="op" id="2906260">[</span><span class="ident" id="2906261">i</span><span class="op" id="2906262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906265">f</span><span class="op" id="2906266">.</span><span class="ident" id="2906267">Type</span>&nbsp;<span class="op" id="2906272">=</span>&nbsp;<span class="ident" id="2906274">toType</span><span class="op" id="2906280">(</span><span class="ident" id="2906281">p</span><span class="op" id="2906282">.</span><span class="ident" id="2906283">typ</span><span class="op" id="2906286">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906289">if</span>&nbsp;<span class="ident" id="2906292">p</span><span class="op" id="2906293">.</span><span class="ident" id="2906294">name</span>&nbsp;<span class="op" id="2906299">!=</span>&nbsp;<span class="ident" id="2906302">nil</span>&nbsp;<span class="op" id="2906306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906310">f</span><span class="op" id="2906311">.</span><span class="ident" id="2906312">Name</span>&nbsp;<span class="op" id="2906317">=</span>&nbsp;<span class="op" id="2906319">*</span><span class="ident" id="2906320">p</span><span class="op" id="2906321">.</span><span class="ident" id="2906322">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906328">}</span>&nbsp;<span class="keyword" id="2906330">else</span>&nbsp;<span class="op" id="2906335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906339">t</span>&nbsp;<span class="op" id="2906341">:=</span>&nbsp;<span class="ident" id="2906344">f</span><span class="op" id="2906345">.</span><span class="ident" id="2906346">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906353">if</span>&nbsp;<span class="ident" id="2906356">t</span><span class="op" id="2906357">.</span><span class="ident" id="2906358">Kind</span><span class="op" id="2906362">(</span><span class="op" id="2906363">)</span>&nbsp;<span class="op" id="2906365">==</span>&nbsp;<span class="ident" id="2906368">Ptr</span>&nbsp;<span class="op" id="2906372">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906377">t</span>&nbsp;<span class="op" id="2906379">=</span>&nbsp;<span class="ident" id="2906381">t</span><span class="op" id="2906382">.</span><span class="ident" id="2906383">Elem</span><span class="op" id="2906387">(</span><span class="op" id="2906388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906396">f</span><span class="op" id="2906397">.</span><span class="ident" id="2906398">Name</span>&nbsp;<span class="op" id="2906403">=</span>&nbsp;<span class="ident" id="2906405">t</span><span class="op" id="2906406">.</span><span class="ident" id="2906407">Name</span><span class="op" id="2906411">(</span><span class="op" id="2906412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906416">f</span><span class="op" id="2906417">.</span><span class="ident" id="2906418">Anonymous</span>&nbsp;<span class="op" id="2906428">=</span>&nbsp;<span class="builtintype" id="2906430">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906436">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906439">if</span>&nbsp;<span class="ident" id="2906442">p</span><span class="op" id="2906443">.</span><span class="ident" id="2906444">pkgPath</span>&nbsp;<span class="op" id="2906452">!=</span>&nbsp;<span class="ident" id="2906455">nil</span>&nbsp;<span class="op" id="2906459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906463">f</span><span class="op" id="2906464">.</span><span class="ident" id="2906465">PkgPath</span>&nbsp;<span class="op" id="2906473">=</span>&nbsp;<span class="op" id="2906475">*</span><span class="ident" id="2906476">p</span><span class="op" id="2906477">.</span><span class="ident" id="2906478">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906490">if</span>&nbsp;<span class="ident" id="2906493">p</span><span class="op" id="2906494">.</span><span class="ident" id="2906495">tag</span>&nbsp;<span class="op" id="2906499">!=</span>&nbsp;<span class="ident" id="2906502">nil</span>&nbsp;<span class="op" id="2906506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906510">f</span><span class="op" id="2906511">.</span><span class="ident" id="2906512">Tag</span>&nbsp;<span class="op" id="2906516">=</span>&nbsp;<span class="ident" id="2906518">StructTag</span><span class="op" id="2906527">(</span><span class="op" id="2906528">*</span><span class="ident" id="2906529">p</span><span class="op" id="2906530">.</span><span class="ident" id="2906531">tag</span><span class="op" id="2906534">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906540">f</span><span class="op" id="2906541">.</span><span class="ident" id="2906542">Offset</span>&nbsp;<span class="op" id="2906549">=</span>&nbsp;<span class="ident" id="2906551">p</span><span class="op" id="2906552">.</span><span class="ident" id="2906553">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906562">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906622">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906683">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906742">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906802">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906862">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906920">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906971">f</span><span class="op" id="2906972">.</span><span class="ident" id="2906973">Index</span>&nbsp;<span class="op" id="2906979">=</span>&nbsp;<span class="op" id="2906981">[</span><span class="op" id="2906982">]</span><span class="builtintype" id="2906983">int</span><span class="op" id="2906986">{</span><span class="ident" id="2906987">i</span><span class="op" id="2906988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906991">return</span><br>
<span class="lineno"></span><span class="op" id="2906998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2907001">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2907068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2907110">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2907175">func</span>&nbsp;<span class="op" id="2907180">(</span><span class="ident" id="2907181">t</span>&nbsp;<span class="op" id="2907183">*</span><span class="ident" id="2907184">structType</span><span class="op" id="2907194">)</span>&nbsp;<span class="ident" id="2907196">FieldByIndex</span><span class="op" id="2907208">(</span><span class="ident" id="2907209">index</span>&nbsp;<span class="op" id="2907215">[</span><span class="op" id="2907216">]</span><span class="builtintype" id="2907217">int</span><span class="op" id="2907220">)</span>&nbsp;<span class="op" id="2907222">(</span><span class="ident" id="2907223">f</span>&nbsp;<span class="ident" id="2907225">StructField</span><span class="op" id="2907236">)</span>&nbsp;<span class="op" id="2907238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907241">f</span><span class="op" id="2907242">.</span><span class="ident" id="2907243">Type</span>&nbsp;<span class="op" id="2907248">=</span>&nbsp;<span class="ident" id="2907250">toType</span><span class="op" id="2907256">(</span><span class="op" id="2907257">&amp;</span><span class="ident" id="2907258">t</span><span class="op" id="2907259">.</span><span class="ident" id="2907260">rtype</span><span class="op" id="2907265">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907268">for</span>&nbsp;<span class="ident" id="2907272">i</span><span class="op" id="2907273">,</span>&nbsp;<span class="ident" id="2907275">x</span>&nbsp;<span class="op" id="2907277">:=</span>&nbsp;<span class="keyword" id="2907280">range</span>&nbsp;<span class="ident" id="2907286">index</span>&nbsp;<span class="op" id="2907292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907296">if</span>&nbsp;<span class="ident" id="2907299">i</span>&nbsp;<span class="op" id="2907301">&gt;</span>&nbsp;<span class="num" id="2907303">0</span>&nbsp;<span class="op" id="2907305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907310">ft</span>&nbsp;<span class="op" id="2907313">:=</span>&nbsp;<span class="ident" id="2907316">f</span><span class="op" id="2907317">.</span><span class="ident" id="2907318">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907326">if</span>&nbsp;<span class="ident" id="2907329">ft</span><span class="op" id="2907331">.</span><span class="ident" id="2907332">Kind</span><span class="op" id="2907336">(</span><span class="op" id="2907337">)</span>&nbsp;<span class="op" id="2907339">==</span>&nbsp;<span class="ident" id="2907342">Ptr</span>&nbsp;<span class="op" id="2907346">&amp;&amp;</span>&nbsp;<span class="ident" id="2907349">ft</span><span class="op" id="2907351">.</span><span class="ident" id="2907352">Elem</span><span class="op" id="2907356">(</span><span class="op" id="2907357">)</span><span class="op" id="2907358">.</span><span class="ident" id="2907359">Kind</span><span class="op" id="2907363">(</span><span class="op" id="2907364">)</span>&nbsp;<span class="op" id="2907366">==</span>&nbsp;<span class="ident" id="2907369">Struct</span>&nbsp;<span class="op" id="2907376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907382">ft</span>&nbsp;<span class="op" id="2907385">=</span>&nbsp;<span class="ident" id="2907387">ft</span><span class="op" id="2907389">.</span><span class="ident" id="2907390">Elem</span><span class="op" id="2907394">(</span><span class="op" id="2907395">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907405">f</span><span class="op" id="2907406">.</span><span class="ident" id="2907407">Type</span>&nbsp;<span class="op" id="2907412">=</span>&nbsp;<span class="ident" id="2907414">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907423">f</span>&nbsp;<span class="op" id="2907425">=</span>&nbsp;<span class="ident" id="2907427">f</span><span class="op" id="2907428">.</span><span class="ident" id="2907429">Type</span><span class="op" id="2907433">.</span><span class="ident" id="2907434">Field</span><span class="op" id="2907439">(</span><span class="ident" id="2907440">x</span><span class="op" id="2907441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907444">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907447">return</span><br>
<span class="lineno"></span><span class="op" id="2907454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2907457">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2907530">type</span>&nbsp;<span class="ident" id="2907535">fieldScan</span>&nbsp;<span class="keyword" id="2907545">struct</span>&nbsp;<span class="op" id="2907552">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907555">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2907561">*</span><span class="ident" id="2907562">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907574">index</span>&nbsp;<span class="op" id="2907580">[</span><span class="op" id="2907581">]</span><span class="builtintype" id="2907582">int</span><br>
<span class="lineno"></span><span class="op" id="2907586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2907589">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2907664">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2907732">func</span>&nbsp;<span class="op" id="2907737">(</span><span class="ident" id="2907738">t</span>&nbsp;<span class="op" id="2907740">*</span><span class="ident" id="2907741">structType</span><span class="op" id="2907751">)</span>&nbsp;<span class="ident" id="2907753">FieldByNameFunc</span><span class="op" id="2907768">(</span><span class="ident" id="2907769">match</span>&nbsp;<span class="keyword" id="2907775">func</span><span class="op" id="2907779">(</span><span class="builtintype" id="2907780">string</span><span class="op" id="2907786">)</span>&nbsp;<span class="builtintype" id="2907788">bool</span><span class="op" id="2907792">)</span>&nbsp;<span class="op" id="2907794">(</span><span class="ident" id="2907795">result</span>&nbsp;<span class="ident" id="2907802">StructField</span><span class="op" id="2907813">,</span>&nbsp;<span class="ident" id="2907815">ok</span>&nbsp;<span class="builtintype" id="2907818">bool</span><span class="op" id="2907822">)</span>&nbsp;<span class="op" id="2907824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2907827">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2907919">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908010">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908102">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908173">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908222">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908281">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2908336">current</span>&nbsp;<span class="op" id="2908344">:=</span>&nbsp;<span class="op" id="2908347">[</span><span class="op" id="2908348">]</span><span class="ident" id="2908349">fieldScan</span><span class="op" id="2908358">{</span><span class="op" id="2908359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2908362">next</span>&nbsp;<span class="op" id="2908367">:=</span>&nbsp;<span class="op" id="2908370">[</span><span class="op" id="2908371">]</span><span class="ident" id="2908372">fieldScan</span><span class="op" id="2908381">{</span><span class="op" id="2908382">{</span><span class="ident" id="2908383">typ</span><span class="op" id="2908386">:</span>&nbsp;<span class="ident" id="2908388">t</span><span class="op" id="2908389">}</span><span class="op" id="2908390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908394">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908462">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908527">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908596">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908673">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908746">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2908781">var</span>&nbsp;<span class="ident" id="2908785">nextCount</span>&nbsp;<span class="keyword" id="2908795">map</span><span class="op" id="2908798">[</span><span class="op" id="2908799">*</span><span class="ident" id="2908800">structType</span><span class="op" id="2908810">]</span><span class="builtintype" id="2908811">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908817">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908884">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2908946">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909015">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909087">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909162">visited</span>&nbsp;<span class="op" id="2909170">:=</span>&nbsp;<span class="keyword" id="2909173">map</span><span class="op" id="2909176">[</span><span class="op" id="2909177">*</span><span class="ident" id="2909178">structType</span><span class="op" id="2909188">]</span><span class="builtintype" id="2909189">bool</span><span class="op" id="2909193">{</span><span class="op" id="2909194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909198">for</span>&nbsp;<span class="builtinfunc" id="2909202">len</span><span class="op" id="2909205">(</span><span class="ident" id="2909206">next</span><span class="op" id="2909210">)</span>&nbsp;<span class="op" id="2909212">&gt;</span>&nbsp;<span class="num" id="2909214">0</span>&nbsp;<span class="op" id="2909216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909220">current</span><span class="op" id="2909227">,</span>&nbsp;<span class="ident" id="2909229">next</span>&nbsp;<span class="op" id="2909234">=</span>&nbsp;<span class="ident" id="2909236">next</span><span class="op" id="2909240">,</span>&nbsp;<span class="ident" id="2909242">current</span><span class="op" id="2909249">[</span><span class="op" id="2909250">:</span><span class="num" id="2909251">0</span><span class="op" id="2909252">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909256">count</span>&nbsp;<span class="op" id="2909262">:=</span>&nbsp;<span class="ident" id="2909265">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909277">nextCount</span>&nbsp;<span class="op" id="2909287">=</span>&nbsp;<span class="ident" id="2909289">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909296">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909364">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909449">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909524">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909613">for</span>&nbsp;<span class="ident" id="2909617">_</span><span class="op" id="2909618">,</span>&nbsp;<span class="ident" id="2909620">scan</span>&nbsp;<span class="op" id="2909625">:=</span>&nbsp;<span class="keyword" id="2909628">range</span>&nbsp;<span class="ident" id="2909634">current</span>&nbsp;<span class="op" id="2909642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909647">t</span>&nbsp;<span class="op" id="2909649">:=</span>&nbsp;<span class="ident" id="2909652">scan</span><span class="op" id="2909656">.</span><span class="ident" id="2909657">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909664">if</span>&nbsp;<span class="ident" id="2909667">visited</span><span class="op" id="2909674">[</span><span class="ident" id="2909675">t</span><span class="op" id="2909676">]</span>&nbsp;<span class="op" id="2909678">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909684">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909749">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909817">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2909882">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909887">visited</span><span class="op" id="2909894">[</span><span class="ident" id="2909895">t</span><span class="op" id="2909896">]</span>&nbsp;<span class="op" id="2909898">=</span>&nbsp;<span class="builtintype" id="2909900">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909908">for</span>&nbsp;<span class="ident" id="2909912">i</span>&nbsp;<span class="op" id="2909914">:=</span>&nbsp;<span class="keyword" id="2909917">range</span>&nbsp;<span class="ident" id="2909923">t</span><span class="op" id="2909924">.</span><span class="ident" id="2909925">fields</span>&nbsp;<span class="op" id="2909932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2909938">f</span>&nbsp;<span class="op" id="2909940">:=</span>&nbsp;<span class="op" id="2909943">&amp;</span><span class="ident" id="2909944">t</span><span class="op" id="2909945">.</span><span class="ident" id="2909946">fields</span><span class="op" id="2909952">[</span><span class="ident" id="2909953">i</span><span class="op" id="2909954">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2909960">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2909999">var</span>&nbsp;<span class="ident" id="2910003">fname</span>&nbsp;<span class="builtintype" id="2910009">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910020">var</span>&nbsp;<span class="ident" id="2910024">ntyp</span>&nbsp;<span class="op" id="2910029">*</span><span class="ident" id="2910030">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910040">if</span>&nbsp;<span class="ident" id="2910043">f</span><span class="op" id="2910044">.</span><span class="ident" id="2910045">name</span>&nbsp;<span class="op" id="2910050">!=</span>&nbsp;<span class="ident" id="2910053">nil</span>&nbsp;<span class="op" id="2910057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910064">fname</span>&nbsp;<span class="op" id="2910070">=</span>&nbsp;<span class="op" id="2910072">*</span><span class="ident" id="2910073">f</span><span class="op" id="2910074">.</span><span class="ident" id="2910075">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910084">}</span>&nbsp;<span class="keyword" id="2910086">else</span>&nbsp;<span class="op" id="2910091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910098">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910139">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910169">ntyp</span>&nbsp;<span class="op" id="2910174">=</span>&nbsp;<span class="ident" id="2910176">f</span><span class="op" id="2910177">.</span><span class="ident" id="2910178">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910187">if</span>&nbsp;<span class="ident" id="2910190">ntyp</span><span class="op" id="2910194">.</span><span class="ident" id="2910195">Kind</span><span class="op" id="2910199">(</span><span class="op" id="2910200">)</span>&nbsp;<span class="op" id="2910202">==</span>&nbsp;<span class="ident" id="2910205">Ptr</span>&nbsp;<span class="op" id="2910209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910217">ntyp</span>&nbsp;<span class="op" id="2910222">=</span>&nbsp;<span class="ident" id="2910224">ntyp</span><span class="op" id="2910228">.</span><span class="ident" id="2910229">Elem</span><span class="op" id="2910233">(</span><span class="op" id="2910234">)</span><span class="op" id="2910235">.</span><span class="ident" id="2910236">common</span><span class="op" id="2910242">(</span><span class="op" id="2910243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910250">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910257">fname</span>&nbsp;<span class="op" id="2910263">=</span>&nbsp;<span class="ident" id="2910265">ntyp</span><span class="op" id="2910269">.</span><span class="ident" id="2910270">Name</span><span class="op" id="2910274">(</span><span class="op" id="2910275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910288">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910310">if</span>&nbsp;<span class="ident" id="2910313">match</span><span class="op" id="2910318">(</span><span class="ident" id="2910319">fname</span><span class="op" id="2910324">)</span>&nbsp;<span class="op" id="2910326">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910333">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910357">if</span>&nbsp;<span class="ident" id="2910360">count</span><span class="op" id="2910365">[</span><span class="ident" id="2910366">t</span><span class="op" id="2910367">]</span>&nbsp;<span class="op" id="2910369">&gt;</span>&nbsp;<span class="num" id="2910371">1</span>&nbsp;<span class="op" id="2910373">||</span>&nbsp;<span class="ident" id="2910376">ok</span>&nbsp;<span class="op" id="2910379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910387">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910452">return</span>&nbsp;<span class="ident" id="2910459">StructField</span><span class="op" id="2910470">{</span><span class="op" id="2910471">}</span><span class="op" id="2910472">,</span>&nbsp;<span class="builtintype" id="2910474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910485">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910492">result</span>&nbsp;<span class="op" id="2910499">=</span>&nbsp;<span class="ident" id="2910501">t</span><span class="op" id="2910502">.</span><span class="ident" id="2910503">Field</span><span class="op" id="2910508">(</span><span class="ident" id="2910509">i</span><span class="op" id="2910510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910517">result</span><span class="op" id="2910523">.</span><span class="ident" id="2910524">Index</span>&nbsp;<span class="op" id="2910530">=</span>&nbsp;<span class="ident" id="2910532">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910541">result</span><span class="op" id="2910547">.</span><span class="ident" id="2910548">Index</span>&nbsp;<span class="op" id="2910554">=</span>&nbsp;<span class="builtinfunc" id="2910556">append</span><span class="op" id="2910562">(</span><span class="ident" id="2910563">result</span><span class="op" id="2910569">.</span><span class="ident" id="2910570">Index</span><span class="op" id="2910575">,</span>&nbsp;<span class="ident" id="2910577">scan</span><span class="op" id="2910581">.</span><span class="ident" id="2910582">index</span><span class="op" id="2910587">...</span><span class="op" id="2910590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910597">result</span><span class="op" id="2910603">.</span><span class="ident" id="2910604">Index</span>&nbsp;<span class="op" id="2910610">=</span>&nbsp;<span class="builtinfunc" id="2910612">append</span><span class="op" id="2910618">(</span><span class="ident" id="2910619">result</span><span class="op" id="2910625">.</span><span class="ident" id="2910626">Index</span><span class="op" id="2910631">,</span>&nbsp;<span class="ident" id="2910633">i</span><span class="op" id="2910634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910641">ok</span>&nbsp;<span class="op" id="2910644">=</span>&nbsp;<span class="builtintype" id="2910646">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910656">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910676">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910744">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2910814">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910872">if</span>&nbsp;<span class="ident" id="2910875">ok</span>&nbsp;<span class="op" id="2910878">||</span>&nbsp;<span class="ident" id="2910881">ntyp</span>&nbsp;<span class="op" id="2910886">==</span>&nbsp;<span class="ident" id="2910889">nil</span>&nbsp;<span class="op" id="2910893">||</span>&nbsp;<span class="ident" id="2910896">ntyp</span><span class="op" id="2910900">.</span><span class="ident" id="2910901">Kind</span><span class="op" id="2910905">(</span><span class="op" id="2910906">)</span>&nbsp;<span class="op" id="2910908">!=</span>&nbsp;<span class="ident" id="2910911">Struct</span>&nbsp;<span class="op" id="2910918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910925">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2910938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2910944">styp</span>&nbsp;<span class="op" id="2910949">:=</span>&nbsp;<span class="op" id="2910952">(</span><span class="op" id="2910953">*</span><span class="ident" id="2910954">structType</span><span class="op" id="2910964">)</span><span class="op" id="2910965">(</span><span class="ident" id="2910966">unsafe</span><span class="op" id="2910972">.</span><span class="ident" id="2910973">Pointer</span><span class="op" id="2910980">(</span><span class="ident" id="2910981">ntyp</span><span class="op" id="2910985">)</span><span class="op" id="2910986">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2910992">if</span>&nbsp;<span class="ident" id="2910995">nextCount</span><span class="op" id="2911004">[</span><span class="ident" id="2911005">styp</span><span class="op" id="2911009">]</span>&nbsp;<span class="op" id="2911011">&gt;</span>&nbsp;<span class="num" id="2911013">0</span>&nbsp;<span class="op" id="2911015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911022">nextCount</span><span class="op" id="2911031">[</span><span class="ident" id="2911032">styp</span><span class="op" id="2911036">]</span>&nbsp;<span class="op" id="2911038">=</span>&nbsp;<span class="num" id="2911040">2</span>&nbsp;<span class="comment" id="2911042">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911080">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911099">if</span>&nbsp;<span class="ident" id="2911102">nextCount</span>&nbsp;<span class="op" id="2911112">==</span>&nbsp;<span class="ident" id="2911115">nil</span>&nbsp;<span class="op" id="2911119">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911126">nextCount</span>&nbsp;<span class="op" id="2911136">=</span>&nbsp;<span class="keyword" id="2911138">map</span><span class="op" id="2911141">[</span><span class="op" id="2911142">*</span><span class="ident" id="2911143">structType</span><span class="op" id="2911153">]</span><span class="builtintype" id="2911154">int</span><span class="op" id="2911157">{</span><span class="op" id="2911158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911170">nextCount</span><span class="op" id="2911179">[</span><span class="ident" id="2911180">styp</span><span class="op" id="2911184">]</span>&nbsp;<span class="op" id="2911186">=</span>&nbsp;<span class="num" id="2911188">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911194">if</span>&nbsp;<span class="ident" id="2911197">count</span><span class="op" id="2911202">[</span><span class="ident" id="2911203">t</span><span class="op" id="2911204">]</span>&nbsp;<span class="op" id="2911206">&gt;</span>&nbsp;<span class="num" id="2911208">1</span>&nbsp;<span class="op" id="2911210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911217">nextCount</span><span class="op" id="2911226">[</span><span class="ident" id="2911227">styp</span><span class="op" id="2911231">]</span>&nbsp;<span class="op" id="2911233">=</span>&nbsp;<span class="num" id="2911235">2</span>&nbsp;<span class="comment" id="2911237">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911280">var</span>&nbsp;<span class="ident" id="2911284">index</span>&nbsp;<span class="op" id="2911290">[</span><span class="op" id="2911291">]</span><span class="builtintype" id="2911292">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911300">index</span>&nbsp;<span class="op" id="2911306">=</span>&nbsp;<span class="builtinfunc" id="2911308">append</span><span class="op" id="2911314">(</span><span class="ident" id="2911315">index</span><span class="op" id="2911320">,</span>&nbsp;<span class="ident" id="2911322">scan</span><span class="op" id="2911326">.</span><span class="ident" id="2911327">index</span><span class="op" id="2911332">...</span><span class="op" id="2911335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911341">index</span>&nbsp;<span class="op" id="2911347">=</span>&nbsp;<span class="builtinfunc" id="2911349">append</span><span class="op" id="2911355">(</span><span class="ident" id="2911356">index</span><span class="op" id="2911361">,</span>&nbsp;<span class="ident" id="2911363">i</span><span class="op" id="2911364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911370">next</span>&nbsp;<span class="op" id="2911375">=</span>&nbsp;<span class="builtinfunc" id="2911377">append</span><span class="op" id="2911383">(</span><span class="ident" id="2911384">next</span><span class="op" id="2911388">,</span>&nbsp;<span class="ident" id="2911390">fieldScan</span><span class="op" id="2911399">{</span><span class="ident" id="2911400">styp</span><span class="op" id="2911404">,</span>&nbsp;<span class="ident" id="2911406">index</span><span class="op" id="2911411">}</span><span class="op" id="2911412">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911425">if</span>&nbsp;<span class="ident" id="2911428">ok</span>&nbsp;<span class="op" id="2911431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911436">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911444">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911450">return</span><br>
<span class="lineno"></span><span class="op" id="2911457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2911460">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2911520">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2911573">func</span>&nbsp;<span class="op" id="2911578">(</span><span class="ident" id="2911579">t</span>&nbsp;<span class="op" id="2911581">*</span><span class="ident" id="2911582">structType</span><span class="op" id="2911592">)</span>&nbsp;<span class="ident" id="2911594">FieldByName</span><span class="op" id="2911605">(</span><span class="ident" id="2911606">name</span>&nbsp;<span class="builtintype" id="2911611">string</span><span class="op" id="2911617">)</span>&nbsp;<span class="op" id="2911619">(</span><span class="ident" id="2911620">f</span>&nbsp;<span class="ident" id="2911622">StructField</span><span class="op" id="2911633">,</span>&nbsp;<span class="ident" id="2911635">present</span>&nbsp;<span class="builtintype" id="2911643">bool</span><span class="op" id="2911647">)</span>&nbsp;<span class="op" id="2911649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2911652">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911724">hasAnon</span>&nbsp;<span class="op" id="2911732">:=</span>&nbsp;<span class="builtintype" id="2911735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911742">if</span>&nbsp;<span class="ident" id="2911745">name</span>&nbsp;<span class="op" id="2911750">!=</span>&nbsp;<span class="string" id="2911753">&#34;&#34;</span>&nbsp;<span class="op" id="2911756">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911760">for</span>&nbsp;<span class="ident" id="2911764">i</span>&nbsp;<span class="op" id="2911766">:=</span>&nbsp;<span class="keyword" id="2911769">range</span>&nbsp;<span class="ident" id="2911775">t</span><span class="op" id="2911776">.</span><span class="ident" id="2911777">fields</span>&nbsp;<span class="op" id="2911784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911789">tf</span>&nbsp;<span class="op" id="2911792">:=</span>&nbsp;<span class="op" id="2911795">&amp;</span><span class="ident" id="2911796">t</span><span class="op" id="2911797">.</span><span class="ident" id="2911798">fields</span><span class="op" id="2911804">[</span><span class="ident" id="2911805">i</span><span class="op" id="2911806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911811">if</span>&nbsp;<span class="ident" id="2911814">tf</span><span class="op" id="2911816">.</span><span class="ident" id="2911817">name</span>&nbsp;<span class="op" id="2911822">==</span>&nbsp;<span class="ident" id="2911825">nil</span>&nbsp;<span class="op" id="2911829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2911835">hasAnon</span>&nbsp;<span class="op" id="2911843">=</span>&nbsp;<span class="builtintype" id="2911845">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911854">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911871">if</span>&nbsp;<span class="op" id="2911874">*</span><span class="ident" id="2911875">tf</span><span class="op" id="2911877">.</span><span class="ident" id="2911878">name</span>&nbsp;<span class="op" id="2911883">==</span>&nbsp;<span class="ident" id="2911886">name</span>&nbsp;<span class="op" id="2911891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911897">return</span>&nbsp;<span class="ident" id="2911904">t</span><span class="op" id="2911905">.</span><span class="ident" id="2911906">Field</span><span class="op" id="2911911">(</span><span class="ident" id="2911912">i</span><span class="op" id="2911913">)</span><span class="op" id="2911914">,</span>&nbsp;<span class="builtintype" id="2911916">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911928">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911934">if</span>&nbsp;<span class="op" id="2911937">!</span><span class="ident" id="2911938">hasAnon</span>&nbsp;<span class="op" id="2911946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911950">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2911958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2911961">return</span>&nbsp;<span class="ident" id="2911968">t</span><span class="op" id="2911969">.</span><span class="ident" id="2911970">FieldByNameFunc</span><span class="op" id="2911985">(</span><span class="keyword" id="2911986">func</span><span class="op" id="2911990">(</span><span class="ident" id="2911991">s</span>&nbsp;<span class="builtintype" id="2911993">string</span><span class="op" id="2911999">)</span>&nbsp;<span class="builtintype" id="2912001">bool</span>&nbsp;<span class="op" id="2912006">{</span>&nbsp;<span class="keyword" id="2912008">return</span>&nbsp;<span class="ident" id="2912015">s</span>&nbsp;<span class="op" id="2912017">==</span>&nbsp;<span class="ident" id="2912020">name</span>&nbsp;<span class="op" id="2912025">}</span><span class="op" id="2912026">)</span><br>
<span class="lineno">1000</span><span class="op" id="2912028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2912031">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2912102">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2912130">func</span>&nbsp;<span class="ident" id="2912135">TypeOf</span><span class="op" id="2912141">(</span><span class="ident" id="2912142">i</span>&nbsp;<span class="keyword" id="2912144">interface</span><span class="op" id="2912153">{</span><span class="op" id="2912154">}</span><span class="op" id="2912155">)</span>&nbsp;<span class="ident" id="2912157">Type</span>&nbsp;<span class="op" id="2912162">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912165">eface</span>&nbsp;<span class="op" id="2912171">:=</span>&nbsp;<span class="op" id="2912174">*</span><span class="op" id="2912175">(</span><span class="op" id="2912176">*</span><span class="ident" id="2912177">emptyInterface</span><span class="op" id="2912191">)</span><span class="op" id="2912192">(</span><span class="ident" id="2912193">unsafe</span><span class="op" id="2912199">.</span><span class="ident" id="2912200">Pointer</span><span class="op" id="2912207">(</span><span class="op" id="2912208">&amp;</span><span class="ident" id="2912209">i</span><span class="op" id="2912210">)</span><span class="op" id="2912211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912214">return</span>&nbsp;<span class="ident" id="2912221">toType</span><span class="op" id="2912227">(</span><span class="ident" id="2912228">eface</span><span class="op" id="2912233">.</span><span class="ident" id="2912234">typ</span><span class="op" id="2912237">)</span><br>
<span class="lineno"></span><span class="op" id="2912239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2912242">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2912276">var</span>&nbsp;<span class="ident" id="2912280">ptrMap</span>&nbsp;<span class="keyword" id="2912287">struct</span>&nbsp;<span class="op" id="2912294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912297">sync</span><span class="op" id="2912301">.</span><span class="ident" id="2912302">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912311">m</span>&nbsp;<span class="keyword" id="2912313">map</span><span class="op" id="2912316">[</span><span class="op" id="2912317">*</span><span class="ident" id="2912318">rtype</span><span class="op" id="2912323">]</span><span class="op" id="2912324">*</span><span class="ident" id="2912325">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2912333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2912336">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2912386">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2912454">func</span>&nbsp;<span class="ident" id="2912459">PtrTo</span><span class="op" id="2912464">(</span><span class="ident" id="2912465">t</span>&nbsp;<span class="ident" id="2912467">Type</span><span class="op" id="2912471">)</span>&nbsp;<span class="ident" id="2912473">Type</span>&nbsp;<span class="op" id="2912478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912481">return</span>&nbsp;<span class="ident" id="2912488">t</span><span class="op" id="2912489">.</span><span class="op" id="2912490">(</span><span class="op" id="2912491">*</span><span class="ident" id="2912492">rtype</span><span class="op" id="2912497">)</span><span class="op" id="2912498">.</span><span class="ident" id="2912499">ptrTo</span><span class="op" id="2912504">(</span><span class="op" id="2912505">)</span><br>
<span class="lineno"></span><span class="op" id="2912507">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2912510">func</span>&nbsp;<span class="op" id="2912515">(</span><span class="ident" id="2912516">t</span>&nbsp;<span class="op" id="2912518">*</span><span class="ident" id="2912519">rtype</span><span class="op" id="2912524">)</span>&nbsp;<span class="ident" id="2912526">ptrTo</span><span class="op" id="2912531">(</span><span class="op" id="2912532">)</span>&nbsp;<span class="op" id="2912534">*</span><span class="ident" id="2912535">rtype</span>&nbsp;<span class="op" id="2912541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912544">if</span>&nbsp;<span class="ident" id="2912547">p</span>&nbsp;<span class="op" id="2912549">:=</span>&nbsp;<span class="ident" id="2912552">t</span><span class="op" id="2912553">.</span><span class="ident" id="2912554">ptrToThis</span><span class="op" id="2912563">;</span>&nbsp;<span class="ident" id="2912565">p</span>&nbsp;<span class="op" id="2912567">!=</span>&nbsp;<span class="ident" id="2912570">nil</span>&nbsp;<span class="op" id="2912574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912578">return</span>&nbsp;<span class="ident" id="2912585">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2912588">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2912592">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2912623">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2912675">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2912729">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2912788">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912833">ptrMap</span><span class="op" id="2912839">.</span><span class="ident" id="2912840">RLock</span><span class="op" id="2912845">(</span><span class="op" id="2912846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912849">if</span>&nbsp;<span class="ident" id="2912852">m</span>&nbsp;<span class="op" id="2912854">:=</span>&nbsp;<span class="ident" id="2912857">ptrMap</span><span class="op" id="2912863">.</span><span class="ident" id="2912864">m</span><span class="op" id="2912865">;</span>&nbsp;<span class="ident" id="2912867">m</span>&nbsp;<span class="op" id="2912869">!=</span>&nbsp;<span class="ident" id="2912872">nil</span>&nbsp;<span class="op" id="2912876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912880">if</span>&nbsp;<span class="ident" id="2912883">p</span>&nbsp;<span class="op" id="2912885">:=</span>&nbsp;<span class="ident" id="2912888">m</span><span class="op" id="2912889">[</span><span class="ident" id="2912890">t</span><span class="op" id="2912891">]</span><span class="op" id="2912892">;</span>&nbsp;<span class="ident" id="2912894">p</span>&nbsp;<span class="op" id="2912896">!=</span>&nbsp;<span class="ident" id="2912899">nil</span>&nbsp;<span class="op" id="2912903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912908">ptrMap</span><span class="op" id="2912914">.</span><span class="ident" id="2912915">RUnlock</span><span class="op" id="2912922">(</span><span class="op" id="2912923">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912928">return</span>&nbsp;<span class="op" id="2912935">&amp;</span><span class="ident" id="2912936">p</span><span class="op" id="2912937">.</span><span class="ident" id="2912938">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2912946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2912949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912952">ptrMap</span><span class="op" id="2912958">.</span><span class="ident" id="2912959">RUnlock</span><span class="op" id="2912966">(</span><span class="op" id="2912967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2912970">ptrMap</span><span class="op" id="2912976">.</span><span class="ident" id="2912977">Lock</span><span class="op" id="2912981">(</span><span class="op" id="2912982">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2912985">if</span>&nbsp;<span class="ident" id="2912988">ptrMap</span><span class="op" id="2912994">.</span><span class="ident" id="2912995">m</span>&nbsp;<span class="op" id="2912997">==</span>&nbsp;<span class="ident" id="2913000">nil</span>&nbsp;<span class="op" id="2913004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913008">ptrMap</span><span class="op" id="2913014">.</span><span class="ident" id="2913015">m</span>&nbsp;<span class="op" id="2913017">=</span>&nbsp;<span class="builtinfunc" id="2913019">make</span><span class="op" id="2913023">(</span><span class="keyword" id="2913024">map</span><span class="op" id="2913027">[</span><span class="op" id="2913028">*</span><span class="ident" id="2913029">rtype</span><span class="op" id="2913034">]</span><span class="op" id="2913035">*</span><span class="ident" id="2913036">ptrType</span><span class="op" id="2913043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2913046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913049">p</span>&nbsp;<span class="op" id="2913051">:=</span>&nbsp;<span class="ident" id="2913054">ptrMap</span><span class="op" id="2913060">.</span><span class="ident" id="2913061">m</span><span class="op" id="2913062">[</span><span class="ident" id="2913063">t</span><span class="op" id="2913064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2913067">if</span>&nbsp;<span class="ident" id="2913070">p</span>&nbsp;<span class="op" id="2913072">!=</span>&nbsp;<span class="ident" id="2913075">nil</span>&nbsp;<span class="op" id="2913079">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913083">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913137">ptrMap</span><span class="op" id="2913143">.</span><span class="ident" id="2913144">Unlock</span><span class="op" id="2913150">(</span><span class="op" id="2913151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2913155">return</span>&nbsp;<span class="op" id="2913162">&amp;</span><span class="ident" id="2913163">p</span><span class="op" id="2913164">.</span><span class="ident" id="2913165">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2913172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913176">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913231">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913258">p</span>&nbsp;<span class="op" id="2913260">=</span>&nbsp;<span class="builtinfunc" id="2913262">new</span><span class="op" id="2913265">(</span><span class="ident" id="2913266">ptrType</span><span class="op" id="2913273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2913276">var</span>&nbsp;<span class="ident" id="2913280">iptr</span>&nbsp;<span class="keyword" id="2913285">interface</span><span class="op" id="2913294">{</span><span class="op" id="2913295">}</span>&nbsp;<span class="op" id="2913297">=</span>&nbsp;<span class="op" id="2913299">(</span><span class="op" id="2913300">*</span><span class="ident" id="2913301">unsafe</span><span class="op" id="2913307">.</span><span class="ident" id="2913308">Pointer</span><span class="op" id="2913315">)</span><span class="op" id="2913316">(</span><span class="ident" id="2913317">nil</span><span class="op" id="2913320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913323">prototype</span>&nbsp;<span class="op" id="2913333">:=</span>&nbsp;<span class="op" id="2913336">*</span><span class="op" id="2913337">(</span><span class="op" id="2913338">*</span><span class="op" id="2913339">*</span><span class="ident" id="2913340">ptrType</span><span class="op" id="2913347">)</span><span class="op" id="2913348">(</span><span class="ident" id="2913349">unsafe</span><span class="op" id="2913355">.</span><span class="ident" id="2913356">Pointer</span><span class="op" id="2913363">(</span><span class="op" id="2913364">&amp;</span><span class="ident" id="2913365">iptr</span><span class="op" id="2913369">)</span><span class="op" id="2913370">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2913373">*</span><span class="ident" id="2913374">p</span>&nbsp;<span class="op" id="2913376">=</span>&nbsp;<span class="op" id="2913378">*</span><span class="ident" id="2913379">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913391">s</span>&nbsp;<span class="op" id="2913393">:=</span>&nbsp;<span class="string" id="2913396">&#34;*&#34;</span>&nbsp;<span class="op" id="2913400">+</span>&nbsp;<span class="op" id="2913402">*</span><span class="ident" id="2913403">t</span><span class="op" id="2913404">.</span><span class="builtintype" id="2913405">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913413">p</span><span class="op" id="2913414">.</span><span class="builtintype" id="2913415">string</span>&nbsp;<span class="op" id="2913422">=</span>&nbsp;<span class="op" id="2913424">&amp;</span><span class="ident" id="2913425">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913429">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913485">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913534">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913585">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2913637">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913667">p</span><span class="op" id="2913668">.</span><span class="ident" id="2913669">hash</span>&nbsp;<span class="op" id="2913674">=</span>&nbsp;<span class="ident" id="2913676">fnv1</span><span class="op" id="2913680">(</span><span class="ident" id="2913681">t</span><span class="op" id="2913682">.</span><span class="ident" id="2913683">hash</span><span class="op" id="2913687">,</span>&nbsp;<span class="string" id="2913689">&#39;*&#39;</span><span class="op" id="2913692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913696">p</span><span class="op" id="2913697">.</span><span class="ident" id="2913698">uncommonType</span>&nbsp;<span class="op" id="2913711">=</span>&nbsp;<span class="ident" id="2913713">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913718">p</span><span class="op" id="2913719">.</span><span class="ident" id="2913720">ptrToThis</span>&nbsp;<span class="op" id="2913730">=</span>&nbsp;<span class="ident" id="2913732">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913737">p</span><span class="op" id="2913738">.</span><span class="ident" id="2913739">zero</span>&nbsp;<span class="op" id="2913744">=</span>&nbsp;<span class="ident" id="2913746">unsafe</span><span class="op" id="2913752">.</span><span class="ident" id="2913753">Pointer</span><span class="op" id="2913760">(</span><span class="op" id="2913761">&amp;</span><span class="builtinfunc" id="2913762">make</span><span class="op" id="2913766">(</span><span class="op" id="2913767">[</span><span class="op" id="2913768">]</span><span class="builtintype" id="2913769">byte</span><span class="op" id="2913773">,</span>&nbsp;<span class="ident" id="2913775">p</span><span class="op" id="2913776">.</span><span class="ident" id="2913777">size</span><span class="op" id="2913781">)</span><span class="op" id="2913782">[</span><span class="num" id="2913783">0</span><span class="op" id="2913784">]</span><span class="op" id="2913785">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913788">p</span><span class="op" id="2913789">.</span><span class="ident" id="2913790">elem</span>&nbsp;<span class="op" id="2913795">=</span>&nbsp;<span class="ident" id="2913797">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913801">ptrMap</span><span class="op" id="2913807">.</span><span class="ident" id="2913808">m</span><span class="op" id="2913809">[</span><span class="ident" id="2913810">t</span><span class="op" id="2913811">]</span>&nbsp;<span class="op" id="2913813">=</span>&nbsp;<span class="ident" id="2913815">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2913818">ptrMap</span><span class="op" id="2913824">.</span><span class="ident" id="2913825">Unlock</span><span class="op" id="2913831">(</span><span class="op" id="2913832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2913835">return</span>&nbsp;<span class="op" id="2913842">&amp;</span><span class="ident" id="2913843">p</span><span class="op" id="2913844">.</span><span class="ident" id="2913845">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2913851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2913854">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2913940">func</span>&nbsp;<span class="ident" id="2913945">fnv1</span><span class="op" id="2913949">(</span><span class="ident" id="2913950">x</span>&nbsp;<span class="builtintype" id="2913952">uint32</span><span class="op" id="2913958">,</span>&nbsp;<span class="ident" id="2913960">list</span>&nbsp;<span class="op" id="2913965">...</span><span class="builtintype" id="2913968">byte</span><span class="op" id="2913972">)</span>&nbsp;<span class="builtintype" id="2913974">uint32</span>&nbsp;<span class="op" id="2913981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2913984">for</span>&nbsp;<span class="ident" id="2913988">_</span><span class="op" id="2913989">,</span>&nbsp;<span class="ident" id="2913991">b</span>&nbsp;<span class="op" id="2913993">:=</span>&nbsp;<span class="keyword" id="2913996">range</span>&nbsp;<span class="ident" id="2914002">list</span>&nbsp;<span class="op" id="2914007">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2914011">x</span>&nbsp;<span class="op" id="2914013">=</span>&nbsp;<span class="ident" id="2914015">x</span><span class="op" id="2914016">*</span><span class="num" id="2914017">16777619</span>&nbsp;<span class="op" id="2914026">^</span>&nbsp;<span class="builtintype" id="2914028">uint32</span><span class="op" id="2914034">(</span><span class="ident" id="2914035">b</span><span class="op" id="2914036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914042">return</span>&nbsp;<span class="ident" id="2914049">x</span><br>
<span class="lineno"></span><span class="op" id="2914051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2914054">func</span>&nbsp;<span class="op" id="2914059">(</span><span class="ident" id="2914060">t</span>&nbsp;<span class="op" id="2914062">*</span><span class="ident" id="2914063">rtype</span><span class="op" id="2914068">)</span>&nbsp;<span class="ident" id="2914070">Implements</span><span class="op" id="2914080">(</span><span class="ident" id="2914081">u</span>&nbsp;<span class="ident" id="2914083">Type</span><span class="op" id="2914087">)</span>&nbsp;<span class="builtintype" id="2914089">bool</span>&nbsp;<span class="op" id="2914094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914097">if</span>&nbsp;<span class="ident" id="2914100">u</span>&nbsp;<span class="op" id="2914102">==</span>&nbsp;<span class="ident" id="2914105">nil</span>&nbsp;<span class="op" id="2914109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2914113">panic</span><span class="op" id="2914118">(</span><span class="string" id="2914119">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2914164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914170">if</span>&nbsp;<span class="ident" id="2914173">u</span><span class="op" id="2914174">.</span><span class="ident" id="2914175">Kind</span><span class="op" id="2914179">(</span><span class="op" id="2914180">)</span>&nbsp;<span class="op" id="2914182">!=</span>&nbsp;<span class="ident" id="2914185">Interface</span>&nbsp;<span class="op" id="2914195">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2914199">panic</span><span class="op" id="2914204">(</span><span class="string" id="2914205">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2914260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914266">return</span>&nbsp;<span class="ident" id="2914273">implements</span><span class="op" id="2914283">(</span><span class="ident" id="2914284">u</span><span class="op" id="2914285">.</span><span class="op" id="2914286">(</span><span class="op" id="2914287">*</span><span class="ident" id="2914288">rtype</span><span class="op" id="2914293">)</span><span class="op" id="2914294">,</span>&nbsp;<span class="ident" id="2914296">t</span><span class="op" id="2914297">)</span><br>
<span class="lineno"></span><span class="op" id="2914299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2914302">func</span>&nbsp;<span class="op" id="2914307">(</span><span class="ident" id="2914308">t</span>&nbsp;<span class="op" id="2914310">*</span><span class="ident" id="2914311">rtype</span><span class="op" id="2914316">)</span>&nbsp;<span class="ident" id="2914318">AssignableTo</span><span class="op" id="2914330">(</span><span class="ident" id="2914331">u</span>&nbsp;<span class="ident" id="2914333">Type</span><span class="op" id="2914337">)</span>&nbsp;<span class="builtintype" id="2914339">bool</span>&nbsp;<span class="op" id="2914344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914347">if</span>&nbsp;<span class="ident" id="2914350">u</span>&nbsp;<span class="op" id="2914352">==</span>&nbsp;<span class="ident" id="2914355">nil</span>&nbsp;<span class="op" id="2914359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2914363">panic</span><span class="op" id="2914368">(</span><span class="string" id="2914369">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2914416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2914422">uu</span>&nbsp;<span class="op" id="2914425">:=</span>&nbsp;<span class="ident" id="2914428">u</span><span class="op" id="2914429">.</span><span class="op" id="2914430">(</span><span class="op" id="2914431">*</span><span class="ident" id="2914432">rtype</span><span class="op" id="2914437">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914440">return</span>&nbsp;<span class="ident" id="2914447">directlyAssignable</span><span class="op" id="2914465">(</span><span class="ident" id="2914466">uu</span><span class="op" id="2914468">,</span>&nbsp;<span class="ident" id="2914470">t</span><span class="op" id="2914471">)</span>&nbsp;<span class="op" id="2914473">||</span>&nbsp;<span class="ident" id="2914476">implements</span><span class="op" id="2914486">(</span><span class="ident" id="2914487">uu</span><span class="op" id="2914489">,</span>&nbsp;<span class="ident" id="2914491">t</span><span class="op" id="2914492">)</span><br>
<span class="lineno"></span><span class="op" id="2914494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2914497">func</span>&nbsp;<span class="op" id="2914502">(</span><span class="ident" id="2914503">t</span>&nbsp;<span class="op" id="2914505">*</span><span class="ident" id="2914506">rtype</span><span class="op" id="2914511">)</span>&nbsp;<span class="ident" id="2914513">ConvertibleTo</span><span class="op" id="2914526">(</span><span class="ident" id="2914527">u</span>&nbsp;<span class="ident" id="2914529">Type</span><span class="op" id="2914533">)</span>&nbsp;<span class="builtintype" id="2914535">bool</span>&nbsp;<span class="op" id="2914540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914543">if</span>&nbsp;<span class="ident" id="2914546">u</span>&nbsp;<span class="op" id="2914548">==</span>&nbsp;<span class="ident" id="2914551">nil</span>&nbsp;<span class="op" id="2914555">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2914559">panic</span><span class="op" id="2914564">(</span><span class="string" id="2914565">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2914613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2914619">uu</span>&nbsp;<span class="op" id="2914622">:=</span>&nbsp;<span class="ident" id="2914625">u</span><span class="op" id="2914626">.</span><span class="op" id="2914627">(</span><span class="op" id="2914628">*</span><span class="ident" id="2914629">rtype</span><span class="op" id="2914634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914637">return</span>&nbsp;<span class="ident" id="2914644">convertOp</span><span class="op" id="2914653">(</span><span class="ident" id="2914654">uu</span><span class="op" id="2914656">,</span>&nbsp;<span class="ident" id="2914658">t</span><span class="op" id="2914659">)</span>&nbsp;<span class="op" id="2914661">!=</span>&nbsp;<span class="ident" id="2914664">nil</span><br>
<span class="lineno"></span><span class="op" id="2914668">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2914671">func</span>&nbsp;<span class="op" id="2914676">(</span><span class="ident" id="2914677">t</span>&nbsp;<span class="op" id="2914679">*</span><span class="ident" id="2914680">rtype</span><span class="op" id="2914685">)</span>&nbsp;<span class="ident" id="2914687">Comparable</span><span class="op" id="2914697">(</span><span class="op" id="2914698">)</span>&nbsp;<span class="builtintype" id="2914700">bool</span>&nbsp;<span class="op" id="2914705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914708">return</span>&nbsp;<span class="ident" id="2914715">t</span><span class="op" id="2914716">.</span><span class="ident" id="2914717">alg</span>&nbsp;<span class="op" id="2914721">!=</span>&nbsp;<span class="ident" id="2914724">nil</span>&nbsp;<span class="op" id="2914728">&amp;&amp;</span>&nbsp;<span class="ident" id="2914731">t</span><span class="op" id="2914732">.</span><span class="ident" id="2914733">alg</span><span class="op" id="2914736">.</span><span class="ident" id="2914737">equal</span>&nbsp;<span class="op" id="2914743">!=</span>&nbsp;<span class="ident" id="2914746">nil</span><br>
<span class="lineno"></span><span class="op" id="2914750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2914753">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2914827">func</span>&nbsp;<span class="ident" id="2914832">implements</span><span class="op" id="2914842">(</span><span class="ident" id="2914843">T</span><span class="op" id="2914844">,</span>&nbsp;<span class="ident" id="2914846">V</span>&nbsp;<span class="op" id="2914848">*</span><span class="ident" id="2914849">rtype</span><span class="op" id="2914854">)</span>&nbsp;<span class="builtintype" id="2914856">bool</span>&nbsp;<span class="op" id="2914861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914864">if</span>&nbsp;<span class="ident" id="2914867">T</span><span class="op" id="2914868">.</span><span class="ident" id="2914869">Kind</span><span class="op" id="2914873">(</span><span class="op" id="2914874">)</span>&nbsp;<span class="op" id="2914876">!=</span>&nbsp;<span class="ident" id="2914879">Interface</span>&nbsp;<span class="op" id="2914889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914893">return</span>&nbsp;<span class="builtintype" id="2914900">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914907">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2914910">t</span>&nbsp;<span class="op" id="2914912">:=</span>&nbsp;<span class="op" id="2914915">(</span><span class="op" id="2914916">*</span><span class="ident" id="2914917">interfaceType</span><span class="op" id="2914930">)</span><span class="op" id="2914931">(</span><span class="ident" id="2914932">unsafe</span><span class="op" id="2914938">.</span><span class="ident" id="2914939">Pointer</span><span class="op" id="2914946">(</span><span class="ident" id="2914947">T</span><span class="op" id="2914948">)</span><span class="op" id="2914949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914952">if</span>&nbsp;<span class="builtinfunc" id="2914955">len</span><span class="op" id="2914958">(</span><span class="ident" id="2914959">t</span><span class="op" id="2914960">.</span><span class="ident" id="2914961">methods</span><span class="op" id="2914968">)</span>&nbsp;<span class="op" id="2914970">==</span>&nbsp;<span class="num" id="2914973">0</span>&nbsp;<span class="op" id="2914975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2914979">return</span>&nbsp;<span class="builtintype" id="2914986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2914992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2914996">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915050">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915110">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915156">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915218">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915276">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915336">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915397">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915454">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915513">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915577">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2915631">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915664">if</span>&nbsp;<span class="ident" id="2915667">V</span><span class="op" id="2915668">.</span><span class="ident" id="2915669">Kind</span><span class="op" id="2915673">(</span><span class="op" id="2915674">)</span>&nbsp;<span class="op" id="2915676">==</span>&nbsp;<span class="ident" id="2915679">Interface</span>&nbsp;<span class="op" id="2915689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2915693">v</span>&nbsp;<span class="op" id="2915695">:=</span>&nbsp;<span class="op" id="2915698">(</span><span class="op" id="2915699">*</span><span class="ident" id="2915700">interfaceType</span><span class="op" id="2915713">)</span><span class="op" id="2915714">(</span><span class="ident" id="2915715">unsafe</span><span class="op" id="2915721">.</span><span class="ident" id="2915722">Pointer</span><span class="op" id="2915729">(</span><span class="ident" id="2915730">V</span><span class="op" id="2915731">)</span><span class="op" id="2915732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2915736">i</span>&nbsp;<span class="op" id="2915738">:=</span>&nbsp;<span class="num" id="2915741">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915745">for</span>&nbsp;<span class="ident" id="2915749">j</span>&nbsp;<span class="op" id="2915751">:=</span>&nbsp;<span class="num" id="2915754">0</span><span class="op" id="2915755">;</span>&nbsp;<span class="ident" id="2915757">j</span>&nbsp;<span class="op" id="2915759">&lt;</span>&nbsp;<span class="builtinfunc" id="2915761">len</span><span class="op" id="2915764">(</span><span class="ident" id="2915765">v</span><span class="op" id="2915766">.</span><span class="ident" id="2915767">methods</span><span class="op" id="2915774">)</span><span class="op" id="2915775">;</span>&nbsp;<span class="ident" id="2915777">j</span><span class="op" id="2915778">++</span>&nbsp;<span class="op" id="2915781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2915786">tm</span>&nbsp;<span class="op" id="2915789">:=</span>&nbsp;<span class="op" id="2915792">&amp;</span><span class="ident" id="2915793">t</span><span class="op" id="2915794">.</span><span class="ident" id="2915795">methods</span><span class="op" id="2915802">[</span><span class="ident" id="2915803">i</span><span class="op" id="2915804">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2915809">vm</span>&nbsp;<span class="op" id="2915812">:=</span>&nbsp;<span class="op" id="2915815">&amp;</span><span class="ident" id="2915816">v</span><span class="op" id="2915817">.</span><span class="ident" id="2915818">methods</span><span class="op" id="2915825">[</span><span class="ident" id="2915826">j</span><span class="op" id="2915827">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915832">if</span>&nbsp;<span class="ident" id="2915835">vm</span><span class="op" id="2915837">.</span><span class="ident" id="2915838">name</span>&nbsp;<span class="op" id="2915843">==</span>&nbsp;<span class="ident" id="2915846">tm</span><span class="op" id="2915848">.</span><span class="ident" id="2915849">name</span>&nbsp;<span class="op" id="2915854">&amp;&amp;</span>&nbsp;<span class="ident" id="2915857">vm</span><span class="op" id="2915859">.</span><span class="ident" id="2915860">pkgPath</span>&nbsp;<span class="op" id="2915868">==</span>&nbsp;<span class="ident" id="2915871">tm</span><span class="op" id="2915873">.</span><span class="ident" id="2915874">pkgPath</span>&nbsp;<span class="op" id="2915882">&amp;&amp;</span>&nbsp;<span class="ident" id="2915885">vm</span><span class="op" id="2915887">.</span><span class="ident" id="2915888">typ</span>&nbsp;<span class="op" id="2915892">==</span>&nbsp;<span class="ident" id="2915895">tm</span><span class="op" id="2915897">.</span><span class="ident" id="2915898">typ</span>&nbsp;<span class="op" id="2915902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915908">if</span>&nbsp;<span class="ident" id="2915911">i</span><span class="op" id="2915912">++</span><span class="op" id="2915914">;</span>&nbsp;<span class="ident" id="2915916">i</span>&nbsp;<span class="op" id="2915918">&gt;=</span>&nbsp;<span class="builtinfunc" id="2915921">len</span><span class="op" id="2915924">(</span><span class="ident" id="2915925">t</span><span class="op" id="2915926">.</span><span class="ident" id="2915927">methods</span><span class="op" id="2915934">)</span>&nbsp;<span class="op" id="2915936">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915943">return</span>&nbsp;<span class="builtintype" id="2915950">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2915959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2915964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2915968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2915972">return</span>&nbsp;<span class="builtintype" id="2915979">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2915986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2915990">v</span>&nbsp;<span class="op" id="2915992">:=</span>&nbsp;<span class="ident" id="2915995">V</span><span class="op" id="2915996">.</span><span class="ident" id="2915997">uncommon</span><span class="op" id="2916005">(</span><span class="op" id="2916006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916009">if</span>&nbsp;<span class="ident" id="2916012">v</span>&nbsp;<span class="op" id="2916014">==</span>&nbsp;<span class="ident" id="2916017">nil</span>&nbsp;<span class="op" id="2916021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916025">return</span>&nbsp;<span class="builtintype" id="2916032">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2916042">i</span>&nbsp;<span class="op" id="2916044">:=</span>&nbsp;<span class="num" id="2916047">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916050">for</span>&nbsp;<span class="ident" id="2916054">j</span>&nbsp;<span class="op" id="2916056">:=</span>&nbsp;<span class="num" id="2916059">0</span><span class="op" id="2916060">;</span>&nbsp;<span class="ident" id="2916062">j</span>&nbsp;<span class="op" id="2916064">&lt;</span>&nbsp;<span class="builtinfunc" id="2916066">len</span><span class="op" id="2916069">(</span><span class="ident" id="2916070">v</span><span class="op" id="2916071">.</span><span class="ident" id="2916072">methods</span><span class="op" id="2916079">)</span><span class="op" id="2916080">;</span>&nbsp;<span class="ident" id="2916082">j</span><span class="op" id="2916083">++</span>&nbsp;<span class="op" id="2916086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2916090">tm</span>&nbsp;<span class="op" id="2916093">:=</span>&nbsp;<span class="op" id="2916096">&amp;</span><span class="ident" id="2916097">t</span><span class="op" id="2916098">.</span><span class="ident" id="2916099">methods</span><span class="op" id="2916106">[</span><span class="ident" id="2916107">i</span><span class="op" id="2916108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2916112">vm</span>&nbsp;<span class="op" id="2916115">:=</span>&nbsp;<span class="op" id="2916118">&amp;</span><span class="ident" id="2916119">v</span><span class="op" id="2916120">.</span><span class="ident" id="2916121">methods</span><span class="op" id="2916128">[</span><span class="ident" id="2916129">j</span><span class="op" id="2916130">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916134">if</span>&nbsp;<span class="ident" id="2916137">vm</span><span class="op" id="2916139">.</span><span class="ident" id="2916140">name</span>&nbsp;<span class="op" id="2916145">==</span>&nbsp;<span class="ident" id="2916148">tm</span><span class="op" id="2916150">.</span><span class="ident" id="2916151">name</span>&nbsp;<span class="op" id="2916156">&amp;&amp;</span>&nbsp;<span class="ident" id="2916159">vm</span><span class="op" id="2916161">.</span><span class="ident" id="2916162">pkgPath</span>&nbsp;<span class="op" id="2916170">==</span>&nbsp;<span class="ident" id="2916173">tm</span><span class="op" id="2916175">.</span><span class="ident" id="2916176">pkgPath</span>&nbsp;<span class="op" id="2916184">&amp;&amp;</span>&nbsp;<span class="ident" id="2916187">vm</span><span class="op" id="2916189">.</span><span class="ident" id="2916190">mtyp</span>&nbsp;<span class="op" id="2916195">==</span>&nbsp;<span class="ident" id="2916198">tm</span><span class="op" id="2916200">.</span><span class="ident" id="2916201">typ</span>&nbsp;<span class="op" id="2916205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916210">if</span>&nbsp;<span class="ident" id="2916213">i</span><span class="op" id="2916214">++</span><span class="op" id="2916216">;</span>&nbsp;<span class="ident" id="2916218">i</span>&nbsp;<span class="op" id="2916220">&gt;=</span>&nbsp;<span class="builtinfunc" id="2916223">len</span><span class="op" id="2916226">(</span><span class="ident" id="2916227">t</span><span class="op" id="2916228">.</span><span class="ident" id="2916229">methods</span><span class="op" id="2916236">)</span>&nbsp;<span class="op" id="2916238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916244">return</span>&nbsp;<span class="builtintype" id="2916251">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916263">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916269">return</span>&nbsp;<span class="builtintype" id="2916276">false</span><br>
<span class="lineno"></span><span class="op" id="2916282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2916285">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2916359">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2916409">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2916461">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2916517">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2916583">func</span>&nbsp;<span class="ident" id="2916588">directlyAssignable</span><span class="op" id="2916606">(</span><span class="ident" id="2916607">T</span><span class="op" id="2916608">,</span>&nbsp;<span class="ident" id="2916610">V</span>&nbsp;<span class="op" id="2916612">*</span><span class="ident" id="2916613">rtype</span><span class="op" id="2916618">)</span>&nbsp;<span class="builtintype" id="2916620">bool</span>&nbsp;<span class="op" id="2916625">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2916628">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916662">if</span>&nbsp;<span class="ident" id="2916665">T</span>&nbsp;<span class="op" id="2916667">==</span>&nbsp;<span class="ident" id="2916670">V</span>&nbsp;<span class="op" id="2916672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916676">return</span>&nbsp;<span class="builtintype" id="2916683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2916693">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2916747">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916785">if</span>&nbsp;<span class="ident" id="2916788">T</span><span class="op" id="2916789">.</span><span class="ident" id="2916790">Name</span><span class="op" id="2916794">(</span><span class="op" id="2916795">)</span>&nbsp;<span class="op" id="2916797">!=</span>&nbsp;<span class="string" id="2916800">&#34;&#34;</span>&nbsp;<span class="op" id="2916803">&amp;&amp;</span>&nbsp;<span class="ident" id="2916806">V</span><span class="op" id="2916807">.</span><span class="ident" id="2916808">Name</span><span class="op" id="2916812">(</span><span class="op" id="2916813">)</span>&nbsp;<span class="op" id="2916815">!=</span>&nbsp;<span class="string" id="2916818">&#34;&#34;</span>&nbsp;<span class="op" id="2916821">||</span>&nbsp;<span class="ident" id="2916824">T</span><span class="op" id="2916825">.</span><span class="ident" id="2916826">Kind</span><span class="op" id="2916830">(</span><span class="op" id="2916831">)</span>&nbsp;<span class="op" id="2916833">!=</span>&nbsp;<span class="ident" id="2916836">V</span><span class="op" id="2916837">.</span><span class="ident" id="2916838">Kind</span><span class="op" id="2916842">(</span><span class="op" id="2916843">)</span>&nbsp;<span class="op" id="2916845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916849">return</span>&nbsp;<span class="builtintype" id="2916856">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2916863">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2916867">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2916927">return</span>&nbsp;<span class="ident" id="2916934">haveIdenticalUnderlyingType</span><span class="op" id="2916961">(</span><span class="ident" id="2916962">T</span><span class="op" id="2916963">,</span>&nbsp;<span class="ident" id="2916965">V</span><span class="op" id="2916966">)</span><br>
<span class="lineno"></span><span class="op" id="2916968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2916971">func</span>&nbsp;<span class="ident" id="2916976">haveIdenticalUnderlyingType</span><span class="op" id="2917003">(</span><span class="ident" id="2917004">T</span><span class="op" id="2917005">,</span>&nbsp;<span class="ident" id="2917007">V</span>&nbsp;<span class="op" id="2917009">*</span><span class="ident" id="2917010">rtype</span><span class="op" id="2917015">)</span>&nbsp;<span class="builtintype" id="2917017">bool</span>&nbsp;<span class="op" id="2917022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917025">if</span>&nbsp;<span class="ident" id="2917028">T</span>&nbsp;<span class="op" id="2917030">==</span>&nbsp;<span class="ident" id="2917033">V</span>&nbsp;<span class="op" id="2917035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917039">return</span>&nbsp;<span class="builtintype" id="2917046">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2917052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2917056">kind</span>&nbsp;<span class="op" id="2917061">:=</span>&nbsp;<span class="ident" id="2917064">T</span><span class="op" id="2917065">.</span><span class="ident" id="2917066">Kind</span><span class="op" id="2917070">(</span><span class="op" id="2917071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917074">if</span>&nbsp;<span class="ident" id="2917077">kind</span>&nbsp;<span class="op" id="2917082">!=</span>&nbsp;<span class="ident" id="2917085">V</span><span class="op" id="2917086">.</span><span class="ident" id="2917087">Kind</span><span class="op" id="2917091">(</span><span class="op" id="2917092">)</span>&nbsp;<span class="op" id="2917094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917098">return</span>&nbsp;<span class="builtintype" id="2917105">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2917112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917116">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917180">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917223">if</span>&nbsp;<span class="ident" id="2917226">Bool</span>&nbsp;<span class="op" id="2917231">&lt;=</span>&nbsp;<span class="ident" id="2917234">kind</span>&nbsp;<span class="op" id="2917239">&amp;&amp;</span>&nbsp;<span class="ident" id="2917242">kind</span>&nbsp;<span class="op" id="2917247">&lt;=</span>&nbsp;<span class="ident" id="2917250">Complex128</span>&nbsp;<span class="op" id="2917261">||</span>&nbsp;<span class="ident" id="2917264">kind</span>&nbsp;<span class="op" id="2917269">==</span>&nbsp;<span class="ident" id="2917272">String</span>&nbsp;<span class="op" id="2917279">||</span>&nbsp;<span class="ident" id="2917282">kind</span>&nbsp;<span class="op" id="2917287">==</span>&nbsp;<span class="ident" id="2917290">UnsafePointer</span>&nbsp;<span class="op" id="2917304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917308">return</span>&nbsp;<span class="builtintype" id="2917315">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2917321">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917325">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917346">switch</span>&nbsp;<span class="ident" id="2917353">kind</span>&nbsp;<span class="op" id="2917358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917361">case</span>&nbsp;<span class="ident" id="2917366">Array</span><span class="op" id="2917371">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917375">return</span>&nbsp;<span class="ident" id="2917382">T</span><span class="op" id="2917383">.</span><span class="ident" id="2917384">Elem</span><span class="op" id="2917388">(</span><span class="op" id="2917389">)</span>&nbsp;<span class="op" id="2917391">==</span>&nbsp;<span class="ident" id="2917394">V</span><span class="op" id="2917395">.</span><span class="ident" id="2917396">Elem</span><span class="op" id="2917400">(</span><span class="op" id="2917401">)</span>&nbsp;<span class="op" id="2917403">&amp;&amp;</span>&nbsp;<span class="ident" id="2917406">T</span><span class="op" id="2917407">.</span><span class="ident" id="2917408">Len</span><span class="op" id="2917411">(</span><span class="op" id="2917412">)</span>&nbsp;<span class="op" id="2917414">==</span>&nbsp;<span class="ident" id="2917417">V</span><span class="op" id="2917418">.</span><span class="ident" id="2917419">Len</span><span class="op" id="2917422">(</span><span class="op" id="2917423">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917427">case</span>&nbsp;<span class="ident" id="2917432">Chan</span><span class="op" id="2917436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917440">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917459">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917521">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917577">if</span>&nbsp;<span class="ident" id="2917580">V</span><span class="op" id="2917581">.</span><span class="ident" id="2917582">ChanDir</span><span class="op" id="2917589">(</span><span class="op" id="2917590">)</span>&nbsp;<span class="op" id="2917592">==</span>&nbsp;<span class="ident" id="2917595">BothDir</span>&nbsp;<span class="op" id="2917603">&amp;&amp;</span>&nbsp;<span class="ident" id="2917606">T</span><span class="op" id="2917607">.</span><span class="ident" id="2917608">Elem</span><span class="op" id="2917612">(</span><span class="op" id="2917613">)</span>&nbsp;<span class="op" id="2917615">==</span>&nbsp;<span class="ident" id="2917618">V</span><span class="op" id="2917619">.</span><span class="ident" id="2917620">Elem</span><span class="op" id="2917624">(</span><span class="op" id="2917625">)</span>&nbsp;<span class="op" id="2917627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917632">return</span>&nbsp;<span class="builtintype" id="2917639">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2917646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2917651">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917711">return</span>&nbsp;<span class="ident" id="2917718">V</span><span class="op" id="2917719">.</span><span class="ident" id="2917720">ChanDir</span><span class="op" id="2917727">(</span><span class="op" id="2917728">)</span>&nbsp;<span class="op" id="2917730">==</span>&nbsp;<span class="ident" id="2917733">T</span><span class="op" id="2917734">.</span><span class="ident" id="2917735">ChanDir</span><span class="op" id="2917742">(</span><span class="op" id="2917743">)</span>&nbsp;<span class="op" id="2917745">&amp;&amp;</span>&nbsp;<span class="ident" id="2917748">T</span><span class="op" id="2917749">.</span><span class="ident" id="2917750">Elem</span><span class="op" id="2917754">(</span><span class="op" id="2917755">)</span>&nbsp;<span class="op" id="2917757">==</span>&nbsp;<span class="ident" id="2917760">V</span><span class="op" id="2917761">.</span><span class="ident" id="2917762">Elem</span><span class="op" id="2917766">(</span><span class="op" id="2917767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917771">case</span>&nbsp;<span class="ident" id="2917776">Func</span><span class="op" id="2917780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2917784">t</span>&nbsp;<span class="op" id="2917786">:=</span>&nbsp;<span class="op" id="2917789">(</span><span class="op" id="2917790">*</span><span class="ident" id="2917791">funcType</span><span class="op" id="2917799">)</span><span class="op" id="2917800">(</span><span class="ident" id="2917801">unsafe</span><span class="op" id="2917807">.</span><span class="ident" id="2917808">Pointer</span><span class="op" id="2917815">(</span><span class="ident" id="2917816">T</span><span class="op" id="2917817">)</span><span class="op" id="2917818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2917822">v</span>&nbsp;<span class="op" id="2917824">:=</span>&nbsp;<span class="op" id="2917827">(</span><span class="op" id="2917828">*</span><span class="ident" id="2917829">funcType</span><span class="op" id="2917837">)</span><span class="op" id="2917838">(</span><span class="ident" id="2917839">unsafe</span><span class="op" id="2917845">.</span><span class="ident" id="2917846">Pointer</span><span class="op" id="2917853">(</span><span class="ident" id="2917854">V</span><span class="op" id="2917855">)</span><span class="op" id="2917856">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917860">if</span>&nbsp;<span class="ident" id="2917863">t</span><span class="op" id="2917864">.</span><span class="ident" id="2917865">dotdotdot</span>&nbsp;<span class="op" id="2917875">!=</span>&nbsp;<span class="ident" id="2917878">v</span><span class="op" id="2917879">.</span><span class="ident" id="2917880">dotdotdot</span>&nbsp;<span class="op" id="2917890">||</span>&nbsp;<span class="builtinfunc" id="2917893">len</span><span class="op" id="2917896">(</span><span class="ident" id="2917897">t</span><span class="op" id="2917898">.</span><span class="ident" id="2917899">in</span><span class="op" id="2917901">)</span>&nbsp;<span class="op" id="2917903">!=</span>&nbsp;<span class="builtinfunc" id="2917906">len</span><span class="op" id="2917909">(</span><span class="ident" id="2917910">v</span><span class="op" id="2917911">.</span><span class="ident" id="2917912">in</span><span class="op" id="2917914">)</span>&nbsp;<span class="op" id="2917916">||</span>&nbsp;<span class="builtinfunc" id="2917919">len</span><span class="op" id="2917922">(</span><span class="ident" id="2917923">t</span><span class="op" id="2917924">.</span><span class="ident" id="2917925">out</span><span class="op" id="2917928">)</span>&nbsp;<span class="op" id="2917930">!=</span>&nbsp;<span class="builtinfunc" id="2917933">len</span><span class="op" id="2917936">(</span><span class="ident" id="2917937">v</span><span class="op" id="2917938">.</span><span class="ident" id="2917939">out</span><span class="op" id="2917942">)</span>&nbsp;<span class="op" id="2917944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917949">return</span>&nbsp;<span class="builtintype" id="2917956">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2917964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917968">for</span>&nbsp;<span class="ident" id="2917972">i</span><span class="op" id="2917973">,</span>&nbsp;<span class="ident" id="2917975">typ</span>&nbsp;<span class="op" id="2917979">:=</span>&nbsp;<span class="keyword" id="2917982">range</span>&nbsp;<span class="ident" id="2917988">t</span><span class="op" id="2917989">.</span><span class="ident" id="2917990">in</span>&nbsp;<span class="op" id="2917993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2917998">if</span>&nbsp;<span class="ident" id="2918001">typ</span>&nbsp;<span class="op" id="2918005">!=</span>&nbsp;<span class="ident" id="2918008">v</span><span class="op" id="2918009">.</span><span class="ident" id="2918010">in</span><span class="op" id="2918012">[</span><span class="ident" id="2918013">i</span><span class="op" id="2918014">]</span>&nbsp;<span class="op" id="2918016">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918022">return</span>&nbsp;<span class="builtintype" id="2918029">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918046">for</span>&nbsp;<span class="ident" id="2918050">i</span><span class="op" id="2918051">,</span>&nbsp;<span class="ident" id="2918053">typ</span>&nbsp;<span class="op" id="2918057">:=</span>&nbsp;<span class="keyword" id="2918060">range</span>&nbsp;<span class="ident" id="2918066">t</span><span class="op" id="2918067">.</span><span class="ident" id="2918068">out</span>&nbsp;<span class="op" id="2918072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918077">if</span>&nbsp;<span class="ident" id="2918080">typ</span>&nbsp;<span class="op" id="2918084">!=</span>&nbsp;<span class="ident" id="2918087">v</span><span class="op" id="2918088">.</span><span class="ident" id="2918089">out</span><span class="op" id="2918092">[</span><span class="ident" id="2918093">i</span><span class="op" id="2918094">]</span>&nbsp;<span class="op" id="2918096">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918102">return</span>&nbsp;<span class="builtintype" id="2918109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918126">return</span>&nbsp;<span class="builtintype" id="2918133">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918140">case</span>&nbsp;<span class="ident" id="2918145">Interface</span><span class="op" id="2918154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918158">t</span>&nbsp;<span class="op" id="2918160">:=</span>&nbsp;<span class="op" id="2918163">(</span><span class="op" id="2918164">*</span><span class="ident" id="2918165">interfaceType</span><span class="op" id="2918178">)</span><span class="op" id="2918179">(</span><span class="ident" id="2918180">unsafe</span><span class="op" id="2918186">.</span><span class="ident" id="2918187">Pointer</span><span class="op" id="2918194">(</span><span class="ident" id="2918195">T</span><span class="op" id="2918196">)</span><span class="op" id="2918197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918201">v</span>&nbsp;<span class="op" id="2918203">:=</span>&nbsp;<span class="op" id="2918206">(</span><span class="op" id="2918207">*</span><span class="ident" id="2918208">interfaceType</span><span class="op" id="2918221">)</span><span class="op" id="2918222">(</span><span class="ident" id="2918223">unsafe</span><span class="op" id="2918229">.</span><span class="ident" id="2918230">Pointer</span><span class="op" id="2918237">(</span><span class="ident" id="2918238">V</span><span class="op" id="2918239">)</span><span class="op" id="2918240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918244">if</span>&nbsp;<span class="builtinfunc" id="2918247">len</span><span class="op" id="2918250">(</span><span class="ident" id="2918251">t</span><span class="op" id="2918252">.</span><span class="ident" id="2918253">methods</span><span class="op" id="2918260">)</span>&nbsp;<span class="op" id="2918262">==</span>&nbsp;<span class="num" id="2918265">0</span>&nbsp;<span class="op" id="2918267">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2918270">len</span><span class="op" id="2918273">(</span><span class="ident" id="2918274">v</span><span class="op" id="2918275">.</span><span class="ident" id="2918276">methods</span><span class="op" id="2918283">)</span>&nbsp;<span class="op" id="2918285">==</span>&nbsp;<span class="num" id="2918288">0</span>&nbsp;<span class="op" id="2918290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918295">return</span>&nbsp;<span class="builtintype" id="2918302">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2918313">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2918356">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918389">return</span>&nbsp;<span class="builtintype" id="2918396">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918404">case</span>&nbsp;<span class="ident" id="2918409">Map</span><span class="op" id="2918412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918416">return</span>&nbsp;<span class="ident" id="2918423">T</span><span class="op" id="2918424">.</span><span class="ident" id="2918425">Key</span><span class="op" id="2918428">(</span><span class="op" id="2918429">)</span>&nbsp;<span class="op" id="2918431">==</span>&nbsp;<span class="ident" id="2918434">V</span><span class="op" id="2918435">.</span><span class="ident" id="2918436">Key</span><span class="op" id="2918439">(</span><span class="op" id="2918440">)</span>&nbsp;<span class="op" id="2918442">&amp;&amp;</span>&nbsp;<span class="ident" id="2918445">T</span><span class="op" id="2918446">.</span><span class="ident" id="2918447">Elem</span><span class="op" id="2918451">(</span><span class="op" id="2918452">)</span>&nbsp;<span class="op" id="2918454">==</span>&nbsp;<span class="ident" id="2918457">V</span><span class="op" id="2918458">.</span><span class="ident" id="2918459">Elem</span><span class="op" id="2918463">(</span><span class="op" id="2918464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918468">case</span>&nbsp;<span class="ident" id="2918473">Ptr</span><span class="op" id="2918476">,</span>&nbsp;<span class="ident" id="2918478">Slice</span><span class="op" id="2918483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918487">return</span>&nbsp;<span class="ident" id="2918494">T</span><span class="op" id="2918495">.</span><span class="ident" id="2918496">Elem</span><span class="op" id="2918500">(</span><span class="op" id="2918501">)</span>&nbsp;<span class="op" id="2918503">==</span>&nbsp;<span class="ident" id="2918506">V</span><span class="op" id="2918507">.</span><span class="ident" id="2918508">Elem</span><span class="op" id="2918512">(</span><span class="op" id="2918513">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918517">case</span>&nbsp;<span class="ident" id="2918522">Struct</span><span class="op" id="2918528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918532">t</span>&nbsp;<span class="op" id="2918534">:=</span>&nbsp;<span class="op" id="2918537">(</span><span class="op" id="2918538">*</span><span class="ident" id="2918539">structType</span><span class="op" id="2918549">)</span><span class="op" id="2918550">(</span><span class="ident" id="2918551">unsafe</span><span class="op" id="2918557">.</span><span class="ident" id="2918558">Pointer</span><span class="op" id="2918565">(</span><span class="ident" id="2918566">T</span><span class="op" id="2918567">)</span><span class="op" id="2918568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918572">v</span>&nbsp;<span class="op" id="2918574">:=</span>&nbsp;<span class="op" id="2918577">(</span><span class="op" id="2918578">*</span><span class="ident" id="2918579">structType</span><span class="op" id="2918589">)</span><span class="op" id="2918590">(</span><span class="ident" id="2918591">unsafe</span><span class="op" id="2918597">.</span><span class="ident" id="2918598">Pointer</span><span class="op" id="2918605">(</span><span class="ident" id="2918606">V</span><span class="op" id="2918607">)</span><span class="op" id="2918608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918612">if</span>&nbsp;<span class="builtinfunc" id="2918615">len</span><span class="op" id="2918618">(</span><span class="ident" id="2918619">t</span><span class="op" id="2918620">.</span><span class="ident" id="2918621">fields</span><span class="op" id="2918627">)</span>&nbsp;<span class="op" id="2918629">!=</span>&nbsp;<span class="builtinfunc" id="2918632">len</span><span class="op" id="2918635">(</span><span class="ident" id="2918636">v</span><span class="op" id="2918637">.</span><span class="ident" id="2918638">fields</span><span class="op" id="2918644">)</span>&nbsp;<span class="op" id="2918646">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918651">return</span>&nbsp;<span class="builtintype" id="2918658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918670">for</span>&nbsp;<span class="ident" id="2918674">i</span>&nbsp;<span class="op" id="2918676">:=</span>&nbsp;<span class="keyword" id="2918679">range</span>&nbsp;<span class="ident" id="2918685">t</span><span class="op" id="2918686">.</span><span class="ident" id="2918687">fields</span>&nbsp;<span class="op" id="2918694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918699">tf</span>&nbsp;<span class="op" id="2918702">:=</span>&nbsp;<span class="op" id="2918705">&amp;</span><span class="ident" id="2918706">t</span><span class="op" id="2918707">.</span><span class="ident" id="2918708">fields</span><span class="op" id="2918714">[</span><span class="ident" id="2918715">i</span><span class="op" id="2918716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2918721">vf</span>&nbsp;<span class="op" id="2918724">:=</span>&nbsp;<span class="op" id="2918727">&amp;</span><span class="ident" id="2918728">v</span><span class="op" id="2918729">.</span><span class="ident" id="2918730">fields</span><span class="op" id="2918736">[</span><span class="ident" id="2918737">i</span><span class="op" id="2918738">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918743">if</span>&nbsp;<span class="ident" id="2918746">tf</span><span class="op" id="2918748">.</span><span class="ident" id="2918749">name</span>&nbsp;<span class="op" id="2918754">!=</span>&nbsp;<span class="ident" id="2918757">vf</span><span class="op" id="2918759">.</span><span class="ident" id="2918760">name</span>&nbsp;<span class="op" id="2918765">&amp;&amp;</span>&nbsp;<span class="op" id="2918768">(</span><span class="ident" id="2918769">tf</span><span class="op" id="2918771">.</span><span class="ident" id="2918772">name</span>&nbsp;<span class="op" id="2918777">==</span>&nbsp;<span class="ident" id="2918780">nil</span>&nbsp;<span class="op" id="2918784">||</span>&nbsp;<span class="ident" id="2918787">vf</span><span class="op" id="2918789">.</span><span class="ident" id="2918790">name</span>&nbsp;<span class="op" id="2918795">==</span>&nbsp;<span class="ident" id="2918798">nil</span>&nbsp;<span class="op" id="2918802">||</span>&nbsp;<span class="op" id="2918805">*</span><span class="ident" id="2918806">tf</span><span class="op" id="2918808">.</span><span class="ident" id="2918809">name</span>&nbsp;<span class="op" id="2918814">!=</span>&nbsp;<span class="op" id="2918817">*</span><span class="ident" id="2918818">vf</span><span class="op" id="2918820">.</span><span class="ident" id="2918821">name</span><span class="op" id="2918825">)</span>&nbsp;<span class="op" id="2918827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918833">return</span>&nbsp;<span class="builtintype" id="2918840">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918854">if</span>&nbsp;<span class="ident" id="2918857">tf</span><span class="op" id="2918859">.</span><span class="ident" id="2918860">pkgPath</span>&nbsp;<span class="op" id="2918868">!=</span>&nbsp;<span class="ident" id="2918871">vf</span><span class="op" id="2918873">.</span><span class="ident" id="2918874">pkgPath</span>&nbsp;<span class="op" id="2918882">&amp;&amp;</span>&nbsp;<span class="op" id="2918885">(</span><span class="ident" id="2918886">tf</span><span class="op" id="2918888">.</span><span class="ident" id="2918889">pkgPath</span>&nbsp;<span class="op" id="2918897">==</span>&nbsp;<span class="ident" id="2918900">nil</span>&nbsp;<span class="op" id="2918904">||</span>&nbsp;<span class="ident" id="2918907">vf</span><span class="op" id="2918909">.</span><span class="ident" id="2918910">pkgPath</span>&nbsp;<span class="op" id="2918918">==</span>&nbsp;<span class="ident" id="2918921">nil</span>&nbsp;<span class="op" id="2918925">||</span>&nbsp;<span class="op" id="2918928">*</span><span class="ident" id="2918929">tf</span><span class="op" id="2918931">.</span><span class="ident" id="2918932">pkgPath</span>&nbsp;<span class="op" id="2918940">!=</span>&nbsp;<span class="op" id="2918943">*</span><span class="ident" id="2918944">vf</span><span class="op" id="2918946">.</span><span class="ident" id="2918947">pkgPath</span><span class="op" id="2918954">)</span>&nbsp;<span class="op" id="2918956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918962">return</span>&nbsp;<span class="builtintype" id="2918969">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2918978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2918983">if</span>&nbsp;<span class="ident" id="2918986">tf</span><span class="op" id="2918988">.</span><span class="ident" id="2918989">typ</span>&nbsp;<span class="op" id="2918993">!=</span>&nbsp;<span class="ident" id="2918996">vf</span><span class="op" id="2918998">.</span><span class="ident" id="2918999">typ</span>&nbsp;<span class="op" id="2919003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919009">return</span>&nbsp;<span class="builtintype" id="2919016">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2919025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919030">if</span>&nbsp;<span class="ident" id="2919033">tf</span><span class="op" id="2919035">.</span><span class="ident" id="2919036">tag</span>&nbsp;<span class="op" id="2919040">!=</span>&nbsp;<span class="ident" id="2919043">vf</span><span class="op" id="2919045">.</span><span class="ident" id="2919046">tag</span>&nbsp;<span class="op" id="2919050">&amp;&amp;</span>&nbsp;<span class="op" id="2919053">(</span><span class="ident" id="2919054">tf</span><span class="op" id="2919056">.</span><span class="ident" id="2919057">tag</span>&nbsp;<span class="op" id="2919061">==</span>&nbsp;<span class="ident" id="2919064">nil</span>&nbsp;<span class="op" id="2919068">||</span>&nbsp;<span class="ident" id="2919071">vf</span><span class="op" id="2919073">.</span><span class="ident" id="2919074">tag</span>&nbsp;<span class="op" id="2919078">==</span>&nbsp;<span class="ident" id="2919081">nil</span>&nbsp;<span class="op" id="2919085">||</span>&nbsp;<span class="op" id="2919088">*</span><span class="ident" id="2919089">tf</span><span class="op" id="2919091">.</span><span class="ident" id="2919092">tag</span>&nbsp;<span class="op" id="2919096">!=</span>&nbsp;<span class="op" id="2919099">*</span><span class="ident" id="2919100">vf</span><span class="op" id="2919102">.</span><span class="ident" id="2919103">tag</span><span class="op" id="2919106">)</span>&nbsp;<span class="op" id="2919108">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919114">return</span>&nbsp;<span class="builtintype" id="2919121">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2919130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919135">if</span>&nbsp;<span class="ident" id="2919138">tf</span><span class="op" id="2919140">.</span><span class="ident" id="2919141">offset</span>&nbsp;<span class="op" id="2919148">!=</span>&nbsp;<span class="ident" id="2919151">vf</span><span class="op" id="2919153">.</span><span class="ident" id="2919154">offset</span>&nbsp;<span class="op" id="2919161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919167">return</span>&nbsp;<span class="builtintype" id="2919174">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2919183">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2919187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919191">return</span>&nbsp;<span class="builtintype" id="2919198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2919204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2919208">return</span>&nbsp;<span class="builtintype" id="2919215">false</span><br>
<span class="lineno">1285</span><span class="op" id="2919221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2919224">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2919272">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2919343">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2919404">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2919463">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2919514">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2919567">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2919606">func</span>&nbsp;<span class="ident" id="2919611">typelinks</span><span class="op" id="2919620">(</span><span class="op" id="2919621">)</span>&nbsp;<span class="op" id="2919623">[</span><span class="op" id="2919624">]</span><span class="op" id="2919625">*</span><span class="ident" id="2919626">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2919633">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2919706">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2919742">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2919807">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2919863">func</span>&nbsp;<span class="ident" id="2919868">typesByString</span><span class="op" id="2919881">(</span><span class="ident" id="2919882">s</span>&nbsp;<span class="builtintype" id="2919884">string</span><span class="op" id="2919890">)</span>&nbsp;<span class="op" id="2919892">[</span><span class="op" id="2919893">]</span><span class="op" id="2919894">*</span><span class="ident" id="2919895">rtype</span>&nbsp;<span class="op" id="2919901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2919904">typ</span>&nbsp;<span class="op" id="2919908">:=</span>&nbsp;<span class="ident" id="2919911">typelinks</span><span class="op" id="2919920">(</span><span class="op" id="2919921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2919925">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2919997">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920077">i</span><span class="op" id="2920078">,</span>&nbsp;<span class="ident" id="2920080">j</span>&nbsp;<span class="op" id="2920082">:=</span>&nbsp;<span class="num" id="2920085">0</span><span class="op" id="2920086">,</span>&nbsp;<span class="builtinfunc" id="2920088">len</span><span class="op" id="2920091">(</span><span class="ident" id="2920092">typ</span><span class="op" id="2920095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2920098">for</span>&nbsp;<span class="ident" id="2920102">i</span>&nbsp;<span class="op" id="2920104">&lt;</span>&nbsp;<span class="ident" id="2920106">j</span>&nbsp;<span class="op" id="2920108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920112">h</span>&nbsp;<span class="op" id="2920114">:=</span>&nbsp;<span class="ident" id="2920117">i</span>&nbsp;<span class="op" id="2920119">+</span>&nbsp;<span class="op" id="2920121">(</span><span class="ident" id="2920122">j</span><span class="op" id="2920123">-</span><span class="ident" id="2920124">i</span><span class="op" id="2920125">)</span><span class="op" id="2920126">/</span><span class="num" id="2920127">2</span>&nbsp;<span class="comment" id="2920129">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920166">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2920183">if</span>&nbsp;<span class="op" id="2920186">!</span><span class="op" id="2920187">(</span><span class="op" id="2920188">*</span><span class="ident" id="2920189">typ</span><span class="op" id="2920192">[</span><span class="ident" id="2920193">h</span><span class="op" id="2920194">]</span><span class="op" id="2920195">.</span><span class="builtintype" id="2920196">string</span>&nbsp;<span class="op" id="2920203">&gt;=</span>&nbsp;<span class="ident" id="2920206">s</span><span class="op" id="2920207">)</span>&nbsp;<span class="op" id="2920209">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920214">i</span>&nbsp;<span class="op" id="2920216">=</span>&nbsp;<span class="ident" id="2920218">h</span>&nbsp;<span class="op" id="2920220">+</span>&nbsp;<span class="num" id="2920222">1</span>&nbsp;<span class="comment" id="2920224">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2920255">}</span>&nbsp;<span class="keyword" id="2920257">else</span>&nbsp;<span class="op" id="2920262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920267">j</span>&nbsp;<span class="op" id="2920269">=</span>&nbsp;<span class="ident" id="2920271">h</span>&nbsp;<span class="comment" id="2920273">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2920301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2920304">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920307">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920381">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920447">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920511">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920543">j</span>&nbsp;<span class="op" id="2920545">=</span>&nbsp;<span class="ident" id="2920547">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2920550">for</span>&nbsp;<span class="ident" id="2920554">j</span>&nbsp;<span class="op" id="2920556">&lt;</span>&nbsp;<span class="builtinfunc" id="2920558">len</span><span class="op" id="2920561">(</span><span class="ident" id="2920562">typ</span><span class="op" id="2920565">)</span>&nbsp;<span class="op" id="2920567">&amp;&amp;</span>&nbsp;<span class="op" id="2920570">*</span><span class="ident" id="2920571">typ</span><span class="op" id="2920574">[</span><span class="ident" id="2920575">j</span><span class="op" id="2920576">]</span><span class="op" id="2920577">.</span><span class="builtintype" id="2920578">string</span>&nbsp;<span class="op" id="2920585">==</span>&nbsp;<span class="ident" id="2920588">s</span>&nbsp;<span class="op" id="2920590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920594">j</span><span class="op" id="2920595">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2920599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2920603">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2920660">return</span>&nbsp;<span class="ident" id="2920667">typ</span><span class="op" id="2920670">[</span><span class="ident" id="2920671">i</span><span class="op" id="2920672">:</span><span class="ident" id="2920673">j</span><span class="op" id="2920674">]</span><br>
<span class="lineno"></span><span class="op" id="2920676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2920679">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2920741">var</span>&nbsp;<span class="ident" id="2920745">lookupCache</span>&nbsp;<span class="keyword" id="2920757">struct</span>&nbsp;<span class="op" id="2920764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920767">sync</span><span class="op" id="2920771">.</span><span class="ident" id="2920772">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2920781">m</span>&nbsp;<span class="keyword" id="2920783">map</span><span class="op" id="2920786">[</span><span class="ident" id="2920787">cacheKey</span><span class="op" id="2920795">]</span><span class="op" id="2920796">*</span><span class="ident" id="2920797">rtype</span><br>
<span class="lineno"></span><span class="op" id="2920803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2920806">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2920859">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2920920">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2920977">type</span>&nbsp;<span class="ident" id="2920982">cacheKey</span>&nbsp;<span class="keyword" id="2920991">struct</span>&nbsp;<span class="op" id="2920998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921001">kind</span>&nbsp;&nbsp;<span class="ident" id="2921007">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921013">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2921019">*</span><span class="ident" id="2921020">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921027">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2921033">*</span><span class="ident" id="2921034">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921041">extra</span>&nbsp;<span class="builtintype" id="2921047">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2921055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2921058">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2921123">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2921165">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2921214">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2921277">func</span>&nbsp;<span class="ident" id="2921282">cacheGet</span><span class="op" id="2921290">(</span><span class="ident" id="2921291">k</span>&nbsp;<span class="ident" id="2921293">cacheKey</span><span class="op" id="2921301">)</span>&nbsp;<span class="ident" id="2921303">Type</span>&nbsp;<span class="op" id="2921308">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921311">lookupCache</span><span class="op" id="2921322">.</span><span class="ident" id="2921323">RLock</span><span class="op" id="2921328">(</span><span class="op" id="2921329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921332">t</span>&nbsp;<span class="op" id="2921334">:=</span>&nbsp;<span class="ident" id="2921337">lookupCache</span><span class="op" id="2921348">.</span><span class="ident" id="2921349">m</span><span class="op" id="2921350">[</span><span class="ident" id="2921351">k</span><span class="op" id="2921352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921355">lookupCache</span><span class="op" id="2921366">.</span><span class="ident" id="2921367">RUnlock</span><span class="op" id="2921374">(</span><span class="op" id="2921375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921378">if</span>&nbsp;<span class="ident" id="2921381">t</span>&nbsp;<span class="op" id="2921383">!=</span>&nbsp;<span class="ident" id="2921386">nil</span>&nbsp;<span class="op" id="2921390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921394">return</span>&nbsp;<span class="ident" id="2921401">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2921404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921408">lookupCache</span><span class="op" id="2921419">.</span><span class="ident" id="2921420">Lock</span><span class="op" id="2921424">(</span><span class="op" id="2921425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921428">t</span>&nbsp;<span class="op" id="2921430">=</span>&nbsp;<span class="ident" id="2921432">lookupCache</span><span class="op" id="2921443">.</span><span class="ident" id="2921444">m</span><span class="op" id="2921445">[</span><span class="ident" id="2921446">k</span><span class="op" id="2921447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921450">if</span>&nbsp;<span class="ident" id="2921453">t</span>&nbsp;<span class="op" id="2921455">!=</span>&nbsp;<span class="ident" id="2921458">nil</span>&nbsp;<span class="op" id="2921462">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921466">lookupCache</span><span class="op" id="2921477">.</span><span class="ident" id="2921478">Unlock</span><span class="op" id="2921484">(</span><span class="op" id="2921485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921489">return</span>&nbsp;<span class="ident" id="2921496">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2921499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921503">if</span>&nbsp;<span class="ident" id="2921506">lookupCache</span><span class="op" id="2921517">.</span><span class="ident" id="2921518">m</span>&nbsp;<span class="op" id="2921520">==</span>&nbsp;<span class="ident" id="2921523">nil</span>&nbsp;<span class="op" id="2921527">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921531">lookupCache</span><span class="op" id="2921542">.</span><span class="ident" id="2921543">m</span>&nbsp;<span class="op" id="2921545">=</span>&nbsp;<span class="builtinfunc" id="2921547">make</span><span class="op" id="2921551">(</span><span class="keyword" id="2921552">map</span><span class="op" id="2921555">[</span><span class="ident" id="2921556">cacheKey</span><span class="op" id="2921564">]</span><span class="op" id="2921565">*</span><span class="ident" id="2921566">rtype</span><span class="op" id="2921571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2921574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921578">return</span>&nbsp;<span class="ident" id="2921585">nil</span><br>
<span class="lineno"></span><span class="op" id="2921589">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2921592">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2921659">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2921724">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2921758">func</span>&nbsp;<span class="ident" id="2921763">cachePut</span><span class="op" id="2921771">(</span><span class="ident" id="2921772">k</span>&nbsp;<span class="ident" id="2921774">cacheKey</span><span class="op" id="2921782">,</span>&nbsp;<span class="ident" id="2921784">t</span>&nbsp;<span class="op" id="2921786">*</span><span class="ident" id="2921787">rtype</span><span class="op" id="2921792">)</span>&nbsp;<span class="ident" id="2921794">Type</span>&nbsp;<span class="op" id="2921799">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921802">lookupCache</span><span class="op" id="2921813">.</span><span class="ident" id="2921814">m</span><span class="op" id="2921815">[</span><span class="ident" id="2921816">k</span><span class="op" id="2921817">]</span>&nbsp;<span class="op" id="2921819">=</span>&nbsp;<span class="ident" id="2921821">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2921824">lookupCache</span><span class="op" id="2921835">.</span><span class="ident" id="2921836">Unlock</span><span class="op" id="2921842">(</span><span class="op" id="2921843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2921846">return</span>&nbsp;<span class="ident" id="2921853">t</span><br>
<span class="lineno"></span><span class="op" id="2921855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2921858">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2921936">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2922015">//</span><br>
<span class="lineno"></span><span class="comment" id="2922018">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2922087">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2922152">func</span>&nbsp;<span class="ident" id="2922157">ChanOf</span><span class="op" id="2922163">(</span><span class="ident" id="2922164">dir</span>&nbsp;<span class="ident" id="2922168">ChanDir</span><span class="op" id="2922175">,</span>&nbsp;<span class="ident" id="2922177">t</span>&nbsp;<span class="ident" id="2922179">Type</span><span class="op" id="2922183">)</span>&nbsp;<span class="ident" id="2922185">Type</span>&nbsp;<span class="op" id="2922190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922193">typ</span>&nbsp;<span class="op" id="2922197">:=</span>&nbsp;<span class="ident" id="2922200">t</span><span class="op" id="2922201">.</span><span class="op" id="2922202">(</span><span class="op" id="2922203">*</span><span class="ident" id="2922204">rtype</span><span class="op" id="2922209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2922213">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922232">ckey</span>&nbsp;<span class="op" id="2922237">:=</span>&nbsp;<span class="ident" id="2922240">cacheKey</span><span class="op" id="2922248">{</span><span class="ident" id="2922249">Chan</span><span class="op" id="2922253">,</span>&nbsp;<span class="ident" id="2922255">typ</span><span class="op" id="2922258">,</span>&nbsp;<span class="ident" id="2922260">nil</span><span class="op" id="2922263">,</span>&nbsp;<span class="builtintype" id="2922265">uintptr</span><span class="op" id="2922272">(</span><span class="ident" id="2922273">dir</span><span class="op" id="2922276">)</span><span class="op" id="2922277">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922280">if</span>&nbsp;<span class="ident" id="2922283">ch</span>&nbsp;<span class="op" id="2922286">:=</span>&nbsp;<span class="ident" id="2922289">cacheGet</span><span class="op" id="2922297">(</span><span class="ident" id="2922298">ckey</span><span class="op" id="2922302">)</span><span class="op" id="2922303">;</span>&nbsp;<span class="ident" id="2922305">ch</span>&nbsp;<span class="op" id="2922308">!=</span>&nbsp;<span class="ident" id="2922311">nil</span>&nbsp;<span class="op" id="2922315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922319">return</span>&nbsp;<span class="ident" id="2922326">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2922330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2922334">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922402">if</span>&nbsp;<span class="ident" id="2922405">typ</span><span class="op" id="2922408">.</span><span class="ident" id="2922409">size</span>&nbsp;<span class="op" id="2922414">&gt;=</span>&nbsp;<span class="num" id="2922417">1</span><span class="op" id="2922418">&lt;&lt;</span><span class="num" id="2922420">16</span>&nbsp;<span class="op" id="2922423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922427">lookupCache</span><span class="op" id="2922438">.</span><span class="ident" id="2922439">Unlock</span><span class="op" id="2922445">(</span><span class="op" id="2922446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2922450">panic</span><span class="op" id="2922455">(</span><span class="string" id="2922456">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2922496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2922499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2922503">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2922528">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922575">var</span>&nbsp;<span class="ident" id="2922579">s</span>&nbsp;<span class="builtintype" id="2922581">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922589">switch</span>&nbsp;<span class="ident" id="2922596">dir</span>&nbsp;<span class="op" id="2922600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922603">default</span><span class="op" id="2922610">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922614">lookupCache</span><span class="op" id="2922625">.</span><span class="ident" id="2922626">Unlock</span><span class="op" id="2922632">(</span><span class="op" id="2922633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2922637">panic</span><span class="op" id="2922642">(</span><span class="string" id="2922643">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2922672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922675">case</span>&nbsp;<span class="ident" id="2922680">SendDir</span><span class="op" id="2922687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922691">s</span>&nbsp;<span class="op" id="2922693">=</span>&nbsp;<span class="string" id="2922695">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2922705">+</span>&nbsp;<span class="op" id="2922707">*</span><span class="ident" id="2922708">typ</span><span class="op" id="2922711">.</span><span class="builtintype" id="2922712">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922720">case</span>&nbsp;<span class="ident" id="2922725">RecvDir</span><span class="op" id="2922732">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922736">s</span>&nbsp;<span class="op" id="2922738">=</span>&nbsp;<span class="string" id="2922740">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2922750">+</span>&nbsp;<span class="op" id="2922752">*</span><span class="ident" id="2922753">typ</span><span class="op" id="2922756">.</span><span class="builtintype" id="2922757">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922765">case</span>&nbsp;<span class="ident" id="2922770">BothDir</span><span class="op" id="2922777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922781">s</span>&nbsp;<span class="op" id="2922783">=</span>&nbsp;<span class="string" id="2922785">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2922793">+</span>&nbsp;<span class="op" id="2922795">*</span><span class="ident" id="2922796">typ</span><span class="op" id="2922799">.</span><span class="builtintype" id="2922800">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2922808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922811">for</span>&nbsp;<span class="ident" id="2922815">_</span><span class="op" id="2922816">,</span>&nbsp;<span class="ident" id="2922818">tt</span>&nbsp;<span class="op" id="2922821">:=</span>&nbsp;<span class="keyword" id="2922824">range</span>&nbsp;<span class="ident" id="2922830">typesByString</span><span class="op" id="2922843">(</span><span class="ident" id="2922844">s</span><span class="op" id="2922845">)</span>&nbsp;<span class="op" id="2922847">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2922851">ch</span>&nbsp;<span class="op" id="2922854">:=</span>&nbsp;<span class="op" id="2922857">(</span><span class="op" id="2922858">*</span><span class="ident" id="2922859">chanType</span><span class="op" id="2922867">)</span><span class="op" id="2922868">(</span><span class="ident" id="2922869">unsafe</span><span class="op" id="2922875">.</span><span class="ident" id="2922876">Pointer</span><span class="op" id="2922883">(</span><span class="ident" id="2922884">tt</span><span class="op" id="2922886">)</span><span class="op" id="2922887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922891">if</span>&nbsp;<span class="ident" id="2922894">ch</span><span class="op" id="2922896">.</span><span class="ident" id="2922897">elem</span>&nbsp;<span class="op" id="2922902">==</span>&nbsp;<span class="ident" id="2922905">typ</span>&nbsp;<span class="op" id="2922909">&amp;&amp;</span>&nbsp;<span class="ident" id="2922912">ch</span><span class="op" id="2922914">.</span><span class="ident" id="2922915">dir</span>&nbsp;<span class="op" id="2922919">==</span>&nbsp;<span class="builtintype" id="2922922">uintptr</span><span class="op" id="2922929">(</span><span class="ident" id="2922930">dir</span><span class="op" id="2922933">)</span>&nbsp;<span class="op" id="2922935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2922940">return</span>&nbsp;<span class="ident" id="2922947">cachePut</span><span class="op" id="2922955">(</span><span class="ident" id="2922956">ckey</span><span class="op" id="2922960">,</span>&nbsp;<span class="ident" id="2922962">tt</span><span class="op" id="2922964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2922968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2922971">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2922975">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2923000">var</span>&nbsp;<span class="ident" id="2923004">ichan</span>&nbsp;<span class="keyword" id="2923010">interface</span><span class="op" id="2923019">{</span><span class="op" id="2923020">}</span>&nbsp;<span class="op" id="2923022">=</span>&nbsp;<span class="op" id="2923024">(</span><span class="keyword" id="2923025">chan</span>&nbsp;<span class="ident" id="2923030">unsafe</span><span class="op" id="2923036">.</span><span class="ident" id="2923037">Pointer</span><span class="op" id="2923044">)</span><span class="op" id="2923045">(</span><span class="ident" id="2923046">nil</span><span class="op" id="2923049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923052">prototype</span>&nbsp;<span class="op" id="2923062">:=</span>&nbsp;<span class="op" id="2923065">*</span><span class="op" id="2923066">(</span><span class="op" id="2923067">*</span><span class="op" id="2923068">*</span><span class="ident" id="2923069">chanType</span><span class="op" id="2923077">)</span><span class="op" id="2923078">(</span><span class="ident" id="2923079">unsafe</span><span class="op" id="2923085">.</span><span class="ident" id="2923086">Pointer</span><span class="op" id="2923093">(</span><span class="op" id="2923094">&amp;</span><span class="ident" id="2923095">ichan</span><span class="op" id="2923100">)</span><span class="op" id="2923101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923104">ch</span>&nbsp;<span class="op" id="2923107">:=</span>&nbsp;<span class="builtinfunc" id="2923110">new</span><span class="op" id="2923113">(</span><span class="ident" id="2923114">chanType</span><span class="op" id="2923122">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2923125">*</span><span class="ident" id="2923126">ch</span>&nbsp;<span class="op" id="2923129">=</span>&nbsp;<span class="op" id="2923131">*</span><span class="ident" id="2923132">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923143">ch</span><span class="op" id="2923145">.</span><span class="builtintype" id="2923146">string</span>&nbsp;<span class="op" id="2923153">=</span>&nbsp;<span class="op" id="2923155">&amp;</span><span class="ident" id="2923156">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923159">ch</span><span class="op" id="2923161">.</span><span class="ident" id="2923162">hash</span>&nbsp;<span class="op" id="2923167">=</span>&nbsp;<span class="ident" id="2923169">fnv1</span><span class="op" id="2923173">(</span><span class="ident" id="2923174">typ</span><span class="op" id="2923177">.</span><span class="ident" id="2923178">hash</span><span class="op" id="2923182">,</span>&nbsp;<span class="string" id="2923184">&#39;c&#39;</span><span class="op" id="2923187">,</span>&nbsp;<span class="builtintype" id="2923189">byte</span><span class="op" id="2923193">(</span><span class="ident" id="2923194">dir</span><span class="op" id="2923197">)</span><span class="op" id="2923198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923201">ch</span><span class="op" id="2923203">.</span><span class="ident" id="2923204">elem</span>&nbsp;<span class="op" id="2923209">=</span>&nbsp;<span class="ident" id="2923211">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923216">ch</span><span class="op" id="2923218">.</span><span class="ident" id="2923219">uncommonType</span>&nbsp;<span class="op" id="2923232">=</span>&nbsp;<span class="ident" id="2923234">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923239">ch</span><span class="op" id="2923241">.</span><span class="ident" id="2923242">ptrToThis</span>&nbsp;<span class="op" id="2923252">=</span>&nbsp;<span class="ident" id="2923254">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923259">ch</span><span class="op" id="2923261">.</span><span class="ident" id="2923262">zero</span>&nbsp;<span class="op" id="2923267">=</span>&nbsp;<span class="ident" id="2923269">unsafe</span><span class="op" id="2923275">.</span><span class="ident" id="2923276">Pointer</span><span class="op" id="2923283">(</span><span class="op" id="2923284">&amp;</span><span class="builtinfunc" id="2923285">make</span><span class="op" id="2923289">(</span><span class="op" id="2923290">[</span><span class="op" id="2923291">]</span><span class="builtintype" id="2923292">byte</span><span class="op" id="2923296">,</span>&nbsp;<span class="ident" id="2923298">ch</span><span class="op" id="2923300">.</span><span class="ident" id="2923301">size</span><span class="op" id="2923305">)</span><span class="op" id="2923306">[</span><span class="num" id="2923307">0</span><span class="op" id="2923308">]</span><span class="op" id="2923309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2923313">return</span>&nbsp;<span class="ident" id="2923320">cachePut</span><span class="op" id="2923328">(</span><span class="ident" id="2923329">ckey</span><span class="op" id="2923333">,</span>&nbsp;<span class="op" id="2923335">&amp;</span><span class="ident" id="2923336">ch</span><span class="op" id="2923338">.</span><span class="ident" id="2923339">rtype</span><span class="op" id="2923344">)</span><br>
<span class="lineno"></span><span class="op" id="2923346">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2923349">func</span>&nbsp;<span class="ident" id="2923354">ismapkey</span><span class="op" id="2923362">(</span><span class="op" id="2923363">*</span><span class="ident" id="2923364">rtype</span><span class="op" id="2923369">)</span>&nbsp;<span class="builtintype" id="2923371">bool</span>&nbsp;<span class="comment" id="2923376">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2923403">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2923471">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2923532">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2923574">//</span><br>
<span class="lineno"></span><span class="comment" id="2923577">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2923645">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2923695">func</span>&nbsp;<span class="ident" id="2923700">MapOf</span><span class="op" id="2923705">(</span><span class="ident" id="2923706">key</span><span class="op" id="2923709">,</span>&nbsp;<span class="ident" id="2923711">elem</span>&nbsp;<span class="ident" id="2923716">Type</span><span class="op" id="2923720">)</span>&nbsp;<span class="ident" id="2923722">Type</span>&nbsp;<span class="op" id="2923727">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923730">ktyp</span>&nbsp;<span class="op" id="2923735">:=</span>&nbsp;<span class="ident" id="2923738">key</span><span class="op" id="2923741">.</span><span class="op" id="2923742">(</span><span class="op" id="2923743">*</span><span class="ident" id="2923744">rtype</span><span class="op" id="2923749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923752">etyp</span>&nbsp;<span class="op" id="2923757">:=</span>&nbsp;<span class="ident" id="2923760">elem</span><span class="op" id="2923764">.</span><span class="op" id="2923765">(</span><span class="op" id="2923766">*</span><span class="ident" id="2923767">rtype</span><span class="op" id="2923772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2923776">if</span>&nbsp;<span class="op" id="2923779">!</span><span class="ident" id="2923780">ismapkey</span><span class="op" id="2923788">(</span><span class="ident" id="2923789">ktyp</span><span class="op" id="2923793">)</span>&nbsp;<span class="op" id="2923795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2923799">panic</span><span class="op" id="2923804">(</span><span class="string" id="2923805">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2923840">+</span>&nbsp;<span class="ident" id="2923842">ktyp</span><span class="op" id="2923846">.</span><span class="ident" id="2923847">String</span><span class="op" id="2923853">(</span><span class="op" id="2923854">)</span><span class="op" id="2923855">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2923858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2923862">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923881">ckey</span>&nbsp;<span class="op" id="2923886">:=</span>&nbsp;<span class="ident" id="2923889">cacheKey</span><span class="op" id="2923897">{</span><span class="ident" id="2923898">Map</span><span class="op" id="2923901">,</span>&nbsp;<span class="ident" id="2923903">ktyp</span><span class="op" id="2923907">,</span>&nbsp;<span class="ident" id="2923909">etyp</span><span class="op" id="2923913">,</span>&nbsp;<span class="num" id="2923915">0</span><span class="op" id="2923916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2923919">if</span>&nbsp;<span class="ident" id="2923922">mt</span>&nbsp;<span class="op" id="2923925">:=</span>&nbsp;<span class="ident" id="2923928">cacheGet</span><span class="op" id="2923936">(</span><span class="ident" id="2923937">ckey</span><span class="op" id="2923941">)</span><span class="op" id="2923942">;</span>&nbsp;<span class="ident" id="2923944">mt</span>&nbsp;<span class="op" id="2923947">!=</span>&nbsp;<span class="ident" id="2923950">nil</span>&nbsp;<span class="op" id="2923954">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2923958">return</span>&nbsp;<span class="ident" id="2923965">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2923969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2923973">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2923998">s</span>&nbsp;<span class="op" id="2924000">:=</span>&nbsp;<span class="string" id="2924003">&#34;map[&#34;</span>&nbsp;<span class="op" id="2924010">+</span>&nbsp;<span class="op" id="2924012">*</span><span class="ident" id="2924013">ktyp</span><span class="op" id="2924017">.</span><span class="builtintype" id="2924018">string</span>&nbsp;<span class="op" id="2924025">+</span>&nbsp;<span class="string" id="2924027">&#34;]&#34;</span>&nbsp;<span class="op" id="2924031">+</span>&nbsp;<span class="op" id="2924033">*</span><span class="ident" id="2924034">etyp</span><span class="op" id="2924038">.</span><span class="builtintype" id="2924039">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924047">for</span>&nbsp;<span class="ident" id="2924051">_</span><span class="op" id="2924052">,</span>&nbsp;<span class="ident" id="2924054">tt</span>&nbsp;<span class="op" id="2924057">:=</span>&nbsp;<span class="keyword" id="2924060">range</span>&nbsp;<span class="ident" id="2924066">typesByString</span><span class="op" id="2924079">(</span><span class="ident" id="2924080">s</span><span class="op" id="2924081">)</span>&nbsp;<span class="op" id="2924083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924087">mt</span>&nbsp;<span class="op" id="2924090">:=</span>&nbsp;<span class="op" id="2924093">(</span><span class="op" id="2924094">*</span><span class="ident" id="2924095">mapType</span><span class="op" id="2924102">)</span><span class="op" id="2924103">(</span><span class="ident" id="2924104">unsafe</span><span class="op" id="2924110">.</span><span class="ident" id="2924111">Pointer</span><span class="op" id="2924118">(</span><span class="ident" id="2924119">tt</span><span class="op" id="2924121">)</span><span class="op" id="2924122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924126">if</span>&nbsp;<span class="ident" id="2924129">mt</span><span class="op" id="2924131">.</span><span class="ident" id="2924132">key</span>&nbsp;<span class="op" id="2924136">==</span>&nbsp;<span class="ident" id="2924139">ktyp</span>&nbsp;<span class="op" id="2924144">&amp;&amp;</span>&nbsp;<span class="ident" id="2924147">mt</span><span class="op" id="2924149">.</span><span class="ident" id="2924150">elem</span>&nbsp;<span class="op" id="2924155">==</span>&nbsp;<span class="ident" id="2924158">etyp</span>&nbsp;<span class="op" id="2924163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924168">return</span>&nbsp;<span class="ident" id="2924175">cachePut</span><span class="op" id="2924183">(</span><span class="ident" id="2924184">ckey</span><span class="op" id="2924188">,</span>&nbsp;<span class="ident" id="2924190">tt</span><span class="op" id="2924192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924196">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2924203">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924224">var</span>&nbsp;<span class="ident" id="2924228">imap</span>&nbsp;<span class="keyword" id="2924233">interface</span><span class="op" id="2924242">{</span><span class="op" id="2924243">}</span>&nbsp;<span class="op" id="2924245">=</span>&nbsp;<span class="op" id="2924247">(</span><span class="keyword" id="2924248">map</span><span class="op" id="2924251">[</span><span class="ident" id="2924252">unsafe</span><span class="op" id="2924258">.</span><span class="ident" id="2924259">Pointer</span><span class="op" id="2924266">]</span><span class="ident" id="2924267">unsafe</span><span class="op" id="2924273">.</span><span class="ident" id="2924274">Pointer</span><span class="op" id="2924281">)</span><span class="op" id="2924282">(</span><span class="ident" id="2924283">nil</span><span class="op" id="2924286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924289">prototype</span>&nbsp;<span class="op" id="2924299">:=</span>&nbsp;<span class="op" id="2924302">*</span><span class="op" id="2924303">(</span><span class="op" id="2924304">*</span><span class="op" id="2924305">*</span><span class="ident" id="2924306">mapType</span><span class="op" id="2924313">)</span><span class="op" id="2924314">(</span><span class="ident" id="2924315">unsafe</span><span class="op" id="2924321">.</span><span class="ident" id="2924322">Pointer</span><span class="op" id="2924329">(</span><span class="op" id="2924330">&amp;</span><span class="ident" id="2924331">imap</span><span class="op" id="2924335">)</span><span class="op" id="2924336">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924339">mt</span>&nbsp;<span class="op" id="2924342">:=</span>&nbsp;<span class="builtinfunc" id="2924345">new</span><span class="op" id="2924348">(</span><span class="ident" id="2924349">mapType</span><span class="op" id="2924356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924359">*</span><span class="ident" id="2924360">mt</span>&nbsp;<span class="op" id="2924363">=</span>&nbsp;<span class="op" id="2924365">*</span><span class="ident" id="2924366">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924377">mt</span><span class="op" id="2924379">.</span><span class="builtintype" id="2924380">string</span>&nbsp;<span class="op" id="2924387">=</span>&nbsp;<span class="op" id="2924389">&amp;</span><span class="ident" id="2924390">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924393">mt</span><span class="op" id="2924395">.</span><span class="ident" id="2924396">hash</span>&nbsp;<span class="op" id="2924401">=</span>&nbsp;<span class="ident" id="2924403">fnv1</span><span class="op" id="2924407">(</span><span class="ident" id="2924408">etyp</span><span class="op" id="2924412">.</span><span class="ident" id="2924413">hash</span><span class="op" id="2924417">,</span>&nbsp;<span class="string" id="2924419">&#39;m&#39;</span><span class="op" id="2924422">,</span>&nbsp;<span class="builtintype" id="2924424">byte</span><span class="op" id="2924428">(</span><span class="ident" id="2924429">ktyp</span><span class="op" id="2924433">.</span><span class="ident" id="2924434">hash</span><span class="op" id="2924438">&gt;&gt;</span><span class="num" id="2924440">24</span><span class="op" id="2924442">)</span><span class="op" id="2924443">,</span>&nbsp;<span class="builtintype" id="2924445">byte</span><span class="op" id="2924449">(</span><span class="ident" id="2924450">ktyp</span><span class="op" id="2924454">.</span><span class="ident" id="2924455">hash</span><span class="op" id="2924459">&gt;&gt;</span><span class="num" id="2924461">16</span><span class="op" id="2924463">)</span><span class="op" id="2924464">,</span>&nbsp;<span class="builtintype" id="2924466">byte</span><span class="op" id="2924470">(</span><span class="ident" id="2924471">ktyp</span><span class="op" id="2924475">.</span><span class="ident" id="2924476">hash</span><span class="op" id="2924480">&gt;&gt;</span><span class="num" id="2924482">8</span><span class="op" id="2924483">)</span><span class="op" id="2924484">,</span>&nbsp;<span class="builtintype" id="2924486">byte</span><span class="op" id="2924490">(</span><span class="ident" id="2924491">ktyp</span><span class="op" id="2924495">.</span><span class="ident" id="2924496">hash</span><span class="op" id="2924500">)</span><span class="op" id="2924501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924504">mt</span><span class="op" id="2924506">.</span><span class="ident" id="2924507">key</span>&nbsp;<span class="op" id="2924511">=</span>&nbsp;<span class="ident" id="2924513">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924519">mt</span><span class="op" id="2924521">.</span><span class="ident" id="2924522">elem</span>&nbsp;<span class="op" id="2924527">=</span>&nbsp;<span class="ident" id="2924529">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924535">mt</span><span class="op" id="2924537">.</span><span class="ident" id="2924538">bucket</span>&nbsp;<span class="op" id="2924545">=</span>&nbsp;<span class="ident" id="2924547">bucketOf</span><span class="op" id="2924555">(</span><span class="ident" id="2924556">ktyp</span><span class="op" id="2924560">,</span>&nbsp;<span class="ident" id="2924562">etyp</span><span class="op" id="2924566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924569">if</span>&nbsp;<span class="ident" id="2924572">ktyp</span><span class="op" id="2924576">.</span><span class="ident" id="2924577">size</span>&nbsp;<span class="op" id="2924582">&gt;</span>&nbsp;<span class="ident" id="2924584">maxKeySize</span>&nbsp;<span class="op" id="2924595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924599">mt</span><span class="op" id="2924601">.</span><span class="ident" id="2924602">keysize</span>&nbsp;<span class="op" id="2924610">=</span>&nbsp;<span class="builtintype" id="2924612">uint8</span><span class="op" id="2924617">(</span><span class="ident" id="2924618">ptrSize</span><span class="op" id="2924625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924629">mt</span><span class="op" id="2924631">.</span><span class="ident" id="2924632">indirectkey</span>&nbsp;<span class="op" id="2924644">=</span>&nbsp;<span class="num" id="2924646">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924649">}</span>&nbsp;<span class="keyword" id="2924651">else</span>&nbsp;<span class="op" id="2924656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924660">mt</span><span class="op" id="2924662">.</span><span class="ident" id="2924663">keysize</span>&nbsp;<span class="op" id="2924671">=</span>&nbsp;<span class="builtintype" id="2924673">uint8</span><span class="op" id="2924678">(</span><span class="ident" id="2924679">ktyp</span><span class="op" id="2924683">.</span><span class="ident" id="2924684">size</span><span class="op" id="2924688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924692">mt</span><span class="op" id="2924694">.</span><span class="ident" id="2924695">indirectkey</span>&nbsp;<span class="op" id="2924707">=</span>&nbsp;<span class="num" id="2924709">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2924715">if</span>&nbsp;<span class="ident" id="2924718">etyp</span><span class="op" id="2924722">.</span><span class="ident" id="2924723">size</span>&nbsp;<span class="op" id="2924728">&gt;</span>&nbsp;<span class="ident" id="2924730">maxValSize</span>&nbsp;<span class="op" id="2924741">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924745">mt</span><span class="op" id="2924747">.</span><span class="ident" id="2924748">valuesize</span>&nbsp;<span class="op" id="2924758">=</span>&nbsp;<span class="builtintype" id="2924760">uint8</span><span class="op" id="2924765">(</span><span class="ident" id="2924766">ptrSize</span><span class="op" id="2924773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924777">mt</span><span class="op" id="2924779">.</span><span class="ident" id="2924780">indirectvalue</span>&nbsp;<span class="op" id="2924794">=</span>&nbsp;<span class="num" id="2924796">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924799">}</span>&nbsp;<span class="keyword" id="2924801">else</span>&nbsp;<span class="op" id="2924806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924810">mt</span><span class="op" id="2924812">.</span><span class="ident" id="2924813">valuesize</span>&nbsp;<span class="op" id="2924823">=</span>&nbsp;<span class="builtintype" id="2924825">uint8</span><span class="op" id="2924830">(</span><span class="ident" id="2924831">etyp</span><span class="op" id="2924835">.</span><span class="ident" id="2924836">size</span><span class="op" id="2924840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924844">mt</span><span class="op" id="2924846">.</span><span class="ident" id="2924847">indirectvalue</span>&nbsp;<span class="op" id="2924861">=</span>&nbsp;<span class="num" id="2924863">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2924866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924869">mt</span><span class="op" id="2924871">.</span><span class="ident" id="2924872">bucketsize</span>&nbsp;<span class="op" id="2924883">=</span>&nbsp;<span class="builtintype" id="2924885">uint16</span><span class="op" id="2924891">(</span><span class="ident" id="2924892">mt</span><span class="op" id="2924894">.</span><span class="ident" id="2924895">bucket</span><span class="op" id="2924901">.</span><span class="ident" id="2924902">size</span><span class="op" id="2924906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924909">mt</span><span class="op" id="2924911">.</span><span class="ident" id="2924912">uncommonType</span>&nbsp;<span class="op" id="2924925">=</span>&nbsp;<span class="ident" id="2924927">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924932">mt</span><span class="op" id="2924934">.</span><span class="ident" id="2924935">ptrToThis</span>&nbsp;<span class="op" id="2924945">=</span>&nbsp;<span class="ident" id="2924947">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2924952">mt</span><span class="op" id="2924954">.</span><span class="ident" id="2924955">zero</span>&nbsp;<span class="op" id="2924960">=</span>&nbsp;<span class="ident" id="2924962">unsafe</span><span class="op" id="2924968">.</span><span class="ident" id="2924969">Pointer</span><span class="op" id="2924976">(</span><span class="op" id="2924977">&amp;</span><span class="builtinfunc" id="2924978">make</span><span class="op" id="2924982">(</span><span class="op" id="2924983">[</span><span class="op" id="2924984">]</span><span class="builtintype" id="2924985">byte</span><span class="op" id="2924989">,</span>&nbsp;<span class="ident" id="2924991">mt</span><span class="op" id="2924993">.</span><span class="ident" id="2924994">size</span><span class="op" id="2924998">)</span><span class="op" id="2924999">[</span><span class="num" id="2925000">0</span><span class="op" id="2925001">]</span><span class="op" id="2925002">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925006">return</span>&nbsp;<span class="ident" id="2925013">cachePut</span><span class="op" id="2925021">(</span><span class="ident" id="2925022">ckey</span><span class="op" id="2925026">,</span>&nbsp;<span class="op" id="2925028">&amp;</span><span class="ident" id="2925029">mt</span><span class="op" id="2925031">.</span><span class="ident" id="2925032">rtype</span><span class="op" id="2925037">)</span><br>
<span class="lineno"></span><span class="op" id="2925039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2925042">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2925106">type</span>&nbsp;<span class="ident" id="2925111">gcProg</span>&nbsp;<span class="keyword" id="2925118">struct</span>&nbsp;<span class="op" id="2925125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925128">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2925133">[</span><span class="op" id="2925134">]</span><span class="builtintype" id="2925135">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925141">size</span>&nbsp;<span class="builtintype" id="2925146">uintptr</span>&nbsp;<span class="comment" id="2925154">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2925179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2925182">func</span>&nbsp;<span class="op" id="2925187">(</span><span class="ident" id="2925188">gc</span>&nbsp;<span class="op" id="2925191">*</span><span class="ident" id="2925192">gcProg</span><span class="op" id="2925198">)</span>&nbsp;<span class="builtinfunc" id="2925200">append</span><span class="op" id="2925206">(</span><span class="ident" id="2925207">v</span>&nbsp;<span class="builtintype" id="2925209">byte</span><span class="op" id="2925213">)</span>&nbsp;<span class="op" id="2925215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925218">gc</span><span class="op" id="2925220">.</span><span class="ident" id="2925221">align</span><span class="op" id="2925226">(</span><span class="ident" id="2925227">unsafe</span><span class="op" id="2925233">.</span><span class="ident" id="2925234">Sizeof</span><span class="op" id="2925240">(</span><span class="builtintype" id="2925241">uintptr</span><span class="op" id="2925248">(</span><span class="num" id="2925249">0</span><span class="op" id="2925250">)</span><span class="op" id="2925251">)</span><span class="op" id="2925252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925255">gc</span><span class="op" id="2925257">.</span><span class="ident" id="2925258">appendWord</span><span class="op" id="2925268">(</span><span class="ident" id="2925269">v</span><span class="op" id="2925270">)</span><br>
<span class="lineno"></span><span class="op" id="2925272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2925275">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2925324">func</span>&nbsp;<span class="op" id="2925329">(</span><span class="ident" id="2925330">gc</span>&nbsp;<span class="op" id="2925333">*</span><span class="ident" id="2925334">gcProg</span><span class="op" id="2925340">)</span>&nbsp;<span class="ident" id="2925342">appendProg</span><span class="op" id="2925352">(</span><span class="ident" id="2925353">t</span>&nbsp;<span class="op" id="2925355">*</span><span class="ident" id="2925356">rtype</span><span class="op" id="2925361">)</span>&nbsp;<span class="op" id="2925363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925366">gc</span><span class="op" id="2925368">.</span><span class="ident" id="2925369">align</span><span class="op" id="2925374">(</span><span class="builtintype" id="2925375">uintptr</span><span class="op" id="2925382">(</span><span class="ident" id="2925383">t</span><span class="op" id="2925384">.</span><span class="ident" id="2925385">align</span><span class="op" id="2925390">)</span><span class="op" id="2925391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925394">if</span>&nbsp;<span class="op" id="2925397">!</span><span class="ident" id="2925398">t</span><span class="op" id="2925399">.</span><span class="ident" id="2925400">pointers</span><span class="op" id="2925408">(</span><span class="op" id="2925409">)</span>&nbsp;<span class="op" id="2925411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925415">gc</span><span class="op" id="2925417">.</span><span class="ident" id="2925418">size</span>&nbsp;<span class="op" id="2925423">+=</span>&nbsp;<span class="ident" id="2925426">t</span><span class="op" id="2925427">.</span><span class="ident" id="2925428">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925435">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2925443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925446">switch</span>&nbsp;<span class="ident" id="2925453">t</span><span class="op" id="2925454">.</span><span class="ident" id="2925455">Kind</span><span class="op" id="2925459">(</span><span class="op" id="2925460">)</span>&nbsp;<span class="op" id="2925462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925465">default</span><span class="op" id="2925472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2925476">panic</span><span class="op" id="2925481">(</span><span class="string" id="2925482">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2925535">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925538">case</span>&nbsp;<span class="ident" id="2925543">Ptr</span><span class="op" id="2925546">,</span>&nbsp;<span class="ident" id="2925548">UnsafePointer</span><span class="op" id="2925561">,</span>&nbsp;<span class="ident" id="2925563">Chan</span><span class="op" id="2925567">,</span>&nbsp;<span class="ident" id="2925569">Func</span><span class="op" id="2925573">,</span>&nbsp;<span class="ident" id="2925575">Map</span><span class="op" id="2925578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925582">gc</span><span class="op" id="2925584">.</span><span class="ident" id="2925585">appendWord</span><span class="op" id="2925595">(</span><span class="ident" id="2925596">bitsPointer</span><span class="op" id="2925607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925610">case</span>&nbsp;<span class="ident" id="2925615">Slice</span><span class="op" id="2925620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925624">gc</span><span class="op" id="2925626">.</span><span class="ident" id="2925627">appendWord</span><span class="op" id="2925637">(</span><span class="ident" id="2925638">bitsPointer</span><span class="op" id="2925649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925653">gc</span><span class="op" id="2925655">.</span><span class="ident" id="2925656">appendWord</span><span class="op" id="2925666">(</span><span class="ident" id="2925667">bitsScalar</span><span class="op" id="2925677">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925681">gc</span><span class="op" id="2925683">.</span><span class="ident" id="2925684">appendWord</span><span class="op" id="2925694">(</span><span class="ident" id="2925695">bitsScalar</span><span class="op" id="2925705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925708">case</span>&nbsp;<span class="ident" id="2925713">String</span><span class="op" id="2925719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925723">gc</span><span class="op" id="2925725">.</span><span class="ident" id="2925726">appendWord</span><span class="op" id="2925736">(</span><span class="ident" id="2925737">bitsPointer</span><span class="op" id="2925748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925752">gc</span><span class="op" id="2925754">.</span><span class="ident" id="2925755">appendWord</span><span class="op" id="2925765">(</span><span class="ident" id="2925766">bitsScalar</span><span class="op" id="2925776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925779">case</span>&nbsp;<span class="ident" id="2925784">Array</span><span class="op" id="2925789">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925793">c</span>&nbsp;<span class="op" id="2925795">:=</span>&nbsp;<span class="ident" id="2925798">t</span><span class="op" id="2925799">.</span><span class="ident" id="2925800">Len</span><span class="op" id="2925803">(</span><span class="op" id="2925804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925808">e</span>&nbsp;<span class="op" id="2925810">:=</span>&nbsp;<span class="ident" id="2925813">t</span><span class="op" id="2925814">.</span><span class="ident" id="2925815">Elem</span><span class="op" id="2925819">(</span><span class="op" id="2925820">)</span><span class="op" id="2925821">.</span><span class="ident" id="2925822">common</span><span class="op" id="2925828">(</span><span class="op" id="2925829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925833">for</span>&nbsp;<span class="ident" id="2925837">i</span>&nbsp;<span class="op" id="2925839">:=</span>&nbsp;<span class="num" id="2925842">0</span><span class="op" id="2925843">;</span>&nbsp;<span class="ident" id="2925845">i</span>&nbsp;<span class="op" id="2925847">&lt;</span>&nbsp;<span class="ident" id="2925849">c</span><span class="op" id="2925850">;</span>&nbsp;<span class="ident" id="2925852">i</span><span class="op" id="2925853">++</span>&nbsp;<span class="op" id="2925856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925861">gc</span><span class="op" id="2925863">.</span><span class="ident" id="2925864">appendProg</span><span class="op" id="2925874">(</span><span class="ident" id="2925875">e</span><span class="op" id="2925876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2925880">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925883">case</span>&nbsp;<span class="ident" id="2925888">Interface</span><span class="op" id="2925897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925901">gc</span><span class="op" id="2925903">.</span><span class="ident" id="2925904">appendWord</span><span class="op" id="2925914">(</span><span class="ident" id="2925915">bitsMultiWord</span><span class="op" id="2925928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2925932">if</span>&nbsp;<span class="ident" id="2925935">t</span><span class="op" id="2925936">.</span><span class="ident" id="2925937">NumMethod</span><span class="op" id="2925946">(</span><span class="op" id="2925947">)</span>&nbsp;<span class="op" id="2925949">==</span>&nbsp;<span class="num" id="2925952">0</span>&nbsp;<span class="op" id="2925954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925959">gc</span><span class="op" id="2925961">.</span><span class="ident" id="2925962">appendWord</span><span class="op" id="2925972">(</span><span class="ident" id="2925973">bitsEface</span><span class="op" id="2925982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2925986">}</span>&nbsp;<span class="keyword" id="2925988">else</span>&nbsp;<span class="op" id="2925993">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2925998">gc</span><span class="op" id="2926000">.</span><span class="ident" id="2926001">appendWord</span><span class="op" id="2926011">(</span><span class="ident" id="2926012">bitsIface</span><span class="op" id="2926021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926028">case</span>&nbsp;<span class="ident" id="2926033">Struct</span><span class="op" id="2926039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926043">c</span>&nbsp;<span class="op" id="2926045">:=</span>&nbsp;<span class="ident" id="2926048">t</span><span class="op" id="2926049">.</span><span class="ident" id="2926050">NumField</span><span class="op" id="2926058">(</span><span class="op" id="2926059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926063">for</span>&nbsp;<span class="ident" id="2926067">i</span>&nbsp;<span class="op" id="2926069">:=</span>&nbsp;<span class="num" id="2926072">0</span><span class="op" id="2926073">;</span>&nbsp;<span class="ident" id="2926075">i</span>&nbsp;<span class="op" id="2926077">&lt;</span>&nbsp;<span class="ident" id="2926079">c</span><span class="op" id="2926080">;</span>&nbsp;<span class="ident" id="2926082">i</span><span class="op" id="2926083">++</span>&nbsp;<span class="op" id="2926086">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926091">gc</span><span class="op" id="2926093">.</span><span class="ident" id="2926094">appendProg</span><span class="op" id="2926104">(</span><span class="ident" id="2926105">t</span><span class="op" id="2926106">.</span><span class="ident" id="2926107">Field</span><span class="op" id="2926112">(</span><span class="ident" id="2926113">i</span><span class="op" id="2926114">)</span><span class="op" id="2926115">.</span><span class="ident" id="2926116">Type</span><span class="op" id="2926120">.</span><span class="ident" id="2926121">common</span><span class="op" id="2926127">(</span><span class="op" id="2926128">)</span><span class="op" id="2926129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926137">gc</span><span class="op" id="2926139">.</span><span class="ident" id="2926140">align</span><span class="op" id="2926145">(</span><span class="builtintype" id="2926146">uintptr</span><span class="op" id="2926153">(</span><span class="ident" id="2926154">t</span><span class="op" id="2926155">.</span><span class="ident" id="2926156">align</span><span class="op" id="2926161">)</span><span class="op" id="2926162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926165">}</span><br>
<span class="lineno"></span><span class="op" id="2926167">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2926170">func</span>&nbsp;<span class="op" id="2926175">(</span><span class="ident" id="2926176">gc</span>&nbsp;<span class="op" id="2926179">*</span><span class="ident" id="2926180">gcProg</span><span class="op" id="2926186">)</span>&nbsp;<span class="ident" id="2926188">appendWord</span><span class="op" id="2926198">(</span><span class="ident" id="2926199">v</span>&nbsp;<span class="builtintype" id="2926201">byte</span><span class="op" id="2926205">)</span>&nbsp;<span class="op" id="2926207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926210">ptrsize</span>&nbsp;<span class="op" id="2926218">:=</span>&nbsp;<span class="ident" id="2926221">unsafe</span><span class="op" id="2926227">.</span><span class="ident" id="2926228">Sizeof</span><span class="op" id="2926234">(</span><span class="builtintype" id="2926235">uintptr</span><span class="op" id="2926242">(</span><span class="num" id="2926243">0</span><span class="op" id="2926244">)</span><span class="op" id="2926245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926248">if</span>&nbsp;<span class="ident" id="2926251">gc</span><span class="op" id="2926253">.</span><span class="ident" id="2926254">size</span><span class="op" id="2926258">%</span><span class="ident" id="2926259">ptrsize</span>&nbsp;<span class="op" id="2926267">!=</span>&nbsp;<span class="num" id="2926270">0</span>&nbsp;<span class="op" id="2926272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2926276">panic</span><span class="op" id="2926281">(</span><span class="string" id="2926282">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2926313">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926319">nptr</span>&nbsp;<span class="op" id="2926324">:=</span>&nbsp;<span class="ident" id="2926327">gc</span><span class="op" id="2926329">.</span><span class="ident" id="2926330">size</span>&nbsp;<span class="op" id="2926335">/</span>&nbsp;<span class="ident" id="2926337">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926346">for</span>&nbsp;<span class="builtintype" id="2926350">uintptr</span><span class="op" id="2926357">(</span><span class="builtinfunc" id="2926358">len</span><span class="op" id="2926361">(</span><span class="ident" id="2926362">gc</span><span class="op" id="2926364">.</span><span class="ident" id="2926365">gc</span><span class="op" id="2926367">)</span><span class="op" id="2926368">)</span>&nbsp;<span class="op" id="2926370">&lt;</span>&nbsp;<span class="ident" id="2926372">nptr</span><span class="op" id="2926376">/</span><span class="num" id="2926377">2</span><span class="op" id="2926378">+</span><span class="num" id="2926379">1</span>&nbsp;<span class="op" id="2926381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926385">gc</span><span class="op" id="2926387">.</span><span class="ident" id="2926388">gc</span>&nbsp;<span class="op" id="2926391">=</span>&nbsp;<span class="builtinfunc" id="2926393">append</span><span class="op" id="2926399">(</span><span class="ident" id="2926400">gc</span><span class="op" id="2926402">.</span><span class="ident" id="2926403">gc</span><span class="op" id="2926405">,</span>&nbsp;<span class="num" id="2926407">0x44</span><span class="op" id="2926411">)</span>&nbsp;<span class="comment" id="2926413">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926428">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926431">gc</span><span class="op" id="2926433">.</span><span class="ident" id="2926434">gc</span><span class="op" id="2926436">[</span><span class="ident" id="2926437">nptr</span><span class="op" id="2926441">/</span><span class="num" id="2926442">2</span><span class="op" id="2926443">]</span>&nbsp;<span class="op" id="2926445">&amp;=</span>&nbsp;<span class="op" id="2926448">^</span><span class="op" id="2926449">(</span><span class="num" id="2926450">3</span>&nbsp;<span class="op" id="2926452">&lt;&lt;</span>&nbsp;<span class="op" id="2926455">(</span><span class="op" id="2926456">(</span><span class="ident" id="2926457">nptr</span><span class="op" id="2926461">%</span><span class="num" id="2926462">2</span><span class="op" id="2926463">)</span><span class="op" id="2926464">*</span><span class="num" id="2926465">4</span>&nbsp;<span class="op" id="2926467">+</span>&nbsp;<span class="num" id="2926469">2</span><span class="op" id="2926470">)</span><span class="op" id="2926471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926474">gc</span><span class="op" id="2926476">.</span><span class="ident" id="2926477">gc</span><span class="op" id="2926479">[</span><span class="ident" id="2926480">nptr</span><span class="op" id="2926484">/</span><span class="num" id="2926485">2</span><span class="op" id="2926486">]</span>&nbsp;<span class="op" id="2926488">|=</span>&nbsp;<span class="ident" id="2926491">v</span>&nbsp;<span class="op" id="2926493">&lt;&lt;</span>&nbsp;<span class="op" id="2926496">(</span><span class="op" id="2926497">(</span><span class="ident" id="2926498">nptr</span><span class="op" id="2926502">%</span><span class="num" id="2926503">2</span><span class="op" id="2926504">)</span><span class="op" id="2926505">*</span><span class="num" id="2926506">4</span>&nbsp;<span class="op" id="2926508">+</span>&nbsp;<span class="num" id="2926510">2</span><span class="op" id="2926511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926514">gc</span><span class="op" id="2926516">.</span><span class="ident" id="2926517">size</span>&nbsp;<span class="op" id="2926522">+=</span>&nbsp;<span class="ident" id="2926525">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2926533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2926536">func</span>&nbsp;<span class="op" id="2926541">(</span><span class="ident" id="2926542">gc</span>&nbsp;<span class="op" id="2926545">*</span><span class="ident" id="2926546">gcProg</span><span class="op" id="2926552">)</span>&nbsp;<span class="ident" id="2926554">finalize</span><span class="op" id="2926562">(</span><span class="op" id="2926563">)</span>&nbsp;<span class="ident" id="2926565">unsafe</span><span class="op" id="2926571">.</span><span class="ident" id="2926572">Pointer</span>&nbsp;<span class="op" id="2926580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926583">if</span>&nbsp;<span class="ident" id="2926586">gc</span><span class="op" id="2926588">.</span><span class="ident" id="2926589">size</span>&nbsp;<span class="op" id="2926594">==</span>&nbsp;<span class="num" id="2926597">0</span>&nbsp;<span class="op" id="2926599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926603">return</span>&nbsp;<span class="ident" id="2926610">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926618">ptrsize</span>&nbsp;<span class="op" id="2926626">:=</span>&nbsp;<span class="ident" id="2926629">unsafe</span><span class="op" id="2926635">.</span><span class="ident" id="2926636">Sizeof</span><span class="op" id="2926642">(</span><span class="builtintype" id="2926643">uintptr</span><span class="op" id="2926650">(</span><span class="num" id="2926651">0</span><span class="op" id="2926652">)</span><span class="op" id="2926653">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926656">gc</span><span class="op" id="2926658">.</span><span class="ident" id="2926659">align</span><span class="op" id="2926664">(</span><span class="ident" id="2926665">ptrsize</span><span class="op" id="2926672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926675">nptr</span>&nbsp;<span class="op" id="2926680">:=</span>&nbsp;<span class="ident" id="2926683">gc</span><span class="op" id="2926685">.</span><span class="ident" id="2926686">size</span>&nbsp;<span class="op" id="2926691">/</span>&nbsp;<span class="ident" id="2926693">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926702">for</span>&nbsp;<span class="builtintype" id="2926706">uintptr</span><span class="op" id="2926713">(</span><span class="builtinfunc" id="2926714">len</span><span class="op" id="2926717">(</span><span class="ident" id="2926718">gc</span><span class="op" id="2926720">.</span><span class="ident" id="2926721">gc</span><span class="op" id="2926723">)</span><span class="op" id="2926724">)</span>&nbsp;<span class="op" id="2926726">&lt;</span>&nbsp;<span class="ident" id="2926728">nptr</span><span class="op" id="2926732">/</span><span class="num" id="2926733">2</span><span class="op" id="2926734">+</span><span class="num" id="2926735">1</span>&nbsp;<span class="op" id="2926737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926741">gc</span><span class="op" id="2926743">.</span><span class="ident" id="2926744">gc</span>&nbsp;<span class="op" id="2926747">=</span>&nbsp;<span class="builtinfunc" id="2926749">append</span><span class="op" id="2926755">(</span><span class="ident" id="2926756">gc</span><span class="op" id="2926758">.</span><span class="ident" id="2926759">gc</span><span class="op" id="2926761">,</span>&nbsp;<span class="num" id="2926763">0x44</span><span class="op" id="2926767">)</span>&nbsp;<span class="comment" id="2926769">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926784">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2926787">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2926841">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926869">if</span>&nbsp;<span class="ident" id="2926872">nptr</span><span class="op" id="2926876">%</span><span class="num" id="2926877">2</span>&nbsp;<span class="op" id="2926879">!=</span>&nbsp;<span class="num" id="2926882">0</span>&nbsp;<span class="op" id="2926884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926888">for</span>&nbsp;<span class="ident" id="2926892">i</span>&nbsp;<span class="op" id="2926894">:=</span>&nbsp;<span class="builtintype" id="2926897">uintptr</span><span class="op" id="2926904">(</span><span class="num" id="2926905">0</span><span class="op" id="2926906">)</span><span class="op" id="2926907">;</span>&nbsp;<span class="ident" id="2926909">i</span>&nbsp;<span class="op" id="2926911">&lt;</span>&nbsp;<span class="ident" id="2926913">nptr</span><span class="op" id="2926917">;</span>&nbsp;<span class="ident" id="2926919">i</span><span class="op" id="2926920">++</span>&nbsp;<span class="op" id="2926923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2926928">gc</span><span class="op" id="2926930">.</span><span class="ident" id="2926931">appendWord</span><span class="op" id="2926941">(</span><span class="ident" id="2926942">extractGCWord</span><span class="op" id="2926955">(</span><span class="ident" id="2926956">gc</span><span class="op" id="2926958">.</span><span class="ident" id="2926959">gc</span><span class="op" id="2926961">,</span>&nbsp;<span class="ident" id="2926963">i</span><span class="op" id="2926964">)</span><span class="op" id="2926965">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2926972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2926975">return</span>&nbsp;<span class="ident" id="2926982">unsafe</span><span class="op" id="2926988">.</span><span class="ident" id="2926989">Pointer</span><span class="op" id="2926996">(</span><span class="op" id="2926997">&amp;</span><span class="ident" id="2926998">gc</span><span class="op" id="2927000">.</span><span class="ident" id="2927001">gc</span><span class="op" id="2927003">[</span><span class="num" id="2927004">0</span><span class="op" id="2927005">]</span><span class="op" id="2927006">)</span><br>
<span class="lineno"></span><span class="op" id="2927008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2927011">func</span>&nbsp;<span class="ident" id="2927016">extractGCWord</span><span class="op" id="2927029">(</span><span class="ident" id="2927030">gc</span>&nbsp;<span class="op" id="2927033">[</span><span class="op" id="2927034">]</span><span class="builtintype" id="2927035">byte</span><span class="op" id="2927039">,</span>&nbsp;<span class="ident" id="2927041">i</span>&nbsp;<span class="builtintype" id="2927043">uintptr</span><span class="op" id="2927050">)</span>&nbsp;<span class="builtintype" id="2927052">byte</span>&nbsp;<span class="op" id="2927057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2927060">return</span>&nbsp;<span class="op" id="2927067">(</span><span class="ident" id="2927068">gc</span><span class="op" id="2927070">[</span><span class="ident" id="2927071">i</span><span class="op" id="2927072">/</span><span class="num" id="2927073">2</span><span class="op" id="2927074">]</span>&nbsp;<span class="op" id="2927076">&gt;&gt;</span>&nbsp;<span class="op" id="2927079">(</span><span class="op" id="2927080">(</span><span class="ident" id="2927081">i</span><span class="op" id="2927082">%</span><span class="num" id="2927083">2</span><span class="op" id="2927084">)</span><span class="op" id="2927085">*</span><span class="num" id="2927086">4</span>&nbsp;<span class="op" id="2927088">+</span>&nbsp;<span class="num" id="2927090">2</span><span class="op" id="2927091">)</span><span class="op" id="2927092">)</span>&nbsp;<span class="op" id="2927094">&amp;</span>&nbsp;<span class="num" id="2927096">3</span><br>
<span class="lineno"></span><span class="op" id="2927098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2927101">func</span>&nbsp;<span class="op" id="2927106">(</span><span class="ident" id="2927107">gc</span>&nbsp;<span class="op" id="2927110">*</span><span class="ident" id="2927111">gcProg</span><span class="op" id="2927117">)</span>&nbsp;<span class="ident" id="2927119">align</span><span class="op" id="2927124">(</span><span class="ident" id="2927125">a</span>&nbsp;<span class="builtintype" id="2927127">uintptr</span><span class="op" id="2927134">)</span>&nbsp;<span class="op" id="2927136">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927139">gc</span><span class="op" id="2927141">.</span><span class="ident" id="2927142">size</span>&nbsp;<span class="op" id="2927147">=</span>&nbsp;<span class="ident" id="2927149">align</span><span class="op" id="2927154">(</span><span class="ident" id="2927155">gc</span><span class="op" id="2927157">.</span><span class="ident" id="2927158">size</span><span class="op" id="2927162">,</span>&nbsp;<span class="ident" id="2927164">a</span><span class="op" id="2927165">)</span><br>
<span class="lineno"></span><span class="op" id="2927167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2927170">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2927231">const</span>&nbsp;<span class="op" id="2927237">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927240">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2927254">=</span>&nbsp;<span class="num" id="2927256">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927259">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2927273">=</span>&nbsp;<span class="num" id="2927275">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927278">bitsMultiWord</span>&nbsp;<span class="op" id="2927292">=</span>&nbsp;<span class="num" id="2927294">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927298">bitsIface</span>&nbsp;<span class="op" id="2927308">=</span>&nbsp;<span class="num" id="2927310">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927313">bitsEface</span>&nbsp;<span class="op" id="2927323">=</span>&nbsp;<span class="num" id="2927325">3</span><br>
<span class="lineno"></span><span class="op" id="2927327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2927330">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2927402">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2927474">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2927549">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2927580">const</span>&nbsp;<span class="op" id="2927586">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927589">bucketSize</span>&nbsp;<span class="op" id="2927600">=</span>&nbsp;<span class="num" id="2927602">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927605">maxKeySize</span>&nbsp;<span class="op" id="2927616">=</span>&nbsp;<span class="num" id="2927618">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927623">maxValSize</span>&nbsp;<span class="op" id="2927634">=</span>&nbsp;<span class="num" id="2927636">128</span><br>
<span class="lineno"></span><span class="op" id="2927640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2927643">func</span>&nbsp;<span class="ident" id="2927648">bucketOf</span><span class="op" id="2927656">(</span><span class="ident" id="2927657">ktyp</span><span class="op" id="2927661">,</span>&nbsp;<span class="ident" id="2927663">etyp</span>&nbsp;<span class="op" id="2927668">*</span><span class="ident" id="2927669">rtype</span><span class="op" id="2927674">)</span>&nbsp;<span class="op" id="2927676">*</span><span class="ident" id="2927677">rtype</span>&nbsp;<span class="op" id="2927683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2927686">if</span>&nbsp;<span class="ident" id="2927689">ktyp</span><span class="op" id="2927693">.</span><span class="ident" id="2927694">size</span>&nbsp;<span class="op" id="2927699">&gt;</span>&nbsp;<span class="ident" id="2927701">maxKeySize</span>&nbsp;<span class="op" id="2927712">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927716">ktyp</span>&nbsp;<span class="op" id="2927721">=</span>&nbsp;<span class="ident" id="2927723">PtrTo</span><span class="op" id="2927728">(</span><span class="ident" id="2927729">ktyp</span><span class="op" id="2927733">)</span><span class="op" id="2927734">.</span><span class="op" id="2927735">(</span><span class="op" id="2927736">*</span><span class="ident" id="2927737">rtype</span><span class="op" id="2927742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2927745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2927748">if</span>&nbsp;<span class="ident" id="2927751">etyp</span><span class="op" id="2927755">.</span><span class="ident" id="2927756">size</span>&nbsp;<span class="op" id="2927761">&gt;</span>&nbsp;<span class="ident" id="2927763">maxValSize</span>&nbsp;<span class="op" id="2927774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927778">etyp</span>&nbsp;<span class="op" id="2927783">=</span>&nbsp;<span class="ident" id="2927785">PtrTo</span><span class="op" id="2927790">(</span><span class="ident" id="2927791">etyp</span><span class="op" id="2927795">)</span><span class="op" id="2927796">.</span><span class="op" id="2927797">(</span><span class="op" id="2927798">*</span><span class="ident" id="2927799">rtype</span><span class="op" id="2927804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2927807">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927810">ptrsize</span>&nbsp;<span class="op" id="2927818">:=</span>&nbsp;<span class="ident" id="2927821">unsafe</span><span class="op" id="2927827">.</span><span class="ident" id="2927828">Sizeof</span><span class="op" id="2927834">(</span><span class="builtintype" id="2927835">uintptr</span><span class="op" id="2927842">(</span><span class="num" id="2927843">0</span><span class="op" id="2927844">)</span><span class="op" id="2927845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2927849">var</span>&nbsp;<span class="ident" id="2927853">gc</span>&nbsp;<span class="ident" id="2927856">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2927864">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2927876">for</span>&nbsp;<span class="ident" id="2927880">i</span>&nbsp;<span class="op" id="2927882">:=</span>&nbsp;<span class="num" id="2927885">0</span><span class="op" id="2927886">;</span>&nbsp;<span class="ident" id="2927888">i</span>&nbsp;<span class="op" id="2927890">&lt;</span>&nbsp;<span class="builtintype" id="2927892">int</span><span class="op" id="2927895">(</span><span class="ident" id="2927896">bucketSize</span><span class="op" id="2927906">*</span><span class="ident" id="2927907">unsafe</span><span class="op" id="2927913">.</span><span class="ident" id="2927914">Sizeof</span><span class="op" id="2927920">(</span><span class="builtintype" id="2927921">uint8</span><span class="op" id="2927926">(</span><span class="num" id="2927927">0</span><span class="op" id="2927928">)</span><span class="op" id="2927929">)</span><span class="op" id="2927930">/</span><span class="ident" id="2927931">ptrsize</span><span class="op" id="2927938">)</span><span class="op" id="2927939">;</span>&nbsp;<span class="ident" id="2927941">i</span><span class="op" id="2927942">++</span>&nbsp;<span class="op" id="2927945">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927949">gc</span><span class="op" id="2927951">.</span><span class="builtinfunc" id="2927952">append</span><span class="op" id="2927958">(</span><span class="ident" id="2927959">bitsScalar</span><span class="op" id="2927969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2927972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2927975">gc</span><span class="op" id="2927977">.</span><span class="builtinfunc" id="2927978">append</span><span class="op" id="2927984">(</span><span class="ident" id="2927985">bitsPointer</span><span class="op" id="2927996">)</span>&nbsp;<span class="comment" id="2927998">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928011">if</span>&nbsp;<span class="ident" id="2928014">runtime</span><span class="op" id="2928021">.</span><span class="ident" id="2928022">GOARCH</span>&nbsp;<span class="op" id="2928029">==</span>&nbsp;<span class="string" id="2928032">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2928043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928047">gc</span><span class="op" id="2928049">.</span><span class="builtinfunc" id="2928050">append</span><span class="op" id="2928056">(</span><span class="ident" id="2928057">bitsScalar</span><span class="op" id="2928067">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2928073">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928082">for</span>&nbsp;<span class="ident" id="2928086">i</span>&nbsp;<span class="op" id="2928088">:=</span>&nbsp;<span class="num" id="2928091">0</span><span class="op" id="2928092">;</span>&nbsp;<span class="ident" id="2928094">i</span>&nbsp;<span class="op" id="2928096">&lt;</span>&nbsp;<span class="ident" id="2928098">bucketSize</span><span class="op" id="2928108">;</span>&nbsp;<span class="ident" id="2928110">i</span><span class="op" id="2928111">++</span>&nbsp;<span class="op" id="2928114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928118">gc</span><span class="op" id="2928120">.</span><span class="ident" id="2928121">appendProg</span><span class="op" id="2928131">(</span><span class="ident" id="2928132">ktyp</span><span class="op" id="2928136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928139">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2928142">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928153">for</span>&nbsp;<span class="ident" id="2928157">i</span>&nbsp;<span class="op" id="2928159">:=</span>&nbsp;<span class="num" id="2928162">0</span><span class="op" id="2928163">;</span>&nbsp;<span class="ident" id="2928165">i</span>&nbsp;<span class="op" id="2928167">&lt;</span>&nbsp;<span class="ident" id="2928169">bucketSize</span><span class="op" id="2928179">;</span>&nbsp;<span class="ident" id="2928181">i</span><span class="op" id="2928182">++</span>&nbsp;<span class="op" id="2928185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928189">gc</span><span class="op" id="2928191">.</span><span class="ident" id="2928192">appendProg</span><span class="op" id="2928202">(</span><span class="ident" id="2928203">etyp</span><span class="op" id="2928207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928214">b</span>&nbsp;<span class="op" id="2928216">:=</span>&nbsp;<span class="builtinfunc" id="2928219">new</span><span class="op" id="2928222">(</span><span class="ident" id="2928223">rtype</span><span class="op" id="2928228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928231">b</span><span class="op" id="2928232">.</span><span class="ident" id="2928233">size</span>&nbsp;<span class="op" id="2928238">=</span>&nbsp;<span class="ident" id="2928240">gc</span><span class="op" id="2928242">.</span><span class="ident" id="2928243">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928249">b</span><span class="op" id="2928250">.</span><span class="ident" id="2928251">gc</span><span class="op" id="2928253">[</span><span class="num" id="2928254">0</span><span class="op" id="2928255">]</span>&nbsp;<span class="op" id="2928257">=</span>&nbsp;<span class="ident" id="2928259">gc</span><span class="op" id="2928261">.</span><span class="ident" id="2928262">finalize</span><span class="op" id="2928270">(</span><span class="op" id="2928271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928274">s</span>&nbsp;<span class="op" id="2928276">:=</span>&nbsp;<span class="string" id="2928279">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2928289">+</span>&nbsp;<span class="op" id="2928291">*</span><span class="ident" id="2928292">ktyp</span><span class="op" id="2928296">.</span><span class="builtintype" id="2928297">string</span>&nbsp;<span class="op" id="2928304">+</span>&nbsp;<span class="string" id="2928306">&#34;,&#34;</span>&nbsp;<span class="op" id="2928310">+</span>&nbsp;<span class="op" id="2928312">*</span><span class="ident" id="2928313">etyp</span><span class="op" id="2928317">.</span><span class="builtintype" id="2928318">string</span>&nbsp;<span class="op" id="2928325">+</span>&nbsp;<span class="string" id="2928327">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928332">b</span><span class="op" id="2928333">.</span><span class="builtintype" id="2928334">string</span>&nbsp;<span class="op" id="2928341">=</span>&nbsp;<span class="op" id="2928343">&amp;</span><span class="ident" id="2928344">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928347">return</span>&nbsp;<span class="ident" id="2928354">b</span><br>
<span class="lineno"></span><span class="op" id="2928356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2928359">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2928414">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2928480">func</span>&nbsp;<span class="ident" id="2928485">SliceOf</span><span class="op" id="2928492">(</span><span class="ident" id="2928493">t</span>&nbsp;<span class="ident" id="2928495">Type</span><span class="op" id="2928499">)</span>&nbsp;<span class="ident" id="2928501">Type</span>&nbsp;<span class="op" id="2928506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928509">typ</span>&nbsp;<span class="op" id="2928513">:=</span>&nbsp;<span class="ident" id="2928516">t</span><span class="op" id="2928517">.</span><span class="op" id="2928518">(</span><span class="op" id="2928519">*</span><span class="ident" id="2928520">rtype</span><span class="op" id="2928525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2928529">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928548">ckey</span>&nbsp;<span class="op" id="2928553">:=</span>&nbsp;<span class="ident" id="2928556">cacheKey</span><span class="op" id="2928564">{</span><span class="ident" id="2928565">Slice</span><span class="op" id="2928570">,</span>&nbsp;<span class="ident" id="2928572">typ</span><span class="op" id="2928575">,</span>&nbsp;<span class="ident" id="2928577">nil</span><span class="op" id="2928580">,</span>&nbsp;<span class="num" id="2928582">0</span><span class="op" id="2928583">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928586">if</span>&nbsp;<span class="ident" id="2928589">slice</span>&nbsp;<span class="op" id="2928595">:=</span>&nbsp;<span class="ident" id="2928598">cacheGet</span><span class="op" id="2928606">(</span><span class="ident" id="2928607">ckey</span><span class="op" id="2928611">)</span><span class="op" id="2928612">;</span>&nbsp;<span class="ident" id="2928614">slice</span>&nbsp;<span class="op" id="2928620">!=</span>&nbsp;<span class="ident" id="2928623">nil</span>&nbsp;<span class="op" id="2928627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928631">return</span>&nbsp;<span class="ident" id="2928638">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2928649">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928674">s</span>&nbsp;<span class="op" id="2928676">:=</span>&nbsp;<span class="string" id="2928679">&#34;[]&#34;</span>&nbsp;<span class="op" id="2928684">+</span>&nbsp;<span class="op" id="2928686">*</span><span class="ident" id="2928687">typ</span><span class="op" id="2928690">.</span><span class="builtintype" id="2928691">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928699">for</span>&nbsp;<span class="ident" id="2928703">_</span><span class="op" id="2928704">,</span>&nbsp;<span class="ident" id="2928706">tt</span>&nbsp;<span class="op" id="2928709">:=</span>&nbsp;<span class="keyword" id="2928712">range</span>&nbsp;<span class="ident" id="2928718">typesByString</span><span class="op" id="2928731">(</span><span class="ident" id="2928732">s</span><span class="op" id="2928733">)</span>&nbsp;<span class="op" id="2928735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928739">slice</span>&nbsp;<span class="op" id="2928745">:=</span>&nbsp;<span class="op" id="2928748">(</span><span class="op" id="2928749">*</span><span class="ident" id="2928750">sliceType</span><span class="op" id="2928759">)</span><span class="op" id="2928760">(</span><span class="ident" id="2928761">unsafe</span><span class="op" id="2928767">.</span><span class="ident" id="2928768">Pointer</span><span class="op" id="2928775">(</span><span class="ident" id="2928776">tt</span><span class="op" id="2928778">)</span><span class="op" id="2928779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928783">if</span>&nbsp;<span class="ident" id="2928786">slice</span><span class="op" id="2928791">.</span><span class="ident" id="2928792">elem</span>&nbsp;<span class="op" id="2928797">==</span>&nbsp;<span class="ident" id="2928800">typ</span>&nbsp;<span class="op" id="2928804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928809">return</span>&nbsp;<span class="ident" id="2928816">cachePut</span><span class="op" id="2928824">(</span><span class="ident" id="2928825">ckey</span><span class="op" id="2928829">,</span>&nbsp;<span class="ident" id="2928831">tt</span><span class="op" id="2928833">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2928844">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2928867">var</span>&nbsp;<span class="ident" id="2928871">islice</span>&nbsp;<span class="keyword" id="2928878">interface</span><span class="op" id="2928887">{</span><span class="op" id="2928888">}</span>&nbsp;<span class="op" id="2928890">=</span>&nbsp;<span class="op" id="2928892">(</span><span class="op" id="2928893">[</span><span class="op" id="2928894">]</span><span class="ident" id="2928895">unsafe</span><span class="op" id="2928901">.</span><span class="ident" id="2928902">Pointer</span><span class="op" id="2928909">)</span><span class="op" id="2928910">(</span><span class="ident" id="2928911">nil</span><span class="op" id="2928914">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928917">prototype</span>&nbsp;<span class="op" id="2928927">:=</span>&nbsp;<span class="op" id="2928930">*</span><span class="op" id="2928931">(</span><span class="op" id="2928932">*</span><span class="op" id="2928933">*</span><span class="ident" id="2928934">sliceType</span><span class="op" id="2928943">)</span><span class="op" id="2928944">(</span><span class="ident" id="2928945">unsafe</span><span class="op" id="2928951">.</span><span class="ident" id="2928952">Pointer</span><span class="op" id="2928959">(</span><span class="op" id="2928960">&amp;</span><span class="ident" id="2928961">islice</span><span class="op" id="2928967">)</span><span class="op" id="2928968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2928971">slice</span>&nbsp;<span class="op" id="2928977">:=</span>&nbsp;<span class="builtinfunc" id="2928980">new</span><span class="op" id="2928983">(</span><span class="ident" id="2928984">sliceType</span><span class="op" id="2928993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2928996">*</span><span class="ident" id="2928997">slice</span>&nbsp;<span class="op" id="2929003">=</span>&nbsp;<span class="op" id="2929005">*</span><span class="ident" id="2929006">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929017">slice</span><span class="op" id="2929022">.</span><span class="builtintype" id="2929023">string</span>&nbsp;<span class="op" id="2929030">=</span>&nbsp;<span class="op" id="2929032">&amp;</span><span class="ident" id="2929033">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929036">slice</span><span class="op" id="2929041">.</span><span class="ident" id="2929042">hash</span>&nbsp;<span class="op" id="2929047">=</span>&nbsp;<span class="ident" id="2929049">fnv1</span><span class="op" id="2929053">(</span><span class="ident" id="2929054">typ</span><span class="op" id="2929057">.</span><span class="ident" id="2929058">hash</span><span class="op" id="2929062">,</span>&nbsp;<span class="string" id="2929064">&#39;[&#39;</span><span class="op" id="2929067">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929070">slice</span><span class="op" id="2929075">.</span><span class="ident" id="2929076">elem</span>&nbsp;<span class="op" id="2929081">=</span>&nbsp;<span class="ident" id="2929083">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929088">slice</span><span class="op" id="2929093">.</span><span class="ident" id="2929094">uncommonType</span>&nbsp;<span class="op" id="2929107">=</span>&nbsp;<span class="ident" id="2929109">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929114">slice</span><span class="op" id="2929119">.</span><span class="ident" id="2929120">ptrToThis</span>&nbsp;<span class="op" id="2929130">=</span>&nbsp;<span class="ident" id="2929132">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929137">slice</span><span class="op" id="2929142">.</span><span class="ident" id="2929143">zero</span>&nbsp;<span class="op" id="2929148">=</span>&nbsp;<span class="ident" id="2929150">unsafe</span><span class="op" id="2929156">.</span><span class="ident" id="2929157">Pointer</span><span class="op" id="2929164">(</span><span class="op" id="2929165">&amp;</span><span class="builtinfunc" id="2929166">make</span><span class="op" id="2929170">(</span><span class="op" id="2929171">[</span><span class="op" id="2929172">]</span><span class="builtintype" id="2929173">byte</span><span class="op" id="2929177">,</span>&nbsp;<span class="ident" id="2929179">slice</span><span class="op" id="2929184">.</span><span class="ident" id="2929185">size</span><span class="op" id="2929189">)</span><span class="op" id="2929190">[</span><span class="num" id="2929191">0</span><span class="op" id="2929192">]</span><span class="op" id="2929193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2929197">return</span>&nbsp;<span class="ident" id="2929204">cachePut</span><span class="op" id="2929212">(</span><span class="ident" id="2929213">ckey</span><span class="op" id="2929217">,</span>&nbsp;<span class="op" id="2929219">&amp;</span><span class="ident" id="2929220">slice</span><span class="op" id="2929225">.</span><span class="ident" id="2929226">rtype</span><span class="op" id="2929231">)</span><br>
<span class="lineno"></span><span class="op" id="2929233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2929236">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2929309">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2929379">//</span><br>
<span class="lineno"></span><span class="comment" id="2929382">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2929457">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2929476">//</span><br>
<span class="lineno"></span><span class="comment" id="2929479">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2929556">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2929608">//</span><br>
<span class="lineno"></span><span class="comment" id="2929611">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2929666">func</span>&nbsp;<span class="ident" id="2929671">arrayOf</span><span class="op" id="2929678">(</span><span class="ident" id="2929679">count</span>&nbsp;<span class="builtintype" id="2929685">int</span><span class="op" id="2929688">,</span>&nbsp;<span class="ident" id="2929690">elem</span>&nbsp;<span class="ident" id="2929695">Type</span><span class="op" id="2929699">)</span>&nbsp;<span class="ident" id="2929701">Type</span>&nbsp;<span class="op" id="2929706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929709">typ</span>&nbsp;<span class="op" id="2929713">:=</span>&nbsp;<span class="ident" id="2929716">elem</span><span class="op" id="2929720">.</span><span class="op" id="2929721">(</span><span class="op" id="2929722">*</span><span class="ident" id="2929723">rtype</span><span class="op" id="2929728">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929731">slice</span>&nbsp;<span class="op" id="2929737">:=</span>&nbsp;<span class="ident" id="2929740">SliceOf</span><span class="op" id="2929747">(</span><span class="ident" id="2929748">elem</span><span class="op" id="2929752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2929756">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929775">ckey</span>&nbsp;<span class="op" id="2929780">:=</span>&nbsp;<span class="ident" id="2929783">cacheKey</span><span class="op" id="2929791">{</span><span class="ident" id="2929792">Array</span><span class="op" id="2929797">,</span>&nbsp;<span class="ident" id="2929799">typ</span><span class="op" id="2929802">,</span>&nbsp;<span class="ident" id="2929804">nil</span><span class="op" id="2929807">,</span>&nbsp;<span class="builtintype" id="2929809">uintptr</span><span class="op" id="2929816">(</span><span class="ident" id="2929817">count</span><span class="op" id="2929822">)</span><span class="op" id="2929823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2929826">if</span>&nbsp;<span class="ident" id="2929829">slice</span>&nbsp;<span class="op" id="2929835">:=</span>&nbsp;<span class="ident" id="2929838">cacheGet</span><span class="op" id="2929846">(</span><span class="ident" id="2929847">ckey</span><span class="op" id="2929851">)</span><span class="op" id="2929852">;</span>&nbsp;<span class="ident" id="2929854">slice</span>&nbsp;<span class="op" id="2929860">!=</span>&nbsp;<span class="ident" id="2929863">nil</span>&nbsp;<span class="op" id="2929867">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2929871">return</span>&nbsp;<span class="ident" id="2929878">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2929885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2929889">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2929914">s</span>&nbsp;<span class="op" id="2929916">:=</span>&nbsp;<span class="string" id="2929919">&#34;[&#34;</span>&nbsp;<span class="op" id="2929923">+</span>&nbsp;<span class="ident" id="2929925">strconv</span><span class="op" id="2929932">.</span><span class="ident" id="2929933">Itoa</span><span class="op" id="2929937">(</span><span class="ident" id="2929938">count</span><span class="op" id="2929943">)</span>&nbsp;<span class="op" id="2929945">+</span>&nbsp;<span class="string" id="2929947">&#34;]&#34;</span>&nbsp;<span class="op" id="2929951">+</span>&nbsp;<span class="op" id="2929953">*</span><span class="ident" id="2929954">typ</span><span class="op" id="2929957">.</span><span class="builtintype" id="2929958">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2929966">for</span>&nbsp;<span class="ident" id="2929970">_</span><span class="op" id="2929971">,</span>&nbsp;<span class="ident" id="2929973">tt</span>&nbsp;<span class="op" id="2929976">:=</span>&nbsp;<span class="keyword" id="2929979">range</span>&nbsp;<span class="ident" id="2929985">typesByString</span><span class="op" id="2929998">(</span><span class="ident" id="2929999">s</span><span class="op" id="2930000">)</span>&nbsp;<span class="op" id="2930002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930006">slice</span>&nbsp;<span class="op" id="2930012">:=</span>&nbsp;<span class="op" id="2930015">(</span><span class="op" id="2930016">*</span><span class="ident" id="2930017">sliceType</span><span class="op" id="2930026">)</span><span class="op" id="2930027">(</span><span class="ident" id="2930028">unsafe</span><span class="op" id="2930034">.</span><span class="ident" id="2930035">Pointer</span><span class="op" id="2930042">(</span><span class="ident" id="2930043">tt</span><span class="op" id="2930045">)</span><span class="op" id="2930046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930050">if</span>&nbsp;<span class="ident" id="2930053">slice</span><span class="op" id="2930058">.</span><span class="ident" id="2930059">elem</span>&nbsp;<span class="op" id="2930064">==</span>&nbsp;<span class="ident" id="2930067">typ</span>&nbsp;<span class="op" id="2930071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930076">return</span>&nbsp;<span class="ident" id="2930083">cachePut</span><span class="op" id="2930091">(</span><span class="ident" id="2930092">ckey</span><span class="op" id="2930096">,</span>&nbsp;<span class="ident" id="2930098">tt</span><span class="op" id="2930100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2930104">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2930107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2930111">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930135">var</span>&nbsp;<span class="ident" id="2930139">iarray</span>&nbsp;<span class="keyword" id="2930146">interface</span><span class="op" id="2930155">{</span><span class="op" id="2930156">}</span>&nbsp;<span class="op" id="2930158">=</span>&nbsp;<span class="op" id="2930160">[</span><span class="num" id="2930161">1</span><span class="op" id="2930162">]</span><span class="ident" id="2930163">unsafe</span><span class="op" id="2930169">.</span><span class="ident" id="2930170">Pointer</span><span class="op" id="2930177">{</span><span class="op" id="2930178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930181">prototype</span>&nbsp;<span class="op" id="2930191">:=</span>&nbsp;<span class="op" id="2930194">*</span><span class="op" id="2930195">(</span><span class="op" id="2930196">*</span><span class="op" id="2930197">*</span><span class="ident" id="2930198">arrayType</span><span class="op" id="2930207">)</span><span class="op" id="2930208">(</span><span class="ident" id="2930209">unsafe</span><span class="op" id="2930215">.</span><span class="ident" id="2930216">Pointer</span><span class="op" id="2930223">(</span><span class="op" id="2930224">&amp;</span><span class="ident" id="2930225">iarray</span><span class="op" id="2930231">)</span><span class="op" id="2930232">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930235">array</span>&nbsp;<span class="op" id="2930241">:=</span>&nbsp;<span class="builtinfunc" id="2930244">new</span><span class="op" id="2930247">(</span><span class="ident" id="2930248">arrayType</span><span class="op" id="2930257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2930260">*</span><span class="ident" id="2930261">array</span>&nbsp;<span class="op" id="2930267">=</span>&nbsp;<span class="op" id="2930269">*</span><span class="ident" id="2930270">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2930281">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930322">array</span><span class="op" id="2930327">.</span><span class="builtintype" id="2930328">string</span>&nbsp;<span class="op" id="2930335">=</span>&nbsp;<span class="op" id="2930337">&amp;</span><span class="ident" id="2930338">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930341">array</span><span class="op" id="2930346">.</span><span class="ident" id="2930347">hash</span>&nbsp;<span class="op" id="2930352">=</span>&nbsp;<span class="ident" id="2930354">fnv1</span><span class="op" id="2930358">(</span><span class="ident" id="2930359">typ</span><span class="op" id="2930362">.</span><span class="ident" id="2930363">hash</span><span class="op" id="2930367">,</span>&nbsp;<span class="string" id="2930369">&#39;[&#39;</span><span class="op" id="2930372">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930375">for</span>&nbsp;<span class="ident" id="2930379">n</span>&nbsp;<span class="op" id="2930381">:=</span>&nbsp;<span class="builtintype" id="2930384">uint32</span><span class="op" id="2930390">(</span><span class="ident" id="2930391">count</span><span class="op" id="2930396">)</span><span class="op" id="2930397">;</span>&nbsp;<span class="ident" id="2930399">n</span>&nbsp;<span class="op" id="2930401">&gt;</span>&nbsp;<span class="num" id="2930403">0</span><span class="op" id="2930404">;</span>&nbsp;<span class="ident" id="2930406">n</span>&nbsp;<span class="op" id="2930408">&gt;&gt;=</span>&nbsp;<span class="num" id="2930412">8</span>&nbsp;<span class="op" id="2930414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930418">array</span><span class="op" id="2930423">.</span><span class="ident" id="2930424">hash</span>&nbsp;<span class="op" id="2930429">=</span>&nbsp;<span class="ident" id="2930431">fnv1</span><span class="op" id="2930435">(</span><span class="ident" id="2930436">array</span><span class="op" id="2930441">.</span><span class="ident" id="2930442">hash</span><span class="op" id="2930446">,</span>&nbsp;<span class="builtintype" id="2930448">byte</span><span class="op" id="2930452">(</span><span class="ident" id="2930453">n</span><span class="op" id="2930454">)</span><span class="op" id="2930455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2930458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930461">array</span><span class="op" id="2930466">.</span><span class="ident" id="2930467">hash</span>&nbsp;<span class="op" id="2930472">=</span>&nbsp;<span class="ident" id="2930474">fnv1</span><span class="op" id="2930478">(</span><span class="ident" id="2930479">array</span><span class="op" id="2930484">.</span><span class="ident" id="2930485">hash</span><span class="op" id="2930489">,</span>&nbsp;<span class="string" id="2930491">&#39;]&#39;</span><span class="op" id="2930494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930497">array</span><span class="op" id="2930502">.</span><span class="ident" id="2930503">elem</span>&nbsp;<span class="op" id="2930508">=</span>&nbsp;<span class="ident" id="2930510">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930515">max</span>&nbsp;<span class="op" id="2930519">:=</span>&nbsp;<span class="op" id="2930522">^</span><span class="builtintype" id="2930523">uintptr</span><span class="op" id="2930530">(</span><span class="num" id="2930531">0</span><span class="op" id="2930532">)</span>&nbsp;<span class="op" id="2930534">/</span>&nbsp;<span class="ident" id="2930536">typ</span><span class="op" id="2930539">.</span><span class="ident" id="2930540">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930546">if</span>&nbsp;<span class="builtintype" id="2930549">uintptr</span><span class="op" id="2930556">(</span><span class="ident" id="2930557">count</span><span class="op" id="2930562">)</span>&nbsp;<span class="op" id="2930564">&gt;</span>&nbsp;<span class="ident" id="2930566">max</span>&nbsp;<span class="op" id="2930570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2930574">panic</span><span class="op" id="2930579">(</span><span class="string" id="2930580">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2930644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2930647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930650">array</span><span class="op" id="2930655">.</span><span class="ident" id="2930656">size</span>&nbsp;<span class="op" id="2930661">=</span>&nbsp;<span class="ident" id="2930663">typ</span><span class="op" id="2930666">.</span><span class="ident" id="2930667">size</span>&nbsp;<span class="op" id="2930672">*</span>&nbsp;<span class="builtintype" id="2930674">uintptr</span><span class="op" id="2930681">(</span><span class="ident" id="2930682">count</span><span class="op" id="2930687">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930690">array</span><span class="op" id="2930695">.</span><span class="ident" id="2930696">align</span>&nbsp;<span class="op" id="2930702">=</span>&nbsp;<span class="ident" id="2930704">typ</span><span class="op" id="2930707">.</span><span class="ident" id="2930708">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930715">array</span><span class="op" id="2930720">.</span><span class="ident" id="2930721">fieldAlign</span>&nbsp;<span class="op" id="2930732">=</span>&nbsp;<span class="ident" id="2930734">typ</span><span class="op" id="2930737">.</span><span class="ident" id="2930738">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2930750">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2930770">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2930789">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930799">array</span><span class="op" id="2930804">.</span><span class="ident" id="2930805">uncommonType</span>&nbsp;<span class="op" id="2930818">=</span>&nbsp;<span class="ident" id="2930820">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930825">array</span><span class="op" id="2930830">.</span><span class="ident" id="2930831">ptrToThis</span>&nbsp;<span class="op" id="2930841">=</span>&nbsp;<span class="ident" id="2930843">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930848">array</span><span class="op" id="2930853">.</span><span class="ident" id="2930854">zero</span>&nbsp;<span class="op" id="2930859">=</span>&nbsp;<span class="ident" id="2930861">unsafe</span><span class="op" id="2930867">.</span><span class="ident" id="2930868">Pointer</span><span class="op" id="2930875">(</span><span class="op" id="2930876">&amp;</span><span class="builtinfunc" id="2930877">make</span><span class="op" id="2930881">(</span><span class="op" id="2930882">[</span><span class="op" id="2930883">]</span><span class="builtintype" id="2930884">byte</span><span class="op" id="2930888">,</span>&nbsp;<span class="ident" id="2930890">array</span><span class="op" id="2930895">.</span><span class="ident" id="2930896">size</span><span class="op" id="2930900">)</span><span class="op" id="2930901">[</span><span class="num" id="2930902">0</span><span class="op" id="2930903">]</span><span class="op" id="2930904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930907">array</span><span class="op" id="2930912">.</span><span class="builtinfunc" id="2930913">len</span>&nbsp;<span class="op" id="2930917">=</span>&nbsp;<span class="builtintype" id="2930919">uintptr</span><span class="op" id="2930926">(</span><span class="ident" id="2930927">count</span><span class="op" id="2930932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2930935">array</span><span class="op" id="2930940">.</span><span class="ident" id="2930941">slice</span>&nbsp;<span class="op" id="2930947">=</span>&nbsp;<span class="ident" id="2930949">slice</span><span class="op" id="2930954">.</span><span class="op" id="2930955">(</span><span class="op" id="2930956">*</span><span class="ident" id="2930957">rtype</span><span class="op" id="2930962">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2930966">return</span>&nbsp;<span class="ident" id="2930973">cachePut</span><span class="op" id="2930981">(</span><span class="ident" id="2930982">ckey</span><span class="op" id="2930986">,</span>&nbsp;<span class="op" id="2930988">&amp;</span><span class="ident" id="2930989">array</span><span class="op" id="2930994">.</span><span class="ident" id="2930995">rtype</span><span class="op" id="2931000">)</span><br>
<span class="lineno"></span><span class="op" id="2931002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2931005">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2931069">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2931138">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2931204">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2931273">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2931315">func</span>&nbsp;<span class="ident" id="2931320">toType</span><span class="op" id="2931326">(</span><span class="ident" id="2931327">t</span>&nbsp;<span class="op" id="2931329">*</span><span class="ident" id="2931330">rtype</span><span class="op" id="2931335">)</span>&nbsp;<span class="ident" id="2931337">Type</span>&nbsp;<span class="op" id="2931342">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2931345">if</span>&nbsp;<span class="ident" id="2931348">t</span>&nbsp;<span class="op" id="2931350">==</span>&nbsp;<span class="ident" id="2931353">nil</span>&nbsp;<span class="op" id="2931357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2931361">return</span>&nbsp;<span class="ident" id="2931368">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2931373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2931376">return</span>&nbsp;<span class="ident" id="2931383">t</span><br>
<span class="lineno"></span><span class="op" id="2931385">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2931388">type</span>&nbsp;<span class="ident" id="2931393">layoutKey</span>&nbsp;<span class="keyword" id="2931403">struct</span>&nbsp;<span class="op" id="2931410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931413">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2931418">*</span><span class="ident" id="2931419">rtype</span>&nbsp;<span class="comment" id="2931425">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931448">rcvr</span>&nbsp;<span class="op" id="2931453">*</span><span class="ident" id="2931454">rtype</span>&nbsp;<span class="comment" id="2931460">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2931493">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2931496">type</span>&nbsp;<span class="ident" id="2931501">layoutType</span>&nbsp;<span class="keyword" id="2931512">struct</span>&nbsp;<span class="op" id="2931519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931522">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2931532">*</span><span class="ident" id="2931533">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931540">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2931550">uintptr</span>&nbsp;<span class="comment" id="2931558">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931580">retOffset</span>&nbsp;<span class="builtintype" id="2931590">uintptr</span>&nbsp;<span class="comment" id="2931598">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931627">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2931637">*</span><span class="ident" id="2931638">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2931648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2931651">var</span>&nbsp;<span class="ident" id="2931655">layoutCache</span>&nbsp;<span class="keyword" id="2931667">struct</span>&nbsp;<span class="op" id="2931674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931677">sync</span><span class="op" id="2931681">.</span><span class="ident" id="2931682">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2931691">m</span>&nbsp;<span class="keyword" id="2931693">map</span><span class="op" id="2931696">[</span><span class="ident" id="2931697">layoutKey</span><span class="op" id="2931706">]</span><span class="ident" id="2931707">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2931718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2931721">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2931789">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2931854">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2931914">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2931993">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2932061">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2932101">func</span>&nbsp;<span class="ident" id="2932106">funcLayout</span><span class="op" id="2932116">(</span><span class="ident" id="2932117">t</span>&nbsp;<span class="op" id="2932119">*</span><span class="ident" id="2932120">rtype</span><span class="op" id="2932125">,</span>&nbsp;<span class="ident" id="2932127">rcvr</span>&nbsp;<span class="op" id="2932132">*</span><span class="ident" id="2932133">rtype</span><span class="op" id="2932138">)</span>&nbsp;<span class="op" id="2932140">(</span><span class="ident" id="2932141">frametype</span>&nbsp;<span class="op" id="2932151">*</span><span class="ident" id="2932152">rtype</span><span class="op" id="2932157">,</span>&nbsp;<span class="ident" id="2932159">argSize</span><span class="op" id="2932166">,</span>&nbsp;<span class="ident" id="2932168">retOffset</span>&nbsp;<span class="builtintype" id="2932178">uintptr</span><span class="op" id="2932185">,</span>&nbsp;<span class="ident" id="2932187">stack</span>&nbsp;<span class="op" id="2932193">*</span><span class="ident" id="2932194">bitVector</span><span class="op" id="2932203">)</span>&nbsp;<span class="op" id="2932205">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932208">if</span>&nbsp;<span class="ident" id="2932211">t</span><span class="op" id="2932212">.</span><span class="ident" id="2932213">Kind</span><span class="op" id="2932217">(</span><span class="op" id="2932218">)</span>&nbsp;<span class="op" id="2932220">!=</span>&nbsp;<span class="ident" id="2932223">Func</span>&nbsp;<span class="op" id="2932228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2932232">panic</span><span class="op" id="2932237">(</span><span class="string" id="2932238">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2932276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932282">if</span>&nbsp;<span class="ident" id="2932285">rcvr</span>&nbsp;<span class="op" id="2932290">!=</span>&nbsp;<span class="ident" id="2932293">nil</span>&nbsp;<span class="op" id="2932297">&amp;&amp;</span>&nbsp;<span class="ident" id="2932300">rcvr</span><span class="op" id="2932304">.</span><span class="ident" id="2932305">Kind</span><span class="op" id="2932309">(</span><span class="op" id="2932310">)</span>&nbsp;<span class="op" id="2932312">==</span>&nbsp;<span class="ident" id="2932315">Interface</span>&nbsp;<span class="op" id="2932325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2932329">panic</span><span class="op" id="2932334">(</span><span class="string" id="2932335">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2932382">+</span>&nbsp;<span class="ident" id="2932384">rcvr</span><span class="op" id="2932388">.</span><span class="ident" id="2932389">String</span><span class="op" id="2932395">(</span><span class="op" id="2932396">)</span><span class="op" id="2932397">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932403">k</span>&nbsp;<span class="op" id="2932405">:=</span>&nbsp;<span class="ident" id="2932408">layoutKey</span><span class="op" id="2932417">{</span><span class="ident" id="2932418">t</span><span class="op" id="2932419">,</span>&nbsp;<span class="ident" id="2932421">rcvr</span><span class="op" id="2932425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932428">layoutCache</span><span class="op" id="2932439">.</span><span class="ident" id="2932440">RLock</span><span class="op" id="2932445">(</span><span class="op" id="2932446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932449">if</span>&nbsp;<span class="ident" id="2932452">x</span>&nbsp;<span class="op" id="2932454">:=</span>&nbsp;<span class="ident" id="2932457">layoutCache</span><span class="op" id="2932468">.</span><span class="ident" id="2932469">m</span><span class="op" id="2932470">[</span><span class="ident" id="2932471">k</span><span class="op" id="2932472">]</span><span class="op" id="2932473">;</span>&nbsp;<span class="ident" id="2932475">x</span><span class="op" id="2932476">.</span><span class="ident" id="2932477">t</span>&nbsp;<span class="op" id="2932479">!=</span>&nbsp;<span class="ident" id="2932482">nil</span>&nbsp;<span class="op" id="2932486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932490">layoutCache</span><span class="op" id="2932501">.</span><span class="ident" id="2932502">RUnlock</span><span class="op" id="2932509">(</span><span class="op" id="2932510">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932514">return</span>&nbsp;<span class="ident" id="2932521">x</span><span class="op" id="2932522">.</span><span class="ident" id="2932523">t</span><span class="op" id="2932524">,</span>&nbsp;<span class="ident" id="2932526">x</span><span class="op" id="2932527">.</span><span class="ident" id="2932528">argSize</span><span class="op" id="2932535">,</span>&nbsp;<span class="ident" id="2932537">x</span><span class="op" id="2932538">.</span><span class="ident" id="2932539">retOffset</span><span class="op" id="2932548">,</span>&nbsp;<span class="ident" id="2932550">x</span><span class="op" id="2932551">.</span><span class="ident" id="2932552">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932562">layoutCache</span><span class="op" id="2932573">.</span><span class="ident" id="2932574">RUnlock</span><span class="op" id="2932581">(</span><span class="op" id="2932582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932585">layoutCache</span><span class="op" id="2932596">.</span><span class="ident" id="2932597">Lock</span><span class="op" id="2932601">(</span><span class="op" id="2932602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932605">if</span>&nbsp;<span class="ident" id="2932608">x</span>&nbsp;<span class="op" id="2932610">:=</span>&nbsp;<span class="ident" id="2932613">layoutCache</span><span class="op" id="2932624">.</span><span class="ident" id="2932625">m</span><span class="op" id="2932626">[</span><span class="ident" id="2932627">k</span><span class="op" id="2932628">]</span><span class="op" id="2932629">;</span>&nbsp;<span class="ident" id="2932631">x</span><span class="op" id="2932632">.</span><span class="ident" id="2932633">t</span>&nbsp;<span class="op" id="2932635">!=</span>&nbsp;<span class="ident" id="2932638">nil</span>&nbsp;<span class="op" id="2932642">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932646">layoutCache</span><span class="op" id="2932657">.</span><span class="ident" id="2932658">Unlock</span><span class="op" id="2932664">(</span><span class="op" id="2932665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932669">return</span>&nbsp;<span class="ident" id="2932676">x</span><span class="op" id="2932677">.</span><span class="ident" id="2932678">t</span><span class="op" id="2932679">,</span>&nbsp;<span class="ident" id="2932681">x</span><span class="op" id="2932682">.</span><span class="ident" id="2932683">argSize</span><span class="op" id="2932690">,</span>&nbsp;<span class="ident" id="2932692">x</span><span class="op" id="2932693">.</span><span class="ident" id="2932694">retOffset</span><span class="op" id="2932703">,</span>&nbsp;<span class="ident" id="2932705">x</span><span class="op" id="2932706">.</span><span class="ident" id="2932707">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932718">tt</span>&nbsp;<span class="op" id="2932721">:=</span>&nbsp;<span class="op" id="2932724">(</span><span class="op" id="2932725">*</span><span class="ident" id="2932726">funcType</span><span class="op" id="2932734">)</span><span class="op" id="2932735">(</span><span class="ident" id="2932736">unsafe</span><span class="op" id="2932742">.</span><span class="ident" id="2932743">Pointer</span><span class="op" id="2932750">(</span><span class="ident" id="2932751">t</span><span class="op" id="2932752">)</span><span class="op" id="2932753">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2932757">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932809">stack</span>&nbsp;<span class="op" id="2932815">=</span>&nbsp;<span class="builtinfunc" id="2932817">new</span><span class="op" id="2932820">(</span><span class="ident" id="2932821">bitVector</span><span class="op" id="2932830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932833">var</span>&nbsp;<span class="ident" id="2932837">gc</span>&nbsp;<span class="ident" id="2932840">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932848">var</span>&nbsp;<span class="ident" id="2932852">offset</span>&nbsp;<span class="builtintype" id="2932859">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932868">if</span>&nbsp;<span class="ident" id="2932871">rcvr</span>&nbsp;<span class="op" id="2932876">!=</span>&nbsp;<span class="ident" id="2932879">nil</span>&nbsp;<span class="op" id="2932883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2932887">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2932944">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933000">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933048">if</span>&nbsp;<span class="ident" id="2933051">ifaceIndir</span><span class="op" id="2933061">(</span><span class="ident" id="2933062">rcvr</span><span class="op" id="2933066">)</span>&nbsp;<span class="op" id="2933068">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933073">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933114">gc</span><span class="op" id="2933116">.</span><span class="builtinfunc" id="2933117">append</span><span class="op" id="2933123">(</span><span class="ident" id="2933124">bitsPointer</span><span class="op" id="2933135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933140">stack</span><span class="op" id="2933145">.</span><span class="ident" id="2933146">append2</span><span class="op" id="2933153">(</span><span class="ident" id="2933154">bitsPointer</span><span class="op" id="2933165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933169">}</span>&nbsp;<span class="keyword" id="2933171">else</span>&nbsp;<span class="keyword" id="2933176">if</span>&nbsp;<span class="ident" id="2933179">rcvr</span><span class="op" id="2933183">.</span><span class="ident" id="2933184">pointers</span><span class="op" id="2933192">(</span><span class="op" id="2933193">)</span>&nbsp;<span class="op" id="2933195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933200">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933257">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933290">gc</span><span class="op" id="2933292">.</span><span class="builtinfunc" id="2933293">append</span><span class="op" id="2933299">(</span><span class="ident" id="2933300">bitsPointer</span><span class="op" id="2933311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933316">stack</span><span class="op" id="2933321">.</span><span class="ident" id="2933322">append2</span><span class="op" id="2933329">(</span><span class="ident" id="2933330">bitsPointer</span><span class="op" id="2933341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933345">}</span>&nbsp;<span class="keyword" id="2933347">else</span>&nbsp;<span class="op" id="2933352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933357">gc</span><span class="op" id="2933359">.</span><span class="builtinfunc" id="2933360">append</span><span class="op" id="2933366">(</span><span class="ident" id="2933367">bitsScalar</span><span class="op" id="2933377">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933382">stack</span><span class="op" id="2933387">.</span><span class="ident" id="2933388">append2</span><span class="op" id="2933395">(</span><span class="ident" id="2933396">bitsScalar</span><span class="op" id="2933406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933414">offset</span>&nbsp;<span class="op" id="2933421">+=</span>&nbsp;<span class="ident" id="2933424">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933436">for</span>&nbsp;<span class="ident" id="2933440">_</span><span class="op" id="2933441">,</span>&nbsp;<span class="ident" id="2933443">arg</span>&nbsp;<span class="op" id="2933447">:=</span>&nbsp;<span class="keyword" id="2933450">range</span>&nbsp;<span class="ident" id="2933456">tt</span><span class="op" id="2933458">.</span><span class="ident" id="2933459">in</span>&nbsp;<span class="op" id="2933462">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933466">gc</span><span class="op" id="2933468">.</span><span class="ident" id="2933469">appendProg</span><span class="op" id="2933479">(</span><span class="ident" id="2933480">arg</span><span class="op" id="2933483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933487">addTypeBits</span><span class="op" id="2933498">(</span><span class="ident" id="2933499">stack</span><span class="op" id="2933504">,</span>&nbsp;<span class="op" id="2933506">&amp;</span><span class="ident" id="2933507">offset</span><span class="op" id="2933513">,</span>&nbsp;<span class="ident" id="2933515">arg</span><span class="op" id="2933518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933524">argSize</span>&nbsp;<span class="op" id="2933532">=</span>&nbsp;<span class="ident" id="2933534">gc</span><span class="op" id="2933536">.</span><span class="ident" id="2933537">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933543">if</span>&nbsp;<span class="ident" id="2933546">runtime</span><span class="op" id="2933553">.</span><span class="ident" id="2933554">GOARCH</span>&nbsp;<span class="op" id="2933561">==</span>&nbsp;<span class="string" id="2933564">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2933575">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933579">gc</span><span class="op" id="2933581">.</span><span class="ident" id="2933582">align</span><span class="op" id="2933587">(</span><span class="num" id="2933588">8</span><span class="op" id="2933589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933595">gc</span><span class="op" id="2933597">.</span><span class="ident" id="2933598">align</span><span class="op" id="2933603">(</span><span class="ident" id="2933604">ptrSize</span><span class="op" id="2933611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933614">retOffset</span>&nbsp;<span class="op" id="2933624">=</span>&nbsp;<span class="ident" id="2933626">gc</span><span class="op" id="2933628">.</span><span class="ident" id="2933629">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933635">for</span>&nbsp;<span class="ident" id="2933639">_</span><span class="op" id="2933640">,</span>&nbsp;<span class="ident" id="2933642">res</span>&nbsp;<span class="op" id="2933646">:=</span>&nbsp;<span class="keyword" id="2933649">range</span>&nbsp;<span class="ident" id="2933655">tt</span><span class="op" id="2933657">.</span><span class="ident" id="2933658">out</span>&nbsp;<span class="op" id="2933662">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933666">gc</span><span class="op" id="2933668">.</span><span class="ident" id="2933669">appendProg</span><span class="op" id="2933679">(</span><span class="ident" id="2933680">res</span><span class="op" id="2933683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933687">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933730">gc</span><span class="op" id="2933732">.</span><span class="ident" id="2933733">align</span><span class="op" id="2933738">(</span><span class="ident" id="2933739">ptrSize</span><span class="op" id="2933746">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2933750">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933791">x</span>&nbsp;<span class="op" id="2933793">:=</span>&nbsp;<span class="builtinfunc" id="2933796">new</span><span class="op" id="2933799">(</span><span class="ident" id="2933800">rtype</span><span class="op" id="2933805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933808">x</span><span class="op" id="2933809">.</span><span class="ident" id="2933810">size</span>&nbsp;<span class="op" id="2933815">=</span>&nbsp;<span class="ident" id="2933817">gc</span><span class="op" id="2933819">.</span><span class="ident" id="2933820">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933826">x</span><span class="op" id="2933827">.</span><span class="ident" id="2933828">gc</span><span class="op" id="2933830">[</span><span class="num" id="2933831">0</span><span class="op" id="2933832">]</span>&nbsp;<span class="op" id="2933834">=</span>&nbsp;<span class="ident" id="2933836">gc</span><span class="op" id="2933838">.</span><span class="ident" id="2933839">finalize</span><span class="op" id="2933847">(</span><span class="op" id="2933848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933851">var</span>&nbsp;<span class="ident" id="2933855">s</span>&nbsp;<span class="builtintype" id="2933857">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2933865">if</span>&nbsp;<span class="ident" id="2933868">rcvr</span>&nbsp;<span class="op" id="2933873">!=</span>&nbsp;<span class="ident" id="2933876">nil</span>&nbsp;<span class="op" id="2933880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933884">s</span>&nbsp;<span class="op" id="2933886">=</span>&nbsp;<span class="string" id="2933888">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2933902">+</span>&nbsp;<span class="op" id="2933904">*</span><span class="ident" id="2933905">rcvr</span><span class="op" id="2933909">.</span><span class="builtintype" id="2933910">string</span>&nbsp;<span class="op" id="2933917">+</span>&nbsp;<span class="string" id="2933919">&#34;)(&#34;</span>&nbsp;<span class="op" id="2933924">+</span>&nbsp;<span class="op" id="2933926">*</span><span class="ident" id="2933927">t</span><span class="op" id="2933928">.</span><span class="builtintype" id="2933929">string</span>&nbsp;<span class="op" id="2933936">+</span>&nbsp;<span class="string" id="2933938">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933943">}</span>&nbsp;<span class="keyword" id="2933945">else</span>&nbsp;<span class="op" id="2933950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933954">s</span>&nbsp;<span class="op" id="2933956">=</span>&nbsp;<span class="string" id="2933958">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2933970">+</span>&nbsp;<span class="op" id="2933972">*</span><span class="ident" id="2933973">t</span><span class="op" id="2933974">.</span><span class="builtintype" id="2933975">string</span>&nbsp;<span class="op" id="2933982">+</span>&nbsp;<span class="string" id="2933984">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2933989">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2933992">x</span><span class="op" id="2933993">.</span><span class="builtintype" id="2933994">string</span>&nbsp;<span class="op" id="2934001">=</span>&nbsp;<span class="op" id="2934003">&amp;</span><span class="ident" id="2934004">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934008">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934044">if</span>&nbsp;<span class="ident" id="2934047">layoutCache</span><span class="op" id="2934058">.</span><span class="ident" id="2934059">m</span>&nbsp;<span class="op" id="2934061">==</span>&nbsp;<span class="ident" id="2934064">nil</span>&nbsp;<span class="op" id="2934068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934072">layoutCache</span><span class="op" id="2934083">.</span><span class="ident" id="2934084">m</span>&nbsp;<span class="op" id="2934086">=</span>&nbsp;<span class="builtinfunc" id="2934088">make</span><span class="op" id="2934092">(</span><span class="keyword" id="2934093">map</span><span class="op" id="2934096">[</span><span class="ident" id="2934097">layoutKey</span><span class="op" id="2934106">]</span><span class="ident" id="2934107">layoutType</span><span class="op" id="2934117">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934123">layoutCache</span><span class="op" id="2934134">.</span><span class="ident" id="2934135">m</span><span class="op" id="2934136">[</span><span class="ident" id="2934137">k</span><span class="op" id="2934138">]</span>&nbsp;<span class="op" id="2934140">=</span>&nbsp;<span class="ident" id="2934142">layoutType</span><span class="op" id="2934152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934156">t</span><span class="op" id="2934157">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2934167">x</span><span class="op" id="2934168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934172">argSize</span><span class="op" id="2934179">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2934183">argSize</span><span class="op" id="2934190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934194">retOffset</span><span class="op" id="2934203">:</span>&nbsp;<span class="ident" id="2934205">retOffset</span><span class="op" id="2934214">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934218">stack</span><span class="op" id="2934223">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2934229">stack</span><span class="op" id="2934234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934240">layoutCache</span><span class="op" id="2934251">.</span><span class="ident" id="2934252">Unlock</span><span class="op" id="2934258">(</span><span class="op" id="2934259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934262">return</span>&nbsp;<span class="ident" id="2934269">x</span><span class="op" id="2934270">,</span>&nbsp;<span class="ident" id="2934272">argSize</span><span class="op" id="2934279">,</span>&nbsp;<span class="ident" id="2934281">retOffset</span><span class="op" id="2934290">,</span>&nbsp;<span class="ident" id="2934292">stack</span><br>
<span class="lineno"></span><span class="op" id="2934298">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2934301">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2934377">func</span>&nbsp;<span class="ident" id="2934382">ifaceIndir</span><span class="op" id="2934392">(</span><span class="ident" id="2934393">t</span>&nbsp;<span class="op" id="2934395">*</span><span class="ident" id="2934396">rtype</span><span class="op" id="2934401">)</span>&nbsp;<span class="builtintype" id="2934403">bool</span>&nbsp;<span class="op" id="2934408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934411">return</span>&nbsp;<span class="ident" id="2934418">t</span><span class="op" id="2934419">.</span><span class="ident" id="2934420">kind</span><span class="op" id="2934424">&amp;</span><span class="ident" id="2934425">kindDirectIface</span>&nbsp;<span class="op" id="2934441">==</span>&nbsp;<span class="num" id="2934444">0</span><br>
<span class="lineno"></span><span class="op" id="2934446">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2934449">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2934500">type</span>&nbsp;<span class="ident" id="2934505">bitVector</span>&nbsp;<span class="keyword" id="2934515">struct</span>&nbsp;<span class="op" id="2934522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934525">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2934530">uint32</span>&nbsp;<span class="comment" id="2934537">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934556">data</span>&nbsp;<span class="op" id="2934561">[</span><span class="op" id="2934562">]</span><span class="builtintype" id="2934563">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2934568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2934571">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2934607">func</span>&nbsp;<span class="op" id="2934612">(</span><span class="ident" id="2934613">bv</span>&nbsp;<span class="op" id="2934616">*</span><span class="ident" id="2934617">bitVector</span><span class="op" id="2934626">)</span>&nbsp;<span class="ident" id="2934628">append2</span><span class="op" id="2934635">(</span><span class="ident" id="2934636">bits</span>&nbsp;<span class="builtintype" id="2934641">uint8</span><span class="op" id="2934646">)</span>&nbsp;<span class="op" id="2934648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934651">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934724">if</span>&nbsp;<span class="ident" id="2934727">bv</span><span class="op" id="2934729">.</span><span class="ident" id="2934730">n</span><span class="op" id="2934731">%</span><span class="num" id="2934732">8</span>&nbsp;<span class="op" id="2934734">==</span>&nbsp;<span class="num" id="2934737">0</span>&nbsp;<span class="op" id="2934739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934743">bv</span><span class="op" id="2934745">.</span><span class="ident" id="2934746">data</span>&nbsp;<span class="op" id="2934751">=</span>&nbsp;<span class="builtinfunc" id="2934753">append</span><span class="op" id="2934759">(</span><span class="ident" id="2934760">bv</span><span class="op" id="2934762">.</span><span class="ident" id="2934763">data</span><span class="op" id="2934767">,</span>&nbsp;<span class="num" id="2934769">0</span><span class="op" id="2934770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934776">bv</span><span class="op" id="2934778">.</span><span class="ident" id="2934779">data</span><span class="op" id="2934783">[</span><span class="ident" id="2934784">bv</span><span class="op" id="2934786">.</span><span class="ident" id="2934787">n</span><span class="op" id="2934788">/</span><span class="num" id="2934789">8</span><span class="op" id="2934790">]</span>&nbsp;<span class="op" id="2934792">|=</span>&nbsp;<span class="ident" id="2934795">bits</span>&nbsp;<span class="op" id="2934800">&lt;&lt;</span>&nbsp;<span class="op" id="2934803">(</span><span class="ident" id="2934804">bv</span><span class="op" id="2934806">.</span><span class="ident" id="2934807">n</span>&nbsp;<span class="op" id="2934809">%</span>&nbsp;<span class="num" id="2934811">8</span><span class="op" id="2934812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934815">bv</span><span class="op" id="2934817">.</span><span class="ident" id="2934818">n</span>&nbsp;<span class="op" id="2934820">+=</span>&nbsp;<span class="num" id="2934823">2</span><br>
<span class="lineno">1885</span><span class="op" id="2934825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2934828">func</span>&nbsp;<span class="ident" id="2934833">addTypeBits</span><span class="op" id="2934844">(</span><span class="ident" id="2934845">bv</span>&nbsp;<span class="op" id="2934848">*</span><span class="ident" id="2934849">bitVector</span><span class="op" id="2934858">,</span>&nbsp;<span class="ident" id="2934860">offset</span>&nbsp;<span class="op" id="2934867">*</span><span class="builtintype" id="2934868">uintptr</span><span class="op" id="2934875">,</span>&nbsp;<span class="ident" id="2934877">t</span>&nbsp;<span class="op" id="2934879">*</span><span class="ident" id="2934880">rtype</span><span class="op" id="2934885">)</span>&nbsp;<span class="op" id="2934887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934890">*</span><span class="ident" id="2934891">offset</span>&nbsp;<span class="op" id="2934898">=</span>&nbsp;<span class="ident" id="2934900">align</span><span class="op" id="2934905">(</span><span class="op" id="2934906">*</span><span class="ident" id="2934907">offset</span><span class="op" id="2934913">,</span>&nbsp;<span class="builtintype" id="2934915">uintptr</span><span class="op" id="2934922">(</span><span class="ident" id="2934923">t</span><span class="op" id="2934924">.</span><span class="ident" id="2934925">align</span><span class="op" id="2934930">)</span><span class="op" id="2934931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934934">if</span>&nbsp;<span class="ident" id="2934937">t</span><span class="op" id="2934938">.</span><span class="ident" id="2934939">kind</span><span class="op" id="2934943">&amp;</span><span class="ident" id="2934944">kindNoPointers</span>&nbsp;<span class="op" id="2934959">!=</span>&nbsp;<span class="num" id="2934962">0</span>&nbsp;<span class="op" id="2934964">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934968">*</span><span class="ident" id="2934969">offset</span>&nbsp;<span class="op" id="2934976">+=</span>&nbsp;<span class="ident" id="2934979">t</span><span class="op" id="2934980">.</span><span class="ident" id="2934981">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934988">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935000">switch</span>&nbsp;<span class="ident" id="2935007">Kind</span><span class="op" id="2935011">(</span><span class="ident" id="2935012">t</span><span class="op" id="2935013">.</span><span class="ident" id="2935014">kind</span>&nbsp;<span class="op" id="2935019">&amp;</span>&nbsp;<span class="ident" id="2935021">kindMask</span><span class="op" id="2935029">)</span>&nbsp;<span class="op" id="2935031">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935034">case</span>&nbsp;<span class="ident" id="2935039">Chan</span><span class="op" id="2935043">,</span>&nbsp;<span class="ident" id="2935045">Func</span><span class="op" id="2935049">,</span>&nbsp;<span class="ident" id="2935051">Map</span><span class="op" id="2935054">,</span>&nbsp;<span class="ident" id="2935056">Ptr</span><span class="op" id="2935059">,</span>&nbsp;<span class="ident" id="2935061">Slice</span><span class="op" id="2935066">,</span>&nbsp;<span class="ident" id="2935068">String</span><span class="op" id="2935074">,</span>&nbsp;<span class="ident" id="2935076">UnsafePointer</span><span class="op" id="2935089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935093">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935135">for</span>&nbsp;<span class="ident" id="2935139">bv</span><span class="op" id="2935141">.</span><span class="ident" id="2935142">n</span>&nbsp;<span class="op" id="2935144">&lt;</span>&nbsp;<span class="num" id="2935146">2</span><span class="op" id="2935147">*</span><span class="builtintype" id="2935148">uint32</span><span class="op" id="2935154">(</span><span class="op" id="2935155">*</span><span class="ident" id="2935156">offset</span><span class="op" id="2935162">/</span><span class="builtintype" id="2935163">uintptr</span><span class="op" id="2935170">(</span><span class="ident" id="2935171">ptrSize</span><span class="op" id="2935178">)</span><span class="op" id="2935179">)</span>&nbsp;<span class="op" id="2935181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935186">bv</span><span class="op" id="2935188">.</span><span class="ident" id="2935189">append2</span><span class="op" id="2935196">(</span><span class="ident" id="2935197">bitsScalar</span><span class="op" id="2935207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935211">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935215">bv</span><span class="op" id="2935217">.</span><span class="ident" id="2935218">append2</span><span class="op" id="2935225">(</span><span class="ident" id="2935226">bitsPointer</span><span class="op" id="2935237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935241">case</span>&nbsp;<span class="ident" id="2935246">Interface</span><span class="op" id="2935255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935259">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935275">for</span>&nbsp;<span class="ident" id="2935279">bv</span><span class="op" id="2935281">.</span><span class="ident" id="2935282">n</span>&nbsp;<span class="op" id="2935284">&lt;</span>&nbsp;<span class="num" id="2935286">2</span><span class="op" id="2935287">*</span><span class="builtintype" id="2935288">uint32</span><span class="op" id="2935294">(</span><span class="op" id="2935295">*</span><span class="ident" id="2935296">offset</span><span class="op" id="2935302">/</span><span class="builtintype" id="2935303">uintptr</span><span class="op" id="2935310">(</span><span class="ident" id="2935311">ptrSize</span><span class="op" id="2935318">)</span><span class="op" id="2935319">)</span>&nbsp;<span class="op" id="2935321">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935326">bv</span><span class="op" id="2935328">.</span><span class="ident" id="2935329">append2</span><span class="op" id="2935336">(</span><span class="ident" id="2935337">bitsScalar</span><span class="op" id="2935347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935355">bv</span><span class="op" id="2935357">.</span><span class="ident" id="2935358">append2</span><span class="op" id="2935365">(</span><span class="ident" id="2935366">bitsPointer</span><span class="op" id="2935377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935381">bv</span><span class="op" id="2935383">.</span><span class="ident" id="2935384">append2</span><span class="op" id="2935391">(</span><span class="ident" id="2935392">bitsPointer</span><span class="op" id="2935403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935407">case</span>&nbsp;<span class="ident" id="2935412">Array</span><span class="op" id="2935417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935421">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935444">tt</span>&nbsp;<span class="op" id="2935447">:=</span>&nbsp;<span class="op" id="2935450">(</span><span class="op" id="2935451">*</span><span class="ident" id="2935452">arrayType</span><span class="op" id="2935461">)</span><span class="op" id="2935462">(</span><span class="ident" id="2935463">unsafe</span><span class="op" id="2935469">.</span><span class="ident" id="2935470">Pointer</span><span class="op" id="2935477">(</span><span class="ident" id="2935478">t</span><span class="op" id="2935479">)</span><span class="op" id="2935480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935484">for</span>&nbsp;<span class="ident" id="2935488">i</span>&nbsp;<span class="op" id="2935490">:=</span>&nbsp;<span class="num" id="2935493">0</span><span class="op" id="2935494">;</span>&nbsp;<span class="ident" id="2935496">i</span>&nbsp;<span class="op" id="2935498">&lt;</span>&nbsp;<span class="builtintype" id="2935500">int</span><span class="op" id="2935503">(</span><span class="ident" id="2935504">tt</span><span class="op" id="2935506">.</span><span class="builtinfunc" id="2935507">len</span><span class="op" id="2935510">)</span><span class="op" id="2935511">;</span>&nbsp;<span class="ident" id="2935513">i</span><span class="op" id="2935514">++</span>&nbsp;<span class="op" id="2935517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935522">addTypeBits</span><span class="op" id="2935533">(</span><span class="ident" id="2935534">bv</span><span class="op" id="2935536">,</span>&nbsp;<span class="ident" id="2935538">offset</span><span class="op" id="2935544">,</span>&nbsp;<span class="ident" id="2935546">tt</span><span class="op" id="2935548">.</span><span class="ident" id="2935549">elem</span><span class="op" id="2935553">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935561">case</span>&nbsp;<span class="ident" id="2935566">Struct</span><span class="op" id="2935572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935576">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935594">tt</span>&nbsp;<span class="op" id="2935597">:=</span>&nbsp;<span class="op" id="2935600">(</span><span class="op" id="2935601">*</span><span class="ident" id="2935602">structType</span><span class="op" id="2935612">)</span><span class="op" id="2935613">(</span><span class="ident" id="2935614">unsafe</span><span class="op" id="2935620">.</span><span class="ident" id="2935621">Pointer</span><span class="op" id="2935628">(</span><span class="ident" id="2935629">t</span><span class="op" id="2935630">)</span><span class="op" id="2935631">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935635">start</span>&nbsp;<span class="op" id="2935641">:=</span>&nbsp;<span class="op" id="2935644">*</span><span class="ident" id="2935645">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935654">for</span>&nbsp;<span class="ident" id="2935658">i</span>&nbsp;<span class="op" id="2935660">:=</span>&nbsp;<span class="keyword" id="2935663">range</span>&nbsp;<span class="ident" id="2935669">tt</span><span class="op" id="2935671">.</span><span class="ident" id="2935672">fields</span>&nbsp;<span class="op" id="2935679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935684">f</span>&nbsp;<span class="op" id="2935686">:=</span>&nbsp;<span class="op" id="2935689">&amp;</span><span class="ident" id="2935690">tt</span><span class="op" id="2935692">.</span><span class="ident" id="2935693">fields</span><span class="op" id="2935699">[</span><span class="ident" id="2935700">i</span><span class="op" id="2935701">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935706">off</span>&nbsp;<span class="op" id="2935710">:=</span>&nbsp;<span class="ident" id="2935713">start</span>&nbsp;<span class="op" id="2935719">+</span>&nbsp;<span class="ident" id="2935721">f</span><span class="op" id="2935722">.</span><span class="ident" id="2935723">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935733">addTypeBits</span><span class="op" id="2935744">(</span><span class="ident" id="2935745">bv</span><span class="op" id="2935747">,</span>&nbsp;<span class="op" id="2935749">&amp;</span><span class="ident" id="2935750">off</span><span class="op" id="2935753">,</span>&nbsp;<span class="ident" id="2935755">f</span><span class="op" id="2935756">.</span><span class="ident" id="2935757">typ</span><span class="op" id="2935760">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935771">*</span><span class="ident" id="2935772">offset</span>&nbsp;<span class="op" id="2935779">+=</span>&nbsp;<span class="ident" id="2935782">t</span><span class="op" id="2935783">.</span><span class="ident" id="2935784">size</span><br>
<span class="lineno"></span><span class="op" id="2935789">}</span>
</div>
</body>
</html>
