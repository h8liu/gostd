<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4363209">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4363264">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4363318">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4363369">package</span>&nbsp;<span class="ident" id="4363377">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4363383">import</span>&nbsp;<span class="op" id="4363390">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363393">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363409">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363428">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363445">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363455">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363462">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4363473">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4363476">const</span>&nbsp;<span class="ident" id="4363482">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4363499">=</span>&nbsp;<span class="num" id="4363501">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4363504">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4363576">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4363591">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4363604">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4363665">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4363738">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4363763">type</span>&nbsp;<span class="ident" id="4363768">ecPrivateKey</span>&nbsp;<span class="keyword" id="4363781">struct</span>&nbsp;<span class="op" id="4363788">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4363791">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4363805">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4363810">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4363824">[</span><span class="op" id="4363825">]</span><span class="builtintype" id="4363826">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4363832">NamedCurveOID</span>&nbsp;<span class="ident" id="4363846">asn1</span><span class="op" id="4363850">.</span><span class="ident" id="4363851">ObjectIdentifier</span>&nbsp;<span class="string" id="4363868">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4363902">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4363916">asn1</span><span class="op" id="4363920">.</span><span class="ident" id="4363921">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4363938">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4363971">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4363974">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4364049">func</span>&nbsp;<span class="ident" id="4364054">ParseECPrivateKey</span><span class="op" id="4364071">(</span><span class="ident" id="4364072">der</span>&nbsp;<span class="op" id="4364076">[</span><span class="op" id="4364077">]</span><span class="builtintype" id="4364078">byte</span><span class="op" id="4364082">)</span>&nbsp;<span class="op" id="4364084">(</span><span class="ident" id="4364085">key</span>&nbsp;<span class="op" id="4364089">*</span><span class="ident" id="4364090">ecdsa</span><span class="op" id="4364095">.</span><span class="ident" id="4364096">PrivateKey</span><span class="op" id="4364106">,</span>&nbsp;<span class="ident" id="4364108">err</span>&nbsp;<span class="builtintype" id="4364112">error</span><span class="op" id="4364117">)</span>&nbsp;<span class="op" id="4364119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4364122">return</span>&nbsp;<span class="ident" id="4364129">parseECPrivateKey</span><span class="op" id="4364146">(</span><span class="builtintype" id="4364147">nil</span><span class="op" id="4364150">,</span>&nbsp;<span class="ident" id="4364152">der</span><span class="op" id="4364155">)</span><br>
<span class="lineno"></span><span class="op" id="4364157">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4364160">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4364234">func</span>&nbsp;<span class="ident" id="4364239">MarshalECPrivateKey</span><span class="op" id="4364258">(</span><span class="ident" id="4364259">key</span>&nbsp;<span class="op" id="4364263">*</span><span class="ident" id="4364264">ecdsa</span><span class="op" id="4364269">.</span><span class="ident" id="4364270">PrivateKey</span><span class="op" id="4364280">)</span>&nbsp;<span class="op" id="4364282">(</span><span class="op" id="4364283">[</span><span class="op" id="4364284">]</span><span class="builtintype" id="4364285">byte</span><span class="op" id="4364289">,</span>&nbsp;<span class="builtintype" id="4364291">error</span><span class="op" id="4364296">)</span>&nbsp;<span class="op" id="4364298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364301">oid</span><span class="op" id="4364304">,</span>&nbsp;<span class="ident" id="4364306">ok</span>&nbsp;<span class="op" id="4364309">:=</span>&nbsp;<span class="ident" id="4364312">oidFromNamedCurve</span><span class="op" id="4364329">(</span><span class="ident" id="4364330">key</span><span class="op" id="4364333">.</span><span class="ident" id="4364334">Curve</span><span class="op" id="4364339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4364342">if</span>&nbsp;<span class="op" id="4364345">!</span><span class="ident" id="4364346">ok</span>&nbsp;<span class="op" id="4364349">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4364353">return</span>&nbsp;<span class="builtintype" id="4364360">nil</span><span class="op" id="4364363">,</span>&nbsp;<span class="ident" id="4364365">errors</span><span class="op" id="4364371">.</span><span class="ident" id="4364372">New</span><span class="op" id="4364375">(</span><span class="string" id="4364376">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4364406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4364409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4364412">return</span>&nbsp;<span class="ident" id="4364419">asn1</span><span class="op" id="4364423">.</span><span class="ident" id="4364424">Marshal</span><span class="op" id="4364431">(</span><span class="ident" id="4364432">ecPrivateKey</span><span class="op" id="4364444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364448">Version</span><span class="op" id="4364455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4364463">1</span><span class="op" id="4364464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364468">PrivateKey</span><span class="op" id="4364478">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364483">key</span><span class="op" id="4364486">.</span><span class="ident" id="4364487">D</span><span class="op" id="4364488">.</span><span class="ident" id="4364489">Bytes</span><span class="op" id="4364494">(</span><span class="op" id="4364495">)</span><span class="op" id="4364496">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364500">NamedCurveOID</span><span class="op" id="4364513">:</span>&nbsp;<span class="ident" id="4364515">oid</span><span class="op" id="4364518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364522">PublicKey</span><span class="op" id="4364531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4364537">asn1</span><span class="op" id="4364541">.</span><span class="ident" id="4364542">BitString</span><span class="op" id="4364551">{</span><span class="ident" id="4364552">Bytes</span><span class="op" id="4364557">:</span>&nbsp;<span class="ident" id="4364559">elliptic</span><span class="op" id="4364567">.</span><span class="ident" id="4364568">Marshal</span><span class="op" id="4364575">(</span><span class="ident" id="4364576">key</span><span class="op" id="4364579">.</span><span class="ident" id="4364580">Curve</span><span class="op" id="4364585">,</span>&nbsp;<span class="ident" id="4364587">key</span><span class="op" id="4364590">.</span><span class="ident" id="4364591">X</span><span class="op" id="4364592">,</span>&nbsp;<span class="ident" id="4364594">key</span><span class="op" id="4364597">.</span><span class="ident" id="4364598">Y</span><span class="op" id="4364599">)</span><span class="op" id="4364600">}</span><span class="op" id="4364601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4364604">}</span><span class="op" id="4364605">)</span><br>
<span class="lineno"></span><span class="op" id="4364607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4364610">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4364685">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4364761">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4364838">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4364889">func</span>&nbsp;<span class="ident" id="4364894">parseECPrivateKey</span><span class="op" id="4364911">(</span><span class="ident" id="4364912">namedCurveOID</span>&nbsp;<span class="op" id="4364926">*</span><span class="ident" id="4364927">asn1</span><span class="op" id="4364931">.</span><span class="ident" id="4364932">ObjectIdentifier</span><span class="op" id="4364948">,</span>&nbsp;<span class="ident" id="4364950">der</span>&nbsp;<span class="op" id="4364954">[</span><span class="op" id="4364955">]</span><span class="builtintype" id="4364956">byte</span><span class="op" id="4364960">)</span>&nbsp;<span class="op" id="4364962">(</span><span class="ident" id="4364963">key</span>&nbsp;<span class="op" id="4364967">*</span><span class="ident" id="4364968">ecdsa</span><span class="op" id="4364973">.</span><span class="ident" id="4364974">PrivateKey</span><span class="op" id="4364984">,</span>&nbsp;<span class="ident" id="4364986">err</span>&nbsp;<span class="builtintype" id="4364990">error</span><span class="op" id="4364995">)</span>&nbsp;<span class="op" id="4364997">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365000">var</span>&nbsp;<span class="ident" id="4365004">privKey</span>&nbsp;<span class="ident" id="4365012">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365026">if</span>&nbsp;<span class="ident" id="4365029">_</span><span class="op" id="4365030">,</span>&nbsp;<span class="ident" id="4365032">err</span>&nbsp;<span class="op" id="4365036">:=</span>&nbsp;<span class="ident" id="4365039">asn1</span><span class="op" id="4365043">.</span><span class="ident" id="4365044">Unmarshal</span><span class="op" id="4365053">(</span><span class="ident" id="4365054">der</span><span class="op" id="4365057">,</span>&nbsp;<span class="op" id="4365059">&amp;</span><span class="ident" id="4365060">privKey</span><span class="op" id="4365067">)</span><span class="op" id="4365068">;</span>&nbsp;<span class="ident" id="4365070">err</span>&nbsp;<span class="op" id="4365074">!=</span>&nbsp;<span class="builtintype" id="4365077">nil</span>&nbsp;<span class="op" id="4365081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365085">return</span>&nbsp;<span class="builtintype" id="4365092">nil</span><span class="op" id="4365095">,</span>&nbsp;<span class="ident" id="4365097">errors</span><span class="op" id="4365103">.</span><span class="ident" id="4365104">New</span><span class="op" id="4365107">(</span><span class="string" id="4365108">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4365149">+</span>&nbsp;<span class="ident" id="4365151">err</span><span class="op" id="4365154">.</span><span class="ident" id="4365155">Error</span><span class="op" id="4365160">(</span><span class="op" id="4365161">)</span><span class="op" id="4365162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365168">if</span>&nbsp;<span class="ident" id="4365171">privKey</span><span class="op" id="4365178">.</span><span class="ident" id="4365179">Version</span>&nbsp;<span class="op" id="4365187">!=</span>&nbsp;<span class="ident" id="4365190">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4365207">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365211">return</span>&nbsp;<span class="builtintype" id="4365218">nil</span><span class="op" id="4365221">,</span>&nbsp;<span class="ident" id="4365223">fmt</span><span class="op" id="4365226">.</span><span class="ident" id="4365227">Errorf</span><span class="op" id="4365233">(</span><span class="string" id="4365234">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4365275">,</span>&nbsp;<span class="ident" id="4365277">privKey</span><span class="op" id="4365284">.</span><span class="ident" id="4365285">Version</span><span class="op" id="4365292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365299">var</span>&nbsp;<span class="ident" id="4365303">curve</span>&nbsp;<span class="ident" id="4365309">elliptic</span><span class="op" id="4365317">.</span><span class="ident" id="4365318">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365325">if</span>&nbsp;<span class="ident" id="4365328">namedCurveOID</span>&nbsp;<span class="op" id="4365342">!=</span>&nbsp;<span class="builtintype" id="4365345">nil</span>&nbsp;<span class="op" id="4365349">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365353">curve</span>&nbsp;<span class="op" id="4365359">=</span>&nbsp;<span class="ident" id="4365361">namedCurveFromOID</span><span class="op" id="4365378">(</span><span class="op" id="4365379">*</span><span class="ident" id="4365380">namedCurveOID</span><span class="op" id="4365393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365396">}</span>&nbsp;<span class="keyword" id="4365398">else</span>&nbsp;<span class="op" id="4365403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365407">curve</span>&nbsp;<span class="op" id="4365413">=</span>&nbsp;<span class="ident" id="4365415">namedCurveFromOID</span><span class="op" id="4365432">(</span><span class="ident" id="4365433">privKey</span><span class="op" id="4365440">.</span><span class="ident" id="4365441">NamedCurveOID</span><span class="op" id="4365454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365460">if</span>&nbsp;<span class="ident" id="4365463">curve</span>&nbsp;<span class="op" id="4365469">==</span>&nbsp;<span class="builtintype" id="4365472">nil</span>&nbsp;<span class="op" id="4365476">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365480">return</span>&nbsp;<span class="builtintype" id="4365487">nil</span><span class="op" id="4365490">,</span>&nbsp;<span class="ident" id="4365492">errors</span><span class="op" id="4365498">.</span><span class="ident" id="4365499">New</span><span class="op" id="4365502">(</span><span class="string" id="4365503">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4365533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365540">k</span>&nbsp;<span class="op" id="4365542">:=</span>&nbsp;<span class="builtinfunc" id="4365545">new</span><span class="op" id="4365548">(</span><span class="ident" id="4365549">big</span><span class="op" id="4365552">.</span><span class="ident" id="4365553">Int</span><span class="op" id="4365556">)</span><span class="op" id="4365557">.</span><span class="ident" id="4365558">SetBytes</span><span class="op" id="4365566">(</span><span class="ident" id="4365567">privKey</span><span class="op" id="4365574">.</span><span class="ident" id="4365575">PrivateKey</span><span class="op" id="4365585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365588">if</span>&nbsp;<span class="ident" id="4365591">k</span><span class="op" id="4365592">.</span><span class="ident" id="4365593">Cmp</span><span class="op" id="4365596">(</span><span class="ident" id="4365597">curve</span><span class="op" id="4365602">.</span><span class="ident" id="4365603">Params</span><span class="op" id="4365609">(</span><span class="op" id="4365610">)</span><span class="op" id="4365611">.</span><span class="ident" id="4365612">N</span><span class="op" id="4365613">)</span>&nbsp;<span class="op" id="4365615">&gt;=</span>&nbsp;<span class="num" id="4365618">0</span>&nbsp;<span class="op" id="4365620">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365624">return</span>&nbsp;<span class="builtintype" id="4365631">nil</span><span class="op" id="4365634">,</span>&nbsp;<span class="ident" id="4365636">errors</span><span class="op" id="4365642">.</span><span class="ident" id="4365643">New</span><span class="op" id="4365646">(</span><span class="string" id="4365647">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4365695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4365698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365701">priv</span>&nbsp;<span class="op" id="4365706">:=</span>&nbsp;<span class="builtinfunc" id="4365709">new</span><span class="op" id="4365712">(</span><span class="ident" id="4365713">ecdsa</span><span class="op" id="4365718">.</span><span class="ident" id="4365719">PrivateKey</span><span class="op" id="4365729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365732">priv</span><span class="op" id="4365736">.</span><span class="ident" id="4365737">Curve</span>&nbsp;<span class="op" id="4365743">=</span>&nbsp;<span class="ident" id="4365745">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365752">priv</span><span class="op" id="4365756">.</span><span class="ident" id="4365757">D</span>&nbsp;<span class="op" id="4365759">=</span>&nbsp;<span class="ident" id="4365761">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4365764">priv</span><span class="op" id="4365768">.</span><span class="ident" id="4365769">X</span><span class="op" id="4365770">,</span>&nbsp;<span class="ident" id="4365772">priv</span><span class="op" id="4365776">.</span><span class="ident" id="4365777">Y</span>&nbsp;<span class="op" id="4365779">=</span>&nbsp;<span class="ident" id="4365781">curve</span><span class="op" id="4365786">.</span><span class="ident" id="4365787">ScalarBaseMult</span><span class="op" id="4365801">(</span><span class="ident" id="4365802">privKey</span><span class="op" id="4365809">.</span><span class="ident" id="4365810">PrivateKey</span><span class="op" id="4365820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4365824">return</span>&nbsp;<span class="ident" id="4365831">priv</span><span class="op" id="4365835">,</span>&nbsp;<span class="builtintype" id="4365837">nil</span><br>
<span class="lineno"></span><span class="op" id="4365841">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
