<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html" class="current">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4416111">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4416166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4416220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4416271">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4416346">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4416420">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4416436">package</span>&nbsp;<span class="ident" id="4416444">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4416451">import</span>&nbsp;<span class="op" id="4416458">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4416461">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4416469">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4416476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4416479">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4416522">const</span>&nbsp;<span class="ident" id="4416528">Size</span>&nbsp;<span class="op" id="4416533">=</span>&nbsp;<span class="num" id="4416535">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4416538">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4416565">const</span>&nbsp;<span class="op" id="4416571">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416574">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416637">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416704">IEEE</span>&nbsp;<span class="op" id="4416709">=</span>&nbsp;<span class="num" id="4416711">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416724">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416768">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416826">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416866">Castagnoli</span>&nbsp;<span class="op" id="4416877">=</span>&nbsp;<span class="num" id="4416879">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416892">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416918">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416981">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417028">Koopman</span>&nbsp;<span class="op" id="4417036">=</span>&nbsp;<span class="num" id="4417038">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4417049">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4417052">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4417135">type</span>&nbsp;<span class="ident" id="4417140">Table</span>&nbsp;<span class="op" id="4417146">[</span><span class="num" id="4417147">256</span><span class="op" id="4417150">]</span><span class="builtintype" id="4417151">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417159">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4417234">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4417310">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4417386">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4417412">var</span>&nbsp;<span class="ident" id="4417416">castagnoliTable</span>&nbsp;<span class="op" id="4417432">*</span><span class="ident" id="4417433">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4417439">var</span>&nbsp;<span class="ident" id="4417443">castagnoliOnce</span>&nbsp;<span class="ident" id="4417458">sync</span><span class="op" id="4417462">.</span><span class="ident" id="4417463">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4417469">func</span>&nbsp;<span class="ident" id="4417474">castagnoliInit</span><span class="op" id="4417488">(</span><span class="op" id="4417489">)</span>&nbsp;<span class="op" id="4417491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417494">castagnoliTable</span>&nbsp;<span class="op" id="4417510">=</span>&nbsp;<span class="ident" id="4417512">makeTable</span><span class="op" id="4417521">(</span><span class="ident" id="4417522">Castagnoli</span><span class="op" id="4417532">)</span><br>
<span class="lineno"></span><span class="op" id="4417534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417537">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4417588">var</span>&nbsp;<span class="ident" id="4417592">IEEETable</span>&nbsp;<span class="op" id="4417602">=</span>&nbsp;<span class="ident" id="4417604">makeTable</span><span class="op" id="4417613">(</span><span class="ident" id="4417614">IEEE</span><span class="op" id="4417618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417621">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4417695">func</span>&nbsp;<span class="ident" id="4417700">MakeTable</span><span class="op" id="4417709">(</span><span class="ident" id="4417710">poly</span>&nbsp;<span class="builtintype" id="4417715">uint32</span><span class="op" id="4417721">)</span>&nbsp;<span class="op" id="4417723">*</span><span class="ident" id="4417724">Table</span>&nbsp;<span class="op" id="4417730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417733">switch</span>&nbsp;<span class="ident" id="4417740">poly</span>&nbsp;<span class="op" id="4417745">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417748">case</span>&nbsp;<span class="ident" id="4417753">IEEE</span><span class="op" id="4417757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417761">return</span>&nbsp;<span class="ident" id="4417768">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417779">case</span>&nbsp;<span class="ident" id="4417784">Castagnoli</span><span class="op" id="4417794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417798">castagnoliOnce</span><span class="op" id="4417812">.</span><span class="ident" id="4417813">Do</span><span class="op" id="4417815">(</span><span class="ident" id="4417816">castagnoliInit</span><span class="op" id="4417830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417834">return</span>&nbsp;<span class="ident" id="4417841">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417861">return</span>&nbsp;<span class="ident" id="4417868">makeTable</span><span class="op" id="4417877">(</span><span class="ident" id="4417878">poly</span><span class="op" id="4417882">)</span><br>
<span class="lineno"></span><span class="op" id="4417884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417887">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4417961">func</span>&nbsp;<span class="ident" id="4417966">makeTable</span><span class="op" id="4417975">(</span><span class="ident" id="4417976">poly</span>&nbsp;<span class="builtintype" id="4417981">uint32</span><span class="op" id="4417987">)</span>&nbsp;<span class="op" id="4417989">*</span><span class="ident" id="4417990">Table</span>&nbsp;<span class="op" id="4417996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417999">t</span>&nbsp;<span class="op" id="4418001">:=</span>&nbsp;<span class="builtinfunc" id="4418004">new</span><span class="op" id="4418007">(</span><span class="ident" id="4418008">Table</span><span class="op" id="4418013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418016">for</span>&nbsp;<span class="ident" id="4418020">i</span>&nbsp;<span class="op" id="4418022">:=</span>&nbsp;<span class="num" id="4418025">0</span><span class="op" id="4418026">;</span>&nbsp;<span class="ident" id="4418028">i</span>&nbsp;<span class="op" id="4418030">&lt;</span>&nbsp;<span class="num" id="4418032">256</span><span class="op" id="4418035">;</span>&nbsp;<span class="ident" id="4418037">i</span><span class="op" id="4418038">++</span>&nbsp;<span class="op" id="4418041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418045">crc</span>&nbsp;<span class="op" id="4418049">:=</span>&nbsp;<span class="builtintype" id="4418052">uint32</span><span class="op" id="4418058">(</span><span class="ident" id="4418059">i</span><span class="op" id="4418060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418064">for</span>&nbsp;<span class="ident" id="4418068">j</span>&nbsp;<span class="op" id="4418070">:=</span>&nbsp;<span class="num" id="4418073">0</span><span class="op" id="4418074">;</span>&nbsp;<span class="ident" id="4418076">j</span>&nbsp;<span class="op" id="4418078">&lt;</span>&nbsp;<span class="num" id="4418080">8</span><span class="op" id="4418081">;</span>&nbsp;<span class="ident" id="4418083">j</span><span class="op" id="4418084">++</span>&nbsp;<span class="op" id="4418087">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418092">if</span>&nbsp;<span class="ident" id="4418095">crc</span><span class="op" id="4418098">&amp;</span><span class="num" id="4418099">1</span>&nbsp;<span class="op" id="4418101">==</span>&nbsp;<span class="num" id="4418104">1</span>&nbsp;<span class="op" id="4418106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418112">crc</span>&nbsp;<span class="op" id="4418116">=</span>&nbsp;<span class="op" id="4418118">(</span><span class="ident" id="4418119">crc</span>&nbsp;<span class="op" id="4418123">&gt;&gt;</span>&nbsp;<span class="num" id="4418126">1</span><span class="op" id="4418127">)</span>&nbsp;<span class="op" id="4418129">^</span>&nbsp;<span class="ident" id="4418131">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418139">}</span>&nbsp;<span class="keyword" id="4418141">else</span>&nbsp;<span class="op" id="4418146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418152">crc</span>&nbsp;<span class="op" id="4418156">&gt;&gt;=</span>&nbsp;<span class="num" id="4418160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418165">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418173">t</span><span class="op" id="4418174">[</span><span class="ident" id="4418175">i</span><span class="op" id="4418176">]</span>&nbsp;<span class="op" id="4418178">=</span>&nbsp;<span class="ident" id="4418180">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418188">return</span>&nbsp;<span class="ident" id="4418195">t</span><br>
<span class="lineno"></span><span class="op" id="4418197">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4418200">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4418259">type</span>&nbsp;<span class="ident" id="4418264">digest</span>&nbsp;<span class="keyword" id="4418271">struct</span>&nbsp;<span class="op" id="4418278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418281">crc</span>&nbsp;<span class="builtintype" id="4418285">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418293">tab</span>&nbsp;<span class="op" id="4418297">*</span><span class="ident" id="4418298">Table</span><br>
<span class="lineno">85</span><span class="op" id="4418304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4418307">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4418370">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4418420">func</span>&nbsp;<span class="ident" id="4418425">New</span><span class="op" id="4418428">(</span><span class="ident" id="4418429">tab</span>&nbsp;<span class="op" id="4418433">*</span><span class="ident" id="4418434">Table</span><span class="op" id="4418439">)</span>&nbsp;<span class="ident" id="4418441">hash</span><span class="op" id="4418445">.</span><span class="ident" id="4418446">Hash32</span>&nbsp;<span class="op" id="4418453">{</span>&nbsp;<span class="keyword" id="4418455">return</span>&nbsp;<span class="op" id="4418462">&amp;</span><span class="ident" id="4418463">digest</span><span class="op" id="4418469">{</span><span class="num" id="4418470">0</span><span class="op" id="4418471">,</span>&nbsp;<span class="ident" id="4418473">tab</span><span class="op" id="4418476">}</span>&nbsp;<span class="op" id="4418478">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4418481">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4418548">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4418578">func</span>&nbsp;<span class="ident" id="4418583">NewIEEE</span><span class="op" id="4418590">(</span><span class="op" id="4418591">)</span>&nbsp;<span class="ident" id="4418593">hash</span><span class="op" id="4418597">.</span><span class="ident" id="4418598">Hash32</span>&nbsp;<span class="op" id="4418605">{</span>&nbsp;<span class="keyword" id="4418607">return</span>&nbsp;<span class="ident" id="4418614">New</span><span class="op" id="4418617">(</span><span class="ident" id="4418618">IEEETable</span><span class="op" id="4418627">)</span>&nbsp;<span class="op" id="4418629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4418632">func</span>&nbsp;<span class="op" id="4418637">(</span><span class="ident" id="4418638">d</span>&nbsp;<span class="op" id="4418640">*</span><span class="ident" id="4418641">digest</span><span class="op" id="4418647">)</span>&nbsp;<span class="ident" id="4418649">Size</span><span class="op" id="4418653">(</span><span class="op" id="4418654">)</span>&nbsp;<span class="builtintype" id="4418656">int</span>&nbsp;<span class="op" id="4418660">{</span>&nbsp;<span class="keyword" id="4418662">return</span>&nbsp;<span class="ident" id="4418669">Size</span>&nbsp;<span class="op" id="4418674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418677">func</span>&nbsp;<span class="op" id="4418682">(</span><span class="ident" id="4418683">d</span>&nbsp;<span class="op" id="4418685">*</span><span class="ident" id="4418686">digest</span><span class="op" id="4418692">)</span>&nbsp;<span class="ident" id="4418694">BlockSize</span><span class="op" id="4418703">(</span><span class="op" id="4418704">)</span>&nbsp;<span class="builtintype" id="4418706">int</span>&nbsp;<span class="op" id="4418710">{</span>&nbsp;<span class="keyword" id="4418712">return</span>&nbsp;<span class="num" id="4418719">1</span>&nbsp;<span class="op" id="4418721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418724">func</span>&nbsp;<span class="op" id="4418729">(</span><span class="ident" id="4418730">d</span>&nbsp;<span class="op" id="4418732">*</span><span class="ident" id="4418733">digest</span><span class="op" id="4418739">)</span>&nbsp;<span class="ident" id="4418741">Reset</span><span class="op" id="4418746">(</span><span class="op" id="4418747">)</span>&nbsp;<span class="op" id="4418749">{</span>&nbsp;<span class="ident" id="4418751">d</span><span class="op" id="4418752">.</span><span class="ident" id="4418753">crc</span>&nbsp;<span class="op" id="4418757">=</span>&nbsp;<span class="num" id="4418759">0</span>&nbsp;<span class="op" id="4418761">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4418764">func</span>&nbsp;<span class="ident" id="4418769">update</span><span class="op" id="4418775">(</span><span class="ident" id="4418776">crc</span>&nbsp;<span class="builtintype" id="4418780">uint32</span><span class="op" id="4418786">,</span>&nbsp;<span class="ident" id="4418788">tab</span>&nbsp;<span class="op" id="4418792">*</span><span class="ident" id="4418793">Table</span><span class="op" id="4418798">,</span>&nbsp;<span class="ident" id="4418800">p</span>&nbsp;<span class="op" id="4418802">[</span><span class="op" id="4418803">]</span><span class="builtintype" id="4418804">byte</span><span class="op" id="4418808">)</span>&nbsp;<span class="builtintype" id="4418810">uint32</span>&nbsp;<span class="op" id="4418817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418820">crc</span>&nbsp;<span class="op" id="4418824">=</span>&nbsp;<span class="op" id="4418826">^</span><span class="ident" id="4418827">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418832">for</span>&nbsp;<span class="ident" id="4418836">_</span><span class="op" id="4418837">,</span>&nbsp;<span class="ident" id="4418839">v</span>&nbsp;<span class="op" id="4418841">:=</span>&nbsp;<span class="keyword" id="4418844">range</span>&nbsp;<span class="ident" id="4418850">p</span>&nbsp;<span class="op" id="4418852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418856">crc</span>&nbsp;<span class="op" id="4418860">=</span>&nbsp;<span class="ident" id="4418862">tab</span><span class="op" id="4418865">[</span><span class="builtintype" id="4418866">byte</span><span class="op" id="4418870">(</span><span class="ident" id="4418871">crc</span><span class="op" id="4418874">)</span><span class="op" id="4418875">^</span><span class="ident" id="4418876">v</span><span class="op" id="4418877">]</span>&nbsp;<span class="op" id="4418879">^</span>&nbsp;<span class="op" id="4418881">(</span><span class="ident" id="4418882">crc</span>&nbsp;<span class="op" id="4418886">&gt;&gt;</span>&nbsp;<span class="num" id="4418889">8</span><span class="op" id="4418890">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418896">return</span>&nbsp;<span class="op" id="4418903">^</span><span class="ident" id="4418904">crc</span><br>
<span class="lineno"></span><span class="op" id="4418908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4418911">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4418977">func</span>&nbsp;<span class="ident" id="4418982">Update</span><span class="op" id="4418988">(</span><span class="ident" id="4418989">crc</span>&nbsp;<span class="builtintype" id="4418993">uint32</span><span class="op" id="4418999">,</span>&nbsp;<span class="ident" id="4419001">tab</span>&nbsp;<span class="op" id="4419005">*</span><span class="ident" id="4419006">Table</span><span class="op" id="4419011">,</span>&nbsp;<span class="ident" id="4419013">p</span>&nbsp;<span class="op" id="4419015">[</span><span class="op" id="4419016">]</span><span class="builtintype" id="4419017">byte</span><span class="op" id="4419021">)</span>&nbsp;<span class="builtintype" id="4419023">uint32</span>&nbsp;<span class="op" id="4419030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419033">if</span>&nbsp;<span class="ident" id="4419036">tab</span>&nbsp;<span class="op" id="4419040">==</span>&nbsp;<span class="ident" id="4419043">castagnoliTable</span>&nbsp;<span class="op" id="4419059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419063">return</span>&nbsp;<span class="ident" id="4419070">updateCastagnoli</span><span class="op" id="4419086">(</span><span class="ident" id="4419087">crc</span><span class="op" id="4419090">,</span>&nbsp;<span class="ident" id="4419092">p</span><span class="op" id="4419093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419099">return</span>&nbsp;<span class="ident" id="4419106">update</span><span class="op" id="4419112">(</span><span class="ident" id="4419113">crc</span><span class="op" id="4419116">,</span>&nbsp;<span class="ident" id="4419118">tab</span><span class="op" id="4419121">,</span>&nbsp;<span class="ident" id="4419123">p</span><span class="op" id="4419124">)</span><br>
<span class="lineno">115</span><span class="op" id="4419126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419129">func</span>&nbsp;<span class="op" id="4419134">(</span><span class="ident" id="4419135">d</span>&nbsp;<span class="op" id="4419137">*</span><span class="ident" id="4419138">digest</span><span class="op" id="4419144">)</span>&nbsp;<span class="ident" id="4419146">Write</span><span class="op" id="4419151">(</span><span class="ident" id="4419152">p</span>&nbsp;<span class="op" id="4419154">[</span><span class="op" id="4419155">]</span><span class="builtintype" id="4419156">byte</span><span class="op" id="4419160">)</span>&nbsp;<span class="op" id="4419162">(</span><span class="ident" id="4419163">n</span>&nbsp;<span class="builtintype" id="4419165">int</span><span class="op" id="4419168">,</span>&nbsp;<span class="ident" id="4419170">err</span>&nbsp;<span class="builtintype" id="4419174">error</span><span class="op" id="4419179">)</span>&nbsp;<span class="op" id="4419181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419184">d</span><span class="op" id="4419185">.</span><span class="ident" id="4419186">crc</span>&nbsp;<span class="op" id="4419190">=</span>&nbsp;<span class="ident" id="4419192">Update</span><span class="op" id="4419198">(</span><span class="ident" id="4419199">d</span><span class="op" id="4419200">.</span><span class="ident" id="4419201">crc</span><span class="op" id="4419204">,</span>&nbsp;<span class="ident" id="4419206">d</span><span class="op" id="4419207">.</span><span class="ident" id="4419208">tab</span><span class="op" id="4419211">,</span>&nbsp;<span class="ident" id="4419213">p</span><span class="op" id="4419214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419217">return</span>&nbsp;<span class="builtinfunc" id="4419224">len</span><span class="op" id="4419227">(</span><span class="ident" id="4419228">p</span><span class="op" id="4419229">)</span><span class="op" id="4419230">,</span>&nbsp;<span class="ident" id="4419232">nil</span><br>
<span class="lineno">120</span><span class="op" id="4419236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419239">func</span>&nbsp;<span class="op" id="4419244">(</span><span class="ident" id="4419245">d</span>&nbsp;<span class="op" id="4419247">*</span><span class="ident" id="4419248">digest</span><span class="op" id="4419254">)</span>&nbsp;<span class="ident" id="4419256">Sum32</span><span class="op" id="4419261">(</span><span class="op" id="4419262">)</span>&nbsp;<span class="builtintype" id="4419264">uint32</span>&nbsp;<span class="op" id="4419271">{</span>&nbsp;<span class="keyword" id="4419273">return</span>&nbsp;<span class="ident" id="4419280">d</span><span class="op" id="4419281">.</span><span class="ident" id="4419282">crc</span>&nbsp;<span class="op" id="4419286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419289">func</span>&nbsp;<span class="op" id="4419294">(</span><span class="ident" id="4419295">d</span>&nbsp;<span class="op" id="4419297">*</span><span class="ident" id="4419298">digest</span><span class="op" id="4419304">)</span>&nbsp;<span class="ident" id="4419306">Sum</span><span class="op" id="4419309">(</span><span class="ident" id="4419310">in</span>&nbsp;<span class="op" id="4419313">[</span><span class="op" id="4419314">]</span><span class="builtintype" id="4419315">byte</span><span class="op" id="4419319">)</span>&nbsp;<span class="op" id="4419321">[</span><span class="op" id="4419322">]</span><span class="builtintype" id="4419323">byte</span>&nbsp;<span class="op" id="4419328">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419331">s</span>&nbsp;<span class="op" id="4419333">:=</span>&nbsp;<span class="ident" id="4419336">d</span><span class="op" id="4419337">.</span><span class="ident" id="4419338">Sum32</span><span class="op" id="4419343">(</span><span class="op" id="4419344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419347">return</span>&nbsp;<span class="builtinfunc" id="4419354">append</span><span class="op" id="4419360">(</span><span class="ident" id="4419361">in</span><span class="op" id="4419363">,</span>&nbsp;<span class="builtintype" id="4419365">byte</span><span class="op" id="4419369">(</span><span class="ident" id="4419370">s</span><span class="op" id="4419371">&gt;&gt;</span><span class="num" id="4419373">24</span><span class="op" id="4419375">)</span><span class="op" id="4419376">,</span>&nbsp;<span class="builtintype" id="4419378">byte</span><span class="op" id="4419382">(</span><span class="ident" id="4419383">s</span><span class="op" id="4419384">&gt;&gt;</span><span class="num" id="4419386">16</span><span class="op" id="4419388">)</span><span class="op" id="4419389">,</span>&nbsp;<span class="builtintype" id="4419391">byte</span><span class="op" id="4419395">(</span><span class="ident" id="4419396">s</span><span class="op" id="4419397">&gt;&gt;</span><span class="num" id="4419399">8</span><span class="op" id="4419400">)</span><span class="op" id="4419401">,</span>&nbsp;<span class="builtintype" id="4419403">byte</span><span class="op" id="4419407">(</span><span class="ident" id="4419408">s</span><span class="op" id="4419409">)</span><span class="op" id="4419410">)</span><br>
<span class="lineno"></span><span class="op" id="4419412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419415">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4419463">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4419513">func</span>&nbsp;<span class="ident" id="4419518">Checksum</span><span class="op" id="4419526">(</span><span class="ident" id="4419527">data</span>&nbsp;<span class="op" id="4419532">[</span><span class="op" id="4419533">]</span><span class="builtintype" id="4419534">byte</span><span class="op" id="4419538">,</span>&nbsp;<span class="ident" id="4419540">tab</span>&nbsp;<span class="op" id="4419544">*</span><span class="ident" id="4419545">Table</span><span class="op" id="4419550">)</span>&nbsp;<span class="builtintype" id="4419552">uint32</span>&nbsp;<span class="op" id="4419559">{</span>&nbsp;<span class="keyword" id="4419561">return</span>&nbsp;<span class="ident" id="4419568">Update</span><span class="op" id="4419574">(</span><span class="num" id="4419575">0</span><span class="op" id="4419576">,</span>&nbsp;<span class="ident" id="4419578">tab</span><span class="op" id="4419581">,</span>&nbsp;<span class="ident" id="4419583">data</span><span class="op" id="4419587">)</span>&nbsp;<span class="op" id="4419589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419592">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4419644">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4419674">func</span>&nbsp;<span class="ident" id="4419679">ChecksumIEEE</span><span class="op" id="4419691">(</span><span class="ident" id="4419692">data</span>&nbsp;<span class="op" id="4419697">[</span><span class="op" id="4419698">]</span><span class="builtintype" id="4419699">byte</span><span class="op" id="4419703">)</span>&nbsp;<span class="builtintype" id="4419705">uint32</span>&nbsp;<span class="op" id="4419712">{</span>&nbsp;<span class="keyword" id="4419714">return</span>&nbsp;<span class="ident" id="4419721">update</span><span class="op" id="4419727">(</span><span class="num" id="4419728">0</span><span class="op" id="4419729">,</span>&nbsp;<span class="ident" id="4419731">IEEETable</span><span class="op" id="4419740">,</span>&nbsp;<span class="ident" id="4419742">data</span><span class="op" id="4419746">)</span>&nbsp;<span class="op" id="4419748">}</span>
</div>
</body>
</html>
