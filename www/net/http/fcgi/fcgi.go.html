<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6106930">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6106985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6107039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6107090">//&nbsp;Package&nbsp;fcgi&nbsp;implements&nbsp;the&nbsp;FastCGI&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="comment" id="6107139">//&nbsp;Currently&nbsp;only&nbsp;the&nbsp;responder&nbsp;role&nbsp;is&nbsp;supported.</span><br>
<span class="lineno"></span><span class="comment" id="6107190">//&nbsp;The&nbsp;protocol&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://www.fastcgi.com/drupal/node/6?q=node/22</span><br>
<span class="lineno"></span><span class="keyword" id="6107267">package</span>&nbsp;<span class="ident" id="6107275">fcgi</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="6107281">//&nbsp;This&nbsp;file&nbsp;defines&nbsp;the&nbsp;raw&nbsp;protocol&nbsp;and&nbsp;some&nbsp;utilities&nbsp;used&nbsp;by&nbsp;the&nbsp;child&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6107360">//&nbsp;the&nbsp;host.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6107374">import</span>&nbsp;<span class="op" id="6107381">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107384">&#34;bufio&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107393">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107402">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107421">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107431">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6107437">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="6107444">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6107447">//&nbsp;recType&nbsp;is&nbsp;a&nbsp;record&nbsp;type,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6107490">//&nbsp;http://www.fastcgi.com/devkit/doc/fcgi-spec.html#S8</span><br>
<span class="lineno"></span><span class="keyword" id="6107545">type</span>&nbsp;<span class="ident" id="6107550">recType</span>&nbsp;<span class="builtintype" id="6107558">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6107565">const</span>&nbsp;<span class="op" id="6107571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107574">typeBeginRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107594"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107602">=</span>&nbsp;<span class="num" id="6107604">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107607">typeAbortRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107627"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107635">=</span>&nbsp;<span class="num" id="6107637">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107640">typeEndRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107660"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107668">=</span>&nbsp;<span class="num" id="6107670">3</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107673">typeParams</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107693"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107701">=</span>&nbsp;<span class="num" id="6107703">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107706">typeStdin</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107726"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107734">=</span>&nbsp;<span class="num" id="6107736">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107739">typeStdout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107759"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107767">=</span>&nbsp;<span class="num" id="6107769">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107772">typeStderr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107792"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107800">=</span>&nbsp;<span class="num" id="6107802">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107805">typeData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107825"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107833">=</span>&nbsp;<span class="num" id="6107835">8</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107838">typeGetValues</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107858"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107866">=</span>&nbsp;<span class="num" id="6107868">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107871">typeGetValuesResult</span>&nbsp;<span class="ident" id="6107891"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107899">=</span>&nbsp;<span class="num" id="6107901">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107905">typeUnknownType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107925"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span>&nbsp;<span class="op" id="6107933">=</span>&nbsp;<span class="num" id="6107935">11</span><br>
<span class="lineno"></span><span class="op" id="6107938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6107941">//&nbsp;keep&nbsp;the&nbsp;connection&nbsp;between&nbsp;web-server&nbsp;and&nbsp;responder&nbsp;open&nbsp;after&nbsp;request</span><br>
<span class="lineno"></span><span class="keyword" id="6108016">const</span>&nbsp;<span class="ident" id="6108022">flagKeepConn</span>&nbsp;<span class="op" id="6108035">=</span>&nbsp;<span class="num" id="6108037">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108040">const</span>&nbsp;<span class="op" id="6108046">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108049">maxWrite</span>&nbsp;<span class="op" id="6108058">=</span>&nbsp;<span class="num" id="6108060">65535</span>&nbsp;<span class="comment" id="6108066">//&nbsp;maximum&nbsp;record&nbsp;body</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108090">maxPad</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6108099">=</span>&nbsp;<span class="num" id="6108101">255</span><br>
<span class="lineno"></span><span class="op" id="6108105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108108">const</span>&nbsp;<span class="op" id="6108114">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108117">roleResponder</span>&nbsp;<span class="op" id="6108131">=</span>&nbsp;<span class="ident" id="6108133">iota</span>&nbsp;<span class="op" id="6108138">+</span>&nbsp;<span class="num" id="6108140">1</span>&nbsp;<span class="comment" id="6108142">//&nbsp;only&nbsp;Responders&nbsp;are&nbsp;implemented.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108179">roleAuthorizer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108195">roleFilter</span><br>
<span class="lineno"></span><span class="op" id="6108206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108209">const</span>&nbsp;<span class="op" id="6108215">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108218">statusRequestComplete</span>&nbsp;<span class="op" id="6108240">=</span>&nbsp;<span class="ident" id="6108242">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108248">statusCantMultiplex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108269">statusOverloaded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108287">statusUnknownRole</span><br>
<span class="lineno"></span><span class="op" id="6108305">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="6108308">const</span>&nbsp;<span class="ident" id="6108314">headerLen</span>&nbsp;<span class="op" id="6108324">=</span>&nbsp;<span class="num" id="6108326">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108329">type</span>&nbsp;<span class="ident" id="6108334">header</span>&nbsp;<span class="keyword" id="6108341">struct</span>&nbsp;<span class="op" id="6108348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108351">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6108365">uint8</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108372">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108386"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108395">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6108409">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108417">ContentLength</span>&nbsp;<span class="builtintype" id="6108431">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108439">PaddingLength</span>&nbsp;<span class="builtintype" id="6108453">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108460">Reserved</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6108474">uint8</span><br>
<span class="lineno">70</span><span class="op" id="6108480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108483">type</span>&nbsp;<span class="ident" id="6108488">beginRequest</span>&nbsp;<span class="keyword" id="6108501">struct</span>&nbsp;<span class="op" id="6108508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108511">role</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6108520">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108528">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6108537">uint8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108544">reserved</span>&nbsp;<span class="op" id="6108553">[</span><span class="num" id="6108554">5</span><span class="op" id="6108555">]</span><span class="builtintype" id="6108556">uint8</span><br>
<span class="lineno"></span><span class="op" id="6108562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6108565">func</span>&nbsp;<span class="op" id="6108570">(</span><span class="ident" id="6108571">br</span>&nbsp;<span class="op" id="6108574">*</span><span class="ident" id="6108575"><a href="/net/http/fcgi/fcgi.go.html#6108488">beginRequest</a></span><span class="op" id="6108587">)</span>&nbsp;<span class="ident" id="6108589">read</span><span class="op" id="6108593">(</span><span class="ident" id="6108594">content</span>&nbsp;<span class="op" id="6108602">[</span><span class="op" id="6108603">]</span><span class="builtintype" id="6108604">byte</span><span class="op" id="6108608">)</span>&nbsp;<span class="builtintype" id="6108610">error</span>&nbsp;<span class="op" id="6108616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108619">if</span>&nbsp;<span class="builtinfunc" id="6108622">len</span><span class="op" id="6108625">(</span><span class="ident" id="6108626"><a href="/net/http/fcgi/fcgi.go.html#6108594">content</a></span><span class="op" id="6108633">)</span>&nbsp;<span class="op" id="6108635">!=</span>&nbsp;<span class="num" id="6108638">8</span>&nbsp;<span class="op" id="6108640">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108644">return</span>&nbsp;<span class="ident" id="6108651"><a href="/net/http/fcgi/fcgi.go.html#6107421">errors</a></span><span class="op" id="6108657">.</span><span class="ident" id="6108658">New</span><span class="op" id="6108661">(</span><span class="string" id="6108662">&#34;fcgi:&nbsp;invalid&nbsp;begin&nbsp;request&nbsp;record&#34;</span><span class="op" id="6108698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108704"><a href="/net/http/fcgi/fcgi.go.html#6108571">br</a></span><span class="op" id="6108706">.</span><span class="ident" id="6108707">role</span>&nbsp;<span class="op" id="6108712">=</span>&nbsp;<span class="ident" id="6108714"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6108720">.</span><span class="ident" id="6108721">BigEndian</span><span class="op" id="6108730">.</span><span class="ident" id="6108731">Uint16</span><span class="op" id="6108737">(</span><span class="ident" id="6108738"><a href="/net/http/fcgi/fcgi.go.html#6108594">content</a></span><span class="op" id="6108745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108748"><a href="/net/http/fcgi/fcgi.go.html#6108571">br</a></span><span class="op" id="6108750">.</span><span class="ident" id="6108751">flags</span>&nbsp;<span class="op" id="6108757">=</span>&nbsp;<span class="ident" id="6108759"><a href="/net/http/fcgi/fcgi.go.html#6108594">content</a></span><span class="op" id="6108766">[</span><span class="num" id="6108767">2</span><span class="op" id="6108768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108771">return</span>&nbsp;<span class="ident" id="6108778">nil</span><br>
<span class="lineno">85</span><span class="op" id="6108782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6108785">//&nbsp;for&nbsp;padding&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;allocate&nbsp;all&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="6108842">//&nbsp;not&nbsp;synchronized&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;care&nbsp;what&nbsp;the&nbsp;contents&nbsp;are</span><br>
<span class="lineno"></span><span class="keyword" id="6108906">var</span>&nbsp;<span class="ident" id="6108910">pad</span>&nbsp;<span class="op" id="6108914">[</span><span class="ident" id="6108915"><a href="/net/http/fcgi/fcgi.go.html#6108090">maxPad</a></span><span class="op" id="6108921">]</span><span class="builtintype" id="6108922">byte</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6108928">func</span>&nbsp;<span class="op" id="6108933">(</span><span class="ident" id="6108934">h</span>&nbsp;<span class="op" id="6108936">*</span><span class="ident" id="6108937"><a href="/net/http/fcgi/fcgi.go.html#6108334">header</a></span><span class="op" id="6108943">)</span>&nbsp;<span class="ident" id="6108945">init</span><span class="op" id="6108949">(</span><span class="ident" id="6108950">recType</span>&nbsp;<span class="ident" id="6108958"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><span class="op" id="6108965">,</span>&nbsp;<span class="ident" id="6108967">reqId</span>&nbsp;<span class="builtintype" id="6108973">uint16</span><span class="op" id="6108979">,</span>&nbsp;<span class="ident" id="6108981">contentLength</span>&nbsp;<span class="builtintype" id="6108995">int</span><span class="op" id="6108998">)</span>&nbsp;<span class="op" id="6109000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109003"><a href="/net/http/fcgi/fcgi.go.html#6108934">h</a></span><span class="op" id="6109004">.</span><span class="ident" id="6109005">Version</span>&nbsp;<span class="op" id="6109013">=</span>&nbsp;<span class="num" id="6109015">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109018"><a href="/net/http/fcgi/fcgi.go.html#6108934">h</a></span><span class="op" id="6109019">.</span><span class="ident" id="6109020">Type</span>&nbsp;<span class="op" id="6109025">=</span>&nbsp;<span class="ident" id="6109027"><a href="/net/http/fcgi/fcgi.go.html#6108950">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109036"><a href="/net/http/fcgi/fcgi.go.html#6108934">h</a></span><span class="op" id="6109037">.</span><span class="ident" id="6109038">Id</span>&nbsp;<span class="op" id="6109041">=</span>&nbsp;<span class="ident" id="6109043"><a href="/net/http/fcgi/fcgi.go.html#6108967">reqId</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109050"><a href="/net/http/fcgi/fcgi.go.html#6108934">h</a></span><span class="op" id="6109051">.</span><span class="ident" id="6109052">ContentLength</span>&nbsp;<span class="op" id="6109066">=</span>&nbsp;<span class="builtintype" id="6109068">uint16</span><span class="op" id="6109074">(</span><span class="ident" id="6109075"><a href="/net/http/fcgi/fcgi.go.html#6108981">contentLength</a></span><span class="op" id="6109088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109091"><a href="/net/http/fcgi/fcgi.go.html#6108934">h</a></span><span class="op" id="6109092">.</span><span class="ident" id="6109093">PaddingLength</span>&nbsp;<span class="op" id="6109107">=</span>&nbsp;<span class="builtintype" id="6109109">uint8</span><span class="op" id="6109114">(</span><span class="op" id="6109115">-</span><span class="ident" id="6109116"><a href="/net/http/fcgi/fcgi.go.html#6108981">contentLength</a></span>&nbsp;<span class="op" id="6109130">&amp;</span>&nbsp;<span class="num" id="6109132">7</span><span class="op" id="6109133">)</span><br>
<span class="lineno"></span><span class="op" id="6109135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6109138">//&nbsp;conn&nbsp;sends&nbsp;records&nbsp;over&nbsp;rwc</span><br>
<span class="lineno">100</span><span class="keyword" id="6109169">type</span>&nbsp;<span class="ident" id="6109174">conn</span>&nbsp;<span class="keyword" id="6109179">struct</span>&nbsp;<span class="op" id="6109186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109189">mutex</span>&nbsp;<span class="ident" id="6109195"><a href="/net/http/fcgi/fcgi.go.html#6107437">sync</a></span><span class="op" id="6109199">.</span><span class="ident" id="6109200">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109207">rwc</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6109213"><a href="/net/http/fcgi/fcgi.go.html#6107431">io</a></span><span class="op" id="6109215">.</span><span class="ident" id="6109216">ReadWriteCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109234">//&nbsp;to&nbsp;avoid&nbsp;allocations</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109259">buf</span>&nbsp;<span class="ident" id="6109263"><a href="/net/http/fcgi/fcgi.go.html#6107393">bytes</a></span><span class="op" id="6109268">.</span><span class="ident" id="6109269">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109277">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6109281"><a href="/net/http/fcgi/fcgi.go.html#6108334">header</a></span><br>
<span class="lineno"></span><span class="op" id="6109288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109291">func</span>&nbsp;<span class="ident" id="6109296">newConn</span><span class="op" id="6109303">(</span><span class="ident" id="6109304">rwc</span>&nbsp;<span class="ident" id="6109308"><a href="/net/http/fcgi/fcgi.go.html#6107431">io</a></span><span class="op" id="6109310">.</span><span class="ident" id="6109311">ReadWriteCloser</span><span class="op" id="6109326">)</span>&nbsp;<span class="op" id="6109328">*</span><span class="ident" id="6109329"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span>&nbsp;<span class="op" id="6109334">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109337">return</span>&nbsp;<span class="op" id="6109344">&amp;</span><span class="ident" id="6109345"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6109349">{</span><span class="ident" id="6109350">rwc</span><span class="op" id="6109353">:</span>&nbsp;<span class="ident" id="6109355"><a href="/net/http/fcgi/fcgi.go.html#6109304">rwc</a></span><span class="op" id="6109358">}</span><br>
<span class="lineno"></span><span class="op" id="6109360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109363">func</span>&nbsp;<span class="op" id="6109368">(</span><span class="ident" id="6109369">c</span>&nbsp;<span class="op" id="6109371">*</span><span class="ident" id="6109372"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6109376">)</span>&nbsp;<span class="ident" id="6109378">Close</span><span class="op" id="6109383">(</span><span class="op" id="6109384">)</span>&nbsp;<span class="builtintype" id="6109386">error</span>&nbsp;<span class="op" id="6109392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109395"><a href="/net/http/fcgi/fcgi.go.html#6109369">c</a></span><span class="op" id="6109396">.</span><span class="ident" id="6109397">mutex</span><span class="op" id="6109402">.</span><span class="ident" id="6109403">Lock</span><span class="op" id="6109407">(</span><span class="op" id="6109408">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109411">defer</span>&nbsp;<span class="ident" id="6109417"><a href="/net/http/fcgi/fcgi.go.html#6109369">c</a></span><span class="op" id="6109418">.</span><span class="ident" id="6109419">mutex</span><span class="op" id="6109424">.</span><span class="ident" id="6109425">Unlock</span><span class="op" id="6109431">(</span><span class="op" id="6109432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109435">return</span>&nbsp;<span class="ident" id="6109442"><a href="/net/http/fcgi/fcgi.go.html#6109369">c</a></span><span class="op" id="6109443">.</span><span class="ident" id="6109444">rwc</span><span class="op" id="6109447">.</span><span class="ident" id="6109448">Close</span><span class="op" id="6109453">(</span><span class="op" id="6109454">)</span><br>
<span class="lineno"></span><span class="op" id="6109456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109459">type</span>&nbsp;<span class="ident" id="6109464">record</span>&nbsp;<span class="keyword" id="6109471">struct</span>&nbsp;<span class="op" id="6109478">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109481">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6109485"><a href="/net/http/fcgi/fcgi.go.html#6108334">header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109493">buf</span>&nbsp;<span class="op" id="6109497">[</span><span class="ident" id="6109498"><a href="/net/http/fcgi/fcgi.go.html#6108049">maxWrite</a></span>&nbsp;<span class="op" id="6109507">+</span>&nbsp;<span class="ident" id="6109509"><a href="/net/http/fcgi/fcgi.go.html#6108090">maxPad</a></span><span class="op" id="6109515">]</span><span class="builtintype" id="6109516">byte</span><br>
<span class="lineno"></span><span class="op" id="6109521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109524">func</span>&nbsp;<span class="op" id="6109529">(</span><span class="ident" id="6109530">rec</span>&nbsp;<span class="op" id="6109534">*</span><span class="ident" id="6109535"><a href="/net/http/fcgi/fcgi.go.html#6109464">record</a></span><span class="op" id="6109541">)</span>&nbsp;<span class="ident" id="6109543">read</span><span class="op" id="6109547">(</span><span class="ident" id="6109548">r</span>&nbsp;<span class="ident" id="6109550"><a href="/net/http/fcgi/fcgi.go.html#6107431">io</a></span><span class="op" id="6109552">.</span><span class="ident" id="6109553">Reader</span><span class="op" id="6109559">)</span>&nbsp;<span class="op" id="6109561">(</span><span class="ident" id="6109562">err</span>&nbsp;<span class="builtintype" id="6109566">error</span><span class="op" id="6109571">)</span>&nbsp;<span class="op" id="6109573">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109576">if</span>&nbsp;<span class="ident" id="6109579"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span>&nbsp;<span class="op" id="6109583">=</span>&nbsp;<span class="ident" id="6109585"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6109591">.</span><span class="ident" id="6109592">Read</span><span class="op" id="6109596">(</span><span class="ident" id="6109597"><a href="/net/http/fcgi/fcgi.go.html#6109548">r</a></span><span class="op" id="6109598">,</span>&nbsp;<span class="ident" id="6109600"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6109606">.</span><span class="ident" id="6109607">BigEndian</span><span class="op" id="6109616">,</span>&nbsp;<span class="op" id="6109618">&amp;</span><span class="ident" id="6109619"><a href="/net/http/fcgi/fcgi.go.html#6109530">rec</a></span><span class="op" id="6109622">.</span><span class="ident" id="6109623">h</span><span class="op" id="6109624">)</span><span class="op" id="6109625">;</span>&nbsp;<span class="ident" id="6109627"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span>&nbsp;<span class="op" id="6109631">!=</span>&nbsp;<span class="ident" id="6109634">nil</span>&nbsp;<span class="op" id="6109638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109642">return</span>&nbsp;<span class="ident" id="6109649"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109657">if</span>&nbsp;<span class="ident" id="6109660"><a href="/net/http/fcgi/fcgi.go.html#6109530">rec</a></span><span class="op" id="6109663">.</span><span class="ident" id="6109664">h</span><span class="op" id="6109665">.</span><span class="ident" id="6109666">Version</span>&nbsp;<span class="op" id="6109674">!=</span>&nbsp;<span class="num" id="6109677">1</span>&nbsp;<span class="op" id="6109679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109683">return</span>&nbsp;<span class="ident" id="6109690"><a href="/net/http/fcgi/fcgi.go.html#6107421">errors</a></span><span class="op" id="6109696">.</span><span class="ident" id="6109697">New</span><span class="op" id="6109700">(</span><span class="string" id="6109701">&#34;fcgi:&nbsp;invalid&nbsp;header&nbsp;version&#34;</span><span class="op" id="6109731">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109737">n</span>&nbsp;<span class="op" id="6109739">:=</span>&nbsp;<span class="builtintype" id="6109742">int</span><span class="op" id="6109745">(</span><span class="ident" id="6109746"><a href="/net/http/fcgi/fcgi.go.html#6109530">rec</a></span><span class="op" id="6109749">.</span><span class="ident" id="6109750">h</span><span class="op" id="6109751">.</span><span class="ident" id="6109752">ContentLength</span><span class="op" id="6109765">)</span>&nbsp;<span class="op" id="6109767">+</span>&nbsp;<span class="builtintype" id="6109769">int</span><span class="op" id="6109772">(</span><span class="ident" id="6109773"><a href="/net/http/fcgi/fcgi.go.html#6109530">rec</a></span><span class="op" id="6109776">.</span><span class="ident" id="6109777">h</span><span class="op" id="6109778">.</span><span class="ident" id="6109779">PaddingLength</span><span class="op" id="6109792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109795">if</span>&nbsp;<span class="ident" id="6109798">_</span><span class="op" id="6109799">,</span>&nbsp;<span class="ident" id="6109801"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span>&nbsp;<span class="op" id="6109805">=</span>&nbsp;<span class="ident" id="6109807"><a href="/net/http/fcgi/fcgi.go.html#6107431">io</a></span><span class="op" id="6109809">.</span><span class="ident" id="6109810">ReadFull</span><span class="op" id="6109818">(</span><span class="ident" id="6109819"><a href="/net/http/fcgi/fcgi.go.html#6109548">r</a></span><span class="op" id="6109820">,</span>&nbsp;<span class="ident" id="6109822"><a href="/net/http/fcgi/fcgi.go.html#6109530">rec</a></span><span class="op" id="6109825">.</span><span class="ident" id="6109826">buf</span><span class="op" id="6109829">[</span><span class="op" id="6109830">:</span><span class="ident" id="6109831"><a href="/net/http/fcgi/fcgi.go.html#6109737">n</a></span><span class="op" id="6109832">]</span><span class="op" id="6109833">)</span><span class="op" id="6109834">;</span>&nbsp;<span class="ident" id="6109836"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span>&nbsp;<span class="op" id="6109840">!=</span>&nbsp;<span class="ident" id="6109843">nil</span>&nbsp;<span class="op" id="6109847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109851">return</span>&nbsp;<span class="ident" id="6109858"><a href="/net/http/fcgi/fcgi.go.html#6109562">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109863">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109866">return</span>&nbsp;<span class="ident" id="6109873">nil</span><br>
<span class="lineno"></span><span class="op" id="6109877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109880">func</span>&nbsp;<span class="op" id="6109885">(</span><span class="ident" id="6109886">r</span>&nbsp;<span class="op" id="6109888">*</span><span class="ident" id="6109889"><a href="/net/http/fcgi/fcgi.go.html#6109464">record</a></span><span class="op" id="6109895">)</span>&nbsp;<span class="ident" id="6109897">content</span><span class="op" id="6109904">(</span><span class="op" id="6109905">)</span>&nbsp;<span class="op" id="6109907">[</span><span class="op" id="6109908">]</span><span class="builtintype" id="6109909">byte</span>&nbsp;<span class="op" id="6109914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109917">return</span>&nbsp;<span class="ident" id="6109924"><a href="/net/http/fcgi/fcgi.go.html#6109886">r</a></span><span class="op" id="6109925">.</span><span class="ident" id="6109926">buf</span><span class="op" id="6109929">[</span><span class="op" id="6109930">:</span><span class="ident" id="6109931"><a href="/net/http/fcgi/fcgi.go.html#6109886">r</a></span><span class="op" id="6109932">.</span><span class="ident" id="6109933">h</span><span class="op" id="6109934">.</span><span class="ident" id="6109935">ContentLength</span><span class="op" id="6109948">]</span><br>
<span class="lineno">140</span><span class="op" id="6109950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6109953">//&nbsp;writeRecord&nbsp;writes&nbsp;and&nbsp;sends&nbsp;a&nbsp;single&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="6110002">func</span>&nbsp;<span class="op" id="6110007">(</span><span class="ident" id="6110008">c</span>&nbsp;<span class="op" id="6110010">*</span><span class="ident" id="6110011"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6110015">)</span>&nbsp;<span class="ident" id="6110017">writeRecord</span><span class="op" id="6110028">(</span><span class="ident" id="6110029">recType</span>&nbsp;<span class="ident" id="6110037"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><span class="op" id="6110044">,</span>&nbsp;<span class="ident" id="6110046">reqId</span>&nbsp;<span class="builtintype" id="6110052">uint16</span><span class="op" id="6110058">,</span>&nbsp;<span class="ident" id="6110060">b</span>&nbsp;<span class="op" id="6110062">[</span><span class="op" id="6110063">]</span><span class="builtintype" id="6110064">byte</span><span class="op" id="6110068">)</span>&nbsp;<span class="builtintype" id="6110070">error</span>&nbsp;<span class="op" id="6110076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110079"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110080">.</span><span class="ident" id="6110081">mutex</span><span class="op" id="6110086">.</span><span class="ident" id="6110087">Lock</span><span class="op" id="6110091">(</span><span class="op" id="6110092">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110095">defer</span>&nbsp;<span class="ident" id="6110101"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110102">.</span><span class="ident" id="6110103">mutex</span><span class="op" id="6110108">.</span><span class="ident" id="6110109">Unlock</span><span class="op" id="6110115">(</span><span class="op" id="6110116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110119"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110120">.</span><span class="ident" id="6110121">buf</span><span class="op" id="6110124">.</span><span class="ident" id="6110125">Reset</span><span class="op" id="6110130">(</span><span class="op" id="6110131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110134"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110135">.</span><span class="ident" id="6110136">h</span><span class="op" id="6110137">.</span><span class="ident" id="6110138">init</span><span class="op" id="6110142">(</span><span class="ident" id="6110143"><a href="/net/http/fcgi/fcgi.go.html#6110029">recType</a></span><span class="op" id="6110150">,</span>&nbsp;<span class="ident" id="6110152"><a href="/net/http/fcgi/fcgi.go.html#6110046">reqId</a></span><span class="op" id="6110157">,</span>&nbsp;<span class="builtinfunc" id="6110159">len</span><span class="op" id="6110162">(</span><span class="ident" id="6110163"><a href="/net/http/fcgi/fcgi.go.html#6110060">b</a></span><span class="op" id="6110164">)</span><span class="op" id="6110165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110168">if</span>&nbsp;<span class="ident" id="6110171">err</span>&nbsp;<span class="op" id="6110175">:=</span>&nbsp;<span class="ident" id="6110178"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6110184">.</span><span class="ident" id="6110185">Write</span><span class="op" id="6110190">(</span><span class="op" id="6110191">&amp;</span><span class="ident" id="6110192"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110193">.</span><span class="ident" id="6110194">buf</span><span class="op" id="6110197">,</span>&nbsp;<span class="ident" id="6110199"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6110205">.</span><span class="ident" id="6110206">BigEndian</span><span class="op" id="6110215">,</span>&nbsp;<span class="ident" id="6110217"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110218">.</span><span class="ident" id="6110219">h</span><span class="op" id="6110220">)</span><span class="op" id="6110221">;</span>&nbsp;<span class="ident" id="6110223"><a href="/net/http/fcgi/fcgi.go.html#6110171">err</a></span>&nbsp;<span class="op" id="6110227">!=</span>&nbsp;<span class="ident" id="6110230">nil</span>&nbsp;<span class="op" id="6110234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110238">return</span>&nbsp;<span class="ident" id="6110245"><a href="/net/http/fcgi/fcgi.go.html#6110171">err</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110253">if</span>&nbsp;<span class="ident" id="6110256">_</span><span class="op" id="6110257">,</span>&nbsp;<span class="ident" id="6110259">err</span>&nbsp;<span class="op" id="6110263">:=</span>&nbsp;<span class="ident" id="6110266"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110267">.</span><span class="ident" id="6110268">buf</span><span class="op" id="6110271">.</span><span class="ident" id="6110272">Write</span><span class="op" id="6110277">(</span><span class="ident" id="6110278"><a href="/net/http/fcgi/fcgi.go.html#6110060">b</a></span><span class="op" id="6110279">)</span><span class="op" id="6110280">;</span>&nbsp;<span class="ident" id="6110282"><a href="/net/http/fcgi/fcgi.go.html#6110259">err</a></span>&nbsp;<span class="op" id="6110286">!=</span>&nbsp;<span class="ident" id="6110289">nil</span>&nbsp;<span class="op" id="6110293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110297">return</span>&nbsp;<span class="ident" id="6110304"><a href="/net/http/fcgi/fcgi.go.html#6110259">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110312">if</span>&nbsp;<span class="ident" id="6110315">_</span><span class="op" id="6110316">,</span>&nbsp;<span class="ident" id="6110318">err</span>&nbsp;<span class="op" id="6110322">:=</span>&nbsp;<span class="ident" id="6110325"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110326">.</span><span class="ident" id="6110327">buf</span><span class="op" id="6110330">.</span><span class="ident" id="6110331">Write</span><span class="op" id="6110336">(</span><span class="ident" id="6110337"><a href="/net/http/fcgi/fcgi.go.html#6108910">pad</a></span><span class="op" id="6110340">[</span><span class="op" id="6110341">:</span><span class="ident" id="6110342"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110343">.</span><span class="ident" id="6110344">h</span><span class="op" id="6110345">.</span><span class="ident" id="6110346">PaddingLength</span><span class="op" id="6110359">]</span><span class="op" id="6110360">)</span><span class="op" id="6110361">;</span>&nbsp;<span class="ident" id="6110363"><a href="/net/http/fcgi/fcgi.go.html#6110318">err</a></span>&nbsp;<span class="op" id="6110367">!=</span>&nbsp;<span class="ident" id="6110370">nil</span>&nbsp;<span class="op" id="6110374">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110378">return</span>&nbsp;<span class="ident" id="6110385"><a href="/net/http/fcgi/fcgi.go.html#6110318">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110393">_</span><span class="op" id="6110394">,</span>&nbsp;<span class="ident" id="6110396">err</span>&nbsp;<span class="op" id="6110400">:=</span>&nbsp;<span class="ident" id="6110403"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110404">.</span><span class="ident" id="6110405">rwc</span><span class="op" id="6110408">.</span><span class="ident" id="6110409">Write</span><span class="op" id="6110414">(</span><span class="ident" id="6110415"><a href="/net/http/fcgi/fcgi.go.html#6110008">c</a></span><span class="op" id="6110416">.</span><span class="ident" id="6110417">buf</span><span class="op" id="6110420">.</span><span class="ident" id="6110421">Bytes</span><span class="op" id="6110426">(</span><span class="op" id="6110427">)</span><span class="op" id="6110428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110431">return</span>&nbsp;<span class="ident" id="6110438"><a href="/net/http/fcgi/fcgi.go.html#6110396">err</a></span><br>
<span class="lineno"></span><span class="op" id="6110442">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="6110445">func</span>&nbsp;<span class="op" id="6110450">(</span><span class="ident" id="6110451">c</span>&nbsp;<span class="op" id="6110453">*</span><span class="ident" id="6110454"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6110458">)</span>&nbsp;<span class="ident" id="6110460">writeBeginRequest</span><span class="op" id="6110477">(</span><span class="ident" id="6110478">reqId</span>&nbsp;<span class="builtintype" id="6110484">uint16</span><span class="op" id="6110490">,</span>&nbsp;<span class="ident" id="6110492">role</span>&nbsp;<span class="builtintype" id="6110497">uint16</span><span class="op" id="6110503">,</span>&nbsp;<span class="ident" id="6110505">flags</span>&nbsp;<span class="builtintype" id="6110511">uint8</span><span class="op" id="6110516">)</span>&nbsp;<span class="builtintype" id="6110518">error</span>&nbsp;<span class="op" id="6110524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110527">b</span>&nbsp;<span class="op" id="6110529">:=</span>&nbsp;<span class="op" id="6110532">[</span><span class="num" id="6110533">8</span><span class="op" id="6110534">]</span><span class="builtintype" id="6110535">byte</span><span class="op" id="6110539">{</span><span class="builtintype" id="6110540">byte</span><span class="op" id="6110544">(</span><span class="ident" id="6110545"><a href="/net/http/fcgi/fcgi.go.html#6110492">role</a></span>&nbsp;<span class="op" id="6110550">&gt;&gt;</span>&nbsp;<span class="num" id="6110553">8</span><span class="op" id="6110554">)</span><span class="op" id="6110555">,</span>&nbsp;<span class="builtintype" id="6110557">byte</span><span class="op" id="6110561">(</span><span class="ident" id="6110562"><a href="/net/http/fcgi/fcgi.go.html#6110492">role</a></span><span class="op" id="6110566">)</span><span class="op" id="6110567">,</span>&nbsp;<span class="ident" id="6110569"><a href="/net/http/fcgi/fcgi.go.html#6110505">flags</a></span><span class="op" id="6110574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110577">return</span>&nbsp;<span class="ident" id="6110584"><a href="/net/http/fcgi/fcgi.go.html#6110451">c</a></span><span class="op" id="6110585">.</span><span class="ident" id="6110586">writeRecord</span><span class="op" id="6110597">(</span><span class="ident" id="6110598"><a href="/net/http/fcgi/fcgi.go.html#6107574">typeBeginRequest</a></span><span class="op" id="6110614">,</span>&nbsp;<span class="ident" id="6110616"><a href="/net/http/fcgi/fcgi.go.html#6110478">reqId</a></span><span class="op" id="6110621">,</span>&nbsp;<span class="ident" id="6110623"><a href="/net/http/fcgi/fcgi.go.html#6110527">b</a></span><span class="op" id="6110624">[</span><span class="op" id="6110625">:</span><span class="op" id="6110626">]</span><span class="op" id="6110627">)</span><br>
<span class="lineno"></span><span class="op" id="6110629">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6110632">func</span>&nbsp;<span class="op" id="6110637">(</span><span class="ident" id="6110638">c</span>&nbsp;<span class="op" id="6110640">*</span><span class="ident" id="6110641"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6110645">)</span>&nbsp;<span class="ident" id="6110647">writeEndRequest</span><span class="op" id="6110662">(</span><span class="ident" id="6110663">reqId</span>&nbsp;<span class="builtintype" id="6110669">uint16</span><span class="op" id="6110675">,</span>&nbsp;<span class="ident" id="6110677">appStatus</span>&nbsp;<span class="builtintype" id="6110687">int</span><span class="op" id="6110690">,</span>&nbsp;<span class="ident" id="6110692">protocolStatus</span>&nbsp;<span class="builtintype" id="6110707">uint8</span><span class="op" id="6110712">)</span>&nbsp;<span class="builtintype" id="6110714">error</span>&nbsp;<span class="op" id="6110720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110723">b</span>&nbsp;<span class="op" id="6110725">:=</span>&nbsp;<span class="builtinfunc" id="6110728">make</span><span class="op" id="6110732">(</span><span class="op" id="6110733">[</span><span class="op" id="6110734">]</span><span class="builtintype" id="6110735">byte</span><span class="op" id="6110739">,</span>&nbsp;<span class="num" id="6110741">8</span><span class="op" id="6110742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110745"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6110751">.</span><span class="ident" id="6110752">BigEndian</span><span class="op" id="6110761">.</span><span class="ident" id="6110762">PutUint32</span><span class="op" id="6110771">(</span><span class="ident" id="6110772"><a href="/net/http/fcgi/fcgi.go.html#6110723">b</a></span><span class="op" id="6110773">,</span>&nbsp;<span class="builtintype" id="6110775">uint32</span><span class="op" id="6110781">(</span><span class="ident" id="6110782"><a href="/net/http/fcgi/fcgi.go.html#6110677">appStatus</a></span><span class="op" id="6110791">)</span><span class="op" id="6110792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110795"><a href="/net/http/fcgi/fcgi.go.html#6110723">b</a></span><span class="op" id="6110796">[</span><span class="num" id="6110797">4</span><span class="op" id="6110798">]</span>&nbsp;<span class="op" id="6110800">=</span>&nbsp;<span class="ident" id="6110802"><a href="/net/http/fcgi/fcgi.go.html#6110692">protocolStatus</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110818">return</span>&nbsp;<span class="ident" id="6110825"><a href="/net/http/fcgi/fcgi.go.html#6110638">c</a></span><span class="op" id="6110826">.</span><span class="ident" id="6110827">writeRecord</span><span class="op" id="6110838">(</span><span class="ident" id="6110839"><a href="/net/http/fcgi/fcgi.go.html#6107640">typeEndRequest</a></span><span class="op" id="6110853">,</span>&nbsp;<span class="ident" id="6110855"><a href="/net/http/fcgi/fcgi.go.html#6110663">reqId</a></span><span class="op" id="6110860">,</span>&nbsp;<span class="ident" id="6110862"><a href="/net/http/fcgi/fcgi.go.html#6110723">b</a></span><span class="op" id="6110863">)</span><br>
<span class="lineno"></span><span class="op" id="6110865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6110868">func</span>&nbsp;<span class="op" id="6110873">(</span><span class="ident" id="6110874">c</span>&nbsp;<span class="op" id="6110876">*</span><span class="ident" id="6110877"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6110881">)</span>&nbsp;<span class="ident" id="6110883">writePairs</span><span class="op" id="6110893">(</span><span class="ident" id="6110894">recType</span>&nbsp;<span class="ident" id="6110902"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><span class="op" id="6110909">,</span>&nbsp;<span class="ident" id="6110911">reqId</span>&nbsp;<span class="builtintype" id="6110917">uint16</span><span class="op" id="6110923">,</span>&nbsp;<span class="ident" id="6110925">pairs</span>&nbsp;<span class="keyword" id="6110931">map</span><span class="op" id="6110934">[</span><span class="builtintype" id="6110935">string</span><span class="op" id="6110941">]</span><span class="builtintype" id="6110942">string</span><span class="op" id="6110948">)</span>&nbsp;<span class="builtintype" id="6110950">error</span>&nbsp;<span class="op" id="6110956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110959">w</span>&nbsp;<span class="op" id="6110961">:=</span>&nbsp;<span class="ident" id="6110964"><a href="/net/http/fcgi/fcgi.go.html#6112169">newWriter</a></span><span class="op" id="6110973">(</span><span class="ident" id="6110974"><a href="/net/http/fcgi/fcgi.go.html#6110874">c</a></span><span class="op" id="6110975">,</span>&nbsp;<span class="ident" id="6110977"><a href="/net/http/fcgi/fcgi.go.html#6110894">recType</a></span><span class="op" id="6110984">,</span>&nbsp;<span class="ident" id="6110986"><a href="/net/http/fcgi/fcgi.go.html#6110911">reqId</a></span><span class="op" id="6110991">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110994">b</span>&nbsp;<span class="op" id="6110996">:=</span>&nbsp;<span class="builtinfunc" id="6110999">make</span><span class="op" id="6111003">(</span><span class="op" id="6111004">[</span><span class="op" id="6111005">]</span><span class="builtintype" id="6111006">byte</span><span class="op" id="6111010">,</span>&nbsp;<span class="num" id="6111012">8</span><span class="op" id="6111013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111016">for</span>&nbsp;<span class="ident" id="6111020">k</span><span class="op" id="6111021">,</span>&nbsp;<span class="ident" id="6111023">v</span>&nbsp;<span class="op" id="6111025">:=</span>&nbsp;<span class="keyword" id="6111028">range</span>&nbsp;<span class="ident" id="6111034"><a href="/net/http/fcgi/fcgi.go.html#6110925">pairs</a></span>&nbsp;<span class="op" id="6111040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111044">n</span>&nbsp;<span class="op" id="6111046">:=</span>&nbsp;<span class="ident" id="6111049"><a href="/net/http/fcgi/fcgi.go.html#6111711">encodeSize</a></span><span class="op" id="6111059">(</span><span class="ident" id="6111060"><a href="/net/http/fcgi/fcgi.go.html#6110994">b</a></span><span class="op" id="6111061">,</span>&nbsp;<span class="builtintype" id="6111063">uint32</span><span class="op" id="6111069">(</span><span class="builtinfunc" id="6111070">len</span><span class="op" id="6111073">(</span><span class="ident" id="6111074"><a href="/net/http/fcgi/fcgi.go.html#6111020">k</a></span><span class="op" id="6111075">)</span><span class="op" id="6111076">)</span><span class="op" id="6111077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111081"><a href="/net/http/fcgi/fcgi.go.html#6111044">n</a></span>&nbsp;<span class="op" id="6111083">+=</span>&nbsp;<span class="ident" id="6111086"><a href="/net/http/fcgi/fcgi.go.html#6111711">encodeSize</a></span><span class="op" id="6111096">(</span><span class="ident" id="6111097"><a href="/net/http/fcgi/fcgi.go.html#6110994">b</a></span><span class="op" id="6111098">[</span><span class="ident" id="6111099"><a href="/net/http/fcgi/fcgi.go.html#6111044">n</a></span><span class="op" id="6111100">:</span><span class="op" id="6111101">]</span><span class="op" id="6111102">,</span>&nbsp;<span class="builtintype" id="6111104">uint32</span><span class="op" id="6111110">(</span><span class="builtinfunc" id="6111111">len</span><span class="op" id="6111114">(</span><span class="ident" id="6111115"><a href="/net/http/fcgi/fcgi.go.html#6111023">v</a></span><span class="op" id="6111116">)</span><span class="op" id="6111117">)</span><span class="op" id="6111118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111122">if</span>&nbsp;<span class="ident" id="6111125">_</span><span class="op" id="6111126">,</span>&nbsp;<span class="ident" id="6111128">err</span>&nbsp;<span class="op" id="6111132">:=</span>&nbsp;<span class="ident" id="6111135"><a href="/net/http/fcgi/fcgi.go.html#6110959">w</a></span><span class="op" id="6111136">.</span><span class="ident" id="6111137">Write</span><span class="op" id="6111142">(</span><span class="ident" id="6111143"><a href="/net/http/fcgi/fcgi.go.html#6110994">b</a></span><span class="op" id="6111144">[</span><span class="op" id="6111145">:</span><span class="ident" id="6111146"><a href="/net/http/fcgi/fcgi.go.html#6111044">n</a></span><span class="op" id="6111147">]</span><span class="op" id="6111148">)</span><span class="op" id="6111149">;</span>&nbsp;<span class="ident" id="6111151"><a href="/net/http/fcgi/fcgi.go.html#6111128">err</a></span>&nbsp;<span class="op" id="6111155">!=</span>&nbsp;<span class="ident" id="6111158">nil</span>&nbsp;<span class="op" id="6111162">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111167">return</span>&nbsp;<span class="ident" id="6111174"><a href="/net/http/fcgi/fcgi.go.html#6111128">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111184">if</span>&nbsp;<span class="ident" id="6111187">_</span><span class="op" id="6111188">,</span>&nbsp;<span class="ident" id="6111190">err</span>&nbsp;<span class="op" id="6111194">:=</span>&nbsp;<span class="ident" id="6111197"><a href="/net/http/fcgi/fcgi.go.html#6110959">w</a></span><span class="op" id="6111198">.</span><span class="ident" id="6111199">WriteString</span><span class="op" id="6111210">(</span><span class="ident" id="6111211"><a href="/net/http/fcgi/fcgi.go.html#6111020">k</a></span><span class="op" id="6111212">)</span><span class="op" id="6111213">;</span>&nbsp;<span class="ident" id="6111215"><a href="/net/http/fcgi/fcgi.go.html#6111190">err</a></span>&nbsp;<span class="op" id="6111219">!=</span>&nbsp;<span class="ident" id="6111222">nil</span>&nbsp;<span class="op" id="6111226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111231">return</span>&nbsp;<span class="ident" id="6111238"><a href="/net/http/fcgi/fcgi.go.html#6111190">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111244">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111248">if</span>&nbsp;<span class="ident" id="6111251">_</span><span class="op" id="6111252">,</span>&nbsp;<span class="ident" id="6111254">err</span>&nbsp;<span class="op" id="6111258">:=</span>&nbsp;<span class="ident" id="6111261"><a href="/net/http/fcgi/fcgi.go.html#6110959">w</a></span><span class="op" id="6111262">.</span><span class="ident" id="6111263">WriteString</span><span class="op" id="6111274">(</span><span class="ident" id="6111275"><a href="/net/http/fcgi/fcgi.go.html#6111023">v</a></span><span class="op" id="6111276">)</span><span class="op" id="6111277">;</span>&nbsp;<span class="ident" id="6111279"><a href="/net/http/fcgi/fcgi.go.html#6111254">err</a></span>&nbsp;<span class="op" id="6111283">!=</span>&nbsp;<span class="ident" id="6111286">nil</span>&nbsp;<span class="op" id="6111290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111295">return</span>&nbsp;<span class="ident" id="6111302"><a href="/net/http/fcgi/fcgi.go.html#6111254">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111314"><a href="/net/http/fcgi/fcgi.go.html#6110959">w</a></span><span class="op" id="6111315">.</span><span class="ident" id="6111316">Close</span><span class="op" id="6111321">(</span><span class="op" id="6111322">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111325">return</span>&nbsp;<span class="ident" id="6111332">nil</span><br>
<span class="lineno"></span><span class="op" id="6111336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6111339">func</span>&nbsp;<span class="ident" id="6111344">readSize</span><span class="op" id="6111352">(</span><span class="ident" id="6111353">s</span>&nbsp;<span class="op" id="6111355">[</span><span class="op" id="6111356">]</span><span class="builtintype" id="6111357">byte</span><span class="op" id="6111361">)</span>&nbsp;<span class="op" id="6111363">(</span><span class="builtintype" id="6111364">uint32</span><span class="op" id="6111370">,</span>&nbsp;<span class="builtintype" id="6111372">int</span><span class="op" id="6111375">)</span>&nbsp;<span class="op" id="6111377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111380">if</span>&nbsp;<span class="builtinfunc" id="6111383">len</span><span class="op" id="6111386">(</span><span class="ident" id="6111387"><a href="/net/http/fcgi/fcgi.go.html#6111353">s</a></span><span class="op" id="6111388">)</span>&nbsp;<span class="op" id="6111390">==</span>&nbsp;<span class="num" id="6111393">0</span>&nbsp;<span class="op" id="6111395">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111399">return</span>&nbsp;<span class="num" id="6111406">0</span><span class="op" id="6111407">,</span>&nbsp;<span class="num" id="6111409">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111415">size</span><span class="op" id="6111419">,</span>&nbsp;<span class="ident" id="6111421">n</span>&nbsp;<span class="op" id="6111423">:=</span>&nbsp;<span class="builtintype" id="6111426">uint32</span><span class="op" id="6111432">(</span><span class="ident" id="6111433"><a href="/net/http/fcgi/fcgi.go.html#6111353">s</a></span><span class="op" id="6111434">[</span><span class="num" id="6111435">0</span><span class="op" id="6111436">]</span><span class="op" id="6111437">)</span><span class="op" id="6111438">,</span>&nbsp;<span class="num" id="6111440">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111443">if</span>&nbsp;<span class="ident" id="6111446"><a href="/net/http/fcgi/fcgi.go.html#6111415">size</a></span><span class="op" id="6111450">&amp;</span><span class="op" id="6111451">(</span><span class="num" id="6111452">1</span><span class="op" id="6111453">&lt;&lt;</span><span class="num" id="6111455">7</span><span class="op" id="6111456">)</span>&nbsp;<span class="op" id="6111458">!=</span>&nbsp;<span class="num" id="6111461">0</span>&nbsp;<span class="op" id="6111463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111467">if</span>&nbsp;<span class="builtinfunc" id="6111470">len</span><span class="op" id="6111473">(</span><span class="ident" id="6111474"><a href="/net/http/fcgi/fcgi.go.html#6111353">s</a></span><span class="op" id="6111475">)</span>&nbsp;<span class="op" id="6111477">&lt;</span>&nbsp;<span class="num" id="6111479">4</span>&nbsp;<span class="op" id="6111481">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111486">return</span>&nbsp;<span class="num" id="6111493">0</span><span class="op" id="6111494">,</span>&nbsp;<span class="num" id="6111496">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111504"><a href="/net/http/fcgi/fcgi.go.html#6111421">n</a></span>&nbsp;<span class="op" id="6111506">=</span>&nbsp;<span class="num" id="6111508">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111512"><a href="/net/http/fcgi/fcgi.go.html#6111415">size</a></span>&nbsp;<span class="op" id="6111517">=</span>&nbsp;<span class="ident" id="6111519"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6111525">.</span><span class="ident" id="6111526">BigEndian</span><span class="op" id="6111535">.</span><span class="ident" id="6111536">Uint32</span><span class="op" id="6111542">(</span><span class="ident" id="6111543"><a href="/net/http/fcgi/fcgi.go.html#6111353">s</a></span><span class="op" id="6111544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111548"><a href="/net/http/fcgi/fcgi.go.html#6111415">size</a></span>&nbsp;<span class="op" id="6111553">&amp;^=</span>&nbsp;<span class="num" id="6111557">1</span>&nbsp;<span class="op" id="6111559">&lt;&lt;</span>&nbsp;<span class="num" id="6111562">31</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111569">return</span>&nbsp;<span class="ident" id="6111576"><a href="/net/http/fcgi/fcgi.go.html#6111415">size</a></span><span class="op" id="6111580">,</span>&nbsp;<span class="ident" id="6111582"><a href="/net/http/fcgi/fcgi.go.html#6111421">n</a></span><br>
<span class="lineno"></span><span class="op" id="6111584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6111587">func</span>&nbsp;<span class="ident" id="6111592">readString</span><span class="op" id="6111602">(</span><span class="ident" id="6111603">s</span>&nbsp;<span class="op" id="6111605">[</span><span class="op" id="6111606">]</span><span class="builtintype" id="6111607">byte</span><span class="op" id="6111611">,</span>&nbsp;<span class="ident" id="6111613">size</span>&nbsp;<span class="builtintype" id="6111618">uint32</span><span class="op" id="6111624">)</span>&nbsp;<span class="builtintype" id="6111626">string</span>&nbsp;<span class="op" id="6111633">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111636">if</span>&nbsp;<span class="ident" id="6111639"><a href="/net/http/fcgi/fcgi.go.html#6111613">size</a></span>&nbsp;<span class="op" id="6111644">&gt;</span>&nbsp;<span class="builtintype" id="6111646">uint32</span><span class="op" id="6111652">(</span><span class="builtinfunc" id="6111653">len</span><span class="op" id="6111656">(</span><span class="ident" id="6111657"><a href="/net/http/fcgi/fcgi.go.html#6111603">s</a></span><span class="op" id="6111658">)</span><span class="op" id="6111659">)</span>&nbsp;<span class="op" id="6111661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111665">return</span>&nbsp;<span class="string" id="6111672">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111679">return</span>&nbsp;<span class="builtintype" id="6111686">string</span><span class="op" id="6111692">(</span><span class="ident" id="6111693"><a href="/net/http/fcgi/fcgi.go.html#6111603">s</a></span><span class="op" id="6111694">[</span><span class="op" id="6111695">:</span><span class="ident" id="6111696"><a href="/net/http/fcgi/fcgi.go.html#6111613">size</a></span><span class="op" id="6111700">]</span><span class="op" id="6111701">)</span><br>
<span class="lineno"></span><span class="op" id="6111703">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6111706">func</span>&nbsp;<span class="ident" id="6111711">encodeSize</span><span class="op" id="6111721">(</span><span class="ident" id="6111722">b</span>&nbsp;<span class="op" id="6111724">[</span><span class="op" id="6111725">]</span><span class="builtintype" id="6111726">byte</span><span class="op" id="6111730">,</span>&nbsp;<span class="ident" id="6111732">size</span>&nbsp;<span class="builtintype" id="6111737">uint32</span><span class="op" id="6111743">)</span>&nbsp;<span class="builtintype" id="6111745">int</span>&nbsp;<span class="op" id="6111749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111752">if</span>&nbsp;<span class="ident" id="6111755"><a href="/net/http/fcgi/fcgi.go.html#6111732">size</a></span>&nbsp;<span class="op" id="6111760">&gt;</span>&nbsp;<span class="num" id="6111762">127</span>&nbsp;<span class="op" id="6111766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111770"><a href="/net/http/fcgi/fcgi.go.html#6111732">size</a></span>&nbsp;<span class="op" id="6111775">|=</span>&nbsp;<span class="num" id="6111778">1</span>&nbsp;<span class="op" id="6111780">&lt;&lt;</span>&nbsp;<span class="num" id="6111783">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111788"><a href="/net/http/fcgi/fcgi.go.html#6107402">binary</a></span><span class="op" id="6111794">.</span><span class="ident" id="6111795">BigEndian</span><span class="op" id="6111804">.</span><span class="ident" id="6111805">PutUint32</span><span class="op" id="6111814">(</span><span class="ident" id="6111815"><a href="/net/http/fcgi/fcgi.go.html#6111722">b</a></span><span class="op" id="6111816">,</span>&nbsp;<span class="ident" id="6111818"><a href="/net/http/fcgi/fcgi.go.html#6111732">size</a></span><span class="op" id="6111822">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111826">return</span>&nbsp;<span class="num" id="6111833">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111839"><a href="/net/http/fcgi/fcgi.go.html#6111722">b</a></span><span class="op" id="6111840">[</span><span class="num" id="6111841">0</span><span class="op" id="6111842">]</span>&nbsp;<span class="op" id="6111844">=</span>&nbsp;<span class="builtintype" id="6111846">byte</span><span class="op" id="6111850">(</span><span class="ident" id="6111851"><a href="/net/http/fcgi/fcgi.go.html#6111732">size</a></span><span class="op" id="6111855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111858">return</span>&nbsp;<span class="num" id="6111865">1</span><br>
<span class="lineno"></span><span class="op" id="6111867">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="6111870">//&nbsp;bufWriter&nbsp;encapsulates&nbsp;bufio.Writer&nbsp;but&nbsp;also&nbsp;closes&nbsp;the&nbsp;underlying&nbsp;stream&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6111952">//&nbsp;Closed.</span><br>
<span class="lineno"></span><span class="keyword" id="6111963">type</span>&nbsp;<span class="ident" id="6111968">bufWriter</span>&nbsp;<span class="keyword" id="6111978">struct</span>&nbsp;<span class="op" id="6111985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111988">closer</span>&nbsp;<span class="ident" id="6111995"><a href="/net/http/fcgi/fcgi.go.html#6107431">io</a></span><span class="op" id="6111997">.</span><span class="ident" id="6111998">Closer</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112006">*</span><span class="ident" id="6112007"><a href="/net/http/fcgi/fcgi.go.html#6107384">bufio</a></span><span class="op" id="6112012">.</span><span class="ident" id="6112013">Writer</span><br>
<span class="lineno"></span><span class="op" id="6112020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6112023">func</span>&nbsp;<span class="op" id="6112028">(</span><span class="ident" id="6112029">w</span>&nbsp;<span class="op" id="6112031">*</span><span class="ident" id="6112032"><a href="/net/http/fcgi/fcgi.go.html#6111968">bufWriter</a></span><span class="op" id="6112041">)</span>&nbsp;<span class="ident" id="6112043">Close</span><span class="op" id="6112048">(</span><span class="op" id="6112049">)</span>&nbsp;<span class="builtintype" id="6112051">error</span>&nbsp;<span class="op" id="6112057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112060">if</span>&nbsp;<span class="ident" id="6112063">err</span>&nbsp;<span class="op" id="6112067">:=</span>&nbsp;<span class="ident" id="6112070"><a href="/net/http/fcgi/fcgi.go.html#6112029">w</a></span><span class="op" id="6112071">.</span><span class="ident" id="6112072">Writer</span><span class="op" id="6112078">.</span><span class="ident" id="6112079">Flush</span><span class="op" id="6112084">(</span><span class="op" id="6112085">)</span><span class="op" id="6112086">;</span>&nbsp;<span class="ident" id="6112088"><a href="/net/http/fcgi/fcgi.go.html#6112063">err</a></span>&nbsp;<span class="op" id="6112092">!=</span>&nbsp;<span class="ident" id="6112095">nil</span>&nbsp;<span class="op" id="6112099">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112103"><a href="/net/http/fcgi/fcgi.go.html#6112029">w</a></span><span class="op" id="6112104">.</span><span class="ident" id="6112105">closer</span><span class="op" id="6112111">.</span><span class="ident" id="6112112">Close</span><span class="op" id="6112117">(</span><span class="op" id="6112118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112122">return</span>&nbsp;<span class="ident" id="6112129"><a href="/net/http/fcgi/fcgi.go.html#6112063">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112137">return</span>&nbsp;<span class="ident" id="6112144"><a href="/net/http/fcgi/fcgi.go.html#6112029">w</a></span><span class="op" id="6112145">.</span><span class="ident" id="6112146">closer</span><span class="op" id="6112152">.</span><span class="ident" id="6112153">Close</span><span class="op" id="6112158">(</span><span class="op" id="6112159">)</span><br>
<span class="lineno"></span><span class="op" id="6112161">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="6112164">func</span>&nbsp;<span class="ident" id="6112169">newWriter</span><span class="op" id="6112178">(</span><span class="ident" id="6112179">c</span>&nbsp;<span class="op" id="6112181">*</span><span class="ident" id="6112182"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><span class="op" id="6112186">,</span>&nbsp;<span class="ident" id="6112188">recType</span>&nbsp;<span class="ident" id="6112196"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><span class="op" id="6112203">,</span>&nbsp;<span class="ident" id="6112205">reqId</span>&nbsp;<span class="builtintype" id="6112211">uint16</span><span class="op" id="6112217">)</span>&nbsp;<span class="op" id="6112219">*</span><span class="ident" id="6112220"><a href="/net/http/fcgi/fcgi.go.html#6111968">bufWriter</a></span>&nbsp;<span class="op" id="6112230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112233">s</span>&nbsp;<span class="op" id="6112235">:=</span>&nbsp;<span class="op" id="6112238">&amp;</span><span class="ident" id="6112239"><a href="/net/http/fcgi/fcgi.go.html#6112486">streamWriter</a></span><span class="op" id="6112251">{</span><span class="ident" id="6112252">c</span><span class="op" id="6112253">:</span>&nbsp;<span class="ident" id="6112255"><a href="/net/http/fcgi/fcgi.go.html#6112179">c</a></span><span class="op" id="6112256">,</span>&nbsp;<span class="ident" id="6112258">recType</span><span class="op" id="6112265">:</span>&nbsp;<span class="ident" id="6112267"><a href="/net/http/fcgi/fcgi.go.html#6112188">recType</a></span><span class="op" id="6112274">,</span>&nbsp;<span class="ident" id="6112276">reqId</span><span class="op" id="6112281">:</span>&nbsp;<span class="ident" id="6112283"><a href="/net/http/fcgi/fcgi.go.html#6112205">reqId</a></span><span class="op" id="6112288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112291">w</span>&nbsp;<span class="op" id="6112293">:=</span>&nbsp;<span class="ident" id="6112296"><a href="/net/http/fcgi/fcgi.go.html#6107384">bufio</a></span><span class="op" id="6112301">.</span><span class="ident" id="6112302">NewWriterSize</span><span class="op" id="6112315">(</span><span class="ident" id="6112316"><a href="/net/http/fcgi/fcgi.go.html#6112233">s</a></span><span class="op" id="6112317">,</span>&nbsp;<span class="ident" id="6112319"><a href="/net/http/fcgi/fcgi.go.html#6108049">maxWrite</a></span><span class="op" id="6112327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112330">return</span>&nbsp;<span class="op" id="6112337">&amp;</span><span class="ident" id="6112338"><a href="/net/http/fcgi/fcgi.go.html#6111968">bufWriter</a></span><span class="op" id="6112347">{</span><span class="ident" id="6112348"><a href="/net/http/fcgi/fcgi.go.html#6112233">s</a></span><span class="op" id="6112349">,</span>&nbsp;<span class="ident" id="6112351"><a href="/net/http/fcgi/fcgi.go.html#6112291">w</a></span><span class="op" id="6112352">}</span><br>
<span class="lineno">245</span><span class="op" id="6112354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112357">//&nbsp;streamWriter&nbsp;abstracts&nbsp;out&nbsp;the&nbsp;separation&nbsp;of&nbsp;a&nbsp;stream&nbsp;into&nbsp;discrete&nbsp;records.</span><br>
<span class="lineno"></span><span class="comment" id="6112437">//&nbsp;It&nbsp;only&nbsp;writes&nbsp;maxWrite&nbsp;bytes&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6112481">type</span>&nbsp;<span class="ident" id="6112486">streamWriter</span>&nbsp;<span class="keyword" id="6112499">struct</span>&nbsp;<span class="op" id="6112506">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112509">c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6112517">*</span><span class="ident" id="6112518"><a href="/net/http/fcgi/fcgi.go.html#6109174">conn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112524">recType</span>&nbsp;<span class="ident" id="6112532"><a href="/net/http/fcgi/fcgi.go.html#6107550">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112541">reqId</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6112549">uint16</span><br>
<span class="lineno"></span><span class="op" id="6112556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="6112559">func</span>&nbsp;<span class="op" id="6112564">(</span><span class="ident" id="6112565">w</span>&nbsp;<span class="op" id="6112567">*</span><span class="ident" id="6112568"><a href="/net/http/fcgi/fcgi.go.html#6112486">streamWriter</a></span><span class="op" id="6112580">)</span>&nbsp;<span class="ident" id="6112582">Write</span><span class="op" id="6112587">(</span><span class="ident" id="6112588">p</span>&nbsp;<span class="op" id="6112590">[</span><span class="op" id="6112591">]</span><span class="builtintype" id="6112592">byte</span><span class="op" id="6112596">)</span>&nbsp;<span class="op" id="6112598">(</span><span class="builtintype" id="6112599">int</span><span class="op" id="6112602">,</span>&nbsp;<span class="builtintype" id="6112604">error</span><span class="op" id="6112609">)</span>&nbsp;<span class="op" id="6112611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112614">nn</span>&nbsp;<span class="op" id="6112617">:=</span>&nbsp;<span class="num" id="6112620">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112623">for</span>&nbsp;<span class="builtinfunc" id="6112627">len</span><span class="op" id="6112630">(</span><span class="ident" id="6112631"><a href="/net/http/fcgi/fcgi.go.html#6112588">p</a></span><span class="op" id="6112632">)</span>&nbsp;<span class="op" id="6112634">&gt;</span>&nbsp;<span class="num" id="6112636">0</span>&nbsp;<span class="op" id="6112638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112642">n</span>&nbsp;<span class="op" id="6112644">:=</span>&nbsp;<span class="builtinfunc" id="6112647">len</span><span class="op" id="6112650">(</span><span class="ident" id="6112651"><a href="/net/http/fcgi/fcgi.go.html#6112588">p</a></span><span class="op" id="6112652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112656">if</span>&nbsp;<span class="ident" id="6112659"><a href="/net/http/fcgi/fcgi.go.html#6112642">n</a></span>&nbsp;<span class="op" id="6112661">&gt;</span>&nbsp;<span class="ident" id="6112663"><a href="/net/http/fcgi/fcgi.go.html#6108049">maxWrite</a></span>&nbsp;<span class="op" id="6112672">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112677"><a href="/net/http/fcgi/fcgi.go.html#6112642">n</a></span>&nbsp;<span class="op" id="6112679">=</span>&nbsp;<span class="ident" id="6112681"><a href="/net/http/fcgi/fcgi.go.html#6108049">maxWrite</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112696">if</span>&nbsp;<span class="ident" id="6112699">err</span>&nbsp;<span class="op" id="6112703">:=</span>&nbsp;<span class="ident" id="6112706"><a href="/net/http/fcgi/fcgi.go.html#6112565">w</a></span><span class="op" id="6112707">.</span><span class="ident" id="6112708">c</span><span class="op" id="6112709">.</span><span class="ident" id="6112710">writeRecord</span><span class="op" id="6112721">(</span><span class="ident" id="6112722"><a href="/net/http/fcgi/fcgi.go.html#6112565">w</a></span><span class="op" id="6112723">.</span><span class="ident" id="6112724">recType</span><span class="op" id="6112731">,</span>&nbsp;<span class="ident" id="6112733"><a href="/net/http/fcgi/fcgi.go.html#6112565">w</a></span><span class="op" id="6112734">.</span><span class="ident" id="6112735">reqId</span><span class="op" id="6112740">,</span>&nbsp;<span class="ident" id="6112742"><a href="/net/http/fcgi/fcgi.go.html#6112588">p</a></span><span class="op" id="6112743">[</span><span class="op" id="6112744">:</span><span class="ident" id="6112745"><a href="/net/http/fcgi/fcgi.go.html#6112642">n</a></span><span class="op" id="6112746">]</span><span class="op" id="6112747">)</span><span class="op" id="6112748">;</span>&nbsp;<span class="ident" id="6112750"><a href="/net/http/fcgi/fcgi.go.html#6112699">err</a></span>&nbsp;<span class="op" id="6112754">!=</span>&nbsp;<span class="ident" id="6112757">nil</span>&nbsp;<span class="op" id="6112761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112766">return</span>&nbsp;<span class="ident" id="6112773"><a href="/net/http/fcgi/fcgi.go.html#6112614">nn</a></span><span class="op" id="6112775">,</span>&nbsp;<span class="ident" id="6112777"><a href="/net/http/fcgi/fcgi.go.html#6112699">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112783">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112787"><a href="/net/http/fcgi/fcgi.go.html#6112614">nn</a></span>&nbsp;<span class="op" id="6112790">+=</span>&nbsp;<span class="ident" id="6112793"><a href="/net/http/fcgi/fcgi.go.html#6112642">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112797"><a href="/net/http/fcgi/fcgi.go.html#6112588">p</a></span>&nbsp;<span class="op" id="6112799">=</span>&nbsp;<span class="ident" id="6112801"><a href="/net/http/fcgi/fcgi.go.html#6112588">p</a></span><span class="op" id="6112802">[</span><span class="ident" id="6112803"><a href="/net/http/fcgi/fcgi.go.html#6112642">n</a></span><span class="op" id="6112804">:</span><span class="op" id="6112805">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112811">return</span>&nbsp;<span class="ident" id="6112818"><a href="/net/http/fcgi/fcgi.go.html#6112614">nn</a></span><span class="op" id="6112820">,</span>&nbsp;<span class="ident" id="6112822">nil</span><br>
<span class="lineno"></span><span class="op" id="6112826">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="6112829">func</span>&nbsp;<span class="op" id="6112834">(</span><span class="ident" id="6112835">w</span>&nbsp;<span class="op" id="6112837">*</span><span class="ident" id="6112838"><a href="/net/http/fcgi/fcgi.go.html#6112486">streamWriter</a></span><span class="op" id="6112850">)</span>&nbsp;<span class="ident" id="6112852">Close</span><span class="op" id="6112857">(</span><span class="op" id="6112858">)</span>&nbsp;<span class="builtintype" id="6112860">error</span>&nbsp;<span class="op" id="6112866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6112869">//&nbsp;send&nbsp;empty&nbsp;record&nbsp;to&nbsp;close&nbsp;the&nbsp;stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112911">return</span>&nbsp;<span class="ident" id="6112918"><a href="/net/http/fcgi/fcgi.go.html#6112835">w</a></span><span class="op" id="6112919">.</span><span class="ident" id="6112920">c</span><span class="op" id="6112921">.</span><span class="ident" id="6112922">writeRecord</span><span class="op" id="6112933">(</span><span class="ident" id="6112934"><a href="/net/http/fcgi/fcgi.go.html#6112835">w</a></span><span class="op" id="6112935">.</span><span class="ident" id="6112936">recType</span><span class="op" id="6112943">,</span>&nbsp;<span class="ident" id="6112945"><a href="/net/http/fcgi/fcgi.go.html#6112835">w</a></span><span class="op" id="6112946">.</span><span class="ident" id="6112947">reqId</span><span class="op" id="6112952">,</span>&nbsp;<span class="ident" id="6112954">nil</span><span class="op" id="6112957">)</span><br>
<span class="lineno"></span><span class="op" id="6112959">}</span>
</div>
</body>
</html>
