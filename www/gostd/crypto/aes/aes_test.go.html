<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7523406">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7523461">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7523515">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7523566">package</span>&nbsp;<span class="ident" id="7523574">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7523579">import</span>&nbsp;<span class="op" id="7523586">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7523589">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7523599">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="7523602">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7523646">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="7523690">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="7523735">func</span>&nbsp;<span class="ident" id="7523740">TestPowx</span><span class="op" id="7523748">(</span><span class="ident" id="7523749">t</span>&nbsp;<span class="op" id="7523751">*</span><span class="ident" id="7523752">testing</span><span class="op" id="7523759">.</span><span class="ident" id="7523760">T</span><span class="op" id="7523761">)</span>&nbsp;<span class="op" id="7523763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523766">p</span>&nbsp;<span class="op" id="7523768">:=</span>&nbsp;<span class="num" id="7523771">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523774">for</span>&nbsp;<span class="ident" id="7523778">i</span>&nbsp;<span class="op" id="7523780">:=</span>&nbsp;<span class="num" id="7523783">0</span><span class="op" id="7523784">;</span>&nbsp;<span class="ident" id="7523786">i</span>&nbsp;<span class="op" id="7523788">&lt;</span>&nbsp;<span class="builtinfunc" id="7523790">len</span><span class="op" id="7523793">(</span><span class="ident" id="7523794">powx</span><span class="op" id="7523798">)</span><span class="op" id="7523799">;</span>&nbsp;<span class="ident" id="7523801">i</span><span class="op" id="7523802">++</span>&nbsp;<span class="op" id="7523805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523809">if</span>&nbsp;<span class="ident" id="7523812">powx</span><span class="op" id="7523816">[</span><span class="ident" id="7523817">i</span><span class="op" id="7523818">]</span>&nbsp;<span class="op" id="7523820">!=</span>&nbsp;<span class="builtintype" id="7523823">byte</span><span class="op" id="7523827">(</span><span class="ident" id="7523828">p</span><span class="op" id="7523829">)</span>&nbsp;<span class="op" id="7523831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523836">t</span><span class="op" id="7523837">.</span><span class="ident" id="7523838">Errorf</span><span class="op" id="7523844">(</span><span class="string" id="7523845">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7523871">,</span>&nbsp;<span class="ident" id="7523873">i</span><span class="op" id="7523874">,</span>&nbsp;<span class="ident" id="7523876">powx</span><span class="op" id="7523880">[</span><span class="ident" id="7523881">i</span><span class="op" id="7523882">]</span><span class="op" id="7523883">,</span>&nbsp;<span class="ident" id="7523885">p</span><span class="op" id="7523886">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523894">p</span>&nbsp;<span class="op" id="7523896">&lt;&lt;=</span>&nbsp;<span class="num" id="7523900">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523904">if</span>&nbsp;<span class="ident" id="7523907">p</span><span class="op" id="7523908">&amp;</span><span class="num" id="7523909">0x100</span>&nbsp;<span class="op" id="7523915">!=</span>&nbsp;<span class="num" id="7523918">0</span>&nbsp;<span class="op" id="7523920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523925">p</span>&nbsp;<span class="op" id="7523927">^=</span>&nbsp;<span class="ident" id="7523930">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523937">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523940">}</span><br>
<span class="lineno"></span><span class="op" id="7523942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7523945">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="7523998">func</span>&nbsp;<span class="ident" id="7524003">mul</span><span class="op" id="7524006">(</span><span class="ident" id="7524007">b</span><span class="op" id="7524008">,</span>&nbsp;<span class="ident" id="7524010">c</span>&nbsp;<span class="builtintype" id="7524012">uint32</span><span class="op" id="7524018">)</span>&nbsp;<span class="builtintype" id="7524020">uint32</span>&nbsp;<span class="op" id="7524027">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524030">i</span>&nbsp;<span class="op" id="7524032">:=</span>&nbsp;<span class="ident" id="7524035">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524038">j</span>&nbsp;<span class="op" id="7524040">:=</span>&nbsp;<span class="ident" id="7524043">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524046">s</span>&nbsp;<span class="op" id="7524048">:=</span>&nbsp;<span class="builtintype" id="7524051">uint32</span><span class="op" id="7524057">(</span><span class="num" id="7524058">0</span><span class="op" id="7524059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524062">for</span>&nbsp;<span class="ident" id="7524066">k</span>&nbsp;<span class="op" id="7524068">:=</span>&nbsp;<span class="builtintype" id="7524071">uint32</span><span class="op" id="7524077">(</span><span class="num" id="7524078">1</span><span class="op" id="7524079">)</span><span class="op" id="7524080">;</span>&nbsp;<span class="ident" id="7524082">k</span>&nbsp;<span class="op" id="7524084">&lt;</span>&nbsp;<span class="num" id="7524086">0x100</span>&nbsp;<span class="op" id="7524092">&amp;&amp;</span>&nbsp;<span class="ident" id="7524095">j</span>&nbsp;<span class="op" id="7524097">!=</span>&nbsp;<span class="num" id="7524100">0</span><span class="op" id="7524101">;</span>&nbsp;<span class="ident" id="7524103">k</span>&nbsp;<span class="op" id="7524105">&lt;&lt;=</span>&nbsp;<span class="num" id="7524109">1</span>&nbsp;<span class="op" id="7524111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7524115">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524157">if</span>&nbsp;<span class="ident" id="7524160">j</span><span class="op" id="7524161">&amp;</span><span class="ident" id="7524162">k</span>&nbsp;<span class="op" id="7524164">!=</span>&nbsp;<span class="num" id="7524167">0</span>&nbsp;<span class="op" id="7524169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7524174">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524211">s</span>&nbsp;<span class="op" id="7524213">^=</span>&nbsp;<span class="ident" id="7524216">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524221">j</span>&nbsp;<span class="op" id="7524223">^=</span>&nbsp;<span class="ident" id="7524226">k</span>&nbsp;<span class="comment" id="7524228">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7524269">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524312">i</span>&nbsp;<span class="op" id="7524314">&lt;&lt;=</span>&nbsp;<span class="num" id="7524318">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524322">if</span>&nbsp;<span class="ident" id="7524325">i</span><span class="op" id="7524326">&amp;</span><span class="num" id="7524327">0x100</span>&nbsp;<span class="op" id="7524333">!=</span>&nbsp;<span class="num" id="7524336">0</span>&nbsp;<span class="op" id="7524338">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524343">i</span>&nbsp;<span class="op" id="7524345">^=</span>&nbsp;<span class="ident" id="7524348">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524361">return</span>&nbsp;<span class="ident" id="7524368">s</span><br>
<span class="lineno"></span><span class="op" id="7524370">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="7524373">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="7524430">func</span>&nbsp;<span class="ident" id="7524435">TestMul</span><span class="op" id="7524442">(</span><span class="ident" id="7524443">t</span>&nbsp;<span class="op" id="7524445">*</span><span class="ident" id="7524446">testing</span><span class="op" id="7524453">.</span><span class="ident" id="7524454">T</span><span class="op" id="7524455">)</span>&nbsp;<span class="op" id="7524457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524460">for</span>&nbsp;<span class="ident" id="7524464">i</span>&nbsp;<span class="op" id="7524466">:=</span>&nbsp;<span class="builtintype" id="7524469">uint32</span><span class="op" id="7524475">(</span><span class="num" id="7524476">0</span><span class="op" id="7524477">)</span><span class="op" id="7524478">;</span>&nbsp;<span class="ident" id="7524480">i</span>&nbsp;<span class="op" id="7524482">&lt;</span>&nbsp;<span class="num" id="7524484">256</span><span class="op" id="7524487">;</span>&nbsp;<span class="ident" id="7524489">i</span><span class="op" id="7524490">++</span>&nbsp;<span class="op" id="7524493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524497">for</span>&nbsp;<span class="ident" id="7524501">j</span>&nbsp;<span class="op" id="7524503">:=</span>&nbsp;<span class="builtintype" id="7524506">uint32</span><span class="op" id="7524512">(</span><span class="num" id="7524513">0</span><span class="op" id="7524514">)</span><span class="op" id="7524515">;</span>&nbsp;<span class="ident" id="7524517">j</span>&nbsp;<span class="op" id="7524519">&lt;</span>&nbsp;<span class="num" id="7524521">256</span><span class="op" id="7524524">;</span>&nbsp;<span class="ident" id="7524526">j</span><span class="op" id="7524527">++</span>&nbsp;<span class="op" id="7524530">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7524535">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524567">s</span>&nbsp;<span class="op" id="7524569">:=</span>&nbsp;<span class="builtintype" id="7524572">uint8</span><span class="op" id="7524577">(</span><span class="num" id="7524578">0</span><span class="op" id="7524579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524584">for</span>&nbsp;<span class="ident" id="7524588">k</span>&nbsp;<span class="op" id="7524590">:=</span>&nbsp;<span class="builtintype" id="7524593">uint</span><span class="op" id="7524597">(</span><span class="num" id="7524598">0</span><span class="op" id="7524599">)</span><span class="op" id="7524600">;</span>&nbsp;<span class="ident" id="7524602">k</span>&nbsp;<span class="op" id="7524604">&lt;</span>&nbsp;<span class="num" id="7524606">8</span><span class="op" id="7524607">;</span>&nbsp;<span class="ident" id="7524609">k</span><span class="op" id="7524610">++</span>&nbsp;<span class="op" id="7524613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524619">for</span>&nbsp;<span class="ident" id="7524623">l</span>&nbsp;<span class="op" id="7524625">:=</span>&nbsp;<span class="builtintype" id="7524628">uint</span><span class="op" id="7524632">(</span><span class="num" id="7524633">0</span><span class="op" id="7524634">)</span><span class="op" id="7524635">;</span>&nbsp;<span class="ident" id="7524637">l</span>&nbsp;<span class="op" id="7524639">&lt;</span>&nbsp;<span class="num" id="7524641">8</span><span class="op" id="7524642">;</span>&nbsp;<span class="ident" id="7524644">l</span><span class="op" id="7524645">++</span>&nbsp;<span class="op" id="7524648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524655">if</span>&nbsp;<span class="ident" id="7524658">i</span><span class="op" id="7524659">&amp;</span><span class="op" id="7524660">(</span><span class="num" id="7524661">1</span><span class="op" id="7524662">&lt;&lt;</span><span class="ident" id="7524664">k</span><span class="op" id="7524665">)</span>&nbsp;<span class="op" id="7524667">!=</span>&nbsp;<span class="num" id="7524670">0</span>&nbsp;<span class="op" id="7524672">&amp;&amp;</span>&nbsp;<span class="ident" id="7524675">j</span><span class="op" id="7524676">&amp;</span><span class="op" id="7524677">(</span><span class="num" id="7524678">1</span><span class="op" id="7524679">&lt;&lt;</span><span class="ident" id="7524681">l</span><span class="op" id="7524682">)</span>&nbsp;<span class="op" id="7524684">!=</span>&nbsp;<span class="num" id="7524687">0</span>&nbsp;<span class="op" id="7524689">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524697">s</span>&nbsp;<span class="op" id="7524699">^=</span>&nbsp;<span class="ident" id="7524702">powx</span><span class="op" id="7524706">[</span><span class="ident" id="7524707">k</span><span class="op" id="7524708">+</span><span class="ident" id="7524709">l</span><span class="op" id="7524710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7524733">if</span>&nbsp;<span class="ident" id="7524736">x</span>&nbsp;<span class="op" id="7524738">:=</span>&nbsp;<span class="ident" id="7524741">mul</span><span class="op" id="7524744">(</span><span class="ident" id="7524745">i</span><span class="op" id="7524746">,</span>&nbsp;<span class="ident" id="7524748">j</span><span class="op" id="7524749">)</span><span class="op" id="7524750">;</span>&nbsp;<span class="ident" id="7524752">x</span>&nbsp;<span class="op" id="7524754">!=</span>&nbsp;<span class="builtintype" id="7524757">uint32</span><span class="op" id="7524763">(</span><span class="ident" id="7524764">s</span><span class="op" id="7524765">)</span>&nbsp;<span class="op" id="7524767">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7524773">t</span><span class="op" id="7524774">.</span><span class="ident" id="7524775">Fatalf</span><span class="op" id="7524781">(</span><span class="string" id="7524782">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7524813">,</span>&nbsp;<span class="ident" id="7524815">i</span><span class="op" id="7524816">,</span>&nbsp;<span class="ident" id="7524818">j</span><span class="op" id="7524819">,</span>&nbsp;<span class="ident" id="7524821">x</span><span class="op" id="7524822">,</span>&nbsp;<span class="ident" id="7524824">s</span><span class="op" id="7524825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7524837">}</span><br>
<span class="lineno"></span><span class="op" id="7524839">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="7524842">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="7524892">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="7524940">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="7524989">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="7525036">func</span>&nbsp;<span class="ident" id="7525041">TestSboxes</span><span class="op" id="7525051">(</span><span class="ident" id="7525052">t</span>&nbsp;<span class="op" id="7525054">*</span><span class="ident" id="7525055">testing</span><span class="op" id="7525062">.</span><span class="ident" id="7525063">T</span><span class="op" id="7525064">)</span>&nbsp;<span class="op" id="7525066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525069">for</span>&nbsp;<span class="ident" id="7525073">i</span>&nbsp;<span class="op" id="7525075">:=</span>&nbsp;<span class="num" id="7525078">0</span><span class="op" id="7525079">;</span>&nbsp;<span class="ident" id="7525081">i</span>&nbsp;<span class="op" id="7525083">&lt;</span>&nbsp;<span class="num" id="7525085">256</span><span class="op" id="7525088">;</span>&nbsp;<span class="ident" id="7525090">i</span><span class="op" id="7525091">++</span>&nbsp;<span class="op" id="7525094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525098">if</span>&nbsp;<span class="ident" id="7525101">j</span>&nbsp;<span class="op" id="7525103">:=</span>&nbsp;<span class="ident" id="7525106">sbox0</span><span class="op" id="7525111">[</span><span class="ident" id="7525112">sbox1</span><span class="op" id="7525117">[</span><span class="ident" id="7525118">i</span><span class="op" id="7525119">]</span><span class="op" id="7525120">]</span><span class="op" id="7525121">;</span>&nbsp;<span class="ident" id="7525123">j</span>&nbsp;<span class="op" id="7525125">!=</span>&nbsp;<span class="builtintype" id="7525128">byte</span><span class="op" id="7525132">(</span><span class="ident" id="7525133">i</span><span class="op" id="7525134">)</span>&nbsp;<span class="op" id="7525136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525141">t</span><span class="op" id="7525142">.</span><span class="ident" id="7525143">Errorf</span><span class="op" id="7525149">(</span><span class="string" id="7525150">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7525175">,</span>&nbsp;<span class="ident" id="7525177">i</span><span class="op" id="7525178">,</span>&nbsp;<span class="ident" id="7525180">j</span><span class="op" id="7525181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525185">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525189">if</span>&nbsp;<span class="ident" id="7525192">j</span>&nbsp;<span class="op" id="7525194">:=</span>&nbsp;<span class="ident" id="7525197">sbox1</span><span class="op" id="7525202">[</span><span class="ident" id="7525203">sbox0</span><span class="op" id="7525208">[</span><span class="ident" id="7525209">i</span><span class="op" id="7525210">]</span><span class="op" id="7525211">]</span><span class="op" id="7525212">;</span>&nbsp;<span class="ident" id="7525214">j</span>&nbsp;<span class="op" id="7525216">!=</span>&nbsp;<span class="builtintype" id="7525219">byte</span><span class="op" id="7525223">(</span><span class="ident" id="7525224">i</span><span class="op" id="7525225">)</span>&nbsp;<span class="op" id="7525227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525232">t</span><span class="op" id="7525233">.</span><span class="ident" id="7525234">Errorf</span><span class="op" id="7525240">(</span><span class="string" id="7525241">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7525266">,</span>&nbsp;<span class="ident" id="7525268">i</span><span class="op" id="7525269">,</span>&nbsp;<span class="ident" id="7525271">j</span><span class="op" id="7525272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525279">}</span><br>
<span class="lineno"></span><span class="op" id="7525281">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="7525284">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="7525328">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7525375">func</span>&nbsp;<span class="ident" id="7525380">TestTe</span><span class="op" id="7525386">(</span><span class="ident" id="7525387">t</span>&nbsp;<span class="op" id="7525389">*</span><span class="ident" id="7525390">testing</span><span class="op" id="7525397">.</span><span class="ident" id="7525398">T</span><span class="op" id="7525399">)</span>&nbsp;<span class="op" id="7525401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525404">for</span>&nbsp;<span class="ident" id="7525408">i</span>&nbsp;<span class="op" id="7525410">:=</span>&nbsp;<span class="num" id="7525413">0</span><span class="op" id="7525414">;</span>&nbsp;<span class="ident" id="7525416">i</span>&nbsp;<span class="op" id="7525418">&lt;</span>&nbsp;<span class="num" id="7525420">256</span><span class="op" id="7525423">;</span>&nbsp;<span class="ident" id="7525425">i</span><span class="op" id="7525426">++</span>&nbsp;<span class="op" id="7525429">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525433">s</span>&nbsp;<span class="op" id="7525435">:=</span>&nbsp;<span class="builtintype" id="7525438">uint32</span><span class="op" id="7525444">(</span><span class="ident" id="7525445">sbox0</span><span class="op" id="7525450">[</span><span class="ident" id="7525451">i</span><span class="op" id="7525452">]</span><span class="op" id="7525453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525457">s2</span>&nbsp;<span class="op" id="7525460">:=</span>&nbsp;<span class="ident" id="7525463">mul</span><span class="op" id="7525466">(</span><span class="ident" id="7525467">s</span><span class="op" id="7525468">,</span>&nbsp;<span class="num" id="7525470">2</span><span class="op" id="7525471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525475">s3</span>&nbsp;<span class="op" id="7525478">:=</span>&nbsp;<span class="ident" id="7525481">mul</span><span class="op" id="7525484">(</span><span class="ident" id="7525485">s</span><span class="op" id="7525486">,</span>&nbsp;<span class="num" id="7525488">3</span><span class="op" id="7525489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525493">w</span>&nbsp;<span class="op" id="7525495">:=</span>&nbsp;<span class="ident" id="7525498">s2</span><span class="op" id="7525500">&lt;&lt;</span><span class="num" id="7525502">24</span>&nbsp;<span class="op" id="7525505">|</span>&nbsp;<span class="ident" id="7525507">s</span><span class="op" id="7525508">&lt;&lt;</span><span class="num" id="7525510">16</span>&nbsp;<span class="op" id="7525513">|</span>&nbsp;<span class="ident" id="7525515">s</span><span class="op" id="7525516">&lt;&lt;</span><span class="num" id="7525518">8</span>&nbsp;<span class="op" id="7525520">|</span>&nbsp;<span class="ident" id="7525522">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525527">te</span>&nbsp;<span class="op" id="7525530">:=</span>&nbsp;<span class="op" id="7525533">[</span><span class="op" id="7525534">]</span><span class="op" id="7525535">[</span><span class="num" id="7525536">256</span><span class="op" id="7525539">]</span><span class="builtintype" id="7525540">uint32</span><span class="op" id="7525546">{</span><span class="ident" id="7525547">te0</span><span class="op" id="7525550">,</span>&nbsp;<span class="ident" id="7525552">te1</span><span class="op" id="7525555">,</span>&nbsp;<span class="ident" id="7525557">te2</span><span class="op" id="7525560">,</span>&nbsp;<span class="ident" id="7525562">te3</span><span class="op" id="7525565">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525569">for</span>&nbsp;<span class="ident" id="7525573">j</span>&nbsp;<span class="op" id="7525575">:=</span>&nbsp;<span class="num" id="7525578">0</span><span class="op" id="7525579">;</span>&nbsp;<span class="ident" id="7525581">j</span>&nbsp;<span class="op" id="7525583">&lt;</span>&nbsp;<span class="num" id="7525585">4</span><span class="op" id="7525586">;</span>&nbsp;<span class="ident" id="7525588">j</span><span class="op" id="7525589">++</span>&nbsp;<span class="op" id="7525592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525597">if</span>&nbsp;<span class="ident" id="7525600">x</span>&nbsp;<span class="op" id="7525602">:=</span>&nbsp;<span class="ident" id="7525605">te</span><span class="op" id="7525607">[</span><span class="ident" id="7525608">j</span><span class="op" id="7525609">]</span><span class="op" id="7525610">[</span><span class="ident" id="7525611">i</span><span class="op" id="7525612">]</span><span class="op" id="7525613">;</span>&nbsp;<span class="ident" id="7525615">x</span>&nbsp;<span class="op" id="7525617">!=</span>&nbsp;<span class="ident" id="7525620">w</span>&nbsp;<span class="op" id="7525622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525628">t</span><span class="op" id="7525629">.</span><span class="ident" id="7525630">Fatalf</span><span class="op" id="7525636">(</span><span class="string" id="7525637">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7525665">,</span>&nbsp;<span class="ident" id="7525667">j</span><span class="op" id="7525668">,</span>&nbsp;<span class="ident" id="7525670">i</span><span class="op" id="7525671">,</span>&nbsp;<span class="ident" id="7525673">x</span><span class="op" id="7525674">,</span>&nbsp;<span class="ident" id="7525676">w</span><span class="op" id="7525677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525687">w</span>&nbsp;<span class="op" id="7525689">=</span>&nbsp;<span class="ident" id="7525691">w</span><span class="op" id="7525692">&lt;&lt;</span><span class="num" id="7525694">24</span>&nbsp;<span class="op" id="7525697">|</span>&nbsp;<span class="ident" id="7525699">w</span><span class="op" id="7525700">&gt;&gt;</span><span class="num" id="7525702">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7525709">}</span><br>
<span class="lineno"></span><span class="op" id="7525711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7525714">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="7525758">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7525805">func</span>&nbsp;<span class="ident" id="7525810">TestTd</span><span class="op" id="7525816">(</span><span class="ident" id="7525817">t</span>&nbsp;<span class="op" id="7525819">*</span><span class="ident" id="7525820">testing</span><span class="op" id="7525827">.</span><span class="ident" id="7525828">T</span><span class="op" id="7525829">)</span>&nbsp;<span class="op" id="7525831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7525834">for</span>&nbsp;<span class="ident" id="7525838">i</span>&nbsp;<span class="op" id="7525840">:=</span>&nbsp;<span class="num" id="7525843">0</span><span class="op" id="7525844">;</span>&nbsp;<span class="ident" id="7525846">i</span>&nbsp;<span class="op" id="7525848">&lt;</span>&nbsp;<span class="num" id="7525850">256</span><span class="op" id="7525853">;</span>&nbsp;<span class="ident" id="7525855">i</span><span class="op" id="7525856">++</span>&nbsp;<span class="op" id="7525859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525863">s</span>&nbsp;<span class="op" id="7525865">:=</span>&nbsp;<span class="builtintype" id="7525868">uint32</span><span class="op" id="7525874">(</span><span class="ident" id="7525875">sbox1</span><span class="op" id="7525880">[</span><span class="ident" id="7525881">i</span><span class="op" id="7525882">]</span><span class="op" id="7525883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525887">s9</span>&nbsp;<span class="op" id="7525890">:=</span>&nbsp;<span class="ident" id="7525893">mul</span><span class="op" id="7525896">(</span><span class="ident" id="7525897">s</span><span class="op" id="7525898">,</span>&nbsp;<span class="num" id="7525900">0x9</span><span class="op" id="7525903">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525907">sb</span>&nbsp;<span class="op" id="7525910">:=</span>&nbsp;<span class="ident" id="7525913">mul</span><span class="op" id="7525916">(</span><span class="ident" id="7525917">s</span><span class="op" id="7525918">,</span>&nbsp;<span class="num" id="7525920">0xb</span><span class="op" id="7525923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525927">sd</span>&nbsp;<span class="op" id="7525930">:=</span>&nbsp;<span class="ident" id="7525933">mul</span><span class="op" id="7525936">(</span><span class="ident" id="7525937">s</span><span class="op" id="7525938">,</span>&nbsp;<span class="num" id="7525940">0xd</span><span class="op" id="7525943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525947">se</span>&nbsp;<span class="op" id="7525950">:=</span>&nbsp;<span class="ident" id="7525953">mul</span><span class="op" id="7525956">(</span><span class="ident" id="7525957">s</span><span class="op" id="7525958">,</span>&nbsp;<span class="num" id="7525960">0xe</span><span class="op" id="7525963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7525967">w</span>&nbsp;<span class="op" id="7525969">:=</span>&nbsp;<span class="ident" id="7525972">se</span><span class="op" id="7525974">&lt;&lt;</span><span class="num" id="7525976">24</span>&nbsp;<span class="op" id="7525979">|</span>&nbsp;<span class="ident" id="7525981">s9</span><span class="op" id="7525983">&lt;&lt;</span><span class="num" id="7525985">16</span>&nbsp;<span class="op" id="7525988">|</span>&nbsp;<span class="ident" id="7525990">sd</span><span class="op" id="7525992">&lt;&lt;</span><span class="num" id="7525994">8</span>&nbsp;<span class="op" id="7525996">|</span>&nbsp;<span class="ident" id="7525998">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526003">td</span>&nbsp;<span class="op" id="7526006">:=</span>&nbsp;<span class="op" id="7526009">[</span><span class="op" id="7526010">]</span><span class="op" id="7526011">[</span><span class="num" id="7526012">256</span><span class="op" id="7526015">]</span><span class="builtintype" id="7526016">uint32</span><span class="op" id="7526022">{</span><span class="ident" id="7526023">td0</span><span class="op" id="7526026">,</span>&nbsp;<span class="ident" id="7526028">td1</span><span class="op" id="7526031">,</span>&nbsp;<span class="ident" id="7526033">td2</span><span class="op" id="7526036">,</span>&nbsp;<span class="ident" id="7526038">td3</span><span class="op" id="7526041">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7526045">for</span>&nbsp;<span class="ident" id="7526049">j</span>&nbsp;<span class="op" id="7526051">:=</span>&nbsp;<span class="num" id="7526054">0</span><span class="op" id="7526055">;</span>&nbsp;<span class="ident" id="7526057">j</span>&nbsp;<span class="op" id="7526059">&lt;</span>&nbsp;<span class="num" id="7526061">4</span><span class="op" id="7526062">;</span>&nbsp;<span class="ident" id="7526064">j</span><span class="op" id="7526065">++</span>&nbsp;<span class="op" id="7526068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7526073">if</span>&nbsp;<span class="ident" id="7526076">x</span>&nbsp;<span class="op" id="7526078">:=</span>&nbsp;<span class="ident" id="7526081">td</span><span class="op" id="7526083">[</span><span class="ident" id="7526084">j</span><span class="op" id="7526085">]</span><span class="op" id="7526086">[</span><span class="ident" id="7526087">i</span><span class="op" id="7526088">]</span><span class="op" id="7526089">;</span>&nbsp;<span class="ident" id="7526091">x</span>&nbsp;<span class="op" id="7526093">!=</span>&nbsp;<span class="ident" id="7526096">w</span>&nbsp;<span class="op" id="7526098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526104">t</span><span class="op" id="7526105">.</span><span class="ident" id="7526106">Fatalf</span><span class="op" id="7526112">(</span><span class="string" id="7526113">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7526141">,</span>&nbsp;<span class="ident" id="7526143">j</span><span class="op" id="7526144">,</span>&nbsp;<span class="ident" id="7526146">i</span><span class="op" id="7526147">,</span>&nbsp;<span class="ident" id="7526149">x</span><span class="op" id="7526150">,</span>&nbsp;<span class="ident" id="7526152">w</span><span class="op" id="7526153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526163">w</span>&nbsp;<span class="op" id="7526165">=</span>&nbsp;<span class="ident" id="7526167">w</span><span class="op" id="7526168">&lt;&lt;</span><span class="num" id="7526170">24</span>&nbsp;<span class="op" id="7526173">|</span>&nbsp;<span class="ident" id="7526175">w</span><span class="op" id="7526176">&gt;&gt;</span><span class="num" id="7526178">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526185">}</span><br>
<span class="lineno"></span><span class="op" id="7526187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7526190">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="7526225">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7526293">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="7526343">type</span>&nbsp;<span class="ident" id="7526348">KeyTest</span>&nbsp;<span class="keyword" id="7526356">struct</span>&nbsp;<span class="op" id="7526363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526366">key</span>&nbsp;<span class="op" id="7526370">[</span><span class="op" id="7526371">]</span><span class="builtintype" id="7526372">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526378">enc</span>&nbsp;<span class="op" id="7526382">[</span><span class="op" id="7526383">]</span><span class="builtintype" id="7526384">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7526392">dec</span>&nbsp;<span class="op" id="7526396">[</span><span class="op" id="7526397">]</span><span class="builtintype" id="7526398">uint32</span>&nbsp;<span class="comment" id="7526405">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="7526479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7526482">var</span>&nbsp;<span class="ident" id="7526486">keyTests</span>&nbsp;<span class="op" id="7526495">=</span>&nbsp;<span class="op" id="7526497">[</span><span class="op" id="7526498">]</span><span class="ident" id="7526499">KeyTest</span><span class="op" id="7526506">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7526513">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526558">[</span><span class="op" id="7526559">]</span><span class="builtintype" id="7526560">byte</span><span class="op" id="7526564">{</span><span class="num" id="7526565">0x2b</span><span class="op" id="7526569">,</span>&nbsp;<span class="num" id="7526571">0x7e</span><span class="op" id="7526575">,</span>&nbsp;<span class="num" id="7526577">0x15</span><span class="op" id="7526581">,</span>&nbsp;<span class="num" id="7526583">0x16</span><span class="op" id="7526587">,</span>&nbsp;<span class="num" id="7526589">0x28</span><span class="op" id="7526593">,</span>&nbsp;<span class="num" id="7526595">0xae</span><span class="op" id="7526599">,</span>&nbsp;<span class="num" id="7526601">0xd2</span><span class="op" id="7526605">,</span>&nbsp;<span class="num" id="7526607">0xa6</span><span class="op" id="7526611">,</span>&nbsp;<span class="num" id="7526613">0xab</span><span class="op" id="7526617">,</span>&nbsp;<span class="num" id="7526619">0xf7</span><span class="op" id="7526623">,</span>&nbsp;<span class="num" id="7526625">0x15</span><span class="op" id="7526629">,</span>&nbsp;<span class="num" id="7526631">0x88</span><span class="op" id="7526635">,</span>&nbsp;<span class="num" id="7526637">0x09</span><span class="op" id="7526641">,</span>&nbsp;<span class="num" id="7526643">0xcf</span><span class="op" id="7526647">,</span>&nbsp;<span class="num" id="7526649">0x4f</span><span class="op" id="7526653">,</span>&nbsp;<span class="num" id="7526655">0x3c</span><span class="op" id="7526659">}</span><span class="op" id="7526660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7526664">[</span><span class="op" id="7526665">]</span><span class="builtintype" id="7526666">uint32</span><span class="op" id="7526672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526677">0x2b7e1516</span><span class="op" id="7526687">,</span>&nbsp;<span class="num" id="7526689">0x28aed2a6</span><span class="op" id="7526699">,</span>&nbsp;<span class="num" id="7526701">0xabf71588</span><span class="op" id="7526711">,</span>&nbsp;<span class="num" id="7526713">0x09cf4f3c</span><span class="op" id="7526723">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526728">0xa0fafe17</span><span class="op" id="7526738">,</span>&nbsp;<span class="num" id="7526740">0x88542cb1</span><span class="op" id="7526750">,</span>&nbsp;<span class="num" id="7526752">0x23a33939</span><span class="op" id="7526762">,</span>&nbsp;<span class="num" id="7526764">0x2a6c7605</span><span class="op" id="7526774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526779">0xf2c295f2</span><span class="op" id="7526789">,</span>&nbsp;<span class="num" id="7526791">0x7a96b943</span><span class="op" id="7526801">,</span>&nbsp;<span class="num" id="7526803">0x5935807a</span><span class="op" id="7526813">,</span>&nbsp;<span class="num" id="7526815">0x7359f67f</span><span class="op" id="7526825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526830">0x3d80477d</span><span class="op" id="7526840">,</span>&nbsp;<span class="num" id="7526842">0x4716fe3e</span><span class="op" id="7526852">,</span>&nbsp;<span class="num" id="7526854">0x1e237e44</span><span class="op" id="7526864">,</span>&nbsp;<span class="num" id="7526866">0x6d7a883b</span><span class="op" id="7526876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526881">0xef44a541</span><span class="op" id="7526891">,</span>&nbsp;<span class="num" id="7526893">0xa8525b7f</span><span class="op" id="7526903">,</span>&nbsp;<span class="num" id="7526905">0xb671253b</span><span class="op" id="7526915">,</span>&nbsp;<span class="num" id="7526917">0xdb0bad00</span><span class="op" id="7526927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526932">0xd4d1c6f8</span><span class="op" id="7526942">,</span>&nbsp;<span class="num" id="7526944">0x7c839d87</span><span class="op" id="7526954">,</span>&nbsp;<span class="num" id="7526956">0xcaf2b8bc</span><span class="op" id="7526966">,</span>&nbsp;<span class="num" id="7526968">0x11f915bc</span><span class="op" id="7526978">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7526983">0x6d88a37a</span><span class="op" id="7526993">,</span>&nbsp;<span class="num" id="7526995">0x110b3efd</span><span class="op" id="7527005">,</span>&nbsp;<span class="num" id="7527007">0xdbf98641</span><span class="op" id="7527017">,</span>&nbsp;<span class="num" id="7527019">0xca0093fd</span><span class="op" id="7527029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527034">0x4e54f70e</span><span class="op" id="7527044">,</span>&nbsp;<span class="num" id="7527046">0x5f5fc9f3</span><span class="op" id="7527056">,</span>&nbsp;<span class="num" id="7527058">0x84a64fb2</span><span class="op" id="7527068">,</span>&nbsp;<span class="num" id="7527070">0x4ea6dc4f</span><span class="op" id="7527080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527085">0xead27321</span><span class="op" id="7527095">,</span>&nbsp;<span class="num" id="7527097">0xb58dbad2</span><span class="op" id="7527107">,</span>&nbsp;<span class="num" id="7527109">0x312bf560</span><span class="op" id="7527119">,</span>&nbsp;<span class="num" id="7527121">0x7f8d292f</span><span class="op" id="7527131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527136">0xac7766f3</span><span class="op" id="7527146">,</span>&nbsp;<span class="num" id="7527148">0x19fadc21</span><span class="op" id="7527158">,</span>&nbsp;<span class="num" id="7527160">0x28d12941</span><span class="op" id="7527170">,</span>&nbsp;<span class="num" id="7527172">0x575c006e</span><span class="op" id="7527182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527187">0xd014f9a8</span><span class="op" id="7527197">,</span>&nbsp;<span class="num" id="7527199">0xc9ee2589</span><span class="op" id="7527209">,</span>&nbsp;<span class="num" id="7527211">0xe13f0cc8</span><span class="op" id="7527221">,</span>&nbsp;<span class="num" id="7527223">0xb6630ca6</span><span class="op" id="7527233">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527237">}</span><span class="op" id="7527238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527242">[</span><span class="op" id="7527243">]</span><span class="builtintype" id="7527244">uint32</span><span class="op" id="7527250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527255">0xd014f9a8</span><span class="op" id="7527265">,</span>&nbsp;<span class="num" id="7527267">0xc9ee2589</span><span class="op" id="7527277">,</span>&nbsp;<span class="num" id="7527279">0xe13f0cc8</span><span class="op" id="7527289">,</span>&nbsp;<span class="num" id="7527291">0xb6630ca6</span><span class="op" id="7527301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527306">0xc7b5a63</span><span class="op" id="7527315">,</span>&nbsp;<span class="num" id="7527317">0x1319eafe</span><span class="op" id="7527327">,</span>&nbsp;<span class="num" id="7527329">0xb0398890</span><span class="op" id="7527339">,</span>&nbsp;<span class="num" id="7527341">0x664cfbb4</span><span class="op" id="7527351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527356">0xdf7d925a</span><span class="op" id="7527366">,</span>&nbsp;<span class="num" id="7527368">0x1f62b09d</span><span class="op" id="7527378">,</span>&nbsp;<span class="num" id="7527380">0xa320626e</span><span class="op" id="7527390">,</span>&nbsp;<span class="num" id="7527392">0xd6757324</span><span class="op" id="7527402">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527407">0x12c07647</span><span class="op" id="7527417">,</span>&nbsp;<span class="num" id="7527419">0xc01f22c7</span><span class="op" id="7527429">,</span>&nbsp;<span class="num" id="7527431">0xbc42d2f3</span><span class="op" id="7527441">,</span>&nbsp;<span class="num" id="7527443">0x7555114a</span><span class="op" id="7527453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527458">0x6efcd876</span><span class="op" id="7527468">,</span>&nbsp;<span class="num" id="7527470">0xd2df5480</span><span class="op" id="7527480">,</span>&nbsp;<span class="num" id="7527482">0x7c5df034</span><span class="op" id="7527492">,</span>&nbsp;<span class="num" id="7527494">0xc917c3b9</span><span class="op" id="7527504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527509">0x6ea30afc</span><span class="op" id="7527519">,</span>&nbsp;<span class="num" id="7527521">0xbc238cf6</span><span class="op" id="7527531">,</span>&nbsp;<span class="num" id="7527533">0xae82a4b4</span><span class="op" id="7527543">,</span>&nbsp;<span class="num" id="7527545">0xb54a338d</span><span class="op" id="7527555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527560">0x90884413</span><span class="op" id="7527570">,</span>&nbsp;<span class="num" id="7527572">0xd280860a</span><span class="op" id="7527582">,</span>&nbsp;<span class="num" id="7527584">0x12a12842</span><span class="op" id="7527594">,</span>&nbsp;<span class="num" id="7527596">0x1bc89739</span><span class="op" id="7527606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527611">0x7c1f13f7</span><span class="op" id="7527621">,</span>&nbsp;<span class="num" id="7527623">0x4208c219</span><span class="op" id="7527633">,</span>&nbsp;<span class="num" id="7527635">0xc021ae48</span><span class="op" id="7527645">,</span>&nbsp;<span class="num" id="7527647">0x969bf7b</span><span class="op" id="7527656">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527661">0xcc7505eb</span><span class="op" id="7527671">,</span>&nbsp;<span class="num" id="7527673">0x3e17d1ee</span><span class="op" id="7527683">,</span>&nbsp;<span class="num" id="7527685">0x82296c51</span><span class="op" id="7527695">,</span>&nbsp;<span class="num" id="7527697">0xc9481133</span><span class="op" id="7527707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527712">0x2b3708a7</span><span class="op" id="7527722">,</span>&nbsp;<span class="num" id="7527724">0xf262d405</span><span class="op" id="7527734">,</span>&nbsp;<span class="num" id="7527736">0xbc3ebdbf</span><span class="op" id="7527746">,</span>&nbsp;<span class="num" id="7527748">0x4b617d62</span><span class="op" id="7527758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527763">0x2b7e1516</span><span class="op" id="7527773">,</span>&nbsp;<span class="num" id="7527775">0x28aed2a6</span><span class="op" id="7527785">,</span>&nbsp;<span class="num" id="7527787">0xabf71588</span><span class="op" id="7527797">,</span>&nbsp;<span class="num" id="7527799">0x9cf4f3c</span><span class="op" id="7527808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527812">}</span><span class="op" id="7527813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527816">}</span><span class="op" id="7527817">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7527824">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7527869">[</span><span class="op" id="7527870">]</span><span class="builtintype" id="7527871">byte</span><span class="op" id="7527875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527880">0x8e</span><span class="op" id="7527884">,</span>&nbsp;<span class="num" id="7527886">0x73</span><span class="op" id="7527890">,</span>&nbsp;<span class="num" id="7527892">0xb0</span><span class="op" id="7527896">,</span>&nbsp;<span class="num" id="7527898">0xf7</span><span class="op" id="7527902">,</span>&nbsp;<span class="num" id="7527904">0xda</span><span class="op" id="7527908">,</span>&nbsp;<span class="num" id="7527910">0x0e</span><span class="op" id="7527914">,</span>&nbsp;<span class="num" id="7527916">0x64</span><span class="op" id="7527920">,</span>&nbsp;<span class="num" id="7527922">0x52</span><span class="op" id="7527926">,</span>&nbsp;<span class="num" id="7527928">0xc8</span><span class="op" id="7527932">,</span>&nbsp;<span class="num" id="7527934">0x10</span><span class="op" id="7527938">,</span>&nbsp;<span class="num" id="7527940">0xf3</span><span class="op" id="7527944">,</span>&nbsp;<span class="num" id="7527946">0x2b</span><span class="op" id="7527950">,</span>&nbsp;<span class="num" id="7527952">0x80</span><span class="op" id="7527956">,</span>&nbsp;<span class="num" id="7527958">0x90</span><span class="op" id="7527962">,</span>&nbsp;<span class="num" id="7527964">0x79</span><span class="op" id="7527968">,</span>&nbsp;<span class="num" id="7527970">0xe5</span><span class="op" id="7527974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7527979">0x62</span><span class="op" id="7527983">,</span>&nbsp;<span class="num" id="7527985">0xf8</span><span class="op" id="7527989">,</span>&nbsp;<span class="num" id="7527991">0xea</span><span class="op" id="7527995">,</span>&nbsp;<span class="num" id="7527997">0xd2</span><span class="op" id="7528001">,</span>&nbsp;<span class="num" id="7528003">0x52</span><span class="op" id="7528007">,</span>&nbsp;<span class="num" id="7528009">0x2c</span><span class="op" id="7528013">,</span>&nbsp;<span class="num" id="7528015">0x6b</span><span class="op" id="7528019">,</span>&nbsp;<span class="num" id="7528021">0x7b</span><span class="op" id="7528025">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528029">}</span><span class="op" id="7528030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528034">[</span><span class="op" id="7528035">]</span><span class="builtintype" id="7528036">uint32</span><span class="op" id="7528042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528047">0x8e73b0f7</span><span class="op" id="7528057">,</span>&nbsp;<span class="num" id="7528059">0xda0e6452</span><span class="op" id="7528069">,</span>&nbsp;<span class="num" id="7528071">0xc810f32b</span><span class="op" id="7528081">,</span>&nbsp;<span class="num" id="7528083">0x809079e5</span><span class="op" id="7528093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528098">0x62f8ead2</span><span class="op" id="7528108">,</span>&nbsp;<span class="num" id="7528110">0x522c6b7b</span><span class="op" id="7528120">,</span>&nbsp;<span class="num" id="7528122">0xfe0c91f7</span><span class="op" id="7528132">,</span>&nbsp;<span class="num" id="7528134">0x2402f5a5</span><span class="op" id="7528144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528149">0xec12068e</span><span class="op" id="7528159">,</span>&nbsp;<span class="num" id="7528161">0x6c827f6b</span><span class="op" id="7528171">,</span>&nbsp;<span class="num" id="7528173">0x0e7a95b9</span><span class="op" id="7528183">,</span>&nbsp;<span class="num" id="7528185">0x5c56fec2</span><span class="op" id="7528195">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528200">0x4db7b4bd</span><span class="op" id="7528210">,</span>&nbsp;<span class="num" id="7528212">0x69b54118</span><span class="op" id="7528222">,</span>&nbsp;<span class="num" id="7528224">0x85a74796</span><span class="op" id="7528234">,</span>&nbsp;<span class="num" id="7528236">0xe92538fd</span><span class="op" id="7528246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528251">0xe75fad44</span><span class="op" id="7528261">,</span>&nbsp;<span class="num" id="7528263">0xbb095386</span><span class="op" id="7528273">,</span>&nbsp;<span class="num" id="7528275">0x485af057</span><span class="op" id="7528285">,</span>&nbsp;<span class="num" id="7528287">0x21efb14f</span><span class="op" id="7528297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528302">0xa448f6d9</span><span class="op" id="7528312">,</span>&nbsp;<span class="num" id="7528314">0x4d6dce24</span><span class="op" id="7528324">,</span>&nbsp;<span class="num" id="7528326">0xaa326360</span><span class="op" id="7528336">,</span>&nbsp;<span class="num" id="7528338">0x113b30e6</span><span class="op" id="7528348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528353">0xa25e7ed5</span><span class="op" id="7528363">,</span>&nbsp;<span class="num" id="7528365">0x83b1cf9a</span><span class="op" id="7528375">,</span>&nbsp;<span class="num" id="7528377">0x27f93943</span><span class="op" id="7528387">,</span>&nbsp;<span class="num" id="7528389">0x6a94f767</span><span class="op" id="7528399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528404">0xc0a69407</span><span class="op" id="7528414">,</span>&nbsp;<span class="num" id="7528416">0xd19da4e1</span><span class="op" id="7528426">,</span>&nbsp;<span class="num" id="7528428">0xec1786eb</span><span class="op" id="7528438">,</span>&nbsp;<span class="num" id="7528440">0x6fa64971</span><span class="op" id="7528450">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528455">0x485f7032</span><span class="op" id="7528465">,</span>&nbsp;<span class="num" id="7528467">0x22cb8755</span><span class="op" id="7528477">,</span>&nbsp;<span class="num" id="7528479">0xe26d1352</span><span class="op" id="7528489">,</span>&nbsp;<span class="num" id="7528491">0x33f0b7b3</span><span class="op" id="7528501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528506">0x40beeb28</span><span class="op" id="7528516">,</span>&nbsp;<span class="num" id="7528518">0x2f18a259</span><span class="op" id="7528528">,</span>&nbsp;<span class="num" id="7528530">0x6747d26b</span><span class="op" id="7528540">,</span>&nbsp;<span class="num" id="7528542">0x458c553e</span><span class="op" id="7528552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528557">0xa7e1466c</span><span class="op" id="7528567">,</span>&nbsp;<span class="num" id="7528569">0x9411f1df</span><span class="op" id="7528579">,</span>&nbsp;<span class="num" id="7528581">0x821f750a</span><span class="op" id="7528591">,</span>&nbsp;<span class="num" id="7528593">0xad07d753</span><span class="op" id="7528603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528608">0xca400538</span><span class="op" id="7528618">,</span>&nbsp;<span class="num" id="7528620">0x8fcc5006</span><span class="op" id="7528630">,</span>&nbsp;<span class="num" id="7528632">0x282d166a</span><span class="op" id="7528642">,</span>&nbsp;<span class="num" id="7528644">0xbc3ce7b5</span><span class="op" id="7528654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528659">0xe98ba06f</span><span class="op" id="7528669">,</span>&nbsp;<span class="num" id="7528671">0x448c773c</span><span class="op" id="7528681">,</span>&nbsp;<span class="num" id="7528683">0x8ecc7204</span><span class="op" id="7528693">,</span>&nbsp;<span class="num" id="7528695">0x01002202</span><span class="op" id="7528705">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528709">}</span><span class="op" id="7528710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7528714">nil</span><span class="op" id="7528717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528720">}</span><span class="op" id="7528721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7528728">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528773">[</span><span class="op" id="7528774">]</span><span class="builtintype" id="7528775">byte</span><span class="op" id="7528779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528784">0x60</span><span class="op" id="7528788">,</span>&nbsp;<span class="num" id="7528790">0x3d</span><span class="op" id="7528794">,</span>&nbsp;<span class="num" id="7528796">0xeb</span><span class="op" id="7528800">,</span>&nbsp;<span class="num" id="7528802">0x10</span><span class="op" id="7528806">,</span>&nbsp;<span class="num" id="7528808">0x15</span><span class="op" id="7528812">,</span>&nbsp;<span class="num" id="7528814">0xca</span><span class="op" id="7528818">,</span>&nbsp;<span class="num" id="7528820">0x71</span><span class="op" id="7528824">,</span>&nbsp;<span class="num" id="7528826">0xbe</span><span class="op" id="7528830">,</span>&nbsp;<span class="num" id="7528832">0x2b</span><span class="op" id="7528836">,</span>&nbsp;<span class="num" id="7528838">0x73</span><span class="op" id="7528842">,</span>&nbsp;<span class="num" id="7528844">0xae</span><span class="op" id="7528848">,</span>&nbsp;<span class="num" id="7528850">0xf0</span><span class="op" id="7528854">,</span>&nbsp;<span class="num" id="7528856">0x85</span><span class="op" id="7528860">,</span>&nbsp;<span class="num" id="7528862">0x7d</span><span class="op" id="7528866">,</span>&nbsp;<span class="num" id="7528868">0x77</span><span class="op" id="7528872">,</span>&nbsp;<span class="num" id="7528874">0x81</span><span class="op" id="7528878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528883">0x1f</span><span class="op" id="7528887">,</span>&nbsp;<span class="num" id="7528889">0x35</span><span class="op" id="7528893">,</span>&nbsp;<span class="num" id="7528895">0x2c</span><span class="op" id="7528899">,</span>&nbsp;<span class="num" id="7528901">0x07</span><span class="op" id="7528905">,</span>&nbsp;<span class="num" id="7528907">0x3b</span><span class="op" id="7528911">,</span>&nbsp;<span class="num" id="7528913">0x61</span><span class="op" id="7528917">,</span>&nbsp;<span class="num" id="7528919">0x08</span><span class="op" id="7528923">,</span>&nbsp;<span class="num" id="7528925">0xd7</span><span class="op" id="7528929">,</span>&nbsp;<span class="num" id="7528931">0x2d</span><span class="op" id="7528935">,</span>&nbsp;<span class="num" id="7528937">0x98</span><span class="op" id="7528941">,</span>&nbsp;<span class="num" id="7528943">0x10</span><span class="op" id="7528947">,</span>&nbsp;<span class="num" id="7528949">0xa3</span><span class="op" id="7528953">,</span>&nbsp;<span class="num" id="7528955">0x09</span><span class="op" id="7528959">,</span>&nbsp;<span class="num" id="7528961">0x14</span><span class="op" id="7528965">,</span>&nbsp;<span class="num" id="7528967">0xdf</span><span class="op" id="7528971">,</span>&nbsp;<span class="num" id="7528973">0xf4</span><span class="op" id="7528977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528981">}</span><span class="op" id="7528982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7528986">[</span><span class="op" id="7528987">]</span><span class="builtintype" id="7528988">uint32</span><span class="op" id="7528994">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7528999">0x603deb10</span><span class="op" id="7529009">,</span>&nbsp;<span class="num" id="7529011">0x15ca71be</span><span class="op" id="7529021">,</span>&nbsp;<span class="num" id="7529023">0x2b73aef0</span><span class="op" id="7529033">,</span>&nbsp;<span class="num" id="7529035">0x857d7781</span><span class="op" id="7529045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529050">0x1f352c07</span><span class="op" id="7529060">,</span>&nbsp;<span class="num" id="7529062">0x3b6108d7</span><span class="op" id="7529072">,</span>&nbsp;<span class="num" id="7529074">0x2d9810a3</span><span class="op" id="7529084">,</span>&nbsp;<span class="num" id="7529086">0x0914dff4</span><span class="op" id="7529096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529101">0x9ba35411</span><span class="op" id="7529111">,</span>&nbsp;<span class="num" id="7529113">0x8e6925af</span><span class="op" id="7529123">,</span>&nbsp;<span class="num" id="7529125">0xa51a8b5f</span><span class="op" id="7529135">,</span>&nbsp;<span class="num" id="7529137">0x2067fcde</span><span class="op" id="7529147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529152">0xa8b09c1a</span><span class="op" id="7529162">,</span>&nbsp;<span class="num" id="7529164">0x93d194cd</span><span class="op" id="7529174">,</span>&nbsp;<span class="num" id="7529176">0xbe49846e</span><span class="op" id="7529186">,</span>&nbsp;<span class="num" id="7529188">0xb75d5b9a</span><span class="op" id="7529198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529203">0xd59aecb8</span><span class="op" id="7529213">,</span>&nbsp;<span class="num" id="7529215">0x5bf3c917</span><span class="op" id="7529225">,</span>&nbsp;<span class="num" id="7529227">0xfee94248</span><span class="op" id="7529237">,</span>&nbsp;<span class="num" id="7529239">0xde8ebe96</span><span class="op" id="7529249">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529254">0xb5a9328a</span><span class="op" id="7529264">,</span>&nbsp;<span class="num" id="7529266">0x2678a647</span><span class="op" id="7529276">,</span>&nbsp;<span class="num" id="7529278">0x98312229</span><span class="op" id="7529288">,</span>&nbsp;<span class="num" id="7529290">0x2f6c79b3</span><span class="op" id="7529300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529305">0x812c81ad</span><span class="op" id="7529315">,</span>&nbsp;<span class="num" id="7529317">0xdadf48ba</span><span class="op" id="7529327">,</span>&nbsp;<span class="num" id="7529329">0x24360af2</span><span class="op" id="7529339">,</span>&nbsp;<span class="num" id="7529341">0xfab8b464</span><span class="op" id="7529351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529356">0x98c5bfc9</span><span class="op" id="7529366">,</span>&nbsp;<span class="num" id="7529368">0xbebd198e</span><span class="op" id="7529378">,</span>&nbsp;<span class="num" id="7529380">0x268c3ba7</span><span class="op" id="7529390">,</span>&nbsp;<span class="num" id="7529392">0x09e04214</span><span class="op" id="7529402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529407">0x68007bac</span><span class="op" id="7529417">,</span>&nbsp;<span class="num" id="7529419">0xb2df3316</span><span class="op" id="7529429">,</span>&nbsp;<span class="num" id="7529431">0x96e939e4</span><span class="op" id="7529441">,</span>&nbsp;<span class="num" id="7529443">0x6c518d80</span><span class="op" id="7529453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529458">0xc814e204</span><span class="op" id="7529468">,</span>&nbsp;<span class="num" id="7529470">0x76a9fb8a</span><span class="op" id="7529480">,</span>&nbsp;<span class="num" id="7529482">0x5025c02d</span><span class="op" id="7529492">,</span>&nbsp;<span class="num" id="7529494">0x59c58239</span><span class="op" id="7529504">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529509">0xde136967</span><span class="op" id="7529519">,</span>&nbsp;<span class="num" id="7529521">0x6ccc5a71</span><span class="op" id="7529531">,</span>&nbsp;<span class="num" id="7529533">0xfa256395</span><span class="op" id="7529543">,</span>&nbsp;<span class="num" id="7529545">0x9674ee15</span><span class="op" id="7529555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529560">0x5886ca5d</span><span class="op" id="7529570">,</span>&nbsp;<span class="num" id="7529572">0x2e2f31d7</span><span class="op" id="7529582">,</span>&nbsp;<span class="num" id="7529584">0x7e0af1fa</span><span class="op" id="7529594">,</span>&nbsp;<span class="num" id="7529596">0x27cf73c3</span><span class="op" id="7529606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529611">0x749c47ab</span><span class="op" id="7529621">,</span>&nbsp;<span class="num" id="7529623">0x18501dda</span><span class="op" id="7529633">,</span>&nbsp;<span class="num" id="7529635">0xe2757e4f</span><span class="op" id="7529645">,</span>&nbsp;<span class="num" id="7529647">0x7401905a</span><span class="op" id="7529657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529662">0xcafaaae3</span><span class="op" id="7529672">,</span>&nbsp;<span class="num" id="7529674">0xe4d59b34</span><span class="op" id="7529684">,</span>&nbsp;<span class="num" id="7529686">0x9adf6ace</span><span class="op" id="7529696">,</span>&nbsp;<span class="num" id="7529698">0xbd10190d</span><span class="op" id="7529708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7529713">0xfe4890d1</span><span class="op" id="7529723">,</span>&nbsp;<span class="num" id="7529725">0xe6188d0b</span><span class="op" id="7529735">,</span>&nbsp;<span class="num" id="7529737">0x046df344</span><span class="op" id="7529747">,</span>&nbsp;<span class="num" id="7529749">0x706c631e</span><span class="op" id="7529759">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529763">}</span><span class="op" id="7529764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529768">nil</span><span class="op" id="7529771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529774">}</span><span class="op" id="7529775">,</span><br>
<span class="lineno"></span><span class="op" id="7529777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="7529780">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7529829">func</span>&nbsp;<span class="ident" id="7529834">TestExpandKey</span><span class="op" id="7529847">(</span><span class="ident" id="7529848">t</span>&nbsp;<span class="op" id="7529850">*</span><span class="ident" id="7529851">testing</span><span class="op" id="7529858">.</span><span class="ident" id="7529859">T</span><span class="op" id="7529860">)</span>&nbsp;<span class="op" id="7529862">{</span><br>
<span class="lineno"></span><span class="ident" id="7529864">L</span><span class="op" id="7529865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529868">for</span>&nbsp;<span class="ident" id="7529872">i</span><span class="op" id="7529873">,</span>&nbsp;<span class="ident" id="7529875">tt</span>&nbsp;<span class="op" id="7529878">:=</span>&nbsp;<span class="keyword" id="7529881">range</span>&nbsp;<span class="ident" id="7529887">keyTests</span>&nbsp;<span class="op" id="7529896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529900">enc</span>&nbsp;<span class="op" id="7529904">:=</span>&nbsp;<span class="builtinfunc" id="7529907">make</span><span class="op" id="7529911">(</span><span class="op" id="7529912">[</span><span class="op" id="7529913">]</span><span class="builtintype" id="7529914">uint32</span><span class="op" id="7529920">,</span>&nbsp;<span class="builtinfunc" id="7529922">len</span><span class="op" id="7529925">(</span><span class="ident" id="7529926">tt</span><span class="op" id="7529928">.</span><span class="ident" id="7529929">enc</span><span class="op" id="7529932">)</span><span class="op" id="7529933">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529937">var</span>&nbsp;<span class="ident" id="7529941">dec</span>&nbsp;<span class="op" id="7529945">[</span><span class="op" id="7529946">]</span><span class="builtintype" id="7529947">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529956">if</span>&nbsp;<span class="ident" id="7529959">tt</span><span class="op" id="7529961">.</span><span class="ident" id="7529962">dec</span>&nbsp;<span class="op" id="7529966">!=</span>&nbsp;<span class="ident" id="7529969">nil</span>&nbsp;<span class="op" id="7529973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529978">dec</span>&nbsp;<span class="op" id="7529982">=</span>&nbsp;<span class="builtinfunc" id="7529984">make</span><span class="op" id="7529988">(</span><span class="op" id="7529989">[</span><span class="op" id="7529990">]</span><span class="builtintype" id="7529991">uint32</span><span class="op" id="7529997">,</span>&nbsp;<span class="builtinfunc" id="7529999">len</span><span class="op" id="7530002">(</span><span class="ident" id="7530003">tt</span><span class="op" id="7530005">.</span><span class="ident" id="7530006">dec</span><span class="op" id="7530009">)</span><span class="op" id="7530010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7530018">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7530085">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7530150">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530219">expandKeyGo</span><span class="op" id="7530230">(</span><span class="ident" id="7530231">tt</span><span class="op" id="7530233">.</span><span class="ident" id="7530234">key</span><span class="op" id="7530237">,</span>&nbsp;<span class="ident" id="7530239">enc</span><span class="op" id="7530242">,</span>&nbsp;<span class="ident" id="7530244">dec</span><span class="op" id="7530247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530251">for</span>&nbsp;<span class="ident" id="7530255">j</span><span class="op" id="7530256">,</span>&nbsp;<span class="ident" id="7530258">v</span>&nbsp;<span class="op" id="7530260">:=</span>&nbsp;<span class="keyword" id="7530263">range</span>&nbsp;<span class="ident" id="7530269">enc</span>&nbsp;<span class="op" id="7530273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530278">if</span>&nbsp;<span class="ident" id="7530281">v</span>&nbsp;<span class="op" id="7530283">!=</span>&nbsp;<span class="ident" id="7530286">tt</span><span class="op" id="7530288">.</span><span class="ident" id="7530289">enc</span><span class="op" id="7530292">[</span><span class="ident" id="7530293">j</span><span class="op" id="7530294">]</span>&nbsp;<span class="op" id="7530296">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530302">t</span><span class="op" id="7530303">.</span><span class="ident" id="7530304">Errorf</span><span class="op" id="7530310">(</span><span class="string" id="7530311">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7530344">,</span>&nbsp;<span class="ident" id="7530346">i</span><span class="op" id="7530347">,</span>&nbsp;<span class="ident" id="7530349">j</span><span class="op" id="7530350">,</span>&nbsp;<span class="ident" id="7530352">v</span><span class="op" id="7530353">,</span>&nbsp;<span class="ident" id="7530355">tt</span><span class="op" id="7530357">.</span><span class="ident" id="7530358">enc</span><span class="op" id="7530361">[</span><span class="ident" id="7530362">j</span><span class="op" id="7530363">]</span><span class="op" id="7530364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530370">continue</span>&nbsp;<span class="ident" id="7530379">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530392">if</span>&nbsp;<span class="ident" id="7530395">dec</span>&nbsp;<span class="op" id="7530399">!=</span>&nbsp;<span class="ident" id="7530402">nil</span>&nbsp;<span class="op" id="7530406">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530411">for</span>&nbsp;<span class="ident" id="7530415">j</span><span class="op" id="7530416">,</span>&nbsp;<span class="ident" id="7530418">v</span>&nbsp;<span class="op" id="7530420">:=</span>&nbsp;<span class="keyword" id="7530423">range</span>&nbsp;<span class="ident" id="7530429">dec</span>&nbsp;<span class="op" id="7530433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530439">if</span>&nbsp;<span class="ident" id="7530442">v</span>&nbsp;<span class="op" id="7530444">!=</span>&nbsp;<span class="ident" id="7530447">tt</span><span class="op" id="7530449">.</span><span class="ident" id="7530450">dec</span><span class="op" id="7530453">[</span><span class="ident" id="7530454">j</span><span class="op" id="7530455">]</span>&nbsp;<span class="op" id="7530457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530464">t</span><span class="op" id="7530465">.</span><span class="ident" id="7530466">Errorf</span><span class="op" id="7530472">(</span><span class="string" id="7530473">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7530506">,</span>&nbsp;<span class="ident" id="7530508">i</span><span class="op" id="7530509">,</span>&nbsp;<span class="ident" id="7530511">j</span><span class="op" id="7530512">,</span>&nbsp;<span class="ident" id="7530514">v</span><span class="op" id="7530515">,</span>&nbsp;<span class="ident" id="7530517">tt</span><span class="op" id="7530519">.</span><span class="ident" id="7530520">dec</span><span class="op" id="7530523">[</span><span class="ident" id="7530524">j</span><span class="op" id="7530525">]</span><span class="op" id="7530526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530533">continue</span>&nbsp;<span class="ident" id="7530542">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530548">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530560">}</span><br>
<span class="lineno"></span><span class="op" id="7530562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="7530565">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="7530629">type</span>&nbsp;<span class="ident" id="7530634">CryptTest</span>&nbsp;<span class="keyword" id="7530644">struct</span>&nbsp;<span class="op" id="7530651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530654">key</span>&nbsp;<span class="op" id="7530658">[</span><span class="op" id="7530659">]</span><span class="builtintype" id="7530660">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530666">in</span>&nbsp;&nbsp;<span class="op" id="7530670">[</span><span class="op" id="7530671">]</span><span class="builtintype" id="7530672">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530678">out</span>&nbsp;<span class="op" id="7530682">[</span><span class="op" id="7530683">]</span><span class="builtintype" id="7530684">byte</span><br>
<span class="lineno">250</span><span class="op" id="7530689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7530692">var</span>&nbsp;<span class="ident" id="7530696">encryptTests</span>&nbsp;<span class="op" id="7530709">=</span>&nbsp;<span class="op" id="7530711">[</span><span class="op" id="7530712">]</span><span class="ident" id="7530713">CryptTest</span><span class="op" id="7530722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7530729">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530746">[</span><span class="op" id="7530747">]</span><span class="builtintype" id="7530748">byte</span><span class="op" id="7530752">{</span><span class="num" id="7530753">0x2b</span><span class="op" id="7530757">,</span>&nbsp;<span class="num" id="7530759">0x7e</span><span class="op" id="7530763">,</span>&nbsp;<span class="num" id="7530765">0x15</span><span class="op" id="7530769">,</span>&nbsp;<span class="num" id="7530771">0x16</span><span class="op" id="7530775">,</span>&nbsp;<span class="num" id="7530777">0x28</span><span class="op" id="7530781">,</span>&nbsp;<span class="num" id="7530783">0xae</span><span class="op" id="7530787">,</span>&nbsp;<span class="num" id="7530789">0xd2</span><span class="op" id="7530793">,</span>&nbsp;<span class="num" id="7530795">0xa6</span><span class="op" id="7530799">,</span>&nbsp;<span class="num" id="7530801">0xab</span><span class="op" id="7530805">,</span>&nbsp;<span class="num" id="7530807">0xf7</span><span class="op" id="7530811">,</span>&nbsp;<span class="num" id="7530813">0x15</span><span class="op" id="7530817">,</span>&nbsp;<span class="num" id="7530819">0x88</span><span class="op" id="7530823">,</span>&nbsp;<span class="num" id="7530825">0x09</span><span class="op" id="7530829">,</span>&nbsp;<span class="num" id="7530831">0xcf</span><span class="op" id="7530835">,</span>&nbsp;<span class="num" id="7530837">0x4f</span><span class="op" id="7530841">,</span>&nbsp;<span class="num" id="7530843">0x3c</span><span class="op" id="7530847">}</span><span class="op" id="7530848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530852">[</span><span class="op" id="7530853">]</span><span class="builtintype" id="7530854">byte</span><span class="op" id="7530858">{</span><span class="num" id="7530859">0x32</span><span class="op" id="7530863">,</span>&nbsp;<span class="num" id="7530865">0x43</span><span class="op" id="7530869">,</span>&nbsp;<span class="num" id="7530871">0xf6</span><span class="op" id="7530875">,</span>&nbsp;<span class="num" id="7530877">0xa8</span><span class="op" id="7530881">,</span>&nbsp;<span class="num" id="7530883">0x88</span><span class="op" id="7530887">,</span>&nbsp;<span class="num" id="7530889">0x5a</span><span class="op" id="7530893">,</span>&nbsp;<span class="num" id="7530895">0x30</span><span class="op" id="7530899">,</span>&nbsp;<span class="num" id="7530901">0x8d</span><span class="op" id="7530905">,</span>&nbsp;<span class="num" id="7530907">0x31</span><span class="op" id="7530911">,</span>&nbsp;<span class="num" id="7530913">0x31</span><span class="op" id="7530917">,</span>&nbsp;<span class="num" id="7530919">0x98</span><span class="op" id="7530923">,</span>&nbsp;<span class="num" id="7530925">0xa2</span><span class="op" id="7530929">,</span>&nbsp;<span class="num" id="7530931">0xe0</span><span class="op" id="7530935">,</span>&nbsp;<span class="num" id="7530937">0x37</span><span class="op" id="7530941">,</span>&nbsp;<span class="num" id="7530943">0x07</span><span class="op" id="7530947">,</span>&nbsp;<span class="num" id="7530949">0x34</span><span class="op" id="7530953">}</span><span class="op" id="7530954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530958">[</span><span class="op" id="7530959">]</span><span class="builtintype" id="7530960">byte</span><span class="op" id="7530964">{</span><span class="num" id="7530965">0x39</span><span class="op" id="7530969">,</span>&nbsp;<span class="num" id="7530971">0x25</span><span class="op" id="7530975">,</span>&nbsp;<span class="num" id="7530977">0x84</span><span class="op" id="7530981">,</span>&nbsp;<span class="num" id="7530983">0x1d</span><span class="op" id="7530987">,</span>&nbsp;<span class="num" id="7530989">0x02</span><span class="op" id="7530993">,</span>&nbsp;<span class="num" id="7530995">0xdc</span><span class="op" id="7530999">,</span>&nbsp;<span class="num" id="7531001">0x09</span><span class="op" id="7531005">,</span>&nbsp;<span class="num" id="7531007">0xfb</span><span class="op" id="7531011">,</span>&nbsp;<span class="num" id="7531013">0xdc</span><span class="op" id="7531017">,</span>&nbsp;<span class="num" id="7531019">0x11</span><span class="op" id="7531023">,</span>&nbsp;<span class="num" id="7531025">0x85</span><span class="op" id="7531029">,</span>&nbsp;<span class="num" id="7531031">0x97</span><span class="op" id="7531035">,</span>&nbsp;<span class="num" id="7531037">0x19</span><span class="op" id="7531041">,</span>&nbsp;<span class="num" id="7531043">0x6a</span><span class="op" id="7531047">,</span>&nbsp;<span class="num" id="7531049">0x0b</span><span class="op" id="7531053">,</span>&nbsp;<span class="num" id="7531055">0x32</span><span class="op" id="7531059">}</span><span class="op" id="7531060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531063">}</span><span class="op" id="7531064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531067">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7531071">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531099">[</span><span class="op" id="7531100">]</span><span class="builtintype" id="7531101">byte</span><span class="op" id="7531105">{</span><span class="num" id="7531106">0x00</span><span class="op" id="7531110">,</span>&nbsp;<span class="num" id="7531112">0x01</span><span class="op" id="7531116">,</span>&nbsp;<span class="num" id="7531118">0x02</span><span class="op" id="7531122">,</span>&nbsp;<span class="num" id="7531124">0x03</span><span class="op" id="7531128">,</span>&nbsp;<span class="num" id="7531130">0x04</span><span class="op" id="7531134">,</span>&nbsp;<span class="num" id="7531136">0x05</span><span class="op" id="7531140">,</span>&nbsp;<span class="num" id="7531142">0x06</span><span class="op" id="7531146">,</span>&nbsp;<span class="num" id="7531148">0x07</span><span class="op" id="7531152">,</span>&nbsp;<span class="num" id="7531154">0x08</span><span class="op" id="7531158">,</span>&nbsp;<span class="num" id="7531160">0x09</span><span class="op" id="7531164">,</span>&nbsp;<span class="num" id="7531166">0x0a</span><span class="op" id="7531170">,</span>&nbsp;<span class="num" id="7531172">0x0b</span><span class="op" id="7531176">,</span>&nbsp;<span class="num" id="7531178">0x0c</span><span class="op" id="7531182">,</span>&nbsp;<span class="num" id="7531184">0x0d</span><span class="op" id="7531188">,</span>&nbsp;<span class="num" id="7531190">0x0e</span><span class="op" id="7531194">,</span>&nbsp;<span class="num" id="7531196">0x0f</span><span class="op" id="7531200">}</span><span class="op" id="7531201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531205">[</span><span class="op" id="7531206">]</span><span class="builtintype" id="7531207">byte</span><span class="op" id="7531211">{</span><span class="num" id="7531212">0x00</span><span class="op" id="7531216">,</span>&nbsp;<span class="num" id="7531218">0x11</span><span class="op" id="7531222">,</span>&nbsp;<span class="num" id="7531224">0x22</span><span class="op" id="7531228">,</span>&nbsp;<span class="num" id="7531230">0x33</span><span class="op" id="7531234">,</span>&nbsp;<span class="num" id="7531236">0x44</span><span class="op" id="7531240">,</span>&nbsp;<span class="num" id="7531242">0x55</span><span class="op" id="7531246">,</span>&nbsp;<span class="num" id="7531248">0x66</span><span class="op" id="7531252">,</span>&nbsp;<span class="num" id="7531254">0x77</span><span class="op" id="7531258">,</span>&nbsp;<span class="num" id="7531260">0x88</span><span class="op" id="7531264">,</span>&nbsp;<span class="num" id="7531266">0x99</span><span class="op" id="7531270">,</span>&nbsp;<span class="num" id="7531272">0xaa</span><span class="op" id="7531276">,</span>&nbsp;<span class="num" id="7531278">0xbb</span><span class="op" id="7531282">,</span>&nbsp;<span class="num" id="7531284">0xcc</span><span class="op" id="7531288">,</span>&nbsp;<span class="num" id="7531290">0xdd</span><span class="op" id="7531294">,</span>&nbsp;<span class="num" id="7531296">0xee</span><span class="op" id="7531300">,</span>&nbsp;<span class="num" id="7531302">0xff</span><span class="op" id="7531306">}</span><span class="op" id="7531307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531311">[</span><span class="op" id="7531312">]</span><span class="builtintype" id="7531313">byte</span><span class="op" id="7531317">{</span><span class="num" id="7531318">0x69</span><span class="op" id="7531322">,</span>&nbsp;<span class="num" id="7531324">0xc4</span><span class="op" id="7531328">,</span>&nbsp;<span class="num" id="7531330">0xe0</span><span class="op" id="7531334">,</span>&nbsp;<span class="num" id="7531336">0xd8</span><span class="op" id="7531340">,</span>&nbsp;<span class="num" id="7531342">0x6a</span><span class="op" id="7531346">,</span>&nbsp;<span class="num" id="7531348">0x7b</span><span class="op" id="7531352">,</span>&nbsp;<span class="num" id="7531354">0x04</span><span class="op" id="7531358">,</span>&nbsp;<span class="num" id="7531360">0x30</span><span class="op" id="7531364">,</span>&nbsp;<span class="num" id="7531366">0xd8</span><span class="op" id="7531370">,</span>&nbsp;<span class="num" id="7531372">0xcd</span><span class="op" id="7531376">,</span>&nbsp;<span class="num" id="7531378">0xb7</span><span class="op" id="7531382">,</span>&nbsp;<span class="num" id="7531384">0x80</span><span class="op" id="7531388">,</span>&nbsp;<span class="num" id="7531390">0x70</span><span class="op" id="7531394">,</span>&nbsp;<span class="num" id="7531396">0xb4</span><span class="op" id="7531400">,</span>&nbsp;<span class="num" id="7531402">0xc5</span><span class="op" id="7531406">,</span>&nbsp;<span class="num" id="7531408">0x5a</span><span class="op" id="7531412">}</span><span class="op" id="7531413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531416">}</span><span class="op" id="7531417">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7531424">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531452">[</span><span class="op" id="7531453">]</span><span class="builtintype" id="7531454">byte</span><span class="op" id="7531458">{</span><span class="num" id="7531459">0x00</span><span class="op" id="7531463">,</span>&nbsp;<span class="num" id="7531465">0x01</span><span class="op" id="7531469">,</span>&nbsp;<span class="num" id="7531471">0x02</span><span class="op" id="7531475">,</span>&nbsp;<span class="num" id="7531477">0x03</span><span class="op" id="7531481">,</span>&nbsp;<span class="num" id="7531483">0x04</span><span class="op" id="7531487">,</span>&nbsp;<span class="num" id="7531489">0x05</span><span class="op" id="7531493">,</span>&nbsp;<span class="num" id="7531495">0x06</span><span class="op" id="7531499">,</span>&nbsp;<span class="num" id="7531501">0x07</span><span class="op" id="7531505">,</span>&nbsp;<span class="num" id="7531507">0x08</span><span class="op" id="7531511">,</span>&nbsp;<span class="num" id="7531513">0x09</span><span class="op" id="7531517">,</span>&nbsp;<span class="num" id="7531519">0x0a</span><span class="op" id="7531523">,</span>&nbsp;<span class="num" id="7531525">0x0b</span><span class="op" id="7531529">,</span>&nbsp;<span class="num" id="7531531">0x0c</span><span class="op" id="7531535">,</span>&nbsp;<span class="num" id="7531537">0x0d</span><span class="op" id="7531541">,</span>&nbsp;<span class="num" id="7531543">0x0e</span><span class="op" id="7531547">,</span>&nbsp;<span class="num" id="7531549">0x0f</span><span class="op" id="7531553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7531558">0x10</span><span class="op" id="7531562">,</span>&nbsp;<span class="num" id="7531564">0x11</span><span class="op" id="7531568">,</span>&nbsp;<span class="num" id="7531570">0x12</span><span class="op" id="7531574">,</span>&nbsp;<span class="num" id="7531576">0x13</span><span class="op" id="7531580">,</span>&nbsp;<span class="num" id="7531582">0x14</span><span class="op" id="7531586">,</span>&nbsp;<span class="num" id="7531588">0x15</span><span class="op" id="7531592">,</span>&nbsp;<span class="num" id="7531594">0x16</span><span class="op" id="7531598">,</span>&nbsp;<span class="num" id="7531600">0x17</span><span class="op" id="7531604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531608">}</span><span class="op" id="7531609">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531613">[</span><span class="op" id="7531614">]</span><span class="builtintype" id="7531615">byte</span><span class="op" id="7531619">{</span><span class="num" id="7531620">0x00</span><span class="op" id="7531624">,</span>&nbsp;<span class="num" id="7531626">0x11</span><span class="op" id="7531630">,</span>&nbsp;<span class="num" id="7531632">0x22</span><span class="op" id="7531636">,</span>&nbsp;<span class="num" id="7531638">0x33</span><span class="op" id="7531642">,</span>&nbsp;<span class="num" id="7531644">0x44</span><span class="op" id="7531648">,</span>&nbsp;<span class="num" id="7531650">0x55</span><span class="op" id="7531654">,</span>&nbsp;<span class="num" id="7531656">0x66</span><span class="op" id="7531660">,</span>&nbsp;<span class="num" id="7531662">0x77</span><span class="op" id="7531666">,</span>&nbsp;<span class="num" id="7531668">0x88</span><span class="op" id="7531672">,</span>&nbsp;<span class="num" id="7531674">0x99</span><span class="op" id="7531678">,</span>&nbsp;<span class="num" id="7531680">0xaa</span><span class="op" id="7531684">,</span>&nbsp;<span class="num" id="7531686">0xbb</span><span class="op" id="7531690">,</span>&nbsp;<span class="num" id="7531692">0xcc</span><span class="op" id="7531696">,</span>&nbsp;<span class="num" id="7531698">0xdd</span><span class="op" id="7531702">,</span>&nbsp;<span class="num" id="7531704">0xee</span><span class="op" id="7531708">,</span>&nbsp;<span class="num" id="7531710">0xff</span><span class="op" id="7531714">}</span><span class="op" id="7531715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531719">[</span><span class="op" id="7531720">]</span><span class="builtintype" id="7531721">byte</span><span class="op" id="7531725">{</span><span class="num" id="7531726">0xdd</span><span class="op" id="7531730">,</span>&nbsp;<span class="num" id="7531732">0xa9</span><span class="op" id="7531736">,</span>&nbsp;<span class="num" id="7531738">0x7c</span><span class="op" id="7531742">,</span>&nbsp;<span class="num" id="7531744">0xa4</span><span class="op" id="7531748">,</span>&nbsp;<span class="num" id="7531750">0x86</span><span class="op" id="7531754">,</span>&nbsp;<span class="num" id="7531756">0x4c</span><span class="op" id="7531760">,</span>&nbsp;<span class="num" id="7531762">0xdf</span><span class="op" id="7531766">,</span>&nbsp;<span class="num" id="7531768">0xe0</span><span class="op" id="7531772">,</span>&nbsp;<span class="num" id="7531774">0x6e</span><span class="op" id="7531778">,</span>&nbsp;<span class="num" id="7531780">0xaf</span><span class="op" id="7531784">,</span>&nbsp;<span class="num" id="7531786">0x70</span><span class="op" id="7531790">,</span>&nbsp;<span class="num" id="7531792">0xa0</span><span class="op" id="7531796">,</span>&nbsp;<span class="num" id="7531798">0xec</span><span class="op" id="7531802">,</span>&nbsp;<span class="num" id="7531804">0x0d</span><span class="op" id="7531808">,</span>&nbsp;<span class="num" id="7531810">0x71</span><span class="op" id="7531814">,</span>&nbsp;<span class="num" id="7531816">0x91</span><span class="op" id="7531820">}</span><span class="op" id="7531821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531824">}</span><span class="op" id="7531825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7531832">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531860">[</span><span class="op" id="7531861">]</span><span class="builtintype" id="7531862">byte</span><span class="op" id="7531866">{</span><span class="num" id="7531867">0x00</span><span class="op" id="7531871">,</span>&nbsp;<span class="num" id="7531873">0x01</span><span class="op" id="7531877">,</span>&nbsp;<span class="num" id="7531879">0x02</span><span class="op" id="7531883">,</span>&nbsp;<span class="num" id="7531885">0x03</span><span class="op" id="7531889">,</span>&nbsp;<span class="num" id="7531891">0x04</span><span class="op" id="7531895">,</span>&nbsp;<span class="num" id="7531897">0x05</span><span class="op" id="7531901">,</span>&nbsp;<span class="num" id="7531903">0x06</span><span class="op" id="7531907">,</span>&nbsp;<span class="num" id="7531909">0x07</span><span class="op" id="7531913">,</span>&nbsp;<span class="num" id="7531915">0x08</span><span class="op" id="7531919">,</span>&nbsp;<span class="num" id="7531921">0x09</span><span class="op" id="7531925">,</span>&nbsp;<span class="num" id="7531927">0x0a</span><span class="op" id="7531931">,</span>&nbsp;<span class="num" id="7531933">0x0b</span><span class="op" id="7531937">,</span>&nbsp;<span class="num" id="7531939">0x0c</span><span class="op" id="7531943">,</span>&nbsp;<span class="num" id="7531945">0x0d</span><span class="op" id="7531949">,</span>&nbsp;<span class="num" id="7531951">0x0e</span><span class="op" id="7531955">,</span>&nbsp;<span class="num" id="7531957">0x0f</span><span class="op" id="7531961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7531966">0x10</span><span class="op" id="7531970">,</span>&nbsp;<span class="num" id="7531972">0x11</span><span class="op" id="7531976">,</span>&nbsp;<span class="num" id="7531978">0x12</span><span class="op" id="7531982">,</span>&nbsp;<span class="num" id="7531984">0x13</span><span class="op" id="7531988">,</span>&nbsp;<span class="num" id="7531990">0x14</span><span class="op" id="7531994">,</span>&nbsp;<span class="num" id="7531996">0x15</span><span class="op" id="7532000">,</span>&nbsp;<span class="num" id="7532002">0x16</span><span class="op" id="7532006">,</span>&nbsp;<span class="num" id="7532008">0x17</span><span class="op" id="7532012">,</span>&nbsp;<span class="num" id="7532014">0x18</span><span class="op" id="7532018">,</span>&nbsp;<span class="num" id="7532020">0x19</span><span class="op" id="7532024">,</span>&nbsp;<span class="num" id="7532026">0x1a</span><span class="op" id="7532030">,</span>&nbsp;<span class="num" id="7532032">0x1b</span><span class="op" id="7532036">,</span>&nbsp;<span class="num" id="7532038">0x1c</span><span class="op" id="7532042">,</span>&nbsp;<span class="num" id="7532044">0x1d</span><span class="op" id="7532048">,</span>&nbsp;<span class="num" id="7532050">0x1e</span><span class="op" id="7532054">,</span>&nbsp;<span class="num" id="7532056">0x1f</span><span class="op" id="7532060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532064">}</span><span class="op" id="7532065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532069">[</span><span class="op" id="7532070">]</span><span class="builtintype" id="7532071">byte</span><span class="op" id="7532075">{</span><span class="num" id="7532076">0x00</span><span class="op" id="7532080">,</span>&nbsp;<span class="num" id="7532082">0x11</span><span class="op" id="7532086">,</span>&nbsp;<span class="num" id="7532088">0x22</span><span class="op" id="7532092">,</span>&nbsp;<span class="num" id="7532094">0x33</span><span class="op" id="7532098">,</span>&nbsp;<span class="num" id="7532100">0x44</span><span class="op" id="7532104">,</span>&nbsp;<span class="num" id="7532106">0x55</span><span class="op" id="7532110">,</span>&nbsp;<span class="num" id="7532112">0x66</span><span class="op" id="7532116">,</span>&nbsp;<span class="num" id="7532118">0x77</span><span class="op" id="7532122">,</span>&nbsp;<span class="num" id="7532124">0x88</span><span class="op" id="7532128">,</span>&nbsp;<span class="num" id="7532130">0x99</span><span class="op" id="7532134">,</span>&nbsp;<span class="num" id="7532136">0xaa</span><span class="op" id="7532140">,</span>&nbsp;<span class="num" id="7532142">0xbb</span><span class="op" id="7532146">,</span>&nbsp;<span class="num" id="7532148">0xcc</span><span class="op" id="7532152">,</span>&nbsp;<span class="num" id="7532154">0xdd</span><span class="op" id="7532158">,</span>&nbsp;<span class="num" id="7532160">0xee</span><span class="op" id="7532164">,</span>&nbsp;<span class="num" id="7532166">0xff</span><span class="op" id="7532170">}</span><span class="op" id="7532171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532175">[</span><span class="op" id="7532176">]</span><span class="builtintype" id="7532177">byte</span><span class="op" id="7532181">{</span><span class="num" id="7532182">0x8e</span><span class="op" id="7532186">,</span>&nbsp;<span class="num" id="7532188">0xa2</span><span class="op" id="7532192">,</span>&nbsp;<span class="num" id="7532194">0xb7</span><span class="op" id="7532198">,</span>&nbsp;<span class="num" id="7532200">0xca</span><span class="op" id="7532204">,</span>&nbsp;<span class="num" id="7532206">0x51</span><span class="op" id="7532210">,</span>&nbsp;<span class="num" id="7532212">0x67</span><span class="op" id="7532216">,</span>&nbsp;<span class="num" id="7532218">0x45</span><span class="op" id="7532222">,</span>&nbsp;<span class="num" id="7532224">0xbf</span><span class="op" id="7532228">,</span>&nbsp;<span class="num" id="7532230">0xea</span><span class="op" id="7532234">,</span>&nbsp;<span class="num" id="7532236">0xfc</span><span class="op" id="7532240">,</span>&nbsp;<span class="num" id="7532242">0x49</span><span class="op" id="7532246">,</span>&nbsp;<span class="num" id="7532248">0x90</span><span class="op" id="7532252">,</span>&nbsp;<span class="num" id="7532254">0x4b</span><span class="op" id="7532258">,</span>&nbsp;<span class="num" id="7532260">0x49</span><span class="op" id="7532264">,</span>&nbsp;<span class="num" id="7532266">0x60</span><span class="op" id="7532270">,</span>&nbsp;<span class="num" id="7532272">0x89</span><span class="op" id="7532276">}</span><span class="op" id="7532277">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532280">}</span><span class="op" id="7532281">,</span><br>
<span class="lineno"></span><span class="op" id="7532283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7532286">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7532334">func</span>&nbsp;<span class="ident" id="7532339">TestEncryptBlock</span><span class="op" id="7532355">(</span><span class="ident" id="7532356">t</span>&nbsp;<span class="op" id="7532358">*</span><span class="ident" id="7532359">testing</span><span class="op" id="7532366">.</span><span class="ident" id="7532367">T</span><span class="op" id="7532368">)</span>&nbsp;<span class="op" id="7532370">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532373">for</span>&nbsp;<span class="ident" id="7532377">i</span><span class="op" id="7532378">,</span>&nbsp;<span class="ident" id="7532380">tt</span>&nbsp;<span class="op" id="7532383">:=</span>&nbsp;<span class="keyword" id="7532386">range</span>&nbsp;<span class="ident" id="7532392">encryptTests</span>&nbsp;<span class="op" id="7532405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532409">n</span>&nbsp;<span class="op" id="7532411">:=</span>&nbsp;<span class="builtinfunc" id="7532414">len</span><span class="op" id="7532417">(</span><span class="ident" id="7532418">tt</span><span class="op" id="7532420">.</span><span class="ident" id="7532421">key</span><span class="op" id="7532424">)</span>&nbsp;<span class="op" id="7532426">+</span>&nbsp;<span class="num" id="7532428">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532433">enc</span>&nbsp;<span class="op" id="7532437">:=</span>&nbsp;<span class="builtinfunc" id="7532440">make</span><span class="op" id="7532444">(</span><span class="op" id="7532445">[</span><span class="op" id="7532446">]</span><span class="builtintype" id="7532447">uint32</span><span class="op" id="7532453">,</span>&nbsp;<span class="ident" id="7532455">n</span><span class="op" id="7532456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532460">dec</span>&nbsp;<span class="op" id="7532464">:=</span>&nbsp;<span class="builtinfunc" id="7532467">make</span><span class="op" id="7532471">(</span><span class="op" id="7532472">[</span><span class="op" id="7532473">]</span><span class="builtintype" id="7532474">uint32</span><span class="op" id="7532480">,</span>&nbsp;<span class="ident" id="7532482">n</span><span class="op" id="7532483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532487">expandKey</span><span class="op" id="7532496">(</span><span class="ident" id="7532497">tt</span><span class="op" id="7532499">.</span><span class="ident" id="7532500">key</span><span class="op" id="7532503">,</span>&nbsp;<span class="ident" id="7532505">enc</span><span class="op" id="7532508">,</span>&nbsp;<span class="ident" id="7532510">dec</span><span class="op" id="7532513">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532517">out</span>&nbsp;<span class="op" id="7532521">:=</span>&nbsp;<span class="builtinfunc" id="7532524">make</span><span class="op" id="7532528">(</span><span class="op" id="7532529">[</span><span class="op" id="7532530">]</span><span class="builtintype" id="7532531">byte</span><span class="op" id="7532535">,</span>&nbsp;<span class="builtinfunc" id="7532537">len</span><span class="op" id="7532540">(</span><span class="ident" id="7532541">tt</span><span class="op" id="7532543">.</span><span class="ident" id="7532544">in</span><span class="op" id="7532546">)</span><span class="op" id="7532547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532551">encryptBlock</span><span class="op" id="7532563">(</span><span class="ident" id="7532564">enc</span><span class="op" id="7532567">,</span>&nbsp;<span class="ident" id="7532569">out</span><span class="op" id="7532572">,</span>&nbsp;<span class="ident" id="7532574">tt</span><span class="op" id="7532576">.</span><span class="ident" id="7532577">in</span><span class="op" id="7532579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532583">for</span>&nbsp;<span class="ident" id="7532587">j</span><span class="op" id="7532588">,</span>&nbsp;<span class="ident" id="7532590">v</span>&nbsp;<span class="op" id="7532592">:=</span>&nbsp;<span class="keyword" id="7532595">range</span>&nbsp;<span class="ident" id="7532601">out</span>&nbsp;<span class="op" id="7532605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532610">if</span>&nbsp;<span class="ident" id="7532613">v</span>&nbsp;<span class="op" id="7532615">!=</span>&nbsp;<span class="ident" id="7532618">tt</span><span class="op" id="7532620">.</span><span class="ident" id="7532621">out</span><span class="op" id="7532624">[</span><span class="ident" id="7532625">j</span><span class="op" id="7532626">]</span>&nbsp;<span class="op" id="7532628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532634">t</span><span class="op" id="7532635">.</span><span class="ident" id="7532636">Errorf</span><span class="op" id="7532642">(</span><span class="string" id="7532643">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7532685">,</span>&nbsp;<span class="ident" id="7532687">i</span><span class="op" id="7532688">,</span>&nbsp;<span class="ident" id="7532690">j</span><span class="op" id="7532691">,</span>&nbsp;<span class="ident" id="7532693">v</span><span class="op" id="7532694">,</span>&nbsp;<span class="ident" id="7532696">tt</span><span class="op" id="7532698">.</span><span class="ident" id="7532699">out</span><span class="op" id="7532702">[</span><span class="ident" id="7532703">j</span><span class="op" id="7532704">]</span><span class="op" id="7532705">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532711">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532727">}</span><br>
<span class="lineno"></span><span class="op" id="7532729">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="7532732">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7532780">func</span>&nbsp;<span class="ident" id="7532785">TestDecryptBlock</span><span class="op" id="7532801">(</span><span class="ident" id="7532802">t</span>&nbsp;<span class="op" id="7532804">*</span><span class="ident" id="7532805">testing</span><span class="op" id="7532812">.</span><span class="ident" id="7532813">T</span><span class="op" id="7532814">)</span>&nbsp;<span class="op" id="7532816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532819">for</span>&nbsp;<span class="ident" id="7532823">i</span><span class="op" id="7532824">,</span>&nbsp;<span class="ident" id="7532826">tt</span>&nbsp;<span class="op" id="7532829">:=</span>&nbsp;<span class="keyword" id="7532832">range</span>&nbsp;<span class="ident" id="7532838">encryptTests</span>&nbsp;<span class="op" id="7532851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532855">n</span>&nbsp;<span class="op" id="7532857">:=</span>&nbsp;<span class="builtinfunc" id="7532860">len</span><span class="op" id="7532863">(</span><span class="ident" id="7532864">tt</span><span class="op" id="7532866">.</span><span class="ident" id="7532867">key</span><span class="op" id="7532870">)</span>&nbsp;<span class="op" id="7532872">+</span>&nbsp;<span class="num" id="7532874">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532879">enc</span>&nbsp;<span class="op" id="7532883">:=</span>&nbsp;<span class="builtinfunc" id="7532886">make</span><span class="op" id="7532890">(</span><span class="op" id="7532891">[</span><span class="op" id="7532892">]</span><span class="builtintype" id="7532893">uint32</span><span class="op" id="7532899">,</span>&nbsp;<span class="ident" id="7532901">n</span><span class="op" id="7532902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532906">dec</span>&nbsp;<span class="op" id="7532910">:=</span>&nbsp;<span class="builtinfunc" id="7532913">make</span><span class="op" id="7532917">(</span><span class="op" id="7532918">[</span><span class="op" id="7532919">]</span><span class="builtintype" id="7532920">uint32</span><span class="op" id="7532926">,</span>&nbsp;<span class="ident" id="7532928">n</span><span class="op" id="7532929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532933">expandKey</span><span class="op" id="7532942">(</span><span class="ident" id="7532943">tt</span><span class="op" id="7532945">.</span><span class="ident" id="7532946">key</span><span class="op" id="7532949">,</span>&nbsp;<span class="ident" id="7532951">enc</span><span class="op" id="7532954">,</span>&nbsp;<span class="ident" id="7532956">dec</span><span class="op" id="7532959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532963">plain</span>&nbsp;<span class="op" id="7532969">:=</span>&nbsp;<span class="builtinfunc" id="7532972">make</span><span class="op" id="7532976">(</span><span class="op" id="7532977">[</span><span class="op" id="7532978">]</span><span class="builtintype" id="7532979">byte</span><span class="op" id="7532983">,</span>&nbsp;<span class="builtinfunc" id="7532985">len</span><span class="op" id="7532988">(</span><span class="ident" id="7532989">tt</span><span class="op" id="7532991">.</span><span class="ident" id="7532992">in</span><span class="op" id="7532994">)</span><span class="op" id="7532995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532999">decryptBlock</span><span class="op" id="7533011">(</span><span class="ident" id="7533012">dec</span><span class="op" id="7533015">,</span>&nbsp;<span class="ident" id="7533017">plain</span><span class="op" id="7533022">,</span>&nbsp;<span class="ident" id="7533024">tt</span><span class="op" id="7533026">.</span><span class="ident" id="7533027">out</span><span class="op" id="7533030">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533034">for</span>&nbsp;<span class="ident" id="7533038">j</span><span class="op" id="7533039">,</span>&nbsp;<span class="ident" id="7533041">v</span>&nbsp;<span class="op" id="7533043">:=</span>&nbsp;<span class="keyword" id="7533046">range</span>&nbsp;<span class="ident" id="7533052">plain</span>&nbsp;<span class="op" id="7533058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533063">if</span>&nbsp;<span class="ident" id="7533066">v</span>&nbsp;<span class="op" id="7533068">!=</span>&nbsp;<span class="ident" id="7533071">tt</span><span class="op" id="7533073">.</span><span class="ident" id="7533074">in</span><span class="op" id="7533076">[</span><span class="ident" id="7533077">j</span><span class="op" id="7533078">]</span>&nbsp;<span class="op" id="7533080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533086">t</span><span class="op" id="7533087">.</span><span class="ident" id="7533088">Errorf</span><span class="op" id="7533094">(</span><span class="string" id="7533095">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7533139">,</span>&nbsp;<span class="ident" id="7533141">i</span><span class="op" id="7533142">,</span>&nbsp;<span class="ident" id="7533144">j</span><span class="op" id="7533145">,</span>&nbsp;<span class="ident" id="7533147">v</span><span class="op" id="7533148">,</span>&nbsp;<span class="ident" id="7533150">tt</span><span class="op" id="7533152">.</span><span class="ident" id="7533153">in</span><span class="op" id="7533155">[</span><span class="ident" id="7533156">j</span><span class="op" id="7533157">]</span><span class="op" id="7533158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533164">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533173">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533180">}</span><br>
<span class="lineno"></span><span class="op" id="7533182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7533185">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="7533242">func</span>&nbsp;<span class="ident" id="7533247">TestCipherEncrypt</span><span class="op" id="7533264">(</span><span class="ident" id="7533265">t</span>&nbsp;<span class="op" id="7533267">*</span><span class="ident" id="7533268">testing</span><span class="op" id="7533275">.</span><span class="ident" id="7533276">T</span><span class="op" id="7533277">)</span>&nbsp;<span class="op" id="7533279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533282">for</span>&nbsp;<span class="ident" id="7533286">i</span><span class="op" id="7533287">,</span>&nbsp;<span class="ident" id="7533289">tt</span>&nbsp;<span class="op" id="7533292">:=</span>&nbsp;<span class="keyword" id="7533295">range</span>&nbsp;<span class="ident" id="7533301">encryptTests</span>&nbsp;<span class="op" id="7533314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533318">c</span><span class="op" id="7533319">,</span>&nbsp;<span class="ident" id="7533321">err</span>&nbsp;<span class="op" id="7533325">:=</span>&nbsp;<span class="ident" id="7533328">NewCipher</span><span class="op" id="7533337">(</span><span class="ident" id="7533338">tt</span><span class="op" id="7533340">.</span><span class="ident" id="7533341">key</span><span class="op" id="7533344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533348">if</span>&nbsp;<span class="ident" id="7533351">err</span>&nbsp;<span class="op" id="7533355">!=</span>&nbsp;<span class="ident" id="7533358">nil</span>&nbsp;<span class="op" id="7533362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533367">t</span><span class="op" id="7533368">.</span><span class="ident" id="7533369">Errorf</span><span class="op" id="7533375">(</span><span class="string" id="7533376">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7533402">,</span>&nbsp;<span class="builtinfunc" id="7533404">len</span><span class="op" id="7533407">(</span><span class="ident" id="7533408">tt</span><span class="op" id="7533410">.</span><span class="ident" id="7533411">key</span><span class="op" id="7533414">)</span><span class="op" id="7533415">,</span>&nbsp;<span class="ident" id="7533417">err</span><span class="op" id="7533420">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533425">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533440">out</span>&nbsp;<span class="op" id="7533444">:=</span>&nbsp;<span class="builtinfunc" id="7533447">make</span><span class="op" id="7533451">(</span><span class="op" id="7533452">[</span><span class="op" id="7533453">]</span><span class="builtintype" id="7533454">byte</span><span class="op" id="7533458">,</span>&nbsp;<span class="builtinfunc" id="7533460">len</span><span class="op" id="7533463">(</span><span class="ident" id="7533464">tt</span><span class="op" id="7533466">.</span><span class="ident" id="7533467">in</span><span class="op" id="7533469">)</span><span class="op" id="7533470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533474">c</span><span class="op" id="7533475">.</span><span class="ident" id="7533476">Encrypt</span><span class="op" id="7533483">(</span><span class="ident" id="7533484">out</span><span class="op" id="7533487">,</span>&nbsp;<span class="ident" id="7533489">tt</span><span class="op" id="7533491">.</span><span class="ident" id="7533492">in</span><span class="op" id="7533494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533498">for</span>&nbsp;<span class="ident" id="7533502">j</span><span class="op" id="7533503">,</span>&nbsp;<span class="ident" id="7533505">v</span>&nbsp;<span class="op" id="7533507">:=</span>&nbsp;<span class="keyword" id="7533510">range</span>&nbsp;<span class="ident" id="7533516">out</span>&nbsp;<span class="op" id="7533520">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533525">if</span>&nbsp;<span class="ident" id="7533528">v</span>&nbsp;<span class="op" id="7533530">!=</span>&nbsp;<span class="ident" id="7533533">tt</span><span class="op" id="7533535">.</span><span class="ident" id="7533536">out</span><span class="op" id="7533539">[</span><span class="ident" id="7533540">j</span><span class="op" id="7533541">]</span>&nbsp;<span class="op" id="7533543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533549">t</span><span class="op" id="7533550">.</span><span class="ident" id="7533551">Errorf</span><span class="op" id="7533557">(</span><span class="string" id="7533558">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7533602">,</span>&nbsp;<span class="ident" id="7533604">i</span><span class="op" id="7533605">,</span>&nbsp;<span class="ident" id="7533607">j</span><span class="op" id="7533608">,</span>&nbsp;<span class="ident" id="7533610">v</span><span class="op" id="7533611">,</span>&nbsp;<span class="ident" id="7533613">tt</span><span class="op" id="7533615">.</span><span class="ident" id="7533616">out</span><span class="op" id="7533619">[</span><span class="ident" id="7533620">j</span><span class="op" id="7533621">]</span><span class="op" id="7533622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533628">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533641">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533644">}</span><br>
<span class="lineno"></span><span class="op" id="7533646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7533649">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7533699">func</span>&nbsp;<span class="ident" id="7533704">TestCipherDecrypt</span><span class="op" id="7533721">(</span><span class="ident" id="7533722">t</span>&nbsp;<span class="op" id="7533724">*</span><span class="ident" id="7533725">testing</span><span class="op" id="7533732">.</span><span class="ident" id="7533733">T</span><span class="op" id="7533734">)</span>&nbsp;<span class="op" id="7533736">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533739">for</span>&nbsp;<span class="ident" id="7533743">i</span><span class="op" id="7533744">,</span>&nbsp;<span class="ident" id="7533746">tt</span>&nbsp;<span class="op" id="7533749">:=</span>&nbsp;<span class="keyword" id="7533752">range</span>&nbsp;<span class="ident" id="7533758">encryptTests</span>&nbsp;<span class="op" id="7533771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533775">c</span><span class="op" id="7533776">,</span>&nbsp;<span class="ident" id="7533778">err</span>&nbsp;<span class="op" id="7533782">:=</span>&nbsp;<span class="ident" id="7533785">NewCipher</span><span class="op" id="7533794">(</span><span class="ident" id="7533795">tt</span><span class="op" id="7533797">.</span><span class="ident" id="7533798">key</span><span class="op" id="7533801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533805">if</span>&nbsp;<span class="ident" id="7533808">err</span>&nbsp;<span class="op" id="7533812">!=</span>&nbsp;<span class="ident" id="7533815">nil</span>&nbsp;<span class="op" id="7533819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533824">t</span><span class="op" id="7533825">.</span><span class="ident" id="7533826">Errorf</span><span class="op" id="7533832">(</span><span class="string" id="7533833">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7533859">,</span>&nbsp;<span class="builtinfunc" id="7533861">len</span><span class="op" id="7533864">(</span><span class="ident" id="7533865">tt</span><span class="op" id="7533867">.</span><span class="ident" id="7533868">key</span><span class="op" id="7533871">)</span><span class="op" id="7533872">,</span>&nbsp;<span class="ident" id="7533874">err</span><span class="op" id="7533877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533882">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533897">plain</span>&nbsp;<span class="op" id="7533903">:=</span>&nbsp;<span class="builtinfunc" id="7533906">make</span><span class="op" id="7533910">(</span><span class="op" id="7533911">[</span><span class="op" id="7533912">]</span><span class="builtintype" id="7533913">byte</span><span class="op" id="7533917">,</span>&nbsp;<span class="builtinfunc" id="7533919">len</span><span class="op" id="7533922">(</span><span class="ident" id="7533923">tt</span><span class="op" id="7533925">.</span><span class="ident" id="7533926">in</span><span class="op" id="7533928">)</span><span class="op" id="7533929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533933">c</span><span class="op" id="7533934">.</span><span class="ident" id="7533935">Decrypt</span><span class="op" id="7533942">(</span><span class="ident" id="7533943">plain</span><span class="op" id="7533948">,</span>&nbsp;<span class="ident" id="7533950">tt</span><span class="op" id="7533952">.</span><span class="ident" id="7533953">out</span><span class="op" id="7533956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533960">for</span>&nbsp;<span class="ident" id="7533964">j</span><span class="op" id="7533965">,</span>&nbsp;<span class="ident" id="7533967">v</span>&nbsp;<span class="op" id="7533969">:=</span>&nbsp;<span class="keyword" id="7533972">range</span>&nbsp;<span class="ident" id="7533978">plain</span>&nbsp;<span class="op" id="7533984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533989">if</span>&nbsp;<span class="ident" id="7533992">v</span>&nbsp;<span class="op" id="7533994">!=</span>&nbsp;<span class="ident" id="7533997">tt</span><span class="op" id="7533999">.</span><span class="ident" id="7534000">in</span><span class="op" id="7534002">[</span><span class="ident" id="7534003">j</span><span class="op" id="7534004">]</span>&nbsp;<span class="op" id="7534006">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534012">t</span><span class="op" id="7534013">.</span><span class="ident" id="7534014">Errorf</span><span class="op" id="7534020">(</span><span class="string" id="7534021">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7534065">,</span>&nbsp;<span class="ident" id="7534067">i</span><span class="op" id="7534068">,</span>&nbsp;<span class="ident" id="7534070">j</span><span class="op" id="7534071">,</span>&nbsp;<span class="ident" id="7534073">v</span><span class="op" id="7534074">,</span>&nbsp;<span class="ident" id="7534076">tt</span><span class="op" id="7534078">.</span><span class="ident" id="7534079">in</span><span class="op" id="7534081">[</span><span class="ident" id="7534082">j</span><span class="op" id="7534083">]</span><span class="op" id="7534084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534090">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534106">}</span><br>
<span class="lineno">355</span><span class="op" id="7534108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7534111">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="7534139">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="7534171">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="7534190">func</span>&nbsp;<span class="ident" id="7534195">TestShortBlocks</span><span class="op" id="7534210">(</span><span class="ident" id="7534211">t</span>&nbsp;<span class="op" id="7534213">*</span><span class="ident" id="7534214">testing</span><span class="op" id="7534221">.</span><span class="ident" id="7534222">T</span><span class="op" id="7534223">)</span>&nbsp;<span class="op" id="7534225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534228">bytes</span>&nbsp;<span class="op" id="7534234">:=</span>&nbsp;<span class="keyword" id="7534237">func</span><span class="op" id="7534241">(</span><span class="ident" id="7534242">n</span>&nbsp;<span class="builtintype" id="7534244">int</span><span class="op" id="7534247">)</span>&nbsp;<span class="op" id="7534249">[</span><span class="op" id="7534250">]</span><span class="builtintype" id="7534251">byte</span>&nbsp;<span class="op" id="7534256">{</span>&nbsp;<span class="keyword" id="7534258">return</span>&nbsp;<span class="builtinfunc" id="7534265">make</span><span class="op" id="7534269">(</span><span class="op" id="7534270">[</span><span class="op" id="7534271">]</span><span class="builtintype" id="7534272">byte</span><span class="op" id="7534276">,</span>&nbsp;<span class="ident" id="7534278">n</span><span class="op" id="7534279">)</span>&nbsp;<span class="op" id="7534281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534285">c</span><span class="op" id="7534286">,</span>&nbsp;<span class="ident" id="7534288">_</span>&nbsp;<span class="op" id="7534290">:=</span>&nbsp;<span class="ident" id="7534293">NewCipher</span><span class="op" id="7534302">(</span><span class="ident" id="7534303">bytes</span><span class="op" id="7534308">(</span><span class="num" id="7534309">16</span><span class="op" id="7534311">)</span><span class="op" id="7534312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534316">mustPanic</span><span class="op" id="7534325">(</span><span class="ident" id="7534326">t</span><span class="op" id="7534327">,</span>&nbsp;<span class="string" id="7534329">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534363">,</span>&nbsp;<span class="keyword" id="7534365">func</span><span class="op" id="7534369">(</span><span class="op" id="7534370">)</span>&nbsp;<span class="op" id="7534372">{</span>&nbsp;<span class="ident" id="7534374">c</span><span class="op" id="7534375">.</span><span class="ident" id="7534376">Encrypt</span><span class="op" id="7534383">(</span><span class="ident" id="7534384">bytes</span><span class="op" id="7534389">(</span><span class="num" id="7534390">1</span><span class="op" id="7534391">)</span><span class="op" id="7534392">,</span>&nbsp;<span class="ident" id="7534394">bytes</span><span class="op" id="7534399">(</span><span class="num" id="7534400">1</span><span class="op" id="7534401">)</span><span class="op" id="7534402">)</span>&nbsp;<span class="op" id="7534404">}</span><span class="op" id="7534405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534408">mustPanic</span><span class="op" id="7534417">(</span><span class="ident" id="7534418">t</span><span class="op" id="7534419">,</span>&nbsp;<span class="string" id="7534421">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534455">,</span>&nbsp;<span class="keyword" id="7534457">func</span><span class="op" id="7534461">(</span><span class="op" id="7534462">)</span>&nbsp;<span class="op" id="7534464">{</span>&nbsp;<span class="ident" id="7534466">c</span><span class="op" id="7534467">.</span><span class="ident" id="7534468">Decrypt</span><span class="op" id="7534475">(</span><span class="ident" id="7534476">bytes</span><span class="op" id="7534481">(</span><span class="num" id="7534482">1</span><span class="op" id="7534483">)</span><span class="op" id="7534484">,</span>&nbsp;<span class="ident" id="7534486">bytes</span><span class="op" id="7534491">(</span><span class="num" id="7534492">1</span><span class="op" id="7534493">)</span><span class="op" id="7534494">)</span>&nbsp;<span class="op" id="7534496">}</span><span class="op" id="7534497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534500">mustPanic</span><span class="op" id="7534509">(</span><span class="ident" id="7534510">t</span><span class="op" id="7534511">,</span>&nbsp;<span class="string" id="7534513">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534547">,</span>&nbsp;<span class="keyword" id="7534549">func</span><span class="op" id="7534553">(</span><span class="op" id="7534554">)</span>&nbsp;<span class="op" id="7534556">{</span>&nbsp;<span class="ident" id="7534558">c</span><span class="op" id="7534559">.</span><span class="ident" id="7534560">Encrypt</span><span class="op" id="7534567">(</span><span class="ident" id="7534568">bytes</span><span class="op" id="7534573">(</span><span class="num" id="7534574">100</span><span class="op" id="7534577">)</span><span class="op" id="7534578">,</span>&nbsp;<span class="ident" id="7534580">bytes</span><span class="op" id="7534585">(</span><span class="num" id="7534586">1</span><span class="op" id="7534587">)</span><span class="op" id="7534588">)</span>&nbsp;<span class="op" id="7534590">}</span><span class="op" id="7534591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534594">mustPanic</span><span class="op" id="7534603">(</span><span class="ident" id="7534604">t</span><span class="op" id="7534605">,</span>&nbsp;<span class="string" id="7534607">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534641">,</span>&nbsp;<span class="keyword" id="7534643">func</span><span class="op" id="7534647">(</span><span class="op" id="7534648">)</span>&nbsp;<span class="op" id="7534650">{</span>&nbsp;<span class="ident" id="7534652">c</span><span class="op" id="7534653">.</span><span class="ident" id="7534654">Decrypt</span><span class="op" id="7534661">(</span><span class="ident" id="7534662">bytes</span><span class="op" id="7534667">(</span><span class="num" id="7534668">100</span><span class="op" id="7534671">)</span><span class="op" id="7534672">,</span>&nbsp;<span class="ident" id="7534674">bytes</span><span class="op" id="7534679">(</span><span class="num" id="7534680">1</span><span class="op" id="7534681">)</span><span class="op" id="7534682">)</span>&nbsp;<span class="op" id="7534684">}</span><span class="op" id="7534685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534688">mustPanic</span><span class="op" id="7534697">(</span><span class="ident" id="7534698">t</span><span class="op" id="7534699">,</span>&nbsp;<span class="string" id="7534701">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534736">,</span>&nbsp;<span class="keyword" id="7534738">func</span><span class="op" id="7534742">(</span><span class="op" id="7534743">)</span>&nbsp;<span class="op" id="7534745">{</span>&nbsp;<span class="ident" id="7534747">c</span><span class="op" id="7534748">.</span><span class="ident" id="7534749">Encrypt</span><span class="op" id="7534756">(</span><span class="ident" id="7534757">bytes</span><span class="op" id="7534762">(</span><span class="num" id="7534763">1</span><span class="op" id="7534764">)</span><span class="op" id="7534765">,</span>&nbsp;<span class="ident" id="7534767">bytes</span><span class="op" id="7534772">(</span><span class="num" id="7534773">100</span><span class="op" id="7534776">)</span><span class="op" id="7534777">)</span>&nbsp;<span class="op" id="7534779">}</span><span class="op" id="7534780">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534783">mustPanic</span><span class="op" id="7534792">(</span><span class="ident" id="7534793">t</span><span class="op" id="7534794">,</span>&nbsp;<span class="string" id="7534796">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7534831">,</span>&nbsp;<span class="keyword" id="7534833">func</span><span class="op" id="7534837">(</span><span class="op" id="7534838">)</span>&nbsp;<span class="op" id="7534840">{</span>&nbsp;<span class="ident" id="7534842">c</span><span class="op" id="7534843">.</span><span class="ident" id="7534844">Decrypt</span><span class="op" id="7534851">(</span><span class="ident" id="7534852">bytes</span><span class="op" id="7534857">(</span><span class="num" id="7534858">1</span><span class="op" id="7534859">)</span><span class="op" id="7534860">,</span>&nbsp;<span class="ident" id="7534862">bytes</span><span class="op" id="7534867">(</span><span class="num" id="7534868">100</span><span class="op" id="7534871">)</span><span class="op" id="7534872">)</span>&nbsp;<span class="op" id="7534874">}</span><span class="op" id="7534875">)</span><br>
<span class="lineno"></span><span class="op" id="7534877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7534880">func</span>&nbsp;<span class="ident" id="7534885">mustPanic</span><span class="op" id="7534894">(</span><span class="ident" id="7534895">t</span>&nbsp;<span class="op" id="7534897">*</span><span class="ident" id="7534898">testing</span><span class="op" id="7534905">.</span><span class="ident" id="7534906">T</span><span class="op" id="7534907">,</span>&nbsp;<span class="ident" id="7534909">msg</span>&nbsp;<span class="builtintype" id="7534913">string</span><span class="op" id="7534919">,</span>&nbsp;<span class="ident" id="7534921">f</span>&nbsp;<span class="keyword" id="7534923">func</span><span class="op" id="7534927">(</span><span class="op" id="7534928">)</span><span class="op" id="7534929">)</span>&nbsp;<span class="op" id="7534931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534934">defer</span>&nbsp;<span class="keyword" id="7534940">func</span><span class="op" id="7534944">(</span><span class="op" id="7534945">)</span>&nbsp;<span class="op" id="7534947">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534951">err</span>&nbsp;<span class="op" id="7534955">:=</span>&nbsp;<span class="builtinfunc" id="7534958">recover</span><span class="op" id="7534965">(</span><span class="op" id="7534966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534970">if</span>&nbsp;<span class="ident" id="7534973">err</span>&nbsp;<span class="op" id="7534977">==</span>&nbsp;<span class="ident" id="7534980">nil</span>&nbsp;<span class="op" id="7534984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534989">t</span><span class="op" id="7534990">.</span><span class="ident" id="7534991">Errorf</span><span class="op" id="7534997">(</span><span class="string" id="7534998">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7535033">,</span>&nbsp;<span class="ident" id="7535035">msg</span><span class="op" id="7535038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535042">}</span>&nbsp;<span class="keyword" id="7535044">else</span>&nbsp;<span class="keyword" id="7535049">if</span>&nbsp;<span class="ident" id="7535052">err</span>&nbsp;<span class="op" id="7535056">!=</span>&nbsp;<span class="ident" id="7535059">msg</span>&nbsp;<span class="op" id="7535063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535068">t</span><span class="op" id="7535069">.</span><span class="ident" id="7535070">Errorf</span><span class="op" id="7535076">(</span><span class="string" id="7535077">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7535102">,</span>&nbsp;<span class="ident" id="7535104">err</span><span class="op" id="7535107">,</span>&nbsp;<span class="ident" id="7535109">msg</span><span class="op" id="7535112">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535119">}</span><span class="op" id="7535120">(</span><span class="op" id="7535121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535124">f</span><span class="op" id="7535125">(</span><span class="op" id="7535126">)</span><br>
<span class="lineno"></span><span class="op" id="7535128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="7535131">func</span>&nbsp;<span class="ident" id="7535136">BenchmarkEncrypt</span><span class="op" id="7535152">(</span><span class="ident" id="7535153">b</span>&nbsp;<span class="op" id="7535155">*</span><span class="ident" id="7535156">testing</span><span class="op" id="7535163">.</span><span class="ident" id="7535164">B</span><span class="op" id="7535165">)</span>&nbsp;<span class="op" id="7535167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535170">tt</span>&nbsp;<span class="op" id="7535173">:=</span>&nbsp;<span class="ident" id="7535176">encryptTests</span><span class="op" id="7535188">[</span><span class="num" id="7535189">0</span><span class="op" id="7535190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535193">c</span><span class="op" id="7535194">,</span>&nbsp;<span class="ident" id="7535196">err</span>&nbsp;<span class="op" id="7535200">:=</span>&nbsp;<span class="ident" id="7535203">NewCipher</span><span class="op" id="7535212">(</span><span class="ident" id="7535213">tt</span><span class="op" id="7535215">.</span><span class="ident" id="7535216">key</span><span class="op" id="7535219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535222">if</span>&nbsp;<span class="ident" id="7535225">err</span>&nbsp;<span class="op" id="7535229">!=</span>&nbsp;<span class="ident" id="7535232">nil</span>&nbsp;<span class="op" id="7535236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535240">b</span><span class="op" id="7535241">.</span><span class="ident" id="7535242">Fatal</span><span class="op" id="7535247">(</span><span class="string" id="7535248">&#34;NewCipher:&#34;</span><span class="op" id="7535260">,</span>&nbsp;<span class="ident" id="7535262">err</span><span class="op" id="7535265">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535271">out</span>&nbsp;<span class="op" id="7535275">:=</span>&nbsp;<span class="builtinfunc" id="7535278">make</span><span class="op" id="7535282">(</span><span class="op" id="7535283">[</span><span class="op" id="7535284">]</span><span class="builtintype" id="7535285">byte</span><span class="op" id="7535289">,</span>&nbsp;<span class="builtinfunc" id="7535291">len</span><span class="op" id="7535294">(</span><span class="ident" id="7535295">tt</span><span class="op" id="7535297">.</span><span class="ident" id="7535298">in</span><span class="op" id="7535300">)</span><span class="op" id="7535301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535304">b</span><span class="op" id="7535305">.</span><span class="ident" id="7535306">SetBytes</span><span class="op" id="7535314">(</span><span class="ident" id="7535315">int64</span><span class="op" id="7535320">(</span><span class="builtinfunc" id="7535321">len</span><span class="op" id="7535324">(</span><span class="ident" id="7535325">out</span><span class="op" id="7535328">)</span><span class="op" id="7535329">)</span><span class="op" id="7535330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535333">b</span><span class="op" id="7535334">.</span><span class="ident" id="7535335">ResetTimer</span><span class="op" id="7535345">(</span><span class="op" id="7535346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535349">for</span>&nbsp;<span class="ident" id="7535353">i</span>&nbsp;<span class="op" id="7535355">:=</span>&nbsp;<span class="num" id="7535358">0</span><span class="op" id="7535359">;</span>&nbsp;<span class="ident" id="7535361">i</span>&nbsp;<span class="op" id="7535363">&lt;</span>&nbsp;<span class="ident" id="7535365">b</span><span class="op" id="7535366">.</span><span class="ident" id="7535367">N</span><span class="op" id="7535368">;</span>&nbsp;<span class="ident" id="7535370">i</span><span class="op" id="7535371">++</span>&nbsp;<span class="op" id="7535374">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535378">c</span><span class="op" id="7535379">.</span><span class="ident" id="7535380">Encrypt</span><span class="op" id="7535387">(</span><span class="ident" id="7535388">out</span><span class="op" id="7535391">,</span>&nbsp;<span class="ident" id="7535393">tt</span><span class="op" id="7535395">.</span><span class="ident" id="7535396">in</span><span class="op" id="7535398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535401">}</span><br>
<span class="lineno"></span><span class="op" id="7535403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7535406">func</span>&nbsp;<span class="ident" id="7535411">BenchmarkDecrypt</span><span class="op" id="7535427">(</span><span class="ident" id="7535428">b</span>&nbsp;<span class="op" id="7535430">*</span><span class="ident" id="7535431">testing</span><span class="op" id="7535438">.</span><span class="ident" id="7535439">B</span><span class="op" id="7535440">)</span>&nbsp;<span class="op" id="7535442">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535445">tt</span>&nbsp;<span class="op" id="7535448">:=</span>&nbsp;<span class="ident" id="7535451">encryptTests</span><span class="op" id="7535463">[</span><span class="num" id="7535464">0</span><span class="op" id="7535465">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535468">c</span><span class="op" id="7535469">,</span>&nbsp;<span class="ident" id="7535471">err</span>&nbsp;<span class="op" id="7535475">:=</span>&nbsp;<span class="ident" id="7535478">NewCipher</span><span class="op" id="7535487">(</span><span class="ident" id="7535488">tt</span><span class="op" id="7535490">.</span><span class="ident" id="7535491">key</span><span class="op" id="7535494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535497">if</span>&nbsp;<span class="ident" id="7535500">err</span>&nbsp;<span class="op" id="7535504">!=</span>&nbsp;<span class="ident" id="7535507">nil</span>&nbsp;<span class="op" id="7535511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535515">b</span><span class="op" id="7535516">.</span><span class="ident" id="7535517">Fatal</span><span class="op" id="7535522">(</span><span class="string" id="7535523">&#34;NewCipher:&#34;</span><span class="op" id="7535535">,</span>&nbsp;<span class="ident" id="7535537">err</span><span class="op" id="7535540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535543">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535546">out</span>&nbsp;<span class="op" id="7535550">:=</span>&nbsp;<span class="builtinfunc" id="7535553">make</span><span class="op" id="7535557">(</span><span class="op" id="7535558">[</span><span class="op" id="7535559">]</span><span class="builtintype" id="7535560">byte</span><span class="op" id="7535564">,</span>&nbsp;<span class="builtinfunc" id="7535566">len</span><span class="op" id="7535569">(</span><span class="ident" id="7535570">tt</span><span class="op" id="7535572">.</span><span class="ident" id="7535573">out</span><span class="op" id="7535576">)</span><span class="op" id="7535577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535580">b</span><span class="op" id="7535581">.</span><span class="ident" id="7535582">SetBytes</span><span class="op" id="7535590">(</span><span class="ident" id="7535591">int64</span><span class="op" id="7535596">(</span><span class="builtinfunc" id="7535597">len</span><span class="op" id="7535600">(</span><span class="ident" id="7535601">out</span><span class="op" id="7535604">)</span><span class="op" id="7535605">)</span><span class="op" id="7535606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535609">b</span><span class="op" id="7535610">.</span><span class="ident" id="7535611">ResetTimer</span><span class="op" id="7535621">(</span><span class="op" id="7535622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535625">for</span>&nbsp;<span class="ident" id="7535629">i</span>&nbsp;<span class="op" id="7535631">:=</span>&nbsp;<span class="num" id="7535634">0</span><span class="op" id="7535635">;</span>&nbsp;<span class="ident" id="7535637">i</span>&nbsp;<span class="op" id="7535639">&lt;</span>&nbsp;<span class="ident" id="7535641">b</span><span class="op" id="7535642">.</span><span class="ident" id="7535643">N</span><span class="op" id="7535644">;</span>&nbsp;<span class="ident" id="7535646">i</span><span class="op" id="7535647">++</span>&nbsp;<span class="op" id="7535650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535654">c</span><span class="op" id="7535655">.</span><span class="ident" id="7535656">Decrypt</span><span class="op" id="7535663">(</span><span class="ident" id="7535664">out</span><span class="op" id="7535667">,</span>&nbsp;<span class="ident" id="7535669">tt</span><span class="op" id="7535671">.</span><span class="ident" id="7535672">out</span><span class="op" id="7535675">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535678">}</span><br>
<span class="lineno"></span><span class="op" id="7535680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7535683">func</span>&nbsp;<span class="ident" id="7535688">BenchmarkExpand</span><span class="op" id="7535703">(</span><span class="ident" id="7535704">b</span>&nbsp;<span class="op" id="7535706">*</span><span class="ident" id="7535707">testing</span><span class="op" id="7535714">.</span><span class="ident" id="7535715">B</span><span class="op" id="7535716">)</span>&nbsp;<span class="op" id="7535718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535721">tt</span>&nbsp;<span class="op" id="7535724">:=</span>&nbsp;<span class="ident" id="7535727">encryptTests</span><span class="op" id="7535739">[</span><span class="num" id="7535740">0</span><span class="op" id="7535741">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535744">n</span>&nbsp;<span class="op" id="7535746">:=</span>&nbsp;<span class="builtinfunc" id="7535749">len</span><span class="op" id="7535752">(</span><span class="ident" id="7535753">tt</span><span class="op" id="7535755">.</span><span class="ident" id="7535756">key</span><span class="op" id="7535759">)</span>&nbsp;<span class="op" id="7535761">+</span>&nbsp;<span class="num" id="7535763">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535767">c</span>&nbsp;<span class="op" id="7535769">:=</span>&nbsp;<span class="op" id="7535772">&amp;</span><span class="ident" id="7535773">aesCipher</span><span class="op" id="7535782">{</span><span class="builtinfunc" id="7535783">make</span><span class="op" id="7535787">(</span><span class="op" id="7535788">[</span><span class="op" id="7535789">]</span><span class="builtintype" id="7535790">uint32</span><span class="op" id="7535796">,</span>&nbsp;<span class="ident" id="7535798">n</span><span class="op" id="7535799">)</span><span class="op" id="7535800">,</span>&nbsp;<span class="builtinfunc" id="7535802">make</span><span class="op" id="7535806">(</span><span class="op" id="7535807">[</span><span class="op" id="7535808">]</span><span class="builtintype" id="7535809">uint32</span><span class="op" id="7535815">,</span>&nbsp;<span class="ident" id="7535817">n</span><span class="op" id="7535818">)</span><span class="op" id="7535819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535822">b</span><span class="op" id="7535823">.</span><span class="ident" id="7535824">ResetTimer</span><span class="op" id="7535834">(</span><span class="op" id="7535835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535838">for</span>&nbsp;<span class="ident" id="7535842">i</span>&nbsp;<span class="op" id="7535844">:=</span>&nbsp;<span class="num" id="7535847">0</span><span class="op" id="7535848">;</span>&nbsp;<span class="ident" id="7535850">i</span>&nbsp;<span class="op" id="7535852">&lt;</span>&nbsp;<span class="ident" id="7535854">b</span><span class="op" id="7535855">.</span><span class="ident" id="7535856">N</span><span class="op" id="7535857">;</span>&nbsp;<span class="ident" id="7535859">i</span><span class="op" id="7535860">++</span>&nbsp;<span class="op" id="7535863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535867">expandKey</span><span class="op" id="7535876">(</span><span class="ident" id="7535877">tt</span><span class="op" id="7535879">.</span><span class="ident" id="7535880">key</span><span class="op" id="7535883">,</span>&nbsp;<span class="ident" id="7535885">c</span><span class="op" id="7535886">.</span><span class="ident" id="7535887">enc</span><span class="op" id="7535890">,</span>&nbsp;<span class="ident" id="7535892">c</span><span class="op" id="7535893">.</span><span class="ident" id="7535894">dec</span><span class="op" id="7535897">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535900">}</span><br>
<span class="lineno"></span><span class="op" id="7535902">}</span>
</div>
</body>
</html>
