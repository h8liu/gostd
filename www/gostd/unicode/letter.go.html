<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1810944">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1810999">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1811053">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1811104">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1811178">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1811202">package</span>&nbsp;<span class="ident" id="1811210">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1811219">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1811286">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1811352">const</span>&nbsp;<span class="op" id="1811358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1811361">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811377">=</span>&nbsp;<span class="string" id="1811379">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1811392">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1811430">ReplacementChar</span>&nbsp;<span class="op" id="1811446">=</span>&nbsp;<span class="string" id="1811448">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811461">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1811497">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811513">=</span>&nbsp;<span class="string" id="1811515">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811528">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1811553">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811569">=</span>&nbsp;<span class="string" id="1811571">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811584">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1811610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1811613">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1811689">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1811756">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1811829">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1811892">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1811952">type</span>&nbsp;<span class="ident" id="1811957">RangeTable</span>&nbsp;<span class="keyword" id="1811968">struct</span>&nbsp;<span class="op" id="1811975">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1811978">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811990">[</span><span class="op" id="1811991">]</span><span class="ident" id="1811992">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812001">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812013">[</span><span class="op" id="1812014">]</span><span class="ident" id="1812015">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812024">LatinOffset</span>&nbsp;<span class="builtintype" id="1812036">int</span>&nbsp;<span class="comment" id="1812040">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1812089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1812092">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1812186">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1812229">type</span>&nbsp;<span class="ident" id="1812234">Range16</span>&nbsp;<span class="keyword" id="1812242">struct</span>&nbsp;<span class="op" id="1812249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812252">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1812259">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812267">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1812274">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812282">Stride</span>&nbsp;<span class="builtintype" id="1812289">uint16</span><br>
<span class="lineno"></span><span class="op" id="1812296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1812299">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1812379">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1812456">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1812534">type</span>&nbsp;<span class="ident" id="1812539">Range32</span>&nbsp;<span class="keyword" id="1812547">struct</span>&nbsp;<span class="op" id="1812554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812557">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1812564">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812572">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1812579">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1812587">Stride</span>&nbsp;<span class="builtintype" id="1812594">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1812601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1812604">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1812675">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1812725">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1812802">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1812875">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1812949">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1813021">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1813097">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1813141">//&nbsp;&nbsp;&nbsp;&nbsp{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1813181">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1813249">type</span>&nbsp;<span class="ident" id="1813254">CaseRange</span>&nbsp;<span class="keyword" id="1813264">struct</span>&nbsp;<span class="op" id="1813271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813274">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1813280">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813288">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1813294">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813302">Delta</span>&nbsp;<span class="ident" id="1813308">d</span><br>
<span class="lineno"></span><span class="op" id="1813310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1813313">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1813388">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1813463">type</span>&nbsp;<span class="ident" id="1813468">SpecialCase</span>&nbsp;<span class="op" id="1813480">[</span><span class="op" id="1813481">]</span><span class="ident" id="1813482">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1813493">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1813562">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1813629">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1813698">const</span>&nbsp;<span class="op" id="1813704">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813707">UpperCase</span>&nbsp;<span class="op" id="1813717">=</span>&nbsp;<span class="ident" id="1813719">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813725">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813736">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813747">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1813755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1813758">type</span>&nbsp;<span class="ident" id="1813763">d</span>&nbsp;<span class="op" id="1813765">[</span><span class="ident" id="1813766">MaxCase</span><span class="op" id="1813773">]</span><span class="builtintype" id="1813774">rune</span>&nbsp;<span class="comment" id="1813779">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1813819">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1813880">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1813938">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1813966">const</span>&nbsp;<span class="op" id="1813972">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1813975">UpperLower</span>&nbsp;<span class="op" id="1813986">=</span>&nbsp;<span class="ident" id="1813988">MaxRune</span>&nbsp;<span class="op" id="1813996">+</span>&nbsp;<span class="num" id="1813998">1</span>&nbsp;<span class="comment" id="1814000">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1814030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1814033">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1814111">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1814155">const</span>&nbsp;<span class="ident" id="1814161">linearMax</span>&nbsp;<span class="op" id="1814171">=</span>&nbsp;<span class="num" id="1814173">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1814177">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1814244">func</span>&nbsp;<span class="ident" id="1814249">is16</span><span class="op" id="1814253">(</span><span class="ident" id="1814254">ranges</span>&nbsp;<span class="op" id="1814261">[</span><span class="op" id="1814262">]</span><span class="ident" id="1814263">Range16</span><span class="op" id="1814270">,</span>&nbsp;<span class="ident" id="1814272">r</span>&nbsp;<span class="builtintype" id="1814274">uint16</span><span class="op" id="1814280">)</span>&nbsp;<span class="builtintype" id="1814282">bool</span>&nbsp;<span class="op" id="1814287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814290">if</span>&nbsp;<span class="builtinfunc" id="1814293">len</span><span class="op" id="1814296">(</span><span class="ident" id="1814297">ranges</span><span class="op" id="1814303">)</span>&nbsp;<span class="op" id="1814305">&lt;=</span>&nbsp;<span class="ident" id="1814308">linearMax</span>&nbsp;<span class="op" id="1814318">||</span>&nbsp;<span class="ident" id="1814321">r</span>&nbsp;<span class="op" id="1814323">&lt;=</span>&nbsp;<span class="ident" id="1814326">MaxLatin1</span>&nbsp;<span class="op" id="1814336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814340">for</span>&nbsp;<span class="ident" id="1814344">i</span>&nbsp;<span class="op" id="1814346">:=</span>&nbsp;<span class="keyword" id="1814349">range</span>&nbsp;<span class="ident" id="1814355">ranges</span>&nbsp;<span class="op" id="1814362">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814367">range_</span>&nbsp;<span class="op" id="1814374">:=</span>&nbsp;<span class="op" id="1814377">&amp;</span><span class="ident" id="1814378">ranges</span><span class="op" id="1814384">[</span><span class="ident" id="1814385">i</span><span class="op" id="1814386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814391">if</span>&nbsp;<span class="ident" id="1814394">r</span>&nbsp;<span class="op" id="1814396">&lt;</span>&nbsp;<span class="ident" id="1814398">range_</span><span class="op" id="1814404">.</span><span class="ident" id="1814405">Lo</span>&nbsp;<span class="op" id="1814408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814414">return</span>&nbsp;<span class="builtintype" id="1814421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814435">if</span>&nbsp;<span class="ident" id="1814438">r</span>&nbsp;<span class="op" id="1814440">&lt;=</span>&nbsp;<span class="ident" id="1814443">range_</span><span class="op" id="1814449">.</span><span class="ident" id="1814450">Hi</span>&nbsp;<span class="op" id="1814453">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814459">return</span>&nbsp;<span class="op" id="1814466">(</span><span class="ident" id="1814467">r</span><span class="op" id="1814468">-</span><span class="ident" id="1814469">range_</span><span class="op" id="1814475">.</span><span class="ident" id="1814476">Lo</span><span class="op" id="1814478">)</span><span class="op" id="1814479">%</span><span class="ident" id="1814480">range_</span><span class="op" id="1814486">.</span><span class="ident" id="1814487">Stride</span>&nbsp;<span class="op" id="1814494">==</span>&nbsp;<span class="num" id="1814497">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814510">return</span>&nbsp;<span class="builtintype" id="1814517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814524">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1814528">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814558">lo</span>&nbsp;<span class="op" id="1814561">:=</span>&nbsp;<span class="num" id="1814564">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814567">hi</span>&nbsp;<span class="op" id="1814570">:=</span>&nbsp;<span class="builtinfunc" id="1814573">len</span><span class="op" id="1814576">(</span><span class="ident" id="1814577">ranges</span><span class="op" id="1814583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814586">for</span>&nbsp;<span class="ident" id="1814590">lo</span>&nbsp;<span class="op" id="1814593">&lt;</span>&nbsp;<span class="ident" id="1814595">hi</span>&nbsp;<span class="op" id="1814598">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814602">m</span>&nbsp;<span class="op" id="1814604">:=</span>&nbsp;<span class="ident" id="1814607">lo</span>&nbsp;<span class="op" id="1814610">+</span>&nbsp;<span class="op" id="1814612">(</span><span class="ident" id="1814613">hi</span><span class="op" id="1814615">-</span><span class="ident" id="1814616">lo</span><span class="op" id="1814618">)</span><span class="op" id="1814619">/</span><span class="num" id="1814620">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814624">range_</span>&nbsp;<span class="op" id="1814631">:=</span>&nbsp;<span class="op" id="1814634">&amp;</span><span class="ident" id="1814635">ranges</span><span class="op" id="1814641">[</span><span class="ident" id="1814642">m</span><span class="op" id="1814643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814647">if</span>&nbsp;<span class="ident" id="1814650">range_</span><span class="op" id="1814656">.</span><span class="ident" id="1814657">Lo</span>&nbsp;<span class="op" id="1814660">&lt;=</span>&nbsp;<span class="ident" id="1814663">r</span>&nbsp;<span class="op" id="1814665">&amp;&amp;</span>&nbsp;<span class="ident" id="1814668">r</span>&nbsp;<span class="op" id="1814670">&lt;=</span>&nbsp;<span class="ident" id="1814673">range_</span><span class="op" id="1814679">.</span><span class="ident" id="1814680">Hi</span>&nbsp;<span class="op" id="1814683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814688">return</span>&nbsp;<span class="op" id="1814695">(</span><span class="ident" id="1814696">r</span><span class="op" id="1814697">-</span><span class="ident" id="1814698">range_</span><span class="op" id="1814704">.</span><span class="ident" id="1814705">Lo</span><span class="op" id="1814707">)</span><span class="op" id="1814708">%</span><span class="ident" id="1814709">range_</span><span class="op" id="1814715">.</span><span class="ident" id="1814716">Stride</span>&nbsp;<span class="op" id="1814723">==</span>&nbsp;<span class="num" id="1814726">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814730">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814734">if</span>&nbsp;<span class="ident" id="1814737">r</span>&nbsp;<span class="op" id="1814739">&lt;</span>&nbsp;<span class="ident" id="1814741">range_</span><span class="op" id="1814747">.</span><span class="ident" id="1814748">Lo</span>&nbsp;<span class="op" id="1814751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814756">hi</span>&nbsp;<span class="op" id="1814759">=</span>&nbsp;<span class="ident" id="1814761">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814765">}</span>&nbsp;<span class="keyword" id="1814767">else</span>&nbsp;<span class="op" id="1814772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814777">lo</span>&nbsp;<span class="op" id="1814780">=</span>&nbsp;<span class="ident" id="1814782">m</span>&nbsp;<span class="op" id="1814784">+</span>&nbsp;<span class="num" id="1814786">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814790">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1814793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814796">return</span>&nbsp;<span class="builtintype" id="1814803">false</span><br>
<span class="lineno"></span><span class="op" id="1814809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1814812">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1814879">func</span>&nbsp;<span class="ident" id="1814884">is32</span><span class="op" id="1814888">(</span><span class="ident" id="1814889">ranges</span>&nbsp;<span class="op" id="1814896">[</span><span class="op" id="1814897">]</span><span class="ident" id="1814898">Range32</span><span class="op" id="1814905">,</span>&nbsp;<span class="ident" id="1814907">r</span>&nbsp;<span class="builtintype" id="1814909">uint32</span><span class="op" id="1814915">)</span>&nbsp;<span class="builtintype" id="1814917">bool</span>&nbsp;<span class="op" id="1814922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814925">if</span>&nbsp;<span class="builtinfunc" id="1814928">len</span><span class="op" id="1814931">(</span><span class="ident" id="1814932">ranges</span><span class="op" id="1814938">)</span>&nbsp;<span class="op" id="1814940">&lt;=</span>&nbsp;<span class="ident" id="1814943">linearMax</span>&nbsp;<span class="op" id="1814953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1814957">for</span>&nbsp;<span class="ident" id="1814961">i</span>&nbsp;<span class="op" id="1814963">:=</span>&nbsp;<span class="keyword" id="1814966">range</span>&nbsp;<span class="ident" id="1814972">ranges</span>&nbsp;<span class="op" id="1814979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1814984">range_</span>&nbsp;<span class="op" id="1814991">:=</span>&nbsp;<span class="op" id="1814994">&amp;</span><span class="ident" id="1814995">ranges</span><span class="op" id="1815001">[</span><span class="ident" id="1815002">i</span><span class="op" id="1815003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815008">if</span>&nbsp;<span class="ident" id="1815011">r</span>&nbsp;<span class="op" id="1815013">&lt;</span>&nbsp;<span class="ident" id="1815015">range_</span><span class="op" id="1815021">.</span><span class="ident" id="1815022">Lo</span>&nbsp;<span class="op" id="1815025">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815031">return</span>&nbsp;<span class="builtintype" id="1815038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815052">if</span>&nbsp;<span class="ident" id="1815055">r</span>&nbsp;<span class="op" id="1815057">&lt;=</span>&nbsp;<span class="ident" id="1815060">range_</span><span class="op" id="1815066">.</span><span class="ident" id="1815067">Hi</span>&nbsp;<span class="op" id="1815070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815076">return</span>&nbsp;<span class="op" id="1815083">(</span><span class="ident" id="1815084">r</span><span class="op" id="1815085">-</span><span class="ident" id="1815086">range_</span><span class="op" id="1815092">.</span><span class="ident" id="1815093">Lo</span><span class="op" id="1815095">)</span><span class="op" id="1815096">%</span><span class="ident" id="1815097">range_</span><span class="op" id="1815103">.</span><span class="ident" id="1815104">Stride</span>&nbsp;<span class="op" id="1815111">==</span>&nbsp;<span class="num" id="1815114">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815119">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815127">return</span>&nbsp;<span class="builtintype" id="1815134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1815145">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815175">lo</span>&nbsp;<span class="op" id="1815178">:=</span>&nbsp;<span class="num" id="1815181">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815184">hi</span>&nbsp;<span class="op" id="1815187">:=</span>&nbsp;<span class="builtinfunc" id="1815190">len</span><span class="op" id="1815193">(</span><span class="ident" id="1815194">ranges</span><span class="op" id="1815200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815203">for</span>&nbsp;<span class="ident" id="1815207">lo</span>&nbsp;<span class="op" id="1815210">&lt;</span>&nbsp;<span class="ident" id="1815212">hi</span>&nbsp;<span class="op" id="1815215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815219">m</span>&nbsp;<span class="op" id="1815221">:=</span>&nbsp;<span class="ident" id="1815224">lo</span>&nbsp;<span class="op" id="1815227">+</span>&nbsp;<span class="op" id="1815229">(</span><span class="ident" id="1815230">hi</span><span class="op" id="1815232">-</span><span class="ident" id="1815233">lo</span><span class="op" id="1815235">)</span><span class="op" id="1815236">/</span><span class="num" id="1815237">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815241">range_</span>&nbsp;<span class="op" id="1815248">:=</span>&nbsp;<span class="ident" id="1815251">ranges</span><span class="op" id="1815257">[</span><span class="ident" id="1815258">m</span><span class="op" id="1815259">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815263">if</span>&nbsp;<span class="ident" id="1815266">range_</span><span class="op" id="1815272">.</span><span class="ident" id="1815273">Lo</span>&nbsp;<span class="op" id="1815276">&lt;=</span>&nbsp;<span class="ident" id="1815279">r</span>&nbsp;<span class="op" id="1815281">&amp;&amp;</span>&nbsp;<span class="ident" id="1815284">r</span>&nbsp;<span class="op" id="1815286">&lt;=</span>&nbsp;<span class="ident" id="1815289">range_</span><span class="op" id="1815295">.</span><span class="ident" id="1815296">Hi</span>&nbsp;<span class="op" id="1815299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815304">return</span>&nbsp;<span class="op" id="1815311">(</span><span class="ident" id="1815312">r</span><span class="op" id="1815313">-</span><span class="ident" id="1815314">range_</span><span class="op" id="1815320">.</span><span class="ident" id="1815321">Lo</span><span class="op" id="1815323">)</span><span class="op" id="1815324">%</span><span class="ident" id="1815325">range_</span><span class="op" id="1815331">.</span><span class="ident" id="1815332">Stride</span>&nbsp;<span class="op" id="1815339">==</span>&nbsp;<span class="num" id="1815342">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815350">if</span>&nbsp;<span class="ident" id="1815353">r</span>&nbsp;<span class="op" id="1815355">&lt;</span>&nbsp;<span class="ident" id="1815357">range_</span><span class="op" id="1815363">.</span><span class="ident" id="1815364">Lo</span>&nbsp;<span class="op" id="1815367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815372">hi</span>&nbsp;<span class="op" id="1815375">=</span>&nbsp;<span class="ident" id="1815377">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815381">}</span>&nbsp;<span class="keyword" id="1815383">else</span>&nbsp;<span class="op" id="1815388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815393">lo</span>&nbsp;<span class="op" id="1815396">=</span>&nbsp;<span class="ident" id="1815398">m</span>&nbsp;<span class="op" id="1815400">+</span>&nbsp;<span class="num" id="1815402">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815412">return</span>&nbsp;<span class="builtintype" id="1815419">false</span><br>
<span class="lineno">155</span><span class="op" id="1815425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1815428">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1815496">func</span>&nbsp;<span class="ident" id="1815501">Is</span><span class="op" id="1815503">(</span><span class="ident" id="1815504">rangeTab</span>&nbsp;<span class="op" id="1815513">*</span><span class="ident" id="1815514">RangeTable</span><span class="op" id="1815524">,</span>&nbsp;<span class="ident" id="1815526">r</span>&nbsp;<span class="builtintype" id="1815528">rune</span><span class="op" id="1815532">)</span>&nbsp;<span class="builtintype" id="1815534">bool</span>&nbsp;<span class="op" id="1815539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815542">r16</span>&nbsp;<span class="op" id="1815546">:=</span>&nbsp;<span class="ident" id="1815549">rangeTab</span><span class="op" id="1815557">.</span><span class="ident" id="1815558">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815563">if</span>&nbsp;<span class="builtinfunc" id="1815566">len</span><span class="op" id="1815569">(</span><span class="ident" id="1815570">r16</span><span class="op" id="1815573">)</span>&nbsp;<span class="op" id="1815575">&gt;</span>&nbsp;<span class="num" id="1815577">0</span>&nbsp;<span class="op" id="1815579">&amp;&amp;</span>&nbsp;<span class="ident" id="1815582">r</span>&nbsp;<span class="op" id="1815584">&lt;=</span>&nbsp;<span class="builtintype" id="1815587">rune</span><span class="op" id="1815591">(</span><span class="ident" id="1815592">r16</span><span class="op" id="1815595">[</span><span class="builtinfunc" id="1815596">len</span><span class="op" id="1815599">(</span><span class="ident" id="1815600">r16</span><span class="op" id="1815603">)</span><span class="op" id="1815604">-</span><span class="num" id="1815605">1</span><span class="op" id="1815606">]</span><span class="op" id="1815607">.</span><span class="ident" id="1815608">Hi</span><span class="op" id="1815610">)</span>&nbsp;<span class="op" id="1815612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815616">return</span>&nbsp;<span class="ident" id="1815623">is16</span><span class="op" id="1815627">(</span><span class="ident" id="1815628">r16</span><span class="op" id="1815631">,</span>&nbsp;<span class="builtintype" id="1815633">uint16</span><span class="op" id="1815639">(</span><span class="ident" id="1815640">r</span><span class="op" id="1815641">)</span><span class="op" id="1815642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815648">r32</span>&nbsp;<span class="op" id="1815652">:=</span>&nbsp;<span class="ident" id="1815655">rangeTab</span><span class="op" id="1815663">.</span><span class="ident" id="1815664">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815669">if</span>&nbsp;<span class="builtinfunc" id="1815672">len</span><span class="op" id="1815675">(</span><span class="ident" id="1815676">r32</span><span class="op" id="1815679">)</span>&nbsp;<span class="op" id="1815681">&gt;</span>&nbsp;<span class="num" id="1815683">0</span>&nbsp;<span class="op" id="1815685">&amp;&amp;</span>&nbsp;<span class="ident" id="1815688">r</span>&nbsp;<span class="op" id="1815690">&gt;=</span>&nbsp;<span class="builtintype" id="1815693">rune</span><span class="op" id="1815697">(</span><span class="ident" id="1815698">r32</span><span class="op" id="1815701">[</span><span class="num" id="1815702">0</span><span class="op" id="1815703">]</span><span class="op" id="1815704">.</span><span class="ident" id="1815705">Lo</span><span class="op" id="1815707">)</span>&nbsp;<span class="op" id="1815709">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815713">return</span>&nbsp;<span class="ident" id="1815720">is32</span><span class="op" id="1815724">(</span><span class="ident" id="1815725">r32</span><span class="op" id="1815728">,</span>&nbsp;<span class="builtintype" id="1815730">uint32</span><span class="op" id="1815736">(</span><span class="ident" id="1815737">r</span><span class="op" id="1815738">)</span><span class="op" id="1815739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815745">return</span>&nbsp;<span class="builtintype" id="1815752">false</span><br>
<span class="lineno"></span><span class="op" id="1815758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1815761">func</span>&nbsp;<span class="ident" id="1815766">isExcludingLatin</span><span class="op" id="1815782">(</span><span class="ident" id="1815783">rangeTab</span>&nbsp;<span class="op" id="1815792">*</span><span class="ident" id="1815793">RangeTable</span><span class="op" id="1815803">,</span>&nbsp;<span class="ident" id="1815805">r</span>&nbsp;<span class="builtintype" id="1815807">rune</span><span class="op" id="1815811">)</span>&nbsp;<span class="builtintype" id="1815813">bool</span>&nbsp;<span class="op" id="1815818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815821">r16</span>&nbsp;<span class="op" id="1815825">:=</span>&nbsp;<span class="ident" id="1815828">rangeTab</span><span class="op" id="1815836">.</span><span class="ident" id="1815837">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815842">if</span>&nbsp;<span class="ident" id="1815845">off</span>&nbsp;<span class="op" id="1815849">:=</span>&nbsp;<span class="ident" id="1815852">rangeTab</span><span class="op" id="1815860">.</span><span class="ident" id="1815861">LatinOffset</span><span class="op" id="1815872">;</span>&nbsp;<span class="builtinfunc" id="1815874">len</span><span class="op" id="1815877">(</span><span class="ident" id="1815878">r16</span><span class="op" id="1815881">)</span>&nbsp;<span class="op" id="1815883">&gt;</span>&nbsp;<span class="ident" id="1815885">off</span>&nbsp;<span class="op" id="1815889">&amp;&amp;</span>&nbsp;<span class="ident" id="1815892">r</span>&nbsp;<span class="op" id="1815894">&lt;=</span>&nbsp;<span class="builtintype" id="1815897">rune</span><span class="op" id="1815901">(</span><span class="ident" id="1815902">r16</span><span class="op" id="1815905">[</span><span class="builtinfunc" id="1815906">len</span><span class="op" id="1815909">(</span><span class="ident" id="1815910">r16</span><span class="op" id="1815913">)</span><span class="op" id="1815914">-</span><span class="num" id="1815915">1</span><span class="op" id="1815916">]</span><span class="op" id="1815917">.</span><span class="ident" id="1815918">Hi</span><span class="op" id="1815920">)</span>&nbsp;<span class="op" id="1815922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815926">return</span>&nbsp;<span class="ident" id="1815933">is16</span><span class="op" id="1815937">(</span><span class="ident" id="1815938">r16</span><span class="op" id="1815941">[</span><span class="ident" id="1815942">off</span><span class="op" id="1815945">:</span><span class="op" id="1815946">]</span><span class="op" id="1815947">,</span>&nbsp;<span class="builtintype" id="1815949">uint16</span><span class="op" id="1815955">(</span><span class="ident" id="1815956">r</span><span class="op" id="1815957">)</span><span class="op" id="1815958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1815961">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1815964">r32</span>&nbsp;<span class="op" id="1815968">:=</span>&nbsp;<span class="ident" id="1815971">rangeTab</span><span class="op" id="1815979">.</span><span class="ident" id="1815980">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1815985">if</span>&nbsp;<span class="builtinfunc" id="1815988">len</span><span class="op" id="1815991">(</span><span class="ident" id="1815992">r32</span><span class="op" id="1815995">)</span>&nbsp;<span class="op" id="1815997">&gt;</span>&nbsp;<span class="num" id="1815999">0</span>&nbsp;<span class="op" id="1816001">&amp;&amp;</span>&nbsp;<span class="ident" id="1816004">r</span>&nbsp;<span class="op" id="1816006">&gt;=</span>&nbsp;<span class="builtintype" id="1816009">rune</span><span class="op" id="1816013">(</span><span class="ident" id="1816014">r32</span><span class="op" id="1816017">[</span><span class="num" id="1816018">0</span><span class="op" id="1816019">]</span><span class="op" id="1816020">.</span><span class="ident" id="1816021">Lo</span><span class="op" id="1816023">)</span>&nbsp;<span class="op" id="1816025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816029">return</span>&nbsp;<span class="ident" id="1816036">is32</span><span class="op" id="1816040">(</span><span class="ident" id="1816041">r32</span><span class="op" id="1816044">,</span>&nbsp;<span class="builtintype" id="1816046">uint32</span><span class="op" id="1816052">(</span><span class="ident" id="1816053">r</span><span class="op" id="1816054">)</span><span class="op" id="1816055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1816058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816061">return</span>&nbsp;<span class="builtintype" id="1816068">false</span><br>
<span class="lineno">180</span><span class="op" id="1816074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1816077">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1816138">func</span>&nbsp;<span class="ident" id="1816143">IsUpper</span><span class="op" id="1816150">(</span><span class="ident" id="1816151">r</span>&nbsp;<span class="builtintype" id="1816153">rune</span><span class="op" id="1816157">)</span>&nbsp;<span class="builtintype" id="1816159">bool</span>&nbsp;<span class="op" id="1816164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1816167">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816197">if</span>&nbsp;<span class="builtintype" id="1816200">uint32</span><span class="op" id="1816206">(</span><span class="ident" id="1816207">r</span><span class="op" id="1816208">)</span>&nbsp;<span class="op" id="1816210">&lt;=</span>&nbsp;<span class="ident" id="1816213">MaxLatin1</span>&nbsp;<span class="op" id="1816223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816227">return</span>&nbsp;<span class="ident" id="1816234">properties</span><span class="op" id="1816244">[</span><span class="builtintype" id="1816245">uint8</span><span class="op" id="1816250">(</span><span class="ident" id="1816251">r</span><span class="op" id="1816252">)</span><span class="op" id="1816253">]</span><span class="op" id="1816254">&amp;</span><span class="ident" id="1816255">pLmask</span>&nbsp;<span class="op" id="1816262">==</span>&nbsp;<span class="ident" id="1816265">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1816270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816273">return</span>&nbsp;<span class="ident" id="1816280">isExcludingLatin</span><span class="op" id="1816296">(</span><span class="ident" id="1816297">Upper</span><span class="op" id="1816302">,</span>&nbsp;<span class="ident" id="1816304">r</span><span class="op" id="1816305">)</span><br>
<span class="lineno"></span><span class="op" id="1816307">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1816310">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1816370">func</span>&nbsp;<span class="ident" id="1816375">IsLower</span><span class="op" id="1816382">(</span><span class="ident" id="1816383">r</span>&nbsp;<span class="builtintype" id="1816385">rune</span><span class="op" id="1816389">)</span>&nbsp;<span class="builtintype" id="1816391">bool</span>&nbsp;<span class="op" id="1816396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1816399">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816429">if</span>&nbsp;<span class="builtintype" id="1816432">uint32</span><span class="op" id="1816438">(</span><span class="ident" id="1816439">r</span><span class="op" id="1816440">)</span>&nbsp;<span class="op" id="1816442">&lt;=</span>&nbsp;<span class="ident" id="1816445">MaxLatin1</span>&nbsp;<span class="op" id="1816455">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816459">return</span>&nbsp;<span class="ident" id="1816466">properties</span><span class="op" id="1816476">[</span><span class="builtintype" id="1816477">uint8</span><span class="op" id="1816482">(</span><span class="ident" id="1816483">r</span><span class="op" id="1816484">)</span><span class="op" id="1816485">]</span><span class="op" id="1816486">&amp;</span><span class="ident" id="1816487">pLmask</span>&nbsp;<span class="op" id="1816494">==</span>&nbsp;<span class="ident" id="1816497">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1816502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816505">return</span>&nbsp;<span class="ident" id="1816512">isExcludingLatin</span><span class="op" id="1816528">(</span><span class="ident" id="1816529">Lower</span><span class="op" id="1816534">,</span>&nbsp;<span class="ident" id="1816536">r</span><span class="op" id="1816537">)</span><br>
<span class="lineno"></span><span class="op" id="1816539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1816542">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1816602">func</span>&nbsp;<span class="ident" id="1816607">IsTitle</span><span class="op" id="1816614">(</span><span class="ident" id="1816615">r</span>&nbsp;<span class="builtintype" id="1816617">rune</span><span class="op" id="1816621">)</span>&nbsp;<span class="builtintype" id="1816623">bool</span>&nbsp;<span class="op" id="1816628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816631">if</span>&nbsp;<span class="ident" id="1816634">r</span>&nbsp;<span class="op" id="1816636">&lt;=</span>&nbsp;<span class="ident" id="1816639">MaxLatin1</span>&nbsp;<span class="op" id="1816649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816653">return</span>&nbsp;<span class="builtintype" id="1816660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1816667">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816670">return</span>&nbsp;<span class="ident" id="1816677">isExcludingLatin</span><span class="op" id="1816693">(</span><span class="ident" id="1816694">Title</span><span class="op" id="1816699">,</span>&nbsp;<span class="ident" id="1816701">r</span><span class="op" id="1816702">)</span><br>
<span class="lineno"></span><span class="op" id="1816704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1816707">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1816761">func</span>&nbsp;<span class="ident" id="1816766">to</span><span class="op" id="1816768">(</span><span class="ident" id="1816769">_case</span>&nbsp;<span class="builtintype" id="1816775">int</span><span class="op" id="1816778">,</span>&nbsp;<span class="ident" id="1816780">r</span>&nbsp;<span class="builtintype" id="1816782">rune</span><span class="op" id="1816786">,</span>&nbsp;<span class="ident" id="1816788">caseRange</span>&nbsp;<span class="op" id="1816798">[</span><span class="op" id="1816799">]</span><span class="ident" id="1816800">CaseRange</span><span class="op" id="1816809">)</span>&nbsp;<span class="builtintype" id="1816811">rune</span>&nbsp;<span class="op" id="1816816">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816819">if</span>&nbsp;<span class="ident" id="1816822">_case</span>&nbsp;<span class="op" id="1816828">&lt;</span>&nbsp;<span class="num" id="1816830">0</span>&nbsp;<span class="op" id="1816832">||</span>&nbsp;<span class="ident" id="1816835">MaxCase</span>&nbsp;<span class="op" id="1816843">&lt;=</span>&nbsp;<span class="ident" id="1816846">_case</span>&nbsp;<span class="op" id="1816852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816856">return</span>&nbsp;<span class="ident" id="1816863">ReplacementChar</span>&nbsp;<span class="comment" id="1816879">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1816913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1816916">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1816946">lo</span>&nbsp;<span class="op" id="1816949">:=</span>&nbsp;<span class="num" id="1816952">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1816955">hi</span>&nbsp;<span class="op" id="1816958">:=</span>&nbsp;<span class="builtinfunc" id="1816961">len</span><span class="op" id="1816964">(</span><span class="ident" id="1816965">caseRange</span><span class="op" id="1816974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1816977">for</span>&nbsp;<span class="ident" id="1816981">lo</span>&nbsp;<span class="op" id="1816984">&lt;</span>&nbsp;<span class="ident" id="1816986">hi</span>&nbsp;<span class="op" id="1816989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1816993">m</span>&nbsp;<span class="op" id="1816995">:=</span>&nbsp;<span class="ident" id="1816998">lo</span>&nbsp;<span class="op" id="1817001">+</span>&nbsp;<span class="op" id="1817003">(</span><span class="ident" id="1817004">hi</span><span class="op" id="1817006">-</span><span class="ident" id="1817007">lo</span><span class="op" id="1817009">)</span><span class="op" id="1817010">/</span><span class="num" id="1817011">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1817015">cr</span>&nbsp;<span class="op" id="1817018">:=</span>&nbsp;<span class="ident" id="1817021">caseRange</span><span class="op" id="1817030">[</span><span class="ident" id="1817031">m</span><span class="op" id="1817032">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817036">if</span>&nbsp;<span class="builtintype" id="1817039">rune</span><span class="op" id="1817043">(</span><span class="ident" id="1817044">cr</span><span class="op" id="1817046">.</span><span class="ident" id="1817047">Lo</span><span class="op" id="1817049">)</span>&nbsp;<span class="op" id="1817051">&lt;=</span>&nbsp;<span class="ident" id="1817054">r</span>&nbsp;<span class="op" id="1817056">&amp;&amp;</span>&nbsp;<span class="ident" id="1817059">r</span>&nbsp;<span class="op" id="1817061">&lt;=</span>&nbsp;<span class="builtintype" id="1817064">rune</span><span class="op" id="1817068">(</span><span class="ident" id="1817069">cr</span><span class="op" id="1817071">.</span><span class="ident" id="1817072">Hi</span><span class="op" id="1817074">)</span>&nbsp;<span class="op" id="1817076">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1817081">delta</span>&nbsp;<span class="op" id="1817087">:=</span>&nbsp;<span class="builtintype" id="1817090">rune</span><span class="op" id="1817094">(</span><span class="ident" id="1817095">cr</span><span class="op" id="1817097">.</span><span class="ident" id="1817098">Delta</span><span class="op" id="1817103">[</span><span class="ident" id="1817104">_case</span><span class="op" id="1817109">]</span><span class="op" id="1817110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817115">if</span>&nbsp;<span class="ident" id="1817118">delta</span>&nbsp;<span class="op" id="1817124">&gt;</span>&nbsp;<span class="ident" id="1817126">MaxRune</span>&nbsp;<span class="op" id="1817134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817140">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817200">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817262">//&nbsp;&nbsp;&nbsp;&nbsp{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817308">//&nbsp;&nbsp;&nbsp;&nbsp{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817366">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817430">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817497">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817567">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817602">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1817672">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817721">return</span>&nbsp;<span class="builtintype" id="1817728">rune</span><span class="op" id="1817732">(</span><span class="ident" id="1817733">cr</span><span class="op" id="1817735">.</span><span class="ident" id="1817736">Lo</span><span class="op" id="1817738">)</span>&nbsp;<span class="op" id="1817740">+</span>&nbsp;<span class="op" id="1817742">(</span><span class="op" id="1817743">(</span><span class="ident" id="1817744">r</span><span class="op" id="1817745">-</span><span class="builtintype" id="1817746">rune</span><span class="op" id="1817750">(</span><span class="ident" id="1817751">cr</span><span class="op" id="1817753">.</span><span class="ident" id="1817754">Lo</span><span class="op" id="1817756">)</span><span class="op" id="1817757">)</span><span class="op" id="1817758">&amp;^</span><span class="num" id="1817760">1</span>&nbsp;<span class="op" id="1817762">|</span>&nbsp;<span class="builtintype" id="1817764">rune</span><span class="op" id="1817768">(</span><span class="ident" id="1817769">_case</span><span class="op" id="1817774">&amp;</span><span class="num" id="1817775">1</span><span class="op" id="1817776">)</span><span class="op" id="1817777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1817782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817787">return</span>&nbsp;<span class="ident" id="1817794">r</span>&nbsp;<span class="op" id="1817796">+</span>&nbsp;<span class="ident" id="1817798">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1817806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817810">if</span>&nbsp;<span class="ident" id="1817813">r</span>&nbsp;<span class="op" id="1817815">&lt;</span>&nbsp;<span class="builtintype" id="1817817">rune</span><span class="op" id="1817821">(</span><span class="ident" id="1817822">cr</span><span class="op" id="1817824">.</span><span class="ident" id="1817825">Lo</span><span class="op" id="1817827">)</span>&nbsp;<span class="op" id="1817829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1817834">hi</span>&nbsp;<span class="op" id="1817837">=</span>&nbsp;<span class="ident" id="1817839">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1817843">}</span>&nbsp;<span class="keyword" id="1817845">else</span>&nbsp;<span class="op" id="1817850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1817855">lo</span>&nbsp;<span class="op" id="1817858">=</span>&nbsp;<span class="ident" id="1817860">m</span>&nbsp;<span class="op" id="1817862">+</span>&nbsp;<span class="num" id="1817864">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1817868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1817871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1817874">return</span>&nbsp;<span class="ident" id="1817881">r</span><br>
<span class="lineno"></span><span class="op" id="1817883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1817886">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1817965">func</span>&nbsp;<span class="ident" id="1817970">To</span><span class="op" id="1817972">(</span><span class="ident" id="1817973">_case</span>&nbsp;<span class="builtintype" id="1817979">int</span><span class="op" id="1817982">,</span>&nbsp;<span class="ident" id="1817984">r</span>&nbsp;<span class="builtintype" id="1817986">rune</span><span class="op" id="1817990">)</span>&nbsp;<span class="builtintype" id="1817992">rune</span>&nbsp;<span class="op" id="1817997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818000">return</span>&nbsp;<span class="ident" id="1818007">to</span><span class="op" id="1818009">(</span><span class="ident" id="1818010">_case</span><span class="op" id="1818015">,</span>&nbsp;<span class="ident" id="1818017">r</span><span class="op" id="1818018">,</span>&nbsp;<span class="ident" id="1818020">CaseRanges</span><span class="op" id="1818030">)</span><br>
<span class="lineno"></span><span class="op" id="1818032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1818035">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1818075">func</span>&nbsp;<span class="ident" id="1818080">ToUpper</span><span class="op" id="1818087">(</span><span class="ident" id="1818088">r</span>&nbsp;<span class="builtintype" id="1818090">rune</span><span class="op" id="1818094">)</span>&nbsp;<span class="builtintype" id="1818096">rune</span>&nbsp;<span class="op" id="1818101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818104">if</span>&nbsp;<span class="ident" id="1818107">r</span>&nbsp;<span class="op" id="1818109">&lt;=</span>&nbsp;<span class="ident" id="1818112">MaxASCII</span>&nbsp;<span class="op" id="1818121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818125">if</span>&nbsp;<span class="string" id="1818128">&#39;a&#39;</span>&nbsp;<span class="op" id="1818132">&lt;=</span>&nbsp;<span class="ident" id="1818135">r</span>&nbsp;<span class="op" id="1818137">&amp;&amp;</span>&nbsp;<span class="ident" id="1818140">r</span>&nbsp;<span class="op" id="1818142">&lt;=</span>&nbsp;<span class="string" id="1818145">&#39;z&#39;</span>&nbsp;<span class="op" id="1818149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818154">r</span>&nbsp;<span class="op" id="1818156">-=</span>&nbsp;<span class="string" id="1818159">&#39;a&#39;</span>&nbsp;<span class="op" id="1818163">-</span>&nbsp;<span class="string" id="1818165">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818175">return</span>&nbsp;<span class="ident" id="1818182">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818188">return</span>&nbsp;<span class="ident" id="1818195">To</span><span class="op" id="1818197">(</span><span class="ident" id="1818198">UpperCase</span><span class="op" id="1818207">,</span>&nbsp;<span class="ident" id="1818209">r</span><span class="op" id="1818210">)</span><br>
<span class="lineno"></span><span class="op" id="1818212">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1818215">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1818255">func</span>&nbsp;<span class="ident" id="1818260">ToLower</span><span class="op" id="1818267">(</span><span class="ident" id="1818268">r</span>&nbsp;<span class="builtintype" id="1818270">rune</span><span class="op" id="1818274">)</span>&nbsp;<span class="builtintype" id="1818276">rune</span>&nbsp;<span class="op" id="1818281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818284">if</span>&nbsp;<span class="ident" id="1818287">r</span>&nbsp;<span class="op" id="1818289">&lt;=</span>&nbsp;<span class="ident" id="1818292">MaxASCII</span>&nbsp;<span class="op" id="1818301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818305">if</span>&nbsp;<span class="string" id="1818308">&#39;A&#39;</span>&nbsp;<span class="op" id="1818312">&lt;=</span>&nbsp;<span class="ident" id="1818315">r</span>&nbsp;<span class="op" id="1818317">&amp;&amp;</span>&nbsp;<span class="ident" id="1818320">r</span>&nbsp;<span class="op" id="1818322">&lt;=</span>&nbsp;<span class="string" id="1818325">&#39;Z&#39;</span>&nbsp;<span class="op" id="1818329">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818334">r</span>&nbsp;<span class="op" id="1818336">+=</span>&nbsp;<span class="string" id="1818339">&#39;a&#39;</span>&nbsp;<span class="op" id="1818343">-</span>&nbsp;<span class="string" id="1818345">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818355">return</span>&nbsp;<span class="ident" id="1818362">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818368">return</span>&nbsp;<span class="ident" id="1818375">To</span><span class="op" id="1818377">(</span><span class="ident" id="1818378">LowerCase</span><span class="op" id="1818387">,</span>&nbsp;<span class="ident" id="1818389">r</span><span class="op" id="1818390">)</span><br>
<span class="lineno">270</span><span class="op" id="1818392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1818395">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1818435">func</span>&nbsp;<span class="ident" id="1818440">ToTitle</span><span class="op" id="1818447">(</span><span class="ident" id="1818448">r</span>&nbsp;<span class="builtintype" id="1818450">rune</span><span class="op" id="1818454">)</span>&nbsp;<span class="builtintype" id="1818456">rune</span>&nbsp;<span class="op" id="1818461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818464">if</span>&nbsp;<span class="ident" id="1818467">r</span>&nbsp;<span class="op" id="1818469">&lt;=</span>&nbsp;<span class="ident" id="1818472">MaxASCII</span>&nbsp;<span class="op" id="1818481">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818485">if</span>&nbsp;<span class="string" id="1818488">&#39;a&#39;</span>&nbsp;<span class="op" id="1818492">&lt;=</span>&nbsp;<span class="ident" id="1818495">r</span>&nbsp;<span class="op" id="1818497">&amp;&amp;</span>&nbsp;<span class="ident" id="1818500">r</span>&nbsp;<span class="op" id="1818502">&lt;=</span>&nbsp;<span class="string" id="1818505">&#39;z&#39;</span>&nbsp;<span class="op" id="1818509">{</span>&nbsp;<span class="comment" id="1818511">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818552">r</span>&nbsp;<span class="op" id="1818554">-=</span>&nbsp;<span class="string" id="1818557">&#39;a&#39;</span>&nbsp;<span class="op" id="1818561">-</span>&nbsp;<span class="string" id="1818563">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818573">return</span>&nbsp;<span class="ident" id="1818580">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818583">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818586">return</span>&nbsp;<span class="ident" id="1818593">To</span><span class="op" id="1818595">(</span><span class="ident" id="1818596">TitleCase</span><span class="op" id="1818605">,</span>&nbsp;<span class="ident" id="1818607">r</span><span class="op" id="1818608">)</span><br>
<span class="lineno"></span><span class="op" id="1818610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1818613">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1818692">func</span>&nbsp;<span class="op" id="1818697">(</span><span class="ident" id="1818698">special</span>&nbsp;<span class="ident" id="1818706">SpecialCase</span><span class="op" id="1818717">)</span>&nbsp;<span class="ident" id="1818719">ToUpper</span><span class="op" id="1818726">(</span><span class="ident" id="1818727">r</span>&nbsp;<span class="builtintype" id="1818729">rune</span><span class="op" id="1818733">)</span>&nbsp;<span class="builtintype" id="1818735">rune</span>&nbsp;<span class="op" id="1818740">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818743">r1</span>&nbsp;<span class="op" id="1818746">:=</span>&nbsp;<span class="ident" id="1818749">to</span><span class="op" id="1818751">(</span><span class="ident" id="1818752">UpperCase</span><span class="op" id="1818761">,</span>&nbsp;<span class="ident" id="1818763">r</span><span class="op" id="1818764">,</span>&nbsp;<span class="op" id="1818766">[</span><span class="op" id="1818767">]</span><span class="ident" id="1818768">CaseRange</span><span class="op" id="1818777">(</span><span class="ident" id="1818778">special</span><span class="op" id="1818785">)</span><span class="op" id="1818786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818789">if</span>&nbsp;<span class="ident" id="1818792">r1</span>&nbsp;<span class="op" id="1818795">==</span>&nbsp;<span class="ident" id="1818798">r</span>&nbsp;<span class="op" id="1818800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818804">r1</span>&nbsp;<span class="op" id="1818807">=</span>&nbsp;<span class="ident" id="1818809">ToUpper</span><span class="op" id="1818816">(</span><span class="ident" id="1818817">r</span><span class="op" id="1818818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1818821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1818824">return</span>&nbsp;<span class="ident" id="1818831">r1</span><br>
<span class="lineno">290</span><span class="op" id="1818834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1818837">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1818916">func</span>&nbsp;<span class="op" id="1818921">(</span><span class="ident" id="1818922">special</span>&nbsp;<span class="ident" id="1818930">SpecialCase</span><span class="op" id="1818941">)</span>&nbsp;<span class="ident" id="1818943">ToTitle</span><span class="op" id="1818950">(</span><span class="ident" id="1818951">r</span>&nbsp;<span class="builtintype" id="1818953">rune</span><span class="op" id="1818957">)</span>&nbsp;<span class="builtintype" id="1818959">rune</span>&nbsp;<span class="op" id="1818964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818967">r1</span>&nbsp;<span class="op" id="1818970">:=</span>&nbsp;<span class="ident" id="1818973">to</span><span class="op" id="1818975">(</span><span class="ident" id="1818976">TitleCase</span><span class="op" id="1818985">,</span>&nbsp;<span class="ident" id="1818987">r</span><span class="op" id="1818988">,</span>&nbsp;<span class="op" id="1818990">[</span><span class="op" id="1818991">]</span><span class="ident" id="1818992">CaseRange</span><span class="op" id="1819001">(</span><span class="ident" id="1819002">special</span><span class="op" id="1819009">)</span><span class="op" id="1819010">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1819013">if</span>&nbsp;<span class="ident" id="1819016">r1</span>&nbsp;<span class="op" id="1819019">==</span>&nbsp;<span class="ident" id="1819022">r</span>&nbsp;<span class="op" id="1819024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819028">r1</span>&nbsp;<span class="op" id="1819031">=</span>&nbsp;<span class="ident" id="1819033">ToTitle</span><span class="op" id="1819040">(</span><span class="ident" id="1819041">r</span><span class="op" id="1819042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1819045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1819048">return</span>&nbsp;<span class="ident" id="1819055">r1</span><br>
<span class="lineno"></span><span class="op" id="1819058">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1819061">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1819140">func</span>&nbsp;<span class="op" id="1819145">(</span><span class="ident" id="1819146">special</span>&nbsp;<span class="ident" id="1819154">SpecialCase</span><span class="op" id="1819165">)</span>&nbsp;<span class="ident" id="1819167">ToLower</span><span class="op" id="1819174">(</span><span class="ident" id="1819175">r</span>&nbsp;<span class="builtintype" id="1819177">rune</span><span class="op" id="1819181">)</span>&nbsp;<span class="builtintype" id="1819183">rune</span>&nbsp;<span class="op" id="1819188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819191">r1</span>&nbsp;<span class="op" id="1819194">:=</span>&nbsp;<span class="ident" id="1819197">to</span><span class="op" id="1819199">(</span><span class="ident" id="1819200">LowerCase</span><span class="op" id="1819209">,</span>&nbsp;<span class="ident" id="1819211">r</span><span class="op" id="1819212">,</span>&nbsp;<span class="op" id="1819214">[</span><span class="op" id="1819215">]</span><span class="ident" id="1819216">CaseRange</span><span class="op" id="1819225">(</span><span class="ident" id="1819226">special</span><span class="op" id="1819233">)</span><span class="op" id="1819234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1819237">if</span>&nbsp;<span class="ident" id="1819240">r1</span>&nbsp;<span class="op" id="1819243">==</span>&nbsp;<span class="ident" id="1819246">r</span>&nbsp;<span class="op" id="1819248">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819252">r1</span>&nbsp;<span class="op" id="1819255">=</span>&nbsp;<span class="ident" id="1819257">ToLower</span><span class="op" id="1819264">(</span><span class="ident" id="1819265">r</span><span class="op" id="1819266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1819269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1819272">return</span>&nbsp;<span class="ident" id="1819279">r1</span><br>
<span class="lineno"></span><span class="op" id="1819282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1819285">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1819356">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1819427">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1819504">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1819548">type</span>&nbsp;<span class="ident" id="1819553">foldPair</span>&nbsp;<span class="keyword" id="1819562">struct</span>&nbsp;<span class="op" id="1819569">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819572">From</span>&nbsp;<span class="builtintype" id="1819577">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819585">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1819590">uint16</span><br>
<span class="lineno"></span><span class="op" id="1819597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1819600">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1819665">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1819732">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1819802">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1819870">//</span><br>
<span class="lineno"></span><span class="comment" id="1819873">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1819889">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1819914">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1819939">//</span><br>
<span class="lineno"></span><span class="comment" id="1819942">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1819967">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;)</span><br>
<span class="lineno">330</span><span class="comment" id="1820018">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1820048">//</span><br>
<span class="lineno"></span><span class="comment" id="1820051">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1820076">//</span><br>
<span class="lineno"></span><span class="keyword" id="1820079">func</span>&nbsp;<span class="ident" id="1820084">SimpleFold</span><span class="op" id="1820094">(</span><span class="ident" id="1820095">r</span>&nbsp;<span class="builtintype" id="1820097">rune</span><span class="op" id="1820101">)</span>&nbsp;<span class="builtintype" id="1820103">rune</span>&nbsp;<span class="op" id="1820108">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1820111">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820158">lo</span>&nbsp;<span class="op" id="1820161">:=</span>&nbsp;<span class="num" id="1820164">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820167">hi</span>&nbsp;<span class="op" id="1820170">:=</span>&nbsp;<span class="builtinfunc" id="1820173">len</span><span class="op" id="1820176">(</span><span class="ident" id="1820177">caseOrbit</span><span class="op" id="1820186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820189">for</span>&nbsp;<span class="ident" id="1820193">lo</span>&nbsp;<span class="op" id="1820196">&lt;</span>&nbsp;<span class="ident" id="1820198">hi</span>&nbsp;<span class="op" id="1820201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820205">m</span>&nbsp;<span class="op" id="1820207">:=</span>&nbsp;<span class="ident" id="1820210">lo</span>&nbsp;<span class="op" id="1820213">+</span>&nbsp;<span class="op" id="1820215">(</span><span class="ident" id="1820216">hi</span><span class="op" id="1820218">-</span><span class="ident" id="1820219">lo</span><span class="op" id="1820221">)</span><span class="op" id="1820222">/</span><span class="num" id="1820223">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820227">if</span>&nbsp;<span class="builtintype" id="1820230">rune</span><span class="op" id="1820234">(</span><span class="ident" id="1820235">caseOrbit</span><span class="op" id="1820244">[</span><span class="ident" id="1820245">m</span><span class="op" id="1820246">]</span><span class="op" id="1820247">.</span><span class="ident" id="1820248">From</span><span class="op" id="1820252">)</span>&nbsp;<span class="op" id="1820254">&lt;</span>&nbsp;<span class="ident" id="1820256">r</span>&nbsp;<span class="op" id="1820258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820263">lo</span>&nbsp;<span class="op" id="1820266">=</span>&nbsp;<span class="ident" id="1820268">m</span>&nbsp;<span class="op" id="1820270">+</span>&nbsp;<span class="num" id="1820272">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1820276">}</span>&nbsp;<span class="keyword" id="1820278">else</span>&nbsp;<span class="op" id="1820283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820288">hi</span>&nbsp;<span class="op" id="1820291">=</span>&nbsp;<span class="ident" id="1820293">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1820297">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1820300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820303">if</span>&nbsp;<span class="ident" id="1820306">lo</span>&nbsp;<span class="op" id="1820309">&lt;</span>&nbsp;<span class="builtinfunc" id="1820311">len</span><span class="op" id="1820314">(</span><span class="ident" id="1820315">caseOrbit</span><span class="op" id="1820324">)</span>&nbsp;<span class="op" id="1820326">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1820329">rune</span><span class="op" id="1820333">(</span><span class="ident" id="1820334">caseOrbit</span><span class="op" id="1820343">[</span><span class="ident" id="1820344">lo</span><span class="op" id="1820346">]</span><span class="op" id="1820347">.</span><span class="ident" id="1820348">From</span><span class="op" id="1820352">)</span>&nbsp;<span class="op" id="1820354">==</span>&nbsp;<span class="ident" id="1820357">r</span>&nbsp;<span class="op" id="1820359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820363">return</span>&nbsp;<span class="builtintype" id="1820370">rune</span><span class="op" id="1820374">(</span><span class="ident" id="1820375">caseOrbit</span><span class="op" id="1820384">[</span><span class="ident" id="1820385">lo</span><span class="op" id="1820387">]</span><span class="op" id="1820388">.</span><span class="ident" id="1820389">To</span><span class="op" id="1820391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1820394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1820398">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1820455">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1820511">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820566">if</span>&nbsp;<span class="ident" id="1820569">l</span>&nbsp;<span class="op" id="1820571">:=</span>&nbsp;<span class="ident" id="1820574">ToLower</span><span class="op" id="1820581">(</span><span class="ident" id="1820582">r</span><span class="op" id="1820583">)</span><span class="op" id="1820584">;</span>&nbsp;<span class="ident" id="1820586">l</span>&nbsp;<span class="op" id="1820588">!=</span>&nbsp;<span class="ident" id="1820591">r</span>&nbsp;<span class="op" id="1820593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820597">return</span>&nbsp;<span class="ident" id="1820604">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1820607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1820610">return</span>&nbsp;<span class="ident" id="1820617">ToUpper</span><span class="op" id="1820624">(</span><span class="ident" id="1820625">r</span><span class="op" id="1820626">)</span><br>
<span class="lineno"></span><span class="op" id="1820628">}</span>
</div>
</body>
</html>
