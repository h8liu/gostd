<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5166995">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5167050">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5167104">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5167155">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5167231">package</span>&nbsp;<span class="ident" id="5167239">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5167247">import</span>&nbsp;<span class="op" id="5167254">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5167257">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5167267">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5167272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5167275">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5167325">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5167376">func</span>&nbsp;<span class="ident" id="5167381">OneByteReader</span><span class="op" id="5167394">(</span><span class="ident" id="5167395">r</span>&nbsp;<span class="ident" id="5167397">io</span><span class="op" id="5167399">.</span><span class="ident" id="5167400">Reader</span><span class="op" id="5167406">)</span>&nbsp;<span class="ident" id="5167408">io</span><span class="op" id="5167410">.</span><span class="ident" id="5167411">Reader</span>&nbsp;<span class="op" id="5167418">{</span>&nbsp;<span class="keyword" id="5167420">return</span>&nbsp;<span class="op" id="5167427">&amp;</span><span class="ident" id="5167428">oneByteReader</span><span class="op" id="5167441">{</span><span class="ident" id="5167442">r</span><span class="op" id="5167443">}</span>&nbsp;<span class="op" id="5167445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5167448">type</span>&nbsp;<span class="ident" id="5167453">oneByteReader</span>&nbsp;<span class="keyword" id="5167467">struct</span>&nbsp;<span class="op" id="5167474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167477">r</span>&nbsp;<span class="ident" id="5167479">io</span><span class="op" id="5167481">.</span><span class="ident" id="5167482">Reader</span><br>
<span class="lineno"></span><span class="op" id="5167489">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5167492">func</span>&nbsp;<span class="op" id="5167497">(</span><span class="ident" id="5167498">r</span>&nbsp;<span class="op" id="5167500">*</span><span class="ident" id="5167501">oneByteReader</span><span class="op" id="5167514">)</span>&nbsp;<span class="ident" id="5167516">Read</span><span class="op" id="5167520">(</span><span class="ident" id="5167521">p</span>&nbsp;<span class="op" id="5167523">[</span><span class="op" id="5167524">]</span><span class="builtintype" id="5167525">byte</span><span class="op" id="5167529">)</span>&nbsp;<span class="op" id="5167531">(</span><span class="builtintype" id="5167532">int</span><span class="op" id="5167535">,</span>&nbsp;<span class="builtintype" id="5167537">error</span><span class="op" id="5167542">)</span>&nbsp;<span class="op" id="5167544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167547">if</span>&nbsp;<span class="builtinfunc" id="5167550">len</span><span class="op" id="5167553">(</span><span class="ident" id="5167554">p</span><span class="op" id="5167555">)</span>&nbsp;<span class="op" id="5167557">==</span>&nbsp;<span class="num" id="5167560">0</span>&nbsp;<span class="op" id="5167562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167566">return</span>&nbsp;<span class="num" id="5167573">0</span><span class="op" id="5167574">,</span>&nbsp;<span class="ident" id="5167576">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167581">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167584">return</span>&nbsp;<span class="ident" id="5167591">r</span><span class="op" id="5167592">.</span><span class="ident" id="5167593">r</span><span class="op" id="5167594">.</span><span class="ident" id="5167595">Read</span><span class="op" id="5167599">(</span><span class="ident" id="5167600">p</span><span class="op" id="5167601">[</span><span class="num" id="5167602">0</span><span class="op" id="5167603">:</span><span class="num" id="5167604">1</span><span class="op" id="5167605">]</span><span class="op" id="5167606">)</span><br>
<span class="lineno"></span><span class="op" id="5167608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5167611">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5167663">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5167714">func</span>&nbsp;<span class="ident" id="5167719">HalfReader</span><span class="op" id="5167729">(</span><span class="ident" id="5167730">r</span>&nbsp;<span class="ident" id="5167732">io</span><span class="op" id="5167734">.</span><span class="ident" id="5167735">Reader</span><span class="op" id="5167741">)</span>&nbsp;<span class="ident" id="5167743">io</span><span class="op" id="5167745">.</span><span class="ident" id="5167746">Reader</span>&nbsp;<span class="op" id="5167753">{</span>&nbsp;<span class="keyword" id="5167755">return</span>&nbsp;<span class="op" id="5167762">&amp;</span><span class="ident" id="5167763">halfReader</span><span class="op" id="5167773">{</span><span class="ident" id="5167774">r</span><span class="op" id="5167775">}</span>&nbsp;<span class="op" id="5167777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5167780">type</span>&nbsp;<span class="ident" id="5167785">halfReader</span>&nbsp;<span class="keyword" id="5167796">struct</span>&nbsp;<span class="op" id="5167803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167806">r</span>&nbsp;<span class="ident" id="5167808">io</span><span class="op" id="5167810">.</span><span class="ident" id="5167811">Reader</span><br>
<span class="lineno"></span><span class="op" id="5167818">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5167821">func</span>&nbsp;<span class="op" id="5167826">(</span><span class="ident" id="5167827">r</span>&nbsp;<span class="op" id="5167829">*</span><span class="ident" id="5167830">halfReader</span><span class="op" id="5167840">)</span>&nbsp;<span class="ident" id="5167842">Read</span><span class="op" id="5167846">(</span><span class="ident" id="5167847">p</span>&nbsp;<span class="op" id="5167849">[</span><span class="op" id="5167850">]</span><span class="builtintype" id="5167851">byte</span><span class="op" id="5167855">)</span>&nbsp;<span class="op" id="5167857">(</span><span class="builtintype" id="5167858">int</span><span class="op" id="5167861">,</span>&nbsp;<span class="builtintype" id="5167863">error</span><span class="op" id="5167868">)</span>&nbsp;<span class="op" id="5167870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167873">return</span>&nbsp;<span class="ident" id="5167880">r</span><span class="op" id="5167881">.</span><span class="ident" id="5167882">r</span><span class="op" id="5167883">.</span><span class="ident" id="5167884">Read</span><span class="op" id="5167888">(</span><span class="ident" id="5167889">p</span><span class="op" id="5167890">[</span><span class="num" id="5167891">0</span>&nbsp;<span class="op" id="5167893">:</span>&nbsp;<span class="op" id="5167895">(</span><span class="builtinfunc" id="5167896">len</span><span class="op" id="5167899">(</span><span class="ident" id="5167900">p</span><span class="op" id="5167901">)</span><span class="op" id="5167902">+</span><span class="num" id="5167903">1</span><span class="op" id="5167904">)</span><span class="op" id="5167905">/</span><span class="num" id="5167906">2</span><span class="op" id="5167907">]</span><span class="op" id="5167908">)</span><br>
<span class="lineno"></span><span class="op" id="5167910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5167913">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5167990">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5168068">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5168144">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5168222">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5168268">func</span>&nbsp;<span class="ident" id="5168273">DataErrReader</span><span class="op" id="5168286">(</span><span class="ident" id="5168287">r</span>&nbsp;<span class="ident" id="5168289">io</span><span class="op" id="5168291">.</span><span class="ident" id="5168292">Reader</span><span class="op" id="5168298">)</span>&nbsp;<span class="ident" id="5168300">io</span><span class="op" id="5168302">.</span><span class="ident" id="5168303">Reader</span>&nbsp;<span class="op" id="5168310">{</span>&nbsp;<span class="keyword" id="5168312">return</span>&nbsp;<span class="op" id="5168319">&amp;</span><span class="ident" id="5168320">dataErrReader</span><span class="op" id="5168333">{</span><span class="ident" id="5168334">r</span><span class="op" id="5168335">,</span>&nbsp;<span class="ident" id="5168337">nil</span><span class="op" id="5168340">,</span>&nbsp;<span class="builtinfunc" id="5168342">make</span><span class="op" id="5168346">(</span><span class="op" id="5168347">[</span><span class="op" id="5168348">]</span><span class="builtintype" id="5168349">byte</span><span class="op" id="5168353">,</span>&nbsp;<span class="num" id="5168355">1024</span><span class="op" id="5168359">)</span><span class="op" id="5168360">}</span>&nbsp;<span class="op" id="5168362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5168365">type</span>&nbsp;<span class="ident" id="5168370">dataErrReader</span>&nbsp;<span class="keyword" id="5168384">struct</span>&nbsp;<span class="op" id="5168391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168394">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5168401">io</span><span class="op" id="5168403">.</span><span class="ident" id="5168404">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168412">unread</span>&nbsp;<span class="op" id="5168419">[</span><span class="op" id="5168420">]</span><span class="builtintype" id="5168421">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168427">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5168434">[</span><span class="op" id="5168435">]</span><span class="builtintype" id="5168436">byte</span><br>
<span class="lineno"></span><span class="op" id="5168441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5168444">func</span>&nbsp;<span class="op" id="5168449">(</span><span class="ident" id="5168450">r</span>&nbsp;<span class="op" id="5168452">*</span><span class="ident" id="5168453">dataErrReader</span><span class="op" id="5168466">)</span>&nbsp;<span class="ident" id="5168468">Read</span><span class="op" id="5168472">(</span><span class="ident" id="5168473">p</span>&nbsp;<span class="op" id="5168475">[</span><span class="op" id="5168476">]</span><span class="builtintype" id="5168477">byte</span><span class="op" id="5168481">)</span>&nbsp;<span class="op" id="5168483">(</span><span class="ident" id="5168484">n</span>&nbsp;<span class="builtintype" id="5168486">int</span><span class="op" id="5168489">,</span>&nbsp;<span class="ident" id="5168491">err</span>&nbsp;<span class="builtintype" id="5168495">error</span><span class="op" id="5168500">)</span>&nbsp;<span class="op" id="5168502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168505">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168550">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168605">for</span>&nbsp;<span class="op" id="5168609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168613">if</span>&nbsp;<span class="builtinfunc" id="5168616">len</span><span class="op" id="5168619">(</span><span class="ident" id="5168620">r</span><span class="op" id="5168621">.</span><span class="ident" id="5168622">unread</span><span class="op" id="5168628">)</span>&nbsp;<span class="op" id="5168630">==</span>&nbsp;<span class="num" id="5168633">0</span>&nbsp;<span class="op" id="5168635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168640">n1</span><span class="op" id="5168642">,</span>&nbsp;<span class="ident" id="5168644">err1</span>&nbsp;<span class="op" id="5168649">:=</span>&nbsp;<span class="ident" id="5168652">r</span><span class="op" id="5168653">.</span><span class="ident" id="5168654">r</span><span class="op" id="5168655">.</span><span class="ident" id="5168656">Read</span><span class="op" id="5168660">(</span><span class="ident" id="5168661">r</span><span class="op" id="5168662">.</span><span class="ident" id="5168663">data</span><span class="op" id="5168667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168672">r</span><span class="op" id="5168673">.</span><span class="ident" id="5168674">unread</span>&nbsp;<span class="op" id="5168681">=</span>&nbsp;<span class="ident" id="5168683">r</span><span class="op" id="5168684">.</span><span class="ident" id="5168685">data</span><span class="op" id="5168689">[</span><span class="num" id="5168690">0</span><span class="op" id="5168691">:</span><span class="ident" id="5168692">n1</span><span class="op" id="5168694">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168699">err</span>&nbsp;<span class="op" id="5168703">=</span>&nbsp;<span class="ident" id="5168705">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168716">if</span>&nbsp;<span class="ident" id="5168719">n</span>&nbsp;<span class="op" id="5168721">&gt;</span>&nbsp;<span class="num" id="5168723">0</span>&nbsp;<span class="op" id="5168725">||</span>&nbsp;<span class="ident" id="5168728">err</span>&nbsp;<span class="op" id="5168732">!=</span>&nbsp;<span class="ident" id="5168735">nil</span>&nbsp;<span class="op" id="5168739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168744">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168752">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168756">n</span>&nbsp;<span class="op" id="5168758">=</span>&nbsp;<span class="builtinfunc" id="5168760">copy</span><span class="op" id="5168764">(</span><span class="ident" id="5168765">p</span><span class="op" id="5168766">,</span>&nbsp;<span class="ident" id="5168768">r</span><span class="op" id="5168769">.</span><span class="ident" id="5168770">unread</span><span class="op" id="5168776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168780">r</span><span class="op" id="5168781">.</span><span class="ident" id="5168782">unread</span>&nbsp;<span class="op" id="5168789">=</span>&nbsp;<span class="ident" id="5168791">r</span><span class="op" id="5168792">.</span><span class="ident" id="5168793">unread</span><span class="op" id="5168799">[</span><span class="ident" id="5168800">n</span><span class="op" id="5168801">:</span><span class="op" id="5168802">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168808">return</span><br>
<span class="lineno"></span><span class="op" id="5168815">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5168818">var</span>&nbsp;<span class="ident" id="5168822">ErrTimeout</span>&nbsp;<span class="op" id="5168833">=</span>&nbsp;<span class="ident" id="5168835">errors</span><span class="op" id="5168841">.</span><span class="ident" id="5168842">New</span><span class="op" id="5168845">(</span><span class="string" id="5168846">&#34;timeout&#34;</span><span class="op" id="5168855">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5168858">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5168913">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5168965">func</span>&nbsp;<span class="ident" id="5168970">TimeoutReader</span><span class="op" id="5168983">(</span><span class="ident" id="5168984">r</span>&nbsp;<span class="ident" id="5168986">io</span><span class="op" id="5168988">.</span><span class="ident" id="5168989">Reader</span><span class="op" id="5168995">)</span>&nbsp;<span class="ident" id="5168997">io</span><span class="op" id="5168999">.</span><span class="ident" id="5169000">Reader</span>&nbsp;<span class="op" id="5169007">{</span>&nbsp;<span class="keyword" id="5169009">return</span>&nbsp;<span class="op" id="5169016">&amp;</span><span class="ident" id="5169017">timeoutReader</span><span class="op" id="5169030">{</span><span class="ident" id="5169031">r</span><span class="op" id="5169032">,</span>&nbsp;<span class="num" id="5169034">0</span><span class="op" id="5169035">}</span>&nbsp;<span class="op" id="5169037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5169040">type</span>&nbsp;<span class="ident" id="5169045">timeoutReader</span>&nbsp;<span class="keyword" id="5169059">struct</span>&nbsp;<span class="op" id="5169066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169069">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5169075">io</span><span class="op" id="5169077">.</span><span class="ident" id="5169078">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169086">count</span>&nbsp;<span class="builtintype" id="5169092">int</span><br>
<span class="lineno">80</span><span class="op" id="5169096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5169099">func</span>&nbsp;<span class="op" id="5169104">(</span><span class="ident" id="5169105">r</span>&nbsp;<span class="op" id="5169107">*</span><span class="ident" id="5169108">timeoutReader</span><span class="op" id="5169121">)</span>&nbsp;<span class="ident" id="5169123">Read</span><span class="op" id="5169127">(</span><span class="ident" id="5169128">p</span>&nbsp;<span class="op" id="5169130">[</span><span class="op" id="5169131">]</span><span class="builtintype" id="5169132">byte</span><span class="op" id="5169136">)</span>&nbsp;<span class="op" id="5169138">(</span><span class="builtintype" id="5169139">int</span><span class="op" id="5169142">,</span>&nbsp;<span class="builtintype" id="5169144">error</span><span class="op" id="5169149">)</span>&nbsp;<span class="op" id="5169151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169154">r</span><span class="op" id="5169155">.</span><span class="ident" id="5169156">count</span><span class="op" id="5169161">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169165">if</span>&nbsp;<span class="ident" id="5169168">r</span><span class="op" id="5169169">.</span><span class="ident" id="5169170">count</span>&nbsp;<span class="op" id="5169176">==</span>&nbsp;<span class="num" id="5169179">2</span>&nbsp;<span class="op" id="5169181">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169185">return</span>&nbsp;<span class="num" id="5169192">0</span><span class="op" id="5169193">,</span>&nbsp;<span class="ident" id="5169195">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169210">return</span>&nbsp;<span class="ident" id="5169217">r</span><span class="op" id="5169218">.</span><span class="ident" id="5169219">r</span><span class="op" id="5169220">.</span><span class="ident" id="5169221">Read</span><span class="op" id="5169225">(</span><span class="ident" id="5169226">p</span><span class="op" id="5169227">)</span><br>
<span class="lineno"></span><span class="op" id="5169229">}</span>
</div>
</body>
</html>
