<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2212480">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2212535">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2212589">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2212640">package</span>&nbsp;<span class="ident" id="2212648">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212654">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2212714">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2212779">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2212837">//</span><br>
<span class="lineno"></span><span class="comment" id="2212840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2212857">//</span><br>
<span class="lineno"></span><span class="comment" id="2212860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2212883">//</span><br>
<span class="lineno">15</span><span class="comment" id="2212886">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2212899">//</span><br>
<span class="lineno"></span><span class="comment" id="2212902">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2212928">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2212951">//</span><br>
<span class="lineno">20</span><span class="comment" id="2212954">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2212974">//</span><br>
<span class="lineno"></span><span class="comment" id="2212977">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2212993">//</span><br>
<span class="lineno"></span><span class="comment" id="2212996">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2213054">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2213107">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2213164">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2213224">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2213246">//</span><br>
<span class="lineno">30</span><span class="comment" id="2213249">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2213315">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2213375">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2213437">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2213498">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2213523">//</span><br>
<span class="lineno"></span><span class="comment" id="2213526">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2213539">//</span><br>
<span class="lineno"></span><span class="comment" id="2213542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2213582">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2213640">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2213700">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2213760">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2213820">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2213880">//</span><br>
<span class="lineno">45</span><span class="comment" id="2213883">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2213944">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2214005">//</span><br>
<span class="lineno"></span><span class="comment" id="2214008">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2214056">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2214120">//</span><br>
<span class="lineno"></span><span class="comment" id="2214123">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2214184">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2214254">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2214329">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2214396">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2214469">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2214541">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2214555">//</span><br>
<span class="lineno"></span><span class="comment" id="2214558">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2214624">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2214690">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2214703">//</span><br>
<span class="lineno"></span><span class="comment" id="2214706">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2214730">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2214760">var</span>&nbsp;<span class="ident" id="2214764">_gamP</span>&nbsp;<span class="op" id="2214770">=</span>&nbsp;<span class="op" id="2214772">[</span><span class="op" id="2214773">...</span><span class="op" id="2214776">]</span><span class="builtintype" id="2214777">float64</span><span class="op" id="2214784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214787">1.60119522476751861407e-04</span><span class="op" id="2214813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214816">1.19135147006586384913e-03</span><span class="op" id="2214842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214845">1.04213797561761569935e-02</span><span class="op" id="2214871">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214874">4.76367800457137231464e-02</span><span class="op" id="2214900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214903">2.07448227648435975150e-01</span><span class="op" id="2214929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214932">4.94214826801497100753e-01</span><span class="op" id="2214958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2214961">9.99999999999999996796e-01</span><span class="op" id="2214987">,</span><br>
<span class="lineno"></span><span class="op" id="2214989">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2214991">var</span>&nbsp;<span class="ident" id="2214995">_gamQ</span>&nbsp;<span class="op" id="2215001">=</span>&nbsp;<span class="op" id="2215003">[</span><span class="op" id="2215004">...</span><span class="op" id="2215007">]</span><span class="builtintype" id="2215008">float64</span><span class="op" id="2215015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215018">-</span><span class="num" id="2215019">2.31581873324120129819e-05</span><span class="op" id="2215045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215048">5.39605580493303397842e-04</span><span class="op" id="2215074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215077">-</span><span class="num" id="2215078">4.45641913851797240494e-03</span><span class="op" id="2215104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215107">1.18139785222060435552e-02</span><span class="op" id="2215133">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215136">3.58236398605498653373e-02</span><span class="op" id="2215162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215165">-</span><span class="num" id="2215166">2.34591795718243348568e-01</span><span class="op" id="2215192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215195">7.14304917030273074085e-02</span><span class="op" id="2215221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215224">1.00000000000000000320e+00</span><span class="op" id="2215250">,</span><br>
<span class="lineno"></span><span class="op" id="2215252">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2215254">var</span>&nbsp;<span class="ident" id="2215258">_gamS</span>&nbsp;<span class="op" id="2215264">=</span>&nbsp;<span class="op" id="2215266">[</span><span class="op" id="2215267">...</span><span class="op" id="2215270">]</span><span class="builtintype" id="2215271">float64</span><span class="op" id="2215278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215281">7.87311395793093628397e-04</span><span class="op" id="2215307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215310">-</span><span class="num" id="2215311">2.29549961613378126380e-04</span><span class="op" id="2215337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215340">-</span><span class="num" id="2215341">2.68132617805781232825e-03</span><span class="op" id="2215367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215370">3.47222221605458667310e-03</span><span class="op" id="2215396">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215399">8.33333333333482257126e-02</span><span class="op" id="2215425">,</span><br>
<span class="lineno"></span><span class="op" id="2215427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2215430">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2215480">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2215527">func</span>&nbsp;<span class="ident" id="2215532">stirling</span><span class="op" id="2215540">(</span><span class="ident" id="2215541">x</span>&nbsp;<span class="builtintype" id="2215543">float64</span><span class="op" id="2215550">)</span>&nbsp;<span class="builtintype" id="2215552">float64</span>&nbsp;<span class="op" id="2215560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215563">const</span>&nbsp;<span class="op" id="2215569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215573">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2215585">=</span>&nbsp;<span class="num" id="2215587">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215613">MaxStirling</span>&nbsp;<span class="op" id="2215625">=</span>&nbsp;<span class="num" id="2215627">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215638">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215641">w</span>&nbsp;<span class="op" id="2215643">:=</span>&nbsp;<span class="num" id="2215646">1</span>&nbsp;<span class="op" id="2215648">/</span>&nbsp;<span class="ident" id="2215650">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215653">w</span>&nbsp;<span class="op" id="2215655">=</span>&nbsp;<span class="num" id="2215657">1</span>&nbsp;<span class="op" id="2215659">+</span>&nbsp;<span class="ident" id="2215661">w</span><span class="op" id="2215662">*</span><span class="op" id="2215663">(</span><span class="op" id="2215664">(</span><span class="op" id="2215665">(</span><span class="op" id="2215666">(</span><span class="ident" id="2215667">_gamS</span><span class="op" id="2215672">[</span><span class="num" id="2215673">0</span><span class="op" id="2215674">]</span><span class="op" id="2215675">*</span><span class="ident" id="2215676">w</span><span class="op" id="2215677">+</span><span class="ident" id="2215678">_gamS</span><span class="op" id="2215683">[</span><span class="num" id="2215684">1</span><span class="op" id="2215685">]</span><span class="op" id="2215686">)</span><span class="op" id="2215687">*</span><span class="ident" id="2215688">w</span><span class="op" id="2215689">+</span><span class="ident" id="2215690">_gamS</span><span class="op" id="2215695">[</span><span class="num" id="2215696">2</span><span class="op" id="2215697">]</span><span class="op" id="2215698">)</span><span class="op" id="2215699">*</span><span class="ident" id="2215700">w</span><span class="op" id="2215701">+</span><span class="ident" id="2215702">_gamS</span><span class="op" id="2215707">[</span><span class="num" id="2215708">3</span><span class="op" id="2215709">]</span><span class="op" id="2215710">)</span><span class="op" id="2215711">*</span><span class="ident" id="2215712">w</span><span class="op" id="2215713">+</span><span class="ident" id="2215714">_gamS</span><span class="op" id="2215719">[</span><span class="num" id="2215720">4</span><span class="op" id="2215721">]</span><span class="op" id="2215722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215725">y</span>&nbsp;<span class="op" id="2215727">:=</span>&nbsp;<span class="ident" id="2215730">Exp</span><span class="op" id="2215733">(</span><span class="ident" id="2215734">x</span><span class="op" id="2215735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215738">if</span>&nbsp;<span class="ident" id="2215741">x</span>&nbsp;<span class="op" id="2215743">&gt;</span>&nbsp;<span class="ident" id="2215745">MaxStirling</span>&nbsp;<span class="op" id="2215757">{</span>&nbsp;<span class="comment" id="2215759">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215785">v</span>&nbsp;<span class="op" id="2215787">:=</span>&nbsp;<span class="ident" id="2215790">Pow</span><span class="op" id="2215793">(</span><span class="ident" id="2215794">x</span><span class="op" id="2215795">,</span>&nbsp;<span class="num" id="2215797">0.5</span><span class="op" id="2215800">*</span><span class="ident" id="2215801">x</span><span class="op" id="2215802">-</span><span class="num" id="2215803">0.25</span><span class="op" id="2215807">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215811">y</span>&nbsp;<span class="op" id="2215813">=</span>&nbsp;<span class="ident" id="2215815">v</span>&nbsp;<span class="op" id="2215817">*</span>&nbsp;<span class="op" id="2215819">(</span><span class="ident" id="2215820">v</span>&nbsp;<span class="op" id="2215822">/</span>&nbsp;<span class="ident" id="2215824">y</span><span class="op" id="2215825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215828">}</span>&nbsp;<span class="keyword" id="2215830">else</span>&nbsp;<span class="op" id="2215835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215839">y</span>&nbsp;<span class="op" id="2215841">=</span>&nbsp;<span class="ident" id="2215843">Pow</span><span class="op" id="2215846">(</span><span class="ident" id="2215847">x</span><span class="op" id="2215848">,</span>&nbsp;<span class="ident" id="2215850">x</span><span class="op" id="2215851">-</span><span class="num" id="2215852">0.5</span><span class="op" id="2215855">)</span>&nbsp;<span class="op" id="2215857">/</span>&nbsp;<span class="ident" id="2215859">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215865">y</span>&nbsp;<span class="op" id="2215867">=</span>&nbsp;<span class="ident" id="2215869">SqrtTwoPi</span>&nbsp;<span class="op" id="2215879">*</span>&nbsp;<span class="ident" id="2215881">y</span>&nbsp;<span class="op" id="2215883">*</span>&nbsp;<span class="ident" id="2215885">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215888">return</span>&nbsp;<span class="ident" id="2215895">y</span><br>
<span class="lineno"></span><span class="op" id="2215897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2215900">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2215942">//</span><br>
<span class="lineno">115</span><span class="comment" id="2215945">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2215967">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2215989">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2216009">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2216029">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2216065">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2216086">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2216106">func</span>&nbsp;<span class="ident" id="2216111">Gamma</span><span class="op" id="2216116">(</span><span class="ident" id="2216117">x</span>&nbsp;<span class="builtintype" id="2216119">float64</span><span class="op" id="2216126">)</span>&nbsp;<span class="builtintype" id="2216128">float64</span>&nbsp;<span class="op" id="2216136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216139">const</span>&nbsp;<span class="ident" id="2216145">Euler</span>&nbsp;<span class="op" id="2216151">=</span>&nbsp;<span class="num" id="2216153">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2216206">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216218">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216236">switch</span>&nbsp;<span class="op" id="2216243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216246">case</span>&nbsp;<span class="ident" id="2216251">isNegInt</span><span class="op" id="2216259">(</span><span class="ident" id="2216260">x</span><span class="op" id="2216261">)</span>&nbsp;<span class="op" id="2216263">||</span>&nbsp;<span class="ident" id="2216266">IsInf</span><span class="op" id="2216271">(</span><span class="ident" id="2216272">x</span><span class="op" id="2216273">,</span>&nbsp;<span class="op" id="2216275">-</span><span class="num" id="2216276">1</span><span class="op" id="2216277">)</span>&nbsp;<span class="op" id="2216279">||</span>&nbsp;<span class="ident" id="2216282">IsNaN</span><span class="op" id="2216287">(</span><span class="ident" id="2216288">x</span><span class="op" id="2216289">)</span><span class="op" id="2216290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216294">return</span>&nbsp;<span class="ident" id="2216301">NaN</span><span class="op" id="2216304">(</span><span class="op" id="2216305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216308">case</span>&nbsp;<span class="ident" id="2216313">x</span>&nbsp;<span class="op" id="2216315">==</span>&nbsp;<span class="num" id="2216318">0</span><span class="op" id="2216319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216323">if</span>&nbsp;<span class="ident" id="2216326">Signbit</span><span class="op" id="2216333">(</span><span class="ident" id="2216334">x</span><span class="op" id="2216335">)</span>&nbsp;<span class="op" id="2216337">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216342">return</span>&nbsp;<span class="ident" id="2216349">Inf</span><span class="op" id="2216352">(</span><span class="op" id="2216353">-</span><span class="num" id="2216354">1</span><span class="op" id="2216355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216363">return</span>&nbsp;<span class="ident" id="2216370">Inf</span><span class="op" id="2216373">(</span><span class="num" id="2216374">1</span><span class="op" id="2216375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216378">case</span>&nbsp;<span class="ident" id="2216383">x</span>&nbsp;<span class="op" id="2216385">&lt;</span>&nbsp;<span class="op" id="2216387">-</span><span class="num" id="2216388">170.5674972726612</span>&nbsp;<span class="op" id="2216406">||</span>&nbsp;<span class="ident" id="2216409">x</span>&nbsp;<span class="op" id="2216411">&gt;</span>&nbsp;<span class="num" id="2216413">171.61447887182298</span><span class="op" id="2216431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216435">return</span>&nbsp;<span class="ident" id="2216442">Inf</span><span class="op" id="2216445">(</span><span class="num" id="2216446">1</span><span class="op" id="2216447">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216453">q</span>&nbsp;<span class="op" id="2216455">:=</span>&nbsp;<span class="ident" id="2216458">Abs</span><span class="op" id="2216461">(</span><span class="ident" id="2216462">x</span><span class="op" id="2216463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216466">p</span>&nbsp;<span class="op" id="2216468">:=</span>&nbsp;<span class="ident" id="2216471">Floor</span><span class="op" id="2216476">(</span><span class="ident" id="2216477">q</span><span class="op" id="2216478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216481">if</span>&nbsp;<span class="ident" id="2216484">q</span>&nbsp;<span class="op" id="2216486">&gt;</span>&nbsp;<span class="num" id="2216488">33</span>&nbsp;<span class="op" id="2216491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216495">if</span>&nbsp;<span class="ident" id="2216498">x</span>&nbsp;<span class="op" id="2216500">&gt;=</span>&nbsp;<span class="num" id="2216503">0</span>&nbsp;<span class="op" id="2216505">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216510">return</span>&nbsp;<span class="ident" id="2216517">stirling</span><span class="op" id="2216525">(</span><span class="ident" id="2216526">x</span><span class="op" id="2216527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216535">signgam</span>&nbsp;<span class="op" id="2216543">:=</span>&nbsp;<span class="num" id="2216546">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216550">if</span>&nbsp;<span class="ident" id="2216553">ip</span>&nbsp;<span class="op" id="2216556">:=</span>&nbsp;<span class="builtintype" id="2216559">int</span><span class="op" id="2216562">(</span><span class="ident" id="2216563">p</span><span class="op" id="2216564">)</span><span class="op" id="2216565">;</span>&nbsp;<span class="ident" id="2216567">ip</span><span class="op" id="2216569">&amp;</span><span class="num" id="2216570">1</span>&nbsp;<span class="op" id="2216572">==</span>&nbsp;<span class="num" id="2216575">0</span>&nbsp;<span class="op" id="2216577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216582">signgam</span>&nbsp;<span class="op" id="2216590">=</span>&nbsp;<span class="op" id="2216592">-</span><span class="num" id="2216593">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216601">z</span>&nbsp;<span class="op" id="2216603">:=</span>&nbsp;<span class="ident" id="2216606">q</span>&nbsp;<span class="op" id="2216608">-</span>&nbsp;<span class="ident" id="2216610">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216614">if</span>&nbsp;<span class="ident" id="2216617">z</span>&nbsp;<span class="op" id="2216619">&gt;</span>&nbsp;<span class="num" id="2216621">0.5</span>&nbsp;<span class="op" id="2216625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216630">p</span>&nbsp;<span class="op" id="2216632">=</span>&nbsp;<span class="ident" id="2216634">p</span>&nbsp;<span class="op" id="2216636">+</span>&nbsp;<span class="num" id="2216638">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216643">z</span>&nbsp;<span class="op" id="2216645">=</span>&nbsp;<span class="ident" id="2216647">q</span>&nbsp;<span class="op" id="2216649">-</span>&nbsp;<span class="ident" id="2216651">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216659">z</span>&nbsp;<span class="op" id="2216661">=</span>&nbsp;<span class="ident" id="2216663">q</span>&nbsp;<span class="op" id="2216665">*</span>&nbsp;<span class="ident" id="2216667">Sin</span><span class="op" id="2216670">(</span><span class="ident" id="2216671">Pi</span><span class="op" id="2216673">*</span><span class="ident" id="2216674">z</span><span class="op" id="2216675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216679">if</span>&nbsp;<span class="ident" id="2216682">z</span>&nbsp;<span class="op" id="2216684">==</span>&nbsp;<span class="num" id="2216687">0</span>&nbsp;<span class="op" id="2216689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216694">return</span>&nbsp;<span class="ident" id="2216701">Inf</span><span class="op" id="2216704">(</span><span class="ident" id="2216705">signgam</span><span class="op" id="2216712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216716">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216720">z</span>&nbsp;<span class="op" id="2216722">=</span>&nbsp;<span class="ident" id="2216724">Pi</span>&nbsp;<span class="op" id="2216727">/</span>&nbsp;<span class="op" id="2216729">(</span><span class="ident" id="2216730">Abs</span><span class="op" id="2216733">(</span><span class="ident" id="2216734">z</span><span class="op" id="2216735">)</span>&nbsp;<span class="op" id="2216737">*</span>&nbsp;<span class="ident" id="2216739">stirling</span><span class="op" id="2216747">(</span><span class="ident" id="2216748">q</span><span class="op" id="2216749">)</span><span class="op" id="2216750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216754">return</span>&nbsp;<span class="builtintype" id="2216761">float64</span><span class="op" id="2216768">(</span><span class="ident" id="2216769">signgam</span><span class="op" id="2216776">)</span>&nbsp;<span class="op" id="2216778">*</span>&nbsp;<span class="ident" id="2216780">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216787">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216807">z</span>&nbsp;<span class="op" id="2216809">:=</span>&nbsp;<span class="num" id="2216812">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216817">for</span>&nbsp;<span class="ident" id="2216821">x</span>&nbsp;<span class="op" id="2216823">&gt;=</span>&nbsp;<span class="num" id="2216826">3</span>&nbsp;<span class="op" id="2216828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216832">x</span>&nbsp;<span class="op" id="2216834">=</span>&nbsp;<span class="ident" id="2216836">x</span>&nbsp;<span class="op" id="2216838">-</span>&nbsp;<span class="num" id="2216840">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216844">z</span>&nbsp;<span class="op" id="2216846">=</span>&nbsp;<span class="ident" id="2216848">z</span>&nbsp;<span class="op" id="2216850">*</span>&nbsp;<span class="ident" id="2216852">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216855">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216858">for</span>&nbsp;<span class="ident" id="2216862">x</span>&nbsp;<span class="op" id="2216864">&lt;</span>&nbsp;<span class="num" id="2216866">0</span>&nbsp;<span class="op" id="2216868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216872">if</span>&nbsp;<span class="ident" id="2216875">x</span>&nbsp;<span class="op" id="2216877">&gt;</span>&nbsp;<span class="op" id="2216879">-</span><span class="num" id="2216880">1e-09</span>&nbsp;<span class="op" id="2216886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216891">goto</span>&nbsp;<span class="ident" id="2216896">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216908">z</span>&nbsp;<span class="op" id="2216910">=</span>&nbsp;<span class="ident" id="2216912">z</span>&nbsp;<span class="op" id="2216914">/</span>&nbsp;<span class="ident" id="2216916">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216920">x</span>&nbsp;<span class="op" id="2216922">=</span>&nbsp;<span class="ident" id="2216924">x</span>&nbsp;<span class="op" id="2216926">+</span>&nbsp;<span class="num" id="2216928">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216934">for</span>&nbsp;<span class="ident" id="2216938">x</span>&nbsp;<span class="op" id="2216940">&lt;</span>&nbsp;<span class="num" id="2216942">2</span>&nbsp;<span class="op" id="2216944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216948">if</span>&nbsp;<span class="ident" id="2216951">x</span>&nbsp;<span class="op" id="2216953">&lt;</span>&nbsp;<span class="num" id="2216955">1e-09</span>&nbsp;<span class="op" id="2216961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216966">goto</span>&nbsp;<span class="ident" id="2216971">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216983">z</span>&nbsp;<span class="op" id="2216985">=</span>&nbsp;<span class="ident" id="2216987">z</span>&nbsp;<span class="op" id="2216989">/</span>&nbsp;<span class="ident" id="2216991">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216995">x</span>&nbsp;<span class="op" id="2216997">=</span>&nbsp;<span class="ident" id="2216999">x</span>&nbsp;<span class="op" id="2217001">+</span>&nbsp;<span class="num" id="2217003">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217010">if</span>&nbsp;<span class="ident" id="2217013">x</span>&nbsp;<span class="op" id="2217015">==</span>&nbsp;<span class="num" id="2217018">2</span>&nbsp;<span class="op" id="2217020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217024">return</span>&nbsp;<span class="ident" id="2217031">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217038">x</span>&nbsp;<span class="op" id="2217040">=</span>&nbsp;<span class="ident" id="2217042">x</span>&nbsp;<span class="op" id="2217044">-</span>&nbsp;<span class="num" id="2217046">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217049">p</span>&nbsp;<span class="op" id="2217051">=</span>&nbsp;<span class="op" id="2217053">(</span><span class="op" id="2217054">(</span><span class="op" id="2217055">(</span><span class="op" id="2217056">(</span><span class="op" id="2217057">(</span><span class="ident" id="2217058">x</span><span class="op" id="2217059">*</span><span class="ident" id="2217060">_gamP</span><span class="op" id="2217065">[</span><span class="num" id="2217066">0</span><span class="op" id="2217067">]</span><span class="op" id="2217068">+</span><span class="ident" id="2217069">_gamP</span><span class="op" id="2217074">[</span><span class="num" id="2217075">1</span><span class="op" id="2217076">]</span><span class="op" id="2217077">)</span><span class="op" id="2217078">*</span><span class="ident" id="2217079">x</span><span class="op" id="2217080">+</span><span class="ident" id="2217081">_gamP</span><span class="op" id="2217086">[</span><span class="num" id="2217087">2</span><span class="op" id="2217088">]</span><span class="op" id="2217089">)</span><span class="op" id="2217090">*</span><span class="ident" id="2217091">x</span><span class="op" id="2217092">+</span><span class="ident" id="2217093">_gamP</span><span class="op" id="2217098">[</span><span class="num" id="2217099">3</span><span class="op" id="2217100">]</span><span class="op" id="2217101">)</span><span class="op" id="2217102">*</span><span class="ident" id="2217103">x</span><span class="op" id="2217104">+</span><span class="ident" id="2217105">_gamP</span><span class="op" id="2217110">[</span><span class="num" id="2217111">4</span><span class="op" id="2217112">]</span><span class="op" id="2217113">)</span><span class="op" id="2217114">*</span><span class="ident" id="2217115">x</span><span class="op" id="2217116">+</span><span class="ident" id="2217117">_gamP</span><span class="op" id="2217122">[</span><span class="num" id="2217123">5</span><span class="op" id="2217124">]</span><span class="op" id="2217125">)</span><span class="op" id="2217126">*</span><span class="ident" id="2217127">x</span>&nbsp;<span class="op" id="2217129">+</span>&nbsp;<span class="ident" id="2217131">_gamP</span><span class="op" id="2217136">[</span><span class="num" id="2217137">6</span><span class="op" id="2217138">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217141">q</span>&nbsp;<span class="op" id="2217143">=</span>&nbsp;<span class="op" id="2217145">(</span><span class="op" id="2217146">(</span><span class="op" id="2217147">(</span><span class="op" id="2217148">(</span><span class="op" id="2217149">(</span><span class="op" id="2217150">(</span><span class="ident" id="2217151">x</span><span class="op" id="2217152">*</span><span class="ident" id="2217153">_gamQ</span><span class="op" id="2217158">[</span><span class="num" id="2217159">0</span><span class="op" id="2217160">]</span><span class="op" id="2217161">+</span><span class="ident" id="2217162">_gamQ</span><span class="op" id="2217167">[</span><span class="num" id="2217168">1</span><span class="op" id="2217169">]</span><span class="op" id="2217170">)</span><span class="op" id="2217171">*</span><span class="ident" id="2217172">x</span><span class="op" id="2217173">+</span><span class="ident" id="2217174">_gamQ</span><span class="op" id="2217179">[</span><span class="num" id="2217180">2</span><span class="op" id="2217181">]</span><span class="op" id="2217182">)</span><span class="op" id="2217183">*</span><span class="ident" id="2217184">x</span><span class="op" id="2217185">+</span><span class="ident" id="2217186">_gamQ</span><span class="op" id="2217191">[</span><span class="num" id="2217192">3</span><span class="op" id="2217193">]</span><span class="op" id="2217194">)</span><span class="op" id="2217195">*</span><span class="ident" id="2217196">x</span><span class="op" id="2217197">+</span><span class="ident" id="2217198">_gamQ</span><span class="op" id="2217203">[</span><span class="num" id="2217204">4</span><span class="op" id="2217205">]</span><span class="op" id="2217206">)</span><span class="op" id="2217207">*</span><span class="ident" id="2217208">x</span><span class="op" id="2217209">+</span><span class="ident" id="2217210">_gamQ</span><span class="op" id="2217215">[</span><span class="num" id="2217216">5</span><span class="op" id="2217217">]</span><span class="op" id="2217218">)</span><span class="op" id="2217219">*</span><span class="ident" id="2217220">x</span><span class="op" id="2217221">+</span><span class="ident" id="2217222">_gamQ</span><span class="op" id="2217227">[</span><span class="num" id="2217228">6</span><span class="op" id="2217229">]</span><span class="op" id="2217230">)</span><span class="op" id="2217231">*</span><span class="ident" id="2217232">x</span>&nbsp;<span class="op" id="2217234">+</span>&nbsp;<span class="ident" id="2217236">_gamQ</span><span class="op" id="2217241">[</span><span class="num" id="2217242">7</span><span class="op" id="2217243">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217246">return</span>&nbsp;<span class="ident" id="2217253">z</span>&nbsp;<span class="op" id="2217255">*</span>&nbsp;<span class="ident" id="2217257">p</span>&nbsp;<span class="op" id="2217259">/</span>&nbsp;<span class="ident" id="2217261">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2217264">small</span><span class="op" id="2217269">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217272">if</span>&nbsp;<span class="ident" id="2217275">x</span>&nbsp;<span class="op" id="2217277">==</span>&nbsp;<span class="num" id="2217280">0</span>&nbsp;<span class="op" id="2217282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217286">return</span>&nbsp;<span class="ident" id="2217293">Inf</span><span class="op" id="2217296">(</span><span class="num" id="2217297">1</span><span class="op" id="2217298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217304">return</span>&nbsp;<span class="ident" id="2217311">z</span>&nbsp;<span class="op" id="2217313">/</span>&nbsp;<span class="op" id="2217315">(</span><span class="op" id="2217316">(</span><span class="num" id="2217317">1</span>&nbsp;<span class="op" id="2217319">+</span>&nbsp;<span class="ident" id="2217321">Euler</span><span class="op" id="2217326">*</span><span class="ident" id="2217327">x</span><span class="op" id="2217328">)</span>&nbsp;<span class="op" id="2217330">*</span>&nbsp;<span class="ident" id="2217332">x</span><span class="op" id="2217333">)</span><br>
<span class="lineno"></span><span class="op" id="2217335">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2217338">func</span>&nbsp;<span class="ident" id="2217343">isNegInt</span><span class="op" id="2217351">(</span><span class="ident" id="2217352">x</span>&nbsp;<span class="builtintype" id="2217354">float64</span><span class="op" id="2217361">)</span>&nbsp;<span class="builtintype" id="2217363">bool</span>&nbsp;<span class="op" id="2217368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217371">if</span>&nbsp;<span class="ident" id="2217374">x</span>&nbsp;<span class="op" id="2217376">&lt;</span>&nbsp;<span class="num" id="2217378">0</span>&nbsp;<span class="op" id="2217380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217384">_</span><span class="op" id="2217385">,</span>&nbsp;<span class="ident" id="2217387">xf</span>&nbsp;<span class="op" id="2217390">:=</span>&nbsp;<span class="ident" id="2217393">Modf</span><span class="op" id="2217397">(</span><span class="ident" id="2217398">x</span><span class="op" id="2217399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217403">return</span>&nbsp;<span class="ident" id="2217410">xf</span>&nbsp;<span class="op" id="2217413">==</span>&nbsp;<span class="num" id="2217416">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217422">return</span>&nbsp;<span class="builtintype" id="2217429">false</span><br>
<span class="lineno"></span><span class="op" id="2217435">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
