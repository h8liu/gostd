<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6367858">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6367913">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6367967">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6368018">package</span>&nbsp;<span class="ident" id="6368026">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6368033">import</span>&nbsp;<span class="string" id="6368040">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6368048">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6368108">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6368178">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6368236">//</span><br>
<span class="lineno"></span><span class="comment" id="6368239">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6368287">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6368351">//</span><br>
<span class="lineno"></span><span class="comment" id="6368354">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6368415">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6368485">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6368560">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6368627">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6368700">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6368772">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6368786">//</span><br>
<span class="lineno"></span><span class="comment" id="6368789">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6368855">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6368921">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6368934">//</span><br>
<span class="lineno"></span><span class="comment" id="6368937">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6368961">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6368991">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6369019">//</span><br>
<span class="lineno"></span><span class="comment" id="6369022">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6369038">//</span><br>
<span class="lineno">35</span><span class="comment" id="6369041">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6369047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6369066">//</span><br>
<span class="lineno"></span><span class="comment" id="6369069">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6369077">//</span><br>
<span class="lineno">40</span><span class="comment" id="6369080">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6369114">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6369149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6369182">//</span><br>
<span class="lineno"></span><span class="comment" id="6369185">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6369246">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6369302">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6369331">//</span><br>
<span class="lineno"></span><span class="comment" id="6369334">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6369361">//</span><br>
<span class="lineno">50</span><span class="comment" id="6369364">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6369377">//</span><br>
<span class="lineno"></span><span class="comment" id="6369380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6369420">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6369478">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6369538">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6369598">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6369659">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6369692">func</span>&nbsp;<span class="ident" id="6369697">Tan</span><span class="op" id="6369700">(</span><span class="ident" id="6369701">x</span>&nbsp;<span class="builtintype" id="6369703">complex128</span><span class="op" id="6369713">)</span>&nbsp;<span class="builtintype" id="6369715">complex128</span>&nbsp;<span class="op" id="6369726">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6369729">d</span>&nbsp;<span class="op" id="6369731">:=</span>&nbsp;<span class="ident" id="6369734">math</span><span class="op" id="6369738">.</span><span class="ident" id="6369739">Cos</span><span class="op" id="6369742">(</span><span class="num" id="6369743">2</span><span class="op" id="6369744">*</span><span class="builtinfunc" id="6369745">real</span><span class="op" id="6369749">(</span><span class="ident" id="6369750">x</span><span class="op" id="6369751">)</span><span class="op" id="6369752">)</span>&nbsp;<span class="op" id="6369754">+</span>&nbsp;<span class="ident" id="6369756">math</span><span class="op" id="6369760">.</span><span class="ident" id="6369761">Cosh</span><span class="op" id="6369765">(</span><span class="num" id="6369766">2</span><span class="op" id="6369767">*</span><span class="builtinfunc" id="6369768">imag</span><span class="op" id="6369772">(</span><span class="ident" id="6369773">x</span><span class="op" id="6369774">)</span><span class="op" id="6369775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6369778">if</span>&nbsp;<span class="ident" id="6369781">math</span><span class="op" id="6369785">.</span><span class="ident" id="6369786">Abs</span><span class="op" id="6369789">(</span><span class="ident" id="6369790">d</span><span class="op" id="6369791">)</span>&nbsp;<span class="op" id="6369793">&lt;</span>&nbsp;<span class="num" id="6369795">0.25</span>&nbsp;<span class="op" id="6369800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6369804">d</span>&nbsp;<span class="op" id="6369806">=</span>&nbsp;<span class="ident" id="6369808">tanSeries</span><span class="op" id="6369817">(</span><span class="ident" id="6369818">x</span><span class="op" id="6369819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6369822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6369825">if</span>&nbsp;<span class="ident" id="6369828">d</span>&nbsp;<span class="op" id="6369830">==</span>&nbsp;<span class="num" id="6369833">0</span>&nbsp;<span class="op" id="6369835">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6369839">return</span>&nbsp;<span class="ident" id="6369846">Inf</span><span class="op" id="6369849">(</span><span class="op" id="6369850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6369853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6369856">return</span>&nbsp;<span class="builtinfunc" id="6369863">complex</span><span class="op" id="6369870">(</span><span class="ident" id="6369871">math</span><span class="op" id="6369875">.</span><span class="ident" id="6369876">Sin</span><span class="op" id="6369879">(</span><span class="num" id="6369880">2</span><span class="op" id="6369881">*</span><span class="builtinfunc" id="6369882">real</span><span class="op" id="6369886">(</span><span class="ident" id="6369887">x</span><span class="op" id="6369888">)</span><span class="op" id="6369889">)</span><span class="op" id="6369890">/</span><span class="ident" id="6369891">d</span><span class="op" id="6369892">,</span>&nbsp;<span class="ident" id="6369894">math</span><span class="op" id="6369898">.</span><span class="ident" id="6369899">Sinh</span><span class="op" id="6369903">(</span><span class="num" id="6369904">2</span><span class="op" id="6369905">*</span><span class="builtinfunc" id="6369906">imag</span><span class="op" id="6369910">(</span><span class="ident" id="6369911">x</span><span class="op" id="6369912">)</span><span class="op" id="6369913">)</span><span class="op" id="6369914">/</span><span class="ident" id="6369915">d</span><span class="op" id="6369916">)</span><br>
<span class="lineno"></span><span class="op" id="6369918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6369921">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6369951">//</span><br>
<span class="lineno"></span><span class="comment" id="6369954">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6369970">//</span><br>
<span class="lineno"></span><span class="comment" id="6369973">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6370031">//</span><br>
<span class="lineno"></span><span class="comment" id="6370034">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6370047">//</span><br>
<span class="lineno"></span><span class="comment" id="6370050">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6370090">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6370148">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6370209">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6370254">func</span>&nbsp;<span class="ident" id="6370259">Tanh</span><span class="op" id="6370263">(</span><span class="ident" id="6370264">x</span>&nbsp;<span class="builtintype" id="6370266">complex128</span><span class="op" id="6370276">)</span>&nbsp;<span class="builtintype" id="6370278">complex128</span>&nbsp;<span class="op" id="6370289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370292">d</span>&nbsp;<span class="op" id="6370294">:=</span>&nbsp;<span class="ident" id="6370297">math</span><span class="op" id="6370301">.</span><span class="ident" id="6370302">Cosh</span><span class="op" id="6370306">(</span><span class="num" id="6370307">2</span><span class="op" id="6370308">*</span><span class="builtinfunc" id="6370309">real</span><span class="op" id="6370313">(</span><span class="ident" id="6370314">x</span><span class="op" id="6370315">)</span><span class="op" id="6370316">)</span>&nbsp;<span class="op" id="6370318">+</span>&nbsp;<span class="ident" id="6370320">math</span><span class="op" id="6370324">.</span><span class="ident" id="6370325">Cos</span><span class="op" id="6370328">(</span><span class="num" id="6370329">2</span><span class="op" id="6370330">*</span><span class="builtinfunc" id="6370331">imag</span><span class="op" id="6370335">(</span><span class="ident" id="6370336">x</span><span class="op" id="6370337">)</span><span class="op" id="6370338">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370341">if</span>&nbsp;<span class="ident" id="6370344">d</span>&nbsp;<span class="op" id="6370346">==</span>&nbsp;<span class="num" id="6370349">0</span>&nbsp;<span class="op" id="6370351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370355">return</span>&nbsp;<span class="ident" id="6370362">Inf</span><span class="op" id="6370365">(</span><span class="op" id="6370366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6370369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370372">return</span>&nbsp;<span class="builtinfunc" id="6370379">complex</span><span class="op" id="6370386">(</span><span class="ident" id="6370387">math</span><span class="op" id="6370391">.</span><span class="ident" id="6370392">Sinh</span><span class="op" id="6370396">(</span><span class="num" id="6370397">2</span><span class="op" id="6370398">*</span><span class="builtinfunc" id="6370399">real</span><span class="op" id="6370403">(</span><span class="ident" id="6370404">x</span><span class="op" id="6370405">)</span><span class="op" id="6370406">)</span><span class="op" id="6370407">/</span><span class="ident" id="6370408">d</span><span class="op" id="6370409">,</span>&nbsp;<span class="ident" id="6370411">math</span><span class="op" id="6370415">.</span><span class="ident" id="6370416">Sin</span><span class="op" id="6370419">(</span><span class="num" id="6370420">2</span><span class="op" id="6370421">*</span><span class="builtinfunc" id="6370422">imag</span><span class="op" id="6370426">(</span><span class="ident" id="6370427">x</span><span class="op" id="6370428">)</span><span class="op" id="6370429">)</span><span class="op" id="6370430">/</span><span class="ident" id="6370431">d</span><span class="op" id="6370432">)</span><br>
<span class="lineno"></span><span class="op" id="6370434">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6370437">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6370491">func</span>&nbsp;<span class="ident" id="6370496">reducePi</span><span class="op" id="6370504">(</span><span class="ident" id="6370505">x</span>&nbsp;<span class="builtintype" id="6370507">float64</span><span class="op" id="6370514">)</span>&nbsp;<span class="builtintype" id="6370516">float64</span>&nbsp;<span class="op" id="6370524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370527">const</span>&nbsp;<span class="op" id="6370533">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6370537">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370574">DP1</span>&nbsp;<span class="op" id="6370578">=</span>&nbsp;<span class="num" id="6370580">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6370607">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370634">DP2</span>&nbsp;<span class="op" id="6370638">=</span>&nbsp;<span class="num" id="6370640">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6370667">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370694">DP3</span>&nbsp;<span class="op" id="6370698">=</span>&nbsp;<span class="num" id="6370700">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6370727">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6370753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370756">t</span>&nbsp;<span class="op" id="6370758">:=</span>&nbsp;<span class="ident" id="6370761">x</span>&nbsp;<span class="op" id="6370763">/</span>&nbsp;<span class="ident" id="6370765">math</span><span class="op" id="6370769">.</span><span class="ident" id="6370770">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370774">if</span>&nbsp;<span class="ident" id="6370777">t</span>&nbsp;<span class="op" id="6370779">&gt;=</span>&nbsp;<span class="num" id="6370782">0</span>&nbsp;<span class="op" id="6370784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370788">t</span>&nbsp;<span class="op" id="6370790">+=</span>&nbsp;<span class="num" id="6370793">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6370798">}</span>&nbsp;<span class="keyword" id="6370800">else</span>&nbsp;<span class="op" id="6370805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370809">t</span>&nbsp;<span class="op" id="6370811">-=</span>&nbsp;<span class="num" id="6370814">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6370819">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6370822">t</span>&nbsp;<span class="op" id="6370824">=</span>&nbsp;<span class="builtintype" id="6370826">float64</span><span class="op" id="6370833">(</span><span class="ident" id="6370834">int64</span><span class="op" id="6370839">(</span><span class="ident" id="6370840">t</span><span class="op" id="6370841">)</span><span class="op" id="6370842">)</span>&nbsp;<span class="comment" id="6370844">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6370872">return</span>&nbsp;<span class="op" id="6370879">(</span><span class="op" id="6370880">(</span><span class="ident" id="6370881">x</span>&nbsp;<span class="op" id="6370883">-</span>&nbsp;<span class="ident" id="6370885">t</span><span class="op" id="6370886">*</span><span class="ident" id="6370887">DP1</span><span class="op" id="6370890">)</span>&nbsp;<span class="op" id="6370892">-</span>&nbsp;<span class="ident" id="6370894">t</span><span class="op" id="6370895">*</span><span class="ident" id="6370896">DP2</span><span class="op" id="6370899">)</span>&nbsp;<span class="op" id="6370901">-</span>&nbsp;<span class="ident" id="6370903">t</span><span class="op" id="6370904">*</span><span class="ident" id="6370905">DP3</span><br>
<span class="lineno"></span><span class="op" id="6370909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6370912">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6370962">func</span>&nbsp;<span class="ident" id="6370967">tanSeries</span><span class="op" id="6370976">(</span><span class="ident" id="6370977">z</span>&nbsp;<span class="builtintype" id="6370979">complex128</span><span class="op" id="6370989">)</span>&nbsp;<span class="builtintype" id="6370991">float64</span>&nbsp;<span class="op" id="6370999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6371002">const</span>&nbsp;<span class="ident" id="6371008">MACHEP</span>&nbsp;<span class="op" id="6371015">=</span>&nbsp;<span class="num" id="6371017">1.0</span>&nbsp;<span class="op" id="6371021">/</span>&nbsp;<span class="op" id="6371023">(</span><span class="num" id="6371024">1</span>&nbsp;<span class="op" id="6371026">&lt;&lt;</span>&nbsp;<span class="num" id="6371029">53</span><span class="op" id="6371031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371034">x</span>&nbsp;<span class="op" id="6371036">:=</span>&nbsp;<span class="ident" id="6371039">math</span><span class="op" id="6371043">.</span><span class="ident" id="6371044">Abs</span><span class="op" id="6371047">(</span><span class="num" id="6371048">2</span>&nbsp;<span class="op" id="6371050">*</span>&nbsp;<span class="builtinfunc" id="6371052">real</span><span class="op" id="6371056">(</span><span class="ident" id="6371057">z</span><span class="op" id="6371058">)</span><span class="op" id="6371059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371062">y</span>&nbsp;<span class="op" id="6371064">:=</span>&nbsp;<span class="ident" id="6371067">math</span><span class="op" id="6371071">.</span><span class="ident" id="6371072">Abs</span><span class="op" id="6371075">(</span><span class="num" id="6371076">2</span>&nbsp;<span class="op" id="6371078">*</span>&nbsp;<span class="builtinfunc" id="6371080">imag</span><span class="op" id="6371084">(</span><span class="ident" id="6371085">z</span><span class="op" id="6371086">)</span><span class="op" id="6371087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371090">x</span>&nbsp;<span class="op" id="6371092">=</span>&nbsp;<span class="ident" id="6371094">reducePi</span><span class="op" id="6371102">(</span><span class="ident" id="6371103">x</span><span class="op" id="6371104">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371107">x</span>&nbsp;<span class="op" id="6371109">=</span>&nbsp;<span class="ident" id="6371111">x</span>&nbsp;<span class="op" id="6371113">*</span>&nbsp;<span class="ident" id="6371115">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371118">y</span>&nbsp;<span class="op" id="6371120">=</span>&nbsp;<span class="ident" id="6371122">y</span>&nbsp;<span class="op" id="6371124">*</span>&nbsp;<span class="ident" id="6371126">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371129">x2</span>&nbsp;<span class="op" id="6371132">:=</span>&nbsp;<span class="num" id="6371135">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371140">y2</span>&nbsp;<span class="op" id="6371143">:=</span>&nbsp;<span class="num" id="6371146">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371151">f</span>&nbsp;<span class="op" id="6371153">:=</span>&nbsp;<span class="num" id="6371156">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371161">rn</span>&nbsp;<span class="op" id="6371164">:=</span>&nbsp;<span class="num" id="6371167">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371172">d</span>&nbsp;<span class="op" id="6371174">:=</span>&nbsp;<span class="num" id="6371177">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6371182">for</span>&nbsp;<span class="op" id="6371186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371190">rn</span>&nbsp;<span class="op" id="6371193">+=</span>&nbsp;<span class="num" id="6371196">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371200">f</span>&nbsp;<span class="op" id="6371202">*=</span>&nbsp;<span class="ident" id="6371205">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371210">rn</span>&nbsp;<span class="op" id="6371213">+=</span>&nbsp;<span class="num" id="6371216">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371220">f</span>&nbsp;<span class="op" id="6371222">*=</span>&nbsp;<span class="ident" id="6371225">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371230">x2</span>&nbsp;<span class="op" id="6371233">*=</span>&nbsp;<span class="ident" id="6371236">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371240">y2</span>&nbsp;<span class="op" id="6371243">*=</span>&nbsp;<span class="ident" id="6371246">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371250">t</span>&nbsp;<span class="op" id="6371252">:=</span>&nbsp;<span class="ident" id="6371255">y2</span>&nbsp;<span class="op" id="6371258">+</span>&nbsp;<span class="ident" id="6371260">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371265">t</span>&nbsp;<span class="op" id="6371267">/=</span>&nbsp;<span class="ident" id="6371270">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371274">d</span>&nbsp;<span class="op" id="6371276">+=</span>&nbsp;<span class="ident" id="6371279">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371284">rn</span>&nbsp;<span class="op" id="6371287">+=</span>&nbsp;<span class="num" id="6371290">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371294">f</span>&nbsp;<span class="op" id="6371296">*=</span>&nbsp;<span class="ident" id="6371299">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371304">rn</span>&nbsp;<span class="op" id="6371307">+=</span>&nbsp;<span class="num" id="6371310">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371314">f</span>&nbsp;<span class="op" id="6371316">*=</span>&nbsp;<span class="ident" id="6371319">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371324">x2</span>&nbsp;<span class="op" id="6371327">*=</span>&nbsp;<span class="ident" id="6371330">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371334">y2</span>&nbsp;<span class="op" id="6371337">*=</span>&nbsp;<span class="ident" id="6371340">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371344">t</span>&nbsp;<span class="op" id="6371346">=</span>&nbsp;<span class="ident" id="6371348">y2</span>&nbsp;<span class="op" id="6371351">-</span>&nbsp;<span class="ident" id="6371353">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371358">t</span>&nbsp;<span class="op" id="6371360">/=</span>&nbsp;<span class="ident" id="6371363">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6371367">d</span>&nbsp;<span class="op" id="6371369">+=</span>&nbsp;<span class="ident" id="6371372">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6371376">if</span>&nbsp;<span class="ident" id="6371379">math</span><span class="op" id="6371383">.</span><span class="ident" id="6371384">Abs</span><span class="op" id="6371387">(</span><span class="ident" id="6371388">t</span><span class="op" id="6371389">/</span><span class="ident" id="6371390">d</span><span class="op" id="6371391">)</span>&nbsp;<span class="op" id="6371393">&lt;=</span>&nbsp;<span class="ident" id="6371396">MACHEP</span>&nbsp;<span class="op" id="6371403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6371408">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6371416">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6371419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6371422">return</span>&nbsp;<span class="ident" id="6371429">d</span><br>
<span class="lineno"></span><span class="op" id="6371431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6371434">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6371464">//</span><br>
<span class="lineno"></span><span class="comment" id="6371467">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6371483">//</span><br>
<span class="lineno"></span><span class="comment" id="6371486">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6371492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6371511">//</span><br>
<span class="lineno"></span><span class="comment" id="6371514">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6371522">//</span><br>
<span class="lineno"></span><span class="comment" id="6371525">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6371559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6371594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6371627">//</span><br>
<span class="lineno"></span><span class="comment" id="6371630">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6371685">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6371742">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6371765">//</span><br>
<span class="lineno"></span><span class="comment" id="6371768">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6371781">//</span><br>
<span class="lineno"></span><span class="comment" id="6371784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6371824">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6371882">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6371942">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6372002">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6372043">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6372078">func</span>&nbsp;<span class="ident" id="6372083">Cot</span><span class="op" id="6372086">(</span><span class="ident" id="6372087">x</span>&nbsp;<span class="builtintype" id="6372089">complex128</span><span class="op" id="6372099">)</span>&nbsp;<span class="builtintype" id="6372101">complex128</span>&nbsp;<span class="op" id="6372112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6372115">d</span>&nbsp;<span class="op" id="6372117">:=</span>&nbsp;<span class="ident" id="6372120">math</span><span class="op" id="6372124">.</span><span class="ident" id="6372125">Cosh</span><span class="op" id="6372129">(</span><span class="num" id="6372130">2</span><span class="op" id="6372131">*</span><span class="builtinfunc" id="6372132">imag</span><span class="op" id="6372136">(</span><span class="ident" id="6372137">x</span><span class="op" id="6372138">)</span><span class="op" id="6372139">)</span>&nbsp;<span class="op" id="6372141">-</span>&nbsp;<span class="ident" id="6372143">math</span><span class="op" id="6372147">.</span><span class="ident" id="6372148">Cos</span><span class="op" id="6372151">(</span><span class="num" id="6372152">2</span><span class="op" id="6372153">*</span><span class="builtinfunc" id="6372154">real</span><span class="op" id="6372158">(</span><span class="ident" id="6372159">x</span><span class="op" id="6372160">)</span><span class="op" id="6372161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6372164">if</span>&nbsp;<span class="ident" id="6372167">math</span><span class="op" id="6372171">.</span><span class="ident" id="6372172">Abs</span><span class="op" id="6372175">(</span><span class="ident" id="6372176">d</span><span class="op" id="6372177">)</span>&nbsp;<span class="op" id="6372179">&lt;</span>&nbsp;<span class="num" id="6372181">0.25</span>&nbsp;<span class="op" id="6372186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6372190">d</span>&nbsp;<span class="op" id="6372192">=</span>&nbsp;<span class="ident" id="6372194">tanSeries</span><span class="op" id="6372203">(</span><span class="ident" id="6372204">x</span><span class="op" id="6372205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6372208">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6372211">if</span>&nbsp;<span class="ident" id="6372214">d</span>&nbsp;<span class="op" id="6372216">==</span>&nbsp;<span class="num" id="6372219">0</span>&nbsp;<span class="op" id="6372221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6372225">return</span>&nbsp;<span class="ident" id="6372232">Inf</span><span class="op" id="6372235">(</span><span class="op" id="6372236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6372239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6372242">return</span>&nbsp;<span class="builtinfunc" id="6372249">complex</span><span class="op" id="6372256">(</span><span class="ident" id="6372257">math</span><span class="op" id="6372261">.</span><span class="ident" id="6372262">Sin</span><span class="op" id="6372265">(</span><span class="num" id="6372266">2</span><span class="op" id="6372267">*</span><span class="builtinfunc" id="6372268">real</span><span class="op" id="6372272">(</span><span class="ident" id="6372273">x</span><span class="op" id="6372274">)</span><span class="op" id="6372275">)</span><span class="op" id="6372276">/</span><span class="ident" id="6372277">d</span><span class="op" id="6372278">,</span>&nbsp;<span class="op" id="6372280">-</span><span class="ident" id="6372281">math</span><span class="op" id="6372285">.</span><span class="ident" id="6372286">Sinh</span><span class="op" id="6372290">(</span><span class="num" id="6372291">2</span><span class="op" id="6372292">*</span><span class="builtinfunc" id="6372293">imag</span><span class="op" id="6372297">(</span><span class="ident" id="6372298">x</span><span class="op" id="6372299">)</span><span class="op" id="6372300">)</span><span class="op" id="6372301">/</span><span class="ident" id="6372302">d</span><span class="op" id="6372303">)</span><br>
<span class="lineno"></span><span class="op" id="6372305">}</span>
</div>
</body>
</html>
