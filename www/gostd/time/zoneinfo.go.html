<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2857865">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2857920">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2857974">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2858025">package</span>&nbsp;<span class="ident" id="2858033">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2858039">import</span>&nbsp;<span class="op" id="2858046">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2858049">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2858057">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2858067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2858070">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2858136">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2858205">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2858280">type</span>&nbsp;<span class="ident" id="2858285">Location</span>&nbsp;<span class="keyword" id="2858294">struct</span>&nbsp;<span class="op" id="2858301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858304">name</span>&nbsp;<span class="builtintype" id="2858309">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858317">zone</span>&nbsp;<span class="op" id="2858322">[</span><span class="op" id="2858323">]</span><span class="ident" id="2858324">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858330">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2858335">[</span><span class="op" id="2858336">]</span><span class="ident" id="2858337">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858349">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858396">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858446">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858498">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858551">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858587">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858620">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858674">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858727">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858742">cacheStart</span>&nbsp;<span class="ident" id="2858753">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858760">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2858771">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858778">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2858789">*</span><span class="ident" id="2858790">zone</span><br>
<span class="lineno"></span><span class="op" id="2858795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2858798">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2858859">type</span>&nbsp;<span class="ident" id="2858864">zone</span>&nbsp;<span class="keyword" id="2858869">struct</span>&nbsp;<span class="op" id="2858876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858879">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2858886">string</span>&nbsp;<span class="comment" id="2858893">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858921">offset</span>&nbsp;<span class="builtintype" id="2858928">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2858935">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858959">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2858966">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2858973">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2859012">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2859015">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2859072">type</span>&nbsp;<span class="ident" id="2859077">zoneTrans</span>&nbsp;<span class="keyword" id="2859087">struct</span>&nbsp;<span class="op" id="2859094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859097">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859110">int64</span>&nbsp;<span class="comment" id="2859116">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859163">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2859176">uint8</span>&nbsp;<span class="comment" id="2859182">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859243">isstd</span><span class="op" id="2859248">,</span>&nbsp;<span class="ident" id="2859250">isutc</span>&nbsp;<span class="builtintype" id="2859256">bool</span>&nbsp;&nbsp;<span class="comment" id="2859262">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2859299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859302">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2859364">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2859380">const</span>&nbsp;<span class="op" id="2859386">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859389">alpha</span>&nbsp;<span class="op" id="2859395">=</span>&nbsp;<span class="op" id="2859397">-</span><span class="num" id="2859398">1</span>&nbsp;<span class="op" id="2859400">&lt;&lt;</span>&nbsp;<span class="num" id="2859403">63</span>&nbsp;&nbsp;<span class="comment" id="2859407">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859425">omega</span>&nbsp;<span class="op" id="2859431">=</span>&nbsp;<span class="num" id="2859433">1</span><span class="op" id="2859434">&lt;&lt;</span><span class="num" id="2859436">63</span>&nbsp;<span class="op" id="2859439">-</span>&nbsp;<span class="num" id="2859441">1</span>&nbsp;<span class="comment" id="2859443">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2859460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2859463">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2859515">var</span>&nbsp;<span class="ident" id="2859519">UTC</span>&nbsp;<span class="op" id="2859523">*</span><span class="ident" id="2859524">Location</span>&nbsp;<span class="op" id="2859533">=</span>&nbsp;<span class="op" id="2859535">&amp;</span><span class="ident" id="2859536">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859544">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2859599">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2859652">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2859703">var</span>&nbsp;<span class="ident" id="2859707">utcLoc</span>&nbsp;<span class="op" id="2859714">=</span>&nbsp;<span class="ident" id="2859716">Location</span><span class="op" id="2859724">{</span><span class="ident" id="2859725">name</span><span class="op" id="2859729">:</span>&nbsp;<span class="string" id="2859731">&#34;UTC&#34;</span><span class="op" id="2859736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859739">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2859789">var</span>&nbsp;<span class="ident" id="2859793">Local</span>&nbsp;<span class="op" id="2859799">*</span><span class="ident" id="2859800">Location</span>&nbsp;<span class="op" id="2859809">=</span>&nbsp;<span class="op" id="2859811">&amp;</span><span class="ident" id="2859812">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2859822">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2859879">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2859921">var</span>&nbsp;<span class="ident" id="2859925">localLoc</span>&nbsp;<span class="ident" id="2859934">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2859943">var</span>&nbsp;<span class="ident" id="2859947">localOnce</span>&nbsp;<span class="ident" id="2859957">sync</span><span class="op" id="2859961">.</span><span class="ident" id="2859962">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2859968">func</span>&nbsp;<span class="op" id="2859973">(</span><span class="ident" id="2859974">l</span>&nbsp;<span class="op" id="2859976">*</span><span class="ident" id="2859977">Location</span><span class="op" id="2859985">)</span>&nbsp;<span class="ident" id="2859987">get</span><span class="op" id="2859990">(</span><span class="op" id="2859991">)</span>&nbsp;<span class="op" id="2859993">*</span><span class="ident" id="2859994">Location</span>&nbsp;<span class="op" id="2860003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860006">if</span>&nbsp;<span class="ident" id="2860009">l</span>&nbsp;<span class="op" id="2860011">==</span>&nbsp;<span class="ident" id="2860014">nil</span>&nbsp;<span class="op" id="2860018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860022">return</span>&nbsp;<span class="op" id="2860029">&amp;</span><span class="ident" id="2860030">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860038">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860041">if</span>&nbsp;<span class="ident" id="2860044">l</span>&nbsp;<span class="op" id="2860046">==</span>&nbsp;<span class="op" id="2860049">&amp;</span><span class="ident" id="2860050">localLoc</span>&nbsp;<span class="op" id="2860059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860063">localOnce</span><span class="op" id="2860072">.</span><span class="ident" id="2860073">Do</span><span class="op" id="2860075">(</span><span class="ident" id="2860076">initLocal</span><span class="op" id="2860085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860091">return</span>&nbsp;<span class="ident" id="2860098">l</span><br>
<span class="lineno"></span><span class="op" id="2860100">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2860103">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2860171">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2860221">func</span>&nbsp;<span class="op" id="2860226">(</span><span class="ident" id="2860227">l</span>&nbsp;<span class="op" id="2860229">*</span><span class="ident" id="2860230">Location</span><span class="op" id="2860238">)</span>&nbsp;<span class="ident" id="2860240">String</span><span class="op" id="2860246">(</span><span class="op" id="2860247">)</span>&nbsp;<span class="builtintype" id="2860249">string</span>&nbsp;<span class="op" id="2860256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860259">return</span>&nbsp;<span class="ident" id="2860266">l</span><span class="op" id="2860267">.</span><span class="ident" id="2860268">get</span><span class="op" id="2860271">(</span><span class="op" id="2860272">)</span><span class="op" id="2860273">.</span><span class="ident" id="2860274">name</span><br>
<span class="lineno">85</span><span class="op" id="2860279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2860282">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2860331">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2860388">func</span>&nbsp;<span class="ident" id="2860393">FixedZone</span><span class="op" id="2860402">(</span><span class="ident" id="2860403">name</span>&nbsp;<span class="builtintype" id="2860408">string</span><span class="op" id="2860414">,</span>&nbsp;<span class="ident" id="2860416">offset</span>&nbsp;<span class="builtintype" id="2860423">int</span><span class="op" id="2860426">)</span>&nbsp;<span class="op" id="2860428">*</span><span class="ident" id="2860429">Location</span>&nbsp;<span class="op" id="2860438">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860441">l</span>&nbsp;<span class="op" id="2860443">:=</span>&nbsp;<span class="op" id="2860446">&amp;</span><span class="ident" id="2860447">Location</span><span class="op" id="2860455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860459">name</span><span class="op" id="2860463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860471">name</span><span class="op" id="2860475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860479">zone</span><span class="op" id="2860483">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860491">[</span><span class="op" id="2860492">]</span><span class="ident" id="2860493">zone</span><span class="op" id="2860497">{</span><span class="op" id="2860498">{</span><span class="ident" id="2860499">name</span><span class="op" id="2860503">,</span>&nbsp;<span class="ident" id="2860505">offset</span><span class="op" id="2860511">,</span>&nbsp;<span class="builtintype" id="2860513">false</span><span class="op" id="2860518">}</span><span class="op" id="2860519">}</span><span class="op" id="2860520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860524">tx</span><span class="op" id="2860526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860536">[</span><span class="op" id="2860537">]</span><span class="ident" id="2860538">zoneTrans</span><span class="op" id="2860547">{</span><span class="op" id="2860548">{</span><span class="ident" id="2860549">alpha</span><span class="op" id="2860554">,</span>&nbsp;<span class="num" id="2860556">0</span><span class="op" id="2860557">,</span>&nbsp;<span class="builtintype" id="2860559">false</span><span class="op" id="2860564">,</span>&nbsp;<span class="builtintype" id="2860566">false</span><span class="op" id="2860571">}</span><span class="op" id="2860572">}</span><span class="op" id="2860573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860577">cacheStart</span><span class="op" id="2860587">:</span>&nbsp;<span class="ident" id="2860589">alpha</span><span class="op" id="2860594">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860598">cacheEnd</span><span class="op" id="2860606">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2860610">omega</span><span class="op" id="2860615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860621">l</span><span class="op" id="2860622">.</span><span class="ident" id="2860623">cacheZone</span>&nbsp;<span class="op" id="2860633">=</span>&nbsp;<span class="op" id="2860635">&amp;</span><span class="ident" id="2860636">l</span><span class="op" id="2860637">.</span><span class="ident" id="2860638">zone</span><span class="op" id="2860642">[</span><span class="num" id="2860643">0</span><span class="op" id="2860644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860647">return</span>&nbsp;<span class="ident" id="2860654">l</span><br>
<span class="lineno"></span><span class="op" id="2860656">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2860659">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2860722">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2860798">//</span><br>
<span class="lineno"></span><span class="comment" id="2860801">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2860873">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2860944">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2861013">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2861069">func</span>&nbsp;<span class="op" id="2861074">(</span><span class="ident" id="2861075">l</span>&nbsp;<span class="op" id="2861077">*</span><span class="ident" id="2861078">Location</span><span class="op" id="2861086">)</span>&nbsp;<span class="ident" id="2861088">lookup</span><span class="op" id="2861094">(</span><span class="ident" id="2861095">sec</span>&nbsp;<span class="ident" id="2861099">int64</span><span class="op" id="2861104">)</span>&nbsp;<span class="op" id="2861106">(</span><span class="ident" id="2861107">name</span>&nbsp;<span class="builtintype" id="2861112">string</span><span class="op" id="2861118">,</span>&nbsp;<span class="ident" id="2861120">offset</span>&nbsp;<span class="builtintype" id="2861127">int</span><span class="op" id="2861130">,</span>&nbsp;<span class="ident" id="2861132">isDST</span>&nbsp;<span class="builtintype" id="2861138">bool</span><span class="op" id="2861142">,</span>&nbsp;<span class="ident" id="2861144">start</span><span class="op" id="2861149">,</span>&nbsp;<span class="ident" id="2861151">end</span>&nbsp;<span class="ident" id="2861155">int64</span><span class="op" id="2861160">)</span>&nbsp;<span class="op" id="2861162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861165">l</span>&nbsp;<span class="op" id="2861167">=</span>&nbsp;<span class="ident" id="2861169">l</span><span class="op" id="2861170">.</span><span class="ident" id="2861171">get</span><span class="op" id="2861174">(</span><span class="op" id="2861175">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861179">if</span>&nbsp;<span class="builtinfunc" id="2861182">len</span><span class="op" id="2861185">(</span><span class="ident" id="2861186">l</span><span class="op" id="2861187">.</span><span class="ident" id="2861188">zone</span><span class="op" id="2861192">)</span>&nbsp;<span class="op" id="2861194">==</span>&nbsp;<span class="num" id="2861197">0</span>&nbsp;<span class="op" id="2861199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861203">name</span>&nbsp;<span class="op" id="2861208">=</span>&nbsp;<span class="string" id="2861210">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861218">offset</span>&nbsp;<span class="op" id="2861225">=</span>&nbsp;<span class="num" id="2861227">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861231">isDST</span>&nbsp;<span class="op" id="2861237">=</span>&nbsp;<span class="builtintype" id="2861239">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861247">start</span>&nbsp;<span class="op" id="2861253">=</span>&nbsp;<span class="ident" id="2861255">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861263">end</span>&nbsp;<span class="op" id="2861267">=</span>&nbsp;<span class="ident" id="2861269">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861277">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861289">if</span>&nbsp;<span class="ident" id="2861292">zone</span>&nbsp;<span class="op" id="2861297">:=</span>&nbsp;<span class="ident" id="2861300">l</span><span class="op" id="2861301">.</span><span class="ident" id="2861302">cacheZone</span><span class="op" id="2861311">;</span>&nbsp;<span class="ident" id="2861313">zone</span>&nbsp;<span class="op" id="2861318">!=</span>&nbsp;<span class="ident" id="2861321">nil</span>&nbsp;<span class="op" id="2861325">&amp;&amp;</span>&nbsp;<span class="ident" id="2861328">l</span><span class="op" id="2861329">.</span><span class="ident" id="2861330">cacheStart</span>&nbsp;<span class="op" id="2861341">&lt;=</span>&nbsp;<span class="ident" id="2861344">sec</span>&nbsp;<span class="op" id="2861348">&amp;&amp;</span>&nbsp;<span class="ident" id="2861351">sec</span>&nbsp;<span class="op" id="2861355">&lt;</span>&nbsp;<span class="ident" id="2861357">l</span><span class="op" id="2861358">.</span><span class="ident" id="2861359">cacheEnd</span>&nbsp;<span class="op" id="2861368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861372">name</span>&nbsp;<span class="op" id="2861377">=</span>&nbsp;<span class="ident" id="2861379">zone</span><span class="op" id="2861383">.</span><span class="ident" id="2861384">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861391">offset</span>&nbsp;<span class="op" id="2861398">=</span>&nbsp;<span class="ident" id="2861400">zone</span><span class="op" id="2861404">.</span><span class="ident" id="2861405">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861414">isDST</span>&nbsp;<span class="op" id="2861420">=</span>&nbsp;<span class="ident" id="2861422">zone</span><span class="op" id="2861426">.</span><span class="ident" id="2861427">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861435">start</span>&nbsp;<span class="op" id="2861441">=</span>&nbsp;<span class="ident" id="2861443">l</span><span class="op" id="2861444">.</span><span class="ident" id="2861445">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861458">end</span>&nbsp;<span class="op" id="2861462">=</span>&nbsp;<span class="ident" id="2861464">l</span><span class="op" id="2861465">.</span><span class="ident" id="2861466">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861477">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861489">if</span>&nbsp;<span class="builtinfunc" id="2861492">len</span><span class="op" id="2861495">(</span><span class="ident" id="2861496">l</span><span class="op" id="2861497">.</span><span class="ident" id="2861498">tx</span><span class="op" id="2861500">)</span>&nbsp;<span class="op" id="2861502">==</span>&nbsp;<span class="num" id="2861505">0</span>&nbsp;<span class="op" id="2861507">||</span>&nbsp;<span class="ident" id="2861510">sec</span>&nbsp;<span class="op" id="2861514">&lt;</span>&nbsp;<span class="ident" id="2861516">l</span><span class="op" id="2861517">.</span><span class="ident" id="2861518">tx</span><span class="op" id="2861520">[</span><span class="num" id="2861521">0</span><span class="op" id="2861522">]</span><span class="op" id="2861523">.</span><span class="ident" id="2861524">when</span>&nbsp;<span class="op" id="2861529">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861533">zone</span>&nbsp;<span class="op" id="2861538">:=</span>&nbsp;<span class="op" id="2861541">&amp;</span><span class="ident" id="2861542">l</span><span class="op" id="2861543">.</span><span class="ident" id="2861544">zone</span><span class="op" id="2861548">[</span><span class="ident" id="2861549">l</span><span class="op" id="2861550">.</span><span class="ident" id="2861551">lookupFirstZone</span><span class="op" id="2861566">(</span><span class="op" id="2861567">)</span><span class="op" id="2861568">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861572">name</span>&nbsp;<span class="op" id="2861577">=</span>&nbsp;<span class="ident" id="2861579">zone</span><span class="op" id="2861583">.</span><span class="ident" id="2861584">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861591">offset</span>&nbsp;<span class="op" id="2861598">=</span>&nbsp;<span class="ident" id="2861600">zone</span><span class="op" id="2861604">.</span><span class="ident" id="2861605">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861614">isDST</span>&nbsp;<span class="op" id="2861620">=</span>&nbsp;<span class="ident" id="2861622">zone</span><span class="op" id="2861626">.</span><span class="ident" id="2861627">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861635">start</span>&nbsp;<span class="op" id="2861641">=</span>&nbsp;<span class="ident" id="2861643">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861651">if</span>&nbsp;<span class="builtinfunc" id="2861654">len</span><span class="op" id="2861657">(</span><span class="ident" id="2861658">l</span><span class="op" id="2861659">.</span><span class="ident" id="2861660">tx</span><span class="op" id="2861662">)</span>&nbsp;<span class="op" id="2861664">&gt;</span>&nbsp;<span class="num" id="2861666">0</span>&nbsp;<span class="op" id="2861668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861673">end</span>&nbsp;<span class="op" id="2861677">=</span>&nbsp;<span class="ident" id="2861679">l</span><span class="op" id="2861680">.</span><span class="ident" id="2861681">tx</span><span class="op" id="2861683">[</span><span class="num" id="2861684">0</span><span class="op" id="2861685">]</span><span class="op" id="2861686">.</span><span class="ident" id="2861687">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861694">}</span>&nbsp;<span class="keyword" id="2861696">else</span>&nbsp;<span class="op" id="2861701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861706">end</span>&nbsp;<span class="op" id="2861710">=</span>&nbsp;<span class="ident" id="2861712">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861720">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861736">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861790">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861839">tx</span>&nbsp;<span class="op" id="2861842">:=</span>&nbsp;<span class="ident" id="2861845">l</span><span class="op" id="2861846">.</span><span class="ident" id="2861847">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861851">end</span>&nbsp;<span class="op" id="2861855">=</span>&nbsp;<span class="ident" id="2861857">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861864">lo</span>&nbsp;<span class="op" id="2861867">:=</span>&nbsp;<span class="num" id="2861870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861873">hi</span>&nbsp;<span class="op" id="2861876">:=</span>&nbsp;<span class="builtinfunc" id="2861879">len</span><span class="op" id="2861882">(</span><span class="ident" id="2861883">tx</span><span class="op" id="2861885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861888">for</span>&nbsp;<span class="ident" id="2861892">hi</span><span class="op" id="2861894">-</span><span class="ident" id="2861895">lo</span>&nbsp;<span class="op" id="2861898">&gt;</span>&nbsp;<span class="num" id="2861900">1</span>&nbsp;<span class="op" id="2861902">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861906">m</span>&nbsp;<span class="op" id="2861908">:=</span>&nbsp;<span class="ident" id="2861911">lo</span>&nbsp;<span class="op" id="2861914">+</span>&nbsp;<span class="op" id="2861916">(</span><span class="ident" id="2861917">hi</span><span class="op" id="2861919">-</span><span class="ident" id="2861920">lo</span><span class="op" id="2861922">)</span><span class="op" id="2861923">/</span><span class="num" id="2861924">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861928">lim</span>&nbsp;<span class="op" id="2861932">:=</span>&nbsp;<span class="ident" id="2861935">tx</span><span class="op" id="2861937">[</span><span class="ident" id="2861938">m</span><span class="op" id="2861939">]</span><span class="op" id="2861940">.</span><span class="ident" id="2861941">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861948">if</span>&nbsp;<span class="ident" id="2861951">sec</span>&nbsp;<span class="op" id="2861955">&lt;</span>&nbsp;<span class="ident" id="2861957">lim</span>&nbsp;<span class="op" id="2861961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861966">end</span>&nbsp;<span class="op" id="2861970">=</span>&nbsp;<span class="ident" id="2861972">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861979">hi</span>&nbsp;<span class="op" id="2861982">=</span>&nbsp;<span class="ident" id="2861984">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861988">}</span>&nbsp;<span class="keyword" id="2861990">else</span>&nbsp;<span class="op" id="2861995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862000">lo</span>&nbsp;<span class="op" id="2862003">=</span>&nbsp;<span class="ident" id="2862005">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862015">zone</span>&nbsp;<span class="op" id="2862020">:=</span>&nbsp;<span class="op" id="2862023">&amp;</span><span class="ident" id="2862024">l</span><span class="op" id="2862025">.</span><span class="ident" id="2862026">zone</span><span class="op" id="2862030">[</span><span class="ident" id="2862031">tx</span><span class="op" id="2862033">[</span><span class="ident" id="2862034">lo</span><span class="op" id="2862036">]</span><span class="op" id="2862037">.</span><span class="ident" id="2862038">index</span><span class="op" id="2862043">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862046">name</span>&nbsp;<span class="op" id="2862051">=</span>&nbsp;<span class="ident" id="2862053">zone</span><span class="op" id="2862057">.</span><span class="ident" id="2862058">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862064">offset</span>&nbsp;<span class="op" id="2862071">=</span>&nbsp;<span class="ident" id="2862073">zone</span><span class="op" id="2862077">.</span><span class="ident" id="2862078">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862086">isDST</span>&nbsp;<span class="op" id="2862092">=</span>&nbsp;<span class="ident" id="2862094">zone</span><span class="op" id="2862098">.</span><span class="ident" id="2862099">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862106">start</span>&nbsp;<span class="op" id="2862112">=</span>&nbsp;<span class="ident" id="2862114">tx</span><span class="op" id="2862116">[</span><span class="ident" id="2862117">lo</span><span class="op" id="2862119">]</span><span class="op" id="2862120">.</span><span class="ident" id="2862121">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2862127">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862166">return</span><br>
<span class="lineno"></span><span class="op" id="2862173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2862176">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2862247">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2862316">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2862326">//</span><br>
<span class="lineno"></span><span class="comment" id="2862329">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2862381">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2862454">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2862509">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2862571">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2862633">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2862696">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2862768">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2862780">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2862846">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2862866">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2862903">func</span>&nbsp;<span class="op" id="2862908">(</span><span class="ident" id="2862909">l</span>&nbsp;<span class="op" id="2862911">*</span><span class="ident" id="2862912">Location</span><span class="op" id="2862920">)</span>&nbsp;<span class="ident" id="2862922">lookupFirstZone</span><span class="op" id="2862937">(</span><span class="op" id="2862938">)</span>&nbsp;<span class="builtintype" id="2862940">int</span>&nbsp;<span class="op" id="2862944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2862947">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862959">if</span>&nbsp;<span class="op" id="2862962">!</span><span class="ident" id="2862963">l</span><span class="op" id="2862964">.</span><span class="ident" id="2862965">firstZoneUsed</span><span class="op" id="2862978">(</span><span class="op" id="2862979">)</span>&nbsp;<span class="op" id="2862981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862985">return</span>&nbsp;<span class="num" id="2862992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2862999">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863011">if</span>&nbsp;<span class="builtinfunc" id="2863014">len</span><span class="op" id="2863017">(</span><span class="ident" id="2863018">l</span><span class="op" id="2863019">.</span><span class="ident" id="2863020">tx</span><span class="op" id="2863022">)</span>&nbsp;<span class="op" id="2863024">&gt;</span>&nbsp;<span class="num" id="2863026">0</span>&nbsp;<span class="op" id="2863028">&amp;&amp;</span>&nbsp;<span class="ident" id="2863031">l</span><span class="op" id="2863032">.</span><span class="ident" id="2863033">zone</span><span class="op" id="2863037">[</span><span class="ident" id="2863038">l</span><span class="op" id="2863039">.</span><span class="ident" id="2863040">tx</span><span class="op" id="2863042">[</span><span class="num" id="2863043">0</span><span class="op" id="2863044">]</span><span class="op" id="2863045">.</span><span class="ident" id="2863046">index</span><span class="op" id="2863051">]</span><span class="op" id="2863052">.</span><span class="ident" id="2863053">isDST</span>&nbsp;<span class="op" id="2863059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863063">for</span>&nbsp;<span class="ident" id="2863067">zi</span>&nbsp;<span class="op" id="2863070">:=</span>&nbsp;<span class="builtintype" id="2863073">int</span><span class="op" id="2863076">(</span><span class="ident" id="2863077">l</span><span class="op" id="2863078">.</span><span class="ident" id="2863079">tx</span><span class="op" id="2863081">[</span><span class="num" id="2863082">0</span><span class="op" id="2863083">]</span><span class="op" id="2863084">.</span><span class="ident" id="2863085">index</span><span class="op" id="2863090">)</span>&nbsp;<span class="op" id="2863092">-</span>&nbsp;<span class="num" id="2863094">1</span><span class="op" id="2863095">;</span>&nbsp;<span class="ident" id="2863097">zi</span>&nbsp;<span class="op" id="2863100">&gt;=</span>&nbsp;<span class="num" id="2863103">0</span><span class="op" id="2863104">;</span>&nbsp;<span class="ident" id="2863106">zi</span><span class="op" id="2863108">--</span>&nbsp;<span class="op" id="2863111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863116">if</span>&nbsp;<span class="op" id="2863119">!</span><span class="ident" id="2863120">l</span><span class="op" id="2863121">.</span><span class="ident" id="2863122">zone</span><span class="op" id="2863126">[</span><span class="ident" id="2863127">zi</span><span class="op" id="2863129">]</span><span class="op" id="2863130">.</span><span class="ident" id="2863131">isDST</span>&nbsp;<span class="op" id="2863137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863143">return</span>&nbsp;<span class="ident" id="2863150">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863156">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863167">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863179">for</span>&nbsp;<span class="ident" id="2863183">zi</span>&nbsp;<span class="op" id="2863186">:=</span>&nbsp;<span class="keyword" id="2863189">range</span>&nbsp;<span class="ident" id="2863195">l</span><span class="op" id="2863196">.</span><span class="ident" id="2863197">zone</span>&nbsp;<span class="op" id="2863202">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863206">if</span>&nbsp;<span class="op" id="2863209">!</span><span class="ident" id="2863210">l</span><span class="op" id="2863211">.</span><span class="ident" id="2863212">zone</span><span class="op" id="2863216">[</span><span class="ident" id="2863217">zi</span><span class="op" id="2863219">]</span><span class="op" id="2863220">.</span><span class="ident" id="2863221">isDST</span>&nbsp;<span class="op" id="2863227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863232">return</span>&nbsp;<span class="ident" id="2863239">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863251">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863263">return</span>&nbsp;<span class="num" id="2863270">0</span><br>
<span class="lineno"></span><span class="op" id="2863272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2863275">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2863339">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2863354">func</span>&nbsp;<span class="op" id="2863359">(</span><span class="ident" id="2863360">l</span>&nbsp;<span class="op" id="2863362">*</span><span class="ident" id="2863363">Location</span><span class="op" id="2863371">)</span>&nbsp;<span class="ident" id="2863373">firstZoneUsed</span><span class="op" id="2863386">(</span><span class="op" id="2863387">)</span>&nbsp;<span class="builtintype" id="2863389">bool</span>&nbsp;<span class="op" id="2863394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863397">for</span>&nbsp;<span class="ident" id="2863401">_</span><span class="op" id="2863402">,</span>&nbsp;<span class="ident" id="2863404">tx</span>&nbsp;<span class="op" id="2863407">:=</span>&nbsp;<span class="keyword" id="2863410">range</span>&nbsp;<span class="ident" id="2863416">l</span><span class="op" id="2863417">.</span><span class="ident" id="2863418">tx</span>&nbsp;<span class="op" id="2863421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863425">if</span>&nbsp;<span class="ident" id="2863428">tx</span><span class="op" id="2863430">.</span><span class="ident" id="2863431">index</span>&nbsp;<span class="op" id="2863437">==</span>&nbsp;<span class="num" id="2863440">0</span>&nbsp;<span class="op" id="2863442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863447">return</span>&nbsp;<span class="builtintype" id="2863454">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863467">return</span>&nbsp;<span class="builtintype" id="2863474">false</span><br>
<span class="lineno"></span><span class="op" id="2863480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2863483">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2863542">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2863606">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2863655">func</span>&nbsp;<span class="op" id="2863660">(</span><span class="ident" id="2863661">l</span>&nbsp;<span class="op" id="2863663">*</span><span class="ident" id="2863664">Location</span><span class="op" id="2863672">)</span>&nbsp;<span class="ident" id="2863674">lookupName</span><span class="op" id="2863684">(</span><span class="ident" id="2863685">name</span>&nbsp;<span class="builtintype" id="2863690">string</span><span class="op" id="2863696">,</span>&nbsp;<span class="ident" id="2863698">unix</span>&nbsp;<span class="ident" id="2863703">int64</span><span class="op" id="2863708">)</span>&nbsp;<span class="op" id="2863710">(</span><span class="ident" id="2863711">offset</span>&nbsp;<span class="builtintype" id="2863718">int</span><span class="op" id="2863721">,</span>&nbsp;<span class="ident" id="2863723">isDST</span>&nbsp;<span class="builtintype" id="2863729">bool</span><span class="op" id="2863733">,</span>&nbsp;<span class="ident" id="2863735">ok</span>&nbsp;<span class="builtintype" id="2863738">bool</span><span class="op" id="2863742">)</span>&nbsp;<span class="op" id="2863744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863747">l</span>&nbsp;<span class="op" id="2863749">=</span>&nbsp;<span class="ident" id="2863751">l</span><span class="op" id="2863752">.</span><span class="ident" id="2863753">get</span><span class="op" id="2863756">(</span><span class="op" id="2863757">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863761">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863824">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863894">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863957">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2864016">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2864083">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864100">for</span>&nbsp;<span class="ident" id="2864104">i</span>&nbsp;<span class="op" id="2864106">:=</span>&nbsp;<span class="keyword" id="2864109">range</span>&nbsp;<span class="ident" id="2864115">l</span><span class="op" id="2864116">.</span><span class="ident" id="2864117">zone</span>&nbsp;<span class="op" id="2864122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2864126">zone</span>&nbsp;<span class="op" id="2864131">:=</span>&nbsp;<span class="op" id="2864134">&amp;</span><span class="ident" id="2864135">l</span><span class="op" id="2864136">.</span><span class="ident" id="2864137">zone</span><span class="op" id="2864141">[</span><span class="ident" id="2864142">i</span><span class="op" id="2864143">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864147">if</span>&nbsp;<span class="ident" id="2864150">zone</span><span class="op" id="2864154">.</span><span class="ident" id="2864155">name</span>&nbsp;<span class="op" id="2864160">==</span>&nbsp;<span class="ident" id="2864163">name</span>&nbsp;<span class="op" id="2864168">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2864173">nam</span><span class="op" id="2864176">,</span>&nbsp;<span class="ident" id="2864178">offset</span><span class="op" id="2864184">,</span>&nbsp;<span class="ident" id="2864186">isDST</span><span class="op" id="2864191">,</span>&nbsp;<span class="ident" id="2864193">_</span><span class="op" id="2864194">,</span>&nbsp;<span class="ident" id="2864196">_</span>&nbsp;<span class="op" id="2864198">:=</span>&nbsp;<span class="ident" id="2864201">l</span><span class="op" id="2864202">.</span><span class="ident" id="2864203">lookup</span><span class="op" id="2864209">(</span><span class="ident" id="2864210">unix</span>&nbsp;<span class="op" id="2864215">-</span>&nbsp;<span class="ident" id="2864217">int64</span><span class="op" id="2864222">(</span><span class="ident" id="2864223">zone</span><span class="op" id="2864227">.</span><span class="ident" id="2864228">offset</span><span class="op" id="2864234">)</span><span class="op" id="2864235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864240">if</span>&nbsp;<span class="ident" id="2864243">nam</span>&nbsp;<span class="op" id="2864247">==</span>&nbsp;<span class="ident" id="2864250">zone</span><span class="op" id="2864254">.</span><span class="ident" id="2864255">name</span>&nbsp;<span class="op" id="2864260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864266">return</span>&nbsp;<span class="ident" id="2864273">offset</span><span class="op" id="2864279">,</span>&nbsp;<span class="ident" id="2864281">isDST</span><span class="op" id="2864286">,</span>&nbsp;<span class="builtintype" id="2864288">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2864296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2864300">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2864303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2864307">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864358">for</span>&nbsp;<span class="ident" id="2864362">i</span>&nbsp;<span class="op" id="2864364">:=</span>&nbsp;<span class="keyword" id="2864367">range</span>&nbsp;<span class="ident" id="2864373">l</span><span class="op" id="2864374">.</span><span class="ident" id="2864375">zone</span>&nbsp;<span class="op" id="2864380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2864384">zone</span>&nbsp;<span class="op" id="2864389">:=</span>&nbsp;<span class="op" id="2864392">&amp;</span><span class="ident" id="2864393">l</span><span class="op" id="2864394">.</span><span class="ident" id="2864395">zone</span><span class="op" id="2864399">[</span><span class="ident" id="2864400">i</span><span class="op" id="2864401">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864405">if</span>&nbsp;<span class="ident" id="2864408">zone</span><span class="op" id="2864412">.</span><span class="ident" id="2864413">name</span>&nbsp;<span class="op" id="2864418">==</span>&nbsp;<span class="ident" id="2864421">name</span>&nbsp;<span class="op" id="2864426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864431">return</span>&nbsp;<span class="ident" id="2864438">zone</span><span class="op" id="2864442">.</span><span class="ident" id="2864443">offset</span><span class="op" id="2864449">,</span>&nbsp;<span class="ident" id="2864451">zone</span><span class="op" id="2864455">.</span><span class="ident" id="2864456">isDST</span><span class="op" id="2864461">,</span>&nbsp;<span class="builtintype" id="2864463">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2864470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2864473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2864477">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2864501">return</span><br>
<span class="lineno"></span><span class="op" id="2864508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2864511">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2864584">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2864645">var</span>&nbsp;<span class="ident" id="2864649">zoneinfo</span><span class="op" id="2864657">,</span>&nbsp;<span class="ident" id="2864659">_</span>&nbsp;<span class="op" id="2864661">=</span>&nbsp;<span class="ident" id="2864663">syscall</span><span class="op" id="2864670">.</span><span class="ident" id="2864671">Getenv</span><span class="op" id="2864677">(</span><span class="string" id="2864678">&#34;ZONEINFO&#34;</span><span class="op" id="2864688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2864691">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2864749">//</span><br>
<span class="lineno"></span><span class="comment" id="2864752">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2864809">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2864864">//</span><br>
<span class="lineno"></span><span class="comment" id="2864867">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2864945">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2865008">//</span><br>
<span class="lineno"></span><span class="comment" id="2865011">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2865071">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2865127">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2865191">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2865260">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2865309">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2865364">func</span>&nbsp;<span class="ident" id="2865369">LoadLocation</span><span class="op" id="2865381">(</span><span class="ident" id="2865382">name</span>&nbsp;<span class="builtintype" id="2865387">string</span><span class="op" id="2865393">)</span>&nbsp;<span class="op" id="2865395">(</span><span class="op" id="2865396">*</span><span class="ident" id="2865397">Location</span><span class="op" id="2865405">,</span>&nbsp;<span class="builtintype" id="2865407">error</span><span class="op" id="2865412">)</span>&nbsp;<span class="op" id="2865414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865417">if</span>&nbsp;<span class="ident" id="2865420">name</span>&nbsp;<span class="op" id="2865425">==</span>&nbsp;<span class="string" id="2865428">&#34;&#34;</span>&nbsp;<span class="op" id="2865431">||</span>&nbsp;<span class="ident" id="2865434">name</span>&nbsp;<span class="op" id="2865439">==</span>&nbsp;<span class="string" id="2865442">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2865448">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865452">return</span>&nbsp;<span class="ident" id="2865459">UTC</span><span class="op" id="2865462">,</span>&nbsp;<span class="ident" id="2865464">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2865469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865472">if</span>&nbsp;<span class="ident" id="2865475">name</span>&nbsp;<span class="op" id="2865480">==</span>&nbsp;<span class="string" id="2865483">&#34;Local&#34;</span>&nbsp;<span class="op" id="2865491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865495">return</span>&nbsp;<span class="ident" id="2865502">Local</span><span class="op" id="2865507">,</span>&nbsp;<span class="ident" id="2865509">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2865514">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865517">if</span>&nbsp;<span class="ident" id="2865520">zoneinfo</span>&nbsp;<span class="op" id="2865529">!=</span>&nbsp;<span class="string" id="2865532">&#34;&#34;</span>&nbsp;<span class="op" id="2865535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865539">if</span>&nbsp;<span class="ident" id="2865542">z</span><span class="op" id="2865543">,</span>&nbsp;<span class="ident" id="2865545">err</span>&nbsp;<span class="op" id="2865549">:=</span>&nbsp;<span class="ident" id="2865552">loadZoneFile</span><span class="op" id="2865564">(</span><span class="ident" id="2865565">zoneinfo</span><span class="op" id="2865573">,</span>&nbsp;<span class="ident" id="2865575">name</span><span class="op" id="2865579">)</span><span class="op" id="2865580">;</span>&nbsp;<span class="ident" id="2865582">err</span>&nbsp;<span class="op" id="2865586">==</span>&nbsp;<span class="ident" id="2865589">nil</span>&nbsp;<span class="op" id="2865593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2865598">z</span><span class="op" id="2865599">.</span><span class="ident" id="2865600">name</span>&nbsp;<span class="op" id="2865605">=</span>&nbsp;<span class="ident" id="2865607">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865615">return</span>&nbsp;<span class="ident" id="2865622">z</span><span class="op" id="2865623">,</span>&nbsp;<span class="ident" id="2865625">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2865631">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2865634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2865637">return</span>&nbsp;<span class="ident" id="2865644">loadLocation</span><span class="op" id="2865656">(</span><span class="ident" id="2865657">name</span><span class="op" id="2865661">)</span><br>
<span class="lineno"></span><span class="op" id="2865663">}</span>
</div>
</body>
</html>
