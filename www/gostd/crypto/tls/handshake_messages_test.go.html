<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6677624">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6677679">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6677733">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6677784">package</span>&nbsp;<span class="ident" id="6677792">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677797">import</span>&nbsp;<span class="op" id="6677804">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677807">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677820">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677831">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677842">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="6677858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677861">var</span>&nbsp;<span class="ident" id="6677865">tests</span>&nbsp;<span class="op" id="6677871">=</span>&nbsp;<span class="op" id="6677873">[</span><span class="op" id="6677874">]</span><span class="keyword" id="6677875">interface</span><span class="op" id="6677884">{</span><span class="op" id="6677885">}</span><span class="op" id="6677886">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677889">&amp;</span><span class="ident" id="6677890">clientHelloMsg</span><span class="op" id="6677904">{</span><span class="op" id="6677905">}</span><span class="op" id="6677906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677909">&amp;</span><span class="ident" id="6677910">serverHelloMsg</span><span class="op" id="6677924">{</span><span class="op" id="6677925">}</span><span class="op" id="6677926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677929">&amp;</span><span class="ident" id="6677930">finishedMsg</span><span class="op" id="6677941">{</span><span class="op" id="6677942">}</span><span class="op" id="6677943">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677947">&amp;</span><span class="ident" id="6677948">certificateMsg</span><span class="op" id="6677962">{</span><span class="op" id="6677963">}</span><span class="op" id="6677964">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677967">&amp;</span><span class="ident" id="6677968">certificateRequestMsg</span><span class="op" id="6677989">{</span><span class="op" id="6677990">}</span><span class="op" id="6677991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677994">&amp;</span><span class="ident" id="6677995">certificateVerifyMsg</span><span class="op" id="6678015">{</span><span class="op" id="6678016">}</span><span class="op" id="6678017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678020">&amp;</span><span class="ident" id="6678021">certificateStatusMsg</span><span class="op" id="6678041">{</span><span class="op" id="6678042">}</span><span class="op" id="6678043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678046">&amp;</span><span class="ident" id="6678047">clientKeyExchangeMsg</span><span class="op" id="6678067">{</span><span class="op" id="6678068">}</span><span class="op" id="6678069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678072">&amp;</span><span class="ident" id="6678073">nextProtoMsg</span><span class="op" id="6678085">{</span><span class="op" id="6678086">}</span><span class="op" id="6678087">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678090">&amp;</span><span class="ident" id="6678091">newSessionTicketMsg</span><span class="op" id="6678110">{</span><span class="op" id="6678111">}</span><span class="op" id="6678112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678115">&amp;</span><span class="ident" id="6678116">sessionState</span><span class="op" id="6678128">{</span><span class="op" id="6678129">}</span><span class="op" id="6678130">,</span><br>
<span class="lineno"></span><span class="op" id="6678132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6678135">type</span>&nbsp;<span class="ident" id="6678140">testMessage</span>&nbsp;<span class="keyword" id="6678152">interface</span>&nbsp;<span class="op" id="6678162">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678165">marshal</span><span class="op" id="6678172">(</span><span class="op" id="6678173">)</span>&nbsp;<span class="op" id="6678175">[</span><span class="op" id="6678176">]</span><span class="builtintype" id="6678177">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678183">unmarshal</span><span class="op" id="6678192">(</span><span class="op" id="6678193">[</span><span class="op" id="6678194">]</span><span class="builtintype" id="6678195">byte</span><span class="op" id="6678199">)</span>&nbsp;<span class="builtintype" id="6678201">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678207">equal</span><span class="op" id="6678212">(</span><span class="keyword" id="6678213">interface</span><span class="op" id="6678222">{</span><span class="op" id="6678223">}</span><span class="op" id="6678224">)</span>&nbsp;<span class="builtintype" id="6678226">bool</span><br>
<span class="lineno"></span><span class="op" id="6678231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6678234">func</span>&nbsp;<span class="ident" id="6678239">TestMarshalUnmarshal</span><span class="op" id="6678259">(</span><span class="ident" id="6678260">t</span>&nbsp;<span class="op" id="6678262">*</span><span class="ident" id="6678263">testing</span><span class="op" id="6678270">.</span><span class="ident" id="6678271">T</span><span class="op" id="6678272">)</span>&nbsp;<span class="op" id="6678274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678277">rand</span>&nbsp;<span class="op" id="6678282">:=</span>&nbsp;<span class="ident" id="6678285">rand</span><span class="op" id="6678289">.</span><span class="ident" id="6678290">New</span><span class="op" id="6678293">(</span><span class="ident" id="6678294">rand</span><span class="op" id="6678298">.</span><span class="ident" id="6678299">NewSource</span><span class="op" id="6678308">(</span><span class="num" id="6678309">0</span><span class="op" id="6678310">)</span><span class="op" id="6678311">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678315">for</span>&nbsp;<span class="ident" id="6678319">i</span><span class="op" id="6678320">,</span>&nbsp;<span class="ident" id="6678322">iface</span>&nbsp;<span class="op" id="6678328">:=</span>&nbsp;<span class="keyword" id="6678331">range</span>&nbsp;<span class="ident" id="6678337">tests</span>&nbsp;<span class="op" id="6678343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678347">ty</span>&nbsp;<span class="op" id="6678350">:=</span>&nbsp;<span class="ident" id="6678353">reflect</span><span class="op" id="6678360">.</span><span class="ident" id="6678361">ValueOf</span><span class="op" id="6678368">(</span><span class="ident" id="6678369">iface</span><span class="op" id="6678374">)</span><span class="op" id="6678375">.</span><span class="ident" id="6678376">Type</span><span class="op" id="6678380">(</span><span class="op" id="6678381">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678386">n</span>&nbsp;<span class="op" id="6678388">:=</span>&nbsp;<span class="num" id="6678391">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678397">if</span>&nbsp;<span class="ident" id="6678400">testing</span><span class="op" id="6678407">.</span><span class="ident" id="6678408">Short</span><span class="op" id="6678413">(</span><span class="op" id="6678414">)</span>&nbsp;<span class="op" id="6678416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678421">n</span>&nbsp;<span class="op" id="6678423">=</span>&nbsp;<span class="num" id="6678425">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678429">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678433">for</span>&nbsp;<span class="ident" id="6678437">j</span>&nbsp;<span class="op" id="6678439">:=</span>&nbsp;<span class="num" id="6678442">0</span><span class="op" id="6678443">;</span>&nbsp;<span class="ident" id="6678445">j</span>&nbsp;<span class="op" id="6678447">&lt;</span>&nbsp;<span class="ident" id="6678449">n</span><span class="op" id="6678450">;</span>&nbsp;<span class="ident" id="6678452">j</span><span class="op" id="6678453">++</span>&nbsp;<span class="op" id="6678456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678461">v</span><span class="op" id="6678462">,</span>&nbsp;<span class="ident" id="6678464">ok</span>&nbsp;<span class="op" id="6678467">:=</span>&nbsp;<span class="ident" id="6678470">quick</span><span class="op" id="6678475">.</span><span class="ident" id="6678476">Value</span><span class="op" id="6678481">(</span><span class="ident" id="6678482">ty</span><span class="op" id="6678484">,</span>&nbsp;<span class="ident" id="6678486">rand</span><span class="op" id="6678490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678495">if</span>&nbsp;<span class="op" id="6678498">!</span><span class="ident" id="6678499">ok</span>&nbsp;<span class="op" id="6678502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678508">t</span><span class="op" id="6678509">.</span><span class="ident" id="6678510">Errorf</span><span class="op" id="6678516">(</span><span class="string" id="6678517">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="6678546">,</span>&nbsp;<span class="ident" id="6678548">i</span><span class="op" id="6678549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678555">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678570">m1</span>&nbsp;<span class="op" id="6678573">:=</span>&nbsp;<span class="ident" id="6678576">v</span><span class="op" id="6678577">.</span><span class="ident" id="6678578">Interface</span><span class="op" id="6678587">(</span><span class="op" id="6678588">)</span><span class="op" id="6678589">.</span><span class="op" id="6678590">(</span><span class="ident" id="6678591">testMessage</span><span class="op" id="6678602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678607">marshaled</span>&nbsp;<span class="op" id="6678617">:=</span>&nbsp;<span class="ident" id="6678620">m1</span><span class="op" id="6678622">.</span><span class="ident" id="6678623">marshal</span><span class="op" id="6678630">(</span><span class="op" id="6678631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678636">m2</span>&nbsp;<span class="op" id="6678639">:=</span>&nbsp;<span class="ident" id="6678642">iface</span><span class="op" id="6678647">.</span><span class="op" id="6678648">(</span><span class="ident" id="6678649">testMessage</span><span class="op" id="6678660">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678665">if</span>&nbsp;<span class="op" id="6678668">!</span><span class="ident" id="6678669">m2</span><span class="op" id="6678671">.</span><span class="ident" id="6678672">unmarshal</span><span class="op" id="6678681">(</span><span class="ident" id="6678682">marshaled</span><span class="op" id="6678691">)</span>&nbsp;<span class="op" id="6678693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678699">t</span><span class="op" id="6678700">.</span><span class="ident" id="6678701">Errorf</span><span class="op" id="6678707">(</span><span class="string" id="6678708">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="6678740">,</span>&nbsp;<span class="ident" id="6678742">i</span><span class="op" id="6678743">,</span>&nbsp;<span class="ident" id="6678745">m1</span><span class="op" id="6678747">,</span>&nbsp;<span class="ident" id="6678749">marshaled</span><span class="op" id="6678758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678764">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678778">m2</span><span class="op" id="6678780">.</span><span class="ident" id="6678781">marshal</span><span class="op" id="6678788">(</span><span class="op" id="6678789">)</span>&nbsp;<span class="comment" id="6678791">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678839">if</span>&nbsp;<span class="op" id="6678842">!</span><span class="ident" id="6678843">m1</span><span class="op" id="6678845">.</span><span class="ident" id="6678846">equal</span><span class="op" id="6678851">(</span><span class="ident" id="6678852">m2</span><span class="op" id="6678854">)</span>&nbsp;<span class="op" id="6678856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678862">t</span><span class="op" id="6678863">.</span><span class="ident" id="6678864">Errorf</span><span class="op" id="6678870">(</span><span class="string" id="6678871">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="6678896">,</span>&nbsp;<span class="ident" id="6678898">i</span><span class="op" id="6678899">,</span>&nbsp;<span class="ident" id="6678901">m2</span><span class="op" id="6678903">,</span>&nbsp;<span class="ident" id="6678905">m1</span><span class="op" id="6678907">,</span>&nbsp;<span class="ident" id="6678909">marshaled</span><span class="op" id="6678918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678924">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678933">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678939">if</span>&nbsp;<span class="ident" id="6678942">i</span>&nbsp;<span class="op" id="6678944">&gt;=</span>&nbsp;<span class="num" id="6678947">3</span>&nbsp;<span class="op" id="6678949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6678955">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6679006">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6679054">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6679106">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6679152">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679192">for</span>&nbsp;<span class="ident" id="6679196">j</span>&nbsp;<span class="op" id="6679198">:=</span>&nbsp;<span class="num" id="6679201">0</span><span class="op" id="6679202">;</span>&nbsp;<span class="ident" id="6679204">j</span>&nbsp;<span class="op" id="6679206">&lt;</span>&nbsp;<span class="builtinfunc" id="6679208">len</span><span class="op" id="6679211">(</span><span class="ident" id="6679212">marshaled</span><span class="op" id="6679221">)</span><span class="op" id="6679222">;</span>&nbsp;<span class="ident" id="6679224">j</span><span class="op" id="6679225">++</span>&nbsp;<span class="op" id="6679228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679235">if</span>&nbsp;<span class="ident" id="6679238">m2</span><span class="op" id="6679240">.</span><span class="ident" id="6679241">unmarshal</span><span class="op" id="6679250">(</span><span class="ident" id="6679251">marshaled</span><span class="op" id="6679260">[</span><span class="num" id="6679261">0</span><span class="op" id="6679262">:</span><span class="ident" id="6679263">j</span><span class="op" id="6679264">]</span><span class="op" id="6679265">)</span>&nbsp;<span class="op" id="6679267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679275">t</span><span class="op" id="6679276">.</span><span class="ident" id="6679277">Errorf</span><span class="op" id="6679283">(</span><span class="string" id="6679284">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="6679330">,</span>&nbsp;<span class="ident" id="6679332">i</span><span class="op" id="6679333">,</span>&nbsp;<span class="ident" id="6679335">j</span><span class="op" id="6679336">,</span>&nbsp;<span class="ident" id="6679338">m1</span><span class="op" id="6679340">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679348">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679374">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679377">}</span><br>
<span class="lineno"></span><span class="op" id="6679379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6679382">func</span>&nbsp;<span class="ident" id="6679387">TestFuzz</span><span class="op" id="6679395">(</span><span class="ident" id="6679396">t</span>&nbsp;<span class="op" id="6679398">*</span><span class="ident" id="6679399">testing</span><span class="op" id="6679406">.</span><span class="ident" id="6679407">T</span><span class="op" id="6679408">)</span>&nbsp;<span class="op" id="6679410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679413">rand</span>&nbsp;<span class="op" id="6679418">:=</span>&nbsp;<span class="ident" id="6679421">rand</span><span class="op" id="6679425">.</span><span class="ident" id="6679426">New</span><span class="op" id="6679429">(</span><span class="ident" id="6679430">rand</span><span class="op" id="6679434">.</span><span class="ident" id="6679435">NewSource</span><span class="op" id="6679444">(</span><span class="num" id="6679445">0</span><span class="op" id="6679446">)</span><span class="op" id="6679447">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679450">for</span>&nbsp;<span class="ident" id="6679454">_</span><span class="op" id="6679455">,</span>&nbsp;<span class="ident" id="6679457">iface</span>&nbsp;<span class="op" id="6679463">:=</span>&nbsp;<span class="keyword" id="6679466">range</span>&nbsp;<span class="ident" id="6679472">tests</span>&nbsp;<span class="op" id="6679478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679482">m</span>&nbsp;<span class="op" id="6679484">:=</span>&nbsp;<span class="ident" id="6679487">iface</span><span class="op" id="6679492">.</span><span class="op" id="6679493">(</span><span class="ident" id="6679494">testMessage</span><span class="op" id="6679505">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679510">for</span>&nbsp;<span class="ident" id="6679514">j</span>&nbsp;<span class="op" id="6679516">:=</span>&nbsp;<span class="num" id="6679519">0</span><span class="op" id="6679520">;</span>&nbsp;<span class="ident" id="6679522">j</span>&nbsp;<span class="op" id="6679524">&lt;</span>&nbsp;<span class="num" id="6679526">1000</span><span class="op" id="6679530">;</span>&nbsp;<span class="ident" id="6679532">j</span><span class="op" id="6679533">++</span>&nbsp;<span class="op" id="6679536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6679541">len</span>&nbsp;<span class="op" id="6679545">:=</span>&nbsp;<span class="ident" id="6679548">rand</span><span class="op" id="6679552">.</span><span class="ident" id="6679553">Intn</span><span class="op" id="6679557">(</span><span class="num" id="6679558">100</span><span class="op" id="6679561">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679566">bytes</span>&nbsp;<span class="op" id="6679572">:=</span>&nbsp;<span class="ident" id="6679575">randomBytes</span><span class="op" id="6679586">(</span><span class="builtinfunc" id="6679587">len</span><span class="op" id="6679590">,</span>&nbsp;<span class="ident" id="6679592">rand</span><span class="op" id="6679596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6679601">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679661">m</span><span class="op" id="6679662">.</span><span class="ident" id="6679663">unmarshal</span><span class="op" id="6679672">(</span><span class="ident" id="6679673">bytes</span><span class="op" id="6679678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679685">}</span><br>
<span class="lineno">95</span><span class="op" id="6679687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6679690">func</span>&nbsp;<span class="ident" id="6679695">randomBytes</span><span class="op" id="6679706">(</span><span class="ident" id="6679707">n</span>&nbsp;<span class="builtintype" id="6679709">int</span><span class="op" id="6679712">,</span>&nbsp;<span class="ident" id="6679714">rand</span>&nbsp;<span class="op" id="6679719">*</span><span class="ident" id="6679720">rand</span><span class="op" id="6679724">.</span><span class="ident" id="6679725">Rand</span><span class="op" id="6679729">)</span>&nbsp;<span class="op" id="6679731">[</span><span class="op" id="6679732">]</span><span class="builtintype" id="6679733">byte</span>&nbsp;<span class="op" id="6679738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679741">r</span>&nbsp;<span class="op" id="6679743">:=</span>&nbsp;<span class="builtinfunc" id="6679746">make</span><span class="op" id="6679750">(</span><span class="op" id="6679751">[</span><span class="op" id="6679752">]</span><span class="builtintype" id="6679753">byte</span><span class="op" id="6679757">,</span>&nbsp;<span class="ident" id="6679759">n</span><span class="op" id="6679760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679763">for</span>&nbsp;<span class="ident" id="6679767">i</span>&nbsp;<span class="op" id="6679769">:=</span>&nbsp;<span class="num" id="6679772">0</span><span class="op" id="6679773">;</span>&nbsp;<span class="ident" id="6679775">i</span>&nbsp;<span class="op" id="6679777">&lt;</span>&nbsp;<span class="ident" id="6679779">n</span><span class="op" id="6679780">;</span>&nbsp;<span class="ident" id="6679782">i</span><span class="op" id="6679783">++</span>&nbsp;<span class="op" id="6679786">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679790">r</span><span class="op" id="6679791">[</span><span class="ident" id="6679792">i</span><span class="op" id="6679793">]</span>&nbsp;<span class="op" id="6679795">=</span>&nbsp;<span class="builtintype" id="6679797">byte</span><span class="op" id="6679801">(</span><span class="ident" id="6679802">rand</span><span class="op" id="6679806">.</span><span class="ident" id="6679807">Int31</span><span class="op" id="6679812">(</span><span class="op" id="6679813">)</span><span class="op" id="6679814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6679817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679820">return</span>&nbsp;<span class="ident" id="6679827">r</span><br>
<span class="lineno"></span><span class="op" id="6679829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="6679832">func</span>&nbsp;<span class="ident" id="6679837">randomString</span><span class="op" id="6679849">(</span><span class="ident" id="6679850">n</span>&nbsp;<span class="builtintype" id="6679852">int</span><span class="op" id="6679855">,</span>&nbsp;<span class="ident" id="6679857">rand</span>&nbsp;<span class="op" id="6679862">*</span><span class="ident" id="6679863">rand</span><span class="op" id="6679867">.</span><span class="ident" id="6679868">Rand</span><span class="op" id="6679872">)</span>&nbsp;<span class="builtintype" id="6679874">string</span>&nbsp;<span class="op" id="6679881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6679884">b</span>&nbsp;<span class="op" id="6679886">:=</span>&nbsp;<span class="ident" id="6679889">randomBytes</span><span class="op" id="6679900">(</span><span class="ident" id="6679901">n</span><span class="op" id="6679902">,</span>&nbsp;<span class="ident" id="6679904">rand</span><span class="op" id="6679908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6679911">return</span>&nbsp;<span class="builtintype" id="6679918">string</span><span class="op" id="6679924">(</span><span class="ident" id="6679925">b</span><span class="op" id="6679926">)</span><br>
<span class="lineno"></span><span class="op" id="6679928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6679931">func</span>&nbsp;<span class="op" id="6679936">(</span><span class="op" id="6679937">*</span><span class="ident" id="6679938">clientHelloMsg</span><span class="op" id="6679952">)</span>&nbsp;<span class="ident" id="6679954">Generate</span><span class="op" id="6679962">(</span><span class="ident" id="6679963">rand</span>&nbsp;<span class="op" id="6679968">*</span><span class="ident" id="6679969">rand</span><span class="op" id="6679973">.</span><span class="ident" id="6679974">Rand</span><span class="op" id="6679978">,</span>&nbsp;<span class="ident" id="6679980">size</span>&nbsp;<span class="builtintype" id="6679985">int</span><span class="op" id="6679988">)</span>&nbsp;<span class="ident" id="6679990">reflect</span><span class="op" id="6679997">.</span><span class="ident" id="6679998">Value</span>&nbsp;<span class="op" id="6680004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680007">m</span>&nbsp;<span class="op" id="6680009">:=</span>&nbsp;<span class="op" id="6680012">&amp;</span><span class="ident" id="6680013">clientHelloMsg</span><span class="op" id="6680027">{</span><span class="op" id="6680028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680031">m</span><span class="op" id="6680032">.</span><span class="ident" id="6680033">vers</span>&nbsp;<span class="op" id="6680038">=</span>&nbsp;<span class="builtintype" id="6680040">uint16</span><span class="op" id="6680046">(</span><span class="ident" id="6680047">rand</span><span class="op" id="6680051">.</span><span class="ident" id="6680052">Intn</span><span class="op" id="6680056">(</span><span class="num" id="6680057">65536</span><span class="op" id="6680062">)</span><span class="op" id="6680063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680066">m</span><span class="op" id="6680067">.</span><span class="ident" id="6680068">random</span>&nbsp;<span class="op" id="6680075">=</span>&nbsp;<span class="ident" id="6680077">randomBytes</span><span class="op" id="6680088">(</span><span class="num" id="6680089">32</span><span class="op" id="6680091">,</span>&nbsp;<span class="ident" id="6680093">rand</span><span class="op" id="6680097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680100">m</span><span class="op" id="6680101">.</span><span class="ident" id="6680102">sessionId</span>&nbsp;<span class="op" id="6680112">=</span>&nbsp;<span class="ident" id="6680114">randomBytes</span><span class="op" id="6680125">(</span><span class="ident" id="6680126">rand</span><span class="op" id="6680130">.</span><span class="ident" id="6680131">Intn</span><span class="op" id="6680135">(</span><span class="num" id="6680136">32</span><span class="op" id="6680138">)</span><span class="op" id="6680139">,</span>&nbsp;<span class="ident" id="6680141">rand</span><span class="op" id="6680145">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680148">m</span><span class="op" id="6680149">.</span><span class="ident" id="6680150">cipherSuites</span>&nbsp;<span class="op" id="6680163">=</span>&nbsp;<span class="builtinfunc" id="6680165">make</span><span class="op" id="6680169">(</span><span class="op" id="6680170">[</span><span class="op" id="6680171">]</span><span class="builtintype" id="6680172">uint16</span><span class="op" id="6680178">,</span>&nbsp;<span class="ident" id="6680180">rand</span><span class="op" id="6680184">.</span><span class="ident" id="6680185">Intn</span><span class="op" id="6680189">(</span><span class="num" id="6680190">63</span><span class="op" id="6680192">)</span><span class="op" id="6680193">+</span><span class="num" id="6680194">1</span><span class="op" id="6680195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680198">for</span>&nbsp;<span class="ident" id="6680202">i</span>&nbsp;<span class="op" id="6680204">:=</span>&nbsp;<span class="num" id="6680207">0</span><span class="op" id="6680208">;</span>&nbsp;<span class="ident" id="6680210">i</span>&nbsp;<span class="op" id="6680212">&lt;</span>&nbsp;<span class="builtinfunc" id="6680214">len</span><span class="op" id="6680217">(</span><span class="ident" id="6680218">m</span><span class="op" id="6680219">.</span><span class="ident" id="6680220">cipherSuites</span><span class="op" id="6680232">)</span><span class="op" id="6680233">;</span>&nbsp;<span class="ident" id="6680235">i</span><span class="op" id="6680236">++</span>&nbsp;<span class="op" id="6680239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680243">m</span><span class="op" id="6680244">.</span><span class="ident" id="6680245">cipherSuites</span><span class="op" id="6680257">[</span><span class="ident" id="6680258">i</span><span class="op" id="6680259">]</span>&nbsp;<span class="op" id="6680261">=</span>&nbsp;<span class="builtintype" id="6680263">uint16</span><span class="op" id="6680269">(</span><span class="ident" id="6680270">rand</span><span class="op" id="6680274">.</span><span class="ident" id="6680275">Int31</span><span class="op" id="6680280">(</span><span class="op" id="6680281">)</span><span class="op" id="6680282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680288">m</span><span class="op" id="6680289">.</span><span class="ident" id="6680290">compressionMethods</span>&nbsp;<span class="op" id="6680309">=</span>&nbsp;<span class="ident" id="6680311">randomBytes</span><span class="op" id="6680322">(</span><span class="ident" id="6680323">rand</span><span class="op" id="6680327">.</span><span class="ident" id="6680328">Intn</span><span class="op" id="6680332">(</span><span class="num" id="6680333">63</span><span class="op" id="6680335">)</span><span class="op" id="6680336">+</span><span class="num" id="6680337">1</span><span class="op" id="6680338">,</span>&nbsp;<span class="ident" id="6680340">rand</span><span class="op" id="6680344">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680347">if</span>&nbsp;<span class="ident" id="6680350">rand</span><span class="op" id="6680354">.</span><span class="ident" id="6680355">Intn</span><span class="op" id="6680359">(</span><span class="num" id="6680360">10</span><span class="op" id="6680362">)</span>&nbsp;<span class="op" id="6680364">&gt;</span>&nbsp;<span class="num" id="6680366">5</span>&nbsp;<span class="op" id="6680368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680372">m</span><span class="op" id="6680373">.</span><span class="ident" id="6680374">nextProtoNeg</span>&nbsp;<span class="op" id="6680387">=</span>&nbsp;<span class="builtintype" id="6680389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680398">if</span>&nbsp;<span class="ident" id="6680401">rand</span><span class="op" id="6680405">.</span><span class="ident" id="6680406">Intn</span><span class="op" id="6680410">(</span><span class="num" id="6680411">10</span><span class="op" id="6680413">)</span>&nbsp;<span class="op" id="6680415">&gt;</span>&nbsp;<span class="num" id="6680417">5</span>&nbsp;<span class="op" id="6680419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680423">m</span><span class="op" id="6680424">.</span><span class="ident" id="6680425">serverName</span>&nbsp;<span class="op" id="6680436">=</span>&nbsp;<span class="ident" id="6680438">randomString</span><span class="op" id="6680450">(</span><span class="ident" id="6680451">rand</span><span class="op" id="6680455">.</span><span class="ident" id="6680456">Intn</span><span class="op" id="6680460">(</span><span class="num" id="6680461">255</span><span class="op" id="6680464">)</span><span class="op" id="6680465">,</span>&nbsp;<span class="ident" id="6680467">rand</span><span class="op" id="6680471">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680477">m</span><span class="op" id="6680478">.</span><span class="ident" id="6680479">ocspStapling</span>&nbsp;<span class="op" id="6680492">=</span>&nbsp;<span class="ident" id="6680494">rand</span><span class="op" id="6680498">.</span><span class="ident" id="6680499">Intn</span><span class="op" id="6680503">(</span><span class="num" id="6680504">10</span><span class="op" id="6680506">)</span>&nbsp;<span class="op" id="6680508">&gt;</span>&nbsp;<span class="num" id="6680510">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680513">m</span><span class="op" id="6680514">.</span><span class="ident" id="6680515">supportedPoints</span>&nbsp;<span class="op" id="6680531">=</span>&nbsp;<span class="ident" id="6680533">randomBytes</span><span class="op" id="6680544">(</span><span class="ident" id="6680545">rand</span><span class="op" id="6680549">.</span><span class="ident" id="6680550">Intn</span><span class="op" id="6680554">(</span><span class="num" id="6680555">5</span><span class="op" id="6680556">)</span><span class="op" id="6680557">+</span><span class="num" id="6680558">1</span><span class="op" id="6680559">,</span>&nbsp;<span class="ident" id="6680561">rand</span><span class="op" id="6680565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680568">m</span><span class="op" id="6680569">.</span><span class="ident" id="6680570">supportedCurves</span>&nbsp;<span class="op" id="6680586">=</span>&nbsp;<span class="builtinfunc" id="6680588">make</span><span class="op" id="6680592">(</span><span class="op" id="6680593">[</span><span class="op" id="6680594">]</span><span class="ident" id="6680595">CurveID</span><span class="op" id="6680602">,</span>&nbsp;<span class="ident" id="6680604">rand</span><span class="op" id="6680608">.</span><span class="ident" id="6680609">Intn</span><span class="op" id="6680613">(</span><span class="num" id="6680614">5</span><span class="op" id="6680615">)</span><span class="op" id="6680616">+</span><span class="num" id="6680617">1</span><span class="op" id="6680618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680621">for</span>&nbsp;<span class="ident" id="6680625">i</span>&nbsp;<span class="op" id="6680627">:=</span>&nbsp;<span class="keyword" id="6680630">range</span>&nbsp;<span class="ident" id="6680636">m</span><span class="op" id="6680637">.</span><span class="ident" id="6680638">supportedCurves</span>&nbsp;<span class="op" id="6680654">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680658">m</span><span class="op" id="6680659">.</span><span class="ident" id="6680660">supportedCurves</span><span class="op" id="6680675">[</span><span class="ident" id="6680676">i</span><span class="op" id="6680677">]</span>&nbsp;<span class="op" id="6680679">=</span>&nbsp;<span class="ident" id="6680681">CurveID</span><span class="op" id="6680688">(</span><span class="ident" id="6680689">rand</span><span class="op" id="6680693">.</span><span class="ident" id="6680694">Intn</span><span class="op" id="6680698">(</span><span class="num" id="6680699">30000</span><span class="op" id="6680704">)</span><span class="op" id="6680705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680711">if</span>&nbsp;<span class="ident" id="6680714">rand</span><span class="op" id="6680718">.</span><span class="ident" id="6680719">Intn</span><span class="op" id="6680723">(</span><span class="num" id="6680724">10</span><span class="op" id="6680726">)</span>&nbsp;<span class="op" id="6680728">&gt;</span>&nbsp;<span class="num" id="6680730">5</span>&nbsp;<span class="op" id="6680732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680736">m</span><span class="op" id="6680737">.</span><span class="ident" id="6680738">ticketSupported</span>&nbsp;<span class="op" id="6680754">=</span>&nbsp;<span class="builtintype" id="6680756">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680763">if</span>&nbsp;<span class="ident" id="6680766">rand</span><span class="op" id="6680770">.</span><span class="ident" id="6680771">Intn</span><span class="op" id="6680775">(</span><span class="num" id="6680776">10</span><span class="op" id="6680778">)</span>&nbsp;<span class="op" id="6680780">&gt;</span>&nbsp;<span class="num" id="6680782">5</span>&nbsp;<span class="op" id="6680784">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680789">m</span><span class="op" id="6680790">.</span><span class="ident" id="6680791">sessionTicket</span>&nbsp;<span class="op" id="6680805">=</span>&nbsp;<span class="ident" id="6680807">randomBytes</span><span class="op" id="6680818">(</span><span class="ident" id="6680819">rand</span><span class="op" id="6680823">.</span><span class="ident" id="6680824">Intn</span><span class="op" id="6680828">(</span><span class="num" id="6680829">300</span><span class="op" id="6680832">)</span><span class="op" id="6680833">,</span>&nbsp;<span class="ident" id="6680835">rand</span><span class="op" id="6680839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680849">if</span>&nbsp;<span class="ident" id="6680852">rand</span><span class="op" id="6680856">.</span><span class="ident" id="6680857">Intn</span><span class="op" id="6680861">(</span><span class="num" id="6680862">10</span><span class="op" id="6680864">)</span>&nbsp;<span class="op" id="6680866">&gt;</span>&nbsp;<span class="num" id="6680868">5</span>&nbsp;<span class="op" id="6680870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680874">m</span><span class="op" id="6680875">.</span><span class="ident" id="6680876">signatureAndHashes</span>&nbsp;<span class="op" id="6680895">=</span>&nbsp;<span class="ident" id="6680897">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6680930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6680933">m</span><span class="op" id="6680934">.</span><span class="ident" id="6680935">alpnProtocols</span>&nbsp;<span class="op" id="6680949">=</span>&nbsp;<span class="builtinfunc" id="6680951">make</span><span class="op" id="6680955">(</span><span class="op" id="6680956">[</span><span class="op" id="6680957">]</span><span class="builtintype" id="6680958">string</span><span class="op" id="6680964">,</span>&nbsp;<span class="ident" id="6680966">rand</span><span class="op" id="6680970">.</span><span class="ident" id="6680971">Intn</span><span class="op" id="6680975">(</span><span class="num" id="6680976">5</span><span class="op" id="6680977">)</span><span class="op" id="6680978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6680981">for</span>&nbsp;<span class="ident" id="6680985">i</span>&nbsp;<span class="op" id="6680987">:=</span>&nbsp;<span class="keyword" id="6680990">range</span>&nbsp;<span class="ident" id="6680996">m</span><span class="op" id="6680997">.</span><span class="ident" id="6680998">alpnProtocols</span>&nbsp;<span class="op" id="6681012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681016">m</span><span class="op" id="6681017">.</span><span class="ident" id="6681018">alpnProtocols</span><span class="op" id="6681031">[</span><span class="ident" id="6681032">i</span><span class="op" id="6681033">]</span>&nbsp;<span class="op" id="6681035">=</span>&nbsp;<span class="ident" id="6681037">randomString</span><span class="op" id="6681049">(</span><span class="ident" id="6681050">rand</span><span class="op" id="6681054">.</span><span class="ident" id="6681055">Intn</span><span class="op" id="6681059">(</span><span class="num" id="6681060">20</span><span class="op" id="6681062">)</span><span class="op" id="6681063">+</span><span class="num" id="6681064">1</span><span class="op" id="6681065">,</span>&nbsp;<span class="ident" id="6681067">rand</span><span class="op" id="6681071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6681074">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681078">return</span>&nbsp;<span class="ident" id="6681085">reflect</span><span class="op" id="6681092">.</span><span class="ident" id="6681093">ValueOf</span><span class="op" id="6681100">(</span><span class="ident" id="6681101">m</span><span class="op" id="6681102">)</span><br>
<span class="lineno"></span><span class="op" id="6681104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6681107">func</span>&nbsp;<span class="op" id="6681112">(</span><span class="op" id="6681113">*</span><span class="ident" id="6681114">serverHelloMsg</span><span class="op" id="6681128">)</span>&nbsp;<span class="ident" id="6681130">Generate</span><span class="op" id="6681138">(</span><span class="ident" id="6681139">rand</span>&nbsp;<span class="op" id="6681144">*</span><span class="ident" id="6681145">rand</span><span class="op" id="6681149">.</span><span class="ident" id="6681150">Rand</span><span class="op" id="6681154">,</span>&nbsp;<span class="ident" id="6681156">size</span>&nbsp;<span class="builtintype" id="6681161">int</span><span class="op" id="6681164">)</span>&nbsp;<span class="ident" id="6681166">reflect</span><span class="op" id="6681173">.</span><span class="ident" id="6681174">Value</span>&nbsp;<span class="op" id="6681180">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681183">m</span>&nbsp;<span class="op" id="6681185">:=</span>&nbsp;<span class="op" id="6681188">&amp;</span><span class="ident" id="6681189">serverHelloMsg</span><span class="op" id="6681203">{</span><span class="op" id="6681204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681207">m</span><span class="op" id="6681208">.</span><span class="ident" id="6681209">vers</span>&nbsp;<span class="op" id="6681214">=</span>&nbsp;<span class="builtintype" id="6681216">uint16</span><span class="op" id="6681222">(</span><span class="ident" id="6681223">rand</span><span class="op" id="6681227">.</span><span class="ident" id="6681228">Intn</span><span class="op" id="6681232">(</span><span class="num" id="6681233">65536</span><span class="op" id="6681238">)</span><span class="op" id="6681239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681242">m</span><span class="op" id="6681243">.</span><span class="ident" id="6681244">random</span>&nbsp;<span class="op" id="6681251">=</span>&nbsp;<span class="ident" id="6681253">randomBytes</span><span class="op" id="6681264">(</span><span class="num" id="6681265">32</span><span class="op" id="6681267">,</span>&nbsp;<span class="ident" id="6681269">rand</span><span class="op" id="6681273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681276">m</span><span class="op" id="6681277">.</span><span class="ident" id="6681278">sessionId</span>&nbsp;<span class="op" id="6681288">=</span>&nbsp;<span class="ident" id="6681290">randomBytes</span><span class="op" id="6681301">(</span><span class="ident" id="6681302">rand</span><span class="op" id="6681306">.</span><span class="ident" id="6681307">Intn</span><span class="op" id="6681311">(</span><span class="num" id="6681312">32</span><span class="op" id="6681314">)</span><span class="op" id="6681315">,</span>&nbsp;<span class="ident" id="6681317">rand</span><span class="op" id="6681321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681324">m</span><span class="op" id="6681325">.</span><span class="ident" id="6681326">cipherSuite</span>&nbsp;<span class="op" id="6681338">=</span>&nbsp;<span class="builtintype" id="6681340">uint16</span><span class="op" id="6681346">(</span><span class="ident" id="6681347">rand</span><span class="op" id="6681351">.</span><span class="ident" id="6681352">Int31</span><span class="op" id="6681357">(</span><span class="op" id="6681358">)</span><span class="op" id="6681359">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681362">m</span><span class="op" id="6681363">.</span><span class="ident" id="6681364">compressionMethod</span>&nbsp;<span class="op" id="6681382">=</span>&nbsp;<span class="builtintype" id="6681384">uint8</span><span class="op" id="6681389">(</span><span class="ident" id="6681390">rand</span><span class="op" id="6681394">.</span><span class="ident" id="6681395">Intn</span><span class="op" id="6681399">(</span><span class="num" id="6681400">256</span><span class="op" id="6681403">)</span><span class="op" id="6681404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681408">if</span>&nbsp;<span class="ident" id="6681411">rand</span><span class="op" id="6681415">.</span><span class="ident" id="6681416">Intn</span><span class="op" id="6681420">(</span><span class="num" id="6681421">10</span><span class="op" id="6681423">)</span>&nbsp;<span class="op" id="6681425">&gt;</span>&nbsp;<span class="num" id="6681427">5</span>&nbsp;<span class="op" id="6681429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681433">m</span><span class="op" id="6681434">.</span><span class="ident" id="6681435">nextProtoNeg</span>&nbsp;<span class="op" id="6681448">=</span>&nbsp;<span class="builtintype" id="6681450">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681458">n</span>&nbsp;<span class="op" id="6681460">:=</span>&nbsp;<span class="ident" id="6681463">rand</span><span class="op" id="6681467">.</span><span class="ident" id="6681468">Intn</span><span class="op" id="6681472">(</span><span class="num" id="6681473">10</span><span class="op" id="6681475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681479">m</span><span class="op" id="6681480">.</span><span class="ident" id="6681481">nextProtos</span>&nbsp;<span class="op" id="6681492">=</span>&nbsp;<span class="builtinfunc" id="6681494">make</span><span class="op" id="6681498">(</span><span class="op" id="6681499">[</span><span class="op" id="6681500">]</span><span class="builtintype" id="6681501">string</span><span class="op" id="6681507">,</span>&nbsp;<span class="ident" id="6681509">n</span><span class="op" id="6681510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681514">for</span>&nbsp;<span class="ident" id="6681518">i</span>&nbsp;<span class="op" id="6681520">:=</span>&nbsp;<span class="num" id="6681523">0</span><span class="op" id="6681524">;</span>&nbsp;<span class="ident" id="6681526">i</span>&nbsp;<span class="op" id="6681528">&lt;</span>&nbsp;<span class="ident" id="6681530">n</span><span class="op" id="6681531">;</span>&nbsp;<span class="ident" id="6681533">i</span><span class="op" id="6681534">++</span>&nbsp;<span class="op" id="6681537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681542">m</span><span class="op" id="6681543">.</span><span class="ident" id="6681544">nextProtos</span><span class="op" id="6681554">[</span><span class="ident" id="6681555">i</span><span class="op" id="6681556">]</span>&nbsp;<span class="op" id="6681558">=</span>&nbsp;<span class="ident" id="6681560">randomString</span><span class="op" id="6681572">(</span><span class="num" id="6681573">20</span><span class="op" id="6681575">,</span>&nbsp;<span class="ident" id="6681577">rand</span><span class="op" id="6681581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6681585">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6681588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681592">if</span>&nbsp;<span class="ident" id="6681595">rand</span><span class="op" id="6681599">.</span><span class="ident" id="6681600">Intn</span><span class="op" id="6681604">(</span><span class="num" id="6681605">10</span><span class="op" id="6681607">)</span>&nbsp;<span class="op" id="6681609">&gt;</span>&nbsp;<span class="num" id="6681611">5</span>&nbsp;<span class="op" id="6681613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681617">m</span><span class="op" id="6681618">.</span><span class="ident" id="6681619">ocspStapling</span>&nbsp;<span class="op" id="6681632">=</span>&nbsp;<span class="builtintype" id="6681634">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6681640">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681643">if</span>&nbsp;<span class="ident" id="6681646">rand</span><span class="op" id="6681650">.</span><span class="ident" id="6681651">Intn</span><span class="op" id="6681655">(</span><span class="num" id="6681656">10</span><span class="op" id="6681658">)</span>&nbsp;<span class="op" id="6681660">&gt;</span>&nbsp;<span class="num" id="6681662">5</span>&nbsp;<span class="op" id="6681664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681668">m</span><span class="op" id="6681669">.</span><span class="ident" id="6681670">ticketSupported</span>&nbsp;<span class="op" id="6681686">=</span>&nbsp;<span class="builtintype" id="6681688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6681694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681697">m</span><span class="op" id="6681698">.</span><span class="ident" id="6681699">alpnProtocol</span>&nbsp;<span class="op" id="6681712">=</span>&nbsp;<span class="ident" id="6681714">randomString</span><span class="op" id="6681726">(</span><span class="ident" id="6681727">rand</span><span class="op" id="6681731">.</span><span class="ident" id="6681732">Intn</span><span class="op" id="6681736">(</span><span class="num" id="6681737">32</span><span class="op" id="6681739">)</span><span class="op" id="6681740">+</span><span class="num" id="6681741">1</span><span class="op" id="6681742">,</span>&nbsp;<span class="ident" id="6681744">rand</span><span class="op" id="6681748">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681752">return</span>&nbsp;<span class="ident" id="6681759">reflect</span><span class="op" id="6681766">.</span><span class="ident" id="6681767">ValueOf</span><span class="op" id="6681774">(</span><span class="ident" id="6681775">m</span><span class="op" id="6681776">)</span><br>
<span class="lineno"></span><span class="op" id="6681778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6681781">func</span>&nbsp;<span class="op" id="6681786">(</span><span class="op" id="6681787">*</span><span class="ident" id="6681788">certificateMsg</span><span class="op" id="6681802">)</span>&nbsp;<span class="ident" id="6681804">Generate</span><span class="op" id="6681812">(</span><span class="ident" id="6681813">rand</span>&nbsp;<span class="op" id="6681818">*</span><span class="ident" id="6681819">rand</span><span class="op" id="6681823">.</span><span class="ident" id="6681824">Rand</span><span class="op" id="6681828">,</span>&nbsp;<span class="ident" id="6681830">size</span>&nbsp;<span class="builtintype" id="6681835">int</span><span class="op" id="6681838">)</span>&nbsp;<span class="ident" id="6681840">reflect</span><span class="op" id="6681847">.</span><span class="ident" id="6681848">Value</span>&nbsp;<span class="op" id="6681854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681857">m</span>&nbsp;<span class="op" id="6681859">:=</span>&nbsp;<span class="op" id="6681862">&amp;</span><span class="ident" id="6681863">certificateMsg</span><span class="op" id="6681877">{</span><span class="op" id="6681878">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681881">numCerts</span>&nbsp;<span class="op" id="6681890">:=</span>&nbsp;<span class="ident" id="6681893">rand</span><span class="op" id="6681897">.</span><span class="ident" id="6681898">Intn</span><span class="op" id="6681902">(</span><span class="num" id="6681903">20</span><span class="op" id="6681905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681908">m</span><span class="op" id="6681909">.</span><span class="ident" id="6681910">certificates</span>&nbsp;<span class="op" id="6681923">=</span>&nbsp;<span class="builtinfunc" id="6681925">make</span><span class="op" id="6681929">(</span><span class="op" id="6681930">[</span><span class="op" id="6681931">]</span><span class="op" id="6681932">[</span><span class="op" id="6681933">]</span><span class="builtintype" id="6681934">byte</span><span class="op" id="6681938">,</span>&nbsp;<span class="ident" id="6681940">numCerts</span><span class="op" id="6681948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6681951">for</span>&nbsp;<span class="ident" id="6681955">i</span>&nbsp;<span class="op" id="6681957">:=</span>&nbsp;<span class="num" id="6681960">0</span><span class="op" id="6681961">;</span>&nbsp;<span class="ident" id="6681963">i</span>&nbsp;<span class="op" id="6681965">&lt;</span>&nbsp;<span class="ident" id="6681967">numCerts</span><span class="op" id="6681975">;</span>&nbsp;<span class="ident" id="6681977">i</span><span class="op" id="6681978">++</span>&nbsp;<span class="op" id="6681981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6681985">m</span><span class="op" id="6681986">.</span><span class="ident" id="6681987">certificates</span><span class="op" id="6681999">[</span><span class="ident" id="6682000">i</span><span class="op" id="6682001">]</span>&nbsp;<span class="op" id="6682003">=</span>&nbsp;<span class="ident" id="6682005">randomBytes</span><span class="op" id="6682016">(</span><span class="ident" id="6682017">rand</span><span class="op" id="6682021">.</span><span class="ident" id="6682022">Intn</span><span class="op" id="6682026">(</span><span class="num" id="6682027">10</span><span class="op" id="6682029">)</span><span class="op" id="6682030">+</span><span class="num" id="6682031">1</span><span class="op" id="6682032">,</span>&nbsp;<span class="ident" id="6682034">rand</span><span class="op" id="6682038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6682041">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682044">return</span>&nbsp;<span class="ident" id="6682051">reflect</span><span class="op" id="6682058">.</span><span class="ident" id="6682059">ValueOf</span><span class="op" id="6682066">(</span><span class="ident" id="6682067">m</span><span class="op" id="6682068">)</span><br>
<span class="lineno"></span><span class="op" id="6682070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6682073">func</span>&nbsp;<span class="op" id="6682078">(</span><span class="op" id="6682079">*</span><span class="ident" id="6682080">certificateRequestMsg</span><span class="op" id="6682101">)</span>&nbsp;<span class="ident" id="6682103">Generate</span><span class="op" id="6682111">(</span><span class="ident" id="6682112">rand</span>&nbsp;<span class="op" id="6682117">*</span><span class="ident" id="6682118">rand</span><span class="op" id="6682122">.</span><span class="ident" id="6682123">Rand</span><span class="op" id="6682127">,</span>&nbsp;<span class="ident" id="6682129">size</span>&nbsp;<span class="builtintype" id="6682134">int</span><span class="op" id="6682137">)</span>&nbsp;<span class="ident" id="6682139">reflect</span><span class="op" id="6682146">.</span><span class="ident" id="6682147">Value</span>&nbsp;<span class="op" id="6682153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682156">m</span>&nbsp;<span class="op" id="6682158">:=</span>&nbsp;<span class="op" id="6682161">&amp;</span><span class="ident" id="6682162">certificateRequestMsg</span><span class="op" id="6682183">{</span><span class="op" id="6682184">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682187">m</span><span class="op" id="6682188">.</span><span class="ident" id="6682189">certificateTypes</span>&nbsp;<span class="op" id="6682206">=</span>&nbsp;<span class="ident" id="6682208">randomBytes</span><span class="op" id="6682219">(</span><span class="ident" id="6682220">rand</span><span class="op" id="6682224">.</span><span class="ident" id="6682225">Intn</span><span class="op" id="6682229">(</span><span class="num" id="6682230">5</span><span class="op" id="6682231">)</span><span class="op" id="6682232">+</span><span class="num" id="6682233">1</span><span class="op" id="6682234">,</span>&nbsp;<span class="ident" id="6682236">rand</span><span class="op" id="6682240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682243">numCAs</span>&nbsp;<span class="op" id="6682250">:=</span>&nbsp;<span class="ident" id="6682253">rand</span><span class="op" id="6682257">.</span><span class="ident" id="6682258">Intn</span><span class="op" id="6682262">(</span><span class="num" id="6682263">100</span><span class="op" id="6682266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682269">m</span><span class="op" id="6682270">.</span><span class="ident" id="6682271">certificateAuthorities</span>&nbsp;<span class="op" id="6682294">=</span>&nbsp;<span class="builtinfunc" id="6682296">make</span><span class="op" id="6682300">(</span><span class="op" id="6682301">[</span><span class="op" id="6682302">]</span><span class="op" id="6682303">[</span><span class="op" id="6682304">]</span><span class="builtintype" id="6682305">byte</span><span class="op" id="6682309">,</span>&nbsp;<span class="ident" id="6682311">numCAs</span><span class="op" id="6682317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682320">for</span>&nbsp;<span class="ident" id="6682324">i</span>&nbsp;<span class="op" id="6682326">:=</span>&nbsp;<span class="num" id="6682329">0</span><span class="op" id="6682330">;</span>&nbsp;<span class="ident" id="6682332">i</span>&nbsp;<span class="op" id="6682334">&lt;</span>&nbsp;<span class="ident" id="6682336">numCAs</span><span class="op" id="6682342">;</span>&nbsp;<span class="ident" id="6682344">i</span><span class="op" id="6682345">++</span>&nbsp;<span class="op" id="6682348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682352">m</span><span class="op" id="6682353">.</span><span class="ident" id="6682354">certificateAuthorities</span><span class="op" id="6682376">[</span><span class="ident" id="6682377">i</span><span class="op" id="6682378">]</span>&nbsp;<span class="op" id="6682380">=</span>&nbsp;<span class="ident" id="6682382">randomBytes</span><span class="op" id="6682393">(</span><span class="ident" id="6682394">rand</span><span class="op" id="6682398">.</span><span class="ident" id="6682399">Intn</span><span class="op" id="6682403">(</span><span class="num" id="6682404">15</span><span class="op" id="6682406">)</span><span class="op" id="6682407">+</span><span class="num" id="6682408">1</span><span class="op" id="6682409">,</span>&nbsp;<span class="ident" id="6682411">rand</span><span class="op" id="6682415">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6682418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682421">return</span>&nbsp;<span class="ident" id="6682428">reflect</span><span class="op" id="6682435">.</span><span class="ident" id="6682436">ValueOf</span><span class="op" id="6682443">(</span><span class="ident" id="6682444">m</span><span class="op" id="6682445">)</span><br>
<span class="lineno"></span><span class="op" id="6682447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6682450">func</span>&nbsp;<span class="op" id="6682455">(</span><span class="op" id="6682456">*</span><span class="ident" id="6682457">certificateVerifyMsg</span><span class="op" id="6682477">)</span>&nbsp;<span class="ident" id="6682479">Generate</span><span class="op" id="6682487">(</span><span class="ident" id="6682488">rand</span>&nbsp;<span class="op" id="6682493">*</span><span class="ident" id="6682494">rand</span><span class="op" id="6682498">.</span><span class="ident" id="6682499">Rand</span><span class="op" id="6682503">,</span>&nbsp;<span class="ident" id="6682505">size</span>&nbsp;<span class="builtintype" id="6682510">int</span><span class="op" id="6682513">)</span>&nbsp;<span class="ident" id="6682515">reflect</span><span class="op" id="6682522">.</span><span class="ident" id="6682523">Value</span>&nbsp;<span class="op" id="6682529">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682532">m</span>&nbsp;<span class="op" id="6682534">:=</span>&nbsp;<span class="op" id="6682537">&amp;</span><span class="ident" id="6682538">certificateVerifyMsg</span><span class="op" id="6682558">{</span><span class="op" id="6682559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682562">m</span><span class="op" id="6682563">.</span><span class="ident" id="6682564">signature</span>&nbsp;<span class="op" id="6682574">=</span>&nbsp;<span class="ident" id="6682576">randomBytes</span><span class="op" id="6682587">(</span><span class="ident" id="6682588">rand</span><span class="op" id="6682592">.</span><span class="ident" id="6682593">Intn</span><span class="op" id="6682597">(</span><span class="num" id="6682598">15</span><span class="op" id="6682600">)</span><span class="op" id="6682601">+</span><span class="num" id="6682602">1</span><span class="op" id="6682603">,</span>&nbsp;<span class="ident" id="6682605">rand</span><span class="op" id="6682609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682612">return</span>&nbsp;<span class="ident" id="6682619">reflect</span><span class="op" id="6682626">.</span><span class="ident" id="6682627">ValueOf</span><span class="op" id="6682634">(</span><span class="ident" id="6682635">m</span><span class="op" id="6682636">)</span><br>
<span class="lineno"></span><span class="op" id="6682638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="6682641">func</span>&nbsp;<span class="op" id="6682646">(</span><span class="op" id="6682647">*</span><span class="ident" id="6682648">certificateStatusMsg</span><span class="op" id="6682668">)</span>&nbsp;<span class="ident" id="6682670">Generate</span><span class="op" id="6682678">(</span><span class="ident" id="6682679">rand</span>&nbsp;<span class="op" id="6682684">*</span><span class="ident" id="6682685">rand</span><span class="op" id="6682689">.</span><span class="ident" id="6682690">Rand</span><span class="op" id="6682694">,</span>&nbsp;<span class="ident" id="6682696">size</span>&nbsp;<span class="builtintype" id="6682701">int</span><span class="op" id="6682704">)</span>&nbsp;<span class="ident" id="6682706">reflect</span><span class="op" id="6682713">.</span><span class="ident" id="6682714">Value</span>&nbsp;<span class="op" id="6682720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682723">m</span>&nbsp;<span class="op" id="6682725">:=</span>&nbsp;<span class="op" id="6682728">&amp;</span><span class="ident" id="6682729">certificateStatusMsg</span><span class="op" id="6682749">{</span><span class="op" id="6682750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682753">if</span>&nbsp;<span class="ident" id="6682756">rand</span><span class="op" id="6682760">.</span><span class="ident" id="6682761">Intn</span><span class="op" id="6682765">(</span><span class="num" id="6682766">10</span><span class="op" id="6682768">)</span>&nbsp;<span class="op" id="6682770">&gt;</span>&nbsp;<span class="num" id="6682772">5</span>&nbsp;<span class="op" id="6682774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682778">m</span><span class="op" id="6682779">.</span><span class="ident" id="6682780">statusType</span>&nbsp;<span class="op" id="6682791">=</span>&nbsp;<span class="ident" id="6682793">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682810">m</span><span class="op" id="6682811">.</span><span class="ident" id="6682812">response</span>&nbsp;<span class="op" id="6682821">=</span>&nbsp;<span class="ident" id="6682823">randomBytes</span><span class="op" id="6682834">(</span><span class="ident" id="6682835">rand</span><span class="op" id="6682839">.</span><span class="ident" id="6682840">Intn</span><span class="op" id="6682844">(</span><span class="num" id="6682845">10</span><span class="op" id="6682847">)</span><span class="op" id="6682848">+</span><span class="num" id="6682849">1</span><span class="op" id="6682850">,</span>&nbsp;<span class="ident" id="6682852">rand</span><span class="op" id="6682856">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6682859">}</span>&nbsp;<span class="keyword" id="6682861">else</span>&nbsp;<span class="op" id="6682866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6682870">m</span><span class="op" id="6682871">.</span><span class="ident" id="6682872">statusType</span>&nbsp;<span class="op" id="6682883">=</span>&nbsp;<span class="num" id="6682885">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6682889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6682892">return</span>&nbsp;<span class="ident" id="6682899">reflect</span><span class="op" id="6682906">.</span><span class="ident" id="6682907">ValueOf</span><span class="op" id="6682914">(</span><span class="ident" id="6682915">m</span><span class="op" id="6682916">)</span><br>
<span class="lineno"></span><span class="op" id="6682918">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6682921">func</span>&nbsp;<span class="op" id="6682926">(</span><span class="op" id="6682927">*</span><span class="ident" id="6682928">clientKeyExchangeMsg</span><span class="op" id="6682948">)</span>&nbsp;<span class="ident" id="6682950">Generate</span><span class="op" id="6682958">(</span><span class="ident" id="6682959">rand</span>&nbsp;<span class="op" id="6682964">*</span><span class="ident" id="6682965">rand</span><span class="op" id="6682969">.</span><span class="ident" id="6682970">Rand</span><span class="op" id="6682974">,</span>&nbsp;<span class="ident" id="6682976">size</span>&nbsp;<span class="builtintype" id="6682981">int</span><span class="op" id="6682984">)</span>&nbsp;<span class="ident" id="6682986">reflect</span><span class="op" id="6682993">.</span><span class="ident" id="6682994">Value</span>&nbsp;<span class="op" id="6683000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683003">m</span>&nbsp;<span class="op" id="6683005">:=</span>&nbsp;<span class="op" id="6683008">&amp;</span><span class="ident" id="6683009">clientKeyExchangeMsg</span><span class="op" id="6683029">{</span><span class="op" id="6683030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683033">m</span><span class="op" id="6683034">.</span><span class="ident" id="6683035">ciphertext</span>&nbsp;<span class="op" id="6683046">=</span>&nbsp;<span class="ident" id="6683048">randomBytes</span><span class="op" id="6683059">(</span><span class="ident" id="6683060">rand</span><span class="op" id="6683064">.</span><span class="ident" id="6683065">Intn</span><span class="op" id="6683069">(</span><span class="num" id="6683070">1000</span><span class="op" id="6683074">)</span><span class="op" id="6683075">+</span><span class="num" id="6683076">1</span><span class="op" id="6683077">,</span>&nbsp;<span class="ident" id="6683079">rand</span><span class="op" id="6683083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6683086">return</span>&nbsp;<span class="ident" id="6683093">reflect</span><span class="op" id="6683100">.</span><span class="ident" id="6683101">ValueOf</span><span class="op" id="6683108">(</span><span class="ident" id="6683109">m</span><span class="op" id="6683110">)</span><br>
<span class="lineno">220</span><span class="op" id="6683112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6683115">func</span>&nbsp;<span class="op" id="6683120">(</span><span class="op" id="6683121">*</span><span class="ident" id="6683122">finishedMsg</span><span class="op" id="6683133">)</span>&nbsp;<span class="ident" id="6683135">Generate</span><span class="op" id="6683143">(</span><span class="ident" id="6683144">rand</span>&nbsp;<span class="op" id="6683149">*</span><span class="ident" id="6683150">rand</span><span class="op" id="6683154">.</span><span class="ident" id="6683155">Rand</span><span class="op" id="6683159">,</span>&nbsp;<span class="ident" id="6683161">size</span>&nbsp;<span class="builtintype" id="6683166">int</span><span class="op" id="6683169">)</span>&nbsp;<span class="ident" id="6683171">reflect</span><span class="op" id="6683178">.</span><span class="ident" id="6683179">Value</span>&nbsp;<span class="op" id="6683185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683188">m</span>&nbsp;<span class="op" id="6683190">:=</span>&nbsp;<span class="op" id="6683193">&amp;</span><span class="ident" id="6683194">finishedMsg</span><span class="op" id="6683205">{</span><span class="op" id="6683206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683209">m</span><span class="op" id="6683210">.</span><span class="ident" id="6683211">verifyData</span>&nbsp;<span class="op" id="6683222">=</span>&nbsp;<span class="ident" id="6683224">randomBytes</span><span class="op" id="6683235">(</span><span class="num" id="6683236">12</span><span class="op" id="6683238">,</span>&nbsp;<span class="ident" id="6683240">rand</span><span class="op" id="6683244">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6683247">return</span>&nbsp;<span class="ident" id="6683254">reflect</span><span class="op" id="6683261">.</span><span class="ident" id="6683262">ValueOf</span><span class="op" id="6683269">(</span><span class="ident" id="6683270">m</span><span class="op" id="6683271">)</span><br>
<span class="lineno"></span><span class="op" id="6683273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6683276">func</span>&nbsp;<span class="op" id="6683281">(</span><span class="op" id="6683282">*</span><span class="ident" id="6683283">nextProtoMsg</span><span class="op" id="6683295">)</span>&nbsp;<span class="ident" id="6683297">Generate</span><span class="op" id="6683305">(</span><span class="ident" id="6683306">rand</span>&nbsp;<span class="op" id="6683311">*</span><span class="ident" id="6683312">rand</span><span class="op" id="6683316">.</span><span class="ident" id="6683317">Rand</span><span class="op" id="6683321">,</span>&nbsp;<span class="ident" id="6683323">size</span>&nbsp;<span class="builtintype" id="6683328">int</span><span class="op" id="6683331">)</span>&nbsp;<span class="ident" id="6683333">reflect</span><span class="op" id="6683340">.</span><span class="ident" id="6683341">Value</span>&nbsp;<span class="op" id="6683347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683350">m</span>&nbsp;<span class="op" id="6683352">:=</span>&nbsp;<span class="op" id="6683355">&amp;</span><span class="ident" id="6683356">nextProtoMsg</span><span class="op" id="6683368">{</span><span class="op" id="6683369">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683372">m</span><span class="op" id="6683373">.</span><span class="ident" id="6683374">proto</span>&nbsp;<span class="op" id="6683380">=</span>&nbsp;<span class="ident" id="6683382">randomString</span><span class="op" id="6683394">(</span><span class="ident" id="6683395">rand</span><span class="op" id="6683399">.</span><span class="ident" id="6683400">Intn</span><span class="op" id="6683404">(</span><span class="num" id="6683405">255</span><span class="op" id="6683408">)</span><span class="op" id="6683409">,</span>&nbsp;<span class="ident" id="6683411">rand</span><span class="op" id="6683415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6683418">return</span>&nbsp;<span class="ident" id="6683425">reflect</span><span class="op" id="6683432">.</span><span class="ident" id="6683433">ValueOf</span><span class="op" id="6683440">(</span><span class="ident" id="6683441">m</span><span class="op" id="6683442">)</span><br>
<span class="lineno"></span><span class="op" id="6683444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6683447">func</span>&nbsp;<span class="op" id="6683452">(</span><span class="op" id="6683453">*</span><span class="ident" id="6683454">newSessionTicketMsg</span><span class="op" id="6683473">)</span>&nbsp;<span class="ident" id="6683475">Generate</span><span class="op" id="6683483">(</span><span class="ident" id="6683484">rand</span>&nbsp;<span class="op" id="6683489">*</span><span class="ident" id="6683490">rand</span><span class="op" id="6683494">.</span><span class="ident" id="6683495">Rand</span><span class="op" id="6683499">,</span>&nbsp;<span class="ident" id="6683501">size</span>&nbsp;<span class="builtintype" id="6683506">int</span><span class="op" id="6683509">)</span>&nbsp;<span class="ident" id="6683511">reflect</span><span class="op" id="6683518">.</span><span class="ident" id="6683519">Value</span>&nbsp;<span class="op" id="6683525">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683528">m</span>&nbsp;<span class="op" id="6683530">:=</span>&nbsp;<span class="op" id="6683533">&amp;</span><span class="ident" id="6683534">newSessionTicketMsg</span><span class="op" id="6683553">{</span><span class="op" id="6683554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683557">m</span><span class="op" id="6683558">.</span><span class="ident" id="6683559">ticket</span>&nbsp;<span class="op" id="6683566">=</span>&nbsp;<span class="ident" id="6683568">randomBytes</span><span class="op" id="6683579">(</span><span class="ident" id="6683580">rand</span><span class="op" id="6683584">.</span><span class="ident" id="6683585">Intn</span><span class="op" id="6683589">(</span><span class="num" id="6683590">4</span><span class="op" id="6683591">)</span><span class="op" id="6683592">,</span>&nbsp;<span class="ident" id="6683594">rand</span><span class="op" id="6683598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6683601">return</span>&nbsp;<span class="ident" id="6683608">reflect</span><span class="op" id="6683615">.</span><span class="ident" id="6683616">ValueOf</span><span class="op" id="6683623">(</span><span class="ident" id="6683624">m</span><span class="op" id="6683625">)</span><br>
<span class="lineno"></span><span class="op" id="6683627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="6683630">func</span>&nbsp;<span class="op" id="6683635">(</span><span class="op" id="6683636">*</span><span class="ident" id="6683637">sessionState</span><span class="op" id="6683649">)</span>&nbsp;<span class="ident" id="6683651">Generate</span><span class="op" id="6683659">(</span><span class="ident" id="6683660">rand</span>&nbsp;<span class="op" id="6683665">*</span><span class="ident" id="6683666">rand</span><span class="op" id="6683670">.</span><span class="ident" id="6683671">Rand</span><span class="op" id="6683675">,</span>&nbsp;<span class="ident" id="6683677">size</span>&nbsp;<span class="builtintype" id="6683682">int</span><span class="op" id="6683685">)</span>&nbsp;<span class="ident" id="6683687">reflect</span><span class="op" id="6683694">.</span><span class="ident" id="6683695">Value</span>&nbsp;<span class="op" id="6683701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683704">s</span>&nbsp;<span class="op" id="6683706">:=</span>&nbsp;<span class="op" id="6683709">&amp;</span><span class="ident" id="6683710">sessionState</span><span class="op" id="6683722">{</span><span class="op" id="6683723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683726">s</span><span class="op" id="6683727">.</span><span class="ident" id="6683728">vers</span>&nbsp;<span class="op" id="6683733">=</span>&nbsp;<span class="builtintype" id="6683735">uint16</span><span class="op" id="6683741">(</span><span class="ident" id="6683742">rand</span><span class="op" id="6683746">.</span><span class="ident" id="6683747">Intn</span><span class="op" id="6683751">(</span><span class="num" id="6683752">10000</span><span class="op" id="6683757">)</span><span class="op" id="6683758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683761">s</span><span class="op" id="6683762">.</span><span class="ident" id="6683763">cipherSuite</span>&nbsp;<span class="op" id="6683775">=</span>&nbsp;<span class="builtintype" id="6683777">uint16</span><span class="op" id="6683783">(</span><span class="ident" id="6683784">rand</span><span class="op" id="6683788">.</span><span class="ident" id="6683789">Intn</span><span class="op" id="6683793">(</span><span class="num" id="6683794">10000</span><span class="op" id="6683799">)</span><span class="op" id="6683800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683803">s</span><span class="op" id="6683804">.</span><span class="ident" id="6683805">masterSecret</span>&nbsp;<span class="op" id="6683818">=</span>&nbsp;<span class="ident" id="6683820">randomBytes</span><span class="op" id="6683831">(</span><span class="ident" id="6683832">rand</span><span class="op" id="6683836">.</span><span class="ident" id="6683837">Intn</span><span class="op" id="6683841">(</span><span class="num" id="6683842">100</span><span class="op" id="6683845">)</span><span class="op" id="6683846">,</span>&nbsp;<span class="ident" id="6683848">rand</span><span class="op" id="6683852">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683855">numCerts</span>&nbsp;<span class="op" id="6683864">:=</span>&nbsp;<span class="ident" id="6683867">rand</span><span class="op" id="6683871">.</span><span class="ident" id="6683872">Intn</span><span class="op" id="6683876">(</span><span class="num" id="6683877">20</span><span class="op" id="6683879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683882">s</span><span class="op" id="6683883">.</span><span class="ident" id="6683884">certificates</span>&nbsp;<span class="op" id="6683897">=</span>&nbsp;<span class="builtinfunc" id="6683899">make</span><span class="op" id="6683903">(</span><span class="op" id="6683904">[</span><span class="op" id="6683905">]</span><span class="op" id="6683906">[</span><span class="op" id="6683907">]</span><span class="builtintype" id="6683908">byte</span><span class="op" id="6683912">,</span>&nbsp;<span class="ident" id="6683914">numCerts</span><span class="op" id="6683922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6683925">for</span>&nbsp;<span class="ident" id="6683929">i</span>&nbsp;<span class="op" id="6683931">:=</span>&nbsp;<span class="num" id="6683934">0</span><span class="op" id="6683935">;</span>&nbsp;<span class="ident" id="6683937">i</span>&nbsp;<span class="op" id="6683939">&lt;</span>&nbsp;<span class="ident" id="6683941">numCerts</span><span class="op" id="6683949">;</span>&nbsp;<span class="ident" id="6683951">i</span><span class="op" id="6683952">++</span>&nbsp;<span class="op" id="6683955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6683959">s</span><span class="op" id="6683960">.</span><span class="ident" id="6683961">certificates</span><span class="op" id="6683973">[</span><span class="ident" id="6683974">i</span><span class="op" id="6683975">]</span>&nbsp;<span class="op" id="6683977">=</span>&nbsp;<span class="ident" id="6683979">randomBytes</span><span class="op" id="6683990">(</span><span class="ident" id="6683991">rand</span><span class="op" id="6683995">.</span><span class="ident" id="6683996">Intn</span><span class="op" id="6684000">(</span><span class="num" id="6684001">10</span><span class="op" id="6684003">)</span><span class="op" id="6684004">+</span><span class="num" id="6684005">1</span><span class="op" id="6684006">,</span>&nbsp;<span class="ident" id="6684008">rand</span><span class="op" id="6684012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6684015">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6684018">return</span>&nbsp;<span class="ident" id="6684025">reflect</span><span class="op" id="6684032">.</span><span class="ident" id="6684033">ValueOf</span><span class="op" id="6684040">(</span><span class="ident" id="6684041">s</span><span class="op" id="6684042">)</span><br>
<span class="lineno"></span><span class="op" id="6684044">}</span>
</div>
</body>
</html>
