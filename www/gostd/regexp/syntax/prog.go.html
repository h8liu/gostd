<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2286175">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2286230">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2286284">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2286335">package</span>&nbsp;<span class="ident" id="2286343">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286351">import</span>&nbsp;<span class="op" id="2286358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286361">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286370">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286381">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="2286391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286394">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="2286415">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2286475">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2286527">type</span>&nbsp;<span class="ident" id="2286532">Prog</span>&nbsp;<span class="keyword" id="2286537">struct</span>&nbsp;<span class="op" id="2286544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286547">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2286554">[</span><span class="op" id="2286555">]</span><span class="ident" id="2286556">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286562">Start</span>&nbsp;&nbsp;<span class="builtintype" id="2286569">int</span>&nbsp;<span class="comment" id="2286573">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286604">NumCap</span>&nbsp;<span class="builtintype" id="2286611">int</span>&nbsp;<span class="comment" id="2286615">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="2286652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286655">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="2286694">type</span>&nbsp;<span class="ident" id="2286699">InstOp</span>&nbsp;<span class="builtintype" id="2286706">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="2286713">const</span>&nbsp;<span class="op" id="2286719">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286722">InstAlt</span>&nbsp;<span class="ident" id="2286730">InstOp</span>&nbsp;<span class="op" id="2286737">=</span>&nbsp;<span class="ident" id="2286739">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286745">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286759">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286772">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286788">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286799">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286809">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286818">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286828">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286839">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286852">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="2286869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2286872">var</span>&nbsp;<span class="ident" id="2286876">instOpNames</span>&nbsp;<span class="op" id="2286888">=</span>&nbsp;<span class="op" id="2286890">[</span><span class="op" id="2286891">]</span><span class="builtintype" id="2286892">string</span><span class="op" id="2286898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286901">&#34;InstAlt&#34;</span><span class="op" id="2286910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286913">&#34;InstAltMatch&#34;</span><span class="op" id="2286927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286930">&#34;InstCapture&#34;</span><span class="op" id="2286943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286946">&#34;InstEmptyWidth&#34;</span><span class="op" id="2286962">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286965">&#34;InstMatch&#34;</span><span class="op" id="2286976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286979">&#34;InstFail&#34;</span><span class="op" id="2286989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2286992">&#34;InstNop&#34;</span><span class="op" id="2287001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2287004">&#34;InstRune&#34;</span><span class="op" id="2287014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2287017">&#34;InstRune1&#34;</span><span class="op" id="2287028">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2287031">&#34;InstRuneAny&#34;</span><span class="op" id="2287044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2287047">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="2287065">,</span><br>
<span class="lineno"></span><span class="op" id="2287067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2287070">func</span>&nbsp;<span class="op" id="2287075">(</span><span class="ident" id="2287076">i</span>&nbsp;<span class="ident" id="2287078">InstOp</span><span class="op" id="2287084">)</span>&nbsp;<span class="ident" id="2287086">String</span><span class="op" id="2287092">(</span><span class="op" id="2287093">)</span>&nbsp;<span class="builtintype" id="2287095">string</span>&nbsp;<span class="op" id="2287102">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287105">if</span>&nbsp;<span class="builtintype" id="2287108">uint</span><span class="op" id="2287112">(</span><span class="ident" id="2287113">i</span><span class="op" id="2287114">)</span>&nbsp;<span class="op" id="2287116">&gt;=</span>&nbsp;<span class="builtintype" id="2287119">uint</span><span class="op" id="2287123">(</span><span class="builtinfunc" id="2287124">len</span><span class="op" id="2287127">(</span><span class="ident" id="2287128">instOpNames</span><span class="op" id="2287139">)</span><span class="op" id="2287140">)</span>&nbsp;<span class="op" id="2287142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287146">return</span>&nbsp;<span class="string" id="2287153">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287160">return</span>&nbsp;<span class="ident" id="2287167">instOpNames</span><span class="op" id="2287178">[</span><span class="ident" id="2287179">i</span><span class="op" id="2287180">]</span><br>
<span class="lineno"></span><span class="op" id="2287182">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="2287185">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="2287253">type</span>&nbsp;<span class="ident" id="2287258">EmptyOp</span>&nbsp;<span class="builtintype" id="2287266">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2287273">const</span>&nbsp;<span class="op" id="2287279">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287282">EmptyBeginLine</span>&nbsp;<span class="ident" id="2287297">EmptyOp</span>&nbsp;<span class="op" id="2287305">=</span>&nbsp;<span class="num" id="2287307">1</span>&nbsp;<span class="op" id="2287309">&lt;&lt;</span>&nbsp;<span class="ident" id="2287312">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287318">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287332">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287348">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287362">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287381">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="2287401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2287404">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="2287456">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="2287514">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2287565">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="2287598">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2287649">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="2287676">func</span>&nbsp;<span class="ident" id="2287681">EmptyOpContext</span><span class="op" id="2287695">(</span><span class="ident" id="2287696">r1</span><span class="op" id="2287698">,</span>&nbsp;<span class="ident" id="2287700">r2</span>&nbsp;<span class="builtintype" id="2287703">rune</span><span class="op" id="2287707">)</span>&nbsp;<span class="ident" id="2287709">EmptyOp</span>&nbsp;<span class="op" id="2287717">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287720">var</span>&nbsp;<span class="ident" id="2287724">op</span>&nbsp;<span class="ident" id="2287727">EmptyOp</span>&nbsp;<span class="op" id="2287735">=</span>&nbsp;<span class="ident" id="2287737">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287758">var</span>&nbsp;<span class="ident" id="2287762">boundary</span>&nbsp;<span class="builtintype" id="2287771">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287777">switch</span>&nbsp;<span class="op" id="2287784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287787">case</span>&nbsp;<span class="ident" id="2287792">IsWordChar</span><span class="op" id="2287802">(</span><span class="ident" id="2287803">r1</span><span class="op" id="2287805">)</span><span class="op" id="2287806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287810">boundary</span>&nbsp;<span class="op" id="2287819">=</span>&nbsp;<span class="num" id="2287821">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287824">case</span>&nbsp;<span class="ident" id="2287829">r1</span>&nbsp;<span class="op" id="2287832">==</span>&nbsp;<span class="string" id="2287835">&#39;\n&#39;</span><span class="op" id="2287839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287843">op</span>&nbsp;<span class="op" id="2287846">|=</span>&nbsp;<span class="ident" id="2287849">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287865">case</span>&nbsp;<span class="ident" id="2287870">r1</span>&nbsp;<span class="op" id="2287873">&lt;</span>&nbsp;<span class="num" id="2287875">0</span><span class="op" id="2287876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287880">op</span>&nbsp;<span class="op" id="2287883">|=</span>&nbsp;<span class="ident" id="2287886">EmptyBeginText</span>&nbsp;<span class="op" id="2287901">|</span>&nbsp;<span class="ident" id="2287903">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287919">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287922">switch</span>&nbsp;<span class="op" id="2287929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287932">case</span>&nbsp;<span class="ident" id="2287937">IsWordChar</span><span class="op" id="2287947">(</span><span class="ident" id="2287948">r2</span><span class="op" id="2287950">)</span><span class="op" id="2287951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287955">boundary</span>&nbsp;<span class="op" id="2287964">^=</span>&nbsp;<span class="num" id="2287967">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287970">case</span>&nbsp;<span class="ident" id="2287975">r2</span>&nbsp;<span class="op" id="2287978">==</span>&nbsp;<span class="string" id="2287981">&#39;\n&#39;</span><span class="op" id="2287985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287989">op</span>&nbsp;<span class="op" id="2287992">|=</span>&nbsp;<span class="ident" id="2287995">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288009">case</span>&nbsp;<span class="ident" id="2288014">r2</span>&nbsp;<span class="op" id="2288017">&lt;</span>&nbsp;<span class="num" id="2288019">0</span><span class="op" id="2288020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288024">op</span>&nbsp;<span class="op" id="2288027">|=</span>&nbsp;<span class="ident" id="2288030">EmptyEndText</span>&nbsp;<span class="op" id="2288043">|</span>&nbsp;<span class="ident" id="2288045">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288062">if</span>&nbsp;<span class="ident" id="2288065">boundary</span>&nbsp;<span class="op" id="2288074">!=</span>&nbsp;<span class="num" id="2288077">0</span>&nbsp;<span class="op" id="2288079">{</span>&nbsp;<span class="comment" id="2288081">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288119">op</span>&nbsp;<span class="op" id="2288122">^=</span>&nbsp;<span class="op" id="2288125">(</span><span class="ident" id="2288126">EmptyWordBoundary</span>&nbsp;<span class="op" id="2288144">|</span>&nbsp;<span class="ident" id="2288146">EmptyNoWordBoundary</span><span class="op" id="2288165">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288171">return</span>&nbsp;<span class="ident" id="2288178">op</span><br>
<span class="lineno"></span><span class="op" id="2288181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288184">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="2288249">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="2288314">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="2288388">func</span>&nbsp;<span class="ident" id="2288393">IsWordChar</span><span class="op" id="2288403">(</span><span class="ident" id="2288404">r</span>&nbsp;<span class="builtintype" id="2288406">rune</span><span class="op" id="2288410">)</span>&nbsp;<span class="builtintype" id="2288412">bool</span>&nbsp;<span class="op" id="2288417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288420">return</span>&nbsp;<span class="string" id="2288427">&#39;A&#39;</span>&nbsp;<span class="op" id="2288431">&lt;=</span>&nbsp;<span class="ident" id="2288434">r</span>&nbsp;<span class="op" id="2288436">&amp;&amp;</span>&nbsp;<span class="ident" id="2288439">r</span>&nbsp;<span class="op" id="2288441">&lt;=</span>&nbsp;<span class="string" id="2288444">&#39;Z&#39;</span>&nbsp;<span class="op" id="2288448">||</span>&nbsp;<span class="string" id="2288451">&#39;a&#39;</span>&nbsp;<span class="op" id="2288455">&lt;=</span>&nbsp;<span class="ident" id="2288458">r</span>&nbsp;<span class="op" id="2288460">&amp;&amp;</span>&nbsp;<span class="ident" id="2288463">r</span>&nbsp;<span class="op" id="2288465">&lt;=</span>&nbsp;<span class="string" id="2288468">&#39;z&#39;</span>&nbsp;<span class="op" id="2288472">||</span>&nbsp;<span class="string" id="2288475">&#39;0&#39;</span>&nbsp;<span class="op" id="2288479">&lt;=</span>&nbsp;<span class="ident" id="2288482">r</span>&nbsp;<span class="op" id="2288484">&amp;&amp;</span>&nbsp;<span class="ident" id="2288487">r</span>&nbsp;<span class="op" id="2288489">&lt;=</span>&nbsp;<span class="string" id="2288492">&#39;9&#39;</span>&nbsp;<span class="op" id="2288496">||</span>&nbsp;<span class="ident" id="2288499">r</span>&nbsp;<span class="op" id="2288501">==</span>&nbsp;<span class="string" id="2288504">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="2288508">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2288511">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2288579">type</span>&nbsp;<span class="ident" id="2288584">Inst</span>&nbsp;<span class="keyword" id="2288589">struct</span>&nbsp;<span class="op" id="2288596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288599">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2288604">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288612">Out</span>&nbsp;&nbsp;<span class="builtintype" id="2288617">uint32</span>&nbsp;<span class="comment" id="2288624">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288656">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="2288661">uint32</span>&nbsp;<span class="comment" id="2288668">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288723">Rune</span>&nbsp;<span class="op" id="2288728">[</span><span class="op" id="2288729">]</span><span class="builtintype" id="2288730">rune</span><br>
<span class="lineno"></span><span class="op" id="2288735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288738">func</span>&nbsp;<span class="op" id="2288743">(</span><span class="ident" id="2288744">p</span>&nbsp;<span class="op" id="2288746">*</span><span class="ident" id="2288747">Prog</span><span class="op" id="2288751">)</span>&nbsp;<span class="ident" id="2288753">String</span><span class="op" id="2288759">(</span><span class="op" id="2288760">)</span>&nbsp;<span class="builtintype" id="2288762">string</span>&nbsp;<span class="op" id="2288769">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288772">var</span>&nbsp;<span class="ident" id="2288776">b</span>&nbsp;<span class="ident" id="2288778">bytes</span><span class="op" id="2288783">.</span><span class="ident" id="2288784">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288792">dumpProg</span><span class="op" id="2288800">(</span><span class="op" id="2288801">&amp;</span><span class="ident" id="2288802">b</span><span class="op" id="2288803">,</span>&nbsp;<span class="ident" id="2288805">p</span><span class="op" id="2288806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288809">return</span>&nbsp;<span class="ident" id="2288816">b</span><span class="op" id="2288817">.</span><span class="ident" id="2288818">String</span><span class="op" id="2288824">(</span><span class="op" id="2288825">)</span><br>
<span class="lineno"></span><span class="op" id="2288827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2288830">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="2288885">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="2288918">func</span>&nbsp;<span class="op" id="2288923">(</span><span class="ident" id="2288924">p</span>&nbsp;<span class="op" id="2288926">*</span><span class="ident" id="2288927">Prog</span><span class="op" id="2288931">)</span>&nbsp;<span class="ident" id="2288933">skipNop</span><span class="op" id="2288940">(</span><span class="ident" id="2288941">pc</span>&nbsp;<span class="builtintype" id="2288944">uint32</span><span class="op" id="2288950">)</span>&nbsp;<span class="op" id="2288952">(</span><span class="op" id="2288953">*</span><span class="ident" id="2288954">Inst</span><span class="op" id="2288958">,</span>&nbsp;<span class="builtintype" id="2288960">uint32</span><span class="op" id="2288966">)</span>&nbsp;<span class="op" id="2288968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288971">i</span>&nbsp;<span class="op" id="2288973">:=</span>&nbsp;<span class="op" id="2288976">&amp;</span><span class="ident" id="2288977">p</span><span class="op" id="2288978">.</span><span class="ident" id="2288979">Inst</span><span class="op" id="2288983">[</span><span class="ident" id="2288984">pc</span><span class="op" id="2288986">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288989">for</span>&nbsp;<span class="ident" id="2288993">i</span><span class="op" id="2288994">.</span><span class="ident" id="2288995">Op</span>&nbsp;<span class="op" id="2288998">==</span>&nbsp;<span class="ident" id="2289001">InstNop</span>&nbsp;<span class="op" id="2289009">||</span>&nbsp;<span class="ident" id="2289012">i</span><span class="op" id="2289013">.</span><span class="ident" id="2289014">Op</span>&nbsp;<span class="op" id="2289017">==</span>&nbsp;<span class="ident" id="2289020">InstCapture</span>&nbsp;<span class="op" id="2289032">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289036">pc</span>&nbsp;<span class="op" id="2289039">=</span>&nbsp;<span class="ident" id="2289041">i</span><span class="op" id="2289042">.</span><span class="ident" id="2289043">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289049">i</span>&nbsp;<span class="op" id="2289051">=</span>&nbsp;<span class="op" id="2289053">&amp;</span><span class="ident" id="2289054">p</span><span class="op" id="2289055">.</span><span class="ident" id="2289056">Inst</span><span class="op" id="2289060">[</span><span class="ident" id="2289061">pc</span><span class="op" id="2289063">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289069">return</span>&nbsp;<span class="ident" id="2289076">i</span><span class="op" id="2289077">,</span>&nbsp;<span class="ident" id="2289079">pc</span><br>
<span class="lineno"></span><span class="op" id="2289082">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="2289085">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="2289156">func</span>&nbsp;<span class="op" id="2289161">(</span><span class="ident" id="2289162">i</span>&nbsp;<span class="op" id="2289164">*</span><span class="ident" id="2289165">Inst</span><span class="op" id="2289169">)</span>&nbsp;<span class="ident" id="2289171">op</span><span class="op" id="2289173">(</span><span class="op" id="2289174">)</span>&nbsp;<span class="ident" id="2289176">InstOp</span>&nbsp;<span class="op" id="2289183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289186">op</span>&nbsp;<span class="op" id="2289189">:=</span>&nbsp;<span class="ident" id="2289192">i</span><span class="op" id="2289193">.</span><span class="ident" id="2289194">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289198">switch</span>&nbsp;<span class="ident" id="2289205">op</span>&nbsp;<span class="op" id="2289208">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289211">case</span>&nbsp;<span class="ident" id="2289216">InstRune1</span><span class="op" id="2289225">,</span>&nbsp;<span class="ident" id="2289227">InstRuneAny</span><span class="op" id="2289238">,</span>&nbsp;<span class="ident" id="2289240">InstRuneAnyNotNL</span><span class="op" id="2289256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289260">op</span>&nbsp;<span class="op" id="2289263">=</span>&nbsp;<span class="ident" id="2289265">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289278">return</span>&nbsp;<span class="ident" id="2289285">op</span><br>
<span class="lineno"></span><span class="op" id="2289288">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="2289291">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2289351">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="2289410">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="2289434">func</span>&nbsp;<span class="op" id="2289439">(</span><span class="ident" id="2289440">p</span>&nbsp;<span class="op" id="2289442">*</span><span class="ident" id="2289443">Prog</span><span class="op" id="2289447">)</span>&nbsp;<span class="ident" id="2289449">Prefix</span><span class="op" id="2289455">(</span><span class="op" id="2289456">)</span>&nbsp;<span class="op" id="2289458">(</span><span class="ident" id="2289459">prefix</span>&nbsp;<span class="builtintype" id="2289466">string</span><span class="op" id="2289472">,</span>&nbsp;<span class="ident" id="2289474">complete</span>&nbsp;<span class="builtintype" id="2289483">bool</span><span class="op" id="2289487">)</span>&nbsp;<span class="op" id="2289489">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289492">i</span><span class="op" id="2289493">,</span>&nbsp;<span class="ident" id="2289495">_</span>&nbsp;<span class="op" id="2289497">:=</span>&nbsp;<span class="ident" id="2289500">p</span><span class="op" id="2289501">.</span><span class="ident" id="2289502">skipNop</span><span class="op" id="2289509">(</span><span class="builtintype" id="2289510">uint32</span><span class="op" id="2289516">(</span><span class="ident" id="2289517">p</span><span class="op" id="2289518">.</span><span class="ident" id="2289519">Start</span><span class="op" id="2289524">)</span><span class="op" id="2289525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2289529">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289580">if</span>&nbsp;<span class="ident" id="2289583">i</span><span class="op" id="2289584">.</span><span class="ident" id="2289585">op</span><span class="op" id="2289587">(</span><span class="op" id="2289588">)</span>&nbsp;<span class="op" id="2289590">!=</span>&nbsp;<span class="ident" id="2289593">InstRune</span>&nbsp;<span class="op" id="2289602">||</span>&nbsp;<span class="builtinfunc" id="2289605">len</span><span class="op" id="2289608">(</span><span class="ident" id="2289609">i</span><span class="op" id="2289610">.</span><span class="ident" id="2289611">Rune</span><span class="op" id="2289615">)</span>&nbsp;<span class="op" id="2289617">!=</span>&nbsp;<span class="num" id="2289620">1</span>&nbsp;<span class="op" id="2289622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289626">return</span>&nbsp;<span class="string" id="2289633">&#34;&#34;</span><span class="op" id="2289635">,</span>&nbsp;<span class="ident" id="2289637">i</span><span class="op" id="2289638">.</span><span class="ident" id="2289639">Op</span>&nbsp;<span class="op" id="2289642">==</span>&nbsp;<span class="ident" id="2289645">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2289660">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289696">var</span>&nbsp;<span class="ident" id="2289700">buf</span>&nbsp;<span class="ident" id="2289704">bytes</span><span class="op" id="2289709">.</span><span class="ident" id="2289710">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289718">for</span>&nbsp;<span class="ident" id="2289722">i</span><span class="op" id="2289723">.</span><span class="ident" id="2289724">op</span><span class="op" id="2289726">(</span><span class="op" id="2289727">)</span>&nbsp;<span class="op" id="2289729">==</span>&nbsp;<span class="ident" id="2289732">InstRune</span>&nbsp;<span class="op" id="2289741">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2289744">len</span><span class="op" id="2289747">(</span><span class="ident" id="2289748">i</span><span class="op" id="2289749">.</span><span class="ident" id="2289750">Rune</span><span class="op" id="2289754">)</span>&nbsp;<span class="op" id="2289756">==</span>&nbsp;<span class="num" id="2289759">1</span>&nbsp;<span class="op" id="2289761">&amp;&amp;</span>&nbsp;<span class="ident" id="2289764">Flags</span><span class="op" id="2289769">(</span><span class="ident" id="2289770">i</span><span class="op" id="2289771">.</span><span class="ident" id="2289772">Arg</span><span class="op" id="2289775">)</span><span class="op" id="2289776">&amp;</span><span class="ident" id="2289777">FoldCase</span>&nbsp;<span class="op" id="2289786">==</span>&nbsp;<span class="num" id="2289789">0</span>&nbsp;<span class="op" id="2289791">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289795">buf</span><span class="op" id="2289798">.</span><span class="ident" id="2289799">WriteRune</span><span class="op" id="2289808">(</span><span class="ident" id="2289809">i</span><span class="op" id="2289810">.</span><span class="ident" id="2289811">Rune</span><span class="op" id="2289815">[</span><span class="num" id="2289816">0</span><span class="op" id="2289817">]</span><span class="op" id="2289818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289822">i</span><span class="op" id="2289823">,</span>&nbsp;<span class="ident" id="2289825">_</span>&nbsp;<span class="op" id="2289827">=</span>&nbsp;<span class="ident" id="2289829">p</span><span class="op" id="2289830">.</span><span class="ident" id="2289831">skipNop</span><span class="op" id="2289838">(</span><span class="ident" id="2289839">i</span><span class="op" id="2289840">.</span><span class="ident" id="2289841">Out</span><span class="op" id="2289844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289850">return</span>&nbsp;<span class="ident" id="2289857">buf</span><span class="op" id="2289860">.</span><span class="ident" id="2289861">String</span><span class="op" id="2289867">(</span><span class="op" id="2289868">)</span><span class="op" id="2289869">,</span>&nbsp;<span class="ident" id="2289871">i</span><span class="op" id="2289872">.</span><span class="ident" id="2289873">Op</span>&nbsp;<span class="op" id="2289876">==</span>&nbsp;<span class="ident" id="2289879">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="2289889">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2289892">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="2289958">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="2290035">func</span>&nbsp;<span class="op" id="2290040">(</span><span class="ident" id="2290041">p</span>&nbsp;<span class="op" id="2290043">*</span><span class="ident" id="2290044">Prog</span><span class="op" id="2290048">)</span>&nbsp;<span class="ident" id="2290050">StartCond</span><span class="op" id="2290059">(</span><span class="op" id="2290060">)</span>&nbsp;<span class="ident" id="2290062">EmptyOp</span>&nbsp;<span class="op" id="2290070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290073">var</span>&nbsp;<span class="ident" id="2290077">flag</span>&nbsp;<span class="ident" id="2290082">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290091">pc</span>&nbsp;<span class="op" id="2290094">:=</span>&nbsp;<span class="builtintype" id="2290097">uint32</span><span class="op" id="2290103">(</span><span class="ident" id="2290104">p</span><span class="op" id="2290105">.</span><span class="ident" id="2290106">Start</span><span class="op" id="2290111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290114">i</span>&nbsp;<span class="op" id="2290116">:=</span>&nbsp;<span class="op" id="2290119">&amp;</span><span class="ident" id="2290120">p</span><span class="op" id="2290121">.</span><span class="ident" id="2290122">Inst</span><span class="op" id="2290126">[</span><span class="ident" id="2290127">pc</span><span class="op" id="2290129">]</span><br>
<span class="lineno"></span><span class="ident" id="2290131">Loop</span><span class="op" id="2290135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290138">for</span>&nbsp;<span class="op" id="2290142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290146">switch</span>&nbsp;<span class="ident" id="2290153">i</span><span class="op" id="2290154">.</span><span class="ident" id="2290155">Op</span>&nbsp;<span class="op" id="2290158">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290162">case</span>&nbsp;<span class="ident" id="2290167">InstEmptyWidth</span><span class="op" id="2290181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290186">flag</span>&nbsp;<span class="op" id="2290191">|=</span>&nbsp;<span class="ident" id="2290194">EmptyOp</span><span class="op" id="2290201">(</span><span class="ident" id="2290202">i</span><span class="op" id="2290203">.</span><span class="ident" id="2290204">Arg</span><span class="op" id="2290207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290211">case</span>&nbsp;<span class="ident" id="2290216">InstFail</span><span class="op" id="2290224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290229">return</span>&nbsp;<span class="op" id="2290236">^</span><span class="ident" id="2290237">EmptyOp</span><span class="op" id="2290244">(</span><span class="num" id="2290245">0</span><span class="op" id="2290246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290250">case</span>&nbsp;<span class="ident" id="2290255">InstCapture</span><span class="op" id="2290266">,</span>&nbsp;<span class="ident" id="2290268">InstNop</span><span class="op" id="2290275">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2290280">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290290">default</span><span class="op" id="2290297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290302">break</span>&nbsp;<span class="ident" id="2290308">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290319">pc</span>&nbsp;<span class="op" id="2290322">=</span>&nbsp;<span class="ident" id="2290324">i</span><span class="op" id="2290325">.</span><span class="ident" id="2290326">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290332">i</span>&nbsp;<span class="op" id="2290334">=</span>&nbsp;<span class="op" id="2290336">&amp;</span><span class="ident" id="2290337">p</span><span class="op" id="2290338">.</span><span class="ident" id="2290339">Inst</span><span class="op" id="2290343">[</span><span class="ident" id="2290344">pc</span><span class="op" id="2290346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290352">return</span>&nbsp;<span class="ident" id="2290359">flag</span><br>
<span class="lineno"></span><span class="op" id="2290364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2290367">const</span>&nbsp;<span class="ident" id="2290373">noMatch</span>&nbsp;<span class="op" id="2290381">=</span>&nbsp;<span class="op" id="2290383">-</span><span class="num" id="2290384">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2290387">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="2290458">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="2290509">func</span>&nbsp;<span class="op" id="2290514">(</span><span class="ident" id="2290515">i</span>&nbsp;<span class="op" id="2290517">*</span><span class="ident" id="2290518">Inst</span><span class="op" id="2290522">)</span>&nbsp;<span class="ident" id="2290524">MatchRune</span><span class="op" id="2290533">(</span><span class="ident" id="2290534">r</span>&nbsp;<span class="builtintype" id="2290536">rune</span><span class="op" id="2290540">)</span>&nbsp;<span class="builtintype" id="2290542">bool</span>&nbsp;<span class="op" id="2290547">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290550">return</span>&nbsp;<span class="ident" id="2290557">i</span><span class="op" id="2290558">.</span><span class="ident" id="2290559">MatchRunePos</span><span class="op" id="2290571">(</span><span class="ident" id="2290572">r</span><span class="op" id="2290573">)</span>&nbsp;<span class="op" id="2290575">!=</span>&nbsp;<span class="ident" id="2290578">noMatch</span><br>
<span class="lineno"></span><span class="op" id="2290586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2290589">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="2290662">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="2290729">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="2290777">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="2290813">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="2290874">func</span>&nbsp;<span class="op" id="2290879">(</span><span class="ident" id="2290880">i</span>&nbsp;<span class="op" id="2290882">*</span><span class="ident" id="2290883">Inst</span><span class="op" id="2290887">)</span>&nbsp;<span class="ident" id="2290889">MatchRunePos</span><span class="op" id="2290901">(</span><span class="ident" id="2290902">r</span>&nbsp;<span class="builtintype" id="2290904">rune</span><span class="op" id="2290908">)</span>&nbsp;<span class="builtintype" id="2290910">int</span>&nbsp;<span class="op" id="2290914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2290917">rune</span>&nbsp;<span class="op" id="2290922">:=</span>&nbsp;<span class="ident" id="2290925">i</span><span class="op" id="2290926">.</span><span class="ident" id="2290927">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2290934">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291010">if</span>&nbsp;<span class="builtinfunc" id="2291013">len</span><span class="op" id="2291016">(</span><span class="builtintype" id="2291017">rune</span><span class="op" id="2291021">)</span>&nbsp;<span class="op" id="2291023">==</span>&nbsp;<span class="num" id="2291026">1</span>&nbsp;<span class="op" id="2291028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291032">r0</span>&nbsp;<span class="op" id="2291035">:=</span>&nbsp;<span class="builtintype" id="2291038">rune</span><span class="op" id="2291042">[</span><span class="num" id="2291043">0</span><span class="op" id="2291044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291048">if</span>&nbsp;<span class="ident" id="2291051">r</span>&nbsp;<span class="op" id="2291053">==</span>&nbsp;<span class="ident" id="2291056">r0</span>&nbsp;<span class="op" id="2291059">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291064">return</span>&nbsp;<span class="num" id="2291071">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291079">if</span>&nbsp;<span class="ident" id="2291082">Flags</span><span class="op" id="2291087">(</span><span class="ident" id="2291088">i</span><span class="op" id="2291089">.</span><span class="ident" id="2291090">Arg</span><span class="op" id="2291093">)</span><span class="op" id="2291094">&amp;</span><span class="ident" id="2291095">FoldCase</span>&nbsp;<span class="op" id="2291104">!=</span>&nbsp;<span class="num" id="2291107">0</span>&nbsp;<span class="op" id="2291109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291114">for</span>&nbsp;<span class="ident" id="2291118">r1</span>&nbsp;<span class="op" id="2291121">:=</span>&nbsp;<span class="ident" id="2291124">unicode</span><span class="op" id="2291131">.</span><span class="ident" id="2291132">SimpleFold</span><span class="op" id="2291142">(</span><span class="ident" id="2291143">r0</span><span class="op" id="2291145">)</span><span class="op" id="2291146">;</span>&nbsp;<span class="ident" id="2291148">r1</span>&nbsp;<span class="op" id="2291151">!=</span>&nbsp;<span class="ident" id="2291154">r0</span><span class="op" id="2291156">;</span>&nbsp;<span class="ident" id="2291158">r1</span>&nbsp;<span class="op" id="2291161">=</span>&nbsp;<span class="ident" id="2291163">unicode</span><span class="op" id="2291170">.</span><span class="ident" id="2291171">SimpleFold</span><span class="op" id="2291181">(</span><span class="ident" id="2291182">r1</span><span class="op" id="2291184">)</span>&nbsp;<span class="op" id="2291186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291192">if</span>&nbsp;<span class="ident" id="2291195">r</span>&nbsp;<span class="op" id="2291197">==</span>&nbsp;<span class="ident" id="2291200">r1</span>&nbsp;<span class="op" id="2291203">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291210">return</span>&nbsp;<span class="num" id="2291217">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291236">return</span>&nbsp;<span class="ident" id="2291243">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2291256">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2291289">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291319">for</span>&nbsp;<span class="ident" id="2291323">j</span>&nbsp;<span class="op" id="2291325">:=</span>&nbsp;<span class="num" id="2291328">0</span><span class="op" id="2291329">;</span>&nbsp;<span class="ident" id="2291331">j</span>&nbsp;<span class="op" id="2291333">&lt;</span>&nbsp;<span class="builtinfunc" id="2291335">len</span><span class="op" id="2291338">(</span><span class="builtintype" id="2291339">rune</span><span class="op" id="2291343">)</span>&nbsp;<span class="op" id="2291345">&amp;&amp;</span>&nbsp;<span class="ident" id="2291348">j</span>&nbsp;<span class="op" id="2291350">&lt;=</span>&nbsp;<span class="num" id="2291353">8</span><span class="op" id="2291354">;</span>&nbsp;<span class="ident" id="2291356">j</span>&nbsp;<span class="op" id="2291358">+=</span>&nbsp;<span class="num" id="2291361">2</span>&nbsp;<span class="op" id="2291363">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291367">if</span>&nbsp;<span class="ident" id="2291370">r</span>&nbsp;<span class="op" id="2291372">&lt;</span>&nbsp;<span class="builtintype" id="2291374">rune</span><span class="op" id="2291378">[</span><span class="ident" id="2291379">j</span><span class="op" id="2291380">]</span>&nbsp;<span class="op" id="2291382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291387">return</span>&nbsp;<span class="ident" id="2291394">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291408">if</span>&nbsp;<span class="ident" id="2291411">r</span>&nbsp;<span class="op" id="2291413">&lt;=</span>&nbsp;<span class="builtintype" id="2291416">rune</span><span class="op" id="2291420">[</span><span class="ident" id="2291421">j</span><span class="op" id="2291422">+</span><span class="num" id="2291423">1</span><span class="op" id="2291424">]</span>&nbsp;<span class="op" id="2291426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291431">return</span>&nbsp;<span class="ident" id="2291438">j</span>&nbsp;<span class="op" id="2291440">/</span>&nbsp;<span class="num" id="2291442">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2291453">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291482">lo</span>&nbsp;<span class="op" id="2291485">:=</span>&nbsp;<span class="num" id="2291488">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291491">hi</span>&nbsp;<span class="op" id="2291494">:=</span>&nbsp;<span class="builtinfunc" id="2291497">len</span><span class="op" id="2291500">(</span><span class="builtintype" id="2291501">rune</span><span class="op" id="2291505">)</span>&nbsp;<span class="op" id="2291507">/</span>&nbsp;<span class="num" id="2291509">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291512">for</span>&nbsp;<span class="ident" id="2291516">lo</span>&nbsp;<span class="op" id="2291519">&lt;</span>&nbsp;<span class="ident" id="2291521">hi</span>&nbsp;<span class="op" id="2291524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291528">m</span>&nbsp;<span class="op" id="2291530">:=</span>&nbsp;<span class="ident" id="2291533">lo</span>&nbsp;<span class="op" id="2291536">+</span>&nbsp;<span class="op" id="2291538">(</span><span class="ident" id="2291539">hi</span><span class="op" id="2291541">-</span><span class="ident" id="2291542">lo</span><span class="op" id="2291544">)</span><span class="op" id="2291545">/</span><span class="num" id="2291546">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291550">if</span>&nbsp;<span class="ident" id="2291553">c</span>&nbsp;<span class="op" id="2291555">:=</span>&nbsp;<span class="builtintype" id="2291558">rune</span><span class="op" id="2291562">[</span><span class="num" id="2291563">2</span><span class="op" id="2291564">*</span><span class="ident" id="2291565">m</span><span class="op" id="2291566">]</span><span class="op" id="2291567">;</span>&nbsp;<span class="ident" id="2291569">c</span>&nbsp;<span class="op" id="2291571">&lt;=</span>&nbsp;<span class="ident" id="2291574">r</span>&nbsp;<span class="op" id="2291576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291581">if</span>&nbsp;<span class="ident" id="2291584">r</span>&nbsp;<span class="op" id="2291586">&lt;=</span>&nbsp;<span class="builtintype" id="2291589">rune</span><span class="op" id="2291593">[</span><span class="num" id="2291594">2</span><span class="op" id="2291595">*</span><span class="ident" id="2291596">m</span><span class="op" id="2291597">+</span><span class="num" id="2291598">1</span><span class="op" id="2291599">]</span>&nbsp;<span class="op" id="2291601">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291607">return</span>&nbsp;<span class="ident" id="2291614">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291624">lo</span>&nbsp;<span class="op" id="2291627">=</span>&nbsp;<span class="ident" id="2291629">m</span>&nbsp;<span class="op" id="2291631">+</span>&nbsp;<span class="num" id="2291633">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291637">}</span>&nbsp;<span class="keyword" id="2291639">else</span>&nbsp;<span class="op" id="2291644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291649">hi</span>&nbsp;<span class="op" id="2291652">=</span>&nbsp;<span class="ident" id="2291654">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291664">return</span>&nbsp;<span class="ident" id="2291671">noMatch</span><br>
<span class="lineno"></span><span class="op" id="2291679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="2291682">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="2291763">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2291831">func</span>&nbsp;<span class="ident" id="2291836">wordRune</span><span class="op" id="2291844">(</span><span class="ident" id="2291845">r</span>&nbsp;<span class="builtintype" id="2291847">rune</span><span class="op" id="2291851">)</span>&nbsp;<span class="builtintype" id="2291853">bool</span>&nbsp;<span class="op" id="2291858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291861">return</span>&nbsp;<span class="ident" id="2291868">r</span>&nbsp;<span class="op" id="2291870">==</span>&nbsp;<span class="string" id="2291873">&#39;_&#39;</span>&nbsp;<span class="op" id="2291877">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291882">(</span><span class="string" id="2291883">&#39;A&#39;</span>&nbsp;<span class="op" id="2291887">&lt;=</span>&nbsp;<span class="ident" id="2291890">r</span>&nbsp;<span class="op" id="2291892">&amp;&amp;</span>&nbsp;<span class="ident" id="2291895">r</span>&nbsp;<span class="op" id="2291897">&lt;=</span>&nbsp;<span class="string" id="2291900">&#39;Z&#39;</span><span class="op" id="2291903">)</span>&nbsp;<span class="op" id="2291905">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291910">(</span><span class="string" id="2291911">&#39;a&#39;</span>&nbsp;<span class="op" id="2291915">&lt;=</span>&nbsp;<span class="ident" id="2291918">r</span>&nbsp;<span class="op" id="2291920">&amp;&amp;</span>&nbsp;<span class="ident" id="2291923">r</span>&nbsp;<span class="op" id="2291925">&lt;=</span>&nbsp;<span class="string" id="2291928">&#39;z&#39;</span><span class="op" id="2291931">)</span>&nbsp;<span class="op" id="2291933">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291938">(</span><span class="string" id="2291939">&#39;0&#39;</span>&nbsp;<span class="op" id="2291943">&lt;=</span>&nbsp;<span class="ident" id="2291946">r</span>&nbsp;<span class="op" id="2291948">&amp;&amp;</span>&nbsp;<span class="ident" id="2291951">r</span>&nbsp;<span class="op" id="2291953">&lt;=</span>&nbsp;<span class="string" id="2291956">&#39;9&#39;</span><span class="op" id="2291959">)</span><br>
<span class="lineno"></span><span class="op" id="2291961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2291964">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="2292023">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="2292078">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="2292135">func</span>&nbsp;<span class="op" id="2292140">(</span><span class="ident" id="2292141">i</span>&nbsp;<span class="op" id="2292143">*</span><span class="ident" id="2292144">Inst</span><span class="op" id="2292148">)</span>&nbsp;<span class="ident" id="2292150">MatchEmptyWidth</span><span class="op" id="2292165">(</span><span class="ident" id="2292166">before</span>&nbsp;<span class="builtintype" id="2292173">rune</span><span class="op" id="2292177">,</span>&nbsp;<span class="ident" id="2292179">after</span>&nbsp;<span class="builtintype" id="2292185">rune</span><span class="op" id="2292189">)</span>&nbsp;<span class="builtintype" id="2292191">bool</span>&nbsp;<span class="op" id="2292196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292199">switch</span>&nbsp;<span class="ident" id="2292206">EmptyOp</span><span class="op" id="2292213">(</span><span class="ident" id="2292214">i</span><span class="op" id="2292215">.</span><span class="ident" id="2292216">Arg</span><span class="op" id="2292219">)</span>&nbsp;<span class="op" id="2292221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292224">case</span>&nbsp;<span class="ident" id="2292229">EmptyBeginLine</span><span class="op" id="2292243">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292247">return</span>&nbsp;<span class="ident" id="2292254">before</span>&nbsp;<span class="op" id="2292261">==</span>&nbsp;<span class="string" id="2292264">&#39;\n&#39;</span>&nbsp;<span class="op" id="2292269">||</span>&nbsp;<span class="ident" id="2292272">before</span>&nbsp;<span class="op" id="2292279">==</span>&nbsp;<span class="op" id="2292282">-</span><span class="num" id="2292283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292286">case</span>&nbsp;<span class="ident" id="2292291">EmptyEndLine</span><span class="op" id="2292303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292307">return</span>&nbsp;<span class="ident" id="2292314">after</span>&nbsp;<span class="op" id="2292320">==</span>&nbsp;<span class="string" id="2292323">&#39;\n&#39;</span>&nbsp;<span class="op" id="2292328">||</span>&nbsp;<span class="ident" id="2292331">after</span>&nbsp;<span class="op" id="2292337">==</span>&nbsp;<span class="op" id="2292340">-</span><span class="num" id="2292341">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292344">case</span>&nbsp;<span class="ident" id="2292349">EmptyBeginText</span><span class="op" id="2292363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292367">return</span>&nbsp;<span class="ident" id="2292374">before</span>&nbsp;<span class="op" id="2292381">==</span>&nbsp;<span class="op" id="2292384">-</span><span class="num" id="2292385">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292388">case</span>&nbsp;<span class="ident" id="2292393">EmptyEndText</span><span class="op" id="2292405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292409">return</span>&nbsp;<span class="ident" id="2292416">after</span>&nbsp;<span class="op" id="2292422">==</span>&nbsp;<span class="op" id="2292425">-</span><span class="num" id="2292426">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292429">case</span>&nbsp;<span class="ident" id="2292434">EmptyWordBoundary</span><span class="op" id="2292451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292455">return</span>&nbsp;<span class="ident" id="2292462">wordRune</span><span class="op" id="2292470">(</span><span class="ident" id="2292471">before</span><span class="op" id="2292477">)</span>&nbsp;<span class="op" id="2292479">!=</span>&nbsp;<span class="ident" id="2292482">wordRune</span><span class="op" id="2292490">(</span><span class="ident" id="2292491">after</span><span class="op" id="2292496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292499">case</span>&nbsp;<span class="ident" id="2292504">EmptyNoWordBoundary</span><span class="op" id="2292523">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292527">return</span>&nbsp;<span class="ident" id="2292534">wordRune</span><span class="op" id="2292542">(</span><span class="ident" id="2292543">before</span><span class="op" id="2292549">)</span>&nbsp;<span class="op" id="2292551">==</span>&nbsp;<span class="ident" id="2292554">wordRune</span><span class="op" id="2292562">(</span><span class="ident" id="2292563">after</span><span class="op" id="2292568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2292574">panic</span><span class="op" id="2292579">(</span><span class="string" id="2292580">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="2292605">)</span><br>
<span class="lineno"></span><span class="op" id="2292607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="2292610">func</span>&nbsp;<span class="op" id="2292615">(</span><span class="ident" id="2292616">i</span>&nbsp;<span class="op" id="2292618">*</span><span class="ident" id="2292619">Inst</span><span class="op" id="2292623">)</span>&nbsp;<span class="ident" id="2292625">String</span><span class="op" id="2292631">(</span><span class="op" id="2292632">)</span>&nbsp;<span class="builtintype" id="2292634">string</span>&nbsp;<span class="op" id="2292641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292644">var</span>&nbsp;<span class="ident" id="2292648">b</span>&nbsp;<span class="ident" id="2292650">bytes</span><span class="op" id="2292655">.</span><span class="ident" id="2292656">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292664">dumpInst</span><span class="op" id="2292672">(</span><span class="op" id="2292673">&amp;</span><span class="ident" id="2292674">b</span><span class="op" id="2292675">,</span>&nbsp;<span class="ident" id="2292677">i</span><span class="op" id="2292678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292681">return</span>&nbsp;<span class="ident" id="2292688">b</span><span class="op" id="2292689">.</span><span class="ident" id="2292690">String</span><span class="op" id="2292696">(</span><span class="op" id="2292697">)</span><br>
<span class="lineno"></span><span class="op" id="2292699">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="2292702">func</span>&nbsp;<span class="ident" id="2292707">bw</span><span class="op" id="2292709">(</span><span class="ident" id="2292710">b</span>&nbsp;<span class="op" id="2292712">*</span><span class="ident" id="2292713">bytes</span><span class="op" id="2292718">.</span><span class="ident" id="2292719">Buffer</span><span class="op" id="2292725">,</span>&nbsp;<span class="ident" id="2292727">args</span>&nbsp;<span class="op" id="2292732">...</span><span class="builtintype" id="2292735">string</span><span class="op" id="2292741">)</span>&nbsp;<span class="op" id="2292743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292746">for</span>&nbsp;<span class="ident" id="2292750">_</span><span class="op" id="2292751">,</span>&nbsp;<span class="ident" id="2292753">s</span>&nbsp;<span class="op" id="2292755">:=</span>&nbsp;<span class="keyword" id="2292758">range</span>&nbsp;<span class="ident" id="2292764">args</span>&nbsp;<span class="op" id="2292769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292773">b</span><span class="op" id="2292774">.</span><span class="ident" id="2292775">WriteString</span><span class="op" id="2292786">(</span><span class="ident" id="2292787">s</span><span class="op" id="2292788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292791">}</span><br>
<span class="lineno">290</span><span class="op" id="2292793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2292796">func</span>&nbsp;<span class="ident" id="2292801">dumpProg</span><span class="op" id="2292809">(</span><span class="ident" id="2292810">b</span>&nbsp;<span class="op" id="2292812">*</span><span class="ident" id="2292813">bytes</span><span class="op" id="2292818">.</span><span class="ident" id="2292819">Buffer</span><span class="op" id="2292825">,</span>&nbsp;<span class="ident" id="2292827">p</span>&nbsp;<span class="op" id="2292829">*</span><span class="ident" id="2292830">Prog</span><span class="op" id="2292834">)</span>&nbsp;<span class="op" id="2292836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292839">for</span>&nbsp;<span class="ident" id="2292843">j</span>&nbsp;<span class="op" id="2292845">:=</span>&nbsp;<span class="keyword" id="2292848">range</span>&nbsp;<span class="ident" id="2292854">p</span><span class="op" id="2292855">.</span><span class="ident" id="2292856">Inst</span>&nbsp;<span class="op" id="2292861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292865">i</span>&nbsp;<span class="op" id="2292867">:=</span>&nbsp;<span class="op" id="2292870">&amp;</span><span class="ident" id="2292871">p</span><span class="op" id="2292872">.</span><span class="ident" id="2292873">Inst</span><span class="op" id="2292877">[</span><span class="ident" id="2292878">j</span><span class="op" id="2292879">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292883">pc</span>&nbsp;<span class="op" id="2292886">:=</span>&nbsp;<span class="ident" id="2292889">strconv</span><span class="op" id="2292896">.</span><span class="ident" id="2292897">Itoa</span><span class="op" id="2292901">(</span><span class="ident" id="2292902">j</span><span class="op" id="2292903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292907">if</span>&nbsp;<span class="builtinfunc" id="2292910">len</span><span class="op" id="2292913">(</span><span class="ident" id="2292914">pc</span><span class="op" id="2292916">)</span>&nbsp;<span class="op" id="2292918">&lt;</span>&nbsp;<span class="num" id="2292920">3</span>&nbsp;<span class="op" id="2292922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292927">b</span><span class="op" id="2292928">.</span><span class="ident" id="2292929">WriteString</span><span class="op" id="2292940">(</span><span class="string" id="2292941">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="2292946">[</span><span class="builtinfunc" id="2292947">len</span><span class="op" id="2292950">(</span><span class="ident" id="2292951">pc</span><span class="op" id="2292953">)</span><span class="op" id="2292954">:</span><span class="op" id="2292955">]</span><span class="op" id="2292956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292964">if</span>&nbsp;<span class="ident" id="2292967">j</span>&nbsp;<span class="op" id="2292969">==</span>&nbsp;<span class="ident" id="2292972">p</span><span class="op" id="2292973">.</span><span class="ident" id="2292974">Start</span>&nbsp;<span class="op" id="2292980">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292985">pc</span>&nbsp;<span class="op" id="2292988">+=</span>&nbsp;<span class="string" id="2292991">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293001">bw</span><span class="op" id="2293003">(</span><span class="ident" id="2293004">b</span><span class="op" id="2293005">,</span>&nbsp;<span class="ident" id="2293007">pc</span><span class="op" id="2293009">,</span>&nbsp;<span class="string" id="2293011">&#34;\t&#34;</span><span class="op" id="2293015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293019">dumpInst</span><span class="op" id="2293027">(</span><span class="ident" id="2293028">b</span><span class="op" id="2293029">,</span>&nbsp;<span class="ident" id="2293031">i</span><span class="op" id="2293032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293036">bw</span><span class="op" id="2293038">(</span><span class="ident" id="2293039">b</span><span class="op" id="2293040">,</span>&nbsp;<span class="string" id="2293042">&#34;\n&#34;</span><span class="op" id="2293046">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293049">}</span><br>
<span class="lineno"></span><span class="op" id="2293051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2293054">func</span>&nbsp;<span class="ident" id="2293059">u32</span><span class="op" id="2293062">(</span><span class="ident" id="2293063">i</span>&nbsp;<span class="builtintype" id="2293065">uint32</span><span class="op" id="2293071">)</span>&nbsp;<span class="builtintype" id="2293073">string</span>&nbsp;<span class="op" id="2293080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293083">return</span>&nbsp;<span class="ident" id="2293090">strconv</span><span class="op" id="2293097">.</span><span class="ident" id="2293098">FormatUint</span><span class="op" id="2293108">(</span><span class="ident" id="2293109">uint64</span><span class="op" id="2293115">(</span><span class="ident" id="2293116">i</span><span class="op" id="2293117">)</span><span class="op" id="2293118">,</span>&nbsp;<span class="num" id="2293120">10</span><span class="op" id="2293122">)</span><br>
<span class="lineno">310</span><span class="op" id="2293124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2293127">func</span>&nbsp;<span class="ident" id="2293132">dumpInst</span><span class="op" id="2293140">(</span><span class="ident" id="2293141">b</span>&nbsp;<span class="op" id="2293143">*</span><span class="ident" id="2293144">bytes</span><span class="op" id="2293149">.</span><span class="ident" id="2293150">Buffer</span><span class="op" id="2293156">,</span>&nbsp;<span class="ident" id="2293158">i</span>&nbsp;<span class="op" id="2293160">*</span><span class="ident" id="2293161">Inst</span><span class="op" id="2293165">)</span>&nbsp;<span class="op" id="2293167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293170">switch</span>&nbsp;<span class="ident" id="2293177">i</span><span class="op" id="2293178">.</span><span class="ident" id="2293179">Op</span>&nbsp;<span class="op" id="2293182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293185">case</span>&nbsp;<span class="ident" id="2293190">InstAlt</span><span class="op" id="2293197">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293201">bw</span><span class="op" id="2293203">(</span><span class="ident" id="2293204">b</span><span class="op" id="2293205">,</span>&nbsp;<span class="string" id="2293207">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293216">,</span>&nbsp;<span class="ident" id="2293218">u32</span><span class="op" id="2293221">(</span><span class="ident" id="2293222">i</span><span class="op" id="2293223">.</span><span class="ident" id="2293224">Out</span><span class="op" id="2293227">)</span><span class="op" id="2293228">,</span>&nbsp;<span class="string" id="2293230">&#34;,&nbsp;&#34;</span><span class="op" id="2293234">,</span>&nbsp;<span class="ident" id="2293236">u32</span><span class="op" id="2293239">(</span><span class="ident" id="2293240">i</span><span class="op" id="2293241">.</span><span class="ident" id="2293242">Arg</span><span class="op" id="2293245">)</span><span class="op" id="2293246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293249">case</span>&nbsp;<span class="ident" id="2293254">InstAltMatch</span><span class="op" id="2293266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293270">bw</span><span class="op" id="2293272">(</span><span class="ident" id="2293273">b</span><span class="op" id="2293274">,</span>&nbsp;<span class="string" id="2293276">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293290">,</span>&nbsp;<span class="ident" id="2293292">u32</span><span class="op" id="2293295">(</span><span class="ident" id="2293296">i</span><span class="op" id="2293297">.</span><span class="ident" id="2293298">Out</span><span class="op" id="2293301">)</span><span class="op" id="2293302">,</span>&nbsp;<span class="string" id="2293304">&#34;,&nbsp;&#34;</span><span class="op" id="2293308">,</span>&nbsp;<span class="ident" id="2293310">u32</span><span class="op" id="2293313">(</span><span class="ident" id="2293314">i</span><span class="op" id="2293315">.</span><span class="ident" id="2293316">Arg</span><span class="op" id="2293319">)</span><span class="op" id="2293320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293323">case</span>&nbsp;<span class="ident" id="2293328">InstCapture</span><span class="op" id="2293339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293343">bw</span><span class="op" id="2293345">(</span><span class="ident" id="2293346">b</span><span class="op" id="2293347">,</span>&nbsp;<span class="string" id="2293349">&#34;cap&nbsp;&#34;</span><span class="op" id="2293355">,</span>&nbsp;<span class="ident" id="2293357">u32</span><span class="op" id="2293360">(</span><span class="ident" id="2293361">i</span><span class="op" id="2293362">.</span><span class="ident" id="2293363">Arg</span><span class="op" id="2293366">)</span><span class="op" id="2293367">,</span>&nbsp;<span class="string" id="2293369">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293375">,</span>&nbsp;<span class="ident" id="2293377">u32</span><span class="op" id="2293380">(</span><span class="ident" id="2293381">i</span><span class="op" id="2293382">.</span><span class="ident" id="2293383">Out</span><span class="op" id="2293386">)</span><span class="op" id="2293387">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293390">case</span>&nbsp;<span class="ident" id="2293395">InstEmptyWidth</span><span class="op" id="2293409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293413">bw</span><span class="op" id="2293415">(</span><span class="ident" id="2293416">b</span><span class="op" id="2293417">,</span>&nbsp;<span class="string" id="2293419">&#34;empty&nbsp;&#34;</span><span class="op" id="2293427">,</span>&nbsp;<span class="ident" id="2293429">u32</span><span class="op" id="2293432">(</span><span class="ident" id="2293433">i</span><span class="op" id="2293434">.</span><span class="ident" id="2293435">Arg</span><span class="op" id="2293438">)</span><span class="op" id="2293439">,</span>&nbsp;<span class="string" id="2293441">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293447">,</span>&nbsp;<span class="ident" id="2293449">u32</span><span class="op" id="2293452">(</span><span class="ident" id="2293453">i</span><span class="op" id="2293454">.</span><span class="ident" id="2293455">Out</span><span class="op" id="2293458">)</span><span class="op" id="2293459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293462">case</span>&nbsp;<span class="ident" id="2293467">InstMatch</span><span class="op" id="2293476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293480">bw</span><span class="op" id="2293482">(</span><span class="ident" id="2293483">b</span><span class="op" id="2293484">,</span>&nbsp;<span class="string" id="2293486">&#34;match&#34;</span><span class="op" id="2293493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293496">case</span>&nbsp;<span class="ident" id="2293501">InstFail</span><span class="op" id="2293509">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293513">bw</span><span class="op" id="2293515">(</span><span class="ident" id="2293516">b</span><span class="op" id="2293517">,</span>&nbsp;<span class="string" id="2293519">&#34;fail&#34;</span><span class="op" id="2293525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293528">case</span>&nbsp;<span class="ident" id="2293533">InstNop</span><span class="op" id="2293540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293544">bw</span><span class="op" id="2293546">(</span><span class="ident" id="2293547">b</span><span class="op" id="2293548">,</span>&nbsp;<span class="string" id="2293550">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293559">,</span>&nbsp;<span class="ident" id="2293561">u32</span><span class="op" id="2293564">(</span><span class="ident" id="2293565">i</span><span class="op" id="2293566">.</span><span class="ident" id="2293567">Out</span><span class="op" id="2293570">)</span><span class="op" id="2293571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293574">case</span>&nbsp;<span class="ident" id="2293579">InstRune</span><span class="op" id="2293587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293591">if</span>&nbsp;<span class="ident" id="2293594">i</span><span class="op" id="2293595">.</span><span class="ident" id="2293596">Rune</span>&nbsp;<span class="op" id="2293601">==</span>&nbsp;<span class="ident" id="2293604">nil</span>&nbsp;<span class="op" id="2293608">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2293613">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293636">bw</span><span class="op" id="2293638">(</span><span class="ident" id="2293639">b</span><span class="op" id="2293640">,</span>&nbsp;<span class="string" id="2293642">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="2293654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293662">bw</span><span class="op" id="2293664">(</span><span class="ident" id="2293665">b</span><span class="op" id="2293666">,</span>&nbsp;<span class="string" id="2293668">&#34;rune&nbsp;&#34;</span><span class="op" id="2293675">,</span>&nbsp;<span class="ident" id="2293677">strconv</span><span class="op" id="2293684">.</span><span class="ident" id="2293685">QuoteToASCII</span><span class="op" id="2293697">(</span><span class="builtintype" id="2293698">string</span><span class="op" id="2293704">(</span><span class="ident" id="2293705">i</span><span class="op" id="2293706">.</span><span class="ident" id="2293707">Rune</span><span class="op" id="2293711">)</span><span class="op" id="2293712">)</span><span class="op" id="2293713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293717">if</span>&nbsp;<span class="ident" id="2293720">Flags</span><span class="op" id="2293725">(</span><span class="ident" id="2293726">i</span><span class="op" id="2293727">.</span><span class="ident" id="2293728">Arg</span><span class="op" id="2293731">)</span><span class="op" id="2293732">&amp;</span><span class="ident" id="2293733">FoldCase</span>&nbsp;<span class="op" id="2293742">!=</span>&nbsp;<span class="num" id="2293745">0</span>&nbsp;<span class="op" id="2293747">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293752">bw</span><span class="op" id="2293754">(</span><span class="ident" id="2293755">b</span><span class="op" id="2293756">,</span>&nbsp;<span class="string" id="2293758">&#34;/i&#34;</span><span class="op" id="2293762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293770">bw</span><span class="op" id="2293772">(</span><span class="ident" id="2293773">b</span><span class="op" id="2293774">,</span>&nbsp;<span class="string" id="2293776">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293782">,</span>&nbsp;<span class="ident" id="2293784">u32</span><span class="op" id="2293787">(</span><span class="ident" id="2293788">i</span><span class="op" id="2293789">.</span><span class="ident" id="2293790">Out</span><span class="op" id="2293793">)</span><span class="op" id="2293794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293797">case</span>&nbsp;<span class="ident" id="2293802">InstRune1</span><span class="op" id="2293811">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293815">bw</span><span class="op" id="2293817">(</span><span class="ident" id="2293818">b</span><span class="op" id="2293819">,</span>&nbsp;<span class="string" id="2293821">&#34;rune1&nbsp;&#34;</span><span class="op" id="2293829">,</span>&nbsp;<span class="ident" id="2293831">strconv</span><span class="op" id="2293838">.</span><span class="ident" id="2293839">QuoteToASCII</span><span class="op" id="2293851">(</span><span class="builtintype" id="2293852">string</span><span class="op" id="2293858">(</span><span class="ident" id="2293859">i</span><span class="op" id="2293860">.</span><span class="ident" id="2293861">Rune</span><span class="op" id="2293865">)</span><span class="op" id="2293866">)</span><span class="op" id="2293867">,</span>&nbsp;<span class="string" id="2293869">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293875">,</span>&nbsp;<span class="ident" id="2293877">u32</span><span class="op" id="2293880">(</span><span class="ident" id="2293881">i</span><span class="op" id="2293882">.</span><span class="ident" id="2293883">Out</span><span class="op" id="2293886">)</span><span class="op" id="2293887">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293890">case</span>&nbsp;<span class="ident" id="2293895">InstRuneAny</span><span class="op" id="2293906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293910">bw</span><span class="op" id="2293912">(</span><span class="ident" id="2293913">b</span><span class="op" id="2293914">,</span>&nbsp;<span class="string" id="2293916">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293925">,</span>&nbsp;<span class="ident" id="2293927">u32</span><span class="op" id="2293930">(</span><span class="ident" id="2293931">i</span><span class="op" id="2293932">.</span><span class="ident" id="2293933">Out</span><span class="op" id="2293936">)</span><span class="op" id="2293937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293940">case</span>&nbsp;<span class="ident" id="2293945">InstRuneAnyNotNL</span><span class="op" id="2293961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293965">bw</span><span class="op" id="2293967">(</span><span class="ident" id="2293968">b</span><span class="op" id="2293969">,</span>&nbsp;<span class="string" id="2293971">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="2293985">,</span>&nbsp;<span class="ident" id="2293987">u32</span><span class="op" id="2293990">(</span><span class="ident" id="2293991">i</span><span class="op" id="2293992">.</span><span class="ident" id="2293993">Out</span><span class="op" id="2293996">)</span><span class="op" id="2293997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294000">}</span><br>
<span class="lineno">345</span><span class="op" id="2294002">}</span>
</div>
</body>
</html>
