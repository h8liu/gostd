<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html" class="current">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2983304">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2983359">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2983413">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2983464">package</span>&nbsp;<span class="ident" id="2983472">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2983482">import</span>&nbsp;<span class="op" id="2983489">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2983492">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2983501">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2983508">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2983519">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2983534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2983537">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="2983601">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="2983650">func</span>&nbsp;<span class="ident" id="2983655">endsWithCSSKeyword</span><span class="op" id="2983673">(</span><span class="ident" id="2983674">b</span>&nbsp;<span class="op" id="2983676">[</span><span class="op" id="2983677">]</span><span class="builtintype" id="2983678">byte</span><span class="op" id="2983682">,</span>&nbsp;<span class="ident" id="2983684">kw</span>&nbsp;<span class="builtintype" id="2983687">string</span><span class="op" id="2983693">)</span>&nbsp;<span class="builtintype" id="2983695">bool</span>&nbsp;<span class="op" id="2983700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983703">i</span>&nbsp;<span class="op" id="2983705">:=</span>&nbsp;<span class="builtinfunc" id="2983708">len</span><span class="op" id="2983711">(</span><span class="ident" id="2983712">b</span><span class="op" id="2983713">)</span>&nbsp;<span class="op" id="2983715">-</span>&nbsp;<span class="builtinfunc" id="2983717">len</span><span class="op" id="2983720">(</span><span class="ident" id="2983721">kw</span><span class="op" id="2983723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983726">if</span>&nbsp;<span class="ident" id="2983729">i</span>&nbsp;<span class="op" id="2983731">&lt;</span>&nbsp;<span class="num" id="2983733">0</span>&nbsp;<span class="op" id="2983735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2983739">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983755">return</span>&nbsp;<span class="builtintype" id="2983762">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2983769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983772">if</span>&nbsp;<span class="ident" id="2983775">i</span>&nbsp;<span class="op" id="2983777">!=</span>&nbsp;<span class="num" id="2983780">0</span>&nbsp;<span class="op" id="2983782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983786">r</span><span class="op" id="2983787">,</span>&nbsp;<span class="ident" id="2983789">_</span>&nbsp;<span class="op" id="2983791">:=</span>&nbsp;<span class="ident" id="2983794">utf8</span><span class="op" id="2983798">.</span><span class="ident" id="2983799">DecodeLastRune</span><span class="op" id="2983813">(</span><span class="ident" id="2983814">b</span><span class="op" id="2983815">[</span><span class="op" id="2983816">:</span><span class="ident" id="2983817">i</span><span class="op" id="2983818">]</span><span class="op" id="2983819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983823">if</span>&nbsp;<span class="ident" id="2983826">isCSSNmchar</span><span class="op" id="2983837">(</span><span class="ident" id="2983838">r</span><span class="op" id="2983839">)</span>&nbsp;<span class="op" id="2983841">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2983846">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983862">return</span>&nbsp;<span class="builtintype" id="2983869">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2983877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2983880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2983883">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2983956">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984016">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984062">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984132">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2984183">return</span>&nbsp;<span class="builtintype" id="2984190">string</span><span class="op" id="2984196">(</span><span class="ident" id="2984197">bytes</span><span class="op" id="2984202">.</span><span class="ident" id="2984203">ToLower</span><span class="op" id="2984210">(</span><span class="ident" id="2984211">b</span><span class="op" id="2984212">[</span><span class="ident" id="2984213">i</span><span class="op" id="2984214">:</span><span class="op" id="2984215">]</span><span class="op" id="2984216">)</span><span class="op" id="2984217">)</span>&nbsp;<span class="op" id="2984219">==</span>&nbsp;<span class="ident" id="2984222">kw</span><br>
<span class="lineno">35</span><span class="op" id="2984225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2984228">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="2984305">func</span>&nbsp;<span class="ident" id="2984310">isCSSNmchar</span><span class="op" id="2984321">(</span><span class="ident" id="2984322">r</span>&nbsp;<span class="builtintype" id="2984324">rune</span><span class="op" id="2984328">)</span>&nbsp;<span class="builtintype" id="2984330">bool</span>&nbsp;<span class="op" id="2984335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984338">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984408">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984423">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2984475">return</span>&nbsp;<span class="string" id="2984482">&#39;a&#39;</span>&nbsp;<span class="op" id="2984486">&lt;=</span>&nbsp;<span class="ident" id="2984489">r</span>&nbsp;<span class="op" id="2984491">&amp;&amp;</span>&nbsp;<span class="ident" id="2984494">r</span>&nbsp;<span class="op" id="2984496">&lt;=</span>&nbsp;<span class="string" id="2984499">&#39;z&#39;</span>&nbsp;<span class="op" id="2984503">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2984508">&#39;A&#39;</span>&nbsp;<span class="op" id="2984512">&lt;=</span>&nbsp;<span class="ident" id="2984515">r</span>&nbsp;<span class="op" id="2984517">&amp;&amp;</span>&nbsp;<span class="ident" id="2984520">r</span>&nbsp;<span class="op" id="2984522">&lt;=</span>&nbsp;<span class="string" id="2984525">&#39;Z&#39;</span>&nbsp;<span class="op" id="2984529">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2984534">&#39;0&#39;</span>&nbsp;<span class="op" id="2984538">&lt;=</span>&nbsp;<span class="ident" id="2984541">r</span>&nbsp;<span class="op" id="2984543">&amp;&amp;</span>&nbsp;<span class="ident" id="2984546">r</span>&nbsp;<span class="op" id="2984548">&lt;=</span>&nbsp;<span class="string" id="2984551">&#39;9&#39;</span>&nbsp;<span class="op" id="2984555">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2984560">r</span>&nbsp;<span class="op" id="2984562">==</span>&nbsp;<span class="string" id="2984565">&#39;-&#39;</span>&nbsp;<span class="op" id="2984569">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2984574">r</span>&nbsp;<span class="op" id="2984576">==</span>&nbsp;<span class="string" id="2984579">&#39;_&#39;</span>&nbsp;<span class="op" id="2984583">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2984588">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2984616">0x80</span>&nbsp;<span class="op" id="2984621">&lt;=</span>&nbsp;<span class="ident" id="2984624">r</span>&nbsp;<span class="op" id="2984626">&amp;&amp;</span>&nbsp;<span class="ident" id="2984629">r</span>&nbsp;<span class="op" id="2984631">&lt;=</span>&nbsp;<span class="num" id="2984634">0xd7ff</span>&nbsp;<span class="op" id="2984641">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2984646">0xe000</span>&nbsp;<span class="op" id="2984653">&lt;=</span>&nbsp;<span class="ident" id="2984656">r</span>&nbsp;<span class="op" id="2984658">&amp;&amp;</span>&nbsp;<span class="ident" id="2984661">r</span>&nbsp;<span class="op" id="2984663">&lt;=</span>&nbsp;<span class="num" id="2984666">0xfffd</span>&nbsp;<span class="op" id="2984673">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2984678">0x10000</span>&nbsp;<span class="op" id="2984686">&lt;=</span>&nbsp;<span class="ident" id="2984689">r</span>&nbsp;<span class="op" id="2984691">&amp;&amp;</span>&nbsp;<span class="ident" id="2984694">r</span>&nbsp;<span class="op" id="2984696">&lt;=</span>&nbsp;<span class="num" id="2984699">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="2984708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2984711">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="2984778">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="2984855">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="2984881">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="2984956">func</span>&nbsp;<span class="ident" id="2984961">decodeCSS</span><span class="op" id="2984970">(</span><span class="ident" id="2984971">s</span>&nbsp;<span class="op" id="2984973">[</span><span class="op" id="2984974">]</span><span class="builtintype" id="2984975">byte</span><span class="op" id="2984979">)</span>&nbsp;<span class="op" id="2984981">[</span><span class="op" id="2984982">]</span><span class="builtintype" id="2984983">byte</span>&nbsp;<span class="op" id="2984988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2984991">i</span>&nbsp;<span class="op" id="2984993">:=</span>&nbsp;<span class="ident" id="2984996">bytes</span><span class="op" id="2985001">.</span><span class="ident" id="2985002">IndexByte</span><span class="op" id="2985011">(</span><span class="ident" id="2985012">s</span><span class="op" id="2985013">,</span>&nbsp;<span class="string" id="2985015">&#39;\\&#39;</span><span class="op" id="2985019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985022">if</span>&nbsp;<span class="ident" id="2985025">i</span>&nbsp;<span class="op" id="2985027">==</span>&nbsp;<span class="op" id="2985030">-</span><span class="num" id="2985031">1</span>&nbsp;<span class="op" id="2985033">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985037">return</span>&nbsp;<span class="ident" id="2985044">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2985047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985050">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985118">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985190">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985228">b</span>&nbsp;<span class="op" id="2985230">:=</span>&nbsp;<span class="builtinfunc" id="2985233">make</span><span class="op" id="2985237">(</span><span class="op" id="2985238">[</span><span class="op" id="2985239">]</span><span class="builtintype" id="2985240">byte</span><span class="op" id="2985244">,</span>&nbsp;<span class="num" id="2985246">0</span><span class="op" id="2985247">,</span>&nbsp;<span class="builtinfunc" id="2985249">len</span><span class="op" id="2985252">(</span><span class="ident" id="2985253">s</span><span class="op" id="2985254">)</span><span class="op" id="2985255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985258">for</span>&nbsp;<span class="builtinfunc" id="2985262">len</span><span class="op" id="2985265">(</span><span class="ident" id="2985266">s</span><span class="op" id="2985267">)</span>&nbsp;<span class="op" id="2985269">!=</span>&nbsp;<span class="num" id="2985272">0</span>&nbsp;<span class="op" id="2985274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985278">i</span>&nbsp;<span class="op" id="2985280">:=</span>&nbsp;<span class="ident" id="2985283">bytes</span><span class="op" id="2985288">.</span><span class="ident" id="2985289">IndexByte</span><span class="op" id="2985298">(</span><span class="ident" id="2985299">s</span><span class="op" id="2985300">,</span>&nbsp;<span class="string" id="2985302">&#39;\\&#39;</span><span class="op" id="2985306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985310">if</span>&nbsp;<span class="ident" id="2985313">i</span>&nbsp;<span class="op" id="2985315">==</span>&nbsp;<span class="op" id="2985318">-</span><span class="num" id="2985319">1</span>&nbsp;<span class="op" id="2985321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985326">i</span>&nbsp;<span class="op" id="2985328">=</span>&nbsp;<span class="builtinfunc" id="2985330">len</span><span class="op" id="2985333">(</span><span class="ident" id="2985334">s</span><span class="op" id="2985335">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2985339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985343">b</span><span class="op" id="2985344">,</span>&nbsp;<span class="ident" id="2985346">s</span>&nbsp;<span class="op" id="2985348">=</span>&nbsp;<span class="builtinfunc" id="2985350">append</span><span class="op" id="2985356">(</span><span class="ident" id="2985357">b</span><span class="op" id="2985358">,</span>&nbsp;<span class="ident" id="2985360">s</span><span class="op" id="2985361">[</span><span class="op" id="2985362">:</span><span class="ident" id="2985363">i</span><span class="op" id="2985364">]</span><span class="op" id="2985365">...</span><span class="op" id="2985368">)</span><span class="op" id="2985369">,</span>&nbsp;<span class="ident" id="2985371">s</span><span class="op" id="2985372">[</span><span class="ident" id="2985373">i</span><span class="op" id="2985374">:</span><span class="op" id="2985375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985379">if</span>&nbsp;<span class="builtinfunc" id="2985382">len</span><span class="op" id="2985385">(</span><span class="ident" id="2985386">s</span><span class="op" id="2985387">)</span>&nbsp;<span class="op" id="2985389">&lt;</span>&nbsp;<span class="num" id="2985391">2</span>&nbsp;<span class="op" id="2985393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985398">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2985406">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985410">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985463">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985545">if</span>&nbsp;<span class="ident" id="2985548">isHex</span><span class="op" id="2985553">(</span><span class="ident" id="2985554">s</span><span class="op" id="2985555">[</span><span class="num" id="2985556">1</span><span class="op" id="2985557">]</span><span class="op" id="2985558">)</span>&nbsp;<span class="op" id="2985560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985565">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985620">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985665">j</span>&nbsp;<span class="op" id="2985667">:=</span>&nbsp;<span class="num" id="2985670">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985675">for</span>&nbsp;<span class="ident" id="2985679">j</span>&nbsp;<span class="op" id="2985681">&lt;</span>&nbsp;<span class="builtinfunc" id="2985683">len</span><span class="op" id="2985686">(</span><span class="ident" id="2985687">s</span><span class="op" id="2985688">)</span>&nbsp;<span class="op" id="2985690">&amp;&amp;</span>&nbsp;<span class="ident" id="2985693">j</span>&nbsp;<span class="op" id="2985695">&lt;</span>&nbsp;<span class="num" id="2985697">7</span>&nbsp;<span class="op" id="2985699">&amp;&amp;</span>&nbsp;<span class="ident" id="2985702">isHex</span><span class="op" id="2985707">(</span><span class="ident" id="2985708">s</span><span class="op" id="2985709">[</span><span class="ident" id="2985710">j</span><span class="op" id="2985711">]</span><span class="op" id="2985712">)</span>&nbsp;<span class="op" id="2985714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985720">j</span><span class="op" id="2985721">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2985727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985732">r</span>&nbsp;<span class="op" id="2985734">:=</span>&nbsp;<span class="ident" id="2985737">hexDecode</span><span class="op" id="2985746">(</span><span class="ident" id="2985747">s</span><span class="op" id="2985748">[</span><span class="num" id="2985749">1</span><span class="op" id="2985750">:</span><span class="ident" id="2985751">j</span><span class="op" id="2985752">]</span><span class="op" id="2985753">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2985758">if</span>&nbsp;<span class="ident" id="2985761">r</span>&nbsp;<span class="op" id="2985763">&gt;</span>&nbsp;<span class="ident" id="2985765">unicode</span><span class="op" id="2985772">.</span><span class="ident" id="2985773">MaxRune</span>&nbsp;<span class="op" id="2985781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985787">r</span><span class="op" id="2985788">,</span>&nbsp;<span class="ident" id="2985790">j</span>&nbsp;<span class="op" id="2985792">=</span>&nbsp;<span class="ident" id="2985794">r</span><span class="op" id="2985795">/</span><span class="num" id="2985796">16</span><span class="op" id="2985798">,</span>&nbsp;<span class="ident" id="2985800">j</span><span class="op" id="2985801">-</span><span class="num" id="2985802">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2985807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2985812">n</span>&nbsp;<span class="op" id="2985814">:=</span>&nbsp;<span class="ident" id="2985817">utf8</span><span class="op" id="2985821">.</span><span class="ident" id="2985822">EncodeRune</span><span class="op" id="2985832">(</span><span class="ident" id="2985833">b</span><span class="op" id="2985834">[</span><span class="builtinfunc" id="2985835">len</span><span class="op" id="2985838">(</span><span class="ident" id="2985839">b</span><span class="op" id="2985840">)</span><span class="op" id="2985841">:</span><span class="builtinfunc" id="2985842">cap</span><span class="op" id="2985845">(</span><span class="ident" id="2985846">b</span><span class="op" id="2985847">)</span><span class="op" id="2985848">]</span><span class="op" id="2985849">,</span>&nbsp;<span class="ident" id="2985851">r</span><span class="op" id="2985852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985857">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985906">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2985954">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986003">b</span><span class="op" id="2986004">,</span>&nbsp;<span class="ident" id="2986006">s</span>&nbsp;<span class="op" id="2986008">=</span>&nbsp;<span class="ident" id="2986010">b</span><span class="op" id="2986011">[</span><span class="op" id="2986012">:</span><span class="builtinfunc" id="2986013">len</span><span class="op" id="2986016">(</span><span class="ident" id="2986017">b</span><span class="op" id="2986018">)</span><span class="op" id="2986019">+</span><span class="ident" id="2986020">n</span><span class="op" id="2986021">]</span><span class="op" id="2986022">,</span>&nbsp;<span class="ident" id="2986024">skipCSSSpace</span><span class="op" id="2986036">(</span><span class="ident" id="2986037">s</span><span class="op" id="2986038">[</span><span class="ident" id="2986039">j</span><span class="op" id="2986040">:</span><span class="op" id="2986041">]</span><span class="op" id="2986042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986046">}</span>&nbsp;<span class="keyword" id="2986048">else</span>&nbsp;<span class="op" id="2986053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2986058">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986101">_</span><span class="op" id="2986102">,</span>&nbsp;<span class="ident" id="2986104">n</span>&nbsp;<span class="op" id="2986106">:=</span>&nbsp;<span class="ident" id="2986109">utf8</span><span class="op" id="2986113">.</span><span class="ident" id="2986114">DecodeRune</span><span class="op" id="2986124">(</span><span class="ident" id="2986125">s</span><span class="op" id="2986126">[</span><span class="num" id="2986127">1</span><span class="op" id="2986128">:</span><span class="op" id="2986129">]</span><span class="op" id="2986130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986135">b</span><span class="op" id="2986136">,</span>&nbsp;<span class="ident" id="2986138">s</span>&nbsp;<span class="op" id="2986140">=</span>&nbsp;<span class="builtinfunc" id="2986142">append</span><span class="op" id="2986148">(</span><span class="ident" id="2986149">b</span><span class="op" id="2986150">,</span>&nbsp;<span class="ident" id="2986152">s</span><span class="op" id="2986153">[</span><span class="num" id="2986154">1</span><span class="op" id="2986155">:</span><span class="num" id="2986156">1</span><span class="op" id="2986157">+</span><span class="ident" id="2986158">n</span><span class="op" id="2986159">]</span><span class="op" id="2986160">...</span><span class="op" id="2986163">)</span><span class="op" id="2986164">,</span>&nbsp;<span class="ident" id="2986166">s</span><span class="op" id="2986167">[</span><span class="num" id="2986168">1</span><span class="op" id="2986169">+</span><span class="ident" id="2986170">n</span><span class="op" id="2986171">:</span><span class="op" id="2986172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986182">return</span>&nbsp;<span class="ident" id="2986189">b</span><br>
<span class="lineno">100</span><span class="op" id="2986191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2986194">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="2986255">func</span>&nbsp;<span class="ident" id="2986260">isHex</span><span class="op" id="2986265">(</span><span class="ident" id="2986266">c</span>&nbsp;<span class="builtintype" id="2986268">byte</span><span class="op" id="2986272">)</span>&nbsp;<span class="builtintype" id="2986274">bool</span>&nbsp;<span class="op" id="2986279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986282">return</span>&nbsp;<span class="string" id="2986289">&#39;0&#39;</span>&nbsp;<span class="op" id="2986293">&lt;=</span>&nbsp;<span class="ident" id="2986296">c</span>&nbsp;<span class="op" id="2986298">&amp;&amp;</span>&nbsp;<span class="ident" id="2986301">c</span>&nbsp;<span class="op" id="2986303">&lt;=</span>&nbsp;<span class="string" id="2986306">&#39;9&#39;</span>&nbsp;<span class="op" id="2986310">||</span>&nbsp;<span class="string" id="2986313">&#39;a&#39;</span>&nbsp;<span class="op" id="2986317">&lt;=</span>&nbsp;<span class="ident" id="2986320">c</span>&nbsp;<span class="op" id="2986322">&amp;&amp;</span>&nbsp;<span class="ident" id="2986325">c</span>&nbsp;<span class="op" id="2986327">&lt;=</span>&nbsp;<span class="string" id="2986330">&#39;f&#39;</span>&nbsp;<span class="op" id="2986334">||</span>&nbsp;<span class="string" id="2986337">&#39;A&#39;</span>&nbsp;<span class="op" id="2986341">&lt;=</span>&nbsp;<span class="ident" id="2986344">c</span>&nbsp;<span class="op" id="2986346">&amp;&amp;</span>&nbsp;<span class="ident" id="2986349">c</span>&nbsp;<span class="op" id="2986351">&lt;=</span>&nbsp;<span class="string" id="2986354">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="2986358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2986361">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="2986422">func</span>&nbsp;<span class="ident" id="2986427">hexDecode</span><span class="op" id="2986436">(</span><span class="ident" id="2986437">s</span>&nbsp;<span class="op" id="2986439">[</span><span class="op" id="2986440">]</span><span class="builtintype" id="2986441">byte</span><span class="op" id="2986445">)</span>&nbsp;<span class="builtintype" id="2986447">rune</span>&nbsp;<span class="op" id="2986452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986455">n</span>&nbsp;<span class="op" id="2986457">:=</span>&nbsp;<span class="string" id="2986460">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986468">for</span>&nbsp;<span class="ident" id="2986472">_</span><span class="op" id="2986473">,</span>&nbsp;<span class="ident" id="2986475">c</span>&nbsp;<span class="op" id="2986477">:=</span>&nbsp;<span class="keyword" id="2986480">range</span>&nbsp;<span class="ident" id="2986486">s</span>&nbsp;<span class="op" id="2986488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986492">n</span>&nbsp;<span class="op" id="2986494">&lt;&lt;=</span>&nbsp;<span class="num" id="2986498">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986502">switch</span>&nbsp;<span class="op" id="2986509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986513">case</span>&nbsp;<span class="string" id="2986518">&#39;0&#39;</span>&nbsp;<span class="op" id="2986522">&lt;=</span>&nbsp;<span class="ident" id="2986525">c</span>&nbsp;<span class="op" id="2986527">&amp;&amp;</span>&nbsp;<span class="ident" id="2986530">c</span>&nbsp;<span class="op" id="2986532">&lt;=</span>&nbsp;<span class="string" id="2986535">&#39;9&#39;</span><span class="op" id="2986538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986543">n</span>&nbsp;<span class="op" id="2986545">|=</span>&nbsp;<span class="builtintype" id="2986548">rune</span><span class="op" id="2986552">(</span><span class="ident" id="2986553">c</span>&nbsp;<span class="op" id="2986555">-</span>&nbsp;<span class="string" id="2986557">&#39;0&#39;</span><span class="op" id="2986560">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986564">case</span>&nbsp;<span class="string" id="2986569">&#39;a&#39;</span>&nbsp;<span class="op" id="2986573">&lt;=</span>&nbsp;<span class="ident" id="2986576">c</span>&nbsp;<span class="op" id="2986578">&amp;&amp;</span>&nbsp;<span class="ident" id="2986581">c</span>&nbsp;<span class="op" id="2986583">&lt;=</span>&nbsp;<span class="string" id="2986586">&#39;f&#39;</span><span class="op" id="2986589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986594">n</span>&nbsp;<span class="op" id="2986596">|=</span>&nbsp;<span class="builtintype" id="2986599">rune</span><span class="op" id="2986603">(</span><span class="ident" id="2986604">c</span><span class="op" id="2986605">-</span><span class="string" id="2986606">&#39;a&#39;</span><span class="op" id="2986609">)</span>&nbsp;<span class="op" id="2986611">+</span>&nbsp;<span class="num" id="2986613">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986618">case</span>&nbsp;<span class="string" id="2986623">&#39;A&#39;</span>&nbsp;<span class="op" id="2986627">&lt;=</span>&nbsp;<span class="ident" id="2986630">c</span>&nbsp;<span class="op" id="2986632">&amp;&amp;</span>&nbsp;<span class="ident" id="2986635">c</span>&nbsp;<span class="op" id="2986637">&lt;=</span>&nbsp;<span class="string" id="2986640">&#39;F&#39;</span><span class="op" id="2986643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2986648">n</span>&nbsp;<span class="op" id="2986650">|=</span>&nbsp;<span class="builtintype" id="2986653">rune</span><span class="op" id="2986657">(</span><span class="ident" id="2986658">c</span><span class="op" id="2986659">-</span><span class="string" id="2986660">&#39;A&#39;</span><span class="op" id="2986663">)</span>&nbsp;<span class="op" id="2986665">+</span>&nbsp;<span class="num" id="2986667">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986672">default</span><span class="op" id="2986679">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2986684">panic</span><span class="op" id="2986689">(</span><span class="ident" id="2986690">fmt</span><span class="op" id="2986693">.</span><span class="ident" id="2986694">Sprintf</span><span class="op" id="2986701">(</span><span class="string" id="2986702">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="2986723">,</span>&nbsp;<span class="ident" id="2986725">s</span><span class="op" id="2986726">)</span><span class="op" id="2986727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986737">return</span>&nbsp;<span class="ident" id="2986744">n</span><br>
<span class="lineno"></span><span class="op" id="2986746">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="2986749">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2986818">func</span>&nbsp;<span class="ident" id="2986823">skipCSSSpace</span><span class="op" id="2986835">(</span><span class="ident" id="2986836">c</span>&nbsp;<span class="op" id="2986838">[</span><span class="op" id="2986839">]</span><span class="builtintype" id="2986840">byte</span><span class="op" id="2986844">)</span>&nbsp;<span class="op" id="2986846">[</span><span class="op" id="2986847">]</span><span class="builtintype" id="2986848">byte</span>&nbsp;<span class="op" id="2986853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986856">if</span>&nbsp;<span class="builtinfunc" id="2986859">len</span><span class="op" id="2986862">(</span><span class="ident" id="2986863">c</span><span class="op" id="2986864">)</span>&nbsp;<span class="op" id="2986866">==</span>&nbsp;<span class="num" id="2986869">0</span>&nbsp;<span class="op" id="2986871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986875">return</span>&nbsp;<span class="ident" id="2986882">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2986885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2986888">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986928">switch</span>&nbsp;<span class="ident" id="2986935">c</span><span class="op" id="2986936">[</span><span class="num" id="2986937">0</span><span class="op" id="2986938">]</span>&nbsp;<span class="op" id="2986940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986943">case</span>&nbsp;<span class="string" id="2986948">&#39;\t&#39;</span><span class="op" id="2986952">,</span>&nbsp;<span class="string" id="2986954">&#39;\n&#39;</span><span class="op" id="2986958">,</span>&nbsp;<span class="string" id="2986960">&#39;\f&#39;</span><span class="op" id="2986964">,</span>&nbsp;<span class="string" id="2986966">&#39;&nbsp;&#39;</span><span class="op" id="2986969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986973">return</span>&nbsp;<span class="ident" id="2986980">c</span><span class="op" id="2986981">[</span><span class="num" id="2986982">1</span><span class="op" id="2986983">:</span><span class="op" id="2986984">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2986987">case</span>&nbsp;<span class="string" id="2986992">&#39;\r&#39;</span><span class="op" id="2986996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2987000">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2987066">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2987131">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987176">if</span>&nbsp;<span class="builtinfunc" id="2987179">len</span><span class="op" id="2987182">(</span><span class="ident" id="2987183">c</span><span class="op" id="2987184">)</span>&nbsp;<span class="op" id="2987186">&gt;=</span>&nbsp;<span class="num" id="2987189">2</span>&nbsp;<span class="op" id="2987191">&amp;&amp;</span>&nbsp;<span class="ident" id="2987194">c</span><span class="op" id="2987195">[</span><span class="num" id="2987196">1</span><span class="op" id="2987197">]</span>&nbsp;<span class="op" id="2987199">==</span>&nbsp;<span class="string" id="2987202">&#39;\n&#39;</span>&nbsp;<span class="op" id="2987207">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987212">return</span>&nbsp;<span class="ident" id="2987219">c</span><span class="op" id="2987220">[</span><span class="num" id="2987221">2</span><span class="op" id="2987222">:</span><span class="op" id="2987223">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2987227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987231">return</span>&nbsp;<span class="ident" id="2987238">c</span><span class="op" id="2987239">[</span><span class="num" id="2987240">1</span><span class="op" id="2987241">:</span><span class="op" id="2987242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2987245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987248">return</span>&nbsp;<span class="ident" id="2987255">c</span><br>
<span class="lineno">145</span><span class="op" id="2987257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2987260">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="2987330">func</span>&nbsp;<span class="ident" id="2987335">isCSSSpace</span><span class="op" id="2987345">(</span><span class="ident" id="2987346">b</span>&nbsp;<span class="builtintype" id="2987348">byte</span><span class="op" id="2987352">)</span>&nbsp;<span class="builtintype" id="2987354">bool</span>&nbsp;<span class="op" id="2987359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987362">switch</span>&nbsp;<span class="ident" id="2987369">b</span>&nbsp;<span class="op" id="2987371">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987374">case</span>&nbsp;<span class="string" id="2987379">&#39;\t&#39;</span><span class="op" id="2987383">,</span>&nbsp;<span class="string" id="2987385">&#39;\n&#39;</span><span class="op" id="2987389">,</span>&nbsp;<span class="string" id="2987391">&#39;\f&#39;</span><span class="op" id="2987395">,</span>&nbsp;<span class="string" id="2987397">&#39;\r&#39;</span><span class="op" id="2987401">,</span>&nbsp;<span class="string" id="2987403">&#39;&nbsp;&#39;</span><span class="op" id="2987406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987410">return</span>&nbsp;<span class="builtintype" id="2987417">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2987423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987426">return</span>&nbsp;<span class="builtintype" id="2987433">false</span><br>
<span class="lineno"></span><span class="op" id="2987439">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2987442">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="2987519">func</span>&nbsp;<span class="ident" id="2987524">cssEscaper</span><span class="op" id="2987534">(</span><span class="ident" id="2987535">args</span>&nbsp;<span class="op" id="2987540">...</span><span class="keyword" id="2987543">interface</span><span class="op" id="2987552">{</span><span class="op" id="2987553">}</span><span class="op" id="2987554">)</span>&nbsp;<span class="builtintype" id="2987556">string</span>&nbsp;<span class="op" id="2987563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987566">s</span><span class="op" id="2987567">,</span>&nbsp;<span class="ident" id="2987569">_</span>&nbsp;<span class="op" id="2987571">:=</span>&nbsp;<span class="ident" id="2987574">stringify</span><span class="op" id="2987583">(</span><span class="ident" id="2987584">args</span><span class="op" id="2987588">...</span><span class="op" id="2987591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987594">var</span>&nbsp;<span class="ident" id="2987598">b</span>&nbsp;<span class="ident" id="2987600">bytes</span><span class="op" id="2987605">.</span><span class="ident" id="2987606">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987614">written</span>&nbsp;<span class="op" id="2987622">:=</span>&nbsp;<span class="num" id="2987625">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987628">for</span>&nbsp;<span class="ident" id="2987632">i</span><span class="op" id="2987633">,</span>&nbsp;<span class="ident" id="2987635">r</span>&nbsp;<span class="op" id="2987637">:=</span>&nbsp;<span class="keyword" id="2987640">range</span>&nbsp;<span class="ident" id="2987646">s</span>&nbsp;<span class="op" id="2987648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987652">var</span>&nbsp;<span class="ident" id="2987656">repl</span>&nbsp;<span class="builtintype" id="2987661">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987670">switch</span>&nbsp;<span class="ident" id="2987677">r</span>&nbsp;<span class="op" id="2987679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987683">case</span>&nbsp;<span class="num" id="2987688">0</span><span class="op" id="2987689">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987694">repl</span>&nbsp;<span class="op" id="2987699">=</span>&nbsp;<span class="string" id="2987701">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987708">case</span>&nbsp;<span class="string" id="2987713">&#39;\t&#39;</span><span class="op" id="2987717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987722">repl</span>&nbsp;<span class="op" id="2987727">=</span>&nbsp;<span class="string" id="2987729">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987736">case</span>&nbsp;<span class="string" id="2987741">&#39;\n&#39;</span><span class="op" id="2987745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987750">repl</span>&nbsp;<span class="op" id="2987755">=</span>&nbsp;<span class="string" id="2987757">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987764">case</span>&nbsp;<span class="string" id="2987769">&#39;\f&#39;</span><span class="op" id="2987773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987778">repl</span>&nbsp;<span class="op" id="2987783">=</span>&nbsp;<span class="string" id="2987785">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987792">case</span>&nbsp;<span class="string" id="2987797">&#39;\r&#39;</span><span class="op" id="2987801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987806">repl</span>&nbsp;<span class="op" id="2987811">=</span>&nbsp;<span class="string" id="2987813">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2987820">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2987883">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987933">case</span>&nbsp;<span class="string" id="2987938">&#39;&#34;&#39;</span><span class="op" id="2987941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987946">repl</span>&nbsp;<span class="op" id="2987951">=</span>&nbsp;<span class="string" id="2987953">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987961">case</span>&nbsp;<span class="string" id="2987966">&#39;&amp;&#39;</span><span class="op" id="2987969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2987974">repl</span>&nbsp;<span class="op" id="2987979">=</span>&nbsp;<span class="string" id="2987981">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2987989">case</span>&nbsp;<span class="string" id="2987994">&#39;\&#39;&#39;</span><span class="op" id="2987998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988003">repl</span>&nbsp;<span class="op" id="2988008">=</span>&nbsp;<span class="string" id="2988010">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988018">case</span>&nbsp;<span class="string" id="2988023">&#39;(&#39;</span><span class="op" id="2988026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988031">repl</span>&nbsp;<span class="op" id="2988036">=</span>&nbsp;<span class="string" id="2988038">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988046">case</span>&nbsp;<span class="string" id="2988051">&#39;)&#39;</span><span class="op" id="2988054">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988059">repl</span>&nbsp;<span class="op" id="2988064">=</span>&nbsp;<span class="string" id="2988066">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988074">case</span>&nbsp;<span class="string" id="2988079">&#39;+&#39;</span><span class="op" id="2988082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988087">repl</span>&nbsp;<span class="op" id="2988092">=</span>&nbsp;<span class="string" id="2988094">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988102">case</span>&nbsp;<span class="string" id="2988107">&#39;/&#39;</span><span class="op" id="2988110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988115">repl</span>&nbsp;<span class="op" id="2988120">=</span>&nbsp;<span class="string" id="2988122">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988130">case</span>&nbsp;<span class="string" id="2988135">&#39;:&#39;</span><span class="op" id="2988138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988143">repl</span>&nbsp;<span class="op" id="2988148">=</span>&nbsp;<span class="string" id="2988150">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988158">case</span>&nbsp;<span class="string" id="2988163">&#39;;&#39;</span><span class="op" id="2988166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988171">repl</span>&nbsp;<span class="op" id="2988176">=</span>&nbsp;<span class="string" id="2988178">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988186">case</span>&nbsp;<span class="string" id="2988191">&#39;&lt;&#39;</span><span class="op" id="2988194">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988199">repl</span>&nbsp;<span class="op" id="2988204">=</span>&nbsp;<span class="string" id="2988206">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988214">case</span>&nbsp;<span class="string" id="2988219">&#39;&gt;&#39;</span><span class="op" id="2988222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988227">repl</span>&nbsp;<span class="op" id="2988232">=</span>&nbsp;<span class="string" id="2988234">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988242">case</span>&nbsp;<span class="string" id="2988247">&#39;\\&#39;</span><span class="op" id="2988251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988256">repl</span>&nbsp;<span class="op" id="2988261">=</span>&nbsp;<span class="string" id="2988263">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988270">case</span>&nbsp;<span class="string" id="2988275">&#39;{&#39;</span><span class="op" id="2988278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988283">repl</span>&nbsp;<span class="op" id="2988288">=</span>&nbsp;<span class="string" id="2988290">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988298">case</span>&nbsp;<span class="string" id="2988303">&#39;}&#39;</span><span class="op" id="2988306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988311">repl</span>&nbsp;<span class="op" id="2988316">=</span>&nbsp;<span class="string" id="2988318">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988326">default</span><span class="op" id="2988333">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988338">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2988349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988353">b</span><span class="op" id="2988354">.</span><span class="ident" id="2988355">WriteString</span><span class="op" id="2988366">(</span><span class="ident" id="2988367">s</span><span class="op" id="2988368">[</span><span class="ident" id="2988369">written</span><span class="op" id="2988376">:</span><span class="ident" id="2988377">i</span><span class="op" id="2988378">]</span><span class="op" id="2988379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988383">b</span><span class="op" id="2988384">.</span><span class="ident" id="2988385">WriteString</span><span class="op" id="2988396">(</span><span class="ident" id="2988397">repl</span><span class="op" id="2988401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988405">written</span>&nbsp;<span class="op" id="2988413">=</span>&nbsp;<span class="ident" id="2988415">i</span>&nbsp;<span class="op" id="2988417">+</span>&nbsp;<span class="ident" id="2988419">utf8</span><span class="op" id="2988423">.</span><span class="ident" id="2988424">RuneLen</span><span class="op" id="2988431">(</span><span class="ident" id="2988432">r</span><span class="op" id="2988433">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988437">if</span>&nbsp;<span class="ident" id="2988440">repl</span>&nbsp;<span class="op" id="2988445">!=</span>&nbsp;<span class="string" id="2988448">`\\`</span>&nbsp;<span class="op" id="2988453">&amp;&amp;</span>&nbsp;<span class="op" id="2988456">(</span><span class="ident" id="2988457">written</span>&nbsp;<span class="op" id="2988465">==</span>&nbsp;<span class="builtinfunc" id="2988468">len</span><span class="op" id="2988471">(</span><span class="ident" id="2988472">s</span><span class="op" id="2988473">)</span>&nbsp;<span class="op" id="2988475">||</span>&nbsp;<span class="ident" id="2988478">isHex</span><span class="op" id="2988483">(</span><span class="ident" id="2988484">s</span><span class="op" id="2988485">[</span><span class="ident" id="2988486">written</span><span class="op" id="2988493">]</span><span class="op" id="2988494">)</span>&nbsp;<span class="op" id="2988496">||</span>&nbsp;<span class="ident" id="2988499">isCSSSpace</span><span class="op" id="2988509">(</span><span class="ident" id="2988510">s</span><span class="op" id="2988511">[</span><span class="ident" id="2988512">written</span><span class="op" id="2988519">]</span><span class="op" id="2988520">)</span><span class="op" id="2988521">)</span>&nbsp;<span class="op" id="2988523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988528">b</span><span class="op" id="2988529">.</span><span class="ident" id="2988530">WriteByte</span><span class="op" id="2988539">(</span><span class="string" id="2988540">&#39;&nbsp;&#39;</span><span class="op" id="2988543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2988547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2988550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988553">if</span>&nbsp;<span class="ident" id="2988556">written</span>&nbsp;<span class="op" id="2988564">==</span>&nbsp;<span class="num" id="2988567">0</span>&nbsp;<span class="op" id="2988569">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988573">return</span>&nbsp;<span class="ident" id="2988580">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2988583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2988586">b</span><span class="op" id="2988587">.</span><span class="ident" id="2988588">WriteString</span><span class="op" id="2988599">(</span><span class="ident" id="2988600">s</span><span class="op" id="2988601">[</span><span class="ident" id="2988602">written</span><span class="op" id="2988609">:</span><span class="op" id="2988610">]</span><span class="op" id="2988611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2988614">return</span>&nbsp;<span class="ident" id="2988621">b</span><span class="op" id="2988622">.</span><span class="ident" id="2988623">String</span><span class="op" id="2988629">(</span><span class="op" id="2988630">)</span><br>
<span class="lineno"></span><span class="op" id="2988632">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="2988635">var</span>&nbsp;<span class="ident" id="2988639">expressionBytes</span>&nbsp;<span class="op" id="2988655">=</span>&nbsp;<span class="op" id="2988657">[</span><span class="op" id="2988658">]</span><span class="builtintype" id="2988659">byte</span><span class="op" id="2988663">(</span><span class="string" id="2988664">&#34;expression&#34;</span><span class="op" id="2988676">)</span><br>
<span class="lineno"></span><span class="keyword" id="2988678">var</span>&nbsp;<span class="ident" id="2988682">mozBindingBytes</span>&nbsp;<span class="op" id="2988698">=</span>&nbsp;<span class="op" id="2988700">[</span><span class="op" id="2988701">]</span><span class="builtintype" id="2988702">byte</span><span class="op" id="2988706">(</span><span class="string" id="2988707">&#34;mozbinding&#34;</span><span class="op" id="2988719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2988722">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="2988796">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="2988875">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="2988914">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="2988991">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="2989035">func</span>&nbsp;<span class="ident" id="2989040">cssValueFilter</span><span class="op" id="2989054">(</span><span class="ident" id="2989055">args</span>&nbsp;<span class="op" id="2989060">...</span><span class="keyword" id="2989063">interface</span><span class="op" id="2989072">{</span><span class="op" id="2989073">}</span><span class="op" id="2989074">)</span>&nbsp;<span class="builtintype" id="2989076">string</span>&nbsp;<span class="op" id="2989083">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2989086">s</span><span class="op" id="2989087">,</span>&nbsp;<span class="ident" id="2989089">t</span>&nbsp;<span class="op" id="2989091">:=</span>&nbsp;<span class="ident" id="2989094">stringify</span><span class="op" id="2989103">(</span><span class="ident" id="2989104">args</span><span class="op" id="2989108">...</span><span class="op" id="2989111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2989114">if</span>&nbsp;<span class="ident" id="2989117">t</span>&nbsp;<span class="op" id="2989119">==</span>&nbsp;<span class="ident" id="2989122">contentTypeCSS</span>&nbsp;<span class="op" id="2989137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2989141">return</span>&nbsp;<span class="ident" id="2989148">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2989151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2989154">b</span><span class="op" id="2989155">,</span>&nbsp;<span class="ident" id="2989157">id</span>&nbsp;<span class="op" id="2989160">:=</span>&nbsp;<span class="ident" id="2989163">decodeCSS</span><span class="op" id="2989172">(</span><span class="op" id="2989173">[</span><span class="op" id="2989174">]</span><span class="builtintype" id="2989175">byte</span><span class="op" id="2989179">(</span><span class="ident" id="2989180">s</span><span class="op" id="2989181">)</span><span class="op" id="2989182">)</span><span class="op" id="2989183">,</span>&nbsp;<span class="builtinfunc" id="2989185">make</span><span class="op" id="2989189">(</span><span class="op" id="2989190">[</span><span class="op" id="2989191">]</span><span class="builtintype" id="2989192">byte</span><span class="op" id="2989196">,</span>&nbsp;<span class="num" id="2989198">0</span><span class="op" id="2989199">,</span>&nbsp;<span class="num" id="2989201">64</span><span class="op" id="2989203">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989207">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989278">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989333">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989400">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989682">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989720">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989791">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2989862">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2989918">for</span>&nbsp;<span class="ident" id="2989922">i</span><span class="op" id="2989923">,</span>&nbsp;<span class="ident" id="2989925">c</span>&nbsp;<span class="op" id="2989927">:=</span>&nbsp;<span class="keyword" id="2989930">range</span>&nbsp;<span class="ident" id="2989936">b</span>&nbsp;<span class="op" id="2989938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2989942">switch</span>&nbsp;<span class="ident" id="2989949">c</span>&nbsp;<span class="op" id="2989951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2989955">case</span>&nbsp;<span class="num" id="2989960">0</span><span class="op" id="2989961">,</span>&nbsp;<span class="string" id="2989963">&#39;&#34;&#39;</span><span class="op" id="2989966">,</span>&nbsp;<span class="string" id="2989968">&#39;\&#39;&#39;</span><span class="op" id="2989972">,</span>&nbsp;<span class="string" id="2989974">&#39;(&#39;</span><span class="op" id="2989977">,</span>&nbsp;<span class="string" id="2989979">&#39;)&#39;</span><span class="op" id="2989982">,</span>&nbsp;<span class="string" id="2989984">&#39;/&#39;</span><span class="op" id="2989987">,</span>&nbsp;<span class="string" id="2989989">&#39;;&#39;</span><span class="op" id="2989992">,</span>&nbsp;<span class="string" id="2989994">&#39;@&#39;</span><span class="op" id="2989997">,</span>&nbsp;<span class="string" id="2989999">&#39;[&#39;</span><span class="op" id="2990002">,</span>&nbsp;<span class="string" id="2990004">&#39;\\&#39;</span><span class="op" id="2990008">,</span>&nbsp;<span class="string" id="2990010">&#39;]&#39;</span><span class="op" id="2990013">,</span>&nbsp;<span class="string" id="2990015">&#39;`&#39;</span><span class="op" id="2990018">,</span>&nbsp;<span class="string" id="2990020">&#39;{&#39;</span><span class="op" id="2990023">,</span>&nbsp;<span class="string" id="2990025">&#39;}&#39;</span><span class="op" id="2990028">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990033">return</span>&nbsp;<span class="ident" id="2990040">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990057">case</span>&nbsp;<span class="string" id="2990062">&#39;-&#39;</span><span class="op" id="2990065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2990070">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2990098">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990147">if</span>&nbsp;<span class="ident" id="2990150">i</span>&nbsp;<span class="op" id="2990152">!=</span>&nbsp;<span class="num" id="2990155">0</span>&nbsp;<span class="op" id="2990157">&amp;&amp;</span>&nbsp;<span class="ident" id="2990160">b</span><span class="op" id="2990161">[</span><span class="ident" id="2990162">i</span><span class="op" id="2990163">-</span><span class="num" id="2990164">1</span><span class="op" id="2990165">]</span>&nbsp;<span class="op" id="2990167">==</span>&nbsp;<span class="string" id="2990170">&#39;-&#39;</span>&nbsp;<span class="op" id="2990174">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990180">return</span>&nbsp;<span class="ident" id="2990187">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990209">default</span><span class="op" id="2990216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990221">if</span>&nbsp;<span class="ident" id="2990224">c</span>&nbsp;<span class="op" id="2990226">&lt;</span>&nbsp;<span class="num" id="2990228">0x80</span>&nbsp;<span class="op" id="2990233">&amp;&amp;</span>&nbsp;<span class="ident" id="2990236">isCSSNmchar</span><span class="op" id="2990247">(</span><span class="builtintype" id="2990248">rune</span><span class="op" id="2990252">(</span><span class="ident" id="2990253">c</span><span class="op" id="2990254">)</span><span class="op" id="2990255">)</span>&nbsp;<span class="op" id="2990257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2990263">id</span>&nbsp;<span class="op" id="2990266">=</span>&nbsp;<span class="builtinfunc" id="2990268">append</span><span class="op" id="2990274">(</span><span class="ident" id="2990275">id</span><span class="op" id="2990277">,</span>&nbsp;<span class="ident" id="2990279">c</span><span class="op" id="2990280">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2990295">id</span>&nbsp;<span class="op" id="2990298">=</span>&nbsp;<span class="ident" id="2990300">bytes</span><span class="op" id="2990305">.</span><span class="ident" id="2990306">ToLower</span><span class="op" id="2990313">(</span><span class="ident" id="2990314">id</span><span class="op" id="2990316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990319">if</span>&nbsp;<span class="ident" id="2990322">bytes</span><span class="op" id="2990327">.</span><span class="ident" id="2990328">Index</span><span class="op" id="2990333">(</span><span class="ident" id="2990334">id</span><span class="op" id="2990336">,</span>&nbsp;<span class="ident" id="2990338">expressionBytes</span><span class="op" id="2990353">)</span>&nbsp;<span class="op" id="2990355">!=</span>&nbsp;<span class="op" id="2990358">-</span><span class="num" id="2990359">1</span>&nbsp;<span class="op" id="2990361">||</span>&nbsp;<span class="ident" id="2990364">bytes</span><span class="op" id="2990369">.</span><span class="ident" id="2990370">Index</span><span class="op" id="2990375">(</span><span class="ident" id="2990376">id</span><span class="op" id="2990378">,</span>&nbsp;<span class="ident" id="2990380">mozBindingBytes</span><span class="op" id="2990395">)</span>&nbsp;<span class="op" id="2990397">!=</span>&nbsp;<span class="op" id="2990400">-</span><span class="num" id="2990401">1</span>&nbsp;<span class="op" id="2990403">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990407">return</span>&nbsp;<span class="ident" id="2990414">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2990433">return</span>&nbsp;<span class="builtintype" id="2990440">string</span><span class="op" id="2990446">(</span><span class="ident" id="2990447">b</span><span class="op" id="2990448">)</span><br>
<span class="lineno"></span><span class="op" id="2990450">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
