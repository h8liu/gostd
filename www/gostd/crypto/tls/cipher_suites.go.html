<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4060046">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4060101">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4060155">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4060206">package</span>&nbsp;<span class="ident" id="4060214">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4060219">import</span>&nbsp;<span class="op" id="4060226">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060229">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060243">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060260">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060274">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060289">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060303">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060318">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4060333">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4060340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060343">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4060422">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4060486">type</span>&nbsp;<span class="ident" id="4060491">keyAgreement</span>&nbsp;<span class="keyword" id="4060504">interface</span>&nbsp;<span class="op" id="4060514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060517">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060585">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060647">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060720">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060729">generateServerKeyExchange</span><span class="op" id="4060754">(</span><span class="op" id="4060755">*</span><span class="ident" id="4060756">Config</span><span class="op" id="4060762">,</span>&nbsp;<span class="op" id="4060764">*</span><span class="ident" id="4060765">Certificate</span><span class="op" id="4060776">,</span>&nbsp;<span class="op" id="4060778">*</span><span class="ident" id="4060779">clientHelloMsg</span><span class="op" id="4060793">,</span>&nbsp;<span class="op" id="4060795">*</span><span class="ident" id="4060796">serverHelloMsg</span><span class="op" id="4060810">)</span>&nbsp;<span class="op" id="4060812">(</span><span class="op" id="4060813">*</span><span class="ident" id="4060814">serverKeyExchangeMsg</span><span class="op" id="4060834">,</span>&nbsp;<span class="builtintype" id="4060836">error</span><span class="op" id="4060841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060844">processClientKeyExchange</span><span class="op" id="4060868">(</span><span class="op" id="4060869">*</span><span class="ident" id="4060870">Config</span><span class="op" id="4060876">,</span>&nbsp;<span class="op" id="4060878">*</span><span class="ident" id="4060879">Certificate</span><span class="op" id="4060890">,</span>&nbsp;<span class="op" id="4060892">*</span><span class="ident" id="4060893">clientKeyExchangeMsg</span><span class="op" id="4060913">,</span>&nbsp;<span class="builtintype" id="4060915">uint16</span><span class="op" id="4060921">)</span>&nbsp;<span class="op" id="4060923">(</span><span class="op" id="4060924">[</span><span class="op" id="4060925">]</span><span class="builtintype" id="4060926">byte</span><span class="op" id="4060930">,</span>&nbsp;<span class="builtintype" id="4060932">error</span><span class="op" id="4060937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060941">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061008">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061071">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061102">processServerKeyExchange</span><span class="op" id="4061126">(</span><span class="op" id="4061127">*</span><span class="ident" id="4061128">Config</span><span class="op" id="4061134">,</span>&nbsp;<span class="op" id="4061136">*</span><span class="ident" id="4061137">clientHelloMsg</span><span class="op" id="4061151">,</span>&nbsp;<span class="op" id="4061153">*</span><span class="ident" id="4061154">serverHelloMsg</span><span class="op" id="4061168">,</span>&nbsp;<span class="op" id="4061170">*</span><span class="ident" id="4061171">x509</span><span class="op" id="4061175">.</span><span class="ident" id="4061176">Certificate</span><span class="op" id="4061187">,</span>&nbsp;<span class="op" id="4061189">*</span><span class="ident" id="4061190">serverKeyExchangeMsg</span><span class="op" id="4061210">)</span>&nbsp;<span class="builtintype" id="4061212">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061219">generateClientKeyExchange</span><span class="op" id="4061244">(</span><span class="op" id="4061245">*</span><span class="ident" id="4061246">Config</span><span class="op" id="4061252">,</span>&nbsp;<span class="op" id="4061254">*</span><span class="ident" id="4061255">clientHelloMsg</span><span class="op" id="4061269">,</span>&nbsp;<span class="op" id="4061271">*</span><span class="ident" id="4061272">x509</span><span class="op" id="4061276">.</span><span class="ident" id="4061277">Certificate</span><span class="op" id="4061288">)</span>&nbsp;<span class="op" id="4061290">(</span><span class="op" id="4061291">[</span><span class="op" id="4061292">]</span><span class="builtintype" id="4061293">byte</span><span class="op" id="4061297">,</span>&nbsp;<span class="op" id="4061299">*</span><span class="ident" id="4061300">clientKeyExchangeMsg</span><span class="op" id="4061320">,</span>&nbsp;<span class="builtintype" id="4061322">error</span><span class="op" id="4061327">)</span><br>
<span class="lineno">35</span><span class="op" id="4061329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4061332">const</span>&nbsp;<span class="op" id="4061338">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061341">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061411">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061483">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061555">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061582">suiteECDHE</span>&nbsp;<span class="op" id="4061593">=</span>&nbsp;<span class="num" id="4061595">1</span>&nbsp;<span class="op" id="4061597">&lt;&lt;</span>&nbsp;<span class="ident" id="4061600">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061606">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061671">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061738">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061808">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061823">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061835">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061908">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061945">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4061956">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4061959">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4062035">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4062102">type</span>&nbsp;<span class="ident" id="4062107">cipherSuite</span>&nbsp;<span class="keyword" id="4062119">struct</span>&nbsp;<span class="op" id="4062126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062129">id</span>&nbsp;<span class="builtintype" id="4062132">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062140">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062214">keyLen</span>&nbsp;<span class="builtintype" id="4062221">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062226">macLen</span>&nbsp;<span class="builtintype" id="4062233">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062238">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4062245">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062250">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062257">func</span><span class="op" id="4062261">(</span><span class="ident" id="4062262">version</span>&nbsp;<span class="builtintype" id="4062270">uint16</span><span class="op" id="4062276">)</span>&nbsp;<span class="ident" id="4062278">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062292">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062344">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4062351">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062356">cipher</span>&nbsp;<span class="keyword" id="4062363">func</span><span class="op" id="4062367">(</span><span class="ident" id="4062368">key</span><span class="op" id="4062371">,</span>&nbsp;<span class="ident" id="4062373">iv</span>&nbsp;<span class="op" id="4062376">[</span><span class="op" id="4062377">]</span><span class="builtintype" id="4062378">byte</span><span class="op" id="4062382">,</span>&nbsp;<span class="ident" id="4062384">isRead</span>&nbsp;<span class="builtintype" id="4062391">bool</span><span class="op" id="4062395">)</span>&nbsp;<span class="keyword" id="4062397">interface</span><span class="op" id="4062406">{</span><span class="op" id="4062407">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062410">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062417">func</span><span class="op" id="4062421">(</span><span class="ident" id="4062422">version</span>&nbsp;<span class="builtintype" id="4062430">uint16</span><span class="op" id="4062436">,</span>&nbsp;<span class="ident" id="4062438">macKey</span>&nbsp;<span class="op" id="4062445">[</span><span class="op" id="4062446">]</span><span class="builtintype" id="4062447">byte</span><span class="op" id="4062451">)</span>&nbsp;<span class="ident" id="4062453">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062466">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062473">func</span><span class="op" id="4062477">(</span><span class="ident" id="4062478">key</span><span class="op" id="4062481">,</span>&nbsp;<span class="ident" id="4062483">fixedNonce</span>&nbsp;<span class="op" id="4062494">[</span><span class="op" id="4062495">]</span><span class="builtintype" id="4062496">byte</span><span class="op" id="4062500">)</span>&nbsp;<span class="ident" id="4062502">cipher</span><span class="op" id="4062508">.</span><span class="ident" id="4062509">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4062514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4062517">var</span>&nbsp;<span class="ident" id="4062521">cipherSuites</span>&nbsp;<span class="op" id="4062534">=</span>&nbsp;<span class="op" id="4062536">[</span><span class="op" id="4062537">]</span><span class="op" id="4062538">*</span><span class="ident" id="4062539">cipherSuite</span><span class="op" id="4062550">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062553">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062622">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062684">{</span><span class="ident" id="4062685">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4062722">,</span>&nbsp;<span class="num" id="4062724">16</span><span class="op" id="4062726">,</span>&nbsp;<span class="num" id="4062728">0</span><span class="op" id="4062729">,</span>&nbsp;<span class="num" id="4062731">4</span><span class="op" id="4062732">,</span>&nbsp;<span class="ident" id="4062734">ecdheRSAKA</span><span class="op" id="4062744">,</span>&nbsp;<span class="ident" id="4062746">suiteECDHE</span>&nbsp;<span class="op" id="4062757">|</span>&nbsp;<span class="ident" id="4062759">suiteTLS12</span><span class="op" id="4062769">,</span>&nbsp;<span class="ident" id="4062771">nil</span><span class="op" id="4062774">,</span>&nbsp;<span class="ident" id="4062776">nil</span><span class="op" id="4062779">,</span>&nbsp;<span class="ident" id="4062781">aeadAESGCM</span><span class="op" id="4062791">}</span><span class="op" id="4062792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062795">{</span><span class="ident" id="4062796">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4062835">,</span>&nbsp;<span class="num" id="4062837">16</span><span class="op" id="4062839">,</span>&nbsp;<span class="num" id="4062841">0</span><span class="op" id="4062842">,</span>&nbsp;<span class="num" id="4062844">4</span><span class="op" id="4062845">,</span>&nbsp;<span class="ident" id="4062847">ecdheECDSAKA</span><span class="op" id="4062859">,</span>&nbsp;<span class="ident" id="4062861">suiteECDHE</span>&nbsp;<span class="op" id="4062872">|</span>&nbsp;<span class="ident" id="4062874">suiteECDSA</span>&nbsp;<span class="op" id="4062885">|</span>&nbsp;<span class="ident" id="4062887">suiteTLS12</span><span class="op" id="4062897">,</span>&nbsp;<span class="ident" id="4062899">nil</span><span class="op" id="4062902">,</span>&nbsp;<span class="ident" id="4062904">nil</span><span class="op" id="4062907">,</span>&nbsp;<span class="ident" id="4062909">aeadAESGCM</span><span class="op" id="4062919">}</span><span class="op" id="4062920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062923">{</span><span class="ident" id="4062924">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4062954">,</span>&nbsp;<span class="num" id="4062956">16</span><span class="op" id="4062958">,</span>&nbsp;<span class="num" id="4062960">20</span><span class="op" id="4062962">,</span>&nbsp;<span class="num" id="4062964">0</span><span class="op" id="4062965">,</span>&nbsp;<span class="ident" id="4062967">ecdheRSAKA</span><span class="op" id="4062977">,</span>&nbsp;<span class="ident" id="4062979">suiteECDHE</span><span class="op" id="4062989">,</span>&nbsp;<span class="ident" id="4062991">cipherRC4</span><span class="op" id="4063000">,</span>&nbsp;<span class="ident" id="4063002">macSHA1</span><span class="op" id="4063009">,</span>&nbsp;<span class="ident" id="4063011">nil</span><span class="op" id="4063014">}</span><span class="op" id="4063015">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063018">{</span><span class="ident" id="4063019">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4063051">,</span>&nbsp;<span class="num" id="4063053">16</span><span class="op" id="4063055">,</span>&nbsp;<span class="num" id="4063057">20</span><span class="op" id="4063059">,</span>&nbsp;<span class="num" id="4063061">0</span><span class="op" id="4063062">,</span>&nbsp;<span class="ident" id="4063064">ecdheECDSAKA</span><span class="op" id="4063076">,</span>&nbsp;<span class="ident" id="4063078">suiteECDHE</span>&nbsp;<span class="op" id="4063089">|</span>&nbsp;<span class="ident" id="4063091">suiteECDSA</span><span class="op" id="4063101">,</span>&nbsp;<span class="ident" id="4063103">cipherRC4</span><span class="op" id="4063112">,</span>&nbsp;<span class="ident" id="4063114">macSHA1</span><span class="op" id="4063121">,</span>&nbsp;<span class="ident" id="4063123">nil</span><span class="op" id="4063126">}</span><span class="op" id="4063127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063130">{</span><span class="ident" id="4063131">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4063165">,</span>&nbsp;<span class="num" id="4063167">16</span><span class="op" id="4063169">,</span>&nbsp;<span class="num" id="4063171">20</span><span class="op" id="4063173">,</span>&nbsp;<span class="num" id="4063175">16</span><span class="op" id="4063177">,</span>&nbsp;<span class="ident" id="4063179">ecdheRSAKA</span><span class="op" id="4063189">,</span>&nbsp;<span class="ident" id="4063191">suiteECDHE</span><span class="op" id="4063201">,</span>&nbsp;<span class="ident" id="4063203">cipherAES</span><span class="op" id="4063212">,</span>&nbsp;<span class="ident" id="4063214">macSHA1</span><span class="op" id="4063221">,</span>&nbsp;<span class="ident" id="4063223">nil</span><span class="op" id="4063226">}</span><span class="op" id="4063227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063230">{</span><span class="ident" id="4063231">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4063267">,</span>&nbsp;<span class="num" id="4063269">16</span><span class="op" id="4063271">,</span>&nbsp;<span class="num" id="4063273">20</span><span class="op" id="4063275">,</span>&nbsp;<span class="num" id="4063277">16</span><span class="op" id="4063279">,</span>&nbsp;<span class="ident" id="4063281">ecdheECDSAKA</span><span class="op" id="4063293">,</span>&nbsp;<span class="ident" id="4063295">suiteECDHE</span>&nbsp;<span class="op" id="4063306">|</span>&nbsp;<span class="ident" id="4063308">suiteECDSA</span><span class="op" id="4063318">,</span>&nbsp;<span class="ident" id="4063320">cipherAES</span><span class="op" id="4063329">,</span>&nbsp;<span class="ident" id="4063331">macSHA1</span><span class="op" id="4063338">,</span>&nbsp;<span class="ident" id="4063340">nil</span><span class="op" id="4063343">}</span><span class="op" id="4063344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063347">{</span><span class="ident" id="4063348">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4063382">,</span>&nbsp;<span class="num" id="4063384">32</span><span class="op" id="4063386">,</span>&nbsp;<span class="num" id="4063388">20</span><span class="op" id="4063390">,</span>&nbsp;<span class="num" id="4063392">16</span><span class="op" id="4063394">,</span>&nbsp;<span class="ident" id="4063396">ecdheRSAKA</span><span class="op" id="4063406">,</span>&nbsp;<span class="ident" id="4063408">suiteECDHE</span><span class="op" id="4063418">,</span>&nbsp;<span class="ident" id="4063420">cipherAES</span><span class="op" id="4063429">,</span>&nbsp;<span class="ident" id="4063431">macSHA1</span><span class="op" id="4063438">,</span>&nbsp;<span class="ident" id="4063440">nil</span><span class="op" id="4063443">}</span><span class="op" id="4063444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063447">{</span><span class="ident" id="4063448">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4063484">,</span>&nbsp;<span class="num" id="4063486">32</span><span class="op" id="4063488">,</span>&nbsp;<span class="num" id="4063490">20</span><span class="op" id="4063492">,</span>&nbsp;<span class="num" id="4063494">16</span><span class="op" id="4063496">,</span>&nbsp;<span class="ident" id="4063498">ecdheECDSAKA</span><span class="op" id="4063510">,</span>&nbsp;<span class="ident" id="4063512">suiteECDHE</span>&nbsp;<span class="op" id="4063523">|</span>&nbsp;<span class="ident" id="4063525">suiteECDSA</span><span class="op" id="4063535">,</span>&nbsp;<span class="ident" id="4063537">cipherAES</span><span class="op" id="4063546">,</span>&nbsp;<span class="ident" id="4063548">macSHA1</span><span class="op" id="4063555">,</span>&nbsp;<span class="ident" id="4063557">nil</span><span class="op" id="4063560">}</span><span class="op" id="4063561">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063564">{</span><span class="ident" id="4063565">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4063589">,</span>&nbsp;<span class="num" id="4063591">16</span><span class="op" id="4063593">,</span>&nbsp;<span class="num" id="4063595">20</span><span class="op" id="4063597">,</span>&nbsp;<span class="num" id="4063599">0</span><span class="op" id="4063600">,</span>&nbsp;<span class="ident" id="4063602">rsaKA</span><span class="op" id="4063607">,</span>&nbsp;<span class="num" id="4063609">0</span><span class="op" id="4063610">,</span>&nbsp;<span class="ident" id="4063612">cipherRC4</span><span class="op" id="4063621">,</span>&nbsp;<span class="ident" id="4063623">macSHA1</span><span class="op" id="4063630">,</span>&nbsp;<span class="ident" id="4063632">nil</span><span class="op" id="4063635">}</span><span class="op" id="4063636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063639">{</span><span class="ident" id="4063640">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4063668">,</span>&nbsp;<span class="num" id="4063670">16</span><span class="op" id="4063672">,</span>&nbsp;<span class="num" id="4063674">20</span><span class="op" id="4063676">,</span>&nbsp;<span class="num" id="4063678">16</span><span class="op" id="4063680">,</span>&nbsp;<span class="ident" id="4063682">rsaKA</span><span class="op" id="4063687">,</span>&nbsp;<span class="num" id="4063689">0</span><span class="op" id="4063690">,</span>&nbsp;<span class="ident" id="4063692">cipherAES</span><span class="op" id="4063701">,</span>&nbsp;<span class="ident" id="4063703">macSHA1</span><span class="op" id="4063710">,</span>&nbsp;<span class="ident" id="4063712">nil</span><span class="op" id="4063715">}</span><span class="op" id="4063716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063719">{</span><span class="ident" id="4063720">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4063748">,</span>&nbsp;<span class="num" id="4063750">32</span><span class="op" id="4063752">,</span>&nbsp;<span class="num" id="4063754">20</span><span class="op" id="4063756">,</span>&nbsp;<span class="num" id="4063758">16</span><span class="op" id="4063760">,</span>&nbsp;<span class="ident" id="4063762">rsaKA</span><span class="op" id="4063767">,</span>&nbsp;<span class="num" id="4063769">0</span><span class="op" id="4063770">,</span>&nbsp;<span class="ident" id="4063772">cipherAES</span><span class="op" id="4063781">,</span>&nbsp;<span class="ident" id="4063783">macSHA1</span><span class="op" id="4063790">,</span>&nbsp;<span class="ident" id="4063792">nil</span><span class="op" id="4063795">}</span><span class="op" id="4063796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063799">{</span><span class="ident" id="4063800">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4063835">,</span>&nbsp;<span class="num" id="4063837">24</span><span class="op" id="4063839">,</span>&nbsp;<span class="num" id="4063841">20</span><span class="op" id="4063843">,</span>&nbsp;<span class="num" id="4063845">8</span><span class="op" id="4063846">,</span>&nbsp;<span class="ident" id="4063848">ecdheRSAKA</span><span class="op" id="4063858">,</span>&nbsp;<span class="ident" id="4063860">suiteECDHE</span><span class="op" id="4063870">,</span>&nbsp;<span class="ident" id="4063872">cipher3DES</span><span class="op" id="4063882">,</span>&nbsp;<span class="ident" id="4063884">macSHA1</span><span class="op" id="4063891">,</span>&nbsp;<span class="ident" id="4063893">nil</span><span class="op" id="4063896">}</span><span class="op" id="4063897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063900">{</span><span class="ident" id="4063901">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4063930">,</span>&nbsp;<span class="num" id="4063932">24</span><span class="op" id="4063934">,</span>&nbsp;<span class="num" id="4063936">20</span><span class="op" id="4063938">,</span>&nbsp;<span class="num" id="4063940">8</span><span class="op" id="4063941">,</span>&nbsp;<span class="ident" id="4063943">rsaKA</span><span class="op" id="4063948">,</span>&nbsp;<span class="num" id="4063950">0</span><span class="op" id="4063951">,</span>&nbsp;<span class="ident" id="4063953">cipher3DES</span><span class="op" id="4063963">,</span>&nbsp;<span class="ident" id="4063965">macSHA1</span><span class="op" id="4063972">,</span>&nbsp;<span class="ident" id="4063974">nil</span><span class="op" id="4063977">}</span><span class="op" id="4063978">,</span><br>
<span class="lineno">85</span><span class="op" id="4063980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4063983">func</span>&nbsp;<span class="ident" id="4063988">cipherRC4</span><span class="op" id="4063997">(</span><span class="ident" id="4063998">key</span><span class="op" id="4064001">,</span>&nbsp;<span class="ident" id="4064003">iv</span>&nbsp;<span class="op" id="4064006">[</span><span class="op" id="4064007">]</span><span class="builtintype" id="4064008">byte</span><span class="op" id="4064012">,</span>&nbsp;<span class="ident" id="4064014">isRead</span>&nbsp;<span class="builtintype" id="4064021">bool</span><span class="op" id="4064025">)</span>&nbsp;<span class="keyword" id="4064027">interface</span><span class="op" id="4064036">{</span><span class="op" id="4064037">}</span>&nbsp;<span class="op" id="4064039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064042">cipher</span><span class="op" id="4064048">,</span>&nbsp;<span class="ident" id="4064050">_</span>&nbsp;<span class="op" id="4064052">:=</span>&nbsp;<span class="ident" id="4064055">rc4</span><span class="op" id="4064058">.</span><span class="ident" id="4064059">NewCipher</span><span class="op" id="4064068">(</span><span class="ident" id="4064069">key</span><span class="op" id="4064072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064075">return</span>&nbsp;<span class="ident" id="4064082">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4064089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4064092">func</span>&nbsp;<span class="ident" id="4064097">cipher3DES</span><span class="op" id="4064107">(</span><span class="ident" id="4064108">key</span><span class="op" id="4064111">,</span>&nbsp;<span class="ident" id="4064113">iv</span>&nbsp;<span class="op" id="4064116">[</span><span class="op" id="4064117">]</span><span class="builtintype" id="4064118">byte</span><span class="op" id="4064122">,</span>&nbsp;<span class="ident" id="4064124">isRead</span>&nbsp;<span class="builtintype" id="4064131">bool</span><span class="op" id="4064135">)</span>&nbsp;<span class="keyword" id="4064137">interface</span><span class="op" id="4064146">{</span><span class="op" id="4064147">}</span>&nbsp;<span class="op" id="4064149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064152">block</span><span class="op" id="4064157">,</span>&nbsp;<span class="ident" id="4064159">_</span>&nbsp;<span class="op" id="4064161">:=</span>&nbsp;<span class="ident" id="4064164">des</span><span class="op" id="4064167">.</span><span class="ident" id="4064168">NewTripleDESCipher</span><span class="op" id="4064186">(</span><span class="ident" id="4064187">key</span><span class="op" id="4064190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064193">if</span>&nbsp;<span class="ident" id="4064196">isRead</span>&nbsp;<span class="op" id="4064203">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064207">return</span>&nbsp;<span class="ident" id="4064214">cipher</span><span class="op" id="4064220">.</span><span class="ident" id="4064221">NewCBCDecrypter</span><span class="op" id="4064236">(</span><span class="ident" id="4064237">block</span><span class="op" id="4064242">,</span>&nbsp;<span class="ident" id="4064244">iv</span><span class="op" id="4064246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064252">return</span>&nbsp;<span class="ident" id="4064259">cipher</span><span class="op" id="4064265">.</span><span class="ident" id="4064266">NewCBCEncrypter</span><span class="op" id="4064281">(</span><span class="ident" id="4064282">block</span><span class="op" id="4064287">,</span>&nbsp;<span class="ident" id="4064289">iv</span><span class="op" id="4064291">)</span><br>
<span class="lineno"></span><span class="op" id="4064293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4064296">func</span>&nbsp;<span class="ident" id="4064301">cipherAES</span><span class="op" id="4064310">(</span><span class="ident" id="4064311">key</span><span class="op" id="4064314">,</span>&nbsp;<span class="ident" id="4064316">iv</span>&nbsp;<span class="op" id="4064319">[</span><span class="op" id="4064320">]</span><span class="builtintype" id="4064321">byte</span><span class="op" id="4064325">,</span>&nbsp;<span class="ident" id="4064327">isRead</span>&nbsp;<span class="builtintype" id="4064334">bool</span><span class="op" id="4064338">)</span>&nbsp;<span class="keyword" id="4064340">interface</span><span class="op" id="4064349">{</span><span class="op" id="4064350">}</span>&nbsp;<span class="op" id="4064352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064355">block</span><span class="op" id="4064360">,</span>&nbsp;<span class="ident" id="4064362">_</span>&nbsp;<span class="op" id="4064364">:=</span>&nbsp;<span class="ident" id="4064367">aes</span><span class="op" id="4064370">.</span><span class="ident" id="4064371">NewCipher</span><span class="op" id="4064380">(</span><span class="ident" id="4064381">key</span><span class="op" id="4064384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064387">if</span>&nbsp;<span class="ident" id="4064390">isRead</span>&nbsp;<span class="op" id="4064397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064401">return</span>&nbsp;<span class="ident" id="4064408">cipher</span><span class="op" id="4064414">.</span><span class="ident" id="4064415">NewCBCDecrypter</span><span class="op" id="4064430">(</span><span class="ident" id="4064431">block</span><span class="op" id="4064436">,</span>&nbsp;<span class="ident" id="4064438">iv</span><span class="op" id="4064440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064443">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064446">return</span>&nbsp;<span class="ident" id="4064453">cipher</span><span class="op" id="4064459">.</span><span class="ident" id="4064460">NewCBCEncrypter</span><span class="op" id="4064475">(</span><span class="ident" id="4064476">block</span><span class="op" id="4064481">,</span>&nbsp;<span class="ident" id="4064483">iv</span><span class="op" id="4064485">)</span><br>
<span class="lineno"></span><span class="op" id="4064487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4064490">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4064555">func</span>&nbsp;<span class="ident" id="4064560">macSHA1</span><span class="op" id="4064567">(</span><span class="ident" id="4064568">version</span>&nbsp;<span class="builtintype" id="4064576">uint16</span><span class="op" id="4064582">,</span>&nbsp;<span class="ident" id="4064584">key</span>&nbsp;<span class="op" id="4064588">[</span><span class="op" id="4064589">]</span><span class="builtintype" id="4064590">byte</span><span class="op" id="4064594">)</span>&nbsp;<span class="ident" id="4064596">macFunction</span>&nbsp;<span class="op" id="4064608">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064611">if</span>&nbsp;<span class="ident" id="4064614">version</span>&nbsp;<span class="op" id="4064622">==</span>&nbsp;<span class="ident" id="4064625">VersionSSL30</span>&nbsp;<span class="op" id="4064638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064642">mac</span>&nbsp;<span class="op" id="4064646">:=</span>&nbsp;<span class="ident" id="4064649">ssl30MAC</span><span class="op" id="4064657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064662">h</span><span class="op" id="4064663">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4064667">sha1</span><span class="op" id="4064671">.</span><span class="ident" id="4064672">New</span><span class="op" id="4064675">(</span><span class="op" id="4064676">)</span><span class="op" id="4064677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064682">key</span><span class="op" id="4064685">:</span>&nbsp;<span class="builtinfunc" id="4064687">make</span><span class="op" id="4064691">(</span><span class="op" id="4064692">[</span><span class="op" id="4064693">]</span><span class="builtintype" id="4064694">byte</span><span class="op" id="4064698">,</span>&nbsp;<span class="builtinfunc" id="4064700">len</span><span class="op" id="4064703">(</span><span class="ident" id="4064704">key</span><span class="op" id="4064707">)</span><span class="op" id="4064708">)</span><span class="op" id="4064709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064713">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4064717">copy</span><span class="op" id="4064721">(</span><span class="ident" id="4064722">mac</span><span class="op" id="4064725">.</span><span class="ident" id="4064726">key</span><span class="op" id="4064729">,</span>&nbsp;<span class="ident" id="4064731">key</span><span class="op" id="4064734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064738">return</span>&nbsp;<span class="ident" id="4064745">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064753">return</span>&nbsp;<span class="ident" id="4064760">tls10MAC</span><span class="op" id="4064768">{</span><span class="ident" id="4064769">hmac</span><span class="op" id="4064773">.</span><span class="ident" id="4064774">New</span><span class="op" id="4064777">(</span><span class="ident" id="4064778">sha1</span><span class="op" id="4064782">.</span><span class="ident" id="4064783">New</span><span class="op" id="4064786">,</span>&nbsp;<span class="ident" id="4064788">key</span><span class="op" id="4064791">)</span><span class="op" id="4064792">}</span><br>
<span class="lineno"></span><span class="op" id="4064794">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4064797">type</span>&nbsp;<span class="ident" id="4064802">macFunction</span>&nbsp;<span class="keyword" id="4064814">interface</span>&nbsp;<span class="op" id="4064824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064827">Size</span><span class="op" id="4064831">(</span><span class="op" id="4064832">)</span>&nbsp;<span class="builtintype" id="4064834">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064839">MAC</span><span class="op" id="4064842">(</span><span class="ident" id="4064843">digestBuf</span><span class="op" id="4064852">,</span>&nbsp;<span class="ident" id="4064854">seq</span><span class="op" id="4064857">,</span>&nbsp;<span class="ident" id="4064859">header</span><span class="op" id="4064865">,</span>&nbsp;<span class="ident" id="4064867">data</span>&nbsp;<span class="op" id="4064872">[</span><span class="op" id="4064873">]</span><span class="builtintype" id="4064874">byte</span><span class="op" id="4064878">)</span>&nbsp;<span class="op" id="4064880">[</span><span class="op" id="4064881">]</span><span class="builtintype" id="4064882">byte</span><br>
<span class="lineno"></span><span class="op" id="4064887">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4064890">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4064967">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4064981">type</span>&nbsp;<span class="ident" id="4064986">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4065001">struct</span>&nbsp;<span class="op" id="4065008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4065011">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4065082">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4065146">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065201">sealNonce</span><span class="op" id="4065210">,</span>&nbsp;<span class="ident" id="4065212">openNonce</span>&nbsp;<span class="op" id="4065222">[</span><span class="op" id="4065223">]</span><span class="builtintype" id="4065224">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065230">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065251">cipher</span><span class="op" id="4065257">.</span><span class="ident" id="4065258">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4065263">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4065266">func</span>&nbsp;<span class="op" id="4065271">(</span><span class="ident" id="4065272">f</span>&nbsp;<span class="op" id="4065274">*</span><span class="ident" id="4065275">fixedNonceAEAD</span><span class="op" id="4065289">)</span>&nbsp;<span class="ident" id="4065291">NonceSize</span><span class="op" id="4065300">(</span><span class="op" id="4065301">)</span>&nbsp;<span class="builtintype" id="4065303">int</span>&nbsp;<span class="op" id="4065307">{</span>&nbsp;<span class="keyword" id="4065309">return</span>&nbsp;<span class="num" id="4065316">8</span>&nbsp;<span class="op" id="4065318">}</span><br>
<span class="lineno"></span><span class="keyword" id="4065320">func</span>&nbsp;<span class="op" id="4065325">(</span><span class="ident" id="4065326">f</span>&nbsp;<span class="op" id="4065328">*</span><span class="ident" id="4065329">fixedNonceAEAD</span><span class="op" id="4065343">)</span>&nbsp;<span class="ident" id="4065345">Overhead</span><span class="op" id="4065353">(</span><span class="op" id="4065354">)</span>&nbsp;<span class="builtintype" id="4065356">int</span>&nbsp;&nbsp;<span class="op" id="4065361">{</span>&nbsp;<span class="keyword" id="4065363">return</span>&nbsp;<span class="ident" id="4065370">f</span><span class="op" id="4065371">.</span><span class="ident" id="4065372">aead</span><span class="op" id="4065376">.</span><span class="ident" id="4065377">Overhead</span><span class="op" id="4065385">(</span><span class="op" id="4065386">)</span>&nbsp;<span class="op" id="4065388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065391">func</span>&nbsp;<span class="op" id="4065396">(</span><span class="ident" id="4065397">f</span>&nbsp;<span class="op" id="4065399">*</span><span class="ident" id="4065400">fixedNonceAEAD</span><span class="op" id="4065414">)</span>&nbsp;<span class="ident" id="4065416">Seal</span><span class="op" id="4065420">(</span><span class="ident" id="4065421">out</span><span class="op" id="4065424">,</span>&nbsp;<span class="ident" id="4065426">nonce</span><span class="op" id="4065431">,</span>&nbsp;<span class="ident" id="4065433">plaintext</span><span class="op" id="4065442">,</span>&nbsp;<span class="ident" id="4065444">additionalData</span>&nbsp;<span class="op" id="4065459">[</span><span class="op" id="4065460">]</span><span class="builtintype" id="4065461">byte</span><span class="op" id="4065465">)</span>&nbsp;<span class="op" id="4065467">[</span><span class="op" id="4065468">]</span><span class="builtintype" id="4065469">byte</span>&nbsp;<span class="op" id="4065474">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4065477">copy</span><span class="op" id="4065481">(</span><span class="ident" id="4065482">f</span><span class="op" id="4065483">.</span><span class="ident" id="4065484">sealNonce</span><span class="op" id="4065493">[</span><span class="builtinfunc" id="4065494">len</span><span class="op" id="4065497">(</span><span class="ident" id="4065498">f</span><span class="op" id="4065499">.</span><span class="ident" id="4065500">sealNonce</span><span class="op" id="4065509">)</span><span class="op" id="4065510">-</span><span class="num" id="4065511">8</span><span class="op" id="4065512">:</span><span class="op" id="4065513">]</span><span class="op" id="4065514">,</span>&nbsp;<span class="ident" id="4065516">nonce</span><span class="op" id="4065521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065524">return</span>&nbsp;<span class="ident" id="4065531">f</span><span class="op" id="4065532">.</span><span class="ident" id="4065533">aead</span><span class="op" id="4065537">.</span><span class="ident" id="4065538">Seal</span><span class="op" id="4065542">(</span><span class="ident" id="4065543">out</span><span class="op" id="4065546">,</span>&nbsp;<span class="ident" id="4065548">f</span><span class="op" id="4065549">.</span><span class="ident" id="4065550">sealNonce</span><span class="op" id="4065559">,</span>&nbsp;<span class="ident" id="4065561">plaintext</span><span class="op" id="4065570">,</span>&nbsp;<span class="ident" id="4065572">additionalData</span><span class="op" id="4065586">)</span><br>
<span class="lineno"></span><span class="op" id="4065588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065591">func</span>&nbsp;<span class="op" id="4065596">(</span><span class="ident" id="4065597">f</span>&nbsp;<span class="op" id="4065599">*</span><span class="ident" id="4065600">fixedNonceAEAD</span><span class="op" id="4065614">)</span>&nbsp;<span class="ident" id="4065616">Open</span><span class="op" id="4065620">(</span><span class="ident" id="4065621">out</span><span class="op" id="4065624">,</span>&nbsp;<span class="ident" id="4065626">nonce</span><span class="op" id="4065631">,</span>&nbsp;<span class="ident" id="4065633">plaintext</span><span class="op" id="4065642">,</span>&nbsp;<span class="ident" id="4065644">additionalData</span>&nbsp;<span class="op" id="4065659">[</span><span class="op" id="4065660">]</span><span class="builtintype" id="4065661">byte</span><span class="op" id="4065665">)</span>&nbsp;<span class="op" id="4065667">(</span><span class="op" id="4065668">[</span><span class="op" id="4065669">]</span><span class="builtintype" id="4065670">byte</span><span class="op" id="4065674">,</span>&nbsp;<span class="builtintype" id="4065676">error</span><span class="op" id="4065681">)</span>&nbsp;<span class="op" id="4065683">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4065686">copy</span><span class="op" id="4065690">(</span><span class="ident" id="4065691">f</span><span class="op" id="4065692">.</span><span class="ident" id="4065693">openNonce</span><span class="op" id="4065702">[</span><span class="builtinfunc" id="4065703">len</span><span class="op" id="4065706">(</span><span class="ident" id="4065707">f</span><span class="op" id="4065708">.</span><span class="ident" id="4065709">openNonce</span><span class="op" id="4065718">)</span><span class="op" id="4065719">-</span><span class="num" id="4065720">8</span><span class="op" id="4065721">:</span><span class="op" id="4065722">]</span><span class="op" id="4065723">,</span>&nbsp;<span class="ident" id="4065725">nonce</span><span class="op" id="4065730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065733">return</span>&nbsp;<span class="ident" id="4065740">f</span><span class="op" id="4065741">.</span><span class="ident" id="4065742">aead</span><span class="op" id="4065746">.</span><span class="ident" id="4065747">Open</span><span class="op" id="4065751">(</span><span class="ident" id="4065752">out</span><span class="op" id="4065755">,</span>&nbsp;<span class="ident" id="4065757">f</span><span class="op" id="4065758">.</span><span class="ident" id="4065759">openNonce</span><span class="op" id="4065768">,</span>&nbsp;<span class="ident" id="4065770">plaintext</span><span class="op" id="4065779">,</span>&nbsp;<span class="ident" id="4065781">additionalData</span><span class="op" id="4065795">)</span><br>
<span class="lineno"></span><span class="op" id="4065797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065800">func</span>&nbsp;<span class="ident" id="4065805">aeadAESGCM</span><span class="op" id="4065815">(</span><span class="ident" id="4065816">key</span><span class="op" id="4065819">,</span>&nbsp;<span class="ident" id="4065821">fixedNonce</span>&nbsp;<span class="op" id="4065832">[</span><span class="op" id="4065833">]</span><span class="builtintype" id="4065834">byte</span><span class="op" id="4065838">)</span>&nbsp;<span class="ident" id="4065840">cipher</span><span class="op" id="4065846">.</span><span class="ident" id="4065847">AEAD</span>&nbsp;<span class="op" id="4065852">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065855">aes</span><span class="op" id="4065858">,</span>&nbsp;<span class="ident" id="4065860">err</span>&nbsp;<span class="op" id="4065864">:=</span>&nbsp;<span class="ident" id="4065867">aes</span><span class="op" id="4065870">.</span><span class="ident" id="4065871">NewCipher</span><span class="op" id="4065880">(</span><span class="ident" id="4065881">key</span><span class="op" id="4065884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065887">if</span>&nbsp;<span class="ident" id="4065890">err</span>&nbsp;<span class="op" id="4065894">!=</span>&nbsp;<span class="ident" id="4065897">nil</span>&nbsp;<span class="op" id="4065901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4065905">panic</span><span class="op" id="4065910">(</span><span class="ident" id="4065911">err</span><span class="op" id="4065914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4065917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065920">aead</span><span class="op" id="4065924">,</span>&nbsp;<span class="ident" id="4065926">err</span>&nbsp;<span class="op" id="4065930">:=</span>&nbsp;<span class="ident" id="4065933">cipher</span><span class="op" id="4065939">.</span><span class="ident" id="4065940">NewGCM</span><span class="op" id="4065946">(</span><span class="ident" id="4065947">aes</span><span class="op" id="4065950">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065953">if</span>&nbsp;<span class="ident" id="4065956">err</span>&nbsp;<span class="op" id="4065960">!=</span>&nbsp;<span class="ident" id="4065963">nil</span>&nbsp;<span class="op" id="4065967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4065971">panic</span><span class="op" id="4065976">(</span><span class="ident" id="4065977">err</span><span class="op" id="4065980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4065983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065987">nonce1</span><span class="op" id="4065993">,</span>&nbsp;<span class="ident" id="4065995">nonce2</span>&nbsp;<span class="op" id="4066002">:=</span>&nbsp;<span class="builtinfunc" id="4066005">make</span><span class="op" id="4066009">(</span><span class="op" id="4066010">[</span><span class="op" id="4066011">]</span><span class="builtintype" id="4066012">byte</span><span class="op" id="4066016">,</span>&nbsp;<span class="num" id="4066018">12</span><span class="op" id="4066020">)</span><span class="op" id="4066021">,</span>&nbsp;<span class="builtinfunc" id="4066023">make</span><span class="op" id="4066027">(</span><span class="op" id="4066028">[</span><span class="op" id="4066029">]</span><span class="builtintype" id="4066030">byte</span><span class="op" id="4066034">,</span>&nbsp;<span class="num" id="4066036">12</span><span class="op" id="4066038">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4066041">copy</span><span class="op" id="4066045">(</span><span class="ident" id="4066046">nonce1</span><span class="op" id="4066052">,</span>&nbsp;<span class="ident" id="4066054">fixedNonce</span><span class="op" id="4066064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4066067">copy</span><span class="op" id="4066071">(</span><span class="ident" id="4066072">nonce2</span><span class="op" id="4066078">,</span>&nbsp;<span class="ident" id="4066080">fixedNonce</span><span class="op" id="4066090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066094">return</span>&nbsp;<span class="op" id="4066101">&amp;</span><span class="ident" id="4066102">fixedNonceAEAD</span><span class="op" id="4066116">{</span><span class="ident" id="4066117">nonce1</span><span class="op" id="4066123">,</span>&nbsp;<span class="ident" id="4066125">nonce2</span><span class="op" id="4066131">,</span>&nbsp;<span class="ident" id="4066133">aead</span><span class="op" id="4066137">}</span><br>
<span class="lineno"></span><span class="op" id="4066139">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4066142">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4066203">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4066281">type</span>&nbsp;<span class="ident" id="4066286">ssl30MAC</span>&nbsp;<span class="keyword" id="4066295">struct</span>&nbsp;<span class="op" id="4066302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066305">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4066309">hash</span><span class="op" id="4066313">.</span><span class="ident" id="4066314">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066320">key</span>&nbsp;<span class="op" id="4066324">[</span><span class="op" id="4066325">]</span><span class="builtintype" id="4066326">byte</span><br>
<span class="lineno"></span><span class="op" id="4066331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066334">func</span>&nbsp;<span class="op" id="4066339">(</span><span class="ident" id="4066340">s</span>&nbsp;<span class="ident" id="4066342">ssl30MAC</span><span class="op" id="4066350">)</span>&nbsp;<span class="ident" id="4066352">Size</span><span class="op" id="4066356">(</span><span class="op" id="4066357">)</span>&nbsp;<span class="builtintype" id="4066359">int</span>&nbsp;<span class="op" id="4066363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066366">return</span>&nbsp;<span class="ident" id="4066373">s</span><span class="op" id="4066374">.</span><span class="ident" id="4066375">h</span><span class="op" id="4066376">.</span><span class="ident" id="4066377">Size</span><span class="op" id="4066381">(</span><span class="op" id="4066382">)</span><br>
<span class="lineno">175</span><span class="op" id="4066384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066387">var</span>&nbsp;<span class="ident" id="4066391">ssl30Pad1</span>&nbsp;<span class="op" id="4066401">=</span>&nbsp;<span class="op" id="4066403">[</span><span class="num" id="4066404">48</span><span class="op" id="4066406">]</span><span class="builtintype" id="4066407">byte</span><span class="op" id="4066411">{</span><span class="num" id="4066412">0x36</span><span class="op" id="4066416">,</span>&nbsp;<span class="num" id="4066418">0x36</span><span class="op" id="4066422">,</span>&nbsp;<span class="num" id="4066424">0x36</span><span class="op" id="4066428">,</span>&nbsp;<span class="num" id="4066430">0x36</span><span class="op" id="4066434">,</span>&nbsp;<span class="num" id="4066436">0x36</span><span class="op" id="4066440">,</span>&nbsp;<span class="num" id="4066442">0x36</span><span class="op" id="4066446">,</span>&nbsp;<span class="num" id="4066448">0x36</span><span class="op" id="4066452">,</span>&nbsp;<span class="num" id="4066454">0x36</span><span class="op" id="4066458">,</span>&nbsp;<span class="num" id="4066460">0x36</span><span class="op" id="4066464">,</span>&nbsp;<span class="num" id="4066466">0x36</span><span class="op" id="4066470">,</span>&nbsp;<span class="num" id="4066472">0x36</span><span class="op" id="4066476">,</span>&nbsp;<span class="num" id="4066478">0x36</span><span class="op" id="4066482">,</span>&nbsp;<span class="num" id="4066484">0x36</span><span class="op" id="4066488">,</span>&nbsp;<span class="num" id="4066490">0x36</span><span class="op" id="4066494">,</span>&nbsp;<span class="num" id="4066496">0x36</span><span class="op" id="4066500">,</span>&nbsp;<span class="num" id="4066502">0x36</span><span class="op" id="4066506">,</span>&nbsp;<span class="num" id="4066508">0x36</span><span class="op" id="4066512">,</span>&nbsp;<span class="num" id="4066514">0x36</span><span class="op" id="4066518">,</span>&nbsp;<span class="num" id="4066520">0x36</span><span class="op" id="4066524">,</span>&nbsp;<span class="num" id="4066526">0x36</span><span class="op" id="4066530">,</span>&nbsp;<span class="num" id="4066532">0x36</span><span class="op" id="4066536">,</span>&nbsp;<span class="num" id="4066538">0x36</span><span class="op" id="4066542">,</span>&nbsp;<span class="num" id="4066544">0x36</span><span class="op" id="4066548">,</span>&nbsp;<span class="num" id="4066550">0x36</span><span class="op" id="4066554">,</span>&nbsp;<span class="num" id="4066556">0x36</span><span class="op" id="4066560">,</span>&nbsp;<span class="num" id="4066562">0x36</span><span class="op" id="4066566">,</span>&nbsp;<span class="num" id="4066568">0x36</span><span class="op" id="4066572">,</span>&nbsp;<span class="num" id="4066574">0x36</span><span class="op" id="4066578">,</span>&nbsp;<span class="num" id="4066580">0x36</span><span class="op" id="4066584">,</span>&nbsp;<span class="num" id="4066586">0x36</span><span class="op" id="4066590">,</span>&nbsp;<span class="num" id="4066592">0x36</span><span class="op" id="4066596">,</span>&nbsp;<span class="num" id="4066598">0x36</span><span class="op" id="4066602">,</span>&nbsp;<span class="num" id="4066604">0x36</span><span class="op" id="4066608">,</span>&nbsp;<span class="num" id="4066610">0x36</span><span class="op" id="4066614">,</span>&nbsp;<span class="num" id="4066616">0x36</span><span class="op" id="4066620">,</span>&nbsp;<span class="num" id="4066622">0x36</span><span class="op" id="4066626">,</span>&nbsp;<span class="num" id="4066628">0x36</span><span class="op" id="4066632">,</span>&nbsp;<span class="num" id="4066634">0x36</span><span class="op" id="4066638">,</span>&nbsp;<span class="num" id="4066640">0x36</span><span class="op" id="4066644">,</span>&nbsp;<span class="num" id="4066646">0x36</span><span class="op" id="4066650">,</span>&nbsp;<span class="num" id="4066652">0x36</span><span class="op" id="4066656">,</span>&nbsp;<span class="num" id="4066658">0x36</span><span class="op" id="4066662">,</span>&nbsp;<span class="num" id="4066664">0x36</span><span class="op" id="4066668">,</span>&nbsp;<span class="num" id="4066670">0x36</span><span class="op" id="4066674">,</span>&nbsp;<span class="num" id="4066676">0x36</span><span class="op" id="4066680">,</span>&nbsp;<span class="num" id="4066682">0x36</span><span class="op" id="4066686">,</span>&nbsp;<span class="num" id="4066688">0x36</span><span class="op" id="4066692">,</span>&nbsp;<span class="num" id="4066694">0x36</span><span class="op" id="4066698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066701">var</span>&nbsp;<span class="ident" id="4066705">ssl30Pad2</span>&nbsp;<span class="op" id="4066715">=</span>&nbsp;<span class="op" id="4066717">[</span><span class="num" id="4066718">48</span><span class="op" id="4066720">]</span><span class="builtintype" id="4066721">byte</span><span class="op" id="4066725">{</span><span class="num" id="4066726">0x5c</span><span class="op" id="4066730">,</span>&nbsp;<span class="num" id="4066732">0x5c</span><span class="op" id="4066736">,</span>&nbsp;<span class="num" id="4066738">0x5c</span><span class="op" id="4066742">,</span>&nbsp;<span class="num" id="4066744">0x5c</span><span class="op" id="4066748">,</span>&nbsp;<span class="num" id="4066750">0x5c</span><span class="op" id="4066754">,</span>&nbsp;<span class="num" id="4066756">0x5c</span><span class="op" id="4066760">,</span>&nbsp;<span class="num" id="4066762">0x5c</span><span class="op" id="4066766">,</span>&nbsp;<span class="num" id="4066768">0x5c</span><span class="op" id="4066772">,</span>&nbsp;<span class="num" id="4066774">0x5c</span><span class="op" id="4066778">,</span>&nbsp;<span class="num" id="4066780">0x5c</span><span class="op" id="4066784">,</span>&nbsp;<span class="num" id="4066786">0x5c</span><span class="op" id="4066790">,</span>&nbsp;<span class="num" id="4066792">0x5c</span><span class="op" id="4066796">,</span>&nbsp;<span class="num" id="4066798">0x5c</span><span class="op" id="4066802">,</span>&nbsp;<span class="num" id="4066804">0x5c</span><span class="op" id="4066808">,</span>&nbsp;<span class="num" id="4066810">0x5c</span><span class="op" id="4066814">,</span>&nbsp;<span class="num" id="4066816">0x5c</span><span class="op" id="4066820">,</span>&nbsp;<span class="num" id="4066822">0x5c</span><span class="op" id="4066826">,</span>&nbsp;<span class="num" id="4066828">0x5c</span><span class="op" id="4066832">,</span>&nbsp;<span class="num" id="4066834">0x5c</span><span class="op" id="4066838">,</span>&nbsp;<span class="num" id="4066840">0x5c</span><span class="op" id="4066844">,</span>&nbsp;<span class="num" id="4066846">0x5c</span><span class="op" id="4066850">,</span>&nbsp;<span class="num" id="4066852">0x5c</span><span class="op" id="4066856">,</span>&nbsp;<span class="num" id="4066858">0x5c</span><span class="op" id="4066862">,</span>&nbsp;<span class="num" id="4066864">0x5c</span><span class="op" id="4066868">,</span>&nbsp;<span class="num" id="4066870">0x5c</span><span class="op" id="4066874">,</span>&nbsp;<span class="num" id="4066876">0x5c</span><span class="op" id="4066880">,</span>&nbsp;<span class="num" id="4066882">0x5c</span><span class="op" id="4066886">,</span>&nbsp;<span class="num" id="4066888">0x5c</span><span class="op" id="4066892">,</span>&nbsp;<span class="num" id="4066894">0x5c</span><span class="op" id="4066898">,</span>&nbsp;<span class="num" id="4066900">0x5c</span><span class="op" id="4066904">,</span>&nbsp;<span class="num" id="4066906">0x5c</span><span class="op" id="4066910">,</span>&nbsp;<span class="num" id="4066912">0x5c</span><span class="op" id="4066916">,</span>&nbsp;<span class="num" id="4066918">0x5c</span><span class="op" id="4066922">,</span>&nbsp;<span class="num" id="4066924">0x5c</span><span class="op" id="4066928">,</span>&nbsp;<span class="num" id="4066930">0x5c</span><span class="op" id="4066934">,</span>&nbsp;<span class="num" id="4066936">0x5c</span><span class="op" id="4066940">,</span>&nbsp;<span class="num" id="4066942">0x5c</span><span class="op" id="4066946">,</span>&nbsp;<span class="num" id="4066948">0x5c</span><span class="op" id="4066952">,</span>&nbsp;<span class="num" id="4066954">0x5c</span><span class="op" id="4066958">,</span>&nbsp;<span class="num" id="4066960">0x5c</span><span class="op" id="4066964">,</span>&nbsp;<span class="num" id="4066966">0x5c</span><span class="op" id="4066970">,</span>&nbsp;<span class="num" id="4066972">0x5c</span><span class="op" id="4066976">,</span>&nbsp;<span class="num" id="4066978">0x5c</span><span class="op" id="4066982">,</span>&nbsp;<span class="num" id="4066984">0x5c</span><span class="op" id="4066988">,</span>&nbsp;<span class="num" id="4066990">0x5c</span><span class="op" id="4066994">,</span>&nbsp;<span class="num" id="4066996">0x5c</span><span class="op" id="4067000">,</span>&nbsp;<span class="num" id="4067002">0x5c</span><span class="op" id="4067006">,</span>&nbsp;<span class="num" id="4067008">0x5c</span><span class="op" id="4067012">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4067015">func</span>&nbsp;<span class="op" id="4067020">(</span><span class="ident" id="4067021">s</span>&nbsp;<span class="ident" id="4067023">ssl30MAC</span><span class="op" id="4067031">)</span>&nbsp;<span class="ident" id="4067033">MAC</span><span class="op" id="4067036">(</span><span class="ident" id="4067037">digestBuf</span><span class="op" id="4067046">,</span>&nbsp;<span class="ident" id="4067048">seq</span><span class="op" id="4067051">,</span>&nbsp;<span class="ident" id="4067053">header</span><span class="op" id="4067059">,</span>&nbsp;<span class="ident" id="4067061">data</span>&nbsp;<span class="op" id="4067066">[</span><span class="op" id="4067067">]</span><span class="builtintype" id="4067068">byte</span><span class="op" id="4067072">)</span>&nbsp;<span class="op" id="4067074">[</span><span class="op" id="4067075">]</span><span class="builtintype" id="4067076">byte</span>&nbsp;<span class="op" id="4067081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067084">padLength</span>&nbsp;<span class="op" id="4067094">:=</span>&nbsp;<span class="num" id="4067097">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067101">if</span>&nbsp;<span class="ident" id="4067104">s</span><span class="op" id="4067105">.</span><span class="ident" id="4067106">h</span><span class="op" id="4067107">.</span><span class="ident" id="4067108">Size</span><span class="op" id="4067112">(</span><span class="op" id="4067113">)</span>&nbsp;<span class="op" id="4067115">==</span>&nbsp;<span class="num" id="4067118">20</span>&nbsp;<span class="op" id="4067121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067125">padLength</span>&nbsp;<span class="op" id="4067135">=</span>&nbsp;<span class="num" id="4067137">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067145">s</span><span class="op" id="4067146">.</span><span class="ident" id="4067147">h</span><span class="op" id="4067148">.</span><span class="ident" id="4067149">Reset</span><span class="op" id="4067154">(</span><span class="op" id="4067155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067158">s</span><span class="op" id="4067159">.</span><span class="ident" id="4067160">h</span><span class="op" id="4067161">.</span><span class="ident" id="4067162">Write</span><span class="op" id="4067167">(</span><span class="ident" id="4067168">s</span><span class="op" id="4067169">.</span><span class="ident" id="4067170">key</span><span class="op" id="4067173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067176">s</span><span class="op" id="4067177">.</span><span class="ident" id="4067178">h</span><span class="op" id="4067179">.</span><span class="ident" id="4067180">Write</span><span class="op" id="4067185">(</span><span class="ident" id="4067186">ssl30Pad1</span><span class="op" id="4067195">[</span><span class="op" id="4067196">:</span><span class="ident" id="4067197">padLength</span><span class="op" id="4067206">]</span><span class="op" id="4067207">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067210">s</span><span class="op" id="4067211">.</span><span class="ident" id="4067212">h</span><span class="op" id="4067213">.</span><span class="ident" id="4067214">Write</span><span class="op" id="4067219">(</span><span class="ident" id="4067220">seq</span><span class="op" id="4067223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067226">s</span><span class="op" id="4067227">.</span><span class="ident" id="4067228">h</span><span class="op" id="4067229">.</span><span class="ident" id="4067230">Write</span><span class="op" id="4067235">(</span><span class="ident" id="4067236">header</span><span class="op" id="4067242">[</span><span class="op" id="4067243">:</span><span class="num" id="4067244">1</span><span class="op" id="4067245">]</span><span class="op" id="4067246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067249">s</span><span class="op" id="4067250">.</span><span class="ident" id="4067251">h</span><span class="op" id="4067252">.</span><span class="ident" id="4067253">Write</span><span class="op" id="4067258">(</span><span class="ident" id="4067259">header</span><span class="op" id="4067265">[</span><span class="num" id="4067266">3</span><span class="op" id="4067267">:</span><span class="num" id="4067268">5</span><span class="op" id="4067269">]</span><span class="op" id="4067270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067273">s</span><span class="op" id="4067274">.</span><span class="ident" id="4067275">h</span><span class="op" id="4067276">.</span><span class="ident" id="4067277">Write</span><span class="op" id="4067282">(</span><span class="ident" id="4067283">data</span><span class="op" id="4067287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067290">digestBuf</span>&nbsp;<span class="op" id="4067300">=</span>&nbsp;<span class="ident" id="4067302">s</span><span class="op" id="4067303">.</span><span class="ident" id="4067304">h</span><span class="op" id="4067305">.</span><span class="ident" id="4067306">Sum</span><span class="op" id="4067309">(</span><span class="ident" id="4067310">digestBuf</span><span class="op" id="4067319">[</span><span class="op" id="4067320">:</span><span class="num" id="4067321">0</span><span class="op" id="4067322">]</span><span class="op" id="4067323">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067327">s</span><span class="op" id="4067328">.</span><span class="ident" id="4067329">h</span><span class="op" id="4067330">.</span><span class="ident" id="4067331">Reset</span><span class="op" id="4067336">(</span><span class="op" id="4067337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067340">s</span><span class="op" id="4067341">.</span><span class="ident" id="4067342">h</span><span class="op" id="4067343">.</span><span class="ident" id="4067344">Write</span><span class="op" id="4067349">(</span><span class="ident" id="4067350">s</span><span class="op" id="4067351">.</span><span class="ident" id="4067352">key</span><span class="op" id="4067355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067358">s</span><span class="op" id="4067359">.</span><span class="ident" id="4067360">h</span><span class="op" id="4067361">.</span><span class="ident" id="4067362">Write</span><span class="op" id="4067367">(</span><span class="ident" id="4067368">ssl30Pad2</span><span class="op" id="4067377">[</span><span class="op" id="4067378">:</span><span class="ident" id="4067379">padLength</span><span class="op" id="4067388">]</span><span class="op" id="4067389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067392">s</span><span class="op" id="4067393">.</span><span class="ident" id="4067394">h</span><span class="op" id="4067395">.</span><span class="ident" id="4067396">Write</span><span class="op" id="4067401">(</span><span class="ident" id="4067402">digestBuf</span><span class="op" id="4067411">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067414">return</span>&nbsp;<span class="ident" id="4067421">s</span><span class="op" id="4067422">.</span><span class="ident" id="4067423">h</span><span class="op" id="4067424">.</span><span class="ident" id="4067425">Sum</span><span class="op" id="4067428">(</span><span class="ident" id="4067429">digestBuf</span><span class="op" id="4067438">[</span><span class="op" id="4067439">:</span><span class="num" id="4067440">0</span><span class="op" id="4067441">]</span><span class="op" id="4067442">)</span><br>
<span class="lineno"></span><span class="op" id="4067444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067447">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4067521">type</span>&nbsp;<span class="ident" id="4067526">tls10MAC</span>&nbsp;<span class="keyword" id="4067535">struct</span>&nbsp;<span class="op" id="4067542">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067545">h</span>&nbsp;<span class="ident" id="4067547">hash</span><span class="op" id="4067551">.</span><span class="ident" id="4067552">Hash</span><br>
<span class="lineno"></span><span class="op" id="4067557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067560">func</span>&nbsp;<span class="op" id="4067565">(</span><span class="ident" id="4067566">s</span>&nbsp;<span class="ident" id="4067568">tls10MAC</span><span class="op" id="4067576">)</span>&nbsp;<span class="ident" id="4067578">Size</span><span class="op" id="4067582">(</span><span class="op" id="4067583">)</span>&nbsp;<span class="builtintype" id="4067585">int</span>&nbsp;<span class="op" id="4067589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067592">return</span>&nbsp;<span class="ident" id="4067599">s</span><span class="op" id="4067600">.</span><span class="ident" id="4067601">h</span><span class="op" id="4067602">.</span><span class="ident" id="4067603">Size</span><span class="op" id="4067607">(</span><span class="op" id="4067608">)</span><br>
<span class="lineno">210</span><span class="op" id="4067610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067613">func</span>&nbsp;<span class="op" id="4067618">(</span><span class="ident" id="4067619">s</span>&nbsp;<span class="ident" id="4067621">tls10MAC</span><span class="op" id="4067629">)</span>&nbsp;<span class="ident" id="4067631">MAC</span><span class="op" id="4067634">(</span><span class="ident" id="4067635">digestBuf</span><span class="op" id="4067644">,</span>&nbsp;<span class="ident" id="4067646">seq</span><span class="op" id="4067649">,</span>&nbsp;<span class="ident" id="4067651">header</span><span class="op" id="4067657">,</span>&nbsp;<span class="ident" id="4067659">data</span>&nbsp;<span class="op" id="4067664">[</span><span class="op" id="4067665">]</span><span class="builtintype" id="4067666">byte</span><span class="op" id="4067670">)</span>&nbsp;<span class="op" id="4067672">[</span><span class="op" id="4067673">]</span><span class="builtintype" id="4067674">byte</span>&nbsp;<span class="op" id="4067679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067682">s</span><span class="op" id="4067683">.</span><span class="ident" id="4067684">h</span><span class="op" id="4067685">.</span><span class="ident" id="4067686">Reset</span><span class="op" id="4067691">(</span><span class="op" id="4067692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067695">s</span><span class="op" id="4067696">.</span><span class="ident" id="4067697">h</span><span class="op" id="4067698">.</span><span class="ident" id="4067699">Write</span><span class="op" id="4067704">(</span><span class="ident" id="4067705">seq</span><span class="op" id="4067708">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067711">s</span><span class="op" id="4067712">.</span><span class="ident" id="4067713">h</span><span class="op" id="4067714">.</span><span class="ident" id="4067715">Write</span><span class="op" id="4067720">(</span><span class="ident" id="4067721">header</span><span class="op" id="4067727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067730">s</span><span class="op" id="4067731">.</span><span class="ident" id="4067732">h</span><span class="op" id="4067733">.</span><span class="ident" id="4067734">Write</span><span class="op" id="4067739">(</span><span class="ident" id="4067740">data</span><span class="op" id="4067744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067747">return</span>&nbsp;<span class="ident" id="4067754">s</span><span class="op" id="4067755">.</span><span class="ident" id="4067756">h</span><span class="op" id="4067757">.</span><span class="ident" id="4067758">Sum</span><span class="op" id="4067761">(</span><span class="ident" id="4067762">digestBuf</span><span class="op" id="4067771">[</span><span class="op" id="4067772">:</span><span class="num" id="4067773">0</span><span class="op" id="4067774">]</span><span class="op" id="4067775">)</span><br>
<span class="lineno"></span><span class="op" id="4067777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4067780">func</span>&nbsp;<span class="ident" id="4067785">rsaKA</span><span class="op" id="4067790">(</span><span class="ident" id="4067791">version</span>&nbsp;<span class="builtintype" id="4067799">uint16</span><span class="op" id="4067805">)</span>&nbsp;<span class="ident" id="4067807">keyAgreement</span>&nbsp;<span class="op" id="4067820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067823">return</span>&nbsp;<span class="ident" id="4067830">rsaKeyAgreement</span><span class="op" id="4067845">{</span><span class="op" id="4067846">}</span><br>
<span class="lineno"></span><span class="op" id="4067848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067851">func</span>&nbsp;<span class="ident" id="4067856">ecdheECDSAKA</span><span class="op" id="4067868">(</span><span class="ident" id="4067869">version</span>&nbsp;<span class="builtintype" id="4067877">uint16</span><span class="op" id="4067883">)</span>&nbsp;<span class="ident" id="4067885">keyAgreement</span>&nbsp;<span class="op" id="4067898">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067901">return</span>&nbsp;<span class="op" id="4067908">&amp;</span><span class="ident" id="4067909">ecdheKeyAgreement</span><span class="op" id="4067926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067930">sigType</span><span class="op" id="4067937">:</span>&nbsp;<span class="ident" id="4067939">signatureECDSA</span><span class="op" id="4067953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067957">version</span><span class="op" id="4067964">:</span>&nbsp;<span class="ident" id="4067966">version</span><span class="op" id="4067973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067976">}</span><br>
<span class="lineno"></span><span class="op" id="4067978">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4067981">func</span>&nbsp;<span class="ident" id="4067986">ecdheRSAKA</span><span class="op" id="4067996">(</span><span class="ident" id="4067997">version</span>&nbsp;<span class="builtintype" id="4068005">uint16</span><span class="op" id="4068011">)</span>&nbsp;<span class="ident" id="4068013">keyAgreement</span>&nbsp;<span class="op" id="4068026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068029">return</span>&nbsp;<span class="op" id="4068036">&amp;</span><span class="ident" id="4068037">ecdheKeyAgreement</span><span class="op" id="4068054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068058">sigType</span><span class="op" id="4068065">:</span>&nbsp;<span class="ident" id="4068067">signatureRSA</span><span class="op" id="4068079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068083">version</span><span class="op" id="4068090">:</span>&nbsp;<span class="ident" id="4068092">version</span><span class="op" id="4068099">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068102">}</span><br>
<span class="lineno"></span><span class="op" id="4068104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068107">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4068176">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4068226">func</span>&nbsp;<span class="ident" id="4068231">mutualCipherSuite</span><span class="op" id="4068248">(</span><span class="ident" id="4068249">have</span>&nbsp;<span class="op" id="4068254">[</span><span class="op" id="4068255">]</span><span class="builtintype" id="4068256">uint16</span><span class="op" id="4068262">,</span>&nbsp;<span class="ident" id="4068264">want</span>&nbsp;<span class="builtintype" id="4068269">uint16</span><span class="op" id="4068275">)</span>&nbsp;<span class="op" id="4068277">*</span><span class="ident" id="4068278">cipherSuite</span>&nbsp;<span class="op" id="4068290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068293">for</span>&nbsp;<span class="ident" id="4068297">_</span><span class="op" id="4068298">,</span>&nbsp;<span class="ident" id="4068300">id</span>&nbsp;<span class="op" id="4068303">:=</span>&nbsp;<span class="keyword" id="4068306">range</span>&nbsp;<span class="ident" id="4068312">have</span>&nbsp;<span class="op" id="4068317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068321">if</span>&nbsp;<span class="ident" id="4068324">id</span>&nbsp;<span class="op" id="4068327">==</span>&nbsp;<span class="ident" id="4068330">want</span>&nbsp;<span class="op" id="4068335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068340">for</span>&nbsp;<span class="ident" id="4068344">_</span><span class="op" id="4068345">,</span>&nbsp;<span class="ident" id="4068347">suite</span>&nbsp;<span class="op" id="4068353">:=</span>&nbsp;<span class="keyword" id="4068356">range</span>&nbsp;<span class="ident" id="4068362">cipherSuites</span>&nbsp;<span class="op" id="4068375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068381">if</span>&nbsp;<span class="ident" id="4068384">suite</span><span class="op" id="4068389">.</span><span class="ident" id="4068390">id</span>&nbsp;<span class="op" id="4068393">==</span>&nbsp;<span class="ident" id="4068396">want</span>&nbsp;<span class="op" id="4068401">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068408">return</span>&nbsp;<span class="ident" id="4068415">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068435">return</span>&nbsp;<span class="ident" id="4068442">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068448">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068454">return</span>&nbsp;<span class="ident" id="4068461">nil</span><br>
<span class="lineno"></span><span class="op" id="4068465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068468">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4068523">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4068592">const</span>&nbsp;<span class="op" id="4068598">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068601">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068641">uint16</span>&nbsp;<span class="op" id="4068648">=</span>&nbsp;<span class="num" id="4068650">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068658">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068698">uint16</span>&nbsp;<span class="op" id="4068705">=</span>&nbsp;<span class="num" id="4068707">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068715">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068755">uint16</span>&nbsp;<span class="op" id="4068762">=</span>&nbsp;<span class="num" id="4068764">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068772">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068812">uint16</span>&nbsp;<span class="op" id="4068819">=</span>&nbsp;<span class="num" id="4068821">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068829">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068869">uint16</span>&nbsp;<span class="op" id="4068876">=</span>&nbsp;<span class="num" id="4068878">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068886">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068926">uint16</span>&nbsp;<span class="op" id="4068933">=</span>&nbsp;<span class="num" id="4068935">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068943">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4068983">uint16</span>&nbsp;<span class="op" id="4068990">=</span>&nbsp;<span class="num" id="4068992">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069000">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4069040">uint16</span>&nbsp;<span class="op" id="4069047">=</span>&nbsp;<span class="num" id="4069049">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069057">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4069097">uint16</span>&nbsp;<span class="op" id="4069104">=</span>&nbsp;<span class="num" id="4069106">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069114">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4069154">uint16</span>&nbsp;<span class="op" id="4069161">=</span>&nbsp;<span class="num" id="4069163">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069171">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4069211">uint16</span>&nbsp;<span class="op" id="4069218">=</span>&nbsp;<span class="num" id="4069220">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069228">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4069268">uint16</span>&nbsp;<span class="op" id="4069275">=</span>&nbsp;<span class="num" id="4069277">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069285">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4069325">uint16</span>&nbsp;<span class="op" id="4069332">=</span>&nbsp;<span class="num" id="4069334">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069343">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069412">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069463">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069529">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4069547">uint16</span>&nbsp;<span class="op" id="4069554">=</span>&nbsp;<span class="num" id="4069556">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4069563">)</span>
</div>
</body>
</html>
