<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4876046">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4876101">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4876155">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4876206">package</span>&nbsp;<span class="ident" id="4876214">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4876221">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="4876278">func</span>&nbsp;<span class="ident" id="4876283">RGBToYCbCr</span><span class="op" id="4876293">(</span><span class="ident" id="4876294">r</span><span class="op" id="4876295">,</span>&nbsp;<span class="ident" id="4876297">g</span><span class="op" id="4876298">,</span>&nbsp;<span class="ident" id="4876300">b</span>&nbsp;<span class="builtintype" id="4876302">uint8</span><span class="op" id="4876307">)</span>&nbsp;<span class="op" id="4876309">(</span><span class="builtintype" id="4876310">uint8</span><span class="op" id="4876315">,</span>&nbsp;<span class="builtintype" id="4876317">uint8</span><span class="op" id="4876322">,</span>&nbsp;<span class="builtintype" id="4876324">uint8</span><span class="op" id="4876329">)</span>&nbsp;<span class="op" id="4876331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4876334">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4876367">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4876408">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4876455">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4876502">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876569">r1</span>&nbsp;<span class="op" id="4876572">:=</span>&nbsp;<span class="builtintype" id="4876575">int</span><span class="op" id="4876578">(</span><span class="ident" id="4876579">r</span><span class="op" id="4876580">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876583">g1</span>&nbsp;<span class="op" id="4876586">:=</span>&nbsp;<span class="builtintype" id="4876589">int</span><span class="op" id="4876592">(</span><span class="ident" id="4876593">g</span><span class="op" id="4876594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876597">b1</span>&nbsp;<span class="op" id="4876600">:=</span>&nbsp;<span class="builtintype" id="4876603">int</span><span class="op" id="4876606">(</span><span class="ident" id="4876607">b</span><span class="op" id="4876608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876611">yy</span>&nbsp;<span class="op" id="4876614">:=</span>&nbsp;<span class="op" id="4876617">(</span><span class="num" id="4876618">19595</span><span class="op" id="4876623">*</span><span class="ident" id="4876624">r1</span>&nbsp;<span class="op" id="4876627">+</span>&nbsp;<span class="num" id="4876629">38470</span><span class="op" id="4876634">*</span><span class="ident" id="4876635">g1</span>&nbsp;<span class="op" id="4876638">+</span>&nbsp;<span class="num" id="4876640">7471</span><span class="op" id="4876644">*</span><span class="ident" id="4876645">b1</span>&nbsp;<span class="op" id="4876648">+</span>&nbsp;<span class="num" id="4876650">1</span><span class="op" id="4876651">&lt;&lt;</span><span class="num" id="4876653">15</span><span class="op" id="4876655">)</span>&nbsp;<span class="op" id="4876657">&gt;&gt;</span>&nbsp;<span class="num" id="4876660">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876664">cb</span>&nbsp;<span class="op" id="4876667">:=</span>&nbsp;<span class="op" id="4876670">(</span><span class="op" id="4876671">-</span><span class="num" id="4876672">11056</span><span class="op" id="4876677">*</span><span class="ident" id="4876678">r1</span>&nbsp;<span class="op" id="4876681">-</span>&nbsp;<span class="num" id="4876683">21712</span><span class="op" id="4876688">*</span><span class="ident" id="4876689">g1</span>&nbsp;<span class="op" id="4876692">+</span>&nbsp;<span class="num" id="4876694">32768</span><span class="op" id="4876699">*</span><span class="ident" id="4876700">b1</span>&nbsp;<span class="op" id="4876703">+</span>&nbsp;<span class="num" id="4876705">257</span><span class="op" id="4876708">&lt;&lt;</span><span class="num" id="4876710">15</span><span class="op" id="4876712">)</span>&nbsp;<span class="op" id="4876714">&gt;&gt;</span>&nbsp;<span class="num" id="4876717">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876721">cr</span>&nbsp;<span class="op" id="4876724">:=</span>&nbsp;<span class="op" id="4876727">(</span><span class="num" id="4876728">32768</span><span class="op" id="4876733">*</span><span class="ident" id="4876734">r1</span>&nbsp;<span class="op" id="4876737">-</span>&nbsp;<span class="num" id="4876739">27440</span><span class="op" id="4876744">*</span><span class="ident" id="4876745">g1</span>&nbsp;<span class="op" id="4876748">-</span>&nbsp;<span class="num" id="4876750">5328</span><span class="op" id="4876754">*</span><span class="ident" id="4876755">b1</span>&nbsp;<span class="op" id="4876758">+</span>&nbsp;<span class="num" id="4876760">257</span><span class="op" id="4876763">&lt;&lt;</span><span class="num" id="4876765">15</span><span class="op" id="4876767">)</span>&nbsp;<span class="op" id="4876769">&gt;&gt;</span>&nbsp;<span class="num" id="4876772">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876776">if</span>&nbsp;<span class="ident" id="4876779">yy</span>&nbsp;<span class="op" id="4876782">&lt;</span>&nbsp;<span class="num" id="4876784">0</span>&nbsp;<span class="op" id="4876786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876790">yy</span>&nbsp;<span class="op" id="4876793">=</span>&nbsp;<span class="num" id="4876795">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876798">}</span>&nbsp;<span class="keyword" id="4876800">else</span>&nbsp;<span class="keyword" id="4876805">if</span>&nbsp;<span class="ident" id="4876808">yy</span>&nbsp;<span class="op" id="4876811">&gt;</span>&nbsp;<span class="num" id="4876813">255</span>&nbsp;<span class="op" id="4876817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876821">yy</span>&nbsp;<span class="op" id="4876824">=</span>&nbsp;<span class="num" id="4876826">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876831">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876834">if</span>&nbsp;<span class="ident" id="4876837">cb</span>&nbsp;<span class="op" id="4876840">&lt;</span>&nbsp;<span class="num" id="4876842">0</span>&nbsp;<span class="op" id="4876844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876848">cb</span>&nbsp;<span class="op" id="4876851">=</span>&nbsp;<span class="num" id="4876853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876856">}</span>&nbsp;<span class="keyword" id="4876858">else</span>&nbsp;<span class="keyword" id="4876863">if</span>&nbsp;<span class="ident" id="4876866">cb</span>&nbsp;<span class="op" id="4876869">&gt;</span>&nbsp;<span class="num" id="4876871">255</span>&nbsp;<span class="op" id="4876875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876879">cb</span>&nbsp;<span class="op" id="4876882">=</span>&nbsp;<span class="num" id="4876884">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876889">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876892">if</span>&nbsp;<span class="ident" id="4876895">cr</span>&nbsp;<span class="op" id="4876898">&lt;</span>&nbsp;<span class="num" id="4876900">0</span>&nbsp;<span class="op" id="4876902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876906">cr</span>&nbsp;<span class="op" id="4876909">=</span>&nbsp;<span class="num" id="4876911">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876914">}</span>&nbsp;<span class="keyword" id="4876916">else</span>&nbsp;<span class="keyword" id="4876921">if</span>&nbsp;<span class="ident" id="4876924">cr</span>&nbsp;<span class="op" id="4876927">&gt;</span>&nbsp;<span class="num" id="4876929">255</span>&nbsp;<span class="op" id="4876933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876937">cr</span>&nbsp;<span class="op" id="4876940">=</span>&nbsp;<span class="num" id="4876942">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876947">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876950">return</span>&nbsp;<span class="builtintype" id="4876957">uint8</span><span class="op" id="4876962">(</span><span class="ident" id="4876963">yy</span><span class="op" id="4876965">)</span><span class="op" id="4876966">,</span>&nbsp;<span class="builtintype" id="4876968">uint8</span><span class="op" id="4876973">(</span><span class="ident" id="4876974">cb</span><span class="op" id="4876976">)</span><span class="op" id="4876977">,</span>&nbsp;<span class="builtintype" id="4876979">uint8</span><span class="op" id="4876984">(</span><span class="ident" id="4876985">cr</span><span class="op" id="4876987">)</span><br>
<span class="lineno"></span><span class="op" id="4876989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4876992">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="4877049">func</span>&nbsp;<span class="ident" id="4877054">YCbCrToRGB</span><span class="op" id="4877064">(</span><span class="ident" id="4877065">y</span><span class="op" id="4877066">,</span>&nbsp;<span class="ident" id="4877068">cb</span><span class="op" id="4877070">,</span>&nbsp;<span class="ident" id="4877072">cr</span>&nbsp;<span class="builtintype" id="4877075">uint8</span><span class="op" id="4877080">)</span>&nbsp;<span class="op" id="4877082">(</span><span class="builtintype" id="4877083">uint8</span><span class="op" id="4877088">,</span>&nbsp;<span class="builtintype" id="4877090">uint8</span><span class="op" id="4877095">,</span>&nbsp;<span class="builtintype" id="4877097">uint8</span><span class="op" id="4877102">)</span>&nbsp;<span class="op" id="4877104">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4877107">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4877140">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4877170">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4877219">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4877249">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877316">yy1</span>&nbsp;<span class="op" id="4877320">:=</span>&nbsp;<span class="builtintype" id="4877323">int</span><span class="op" id="4877326">(</span><span class="ident" id="4877327">y</span><span class="op" id="4877328">)</span><span class="op" id="4877329">&lt;&lt;</span><span class="num" id="4877331">16</span>&nbsp;<span class="op" id="4877334">+</span>&nbsp;<span class="num" id="4877336">1</span><span class="op" id="4877337">&lt;&lt;</span><span class="num" id="4877339">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877343">cb1</span>&nbsp;<span class="op" id="4877347">:=</span>&nbsp;<span class="builtintype" id="4877350">int</span><span class="op" id="4877353">(</span><span class="ident" id="4877354">cb</span><span class="op" id="4877356">)</span>&nbsp;<span class="op" id="4877358">-</span>&nbsp;<span class="num" id="4877360">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877365">cr1</span>&nbsp;<span class="op" id="4877369">:=</span>&nbsp;<span class="builtintype" id="4877372">int</span><span class="op" id="4877375">(</span><span class="ident" id="4877376">cr</span><span class="op" id="4877378">)</span>&nbsp;<span class="op" id="4877380">-</span>&nbsp;<span class="num" id="4877382">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877387">r</span>&nbsp;<span class="op" id="4877389">:=</span>&nbsp;<span class="op" id="4877392">(</span><span class="ident" id="4877393">yy1</span>&nbsp;<span class="op" id="4877397">+</span>&nbsp;<span class="num" id="4877399">91881</span><span class="op" id="4877404">*</span><span class="ident" id="4877405">cr1</span><span class="op" id="4877408">)</span>&nbsp;<span class="op" id="4877410">&gt;&gt;</span>&nbsp;<span class="num" id="4877413">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877417">g</span>&nbsp;<span class="op" id="4877419">:=</span>&nbsp;<span class="op" id="4877422">(</span><span class="ident" id="4877423">yy1</span>&nbsp;<span class="op" id="4877427">-</span>&nbsp;<span class="num" id="4877429">22554</span><span class="op" id="4877434">*</span><span class="ident" id="4877435">cb1</span>&nbsp;<span class="op" id="4877439">-</span>&nbsp;<span class="num" id="4877441">46802</span><span class="op" id="4877446">*</span><span class="ident" id="4877447">cr1</span><span class="op" id="4877450">)</span>&nbsp;<span class="op" id="4877452">&gt;&gt;</span>&nbsp;<span class="num" id="4877455">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877459">b</span>&nbsp;<span class="op" id="4877461">:=</span>&nbsp;<span class="op" id="4877464">(</span><span class="ident" id="4877465">yy1</span>&nbsp;<span class="op" id="4877469">+</span>&nbsp;<span class="num" id="4877471">116130</span><span class="op" id="4877477">*</span><span class="ident" id="4877478">cb1</span><span class="op" id="4877481">)</span>&nbsp;<span class="op" id="4877483">&gt;&gt;</span>&nbsp;<span class="num" id="4877486">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877490">if</span>&nbsp;<span class="ident" id="4877493">r</span>&nbsp;<span class="op" id="4877495">&lt;</span>&nbsp;<span class="num" id="4877497">0</span>&nbsp;<span class="op" id="4877499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877503">r</span>&nbsp;<span class="op" id="4877505">=</span>&nbsp;<span class="num" id="4877507">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877510">}</span>&nbsp;<span class="keyword" id="4877512">else</span>&nbsp;<span class="keyword" id="4877517">if</span>&nbsp;<span class="ident" id="4877520">r</span>&nbsp;<span class="op" id="4877522">&gt;</span>&nbsp;<span class="num" id="4877524">255</span>&nbsp;<span class="op" id="4877528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877532">r</span>&nbsp;<span class="op" id="4877534">=</span>&nbsp;<span class="num" id="4877536">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877544">if</span>&nbsp;<span class="ident" id="4877547">g</span>&nbsp;<span class="op" id="4877549">&lt;</span>&nbsp;<span class="num" id="4877551">0</span>&nbsp;<span class="op" id="4877553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877557">g</span>&nbsp;<span class="op" id="4877559">=</span>&nbsp;<span class="num" id="4877561">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877564">}</span>&nbsp;<span class="keyword" id="4877566">else</span>&nbsp;<span class="keyword" id="4877571">if</span>&nbsp;<span class="ident" id="4877574">g</span>&nbsp;<span class="op" id="4877576">&gt;</span>&nbsp;<span class="num" id="4877578">255</span>&nbsp;<span class="op" id="4877582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877586">g</span>&nbsp;<span class="op" id="4877588">=</span>&nbsp;<span class="num" id="4877590">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877598">if</span>&nbsp;<span class="ident" id="4877601">b</span>&nbsp;<span class="op" id="4877603">&lt;</span>&nbsp;<span class="num" id="4877605">0</span>&nbsp;<span class="op" id="4877607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877611">b</span>&nbsp;<span class="op" id="4877613">=</span>&nbsp;<span class="num" id="4877615">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877618">}</span>&nbsp;<span class="keyword" id="4877620">else</span>&nbsp;<span class="keyword" id="4877625">if</span>&nbsp;<span class="ident" id="4877628">b</span>&nbsp;<span class="op" id="4877630">&gt;</span>&nbsp;<span class="num" id="4877632">255</span>&nbsp;<span class="op" id="4877636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877640">b</span>&nbsp;<span class="op" id="4877642">=</span>&nbsp;<span class="num" id="4877644">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877652">return</span>&nbsp;<span class="builtintype" id="4877659">uint8</span><span class="op" id="4877664">(</span><span class="ident" id="4877665">r</span><span class="op" id="4877666">)</span><span class="op" id="4877667">,</span>&nbsp;<span class="builtintype" id="4877669">uint8</span><span class="op" id="4877674">(</span><span class="ident" id="4877675">g</span><span class="op" id="4877676">)</span><span class="op" id="4877677">,</span>&nbsp;<span class="builtintype" id="4877679">uint8</span><span class="op" id="4877684">(</span><span class="ident" id="4877685">b</span><span class="op" id="4877686">)</span><br>
<span class="lineno"></span><span class="op" id="4877688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4877691">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="4877770">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="4877809">//</span><br>
<span class="lineno"></span><span class="comment" id="4877812">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="4877886">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4877961">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="4878039">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="4878092">//</span><br>
<span class="lineno"></span><span class="comment" id="4878095">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="4878174">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="4878249">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="4878321">type</span>&nbsp;<span class="ident" id="4878326">YCbCr</span>&nbsp;<span class="keyword" id="4878332">struct</span>&nbsp;<span class="op" id="4878339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878342">Y</span><span class="op" id="4878343">,</span>&nbsp;<span class="ident" id="4878345">Cb</span><span class="op" id="4878347">,</span>&nbsp;<span class="ident" id="4878349">Cr</span>&nbsp;<span class="builtintype" id="4878352">uint8</span><br>
<span class="lineno"></span><span class="op" id="4878358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4878361">func</span>&nbsp;<span class="op" id="4878366">(</span><span class="ident" id="4878367">c</span>&nbsp;<span class="ident" id="4878369">YCbCr</span><span class="op" id="4878374">)</span>&nbsp;<span class="ident" id="4878376">RGBA</span><span class="op" id="4878380">(</span><span class="op" id="4878381">)</span>&nbsp;<span class="op" id="4878383">(</span><span class="builtintype" id="4878384">uint32</span><span class="op" id="4878390">,</span>&nbsp;<span class="builtintype" id="4878392">uint32</span><span class="op" id="4878398">,</span>&nbsp;<span class="builtintype" id="4878400">uint32</span><span class="op" id="4878406">,</span>&nbsp;<span class="builtintype" id="4878408">uint32</span><span class="op" id="4878414">)</span>&nbsp;<span class="op" id="4878416">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878419">r</span><span class="op" id="4878420">,</span>&nbsp;<span class="ident" id="4878422">g</span><span class="op" id="4878423">,</span>&nbsp;<span class="ident" id="4878425">b</span>&nbsp;<span class="op" id="4878427">:=</span>&nbsp;<span class="ident" id="4878430">YCbCrToRGB</span><span class="op" id="4878440">(</span><span class="ident" id="4878441">c</span><span class="op" id="4878442">.</span><span class="ident" id="4878443">Y</span><span class="op" id="4878444">,</span>&nbsp;<span class="ident" id="4878446">c</span><span class="op" id="4878447">.</span><span class="ident" id="4878448">Cb</span><span class="op" id="4878450">,</span>&nbsp;<span class="ident" id="4878452">c</span><span class="op" id="4878453">.</span><span class="ident" id="4878454">Cr</span><span class="op" id="4878456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878459">return</span>&nbsp;<span class="builtintype" id="4878466">uint32</span><span class="op" id="4878472">(</span><span class="ident" id="4878473">r</span><span class="op" id="4878474">)</span>&nbsp;<span class="op" id="4878476">*</span>&nbsp;<span class="num" id="4878478">0x101</span><span class="op" id="4878483">,</span>&nbsp;<span class="builtintype" id="4878485">uint32</span><span class="op" id="4878491">(</span><span class="ident" id="4878492">g</span><span class="op" id="4878493">)</span>&nbsp;<span class="op" id="4878495">*</span>&nbsp;<span class="num" id="4878497">0x101</span><span class="op" id="4878502">,</span>&nbsp;<span class="builtintype" id="4878504">uint32</span><span class="op" id="4878510">(</span><span class="ident" id="4878511">b</span><span class="op" id="4878512">)</span>&nbsp;<span class="op" id="4878514">*</span>&nbsp;<span class="num" id="4878516">0x101</span><span class="op" id="4878521">,</span>&nbsp;<span class="num" id="4878523">0xffff</span><br>
<span class="lineno"></span><span class="op" id="4878530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4878533">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="4878579">var</span>&nbsp;<span class="ident" id="4878583">YCbCrModel</span>&nbsp;<span class="ident" id="4878594">Model</span>&nbsp;<span class="op" id="4878600">=</span>&nbsp;<span class="ident" id="4878602">ModelFunc</span><span class="op" id="4878611">(</span><span class="ident" id="4878612">yCbCrModel</span><span class="op" id="4878622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4878625">func</span>&nbsp;<span class="ident" id="4878630">yCbCrModel</span><span class="op" id="4878640">(</span><span class="ident" id="4878641">c</span>&nbsp;<span class="ident" id="4878643">Color</span><span class="op" id="4878648">)</span>&nbsp;<span class="ident" id="4878650">Color</span>&nbsp;<span class="op" id="4878656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878659">if</span>&nbsp;<span class="ident" id="4878662">_</span><span class="op" id="4878663">,</span>&nbsp;<span class="ident" id="4878665">ok</span>&nbsp;<span class="op" id="4878668">:=</span>&nbsp;<span class="ident" id="4878671">c</span><span class="op" id="4878672">.</span><span class="op" id="4878673">(</span><span class="ident" id="4878674">YCbCr</span><span class="op" id="4878679">)</span><span class="op" id="4878680">;</span>&nbsp;<span class="ident" id="4878682">ok</span>&nbsp;<span class="op" id="4878685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878689">return</span>&nbsp;<span class="ident" id="4878696">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878702">r</span><span class="op" id="4878703">,</span>&nbsp;<span class="ident" id="4878705">g</span><span class="op" id="4878706">,</span>&nbsp;<span class="ident" id="4878708">b</span><span class="op" id="4878709">,</span>&nbsp;<span class="ident" id="4878711">_</span>&nbsp;<span class="op" id="4878713">:=</span>&nbsp;<span class="ident" id="4878716">c</span><span class="op" id="4878717">.</span><span class="ident" id="4878718">RGBA</span><span class="op" id="4878722">(</span><span class="op" id="4878723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878726">y</span><span class="op" id="4878727">,</span>&nbsp;<span class="ident" id="4878729">u</span><span class="op" id="4878730">,</span>&nbsp;<span class="ident" id="4878732">v</span>&nbsp;<span class="op" id="4878734">:=</span>&nbsp;<span class="ident" id="4878737">RGBToYCbCr</span><span class="op" id="4878747">(</span><span class="builtintype" id="4878748">uint8</span><span class="op" id="4878753">(</span><span class="ident" id="4878754">r</span><span class="op" id="4878755">&gt;&gt;</span><span class="num" id="4878757">8</span><span class="op" id="4878758">)</span><span class="op" id="4878759">,</span>&nbsp;<span class="builtintype" id="4878761">uint8</span><span class="op" id="4878766">(</span><span class="ident" id="4878767">g</span><span class="op" id="4878768">&gt;&gt;</span><span class="num" id="4878770">8</span><span class="op" id="4878771">)</span><span class="op" id="4878772">,</span>&nbsp;<span class="builtintype" id="4878774">uint8</span><span class="op" id="4878779">(</span><span class="ident" id="4878780">b</span><span class="op" id="4878781">&gt;&gt;</span><span class="num" id="4878783">8</span><span class="op" id="4878784">)</span><span class="op" id="4878785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878788">return</span>&nbsp;<span class="ident" id="4878795">YCbCr</span><span class="op" id="4878800">{</span><span class="ident" id="4878801">y</span><span class="op" id="4878802">,</span>&nbsp;<span class="ident" id="4878804">u</span><span class="op" id="4878805">,</span>&nbsp;<span class="ident" id="4878807">v</span><span class="op" id="4878808">}</span><br>
<span class="lineno"></span><span class="op" id="4878810">}</span>
</div>
</body>
</html>
