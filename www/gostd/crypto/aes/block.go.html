<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4323327">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4323382">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4323436">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4323487">//&nbsp;This&nbsp;Go&nbsp;implementation&nbsp;is&nbsp;derived&nbsp;in&nbsp;part&nbsp;from&nbsp;the&nbsp;reference</span><br>
<span class="lineno"></span><span class="comment" id="4323551">//&nbsp;ANSI&nbsp;C&nbsp;implementation,&nbsp;which&nbsp;carries&nbsp;the&nbsp;following&nbsp;notice:</span><br>
<span class="lineno"></span><span class="comment" id="4323613">//</span><br>
<span class="lineno"></span><span class="comment" id="4323616">//&nbsp;&nbsp;&nbsp;&nbsprijndael-alg-fst.c</span><br>
<span class="lineno"></span><span class="comment" id="4323638">//</span><br>
<span class="lineno">10</span><span class="comment" id="4323641">//&nbsp;&nbsp;&nbsp;&nbsp@version&nbsp;3.0&nbsp;(December&nbsp;2000)</span><br>
<span class="lineno"></span><span class="comment" id="4323673">//</span><br>
<span class="lineno"></span><span class="comment" id="4323676">//&nbsp;&nbsp;&nbsp;&nbspOptimised&nbsp;ANSI&nbsp;C&nbsp;code&nbsp;for&nbsp;the&nbsp;Rijndael&nbsp;cipher&nbsp;(now&nbsp;AES)</span><br>
<span class="lineno"></span><span class="comment" id="4323735">//</span><br>
<span class="lineno"></span><span class="comment" id="4323738">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Vincent&nbsp;Rijmen&nbsp;&lt;vincent.rijmen@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno">15</span><span class="comment" id="4323801">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Antoon&nbsp;Bosselaers&nbsp;&lt;antoon.bosselaers@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4323870">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Paulo&nbsp;Barreto&nbsp;&lt;paulo.barreto@terra.com.br&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4323924">//</span><br>
<span class="lineno"></span><span class="comment" id="4323927">//&nbsp;&nbsp;&nbsp;&nbspThis&nbsp;code&nbsp;is&nbsp;hereby&nbsp;placed&nbsp;in&nbsp;the&nbsp;public&nbsp;domain.</span><br>
<span class="lineno"></span><span class="comment" id="4323979">//</span><br>
<span class="lineno">20</span><span class="comment" id="4323982">//&nbsp;&nbsp;&nbsp;&nbspTHIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHORS&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS</span><br>
<span class="lineno"></span><span class="comment" id="4324052">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED</span><br>
<span class="lineno"></span><span class="comment" id="4324121">//&nbsp;&nbsp;&nbsp;&nbspWARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE</span><br>
<span class="lineno"></span><span class="comment" id="4324191">//&nbsp;&nbsp;&nbsp;&nbspARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHORS&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE</span><br>
<span class="lineno"></span><span class="comment" id="4324260">//&nbsp;&nbsp;&nbsp;&nbspLIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR</span><br>
<span class="lineno">25</span><span class="comment" id="4324331">//&nbsp;&nbsp;&nbsp;&nbspCONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF</span><br>
<span class="lineno"></span><span class="comment" id="4324403">//&nbsp;&nbsp;&nbsp;&nbspSUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR</span><br>
<span class="lineno"></span><span class="comment" id="4324470">//&nbsp;&nbsp;&nbsp;&nbspBUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,</span><br>
<span class="lineno"></span><span class="comment" id="4324543">//&nbsp;&nbsp;&nbsp;&nbspWHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE</span><br>
<span class="lineno"></span><span class="comment" id="4324615">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,</span><br>
<span class="lineno">30</span><span class="comment" id="4324684">//&nbsp;&nbsp;&nbsp;&nbspEVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.</span><br>
<span class="lineno"></span><span class="comment" id="4324738">//</span><br>
<span class="lineno"></span><span class="comment" id="4324741">//&nbsp;See&nbsp;FIPS&nbsp;197&nbsp;for&nbsp;specification,&nbsp;and&nbsp;see&nbsp;Daemen&nbsp;and&nbsp;Rijmen&#39;s&nbsp;Rijndael&nbsp;submission</span><br>
<span class="lineno"></span><span class="comment" id="4324824">//&nbsp;for&nbsp;implementation&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="4324855">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno">35</span><span class="comment" id="4324922">//&nbsp;&nbsp;&nbsp;&nbsphttp://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4324990">package</span>&nbsp;<span class="ident" id="4324998">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4325003">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">40</span><span class="keyword" id="4325070">func</span>&nbsp;<span class="ident" id="4325075">encryptBlockGo</span><span class="op" id="4325089">(</span><span class="ident" id="4325090">xk</span>&nbsp;<span class="op" id="4325093">[</span><span class="op" id="4325094">]</span><span class="builtintype" id="4325095">uint32</span><span class="op" id="4325101">,</span>&nbsp;<span class="ident" id="4325103">dst</span><span class="op" id="4325106">,</span>&nbsp;<span class="ident" id="4325108">src</span>&nbsp;<span class="op" id="4325112">[</span><span class="op" id="4325113">]</span><span class="builtintype" id="4325114">byte</span><span class="op" id="4325118">)</span>&nbsp;<span class="op" id="4325120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325123">var</span>&nbsp;<span class="ident" id="4325127">s0</span><span class="op" id="4325129">,</span>&nbsp;<span class="ident" id="4325131">s1</span><span class="op" id="4325133">,</span>&nbsp;<span class="ident" id="4325135">s2</span><span class="op" id="4325137">,</span>&nbsp;<span class="ident" id="4325139">s3</span><span class="op" id="4325141">,</span>&nbsp;<span class="ident" id="4325143">t0</span><span class="op" id="4325145">,</span>&nbsp;<span class="ident" id="4325147">t1</span><span class="op" id="4325149">,</span>&nbsp;<span class="ident" id="4325151">t2</span><span class="op" id="4325153">,</span>&nbsp;<span class="ident" id="4325155">t3</span>&nbsp;<span class="builtintype" id="4325158">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325167">s0</span>&nbsp;<span class="op" id="4325170">=</span>&nbsp;<span class="builtintype" id="4325172">uint32</span><span class="op" id="4325178">(</span><span class="ident" id="4325179">src</span><span class="op" id="4325182">[</span><span class="num" id="4325183">0</span><span class="op" id="4325184">]</span><span class="op" id="4325185">)</span><span class="op" id="4325186">&lt;&lt;</span><span class="num" id="4325188">24</span>&nbsp;<span class="op" id="4325191">|</span>&nbsp;<span class="builtintype" id="4325193">uint32</span><span class="op" id="4325199">(</span><span class="ident" id="4325200">src</span><span class="op" id="4325203">[</span><span class="num" id="4325204">1</span><span class="op" id="4325205">]</span><span class="op" id="4325206">)</span><span class="op" id="4325207">&lt;&lt;</span><span class="num" id="4325209">16</span>&nbsp;<span class="op" id="4325212">|</span>&nbsp;<span class="builtintype" id="4325214">uint32</span><span class="op" id="4325220">(</span><span class="ident" id="4325221">src</span><span class="op" id="4325224">[</span><span class="num" id="4325225">2</span><span class="op" id="4325226">]</span><span class="op" id="4325227">)</span><span class="op" id="4325228">&lt;&lt;</span><span class="num" id="4325230">8</span>&nbsp;<span class="op" id="4325232">|</span>&nbsp;<span class="builtintype" id="4325234">uint32</span><span class="op" id="4325240">(</span><span class="ident" id="4325241">src</span><span class="op" id="4325244">[</span><span class="num" id="4325245">3</span><span class="op" id="4325246">]</span><span class="op" id="4325247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325250">s1</span>&nbsp;<span class="op" id="4325253">=</span>&nbsp;<span class="builtintype" id="4325255">uint32</span><span class="op" id="4325261">(</span><span class="ident" id="4325262">src</span><span class="op" id="4325265">[</span><span class="num" id="4325266">4</span><span class="op" id="4325267">]</span><span class="op" id="4325268">)</span><span class="op" id="4325269">&lt;&lt;</span><span class="num" id="4325271">24</span>&nbsp;<span class="op" id="4325274">|</span>&nbsp;<span class="builtintype" id="4325276">uint32</span><span class="op" id="4325282">(</span><span class="ident" id="4325283">src</span><span class="op" id="4325286">[</span><span class="num" id="4325287">5</span><span class="op" id="4325288">]</span><span class="op" id="4325289">)</span><span class="op" id="4325290">&lt;&lt;</span><span class="num" id="4325292">16</span>&nbsp;<span class="op" id="4325295">|</span>&nbsp;<span class="builtintype" id="4325297">uint32</span><span class="op" id="4325303">(</span><span class="ident" id="4325304">src</span><span class="op" id="4325307">[</span><span class="num" id="4325308">6</span><span class="op" id="4325309">]</span><span class="op" id="4325310">)</span><span class="op" id="4325311">&lt;&lt;</span><span class="num" id="4325313">8</span>&nbsp;<span class="op" id="4325315">|</span>&nbsp;<span class="builtintype" id="4325317">uint32</span><span class="op" id="4325323">(</span><span class="ident" id="4325324">src</span><span class="op" id="4325327">[</span><span class="num" id="4325328">7</span><span class="op" id="4325329">]</span><span class="op" id="4325330">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325333">s2</span>&nbsp;<span class="op" id="4325336">=</span>&nbsp;<span class="builtintype" id="4325338">uint32</span><span class="op" id="4325344">(</span><span class="ident" id="4325345">src</span><span class="op" id="4325348">[</span><span class="num" id="4325349">8</span><span class="op" id="4325350">]</span><span class="op" id="4325351">)</span><span class="op" id="4325352">&lt;&lt;</span><span class="num" id="4325354">24</span>&nbsp;<span class="op" id="4325357">|</span>&nbsp;<span class="builtintype" id="4325359">uint32</span><span class="op" id="4325365">(</span><span class="ident" id="4325366">src</span><span class="op" id="4325369">[</span><span class="num" id="4325370">9</span><span class="op" id="4325371">]</span><span class="op" id="4325372">)</span><span class="op" id="4325373">&lt;&lt;</span><span class="num" id="4325375">16</span>&nbsp;<span class="op" id="4325378">|</span>&nbsp;<span class="builtintype" id="4325380">uint32</span><span class="op" id="4325386">(</span><span class="ident" id="4325387">src</span><span class="op" id="4325390">[</span><span class="num" id="4325391">10</span><span class="op" id="4325393">]</span><span class="op" id="4325394">)</span><span class="op" id="4325395">&lt;&lt;</span><span class="num" id="4325397">8</span>&nbsp;<span class="op" id="4325399">|</span>&nbsp;<span class="builtintype" id="4325401">uint32</span><span class="op" id="4325407">(</span><span class="ident" id="4325408">src</span><span class="op" id="4325411">[</span><span class="num" id="4325412">11</span><span class="op" id="4325414">]</span><span class="op" id="4325415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325418">s3</span>&nbsp;<span class="op" id="4325421">=</span>&nbsp;<span class="builtintype" id="4325423">uint32</span><span class="op" id="4325429">(</span><span class="ident" id="4325430">src</span><span class="op" id="4325433">[</span><span class="num" id="4325434">12</span><span class="op" id="4325436">]</span><span class="op" id="4325437">)</span><span class="op" id="4325438">&lt;&lt;</span><span class="num" id="4325440">24</span>&nbsp;<span class="op" id="4325443">|</span>&nbsp;<span class="builtintype" id="4325445">uint32</span><span class="op" id="4325451">(</span><span class="ident" id="4325452">src</span><span class="op" id="4325455">[</span><span class="num" id="4325456">13</span><span class="op" id="4325458">]</span><span class="op" id="4325459">)</span><span class="op" id="4325460">&lt;&lt;</span><span class="num" id="4325462">16</span>&nbsp;<span class="op" id="4325465">|</span>&nbsp;<span class="builtintype" id="4325467">uint32</span><span class="op" id="4325473">(</span><span class="ident" id="4325474">src</span><span class="op" id="4325477">[</span><span class="num" id="4325478">14</span><span class="op" id="4325480">]</span><span class="op" id="4325481">)</span><span class="op" id="4325482">&lt;&lt;</span><span class="num" id="4325484">8</span>&nbsp;<span class="op" id="4325486">|</span>&nbsp;<span class="builtintype" id="4325488">uint32</span><span class="op" id="4325494">(</span><span class="ident" id="4325495">src</span><span class="op" id="4325498">[</span><span class="num" id="4325499">15</span><span class="op" id="4325501">]</span><span class="op" id="4325502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4325506">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325548">s0</span>&nbsp;<span class="op" id="4325551">^=</span>&nbsp;<span class="ident" id="4325554">xk</span><span class="op" id="4325556">[</span><span class="num" id="4325557">0</span><span class="op" id="4325558">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325561">s1</span>&nbsp;<span class="op" id="4325564">^=</span>&nbsp;<span class="ident" id="4325567">xk</span><span class="op" id="4325569">[</span><span class="num" id="4325570">1</span><span class="op" id="4325571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325574">s2</span>&nbsp;<span class="op" id="4325577">^=</span>&nbsp;<span class="ident" id="4325580">xk</span><span class="op" id="4325582">[</span><span class="num" id="4325583">2</span><span class="op" id="4325584">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325587">s3</span>&nbsp;<span class="op" id="4325590">^=</span>&nbsp;<span class="ident" id="4325593">xk</span><span class="op" id="4325595">[</span><span class="num" id="4325596">3</span><span class="op" id="4325597">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4325601">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4325641">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325696">nr</span>&nbsp;<span class="op" id="4325699">:=</span>&nbsp;<span class="builtinfunc" id="4325702">len</span><span class="op" id="4325705">(</span><span class="ident" id="4325706">xk</span><span class="op" id="4325708">)</span><span class="op" id="4325709">/</span><span class="num" id="4325710">4</span>&nbsp;<span class="op" id="4325712">-</span>&nbsp;<span class="num" id="4325714">2</span>&nbsp;<span class="comment" id="4325716">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325751">k</span>&nbsp;<span class="op" id="4325753">:=</span>&nbsp;<span class="num" id="4325756">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325759">for</span>&nbsp;<span class="ident" id="4325763">r</span>&nbsp;<span class="op" id="4325765">:=</span>&nbsp;<span class="num" id="4325768">0</span><span class="op" id="4325769">;</span>&nbsp;<span class="ident" id="4325771">r</span>&nbsp;<span class="op" id="4325773">&lt;</span>&nbsp;<span class="ident" id="4325775">nr</span><span class="op" id="4325777">;</span>&nbsp;<span class="ident" id="4325779">r</span><span class="op" id="4325780">++</span>&nbsp;<span class="op" id="4325783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325787">t0</span>&nbsp;<span class="op" id="4325790">=</span>&nbsp;<span class="ident" id="4325792">xk</span><span class="op" id="4325794">[</span><span class="ident" id="4325795">k</span><span class="op" id="4325796">+</span><span class="num" id="4325797">0</span><span class="op" id="4325798">]</span>&nbsp;<span class="op" id="4325800">^</span>&nbsp;<span class="ident" id="4325802">te0</span><span class="op" id="4325805">[</span><span class="builtintype" id="4325806">uint8</span><span class="op" id="4325811">(</span><span class="ident" id="4325812">s0</span><span class="op" id="4325814">&gt;&gt;</span><span class="num" id="4325816">24</span><span class="op" id="4325818">)</span><span class="op" id="4325819">]</span>&nbsp;<span class="op" id="4325821">^</span>&nbsp;<span class="ident" id="4325823">te1</span><span class="op" id="4325826">[</span><span class="builtintype" id="4325827">uint8</span><span class="op" id="4325832">(</span><span class="ident" id="4325833">s1</span><span class="op" id="4325835">&gt;&gt;</span><span class="num" id="4325837">16</span><span class="op" id="4325839">)</span><span class="op" id="4325840">]</span>&nbsp;<span class="op" id="4325842">^</span>&nbsp;<span class="ident" id="4325844">te2</span><span class="op" id="4325847">[</span><span class="builtintype" id="4325848">uint8</span><span class="op" id="4325853">(</span><span class="ident" id="4325854">s2</span><span class="op" id="4325856">&gt;&gt;</span><span class="num" id="4325858">8</span><span class="op" id="4325859">)</span><span class="op" id="4325860">]</span>&nbsp;<span class="op" id="4325862">^</span>&nbsp;<span class="ident" id="4325864">te3</span><span class="op" id="4325867">[</span><span class="builtintype" id="4325868">uint8</span><span class="op" id="4325873">(</span><span class="ident" id="4325874">s3</span><span class="op" id="4325876">)</span><span class="op" id="4325877">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325881">t1</span>&nbsp;<span class="op" id="4325884">=</span>&nbsp;<span class="ident" id="4325886">xk</span><span class="op" id="4325888">[</span><span class="ident" id="4325889">k</span><span class="op" id="4325890">+</span><span class="num" id="4325891">1</span><span class="op" id="4325892">]</span>&nbsp;<span class="op" id="4325894">^</span>&nbsp;<span class="ident" id="4325896">te0</span><span class="op" id="4325899">[</span><span class="builtintype" id="4325900">uint8</span><span class="op" id="4325905">(</span><span class="ident" id="4325906">s1</span><span class="op" id="4325908">&gt;&gt;</span><span class="num" id="4325910">24</span><span class="op" id="4325912">)</span><span class="op" id="4325913">]</span>&nbsp;<span class="op" id="4325915">^</span>&nbsp;<span class="ident" id="4325917">te1</span><span class="op" id="4325920">[</span><span class="builtintype" id="4325921">uint8</span><span class="op" id="4325926">(</span><span class="ident" id="4325927">s2</span><span class="op" id="4325929">&gt;&gt;</span><span class="num" id="4325931">16</span><span class="op" id="4325933">)</span><span class="op" id="4325934">]</span>&nbsp;<span class="op" id="4325936">^</span>&nbsp;<span class="ident" id="4325938">te2</span><span class="op" id="4325941">[</span><span class="builtintype" id="4325942">uint8</span><span class="op" id="4325947">(</span><span class="ident" id="4325948">s3</span><span class="op" id="4325950">&gt;&gt;</span><span class="num" id="4325952">8</span><span class="op" id="4325953">)</span><span class="op" id="4325954">]</span>&nbsp;<span class="op" id="4325956">^</span>&nbsp;<span class="ident" id="4325958">te3</span><span class="op" id="4325961">[</span><span class="builtintype" id="4325962">uint8</span><span class="op" id="4325967">(</span><span class="ident" id="4325968">s0</span><span class="op" id="4325970">)</span><span class="op" id="4325971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325975">t2</span>&nbsp;<span class="op" id="4325978">=</span>&nbsp;<span class="ident" id="4325980">xk</span><span class="op" id="4325982">[</span><span class="ident" id="4325983">k</span><span class="op" id="4325984">+</span><span class="num" id="4325985">2</span><span class="op" id="4325986">]</span>&nbsp;<span class="op" id="4325988">^</span>&nbsp;<span class="ident" id="4325990">te0</span><span class="op" id="4325993">[</span><span class="builtintype" id="4325994">uint8</span><span class="op" id="4325999">(</span><span class="ident" id="4326000">s2</span><span class="op" id="4326002">&gt;&gt;</span><span class="num" id="4326004">24</span><span class="op" id="4326006">)</span><span class="op" id="4326007">]</span>&nbsp;<span class="op" id="4326009">^</span>&nbsp;<span class="ident" id="4326011">te1</span><span class="op" id="4326014">[</span><span class="builtintype" id="4326015">uint8</span><span class="op" id="4326020">(</span><span class="ident" id="4326021">s3</span><span class="op" id="4326023">&gt;&gt;</span><span class="num" id="4326025">16</span><span class="op" id="4326027">)</span><span class="op" id="4326028">]</span>&nbsp;<span class="op" id="4326030">^</span>&nbsp;<span class="ident" id="4326032">te2</span><span class="op" id="4326035">[</span><span class="builtintype" id="4326036">uint8</span><span class="op" id="4326041">(</span><span class="ident" id="4326042">s0</span><span class="op" id="4326044">&gt;&gt;</span><span class="num" id="4326046">8</span><span class="op" id="4326047">)</span><span class="op" id="4326048">]</span>&nbsp;<span class="op" id="4326050">^</span>&nbsp;<span class="ident" id="4326052">te3</span><span class="op" id="4326055">[</span><span class="builtintype" id="4326056">uint8</span><span class="op" id="4326061">(</span><span class="ident" id="4326062">s1</span><span class="op" id="4326064">)</span><span class="op" id="4326065">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326069">t3</span>&nbsp;<span class="op" id="4326072">=</span>&nbsp;<span class="ident" id="4326074">xk</span><span class="op" id="4326076">[</span><span class="ident" id="4326077">k</span><span class="op" id="4326078">+</span><span class="num" id="4326079">3</span><span class="op" id="4326080">]</span>&nbsp;<span class="op" id="4326082">^</span>&nbsp;<span class="ident" id="4326084">te0</span><span class="op" id="4326087">[</span><span class="builtintype" id="4326088">uint8</span><span class="op" id="4326093">(</span><span class="ident" id="4326094">s3</span><span class="op" id="4326096">&gt;&gt;</span><span class="num" id="4326098">24</span><span class="op" id="4326100">)</span><span class="op" id="4326101">]</span>&nbsp;<span class="op" id="4326103">^</span>&nbsp;<span class="ident" id="4326105">te1</span><span class="op" id="4326108">[</span><span class="builtintype" id="4326109">uint8</span><span class="op" id="4326114">(</span><span class="ident" id="4326115">s0</span><span class="op" id="4326117">&gt;&gt;</span><span class="num" id="4326119">16</span><span class="op" id="4326121">)</span><span class="op" id="4326122">]</span>&nbsp;<span class="op" id="4326124">^</span>&nbsp;<span class="ident" id="4326126">te2</span><span class="op" id="4326129">[</span><span class="builtintype" id="4326130">uint8</span><span class="op" id="4326135">(</span><span class="ident" id="4326136">s1</span><span class="op" id="4326138">&gt;&gt;</span><span class="num" id="4326140">8</span><span class="op" id="4326141">)</span><span class="op" id="4326142">]</span>&nbsp;<span class="op" id="4326144">^</span>&nbsp;<span class="ident" id="4326146">te3</span><span class="op" id="4326149">[</span><span class="builtintype" id="4326150">uint8</span><span class="op" id="4326155">(</span><span class="ident" id="4326156">s2</span><span class="op" id="4326158">)</span><span class="op" id="4326159">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326163">k</span>&nbsp;<span class="op" id="4326165">+=</span>&nbsp;<span class="num" id="4326168">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326172">s0</span><span class="op" id="4326174">,</span>&nbsp;<span class="ident" id="4326176">s1</span><span class="op" id="4326178">,</span>&nbsp;<span class="ident" id="4326180">s2</span><span class="op" id="4326182">,</span>&nbsp;<span class="ident" id="4326184">s3</span>&nbsp;<span class="op" id="4326187">=</span>&nbsp;<span class="ident" id="4326189">t0</span><span class="op" id="4326191">,</span>&nbsp;<span class="ident" id="4326193">t1</span><span class="op" id="4326195">,</span>&nbsp;<span class="ident" id="4326197">t2</span><span class="op" id="4326199">,</span>&nbsp;<span class="ident" id="4326201">t3</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4326205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4326209">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326272">s0</span>&nbsp;<span class="op" id="4326275">=</span>&nbsp;<span class="builtintype" id="4326277">uint32</span><span class="op" id="4326283">(</span><span class="ident" id="4326284">sbox0</span><span class="op" id="4326289">[</span><span class="ident" id="4326290">t0</span><span class="op" id="4326292">&gt;&gt;</span><span class="num" id="4326294">24</span><span class="op" id="4326296">]</span><span class="op" id="4326297">)</span><span class="op" id="4326298">&lt;&lt;</span><span class="num" id="4326300">24</span>&nbsp;<span class="op" id="4326303">|</span>&nbsp;<span class="builtintype" id="4326305">uint32</span><span class="op" id="4326311">(</span><span class="ident" id="4326312">sbox0</span><span class="op" id="4326317">[</span><span class="ident" id="4326318">t1</span><span class="op" id="4326320">&gt;&gt;</span><span class="num" id="4326322">16</span><span class="op" id="4326324">&amp;</span><span class="num" id="4326325">0xff</span><span class="op" id="4326329">]</span><span class="op" id="4326330">)</span><span class="op" id="4326331">&lt;&lt;</span><span class="num" id="4326333">16</span>&nbsp;<span class="op" id="4326336">|</span>&nbsp;<span class="builtintype" id="4326338">uint32</span><span class="op" id="4326344">(</span><span class="ident" id="4326345">sbox0</span><span class="op" id="4326350">[</span><span class="ident" id="4326351">t2</span><span class="op" id="4326353">&gt;&gt;</span><span class="num" id="4326355">8</span><span class="op" id="4326356">&amp;</span><span class="num" id="4326357">0xff</span><span class="op" id="4326361">]</span><span class="op" id="4326362">)</span><span class="op" id="4326363">&lt;&lt;</span><span class="num" id="4326365">8</span>&nbsp;<span class="op" id="4326367">|</span>&nbsp;<span class="builtintype" id="4326369">uint32</span><span class="op" id="4326375">(</span><span class="ident" id="4326376">sbox0</span><span class="op" id="4326381">[</span><span class="ident" id="4326382">t3</span><span class="op" id="4326384">&amp;</span><span class="num" id="4326385">0xff</span><span class="op" id="4326389">]</span><span class="op" id="4326390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326393">s1</span>&nbsp;<span class="op" id="4326396">=</span>&nbsp;<span class="builtintype" id="4326398">uint32</span><span class="op" id="4326404">(</span><span class="ident" id="4326405">sbox0</span><span class="op" id="4326410">[</span><span class="ident" id="4326411">t1</span><span class="op" id="4326413">&gt;&gt;</span><span class="num" id="4326415">24</span><span class="op" id="4326417">]</span><span class="op" id="4326418">)</span><span class="op" id="4326419">&lt;&lt;</span><span class="num" id="4326421">24</span>&nbsp;<span class="op" id="4326424">|</span>&nbsp;<span class="builtintype" id="4326426">uint32</span><span class="op" id="4326432">(</span><span class="ident" id="4326433">sbox0</span><span class="op" id="4326438">[</span><span class="ident" id="4326439">t2</span><span class="op" id="4326441">&gt;&gt;</span><span class="num" id="4326443">16</span><span class="op" id="4326445">&amp;</span><span class="num" id="4326446">0xff</span><span class="op" id="4326450">]</span><span class="op" id="4326451">)</span><span class="op" id="4326452">&lt;&lt;</span><span class="num" id="4326454">16</span>&nbsp;<span class="op" id="4326457">|</span>&nbsp;<span class="builtintype" id="4326459">uint32</span><span class="op" id="4326465">(</span><span class="ident" id="4326466">sbox0</span><span class="op" id="4326471">[</span><span class="ident" id="4326472">t3</span><span class="op" id="4326474">&gt;&gt;</span><span class="num" id="4326476">8</span><span class="op" id="4326477">&amp;</span><span class="num" id="4326478">0xff</span><span class="op" id="4326482">]</span><span class="op" id="4326483">)</span><span class="op" id="4326484">&lt;&lt;</span><span class="num" id="4326486">8</span>&nbsp;<span class="op" id="4326488">|</span>&nbsp;<span class="builtintype" id="4326490">uint32</span><span class="op" id="4326496">(</span><span class="ident" id="4326497">sbox0</span><span class="op" id="4326502">[</span><span class="ident" id="4326503">t0</span><span class="op" id="4326505">&amp;</span><span class="num" id="4326506">0xff</span><span class="op" id="4326510">]</span><span class="op" id="4326511">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326514">s2</span>&nbsp;<span class="op" id="4326517">=</span>&nbsp;<span class="builtintype" id="4326519">uint32</span><span class="op" id="4326525">(</span><span class="ident" id="4326526">sbox0</span><span class="op" id="4326531">[</span><span class="ident" id="4326532">t2</span><span class="op" id="4326534">&gt;&gt;</span><span class="num" id="4326536">24</span><span class="op" id="4326538">]</span><span class="op" id="4326539">)</span><span class="op" id="4326540">&lt;&lt;</span><span class="num" id="4326542">24</span>&nbsp;<span class="op" id="4326545">|</span>&nbsp;<span class="builtintype" id="4326547">uint32</span><span class="op" id="4326553">(</span><span class="ident" id="4326554">sbox0</span><span class="op" id="4326559">[</span><span class="ident" id="4326560">t3</span><span class="op" id="4326562">&gt;&gt;</span><span class="num" id="4326564">16</span><span class="op" id="4326566">&amp;</span><span class="num" id="4326567">0xff</span><span class="op" id="4326571">]</span><span class="op" id="4326572">)</span><span class="op" id="4326573">&lt;&lt;</span><span class="num" id="4326575">16</span>&nbsp;<span class="op" id="4326578">|</span>&nbsp;<span class="builtintype" id="4326580">uint32</span><span class="op" id="4326586">(</span><span class="ident" id="4326587">sbox0</span><span class="op" id="4326592">[</span><span class="ident" id="4326593">t0</span><span class="op" id="4326595">&gt;&gt;</span><span class="num" id="4326597">8</span><span class="op" id="4326598">&amp;</span><span class="num" id="4326599">0xff</span><span class="op" id="4326603">]</span><span class="op" id="4326604">)</span><span class="op" id="4326605">&lt;&lt;</span><span class="num" id="4326607">8</span>&nbsp;<span class="op" id="4326609">|</span>&nbsp;<span class="builtintype" id="4326611">uint32</span><span class="op" id="4326617">(</span><span class="ident" id="4326618">sbox0</span><span class="op" id="4326623">[</span><span class="ident" id="4326624">t1</span><span class="op" id="4326626">&amp;</span><span class="num" id="4326627">0xff</span><span class="op" id="4326631">]</span><span class="op" id="4326632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326635">s3</span>&nbsp;<span class="op" id="4326638">=</span>&nbsp;<span class="builtintype" id="4326640">uint32</span><span class="op" id="4326646">(</span><span class="ident" id="4326647">sbox0</span><span class="op" id="4326652">[</span><span class="ident" id="4326653">t3</span><span class="op" id="4326655">&gt;&gt;</span><span class="num" id="4326657">24</span><span class="op" id="4326659">]</span><span class="op" id="4326660">)</span><span class="op" id="4326661">&lt;&lt;</span><span class="num" id="4326663">24</span>&nbsp;<span class="op" id="4326666">|</span>&nbsp;<span class="builtintype" id="4326668">uint32</span><span class="op" id="4326674">(</span><span class="ident" id="4326675">sbox0</span><span class="op" id="4326680">[</span><span class="ident" id="4326681">t0</span><span class="op" id="4326683">&gt;&gt;</span><span class="num" id="4326685">16</span><span class="op" id="4326687">&amp;</span><span class="num" id="4326688">0xff</span><span class="op" id="4326692">]</span><span class="op" id="4326693">)</span><span class="op" id="4326694">&lt;&lt;</span><span class="num" id="4326696">16</span>&nbsp;<span class="op" id="4326699">|</span>&nbsp;<span class="builtintype" id="4326701">uint32</span><span class="op" id="4326707">(</span><span class="ident" id="4326708">sbox0</span><span class="op" id="4326713">[</span><span class="ident" id="4326714">t1</span><span class="op" id="4326716">&gt;&gt;</span><span class="num" id="4326718">8</span><span class="op" id="4326719">&amp;</span><span class="num" id="4326720">0xff</span><span class="op" id="4326724">]</span><span class="op" id="4326725">)</span><span class="op" id="4326726">&lt;&lt;</span><span class="num" id="4326728">8</span>&nbsp;<span class="op" id="4326730">|</span>&nbsp;<span class="builtintype" id="4326732">uint32</span><span class="op" id="4326738">(</span><span class="ident" id="4326739">sbox0</span><span class="op" id="4326744">[</span><span class="ident" id="4326745">t2</span><span class="op" id="4326747">&amp;</span><span class="num" id="4326748">0xff</span><span class="op" id="4326752">]</span><span class="op" id="4326753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326757">s0</span>&nbsp;<span class="op" id="4326760">^=</span>&nbsp;<span class="ident" id="4326763">xk</span><span class="op" id="4326765">[</span><span class="ident" id="4326766">k</span><span class="op" id="4326767">+</span><span class="num" id="4326768">0</span><span class="op" id="4326769">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326772">s1</span>&nbsp;<span class="op" id="4326775">^=</span>&nbsp;<span class="ident" id="4326778">xk</span><span class="op" id="4326780">[</span><span class="ident" id="4326781">k</span><span class="op" id="4326782">+</span><span class="num" id="4326783">1</span><span class="op" id="4326784">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326787">s2</span>&nbsp;<span class="op" id="4326790">^=</span>&nbsp;<span class="ident" id="4326793">xk</span><span class="op" id="4326795">[</span><span class="ident" id="4326796">k</span><span class="op" id="4326797">+</span><span class="num" id="4326798">2</span><span class="op" id="4326799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326802">s3</span>&nbsp;<span class="op" id="4326805">^=</span>&nbsp;<span class="ident" id="4326808">xk</span><span class="op" id="4326810">[</span><span class="ident" id="4326811">k</span><span class="op" id="4326812">+</span><span class="num" id="4326813">3</span><span class="op" id="4326814">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326818">dst</span><span class="op" id="4326821">[</span><span class="num" id="4326822">0</span><span class="op" id="4326823">]</span><span class="op" id="4326824">,</span>&nbsp;<span class="ident" id="4326826">dst</span><span class="op" id="4326829">[</span><span class="num" id="4326830">1</span><span class="op" id="4326831">]</span><span class="op" id="4326832">,</span>&nbsp;<span class="ident" id="4326834">dst</span><span class="op" id="4326837">[</span><span class="num" id="4326838">2</span><span class="op" id="4326839">]</span><span class="op" id="4326840">,</span>&nbsp;<span class="ident" id="4326842">dst</span><span class="op" id="4326845">[</span><span class="num" id="4326846">3</span><span class="op" id="4326847">]</span>&nbsp;<span class="op" id="4326849">=</span>&nbsp;<span class="builtintype" id="4326851">byte</span><span class="op" id="4326855">(</span><span class="ident" id="4326856">s0</span><span class="op" id="4326858">&gt;&gt;</span><span class="num" id="4326860">24</span><span class="op" id="4326862">)</span><span class="op" id="4326863">,</span>&nbsp;<span class="builtintype" id="4326865">byte</span><span class="op" id="4326869">(</span><span class="ident" id="4326870">s0</span><span class="op" id="4326872">&gt;&gt;</span><span class="num" id="4326874">16</span><span class="op" id="4326876">)</span><span class="op" id="4326877">,</span>&nbsp;<span class="builtintype" id="4326879">byte</span><span class="op" id="4326883">(</span><span class="ident" id="4326884">s0</span><span class="op" id="4326886">&gt;&gt;</span><span class="num" id="4326888">8</span><span class="op" id="4326889">)</span><span class="op" id="4326890">,</span>&nbsp;<span class="builtintype" id="4326892">byte</span><span class="op" id="4326896">(</span><span class="ident" id="4326897">s0</span><span class="op" id="4326899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326902">dst</span><span class="op" id="4326905">[</span><span class="num" id="4326906">4</span><span class="op" id="4326907">]</span><span class="op" id="4326908">,</span>&nbsp;<span class="ident" id="4326910">dst</span><span class="op" id="4326913">[</span><span class="num" id="4326914">5</span><span class="op" id="4326915">]</span><span class="op" id="4326916">,</span>&nbsp;<span class="ident" id="4326918">dst</span><span class="op" id="4326921">[</span><span class="num" id="4326922">6</span><span class="op" id="4326923">]</span><span class="op" id="4326924">,</span>&nbsp;<span class="ident" id="4326926">dst</span><span class="op" id="4326929">[</span><span class="num" id="4326930">7</span><span class="op" id="4326931">]</span>&nbsp;<span class="op" id="4326933">=</span>&nbsp;<span class="builtintype" id="4326935">byte</span><span class="op" id="4326939">(</span><span class="ident" id="4326940">s1</span><span class="op" id="4326942">&gt;&gt;</span><span class="num" id="4326944">24</span><span class="op" id="4326946">)</span><span class="op" id="4326947">,</span>&nbsp;<span class="builtintype" id="4326949">byte</span><span class="op" id="4326953">(</span><span class="ident" id="4326954">s1</span><span class="op" id="4326956">&gt;&gt;</span><span class="num" id="4326958">16</span><span class="op" id="4326960">)</span><span class="op" id="4326961">,</span>&nbsp;<span class="builtintype" id="4326963">byte</span><span class="op" id="4326967">(</span><span class="ident" id="4326968">s1</span><span class="op" id="4326970">&gt;&gt;</span><span class="num" id="4326972">8</span><span class="op" id="4326973">)</span><span class="op" id="4326974">,</span>&nbsp;<span class="builtintype" id="4326976">byte</span><span class="op" id="4326980">(</span><span class="ident" id="4326981">s1</span><span class="op" id="4326983">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4326986">dst</span><span class="op" id="4326989">[</span><span class="num" id="4326990">8</span><span class="op" id="4326991">]</span><span class="op" id="4326992">,</span>&nbsp;<span class="ident" id="4326994">dst</span><span class="op" id="4326997">[</span><span class="num" id="4326998">9</span><span class="op" id="4326999">]</span><span class="op" id="4327000">,</span>&nbsp;<span class="ident" id="4327002">dst</span><span class="op" id="4327005">[</span><span class="num" id="4327006">10</span><span class="op" id="4327008">]</span><span class="op" id="4327009">,</span>&nbsp;<span class="ident" id="4327011">dst</span><span class="op" id="4327014">[</span><span class="num" id="4327015">11</span><span class="op" id="4327017">]</span>&nbsp;<span class="op" id="4327019">=</span>&nbsp;<span class="builtintype" id="4327021">byte</span><span class="op" id="4327025">(</span><span class="ident" id="4327026">s2</span><span class="op" id="4327028">&gt;&gt;</span><span class="num" id="4327030">24</span><span class="op" id="4327032">)</span><span class="op" id="4327033">,</span>&nbsp;<span class="builtintype" id="4327035">byte</span><span class="op" id="4327039">(</span><span class="ident" id="4327040">s2</span><span class="op" id="4327042">&gt;&gt;</span><span class="num" id="4327044">16</span><span class="op" id="4327046">)</span><span class="op" id="4327047">,</span>&nbsp;<span class="builtintype" id="4327049">byte</span><span class="op" id="4327053">(</span><span class="ident" id="4327054">s2</span><span class="op" id="4327056">&gt;&gt;</span><span class="num" id="4327058">8</span><span class="op" id="4327059">)</span><span class="op" id="4327060">,</span>&nbsp;<span class="builtintype" id="4327062">byte</span><span class="op" id="4327066">(</span><span class="ident" id="4327067">s2</span><span class="op" id="4327069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327072">dst</span><span class="op" id="4327075">[</span><span class="num" id="4327076">12</span><span class="op" id="4327078">]</span><span class="op" id="4327079">,</span>&nbsp;<span class="ident" id="4327081">dst</span><span class="op" id="4327084">[</span><span class="num" id="4327085">13</span><span class="op" id="4327087">]</span><span class="op" id="4327088">,</span>&nbsp;<span class="ident" id="4327090">dst</span><span class="op" id="4327093">[</span><span class="num" id="4327094">14</span><span class="op" id="4327096">]</span><span class="op" id="4327097">,</span>&nbsp;<span class="ident" id="4327099">dst</span><span class="op" id="4327102">[</span><span class="num" id="4327103">15</span><span class="op" id="4327105">]</span>&nbsp;<span class="op" id="4327107">=</span>&nbsp;<span class="builtintype" id="4327109">byte</span><span class="op" id="4327113">(</span><span class="ident" id="4327114">s3</span><span class="op" id="4327116">&gt;&gt;</span><span class="num" id="4327118">24</span><span class="op" id="4327120">)</span><span class="op" id="4327121">,</span>&nbsp;<span class="builtintype" id="4327123">byte</span><span class="op" id="4327127">(</span><span class="ident" id="4327128">s3</span><span class="op" id="4327130">&gt;&gt;</span><span class="num" id="4327132">16</span><span class="op" id="4327134">)</span><span class="op" id="4327135">,</span>&nbsp;<span class="builtintype" id="4327137">byte</span><span class="op" id="4327141">(</span><span class="ident" id="4327142">s3</span><span class="op" id="4327144">&gt;&gt;</span><span class="num" id="4327146">8</span><span class="op" id="4327147">)</span><span class="op" id="4327148">,</span>&nbsp;<span class="builtintype" id="4327150">byte</span><span class="op" id="4327154">(</span><span class="ident" id="4327155">s3</span><span class="op" id="4327157">)</span><br>
<span class="lineno"></span><span class="op" id="4327159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327162">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">85</span><span class="keyword" id="4327229">func</span>&nbsp;<span class="ident" id="4327234">decryptBlockGo</span><span class="op" id="4327248">(</span><span class="ident" id="4327249">xk</span>&nbsp;<span class="op" id="4327252">[</span><span class="op" id="4327253">]</span><span class="builtintype" id="4327254">uint32</span><span class="op" id="4327260">,</span>&nbsp;<span class="ident" id="4327262">dst</span><span class="op" id="4327265">,</span>&nbsp;<span class="ident" id="4327267">src</span>&nbsp;<span class="op" id="4327271">[</span><span class="op" id="4327272">]</span><span class="builtintype" id="4327273">byte</span><span class="op" id="4327277">)</span>&nbsp;<span class="op" id="4327279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4327282">var</span>&nbsp;<span class="ident" id="4327286">s0</span><span class="op" id="4327288">,</span>&nbsp;<span class="ident" id="4327290">s1</span><span class="op" id="4327292">,</span>&nbsp;<span class="ident" id="4327294">s2</span><span class="op" id="4327296">,</span>&nbsp;<span class="ident" id="4327298">s3</span><span class="op" id="4327300">,</span>&nbsp;<span class="ident" id="4327302">t0</span><span class="op" id="4327304">,</span>&nbsp;<span class="ident" id="4327306">t1</span><span class="op" id="4327308">,</span>&nbsp;<span class="ident" id="4327310">t2</span><span class="op" id="4327312">,</span>&nbsp;<span class="ident" id="4327314">t3</span>&nbsp;<span class="builtintype" id="4327317">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327326">s0</span>&nbsp;<span class="op" id="4327329">=</span>&nbsp;<span class="builtintype" id="4327331">uint32</span><span class="op" id="4327337">(</span><span class="ident" id="4327338">src</span><span class="op" id="4327341">[</span><span class="num" id="4327342">0</span><span class="op" id="4327343">]</span><span class="op" id="4327344">)</span><span class="op" id="4327345">&lt;&lt;</span><span class="num" id="4327347">24</span>&nbsp;<span class="op" id="4327350">|</span>&nbsp;<span class="builtintype" id="4327352">uint32</span><span class="op" id="4327358">(</span><span class="ident" id="4327359">src</span><span class="op" id="4327362">[</span><span class="num" id="4327363">1</span><span class="op" id="4327364">]</span><span class="op" id="4327365">)</span><span class="op" id="4327366">&lt;&lt;</span><span class="num" id="4327368">16</span>&nbsp;<span class="op" id="4327371">|</span>&nbsp;<span class="builtintype" id="4327373">uint32</span><span class="op" id="4327379">(</span><span class="ident" id="4327380">src</span><span class="op" id="4327383">[</span><span class="num" id="4327384">2</span><span class="op" id="4327385">]</span><span class="op" id="4327386">)</span><span class="op" id="4327387">&lt;&lt;</span><span class="num" id="4327389">8</span>&nbsp;<span class="op" id="4327391">|</span>&nbsp;<span class="builtintype" id="4327393">uint32</span><span class="op" id="4327399">(</span><span class="ident" id="4327400">src</span><span class="op" id="4327403">[</span><span class="num" id="4327404">3</span><span class="op" id="4327405">]</span><span class="op" id="4327406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327409">s1</span>&nbsp;<span class="op" id="4327412">=</span>&nbsp;<span class="builtintype" id="4327414">uint32</span><span class="op" id="4327420">(</span><span class="ident" id="4327421">src</span><span class="op" id="4327424">[</span><span class="num" id="4327425">4</span><span class="op" id="4327426">]</span><span class="op" id="4327427">)</span><span class="op" id="4327428">&lt;&lt;</span><span class="num" id="4327430">24</span>&nbsp;<span class="op" id="4327433">|</span>&nbsp;<span class="builtintype" id="4327435">uint32</span><span class="op" id="4327441">(</span><span class="ident" id="4327442">src</span><span class="op" id="4327445">[</span><span class="num" id="4327446">5</span><span class="op" id="4327447">]</span><span class="op" id="4327448">)</span><span class="op" id="4327449">&lt;&lt;</span><span class="num" id="4327451">16</span>&nbsp;<span class="op" id="4327454">|</span>&nbsp;<span class="builtintype" id="4327456">uint32</span><span class="op" id="4327462">(</span><span class="ident" id="4327463">src</span><span class="op" id="4327466">[</span><span class="num" id="4327467">6</span><span class="op" id="4327468">]</span><span class="op" id="4327469">)</span><span class="op" id="4327470">&lt;&lt;</span><span class="num" id="4327472">8</span>&nbsp;<span class="op" id="4327474">|</span>&nbsp;<span class="builtintype" id="4327476">uint32</span><span class="op" id="4327482">(</span><span class="ident" id="4327483">src</span><span class="op" id="4327486">[</span><span class="num" id="4327487">7</span><span class="op" id="4327488">]</span><span class="op" id="4327489">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327492">s2</span>&nbsp;<span class="op" id="4327495">=</span>&nbsp;<span class="builtintype" id="4327497">uint32</span><span class="op" id="4327503">(</span><span class="ident" id="4327504">src</span><span class="op" id="4327507">[</span><span class="num" id="4327508">8</span><span class="op" id="4327509">]</span><span class="op" id="4327510">)</span><span class="op" id="4327511">&lt;&lt;</span><span class="num" id="4327513">24</span>&nbsp;<span class="op" id="4327516">|</span>&nbsp;<span class="builtintype" id="4327518">uint32</span><span class="op" id="4327524">(</span><span class="ident" id="4327525">src</span><span class="op" id="4327528">[</span><span class="num" id="4327529">9</span><span class="op" id="4327530">]</span><span class="op" id="4327531">)</span><span class="op" id="4327532">&lt;&lt;</span><span class="num" id="4327534">16</span>&nbsp;<span class="op" id="4327537">|</span>&nbsp;<span class="builtintype" id="4327539">uint32</span><span class="op" id="4327545">(</span><span class="ident" id="4327546">src</span><span class="op" id="4327549">[</span><span class="num" id="4327550">10</span><span class="op" id="4327552">]</span><span class="op" id="4327553">)</span><span class="op" id="4327554">&lt;&lt;</span><span class="num" id="4327556">8</span>&nbsp;<span class="op" id="4327558">|</span>&nbsp;<span class="builtintype" id="4327560">uint32</span><span class="op" id="4327566">(</span><span class="ident" id="4327567">src</span><span class="op" id="4327570">[</span><span class="num" id="4327571">11</span><span class="op" id="4327573">]</span><span class="op" id="4327574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327577">s3</span>&nbsp;<span class="op" id="4327580">=</span>&nbsp;<span class="builtintype" id="4327582">uint32</span><span class="op" id="4327588">(</span><span class="ident" id="4327589">src</span><span class="op" id="4327592">[</span><span class="num" id="4327593">12</span><span class="op" id="4327595">]</span><span class="op" id="4327596">)</span><span class="op" id="4327597">&lt;&lt;</span><span class="num" id="4327599">24</span>&nbsp;<span class="op" id="4327602">|</span>&nbsp;<span class="builtintype" id="4327604">uint32</span><span class="op" id="4327610">(</span><span class="ident" id="4327611">src</span><span class="op" id="4327614">[</span><span class="num" id="4327615">13</span><span class="op" id="4327617">]</span><span class="op" id="4327618">)</span><span class="op" id="4327619">&lt;&lt;</span><span class="num" id="4327621">16</span>&nbsp;<span class="op" id="4327624">|</span>&nbsp;<span class="builtintype" id="4327626">uint32</span><span class="op" id="4327632">(</span><span class="ident" id="4327633">src</span><span class="op" id="4327636">[</span><span class="num" id="4327637">14</span><span class="op" id="4327639">]</span><span class="op" id="4327640">)</span><span class="op" id="4327641">&lt;&lt;</span><span class="num" id="4327643">8</span>&nbsp;<span class="op" id="4327645">|</span>&nbsp;<span class="builtintype" id="4327647">uint32</span><span class="op" id="4327653">(</span><span class="ident" id="4327654">src</span><span class="op" id="4327657">[</span><span class="num" id="4327658">15</span><span class="op" id="4327660">]</span><span class="op" id="4327661">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4327665">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327707">s0</span>&nbsp;<span class="op" id="4327710">^=</span>&nbsp;<span class="ident" id="4327713">xk</span><span class="op" id="4327715">[</span><span class="num" id="4327716">0</span><span class="op" id="4327717">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327720">s1</span>&nbsp;<span class="op" id="4327723">^=</span>&nbsp;<span class="ident" id="4327726">xk</span><span class="op" id="4327728">[</span><span class="num" id="4327729">1</span><span class="op" id="4327730">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327733">s2</span>&nbsp;<span class="op" id="4327736">^=</span>&nbsp;<span class="ident" id="4327739">xk</span><span class="op" id="4327741">[</span><span class="num" id="4327742">2</span><span class="op" id="4327743">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327746">s3</span>&nbsp;<span class="op" id="4327749">^=</span>&nbsp;<span class="ident" id="4327752">xk</span><span class="op" id="4327754">[</span><span class="num" id="4327755">3</span><span class="op" id="4327756">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4327760">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4327800">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327855">nr</span>&nbsp;<span class="op" id="4327858">:=</span>&nbsp;<span class="builtinfunc" id="4327861">len</span><span class="op" id="4327864">(</span><span class="ident" id="4327865">xk</span><span class="op" id="4327867">)</span><span class="op" id="4327868">/</span><span class="num" id="4327869">4</span>&nbsp;<span class="op" id="4327871">-</span>&nbsp;<span class="num" id="4327873">2</span>&nbsp;<span class="comment" id="4327875">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327910">k</span>&nbsp;<span class="op" id="4327912">:=</span>&nbsp;<span class="num" id="4327915">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4327918">for</span>&nbsp;<span class="ident" id="4327922">r</span>&nbsp;<span class="op" id="4327924">:=</span>&nbsp;<span class="num" id="4327927">0</span><span class="op" id="4327928">;</span>&nbsp;<span class="ident" id="4327930">r</span>&nbsp;<span class="op" id="4327932">&lt;</span>&nbsp;<span class="ident" id="4327934">nr</span><span class="op" id="4327936">;</span>&nbsp;<span class="ident" id="4327938">r</span><span class="op" id="4327939">++</span>&nbsp;<span class="op" id="4327942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327946">t0</span>&nbsp;<span class="op" id="4327949">=</span>&nbsp;<span class="ident" id="4327951">xk</span><span class="op" id="4327953">[</span><span class="ident" id="4327954">k</span><span class="op" id="4327955">+</span><span class="num" id="4327956">0</span><span class="op" id="4327957">]</span>&nbsp;<span class="op" id="4327959">^</span>&nbsp;<span class="ident" id="4327961">td0</span><span class="op" id="4327964">[</span><span class="builtintype" id="4327965">uint8</span><span class="op" id="4327970">(</span><span class="ident" id="4327971">s0</span><span class="op" id="4327973">&gt;&gt;</span><span class="num" id="4327975">24</span><span class="op" id="4327977">)</span><span class="op" id="4327978">]</span>&nbsp;<span class="op" id="4327980">^</span>&nbsp;<span class="ident" id="4327982">td1</span><span class="op" id="4327985">[</span><span class="builtintype" id="4327986">uint8</span><span class="op" id="4327991">(</span><span class="ident" id="4327992">s3</span><span class="op" id="4327994">&gt;&gt;</span><span class="num" id="4327996">16</span><span class="op" id="4327998">)</span><span class="op" id="4327999">]</span>&nbsp;<span class="op" id="4328001">^</span>&nbsp;<span class="ident" id="4328003">td2</span><span class="op" id="4328006">[</span><span class="builtintype" id="4328007">uint8</span><span class="op" id="4328012">(</span><span class="ident" id="4328013">s2</span><span class="op" id="4328015">&gt;&gt;</span><span class="num" id="4328017">8</span><span class="op" id="4328018">)</span><span class="op" id="4328019">]</span>&nbsp;<span class="op" id="4328021">^</span>&nbsp;<span class="ident" id="4328023">td3</span><span class="op" id="4328026">[</span><span class="builtintype" id="4328027">uint8</span><span class="op" id="4328032">(</span><span class="ident" id="4328033">s1</span><span class="op" id="4328035">)</span><span class="op" id="4328036">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328040">t1</span>&nbsp;<span class="op" id="4328043">=</span>&nbsp;<span class="ident" id="4328045">xk</span><span class="op" id="4328047">[</span><span class="ident" id="4328048">k</span><span class="op" id="4328049">+</span><span class="num" id="4328050">1</span><span class="op" id="4328051">]</span>&nbsp;<span class="op" id="4328053">^</span>&nbsp;<span class="ident" id="4328055">td0</span><span class="op" id="4328058">[</span><span class="builtintype" id="4328059">uint8</span><span class="op" id="4328064">(</span><span class="ident" id="4328065">s1</span><span class="op" id="4328067">&gt;&gt;</span><span class="num" id="4328069">24</span><span class="op" id="4328071">)</span><span class="op" id="4328072">]</span>&nbsp;<span class="op" id="4328074">^</span>&nbsp;<span class="ident" id="4328076">td1</span><span class="op" id="4328079">[</span><span class="builtintype" id="4328080">uint8</span><span class="op" id="4328085">(</span><span class="ident" id="4328086">s0</span><span class="op" id="4328088">&gt;&gt;</span><span class="num" id="4328090">16</span><span class="op" id="4328092">)</span><span class="op" id="4328093">]</span>&nbsp;<span class="op" id="4328095">^</span>&nbsp;<span class="ident" id="4328097">td2</span><span class="op" id="4328100">[</span><span class="builtintype" id="4328101">uint8</span><span class="op" id="4328106">(</span><span class="ident" id="4328107">s3</span><span class="op" id="4328109">&gt;&gt;</span><span class="num" id="4328111">8</span><span class="op" id="4328112">)</span><span class="op" id="4328113">]</span>&nbsp;<span class="op" id="4328115">^</span>&nbsp;<span class="ident" id="4328117">td3</span><span class="op" id="4328120">[</span><span class="builtintype" id="4328121">uint8</span><span class="op" id="4328126">(</span><span class="ident" id="4328127">s2</span><span class="op" id="4328129">)</span><span class="op" id="4328130">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328134">t2</span>&nbsp;<span class="op" id="4328137">=</span>&nbsp;<span class="ident" id="4328139">xk</span><span class="op" id="4328141">[</span><span class="ident" id="4328142">k</span><span class="op" id="4328143">+</span><span class="num" id="4328144">2</span><span class="op" id="4328145">]</span>&nbsp;<span class="op" id="4328147">^</span>&nbsp;<span class="ident" id="4328149">td0</span><span class="op" id="4328152">[</span><span class="builtintype" id="4328153">uint8</span><span class="op" id="4328158">(</span><span class="ident" id="4328159">s2</span><span class="op" id="4328161">&gt;&gt;</span><span class="num" id="4328163">24</span><span class="op" id="4328165">)</span><span class="op" id="4328166">]</span>&nbsp;<span class="op" id="4328168">^</span>&nbsp;<span class="ident" id="4328170">td1</span><span class="op" id="4328173">[</span><span class="builtintype" id="4328174">uint8</span><span class="op" id="4328179">(</span><span class="ident" id="4328180">s1</span><span class="op" id="4328182">&gt;&gt;</span><span class="num" id="4328184">16</span><span class="op" id="4328186">)</span><span class="op" id="4328187">]</span>&nbsp;<span class="op" id="4328189">^</span>&nbsp;<span class="ident" id="4328191">td2</span><span class="op" id="4328194">[</span><span class="builtintype" id="4328195">uint8</span><span class="op" id="4328200">(</span><span class="ident" id="4328201">s0</span><span class="op" id="4328203">&gt;&gt;</span><span class="num" id="4328205">8</span><span class="op" id="4328206">)</span><span class="op" id="4328207">]</span>&nbsp;<span class="op" id="4328209">^</span>&nbsp;<span class="ident" id="4328211">td3</span><span class="op" id="4328214">[</span><span class="builtintype" id="4328215">uint8</span><span class="op" id="4328220">(</span><span class="ident" id="4328221">s3</span><span class="op" id="4328223">)</span><span class="op" id="4328224">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328228">t3</span>&nbsp;<span class="op" id="4328231">=</span>&nbsp;<span class="ident" id="4328233">xk</span><span class="op" id="4328235">[</span><span class="ident" id="4328236">k</span><span class="op" id="4328237">+</span><span class="num" id="4328238">3</span><span class="op" id="4328239">]</span>&nbsp;<span class="op" id="4328241">^</span>&nbsp;<span class="ident" id="4328243">td0</span><span class="op" id="4328246">[</span><span class="builtintype" id="4328247">uint8</span><span class="op" id="4328252">(</span><span class="ident" id="4328253">s3</span><span class="op" id="4328255">&gt;&gt;</span><span class="num" id="4328257">24</span><span class="op" id="4328259">)</span><span class="op" id="4328260">]</span>&nbsp;<span class="op" id="4328262">^</span>&nbsp;<span class="ident" id="4328264">td1</span><span class="op" id="4328267">[</span><span class="builtintype" id="4328268">uint8</span><span class="op" id="4328273">(</span><span class="ident" id="4328274">s2</span><span class="op" id="4328276">&gt;&gt;</span><span class="num" id="4328278">16</span><span class="op" id="4328280">)</span><span class="op" id="4328281">]</span>&nbsp;<span class="op" id="4328283">^</span>&nbsp;<span class="ident" id="4328285">td2</span><span class="op" id="4328288">[</span><span class="builtintype" id="4328289">uint8</span><span class="op" id="4328294">(</span><span class="ident" id="4328295">s1</span><span class="op" id="4328297">&gt;&gt;</span><span class="num" id="4328299">8</span><span class="op" id="4328300">)</span><span class="op" id="4328301">]</span>&nbsp;<span class="op" id="4328303">^</span>&nbsp;<span class="ident" id="4328305">td3</span><span class="op" id="4328308">[</span><span class="builtintype" id="4328309">uint8</span><span class="op" id="4328314">(</span><span class="ident" id="4328315">s0</span><span class="op" id="4328317">)</span><span class="op" id="4328318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328322">k</span>&nbsp;<span class="op" id="4328324">+=</span>&nbsp;<span class="num" id="4328327">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328331">s0</span><span class="op" id="4328333">,</span>&nbsp;<span class="ident" id="4328335">s1</span><span class="op" id="4328337">,</span>&nbsp;<span class="ident" id="4328339">s2</span><span class="op" id="4328341">,</span>&nbsp;<span class="ident" id="4328343">s3</span>&nbsp;<span class="op" id="4328346">=</span>&nbsp;<span class="ident" id="4328348">t0</span><span class="op" id="4328350">,</span>&nbsp;<span class="ident" id="4328352">t1</span><span class="op" id="4328354">,</span>&nbsp;<span class="ident" id="4328356">t2</span><span class="op" id="4328358">,</span>&nbsp;<span class="ident" id="4328360">t3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4328368">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328431">s0</span>&nbsp;<span class="op" id="4328434">=</span>&nbsp;<span class="builtintype" id="4328436">uint32</span><span class="op" id="4328442">(</span><span class="ident" id="4328443">sbox1</span><span class="op" id="4328448">[</span><span class="ident" id="4328449">t0</span><span class="op" id="4328451">&gt;&gt;</span><span class="num" id="4328453">24</span><span class="op" id="4328455">]</span><span class="op" id="4328456">)</span><span class="op" id="4328457">&lt;&lt;</span><span class="num" id="4328459">24</span>&nbsp;<span class="op" id="4328462">|</span>&nbsp;<span class="builtintype" id="4328464">uint32</span><span class="op" id="4328470">(</span><span class="ident" id="4328471">sbox1</span><span class="op" id="4328476">[</span><span class="ident" id="4328477">t3</span><span class="op" id="4328479">&gt;&gt;</span><span class="num" id="4328481">16</span><span class="op" id="4328483">&amp;</span><span class="num" id="4328484">0xff</span><span class="op" id="4328488">]</span><span class="op" id="4328489">)</span><span class="op" id="4328490">&lt;&lt;</span><span class="num" id="4328492">16</span>&nbsp;<span class="op" id="4328495">|</span>&nbsp;<span class="builtintype" id="4328497">uint32</span><span class="op" id="4328503">(</span><span class="ident" id="4328504">sbox1</span><span class="op" id="4328509">[</span><span class="ident" id="4328510">t2</span><span class="op" id="4328512">&gt;&gt;</span><span class="num" id="4328514">8</span><span class="op" id="4328515">&amp;</span><span class="num" id="4328516">0xff</span><span class="op" id="4328520">]</span><span class="op" id="4328521">)</span><span class="op" id="4328522">&lt;&lt;</span><span class="num" id="4328524">8</span>&nbsp;<span class="op" id="4328526">|</span>&nbsp;<span class="builtintype" id="4328528">uint32</span><span class="op" id="4328534">(</span><span class="ident" id="4328535">sbox1</span><span class="op" id="4328540">[</span><span class="ident" id="4328541">t1</span><span class="op" id="4328543">&amp;</span><span class="num" id="4328544">0xff</span><span class="op" id="4328548">]</span><span class="op" id="4328549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328552">s1</span>&nbsp;<span class="op" id="4328555">=</span>&nbsp;<span class="builtintype" id="4328557">uint32</span><span class="op" id="4328563">(</span><span class="ident" id="4328564">sbox1</span><span class="op" id="4328569">[</span><span class="ident" id="4328570">t1</span><span class="op" id="4328572">&gt;&gt;</span><span class="num" id="4328574">24</span><span class="op" id="4328576">]</span><span class="op" id="4328577">)</span><span class="op" id="4328578">&lt;&lt;</span><span class="num" id="4328580">24</span>&nbsp;<span class="op" id="4328583">|</span>&nbsp;<span class="builtintype" id="4328585">uint32</span><span class="op" id="4328591">(</span><span class="ident" id="4328592">sbox1</span><span class="op" id="4328597">[</span><span class="ident" id="4328598">t0</span><span class="op" id="4328600">&gt;&gt;</span><span class="num" id="4328602">16</span><span class="op" id="4328604">&amp;</span><span class="num" id="4328605">0xff</span><span class="op" id="4328609">]</span><span class="op" id="4328610">)</span><span class="op" id="4328611">&lt;&lt;</span><span class="num" id="4328613">16</span>&nbsp;<span class="op" id="4328616">|</span>&nbsp;<span class="builtintype" id="4328618">uint32</span><span class="op" id="4328624">(</span><span class="ident" id="4328625">sbox1</span><span class="op" id="4328630">[</span><span class="ident" id="4328631">t3</span><span class="op" id="4328633">&gt;&gt;</span><span class="num" id="4328635">8</span><span class="op" id="4328636">&amp;</span><span class="num" id="4328637">0xff</span><span class="op" id="4328641">]</span><span class="op" id="4328642">)</span><span class="op" id="4328643">&lt;&lt;</span><span class="num" id="4328645">8</span>&nbsp;<span class="op" id="4328647">|</span>&nbsp;<span class="builtintype" id="4328649">uint32</span><span class="op" id="4328655">(</span><span class="ident" id="4328656">sbox1</span><span class="op" id="4328661">[</span><span class="ident" id="4328662">t2</span><span class="op" id="4328664">&amp;</span><span class="num" id="4328665">0xff</span><span class="op" id="4328669">]</span><span class="op" id="4328670">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328673">s2</span>&nbsp;<span class="op" id="4328676">=</span>&nbsp;<span class="builtintype" id="4328678">uint32</span><span class="op" id="4328684">(</span><span class="ident" id="4328685">sbox1</span><span class="op" id="4328690">[</span><span class="ident" id="4328691">t2</span><span class="op" id="4328693">&gt;&gt;</span><span class="num" id="4328695">24</span><span class="op" id="4328697">]</span><span class="op" id="4328698">)</span><span class="op" id="4328699">&lt;&lt;</span><span class="num" id="4328701">24</span>&nbsp;<span class="op" id="4328704">|</span>&nbsp;<span class="builtintype" id="4328706">uint32</span><span class="op" id="4328712">(</span><span class="ident" id="4328713">sbox1</span><span class="op" id="4328718">[</span><span class="ident" id="4328719">t1</span><span class="op" id="4328721">&gt;&gt;</span><span class="num" id="4328723">16</span><span class="op" id="4328725">&amp;</span><span class="num" id="4328726">0xff</span><span class="op" id="4328730">]</span><span class="op" id="4328731">)</span><span class="op" id="4328732">&lt;&lt;</span><span class="num" id="4328734">16</span>&nbsp;<span class="op" id="4328737">|</span>&nbsp;<span class="builtintype" id="4328739">uint32</span><span class="op" id="4328745">(</span><span class="ident" id="4328746">sbox1</span><span class="op" id="4328751">[</span><span class="ident" id="4328752">t0</span><span class="op" id="4328754">&gt;&gt;</span><span class="num" id="4328756">8</span><span class="op" id="4328757">&amp;</span><span class="num" id="4328758">0xff</span><span class="op" id="4328762">]</span><span class="op" id="4328763">)</span><span class="op" id="4328764">&lt;&lt;</span><span class="num" id="4328766">8</span>&nbsp;<span class="op" id="4328768">|</span>&nbsp;<span class="builtintype" id="4328770">uint32</span><span class="op" id="4328776">(</span><span class="ident" id="4328777">sbox1</span><span class="op" id="4328782">[</span><span class="ident" id="4328783">t3</span><span class="op" id="4328785">&amp;</span><span class="num" id="4328786">0xff</span><span class="op" id="4328790">]</span><span class="op" id="4328791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328794">s3</span>&nbsp;<span class="op" id="4328797">=</span>&nbsp;<span class="builtintype" id="4328799">uint32</span><span class="op" id="4328805">(</span><span class="ident" id="4328806">sbox1</span><span class="op" id="4328811">[</span><span class="ident" id="4328812">t3</span><span class="op" id="4328814">&gt;&gt;</span><span class="num" id="4328816">24</span><span class="op" id="4328818">]</span><span class="op" id="4328819">)</span><span class="op" id="4328820">&lt;&lt;</span><span class="num" id="4328822">24</span>&nbsp;<span class="op" id="4328825">|</span>&nbsp;<span class="builtintype" id="4328827">uint32</span><span class="op" id="4328833">(</span><span class="ident" id="4328834">sbox1</span><span class="op" id="4328839">[</span><span class="ident" id="4328840">t2</span><span class="op" id="4328842">&gt;&gt;</span><span class="num" id="4328844">16</span><span class="op" id="4328846">&amp;</span><span class="num" id="4328847">0xff</span><span class="op" id="4328851">]</span><span class="op" id="4328852">)</span><span class="op" id="4328853">&lt;&lt;</span><span class="num" id="4328855">16</span>&nbsp;<span class="op" id="4328858">|</span>&nbsp;<span class="builtintype" id="4328860">uint32</span><span class="op" id="4328866">(</span><span class="ident" id="4328867">sbox1</span><span class="op" id="4328872">[</span><span class="ident" id="4328873">t1</span><span class="op" id="4328875">&gt;&gt;</span><span class="num" id="4328877">8</span><span class="op" id="4328878">&amp;</span><span class="num" id="4328879">0xff</span><span class="op" id="4328883">]</span><span class="op" id="4328884">)</span><span class="op" id="4328885">&lt;&lt;</span><span class="num" id="4328887">8</span>&nbsp;<span class="op" id="4328889">|</span>&nbsp;<span class="builtintype" id="4328891">uint32</span><span class="op" id="4328897">(</span><span class="ident" id="4328898">sbox1</span><span class="op" id="4328903">[</span><span class="ident" id="4328904">t0</span><span class="op" id="4328906">&amp;</span><span class="num" id="4328907">0xff</span><span class="op" id="4328911">]</span><span class="op" id="4328912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328916">s0</span>&nbsp;<span class="op" id="4328919">^=</span>&nbsp;<span class="ident" id="4328922">xk</span><span class="op" id="4328924">[</span><span class="ident" id="4328925">k</span><span class="op" id="4328926">+</span><span class="num" id="4328927">0</span><span class="op" id="4328928">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328931">s1</span>&nbsp;<span class="op" id="4328934">^=</span>&nbsp;<span class="ident" id="4328937">xk</span><span class="op" id="4328939">[</span><span class="ident" id="4328940">k</span><span class="op" id="4328941">+</span><span class="num" id="4328942">1</span><span class="op" id="4328943">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328946">s2</span>&nbsp;<span class="op" id="4328949">^=</span>&nbsp;<span class="ident" id="4328952">xk</span><span class="op" id="4328954">[</span><span class="ident" id="4328955">k</span><span class="op" id="4328956">+</span><span class="num" id="4328957">2</span><span class="op" id="4328958">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328961">s3</span>&nbsp;<span class="op" id="4328964">^=</span>&nbsp;<span class="ident" id="4328967">xk</span><span class="op" id="4328969">[</span><span class="ident" id="4328970">k</span><span class="op" id="4328971">+</span><span class="num" id="4328972">3</span><span class="op" id="4328973">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328977">dst</span><span class="op" id="4328980">[</span><span class="num" id="4328981">0</span><span class="op" id="4328982">]</span><span class="op" id="4328983">,</span>&nbsp;<span class="ident" id="4328985">dst</span><span class="op" id="4328988">[</span><span class="num" id="4328989">1</span><span class="op" id="4328990">]</span><span class="op" id="4328991">,</span>&nbsp;<span class="ident" id="4328993">dst</span><span class="op" id="4328996">[</span><span class="num" id="4328997">2</span><span class="op" id="4328998">]</span><span class="op" id="4328999">,</span>&nbsp;<span class="ident" id="4329001">dst</span><span class="op" id="4329004">[</span><span class="num" id="4329005">3</span><span class="op" id="4329006">]</span>&nbsp;<span class="op" id="4329008">=</span>&nbsp;<span class="builtintype" id="4329010">byte</span><span class="op" id="4329014">(</span><span class="ident" id="4329015">s0</span><span class="op" id="4329017">&gt;&gt;</span><span class="num" id="4329019">24</span><span class="op" id="4329021">)</span><span class="op" id="4329022">,</span>&nbsp;<span class="builtintype" id="4329024">byte</span><span class="op" id="4329028">(</span><span class="ident" id="4329029">s0</span><span class="op" id="4329031">&gt;&gt;</span><span class="num" id="4329033">16</span><span class="op" id="4329035">)</span><span class="op" id="4329036">,</span>&nbsp;<span class="builtintype" id="4329038">byte</span><span class="op" id="4329042">(</span><span class="ident" id="4329043">s0</span><span class="op" id="4329045">&gt;&gt;</span><span class="num" id="4329047">8</span><span class="op" id="4329048">)</span><span class="op" id="4329049">,</span>&nbsp;<span class="builtintype" id="4329051">byte</span><span class="op" id="4329055">(</span><span class="ident" id="4329056">s0</span><span class="op" id="4329058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329061">dst</span><span class="op" id="4329064">[</span><span class="num" id="4329065">4</span><span class="op" id="4329066">]</span><span class="op" id="4329067">,</span>&nbsp;<span class="ident" id="4329069">dst</span><span class="op" id="4329072">[</span><span class="num" id="4329073">5</span><span class="op" id="4329074">]</span><span class="op" id="4329075">,</span>&nbsp;<span class="ident" id="4329077">dst</span><span class="op" id="4329080">[</span><span class="num" id="4329081">6</span><span class="op" id="4329082">]</span><span class="op" id="4329083">,</span>&nbsp;<span class="ident" id="4329085">dst</span><span class="op" id="4329088">[</span><span class="num" id="4329089">7</span><span class="op" id="4329090">]</span>&nbsp;<span class="op" id="4329092">=</span>&nbsp;<span class="builtintype" id="4329094">byte</span><span class="op" id="4329098">(</span><span class="ident" id="4329099">s1</span><span class="op" id="4329101">&gt;&gt;</span><span class="num" id="4329103">24</span><span class="op" id="4329105">)</span><span class="op" id="4329106">,</span>&nbsp;<span class="builtintype" id="4329108">byte</span><span class="op" id="4329112">(</span><span class="ident" id="4329113">s1</span><span class="op" id="4329115">&gt;&gt;</span><span class="num" id="4329117">16</span><span class="op" id="4329119">)</span><span class="op" id="4329120">,</span>&nbsp;<span class="builtintype" id="4329122">byte</span><span class="op" id="4329126">(</span><span class="ident" id="4329127">s1</span><span class="op" id="4329129">&gt;&gt;</span><span class="num" id="4329131">8</span><span class="op" id="4329132">)</span><span class="op" id="4329133">,</span>&nbsp;<span class="builtintype" id="4329135">byte</span><span class="op" id="4329139">(</span><span class="ident" id="4329140">s1</span><span class="op" id="4329142">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329145">dst</span><span class="op" id="4329148">[</span><span class="num" id="4329149">8</span><span class="op" id="4329150">]</span><span class="op" id="4329151">,</span>&nbsp;<span class="ident" id="4329153">dst</span><span class="op" id="4329156">[</span><span class="num" id="4329157">9</span><span class="op" id="4329158">]</span><span class="op" id="4329159">,</span>&nbsp;<span class="ident" id="4329161">dst</span><span class="op" id="4329164">[</span><span class="num" id="4329165">10</span><span class="op" id="4329167">]</span><span class="op" id="4329168">,</span>&nbsp;<span class="ident" id="4329170">dst</span><span class="op" id="4329173">[</span><span class="num" id="4329174">11</span><span class="op" id="4329176">]</span>&nbsp;<span class="op" id="4329178">=</span>&nbsp;<span class="builtintype" id="4329180">byte</span><span class="op" id="4329184">(</span><span class="ident" id="4329185">s2</span><span class="op" id="4329187">&gt;&gt;</span><span class="num" id="4329189">24</span><span class="op" id="4329191">)</span><span class="op" id="4329192">,</span>&nbsp;<span class="builtintype" id="4329194">byte</span><span class="op" id="4329198">(</span><span class="ident" id="4329199">s2</span><span class="op" id="4329201">&gt;&gt;</span><span class="num" id="4329203">16</span><span class="op" id="4329205">)</span><span class="op" id="4329206">,</span>&nbsp;<span class="builtintype" id="4329208">byte</span><span class="op" id="4329212">(</span><span class="ident" id="4329213">s2</span><span class="op" id="4329215">&gt;&gt;</span><span class="num" id="4329217">8</span><span class="op" id="4329218">)</span><span class="op" id="4329219">,</span>&nbsp;<span class="builtintype" id="4329221">byte</span><span class="op" id="4329225">(</span><span class="ident" id="4329226">s2</span><span class="op" id="4329228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329231">dst</span><span class="op" id="4329234">[</span><span class="num" id="4329235">12</span><span class="op" id="4329237">]</span><span class="op" id="4329238">,</span>&nbsp;<span class="ident" id="4329240">dst</span><span class="op" id="4329243">[</span><span class="num" id="4329244">13</span><span class="op" id="4329246">]</span><span class="op" id="4329247">,</span>&nbsp;<span class="ident" id="4329249">dst</span><span class="op" id="4329252">[</span><span class="num" id="4329253">14</span><span class="op" id="4329255">]</span><span class="op" id="4329256">,</span>&nbsp;<span class="ident" id="4329258">dst</span><span class="op" id="4329261">[</span><span class="num" id="4329262">15</span><span class="op" id="4329264">]</span>&nbsp;<span class="op" id="4329266">=</span>&nbsp;<span class="builtintype" id="4329268">byte</span><span class="op" id="4329272">(</span><span class="ident" id="4329273">s3</span><span class="op" id="4329275">&gt;&gt;</span><span class="num" id="4329277">24</span><span class="op" id="4329279">)</span><span class="op" id="4329280">,</span>&nbsp;<span class="builtintype" id="4329282">byte</span><span class="op" id="4329286">(</span><span class="ident" id="4329287">s3</span><span class="op" id="4329289">&gt;&gt;</span><span class="num" id="4329291">16</span><span class="op" id="4329293">)</span><span class="op" id="4329294">,</span>&nbsp;<span class="builtintype" id="4329296">byte</span><span class="op" id="4329300">(</span><span class="ident" id="4329301">s3</span><span class="op" id="4329303">&gt;&gt;</span><span class="num" id="4329305">8</span><span class="op" id="4329306">)</span><span class="op" id="4329307">,</span>&nbsp;<span class="builtintype" id="4329309">byte</span><span class="op" id="4329313">(</span><span class="ident" id="4329314">s3</span><span class="op" id="4329316">)</span><br>
<span class="lineno"></span><span class="op" id="4329318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4329321">//&nbsp;Apply&nbsp;sbox0&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;w.</span><br>
<span class="lineno">130</span><span class="keyword" id="4329355">func</span>&nbsp;<span class="ident" id="4329360">subw</span><span class="op" id="4329364">(</span><span class="ident" id="4329365">w</span>&nbsp;<span class="builtintype" id="4329367">uint32</span><span class="op" id="4329373">)</span>&nbsp;<span class="builtintype" id="4329375">uint32</span>&nbsp;<span class="op" id="4329382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329385">return</span>&nbsp;<span class="builtintype" id="4329392">uint32</span><span class="op" id="4329398">(</span><span class="ident" id="4329399">sbox0</span><span class="op" id="4329404">[</span><span class="ident" id="4329405">w</span><span class="op" id="4329406">&gt;&gt;</span><span class="num" id="4329408">24</span><span class="op" id="4329410">]</span><span class="op" id="4329411">)</span><span class="op" id="4329412">&lt;&lt;</span><span class="num" id="4329414">24</span>&nbsp;<span class="op" id="4329417">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4329421">uint32</span><span class="op" id="4329427">(</span><span class="ident" id="4329428">sbox0</span><span class="op" id="4329433">[</span><span class="ident" id="4329434">w</span><span class="op" id="4329435">&gt;&gt;</span><span class="num" id="4329437">16</span><span class="op" id="4329439">&amp;</span><span class="num" id="4329440">0xff</span><span class="op" id="4329444">]</span><span class="op" id="4329445">)</span><span class="op" id="4329446">&lt;&lt;</span><span class="num" id="4329448">16</span>&nbsp;<span class="op" id="4329451">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4329455">uint32</span><span class="op" id="4329461">(</span><span class="ident" id="4329462">sbox0</span><span class="op" id="4329467">[</span><span class="ident" id="4329468">w</span><span class="op" id="4329469">&gt;&gt;</span><span class="num" id="4329471">8</span><span class="op" id="4329472">&amp;</span><span class="num" id="4329473">0xff</span><span class="op" id="4329477">]</span><span class="op" id="4329478">)</span><span class="op" id="4329479">&lt;&lt;</span><span class="num" id="4329481">8</span>&nbsp;<span class="op" id="4329483">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4329487">uint32</span><span class="op" id="4329493">(</span><span class="ident" id="4329494">sbox0</span><span class="op" id="4329499">[</span><span class="ident" id="4329500">w</span><span class="op" id="4329501">&amp;</span><span class="num" id="4329502">0xff</span><span class="op" id="4329506">]</span><span class="op" id="4329507">)</span><br>
<span class="lineno">135</span><span class="op" id="4329509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4329512">//&nbsp;Rotate</span><br>
<span class="lineno"></span><span class="keyword" id="4329522">func</span>&nbsp;<span class="ident" id="4329527">rotw</span><span class="op" id="4329531">(</span><span class="ident" id="4329532">w</span>&nbsp;<span class="builtintype" id="4329534">uint32</span><span class="op" id="4329540">)</span>&nbsp;<span class="builtintype" id="4329542">uint32</span>&nbsp;<span class="op" id="4329549">{</span>&nbsp;<span class="keyword" id="4329551">return</span>&nbsp;<span class="ident" id="4329558">w</span><span class="op" id="4329559">&lt;&lt;</span><span class="num" id="4329561">8</span>&nbsp;<span class="op" id="4329563">|</span>&nbsp;<span class="ident" id="4329565">w</span><span class="op" id="4329566">&gt;&gt;</span><span class="num" id="4329568">24</span>&nbsp;<span class="op" id="4329571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4329574">//&nbsp;Key&nbsp;expansion&nbsp;algorithm.&nbsp;&nbsp;See&nbsp;FIPS-197,&nbsp;Figure&nbsp;11.</span><br>
<span class="lineno"></span><span class="comment" id="4329628">//&nbsp;Their&nbsp;rcon[i]&nbsp;is&nbsp;our&nbsp;powx[i-1]&nbsp;&lt;&lt;&nbsp;24.</span><br>
<span class="lineno"></span><span class="keyword" id="4329669">func</span>&nbsp;<span class="ident" id="4329674">expandKeyGo</span><span class="op" id="4329685">(</span><span class="ident" id="4329686">key</span>&nbsp;<span class="op" id="4329690">[</span><span class="op" id="4329691">]</span><span class="builtintype" id="4329692">byte</span><span class="op" id="4329696">,</span>&nbsp;<span class="ident" id="4329698">enc</span><span class="op" id="4329701">,</span>&nbsp;<span class="ident" id="4329703">dec</span>&nbsp;<span class="op" id="4329707">[</span><span class="op" id="4329708">]</span><span class="builtintype" id="4329709">uint32</span><span class="op" id="4329715">)</span>&nbsp;<span class="op" id="4329717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4329720">//&nbsp;Encryption&nbsp;key&nbsp;setup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329746">var</span>&nbsp;<span class="ident" id="4329750">i</span>&nbsp;<span class="builtintype" id="4329752">int</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329757">nk</span>&nbsp;<span class="op" id="4329760">:=</span>&nbsp;<span class="builtinfunc" id="4329763">len</span><span class="op" id="4329766">(</span><span class="ident" id="4329767">key</span><span class="op" id="4329770">)</span>&nbsp;<span class="op" id="4329772">/</span>&nbsp;<span class="num" id="4329774">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329777">for</span>&nbsp;<span class="ident" id="4329781">i</span>&nbsp;<span class="op" id="4329783">=</span>&nbsp;<span class="num" id="4329785">0</span><span class="op" id="4329786">;</span>&nbsp;<span class="ident" id="4329788">i</span>&nbsp;<span class="op" id="4329790">&lt;</span>&nbsp;<span class="ident" id="4329792">nk</span><span class="op" id="4329794">;</span>&nbsp;<span class="ident" id="4329796">i</span><span class="op" id="4329797">++</span>&nbsp;<span class="op" id="4329800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329804">enc</span><span class="op" id="4329807">[</span><span class="ident" id="4329808">i</span><span class="op" id="4329809">]</span>&nbsp;<span class="op" id="4329811">=</span>&nbsp;<span class="builtintype" id="4329813">uint32</span><span class="op" id="4329819">(</span><span class="ident" id="4329820">key</span><span class="op" id="4329823">[</span><span class="num" id="4329824">4</span><span class="op" id="4329825">*</span><span class="ident" id="4329826">i</span><span class="op" id="4329827">]</span><span class="op" id="4329828">)</span><span class="op" id="4329829">&lt;&lt;</span><span class="num" id="4329831">24</span>&nbsp;<span class="op" id="4329834">|</span>&nbsp;<span class="builtintype" id="4329836">uint32</span><span class="op" id="4329842">(</span><span class="ident" id="4329843">key</span><span class="op" id="4329846">[</span><span class="num" id="4329847">4</span><span class="op" id="4329848">*</span><span class="ident" id="4329849">i</span><span class="op" id="4329850">+</span><span class="num" id="4329851">1</span><span class="op" id="4329852">]</span><span class="op" id="4329853">)</span><span class="op" id="4329854">&lt;&lt;</span><span class="num" id="4329856">16</span>&nbsp;<span class="op" id="4329859">|</span>&nbsp;<span class="builtintype" id="4329861">uint32</span><span class="op" id="4329867">(</span><span class="ident" id="4329868">key</span><span class="op" id="4329871">[</span><span class="num" id="4329872">4</span><span class="op" id="4329873">*</span><span class="ident" id="4329874">i</span><span class="op" id="4329875">+</span><span class="num" id="4329876">2</span><span class="op" id="4329877">]</span><span class="op" id="4329878">)</span><span class="op" id="4329879">&lt;&lt;</span><span class="num" id="4329881">8</span>&nbsp;<span class="op" id="4329883">|</span>&nbsp;<span class="builtintype" id="4329885">uint32</span><span class="op" id="4329891">(</span><span class="ident" id="4329892">key</span><span class="op" id="4329895">[</span><span class="num" id="4329896">4</span><span class="op" id="4329897">*</span><span class="ident" id="4329898">i</span><span class="op" id="4329899">+</span><span class="num" id="4329900">3</span><span class="op" id="4329901">]</span><span class="op" id="4329902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329908">for</span>&nbsp;<span class="op" id="4329912">;</span>&nbsp;<span class="ident" id="4329914">i</span>&nbsp;<span class="op" id="4329916">&lt;</span>&nbsp;<span class="builtinfunc" id="4329918">len</span><span class="op" id="4329921">(</span><span class="ident" id="4329922">enc</span><span class="op" id="4329925">)</span><span class="op" id="4329926">;</span>&nbsp;<span class="ident" id="4329928">i</span><span class="op" id="4329929">++</span>&nbsp;<span class="op" id="4329932">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329936">t</span>&nbsp;<span class="op" id="4329938">:=</span>&nbsp;<span class="ident" id="4329941">enc</span><span class="op" id="4329944">[</span><span class="ident" id="4329945">i</span><span class="op" id="4329946">-</span><span class="num" id="4329947">1</span><span class="op" id="4329948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329952">if</span>&nbsp;<span class="ident" id="4329955">i</span><span class="op" id="4329956">%</span><span class="ident" id="4329957">nk</span>&nbsp;<span class="op" id="4329960">==</span>&nbsp;<span class="num" id="4329963">0</span>&nbsp;<span class="op" id="4329965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329970">t</span>&nbsp;<span class="op" id="4329972">=</span>&nbsp;<span class="ident" id="4329974">subw</span><span class="op" id="4329978">(</span><span class="ident" id="4329979">rotw</span><span class="op" id="4329983">(</span><span class="ident" id="4329984">t</span><span class="op" id="4329985">)</span><span class="op" id="4329986">)</span>&nbsp;<span class="op" id="4329988">^</span>&nbsp;<span class="op" id="4329990">(</span><span class="builtintype" id="4329991">uint32</span><span class="op" id="4329997">(</span><span class="ident" id="4329998">powx</span><span class="op" id="4330002">[</span><span class="ident" id="4330003">i</span><span class="op" id="4330004">/</span><span class="ident" id="4330005">nk</span><span class="op" id="4330007">-</span><span class="num" id="4330008">1</span><span class="op" id="4330009">]</span><span class="op" id="4330010">)</span>&nbsp;<span class="op" id="4330012">&lt;&lt;</span>&nbsp;<span class="num" id="4330015">24</span><span class="op" id="4330017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330021">}</span>&nbsp;<span class="keyword" id="4330023">else</span>&nbsp;<span class="keyword" id="4330028">if</span>&nbsp;<span class="ident" id="4330031">nk</span>&nbsp;<span class="op" id="4330034">&gt;</span>&nbsp;<span class="num" id="4330036">6</span>&nbsp;<span class="op" id="4330038">&amp;&amp;</span>&nbsp;<span class="ident" id="4330041">i</span><span class="op" id="4330042">%</span><span class="ident" id="4330043">nk</span>&nbsp;<span class="op" id="4330046">==</span>&nbsp;<span class="num" id="4330049">4</span>&nbsp;<span class="op" id="4330051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330056">t</span>&nbsp;<span class="op" id="4330058">=</span>&nbsp;<span class="ident" id="4330060">subw</span><span class="op" id="4330064">(</span><span class="ident" id="4330065">t</span><span class="op" id="4330066">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330074">enc</span><span class="op" id="4330077">[</span><span class="ident" id="4330078">i</span><span class="op" id="4330079">]</span>&nbsp;<span class="op" id="4330081">=</span>&nbsp;<span class="ident" id="4330083">enc</span><span class="op" id="4330086">[</span><span class="ident" id="4330087">i</span><span class="op" id="4330088">-</span><span class="ident" id="4330089">nk</span><span class="op" id="4330091">]</span>&nbsp;<span class="op" id="4330093">^</span>&nbsp;<span class="ident" id="4330095">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4330102">//&nbsp;Derive&nbsp;decryption&nbsp;key&nbsp;from&nbsp;encryption&nbsp;key.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4330149">//&nbsp;Reverse&nbsp;the&nbsp;4-word&nbsp;round&nbsp;key&nbsp;sets&nbsp;from&nbsp;enc&nbsp;to&nbsp;produce&nbsp;dec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4330212">//&nbsp;All&nbsp;sets&nbsp;but&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;get&nbsp;the&nbsp;MixColumn&nbsp;transform&nbsp;applied.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330285">if</span>&nbsp;<span class="ident" id="4330288">dec</span>&nbsp;<span class="op" id="4330292">==</span>&nbsp;<span class="ident" id="4330295">nil</span>&nbsp;<span class="op" id="4330299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330303">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330311">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330314">n</span>&nbsp;<span class="op" id="4330316">:=</span>&nbsp;<span class="builtinfunc" id="4330319">len</span><span class="op" id="4330322">(</span><span class="ident" id="4330323">enc</span><span class="op" id="4330326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330329">for</span>&nbsp;<span class="ident" id="4330333">i</span>&nbsp;<span class="op" id="4330335">:=</span>&nbsp;<span class="num" id="4330338">0</span><span class="op" id="4330339">;</span>&nbsp;<span class="ident" id="4330341">i</span>&nbsp;<span class="op" id="4330343">&lt;</span>&nbsp;<span class="ident" id="4330345">n</span><span class="op" id="4330346">;</span>&nbsp;<span class="ident" id="4330348">i</span>&nbsp;<span class="op" id="4330350">+=</span>&nbsp;<span class="num" id="4330353">4</span>&nbsp;<span class="op" id="4330355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330359">ei</span>&nbsp;<span class="op" id="4330362">:=</span>&nbsp;<span class="ident" id="4330365">n</span>&nbsp;<span class="op" id="4330367">-</span>&nbsp;<span class="ident" id="4330369">i</span>&nbsp;<span class="op" id="4330371">-</span>&nbsp;<span class="num" id="4330373">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330377">for</span>&nbsp;<span class="ident" id="4330381">j</span>&nbsp;<span class="op" id="4330383">:=</span>&nbsp;<span class="num" id="4330386">0</span><span class="op" id="4330387">;</span>&nbsp;<span class="ident" id="4330389">j</span>&nbsp;<span class="op" id="4330391">&lt;</span>&nbsp;<span class="num" id="4330393">4</span><span class="op" id="4330394">;</span>&nbsp;<span class="ident" id="4330396">j</span><span class="op" id="4330397">++</span>&nbsp;<span class="op" id="4330400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330405">x</span>&nbsp;<span class="op" id="4330407">:=</span>&nbsp;<span class="ident" id="4330410">enc</span><span class="op" id="4330413">[</span><span class="ident" id="4330414">ei</span><span class="op" id="4330416">+</span><span class="ident" id="4330417">j</span><span class="op" id="4330418">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330423">if</span>&nbsp;<span class="ident" id="4330426">i</span>&nbsp;<span class="op" id="4330428">&gt;</span>&nbsp;<span class="num" id="4330430">0</span>&nbsp;<span class="op" id="4330432">&amp;&amp;</span>&nbsp;<span class="ident" id="4330435">i</span><span class="op" id="4330436">+</span><span class="num" id="4330437">4</span>&nbsp;<span class="op" id="4330439">&lt;</span>&nbsp;<span class="ident" id="4330441">n</span>&nbsp;<span class="op" id="4330443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330449">x</span>&nbsp;<span class="op" id="4330451">=</span>&nbsp;<span class="ident" id="4330453">td0</span><span class="op" id="4330456">[</span><span class="ident" id="4330457">sbox0</span><span class="op" id="4330462">[</span><span class="ident" id="4330463">x</span><span class="op" id="4330464">&gt;&gt;</span><span class="num" id="4330466">24</span><span class="op" id="4330468">]</span><span class="op" id="4330469">]</span>&nbsp;<span class="op" id="4330471">^</span>&nbsp;<span class="ident" id="4330473">td1</span><span class="op" id="4330476">[</span><span class="ident" id="4330477">sbox0</span><span class="op" id="4330482">[</span><span class="ident" id="4330483">x</span><span class="op" id="4330484">&gt;&gt;</span><span class="num" id="4330486">16</span><span class="op" id="4330488">&amp;</span><span class="num" id="4330489">0xff</span><span class="op" id="4330493">]</span><span class="op" id="4330494">]</span>&nbsp;<span class="op" id="4330496">^</span>&nbsp;<span class="ident" id="4330498">td2</span><span class="op" id="4330501">[</span><span class="ident" id="4330502">sbox0</span><span class="op" id="4330507">[</span><span class="ident" id="4330508">x</span><span class="op" id="4330509">&gt;&gt;</span><span class="num" id="4330511">8</span><span class="op" id="4330512">&amp;</span><span class="num" id="4330513">0xff</span><span class="op" id="4330517">]</span><span class="op" id="4330518">]</span>&nbsp;<span class="op" id="4330520">^</span>&nbsp;<span class="ident" id="4330522">td3</span><span class="op" id="4330525">[</span><span class="ident" id="4330526">sbox0</span><span class="op" id="4330531">[</span><span class="ident" id="4330532">x</span><span class="op" id="4330533">&amp;</span><span class="num" id="4330534">0xff</span><span class="op" id="4330538">]</span><span class="op" id="4330539">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330549">dec</span><span class="op" id="4330552">[</span><span class="ident" id="4330553">i</span><span class="op" id="4330554">+</span><span class="ident" id="4330555">j</span><span class="op" id="4330556">]</span>&nbsp;<span class="op" id="4330558">=</span>&nbsp;<span class="ident" id="4330560">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330564">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330567">}</span><br>
<span class="lineno"></span><span class="op" id="4330569">}</span>
</div>
</body>
</html>
