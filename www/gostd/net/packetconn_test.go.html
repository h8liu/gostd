<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8450790">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8450846">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8450900">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8450951">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="8451030">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451039">package</span>&nbsp;<span class="ident" id="8451047">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8451052">import</span>&nbsp;<span class="op" id="8451059">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8451062">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8451068">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8451079">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8451090">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8451101">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8451108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451111">func</span>&nbsp;<span class="ident" id="8451116">packetConnTestData</span><span class="op" id="8451134">(</span><span class="ident" id="8451135">t</span>&nbsp;<span class="op" id="8451137">*</span><span class="ident" id="8451138">testing</span><span class="op" id="8451145">.</span><span class="ident" id="8451146">T</span><span class="op" id="8451147">,</span>&nbsp;<span class="ident" id="8451149">net</span>&nbsp;<span class="builtintype" id="8451153">string</span><span class="op" id="8451159">,</span>&nbsp;<span class="ident" id="8451161">i</span>&nbsp;<span class="builtintype" id="8451163">int</span><span class="op" id="8451166">)</span>&nbsp;<span class="op" id="8451168">(</span><span class="op" id="8451169">[</span><span class="op" id="8451170">]</span><span class="builtintype" id="8451171">byte</span><span class="op" id="8451175">,</span>&nbsp;<span class="keyword" id="8451177">func</span><span class="op" id="8451181">(</span><span class="op" id="8451182">)</span><span class="op" id="8451183">)</span>&nbsp;<span class="op" id="8451185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451188">switch</span>&nbsp;<span class="ident" id="8451195">net</span>&nbsp;<span class="op" id="8451199">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451202">case</span>&nbsp;<span class="string" id="8451207">&#34;udp&#34;</span><span class="op" id="8451212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451216">return</span>&nbsp;<span class="op" id="8451223">[</span><span class="op" id="8451224">]</span><span class="builtintype" id="8451225">byte</span><span class="op" id="8451229">(</span><span class="string" id="8451230">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8451251">)</span><span class="op" id="8451252">,</span>&nbsp;<span class="ident" id="8451254">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451259">case</span>&nbsp;<span class="string" id="8451264">&#34;ip&#34;</span><span class="op" id="8451268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451272">if</span>&nbsp;<span class="ident" id="8451275">skip</span><span class="op" id="8451279">,</span>&nbsp;<span class="ident" id="8451281">skipmsg</span>&nbsp;<span class="op" id="8451289">:=</span>&nbsp;<span class="ident" id="8451292">skipRawSocketTest</span><span class="op" id="8451309">(</span><span class="ident" id="8451310">t</span><span class="op" id="8451311">)</span><span class="op" id="8451312">;</span>&nbsp;<span class="ident" id="8451314">skip</span>&nbsp;<span class="op" id="8451319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451324">return</span>&nbsp;<span class="ident" id="8451331">nil</span><span class="op" id="8451334">,</span>&nbsp;<span class="keyword" id="8451336">func</span><span class="op" id="8451340">(</span><span class="op" id="8451341">)</span>&nbsp;<span class="op" id="8451343">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451349">t</span><span class="op" id="8451350">.</span><span class="ident" id="8451351">Logf</span><span class="op" id="8451355">(</span><span class="ident" id="8451356">skipmsg</span><span class="op" id="8451363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451376">b</span><span class="op" id="8451377">,</span>&nbsp;<span class="ident" id="8451379">err</span>&nbsp;<span class="op" id="8451383">:=</span>&nbsp;<span class="op" id="8451386">(</span><span class="op" id="8451387">&amp;</span><span class="ident" id="8451388">icmpMessage</span><span class="op" id="8451399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451404">Type</span><span class="op" id="8451408">:</span>&nbsp;<span class="ident" id="8451410">icmpv4EchoRequest</span><span class="op" id="8451427">,</span>&nbsp;<span class="ident" id="8451429">Code</span><span class="op" id="8451433">:</span>&nbsp;<span class="num" id="8451435">0</span><span class="op" id="8451436">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451441">Body</span><span class="op" id="8451445">:</span>&nbsp;<span class="op" id="8451447">&amp;</span><span class="ident" id="8451448">icmpEcho</span><span class="op" id="8451456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451462">ID</span><span class="op" id="8451464">:</span>&nbsp;<span class="ident" id="8451466">os</span><span class="op" id="8451468">.</span><span class="ident" id="8451469">Getpid</span><span class="op" id="8451475">(</span><span class="op" id="8451476">)</span>&nbsp;<span class="op" id="8451478">&amp;</span>&nbsp;<span class="num" id="8451480">0xffff</span><span class="op" id="8451486">,</span>&nbsp;<span class="ident" id="8451488">Seq</span><span class="op" id="8451491">:</span>&nbsp;<span class="ident" id="8451493">i</span>&nbsp;<span class="op" id="8451495">+</span>&nbsp;<span class="num" id="8451497">1</span><span class="op" id="8451498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451504">Data</span><span class="op" id="8451508">:</span>&nbsp;<span class="op" id="8451510">[</span><span class="op" id="8451511">]</span><span class="builtintype" id="8451512">byte</span><span class="op" id="8451516">(</span><span class="string" id="8451517">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8451537">)</span><span class="op" id="8451538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451543">}</span><span class="op" id="8451544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451548">}</span><span class="op" id="8451549">)</span><span class="op" id="8451550">.</span><span class="ident" id="8451551">Marshal</span><span class="op" id="8451558">(</span><span class="op" id="8451559">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451563">if</span>&nbsp;<span class="ident" id="8451566">err</span>&nbsp;<span class="op" id="8451570">!=</span>&nbsp;<span class="ident" id="8451573">nil</span>&nbsp;<span class="op" id="8451577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451582">return</span>&nbsp;<span class="ident" id="8451589">nil</span><span class="op" id="8451592">,</span>&nbsp;<span class="keyword" id="8451594">func</span><span class="op" id="8451598">(</span><span class="op" id="8451599">)</span>&nbsp;<span class="op" id="8451601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451607">t</span><span class="op" id="8451608">.</span><span class="ident" id="8451609">Fatalf</span><span class="op" id="8451615">(</span><span class="string" id="8451616">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8451648">,</span>&nbsp;<span class="ident" id="8451650">err</span><span class="op" id="8451653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451662">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451666">return</span>&nbsp;<span class="ident" id="8451673">b</span><span class="op" id="8451674">,</span>&nbsp;<span class="ident" id="8451676">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451681">case</span>&nbsp;<span class="string" id="8451686">&#34;unixgram&#34;</span><span class="op" id="8451696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451700">switch</span>&nbsp;<span class="ident" id="8451707">runtime</span><span class="op" id="8451714">.</span><span class="ident" id="8451715">GOOS</span>&nbsp;<span class="op" id="8451720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451724">case</span>&nbsp;<span class="string" id="8451729">&#34;nacl&#34;</span><span class="op" id="8451735">,</span>&nbsp;<span class="string" id="8451737">&#34;plan9&#34;</span><span class="op" id="8451744">,</span>&nbsp;<span class="string" id="8451746">&#34;windows&#34;</span><span class="op" id="8451755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451760">return</span>&nbsp;<span class="ident" id="8451767">nil</span><span class="op" id="8451770">,</span>&nbsp;<span class="keyword" id="8451772">func</span><span class="op" id="8451776">(</span><span class="op" id="8451777">)</span>&nbsp;<span class="op" id="8451779">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451785">t</span><span class="op" id="8451786">.</span><span class="ident" id="8451787">Logf</span><span class="op" id="8451791">(</span><span class="string" id="8451792">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8451816">,</span>&nbsp;<span class="ident" id="8451818">net</span><span class="op" id="8451821">,</span>&nbsp;<span class="ident" id="8451823">runtime</span><span class="op" id="8451830">.</span><span class="ident" id="8451831">GOOS</span><span class="op" id="8451835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451844">default</span><span class="op" id="8451851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451856">return</span>&nbsp;<span class="op" id="8451863">[</span><span class="op" id="8451864">]</span><span class="builtintype" id="8451865">byte</span><span class="op" id="8451869">(</span><span class="string" id="8451870">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8451896">)</span><span class="op" id="8451897">,</span>&nbsp;<span class="ident" id="8451899">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451905">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451908">default</span><span class="op" id="8451915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451919">return</span>&nbsp;<span class="ident" id="8451926">nil</span><span class="op" id="8451929">,</span>&nbsp;<span class="keyword" id="8451931">func</span><span class="op" id="8451935">(</span><span class="op" id="8451936">)</span>&nbsp;<span class="op" id="8451938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451943">t</span><span class="op" id="8451944">.</span><span class="ident" id="8451945">Logf</span><span class="op" id="8451949">(</span><span class="string" id="8451950">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="8451968">,</span>&nbsp;<span class="ident" id="8451970">net</span><span class="op" id="8451973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451980">}</span><br>
<span class="lineno">55</span><span class="op" id="8451982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451985">var</span>&nbsp;<span class="ident" id="8451989">packetConnTests</span>&nbsp;<span class="op" id="8452005">=</span>&nbsp;<span class="op" id="8452007">[</span><span class="op" id="8452008">]</span><span class="keyword" id="8452009">struct</span>&nbsp;<span class="op" id="8452016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452019">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8452025">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452033">addr1</span>&nbsp;<span class="builtintype" id="8452039">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452047">addr2</span>&nbsp;<span class="builtintype" id="8452053">string</span><br>
<span class="lineno"></span><span class="op" id="8452060">}</span><span class="op" id="8452061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452064">{</span><span class="string" id="8452065">&#34;udp&#34;</span><span class="op" id="8452070">,</span>&nbsp;<span class="string" id="8452072">&#34;127.0.0.1:0&#34;</span><span class="op" id="8452085">,</span>&nbsp;<span class="string" id="8452087">&#34;127.0.0.1:0&#34;</span><span class="op" id="8452100">}</span><span class="op" id="8452101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452104">{</span><span class="string" id="8452105">&#34;ip:icmp&#34;</span><span class="op" id="8452114">,</span>&nbsp;<span class="string" id="8452116">&#34;127.0.0.1&#34;</span><span class="op" id="8452127">,</span>&nbsp;<span class="string" id="8452129">&#34;127.0.0.1&#34;</span><span class="op" id="8452140">}</span><span class="op" id="8452141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452144">{</span><span class="string" id="8452145">&#34;unixgram&#34;</span><span class="op" id="8452155">,</span>&nbsp;<span class="ident" id="8452157">testUnixAddr</span><span class="op" id="8452169">(</span><span class="op" id="8452170">)</span><span class="op" id="8452171">,</span>&nbsp;<span class="ident" id="8452173">testUnixAddr</span><span class="op" id="8452185">(</span><span class="op" id="8452186">)</span><span class="op" id="8452187">}</span><span class="op" id="8452188">,</span><br>
<span class="lineno">65</span><span class="op" id="8452190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8452193">func</span>&nbsp;<span class="ident" id="8452198">TestPacketConn</span><span class="op" id="8452212">(</span><span class="ident" id="8452213">t</span>&nbsp;<span class="op" id="8452215">*</span><span class="ident" id="8452216">testing</span><span class="op" id="8452223">.</span><span class="ident" id="8452224">T</span><span class="op" id="8452225">)</span>&nbsp;<span class="op" id="8452227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452230">closer</span>&nbsp;<span class="op" id="8452237">:=</span>&nbsp;<span class="keyword" id="8452240">func</span><span class="op" id="8452244">(</span><span class="ident" id="8452245">c</span>&nbsp;<span class="ident" id="8452247">PacketConn</span><span class="op" id="8452257">,</span>&nbsp;<span class="ident" id="8452259">net</span><span class="op" id="8452262">,</span>&nbsp;<span class="ident" id="8452264">addr1</span><span class="op" id="8452269">,</span>&nbsp;<span class="ident" id="8452271">addr2</span>&nbsp;<span class="builtintype" id="8452277">string</span><span class="op" id="8452283">)</span>&nbsp;<span class="op" id="8452285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452289">c</span><span class="op" id="8452290">.</span><span class="ident" id="8452291">Close</span><span class="op" id="8452296">(</span><span class="op" id="8452297">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452301">switch</span>&nbsp;<span class="ident" id="8452308">net</span>&nbsp;<span class="op" id="8452312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452316">case</span>&nbsp;<span class="string" id="8452321">&#34;unixgram&#34;</span><span class="op" id="8452331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452336">os</span><span class="op" id="8452338">.</span><span class="ident" id="8452339">Remove</span><span class="op" id="8452345">(</span><span class="ident" id="8452346">addr1</span><span class="op" id="8452351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452356">os</span><span class="op" id="8452358">.</span><span class="ident" id="8452359">Remove</span><span class="op" id="8452365">(</span><span class="ident" id="8452366">addr2</span><span class="op" id="8452371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452375">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452382">for</span>&nbsp;<span class="ident" id="8452386">i</span><span class="op" id="8452387">,</span>&nbsp;<span class="ident" id="8452389">tt</span>&nbsp;<span class="op" id="8452392">:=</span>&nbsp;<span class="keyword" id="8452395">range</span>&nbsp;<span class="ident" id="8452401">packetConnTests</span>&nbsp;<span class="op" id="8452417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452421">netstr</span>&nbsp;<span class="op" id="8452428">:=</span>&nbsp;<span class="ident" id="8452431">strings</span><span class="op" id="8452438">.</span><span class="ident" id="8452439">Split</span><span class="op" id="8452444">(</span><span class="ident" id="8452445">tt</span><span class="op" id="8452447">.</span><span class="ident" id="8452448">net</span><span class="op" id="8452451">,</span>&nbsp;<span class="string" id="8452453">&#34;:&#34;</span><span class="op" id="8452456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452460">wb</span><span class="op" id="8452462">,</span>&nbsp;<span class="ident" id="8452464">skipOrFatalFn</span>&nbsp;<span class="op" id="8452478">:=</span>&nbsp;<span class="ident" id="8452481">packetConnTestData</span><span class="op" id="8452499">(</span><span class="ident" id="8452500">t</span><span class="op" id="8452501">,</span>&nbsp;<span class="ident" id="8452503">netstr</span><span class="op" id="8452509">[</span><span class="num" id="8452510">0</span><span class="op" id="8452511">]</span><span class="op" id="8452512">,</span>&nbsp;<span class="ident" id="8452514">i</span><span class="op" id="8452515">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452519">if</span>&nbsp;<span class="ident" id="8452522">skipOrFatalFn</span>&nbsp;<span class="op" id="8452536">!=</span>&nbsp;<span class="ident" id="8452539">nil</span>&nbsp;<span class="op" id="8452543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452548">skipOrFatalFn</span><span class="op" id="8452561">(</span><span class="op" id="8452562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452583">c1</span><span class="op" id="8452585">,</span>&nbsp;<span class="ident" id="8452587">err</span>&nbsp;<span class="op" id="8452591">:=</span>&nbsp;<span class="ident" id="8452594">ListenPacket</span><span class="op" id="8452606">(</span><span class="ident" id="8452607">tt</span><span class="op" id="8452609">.</span><span class="ident" id="8452610">net</span><span class="op" id="8452613">,</span>&nbsp;<span class="ident" id="8452615">tt</span><span class="op" id="8452617">.</span><span class="ident" id="8452618">addr1</span><span class="op" id="8452623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452627">if</span>&nbsp;<span class="ident" id="8452630">err</span>&nbsp;<span class="op" id="8452634">!=</span>&nbsp;<span class="ident" id="8452637">nil</span>&nbsp;<span class="op" id="8452641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452646">t</span><span class="op" id="8452647">.</span><span class="ident" id="8452648">Fatalf</span><span class="op" id="8452654">(</span><span class="string" id="8452655">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8452680">,</span>&nbsp;<span class="ident" id="8452682">err</span><span class="op" id="8452685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452693">defer</span>&nbsp;<span class="ident" id="8452699">closer</span><span class="op" id="8452705">(</span><span class="ident" id="8452706">c1</span><span class="op" id="8452708">,</span>&nbsp;<span class="ident" id="8452710">netstr</span><span class="op" id="8452716">[</span><span class="num" id="8452717">0</span><span class="op" id="8452718">]</span><span class="op" id="8452719">,</span>&nbsp;<span class="ident" id="8452721">tt</span><span class="op" id="8452723">.</span><span class="ident" id="8452724">addr1</span><span class="op" id="8452729">,</span>&nbsp;<span class="ident" id="8452731">tt</span><span class="op" id="8452733">.</span><span class="ident" id="8452734">addr2</span><span class="op" id="8452739">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452743">c1</span><span class="op" id="8452745">.</span><span class="ident" id="8452746">LocalAddr</span><span class="op" id="8452755">(</span><span class="op" id="8452756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452760">c1</span><span class="op" id="8452762">.</span><span class="ident" id="8452763">SetDeadline</span><span class="op" id="8452774">(</span><span class="ident" id="8452775">time</span><span class="op" id="8452779">.</span><span class="ident" id="8452780">Now</span><span class="op" id="8452783">(</span><span class="op" id="8452784">)</span><span class="op" id="8452785">.</span><span class="ident" id="8452786">Add</span><span class="op" id="8452789">(</span><span class="num" id="8452790">100</span>&nbsp;<span class="op" id="8452794">*</span>&nbsp;<span class="ident" id="8452796">time</span><span class="op" id="8452800">.</span><span class="ident" id="8452801">Millisecond</span><span class="op" id="8452812">)</span><span class="op" id="8452813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452817">c1</span><span class="op" id="8452819">.</span><span class="ident" id="8452820">SetReadDeadline</span><span class="op" id="8452835">(</span><span class="ident" id="8452836">time</span><span class="op" id="8452840">.</span><span class="ident" id="8452841">Now</span><span class="op" id="8452844">(</span><span class="op" id="8452845">)</span><span class="op" id="8452846">.</span><span class="ident" id="8452847">Add</span><span class="op" id="8452850">(</span><span class="num" id="8452851">100</span>&nbsp;<span class="op" id="8452855">*</span>&nbsp;<span class="ident" id="8452857">time</span><span class="op" id="8452861">.</span><span class="ident" id="8452862">Millisecond</span><span class="op" id="8452873">)</span><span class="op" id="8452874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452878">c1</span><span class="op" id="8452880">.</span><span class="ident" id="8452881">SetWriteDeadline</span><span class="op" id="8452897">(</span><span class="ident" id="8452898">time</span><span class="op" id="8452902">.</span><span class="ident" id="8452903">Now</span><span class="op" id="8452906">(</span><span class="op" id="8452907">)</span><span class="op" id="8452908">.</span><span class="ident" id="8452909">Add</span><span class="op" id="8452912">(</span><span class="num" id="8452913">100</span>&nbsp;<span class="op" id="8452917">*</span>&nbsp;<span class="ident" id="8452919">time</span><span class="op" id="8452923">.</span><span class="ident" id="8452924">Millisecond</span><span class="op" id="8452935">)</span><span class="op" id="8452936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452941">c2</span><span class="op" id="8452943">,</span>&nbsp;<span class="ident" id="8452945">err</span>&nbsp;<span class="op" id="8452949">:=</span>&nbsp;<span class="ident" id="8452952">ListenPacket</span><span class="op" id="8452964">(</span><span class="ident" id="8452965">tt</span><span class="op" id="8452967">.</span><span class="ident" id="8452968">net</span><span class="op" id="8452971">,</span>&nbsp;<span class="ident" id="8452973">tt</span><span class="op" id="8452975">.</span><span class="ident" id="8452976">addr2</span><span class="op" id="8452981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452985">if</span>&nbsp;<span class="ident" id="8452988">err</span>&nbsp;<span class="op" id="8452992">!=</span>&nbsp;<span class="ident" id="8452995">nil</span>&nbsp;<span class="op" id="8452999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453004">t</span><span class="op" id="8453005">.</span><span class="ident" id="8453006">Fatalf</span><span class="op" id="8453012">(</span><span class="string" id="8453013">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8453038">,</span>&nbsp;<span class="ident" id="8453040">err</span><span class="op" id="8453043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453051">defer</span>&nbsp;<span class="ident" id="8453057">closer</span><span class="op" id="8453063">(</span><span class="ident" id="8453064">c2</span><span class="op" id="8453066">,</span>&nbsp;<span class="ident" id="8453068">netstr</span><span class="op" id="8453074">[</span><span class="num" id="8453075">0</span><span class="op" id="8453076">]</span><span class="op" id="8453077">,</span>&nbsp;<span class="ident" id="8453079">tt</span><span class="op" id="8453081">.</span><span class="ident" id="8453082">addr1</span><span class="op" id="8453087">,</span>&nbsp;<span class="ident" id="8453089">tt</span><span class="op" id="8453091">.</span><span class="ident" id="8453092">addr2</span><span class="op" id="8453097">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453101">c2</span><span class="op" id="8453103">.</span><span class="ident" id="8453104">LocalAddr</span><span class="op" id="8453113">(</span><span class="op" id="8453114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453118">c2</span><span class="op" id="8453120">.</span><span class="ident" id="8453121">SetDeadline</span><span class="op" id="8453132">(</span><span class="ident" id="8453133">time</span><span class="op" id="8453137">.</span><span class="ident" id="8453138">Now</span><span class="op" id="8453141">(</span><span class="op" id="8453142">)</span><span class="op" id="8453143">.</span><span class="ident" id="8453144">Add</span><span class="op" id="8453147">(</span><span class="num" id="8453148">100</span>&nbsp;<span class="op" id="8453152">*</span>&nbsp;<span class="ident" id="8453154">time</span><span class="op" id="8453158">.</span><span class="ident" id="8453159">Millisecond</span><span class="op" id="8453170">)</span><span class="op" id="8453171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453175">c2</span><span class="op" id="8453177">.</span><span class="ident" id="8453178">SetReadDeadline</span><span class="op" id="8453193">(</span><span class="ident" id="8453194">time</span><span class="op" id="8453198">.</span><span class="ident" id="8453199">Now</span><span class="op" id="8453202">(</span><span class="op" id="8453203">)</span><span class="op" id="8453204">.</span><span class="ident" id="8453205">Add</span><span class="op" id="8453208">(</span><span class="num" id="8453209">100</span>&nbsp;<span class="op" id="8453213">*</span>&nbsp;<span class="ident" id="8453215">time</span><span class="op" id="8453219">.</span><span class="ident" id="8453220">Millisecond</span><span class="op" id="8453231">)</span><span class="op" id="8453232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453236">c2</span><span class="op" id="8453238">.</span><span class="ident" id="8453239">SetWriteDeadline</span><span class="op" id="8453255">(</span><span class="ident" id="8453256">time</span><span class="op" id="8453260">.</span><span class="ident" id="8453261">Now</span><span class="op" id="8453264">(</span><span class="op" id="8453265">)</span><span class="op" id="8453266">.</span><span class="ident" id="8453267">Add</span><span class="op" id="8453270">(</span><span class="num" id="8453271">100</span>&nbsp;<span class="op" id="8453275">*</span>&nbsp;<span class="ident" id="8453277">time</span><span class="op" id="8453281">.</span><span class="ident" id="8453282">Millisecond</span><span class="op" id="8453293">)</span><span class="op" id="8453294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453299">if</span>&nbsp;<span class="ident" id="8453302">_</span><span class="op" id="8453303">,</span>&nbsp;<span class="ident" id="8453305">err</span>&nbsp;<span class="op" id="8453309">:=</span>&nbsp;<span class="ident" id="8453312">c1</span><span class="op" id="8453314">.</span><span class="ident" id="8453315">WriteTo</span><span class="op" id="8453322">(</span><span class="ident" id="8453323">wb</span><span class="op" id="8453325">,</span>&nbsp;<span class="ident" id="8453327">c2</span><span class="op" id="8453329">.</span><span class="ident" id="8453330">LocalAddr</span><span class="op" id="8453339">(</span><span class="op" id="8453340">)</span><span class="op" id="8453341">)</span><span class="op" id="8453342">;</span>&nbsp;<span class="ident" id="8453344">err</span>&nbsp;<span class="op" id="8453348">!=</span>&nbsp;<span class="ident" id="8453351">nil</span>&nbsp;<span class="op" id="8453355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453360">t</span><span class="op" id="8453361">.</span><span class="ident" id="8453362">Fatalf</span><span class="op" id="8453368">(</span><span class="string" id="8453369">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8453400">,</span>&nbsp;<span class="ident" id="8453402">err</span><span class="op" id="8453405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453413">rb2</span>&nbsp;<span class="op" id="8453417">:=</span>&nbsp;<span class="builtinfunc" id="8453420">make</span><span class="op" id="8453424">(</span><span class="op" id="8453425">[</span><span class="op" id="8453426">]</span><span class="builtintype" id="8453427">byte</span><span class="op" id="8453431">,</span>&nbsp;<span class="num" id="8453433">128</span><span class="op" id="8453436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453440">if</span>&nbsp;<span class="ident" id="8453443">_</span><span class="op" id="8453444">,</span>&nbsp;<span class="ident" id="8453446">_</span><span class="op" id="8453447">,</span>&nbsp;<span class="ident" id="8453449">err</span>&nbsp;<span class="op" id="8453453">:=</span>&nbsp;<span class="ident" id="8453456">c2</span><span class="op" id="8453458">.</span><span class="ident" id="8453459">ReadFrom</span><span class="op" id="8453467">(</span><span class="ident" id="8453468">rb2</span><span class="op" id="8453471">)</span><span class="op" id="8453472">;</span>&nbsp;<span class="ident" id="8453474">err</span>&nbsp;<span class="op" id="8453478">!=</span>&nbsp;<span class="ident" id="8453481">nil</span>&nbsp;<span class="op" id="8453485">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453490">t</span><span class="op" id="8453491">.</span><span class="ident" id="8453492">Fatalf</span><span class="op" id="8453498">(</span><span class="string" id="8453499">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8453531">,</span>&nbsp;<span class="ident" id="8453533">err</span><span class="op" id="8453536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453544">if</span>&nbsp;<span class="ident" id="8453547">_</span><span class="op" id="8453548">,</span>&nbsp;<span class="ident" id="8453550">err</span>&nbsp;<span class="op" id="8453554">:=</span>&nbsp;<span class="ident" id="8453557">c2</span><span class="op" id="8453559">.</span><span class="ident" id="8453560">WriteTo</span><span class="op" id="8453567">(</span><span class="ident" id="8453568">wb</span><span class="op" id="8453570">,</span>&nbsp;<span class="ident" id="8453572">c1</span><span class="op" id="8453574">.</span><span class="ident" id="8453575">LocalAddr</span><span class="op" id="8453584">(</span><span class="op" id="8453585">)</span><span class="op" id="8453586">)</span><span class="op" id="8453587">;</span>&nbsp;<span class="ident" id="8453589">err</span>&nbsp;<span class="op" id="8453593">!=</span>&nbsp;<span class="ident" id="8453596">nil</span>&nbsp;<span class="op" id="8453600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453605">t</span><span class="op" id="8453606">.</span><span class="ident" id="8453607">Fatalf</span><span class="op" id="8453613">(</span><span class="string" id="8453614">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8453645">,</span>&nbsp;<span class="ident" id="8453647">err</span><span class="op" id="8453650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453654">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453658">rb1</span>&nbsp;<span class="op" id="8453662">:=</span>&nbsp;<span class="builtinfunc" id="8453665">make</span><span class="op" id="8453669">(</span><span class="op" id="8453670">[</span><span class="op" id="8453671">]</span><span class="builtintype" id="8453672">byte</span><span class="op" id="8453676">,</span>&nbsp;<span class="num" id="8453678">128</span><span class="op" id="8453681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453685">if</span>&nbsp;<span class="ident" id="8453688">_</span><span class="op" id="8453689">,</span>&nbsp;<span class="ident" id="8453691">_</span><span class="op" id="8453692">,</span>&nbsp;<span class="ident" id="8453694">err</span>&nbsp;<span class="op" id="8453698">:=</span>&nbsp;<span class="ident" id="8453701">c1</span><span class="op" id="8453703">.</span><span class="ident" id="8453704">ReadFrom</span><span class="op" id="8453712">(</span><span class="ident" id="8453713">rb1</span><span class="op" id="8453716">)</span><span class="op" id="8453717">;</span>&nbsp;<span class="ident" id="8453719">err</span>&nbsp;<span class="op" id="8453723">!=</span>&nbsp;<span class="ident" id="8453726">nil</span>&nbsp;<span class="op" id="8453730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453735">t</span><span class="op" id="8453736">.</span><span class="ident" id="8453737">Fatalf</span><span class="op" id="8453743">(</span><span class="string" id="8453744">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8453776">,</span>&nbsp;<span class="ident" id="8453778">err</span><span class="op" id="8453781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453788">}</span><br>
<span class="lineno">120</span><span class="op" id="8453790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8453793">func</span>&nbsp;<span class="ident" id="8453798">TestConnAndPacketConn</span><span class="op" id="8453819">(</span><span class="ident" id="8453820">t</span>&nbsp;<span class="op" id="8453822">*</span><span class="ident" id="8453823">testing</span><span class="op" id="8453830">.</span><span class="ident" id="8453831">T</span><span class="op" id="8453832">)</span>&nbsp;<span class="op" id="8453834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453837">closer</span>&nbsp;<span class="op" id="8453844">:=</span>&nbsp;<span class="keyword" id="8453847">func</span><span class="op" id="8453851">(</span><span class="ident" id="8453852">c</span>&nbsp;<span class="ident" id="8453854">PacketConn</span><span class="op" id="8453864">,</span>&nbsp;<span class="ident" id="8453866">net</span><span class="op" id="8453869">,</span>&nbsp;<span class="ident" id="8453871">addr1</span><span class="op" id="8453876">,</span>&nbsp;<span class="ident" id="8453878">addr2</span>&nbsp;<span class="builtintype" id="8453884">string</span><span class="op" id="8453890">)</span>&nbsp;<span class="op" id="8453892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453896">c</span><span class="op" id="8453897">.</span><span class="ident" id="8453898">Close</span><span class="op" id="8453903">(</span><span class="op" id="8453904">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453908">switch</span>&nbsp;<span class="ident" id="8453915">net</span>&nbsp;<span class="op" id="8453919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453923">case</span>&nbsp;<span class="string" id="8453928">&#34;unixgram&#34;</span><span class="op" id="8453938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453943">os</span><span class="op" id="8453945">.</span><span class="ident" id="8453946">Remove</span><span class="op" id="8453952">(</span><span class="ident" id="8453953">addr1</span><span class="op" id="8453958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453963">os</span><span class="op" id="8453965">.</span><span class="ident" id="8453966">Remove</span><span class="op" id="8453972">(</span><span class="ident" id="8453973">addr2</span><span class="op" id="8453978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453982">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453989">for</span>&nbsp;<span class="ident" id="8453993">i</span><span class="op" id="8453994">,</span>&nbsp;<span class="ident" id="8453996">tt</span>&nbsp;<span class="op" id="8453999">:=</span>&nbsp;<span class="keyword" id="8454002">range</span>&nbsp;<span class="ident" id="8454008">packetConnTests</span>&nbsp;<span class="op" id="8454024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454028">var</span>&nbsp;<span class="ident" id="8454032">wb</span>&nbsp;<span class="op" id="8454035">[</span><span class="op" id="8454036">]</span><span class="builtintype" id="8454037">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454044">netstr</span>&nbsp;<span class="op" id="8454051">:=</span>&nbsp;<span class="ident" id="8454054">strings</span><span class="op" id="8454061">.</span><span class="ident" id="8454062">Split</span><span class="op" id="8454067">(</span><span class="ident" id="8454068">tt</span><span class="op" id="8454070">.</span><span class="ident" id="8454071">net</span><span class="op" id="8454074">,</span>&nbsp;<span class="string" id="8454076">&#34;:&#34;</span><span class="op" id="8454079">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454083">wb</span><span class="op" id="8454085">,</span>&nbsp;<span class="ident" id="8454087">skipOrFatalFn</span>&nbsp;<span class="op" id="8454101">:=</span>&nbsp;<span class="ident" id="8454104">packetConnTestData</span><span class="op" id="8454122">(</span><span class="ident" id="8454123">t</span><span class="op" id="8454124">,</span>&nbsp;<span class="ident" id="8454126">netstr</span><span class="op" id="8454132">[</span><span class="num" id="8454133">0</span><span class="op" id="8454134">]</span><span class="op" id="8454135">,</span>&nbsp;<span class="ident" id="8454137">i</span><span class="op" id="8454138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454142">if</span>&nbsp;<span class="ident" id="8454145">skipOrFatalFn</span>&nbsp;<span class="op" id="8454159">!=</span>&nbsp;<span class="ident" id="8454162">nil</span>&nbsp;<span class="op" id="8454166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454171">skipOrFatalFn</span><span class="op" id="8454184">(</span><span class="op" id="8454185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454190">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454201">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454206">c1</span><span class="op" id="8454208">,</span>&nbsp;<span class="ident" id="8454210">err</span>&nbsp;<span class="op" id="8454214">:=</span>&nbsp;<span class="ident" id="8454217">ListenPacket</span><span class="op" id="8454229">(</span><span class="ident" id="8454230">tt</span><span class="op" id="8454232">.</span><span class="ident" id="8454233">net</span><span class="op" id="8454236">,</span>&nbsp;<span class="ident" id="8454238">tt</span><span class="op" id="8454240">.</span><span class="ident" id="8454241">addr1</span><span class="op" id="8454246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454250">if</span>&nbsp;<span class="ident" id="8454253">err</span>&nbsp;<span class="op" id="8454257">!=</span>&nbsp;<span class="ident" id="8454260">nil</span>&nbsp;<span class="op" id="8454264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454269">t</span><span class="op" id="8454270">.</span><span class="ident" id="8454271">Fatalf</span><span class="op" id="8454277">(</span><span class="string" id="8454278">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8454303">,</span>&nbsp;<span class="ident" id="8454305">err</span><span class="op" id="8454308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454312">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454316">defer</span>&nbsp;<span class="ident" id="8454322">closer</span><span class="op" id="8454328">(</span><span class="ident" id="8454329">c1</span><span class="op" id="8454331">,</span>&nbsp;<span class="ident" id="8454333">netstr</span><span class="op" id="8454339">[</span><span class="num" id="8454340">0</span><span class="op" id="8454341">]</span><span class="op" id="8454342">,</span>&nbsp;<span class="ident" id="8454344">tt</span><span class="op" id="8454346">.</span><span class="ident" id="8454347">addr1</span><span class="op" id="8454352">,</span>&nbsp;<span class="ident" id="8454354">tt</span><span class="op" id="8454356">.</span><span class="ident" id="8454357">addr2</span><span class="op" id="8454362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454366">c1</span><span class="op" id="8454368">.</span><span class="ident" id="8454369">LocalAddr</span><span class="op" id="8454378">(</span><span class="op" id="8454379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454383">c1</span><span class="op" id="8454385">.</span><span class="ident" id="8454386">SetDeadline</span><span class="op" id="8454397">(</span><span class="ident" id="8454398">time</span><span class="op" id="8454402">.</span><span class="ident" id="8454403">Now</span><span class="op" id="8454406">(</span><span class="op" id="8454407">)</span><span class="op" id="8454408">.</span><span class="ident" id="8454409">Add</span><span class="op" id="8454412">(</span><span class="num" id="8454413">100</span>&nbsp;<span class="op" id="8454417">*</span>&nbsp;<span class="ident" id="8454419">time</span><span class="op" id="8454423">.</span><span class="ident" id="8454424">Millisecond</span><span class="op" id="8454435">)</span><span class="op" id="8454436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454440">c1</span><span class="op" id="8454442">.</span><span class="ident" id="8454443">SetReadDeadline</span><span class="op" id="8454458">(</span><span class="ident" id="8454459">time</span><span class="op" id="8454463">.</span><span class="ident" id="8454464">Now</span><span class="op" id="8454467">(</span><span class="op" id="8454468">)</span><span class="op" id="8454469">.</span><span class="ident" id="8454470">Add</span><span class="op" id="8454473">(</span><span class="num" id="8454474">100</span>&nbsp;<span class="op" id="8454478">*</span>&nbsp;<span class="ident" id="8454480">time</span><span class="op" id="8454484">.</span><span class="ident" id="8454485">Millisecond</span><span class="op" id="8454496">)</span><span class="op" id="8454497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454501">c1</span><span class="op" id="8454503">.</span><span class="ident" id="8454504">SetWriteDeadline</span><span class="op" id="8454520">(</span><span class="ident" id="8454521">time</span><span class="op" id="8454525">.</span><span class="ident" id="8454526">Now</span><span class="op" id="8454529">(</span><span class="op" id="8454530">)</span><span class="op" id="8454531">.</span><span class="ident" id="8454532">Add</span><span class="op" id="8454535">(</span><span class="num" id="8454536">100</span>&nbsp;<span class="op" id="8454540">*</span>&nbsp;<span class="ident" id="8454542">time</span><span class="op" id="8454546">.</span><span class="ident" id="8454547">Millisecond</span><span class="op" id="8454558">)</span><span class="op" id="8454559">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454564">c2</span><span class="op" id="8454566">,</span>&nbsp;<span class="ident" id="8454568">err</span>&nbsp;<span class="op" id="8454572">:=</span>&nbsp;<span class="ident" id="8454575">Dial</span><span class="op" id="8454579">(</span><span class="ident" id="8454580">tt</span><span class="op" id="8454582">.</span><span class="ident" id="8454583">net</span><span class="op" id="8454586">,</span>&nbsp;<span class="ident" id="8454588">c1</span><span class="op" id="8454590">.</span><span class="ident" id="8454591">LocalAddr</span><span class="op" id="8454600">(</span><span class="op" id="8454601">)</span><span class="op" id="8454602">.</span><span class="ident" id="8454603">String</span><span class="op" id="8454609">(</span><span class="op" id="8454610">)</span><span class="op" id="8454611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454615">if</span>&nbsp;<span class="ident" id="8454618">err</span>&nbsp;<span class="op" id="8454622">!=</span>&nbsp;<span class="ident" id="8454625">nil</span>&nbsp;<span class="op" id="8454629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454634">t</span><span class="op" id="8454635">.</span><span class="ident" id="8454636">Fatalf</span><span class="op" id="8454642">(</span><span class="string" id="8454643">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8454660">,</span>&nbsp;<span class="ident" id="8454662">err</span><span class="op" id="8454665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454669">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454673">defer</span>&nbsp;<span class="ident" id="8454679">c2</span><span class="op" id="8454681">.</span><span class="ident" id="8454682">Close</span><span class="op" id="8454687">(</span><span class="op" id="8454688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454692">c2</span><span class="op" id="8454694">.</span><span class="ident" id="8454695">LocalAddr</span><span class="op" id="8454704">(</span><span class="op" id="8454705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454709">c2</span><span class="op" id="8454711">.</span><span class="ident" id="8454712">RemoteAddr</span><span class="op" id="8454722">(</span><span class="op" id="8454723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454727">c2</span><span class="op" id="8454729">.</span><span class="ident" id="8454730">SetDeadline</span><span class="op" id="8454741">(</span><span class="ident" id="8454742">time</span><span class="op" id="8454746">.</span><span class="ident" id="8454747">Now</span><span class="op" id="8454750">(</span><span class="op" id="8454751">)</span><span class="op" id="8454752">.</span><span class="ident" id="8454753">Add</span><span class="op" id="8454756">(</span><span class="num" id="8454757">100</span>&nbsp;<span class="op" id="8454761">*</span>&nbsp;<span class="ident" id="8454763">time</span><span class="op" id="8454767">.</span><span class="ident" id="8454768">Millisecond</span><span class="op" id="8454779">)</span><span class="op" id="8454780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454784">c2</span><span class="op" id="8454786">.</span><span class="ident" id="8454787">SetReadDeadline</span><span class="op" id="8454802">(</span><span class="ident" id="8454803">time</span><span class="op" id="8454807">.</span><span class="ident" id="8454808">Now</span><span class="op" id="8454811">(</span><span class="op" id="8454812">)</span><span class="op" id="8454813">.</span><span class="ident" id="8454814">Add</span><span class="op" id="8454817">(</span><span class="num" id="8454818">100</span>&nbsp;<span class="op" id="8454822">*</span>&nbsp;<span class="ident" id="8454824">time</span><span class="op" id="8454828">.</span><span class="ident" id="8454829">Millisecond</span><span class="op" id="8454840">)</span><span class="op" id="8454841">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454845">c2</span><span class="op" id="8454847">.</span><span class="ident" id="8454848">SetWriteDeadline</span><span class="op" id="8454864">(</span><span class="ident" id="8454865">time</span><span class="op" id="8454869">.</span><span class="ident" id="8454870">Now</span><span class="op" id="8454873">(</span><span class="op" id="8454874">)</span><span class="op" id="8454875">.</span><span class="ident" id="8454876">Add</span><span class="op" id="8454879">(</span><span class="num" id="8454880">100</span>&nbsp;<span class="op" id="8454884">*</span>&nbsp;<span class="ident" id="8454886">time</span><span class="op" id="8454890">.</span><span class="ident" id="8454891">Millisecond</span><span class="op" id="8454902">)</span><span class="op" id="8454903">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454908">if</span>&nbsp;<span class="ident" id="8454911">_</span><span class="op" id="8454912">,</span>&nbsp;<span class="ident" id="8454914">err</span>&nbsp;<span class="op" id="8454918">:=</span>&nbsp;<span class="ident" id="8454921">c2</span><span class="op" id="8454923">.</span><span class="ident" id="8454924">Write</span><span class="op" id="8454929">(</span><span class="ident" id="8454930">wb</span><span class="op" id="8454932">)</span><span class="op" id="8454933">;</span>&nbsp;<span class="ident" id="8454935">err</span>&nbsp;<span class="op" id="8454939">!=</span>&nbsp;<span class="ident" id="8454942">nil</span>&nbsp;<span class="op" id="8454946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454951">t</span><span class="op" id="8454952">.</span><span class="ident" id="8454953">Fatalf</span><span class="op" id="8454959">(</span><span class="string" id="8454960">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8454983">,</span>&nbsp;<span class="ident" id="8454985">err</span><span class="op" id="8454988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454992">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454996">rb1</span>&nbsp;<span class="op" id="8455000">:=</span>&nbsp;<span class="builtinfunc" id="8455003">make</span><span class="op" id="8455007">(</span><span class="op" id="8455008">[</span><span class="op" id="8455009">]</span><span class="builtintype" id="8455010">byte</span><span class="op" id="8455014">,</span>&nbsp;<span class="num" id="8455016">128</span><span class="op" id="8455019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455023">if</span>&nbsp;<span class="ident" id="8455026">_</span><span class="op" id="8455027">,</span>&nbsp;<span class="ident" id="8455029">_</span><span class="op" id="8455030">,</span>&nbsp;<span class="ident" id="8455032">err</span>&nbsp;<span class="op" id="8455036">:=</span>&nbsp;<span class="ident" id="8455039">c1</span><span class="op" id="8455041">.</span><span class="ident" id="8455042">ReadFrom</span><span class="op" id="8455050">(</span><span class="ident" id="8455051">rb1</span><span class="op" id="8455054">)</span><span class="op" id="8455055">;</span>&nbsp;<span class="ident" id="8455057">err</span>&nbsp;<span class="op" id="8455061">!=</span>&nbsp;<span class="ident" id="8455064">nil</span>&nbsp;<span class="op" id="8455068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455073">t</span><span class="op" id="8455074">.</span><span class="ident" id="8455075">Fatalf</span><span class="op" id="8455081">(</span><span class="string" id="8455082">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8455114">,</span>&nbsp;<span class="ident" id="8455116">err</span><span class="op" id="8455119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455127">var</span>&nbsp;<span class="ident" id="8455131">dst</span>&nbsp;<span class="ident" id="8455135">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455142">switch</span>&nbsp;<span class="ident" id="8455149">netstr</span><span class="op" id="8455155">[</span><span class="num" id="8455156">0</span><span class="op" id="8455157">]</span>&nbsp;<span class="op" id="8455159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455163">case</span>&nbsp;<span class="string" id="8455168">&#34;ip&#34;</span><span class="op" id="8455172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455177">dst</span>&nbsp;<span class="op" id="8455181">=</span>&nbsp;<span class="op" id="8455183">&amp;</span><span class="ident" id="8455184">IPAddr</span><span class="op" id="8455190">{</span><span class="ident" id="8455191">IP</span><span class="op" id="8455193">:</span>&nbsp;<span class="ident" id="8455195">IPv4</span><span class="op" id="8455199">(</span><span class="num" id="8455200">127</span><span class="op" id="8455203">,</span>&nbsp;<span class="num" id="8455205">0</span><span class="op" id="8455206">,</span>&nbsp;<span class="num" id="8455208">0</span><span class="op" id="8455209">,</span>&nbsp;<span class="num" id="8455211">1</span><span class="op" id="8455212">)</span><span class="op" id="8455213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455217">case</span>&nbsp;<span class="string" id="8455222">&#34;unixgram&#34;</span><span class="op" id="8455232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455237">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455248">default</span><span class="op" id="8455255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455260">dst</span>&nbsp;<span class="op" id="8455264">=</span>&nbsp;<span class="ident" id="8455266">c2</span><span class="op" id="8455268">.</span><span class="ident" id="8455269">LocalAddr</span><span class="op" id="8455278">(</span><span class="op" id="8455279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455287">if</span>&nbsp;<span class="ident" id="8455290">_</span><span class="op" id="8455291">,</span>&nbsp;<span class="ident" id="8455293">err</span>&nbsp;<span class="op" id="8455297">:=</span>&nbsp;<span class="ident" id="8455300">c1</span><span class="op" id="8455302">.</span><span class="ident" id="8455303">WriteTo</span><span class="op" id="8455310">(</span><span class="ident" id="8455311">wb</span><span class="op" id="8455313">,</span>&nbsp;<span class="ident" id="8455315">dst</span><span class="op" id="8455318">)</span><span class="op" id="8455319">;</span>&nbsp;<span class="ident" id="8455321">err</span>&nbsp;<span class="op" id="8455325">!=</span>&nbsp;<span class="ident" id="8455328">nil</span>&nbsp;<span class="op" id="8455332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455337">t</span><span class="op" id="8455338">.</span><span class="ident" id="8455339">Fatalf</span><span class="op" id="8455345">(</span><span class="string" id="8455346">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8455377">,</span>&nbsp;<span class="ident" id="8455379">err</span><span class="op" id="8455382">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455390">rb2</span>&nbsp;<span class="op" id="8455394">:=</span>&nbsp;<span class="builtinfunc" id="8455397">make</span><span class="op" id="8455401">(</span><span class="op" id="8455402">[</span><span class="op" id="8455403">]</span><span class="builtintype" id="8455404">byte</span><span class="op" id="8455408">,</span>&nbsp;<span class="num" id="8455410">128</span><span class="op" id="8455413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455417">if</span>&nbsp;<span class="ident" id="8455420">_</span><span class="op" id="8455421">,</span>&nbsp;<span class="ident" id="8455423">err</span>&nbsp;<span class="op" id="8455427">:=</span>&nbsp;<span class="ident" id="8455430">c2</span><span class="op" id="8455432">.</span><span class="ident" id="8455433">Read</span><span class="op" id="8455437">(</span><span class="ident" id="8455438">rb2</span><span class="op" id="8455441">)</span><span class="op" id="8455442">;</span>&nbsp;<span class="ident" id="8455444">err</span>&nbsp;<span class="op" id="8455448">!=</span>&nbsp;<span class="ident" id="8455451">nil</span>&nbsp;<span class="op" id="8455455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455460">t</span><span class="op" id="8455461">.</span><span class="ident" id="8455462">Fatalf</span><span class="op" id="8455468">(</span><span class="string" id="8455469">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8455491">,</span>&nbsp;<span class="ident" id="8455493">err</span><span class="op" id="8455496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455500">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455503">}</span><br>
<span class="lineno"></span><span class="op" id="8455505">}</span>
</div>
</body>
</html>
