<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1460930">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1460985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1461039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1461090">package</span>&nbsp;<span class="ident" id="1461098">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1461104">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1461164">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="1461229">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="1461287">//</span><br>
<span class="lineno"></span><span class="comment" id="1461290">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="1461307">//</span><br>
<span class="lineno"></span><span class="comment" id="1461310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1461333">//</span><br>
<span class="lineno">15</span><span class="comment" id="1461336">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1461349">//</span><br>
<span class="lineno"></span><span class="comment" id="1461352">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="1461378">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="1461401">//</span><br>
<span class="lineno">20</span><span class="comment" id="1461404">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1461424">//</span><br>
<span class="lineno"></span><span class="comment" id="1461427">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1461443">//</span><br>
<span class="lineno"></span><span class="comment" id="1461446">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="1461504">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="1461557">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="1461614">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="1461674">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="1461696">//</span><br>
<span class="lineno">30</span><span class="comment" id="1461699">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1461765">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1461825">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="1461887">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="1461948">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="1461973">//</span><br>
<span class="lineno"></span><span class="comment" id="1461976">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1461989">//</span><br>
<span class="lineno"></span><span class="comment" id="1461992">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1462032">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1462090">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="1462150">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="1462210">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1462270">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1462330">//</span><br>
<span class="lineno">45</span><span class="comment" id="1462333">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="1462394">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="1462455">//</span><br>
<span class="lineno"></span><span class="comment" id="1462458">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="1462506">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="1462570">//</span><br>
<span class="lineno"></span><span class="comment" id="1462573">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1462634">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1462704">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="1462779">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="1462846">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1462919">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1462991">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1463005">//</span><br>
<span class="lineno"></span><span class="comment" id="1463008">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="1463074">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1463140">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1463153">//</span><br>
<span class="lineno"></span><span class="comment" id="1463156">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1463180">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1463210">var</span>&nbsp;<span class="ident" id="1463214">_gamP</span>&nbsp;<span class="op" id="1463220">=</span>&nbsp;<span class="op" id="1463222">[</span><span class="op" id="1463223">...</span><span class="op" id="1463226">]</span><span class="builtintype" id="1463227">float64</span><span class="op" id="1463234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463237">1.60119522476751861407e-04</span><span class="op" id="1463263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463266">1.19135147006586384913e-03</span><span class="op" id="1463292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463295">1.04213797561761569935e-02</span><span class="op" id="1463321">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463324">4.76367800457137231464e-02</span><span class="op" id="1463350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463353">2.07448227648435975150e-01</span><span class="op" id="1463379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463382">4.94214826801497100753e-01</span><span class="op" id="1463408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463411">9.99999999999999996796e-01</span><span class="op" id="1463437">,</span><br>
<span class="lineno"></span><span class="op" id="1463439">}</span><br>
<span class="lineno">75</span><span class="keyword" id="1463441">var</span>&nbsp;<span class="ident" id="1463445">_gamQ</span>&nbsp;<span class="op" id="1463451">=</span>&nbsp;<span class="op" id="1463453">[</span><span class="op" id="1463454">...</span><span class="op" id="1463457">]</span><span class="builtintype" id="1463458">float64</span><span class="op" id="1463465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1463468">-</span><span class="num" id="1463469">2.31581873324120129819e-05</span><span class="op" id="1463495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463498">5.39605580493303397842e-04</span><span class="op" id="1463524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1463527">-</span><span class="num" id="1463528">4.45641913851797240494e-03</span><span class="op" id="1463554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463557">1.18139785222060435552e-02</span><span class="op" id="1463583">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463586">3.58236398605498653373e-02</span><span class="op" id="1463612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1463615">-</span><span class="num" id="1463616">2.34591795718243348568e-01</span><span class="op" id="1463642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463645">7.14304917030273074085e-02</span><span class="op" id="1463671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463674">1.00000000000000000320e+00</span><span class="op" id="1463700">,</span><br>
<span class="lineno"></span><span class="op" id="1463702">}</span><br>
<span class="lineno">85</span><span class="keyword" id="1463704">var</span>&nbsp;<span class="ident" id="1463708">_gamS</span>&nbsp;<span class="op" id="1463714">=</span>&nbsp;<span class="op" id="1463716">[</span><span class="op" id="1463717">...</span><span class="op" id="1463720">]</span><span class="builtintype" id="1463721">float64</span><span class="op" id="1463728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463731">7.87311395793093628397e-04</span><span class="op" id="1463757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1463760">-</span><span class="num" id="1463761">2.29549961613378126380e-04</span><span class="op" id="1463787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1463790">-</span><span class="num" id="1463791">2.68132617805781232825e-03</span><span class="op" id="1463817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463820">3.47222221605458667310e-03</span><span class="op" id="1463846">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1463849">8.33333333333482257126e-02</span><span class="op" id="1463875">,</span><br>
<span class="lineno"></span><span class="op" id="1463877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1463880">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="1463930">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="1463977">func</span>&nbsp;<span class="ident" id="1463982">stirling</span><span class="op" id="1463990">(</span><span class="ident" id="1463991">x</span>&nbsp;<span class="builtintype" id="1463993">float64</span><span class="op" id="1464000">)</span>&nbsp;<span class="builtintype" id="1464002">float64</span>&nbsp;<span class="op" id="1464010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464013">const</span>&nbsp;<span class="op" id="1464019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464023">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1464035">=</span>&nbsp;<span class="num" id="1464037">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464063">MaxStirling</span>&nbsp;<span class="op" id="1464075">=</span>&nbsp;<span class="num" id="1464077">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464088">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464091">w</span>&nbsp;<span class="op" id="1464093">:=</span>&nbsp;<span class="num" id="1464096">1</span>&nbsp;<span class="op" id="1464098">/</span>&nbsp;<span class="ident" id="1464100"><a href="/math/gamma.go.html#1463991">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464103"><a href="/math/gamma.go.html#1464091">w</a></span>&nbsp;<span class="op" id="1464105">=</span>&nbsp;<span class="num" id="1464107">1</span>&nbsp;<span class="op" id="1464109">+</span>&nbsp;<span class="ident" id="1464111"><a href="/math/gamma.go.html#1464091">w</a></span><span class="op" id="1464112">*</span><span class="op" id="1464113">(</span><span class="op" id="1464114">(</span><span class="op" id="1464115">(</span><span class="op" id="1464116">(</span><span class="ident" id="1464117"><a href="/math/gamma.go.html#1463708">_gamS</a></span><span class="op" id="1464122">[</span><span class="num" id="1464123">0</span><span class="op" id="1464124">]</span><span class="op" id="1464125">*</span><span class="ident" id="1464126"><a href="/math/gamma.go.html#1464091">w</a></span><span class="op" id="1464127">+</span><span class="ident" id="1464128"><a href="/math/gamma.go.html#1463708">_gamS</a></span><span class="op" id="1464133">[</span><span class="num" id="1464134">1</span><span class="op" id="1464135">]</span><span class="op" id="1464136">)</span><span class="op" id="1464137">*</span><span class="ident" id="1464138"><a href="/math/gamma.go.html#1464091">w</a></span><span class="op" id="1464139">+</span><span class="ident" id="1464140"><a href="/math/gamma.go.html#1463708">_gamS</a></span><span class="op" id="1464145">[</span><span class="num" id="1464146">2</span><span class="op" id="1464147">]</span><span class="op" id="1464148">)</span><span class="op" id="1464149">*</span><span class="ident" id="1464150"><a href="/math/gamma.go.html#1464091">w</a></span><span class="op" id="1464151">+</span><span class="ident" id="1464152"><a href="/math/gamma.go.html#1463708">_gamS</a></span><span class="op" id="1464157">[</span><span class="num" id="1464158">3</span><span class="op" id="1464159">]</span><span class="op" id="1464160">)</span><span class="op" id="1464161">*</span><span class="ident" id="1464162"><a href="/math/gamma.go.html#1464091">w</a></span><span class="op" id="1464163">+</span><span class="ident" id="1464164"><a href="/math/gamma.go.html#1463708">_gamS</a></span><span class="op" id="1464169">[</span><span class="num" id="1464170">4</span><span class="op" id="1464171">]</span><span class="op" id="1464172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464175">y</span>&nbsp;<span class="op" id="1464177">:=</span>&nbsp;<span class="ident" id="1464180"><a href="/math/exp.go.html#1445907">Exp</a></span><span class="op" id="1464183">(</span><span class="ident" id="1464184"><a href="/math/gamma.go.html#1463991">x</a></span><span class="op" id="1464185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464188">if</span>&nbsp;<span class="ident" id="1464191"><a href="/math/gamma.go.html#1463991">x</a></span>&nbsp;<span class="op" id="1464193">&gt;</span>&nbsp;<span class="ident" id="1464195"><a href="/math/gamma.go.html#1464063">MaxStirling</a></span>&nbsp;<span class="op" id="1464207">{</span>&nbsp;<span class="comment" id="1464209">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464235">v</span>&nbsp;<span class="op" id="1464237">:=</span>&nbsp;<span class="ident" id="1464240"><a href="/math/pow.go.html#1529921">Pow</a></span><span class="op" id="1464243">(</span><span class="ident" id="1464244"><a href="/math/gamma.go.html#1463991">x</a></span><span class="op" id="1464245">,</span>&nbsp;<span class="num" id="1464247">0.5</span><span class="op" id="1464250">*</span><span class="ident" id="1464251"><a href="/math/gamma.go.html#1463991">x</a></span><span class="op" id="1464252">-</span><span class="num" id="1464253">0.25</span><span class="op" id="1464257">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464261"><a href="/math/gamma.go.html#1464175">y</a></span>&nbsp;<span class="op" id="1464263">=</span>&nbsp;<span class="ident" id="1464265"><a href="/math/gamma.go.html#1464235">v</a></span>&nbsp;<span class="op" id="1464267">*</span>&nbsp;<span class="op" id="1464269">(</span><span class="ident" id="1464270"><a href="/math/gamma.go.html#1464235">v</a></span>&nbsp;<span class="op" id="1464272">/</span>&nbsp;<span class="ident" id="1464274"><a href="/math/gamma.go.html#1464175">y</a></span><span class="op" id="1464275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464278">}</span>&nbsp;<span class="keyword" id="1464280">else</span>&nbsp;<span class="op" id="1464285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464289"><a href="/math/gamma.go.html#1464175">y</a></span>&nbsp;<span class="op" id="1464291">=</span>&nbsp;<span class="ident" id="1464293"><a href="/math/pow.go.html#1529921">Pow</a></span><span class="op" id="1464296">(</span><span class="ident" id="1464297"><a href="/math/gamma.go.html#1463991">x</a></span><span class="op" id="1464298">,</span>&nbsp;<span class="ident" id="1464300"><a href="/math/gamma.go.html#1463991">x</a></span><span class="op" id="1464301">-</span><span class="num" id="1464302">0.5</span><span class="op" id="1464305">)</span>&nbsp;<span class="op" id="1464307">/</span>&nbsp;<span class="ident" id="1464309"><a href="/math/gamma.go.html#1464175">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464315"><a href="/math/gamma.go.html#1464175">y</a></span>&nbsp;<span class="op" id="1464317">=</span>&nbsp;<span class="ident" id="1464319"><a href="/math/gamma.go.html#1464023">SqrtTwoPi</a></span>&nbsp;<span class="op" id="1464329">*</span>&nbsp;<span class="ident" id="1464331"><a href="/math/gamma.go.html#1464175">y</a></span>&nbsp;<span class="op" id="1464333">*</span>&nbsp;<span class="ident" id="1464335"><a href="/math/gamma.go.html#1464091">w</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464338">return</span>&nbsp;<span class="ident" id="1464345"><a href="/math/gamma.go.html#1464175">y</a></span><br>
<span class="lineno"></span><span class="op" id="1464347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1464350">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1464392">//</span><br>
<span class="lineno">115</span><span class="comment" id="1464395">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1464417">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1464439">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1464459">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1464479">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="1464515">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1464536">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1464556">func</span>&nbsp;<span class="ident" id="1464561">Gamma</span><span class="op" id="1464566">(</span><span class="ident" id="1464567">x</span>&nbsp;<span class="builtintype" id="1464569">float64</span><span class="op" id="1464576">)</span>&nbsp;<span class="builtintype" id="1464578">float64</span>&nbsp;<span class="op" id="1464586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464589">const</span>&nbsp;<span class="ident" id="1464595">Euler</span>&nbsp;<span class="op" id="1464601">=</span>&nbsp;<span class="num" id="1464603">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="1464656">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1464668">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464686">switch</span>&nbsp;<span class="op" id="1464693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464696">case</span>&nbsp;<span class="ident" id="1464701"><a href="/math/gamma.go.html#1465793">isNegInt</a></span><span class="op" id="1464709">(</span><span class="ident" id="1464710"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464711">)</span>&nbsp;<span class="op" id="1464713">||</span>&nbsp;<span class="ident" id="1464716"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1464721">(</span><span class="ident" id="1464722"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464723">,</span>&nbsp;<span class="op" id="1464725">-</span><span class="num" id="1464726">1</span><span class="op" id="1464727">)</span>&nbsp;<span class="op" id="1464729">||</span>&nbsp;<span class="ident" id="1464732"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1464737">(</span><span class="ident" id="1464738"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464739">)</span><span class="op" id="1464740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464744">return</span>&nbsp;<span class="ident" id="1464751"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1464754">(</span><span class="op" id="1464755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464758">case</span>&nbsp;<span class="ident" id="1464763"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1464765">==</span>&nbsp;<span class="num" id="1464768">0</span><span class="op" id="1464769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464773">if</span>&nbsp;<span class="ident" id="1464776"><a href="/math/signbit.go.html#1534414">Signbit</a></span><span class="op" id="1464783">(</span><span class="ident" id="1464784"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464785">)</span>&nbsp;<span class="op" id="1464787">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464792">return</span>&nbsp;<span class="ident" id="1464799"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1464802">(</span><span class="op" id="1464803">-</span><span class="num" id="1464804">1</span><span class="op" id="1464805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464813">return</span>&nbsp;<span class="ident" id="1464820"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1464823">(</span><span class="num" id="1464824">1</span><span class="op" id="1464825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464828">case</span>&nbsp;<span class="ident" id="1464833"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1464835">&lt;</span>&nbsp;<span class="op" id="1464837">-</span><span class="num" id="1464838">170.5674972726612</span>&nbsp;<span class="op" id="1464856">||</span>&nbsp;<span class="ident" id="1464859"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1464861">&gt;</span>&nbsp;<span class="num" id="1464863">171.61447887182298</span><span class="op" id="1464881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464885">return</span>&nbsp;<span class="ident" id="1464892"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1464895">(</span><span class="num" id="1464896">1</span><span class="op" id="1464897">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464903">q</span>&nbsp;<span class="op" id="1464905">:=</span>&nbsp;<span class="ident" id="1464908"><a href="/math/abs.go.html#1415452">Abs</a></span><span class="op" id="1464911">(</span><span class="ident" id="1464912"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464916">p</span>&nbsp;<span class="op" id="1464918">:=</span>&nbsp;<span class="ident" id="1464921"><a href="/math/floor.go.html#1459326">Floor</a></span><span class="op" id="1464926">(</span><span class="ident" id="1464927"><a href="/math/gamma.go.html#1464903">q</a></span><span class="op" id="1464928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464931">if</span>&nbsp;<span class="ident" id="1464934"><a href="/math/gamma.go.html#1464903">q</a></span>&nbsp;<span class="op" id="1464936">&gt;</span>&nbsp;<span class="num" id="1464938">33</span>&nbsp;<span class="op" id="1464941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464945">if</span>&nbsp;<span class="ident" id="1464948"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1464950">&gt;=</span>&nbsp;<span class="num" id="1464953">0</span>&nbsp;<span class="op" id="1464955">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1464960">return</span>&nbsp;<span class="ident" id="1464967"><a href="/math/gamma.go.html#1463982">stirling</a></span><span class="op" id="1464975">(</span><span class="ident" id="1464976"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1464977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1464981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1464985">signgam</span>&nbsp;<span class="op" id="1464993">:=</span>&nbsp;<span class="num" id="1464996">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465000">if</span>&nbsp;<span class="ident" id="1465003">ip</span>&nbsp;<span class="op" id="1465006">:=</span>&nbsp;<span class="builtintype" id="1465009">int</span><span class="op" id="1465012">(</span><span class="ident" id="1465013"><a href="/math/gamma.go.html#1464916">p</a></span><span class="op" id="1465014">)</span><span class="op" id="1465015">;</span>&nbsp;<span class="ident" id="1465017"><a href="/math/gamma.go.html#1465003">ip</a></span><span class="op" id="1465019">&amp;</span><span class="num" id="1465020">1</span>&nbsp;<span class="op" id="1465022">==</span>&nbsp;<span class="num" id="1465025">0</span>&nbsp;<span class="op" id="1465027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465032"><a href="/math/gamma.go.html#1464985">signgam</a></span>&nbsp;<span class="op" id="1465040">=</span>&nbsp;<span class="op" id="1465042">-</span><span class="num" id="1465043">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465051">z</span>&nbsp;<span class="op" id="1465053">:=</span>&nbsp;<span class="ident" id="1465056"><a href="/math/gamma.go.html#1464903">q</a></span>&nbsp;<span class="op" id="1465058">-</span>&nbsp;<span class="ident" id="1465060"><a href="/math/gamma.go.html#1464916">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465064">if</span>&nbsp;<span class="ident" id="1465067"><a href="/math/gamma.go.html#1465051">z</a></span>&nbsp;<span class="op" id="1465069">&gt;</span>&nbsp;<span class="num" id="1465071">0.5</span>&nbsp;<span class="op" id="1465075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465080"><a href="/math/gamma.go.html#1464916">p</a></span>&nbsp;<span class="op" id="1465082">=</span>&nbsp;<span class="ident" id="1465084"><a href="/math/gamma.go.html#1464916">p</a></span>&nbsp;<span class="op" id="1465086">+</span>&nbsp;<span class="num" id="1465088">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465093"><a href="/math/gamma.go.html#1465051">z</a></span>&nbsp;<span class="op" id="1465095">=</span>&nbsp;<span class="ident" id="1465097"><a href="/math/gamma.go.html#1464903">q</a></span>&nbsp;<span class="op" id="1465099">-</span>&nbsp;<span class="ident" id="1465101"><a href="/math/gamma.go.html#1464916">p</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465109"><a href="/math/gamma.go.html#1465051">z</a></span>&nbsp;<span class="op" id="1465111">=</span>&nbsp;<span class="ident" id="1465113"><a href="/math/gamma.go.html#1464903">q</a></span>&nbsp;<span class="op" id="1465115">*</span>&nbsp;<span class="ident" id="1465117"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1465120">(</span><span class="ident" id="1465121"><a href="/math/const.go.html#1430552">Pi</a></span><span class="op" id="1465123">*</span><span class="ident" id="1465124"><a href="/math/gamma.go.html#1465051">z</a></span><span class="op" id="1465125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465129">if</span>&nbsp;<span class="ident" id="1465132"><a href="/math/gamma.go.html#1465051">z</a></span>&nbsp;<span class="op" id="1465134">==</span>&nbsp;<span class="num" id="1465137">0</span>&nbsp;<span class="op" id="1465139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465144">return</span>&nbsp;<span class="ident" id="1465151"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1465154">(</span><span class="ident" id="1465155"><a href="/math/gamma.go.html#1464985">signgam</a></span><span class="op" id="1465162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465166">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465170"><a href="/math/gamma.go.html#1465051">z</a></span>&nbsp;<span class="op" id="1465172">=</span>&nbsp;<span class="ident" id="1465174"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1465177">/</span>&nbsp;<span class="op" id="1465179">(</span><span class="ident" id="1465180"><a href="/math/abs.go.html#1415452">Abs</a></span><span class="op" id="1465183">(</span><span class="ident" id="1465184"><a href="/math/gamma.go.html#1465051">z</a></span><span class="op" id="1465185">)</span>&nbsp;<span class="op" id="1465187">*</span>&nbsp;<span class="ident" id="1465189"><a href="/math/gamma.go.html#1463982">stirling</a></span><span class="op" id="1465197">(</span><span class="ident" id="1465198"><a href="/math/gamma.go.html#1464903">q</a></span><span class="op" id="1465199">)</span><span class="op" id="1465200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465204">return</span>&nbsp;<span class="builtintype" id="1465211">float64</span><span class="op" id="1465218">(</span><span class="ident" id="1465219"><a href="/math/gamma.go.html#1464985">signgam</a></span><span class="op" id="1465226">)</span>&nbsp;<span class="op" id="1465228">*</span>&nbsp;<span class="ident" id="1465230"><a href="/math/gamma.go.html#1465051">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1465237">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465257">z</span>&nbsp;<span class="op" id="1465259">:=</span>&nbsp;<span class="num" id="1465262">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465267">for</span>&nbsp;<span class="ident" id="1465271"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465273">&gt;=</span>&nbsp;<span class="num" id="1465276">3</span>&nbsp;<span class="op" id="1465278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465282"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465284">=</span>&nbsp;<span class="ident" id="1465286"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465288">-</span>&nbsp;<span class="num" id="1465290">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465294"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465296">=</span>&nbsp;<span class="ident" id="1465298"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465300">*</span>&nbsp;<span class="ident" id="1465302"><a href="/math/gamma.go.html#1464567">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465305">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465308">for</span>&nbsp;<span class="ident" id="1465312"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465314">&lt;</span>&nbsp;<span class="num" id="1465316">0</span>&nbsp;<span class="op" id="1465318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465322">if</span>&nbsp;<span class="ident" id="1465325"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465327">&gt;</span>&nbsp;<span class="op" id="1465329">-</span><span class="num" id="1465330">1e-09</span>&nbsp;<span class="op" id="1465336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465341">goto</span>&nbsp;<span class="ident" id="1465346">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465358"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465360">=</span>&nbsp;<span class="ident" id="1465362"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465364">/</span>&nbsp;<span class="ident" id="1465366"><a href="/math/gamma.go.html#1464567">x</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465370"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465372">=</span>&nbsp;<span class="ident" id="1465374"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465376">+</span>&nbsp;<span class="num" id="1465378">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465384">for</span>&nbsp;<span class="ident" id="1465388"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465390">&lt;</span>&nbsp;<span class="num" id="1465392">2</span>&nbsp;<span class="op" id="1465394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465398">if</span>&nbsp;<span class="ident" id="1465401"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465403">&lt;</span>&nbsp;<span class="num" id="1465405">1e-09</span>&nbsp;<span class="op" id="1465411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465416">goto</span>&nbsp;<span class="ident" id="1465421">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465433"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465435">=</span>&nbsp;<span class="ident" id="1465437"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465439">/</span>&nbsp;<span class="ident" id="1465441"><a href="/math/gamma.go.html#1464567">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465445"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465447">=</span>&nbsp;<span class="ident" id="1465449"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465451">+</span>&nbsp;<span class="num" id="1465453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465460">if</span>&nbsp;<span class="ident" id="1465463"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465465">==</span>&nbsp;<span class="num" id="1465468">2</span>&nbsp;<span class="op" id="1465470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465474">return</span>&nbsp;<span class="ident" id="1465481"><a href="/math/gamma.go.html#1465257">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465488"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465490">=</span>&nbsp;<span class="ident" id="1465492"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465494">-</span>&nbsp;<span class="num" id="1465496">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465499"><a href="/math/gamma.go.html#1464916">p</a></span>&nbsp;<span class="op" id="1465501">=</span>&nbsp;<span class="op" id="1465503">(</span><span class="op" id="1465504">(</span><span class="op" id="1465505">(</span><span class="op" id="1465506">(</span><span class="op" id="1465507">(</span><span class="ident" id="1465508"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465509">*</span><span class="ident" id="1465510"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465515">[</span><span class="num" id="1465516">0</span><span class="op" id="1465517">]</span><span class="op" id="1465518">+</span><span class="ident" id="1465519"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465524">[</span><span class="num" id="1465525">1</span><span class="op" id="1465526">]</span><span class="op" id="1465527">)</span><span class="op" id="1465528">*</span><span class="ident" id="1465529"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465530">+</span><span class="ident" id="1465531"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465536">[</span><span class="num" id="1465537">2</span><span class="op" id="1465538">]</span><span class="op" id="1465539">)</span><span class="op" id="1465540">*</span><span class="ident" id="1465541"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465542">+</span><span class="ident" id="1465543"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465548">[</span><span class="num" id="1465549">3</span><span class="op" id="1465550">]</span><span class="op" id="1465551">)</span><span class="op" id="1465552">*</span><span class="ident" id="1465553"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465554">+</span><span class="ident" id="1465555"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465560">[</span><span class="num" id="1465561">4</span><span class="op" id="1465562">]</span><span class="op" id="1465563">)</span><span class="op" id="1465564">*</span><span class="ident" id="1465565"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465566">+</span><span class="ident" id="1465567"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465572">[</span><span class="num" id="1465573">5</span><span class="op" id="1465574">]</span><span class="op" id="1465575">)</span><span class="op" id="1465576">*</span><span class="ident" id="1465577"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465579">+</span>&nbsp;<span class="ident" id="1465581"><a href="/math/gamma.go.html#1463214">_gamP</a></span><span class="op" id="1465586">[</span><span class="num" id="1465587">6</span><span class="op" id="1465588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465591"><a href="/math/gamma.go.html#1464903">q</a></span>&nbsp;<span class="op" id="1465593">=</span>&nbsp;<span class="op" id="1465595">(</span><span class="op" id="1465596">(</span><span class="op" id="1465597">(</span><span class="op" id="1465598">(</span><span class="op" id="1465599">(</span><span class="op" id="1465600">(</span><span class="ident" id="1465601"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465602">*</span><span class="ident" id="1465603"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465608">[</span><span class="num" id="1465609">0</span><span class="op" id="1465610">]</span><span class="op" id="1465611">+</span><span class="ident" id="1465612"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465617">[</span><span class="num" id="1465618">1</span><span class="op" id="1465619">]</span><span class="op" id="1465620">)</span><span class="op" id="1465621">*</span><span class="ident" id="1465622"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465623">+</span><span class="ident" id="1465624"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465629">[</span><span class="num" id="1465630">2</span><span class="op" id="1465631">]</span><span class="op" id="1465632">)</span><span class="op" id="1465633">*</span><span class="ident" id="1465634"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465635">+</span><span class="ident" id="1465636"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465641">[</span><span class="num" id="1465642">3</span><span class="op" id="1465643">]</span><span class="op" id="1465644">)</span><span class="op" id="1465645">*</span><span class="ident" id="1465646"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465647">+</span><span class="ident" id="1465648"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465653">[</span><span class="num" id="1465654">4</span><span class="op" id="1465655">]</span><span class="op" id="1465656">)</span><span class="op" id="1465657">*</span><span class="ident" id="1465658"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465659">+</span><span class="ident" id="1465660"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465665">[</span><span class="num" id="1465666">5</span><span class="op" id="1465667">]</span><span class="op" id="1465668">)</span><span class="op" id="1465669">*</span><span class="ident" id="1465670"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465671">+</span><span class="ident" id="1465672"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465677">[</span><span class="num" id="1465678">6</span><span class="op" id="1465679">]</span><span class="op" id="1465680">)</span><span class="op" id="1465681">*</span><span class="ident" id="1465682"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465684">+</span>&nbsp;<span class="ident" id="1465686"><a href="/math/gamma.go.html#1463445">_gamQ</a></span><span class="op" id="1465691">[</span><span class="num" id="1465692">7</span><span class="op" id="1465693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465696">return</span>&nbsp;<span class="ident" id="1465703"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465705">*</span>&nbsp;<span class="ident" id="1465707"><a href="/math/gamma.go.html#1464916">p</a></span>&nbsp;<span class="op" id="1465709">/</span>&nbsp;<span class="ident" id="1465711"><a href="/math/gamma.go.html#1464903">q</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1465714">small</span><span class="op" id="1465719">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465722">if</span>&nbsp;<span class="ident" id="1465725"><a href="/math/gamma.go.html#1464567">x</a></span>&nbsp;<span class="op" id="1465727">==</span>&nbsp;<span class="num" id="1465730">0</span>&nbsp;<span class="op" id="1465732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465736">return</span>&nbsp;<span class="ident" id="1465743"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1465746">(</span><span class="num" id="1465747">1</span><span class="op" id="1465748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465754">return</span>&nbsp;<span class="ident" id="1465761"><a href="/math/gamma.go.html#1465257">z</a></span>&nbsp;<span class="op" id="1465763">/</span>&nbsp;<span class="op" id="1465765">(</span><span class="op" id="1465766">(</span><span class="num" id="1465767">1</span>&nbsp;<span class="op" id="1465769">+</span>&nbsp;<span class="ident" id="1465771"><a href="/math/gamma.go.html#1464595">Euler</a></span><span class="op" id="1465776">*</span><span class="ident" id="1465777"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465778">)</span>&nbsp;<span class="op" id="1465780">*</span>&nbsp;<span class="ident" id="1465782"><a href="/math/gamma.go.html#1464567">x</a></span><span class="op" id="1465783">)</span><br>
<span class="lineno"></span><span class="op" id="1465785">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="1465788">func</span>&nbsp;<span class="ident" id="1465793">isNegInt</span><span class="op" id="1465801">(</span><span class="ident" id="1465802">x</span>&nbsp;<span class="builtintype" id="1465804">float64</span><span class="op" id="1465811">)</span>&nbsp;<span class="builtintype" id="1465813">bool</span>&nbsp;<span class="op" id="1465818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465821">if</span>&nbsp;<span class="ident" id="1465824"><a href="/math/gamma.go.html#1465802">x</a></span>&nbsp;<span class="op" id="1465826">&lt;</span>&nbsp;<span class="num" id="1465828">0</span>&nbsp;<span class="op" id="1465830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1465834">_</span><span class="op" id="1465835">,</span>&nbsp;<span class="ident" id="1465837">xf</span>&nbsp;<span class="op" id="1465840">:=</span>&nbsp;<span class="ident" id="1465843"><a href="/math/modf.go.html#1527081">Modf</a></span><span class="op" id="1465847">(</span><span class="ident" id="1465848"><a href="/math/gamma.go.html#1465802">x</a></span><span class="op" id="1465849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465853">return</span>&nbsp;<span class="ident" id="1465860"><a href="/math/gamma.go.html#1465837">xf</a></span>&nbsp;<span class="op" id="1465863">==</span>&nbsp;<span class="num" id="1465866">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1465869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1465872">return</span>&nbsp;<span class="ident" id="1465879">false</span><br>
<span class="lineno"></span><span class="op" id="1465885">}</span>
</div>
</body>
</html>
