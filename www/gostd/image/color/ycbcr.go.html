<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5530040">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5530095">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5530149">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5530200">package</span>&nbsp;<span class="ident" id="5530208">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530215">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5530272">func</span>&nbsp;<span class="ident" id="5530277">RGBToYCbCr</span><span class="op" id="5530287">(</span><span class="ident" id="5530288">r</span><span class="op" id="5530289">,</span>&nbsp;<span class="ident" id="5530291">g</span><span class="op" id="5530292">,</span>&nbsp;<span class="ident" id="5530294">b</span>&nbsp;<span class="builtintype" id="5530296">uint8</span><span class="op" id="5530301">)</span>&nbsp;<span class="op" id="5530303">(</span><span class="builtintype" id="5530304">uint8</span><span class="op" id="5530309">,</span>&nbsp;<span class="builtintype" id="5530311">uint8</span><span class="op" id="5530316">,</span>&nbsp;<span class="builtintype" id="5530318">uint8</span><span class="op" id="5530323">)</span>&nbsp;<span class="op" id="5530325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530328">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530361">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530402">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530449">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5530496">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530563">r1</span>&nbsp;<span class="op" id="5530566">:=</span>&nbsp;<span class="builtintype" id="5530569">int</span><span class="op" id="5530572">(</span><span class="ident" id="5530573">r</span><span class="op" id="5530574">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530577">g1</span>&nbsp;<span class="op" id="5530580">:=</span>&nbsp;<span class="builtintype" id="5530583">int</span><span class="op" id="5530586">(</span><span class="ident" id="5530587">g</span><span class="op" id="5530588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530591">b1</span>&nbsp;<span class="op" id="5530594">:=</span>&nbsp;<span class="builtintype" id="5530597">int</span><span class="op" id="5530600">(</span><span class="ident" id="5530601">b</span><span class="op" id="5530602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530605">yy</span>&nbsp;<span class="op" id="5530608">:=</span>&nbsp;<span class="op" id="5530611">(</span><span class="num" id="5530612">19595</span><span class="op" id="5530617">*</span><span class="ident" id="5530618">r1</span>&nbsp;<span class="op" id="5530621">+</span>&nbsp;<span class="num" id="5530623">38470</span><span class="op" id="5530628">*</span><span class="ident" id="5530629">g1</span>&nbsp;<span class="op" id="5530632">+</span>&nbsp;<span class="num" id="5530634">7471</span><span class="op" id="5530638">*</span><span class="ident" id="5530639">b1</span>&nbsp;<span class="op" id="5530642">+</span>&nbsp;<span class="num" id="5530644">1</span><span class="op" id="5530645">&lt;&lt;</span><span class="num" id="5530647">15</span><span class="op" id="5530649">)</span>&nbsp;<span class="op" id="5530651">&gt;&gt;</span>&nbsp;<span class="num" id="5530654">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530658">cb</span>&nbsp;<span class="op" id="5530661">:=</span>&nbsp;<span class="op" id="5530664">(</span><span class="op" id="5530665">-</span><span class="num" id="5530666">11056</span><span class="op" id="5530671">*</span><span class="ident" id="5530672">r1</span>&nbsp;<span class="op" id="5530675">-</span>&nbsp;<span class="num" id="5530677">21712</span><span class="op" id="5530682">*</span><span class="ident" id="5530683">g1</span>&nbsp;<span class="op" id="5530686">+</span>&nbsp;<span class="num" id="5530688">32768</span><span class="op" id="5530693">*</span><span class="ident" id="5530694">b1</span>&nbsp;<span class="op" id="5530697">+</span>&nbsp;<span class="num" id="5530699">257</span><span class="op" id="5530702">&lt;&lt;</span><span class="num" id="5530704">15</span><span class="op" id="5530706">)</span>&nbsp;<span class="op" id="5530708">&gt;&gt;</span>&nbsp;<span class="num" id="5530711">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530715">cr</span>&nbsp;<span class="op" id="5530718">:=</span>&nbsp;<span class="op" id="5530721">(</span><span class="num" id="5530722">32768</span><span class="op" id="5530727">*</span><span class="ident" id="5530728">r1</span>&nbsp;<span class="op" id="5530731">-</span>&nbsp;<span class="num" id="5530733">27440</span><span class="op" id="5530738">*</span><span class="ident" id="5530739">g1</span>&nbsp;<span class="op" id="5530742">-</span>&nbsp;<span class="num" id="5530744">5328</span><span class="op" id="5530748">*</span><span class="ident" id="5530749">b1</span>&nbsp;<span class="op" id="5530752">+</span>&nbsp;<span class="num" id="5530754">257</span><span class="op" id="5530757">&lt;&lt;</span><span class="num" id="5530759">15</span><span class="op" id="5530761">)</span>&nbsp;<span class="op" id="5530763">&gt;&gt;</span>&nbsp;<span class="num" id="5530766">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530770">if</span>&nbsp;<span class="ident" id="5530773">yy</span>&nbsp;<span class="op" id="5530776">&lt;</span>&nbsp;<span class="num" id="5530778">0</span>&nbsp;<span class="op" id="5530780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530784">yy</span>&nbsp;<span class="op" id="5530787">=</span>&nbsp;<span class="num" id="5530789">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530792">}</span>&nbsp;<span class="keyword" id="5530794">else</span>&nbsp;<span class="keyword" id="5530799">if</span>&nbsp;<span class="ident" id="5530802">yy</span>&nbsp;<span class="op" id="5530805">&gt;</span>&nbsp;<span class="num" id="5530807">255</span>&nbsp;<span class="op" id="5530811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530815">yy</span>&nbsp;<span class="op" id="5530818">=</span>&nbsp;<span class="num" id="5530820">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530825">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530828">if</span>&nbsp;<span class="ident" id="5530831">cb</span>&nbsp;<span class="op" id="5530834">&lt;</span>&nbsp;<span class="num" id="5530836">0</span>&nbsp;<span class="op" id="5530838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530842">cb</span>&nbsp;<span class="op" id="5530845">=</span>&nbsp;<span class="num" id="5530847">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530850">}</span>&nbsp;<span class="keyword" id="5530852">else</span>&nbsp;<span class="keyword" id="5530857">if</span>&nbsp;<span class="ident" id="5530860">cb</span>&nbsp;<span class="op" id="5530863">&gt;</span>&nbsp;<span class="num" id="5530865">255</span>&nbsp;<span class="op" id="5530869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530873">cb</span>&nbsp;<span class="op" id="5530876">=</span>&nbsp;<span class="num" id="5530878">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530883">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530886">if</span>&nbsp;<span class="ident" id="5530889">cr</span>&nbsp;<span class="op" id="5530892">&lt;</span>&nbsp;<span class="num" id="5530894">0</span>&nbsp;<span class="op" id="5530896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530900">cr</span>&nbsp;<span class="op" id="5530903">=</span>&nbsp;<span class="num" id="5530905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530908">}</span>&nbsp;<span class="keyword" id="5530910">else</span>&nbsp;<span class="keyword" id="5530915">if</span>&nbsp;<span class="ident" id="5530918">cr</span>&nbsp;<span class="op" id="5530921">&gt;</span>&nbsp;<span class="num" id="5530923">255</span>&nbsp;<span class="op" id="5530927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530931">cr</span>&nbsp;<span class="op" id="5530934">=</span>&nbsp;<span class="num" id="5530936">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530941">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530944">return</span>&nbsp;<span class="builtintype" id="5530951">uint8</span><span class="op" id="5530956">(</span><span class="ident" id="5530957">yy</span><span class="op" id="5530959">)</span><span class="op" id="5530960">,</span>&nbsp;<span class="builtintype" id="5530962">uint8</span><span class="op" id="5530967">(</span><span class="ident" id="5530968">cb</span><span class="op" id="5530970">)</span><span class="op" id="5530971">,</span>&nbsp;<span class="builtintype" id="5530973">uint8</span><span class="op" id="5530978">(</span><span class="ident" id="5530979">cr</span><span class="op" id="5530981">)</span><br>
<span class="lineno"></span><span class="op" id="5530983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530986">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5531043">func</span>&nbsp;<span class="ident" id="5531048">YCbCrToRGB</span><span class="op" id="5531058">(</span><span class="ident" id="5531059">y</span><span class="op" id="5531060">,</span>&nbsp;<span class="ident" id="5531062">cb</span><span class="op" id="5531064">,</span>&nbsp;<span class="ident" id="5531066">cr</span>&nbsp;<span class="builtintype" id="5531069">uint8</span><span class="op" id="5531074">)</span>&nbsp;<span class="op" id="5531076">(</span><span class="builtintype" id="5531077">uint8</span><span class="op" id="5531082">,</span>&nbsp;<span class="builtintype" id="5531084">uint8</span><span class="op" id="5531089">,</span>&nbsp;<span class="builtintype" id="5531091">uint8</span><span class="op" id="5531096">)</span>&nbsp;<span class="op" id="5531098">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5531101">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5531134">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5531164">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5531213">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5531243">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531310">yy1</span>&nbsp;<span class="op" id="5531314">:=</span>&nbsp;<span class="builtintype" id="5531317">int</span><span class="op" id="5531320">(</span><span class="ident" id="5531321">y</span><span class="op" id="5531322">)</span><span class="op" id="5531323">&lt;&lt;</span><span class="num" id="5531325">16</span>&nbsp;<span class="op" id="5531328">+</span>&nbsp;<span class="num" id="5531330">1</span><span class="op" id="5531331">&lt;&lt;</span><span class="num" id="5531333">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531337">cb1</span>&nbsp;<span class="op" id="5531341">:=</span>&nbsp;<span class="builtintype" id="5531344">int</span><span class="op" id="5531347">(</span><span class="ident" id="5531348">cb</span><span class="op" id="5531350">)</span>&nbsp;<span class="op" id="5531352">-</span>&nbsp;<span class="num" id="5531354">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531359">cr1</span>&nbsp;<span class="op" id="5531363">:=</span>&nbsp;<span class="builtintype" id="5531366">int</span><span class="op" id="5531369">(</span><span class="ident" id="5531370">cr</span><span class="op" id="5531372">)</span>&nbsp;<span class="op" id="5531374">-</span>&nbsp;<span class="num" id="5531376">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531381">r</span>&nbsp;<span class="op" id="5531383">:=</span>&nbsp;<span class="op" id="5531386">(</span><span class="ident" id="5531387">yy1</span>&nbsp;<span class="op" id="5531391">+</span>&nbsp;<span class="num" id="5531393">91881</span><span class="op" id="5531398">*</span><span class="ident" id="5531399">cr1</span><span class="op" id="5531402">)</span>&nbsp;<span class="op" id="5531404">&gt;&gt;</span>&nbsp;<span class="num" id="5531407">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531411">g</span>&nbsp;<span class="op" id="5531413">:=</span>&nbsp;<span class="op" id="5531416">(</span><span class="ident" id="5531417">yy1</span>&nbsp;<span class="op" id="5531421">-</span>&nbsp;<span class="num" id="5531423">22554</span><span class="op" id="5531428">*</span><span class="ident" id="5531429">cb1</span>&nbsp;<span class="op" id="5531433">-</span>&nbsp;<span class="num" id="5531435">46802</span><span class="op" id="5531440">*</span><span class="ident" id="5531441">cr1</span><span class="op" id="5531444">)</span>&nbsp;<span class="op" id="5531446">&gt;&gt;</span>&nbsp;<span class="num" id="5531449">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531453">b</span>&nbsp;<span class="op" id="5531455">:=</span>&nbsp;<span class="op" id="5531458">(</span><span class="ident" id="5531459">yy1</span>&nbsp;<span class="op" id="5531463">+</span>&nbsp;<span class="num" id="5531465">116130</span><span class="op" id="5531471">*</span><span class="ident" id="5531472">cb1</span><span class="op" id="5531475">)</span>&nbsp;<span class="op" id="5531477">&gt;&gt;</span>&nbsp;<span class="num" id="5531480">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531484">if</span>&nbsp;<span class="ident" id="5531487">r</span>&nbsp;<span class="op" id="5531489">&lt;</span>&nbsp;<span class="num" id="5531491">0</span>&nbsp;<span class="op" id="5531493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531497">r</span>&nbsp;<span class="op" id="5531499">=</span>&nbsp;<span class="num" id="5531501">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531504">}</span>&nbsp;<span class="keyword" id="5531506">else</span>&nbsp;<span class="keyword" id="5531511">if</span>&nbsp;<span class="ident" id="5531514">r</span>&nbsp;<span class="op" id="5531516">&gt;</span>&nbsp;<span class="num" id="5531518">255</span>&nbsp;<span class="op" id="5531522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531526">r</span>&nbsp;<span class="op" id="5531528">=</span>&nbsp;<span class="num" id="5531530">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531538">if</span>&nbsp;<span class="ident" id="5531541">g</span>&nbsp;<span class="op" id="5531543">&lt;</span>&nbsp;<span class="num" id="5531545">0</span>&nbsp;<span class="op" id="5531547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531551">g</span>&nbsp;<span class="op" id="5531553">=</span>&nbsp;<span class="num" id="5531555">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531558">}</span>&nbsp;<span class="keyword" id="5531560">else</span>&nbsp;<span class="keyword" id="5531565">if</span>&nbsp;<span class="ident" id="5531568">g</span>&nbsp;<span class="op" id="5531570">&gt;</span>&nbsp;<span class="num" id="5531572">255</span>&nbsp;<span class="op" id="5531576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531580">g</span>&nbsp;<span class="op" id="5531582">=</span>&nbsp;<span class="num" id="5531584">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531592">if</span>&nbsp;<span class="ident" id="5531595">b</span>&nbsp;<span class="op" id="5531597">&lt;</span>&nbsp;<span class="num" id="5531599">0</span>&nbsp;<span class="op" id="5531601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531605">b</span>&nbsp;<span class="op" id="5531607">=</span>&nbsp;<span class="num" id="5531609">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531612">}</span>&nbsp;<span class="keyword" id="5531614">else</span>&nbsp;<span class="keyword" id="5531619">if</span>&nbsp;<span class="ident" id="5531622">b</span>&nbsp;<span class="op" id="5531624">&gt;</span>&nbsp;<span class="num" id="5531626">255</span>&nbsp;<span class="op" id="5531630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531634">b</span>&nbsp;<span class="op" id="5531636">=</span>&nbsp;<span class="num" id="5531638">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5531643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531646">return</span>&nbsp;<span class="builtintype" id="5531653">uint8</span><span class="op" id="5531658">(</span><span class="ident" id="5531659">r</span><span class="op" id="5531660">)</span><span class="op" id="5531661">,</span>&nbsp;<span class="builtintype" id="5531663">uint8</span><span class="op" id="5531668">(</span><span class="ident" id="5531669">g</span><span class="op" id="5531670">)</span><span class="op" id="5531671">,</span>&nbsp;<span class="builtintype" id="5531673">uint8</span><span class="op" id="5531678">(</span><span class="ident" id="5531679">b</span><span class="op" id="5531680">)</span><br>
<span class="lineno"></span><span class="op" id="5531682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5531685">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="5531764">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="5531803">//</span><br>
<span class="lineno"></span><span class="comment" id="5531806">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="5531880">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="5531955">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="5532033">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="5532086">//</span><br>
<span class="lineno"></span><span class="comment" id="5532089">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="5532168">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="5532243">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="5532315">type</span>&nbsp;<span class="ident" id="5532320">YCbCr</span>&nbsp;<span class="keyword" id="5532326">struct</span>&nbsp;<span class="op" id="5532333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532336">Y</span><span class="op" id="5532337">,</span>&nbsp;<span class="ident" id="5532339">Cb</span><span class="op" id="5532341">,</span>&nbsp;<span class="ident" id="5532343">Cr</span>&nbsp;<span class="builtintype" id="5532346">uint8</span><br>
<span class="lineno"></span><span class="op" id="5532352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5532355">func</span>&nbsp;<span class="op" id="5532360">(</span><span class="ident" id="5532361">c</span>&nbsp;<span class="ident" id="5532363">YCbCr</span><span class="op" id="5532368">)</span>&nbsp;<span class="ident" id="5532370">RGBA</span><span class="op" id="5532374">(</span><span class="op" id="5532375">)</span>&nbsp;<span class="op" id="5532377">(</span><span class="builtintype" id="5532378">uint32</span><span class="op" id="5532384">,</span>&nbsp;<span class="builtintype" id="5532386">uint32</span><span class="op" id="5532392">,</span>&nbsp;<span class="builtintype" id="5532394">uint32</span><span class="op" id="5532400">,</span>&nbsp;<span class="builtintype" id="5532402">uint32</span><span class="op" id="5532408">)</span>&nbsp;<span class="op" id="5532410">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532413">r</span><span class="op" id="5532414">,</span>&nbsp;<span class="ident" id="5532416">g</span><span class="op" id="5532417">,</span>&nbsp;<span class="ident" id="5532419">b</span>&nbsp;<span class="op" id="5532421">:=</span>&nbsp;<span class="ident" id="5532424">YCbCrToRGB</span><span class="op" id="5532434">(</span><span class="ident" id="5532435">c</span><span class="op" id="5532436">.</span><span class="ident" id="5532437">Y</span><span class="op" id="5532438">,</span>&nbsp;<span class="ident" id="5532440">c</span><span class="op" id="5532441">.</span><span class="ident" id="5532442">Cb</span><span class="op" id="5532444">,</span>&nbsp;<span class="ident" id="5532446">c</span><span class="op" id="5532447">.</span><span class="ident" id="5532448">Cr</span><span class="op" id="5532450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532453">return</span>&nbsp;<span class="builtintype" id="5532460">uint32</span><span class="op" id="5532466">(</span><span class="ident" id="5532467">r</span><span class="op" id="5532468">)</span>&nbsp;<span class="op" id="5532470">*</span>&nbsp;<span class="num" id="5532472">0x101</span><span class="op" id="5532477">,</span>&nbsp;<span class="builtintype" id="5532479">uint32</span><span class="op" id="5532485">(</span><span class="ident" id="5532486">g</span><span class="op" id="5532487">)</span>&nbsp;<span class="op" id="5532489">*</span>&nbsp;<span class="num" id="5532491">0x101</span><span class="op" id="5532496">,</span>&nbsp;<span class="builtintype" id="5532498">uint32</span><span class="op" id="5532504">(</span><span class="ident" id="5532505">b</span><span class="op" id="5532506">)</span>&nbsp;<span class="op" id="5532508">*</span>&nbsp;<span class="num" id="5532510">0x101</span><span class="op" id="5532515">,</span>&nbsp;<span class="num" id="5532517">0xffff</span><br>
<span class="lineno"></span><span class="op" id="5532524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5532527">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="5532573">var</span>&nbsp;<span class="ident" id="5532577">YCbCrModel</span>&nbsp;<span class="ident" id="5532588">Model</span>&nbsp;<span class="op" id="5532594">=</span>&nbsp;<span class="ident" id="5532596">ModelFunc</span><span class="op" id="5532605">(</span><span class="ident" id="5532606">yCbCrModel</span><span class="op" id="5532616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5532619">func</span>&nbsp;<span class="ident" id="5532624">yCbCrModel</span><span class="op" id="5532634">(</span><span class="ident" id="5532635">c</span>&nbsp;<span class="ident" id="5532637">Color</span><span class="op" id="5532642">)</span>&nbsp;<span class="ident" id="5532644">Color</span>&nbsp;<span class="op" id="5532650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532653">if</span>&nbsp;<span class="ident" id="5532656">_</span><span class="op" id="5532657">,</span>&nbsp;<span class="ident" id="5532659">ok</span>&nbsp;<span class="op" id="5532662">:=</span>&nbsp;<span class="ident" id="5532665">c</span><span class="op" id="5532666">.</span><span class="op" id="5532667">(</span><span class="ident" id="5532668">YCbCr</span><span class="op" id="5532673">)</span><span class="op" id="5532674">;</span>&nbsp;<span class="ident" id="5532676">ok</span>&nbsp;<span class="op" id="5532679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532683">return</span>&nbsp;<span class="ident" id="5532690">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532696">r</span><span class="op" id="5532697">,</span>&nbsp;<span class="ident" id="5532699">g</span><span class="op" id="5532700">,</span>&nbsp;<span class="ident" id="5532702">b</span><span class="op" id="5532703">,</span>&nbsp;<span class="ident" id="5532705">_</span>&nbsp;<span class="op" id="5532707">:=</span>&nbsp;<span class="ident" id="5532710">c</span><span class="op" id="5532711">.</span><span class="ident" id="5532712">RGBA</span><span class="op" id="5532716">(</span><span class="op" id="5532717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532720">y</span><span class="op" id="5532721">,</span>&nbsp;<span class="ident" id="5532723">u</span><span class="op" id="5532724">,</span>&nbsp;<span class="ident" id="5532726">v</span>&nbsp;<span class="op" id="5532728">:=</span>&nbsp;<span class="ident" id="5532731">RGBToYCbCr</span><span class="op" id="5532741">(</span><span class="builtintype" id="5532742">uint8</span><span class="op" id="5532747">(</span><span class="ident" id="5532748">r</span><span class="op" id="5532749">&gt;&gt;</span><span class="num" id="5532751">8</span><span class="op" id="5532752">)</span><span class="op" id="5532753">,</span>&nbsp;<span class="builtintype" id="5532755">uint8</span><span class="op" id="5532760">(</span><span class="ident" id="5532761">g</span><span class="op" id="5532762">&gt;&gt;</span><span class="num" id="5532764">8</span><span class="op" id="5532765">)</span><span class="op" id="5532766">,</span>&nbsp;<span class="builtintype" id="5532768">uint8</span><span class="op" id="5532773">(</span><span class="ident" id="5532774">b</span><span class="op" id="5532775">&gt;&gt;</span><span class="num" id="5532777">8</span><span class="op" id="5532778">)</span><span class="op" id="5532779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532782">return</span>&nbsp;<span class="ident" id="5532789">YCbCr</span><span class="op" id="5532794">{</span><span class="ident" id="5532795">y</span><span class="op" id="5532796">,</span>&nbsp;<span class="ident" id="5532798">u</span><span class="op" id="5532799">,</span>&nbsp;<span class="ident" id="5532801">v</span><span class="op" id="5532802">}</span><br>
<span class="lineno"></span><span class="op" id="5532804">}</span>
</div>
</body>
</html>
