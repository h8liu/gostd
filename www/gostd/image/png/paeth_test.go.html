<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8240055">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8240110">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8240164">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8240215">package</span>&nbsp;<span class="ident" id="8240223">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8240228">import</span>&nbsp;<span class="op" id="8240235">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8240238">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8240247">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8240260">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8240270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8240273">func</span>&nbsp;<span class="ident" id="8240278">slowAbs</span><span class="op" id="8240285">(</span><span class="ident" id="8240286">x</span>&nbsp;<span class="builtintype" id="8240288">int</span><span class="op" id="8240291">)</span>&nbsp;<span class="builtintype" id="8240293">int</span>&nbsp;<span class="op" id="8240297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240300">if</span>&nbsp;<span class="ident" id="8240303">x</span>&nbsp;<span class="op" id="8240305">&lt;</span>&nbsp;<span class="num" id="8240307">0</span>&nbsp;<span class="op" id="8240309">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240313">return</span>&nbsp;<span class="op" id="8240320">-</span><span class="ident" id="8240321">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8240324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240327">return</span>&nbsp;<span class="ident" id="8240334">x</span><br>
<span class="lineno"></span><span class="op" id="8240336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="8240339">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="8240411">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="8240485">func</span>&nbsp;<span class="ident" id="8240490">slowPaeth</span><span class="op" id="8240499">(</span><span class="ident" id="8240500">a</span><span class="op" id="8240501">,</span>&nbsp;<span class="ident" id="8240503">b</span><span class="op" id="8240504">,</span>&nbsp;<span class="ident" id="8240506">c</span>&nbsp;<span class="builtintype" id="8240508">uint8</span><span class="op" id="8240513">)</span>&nbsp;<span class="builtintype" id="8240515">uint8</span>&nbsp;<span class="op" id="8240521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240524">p</span>&nbsp;<span class="op" id="8240526">:=</span>&nbsp;<span class="builtintype" id="8240529">int</span><span class="op" id="8240532">(</span><span class="ident" id="8240533">a</span><span class="op" id="8240534">)</span>&nbsp;<span class="op" id="8240536">+</span>&nbsp;<span class="builtintype" id="8240538">int</span><span class="op" id="8240541">(</span><span class="ident" id="8240542">b</span><span class="op" id="8240543">)</span>&nbsp;<span class="op" id="8240545">-</span>&nbsp;<span class="builtintype" id="8240547">int</span><span class="op" id="8240550">(</span><span class="ident" id="8240551">c</span><span class="op" id="8240552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240555">pa</span>&nbsp;<span class="op" id="8240558">:=</span>&nbsp;<span class="ident" id="8240561">slowAbs</span><span class="op" id="8240568">(</span><span class="ident" id="8240569">p</span>&nbsp;<span class="op" id="8240571">-</span>&nbsp;<span class="builtintype" id="8240573">int</span><span class="op" id="8240576">(</span><span class="ident" id="8240577">a</span><span class="op" id="8240578">)</span><span class="op" id="8240579">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240582">pb</span>&nbsp;<span class="op" id="8240585">:=</span>&nbsp;<span class="ident" id="8240588">slowAbs</span><span class="op" id="8240595">(</span><span class="ident" id="8240596">p</span>&nbsp;<span class="op" id="8240598">-</span>&nbsp;<span class="builtintype" id="8240600">int</span><span class="op" id="8240603">(</span><span class="ident" id="8240604">b</span><span class="op" id="8240605">)</span><span class="op" id="8240606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240609">pc</span>&nbsp;<span class="op" id="8240612">:=</span>&nbsp;<span class="ident" id="8240615">slowAbs</span><span class="op" id="8240622">(</span><span class="ident" id="8240623">p</span>&nbsp;<span class="op" id="8240625">-</span>&nbsp;<span class="builtintype" id="8240627">int</span><span class="op" id="8240630">(</span><span class="ident" id="8240631">c</span><span class="op" id="8240632">)</span><span class="op" id="8240633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240636">if</span>&nbsp;<span class="ident" id="8240639">pa</span>&nbsp;<span class="op" id="8240642">&lt;=</span>&nbsp;<span class="ident" id="8240645">pb</span>&nbsp;<span class="op" id="8240648">&amp;&amp;</span>&nbsp;<span class="ident" id="8240651">pa</span>&nbsp;<span class="op" id="8240654">&lt;=</span>&nbsp;<span class="ident" id="8240657">pc</span>&nbsp;<span class="op" id="8240660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240664">return</span>&nbsp;<span class="ident" id="8240671">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8240674">}</span>&nbsp;<span class="keyword" id="8240676">else</span>&nbsp;<span class="keyword" id="8240681">if</span>&nbsp;<span class="ident" id="8240684">pb</span>&nbsp;<span class="op" id="8240687">&lt;=</span>&nbsp;<span class="ident" id="8240690">pc</span>&nbsp;<span class="op" id="8240693">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240697">return</span>&nbsp;<span class="ident" id="8240704">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8240707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240710">return</span>&nbsp;<span class="ident" id="8240717">c</span><br>
<span class="lineno"></span><span class="op" id="8240719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="8240722">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="8240798">func</span>&nbsp;<span class="ident" id="8240803">slowFilterPaeth</span><span class="op" id="8240818">(</span><span class="ident" id="8240819">cdat</span><span class="op" id="8240823">,</span>&nbsp;<span class="ident" id="8240825">pdat</span>&nbsp;<span class="op" id="8240830">[</span><span class="op" id="8240831">]</span><span class="builtintype" id="8240832">byte</span><span class="op" id="8240836">,</span>&nbsp;<span class="ident" id="8240838">bytesPerPixel</span>&nbsp;<span class="builtintype" id="8240852">int</span><span class="op" id="8240855">)</span>&nbsp;<span class="op" id="8240857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240860">for</span>&nbsp;<span class="ident" id="8240864">i</span>&nbsp;<span class="op" id="8240866">:=</span>&nbsp;<span class="num" id="8240869">0</span><span class="op" id="8240870">;</span>&nbsp;<span class="ident" id="8240872">i</span>&nbsp;<span class="op" id="8240874">&lt;</span>&nbsp;<span class="ident" id="8240876">bytesPerPixel</span><span class="op" id="8240889">;</span>&nbsp;<span class="ident" id="8240891">i</span><span class="op" id="8240892">++</span>&nbsp;<span class="op" id="8240895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240899">cdat</span><span class="op" id="8240903">[</span><span class="ident" id="8240904">i</span><span class="op" id="8240905">]</span>&nbsp;<span class="op" id="8240907">+=</span>&nbsp;<span class="ident" id="8240910">paeth</span><span class="op" id="8240915">(</span><span class="num" id="8240916">0</span><span class="op" id="8240917">,</span>&nbsp;<span class="ident" id="8240919">pdat</span><span class="op" id="8240923">[</span><span class="ident" id="8240924">i</span><span class="op" id="8240925">]</span><span class="op" id="8240926">,</span>&nbsp;<span class="num" id="8240928">0</span><span class="op" id="8240929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8240932">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8240935">for</span>&nbsp;<span class="ident" id="8240939">i</span>&nbsp;<span class="op" id="8240941">:=</span>&nbsp;<span class="ident" id="8240944">bytesPerPixel</span><span class="op" id="8240957">;</span>&nbsp;<span class="ident" id="8240959">i</span>&nbsp;<span class="op" id="8240961">&lt;</span>&nbsp;<span class="builtinfunc" id="8240963">len</span><span class="op" id="8240966">(</span><span class="ident" id="8240967">cdat</span><span class="op" id="8240971">)</span><span class="op" id="8240972">;</span>&nbsp;<span class="ident" id="8240974">i</span><span class="op" id="8240975">++</span>&nbsp;<span class="op" id="8240978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8240982">cdat</span><span class="op" id="8240986">[</span><span class="ident" id="8240987">i</span><span class="op" id="8240988">]</span>&nbsp;<span class="op" id="8240990">+=</span>&nbsp;<span class="ident" id="8240993">paeth</span><span class="op" id="8240998">(</span><span class="ident" id="8240999">cdat</span><span class="op" id="8241003">[</span><span class="ident" id="8241004">i</span><span class="op" id="8241005">-</span><span class="ident" id="8241006">bytesPerPixel</span><span class="op" id="8241019">]</span><span class="op" id="8241020">,</span>&nbsp;<span class="ident" id="8241022">pdat</span><span class="op" id="8241026">[</span><span class="ident" id="8241027">i</span><span class="op" id="8241028">]</span><span class="op" id="8241029">,</span>&nbsp;<span class="ident" id="8241031">pdat</span><span class="op" id="8241035">[</span><span class="ident" id="8241036">i</span><span class="op" id="8241037">-</span><span class="ident" id="8241038">bytesPerPixel</span><span class="op" id="8241051">]</span><span class="op" id="8241052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241055">}</span><br>
<span class="lineno"></span><span class="op" id="8241057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="8241060">func</span>&nbsp;<span class="ident" id="8241065">TestPaeth</span><span class="op" id="8241074">(</span><span class="ident" id="8241075">t</span>&nbsp;<span class="op" id="8241077">*</span><span class="ident" id="8241078">testing</span><span class="op" id="8241085">.</span><span class="ident" id="8241086">T</span><span class="op" id="8241087">)</span>&nbsp;<span class="op" id="8241089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241092">for</span>&nbsp;<span class="ident" id="8241096">a</span>&nbsp;<span class="op" id="8241098">:=</span>&nbsp;<span class="num" id="8241101">0</span><span class="op" id="8241102">;</span>&nbsp;<span class="ident" id="8241104">a</span>&nbsp;<span class="op" id="8241106">&lt;</span>&nbsp;<span class="num" id="8241108">256</span><span class="op" id="8241111">;</span>&nbsp;<span class="ident" id="8241113">a</span>&nbsp;<span class="op" id="8241115">+=</span>&nbsp;<span class="num" id="8241118">15</span>&nbsp;<span class="op" id="8241121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241125">for</span>&nbsp;<span class="ident" id="8241129">b</span>&nbsp;<span class="op" id="8241131">:=</span>&nbsp;<span class="num" id="8241134">0</span><span class="op" id="8241135">;</span>&nbsp;<span class="ident" id="8241137">b</span>&nbsp;<span class="op" id="8241139">&lt;</span>&nbsp;<span class="num" id="8241141">256</span><span class="op" id="8241144">;</span>&nbsp;<span class="ident" id="8241146">b</span>&nbsp;<span class="op" id="8241148">+=</span>&nbsp;<span class="num" id="8241151">15</span>&nbsp;<span class="op" id="8241154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241159">for</span>&nbsp;<span class="ident" id="8241163">c</span>&nbsp;<span class="op" id="8241165">:=</span>&nbsp;<span class="num" id="8241168">0</span><span class="op" id="8241169">;</span>&nbsp;<span class="ident" id="8241171">c</span>&nbsp;<span class="op" id="8241173">&lt;</span>&nbsp;<span class="num" id="8241175">256</span><span class="op" id="8241178">;</span>&nbsp;<span class="ident" id="8241180">c</span>&nbsp;<span class="op" id="8241182">+=</span>&nbsp;<span class="num" id="8241185">15</span>&nbsp;<span class="op" id="8241188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241194">got</span>&nbsp;<span class="op" id="8241198">:=</span>&nbsp;<span class="ident" id="8241201">paeth</span><span class="op" id="8241206">(</span><span class="builtintype" id="8241207">uint8</span><span class="op" id="8241212">(</span><span class="ident" id="8241213">a</span><span class="op" id="8241214">)</span><span class="op" id="8241215">,</span>&nbsp;<span class="builtintype" id="8241217">uint8</span><span class="op" id="8241222">(</span><span class="ident" id="8241223">b</span><span class="op" id="8241224">)</span><span class="op" id="8241225">,</span>&nbsp;<span class="builtintype" id="8241227">uint8</span><span class="op" id="8241232">(</span><span class="ident" id="8241233">c</span><span class="op" id="8241234">)</span><span class="op" id="8241235">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241241">want</span>&nbsp;<span class="op" id="8241246">:=</span>&nbsp;<span class="ident" id="8241249">slowPaeth</span><span class="op" id="8241258">(</span><span class="builtintype" id="8241259">uint8</span><span class="op" id="8241264">(</span><span class="ident" id="8241265">a</span><span class="op" id="8241266">)</span><span class="op" id="8241267">,</span>&nbsp;<span class="builtintype" id="8241269">uint8</span><span class="op" id="8241274">(</span><span class="ident" id="8241275">b</span><span class="op" id="8241276">)</span><span class="op" id="8241277">,</span>&nbsp;<span class="builtintype" id="8241279">uint8</span><span class="op" id="8241284">(</span><span class="ident" id="8241285">c</span><span class="op" id="8241286">)</span><span class="op" id="8241287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241293">if</span>&nbsp;<span class="ident" id="8241296">got</span>&nbsp;<span class="op" id="8241300">!=</span>&nbsp;<span class="ident" id="8241303">want</span>&nbsp;<span class="op" id="8241308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241315">t</span><span class="op" id="8241316">.</span><span class="ident" id="8241317">Errorf</span><span class="op" id="8241323">(</span><span class="string" id="8241324">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8241363">,</span>&nbsp;<span class="ident" id="8241365">a</span><span class="op" id="8241366">,</span>&nbsp;<span class="ident" id="8241368">b</span><span class="op" id="8241369">,</span>&nbsp;<span class="ident" id="8241371">c</span><span class="op" id="8241372">,</span>&nbsp;<span class="ident" id="8241374">got</span><span class="op" id="8241377">,</span>&nbsp;<span class="ident" id="8241379">want</span><span class="op" id="8241383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241394">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241401">}</span><br>
<span class="lineno"></span><span class="op" id="8241403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8241406">func</span>&nbsp;<span class="ident" id="8241411">BenchmarkPaeth</span><span class="op" id="8241425">(</span><span class="ident" id="8241426">b</span>&nbsp;<span class="op" id="8241428">*</span><span class="ident" id="8241429">testing</span><span class="op" id="8241436">.</span><span class="ident" id="8241437">B</span><span class="op" id="8241438">)</span>&nbsp;<span class="op" id="8241440">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241443">for</span>&nbsp;<span class="ident" id="8241447">i</span>&nbsp;<span class="op" id="8241449">:=</span>&nbsp;<span class="num" id="8241452">0</span><span class="op" id="8241453">;</span>&nbsp;<span class="ident" id="8241455">i</span>&nbsp;<span class="op" id="8241457">&lt;</span>&nbsp;<span class="ident" id="8241459">b</span><span class="op" id="8241460">.</span><span class="ident" id="8241461">N</span><span class="op" id="8241462">;</span>&nbsp;<span class="ident" id="8241464">i</span><span class="op" id="8241465">++</span>&nbsp;<span class="op" id="8241468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241472">paeth</span><span class="op" id="8241477">(</span><span class="builtintype" id="8241478">uint8</span><span class="op" id="8241483">(</span><span class="ident" id="8241484">i</span><span class="op" id="8241485">&gt;&gt;</span><span class="num" id="8241487">16</span><span class="op" id="8241489">)</span><span class="op" id="8241490">,</span>&nbsp;<span class="builtintype" id="8241492">uint8</span><span class="op" id="8241497">(</span><span class="ident" id="8241498">i</span><span class="op" id="8241499">&gt;&gt;</span><span class="num" id="8241501">8</span><span class="op" id="8241502">)</span><span class="op" id="8241503">,</span>&nbsp;<span class="builtintype" id="8241505">uint8</span><span class="op" id="8241510">(</span><span class="ident" id="8241511">i</span><span class="op" id="8241512">)</span><span class="op" id="8241513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241516">}</span><br>
<span class="lineno"></span><span class="op" id="8241518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8241521">func</span>&nbsp;<span class="ident" id="8241526">TestPaethDecode</span><span class="op" id="8241541">(</span><span class="ident" id="8241542">t</span>&nbsp;<span class="op" id="8241544">*</span><span class="ident" id="8241545">testing</span><span class="op" id="8241552">.</span><span class="ident" id="8241553">T</span><span class="op" id="8241554">)</span>&nbsp;<span class="op" id="8241556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241559">pdat0</span>&nbsp;<span class="op" id="8241565">:=</span>&nbsp;<span class="builtinfunc" id="8241568">make</span><span class="op" id="8241572">(</span><span class="op" id="8241573">[</span><span class="op" id="8241574">]</span><span class="builtintype" id="8241575">byte</span><span class="op" id="8241579">,</span>&nbsp;<span class="num" id="8241581">32</span><span class="op" id="8241583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241586">pdat1</span>&nbsp;<span class="op" id="8241592">:=</span>&nbsp;<span class="builtinfunc" id="8241595">make</span><span class="op" id="8241599">(</span><span class="op" id="8241600">[</span><span class="op" id="8241601">]</span><span class="builtintype" id="8241602">byte</span><span class="op" id="8241606">,</span>&nbsp;<span class="num" id="8241608">32</span><span class="op" id="8241610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241613">pdat2</span>&nbsp;<span class="op" id="8241619">:=</span>&nbsp;<span class="builtinfunc" id="8241622">make</span><span class="op" id="8241626">(</span><span class="op" id="8241627">[</span><span class="op" id="8241628">]</span><span class="builtintype" id="8241629">byte</span><span class="op" id="8241633">,</span>&nbsp;<span class="num" id="8241635">32</span><span class="op" id="8241637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241640">cdat0</span>&nbsp;<span class="op" id="8241646">:=</span>&nbsp;<span class="builtinfunc" id="8241649">make</span><span class="op" id="8241653">(</span><span class="op" id="8241654">[</span><span class="op" id="8241655">]</span><span class="builtintype" id="8241656">byte</span><span class="op" id="8241660">,</span>&nbsp;<span class="num" id="8241662">32</span><span class="op" id="8241664">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241667">cdat1</span>&nbsp;<span class="op" id="8241673">:=</span>&nbsp;<span class="builtinfunc" id="8241676">make</span><span class="op" id="8241680">(</span><span class="op" id="8241681">[</span><span class="op" id="8241682">]</span><span class="builtintype" id="8241683">byte</span><span class="op" id="8241687">,</span>&nbsp;<span class="num" id="8241689">32</span><span class="op" id="8241691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241694">cdat2</span>&nbsp;<span class="op" id="8241700">:=</span>&nbsp;<span class="builtinfunc" id="8241703">make</span><span class="op" id="8241707">(</span><span class="op" id="8241708">[</span><span class="op" id="8241709">]</span><span class="builtintype" id="8241710">byte</span><span class="op" id="8241714">,</span>&nbsp;<span class="num" id="8241716">32</span><span class="op" id="8241718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241721">r</span>&nbsp;<span class="op" id="8241723">:=</span>&nbsp;<span class="ident" id="8241726">rand</span><span class="op" id="8241730">.</span><span class="ident" id="8241731">New</span><span class="op" id="8241734">(</span><span class="ident" id="8241735">rand</span><span class="op" id="8241739">.</span><span class="ident" id="8241740">NewSource</span><span class="op" id="8241749">(</span><span class="num" id="8241750">1</span><span class="op" id="8241751">)</span><span class="op" id="8241752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241755">for</span>&nbsp;<span class="ident" id="8241759">bytesPerPixel</span>&nbsp;<span class="op" id="8241773">:=</span>&nbsp;<span class="num" id="8241776">1</span><span class="op" id="8241777">;</span>&nbsp;<span class="ident" id="8241779">bytesPerPixel</span>&nbsp;<span class="op" id="8241793">&lt;=</span>&nbsp;<span class="num" id="8241796">8</span><span class="op" id="8241797">;</span>&nbsp;<span class="ident" id="8241799">bytesPerPixel</span><span class="op" id="8241812">++</span>&nbsp;<span class="op" id="8241815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241819">for</span>&nbsp;<span class="ident" id="8241823">i</span>&nbsp;<span class="op" id="8241825">:=</span>&nbsp;<span class="num" id="8241828">0</span><span class="op" id="8241829">;</span>&nbsp;<span class="ident" id="8241831">i</span>&nbsp;<span class="op" id="8241833">&lt;</span>&nbsp;<span class="num" id="8241835">100</span><span class="op" id="8241838">;</span>&nbsp;<span class="ident" id="8241840">i</span><span class="op" id="8241841">++</span>&nbsp;<span class="op" id="8241844">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8241849">for</span>&nbsp;<span class="ident" id="8241853">j</span>&nbsp;<span class="op" id="8241855">:=</span>&nbsp;<span class="keyword" id="8241858">range</span>&nbsp;<span class="ident" id="8241864">pdat0</span>&nbsp;<span class="op" id="8241870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241876">pdat0</span><span class="op" id="8241881">[</span><span class="ident" id="8241882">j</span><span class="op" id="8241883">]</span>&nbsp;<span class="op" id="8241885">=</span>&nbsp;<span class="builtintype" id="8241887">uint8</span><span class="op" id="8241892">(</span><span class="ident" id="8241893">r</span><span class="op" id="8241894">.</span><span class="ident" id="8241895">Uint32</span><span class="op" id="8241901">(</span><span class="op" id="8241902">)</span><span class="op" id="8241903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8241909">cdat0</span><span class="op" id="8241914">[</span><span class="ident" id="8241915">j</span><span class="op" id="8241916">]</span>&nbsp;<span class="op" id="8241918">=</span>&nbsp;<span class="builtintype" id="8241920">uint8</span><span class="op" id="8241925">(</span><span class="ident" id="8241926">r</span><span class="op" id="8241927">.</span><span class="ident" id="8241928">Uint32</span><span class="op" id="8241934">(</span><span class="op" id="8241935">)</span><span class="op" id="8241936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8241941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8241946">copy</span><span class="op" id="8241950">(</span><span class="ident" id="8241951">pdat1</span><span class="op" id="8241956">,</span>&nbsp;<span class="ident" id="8241958">pdat0</span><span class="op" id="8241963">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8241968">copy</span><span class="op" id="8241972">(</span><span class="ident" id="8241973">pdat2</span><span class="op" id="8241978">,</span>&nbsp;<span class="ident" id="8241980">pdat0</span><span class="op" id="8241985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8241990">copy</span><span class="op" id="8241994">(</span><span class="ident" id="8241995">cdat1</span><span class="op" id="8242000">,</span>&nbsp;<span class="ident" id="8242002">cdat0</span><span class="op" id="8242007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8242012">copy</span><span class="op" id="8242016">(</span><span class="ident" id="8242017">cdat2</span><span class="op" id="8242022">,</span>&nbsp;<span class="ident" id="8242024">cdat0</span><span class="op" id="8242029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8242034">filterPaeth</span><span class="op" id="8242045">(</span><span class="ident" id="8242046">cdat1</span><span class="op" id="8242051">,</span>&nbsp;<span class="ident" id="8242053">pdat1</span><span class="op" id="8242058">,</span>&nbsp;<span class="ident" id="8242060">bytesPerPixel</span><span class="op" id="8242073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8242078">slowFilterPaeth</span><span class="op" id="8242093">(</span><span class="ident" id="8242094">cdat2</span><span class="op" id="8242099">,</span>&nbsp;<span class="ident" id="8242101">pdat2</span><span class="op" id="8242106">,</span>&nbsp;<span class="ident" id="8242108">bytesPerPixel</span><span class="op" id="8242121">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8242126">if</span>&nbsp;<span class="op" id="8242129">!</span><span class="ident" id="8242130">bytes</span><span class="op" id="8242135">.</span><span class="ident" id="8242136">Equal</span><span class="op" id="8242141">(</span><span class="ident" id="8242142">cdat1</span><span class="op" id="8242147">,</span>&nbsp;<span class="ident" id="8242149">cdat2</span><span class="op" id="8242154">)</span>&nbsp;<span class="op" id="8242156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8242162">t</span><span class="op" id="8242163">.</span><span class="ident" id="8242164">Errorf</span><span class="op" id="8242170">(</span><span class="string" id="8242171">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="8242238">,</span>&nbsp;<span class="ident" id="8242240">bytesPerPixel</span><span class="op" id="8242253">,</span>&nbsp;<span class="ident" id="8242255">pdat0</span><span class="op" id="8242260">,</span>&nbsp;<span class="ident" id="8242262">cdat0</span><span class="op" id="8242267">,</span>&nbsp;<span class="ident" id="8242269">cdat1</span><span class="op" id="8242274">,</span>&nbsp;<span class="ident" id="8242276">cdat2</span><span class="op" id="8242281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8242287">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8242296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8242300">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8242303">}</span><br>
<span class="lineno"></span><span class="op" id="8242305">}</span>
</div>
</body>
</html>
