<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3735359">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3735414">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3735468">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3735519">//&nbsp;HTTP&nbsp;client.&nbsp;See&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3735549">//</span><br>
<span class="lineno"></span><span class="comment" id="3735552">//&nbsp;This&nbsp;is&nbsp;the&nbsp;high-level&nbsp;Client&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3735596">//&nbsp;The&nbsp;low-level&nbsp;implementation&nbsp;is&nbsp;in&nbsp;transport.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3735649">package</span>&nbsp;<span class="ident" id="3735657">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3735663">import</span>&nbsp;<span class="op" id="3735670">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735673">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735692">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735702">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735709">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735715">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735728">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735735">&#34;net/url&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735746">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735757">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3735765">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3735772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3735775">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;an&nbsp;HTTP&nbsp;client.&nbsp;Its&nbsp;zero&nbsp;value&nbsp;(DefaultClient)&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3735842">//&nbsp;usable&nbsp;client&nbsp;that&nbsp;uses&nbsp;DefaultTransport.</span><br>
<span class="lineno"></span><span class="comment" id="3735887">//</span><br>
<span class="lineno"></span><span class="comment" id="3735890">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;typically&nbsp;has&nbsp;internal&nbsp;state&nbsp;(cached&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="3735957">//&nbsp;connections),&nbsp;so&nbsp;Clients&nbsp;should&nbsp;be&nbsp;reused&nbsp;instead&nbsp;of&nbsp;created&nbsp;as</span><br>
<span class="lineno">30</span><span class="comment" id="3736024">//&nbsp;needed.&nbsp;Clients&nbsp;are&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="3736095">//</span><br>
<span class="lineno"></span><span class="comment" id="3736098">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;higher-level&nbsp;than&nbsp;a&nbsp;RoundTripper&nbsp;(such&nbsp;as&nbsp;Transport)</span><br>
<span class="lineno"></span><span class="comment" id="3736166">//&nbsp;and&nbsp;additionally&nbsp;handles&nbsp;HTTP&nbsp;details&nbsp;such&nbsp;as&nbsp;cookies&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3736227">//&nbsp;redirects.</span><br>
<span class="lineno">35</span><span class="keyword" id="3736241">type</span>&nbsp;<span class="ident" id="3736246">Client</span>&nbsp;<span class="keyword" id="3736253">struct</span>&nbsp;<span class="op" id="3736260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736263">//&nbsp;Transport&nbsp;specifies&nbsp;the&nbsp;mechanism&nbsp;by&nbsp;which&nbsp;individual</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736321">//&nbsp;HTTP&nbsp;requests&nbsp;are&nbsp;made.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736349">//&nbsp;If&nbsp;nil,&nbsp;DefaultTransport&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3736387">Transport</span>&nbsp;<span class="ident" id="3736397"><a href="/net/http/client.go.html#3738099">RoundTripper</a></span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736412">//&nbsp;CheckRedirect&nbsp;specifies&nbsp;the&nbsp;policy&nbsp;for&nbsp;handling&nbsp;redirects.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736475">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;not&nbsp;nil,&nbsp;the&nbsp;client&nbsp;calls&nbsp;it&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736535">//&nbsp;following&nbsp;an&nbsp;HTTP&nbsp;redirect.&nbsp;The&nbsp;arguments&nbsp;req&nbsp;and&nbsp;via&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736597">//&nbsp;the&nbsp;upcoming&nbsp;request&nbsp;and&nbsp;the&nbsp;requests&nbsp;made&nbsp;already,&nbsp;oldest</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736660">//&nbsp;first.&nbsp;If&nbsp;CheckRedirect&nbsp;returns&nbsp;an&nbsp;error,&nbsp;the&nbsp;Client&#39;s&nbsp;Get</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736723">//&nbsp;method&nbsp;returns&nbsp;both&nbsp;the&nbsp;previous&nbsp;Response&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736773">//&nbsp;CheckRedirect&#39;s&nbsp;error&nbsp;(wrapped&nbsp;in&nbsp;a&nbsp;url.Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736835">//&nbsp;issuing&nbsp;the&nbsp;Request&nbsp;req.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736864">//</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736868">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;nil,&nbsp;the&nbsp;Client&nbsp;uses&nbsp;its&nbsp;default&nbsp;policy,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3736933">//&nbsp;which&nbsp;is&nbsp;to&nbsp;stop&nbsp;after&nbsp;10&nbsp;consecutive&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3736985">CheckRedirect</span>&nbsp;<span class="keyword" id="3736999">func</span><span class="op" id="3737003">(</span><span class="ident" id="3737004">req</span>&nbsp;<span class="op" id="3737008">*</span><span class="ident" id="3737009"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3737016">,</span>&nbsp;<span class="ident" id="3737018">via</span>&nbsp;<span class="op" id="3737022">[</span><span class="op" id="3737023">]</span><span class="op" id="3737024">*</span><span class="ident" id="3737025"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3737032">)</span>&nbsp;<span class="builtintype" id="3737034">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737042">//&nbsp;Jar&nbsp;specifies&nbsp;the&nbsp;cookie&nbsp;jar.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737076">//&nbsp;If&nbsp;Jar&nbsp;is&nbsp;nil,&nbsp;cookies&nbsp;are&nbsp;not&nbsp;sent&nbsp;in&nbsp;requests&nbsp;and&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737140">//&nbsp;in&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3737158">Jar</span>&nbsp;<span class="ident" id="3737162"><a href="/net/http/jar.go.html#3787395">CookieJar</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737174">//&nbsp;Timeout&nbsp;specifies&nbsp;a&nbsp;time&nbsp;limit&nbsp;for&nbsp;requests&nbsp;made&nbsp;by&nbsp;this</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737235">//&nbsp;Client.&nbsp;The&nbsp;timeout&nbsp;includes&nbsp;connection&nbsp;time,&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737289">//&nbsp;redirects,&nbsp;and&nbsp;reading&nbsp;the&nbsp;response&nbsp;body.&nbsp;The&nbsp;timer&nbsp;remains</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737353">//&nbsp;running&nbsp;after&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do&nbsp;return&nbsp;and&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737410">//&nbsp;interrupt&nbsp;reading&nbsp;of&nbsp;the&nbsp;Response.Body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737454">//</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737458">//&nbsp;A&nbsp;Timeout&nbsp;of&nbsp;zero&nbsp;means&nbsp;no&nbsp;timeout.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737498">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737502">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;must&nbsp;support&nbsp;the&nbsp;CancelRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737560">//&nbsp;method&nbsp;or&nbsp;Client&nbsp;will&nbsp;return&nbsp;errors&nbsp;when&nbsp;attempting&nbsp;to&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737624">//&nbsp;a&nbsp;request&nbsp;with&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do.&nbsp;Client&#39;s&nbsp;default</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3737684">//&nbsp;Transport&nbsp;(DefaultTransport)&nbsp;supports&nbsp;CancelRequest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3737741">Timeout</span>&nbsp;<span class="ident" id="3737749"><a href="/net/http/client.go.html#3735765">time</a></span><span class="op" id="3737753">.</span><span class="ident" id="3737754">Duration</span><br>
<span class="lineno"></span><span class="op" id="3737763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3737766">//&nbsp;DefaultClient&nbsp;is&nbsp;the&nbsp;default&nbsp;Client&nbsp;and&nbsp;is&nbsp;used&nbsp;by&nbsp;Get,&nbsp;Head,&nbsp;and&nbsp;Post.</span><br>
<span class="lineno">75</span><span class="keyword" id="3737841">var</span>&nbsp;<span class="ident" id="3737845">DefaultClient</span>&nbsp;<span class="op" id="3737859">=</span>&nbsp;<span class="op" id="3737861">&amp;</span><span class="ident" id="3737862"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3737868">{</span><span class="op" id="3737869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3737872">//&nbsp;RoundTripper&nbsp;is&nbsp;an&nbsp;interface&nbsp;representing&nbsp;the&nbsp;ability&nbsp;to&nbsp;execute&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3737942">//&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;obtaining&nbsp;the&nbsp;Response&nbsp;for&nbsp;a&nbsp;given&nbsp;Request.</span><br>
<span class="lineno"></span><span class="comment" id="3738014">//</span><br>
<span class="lineno">80</span><span class="comment" id="3738017">//&nbsp;A&nbsp;RoundTripper&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple</span><br>
<span class="lineno"></span><span class="comment" id="3738079">//&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="3738094">type</span>&nbsp;<span class="ident" id="3738099">RoundTripper</span>&nbsp;<span class="keyword" id="3738112">interface</span>&nbsp;<span class="op" id="3738122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738125">//&nbsp;RoundTrip&nbsp;executes&nbsp;a&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738185">//&nbsp;the&nbsp;Response&nbsp;for&nbsp;the&nbsp;request&nbsp;req.&nbsp;&nbsp;RoundTrip&nbsp;should&nbsp;not</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738245">//&nbsp;attempt&nbsp;to&nbsp;interpret&nbsp;the&nbsp;response.&nbsp;&nbsp;In&nbsp;particular,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738300">//&nbsp;RoundTrip&nbsp;must&nbsp;return&nbsp;err&nbsp;==&nbsp;nil&nbsp;if&nbsp;it&nbsp;obtained&nbsp;a&nbsp;response,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738364">//&nbsp;regardless&nbsp;of&nbsp;the&nbsp;response&#39;s&nbsp;HTTP&nbsp;status&nbsp;code.&nbsp;&nbsp;A&nbsp;non-nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738426">//&nbsp;err&nbsp;should&nbsp;be&nbsp;reserved&nbsp;for&nbsp;failure&nbsp;to&nbsp;obtain&nbsp;a&nbsp;response.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738487">//&nbsp;Similarly,&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;attempt&nbsp;to&nbsp;handle</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738541">//&nbsp;higher-level&nbsp;protocol&nbsp;details&nbsp;such&nbsp;as&nbsp;redirects,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738594">//&nbsp;authentication,&nbsp;or&nbsp;cookies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738626">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738630">//&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;modify&nbsp;the&nbsp;request,&nbsp;except&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738686">//&nbsp;consuming&nbsp;and&nbsp;closing&nbsp;the&nbsp;Body,&nbsp;including&nbsp;on&nbsp;errors.&nbsp;The</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738747">//&nbsp;request&#39;s&nbsp;URL&nbsp;and&nbsp;Header&nbsp;fields&nbsp;are&nbsp;guaranteed&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3738804">//&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3738821">RoundTrip</span><span class="op" id="3738830">(</span><span class="op" id="3738831">*</span><span class="ident" id="3738832"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3738839">)</span>&nbsp;<span class="op" id="3738841">(</span><span class="op" id="3738842">*</span><span class="ident" id="3738843"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3738851">,</span>&nbsp;<span class="builtintype" id="3738853">error</span><span class="op" id="3738858">)</span><br>
<span class="lineno"></span><span class="op" id="3738860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3738863">//&nbsp;Given&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host&#34;,&nbsp;&#34;host:port&#34;,&nbsp;or&nbsp;&#34;[ipv6::address]:port&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="3738941">//&nbsp;return&nbsp;true&nbsp;if&nbsp;the&nbsp;string&nbsp;includes&nbsp;a&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="3738987">func</span>&nbsp;<span class="ident" id="3738992">hasPort</span><span class="op" id="3738999">(</span><span class="ident" id="3739000">s</span>&nbsp;<span class="builtintype" id="3739002">string</span><span class="op" id="3739008">)</span>&nbsp;<span class="builtintype" id="3739010">bool</span>&nbsp;<span class="op" id="3739015">{</span>&nbsp;<span class="keyword" id="3739017">return</span>&nbsp;<span class="ident" id="3739024"><a href="/net/http/client.go.html#3735746">strings</a></span><span class="op" id="3739031">.</span><span class="ident" id="3739032">LastIndex</span><span class="op" id="3739041">(</span><span class="ident" id="3739042"><a href="/net/http/client.go.html#3739000">s</a></span><span class="op" id="3739043">,</span>&nbsp;<span class="string" id="3739045">&#34;:&#34;</span><span class="op" id="3739048">)</span>&nbsp;<span class="op" id="3739050">&gt;</span>&nbsp;<span class="ident" id="3739052"><a href="/net/http/client.go.html#3735746">strings</a></span><span class="op" id="3739059">.</span><span class="ident" id="3739060">LastIndex</span><span class="op" id="3739069">(</span><span class="ident" id="3739070"><a href="/net/http/client.go.html#3739000">s</a></span><span class="op" id="3739071">,</span>&nbsp;<span class="string" id="3739073">&#34;]&#34;</span><span class="op" id="3739076">)</span>&nbsp;<span class="op" id="3739078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3739081">//&nbsp;refererForURL&nbsp;returns&nbsp;a&nbsp;referer&nbsp;without&nbsp;any&nbsp;authentication&nbsp;info&nbsp;or</span><br>
<span class="lineno">105</span><span class="comment" id="3739151">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;if&nbsp;lastReq&nbsp;scheme&nbsp;is&nbsp;https&nbsp;and&nbsp;newReq&nbsp;scheme&nbsp;is&nbsp;http.</span><br>
<span class="lineno"></span><span class="keyword" id="3739224">func</span>&nbsp;<span class="ident" id="3739229">refererForURL</span><span class="op" id="3739242">(</span><span class="ident" id="3739243">lastReq</span><span class="op" id="3739250">,</span>&nbsp;<span class="ident" id="3739252">newReq</span>&nbsp;<span class="op" id="3739259">*</span><span class="ident" id="3739260"><a href="/net/http/client.go.html#3735735">url</a></span><span class="op" id="3739263">.</span><span class="ident" id="3739264">URL</span><span class="op" id="3739267">)</span>&nbsp;<span class="builtintype" id="3739269">string</span>&nbsp;<span class="op" id="3739276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739279">//&nbsp;https://tools.ietf.org/html/rfc7231#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739333">//&nbsp;&nbsp;&nbsp;&#34;Clients&nbsp;SHOULD&nbsp;NOT&nbsp;include&nbsp;a&nbsp;Referer&nbsp;header&nbsp;field&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739395">//&nbsp;&nbsp;&nbsp;&nbsp;(non-secure)&nbsp;HTTP&nbsp;request&nbsp;if&nbsp;the&nbsp;referring&nbsp;page&nbsp;was</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739454">//&nbsp;&nbsp;&nbsp;&nbsp;transferred&nbsp;with&nbsp;a&nbsp;secure&nbsp;protocol.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3739498">if</span>&nbsp;<span class="ident" id="3739501"><a href="/net/http/client.go.html#3739243">lastReq</a></span><span class="op" id="3739508">.</span><span class="ident" id="3739509">Scheme</span>&nbsp;<span class="op" id="3739516">==</span>&nbsp;<span class="string" id="3739519">&#34;https&#34;</span>&nbsp;<span class="op" id="3739527">&amp;&amp;</span>&nbsp;<span class="ident" id="3739530"><a href="/net/http/client.go.html#3739252">newReq</a></span><span class="op" id="3739536">.</span><span class="ident" id="3739537">Scheme</span>&nbsp;<span class="op" id="3739544">==</span>&nbsp;<span class="string" id="3739547">&#34;http&#34;</span>&nbsp;<span class="op" id="3739554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3739558">return</span>&nbsp;<span class="string" id="3739565">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3739569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3739572">referer</span>&nbsp;<span class="op" id="3739580">:=</span>&nbsp;<span class="ident" id="3739583"><a href="/net/http/client.go.html#3739243">lastReq</a></span><span class="op" id="3739590">.</span><span class="ident" id="3739591">String</span><span class="op" id="3739597">(</span><span class="op" id="3739598">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3739601">if</span>&nbsp;<span class="ident" id="3739604"><a href="/net/http/client.go.html#3739243">lastReq</a></span><span class="op" id="3739611">.</span><span class="ident" id="3739612">User</span>&nbsp;<span class="op" id="3739617">!=</span>&nbsp;<span class="ident" id="3739620">nil</span>&nbsp;<span class="op" id="3739624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739628">//&nbsp;This&nbsp;is&nbsp;not&nbsp;very&nbsp;efficient,&nbsp;but&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739684">//&nbsp;do&nbsp;without:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739701">//&nbsp;-&nbsp;introducing&nbsp;a&nbsp;new&nbsp;method&nbsp;on&nbsp;URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739740">//&nbsp;-&nbsp;creating&nbsp;a&nbsp;race&nbsp;condition</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739773">//&nbsp;-&nbsp;copying&nbsp;the&nbsp;URL&nbsp;struct&nbsp;manually,&nbsp;which&nbsp;would&nbsp;cause</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3739831">//&nbsp;&nbsp;&nbsp;maintenance&nbsp;problems&nbsp;down&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3739873">auth</span>&nbsp;<span class="op" id="3739878">:=</span>&nbsp;<span class="ident" id="3739881"><a href="/net/http/client.go.html#3739243">lastReq</a></span><span class="op" id="3739888">.</span><span class="ident" id="3739889">User</span><span class="op" id="3739893">.</span><span class="ident" id="3739894">String</span><span class="op" id="3739900">(</span><span class="op" id="3739901">)</span>&nbsp;<span class="op" id="3739903">+</span>&nbsp;<span class="string" id="3739905">&#34;@&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3739911"><a href="/net/http/client.go.html#3739572">referer</a></span>&nbsp;<span class="op" id="3739919">=</span>&nbsp;<span class="ident" id="3739921"><a href="/net/http/client.go.html#3735746">strings</a></span><span class="op" id="3739928">.</span><span class="ident" id="3739929">Replace</span><span class="op" id="3739936">(</span><span class="ident" id="3739937"><a href="/net/http/client.go.html#3739572">referer</a></span><span class="op" id="3739944">,</span>&nbsp;<span class="ident" id="3739946"><a href="/net/http/client.go.html#3739873">auth</a></span><span class="op" id="3739950">,</span>&nbsp;<span class="string" id="3739952">&#34;&#34;</span><span class="op" id="3739954">,</span>&nbsp;<span class="num" id="3739956">1</span><span class="op" id="3739957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3739960">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3739963">return</span>&nbsp;<span class="ident" id="3739970"><a href="/net/http/client.go.html#3739572">referer</a></span><br>
<span class="lineno"></span><span class="op" id="3739978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3739981">//&nbsp;Used&nbsp;in&nbsp;Send&nbsp;to&nbsp;implement&nbsp;io.ReadCloser&nbsp;by&nbsp;bundling&nbsp;together&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3740049">//&nbsp;bufio.Reader&nbsp;through&nbsp;which&nbsp;we&nbsp;read&nbsp;the&nbsp;response,&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">130</span><span class="comment" id="3740120">//&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3740143">type</span>&nbsp;<span class="ident" id="3740148">readClose</span>&nbsp;<span class="keyword" id="3740158">struct</span>&nbsp;<span class="op" id="3740165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3740168"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3740170">.</span><span class="ident" id="3740171">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3740179"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3740181">.</span><span class="ident" id="3740182">Closer</span><br>
<span class="lineno"></span><span class="op" id="3740189">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3740192">func</span>&nbsp;<span class="op" id="3740197">(</span><span class="ident" id="3740198">c</span>&nbsp;<span class="op" id="3740200">*</span><span class="ident" id="3740201"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3740207">)</span>&nbsp;<span class="ident" id="3740209">send</span><span class="op" id="3740213">(</span><span class="ident" id="3740214">req</span>&nbsp;<span class="op" id="3740218">*</span><span class="ident" id="3740219"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3740226">)</span>&nbsp;<span class="op" id="3740228">(</span><span class="op" id="3740229">*</span><span class="ident" id="3740230"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3740238">,</span>&nbsp;<span class="builtintype" id="3740240">error</span><span class="op" id="3740245">)</span>&nbsp;<span class="op" id="3740247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740250">if</span>&nbsp;<span class="ident" id="3740253"><a href="/net/http/client.go.html#3740198">c</a></span><span class="op" id="3740254">.</span><span class="ident" id="3740255">Jar</span>&nbsp;<span class="op" id="3740259">!=</span>&nbsp;<span class="ident" id="3740262">nil</span>&nbsp;<span class="op" id="3740266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740270">for</span>&nbsp;<span class="ident" id="3740274">_</span><span class="op" id="3740275">,</span>&nbsp;<span class="ident" id="3740277">cookie</span>&nbsp;<span class="op" id="3740284">:=</span>&nbsp;<span class="keyword" id="3740287">range</span>&nbsp;<span class="ident" id="3740293"><a href="/net/http/client.go.html#3740198">c</a></span><span class="op" id="3740294">.</span><span class="ident" id="3740295">Jar</span><span class="op" id="3740298">.</span><span class="ident" id="3740299">Cookies</span><span class="op" id="3740306">(</span><span class="ident" id="3740307"><a href="/net/http/client.go.html#3740214">req</a></span><span class="op" id="3740310">.</span><span class="ident" id="3740311">URL</span><span class="op" id="3740314">)</span>&nbsp;<span class="op" id="3740316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3740321"><a href="/net/http/client.go.html#3740214">req</a></span><span class="op" id="3740324">.</span><span class="ident" id="3740325">AddCookie</span><span class="op" id="3740334">(</span><span class="ident" id="3740335"><a href="/net/http/client.go.html#3740277">cookie</a></span><span class="op" id="3740341">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3740345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3740348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3740351">resp</span><span class="op" id="3740355">,</span>&nbsp;<span class="ident" id="3740357">err</span>&nbsp;<span class="op" id="3740361">:=</span>&nbsp;<span class="ident" id="3740364"><a href="/net/http/client.go.html#3741877">send</a></span><span class="op" id="3740368">(</span><span class="ident" id="3740369"><a href="/net/http/client.go.html#3740214">req</a></span><span class="op" id="3740372">,</span>&nbsp;<span class="ident" id="3740374"><a href="/net/http/client.go.html#3740198">c</a></span><span class="op" id="3740375">.</span><span class="ident" id="3740376">transport</span><span class="op" id="3740385">(</span><span class="op" id="3740386">)</span><span class="op" id="3740387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740390">if</span>&nbsp;<span class="ident" id="3740393"><a href="/net/http/client.go.html#3740357">err</a></span>&nbsp;<span class="op" id="3740397">!=</span>&nbsp;<span class="ident" id="3740400">nil</span>&nbsp;<span class="op" id="3740404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740408">return</span>&nbsp;<span class="ident" id="3740415">nil</span><span class="op" id="3740418">,</span>&nbsp;<span class="ident" id="3740420"><a href="/net/http/client.go.html#3740357">err</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3740425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740428">if</span>&nbsp;<span class="ident" id="3740431"><a href="/net/http/client.go.html#3740198">c</a></span><span class="op" id="3740432">.</span><span class="ident" id="3740433">Jar</span>&nbsp;<span class="op" id="3740437">!=</span>&nbsp;<span class="ident" id="3740440">nil</span>&nbsp;<span class="op" id="3740444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740448">if</span>&nbsp;<span class="ident" id="3740451">rc</span>&nbsp;<span class="op" id="3740454">:=</span>&nbsp;<span class="ident" id="3740457"><a href="/net/http/client.go.html#3740351">resp</a></span><span class="op" id="3740461">.</span><span class="ident" id="3740462">Cookies</span><span class="op" id="3740469">(</span><span class="op" id="3740470">)</span><span class="op" id="3740471">;</span>&nbsp;<span class="builtinfunc" id="3740473">len</span><span class="op" id="3740476">(</span><span class="ident" id="3740477"><a href="/net/http/client.go.html#3740451">rc</a></span><span class="op" id="3740479">)</span>&nbsp;<span class="op" id="3740481">&gt;</span>&nbsp;<span class="num" id="3740483">0</span>&nbsp;<span class="op" id="3740485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3740490"><a href="/net/http/client.go.html#3740198">c</a></span><span class="op" id="3740491">.</span><span class="ident" id="3740492">Jar</span><span class="op" id="3740495">.</span><span class="ident" id="3740496">SetCookies</span><span class="op" id="3740506">(</span><span class="ident" id="3740507"><a href="/net/http/client.go.html#3740214">req</a></span><span class="op" id="3740510">.</span><span class="ident" id="3740511">URL</span><span class="op" id="3740514">,</span>&nbsp;<span class="ident" id="3740516"><a href="/net/http/client.go.html#3740451">rc</a></span><span class="op" id="3740518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3740522">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3740525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3740528">return</span>&nbsp;<span class="ident" id="3740535"><a href="/net/http/client.go.html#3740351">resp</a></span><span class="op" id="3740539">,</span>&nbsp;<span class="ident" id="3740541"><a href="/net/http/client.go.html#3740357">err</a></span><br>
<span class="lineno"></span><span class="op" id="3740545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3740548">//&nbsp;Do&nbsp;sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;and&nbsp;returns&nbsp;an&nbsp;HTTP&nbsp;response,&nbsp;following</span><br>
<span class="lineno">155</span><span class="comment" id="3740616">//&nbsp;policy&nbsp;(e.g.&nbsp;redirects,&nbsp;cookies,&nbsp;auth)&nbsp;as&nbsp;configured&nbsp;on&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3740687">//</span><br>
<span class="lineno"></span><span class="comment" id="3740690">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;caused&nbsp;by&nbsp;client&nbsp;policy&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3740750">//&nbsp;CheckRedirect),&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3740809">//&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno">160</span><span class="comment" id="3740855">//</span><br>
<span class="lineno"></span><span class="comment" id="3740858">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3740920">//</span><br>
<span class="lineno"></span><span class="comment" id="3740923">//&nbsp;Callers&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="3740987">//&nbsp;resp.Body&nbsp;is&nbsp;not&nbsp;closed,&nbsp;the&nbsp;Client&#39;s&nbsp;underlying&nbsp;RoundTripper</span><br>
<span class="lineno">165</span><span class="comment" id="3741052">//&nbsp;(typically&nbsp;Transport)&nbsp;may&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;re-use&nbsp;a&nbsp;persistent&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="3741120">//&nbsp;connection&nbsp;to&nbsp;the&nbsp;server&nbsp;for&nbsp;a&nbsp;subsequent&nbsp;&#34;keep-alive&#34;&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3741187">//</span><br>
<span class="lineno"></span><span class="comment" id="3741190">//&nbsp;The&nbsp;request&nbsp;Body,&nbsp;if&nbsp;non-nil,&nbsp;will&nbsp;be&nbsp;closed&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="3741256">//&nbsp;Transport,&nbsp;even&nbsp;on&nbsp;errors.</span><br>
<span class="lineno">170</span><span class="comment" id="3741286">//</span><br>
<span class="lineno"></span><span class="comment" id="3741289">//&nbsp;Generally&nbsp;Get,&nbsp;Post,&nbsp;or&nbsp;PostForm&nbsp;will&nbsp;be&nbsp;used&nbsp;instead&nbsp;of&nbsp;Do.</span><br>
<span class="lineno"></span><span class="keyword" id="3741353">func</span>&nbsp;<span class="op" id="3741358">(</span><span class="ident" id="3741359">c</span>&nbsp;<span class="op" id="3741361">*</span><span class="ident" id="3741362"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3741368">)</span>&nbsp;<span class="ident" id="3741370">Do</span><span class="op" id="3741372">(</span><span class="ident" id="3741373">req</span>&nbsp;<span class="op" id="3741377">*</span><span class="ident" id="3741378"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3741385">)</span>&nbsp;<span class="op" id="3741387">(</span><span class="ident" id="3741388">resp</span>&nbsp;<span class="op" id="3741393">*</span><span class="ident" id="3741394"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3741402">,</span>&nbsp;<span class="ident" id="3741404">err</span>&nbsp;<span class="builtintype" id="3741408">error</span><span class="op" id="3741413">)</span>&nbsp;<span class="op" id="3741415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741418">if</span>&nbsp;<span class="ident" id="3741421"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741424">.</span><span class="ident" id="3741425">Method</span>&nbsp;<span class="op" id="3741432">==</span>&nbsp;<span class="string" id="3741435">&#34;GET&#34;</span>&nbsp;<span class="op" id="3741441">||</span>&nbsp;<span class="ident" id="3741444"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741447">.</span><span class="ident" id="3741448">Method</span>&nbsp;<span class="op" id="3741455">==</span>&nbsp;<span class="string" id="3741458">&#34;HEAD&#34;</span>&nbsp;<span class="op" id="3741465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741469">return</span>&nbsp;<span class="ident" id="3741476"><a href="/net/http/client.go.html#3741359">c</a></span><span class="op" id="3741477">.</span><span class="ident" id="3741478">doFollowingRedirects</span><span class="op" id="3741498">(</span><span class="ident" id="3741499"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741502">,</span>&nbsp;<span class="ident" id="3741504"><a href="/net/http/client.go.html#3743399">shouldRedirectGet</a></span><span class="op" id="3741521">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3741524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741527">if</span>&nbsp;<span class="ident" id="3741530"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741533">.</span><span class="ident" id="3741534">Method</span>&nbsp;<span class="op" id="3741541">==</span>&nbsp;<span class="string" id="3741544">&#34;POST&#34;</span>&nbsp;<span class="op" id="3741551">||</span>&nbsp;<span class="ident" id="3741554"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741557">.</span><span class="ident" id="3741558">Method</span>&nbsp;<span class="op" id="3741565">==</span>&nbsp;<span class="string" id="3741568">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3741574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741578">return</span>&nbsp;<span class="ident" id="3741585"><a href="/net/http/client.go.html#3741359">c</a></span><span class="op" id="3741586">.</span><span class="ident" id="3741587">doFollowingRedirects</span><span class="op" id="3741607">(</span><span class="ident" id="3741608"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741611">,</span>&nbsp;<span class="ident" id="3741613"><a href="/net/http/client.go.html#3743694">shouldRedirectPost</a></span><span class="op" id="3741631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3741634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741637">return</span>&nbsp;<span class="ident" id="3741644"><a href="/net/http/client.go.html#3741359">c</a></span><span class="op" id="3741645">.</span><span class="ident" id="3741646">send</span><span class="op" id="3741650">(</span><span class="ident" id="3741651"><a href="/net/http/client.go.html#3741373">req</a></span><span class="op" id="3741654">)</span><br>
<span class="lineno">180</span><span class="op" id="3741656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3741659">func</span>&nbsp;<span class="op" id="3741664">(</span><span class="ident" id="3741665">c</span>&nbsp;<span class="op" id="3741667">*</span><span class="ident" id="3741668"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3741674">)</span>&nbsp;<span class="ident" id="3741676">transport</span><span class="op" id="3741685">(</span><span class="op" id="3741686">)</span>&nbsp;<span class="ident" id="3741688"><a href="/net/http/client.go.html#3738099">RoundTripper</a></span>&nbsp;<span class="op" id="3741701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741704">if</span>&nbsp;<span class="ident" id="3741707"><a href="/net/http/client.go.html#3741665">c</a></span><span class="op" id="3741708">.</span><span class="ident" id="3741709">Transport</span>&nbsp;<span class="op" id="3741719">!=</span>&nbsp;<span class="ident" id="3741722">nil</span>&nbsp;<span class="op" id="3741726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741730">return</span>&nbsp;<span class="ident" id="3741737"><a href="/net/http/client.go.html#3741665">c</a></span><span class="op" id="3741738">.</span><span class="ident" id="3741739">Transport</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3741750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741753">return</span>&nbsp;<span class="ident" id="3741760"><a href="/net/http/transport.go.html#3915725">DefaultTransport</a></span><br>
<span class="lineno"></span><span class="op" id="3741777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3741780">//&nbsp;send&nbsp;issues&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno">190</span><span class="comment" id="3741812">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3741872">func</span>&nbsp;<span class="ident" id="3741877">send</span><span class="op" id="3741881">(</span><span class="ident" id="3741882">req</span>&nbsp;<span class="op" id="3741886">*</span><span class="ident" id="3741887"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3741894">,</span>&nbsp;<span class="ident" id="3741896">t</span>&nbsp;<span class="ident" id="3741898"><a href="/net/http/client.go.html#3738099">RoundTripper</a></span><span class="op" id="3741910">)</span>&nbsp;<span class="op" id="3741912">(</span><span class="ident" id="3741913">resp</span>&nbsp;<span class="op" id="3741918">*</span><span class="ident" id="3741919"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3741927">,</span>&nbsp;<span class="ident" id="3741929">err</span>&nbsp;<span class="builtintype" id="3741933">error</span><span class="op" id="3741938">)</span>&nbsp;<span class="op" id="3741940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741943">if</span>&nbsp;<span class="ident" id="3741946"><a href="/net/http/client.go.html#3741896">t</a></span>&nbsp;<span class="op" id="3741948">==</span>&nbsp;<span class="ident" id="3741951">nil</span>&nbsp;<span class="op" id="3741955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3741959"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3741962">.</span><span class="ident" id="3741963">closeBody</span><span class="op" id="3741972">(</span><span class="op" id="3741973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3741977">return</span>&nbsp;<span class="ident" id="3741984">nil</span><span class="op" id="3741987">,</span>&nbsp;<span class="ident" id="3741989"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3741995">.</span><span class="ident" id="3741996">New</span><span class="op" id="3741999">(</span><span class="string" id="3742000">&#34;http:&nbsp;no&nbsp;Client.Transport&nbsp;or&nbsp;DefaultTransport&#34;</span><span class="op" id="3742047">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742054">if</span>&nbsp;<span class="ident" id="3742057"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742060">.</span><span class="ident" id="3742061">URL</span>&nbsp;<span class="op" id="3742065">==</span>&nbsp;<span class="ident" id="3742068">nil</span>&nbsp;<span class="op" id="3742072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742076"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742079">.</span><span class="ident" id="3742080">closeBody</span><span class="op" id="3742089">(</span><span class="op" id="3742090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742094">return</span>&nbsp;<span class="ident" id="3742101">nil</span><span class="op" id="3742104">,</span>&nbsp;<span class="ident" id="3742106"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3742112">.</span><span class="ident" id="3742113">New</span><span class="op" id="3742116">(</span><span class="string" id="3742117">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="3742140">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742147">if</span>&nbsp;<span class="ident" id="3742150"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742153">.</span><span class="ident" id="3742154">RequestURI</span>&nbsp;<span class="op" id="3742165">!=</span>&nbsp;<span class="string" id="3742168">&#34;&#34;</span>&nbsp;<span class="op" id="3742171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742175"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742178">.</span><span class="ident" id="3742179">closeBody</span><span class="op" id="3742188">(</span><span class="op" id="3742189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742193">return</span>&nbsp;<span class="ident" id="3742200">nil</span><span class="op" id="3742203">,</span>&nbsp;<span class="ident" id="3742205"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3742211">.</span><span class="ident" id="3742212">New</span><span class="op" id="3742215">(</span><span class="string" id="3742216">&#34;http:&nbsp;Request.RequestURI&nbsp;can&#39;t&nbsp;be&nbsp;set&nbsp;in&nbsp;client&nbsp;requests.&#34;</span><span class="op" id="3742275">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3742282">//&nbsp;Most&nbsp;the&nbsp;callers&nbsp;of&nbsp;send&nbsp;(Get,&nbsp;Post,&nbsp;et&nbsp;al)&nbsp;don&#39;t&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3742341">//&nbsp;Headers,&nbsp;leaving&nbsp;it&nbsp;uninitialized.&nbsp;&nbsp;We&nbsp;guarantee&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3742401">//&nbsp;Transport&nbsp;that&nbsp;this&nbsp;has&nbsp;been&nbsp;initialized,&nbsp;though.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742455">if</span>&nbsp;<span class="ident" id="3742458"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742461">.</span><span class="ident" id="3742462">Header</span>&nbsp;<span class="op" id="3742469">==</span>&nbsp;<span class="ident" id="3742472">nil</span>&nbsp;<span class="op" id="3742476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742480"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742483">.</span><span class="ident" id="3742484">Header</span>&nbsp;<span class="op" id="3742491">=</span>&nbsp;<span class="builtinfunc" id="3742493">make</span><span class="op" id="3742497">(</span><span class="ident" id="3742498"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3742504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742511">if</span>&nbsp;<span class="ident" id="3742514">u</span>&nbsp;<span class="op" id="3742516">:=</span>&nbsp;<span class="ident" id="3742519"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742522">.</span><span class="ident" id="3742523">URL</span><span class="op" id="3742526">.</span><span class="ident" id="3742527">User</span><span class="op" id="3742531">;</span>&nbsp;<span class="ident" id="3742533"><a href="/net/http/client.go.html#3742514">u</a></span>&nbsp;<span class="op" id="3742535">!=</span>&nbsp;<span class="ident" id="3742538">nil</span>&nbsp;<span class="op" id="3742542">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742546">username</span>&nbsp;<span class="op" id="3742555">:=</span>&nbsp;<span class="ident" id="3742558"><a href="/net/http/client.go.html#3742514">u</a></span><span class="op" id="3742559">.</span><span class="ident" id="3742560">Username</span><span class="op" id="3742568">(</span><span class="op" id="3742569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742573">password</span><span class="op" id="3742581">,</span>&nbsp;<span class="ident" id="3742583">_</span>&nbsp;<span class="op" id="3742585">:=</span>&nbsp;<span class="ident" id="3742588"><a href="/net/http/client.go.html#3742514">u</a></span><span class="op" id="3742589">.</span><span class="ident" id="3742590">Password</span><span class="op" id="3742598">(</span><span class="op" id="3742599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742603"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742606">.</span><span class="ident" id="3742607">Header</span><span class="op" id="3742613">.</span><span class="ident" id="3742614">Set</span><span class="op" id="3742617">(</span><span class="string" id="3742618">&#34;Authorization&#34;</span><span class="op" id="3742633">,</span>&nbsp;<span class="string" id="3742635">&#34;Basic&nbsp;&#34;</span><span class="op" id="3742643">+</span><span class="ident" id="3742644"><a href="/net/http/client.go.html#3743145">basicAuth</a></span><span class="op" id="3742653">(</span><span class="ident" id="3742654"><a href="/net/http/client.go.html#3742546">username</a></span><span class="op" id="3742662">,</span>&nbsp;<span class="ident" id="3742664"><a href="/net/http/client.go.html#3742573">password</a></span><span class="op" id="3742672">)</span><span class="op" id="3742673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742679"><a href="/net/http/client.go.html#3741913">resp</a></span><span class="op" id="3742683">,</span>&nbsp;<span class="ident" id="3742685"><a href="/net/http/client.go.html#3741929">err</a></span>&nbsp;<span class="op" id="3742689">=</span>&nbsp;<span class="ident" id="3742691"><a href="/net/http/client.go.html#3741896">t</a></span><span class="op" id="3742692">.</span><span class="ident" id="3742693">RoundTrip</span><span class="op" id="3742702">(</span><span class="ident" id="3742703"><a href="/net/http/client.go.html#3741882">req</a></span><span class="op" id="3742706">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742709">if</span>&nbsp;<span class="ident" id="3742712"><a href="/net/http/client.go.html#3741929">err</a></span>&nbsp;<span class="op" id="3742716">!=</span>&nbsp;<span class="ident" id="3742719">nil</span>&nbsp;<span class="op" id="3742723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742727">if</span>&nbsp;<span class="ident" id="3742730"><a href="/net/http/client.go.html#3741913">resp</a></span>&nbsp;<span class="op" id="3742735">!=</span>&nbsp;<span class="ident" id="3742738">nil</span>&nbsp;<span class="op" id="3742742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3742747"><a href="/net/http/client.go.html#3735728">log</a></span><span class="op" id="3742750">.</span><span class="ident" id="3742751">Printf</span><span class="op" id="3742757">(</span><span class="string" id="3742758">&#34;RoundTripper&nbsp;returned&nbsp;a&nbsp;response&nbsp;&amp;&nbsp;error;&nbsp;ignoring&nbsp;response&#34;</span><span class="op" id="3742819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742827">return</span>&nbsp;<span class="ident" id="3742834">nil</span><span class="op" id="3742837">,</span>&nbsp;<span class="ident" id="3742839"><a href="/net/http/client.go.html#3741929">err</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3742844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3742847">return</span>&nbsp;<span class="ident" id="3742854"><a href="/net/http/client.go.html#3741913">resp</a></span><span class="op" id="3742858">,</span>&nbsp;<span class="ident" id="3742860">nil</span><br>
<span class="lineno"></span><span class="op" id="3742864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3742867">//&nbsp;See&nbsp;2&nbsp;(end&nbsp;of&nbsp;page&nbsp;4)&nbsp;http://www.ietf.org/rfc/rfc2617.txt</span><br>
<span class="lineno">230</span><span class="comment" id="3742928">//&nbsp;&#34;To&nbsp;receive&nbsp;authorization,&nbsp;the&nbsp;client&nbsp;sends&nbsp;the&nbsp;userid&nbsp;and&nbsp;password,</span><br>
<span class="lineno"></span><span class="comment" id="3743000">//&nbsp;separated&nbsp;by&nbsp;a&nbsp;single&nbsp;colon&nbsp;(&#34;:&#34;)&nbsp;character,&nbsp;within&nbsp;a&nbsp;base64</span><br>
<span class="lineno"></span><span class="comment" id="3743064">//&nbsp;encoded&nbsp;string&nbsp;in&nbsp;the&nbsp;credentials.&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3743103">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;urlencoded.</span><br>
<span class="lineno"></span><span class="keyword" id="3743140">func</span>&nbsp;<span class="ident" id="3743145">basicAuth</span><span class="op" id="3743154">(</span><span class="ident" id="3743155">username</span><span class="op" id="3743163">,</span>&nbsp;<span class="ident" id="3743165">password</span>&nbsp;<span class="builtintype" id="3743174">string</span><span class="op" id="3743180">)</span>&nbsp;<span class="builtintype" id="3743182">string</span>&nbsp;<span class="op" id="3743189">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3743192">auth</span>&nbsp;<span class="op" id="3743197">:=</span>&nbsp;<span class="ident" id="3743200"><a href="/net/http/client.go.html#3743155">username</a></span>&nbsp;<span class="op" id="3743209">+</span>&nbsp;<span class="string" id="3743211">&#34;:&#34;</span>&nbsp;<span class="op" id="3743215">+</span>&nbsp;<span class="ident" id="3743217"><a href="/net/http/client.go.html#3743165">password</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743227">return</span>&nbsp;<span class="ident" id="3743234"><a href="/net/http/client.go.html#3735673">base64</a></span><span class="op" id="3743240">.</span><span class="ident" id="3743241">StdEncoding</span><span class="op" id="3743252">.</span><span class="ident" id="3743253">EncodeToString</span><span class="op" id="3743267">(</span><span class="op" id="3743268">[</span><span class="op" id="3743269">]</span><span class="builtintype" id="3743270">byte</span><span class="op" id="3743274">(</span><span class="ident" id="3743275"><a href="/net/http/client.go.html#3743192">auth</a></span><span class="op" id="3743279">)</span><span class="op" id="3743280">)</span><br>
<span class="lineno"></span><span class="op" id="3743282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3743285">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Get&nbsp;utility&nbsp;should</span><br>
<span class="lineno">240</span><span class="comment" id="3743367">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="3743394">func</span>&nbsp;<span class="ident" id="3743399">shouldRedirectGet</span><span class="op" id="3743416">(</span><span class="ident" id="3743417">statusCode</span>&nbsp;<span class="builtintype" id="3743428">int</span><span class="op" id="3743431">)</span>&nbsp;<span class="builtintype" id="3743433">bool</span>&nbsp;<span class="op" id="3743438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743441">switch</span>&nbsp;<span class="ident" id="3743448"><a href="/net/http/client.go.html#3743417">statusCode</a></span>&nbsp;<span class="op" id="3743459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743462">case</span>&nbsp;<span class="ident" id="3743467"><a href="/net/http/status.go.html#3891944">StatusMovedPermanently</a></span><span class="op" id="3743489">,</span>&nbsp;<span class="ident" id="3743491"><a href="/net/http/status.go.html#3891975">StatusFound</a></span><span class="op" id="3743502">,</span>&nbsp;<span class="ident" id="3743504"><a href="/net/http/status.go.html#3892006">StatusSeeOther</a></span><span class="op" id="3743518">,</span>&nbsp;<span class="ident" id="3743520"><a href="/net/http/status.go.html#3892099">StatusTemporaryRedirect</a></span><span class="op" id="3743543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743547">return</span>&nbsp;<span class="ident" id="3743554">true</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3743560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743563">return</span>&nbsp;<span class="ident" id="3743570">false</span><br>
<span class="lineno"></span><span class="op" id="3743576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3743579">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Post&nbsp;utility&nbsp;should</span><br>
<span class="lineno">250</span><span class="comment" id="3743662">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="3743689">func</span>&nbsp;<span class="ident" id="3743694">shouldRedirectPost</span><span class="op" id="3743712">(</span><span class="ident" id="3743713">statusCode</span>&nbsp;<span class="builtintype" id="3743724">int</span><span class="op" id="3743727">)</span>&nbsp;<span class="builtintype" id="3743729">bool</span>&nbsp;<span class="op" id="3743734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743737">switch</span>&nbsp;<span class="ident" id="3743744"><a href="/net/http/client.go.html#3743713">statusCode</a></span>&nbsp;<span class="op" id="3743755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743758">case</span>&nbsp;<span class="ident" id="3743763"><a href="/net/http/status.go.html#3891975">StatusFound</a></span><span class="op" id="3743774">,</span>&nbsp;<span class="ident" id="3743776"><a href="/net/http/status.go.html#3892006">StatusSeeOther</a></span><span class="op" id="3743790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743794">return</span>&nbsp;<span class="ident" id="3743801">true</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3743807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3743810">return</span>&nbsp;<span class="ident" id="3743817">false</span><br>
<span class="lineno"></span><span class="op" id="3743823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3743826">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following</span><br>
<span class="lineno">260</span><span class="comment" id="3743909">//&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect,&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;10&nbsp;redirects:</span><br>
<span class="lineno"></span><span class="comment" id="3743987">//</span><br>
<span class="lineno"></span><span class="comment" id="3743990">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3744020">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="3744038">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">265</span><span class="comment" id="3744060">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3744091">//</span><br>
<span class="lineno"></span><span class="comment" id="3744094">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;there&nbsp;were&nbsp;too&nbsp;many&nbsp;redirects&nbsp;or&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span><span class="comment" id="3744163">//&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3744230">//&nbsp;error.</span><br>
<span class="lineno">270</span><span class="comment" id="3744240">//</span><br>
<span class="lineno"></span><span class="comment" id="3744243">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3744305">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3744365">//</span><br>
<span class="lineno"></span><span class="comment" id="3744368">//&nbsp;Get&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Get.</span><br>
<span class="lineno">275</span><span class="keyword" id="3744414">func</span>&nbsp;<span class="ident" id="3744419">Get</span><span class="op" id="3744422">(</span><span class="ident" id="3744423">url</span>&nbsp;<span class="builtintype" id="3744427">string</span><span class="op" id="3744433">)</span>&nbsp;<span class="op" id="3744435">(</span><span class="ident" id="3744436">resp</span>&nbsp;<span class="op" id="3744441">*</span><span class="ident" id="3744442"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3744450">,</span>&nbsp;<span class="ident" id="3744452">err</span>&nbsp;<span class="builtintype" id="3744456">error</span><span class="op" id="3744461">)</span>&nbsp;<span class="op" id="3744463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3744466">return</span>&nbsp;<span class="ident" id="3744473"><a href="/net/http/client.go.html#3737845">DefaultClient</a></span><span class="op" id="3744486">.</span><span class="ident" id="3744487">Get</span><span class="op" id="3744490">(</span><span class="ident" id="3744491"><a href="/net/http/client.go.html#3744423">url</a></span><span class="op" id="3744494">)</span><br>
<span class="lineno"></span><span class="op" id="3744496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3744499">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">280</span><span class="comment" id="3744572">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3744644">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3744680">//</span><br>
<span class="lineno"></span><span class="comment" id="3744683">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3744713">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">285</span><span class="comment" id="3744731">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="3744753">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3744784">//</span><br>
<span class="lineno"></span><span class="comment" id="3744787">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;the&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="3744856">//&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t</span><br>
<span class="lineno">290</span><span class="comment" id="3744926">//&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3744945">//</span><br>
<span class="lineno"></span><span class="comment" id="3744948">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3745010">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3745070">func</span>&nbsp;<span class="op" id="3745075">(</span><span class="ident" id="3745076">c</span>&nbsp;<span class="op" id="3745078">*</span><span class="ident" id="3745079"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3745085">)</span>&nbsp;<span class="ident" id="3745087">Get</span><span class="op" id="3745090">(</span><span class="ident" id="3745091">url</span>&nbsp;<span class="builtintype" id="3745095">string</span><span class="op" id="3745101">)</span>&nbsp;<span class="op" id="3745103">(</span><span class="ident" id="3745104">resp</span>&nbsp;<span class="op" id="3745109">*</span><span class="ident" id="3745110"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3745118">,</span>&nbsp;<span class="ident" id="3745120">err</span>&nbsp;<span class="builtintype" id="3745124">error</span><span class="op" id="3745129">)</span>&nbsp;<span class="op" id="3745131">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745134">req</span><span class="op" id="3745137">,</span>&nbsp;<span class="ident" id="3745139"><a href="/net/http/client.go.html#3745120">err</a></span>&nbsp;<span class="op" id="3745143">:=</span>&nbsp;<span class="ident" id="3745146"><a href="/net/http/request.go.html#3804993">NewRequest</a></span><span class="op" id="3745156">(</span><span class="string" id="3745157">&#34;GET&#34;</span><span class="op" id="3745162">,</span>&nbsp;<span class="ident" id="3745164"><a href="/net/http/client.go.html#3745091">url</a></span><span class="op" id="3745167">,</span>&nbsp;<span class="ident" id="3745169">nil</span><span class="op" id="3745172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745175">if</span>&nbsp;<span class="ident" id="3745178"><a href="/net/http/client.go.html#3745120">err</a></span>&nbsp;<span class="op" id="3745182">!=</span>&nbsp;<span class="ident" id="3745185">nil</span>&nbsp;<span class="op" id="3745189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745193">return</span>&nbsp;<span class="ident" id="3745200">nil</span><span class="op" id="3745203">,</span>&nbsp;<span class="ident" id="3745205"><a href="/net/http/client.go.html#3745120">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745213">return</span>&nbsp;<span class="ident" id="3745220"><a href="/net/http/client.go.html#3745076">c</a></span><span class="op" id="3745221">.</span><span class="ident" id="3745222">doFollowingRedirects</span><span class="op" id="3745242">(</span><span class="ident" id="3745243"><a href="/net/http/client.go.html#3745134">req</a></span><span class="op" id="3745246">,</span>&nbsp;<span class="ident" id="3745248"><a href="/net/http/client.go.html#3743399">shouldRedirectGet</a></span><span class="op" id="3745265">)</span><br>
<span class="lineno">300</span><span class="op" id="3745267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745270">func</span>&nbsp;<span class="op" id="3745275">(</span><span class="ident" id="3745276">c</span>&nbsp;<span class="op" id="3745278">*</span><span class="ident" id="3745279"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3745285">)</span>&nbsp;<span class="ident" id="3745287">doFollowingRedirects</span><span class="op" id="3745307">(</span><span class="ident" id="3745308">ireq</span>&nbsp;<span class="op" id="3745313">*</span><span class="ident" id="3745314"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3745321">,</span>&nbsp;<span class="ident" id="3745323">shouldRedirect</span>&nbsp;<span class="keyword" id="3745338">func</span><span class="op" id="3745342">(</span><span class="builtintype" id="3745343">int</span><span class="op" id="3745346">)</span>&nbsp;<span class="builtintype" id="3745348">bool</span><span class="op" id="3745352">)</span>&nbsp;<span class="op" id="3745354">(</span><span class="ident" id="3745355">resp</span>&nbsp;<span class="op" id="3745360">*</span><span class="ident" id="3745361"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3745369">,</span>&nbsp;<span class="ident" id="3745371">err</span>&nbsp;<span class="builtintype" id="3745375">error</span><span class="op" id="3745380">)</span>&nbsp;<span class="op" id="3745382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745385">var</span>&nbsp;<span class="ident" id="3745389">base</span>&nbsp;<span class="op" id="3745394">*</span><span class="ident" id="3745395"><a href="/net/http/client.go.html#3735735">url</a></span><span class="op" id="3745398">.</span><span class="ident" id="3745399">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745404">redirectChecker</span>&nbsp;<span class="op" id="3745420">:=</span>&nbsp;<span class="ident" id="3745423"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3745424">.</span><span class="ident" id="3745425">CheckRedirect</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745440">if</span>&nbsp;<span class="ident" id="3745443"><a href="/net/http/client.go.html#3745404">redirectChecker</a></span>&nbsp;<span class="op" id="3745459">==</span>&nbsp;<span class="ident" id="3745462">nil</span>&nbsp;<span class="op" id="3745466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745470"><a href="/net/http/client.go.html#3745404">redirectChecker</a></span>&nbsp;<span class="op" id="3745486">=</span>&nbsp;<span class="ident" id="3745488"><a href="/net/http/client.go.html#3748033">defaultCheckRedirect</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745513">var</span>&nbsp;<span class="ident" id="3745517">via</span>&nbsp;<span class="op" id="3745521">[</span><span class="op" id="3745522">]</span><span class="op" id="3745523">*</span><span class="ident" id="3745524"><a href="/net/http/request.go.html#3791418">Request</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745534">if</span>&nbsp;<span class="ident" id="3745537"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3745541">.</span><span class="ident" id="3745542">URL</span>&nbsp;<span class="op" id="3745546">==</span>&nbsp;<span class="ident" id="3745549">nil</span>&nbsp;<span class="op" id="3745553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745557"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3745561">.</span><span class="ident" id="3745562">closeBody</span><span class="op" id="3745571">(</span><span class="op" id="3745572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745576">return</span>&nbsp;<span class="ident" id="3745583">nil</span><span class="op" id="3745586">,</span>&nbsp;<span class="ident" id="3745588"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3745594">.</span><span class="ident" id="3745595">New</span><span class="op" id="3745598">(</span><span class="string" id="3745599">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="3745622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745629">var</span>&nbsp;<span class="ident" id="3745633">reqmu</span>&nbsp;<span class="ident" id="3745639"><a href="/net/http/client.go.html#3735757">sync</a></span><span class="op" id="3745643">.</span><span class="ident" id="3745644">Mutex</span>&nbsp;<span class="comment" id="3745650">//&nbsp;guards&nbsp;req</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745665">req</span>&nbsp;<span class="op" id="3745669">:=</span>&nbsp;<span class="ident" id="3745672"><a href="/net/http/client.go.html#3745308">ireq</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745679">var</span>&nbsp;<span class="ident" id="3745683">timer</span>&nbsp;<span class="op" id="3745689">*</span><span class="ident" id="3745690"><a href="/net/http/client.go.html#3735765">time</a></span><span class="op" id="3745694">.</span><span class="ident" id="3745695">Timer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745702">if</span>&nbsp;<span class="ident" id="3745705"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3745706">.</span><span class="ident" id="3745707">Timeout</span>&nbsp;<span class="op" id="3745715">&gt;</span>&nbsp;<span class="num" id="3745717">0</span>&nbsp;<span class="op" id="3745719">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745723">type</span>&nbsp;<span class="ident" id="3745728">canceler</span>&nbsp;<span class="keyword" id="3745737">interface</span>&nbsp;<span class="op" id="3745747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745752">CancelRequest</span><span class="op" id="3745765">(</span><span class="op" id="3745766">*</span><span class="ident" id="3745767"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3745774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745782">tr</span><span class="op" id="3745784">,</span>&nbsp;<span class="ident" id="3745786">ok</span>&nbsp;<span class="op" id="3745789">:=</span>&nbsp;<span class="ident" id="3745792"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3745793">.</span><span class="ident" id="3745794">transport</span><span class="op" id="3745803">(</span><span class="op" id="3745804">)</span><span class="op" id="3745805">.</span><span class="op" id="3745806">(</span><span class="ident" id="3745807"><a href="/net/http/client.go.html#3745728">canceler</a></span><span class="op" id="3745815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745819">if</span>&nbsp;<span class="op" id="3745822">!</span><span class="ident" id="3745823"><a href="/net/http/client.go.html#3745786">ok</a></span>&nbsp;<span class="op" id="3745826">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745831">return</span>&nbsp;<span class="ident" id="3745838">nil</span><span class="op" id="3745841">,</span>&nbsp;<span class="ident" id="3745843"><a href="/net/http/client.go.html#3735702">fmt</a></span><span class="op" id="3745846">.</span><span class="ident" id="3745847">Errorf</span><span class="op" id="3745853">(</span><span class="string" id="3745854">&#34;net/http:&nbsp;Client&nbsp;Transport&nbsp;of&nbsp;type&nbsp;%T&nbsp;doesn&#39;t&nbsp;support&nbsp;CancelRequest;&nbsp;Timeout&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3745946">,</span>&nbsp;<span class="ident" id="3745948"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3745949">.</span><span class="ident" id="3745950">transport</span><span class="op" id="3745959">(</span><span class="op" id="3745960">)</span><span class="op" id="3745961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745969"><a href="/net/http/client.go.html#3745683">timer</a></span>&nbsp;<span class="op" id="3745975">=</span>&nbsp;<span class="ident" id="3745977"><a href="/net/http/client.go.html#3735765">time</a></span><span class="op" id="3745981">.</span><span class="ident" id="3745982">AfterFunc</span><span class="op" id="3745991">(</span><span class="ident" id="3745992"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3745993">.</span><span class="ident" id="3745994">Timeout</span><span class="op" id="3746001">,</span>&nbsp;<span class="keyword" id="3746003">func</span><span class="op" id="3746007">(</span><span class="op" id="3746008">)</span>&nbsp;<span class="op" id="3746010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746015"><a href="/net/http/client.go.html#3745633">reqmu</a></span><span class="op" id="3746020">.</span><span class="ident" id="3746021">Lock</span><span class="op" id="3746025">(</span><span class="op" id="3746026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746031">defer</span>&nbsp;<span class="ident" id="3746037"><a href="/net/http/client.go.html#3745633">reqmu</a></span><span class="op" id="3746042">.</span><span class="ident" id="3746043">Unlock</span><span class="op" id="3746049">(</span><span class="op" id="3746050">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746055"><a href="/net/http/client.go.html#3745782">tr</a></span><span class="op" id="3746057">.</span><span class="ident" id="3746058">CancelRequest</span><span class="op" id="3746071">(</span><span class="ident" id="3746072"><a href="/net/http/client.go.html#3745665">req</a></span><span class="op" id="3746075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746079">}</span><span class="op" id="3746080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746087">urlStr</span>&nbsp;<span class="op" id="3746094">:=</span>&nbsp;<span class="string" id="3746097">&#34;&#34;</span>&nbsp;<span class="comment" id="3746100">//&nbsp;next&nbsp;relative&nbsp;or&nbsp;absolute&nbsp;URL&nbsp;to&nbsp;fetch&nbsp;(after&nbsp;first&nbsp;request)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746165">redirectFailed</span>&nbsp;<span class="op" id="3746180">:=</span>&nbsp;<span class="ident" id="3746183">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746190">for</span>&nbsp;<span class="ident" id="3746194">redirect</span>&nbsp;<span class="op" id="3746203">:=</span>&nbsp;<span class="num" id="3746206">0</span><span class="op" id="3746207">;</span>&nbsp;<span class="op" id="3746209">;</span>&nbsp;<span class="ident" id="3746211"><a href="/net/http/client.go.html#3746194">redirect</a></span><span class="op" id="3746219">++</span>&nbsp;<span class="op" id="3746222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746226">if</span>&nbsp;<span class="ident" id="3746229"><a href="/net/http/client.go.html#3746194">redirect</a></span>&nbsp;<span class="op" id="3746238">!=</span>&nbsp;<span class="num" id="3746241">0</span>&nbsp;<span class="op" id="3746243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746248">nreq</span>&nbsp;<span class="op" id="3746253">:=</span>&nbsp;<span class="builtinfunc" id="3746256">new</span><span class="op" id="3746259">(</span><span class="ident" id="3746260"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3746267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746272"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746276">.</span><span class="ident" id="3746277">Method</span>&nbsp;<span class="op" id="3746284">=</span>&nbsp;<span class="ident" id="3746286"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3746290">.</span><span class="ident" id="3746291">Method</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746301">if</span>&nbsp;<span class="ident" id="3746304"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3746308">.</span><span class="ident" id="3746309">Method</span>&nbsp;<span class="op" id="3746316">==</span>&nbsp;<span class="string" id="3746319">&#34;POST&#34;</span>&nbsp;<span class="op" id="3746326">||</span>&nbsp;<span class="ident" id="3746329"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3746333">.</span><span class="ident" id="3746334">Method</span>&nbsp;<span class="op" id="3746341">==</span>&nbsp;<span class="string" id="3746344">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3746350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746356"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746360">.</span><span class="ident" id="3746361">Method</span>&nbsp;<span class="op" id="3746368">=</span>&nbsp;<span class="string" id="3746370">&#34;GET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746384"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746388">.</span><span class="ident" id="3746389">Header</span>&nbsp;<span class="op" id="3746396">=</span>&nbsp;<span class="builtinfunc" id="3746398">make</span><span class="op" id="3746402">(</span><span class="ident" id="3746403"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3746409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746414"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746418">.</span><span class="ident" id="3746419">URL</span><span class="op" id="3746422">,</span>&nbsp;<span class="ident" id="3746424"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746428">=</span>&nbsp;<span class="ident" id="3746430"><a href="/net/http/client.go.html#3745389">base</a></span><span class="op" id="3746434">.</span><span class="ident" id="3746435">Parse</span><span class="op" id="3746440">(</span><span class="ident" id="3746441"><a href="/net/http/client.go.html#3746087">urlStr</a></span><span class="op" id="3746447">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746452">if</span>&nbsp;<span class="ident" id="3746455"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746459">!=</span>&nbsp;<span class="ident" id="3746462">nil</span>&nbsp;<span class="op" id="3746466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746472">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746486">if</span>&nbsp;<span class="builtinfunc" id="3746489">len</span><span class="op" id="3746492">(</span><span class="ident" id="3746493"><a href="/net/http/client.go.html#3745517">via</a></span><span class="op" id="3746496">)</span>&nbsp;<span class="op" id="3746498">&gt;</span>&nbsp;<span class="num" id="3746500">0</span>&nbsp;<span class="op" id="3746502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3746508">//&nbsp;Add&nbsp;the&nbsp;Referer&nbsp;header.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746539">lastReq</span>&nbsp;<span class="op" id="3746547">:=</span>&nbsp;<span class="ident" id="3746550"><a href="/net/http/client.go.html#3745517">via</a></span><span class="op" id="3746553">[</span><span class="builtinfunc" id="3746554">len</span><span class="op" id="3746557">(</span><span class="ident" id="3746558"><a href="/net/http/client.go.html#3745517">via</a></span><span class="op" id="3746561">)</span><span class="op" id="3746562">-</span><span class="num" id="3746563">1</span><span class="op" id="3746564">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746570">if</span>&nbsp;<span class="ident" id="3746573">ref</span>&nbsp;<span class="op" id="3746577">:=</span>&nbsp;<span class="ident" id="3746580"><a href="/net/http/client.go.html#3739229">refererForURL</a></span><span class="op" id="3746593">(</span><span class="ident" id="3746594"><a href="/net/http/client.go.html#3746539">lastReq</a></span><span class="op" id="3746601">.</span><span class="ident" id="3746602">URL</span><span class="op" id="3746605">,</span>&nbsp;<span class="ident" id="3746607"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746611">.</span><span class="ident" id="3746612">URL</span><span class="op" id="3746615">)</span><span class="op" id="3746616">;</span>&nbsp;<span class="ident" id="3746618"><a href="/net/http/client.go.html#3746573">ref</a></span>&nbsp;<span class="op" id="3746622">!=</span>&nbsp;<span class="string" id="3746625">&#34;&#34;</span>&nbsp;<span class="op" id="3746628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746635"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746639">.</span><span class="ident" id="3746640">Header</span><span class="op" id="3746646">.</span><span class="ident" id="3746647">Set</span><span class="op" id="3746650">(</span><span class="string" id="3746651">&#34;Referer&#34;</span><span class="op" id="3746660">,</span>&nbsp;<span class="ident" id="3746662"><a href="/net/http/client.go.html#3746573">ref</a></span><span class="op" id="3746665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746678"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746682">=</span>&nbsp;<span class="ident" id="3746684"><a href="/net/http/client.go.html#3745404">redirectChecker</a></span><span class="op" id="3746699">(</span><span class="ident" id="3746700"><a href="/net/http/client.go.html#3746248">nreq</a></span><span class="op" id="3746704">,</span>&nbsp;<span class="ident" id="3746706"><a href="/net/http/client.go.html#3745517">via</a></span><span class="op" id="3746709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746715">if</span>&nbsp;<span class="ident" id="3746718"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746722">!=</span>&nbsp;<span class="ident" id="3746725">nil</span>&nbsp;<span class="op" id="3746729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746736"><a href="/net/http/client.go.html#3746165">redirectFailed</a></span>&nbsp;<span class="op" id="3746751">=</span>&nbsp;<span class="ident" id="3746753">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746763">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746773">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746783"><a href="/net/http/client.go.html#3745633">reqmu</a></span><span class="op" id="3746788">.</span><span class="ident" id="3746789">Lock</span><span class="op" id="3746793">(</span><span class="op" id="3746794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746799"><a href="/net/http/client.go.html#3745665">req</a></span>&nbsp;<span class="op" id="3746803">=</span>&nbsp;<span class="ident" id="3746805"><a href="/net/http/client.go.html#3746248">nreq</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746813"><a href="/net/http/client.go.html#3745633">reqmu</a></span><span class="op" id="3746818">.</span><span class="ident" id="3746819">Unlock</span><span class="op" id="3746825">(</span><span class="op" id="3746826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746830">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746835"><a href="/net/http/client.go.html#3746087">urlStr</a></span>&nbsp;<span class="op" id="3746842">=</span>&nbsp;<span class="ident" id="3746844"><a href="/net/http/client.go.html#3745665">req</a></span><span class="op" id="3746847">.</span><span class="ident" id="3746848">URL</span><span class="op" id="3746851">.</span><span class="ident" id="3746852">String</span><span class="op" id="3746858">(</span><span class="op" id="3746859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746863">if</span>&nbsp;<span class="ident" id="3746866"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3746870">,</span>&nbsp;<span class="ident" id="3746872"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746876">=</span>&nbsp;<span class="ident" id="3746878"><a href="/net/http/client.go.html#3745276">c</a></span><span class="op" id="3746879">.</span><span class="ident" id="3746880">send</span><span class="op" id="3746884">(</span><span class="ident" id="3746885"><a href="/net/http/client.go.html#3745665">req</a></span><span class="op" id="3746888">)</span><span class="op" id="3746889">;</span>&nbsp;<span class="ident" id="3746891"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3746895">!=</span>&nbsp;<span class="ident" id="3746898">nil</span>&nbsp;<span class="op" id="3746902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746907">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746915">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746920">if</span>&nbsp;<span class="ident" id="3746923"><a href="/net/http/client.go.html#3745323">shouldRedirect</a></span><span class="op" id="3746937">(</span><span class="ident" id="3746938"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3746942">.</span><span class="ident" id="3746943">StatusCode</span><span class="op" id="3746953">)</span>&nbsp;<span class="op" id="3746955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3746960">//&nbsp;Read&nbsp;the&nbsp;body&nbsp;if&nbsp;small&nbsp;so&nbsp;underlying&nbsp;TCP&nbsp;connection&nbsp;will&nbsp;be&nbsp;re-used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747035">//&nbsp;No&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;errors:&nbsp;if&nbsp;it&nbsp;fails,&nbsp;Transport&nbsp;won&#39;t&nbsp;reuse&nbsp;it&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747116">const</span>&nbsp;<span class="ident" id="3747122">maxBodySlurpSize</span>&nbsp;<span class="op" id="3747139">=</span>&nbsp;<span class="num" id="3747141">2</span>&nbsp;<span class="op" id="3747143">&lt;&lt;</span>&nbsp;<span class="num" id="3747146">10</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747152">if</span>&nbsp;<span class="ident" id="3747155"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747159">.</span><span class="ident" id="3747160">ContentLength</span>&nbsp;<span class="op" id="3747174">==</span>&nbsp;<span class="op" id="3747177">-</span><span class="num" id="3747178">1</span>&nbsp;<span class="op" id="3747180">||</span>&nbsp;<span class="ident" id="3747183"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747187">.</span><span class="ident" id="3747188">ContentLength</span>&nbsp;<span class="op" id="3747202">&lt;=</span>&nbsp;<span class="ident" id="3747205"><a href="/net/http/client.go.html#3747122">maxBodySlurpSize</a></span>&nbsp;<span class="op" id="3747222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747228"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3747230">.</span><span class="ident" id="3747231">CopyN</span><span class="op" id="3747236">(</span><span class="ident" id="3747237"><a href="/net/http/client.go.html#3735715">ioutil</a></span><span class="op" id="3747243">.</span><span class="ident" id="3747244">Discard</span><span class="op" id="3747251">,</span>&nbsp;<span class="ident" id="3747253"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747257">.</span><span class="ident" id="3747258">Body</span><span class="op" id="3747262">,</span>&nbsp;<span class="ident" id="3747264"><a href="/net/http/client.go.html#3747122">maxBodySlurpSize</a></span><span class="op" id="3747280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747290"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747294">.</span><span class="ident" id="3747295">Body</span><span class="op" id="3747299">.</span><span class="ident" id="3747300">Close</span><span class="op" id="3747305">(</span><span class="op" id="3747306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747311">if</span>&nbsp;<span class="ident" id="3747314"><a href="/net/http/client.go.html#3746087">urlStr</a></span>&nbsp;<span class="op" id="3747321">=</span>&nbsp;<span class="ident" id="3747323"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747327">.</span><span class="ident" id="3747328">Header</span><span class="op" id="3747334">.</span><span class="ident" id="3747335">Get</span><span class="op" id="3747338">(</span><span class="string" id="3747339">&#34;Location&#34;</span><span class="op" id="3747349">)</span><span class="op" id="3747350">;</span>&nbsp;<span class="ident" id="3747352"><a href="/net/http/client.go.html#3746087">urlStr</a></span>&nbsp;<span class="op" id="3747359">==</span>&nbsp;<span class="string" id="3747362">&#34;&#34;</span>&nbsp;<span class="op" id="3747365">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747371"><a href="/net/http/client.go.html#3745371">err</a></span>&nbsp;<span class="op" id="3747375">=</span>&nbsp;<span class="ident" id="3747377"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3747383">.</span><span class="ident" id="3747384">New</span><span class="op" id="3747387">(</span><span class="ident" id="3747388"><a href="/net/http/client.go.html#3735702">fmt</a></span><span class="op" id="3747391">.</span><span class="ident" id="3747392">Sprintf</span><span class="op" id="3747399">(</span><span class="string" id="3747400">&#34;%d&nbsp;response&nbsp;missing&nbsp;Location&nbsp;header&#34;</span><span class="op" id="3747437">,</span>&nbsp;<span class="ident" id="3747439"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747443">.</span><span class="ident" id="3747444">StatusCode</span><span class="op" id="3747454">)</span><span class="op" id="3747455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747461">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747475"><a href="/net/http/client.go.html#3745389">base</a></span>&nbsp;<span class="op" id="3747480">=</span>&nbsp;<span class="ident" id="3747482"><a href="/net/http/client.go.html#3745665">req</a></span><span class="op" id="3747485">.</span><span class="ident" id="3747486">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747493"><a href="/net/http/client.go.html#3745517">via</a></span>&nbsp;<span class="op" id="3747497">=</span>&nbsp;<span class="builtinfunc" id="3747499">append</span><span class="op" id="3747505">(</span><span class="ident" id="3747506"><a href="/net/http/client.go.html#3745517">via</a></span><span class="op" id="3747509">,</span>&nbsp;<span class="ident" id="3747511"><a href="/net/http/client.go.html#3745665">req</a></span><span class="op" id="3747514">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747519">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747534">if</span>&nbsp;<span class="ident" id="3747537"><a href="/net/http/client.go.html#3745683">timer</a></span>&nbsp;<span class="op" id="3747543">!=</span>&nbsp;<span class="ident" id="3747546">nil</span>&nbsp;<span class="op" id="3747550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747555"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747559">.</span><span class="ident" id="3747560">Body</span>&nbsp;<span class="op" id="3747565">=</span>&nbsp;<span class="op" id="3747567">&amp;</span><span class="ident" id="3747568"><a href="/net/http/client.go.html#3750692">cancelTimerBody</a></span><span class="op" id="3747583">{</span><span class="ident" id="3747584"><a href="/net/http/client.go.html#3745683">timer</a></span><span class="op" id="3747589">,</span>&nbsp;<span class="ident" id="3747591"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747595">.</span><span class="ident" id="3747596">Body</span><span class="op" id="3747600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747604">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747608">return</span>&nbsp;<span class="ident" id="3747615"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747619">,</span>&nbsp;<span class="ident" id="3747621">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747630">method</span>&nbsp;<span class="op" id="3747637">:=</span>&nbsp;<span class="ident" id="3747640"><a href="/net/http/client.go.html#3745308">ireq</a></span><span class="op" id="3747644">.</span><span class="ident" id="3747645">Method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747653">urlErr</span>&nbsp;<span class="op" id="3747660">:=</span>&nbsp;<span class="op" id="3747663">&amp;</span><span class="ident" id="3747664"><a href="/net/http/client.go.html#3735735">url</a></span><span class="op" id="3747667">.</span><span class="ident" id="3747668">Error</span><span class="op" id="3747673">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747677">Op</span><span class="op" id="3747679">:</span>&nbsp;&nbsp;<span class="ident" id="3747682"><a href="/net/http/client.go.html#3747630">method</a></span><span class="op" id="3747688">[</span><span class="num" id="3747689">0</span><span class="op" id="3747690">:</span><span class="num" id="3747691">1</span><span class="op" id="3747692">]</span>&nbsp;<span class="op" id="3747694">+</span>&nbsp;<span class="ident" id="3747696"><a href="/net/http/client.go.html#3735746">strings</a></span><span class="op" id="3747703">.</span><span class="ident" id="3747704">ToLower</span><span class="op" id="3747711">(</span><span class="ident" id="3747712"><a href="/net/http/client.go.html#3747630">method</a></span><span class="op" id="3747718">[</span><span class="num" id="3747719">1</span><span class="op" id="3747720">:</span><span class="op" id="3747721">]</span><span class="op" id="3747722">)</span><span class="op" id="3747723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747727">URL</span><span class="op" id="3747730">:</span>&nbsp;<span class="ident" id="3747732"><a href="/net/http/client.go.html#3746087">urlStr</a></span><span class="op" id="3747738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747742">Err</span><span class="op" id="3747745">:</span>&nbsp;<span class="ident" id="3747747"><a href="/net/http/client.go.html#3745371">err</a></span><span class="op" id="3747750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747757">if</span>&nbsp;<span class="ident" id="3747760"><a href="/net/http/client.go.html#3746165">redirectFailed</a></span>&nbsp;<span class="op" id="3747775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747779">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;Go&nbsp;1&nbsp;compatibility:&nbsp;return&nbsp;both&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747846">//&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;CheckRedirect&nbsp;function&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747902">//&nbsp;See&nbsp;http://golang.org/issue/3795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747940">return</span>&nbsp;<span class="ident" id="3747947"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747951">,</span>&nbsp;<span class="ident" id="3747953"><a href="/net/http/client.go.html#3747653">urlErr</a></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747965">if</span>&nbsp;<span class="ident" id="3747968"><a href="/net/http/client.go.html#3745355">resp</a></span>&nbsp;<span class="op" id="3747973">!=</span>&nbsp;<span class="ident" id="3747976">nil</span>&nbsp;<span class="op" id="3747980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747984"><a href="/net/http/client.go.html#3745355">resp</a></span><span class="op" id="3747988">.</span><span class="ident" id="3747989">Body</span><span class="op" id="3747993">.</span><span class="ident" id="3747994">Close</span><span class="op" id="3747999">(</span><span class="op" id="3748000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748003">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748006">return</span>&nbsp;<span class="ident" id="3748013">nil</span><span class="op" id="3748016">,</span>&nbsp;<span class="ident" id="3748018"><a href="/net/http/client.go.html#3747653">urlErr</a></span><br>
<span class="lineno"></span><span class="op" id="3748025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3748028">func</span>&nbsp;<span class="ident" id="3748033">defaultCheckRedirect</span><span class="op" id="3748053">(</span><span class="ident" id="3748054">req</span>&nbsp;<span class="op" id="3748058">*</span><span class="ident" id="3748059"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3748066">,</span>&nbsp;<span class="ident" id="3748068">via</span>&nbsp;<span class="op" id="3748072">[</span><span class="op" id="3748073">]</span><span class="op" id="3748074">*</span><span class="ident" id="3748075"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3748082">)</span>&nbsp;<span class="builtintype" id="3748084">error</span>&nbsp;<span class="op" id="3748090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748093">if</span>&nbsp;<span class="builtinfunc" id="3748096">len</span><span class="op" id="3748099">(</span><span class="ident" id="3748100"><a href="/net/http/client.go.html#3748068">via</a></span><span class="op" id="3748103">)</span>&nbsp;<span class="op" id="3748105">&gt;=</span>&nbsp;<span class="num" id="3748108">10</span>&nbsp;<span class="op" id="3748111">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748115">return</span>&nbsp;<span class="ident" id="3748122"><a href="/net/http/client.go.html#3735692">errors</a></span><span class="op" id="3748128">.</span><span class="ident" id="3748129">New</span><span class="op" id="3748132">(</span><span class="string" id="3748133">&#34;stopped&nbsp;after&nbsp;10&nbsp;redirects&#34;</span><span class="op" id="3748161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748167">return</span>&nbsp;<span class="ident" id="3748174">nil</span><br>
<span class="lineno"></span><span class="op" id="3748178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="3748181">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno"></span><span class="comment" id="3748225">//</span><br>
<span class="lineno"></span><span class="comment" id="3748228">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3748288">//</span><br>
<span class="lineno"></span><span class="comment" id="3748291">//&nbsp;Post&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Post</span><br>
<span class="lineno">425</span><span class="keyword" id="3748338">func</span>&nbsp;<span class="ident" id="3748343">Post</span><span class="op" id="3748347">(</span><span class="ident" id="3748348">url</span>&nbsp;<span class="builtintype" id="3748352">string</span><span class="op" id="3748358">,</span>&nbsp;<span class="ident" id="3748360">bodyType</span>&nbsp;<span class="builtintype" id="3748369">string</span><span class="op" id="3748375">,</span>&nbsp;<span class="ident" id="3748377">body</span>&nbsp;<span class="ident" id="3748382"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3748384">.</span><span class="ident" id="3748385">Reader</span><span class="op" id="3748391">)</span>&nbsp;<span class="op" id="3748393">(</span><span class="ident" id="3748394">resp</span>&nbsp;<span class="op" id="3748399">*</span><span class="ident" id="3748400"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3748408">,</span>&nbsp;<span class="ident" id="3748410">err</span>&nbsp;<span class="builtintype" id="3748414">error</span><span class="op" id="3748419">)</span>&nbsp;<span class="op" id="3748421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748424">return</span>&nbsp;<span class="ident" id="3748431"><a href="/net/http/client.go.html#3737845">DefaultClient</a></span><span class="op" id="3748444">.</span><span class="ident" id="3748445">Post</span><span class="op" id="3748449">(</span><span class="ident" id="3748450"><a href="/net/http/client.go.html#3748348">url</a></span><span class="op" id="3748453">,</span>&nbsp;<span class="ident" id="3748455"><a href="/net/http/client.go.html#3748360">bodyType</a></span><span class="op" id="3748463">,</span>&nbsp;<span class="ident" id="3748465"><a href="/net/http/client.go.html#3748377">body</a></span><span class="op" id="3748469">)</span><br>
<span class="lineno"></span><span class="op" id="3748471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3748474">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno">430</span><span class="comment" id="3748518">//</span><br>
<span class="lineno"></span><span class="comment" id="3748521">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3748581">//</span><br>
<span class="lineno"></span><span class="comment" id="3748584">//&nbsp;If&nbsp;the&nbsp;provided&nbsp;body&nbsp;is&nbsp;also&nbsp;an&nbsp;io.Closer,&nbsp;it&nbsp;is&nbsp;closed&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3748653">//&nbsp;request.</span><br>
<span class="lineno">435</span><span class="keyword" id="3748665">func</span>&nbsp;<span class="op" id="3748670">(</span><span class="ident" id="3748671">c</span>&nbsp;<span class="op" id="3748673">*</span><span class="ident" id="3748674"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3748680">)</span>&nbsp;<span class="ident" id="3748682">Post</span><span class="op" id="3748686">(</span><span class="ident" id="3748687">url</span>&nbsp;<span class="builtintype" id="3748691">string</span><span class="op" id="3748697">,</span>&nbsp;<span class="ident" id="3748699">bodyType</span>&nbsp;<span class="builtintype" id="3748708">string</span><span class="op" id="3748714">,</span>&nbsp;<span class="ident" id="3748716">body</span>&nbsp;<span class="ident" id="3748721"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3748723">.</span><span class="ident" id="3748724">Reader</span><span class="op" id="3748730">)</span>&nbsp;<span class="op" id="3748732">(</span><span class="ident" id="3748733">resp</span>&nbsp;<span class="op" id="3748738">*</span><span class="ident" id="3748739"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3748747">,</span>&nbsp;<span class="ident" id="3748749">err</span>&nbsp;<span class="builtintype" id="3748753">error</span><span class="op" id="3748758">)</span>&nbsp;<span class="op" id="3748760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748763">req</span><span class="op" id="3748766">,</span>&nbsp;<span class="ident" id="3748768"><a href="/net/http/client.go.html#3748749">err</a></span>&nbsp;<span class="op" id="3748772">:=</span>&nbsp;<span class="ident" id="3748775"><a href="/net/http/request.go.html#3804993">NewRequest</a></span><span class="op" id="3748785">(</span><span class="string" id="3748786">&#34;POST&#34;</span><span class="op" id="3748792">,</span>&nbsp;<span class="ident" id="3748794"><a href="/net/http/client.go.html#3748687">url</a></span><span class="op" id="3748797">,</span>&nbsp;<span class="ident" id="3748799"><a href="/net/http/client.go.html#3748716">body</a></span><span class="op" id="3748803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748806">if</span>&nbsp;<span class="ident" id="3748809"><a href="/net/http/client.go.html#3748749">err</a></span>&nbsp;<span class="op" id="3748813">!=</span>&nbsp;<span class="ident" id="3748816">nil</span>&nbsp;<span class="op" id="3748820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748824">return</span>&nbsp;<span class="ident" id="3748831">nil</span><span class="op" id="3748834">,</span>&nbsp;<span class="ident" id="3748836"><a href="/net/http/client.go.html#3748749">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748841">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748844"><a href="/net/http/client.go.html#3748763">req</a></span><span class="op" id="3748847">.</span><span class="ident" id="3748848">Header</span><span class="op" id="3748854">.</span><span class="ident" id="3748855">Set</span><span class="op" id="3748858">(</span><span class="string" id="3748859">&#34;Content-Type&#34;</span><span class="op" id="3748873">,</span>&nbsp;<span class="ident" id="3748875"><a href="/net/http/client.go.html#3748699">bodyType</a></span><span class="op" id="3748883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748886">return</span>&nbsp;<span class="ident" id="3748893"><a href="/net/http/client.go.html#3748671">c</a></span><span class="op" id="3748894">.</span><span class="ident" id="3748895">doFollowingRedirects</span><span class="op" id="3748915">(</span><span class="ident" id="3748916"><a href="/net/http/client.go.html#3748763">req</a></span><span class="op" id="3748919">,</span>&nbsp;<span class="ident" id="3748921"><a href="/net/http/client.go.html#3743694">shouldRedirectPost</a></span><span class="op" id="3748939">)</span><br>
<span class="lineno"></span><span class="op" id="3748941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3748944">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and</span><br>
<span class="lineno">445</span><span class="comment" id="3749013">//&nbsp;values&nbsp;URL-encoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3749056">//</span><br>
<span class="lineno"></span><span class="comment" id="3749059">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3749121">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3749181">//</span><br>
<span class="lineno">450</span><span class="comment" id="3749184">//&nbsp;PostForm&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.PostForm</span><br>
<span class="lineno"></span><span class="keyword" id="3749239">func</span>&nbsp;<span class="ident" id="3749244">PostForm</span><span class="op" id="3749252">(</span><span class="ident" id="3749253">url</span>&nbsp;<span class="builtintype" id="3749257">string</span><span class="op" id="3749263">,</span>&nbsp;<span class="ident" id="3749265">data</span>&nbsp;<span class="ident" id="3749270"><a href="/net/http/client.go.html#3735735">url</a></span><span class="op" id="3749273">.</span><span class="ident" id="3749274">Values</span><span class="op" id="3749280">)</span>&nbsp;<span class="op" id="3749282">(</span><span class="ident" id="3749283">resp</span>&nbsp;<span class="op" id="3749288">*</span><span class="ident" id="3749289"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3749297">,</span>&nbsp;<span class="ident" id="3749299">err</span>&nbsp;<span class="builtintype" id="3749303">error</span><span class="op" id="3749308">)</span>&nbsp;<span class="op" id="3749310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749313">return</span>&nbsp;<span class="ident" id="3749320"><a href="/net/http/client.go.html#3737845">DefaultClient</a></span><span class="op" id="3749333">.</span><span class="ident" id="3749334">PostForm</span><span class="op" id="3749342">(</span><span class="ident" id="3749343"><a href="/net/http/client.go.html#3749253">url</a></span><span class="op" id="3749346">,</span>&nbsp;<span class="ident" id="3749348"><a href="/net/http/client.go.html#3749265">data</a></span><span class="op" id="3749352">)</span><br>
<span class="lineno"></span><span class="op" id="3749354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="3749357">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,</span><br>
<span class="lineno"></span><span class="comment" id="3749405">//&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and&nbsp;values&nbsp;urlencoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3749468">//</span><br>
<span class="lineno"></span><span class="comment" id="3749471">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3749533">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno">460</span><span class="keyword" id="3749593">func</span>&nbsp;<span class="op" id="3749598">(</span><span class="ident" id="3749599">c</span>&nbsp;<span class="op" id="3749601">*</span><span class="ident" id="3749602"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3749608">)</span>&nbsp;<span class="ident" id="3749610">PostForm</span><span class="op" id="3749618">(</span><span class="ident" id="3749619">url</span>&nbsp;<span class="builtintype" id="3749623">string</span><span class="op" id="3749629">,</span>&nbsp;<span class="ident" id="3749631">data</span>&nbsp;<span class="ident" id="3749636"><a href="/net/http/client.go.html#3735735">url</a></span><span class="op" id="3749639">.</span><span class="ident" id="3749640">Values</span><span class="op" id="3749646">)</span>&nbsp;<span class="op" id="3749648">(</span><span class="ident" id="3749649">resp</span>&nbsp;<span class="op" id="3749654">*</span><span class="ident" id="3749655"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3749663">,</span>&nbsp;<span class="ident" id="3749665">err</span>&nbsp;<span class="builtintype" id="3749669">error</span><span class="op" id="3749674">)</span>&nbsp;<span class="op" id="3749676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749679">return</span>&nbsp;<span class="ident" id="3749686"><a href="/net/http/client.go.html#3749599">c</a></span><span class="op" id="3749687">.</span><span class="ident" id="3749688">Post</span><span class="op" id="3749692">(</span><span class="ident" id="3749693"><a href="/net/http/client.go.html#3749619">url</a></span><span class="op" id="3749696">,</span>&nbsp;<span class="string" id="3749698">&#34;application/x-www-form-urlencoded&#34;</span><span class="op" id="3749733">,</span>&nbsp;<span class="ident" id="3749735"><a href="/net/http/client.go.html#3735746">strings</a></span><span class="op" id="3749742">.</span><span class="ident" id="3749743">NewReader</span><span class="op" id="3749752">(</span><span class="ident" id="3749753"><a href="/net/http/client.go.html#3749631">data</a></span><span class="op" id="3749757">.</span><span class="ident" id="3749758">Encode</span><span class="op" id="3749764">(</span><span class="op" id="3749765">)</span><span class="op" id="3749766">)</span><span class="op" id="3749767">)</span><br>
<span class="lineno"></span><span class="op" id="3749769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3749772">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="3749847">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3749920">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3749956">//</span><br>
<span class="lineno"></span><span class="comment" id="3749959">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3749989">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">470</span><span class="comment" id="3750007">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="3750029">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3750060">//</span><br>
<span class="lineno"></span><span class="comment" id="3750063">//&nbsp;Head&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Head</span><br>
<span class="lineno"></span><span class="keyword" id="3750110">func</span>&nbsp;<span class="ident" id="3750115">Head</span><span class="op" id="3750119">(</span><span class="ident" id="3750120">url</span>&nbsp;<span class="builtintype" id="3750124">string</span><span class="op" id="3750130">)</span>&nbsp;<span class="op" id="3750132">(</span><span class="ident" id="3750133">resp</span>&nbsp;<span class="op" id="3750138">*</span><span class="ident" id="3750139"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3750147">,</span>&nbsp;<span class="ident" id="3750149">err</span>&nbsp;<span class="builtintype" id="3750153">error</span><span class="op" id="3750158">)</span>&nbsp;<span class="op" id="3750160">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750163">return</span>&nbsp;<span class="ident" id="3750170"><a href="/net/http/client.go.html#3737845">DefaultClient</a></span><span class="op" id="3750183">.</span><span class="ident" id="3750184">Head</span><span class="op" id="3750188">(</span><span class="ident" id="3750189"><a href="/net/http/client.go.html#3750120">url</a></span><span class="op" id="3750192">)</span><br>
<span class="lineno"></span><span class="op" id="3750194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3750197">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3750272">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="3750345">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3750381">//</span><br>
<span class="lineno"></span><span class="comment" id="3750384">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3750414">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="3750432">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">485</span><span class="comment" id="3750454">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="keyword" id="3750485">func</span>&nbsp;<span class="op" id="3750490">(</span><span class="ident" id="3750491">c</span>&nbsp;<span class="op" id="3750493">*</span><span class="ident" id="3750494"><a href="/net/http/client.go.html#3736246">Client</a></span><span class="op" id="3750500">)</span>&nbsp;<span class="ident" id="3750502">Head</span><span class="op" id="3750506">(</span><span class="ident" id="3750507">url</span>&nbsp;<span class="builtintype" id="3750511">string</span><span class="op" id="3750517">)</span>&nbsp;<span class="op" id="3750519">(</span><span class="ident" id="3750520">resp</span>&nbsp;<span class="op" id="3750525">*</span><span class="ident" id="3750526"><a href="/net/http/response.go.html#3816973">Response</a></span><span class="op" id="3750534">,</span>&nbsp;<span class="ident" id="3750536">err</span>&nbsp;<span class="builtintype" id="3750540">error</span><span class="op" id="3750545">)</span>&nbsp;<span class="op" id="3750547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750550">req</span><span class="op" id="3750553">,</span>&nbsp;<span class="ident" id="3750555"><a href="/net/http/client.go.html#3750536">err</a></span>&nbsp;<span class="op" id="3750559">:=</span>&nbsp;<span class="ident" id="3750562"><a href="/net/http/request.go.html#3804993">NewRequest</a></span><span class="op" id="3750572">(</span><span class="string" id="3750573">&#34;HEAD&#34;</span><span class="op" id="3750579">,</span>&nbsp;<span class="ident" id="3750581"><a href="/net/http/client.go.html#3750507">url</a></span><span class="op" id="3750584">,</span>&nbsp;<span class="ident" id="3750586">nil</span><span class="op" id="3750589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750592">if</span>&nbsp;<span class="ident" id="3750595"><a href="/net/http/client.go.html#3750536">err</a></span>&nbsp;<span class="op" id="3750599">!=</span>&nbsp;<span class="ident" id="3750602">nil</span>&nbsp;<span class="op" id="3750606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750610">return</span>&nbsp;<span class="ident" id="3750617">nil</span><span class="op" id="3750620">,</span>&nbsp;<span class="ident" id="3750622"><a href="/net/http/client.go.html#3750536">err</a></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750630">return</span>&nbsp;<span class="ident" id="3750637"><a href="/net/http/client.go.html#3750491">c</a></span><span class="op" id="3750638">.</span><span class="ident" id="3750639">doFollowingRedirects</span><span class="op" id="3750659">(</span><span class="ident" id="3750660"><a href="/net/http/client.go.html#3750550">req</a></span><span class="op" id="3750663">,</span>&nbsp;<span class="ident" id="3750665"><a href="/net/http/client.go.html#3743399">shouldRedirectGet</a></span><span class="op" id="3750682">)</span><br>
<span class="lineno"></span><span class="op" id="3750684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3750687">type</span>&nbsp;<span class="ident" id="3750692">cancelTimerBody</span>&nbsp;<span class="keyword" id="3750708">struct</span>&nbsp;<span class="op" id="3750715">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750718">t</span>&nbsp;&nbsp;<span class="op" id="3750721">*</span><span class="ident" id="3750722"><a href="/net/http/client.go.html#3735765">time</a></span><span class="op" id="3750726">.</span><span class="ident" id="3750727">Timer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750734">rc</span>&nbsp;<span class="ident" id="3750737"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3750739">.</span><span class="ident" id="3750740">ReadCloser</span><br>
<span class="lineno"></span><span class="op" id="3750751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3750754">func</span>&nbsp;<span class="op" id="3750759">(</span><span class="ident" id="3750760">b</span>&nbsp;<span class="op" id="3750762">*</span><span class="ident" id="3750763"><a href="/net/http/client.go.html#3750692">cancelTimerBody</a></span><span class="op" id="3750778">)</span>&nbsp;<span class="ident" id="3750780">Read</span><span class="op" id="3750784">(</span><span class="ident" id="3750785">p</span>&nbsp;<span class="op" id="3750787">[</span><span class="op" id="3750788">]</span><span class="builtintype" id="3750789">byte</span><span class="op" id="3750793">)</span>&nbsp;<span class="op" id="3750795">(</span><span class="ident" id="3750796">n</span>&nbsp;<span class="builtintype" id="3750798">int</span><span class="op" id="3750801">,</span>&nbsp;<span class="ident" id="3750803">err</span>&nbsp;<span class="builtintype" id="3750807">error</span><span class="op" id="3750812">)</span>&nbsp;<span class="op" id="3750814">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750817"><a href="/net/http/client.go.html#3750796">n</a></span><span class="op" id="3750818">,</span>&nbsp;<span class="ident" id="3750820"><a href="/net/http/client.go.html#3750803">err</a></span>&nbsp;<span class="op" id="3750824">=</span>&nbsp;<span class="ident" id="3750826"><a href="/net/http/client.go.html#3750760">b</a></span><span class="op" id="3750827">.</span><span class="ident" id="3750828">rc</span><span class="op" id="3750830">.</span><span class="ident" id="3750831">Read</span><span class="op" id="3750835">(</span><span class="ident" id="3750836"><a href="/net/http/client.go.html#3750785">p</a></span><span class="op" id="3750837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750840">if</span>&nbsp;<span class="ident" id="3750843"><a href="/net/http/client.go.html#3750803">err</a></span>&nbsp;<span class="op" id="3750847">==</span>&nbsp;<span class="ident" id="3750850"><a href="/net/http/client.go.html#3735709">io</a></span><span class="op" id="3750852">.</span><span class="ident" id="3750853">EOF</span>&nbsp;<span class="op" id="3750857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750861"><a href="/net/http/client.go.html#3750760">b</a></span><span class="op" id="3750862">.</span><span class="ident" id="3750863">t</span><span class="op" id="3750864">.</span><span class="ident" id="3750865">Stop</span><span class="op" id="3750869">(</span><span class="op" id="3750870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750876">return</span><br>
<span class="lineno">505</span><span class="op" id="3750883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3750886">func</span>&nbsp;<span class="op" id="3750891">(</span><span class="ident" id="3750892">b</span>&nbsp;<span class="op" id="3750894">*</span><span class="ident" id="3750895"><a href="/net/http/client.go.html#3750692">cancelTimerBody</a></span><span class="op" id="3750910">)</span>&nbsp;<span class="ident" id="3750912">Close</span><span class="op" id="3750917">(</span><span class="op" id="3750918">)</span>&nbsp;<span class="builtintype" id="3750920">error</span>&nbsp;<span class="op" id="3750926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750929">err</span>&nbsp;<span class="op" id="3750933">:=</span>&nbsp;<span class="ident" id="3750936"><a href="/net/http/client.go.html#3750892">b</a></span><span class="op" id="3750937">.</span><span class="ident" id="3750938">rc</span><span class="op" id="3750940">.</span><span class="ident" id="3750941">Close</span><span class="op" id="3750946">(</span><span class="op" id="3750947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750950"><a href="/net/http/client.go.html#3750892">b</a></span><span class="op" id="3750951">.</span><span class="ident" id="3750952">t</span><span class="op" id="3750953">.</span><span class="ident" id="3750954">Stop</span><span class="op" id="3750958">(</span><span class="op" id="3750959">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750962">return</span>&nbsp;<span class="ident" id="3750969"><a href="/net/http/client.go.html#3750929">err</a></span><br>
<span class="lineno"></span><span class="op" id="3750973">}</span>
</div>
</body>
</html>
