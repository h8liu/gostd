<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3636731">package</span>&nbsp;<span class="ident" id="3636739">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3636745">import</span>&nbsp;<span class="op" id="3636752">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3636755">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="3636777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3636780">var</span>&nbsp;<span class="op" id="3636784">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636787">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636808">opBrMap</span>&nbsp;<span class="op" id="3636816">=</span>&nbsp;<span class="keyword" id="3636818">map</span><span class="op" id="3636821">[</span><span class="builtintype" id="3636822">string</span><span class="op" id="3636828">]</span><span class="builtintype" id="3636829">uint32</span><span class="op" id="3636835">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3636839">&#34;bne&#34;</span><span class="op" id="3636844">:</span>&nbsp;<span class="num" id="3636846">32</span><span class="op" id="3636848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3636852">&#34;beq&#34;</span><span class="op" id="3636857">:</span>&nbsp;<span class="num" id="3636859">33</span><span class="op" id="3636861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636864">}</span><br>
<span class="lineno"></span><span class="op" id="3636866">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3636869">func</span>&nbsp;<span class="ident" id="3636874">makeInstBr</span><span class="op" id="3636884">(</span><span class="ident" id="3636885">op</span><span class="op" id="3636887">,</span>&nbsp;<span class="ident" id="3636889">s1</span><span class="op" id="3636891">,</span>&nbsp;<span class="ident" id="3636893">s2</span>&nbsp;<span class="builtintype" id="3636896">uint32</span><span class="op" id="3636902">)</span>&nbsp;<span class="op" id="3636904">*</span><span class="ident" id="3636905">inst</span>&nbsp;<span class="op" id="3636910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636913">ret</span>&nbsp;<span class="op" id="3636917">:=</span>&nbsp;<span class="op" id="3636920">(</span><span class="ident" id="3636921">op</span>&nbsp;<span class="op" id="3636924">&amp;</span>&nbsp;<span class="num" id="3636926">0xff</span><span class="op" id="3636930">)</span>&nbsp;<span class="op" id="3636932">&lt;&lt;</span>&nbsp;<span class="num" id="3636935">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636939">ret</span>&nbsp;<span class="op" id="3636943">|=</span>&nbsp;<span class="op" id="3636946">(</span><span class="ident" id="3636947">s1</span>&nbsp;<span class="op" id="3636950">&amp;</span>&nbsp;<span class="num" id="3636952">0x7</span><span class="op" id="3636955">)</span>&nbsp;<span class="op" id="3636957">&lt;&lt;</span>&nbsp;<span class="num" id="3636960">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636964">ret</span>&nbsp;<span class="op" id="3636968">|=</span>&nbsp;<span class="op" id="3636971">(</span><span class="ident" id="3636972">s2</span>&nbsp;<span class="op" id="3636975">&amp;</span>&nbsp;<span class="num" id="3636977">0x7</span><span class="op" id="3636980">)</span>&nbsp;<span class="op" id="3636982">&lt;&lt;</span>&nbsp;<span class="num" id="3636985">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636989">return</span>&nbsp;<span class="op" id="3636996">&amp;</span><span class="ident" id="3636997">inst</span><span class="op" id="3637001">{</span><span class="ident" id="3637002">inst</span><span class="op" id="3637006">:</span>&nbsp;<span class="ident" id="3637008">ret</span><span class="op" id="3637011">}</span><br>
<span class="lineno">20</span><span class="op" id="3637013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3637016">func</span>&nbsp;<span class="ident" id="3637021">parseInstBr</span><span class="op" id="3637032">(</span><span class="ident" id="3637033">p</span>&nbsp;<span class="op" id="3637035">*</span><span class="ident" id="3637036">parser</span><span class="op" id="3637042">,</span>&nbsp;<span class="ident" id="3637044">ops</span>&nbsp;<span class="op" id="3637048">[</span><span class="op" id="3637049">]</span><span class="op" id="3637050">*</span><span class="ident" id="3637051">lex8</span><span class="op" id="3637055">.</span><span class="ident" id="3637056">Token</span><span class="op" id="3637061">)</span>&nbsp;<span class="op" id="3637063">(</span><span class="op" id="3637064">*</span><span class="ident" id="3637065">inst</span><span class="op" id="3637069">,</span>&nbsp;<span class="builtintype" id="3637071">bool</span><span class="op" id="3637075">)</span>&nbsp;<span class="op" id="3637077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637080">op0</span>&nbsp;<span class="op" id="3637084">:=</span>&nbsp;<span class="ident" id="3637087">ops</span><span class="op" id="3637090">[</span><span class="num" id="3637091">0</span><span class="op" id="3637092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637095">opName</span>&nbsp;<span class="op" id="3637102">:=</span>&nbsp;<span class="ident" id="3637105">op0</span><span class="op" id="3637108">.</span><span class="ident" id="3637109">Lit</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637114">args</span>&nbsp;<span class="op" id="3637119">:=</span>&nbsp;<span class="ident" id="3637122">ops</span><span class="op" id="3637125">[</span><span class="num" id="3637126">1</span><span class="op" id="3637127">:</span><span class="op" id="3637128">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637132">var</span>&nbsp;<span class="op" id="3637136">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637140">op</span><span class="op" id="3637142">,</span>&nbsp;<span class="ident" id="3637144">s1</span><span class="op" id="3637146">,</span>&nbsp;<span class="ident" id="3637148">s2</span>&nbsp;<span class="builtintype" id="3637151">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637160">lab</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3637171">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637180">symTok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3637191">*</span><span class="ident" id="3637192">lex8</span><span class="op" id="3637196">.</span><span class="ident" id="3637197">Token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637206">found</span>&nbsp;<span class="builtintype" id="3637212">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637218">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637222">if</span>&nbsp;<span class="ident" id="3637225">op</span><span class="op" id="3637227">,</span>&nbsp;<span class="ident" id="3637229">found</span>&nbsp;<span class="op" id="3637235">=</span>&nbsp;<span class="ident" id="3637237">opBrMap</span><span class="op" id="3637244">[</span><span class="ident" id="3637245">opName</span><span class="op" id="3637251">]</span><span class="op" id="3637252">;</span>&nbsp;<span class="ident" id="3637254">found</span>&nbsp;<span class="op" id="3637260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637264">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637286">if</span>&nbsp;<span class="ident" id="3637289">argCount</span><span class="op" id="3637297">(</span><span class="ident" id="3637298">p</span><span class="op" id="3637299">,</span>&nbsp;<span class="ident" id="3637301">ops</span><span class="op" id="3637304">,</span>&nbsp;<span class="num" id="3637306">3</span><span class="op" id="3637307">)</span>&nbsp;<span class="op" id="3637309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637314">s1</span>&nbsp;<span class="op" id="3637317">=</span>&nbsp;<span class="ident" id="3637319">parseReg</span><span class="op" id="3637327">(</span><span class="ident" id="3637328">p</span><span class="op" id="3637329">,</span>&nbsp;<span class="ident" id="3637331">args</span><span class="op" id="3637335">[</span><span class="num" id="3637336">0</span><span class="op" id="3637337">]</span><span class="op" id="3637338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637343">s2</span>&nbsp;<span class="op" id="3637346">=</span>&nbsp;<span class="ident" id="3637348">parseReg</span><span class="op" id="3637356">(</span><span class="ident" id="3637357">p</span><span class="op" id="3637358">,</span>&nbsp;<span class="ident" id="3637360">args</span><span class="op" id="3637364">[</span><span class="num" id="3637365">1</span><span class="op" id="3637366">]</span><span class="op" id="3637367">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637372">symTok</span>&nbsp;<span class="op" id="3637379">=</span>&nbsp;<span class="ident" id="3637381">args</span><span class="op" id="3637385">[</span><span class="num" id="3637386">2</span><span class="op" id="3637387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637392">if</span>&nbsp;<span class="ident" id="3637395">parseLabel</span><span class="op" id="3637405">(</span><span class="ident" id="3637406">p</span><span class="op" id="3637407">,</span>&nbsp;<span class="ident" id="3637409">symTok</span><span class="op" id="3637415">)</span>&nbsp;<span class="op" id="3637417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637423">lab</span>&nbsp;<span class="op" id="3637427">=</span>&nbsp;<span class="ident" id="3637429">symTok</span><span class="op" id="3637435">.</span><span class="ident" id="3637436">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637443">}</span>&nbsp;<span class="keyword" id="3637445">else</span>&nbsp;<span class="op" id="3637450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637456">p</span><span class="op" id="3637457">.</span><span class="ident" id="3637458">err</span><span class="op" id="3637461">(</span><span class="ident" id="3637462">symTok</span><span class="op" id="3637468">.</span><span class="ident" id="3637469">Pos</span><span class="op" id="3637472">,</span>&nbsp;<span class="string" id="3637474">&#34;expects&nbsp;a&nbsp;label&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3637498">,</span>&nbsp;<span class="ident" id="3637500">opName</span><span class="op" id="3637506">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637518">}</span>&nbsp;<span class="keyword" id="3637520">else</span>&nbsp;<span class="op" id="3637525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637529">return</span>&nbsp;<span class="ident" id="3637536">nil</span><span class="op" id="3637539">,</span>&nbsp;<span class="builtintype" id="3637541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637548">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637552">ret</span>&nbsp;<span class="op" id="3637556">:=</span>&nbsp;<span class="ident" id="3637559">makeInstBr</span><span class="op" id="3637569">(</span><span class="ident" id="3637570">op</span><span class="op" id="3637572">,</span>&nbsp;<span class="ident" id="3637574">s1</span><span class="op" id="3637576">,</span>&nbsp;<span class="ident" id="3637578">s2</span><span class="op" id="3637580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637583">ret</span><span class="op" id="3637586">.</span><span class="ident" id="3637587">symbol</span>&nbsp;<span class="op" id="3637594">=</span>&nbsp;<span class="ident" id="3637596">lab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637601">ret</span><span class="op" id="3637604">.</span><span class="ident" id="3637605">fill</span>&nbsp;<span class="op" id="3637610">=</span>&nbsp;<span class="ident" id="3637612">fillLabel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637623">ret</span><span class="op" id="3637626">.</span><span class="ident" id="3637627">symTok</span>&nbsp;<span class="op" id="3637634">=</span>&nbsp;<span class="ident" id="3637636">symTok</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637645">return</span>&nbsp;<span class="ident" id="3637652">ret</span><span class="op" id="3637655">,</span>&nbsp;<span class="builtintype" id="3637657">true</span><br>
<span class="lineno"></span><span class="op" id="3637662">}</span>
</div>
</body>
</html>
