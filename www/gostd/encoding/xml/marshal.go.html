<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html" class="current">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5655848">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5655903">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5655957">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5656008">package</span>&nbsp;<span class="ident" id="5656016">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5656021">import</span>&nbsp;<span class="op" id="5656028">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656031">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656040">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656049">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656061">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656068">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656074">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656085">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5656096">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5656106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5656109">const</span>&nbsp;<span class="op" id="5656115">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656118">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656188">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656255">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656292">Header</span>&nbsp;<span class="op" id="5656299">=</span>&nbsp;<span class="string" id="5656301">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="5656342">+</span>&nbsp;<span class="string" id="5656344">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="5656349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5656352">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="5656394">//</span><br>
<span class="lineno"></span><span class="comment" id="5656397">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="5656471">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5656549">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="5656627">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5656702">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="5656781">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="5656814">//</span><br>
<span class="lineno"></span><span class="comment" id="5656817">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="5656889">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="5656952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="5657009">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5657070">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5657132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="5657173">//</span><br>
<span class="lineno"></span><span class="comment" id="5657176">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5657253">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="5657310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="5657367">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="5657409">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5657473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="5657517">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5657581">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="5657621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="5657689">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="5657721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="5657792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="5657837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5657908">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="5657981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5658017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="5658089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5658162">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5658233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="5658265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5658335">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="5658381">//</span><br>
<span class="lineno"></span><span class="comment" id="5658384">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="5658459">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="5658536">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="5658592">//</span><br>
<span class="lineno"></span><span class="comment" id="5658595">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="5658632">//</span><br>
<span class="lineno"></span><span class="comment" id="5658635">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="5658716">func</span>&nbsp;<span class="ident" id="5658721">Marshal</span><span class="op" id="5658728">(</span><span class="ident" id="5658729">v</span>&nbsp;<span class="keyword" id="5658731">interface</span><span class="op" id="5658740">{</span><span class="op" id="5658741">}</span><span class="op" id="5658742">)</span>&nbsp;<span class="op" id="5658744">(</span><span class="op" id="5658745">[</span><span class="op" id="5658746">]</span><span class="builtintype" id="5658747">byte</span><span class="op" id="5658751">,</span>&nbsp;<span class="builtintype" id="5658753">error</span><span class="op" id="5658758">)</span>&nbsp;<span class="op" id="5658760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658763">var</span>&nbsp;<span class="ident" id="5658767">b</span>&nbsp;<span class="ident" id="5658769">bytes</span><span class="op" id="5658774">.</span><span class="ident" id="5658775">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658783">if</span>&nbsp;<span class="ident" id="5658786">err</span>&nbsp;<span class="op" id="5658790">:=</span>&nbsp;<span class="ident" id="5658793">NewEncoder</span><span class="op" id="5658803">(</span><span class="op" id="5658804">&amp;</span><span class="ident" id="5658805">b</span><span class="op" id="5658806">)</span><span class="op" id="5658807">.</span><span class="ident" id="5658808">Encode</span><span class="op" id="5658814">(</span><span class="ident" id="5658815">v</span><span class="op" id="5658816">)</span><span class="op" id="5658817">;</span>&nbsp;<span class="ident" id="5658819">err</span>&nbsp;<span class="op" id="5658823">!=</span>&nbsp;<span class="builtintype" id="5658826">nil</span>&nbsp;<span class="op" id="5658830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658834">return</span>&nbsp;<span class="builtintype" id="5658841">nil</span><span class="op" id="5658844">,</span>&nbsp;<span class="ident" id="5658846">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5658851">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658854">return</span>&nbsp;<span class="ident" id="5658861">b</span><span class="op" id="5658862">.</span><span class="ident" id="5658863">Bytes</span><span class="op" id="5658868">(</span><span class="op" id="5658869">)</span><span class="op" id="5658870">,</span>&nbsp;<span class="builtintype" id="5658872">nil</span><br>
<span class="lineno"></span><span class="op" id="5658876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5658879">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="5658949">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="5658988">//</span><br>
<span class="lineno"></span><span class="comment" id="5658991">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="5659056">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="5659127">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="5659158">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="5659222">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="5659288">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5659305">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="5659370">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5659435">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="5659474">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="5659543">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5659594">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="5659660">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="5659677">type</span>&nbsp;<span class="ident" id="5659682">Marshaler</span>&nbsp;<span class="keyword" id="5659692">interface</span>&nbsp;<span class="op" id="5659702">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659705">MarshalXML</span><span class="op" id="5659715">(</span><span class="ident" id="5659716">e</span>&nbsp;<span class="op" id="5659718">*</span><span class="ident" id="5659719">Encoder</span><span class="op" id="5659726">,</span>&nbsp;<span class="ident" id="5659728">start</span>&nbsp;<span class="ident" id="5659734">StartElement</span><span class="op" id="5659746">)</span>&nbsp;<span class="builtintype" id="5659748">error</span><br>
<span class="lineno"></span><span class="op" id="5659754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5659757">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="5659831">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="5659872">//</span><br>
<span class="lineno"></span><span class="comment" id="5659875">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="5659958">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="5660024">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="5660087">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="5660104">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="5660173">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="5660209">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5660267">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5660302">type</span>&nbsp;<span class="ident" id="5660307">MarshalerAttr</span>&nbsp;<span class="keyword" id="5660321">interface</span>&nbsp;<span class="op" id="5660331">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660334">MarshalXMLAttr</span><span class="op" id="5660348">(</span><span class="ident" id="5660349">name</span>&nbsp;<span class="ident" id="5660354">Name</span><span class="op" id="5660358">)</span>&nbsp;<span class="op" id="5660360">(</span><span class="ident" id="5660361">Attr</span><span class="op" id="5660365">,</span>&nbsp;<span class="builtintype" id="5660367">error</span><span class="op" id="5660372">)</span><br>
<span class="lineno"></span><span class="op" id="5660374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5660377">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="5660451">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="5660523">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="5660575">func</span>&nbsp;<span class="ident" id="5660580">MarshalIndent</span><span class="op" id="5660593">(</span><span class="ident" id="5660594">v</span>&nbsp;<span class="keyword" id="5660596">interface</span><span class="op" id="5660605">{</span><span class="op" id="5660606">}</span><span class="op" id="5660607">,</span>&nbsp;<span class="ident" id="5660609">prefix</span><span class="op" id="5660615">,</span>&nbsp;<span class="ident" id="5660617">indent</span>&nbsp;<span class="builtintype" id="5660624">string</span><span class="op" id="5660630">)</span>&nbsp;<span class="op" id="5660632">(</span><span class="op" id="5660633">[</span><span class="op" id="5660634">]</span><span class="builtintype" id="5660635">byte</span><span class="op" id="5660639">,</span>&nbsp;<span class="builtintype" id="5660641">error</span><span class="op" id="5660646">)</span>&nbsp;<span class="op" id="5660648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660651">var</span>&nbsp;<span class="ident" id="5660655">b</span>&nbsp;<span class="ident" id="5660657">bytes</span><span class="op" id="5660662">.</span><span class="ident" id="5660663">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660671">enc</span>&nbsp;<span class="op" id="5660675">:=</span>&nbsp;<span class="ident" id="5660678">NewEncoder</span><span class="op" id="5660688">(</span><span class="op" id="5660689">&amp;</span><span class="ident" id="5660690">b</span><span class="op" id="5660691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660694">enc</span><span class="op" id="5660697">.</span><span class="ident" id="5660698">Indent</span><span class="op" id="5660704">(</span><span class="ident" id="5660705">prefix</span><span class="op" id="5660711">,</span>&nbsp;<span class="ident" id="5660713">indent</span><span class="op" id="5660719">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660722">if</span>&nbsp;<span class="ident" id="5660725">err</span>&nbsp;<span class="op" id="5660729">:=</span>&nbsp;<span class="ident" id="5660732">enc</span><span class="op" id="5660735">.</span><span class="ident" id="5660736">Encode</span><span class="op" id="5660742">(</span><span class="ident" id="5660743">v</span><span class="op" id="5660744">)</span><span class="op" id="5660745">;</span>&nbsp;<span class="ident" id="5660747">err</span>&nbsp;<span class="op" id="5660751">!=</span>&nbsp;<span class="builtintype" id="5660754">nil</span>&nbsp;<span class="op" id="5660758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660762">return</span>&nbsp;<span class="builtintype" id="5660769">nil</span><span class="op" id="5660772">,</span>&nbsp;<span class="ident" id="5660774">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5660779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660782">return</span>&nbsp;<span class="ident" id="5660789">b</span><span class="op" id="5660790">.</span><span class="ident" id="5660791">Bytes</span><span class="op" id="5660796">(</span><span class="op" id="5660797">)</span><span class="op" id="5660798">,</span>&nbsp;<span class="builtintype" id="5660800">nil</span><br>
<span class="lineno"></span><span class="op" id="5660804">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5660807">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="5660858">type</span>&nbsp;<span class="ident" id="5660863">Encoder</span>&nbsp;<span class="keyword" id="5660871">struct</span>&nbsp;<span class="op" id="5660878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660881">p</span>&nbsp;<span class="ident" id="5660883">printer</span><br>
<span class="lineno"></span><span class="op" id="5660891">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="5660894">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5660948">func</span>&nbsp;<span class="ident" id="5660953">NewEncoder</span><span class="op" id="5660963">(</span><span class="ident" id="5660964">w</span>&nbsp;<span class="ident" id="5660966">io</span><span class="op" id="5660968">.</span><span class="ident" id="5660969">Writer</span><span class="op" id="5660975">)</span>&nbsp;<span class="op" id="5660977">*</span><span class="ident" id="5660978">Encoder</span>&nbsp;<span class="op" id="5660986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660989">e</span>&nbsp;<span class="op" id="5660991">:=</span>&nbsp;<span class="op" id="5660994">&amp;</span><span class="ident" id="5660995">Encoder</span><span class="op" id="5661002">{</span><span class="ident" id="5661003">printer</span><span class="op" id="5661010">{</span><span class="ident" id="5661011">Writer</span><span class="op" id="5661017">:</span>&nbsp;<span class="ident" id="5661019">bufio</span><span class="op" id="5661024">.</span><span class="ident" id="5661025">NewWriter</span><span class="op" id="5661034">(</span><span class="ident" id="5661035">w</span><span class="op" id="5661036">)</span><span class="op" id="5661037">}</span><span class="op" id="5661038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661041">e</span><span class="op" id="5661042">.</span><span class="ident" id="5661043">p</span><span class="op" id="5661044">.</span><span class="ident" id="5661045">encoder</span>&nbsp;<span class="op" id="5661053">=</span>&nbsp;<span class="ident" id="5661055">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661058">return</span>&nbsp;<span class="ident" id="5661065">e</span><br>
<span class="lineno"></span><span class="op" id="5661067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5661070">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="5661135">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="5661211">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="5661275">func</span>&nbsp;<span class="op" id="5661280">(</span><span class="ident" id="5661281">enc</span>&nbsp;<span class="op" id="5661285">*</span><span class="ident" id="5661286">Encoder</span><span class="op" id="5661293">)</span>&nbsp;<span class="ident" id="5661295">Indent</span><span class="op" id="5661301">(</span><span class="ident" id="5661302">prefix</span><span class="op" id="5661308">,</span>&nbsp;<span class="ident" id="5661310">indent</span>&nbsp;<span class="builtintype" id="5661317">string</span><span class="op" id="5661323">)</span>&nbsp;<span class="op" id="5661325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661328">enc</span><span class="op" id="5661331">.</span><span class="ident" id="5661332">p</span><span class="op" id="5661333">.</span><span class="ident" id="5661334">prefix</span>&nbsp;<span class="op" id="5661341">=</span>&nbsp;<span class="ident" id="5661343">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661351">enc</span><span class="op" id="5661354">.</span><span class="ident" id="5661355">p</span><span class="op" id="5661356">.</span><span class="ident" id="5661357">indent</span>&nbsp;<span class="op" id="5661364">=</span>&nbsp;<span class="ident" id="5661366">indent</span><br>
<span class="lineno"></span><span class="op" id="5661373">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5661376">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="5661430">//</span><br>
<span class="lineno"></span><span class="comment" id="5661433">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="5661503">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="5661527">//</span><br>
<span class="lineno"></span><span class="comment" id="5661530">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="5661570">func</span>&nbsp;<span class="op" id="5661575">(</span><span class="ident" id="5661576">enc</span>&nbsp;<span class="op" id="5661580">*</span><span class="ident" id="5661581">Encoder</span><span class="op" id="5661588">)</span>&nbsp;<span class="ident" id="5661590">Encode</span><span class="op" id="5661596">(</span><span class="ident" id="5661597">v</span>&nbsp;<span class="keyword" id="5661599">interface</span><span class="op" id="5661608">{</span><span class="op" id="5661609">}</span><span class="op" id="5661610">)</span>&nbsp;<span class="builtintype" id="5661612">error</span>&nbsp;<span class="op" id="5661618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661621">err</span>&nbsp;<span class="op" id="5661625">:=</span>&nbsp;<span class="ident" id="5661628">enc</span><span class="op" id="5661631">.</span><span class="ident" id="5661632">p</span><span class="op" id="5661633">.</span><span class="ident" id="5661634">marshalValue</span><span class="op" id="5661646">(</span><span class="ident" id="5661647">reflect</span><span class="op" id="5661654">.</span><span class="ident" id="5661655">ValueOf</span><span class="op" id="5661662">(</span><span class="ident" id="5661663">v</span><span class="op" id="5661664">)</span><span class="op" id="5661665">,</span>&nbsp;<span class="builtintype" id="5661667">nil</span><span class="op" id="5661670">,</span>&nbsp;<span class="builtintype" id="5661672">nil</span><span class="op" id="5661675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661678">if</span>&nbsp;<span class="ident" id="5661681">err</span>&nbsp;<span class="op" id="5661685">!=</span>&nbsp;<span class="builtintype" id="5661688">nil</span>&nbsp;<span class="op" id="5661692">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661696">return</span>&nbsp;<span class="ident" id="5661703">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661711">return</span>&nbsp;<span class="ident" id="5661718">enc</span><span class="op" id="5661721">.</span><span class="ident" id="5661722">p</span><span class="op" id="5661723">.</span><span class="ident" id="5661724">Flush</span><span class="op" id="5661729">(</span><span class="op" id="5661730">)</span><br>
<span class="lineno"></span><span class="op" id="5661732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="5661735">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="5661796">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="5661849">//</span><br>
<span class="lineno"></span><span class="comment" id="5661852">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="5661922">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="5661946">//</span><br>
<span class="lineno"></span><span class="comment" id="5661949">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="5661996">func</span>&nbsp;<span class="op" id="5662001">(</span><span class="ident" id="5662002">enc</span>&nbsp;<span class="op" id="5662006">*</span><span class="ident" id="5662007">Encoder</span><span class="op" id="5662014">)</span>&nbsp;<span class="ident" id="5662016">EncodeElement</span><span class="op" id="5662029">(</span><span class="ident" id="5662030">v</span>&nbsp;<span class="keyword" id="5662032">interface</span><span class="op" id="5662041">{</span><span class="op" id="5662042">}</span><span class="op" id="5662043">,</span>&nbsp;<span class="ident" id="5662045">start</span>&nbsp;<span class="ident" id="5662051">StartElement</span><span class="op" id="5662063">)</span>&nbsp;<span class="builtintype" id="5662065">error</span>&nbsp;<span class="op" id="5662071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662074">err</span>&nbsp;<span class="op" id="5662078">:=</span>&nbsp;<span class="ident" id="5662081">enc</span><span class="op" id="5662084">.</span><span class="ident" id="5662085">p</span><span class="op" id="5662086">.</span><span class="ident" id="5662087">marshalValue</span><span class="op" id="5662099">(</span><span class="ident" id="5662100">reflect</span><span class="op" id="5662107">.</span><span class="ident" id="5662108">ValueOf</span><span class="op" id="5662115">(</span><span class="ident" id="5662116">v</span><span class="op" id="5662117">)</span><span class="op" id="5662118">,</span>&nbsp;<span class="builtintype" id="5662120">nil</span><span class="op" id="5662123">,</span>&nbsp;<span class="op" id="5662125">&amp;</span><span class="ident" id="5662126">start</span><span class="op" id="5662131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662134">if</span>&nbsp;<span class="ident" id="5662137">err</span>&nbsp;<span class="op" id="5662141">!=</span>&nbsp;<span class="builtintype" id="5662144">nil</span>&nbsp;<span class="op" id="5662148">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662152">return</span>&nbsp;<span class="ident" id="5662159">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662167">return</span>&nbsp;<span class="ident" id="5662174">enc</span><span class="op" id="5662177">.</span><span class="ident" id="5662178">p</span><span class="op" id="5662179">.</span><span class="ident" id="5662180">Flush</span><span class="op" id="5662185">(</span><span class="op" id="5662186">)</span><br>
<span class="lineno"></span><span class="op" id="5662188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="5662191">var</span>&nbsp;<span class="op" id="5662195">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662198">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5662211">=</span>&nbsp;<span class="op" id="5662213">[</span><span class="op" id="5662214">]</span><span class="builtintype" id="5662215">byte</span><span class="op" id="5662219">(</span><span class="string" id="5662220">&#34;--&gt;&#34;</span><span class="op" id="5662225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662228">endProcInst</span>&nbsp;&nbsp;<span class="op" id="5662241">=</span>&nbsp;<span class="op" id="5662243">[</span><span class="op" id="5662244">]</span><span class="builtintype" id="5662245">byte</span><span class="op" id="5662249">(</span><span class="string" id="5662250">&#34;?&gt;&#34;</span><span class="op" id="5662254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662257">endDirective</span>&nbsp;<span class="op" id="5662270">=</span>&nbsp;<span class="op" id="5662272">[</span><span class="op" id="5662273">]</span><span class="builtintype" id="5662274">byte</span><span class="op" id="5662278">(</span><span class="string" id="5662279">&#34;&gt;&#34;</span><span class="op" id="5662282">)</span><br>
<span class="lineno"></span><span class="op" id="5662284">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="5662287">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="5662344">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="5662431">//</span><br>
<span class="lineno"></span><span class="comment" id="5662434">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="5662519">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="5662598">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="5662657">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="5662737">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="5662814">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="5662867">//</span><br>
<span class="lineno"></span><span class="comment" id="5662870">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="5662960">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="5662978">func</span>&nbsp;<span class="op" id="5662983">(</span><span class="ident" id="5662984">enc</span>&nbsp;<span class="op" id="5662988">*</span><span class="ident" id="5662989">Encoder</span><span class="op" id="5662996">)</span>&nbsp;<span class="ident" id="5662998">EncodeToken</span><span class="op" id="5663009">(</span><span class="ident" id="5663010">t</span>&nbsp;<span class="ident" id="5663012">Token</span><span class="op" id="5663017">)</span>&nbsp;<span class="builtintype" id="5663019">error</span>&nbsp;<span class="op" id="5663025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663028">p</span>&nbsp;<span class="op" id="5663030">:=</span>&nbsp;<span class="op" id="5663033">&amp;</span><span class="ident" id="5663034">enc</span><span class="op" id="5663037">.</span><span class="ident" id="5663038">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663041">switch</span>&nbsp;<span class="ident" id="5663048">t</span>&nbsp;<span class="op" id="5663050">:=</span>&nbsp;<span class="ident" id="5663053">t</span><span class="op" id="5663054">.</span><span class="op" id="5663055">(</span><span class="keyword" id="5663056">type</span><span class="op" id="5663060">)</span>&nbsp;<span class="op" id="5663062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663065">case</span>&nbsp;<span class="ident" id="5663070">StartElement</span><span class="op" id="5663082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663086">if</span>&nbsp;<span class="ident" id="5663089">err</span>&nbsp;<span class="op" id="5663093">:=</span>&nbsp;<span class="ident" id="5663096">p</span><span class="op" id="5663097">.</span><span class="ident" id="5663098">writeStart</span><span class="op" id="5663108">(</span><span class="op" id="5663109">&amp;</span><span class="ident" id="5663110">t</span><span class="op" id="5663111">)</span><span class="op" id="5663112">;</span>&nbsp;<span class="ident" id="5663114">err</span>&nbsp;<span class="op" id="5663118">!=</span>&nbsp;<span class="builtintype" id="5663121">nil</span>&nbsp;<span class="op" id="5663125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663130">return</span>&nbsp;<span class="ident" id="5663137">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663143">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663146">case</span>&nbsp;<span class="ident" id="5663151">EndElement</span><span class="op" id="5663161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663165">if</span>&nbsp;<span class="ident" id="5663168">err</span>&nbsp;<span class="op" id="5663172">:=</span>&nbsp;<span class="ident" id="5663175">p</span><span class="op" id="5663176">.</span><span class="ident" id="5663177">writeEnd</span><span class="op" id="5663185">(</span><span class="ident" id="5663186">t</span><span class="op" id="5663187">.</span><span class="ident" id="5663188">Name</span><span class="op" id="5663192">)</span><span class="op" id="5663193">;</span>&nbsp;<span class="ident" id="5663195">err</span>&nbsp;<span class="op" id="5663199">!=</span>&nbsp;<span class="builtintype" id="5663202">nil</span>&nbsp;<span class="op" id="5663206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663211">return</span>&nbsp;<span class="ident" id="5663218">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663227">case</span>&nbsp;<span class="ident" id="5663232">CharData</span><span class="op" id="5663240">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663244">EscapeText</span><span class="op" id="5663254">(</span><span class="ident" id="5663255">p</span><span class="op" id="5663256">,</span>&nbsp;<span class="ident" id="5663258">t</span><span class="op" id="5663259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663262">case</span>&nbsp;<span class="ident" id="5663267">Comment</span><span class="op" id="5663274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663278">if</span>&nbsp;<span class="ident" id="5663281">bytes</span><span class="op" id="5663286">.</span><span class="ident" id="5663287">Contains</span><span class="op" id="5663295">(</span><span class="ident" id="5663296">t</span><span class="op" id="5663297">,</span>&nbsp;<span class="ident" id="5663299">endComment</span><span class="op" id="5663309">)</span>&nbsp;<span class="op" id="5663311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663316">return</span>&nbsp;<span class="ident" id="5663323">fmt</span><span class="op" id="5663326">.</span><span class="ident" id="5663327">Errorf</span><span class="op" id="5663333">(</span><span class="string" id="5663334">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="5663385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663389">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663393">p</span><span class="op" id="5663394">.</span><span class="ident" id="5663395">WriteString</span><span class="op" id="5663406">(</span><span class="string" id="5663407">&#34;&lt;!--&#34;</span><span class="op" id="5663413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663417">p</span><span class="op" id="5663418">.</span><span class="ident" id="5663419">Write</span><span class="op" id="5663424">(</span><span class="ident" id="5663425">t</span><span class="op" id="5663426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663430">p</span><span class="op" id="5663431">.</span><span class="ident" id="5663432">WriteString</span><span class="op" id="5663443">(</span><span class="string" id="5663444">&#34;--&gt;&#34;</span><span class="op" id="5663449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663453">return</span>&nbsp;<span class="ident" id="5663460">p</span><span class="op" id="5663461">.</span><span class="ident" id="5663462">cachedWriteError</span><span class="op" id="5663478">(</span><span class="op" id="5663479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663482">case</span>&nbsp;<span class="ident" id="5663487">ProcInst</span><span class="op" id="5663495">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5663499">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5663574">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663654">if</span>&nbsp;<span class="ident" id="5663657">t</span><span class="op" id="5663658">.</span><span class="ident" id="5663659">Target</span>&nbsp;<span class="op" id="5663666">==</span>&nbsp;<span class="string" id="5663669">&#34;xml&#34;</span>&nbsp;<span class="op" id="5663675">&amp;&amp;</span>&nbsp;<span class="ident" id="5663678">p</span><span class="op" id="5663679">.</span><span class="ident" id="5663680">Buffered</span><span class="op" id="5663688">(</span><span class="op" id="5663689">)</span>&nbsp;<span class="op" id="5663691">!=</span>&nbsp;<span class="num" id="5663694">0</span>&nbsp;<span class="op" id="5663696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663701">return</span>&nbsp;<span class="ident" id="5663708">fmt</span><span class="op" id="5663711">.</span><span class="ident" id="5663712">Errorf</span><span class="op" id="5663718">(</span><span class="string" id="5663719">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="5663812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663816">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663820">if</span>&nbsp;<span class="op" id="5663823">!</span><span class="ident" id="5663824">isNameString</span><span class="op" id="5663836">(</span><span class="ident" id="5663837">t</span><span class="op" id="5663838">.</span><span class="ident" id="5663839">Target</span><span class="op" id="5663845">)</span>&nbsp;<span class="op" id="5663847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663852">return</span>&nbsp;<span class="ident" id="5663859">fmt</span><span class="op" id="5663862">.</span><span class="ident" id="5663863">Errorf</span><span class="op" id="5663869">(</span><span class="string" id="5663870">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="5663920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663928">if</span>&nbsp;<span class="ident" id="5663931">bytes</span><span class="op" id="5663936">.</span><span class="ident" id="5663937">Contains</span><span class="op" id="5663945">(</span><span class="ident" id="5663946">t</span><span class="op" id="5663947">.</span><span class="ident" id="5663948">Inst</span><span class="op" id="5663952">,</span>&nbsp;<span class="ident" id="5663954">endProcInst</span><span class="op" id="5663965">)</span>&nbsp;<span class="op" id="5663967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663972">return</span>&nbsp;<span class="ident" id="5663979">fmt</span><span class="op" id="5663982">.</span><span class="ident" id="5663983">Errorf</span><span class="op" id="5663989">(</span><span class="string" id="5663990">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="5664041">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664049">p</span><span class="op" id="5664050">.</span><span class="ident" id="5664051">WriteString</span><span class="op" id="5664062">(</span><span class="string" id="5664063">&#34;&lt;?&#34;</span><span class="op" id="5664067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664071">p</span><span class="op" id="5664072">.</span><span class="ident" id="5664073">WriteString</span><span class="op" id="5664084">(</span><span class="ident" id="5664085">t</span><span class="op" id="5664086">.</span><span class="ident" id="5664087">Target</span><span class="op" id="5664093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664097">if</span>&nbsp;<span class="builtinfunc" id="5664100">len</span><span class="op" id="5664103">(</span><span class="ident" id="5664104">t</span><span class="op" id="5664105">.</span><span class="ident" id="5664106">Inst</span><span class="op" id="5664110">)</span>&nbsp;<span class="op" id="5664112">&gt;</span>&nbsp;<span class="num" id="5664114">0</span>&nbsp;<span class="op" id="5664116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664121">p</span><span class="op" id="5664122">.</span><span class="ident" id="5664123">WriteByte</span><span class="op" id="5664132">(</span><span class="string" id="5664133">&#39;&nbsp;&#39;</span><span class="op" id="5664136">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664141">p</span><span class="op" id="5664142">.</span><span class="ident" id="5664143">Write</span><span class="op" id="5664148">(</span><span class="ident" id="5664149">t</span><span class="op" id="5664150">.</span><span class="ident" id="5664151">Inst</span><span class="op" id="5664155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664163">p</span><span class="op" id="5664164">.</span><span class="ident" id="5664165">WriteString</span><span class="op" id="5664176">(</span><span class="string" id="5664177">&#34;?&gt;&#34;</span><span class="op" id="5664181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664184">case</span>&nbsp;<span class="ident" id="5664189">Directive</span><span class="op" id="5664198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664202">if</span>&nbsp;<span class="ident" id="5664205">bytes</span><span class="op" id="5664210">.</span><span class="ident" id="5664211">Contains</span><span class="op" id="5664219">(</span><span class="ident" id="5664220">t</span><span class="op" id="5664221">,</span>&nbsp;<span class="ident" id="5664223">endDirective</span><span class="op" id="5664235">)</span>&nbsp;<span class="op" id="5664237">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664242">return</span>&nbsp;<span class="ident" id="5664249">fmt</span><span class="op" id="5664252">.</span><span class="ident" id="5664253">Errorf</span><span class="op" id="5664259">(</span><span class="string" id="5664260">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="5664311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664319">p</span><span class="op" id="5664320">.</span><span class="ident" id="5664321">WriteString</span><span class="op" id="5664332">(</span><span class="string" id="5664333">&#34;&lt;!&#34;</span><span class="op" id="5664337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664341">p</span><span class="op" id="5664342">.</span><span class="ident" id="5664343">Write</span><span class="op" id="5664348">(</span><span class="ident" id="5664349">t</span><span class="op" id="5664350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664354">p</span><span class="op" id="5664355">.</span><span class="ident" id="5664356">WriteString</span><span class="op" id="5664367">(</span><span class="string" id="5664368">&#34;&gt;&#34;</span><span class="op" id="5664371">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664377">return</span>&nbsp;<span class="ident" id="5664384">p</span><span class="op" id="5664385">.</span><span class="ident" id="5664386">cachedWriteError</span><span class="op" id="5664402">(</span><span class="op" id="5664403">)</span><br>
<span class="lineno"></span><span class="op" id="5664405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5664408">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="5664468">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="5664545">func</span>&nbsp;<span class="op" id="5664550">(</span><span class="ident" id="5664551">enc</span>&nbsp;<span class="op" id="5664555">*</span><span class="ident" id="5664556">Encoder</span><span class="op" id="5664563">)</span>&nbsp;<span class="ident" id="5664565">Flush</span><span class="op" id="5664570">(</span><span class="op" id="5664571">)</span>&nbsp;<span class="builtintype" id="5664573">error</span>&nbsp;<span class="op" id="5664579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664582">return</span>&nbsp;<span class="ident" id="5664589">enc</span><span class="op" id="5664592">.</span><span class="ident" id="5664593">p</span><span class="op" id="5664594">.</span><span class="ident" id="5664595">Flush</span><span class="op" id="5664600">(</span><span class="op" id="5664601">)</span><br>
<span class="lineno"></span><span class="op" id="5664603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="5664606">type</span>&nbsp;<span class="ident" id="5664611">printer</span>&nbsp;<span class="keyword" id="5664619">struct</span>&nbsp;<span class="op" id="5664626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664629">*</span><span class="ident" id="5664630">bufio</span><span class="op" id="5664635">.</span><span class="ident" id="5664636">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664644">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664655">*</span><span class="ident" id="5664656">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664665">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5664676">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664681">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5664692">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664700">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5664711">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664719">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5664730">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664735">indentedIn</span>&nbsp;<span class="builtintype" id="5664746">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664752">putNewline</span>&nbsp;<span class="builtintype" id="5664763">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664769">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664780">map</span><span class="op" id="5664783">[</span><span class="builtintype" id="5664784">string</span><span class="op" id="5664790">]</span><span class="builtintype" id="5664791">string</span>&nbsp;<span class="comment" id="5664798">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664827">attrPrefix</span>&nbsp;<span class="keyword" id="5664838">map</span><span class="op" id="5664841">[</span><span class="builtintype" id="5664842">string</span><span class="op" id="5664848">]</span><span class="builtintype" id="5664849">string</span>&nbsp;<span class="comment" id="5664856">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664885">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5664896">[</span><span class="op" id="5664897">]</span><span class="builtintype" id="5664898">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664906">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664917">[</span><span class="op" id="5664918">]</span><span class="ident" id="5664919">Name</span><br>
<span class="lineno"></span><span class="op" id="5664924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="5664927">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="5665018">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="5665080">func</span>&nbsp;<span class="op" id="5665085">(</span><span class="ident" id="5665086">p</span>&nbsp;<span class="op" id="5665088">*</span><span class="ident" id="5665089">printer</span><span class="op" id="5665096">)</span>&nbsp;<span class="ident" id="5665098">createAttrPrefix</span><span class="op" id="5665114">(</span><span class="ident" id="5665115">url</span>&nbsp;<span class="builtintype" id="5665119">string</span><span class="op" id="5665125">)</span>&nbsp;<span class="builtintype" id="5665127">string</span>&nbsp;<span class="op" id="5665134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665137">if</span>&nbsp;<span class="ident" id="5665140">prefix</span>&nbsp;<span class="op" id="5665147">:=</span>&nbsp;<span class="ident" id="5665150">p</span><span class="op" id="5665151">.</span><span class="ident" id="5665152">attrPrefix</span><span class="op" id="5665162">[</span><span class="ident" id="5665163">url</span><span class="op" id="5665166">]</span><span class="op" id="5665167">;</span>&nbsp;<span class="ident" id="5665169">prefix</span>&nbsp;<span class="op" id="5665176">!=</span>&nbsp;<span class="string" id="5665179">&#34;&#34;</span>&nbsp;<span class="op" id="5665182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665186">return</span>&nbsp;<span class="ident" id="5665193">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665205">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665286">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665324">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665407">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665486">if</span>&nbsp;<span class="ident" id="5665489">url</span>&nbsp;<span class="op" id="5665493">==</span>&nbsp;<span class="ident" id="5665496">xmlURL</span>&nbsp;<span class="op" id="5665503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665507">return</span>&nbsp;<span class="string" id="5665514">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665525">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665562">if</span>&nbsp;<span class="ident" id="5665565">p</span><span class="op" id="5665566">.</span><span class="ident" id="5665567">attrPrefix</span>&nbsp;<span class="op" id="5665578">==</span>&nbsp;<span class="builtintype" id="5665581">nil</span>&nbsp;<span class="op" id="5665585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665589">p</span><span class="op" id="5665590">.</span><span class="ident" id="5665591">attrPrefix</span>&nbsp;<span class="op" id="5665602">=</span>&nbsp;<span class="builtinfunc" id="5665604">make</span><span class="op" id="5665608">(</span><span class="keyword" id="5665609">map</span><span class="op" id="5665612">[</span><span class="builtintype" id="5665613">string</span><span class="op" id="5665619">]</span><span class="builtintype" id="5665620">string</span><span class="op" id="5665626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665630">p</span><span class="op" id="5665631">.</span><span class="ident" id="5665632">attrNS</span>&nbsp;<span class="op" id="5665639">=</span>&nbsp;<span class="builtinfunc" id="5665641">make</span><span class="op" id="5665645">(</span><span class="keyword" id="5665646">map</span><span class="op" id="5665649">[</span><span class="builtintype" id="5665650">string</span><span class="op" id="5665656">]</span><span class="builtintype" id="5665657">string</span><span class="op" id="5665663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665666">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665670">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5665731">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665755">prefix</span>&nbsp;<span class="op" id="5665762">:=</span>&nbsp;<span class="ident" id="5665765">strings</span><span class="op" id="5665772">.</span><span class="ident" id="5665773">TrimRight</span><span class="op" id="5665782">(</span><span class="ident" id="5665783">url</span><span class="op" id="5665786">,</span>&nbsp;<span class="string" id="5665788">&#34;/&#34;</span><span class="op" id="5665791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665794">if</span>&nbsp;<span class="ident" id="5665797">i</span>&nbsp;<span class="op" id="5665799">:=</span>&nbsp;<span class="ident" id="5665802">strings</span><span class="op" id="5665809">.</span><span class="ident" id="5665810">LastIndex</span><span class="op" id="5665819">(</span><span class="ident" id="5665820">prefix</span><span class="op" id="5665826">,</span>&nbsp;<span class="string" id="5665828">&#34;/&#34;</span><span class="op" id="5665831">)</span><span class="op" id="5665832">;</span>&nbsp;<span class="ident" id="5665834">i</span>&nbsp;<span class="op" id="5665836">&gt;=</span>&nbsp;<span class="num" id="5665839">0</span>&nbsp;<span class="op" id="5665841">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665845">prefix</span>&nbsp;<span class="op" id="5665852">=</span>&nbsp;<span class="ident" id="5665854">prefix</span><span class="op" id="5665860">[</span><span class="ident" id="5665861">i</span><span class="op" id="5665862">+</span><span class="num" id="5665863">1</span><span class="op" id="5665864">:</span><span class="op" id="5665865">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665871">if</span>&nbsp;<span class="ident" id="5665874">prefix</span>&nbsp;<span class="op" id="5665881">==</span>&nbsp;<span class="string" id="5665884">&#34;&#34;</span>&nbsp;<span class="op" id="5665887">||</span>&nbsp;<span class="op" id="5665890">!</span><span class="ident" id="5665891">isName</span><span class="op" id="5665897">(</span><span class="op" id="5665898">[</span><span class="op" id="5665899">]</span><span class="builtintype" id="5665900">byte</span><span class="op" id="5665904">(</span><span class="ident" id="5665905">prefix</span><span class="op" id="5665911">)</span><span class="op" id="5665912">)</span>&nbsp;<span class="op" id="5665914">||</span>&nbsp;<span class="ident" id="5665917">strings</span><span class="op" id="5665924">.</span><span class="ident" id="5665925">Contains</span><span class="op" id="5665933">(</span><span class="ident" id="5665934">prefix</span><span class="op" id="5665940">,</span>&nbsp;<span class="string" id="5665942">&#34;:&#34;</span><span class="op" id="5665945">)</span>&nbsp;<span class="op" id="5665947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665951">prefix</span>&nbsp;<span class="op" id="5665958">=</span>&nbsp;<span class="string" id="5665960">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665965">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665968">if</span>&nbsp;<span class="ident" id="5665971">strings</span><span class="op" id="5665978">.</span><span class="ident" id="5665979">HasPrefix</span><span class="op" id="5665988">(</span><span class="ident" id="5665989">prefix</span><span class="op" id="5665995">,</span>&nbsp;<span class="string" id="5665997">&#34;xml&#34;</span><span class="op" id="5666002">)</span>&nbsp;<span class="op" id="5666004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5666008">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666038">prefix</span>&nbsp;<span class="op" id="5666045">=</span>&nbsp;<span class="string" id="5666047">&#34;_&#34;</span>&nbsp;<span class="op" id="5666051">+</span>&nbsp;<span class="ident" id="5666053">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666064">if</span>&nbsp;<span class="ident" id="5666067">p</span><span class="op" id="5666068">.</span><span class="ident" id="5666069">attrNS</span><span class="op" id="5666075">[</span><span class="ident" id="5666076">prefix</span><span class="op" id="5666082">]</span>&nbsp;<span class="op" id="5666084">!=</span>&nbsp;<span class="string" id="5666087">&#34;&#34;</span>&nbsp;<span class="op" id="5666090">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5666094">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666133">for</span>&nbsp;<span class="ident" id="5666137">p</span><span class="op" id="5666138">.</span><span class="ident" id="5666139">seq</span><span class="op" id="5666142">++</span><span class="op" id="5666144">;</span>&nbsp;<span class="op" id="5666146">;</span>&nbsp;<span class="ident" id="5666148">p</span><span class="op" id="5666149">.</span><span class="ident" id="5666150">seq</span><span class="op" id="5666153">++</span>&nbsp;<span class="op" id="5666156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666161">if</span>&nbsp;<span class="ident" id="5666164">id</span>&nbsp;<span class="op" id="5666167">:=</span>&nbsp;<span class="ident" id="5666170">prefix</span>&nbsp;<span class="op" id="5666177">+</span>&nbsp;<span class="string" id="5666179">&#34;_&#34;</span>&nbsp;<span class="op" id="5666183">+</span>&nbsp;<span class="ident" id="5666185">strconv</span><span class="op" id="5666192">.</span><span class="ident" id="5666193">Itoa</span><span class="op" id="5666197">(</span><span class="ident" id="5666198">p</span><span class="op" id="5666199">.</span><span class="ident" id="5666200">seq</span><span class="op" id="5666203">)</span><span class="op" id="5666204">;</span>&nbsp;<span class="ident" id="5666206">p</span><span class="op" id="5666207">.</span><span class="ident" id="5666208">attrNS</span><span class="op" id="5666214">[</span><span class="ident" id="5666215">id</span><span class="op" id="5666217">]</span>&nbsp;<span class="op" id="5666219">==</span>&nbsp;<span class="string" id="5666222">&#34;&#34;</span>&nbsp;<span class="op" id="5666225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666231">prefix</span>&nbsp;<span class="op" id="5666238">=</span>&nbsp;<span class="ident" id="5666240">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666247">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666267">p</span><span class="op" id="5666268">.</span><span class="ident" id="5666269">attrPrefix</span><span class="op" id="5666279">[</span><span class="ident" id="5666280">url</span><span class="op" id="5666283">]</span>&nbsp;<span class="op" id="5666285">=</span>&nbsp;<span class="ident" id="5666287">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666295">p</span><span class="op" id="5666296">.</span><span class="ident" id="5666297">attrNS</span><span class="op" id="5666303">[</span><span class="ident" id="5666304">prefix</span><span class="op" id="5666310">]</span>&nbsp;<span class="op" id="5666312">=</span>&nbsp;<span class="ident" id="5666314">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666320">p</span><span class="op" id="5666321">.</span><span class="ident" id="5666322">WriteString</span><span class="op" id="5666333">(</span><span class="string" id="5666334">`xmlns:`</span><span class="op" id="5666342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666345">p</span><span class="op" id="5666346">.</span><span class="ident" id="5666347">WriteString</span><span class="op" id="5666358">(</span><span class="ident" id="5666359">prefix</span><span class="op" id="5666365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666368">p</span><span class="op" id="5666369">.</span><span class="ident" id="5666370">WriteString</span><span class="op" id="5666381">(</span><span class="string" id="5666382">`=&#34;`</span><span class="op" id="5666386">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666389">EscapeText</span><span class="op" id="5666399">(</span><span class="ident" id="5666400">p</span><span class="op" id="5666401">,</span>&nbsp;<span class="op" id="5666403">[</span><span class="op" id="5666404">]</span><span class="builtintype" id="5666405">byte</span><span class="op" id="5666409">(</span><span class="ident" id="5666410">url</span><span class="op" id="5666413">)</span><span class="op" id="5666414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666417">p</span><span class="op" id="5666418">.</span><span class="ident" id="5666419">WriteString</span><span class="op" id="5666430">(</span><span class="string" id="5666431">`&#34;&nbsp;`</span><span class="op" id="5666435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666439">p</span><span class="op" id="5666440">.</span><span class="ident" id="5666441">prefixes</span>&nbsp;<span class="op" id="5666450">=</span>&nbsp;<span class="builtinfunc" id="5666452">append</span><span class="op" id="5666458">(</span><span class="ident" id="5666459">p</span><span class="op" id="5666460">.</span><span class="ident" id="5666461">prefixes</span><span class="op" id="5666469">,</span>&nbsp;<span class="ident" id="5666471">prefix</span><span class="op" id="5666477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666481">return</span>&nbsp;<span class="ident" id="5666488">prefix</span><br>
<span class="lineno"></span><span class="op" id="5666495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5666498">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="5666558">func</span>&nbsp;<span class="op" id="5666563">(</span><span class="ident" id="5666564">p</span>&nbsp;<span class="op" id="5666566">*</span><span class="ident" id="5666567">printer</span><span class="op" id="5666574">)</span>&nbsp;<span class="ident" id="5666576">deleteAttrPrefix</span><span class="op" id="5666592">(</span><span class="ident" id="5666593">prefix</span>&nbsp;<span class="builtintype" id="5666600">string</span><span class="op" id="5666606">)</span>&nbsp;<span class="op" id="5666608">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5666611">delete</span><span class="op" id="5666617">(</span><span class="ident" id="5666618">p</span><span class="op" id="5666619">.</span><span class="ident" id="5666620">attrPrefix</span><span class="op" id="5666630">,</span>&nbsp;<span class="ident" id="5666632">p</span><span class="op" id="5666633">.</span><span class="ident" id="5666634">attrNS</span><span class="op" id="5666640">[</span><span class="ident" id="5666641">prefix</span><span class="op" id="5666647">]</span><span class="op" id="5666648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5666651">delete</span><span class="op" id="5666657">(</span><span class="ident" id="5666658">p</span><span class="op" id="5666659">.</span><span class="ident" id="5666660">attrNS</span><span class="op" id="5666666">,</span>&nbsp;<span class="ident" id="5666668">prefix</span><span class="op" id="5666674">)</span><br>
<span class="lineno"></span><span class="op" id="5666676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666679">func</span>&nbsp;<span class="op" id="5666684">(</span><span class="ident" id="5666685">p</span>&nbsp;<span class="op" id="5666687">*</span><span class="ident" id="5666688">printer</span><span class="op" id="5666695">)</span>&nbsp;<span class="ident" id="5666697">markPrefix</span><span class="op" id="5666707">(</span><span class="op" id="5666708">)</span>&nbsp;<span class="op" id="5666710">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666713">p</span><span class="op" id="5666714">.</span><span class="ident" id="5666715">prefixes</span>&nbsp;<span class="op" id="5666724">=</span>&nbsp;<span class="builtinfunc" id="5666726">append</span><span class="op" id="5666732">(</span><span class="ident" id="5666733">p</span><span class="op" id="5666734">.</span><span class="ident" id="5666735">prefixes</span><span class="op" id="5666743">,</span>&nbsp;<span class="string" id="5666745">&#34;&#34;</span><span class="op" id="5666747">)</span><br>
<span class="lineno"></span><span class="op" id="5666749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666752">func</span>&nbsp;<span class="op" id="5666757">(</span><span class="ident" id="5666758">p</span>&nbsp;<span class="op" id="5666760">*</span><span class="ident" id="5666761">printer</span><span class="op" id="5666768">)</span>&nbsp;<span class="ident" id="5666770">popPrefix</span><span class="op" id="5666779">(</span><span class="op" id="5666780">)</span>&nbsp;<span class="op" id="5666782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666785">for</span>&nbsp;<span class="builtinfunc" id="5666789">len</span><span class="op" id="5666792">(</span><span class="ident" id="5666793">p</span><span class="op" id="5666794">.</span><span class="ident" id="5666795">prefixes</span><span class="op" id="5666803">)</span>&nbsp;<span class="op" id="5666805">&gt;</span>&nbsp;<span class="num" id="5666807">0</span>&nbsp;<span class="op" id="5666809">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666813">prefix</span>&nbsp;<span class="op" id="5666820">:=</span>&nbsp;<span class="ident" id="5666823">p</span><span class="op" id="5666824">.</span><span class="ident" id="5666825">prefixes</span><span class="op" id="5666833">[</span><span class="builtinfunc" id="5666834">len</span><span class="op" id="5666837">(</span><span class="ident" id="5666838">p</span><span class="op" id="5666839">.</span><span class="ident" id="5666840">prefixes</span><span class="op" id="5666848">)</span><span class="op" id="5666849">-</span><span class="num" id="5666850">1</span><span class="op" id="5666851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666855">p</span><span class="op" id="5666856">.</span><span class="ident" id="5666857">prefixes</span>&nbsp;<span class="op" id="5666866">=</span>&nbsp;<span class="ident" id="5666868">p</span><span class="op" id="5666869">.</span><span class="ident" id="5666870">prefixes</span><span class="op" id="5666878">[</span><span class="op" id="5666879">:</span><span class="builtinfunc" id="5666880">len</span><span class="op" id="5666883">(</span><span class="ident" id="5666884">p</span><span class="op" id="5666885">.</span><span class="ident" id="5666886">prefixes</span><span class="op" id="5666894">)</span><span class="op" id="5666895">-</span><span class="num" id="5666896">1</span><span class="op" id="5666897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666901">if</span>&nbsp;<span class="ident" id="5666904">prefix</span>&nbsp;<span class="op" id="5666911">==</span>&nbsp;<span class="string" id="5666914">&#34;&#34;</span>&nbsp;<span class="op" id="5666917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5666922">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666930">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666934">p</span><span class="op" id="5666935">.</span><span class="ident" id="5666936">deleteAttrPrefix</span><span class="op" id="5666952">(</span><span class="ident" id="5666953">prefix</span><span class="op" id="5666959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666962">}</span><br>
<span class="lineno"></span><span class="op" id="5666964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5666967">var</span>&nbsp;<span class="op" id="5666971">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5666974">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5666992">=</span>&nbsp;<span class="ident" id="5666994">reflect</span><span class="op" id="5667001">.</span><span class="ident" id="5667002">TypeOf</span><span class="op" id="5667008">(</span><span class="op" id="5667009">(</span><span class="op" id="5667010">*</span><span class="ident" id="5667011">Marshaler</span><span class="op" id="5667020">)</span><span class="op" id="5667021">(</span><span class="builtintype" id="5667022">nil</span><span class="op" id="5667025">)</span><span class="op" id="5667026">)</span><span class="op" id="5667027">.</span><span class="ident" id="5667028">Elem</span><span class="op" id="5667032">(</span><span class="op" id="5667033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667036">marshalerAttrType</span>&nbsp;<span class="op" id="5667054">=</span>&nbsp;<span class="ident" id="5667056">reflect</span><span class="op" id="5667063">.</span><span class="ident" id="5667064">TypeOf</span><span class="op" id="5667070">(</span><span class="op" id="5667071">(</span><span class="op" id="5667072">*</span><span class="ident" id="5667073">MarshalerAttr</span><span class="op" id="5667086">)</span><span class="op" id="5667087">(</span><span class="builtintype" id="5667088">nil</span><span class="op" id="5667091">)</span><span class="op" id="5667092">)</span><span class="op" id="5667093">.</span><span class="ident" id="5667094">Elem</span><span class="op" id="5667098">(</span><span class="op" id="5667099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667102">textMarshalerType</span>&nbsp;<span class="op" id="5667120">=</span>&nbsp;<span class="ident" id="5667122">reflect</span><span class="op" id="5667129">.</span><span class="ident" id="5667130">TypeOf</span><span class="op" id="5667136">(</span><span class="op" id="5667137">(</span><span class="op" id="5667138">*</span><span class="ident" id="5667139">encoding</span><span class="op" id="5667147">.</span><span class="ident" id="5667148">TextMarshaler</span><span class="op" id="5667161">)</span><span class="op" id="5667162">(</span><span class="builtintype" id="5667163">nil</span><span class="op" id="5667166">)</span><span class="op" id="5667167">)</span><span class="op" id="5667168">.</span><span class="ident" id="5667169">Elem</span><span class="op" id="5667173">(</span><span class="op" id="5667174">)</span><br>
<span class="lineno"></span><span class="op" id="5667176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="5667179">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="5667245">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="5667318">func</span>&nbsp;<span class="op" id="5667323">(</span><span class="ident" id="5667324">p</span>&nbsp;<span class="op" id="5667326">*</span><span class="ident" id="5667327">printer</span><span class="op" id="5667334">)</span>&nbsp;<span class="ident" id="5667336">marshalValue</span><span class="op" id="5667348">(</span><span class="ident" id="5667349">val</span>&nbsp;<span class="ident" id="5667353">reflect</span><span class="op" id="5667360">.</span><span class="ident" id="5667361">Value</span><span class="op" id="5667366">,</span>&nbsp;<span class="ident" id="5667368">finfo</span>&nbsp;<span class="op" id="5667374">*</span><span class="ident" id="5667375">fieldInfo</span><span class="op" id="5667384">,</span>&nbsp;<span class="ident" id="5667386">startTemplate</span>&nbsp;<span class="op" id="5667400">*</span><span class="ident" id="5667401">StartElement</span><span class="op" id="5667413">)</span>&nbsp;<span class="builtintype" id="5667415">error</span>&nbsp;<span class="op" id="5667421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667424">if</span>&nbsp;<span class="ident" id="5667427">startTemplate</span>&nbsp;<span class="op" id="5667441">!=</span>&nbsp;<span class="builtintype" id="5667444">nil</span>&nbsp;<span class="op" id="5667448">&amp;&amp;</span>&nbsp;<span class="ident" id="5667451">startTemplate</span><span class="op" id="5667464">.</span><span class="ident" id="5667465">Name</span><span class="op" id="5667469">.</span><span class="ident" id="5667470">Local</span>&nbsp;<span class="op" id="5667476">==</span>&nbsp;<span class="string" id="5667479">&#34;&#34;</span>&nbsp;<span class="op" id="5667482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667486">return</span>&nbsp;<span class="ident" id="5667493">fmt</span><span class="op" id="5667496">.</span><span class="ident" id="5667497">Errorf</span><span class="op" id="5667503">(</span><span class="string" id="5667504">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="5667558">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667565">if</span>&nbsp;<span class="op" id="5667568">!</span><span class="ident" id="5667569">val</span><span class="op" id="5667572">.</span><span class="ident" id="5667573">IsValid</span><span class="op" id="5667580">(</span><span class="op" id="5667581">)</span>&nbsp;<span class="op" id="5667583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667587">return</span>&nbsp;<span class="builtintype" id="5667594">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667599">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667602">if</span>&nbsp;<span class="ident" id="5667605">finfo</span>&nbsp;<span class="op" id="5667611">!=</span>&nbsp;<span class="builtintype" id="5667614">nil</span>&nbsp;<span class="op" id="5667618">&amp;&amp;</span>&nbsp;<span class="ident" id="5667621">finfo</span><span class="op" id="5667626">.</span><span class="ident" id="5667627">flags</span><span class="op" id="5667632">&amp;</span><span class="ident" id="5667633">fOmitEmpty</span>&nbsp;<span class="op" id="5667644">!=</span>&nbsp;<span class="num" id="5667647">0</span>&nbsp;<span class="op" id="5667649">&amp;&amp;</span>&nbsp;<span class="ident" id="5667652">isEmptyValue</span><span class="op" id="5667664">(</span><span class="ident" id="5667665">val</span><span class="op" id="5667668">)</span>&nbsp;<span class="op" id="5667670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667674">return</span>&nbsp;<span class="builtintype" id="5667681">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5667690">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5667730">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5667792">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667830">for</span>&nbsp;<span class="ident" id="5667834">val</span><span class="op" id="5667837">.</span><span class="ident" id="5667838">Kind</span><span class="op" id="5667842">(</span><span class="op" id="5667843">)</span>&nbsp;<span class="op" id="5667845">==</span>&nbsp;<span class="ident" id="5667848">reflect</span><span class="op" id="5667855">.</span><span class="ident" id="5667856">Interface</span>&nbsp;<span class="op" id="5667866">||</span>&nbsp;<span class="ident" id="5667869">val</span><span class="op" id="5667872">.</span><span class="ident" id="5667873">Kind</span><span class="op" id="5667877">(</span><span class="op" id="5667878">)</span>&nbsp;<span class="op" id="5667880">==</span>&nbsp;<span class="ident" id="5667883">reflect</span><span class="op" id="5667890">.</span><span class="ident" id="5667891">Ptr</span>&nbsp;<span class="op" id="5667895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667899">if</span>&nbsp;<span class="ident" id="5667902">val</span><span class="op" id="5667905">.</span><span class="ident" id="5667906">IsNil</span><span class="op" id="5667911">(</span><span class="op" id="5667912">)</span>&nbsp;<span class="op" id="5667914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5667919">return</span>&nbsp;<span class="builtintype" id="5667926">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667936">val</span>&nbsp;<span class="op" id="5667940">=</span>&nbsp;<span class="ident" id="5667942">val</span><span class="op" id="5667945">.</span><span class="ident" id="5667946">Elem</span><span class="op" id="5667950">(</span><span class="op" id="5667951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5667954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667958">kind</span>&nbsp;<span class="op" id="5667963">:=</span>&nbsp;<span class="ident" id="5667966">val</span><span class="op" id="5667969">.</span><span class="ident" id="5667970">Kind</span><span class="op" id="5667974">(</span><span class="op" id="5667975">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5667978">typ</span>&nbsp;<span class="op" id="5667982">:=</span>&nbsp;<span class="ident" id="5667985">val</span><span class="op" id="5667988">.</span><span class="ident" id="5667989">Type</span><span class="op" id="5667993">(</span><span class="op" id="5667994">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5667998">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668023">if</span>&nbsp;<span class="ident" id="5668026">val</span><span class="op" id="5668029">.</span><span class="ident" id="5668030">CanInterface</span><span class="op" id="5668042">(</span><span class="op" id="5668043">)</span>&nbsp;<span class="op" id="5668045">&amp;&amp;</span>&nbsp;<span class="ident" id="5668048">typ</span><span class="op" id="5668051">.</span><span class="ident" id="5668052">Implements</span><span class="op" id="5668062">(</span><span class="ident" id="5668063">marshalerType</span><span class="op" id="5668076">)</span>&nbsp;<span class="op" id="5668078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668082">return</span>&nbsp;<span class="ident" id="5668089">p</span><span class="op" id="5668090">.</span><span class="ident" id="5668091">marshalInterface</span><span class="op" id="5668107">(</span><span class="ident" id="5668108">val</span><span class="op" id="5668111">.</span><span class="ident" id="5668112">Interface</span><span class="op" id="5668121">(</span><span class="op" id="5668122">)</span><span class="op" id="5668123">.</span><span class="op" id="5668124">(</span><span class="ident" id="5668125">Marshaler</span><span class="op" id="5668134">)</span><span class="op" id="5668135">,</span>&nbsp;<span class="ident" id="5668137">defaultStart</span><span class="op" id="5668149">(</span><span class="ident" id="5668150">typ</span><span class="op" id="5668153">,</span>&nbsp;<span class="ident" id="5668155">finfo</span><span class="op" id="5668160">,</span>&nbsp;<span class="ident" id="5668162">startTemplate</span><span class="op" id="5668175">)</span><span class="op" id="5668176">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668182">if</span>&nbsp;<span class="ident" id="5668185">val</span><span class="op" id="5668188">.</span><span class="ident" id="5668189">CanAddr</span><span class="op" id="5668196">(</span><span class="op" id="5668197">)</span>&nbsp;<span class="op" id="5668199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5668203">pv</span>&nbsp;<span class="op" id="5668206">:=</span>&nbsp;<span class="ident" id="5668209">val</span><span class="op" id="5668212">.</span><span class="ident" id="5668213">Addr</span><span class="op" id="5668217">(</span><span class="op" id="5668218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668222">if</span>&nbsp;<span class="ident" id="5668225">pv</span><span class="op" id="5668227">.</span><span class="ident" id="5668228">CanInterface</span><span class="op" id="5668240">(</span><span class="op" id="5668241">)</span>&nbsp;<span class="op" id="5668243">&amp;&amp;</span>&nbsp;<span class="ident" id="5668246">pv</span><span class="op" id="5668248">.</span><span class="ident" id="5668249">Type</span><span class="op" id="5668253">(</span><span class="op" id="5668254">)</span><span class="op" id="5668255">.</span><span class="ident" id="5668256">Implements</span><span class="op" id="5668266">(</span><span class="ident" id="5668267">marshalerType</span><span class="op" id="5668280">)</span>&nbsp;<span class="op" id="5668282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668287">return</span>&nbsp;<span class="ident" id="5668294">p</span><span class="op" id="5668295">.</span><span class="ident" id="5668296">marshalInterface</span><span class="op" id="5668312">(</span><span class="ident" id="5668313">pv</span><span class="op" id="5668315">.</span><span class="ident" id="5668316">Interface</span><span class="op" id="5668325">(</span><span class="op" id="5668326">)</span><span class="op" id="5668327">.</span><span class="op" id="5668328">(</span><span class="ident" id="5668329">Marshaler</span><span class="op" id="5668338">)</span><span class="op" id="5668339">,</span>&nbsp;<span class="ident" id="5668341">defaultStart</span><span class="op" id="5668353">(</span><span class="ident" id="5668354">pv</span><span class="op" id="5668356">.</span><span class="ident" id="5668357">Type</span><span class="op" id="5668361">(</span><span class="op" id="5668362">)</span><span class="op" id="5668363">,</span>&nbsp;<span class="ident" id="5668365">finfo</span><span class="op" id="5668370">,</span>&nbsp;<span class="ident" id="5668372">startTemplate</span><span class="op" id="5668385">)</span><span class="op" id="5668386">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5668397">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668427">if</span>&nbsp;<span class="ident" id="5668430">val</span><span class="op" id="5668433">.</span><span class="ident" id="5668434">CanInterface</span><span class="op" id="5668446">(</span><span class="op" id="5668447">)</span>&nbsp;<span class="op" id="5668449">&amp;&amp;</span>&nbsp;<span class="ident" id="5668452">typ</span><span class="op" id="5668455">.</span><span class="ident" id="5668456">Implements</span><span class="op" id="5668466">(</span><span class="ident" id="5668467">textMarshalerType</span><span class="op" id="5668484">)</span>&nbsp;<span class="op" id="5668486">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668490">return</span>&nbsp;<span class="ident" id="5668497">p</span><span class="op" id="5668498">.</span><span class="ident" id="5668499">marshalTextInterface</span><span class="op" id="5668519">(</span><span class="ident" id="5668520">val</span><span class="op" id="5668523">.</span><span class="ident" id="5668524">Interface</span><span class="op" id="5668533">(</span><span class="op" id="5668534">)</span><span class="op" id="5668535">.</span><span class="op" id="5668536">(</span><span class="ident" id="5668537">encoding</span><span class="op" id="5668545">.</span><span class="ident" id="5668546">TextMarshaler</span><span class="op" id="5668559">)</span><span class="op" id="5668560">,</span>&nbsp;<span class="ident" id="5668562">defaultStart</span><span class="op" id="5668574">(</span><span class="ident" id="5668575">typ</span><span class="op" id="5668578">,</span>&nbsp;<span class="ident" id="5668580">finfo</span><span class="op" id="5668585">,</span>&nbsp;<span class="ident" id="5668587">startTemplate</span><span class="op" id="5668600">)</span><span class="op" id="5668601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668607">if</span>&nbsp;<span class="ident" id="5668610">val</span><span class="op" id="5668613">.</span><span class="ident" id="5668614">CanAddr</span><span class="op" id="5668621">(</span><span class="op" id="5668622">)</span>&nbsp;<span class="op" id="5668624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5668628">pv</span>&nbsp;<span class="op" id="5668631">:=</span>&nbsp;<span class="ident" id="5668634">val</span><span class="op" id="5668637">.</span><span class="ident" id="5668638">Addr</span><span class="op" id="5668642">(</span><span class="op" id="5668643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668647">if</span>&nbsp;<span class="ident" id="5668650">pv</span><span class="op" id="5668652">.</span><span class="ident" id="5668653">CanInterface</span><span class="op" id="5668665">(</span><span class="op" id="5668666">)</span>&nbsp;<span class="op" id="5668668">&amp;&amp;</span>&nbsp;<span class="ident" id="5668671">pv</span><span class="op" id="5668673">.</span><span class="ident" id="5668674">Type</span><span class="op" id="5668678">(</span><span class="op" id="5668679">)</span><span class="op" id="5668680">.</span><span class="ident" id="5668681">Implements</span><span class="op" id="5668691">(</span><span class="ident" id="5668692">textMarshalerType</span><span class="op" id="5668709">)</span>&nbsp;<span class="op" id="5668711">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668716">return</span>&nbsp;<span class="ident" id="5668723">p</span><span class="op" id="5668724">.</span><span class="ident" id="5668725">marshalTextInterface</span><span class="op" id="5668745">(</span><span class="ident" id="5668746">pv</span><span class="op" id="5668748">.</span><span class="ident" id="5668749">Interface</span><span class="op" id="5668758">(</span><span class="op" id="5668759">)</span><span class="op" id="5668760">.</span><span class="op" id="5668761">(</span><span class="ident" id="5668762">encoding</span><span class="op" id="5668770">.</span><span class="ident" id="5668771">TextMarshaler</span><span class="op" id="5668784">)</span><span class="op" id="5668785">,</span>&nbsp;<span class="ident" id="5668787">defaultStart</span><span class="op" id="5668799">(</span><span class="ident" id="5668800">pv</span><span class="op" id="5668802">.</span><span class="ident" id="5668803">Type</span><span class="op" id="5668807">(</span><span class="op" id="5668808">)</span><span class="op" id="5668809">,</span>&nbsp;<span class="ident" id="5668811">finfo</span><span class="op" id="5668816">,</span>&nbsp;<span class="ident" id="5668818">startTemplate</span><span class="op" id="5668831">)</span><span class="op" id="5668832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5668839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5668843">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5668927">if</span>&nbsp;<span class="op" id="5668930">(</span><span class="ident" id="5668931">kind</span>&nbsp;<span class="op" id="5668936">==</span>&nbsp;<span class="ident" id="5668939">reflect</span><span class="op" id="5668946">.</span><span class="ident" id="5668947">Slice</span>&nbsp;<span class="op" id="5668953">||</span>&nbsp;<span class="ident" id="5668956">kind</span>&nbsp;<span class="op" id="5668961">==</span>&nbsp;<span class="ident" id="5668964">reflect</span><span class="op" id="5668971">.</span><span class="ident" id="5668972">Array</span><span class="op" id="5668977">)</span>&nbsp;<span class="op" id="5668979">&amp;&amp;</span>&nbsp;<span class="ident" id="5668982">typ</span><span class="op" id="5668985">.</span><span class="ident" id="5668986">Elem</span><span class="op" id="5668990">(</span><span class="op" id="5668991">)</span><span class="op" id="5668992">.</span><span class="ident" id="5668993">Kind</span><span class="op" id="5668997">(</span><span class="op" id="5668998">)</span>&nbsp;<span class="op" id="5669000">!=</span>&nbsp;<span class="ident" id="5669003">reflect</span><span class="op" id="5669010">.</span><span class="ident" id="5669011">Uint8</span>&nbsp;<span class="op" id="5669017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669021">for</span>&nbsp;<span class="ident" id="5669025">i</span><span class="op" id="5669026">,</span>&nbsp;<span class="ident" id="5669028">n</span>&nbsp;<span class="op" id="5669030">:=</span>&nbsp;<span class="num" id="5669033">0</span><span class="op" id="5669034">,</span>&nbsp;<span class="ident" id="5669036">val</span><span class="op" id="5669039">.</span><span class="ident" id="5669040">Len</span><span class="op" id="5669043">(</span><span class="op" id="5669044">)</span><span class="op" id="5669045">;</span>&nbsp;<span class="ident" id="5669047">i</span>&nbsp;<span class="op" id="5669049">&lt;</span>&nbsp;<span class="ident" id="5669051">n</span><span class="op" id="5669052">;</span>&nbsp;<span class="ident" id="5669054">i</span><span class="op" id="5669055">++</span>&nbsp;<span class="op" id="5669058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669063">if</span>&nbsp;<span class="ident" id="5669066">err</span>&nbsp;<span class="op" id="5669070">:=</span>&nbsp;<span class="ident" id="5669073">p</span><span class="op" id="5669074">.</span><span class="ident" id="5669075">marshalValue</span><span class="op" id="5669087">(</span><span class="ident" id="5669088">val</span><span class="op" id="5669091">.</span><span class="ident" id="5669092">Index</span><span class="op" id="5669097">(</span><span class="ident" id="5669098">i</span><span class="op" id="5669099">)</span><span class="op" id="5669100">,</span>&nbsp;<span class="ident" id="5669102">finfo</span><span class="op" id="5669107">,</span>&nbsp;<span class="ident" id="5669109">startTemplate</span><span class="op" id="5669122">)</span><span class="op" id="5669123">;</span>&nbsp;<span class="ident" id="5669125">err</span>&nbsp;<span class="op" id="5669129">!=</span>&nbsp;<span class="builtintype" id="5669132">nil</span>&nbsp;<span class="op" id="5669136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669142">return</span>&nbsp;<span class="ident" id="5669149">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669156">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669164">return</span>&nbsp;<span class="builtintype" id="5669171">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669180">tinfo</span><span class="op" id="5669185">,</span>&nbsp;<span class="ident" id="5669187">err</span>&nbsp;<span class="op" id="5669191">:=</span>&nbsp;<span class="ident" id="5669194">getTypeInfo</span><span class="op" id="5669205">(</span><span class="ident" id="5669206">typ</span><span class="op" id="5669209">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669212">if</span>&nbsp;<span class="ident" id="5669215">err</span>&nbsp;<span class="op" id="5669219">!=</span>&nbsp;<span class="builtintype" id="5669222">nil</span>&nbsp;<span class="op" id="5669226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669230">return</span>&nbsp;<span class="ident" id="5669237">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669246">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669272">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669316">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669337">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669380">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5669427">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669444">var</span>&nbsp;<span class="ident" id="5669448">start</span>&nbsp;<span class="ident" id="5669454">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669469">if</span>&nbsp;<span class="ident" id="5669472">startTemplate</span>&nbsp;<span class="op" id="5669486">!=</span>&nbsp;<span class="builtintype" id="5669489">nil</span>&nbsp;<span class="op" id="5669493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669497">start</span><span class="op" id="5669502">.</span><span class="ident" id="5669503">Name</span>&nbsp;<span class="op" id="5669508">=</span>&nbsp;<span class="ident" id="5669510">startTemplate</span><span class="op" id="5669523">.</span><span class="ident" id="5669524">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669531">start</span><span class="op" id="5669536">.</span><span class="ident" id="5669537">Attr</span>&nbsp;<span class="op" id="5669542">=</span>&nbsp;<span class="builtinfunc" id="5669544">append</span><span class="op" id="5669550">(</span><span class="ident" id="5669551">start</span><span class="op" id="5669556">.</span><span class="ident" id="5669557">Attr</span><span class="op" id="5669561">,</span>&nbsp;<span class="ident" id="5669563">startTemplate</span><span class="op" id="5669576">.</span><span class="ident" id="5669577">Attr</span><span class="op" id="5669581">...</span><span class="op" id="5669584">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669587">}</span>&nbsp;<span class="keyword" id="5669589">else</span>&nbsp;<span class="keyword" id="5669594">if</span>&nbsp;<span class="ident" id="5669597">tinfo</span><span class="op" id="5669602">.</span><span class="ident" id="5669603">xmlname</span>&nbsp;<span class="op" id="5669611">!=</span>&nbsp;<span class="builtintype" id="5669614">nil</span>&nbsp;<span class="op" id="5669618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669622">xmlname</span>&nbsp;<span class="op" id="5669630">:=</span>&nbsp;<span class="ident" id="5669633">tinfo</span><span class="op" id="5669638">.</span><span class="ident" id="5669639">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669649">if</span>&nbsp;<span class="ident" id="5669652">xmlname</span><span class="op" id="5669659">.</span><span class="ident" id="5669660">name</span>&nbsp;<span class="op" id="5669665">!=</span>&nbsp;<span class="string" id="5669668">&#34;&#34;</span>&nbsp;<span class="op" id="5669671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669676">start</span><span class="op" id="5669681">.</span><span class="ident" id="5669682">Name</span><span class="op" id="5669686">.</span><span class="ident" id="5669687">Space</span><span class="op" id="5669692">,</span>&nbsp;<span class="ident" id="5669694">start</span><span class="op" id="5669699">.</span><span class="ident" id="5669700">Name</span><span class="op" id="5669704">.</span><span class="ident" id="5669705">Local</span>&nbsp;<span class="op" id="5669711">=</span>&nbsp;<span class="ident" id="5669713">xmlname</span><span class="op" id="5669720">.</span><span class="ident" id="5669721">xmlns</span><span class="op" id="5669726">,</span>&nbsp;<span class="ident" id="5669728">xmlname</span><span class="op" id="5669735">.</span><span class="ident" id="5669736">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669743">}</span>&nbsp;<span class="keyword" id="5669745">else</span>&nbsp;<span class="keyword" id="5669750">if</span>&nbsp;<span class="ident" id="5669753">v</span><span class="op" id="5669754">,</span>&nbsp;<span class="ident" id="5669756">ok</span>&nbsp;<span class="op" id="5669759">:=</span>&nbsp;<span class="ident" id="5669762">xmlname</span><span class="op" id="5669769">.</span><span class="ident" id="5669770">value</span><span class="op" id="5669775">(</span><span class="ident" id="5669776">val</span><span class="op" id="5669779">)</span><span class="op" id="5669780">.</span><span class="ident" id="5669781">Interface</span><span class="op" id="5669790">(</span><span class="op" id="5669791">)</span><span class="op" id="5669792">.</span><span class="op" id="5669793">(</span><span class="ident" id="5669794">Name</span><span class="op" id="5669798">)</span><span class="op" id="5669799">;</span>&nbsp;<span class="ident" id="5669801">ok</span>&nbsp;<span class="op" id="5669804">&amp;&amp;</span>&nbsp;<span class="ident" id="5669807">v</span><span class="op" id="5669808">.</span><span class="ident" id="5669809">Local</span>&nbsp;<span class="op" id="5669815">!=</span>&nbsp;<span class="string" id="5669818">&#34;&#34;</span>&nbsp;<span class="op" id="5669821">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669826">start</span><span class="op" id="5669831">.</span><span class="ident" id="5669832">Name</span>&nbsp;<span class="op" id="5669837">=</span>&nbsp;<span class="ident" id="5669839">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669849">if</span>&nbsp;<span class="ident" id="5669852">start</span><span class="op" id="5669857">.</span><span class="ident" id="5669858">Name</span><span class="op" id="5669862">.</span><span class="ident" id="5669863">Local</span>&nbsp;<span class="op" id="5669869">==</span>&nbsp;<span class="string" id="5669872">&#34;&#34;</span>&nbsp;<span class="op" id="5669875">&amp;&amp;</span>&nbsp;<span class="ident" id="5669878">finfo</span>&nbsp;<span class="op" id="5669884">!=</span>&nbsp;<span class="builtintype" id="5669887">nil</span>&nbsp;<span class="op" id="5669891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669895">start</span><span class="op" id="5669900">.</span><span class="ident" id="5669901">Name</span><span class="op" id="5669905">.</span><span class="ident" id="5669906">Space</span><span class="op" id="5669911">,</span>&nbsp;<span class="ident" id="5669913">start</span><span class="op" id="5669918">.</span><span class="ident" id="5669919">Name</span><span class="op" id="5669923">.</span><span class="ident" id="5669924">Local</span>&nbsp;<span class="op" id="5669930">=</span>&nbsp;<span class="ident" id="5669932">finfo</span><span class="op" id="5669937">.</span><span class="ident" id="5669938">xmlns</span><span class="op" id="5669943">,</span>&nbsp;<span class="ident" id="5669945">finfo</span><span class="op" id="5669950">.</span><span class="ident" id="5669951">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5669957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5669960">if</span>&nbsp;<span class="ident" id="5669963">start</span><span class="op" id="5669968">.</span><span class="ident" id="5669969">Name</span><span class="op" id="5669973">.</span><span class="ident" id="5669974">Local</span>&nbsp;<span class="op" id="5669980">==</span>&nbsp;<span class="string" id="5669983">&#34;&#34;</span>&nbsp;<span class="op" id="5669986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5669990">name</span>&nbsp;<span class="op" id="5669995">:=</span>&nbsp;<span class="ident" id="5669998">typ</span><span class="op" id="5670001">.</span><span class="ident" id="5670002">Name</span><span class="op" id="5670006">(</span><span class="op" id="5670007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670011">if</span>&nbsp;<span class="ident" id="5670014">name</span>&nbsp;<span class="op" id="5670019">==</span>&nbsp;<span class="string" id="5670022">&#34;&#34;</span>&nbsp;<span class="op" id="5670025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670030">return</span>&nbsp;<span class="op" id="5670037">&amp;</span><span class="ident" id="5670038">UnsupportedTypeError</span><span class="op" id="5670058">{</span><span class="ident" id="5670059">typ</span><span class="op" id="5670062">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670070">start</span><span class="op" id="5670075">.</span><span class="ident" id="5670076">Name</span><span class="op" id="5670080">.</span><span class="ident" id="5670081">Local</span>&nbsp;<span class="op" id="5670087">=</span>&nbsp;<span class="ident" id="5670089">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5670099">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670114">for</span>&nbsp;<span class="ident" id="5670118">i</span>&nbsp;<span class="op" id="5670120">:=</span>&nbsp;<span class="keyword" id="5670123">range</span>&nbsp;<span class="ident" id="5670129">tinfo</span><span class="op" id="5670134">.</span><span class="ident" id="5670135">fields</span>&nbsp;<span class="op" id="5670142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670146">finfo</span>&nbsp;<span class="op" id="5670152">:=</span>&nbsp;<span class="op" id="5670155">&amp;</span><span class="ident" id="5670156">tinfo</span><span class="op" id="5670161">.</span><span class="ident" id="5670162">fields</span><span class="op" id="5670168">[</span><span class="ident" id="5670169">i</span><span class="op" id="5670170">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670174">if</span>&nbsp;<span class="ident" id="5670177">finfo</span><span class="op" id="5670182">.</span><span class="ident" id="5670183">flags</span><span class="op" id="5670188">&amp;</span><span class="ident" id="5670189">fAttr</span>&nbsp;<span class="op" id="5670195">==</span>&nbsp;<span class="num" id="5670198">0</span>&nbsp;<span class="op" id="5670200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670205">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670216">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670220">fv</span>&nbsp;<span class="op" id="5670223">:=</span>&nbsp;<span class="ident" id="5670226">finfo</span><span class="op" id="5670231">.</span><span class="ident" id="5670232">value</span><span class="op" id="5670237">(</span><span class="ident" id="5670238">val</span><span class="op" id="5670241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670245">name</span>&nbsp;<span class="op" id="5670250">:=</span>&nbsp;<span class="ident" id="5670253">Name</span><span class="op" id="5670257">{</span><span class="ident" id="5670258">Space</span><span class="op" id="5670263">:</span>&nbsp;<span class="ident" id="5670265">finfo</span><span class="op" id="5670270">.</span><span class="ident" id="5670271">xmlns</span><span class="op" id="5670276">,</span>&nbsp;<span class="ident" id="5670278">Local</span><span class="op" id="5670283">:</span>&nbsp;<span class="ident" id="5670285">finfo</span><span class="op" id="5670290">.</span><span class="ident" id="5670291">name</span><span class="op" id="5670295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670300">if</span>&nbsp;<span class="ident" id="5670303">finfo</span><span class="op" id="5670308">.</span><span class="ident" id="5670309">flags</span><span class="op" id="5670314">&amp;</span><span class="ident" id="5670315">fOmitEmpty</span>&nbsp;<span class="op" id="5670326">!=</span>&nbsp;<span class="num" id="5670329">0</span>&nbsp;<span class="op" id="5670331">&amp;&amp;</span>&nbsp;<span class="ident" id="5670334">isEmptyValue</span><span class="op" id="5670346">(</span><span class="ident" id="5670347">fv</span><span class="op" id="5670349">)</span>&nbsp;<span class="op" id="5670351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670356">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670372">if</span>&nbsp;<span class="ident" id="5670375">fv</span><span class="op" id="5670377">.</span><span class="ident" id="5670378">Kind</span><span class="op" id="5670382">(</span><span class="op" id="5670383">)</span>&nbsp;<span class="op" id="5670385">==</span>&nbsp;<span class="ident" id="5670388">reflect</span><span class="op" id="5670395">.</span><span class="ident" id="5670396">Interface</span>&nbsp;<span class="op" id="5670406">&amp;&amp;</span>&nbsp;<span class="ident" id="5670409">fv</span><span class="op" id="5670411">.</span><span class="ident" id="5670412">IsNil</span><span class="op" id="5670417">(</span><span class="op" id="5670418">)</span>&nbsp;<span class="op" id="5670420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670425">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670436">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670441">if</span>&nbsp;<span class="ident" id="5670444">fv</span><span class="op" id="5670446">.</span><span class="ident" id="5670447">CanInterface</span><span class="op" id="5670459">(</span><span class="op" id="5670460">)</span>&nbsp;<span class="op" id="5670462">&amp;&amp;</span>&nbsp;<span class="ident" id="5670465">fv</span><span class="op" id="5670467">.</span><span class="ident" id="5670468">Type</span><span class="op" id="5670472">(</span><span class="op" id="5670473">)</span><span class="op" id="5670474">.</span><span class="ident" id="5670475">Implements</span><span class="op" id="5670485">(</span><span class="ident" id="5670486">marshalerAttrType</span><span class="op" id="5670503">)</span>&nbsp;<span class="op" id="5670505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670510">attr</span><span class="op" id="5670514">,</span>&nbsp;<span class="ident" id="5670516">err</span>&nbsp;<span class="op" id="5670520">:=</span>&nbsp;<span class="ident" id="5670523">fv</span><span class="op" id="5670525">.</span><span class="ident" id="5670526">Interface</span><span class="op" id="5670535">(</span><span class="op" id="5670536">)</span><span class="op" id="5670537">.</span><span class="op" id="5670538">(</span><span class="ident" id="5670539">MarshalerAttr</span><span class="op" id="5670552">)</span><span class="op" id="5670553">.</span><span class="ident" id="5670554">MarshalXMLAttr</span><span class="op" id="5670568">(</span><span class="ident" id="5670569">name</span><span class="op" id="5670573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670578">if</span>&nbsp;<span class="ident" id="5670581">err</span>&nbsp;<span class="op" id="5670585">!=</span>&nbsp;<span class="builtintype" id="5670588">nil</span>&nbsp;<span class="op" id="5670592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670598">return</span>&nbsp;<span class="ident" id="5670605">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670617">if</span>&nbsp;<span class="ident" id="5670620">attr</span><span class="op" id="5670624">.</span><span class="ident" id="5670625">Name</span><span class="op" id="5670629">.</span><span class="ident" id="5670630">Local</span>&nbsp;<span class="op" id="5670636">!=</span>&nbsp;<span class="string" id="5670639">&#34;&#34;</span>&nbsp;<span class="op" id="5670642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670648">start</span><span class="op" id="5670653">.</span><span class="ident" id="5670654">Attr</span>&nbsp;<span class="op" id="5670659">=</span>&nbsp;<span class="builtinfunc" id="5670661">append</span><span class="op" id="5670667">(</span><span class="ident" id="5670668">start</span><span class="op" id="5670673">.</span><span class="ident" id="5670674">Attr</span><span class="op" id="5670678">,</span>&nbsp;<span class="ident" id="5670680">attr</span><span class="op" id="5670684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670694">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670710">if</span>&nbsp;<span class="ident" id="5670713">fv</span><span class="op" id="5670715">.</span><span class="ident" id="5670716">CanAddr</span><span class="op" id="5670723">(</span><span class="op" id="5670724">)</span>&nbsp;<span class="op" id="5670726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670731">pv</span>&nbsp;<span class="op" id="5670734">:=</span>&nbsp;<span class="ident" id="5670737">fv</span><span class="op" id="5670739">.</span><span class="ident" id="5670740">Addr</span><span class="op" id="5670744">(</span><span class="op" id="5670745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670750">if</span>&nbsp;<span class="ident" id="5670753">pv</span><span class="op" id="5670755">.</span><span class="ident" id="5670756">CanInterface</span><span class="op" id="5670768">(</span><span class="op" id="5670769">)</span>&nbsp;<span class="op" id="5670771">&amp;&amp;</span>&nbsp;<span class="ident" id="5670774">pv</span><span class="op" id="5670776">.</span><span class="ident" id="5670777">Type</span><span class="op" id="5670781">(</span><span class="op" id="5670782">)</span><span class="op" id="5670783">.</span><span class="ident" id="5670784">Implements</span><span class="op" id="5670794">(</span><span class="ident" id="5670795">marshalerAttrType</span><span class="op" id="5670812">)</span>&nbsp;<span class="op" id="5670814">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670820">attr</span><span class="op" id="5670824">,</span>&nbsp;<span class="ident" id="5670826">err</span>&nbsp;<span class="op" id="5670830">:=</span>&nbsp;<span class="ident" id="5670833">pv</span><span class="op" id="5670835">.</span><span class="ident" id="5670836">Interface</span><span class="op" id="5670845">(</span><span class="op" id="5670846">)</span><span class="op" id="5670847">.</span><span class="op" id="5670848">(</span><span class="ident" id="5670849">MarshalerAttr</span><span class="op" id="5670862">)</span><span class="op" id="5670863">.</span><span class="ident" id="5670864">MarshalXMLAttr</span><span class="op" id="5670878">(</span><span class="ident" id="5670879">name</span><span class="op" id="5670883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670889">if</span>&nbsp;<span class="ident" id="5670892">err</span>&nbsp;<span class="op" id="5670896">!=</span>&nbsp;<span class="builtintype" id="5670899">nil</span>&nbsp;<span class="op" id="5670903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670910">return</span>&nbsp;<span class="ident" id="5670917">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5670925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5670931">if</span>&nbsp;<span class="ident" id="5670934">attr</span><span class="op" id="5670938">.</span><span class="ident" id="5670939">Name</span><span class="op" id="5670943">.</span><span class="ident" id="5670944">Local</span>&nbsp;<span class="op" id="5670950">!=</span>&nbsp;<span class="string" id="5670953">&#34;&#34;</span>&nbsp;<span class="op" id="5670956">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5670963">start</span><span class="op" id="5670968">.</span><span class="ident" id="5670969">Attr</span>&nbsp;<span class="op" id="5670974">=</span>&nbsp;<span class="builtinfunc" id="5670976">append</span><span class="op" id="5670982">(</span><span class="ident" id="5670983">start</span><span class="op" id="5670988">.</span><span class="ident" id="5670989">Attr</span><span class="op" id="5670993">,</span>&nbsp;<span class="ident" id="5670995">attr</span><span class="op" id="5670999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671011">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671027">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671032">if</span>&nbsp;<span class="ident" id="5671035">fv</span><span class="op" id="5671037">.</span><span class="ident" id="5671038">CanInterface</span><span class="op" id="5671050">(</span><span class="op" id="5671051">)</span>&nbsp;<span class="op" id="5671053">&amp;&amp;</span>&nbsp;<span class="ident" id="5671056">fv</span><span class="op" id="5671058">.</span><span class="ident" id="5671059">Type</span><span class="op" id="5671063">(</span><span class="op" id="5671064">)</span><span class="op" id="5671065">.</span><span class="ident" id="5671066">Implements</span><span class="op" id="5671076">(</span><span class="ident" id="5671077">textMarshalerType</span><span class="op" id="5671094">)</span>&nbsp;<span class="op" id="5671096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671101">text</span><span class="op" id="5671105">,</span>&nbsp;<span class="ident" id="5671107">err</span>&nbsp;<span class="op" id="5671111">:=</span>&nbsp;<span class="ident" id="5671114">fv</span><span class="op" id="5671116">.</span><span class="ident" id="5671117">Interface</span><span class="op" id="5671126">(</span><span class="op" id="5671127">)</span><span class="op" id="5671128">.</span><span class="op" id="5671129">(</span><span class="ident" id="5671130">encoding</span><span class="op" id="5671138">.</span><span class="ident" id="5671139">TextMarshaler</span><span class="op" id="5671152">)</span><span class="op" id="5671153">.</span><span class="ident" id="5671154">MarshalText</span><span class="op" id="5671165">(</span><span class="op" id="5671166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671171">if</span>&nbsp;<span class="ident" id="5671174">err</span>&nbsp;<span class="op" id="5671178">!=</span>&nbsp;<span class="builtintype" id="5671181">nil</span>&nbsp;<span class="op" id="5671185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671191">return</span>&nbsp;<span class="ident" id="5671198">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671210">start</span><span class="op" id="5671215">.</span><span class="ident" id="5671216">Attr</span>&nbsp;<span class="op" id="5671221">=</span>&nbsp;<span class="builtinfunc" id="5671223">append</span><span class="op" id="5671229">(</span><span class="ident" id="5671230">start</span><span class="op" id="5671235">.</span><span class="ident" id="5671236">Attr</span><span class="op" id="5671240">,</span>&nbsp;<span class="ident" id="5671242">Attr</span><span class="op" id="5671246">{</span><span class="ident" id="5671247">name</span><span class="op" id="5671251">,</span>&nbsp;<span class="builtintype" id="5671253">string</span><span class="op" id="5671259">(</span><span class="ident" id="5671260">text</span><span class="op" id="5671264">)</span><span class="op" id="5671265">}</span><span class="op" id="5671266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671271">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671287">if</span>&nbsp;<span class="ident" id="5671290">fv</span><span class="op" id="5671292">.</span><span class="ident" id="5671293">CanAddr</span><span class="op" id="5671300">(</span><span class="op" id="5671301">)</span>&nbsp;<span class="op" id="5671303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671308">pv</span>&nbsp;<span class="op" id="5671311">:=</span>&nbsp;<span class="ident" id="5671314">fv</span><span class="op" id="5671316">.</span><span class="ident" id="5671317">Addr</span><span class="op" id="5671321">(</span><span class="op" id="5671322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671327">if</span>&nbsp;<span class="ident" id="5671330">pv</span><span class="op" id="5671332">.</span><span class="ident" id="5671333">CanInterface</span><span class="op" id="5671345">(</span><span class="op" id="5671346">)</span>&nbsp;<span class="op" id="5671348">&amp;&amp;</span>&nbsp;<span class="ident" id="5671351">pv</span><span class="op" id="5671353">.</span><span class="ident" id="5671354">Type</span><span class="op" id="5671358">(</span><span class="op" id="5671359">)</span><span class="op" id="5671360">.</span><span class="ident" id="5671361">Implements</span><span class="op" id="5671371">(</span><span class="ident" id="5671372">textMarshalerType</span><span class="op" id="5671389">)</span>&nbsp;<span class="op" id="5671391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671397">text</span><span class="op" id="5671401">,</span>&nbsp;<span class="ident" id="5671403">err</span>&nbsp;<span class="op" id="5671407">:=</span>&nbsp;<span class="ident" id="5671410">pv</span><span class="op" id="5671412">.</span><span class="ident" id="5671413">Interface</span><span class="op" id="5671422">(</span><span class="op" id="5671423">)</span><span class="op" id="5671424">.</span><span class="op" id="5671425">(</span><span class="ident" id="5671426">encoding</span><span class="op" id="5671434">.</span><span class="ident" id="5671435">TextMarshaler</span><span class="op" id="5671448">)</span><span class="op" id="5671449">.</span><span class="ident" id="5671450">MarshalText</span><span class="op" id="5671461">(</span><span class="op" id="5671462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671468">if</span>&nbsp;<span class="ident" id="5671471">err</span>&nbsp;<span class="op" id="5671475">!=</span>&nbsp;<span class="builtintype" id="5671478">nil</span>&nbsp;<span class="op" id="5671482">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671489">return</span>&nbsp;<span class="ident" id="5671496">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671510">start</span><span class="op" id="5671515">.</span><span class="ident" id="5671516">Attr</span>&nbsp;<span class="op" id="5671521">=</span>&nbsp;<span class="builtinfunc" id="5671523">append</span><span class="op" id="5671529">(</span><span class="ident" id="5671530">start</span><span class="op" id="5671535">.</span><span class="ident" id="5671536">Attr</span><span class="op" id="5671540">,</span>&nbsp;<span class="ident" id="5671542">Attr</span><span class="op" id="5671546">{</span><span class="ident" id="5671547">name</span><span class="op" id="5671551">,</span>&nbsp;<span class="builtintype" id="5671553">string</span><span class="op" id="5671559">(</span><span class="ident" id="5671560">text</span><span class="op" id="5671564">)</span><span class="op" id="5671565">}</span><span class="op" id="5671566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671572">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671584">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5671593">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671649">switch</span>&nbsp;<span class="ident" id="5671656">fv</span><span class="op" id="5671658">.</span><span class="ident" id="5671659">Kind</span><span class="op" id="5671663">(</span><span class="op" id="5671664">)</span>&nbsp;<span class="op" id="5671666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671670">case</span>&nbsp;<span class="ident" id="5671675">reflect</span><span class="op" id="5671682">.</span><span class="ident" id="5671683">Ptr</span><span class="op" id="5671686">,</span>&nbsp;<span class="ident" id="5671688">reflect</span><span class="op" id="5671695">.</span><span class="ident" id="5671696">Interface</span><span class="op" id="5671705">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671710">if</span>&nbsp;<span class="ident" id="5671713">fv</span><span class="op" id="5671715">.</span><span class="ident" id="5671716">IsNil</span><span class="op" id="5671721">(</span><span class="op" id="5671722">)</span>&nbsp;<span class="op" id="5671724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671730">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671747">fv</span>&nbsp;<span class="op" id="5671750">=</span>&nbsp;<span class="ident" id="5671752">fv</span><span class="op" id="5671754">.</span><span class="ident" id="5671755">Elem</span><span class="op" id="5671759">(</span><span class="op" id="5671760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671764">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671769">s</span><span class="op" id="5671770">,</span>&nbsp;<span class="ident" id="5671772">b</span><span class="op" id="5671773">,</span>&nbsp;<span class="ident" id="5671775">err</span>&nbsp;<span class="op" id="5671779">:=</span>&nbsp;<span class="ident" id="5671782">p</span><span class="op" id="5671783">.</span><span class="ident" id="5671784">marshalSimple</span><span class="op" id="5671797">(</span><span class="ident" id="5671798">fv</span><span class="op" id="5671800">.</span><span class="ident" id="5671801">Type</span><span class="op" id="5671805">(</span><span class="op" id="5671806">)</span><span class="op" id="5671807">,</span>&nbsp;<span class="ident" id="5671809">fv</span><span class="op" id="5671811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671815">if</span>&nbsp;<span class="ident" id="5671818">err</span>&nbsp;<span class="op" id="5671822">!=</span>&nbsp;<span class="builtintype" id="5671825">nil</span>&nbsp;<span class="op" id="5671829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671834">return</span>&nbsp;<span class="ident" id="5671841">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671847">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671851">if</span>&nbsp;<span class="ident" id="5671854">b</span>&nbsp;<span class="op" id="5671856">!=</span>&nbsp;<span class="builtintype" id="5671859">nil</span>&nbsp;<span class="op" id="5671863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671868">s</span>&nbsp;<span class="op" id="5671870">=</span>&nbsp;<span class="builtintype" id="5671872">string</span><span class="op" id="5671878">(</span><span class="ident" id="5671879">b</span><span class="op" id="5671880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5671888">start</span><span class="op" id="5671893">.</span><span class="ident" id="5671894">Attr</span>&nbsp;<span class="op" id="5671899">=</span>&nbsp;<span class="builtinfunc" id="5671901">append</span><span class="op" id="5671907">(</span><span class="ident" id="5671908">start</span><span class="op" id="5671913">.</span><span class="ident" id="5671914">Attr</span><span class="op" id="5671918">,</span>&nbsp;<span class="ident" id="5671920">Attr</span><span class="op" id="5671924">{</span><span class="ident" id="5671925">name</span><span class="op" id="5671929">,</span>&nbsp;<span class="ident" id="5671931">s</span><span class="op" id="5671932">}</span><span class="op" id="5671933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671936">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671940">if</span>&nbsp;<span class="ident" id="5671943">err</span>&nbsp;<span class="op" id="5671947">:=</span>&nbsp;<span class="ident" id="5671950">p</span><span class="op" id="5671951">.</span><span class="ident" id="5671952">writeStart</span><span class="op" id="5671962">(</span><span class="op" id="5671963">&amp;</span><span class="ident" id="5671964">start</span><span class="op" id="5671969">)</span><span class="op" id="5671970">;</span>&nbsp;<span class="ident" id="5671972">err</span>&nbsp;<span class="op" id="5671976">!=</span>&nbsp;<span class="builtintype" id="5671979">nil</span>&nbsp;<span class="op" id="5671983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5671987">return</span>&nbsp;<span class="ident" id="5671994">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5671999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672003">if</span>&nbsp;<span class="ident" id="5672006">val</span><span class="op" id="5672009">.</span><span class="ident" id="5672010">Kind</span><span class="op" id="5672014">(</span><span class="op" id="5672015">)</span>&nbsp;<span class="op" id="5672017">==</span>&nbsp;<span class="ident" id="5672020">reflect</span><span class="op" id="5672027">.</span><span class="ident" id="5672028">Struct</span>&nbsp;<span class="op" id="5672035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672039">err</span>&nbsp;<span class="op" id="5672043">=</span>&nbsp;<span class="ident" id="5672045">p</span><span class="op" id="5672046">.</span><span class="ident" id="5672047">marshalStruct</span><span class="op" id="5672060">(</span><span class="ident" id="5672061">tinfo</span><span class="op" id="5672066">,</span>&nbsp;<span class="ident" id="5672068">val</span><span class="op" id="5672071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672074">}</span>&nbsp;<span class="keyword" id="5672076">else</span>&nbsp;<span class="op" id="5672081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672085">s</span><span class="op" id="5672086">,</span>&nbsp;<span class="ident" id="5672088">b</span><span class="op" id="5672089">,</span>&nbsp;<span class="ident" id="5672091">err1</span>&nbsp;<span class="op" id="5672096">:=</span>&nbsp;<span class="ident" id="5672099">p</span><span class="op" id="5672100">.</span><span class="ident" id="5672101">marshalSimple</span><span class="op" id="5672114">(</span><span class="ident" id="5672115">typ</span><span class="op" id="5672118">,</span>&nbsp;<span class="ident" id="5672120">val</span><span class="op" id="5672123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672127">if</span>&nbsp;<span class="ident" id="5672130">err1</span>&nbsp;<span class="op" id="5672135">!=</span>&nbsp;<span class="builtintype" id="5672138">nil</span>&nbsp;<span class="op" id="5672142">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672147">err</span>&nbsp;<span class="op" id="5672151">=</span>&nbsp;<span class="ident" id="5672153">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672160">}</span>&nbsp;<span class="keyword" id="5672162">else</span>&nbsp;<span class="keyword" id="5672167">if</span>&nbsp;<span class="ident" id="5672170">b</span>&nbsp;<span class="op" id="5672172">!=</span>&nbsp;<span class="builtintype" id="5672175">nil</span>&nbsp;<span class="op" id="5672179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672184">EscapeText</span><span class="op" id="5672194">(</span><span class="ident" id="5672195">p</span><span class="op" id="5672196">,</span>&nbsp;<span class="ident" id="5672198">b</span><span class="op" id="5672199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672203">}</span>&nbsp;<span class="keyword" id="5672205">else</span>&nbsp;<span class="op" id="5672210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672215">p</span><span class="op" id="5672216">.</span><span class="ident" id="5672217">EscapeString</span><span class="op" id="5672229">(</span><span class="ident" id="5672230">s</span><span class="op" id="5672231">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672241">if</span>&nbsp;<span class="ident" id="5672244">err</span>&nbsp;<span class="op" id="5672248">!=</span>&nbsp;<span class="builtintype" id="5672251">nil</span>&nbsp;<span class="op" id="5672255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672259">return</span>&nbsp;<span class="ident" id="5672266">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672271">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672275">if</span>&nbsp;<span class="ident" id="5672278">err</span>&nbsp;<span class="op" id="5672282">:=</span>&nbsp;<span class="ident" id="5672285">p</span><span class="op" id="5672286">.</span><span class="ident" id="5672287">writeEnd</span><span class="op" id="5672295">(</span><span class="ident" id="5672296">start</span><span class="op" id="5672301">.</span><span class="ident" id="5672302">Name</span><span class="op" id="5672306">)</span><span class="op" id="5672307">;</span>&nbsp;<span class="ident" id="5672309">err</span>&nbsp;<span class="op" id="5672313">!=</span>&nbsp;<span class="builtintype" id="5672316">nil</span>&nbsp;<span class="op" id="5672320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672324">return</span>&nbsp;<span class="ident" id="5672331">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672340">return</span>&nbsp;<span class="ident" id="5672347">p</span><span class="op" id="5672348">.</span><span class="ident" id="5672349">cachedWriteError</span><span class="op" id="5672365">(</span><span class="op" id="5672366">)</span><br>
<span class="lineno"></span><span class="op" id="5672368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5672371">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="5672429">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="5672488">func</span>&nbsp;<span class="ident" id="5672493">defaultStart</span><span class="op" id="5672505">(</span><span class="ident" id="5672506">typ</span>&nbsp;<span class="ident" id="5672510">reflect</span><span class="op" id="5672517">.</span><span class="ident" id="5672518">Type</span><span class="op" id="5672522">,</span>&nbsp;<span class="ident" id="5672524">finfo</span>&nbsp;<span class="op" id="5672530">*</span><span class="ident" id="5672531">fieldInfo</span><span class="op" id="5672540">,</span>&nbsp;<span class="ident" id="5672542">startTemplate</span>&nbsp;<span class="op" id="5672556">*</span><span class="ident" id="5672557">StartElement</span><span class="op" id="5672569">)</span>&nbsp;<span class="ident" id="5672571">StartElement</span>&nbsp;<span class="op" id="5672584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672587">var</span>&nbsp;<span class="ident" id="5672591">start</span>&nbsp;<span class="ident" id="5672597">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5672611">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5672664">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5672731">if</span>&nbsp;<span class="ident" id="5672734">startTemplate</span>&nbsp;<span class="op" id="5672748">!=</span>&nbsp;<span class="builtintype" id="5672751">nil</span>&nbsp;<span class="op" id="5672755">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672759">start</span><span class="op" id="5672764">.</span><span class="ident" id="5672765">Name</span>&nbsp;<span class="op" id="5672770">=</span>&nbsp;<span class="ident" id="5672772">startTemplate</span><span class="op" id="5672785">.</span><span class="ident" id="5672786">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672793">start</span><span class="op" id="5672798">.</span><span class="ident" id="5672799">Attr</span>&nbsp;<span class="op" id="5672804">=</span>&nbsp;<span class="builtinfunc" id="5672806">append</span><span class="op" id="5672812">(</span><span class="ident" id="5672813">start</span><span class="op" id="5672818">.</span><span class="ident" id="5672819">Attr</span><span class="op" id="5672823">,</span>&nbsp;<span class="ident" id="5672825">startTemplate</span><span class="op" id="5672838">.</span><span class="ident" id="5672839">Attr</span><span class="op" id="5672843">...</span><span class="op" id="5672846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672849">}</span>&nbsp;<span class="keyword" id="5672851">else</span>&nbsp;<span class="keyword" id="5672856">if</span>&nbsp;<span class="ident" id="5672859">finfo</span>&nbsp;<span class="op" id="5672865">!=</span>&nbsp;<span class="builtintype" id="5672868">nil</span>&nbsp;<span class="op" id="5672872">&amp;&amp;</span>&nbsp;<span class="ident" id="5672875">finfo</span><span class="op" id="5672880">.</span><span class="ident" id="5672881">name</span>&nbsp;<span class="op" id="5672886">!=</span>&nbsp;<span class="string" id="5672889">&#34;&#34;</span>&nbsp;<span class="op" id="5672892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672896">start</span><span class="op" id="5672901">.</span><span class="ident" id="5672902">Name</span><span class="op" id="5672906">.</span><span class="ident" id="5672907">Local</span>&nbsp;<span class="op" id="5672913">=</span>&nbsp;<span class="ident" id="5672915">finfo</span><span class="op" id="5672920">.</span><span class="ident" id="5672921">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672928">start</span><span class="op" id="5672933">.</span><span class="ident" id="5672934">Name</span><span class="op" id="5672938">.</span><span class="ident" id="5672939">Space</span>&nbsp;<span class="op" id="5672945">=</span>&nbsp;<span class="ident" id="5672947">finfo</span><span class="op" id="5672952">.</span><span class="ident" id="5672953">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5672960">}</span>&nbsp;<span class="keyword" id="5672962">else</span>&nbsp;<span class="keyword" id="5672967">if</span>&nbsp;<span class="ident" id="5672970">typ</span><span class="op" id="5672973">.</span><span class="ident" id="5672974">Name</span><span class="op" id="5672978">(</span><span class="op" id="5672979">)</span>&nbsp;<span class="op" id="5672981">!=</span>&nbsp;<span class="string" id="5672984">&#34;&#34;</span>&nbsp;<span class="op" id="5672987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5672991">start</span><span class="op" id="5672996">.</span><span class="ident" id="5672997">Name</span><span class="op" id="5673001">.</span><span class="ident" id="5673002">Local</span>&nbsp;<span class="op" id="5673008">=</span>&nbsp;<span class="ident" id="5673010">typ</span><span class="op" id="5673013">.</span><span class="ident" id="5673014">Name</span><span class="op" id="5673018">(</span><span class="op" id="5673019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5673022">}</span>&nbsp;<span class="keyword" id="5673024">else</span>&nbsp;<span class="op" id="5673029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5673033">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5673073">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5673114">start</span><span class="op" id="5673119">.</span><span class="ident" id="5673120">Name</span><span class="op" id="5673124">.</span><span class="ident" id="5673125">Local</span>&nbsp;<span class="op" id="5673131">=</span>&nbsp;<span class="ident" id="5673133">typ</span><span class="op" id="5673136">.</span><span class="ident" id="5673137">Elem</span><span class="op" id="5673141">(</span><span class="op" id="5673142">)</span><span class="op" id="5673143">.</span><span class="ident" id="5673144">Name</span><span class="op" id="5673148">(</span><span class="op" id="5673149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5673152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673155">return</span>&nbsp;<span class="ident" id="5673162">start</span><br>
<span class="lineno"></span><span class="op" id="5673168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="5673171">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5673229">func</span>&nbsp;<span class="op" id="5673234">(</span><span class="ident" id="5673235">p</span>&nbsp;<span class="op" id="5673237">*</span><span class="ident" id="5673238">printer</span><span class="op" id="5673245">)</span>&nbsp;<span class="ident" id="5673247">marshalInterface</span><span class="op" id="5673263">(</span><span class="ident" id="5673264">val</span>&nbsp;<span class="ident" id="5673268">Marshaler</span><span class="op" id="5673277">,</span>&nbsp;<span class="ident" id="5673279">start</span>&nbsp;<span class="ident" id="5673285">StartElement</span><span class="op" id="5673297">)</span>&nbsp;<span class="builtintype" id="5673299">error</span>&nbsp;<span class="op" id="5673305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5673308">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5673364">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5673416">p</span><span class="op" id="5673417">.</span><span class="ident" id="5673418">tags</span>&nbsp;<span class="op" id="5673423">=</span>&nbsp;<span class="builtinfunc" id="5673425">append</span><span class="op" id="5673431">(</span><span class="ident" id="5673432">p</span><span class="op" id="5673433">.</span><span class="ident" id="5673434">tags</span><span class="op" id="5673438">,</span>&nbsp;<span class="ident" id="5673440">Name</span><span class="op" id="5673444">{</span><span class="op" id="5673445">}</span><span class="op" id="5673446">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5673449">n</span>&nbsp;<span class="op" id="5673451">:=</span>&nbsp;<span class="builtinfunc" id="5673454">len</span><span class="op" id="5673457">(</span><span class="ident" id="5673458">p</span><span class="op" id="5673459">.</span><span class="ident" id="5673460">tags</span><span class="op" id="5673464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5673468">err</span>&nbsp;<span class="op" id="5673472">:=</span>&nbsp;<span class="ident" id="5673475">val</span><span class="op" id="5673478">.</span><span class="ident" id="5673479">MarshalXML</span><span class="op" id="5673489">(</span><span class="ident" id="5673490">p</span><span class="op" id="5673491">.</span><span class="ident" id="5673492">encoder</span><span class="op" id="5673499">,</span>&nbsp;<span class="ident" id="5673501">start</span><span class="op" id="5673506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673509">if</span>&nbsp;<span class="ident" id="5673512">err</span>&nbsp;<span class="op" id="5673516">!=</span>&nbsp;<span class="builtintype" id="5673519">nil</span>&nbsp;<span class="op" id="5673523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673527">return</span>&nbsp;<span class="ident" id="5673534">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5673539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5673543">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673614">if</span>&nbsp;<span class="builtinfunc" id="5673617">len</span><span class="op" id="5673620">(</span><span class="ident" id="5673621">p</span><span class="op" id="5673622">.</span><span class="ident" id="5673623">tags</span><span class="op" id="5673627">)</span>&nbsp;<span class="op" id="5673629">&gt;</span>&nbsp;<span class="ident" id="5673631">n</span>&nbsp;<span class="op" id="5673633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673637">return</span>&nbsp;<span class="ident" id="5673644">fmt</span><span class="op" id="5673647">.</span><span class="ident" id="5673648">Errorf</span><span class="op" id="5673654">(</span><span class="string" id="5673655">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="5673710">,</span>&nbsp;<span class="ident" id="5673712">receiverType</span><span class="op" id="5673724">(</span><span class="ident" id="5673725">val</span><span class="op" id="5673728">)</span><span class="op" id="5673729">,</span>&nbsp;<span class="ident" id="5673731">p</span><span class="op" id="5673732">.</span><span class="ident" id="5673733">tags</span><span class="op" id="5673737">[</span><span class="builtinfunc" id="5673738">len</span><span class="op" id="5673741">(</span><span class="ident" id="5673742">p</span><span class="op" id="5673743">.</span><span class="ident" id="5673744">tags</span><span class="op" id="5673748">)</span><span class="op" id="5673749">-</span><span class="num" id="5673750">1</span><span class="op" id="5673751">]</span><span class="op" id="5673752">.</span><span class="ident" id="5673753">Local</span><span class="op" id="5673758">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5673761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5673764">p</span><span class="op" id="5673765">.</span><span class="ident" id="5673766">tags</span>&nbsp;<span class="op" id="5673771">=</span>&nbsp;<span class="ident" id="5673773">p</span><span class="op" id="5673774">.</span><span class="ident" id="5673775">tags</span><span class="op" id="5673779">[</span><span class="op" id="5673780">:</span><span class="ident" id="5673781">n</span><span class="op" id="5673782">-</span><span class="num" id="5673783">1</span><span class="op" id="5673784">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673787">return</span>&nbsp;<span class="builtintype" id="5673794">nil</span><br>
<span class="lineno"></span><span class="op" id="5673798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5673801">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5673867">func</span>&nbsp;<span class="op" id="5673872">(</span><span class="ident" id="5673873">p</span>&nbsp;<span class="op" id="5673875">*</span><span class="ident" id="5673876">printer</span><span class="op" id="5673883">)</span>&nbsp;<span class="ident" id="5673885">marshalTextInterface</span><span class="op" id="5673905">(</span><span class="ident" id="5673906">val</span>&nbsp;<span class="ident" id="5673910">encoding</span><span class="op" id="5673918">.</span><span class="ident" id="5673919">TextMarshaler</span><span class="op" id="5673932">,</span>&nbsp;<span class="ident" id="5673934">start</span>&nbsp;<span class="ident" id="5673940">StartElement</span><span class="op" id="5673952">)</span>&nbsp;<span class="builtintype" id="5673954">error</span>&nbsp;<span class="op" id="5673960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5673963">if</span>&nbsp;<span class="ident" id="5673966">err</span>&nbsp;<span class="op" id="5673970">:=</span>&nbsp;<span class="ident" id="5673973">p</span><span class="op" id="5673974">.</span><span class="ident" id="5673975">writeStart</span><span class="op" id="5673985">(</span><span class="op" id="5673986">&amp;</span><span class="ident" id="5673987">start</span><span class="op" id="5673992">)</span><span class="op" id="5673993">;</span>&nbsp;<span class="ident" id="5673995">err</span>&nbsp;<span class="op" id="5673999">!=</span>&nbsp;<span class="builtintype" id="5674002">nil</span>&nbsp;<span class="op" id="5674006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674010">return</span>&nbsp;<span class="ident" id="5674017">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674022">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674025">text</span><span class="op" id="5674029">,</span>&nbsp;<span class="ident" id="5674031">err</span>&nbsp;<span class="op" id="5674035">:=</span>&nbsp;<span class="ident" id="5674038">val</span><span class="op" id="5674041">.</span><span class="ident" id="5674042">MarshalText</span><span class="op" id="5674053">(</span><span class="op" id="5674054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674057">if</span>&nbsp;<span class="ident" id="5674060">err</span>&nbsp;<span class="op" id="5674064">!=</span>&nbsp;<span class="builtintype" id="5674067">nil</span>&nbsp;<span class="op" id="5674071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674075">return</span>&nbsp;<span class="ident" id="5674082">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674090">EscapeText</span><span class="op" id="5674100">(</span><span class="ident" id="5674101">p</span><span class="op" id="5674102">,</span>&nbsp;<span class="ident" id="5674104">text</span><span class="op" id="5674108">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674111">return</span>&nbsp;<span class="ident" id="5674118">p</span><span class="op" id="5674119">.</span><span class="ident" id="5674120">writeEnd</span><span class="op" id="5674128">(</span><span class="ident" id="5674129">start</span><span class="op" id="5674134">.</span><span class="ident" id="5674135">Name</span><span class="op" id="5674139">)</span><br>
<span class="lineno"></span><span class="op" id="5674141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5674144">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="5674190">func</span>&nbsp;<span class="op" id="5674195">(</span><span class="ident" id="5674196">p</span>&nbsp;<span class="op" id="5674198">*</span><span class="ident" id="5674199">printer</span><span class="op" id="5674206">)</span>&nbsp;<span class="ident" id="5674208">writeStart</span><span class="op" id="5674218">(</span><span class="ident" id="5674219">start</span>&nbsp;<span class="op" id="5674225">*</span><span class="ident" id="5674226">StartElement</span><span class="op" id="5674238">)</span>&nbsp;<span class="builtintype" id="5674240">error</span>&nbsp;<span class="op" id="5674246">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674249">if</span>&nbsp;<span class="ident" id="5674252">start</span><span class="op" id="5674257">.</span><span class="ident" id="5674258">Name</span><span class="op" id="5674262">.</span><span class="ident" id="5674263">Local</span>&nbsp;<span class="op" id="5674269">==</span>&nbsp;<span class="string" id="5674272">&#34;&#34;</span>&nbsp;<span class="op" id="5674275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674279">return</span>&nbsp;<span class="ident" id="5674286">fmt</span><span class="op" id="5674289">.</span><span class="ident" id="5674290">Errorf</span><span class="op" id="5674296">(</span><span class="string" id="5674297">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="5674326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674333">p</span><span class="op" id="5674334">.</span><span class="ident" id="5674335">tags</span>&nbsp;<span class="op" id="5674340">=</span>&nbsp;<span class="builtinfunc" id="5674342">append</span><span class="op" id="5674348">(</span><span class="ident" id="5674349">p</span><span class="op" id="5674350">.</span><span class="ident" id="5674351">tags</span><span class="op" id="5674355">,</span>&nbsp;<span class="ident" id="5674357">start</span><span class="op" id="5674362">.</span><span class="ident" id="5674363">Name</span><span class="op" id="5674367">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674370">p</span><span class="op" id="5674371">.</span><span class="ident" id="5674372">markPrefix</span><span class="op" id="5674382">(</span><span class="op" id="5674383">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674387">p</span><span class="op" id="5674388">.</span><span class="ident" id="5674389">writeIndent</span><span class="op" id="5674400">(</span><span class="num" id="5674401">1</span><span class="op" id="5674402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674405">p</span><span class="op" id="5674406">.</span><span class="ident" id="5674407">WriteByte</span><span class="op" id="5674416">(</span><span class="string" id="5674417">&#39;&lt;&#39;</span><span class="op" id="5674420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674423">p</span><span class="op" id="5674424">.</span><span class="ident" id="5674425">WriteString</span><span class="op" id="5674436">(</span><span class="ident" id="5674437">start</span><span class="op" id="5674442">.</span><span class="ident" id="5674443">Name</span><span class="op" id="5674447">.</span><span class="ident" id="5674448">Local</span><span class="op" id="5674453">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674457">if</span>&nbsp;<span class="ident" id="5674460">start</span><span class="op" id="5674465">.</span><span class="ident" id="5674466">Name</span><span class="op" id="5674470">.</span><span class="ident" id="5674471">Space</span>&nbsp;<span class="op" id="5674477">!=</span>&nbsp;<span class="string" id="5674480">&#34;&#34;</span>&nbsp;<span class="op" id="5674483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674487">p</span><span class="op" id="5674488">.</span><span class="ident" id="5674489">WriteString</span><span class="op" id="5674500">(</span><span class="string" id="5674501">`&nbsp;xmlns=&#34;`</span><span class="op" id="5674511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674515">p</span><span class="op" id="5674516">.</span><span class="ident" id="5674517">EscapeString</span><span class="op" id="5674529">(</span><span class="ident" id="5674530">start</span><span class="op" id="5674535">.</span><span class="ident" id="5674536">Name</span><span class="op" id="5674540">.</span><span class="ident" id="5674541">Space</span><span class="op" id="5674546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674550">p</span><span class="op" id="5674551">.</span><span class="ident" id="5674552">WriteByte</span><span class="op" id="5674561">(</span><span class="string" id="5674562">&#39;&#34;&#39;</span><span class="op" id="5674565">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5674572">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674587">for</span>&nbsp;<span class="ident" id="5674591">_</span><span class="op" id="5674592">,</span>&nbsp;<span class="ident" id="5674594">attr</span>&nbsp;<span class="op" id="5674599">:=</span>&nbsp;<span class="keyword" id="5674602">range</span>&nbsp;<span class="ident" id="5674608">start</span><span class="op" id="5674613">.</span><span class="ident" id="5674614">Attr</span>&nbsp;<span class="op" id="5674619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674623">name</span>&nbsp;<span class="op" id="5674628">:=</span>&nbsp;<span class="ident" id="5674631">attr</span><span class="op" id="5674635">.</span><span class="ident" id="5674636">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674643">if</span>&nbsp;<span class="ident" id="5674646">name</span><span class="op" id="5674650">.</span><span class="ident" id="5674651">Local</span>&nbsp;<span class="op" id="5674657">==</span>&nbsp;<span class="string" id="5674660">&#34;&#34;</span>&nbsp;<span class="op" id="5674663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674668">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674683">p</span><span class="op" id="5674684">.</span><span class="ident" id="5674685">WriteByte</span><span class="op" id="5674694">(</span><span class="string" id="5674695">&#39;&nbsp;&#39;</span><span class="op" id="5674698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674702">if</span>&nbsp;<span class="ident" id="5674705">name</span><span class="op" id="5674709">.</span><span class="ident" id="5674710">Space</span>&nbsp;<span class="op" id="5674716">!=</span>&nbsp;<span class="string" id="5674719">&#34;&#34;</span>&nbsp;<span class="op" id="5674722">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674727">p</span><span class="op" id="5674728">.</span><span class="ident" id="5674729">WriteString</span><span class="op" id="5674740">(</span><span class="ident" id="5674741">p</span><span class="op" id="5674742">.</span><span class="ident" id="5674743">createAttrPrefix</span><span class="op" id="5674759">(</span><span class="ident" id="5674760">name</span><span class="op" id="5674764">.</span><span class="ident" id="5674765">Space</span><span class="op" id="5674770">)</span><span class="op" id="5674771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674776">p</span><span class="op" id="5674777">.</span><span class="ident" id="5674778">WriteByte</span><span class="op" id="5674787">(</span><span class="string" id="5674788">&#39;:&#39;</span><span class="op" id="5674791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674799">p</span><span class="op" id="5674800">.</span><span class="ident" id="5674801">WriteString</span><span class="op" id="5674812">(</span><span class="ident" id="5674813">name</span><span class="op" id="5674817">.</span><span class="ident" id="5674818">Local</span><span class="op" id="5674823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674827">p</span><span class="op" id="5674828">.</span><span class="ident" id="5674829">WriteString</span><span class="op" id="5674840">(</span><span class="string" id="5674841">`=&#34;`</span><span class="op" id="5674845">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674849">p</span><span class="op" id="5674850">.</span><span class="ident" id="5674851">EscapeString</span><span class="op" id="5674863">(</span><span class="ident" id="5674864">attr</span><span class="op" id="5674868">.</span><span class="ident" id="5674869">Value</span><span class="op" id="5674874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674878">p</span><span class="op" id="5674879">.</span><span class="ident" id="5674880">WriteByte</span><span class="op" id="5674889">(</span><span class="string" id="5674890">&#39;&#34;&#39;</span><span class="op" id="5674893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5674896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5674899">p</span><span class="op" id="5674900">.</span><span class="ident" id="5674901">WriteByte</span><span class="op" id="5674910">(</span><span class="string" id="5674911">&#39;&gt;&#39;</span><span class="op" id="5674914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674917">return</span>&nbsp;<span class="builtintype" id="5674924">nil</span><br>
<span class="lineno">645</span><span class="op" id="5674928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5674931">func</span>&nbsp;<span class="op" id="5674936">(</span><span class="ident" id="5674937">p</span>&nbsp;<span class="op" id="5674939">*</span><span class="ident" id="5674940">printer</span><span class="op" id="5674947">)</span>&nbsp;<span class="ident" id="5674949">writeEnd</span><span class="op" id="5674957">(</span><span class="ident" id="5674958">name</span>&nbsp;<span class="ident" id="5674963">Name</span><span class="op" id="5674967">)</span>&nbsp;<span class="builtintype" id="5674969">error</span>&nbsp;<span class="op" id="5674975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5674978">if</span>&nbsp;<span class="ident" id="5674981">name</span><span class="op" id="5674985">.</span><span class="ident" id="5674986">Local</span>&nbsp;<span class="op" id="5674992">==</span>&nbsp;<span class="string" id="5674995">&#34;&#34;</span>&nbsp;<span class="op" id="5674998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675002">return</span>&nbsp;<span class="ident" id="5675009">fmt</span><span class="op" id="5675012">.</span><span class="ident" id="5675013">Errorf</span><span class="op" id="5675019">(</span><span class="string" id="5675020">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="5675047">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5675050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675053">if</span>&nbsp;<span class="builtinfunc" id="5675056">len</span><span class="op" id="5675059">(</span><span class="ident" id="5675060">p</span><span class="op" id="5675061">.</span><span class="ident" id="5675062">tags</span><span class="op" id="5675066">)</span>&nbsp;<span class="op" id="5675068">==</span>&nbsp;<span class="num" id="5675071">0</span>&nbsp;<span class="op" id="5675073">||</span>&nbsp;<span class="ident" id="5675076">p</span><span class="op" id="5675077">.</span><span class="ident" id="5675078">tags</span><span class="op" id="5675082">[</span><span class="builtinfunc" id="5675083">len</span><span class="op" id="5675086">(</span><span class="ident" id="5675087">p</span><span class="op" id="5675088">.</span><span class="ident" id="5675089">tags</span><span class="op" id="5675093">)</span><span class="op" id="5675094">-</span><span class="num" id="5675095">1</span><span class="op" id="5675096">]</span><span class="op" id="5675097">.</span><span class="ident" id="5675098">Local</span>&nbsp;<span class="op" id="5675104">==</span>&nbsp;<span class="string" id="5675107">&#34;&#34;</span>&nbsp;<span class="op" id="5675110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675114">return</span>&nbsp;<span class="ident" id="5675121">fmt</span><span class="op" id="5675124">.</span><span class="ident" id="5675125">Errorf</span><span class="op" id="5675131">(</span><span class="string" id="5675132">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="5675170">,</span>&nbsp;<span class="ident" id="5675172">name</span><span class="op" id="5675176">.</span><span class="ident" id="5675177">Local</span><span class="op" id="5675182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5675185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675188">if</span>&nbsp;<span class="ident" id="5675191">top</span>&nbsp;<span class="op" id="5675195">:=</span>&nbsp;<span class="ident" id="5675198">p</span><span class="op" id="5675199">.</span><span class="ident" id="5675200">tags</span><span class="op" id="5675204">[</span><span class="builtinfunc" id="5675205">len</span><span class="op" id="5675208">(</span><span class="ident" id="5675209">p</span><span class="op" id="5675210">.</span><span class="ident" id="5675211">tags</span><span class="op" id="5675215">)</span><span class="op" id="5675216">-</span><span class="num" id="5675217">1</span><span class="op" id="5675218">]</span><span class="op" id="5675219">;</span>&nbsp;<span class="ident" id="5675221">top</span>&nbsp;<span class="op" id="5675225">!=</span>&nbsp;<span class="ident" id="5675228">name</span>&nbsp;<span class="op" id="5675233">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675237">if</span>&nbsp;<span class="ident" id="5675240">top</span><span class="op" id="5675243">.</span><span class="ident" id="5675244">Local</span>&nbsp;<span class="op" id="5675250">!=</span>&nbsp;<span class="ident" id="5675253">name</span><span class="op" id="5675257">.</span><span class="ident" id="5675258">Local</span>&nbsp;<span class="op" id="5675264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675269">return</span>&nbsp;<span class="ident" id="5675276">fmt</span><span class="op" id="5675279">.</span><span class="ident" id="5675280">Errorf</span><span class="op" id="5675286">(</span><span class="string" id="5675287">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="5675337">,</span>&nbsp;<span class="ident" id="5675339">name</span><span class="op" id="5675343">.</span><span class="ident" id="5675344">Local</span><span class="op" id="5675349">,</span>&nbsp;<span class="ident" id="5675351">top</span><span class="op" id="5675354">.</span><span class="ident" id="5675355">Local</span><span class="op" id="5675360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5675364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675368">return</span>&nbsp;<span class="ident" id="5675375">fmt</span><span class="op" id="5675378">.</span><span class="ident" id="5675379">Errorf</span><span class="op" id="5675385">(</span><span class="string" id="5675386">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="5675468">,</span>&nbsp;<span class="ident" id="5675470">name</span><span class="op" id="5675474">.</span><span class="ident" id="5675475">Local</span><span class="op" id="5675480">,</span>&nbsp;<span class="ident" id="5675482">name</span><span class="op" id="5675486">.</span><span class="ident" id="5675487">Space</span><span class="op" id="5675492">,</span>&nbsp;<span class="ident" id="5675494">top</span><span class="op" id="5675497">.</span><span class="ident" id="5675498">Local</span><span class="op" id="5675503">,</span>&nbsp;<span class="ident" id="5675505">top</span><span class="op" id="5675508">.</span><span class="ident" id="5675509">Space</span><span class="op" id="5675514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5675517">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675520">p</span><span class="op" id="5675521">.</span><span class="ident" id="5675522">tags</span>&nbsp;<span class="op" id="5675527">=</span>&nbsp;<span class="ident" id="5675529">p</span><span class="op" id="5675530">.</span><span class="ident" id="5675531">tags</span><span class="op" id="5675535">[</span><span class="op" id="5675536">:</span><span class="builtinfunc" id="5675537">len</span><span class="op" id="5675540">(</span><span class="ident" id="5675541">p</span><span class="op" id="5675542">.</span><span class="ident" id="5675543">tags</span><span class="op" id="5675547">)</span><span class="op" id="5675548">-</span><span class="num" id="5675549">1</span><span class="op" id="5675550">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675554">p</span><span class="op" id="5675555">.</span><span class="ident" id="5675556">writeIndent</span><span class="op" id="5675567">(</span><span class="op" id="5675568">-</span><span class="num" id="5675569">1</span><span class="op" id="5675570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675573">p</span><span class="op" id="5675574">.</span><span class="ident" id="5675575">WriteByte</span><span class="op" id="5675584">(</span><span class="string" id="5675585">&#39;&lt;&#39;</span><span class="op" id="5675588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675591">p</span><span class="op" id="5675592">.</span><span class="ident" id="5675593">WriteByte</span><span class="op" id="5675602">(</span><span class="string" id="5675603">&#39;/&#39;</span><span class="op" id="5675606">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675609">p</span><span class="op" id="5675610">.</span><span class="ident" id="5675611">WriteString</span><span class="op" id="5675622">(</span><span class="ident" id="5675623">name</span><span class="op" id="5675627">.</span><span class="ident" id="5675628">Local</span><span class="op" id="5675633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675636">p</span><span class="op" id="5675637">.</span><span class="ident" id="5675638">WriteByte</span><span class="op" id="5675647">(</span><span class="string" id="5675648">&#39;&gt;&#39;</span><span class="op" id="5675651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5675654">p</span><span class="op" id="5675655">.</span><span class="ident" id="5675656">popPrefix</span><span class="op" id="5675665">(</span><span class="op" id="5675666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675669">return</span>&nbsp;<span class="builtintype" id="5675676">nil</span><br>
<span class="lineno"></span><span class="op" id="5675680">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="5675683">func</span>&nbsp;<span class="op" id="5675688">(</span><span class="ident" id="5675689">p</span>&nbsp;<span class="op" id="5675691">*</span><span class="ident" id="5675692">printer</span><span class="op" id="5675699">)</span>&nbsp;<span class="ident" id="5675701">marshalSimple</span><span class="op" id="5675714">(</span><span class="ident" id="5675715">typ</span>&nbsp;<span class="ident" id="5675719">reflect</span><span class="op" id="5675726">.</span><span class="ident" id="5675727">Type</span><span class="op" id="5675731">,</span>&nbsp;<span class="ident" id="5675733">val</span>&nbsp;<span class="ident" id="5675737">reflect</span><span class="op" id="5675744">.</span><span class="ident" id="5675745">Value</span><span class="op" id="5675750">)</span>&nbsp;<span class="op" id="5675752">(</span><span class="builtintype" id="5675753">string</span><span class="op" id="5675759">,</span>&nbsp;<span class="op" id="5675761">[</span><span class="op" id="5675762">]</span><span class="builtintype" id="5675763">byte</span><span class="op" id="5675767">,</span>&nbsp;<span class="builtintype" id="5675769">error</span><span class="op" id="5675774">)</span>&nbsp;<span class="op" id="5675776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675779">switch</span>&nbsp;<span class="ident" id="5675786">val</span><span class="op" id="5675789">.</span><span class="ident" id="5675790">Kind</span><span class="op" id="5675794">(</span><span class="op" id="5675795">)</span>&nbsp;<span class="op" id="5675797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675800">case</span>&nbsp;<span class="ident" id="5675805">reflect</span><span class="op" id="5675812">.</span><span class="ident" id="5675813">Int</span><span class="op" id="5675816">,</span>&nbsp;<span class="ident" id="5675818">reflect</span><span class="op" id="5675825">.</span><span class="ident" id="5675826">Int8</span><span class="op" id="5675830">,</span>&nbsp;<span class="ident" id="5675832">reflect</span><span class="op" id="5675839">.</span><span class="ident" id="5675840">Int16</span><span class="op" id="5675845">,</span>&nbsp;<span class="ident" id="5675847">reflect</span><span class="op" id="5675854">.</span><span class="ident" id="5675855">Int32</span><span class="op" id="5675860">,</span>&nbsp;<span class="ident" id="5675862">reflect</span><span class="op" id="5675869">.</span><span class="ident" id="5675870">Int64</span><span class="op" id="5675875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675879">return</span>&nbsp;<span class="ident" id="5675886">strconv</span><span class="op" id="5675893">.</span><span class="ident" id="5675894">FormatInt</span><span class="op" id="5675903">(</span><span class="ident" id="5675904">val</span><span class="op" id="5675907">.</span><span class="ident" id="5675908">Int</span><span class="op" id="5675911">(</span><span class="op" id="5675912">)</span><span class="op" id="5675913">,</span>&nbsp;<span class="num" id="5675915">10</span><span class="op" id="5675917">)</span><span class="op" id="5675918">,</span>&nbsp;<span class="builtintype" id="5675920">nil</span><span class="op" id="5675923">,</span>&nbsp;<span class="builtintype" id="5675925">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5675930">case</span>&nbsp;<span class="ident" id="5675935">reflect</span><span class="op" id="5675942">.</span><span class="ident" id="5675943">Uint</span><span class="op" id="5675947">,</span>&nbsp;<span class="ident" id="5675949">reflect</span><span class="op" id="5675956">.</span><span class="ident" id="5675957">Uint8</span><span class="op" id="5675962">,</span>&nbsp;<span class="ident" id="5675964">reflect</span><span class="op" id="5675971">.</span><span class="ident" id="5675972">Uint16</span><span class="op" id="5675978">,</span>&nbsp;<span class="ident" id="5675980">reflect</span><span class="op" id="5675987">.</span><span class="ident" id="5675988">Uint32</span><span class="op" id="5675994">,</span>&nbsp;<span class="ident" id="5675996">reflect</span><span class="op" id="5676003">.</span><span class="ident" id="5676004">Uint64</span><span class="op" id="5676010">,</span>&nbsp;<span class="ident" id="5676012">reflect</span><span class="op" id="5676019">.</span><span class="ident" id="5676020">Uintptr</span><span class="op" id="5676027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676031">return</span>&nbsp;<span class="ident" id="5676038">strconv</span><span class="op" id="5676045">.</span><span class="ident" id="5676046">FormatUint</span><span class="op" id="5676056">(</span><span class="ident" id="5676057">val</span><span class="op" id="5676060">.</span><span class="ident" id="5676061">Uint</span><span class="op" id="5676065">(</span><span class="op" id="5676066">)</span><span class="op" id="5676067">,</span>&nbsp;<span class="num" id="5676069">10</span><span class="op" id="5676071">)</span><span class="op" id="5676072">,</span>&nbsp;<span class="builtintype" id="5676074">nil</span><span class="op" id="5676077">,</span>&nbsp;<span class="builtintype" id="5676079">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676084">case</span>&nbsp;<span class="ident" id="5676089">reflect</span><span class="op" id="5676096">.</span><span class="ident" id="5676097">Float32</span><span class="op" id="5676104">,</span>&nbsp;<span class="ident" id="5676106">reflect</span><span class="op" id="5676113">.</span><span class="ident" id="5676114">Float64</span><span class="op" id="5676121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676125">return</span>&nbsp;<span class="ident" id="5676132">strconv</span><span class="op" id="5676139">.</span><span class="ident" id="5676140">FormatFloat</span><span class="op" id="5676151">(</span><span class="ident" id="5676152">val</span><span class="op" id="5676155">.</span><span class="ident" id="5676156">Float</span><span class="op" id="5676161">(</span><span class="op" id="5676162">)</span><span class="op" id="5676163">,</span>&nbsp;<span class="string" id="5676165">&#39;g&#39;</span><span class="op" id="5676168">,</span>&nbsp;<span class="op" id="5676170">-</span><span class="num" id="5676171">1</span><span class="op" id="5676172">,</span>&nbsp;<span class="ident" id="5676174">val</span><span class="op" id="5676177">.</span><span class="ident" id="5676178">Type</span><span class="op" id="5676182">(</span><span class="op" id="5676183">)</span><span class="op" id="5676184">.</span><span class="ident" id="5676185">Bits</span><span class="op" id="5676189">(</span><span class="op" id="5676190">)</span><span class="op" id="5676191">)</span><span class="op" id="5676192">,</span>&nbsp;<span class="builtintype" id="5676194">nil</span><span class="op" id="5676197">,</span>&nbsp;<span class="builtintype" id="5676199">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676204">case</span>&nbsp;<span class="ident" id="5676209">reflect</span><span class="op" id="5676216">.</span><span class="ident" id="5676217">String</span><span class="op" id="5676223">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676227">return</span>&nbsp;<span class="ident" id="5676234">val</span><span class="op" id="5676237">.</span><span class="ident" id="5676238">String</span><span class="op" id="5676244">(</span><span class="op" id="5676245">)</span><span class="op" id="5676246">,</span>&nbsp;<span class="builtintype" id="5676248">nil</span><span class="op" id="5676251">,</span>&nbsp;<span class="builtintype" id="5676253">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676258">case</span>&nbsp;<span class="ident" id="5676263">reflect</span><span class="op" id="5676270">.</span><span class="ident" id="5676271">Bool</span><span class="op" id="5676275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676279">return</span>&nbsp;<span class="ident" id="5676286">strconv</span><span class="op" id="5676293">.</span><span class="ident" id="5676294">FormatBool</span><span class="op" id="5676304">(</span><span class="ident" id="5676305">val</span><span class="op" id="5676308">.</span><span class="ident" id="5676309">Bool</span><span class="op" id="5676313">(</span><span class="op" id="5676314">)</span><span class="op" id="5676315">)</span><span class="op" id="5676316">,</span>&nbsp;<span class="builtintype" id="5676318">nil</span><span class="op" id="5676321">,</span>&nbsp;<span class="builtintype" id="5676323">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676328">case</span>&nbsp;<span class="ident" id="5676333">reflect</span><span class="op" id="5676340">.</span><span class="ident" id="5676341">Array</span><span class="op" id="5676346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676350">if</span>&nbsp;<span class="ident" id="5676353">typ</span><span class="op" id="5676356">.</span><span class="ident" id="5676357">Elem</span><span class="op" id="5676361">(</span><span class="op" id="5676362">)</span><span class="op" id="5676363">.</span><span class="ident" id="5676364">Kind</span><span class="op" id="5676368">(</span><span class="op" id="5676369">)</span>&nbsp;<span class="op" id="5676371">!=</span>&nbsp;<span class="ident" id="5676374">reflect</span><span class="op" id="5676381">.</span><span class="ident" id="5676382">Uint8</span>&nbsp;<span class="op" id="5676388">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676393">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5676401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5676405">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676420">var</span>&nbsp;<span class="ident" id="5676424">bytes</span>&nbsp;<span class="op" id="5676430">[</span><span class="op" id="5676431">]</span><span class="builtintype" id="5676432">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676439">if</span>&nbsp;<span class="ident" id="5676442">val</span><span class="op" id="5676445">.</span><span class="ident" id="5676446">CanAddr</span><span class="op" id="5676453">(</span><span class="op" id="5676454">)</span>&nbsp;<span class="op" id="5676456">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676461">bytes</span>&nbsp;<span class="op" id="5676467">=</span>&nbsp;<span class="ident" id="5676469">val</span><span class="op" id="5676472">.</span><span class="ident" id="5676473">Slice</span><span class="op" id="5676478">(</span><span class="num" id="5676479">0</span><span class="op" id="5676480">,</span>&nbsp;<span class="ident" id="5676482">val</span><span class="op" id="5676485">.</span><span class="ident" id="5676486">Len</span><span class="op" id="5676489">(</span><span class="op" id="5676490">)</span><span class="op" id="5676491">)</span><span class="op" id="5676492">.</span><span class="ident" id="5676493">Bytes</span><span class="op" id="5676498">(</span><span class="op" id="5676499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5676503">}</span>&nbsp;<span class="keyword" id="5676505">else</span>&nbsp;<span class="op" id="5676510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676515">bytes</span>&nbsp;<span class="op" id="5676521">=</span>&nbsp;<span class="builtinfunc" id="5676523">make</span><span class="op" id="5676527">(</span><span class="op" id="5676528">[</span><span class="op" id="5676529">]</span><span class="builtintype" id="5676530">byte</span><span class="op" id="5676534">,</span>&nbsp;<span class="ident" id="5676536">val</span><span class="op" id="5676539">.</span><span class="ident" id="5676540">Len</span><span class="op" id="5676543">(</span><span class="op" id="5676544">)</span><span class="op" id="5676545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676550">reflect</span><span class="op" id="5676557">.</span><span class="ident" id="5676558">Copy</span><span class="op" id="5676562">(</span><span class="ident" id="5676563">reflect</span><span class="op" id="5676570">.</span><span class="ident" id="5676571">ValueOf</span><span class="op" id="5676578">(</span><span class="ident" id="5676579">bytes</span><span class="op" id="5676584">)</span><span class="op" id="5676585">,</span>&nbsp;<span class="ident" id="5676587">val</span><span class="op" id="5676590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5676594">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676598">return</span>&nbsp;<span class="string" id="5676605">&#34;&#34;</span><span class="op" id="5676607">,</span>&nbsp;<span class="ident" id="5676609">bytes</span><span class="op" id="5676614">,</span>&nbsp;<span class="builtintype" id="5676616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676621">case</span>&nbsp;<span class="ident" id="5676626">reflect</span><span class="op" id="5676633">.</span><span class="ident" id="5676634">Slice</span><span class="op" id="5676639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676643">if</span>&nbsp;<span class="ident" id="5676646">typ</span><span class="op" id="5676649">.</span><span class="ident" id="5676650">Elem</span><span class="op" id="5676654">(</span><span class="op" id="5676655">)</span><span class="op" id="5676656">.</span><span class="ident" id="5676657">Kind</span><span class="op" id="5676661">(</span><span class="op" id="5676662">)</span>&nbsp;<span class="op" id="5676664">!=</span>&nbsp;<span class="ident" id="5676667">reflect</span><span class="op" id="5676674">.</span><span class="ident" id="5676675">Uint8</span>&nbsp;<span class="op" id="5676681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676686">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5676694">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5676698">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676710">return</span>&nbsp;<span class="string" id="5676717">&#34;&#34;</span><span class="op" id="5676719">,</span>&nbsp;<span class="ident" id="5676721">val</span><span class="op" id="5676724">.</span><span class="ident" id="5676725">Bytes</span><span class="op" id="5676730">(</span><span class="op" id="5676731">)</span><span class="op" id="5676732">,</span>&nbsp;<span class="builtintype" id="5676734">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5676739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676742">return</span>&nbsp;<span class="string" id="5676749">&#34;&#34;</span><span class="op" id="5676751">,</span>&nbsp;<span class="builtintype" id="5676753">nil</span><span class="op" id="5676756">,</span>&nbsp;<span class="op" id="5676758">&amp;</span><span class="ident" id="5676759">UnsupportedTypeError</span><span class="op" id="5676779">{</span><span class="ident" id="5676780">typ</span><span class="op" id="5676783">}</span><br>
<span class="lineno"></span><span class="op" id="5676785">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="5676788">var</span>&nbsp;<span class="ident" id="5676792">ddBytes</span>&nbsp;<span class="op" id="5676800">=</span>&nbsp;<span class="op" id="5676802">[</span><span class="op" id="5676803">]</span><span class="builtintype" id="5676804">byte</span><span class="op" id="5676808">(</span><span class="string" id="5676809">&#34;--&#34;</span><span class="op" id="5676813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5676816">func</span>&nbsp;<span class="op" id="5676821">(</span><span class="ident" id="5676822">p</span>&nbsp;<span class="op" id="5676824">*</span><span class="ident" id="5676825">printer</span><span class="op" id="5676832">)</span>&nbsp;<span class="ident" id="5676834">marshalStruct</span><span class="op" id="5676847">(</span><span class="ident" id="5676848">tinfo</span>&nbsp;<span class="op" id="5676854">*</span><span class="ident" id="5676855">typeInfo</span><span class="op" id="5676863">,</span>&nbsp;<span class="ident" id="5676865">val</span>&nbsp;<span class="ident" id="5676869">reflect</span><span class="op" id="5676876">.</span><span class="ident" id="5676877">Value</span><span class="op" id="5676882">)</span>&nbsp;<span class="builtintype" id="5676884">error</span>&nbsp;<span class="op" id="5676890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676893">s</span>&nbsp;<span class="op" id="5676895">:=</span>&nbsp;<span class="ident" id="5676898">parentStack</span><span class="op" id="5676909">{</span><span class="ident" id="5676910">p</span><span class="op" id="5676911">:</span>&nbsp;<span class="ident" id="5676913">p</span><span class="op" id="5676914">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676917">for</span>&nbsp;<span class="ident" id="5676921">i</span>&nbsp;<span class="op" id="5676923">:=</span>&nbsp;<span class="keyword" id="5676926">range</span>&nbsp;<span class="ident" id="5676932">tinfo</span><span class="op" id="5676937">.</span><span class="ident" id="5676938">fields</span>&nbsp;<span class="op" id="5676945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5676949">finfo</span>&nbsp;<span class="op" id="5676955">:=</span>&nbsp;<span class="op" id="5676958">&amp;</span><span class="ident" id="5676959">tinfo</span><span class="op" id="5676964">.</span><span class="ident" id="5676965">fields</span><span class="op" id="5676971">[</span><span class="ident" id="5676972">i</span><span class="op" id="5676973">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5676977">if</span>&nbsp;<span class="ident" id="5676980">finfo</span><span class="op" id="5676985">.</span><span class="ident" id="5676986">flags</span><span class="op" id="5676991">&amp;</span><span class="ident" id="5676992">fAttr</span>&nbsp;<span class="op" id="5676998">!=</span>&nbsp;<span class="num" id="5677001">0</span>&nbsp;<span class="op" id="5677003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677008">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677019">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677023">vf</span>&nbsp;<span class="op" id="5677026">:=</span>&nbsp;<span class="ident" id="5677029">finfo</span><span class="op" id="5677034">.</span><span class="ident" id="5677035">value</span><span class="op" id="5677040">(</span><span class="ident" id="5677041">val</span><span class="op" id="5677044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5677049">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677105">switch</span>&nbsp;<span class="ident" id="5677112">vf</span><span class="op" id="5677114">.</span><span class="ident" id="5677115">Kind</span><span class="op" id="5677119">(</span><span class="op" id="5677120">)</span>&nbsp;<span class="op" id="5677122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677126">case</span>&nbsp;<span class="ident" id="5677131">reflect</span><span class="op" id="5677138">.</span><span class="ident" id="5677139">Ptr</span><span class="op" id="5677142">,</span>&nbsp;<span class="ident" id="5677144">reflect</span><span class="op" id="5677151">.</span><span class="ident" id="5677152">Interface</span><span class="op" id="5677161">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677166">if</span>&nbsp;<span class="op" id="5677169">!</span><span class="ident" id="5677170">vf</span><span class="op" id="5677172">.</span><span class="ident" id="5677173">IsNil</span><span class="op" id="5677178">(</span><span class="op" id="5677179">)</span>&nbsp;<span class="op" id="5677181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677187">vf</span>&nbsp;<span class="op" id="5677190">=</span>&nbsp;<span class="ident" id="5677192">vf</span><span class="op" id="5677194">.</span><span class="ident" id="5677195">Elem</span><span class="op" id="5677199">(</span><span class="op" id="5677200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677214">switch</span>&nbsp;<span class="ident" id="5677221">finfo</span><span class="op" id="5677226">.</span><span class="ident" id="5677227">flags</span>&nbsp;<span class="op" id="5677233">&amp;</span>&nbsp;<span class="ident" id="5677235">fMode</span>&nbsp;<span class="op" id="5677241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677245">case</span>&nbsp;<span class="ident" id="5677250">fCharData</span><span class="op" id="5677259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677264">if</span>&nbsp;<span class="ident" id="5677267">vf</span><span class="op" id="5677269">.</span><span class="ident" id="5677270">CanInterface</span><span class="op" id="5677282">(</span><span class="op" id="5677283">)</span>&nbsp;<span class="op" id="5677285">&amp;&amp;</span>&nbsp;<span class="ident" id="5677288">vf</span><span class="op" id="5677290">.</span><span class="ident" id="5677291">Type</span><span class="op" id="5677295">(</span><span class="op" id="5677296">)</span><span class="op" id="5677297">.</span><span class="ident" id="5677298">Implements</span><span class="op" id="5677308">(</span><span class="ident" id="5677309">textMarshalerType</span><span class="op" id="5677326">)</span>&nbsp;<span class="op" id="5677328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677334">data</span><span class="op" id="5677338">,</span>&nbsp;<span class="ident" id="5677340">err</span>&nbsp;<span class="op" id="5677344">:=</span>&nbsp;<span class="ident" id="5677347">vf</span><span class="op" id="5677349">.</span><span class="ident" id="5677350">Interface</span><span class="op" id="5677359">(</span><span class="op" id="5677360">)</span><span class="op" id="5677361">.</span><span class="op" id="5677362">(</span><span class="ident" id="5677363">encoding</span><span class="op" id="5677371">.</span><span class="ident" id="5677372">TextMarshaler</span><span class="op" id="5677385">)</span><span class="op" id="5677386">.</span><span class="ident" id="5677387">MarshalText</span><span class="op" id="5677398">(</span><span class="op" id="5677399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677405">if</span>&nbsp;<span class="ident" id="5677408">err</span>&nbsp;<span class="op" id="5677412">!=</span>&nbsp;<span class="builtintype" id="5677415">nil</span>&nbsp;<span class="op" id="5677419">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677426">return</span>&nbsp;<span class="ident" id="5677433">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677447">Escape</span><span class="op" id="5677453">(</span><span class="ident" id="5677454">p</span><span class="op" id="5677455">,</span>&nbsp;<span class="ident" id="5677457">data</span><span class="op" id="5677461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677467">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677479">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677484">if</span>&nbsp;<span class="ident" id="5677487">vf</span><span class="op" id="5677489">.</span><span class="ident" id="5677490">CanAddr</span><span class="op" id="5677497">(</span><span class="op" id="5677498">)</span>&nbsp;<span class="op" id="5677500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677506">pv</span>&nbsp;<span class="op" id="5677509">:=</span>&nbsp;<span class="ident" id="5677512">vf</span><span class="op" id="5677514">.</span><span class="ident" id="5677515">Addr</span><span class="op" id="5677519">(</span><span class="op" id="5677520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677526">if</span>&nbsp;<span class="ident" id="5677529">pv</span><span class="op" id="5677531">.</span><span class="ident" id="5677532">CanInterface</span><span class="op" id="5677544">(</span><span class="op" id="5677545">)</span>&nbsp;<span class="op" id="5677547">&amp;&amp;</span>&nbsp;<span class="ident" id="5677550">pv</span><span class="op" id="5677552">.</span><span class="ident" id="5677553">Type</span><span class="op" id="5677557">(</span><span class="op" id="5677558">)</span><span class="op" id="5677559">.</span><span class="ident" id="5677560">Implements</span><span class="op" id="5677570">(</span><span class="ident" id="5677571">textMarshalerType</span><span class="op" id="5677588">)</span>&nbsp;<span class="op" id="5677590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677597">data</span><span class="op" id="5677601">,</span>&nbsp;<span class="ident" id="5677603">err</span>&nbsp;<span class="op" id="5677607">:=</span>&nbsp;<span class="ident" id="5677610">pv</span><span class="op" id="5677612">.</span><span class="ident" id="5677613">Interface</span><span class="op" id="5677622">(</span><span class="op" id="5677623">)</span><span class="op" id="5677624">.</span><span class="op" id="5677625">(</span><span class="ident" id="5677626">encoding</span><span class="op" id="5677634">.</span><span class="ident" id="5677635">TextMarshaler</span><span class="op" id="5677648">)</span><span class="op" id="5677649">.</span><span class="ident" id="5677650">MarshalText</span><span class="op" id="5677661">(</span><span class="op" id="5677662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677669">if</span>&nbsp;<span class="ident" id="5677672">err</span>&nbsp;<span class="op" id="5677676">!=</span>&nbsp;<span class="builtintype" id="5677679">nil</span>&nbsp;<span class="op" id="5677683">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677691">return</span>&nbsp;<span class="ident" id="5677698">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677714">Escape</span><span class="op" id="5677720">(</span><span class="ident" id="5677721">p</span><span class="op" id="5677722">,</span>&nbsp;<span class="ident" id="5677724">data</span><span class="op" id="5677728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677735">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677748">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5677753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677758">var</span>&nbsp;<span class="ident" id="5677762">scratch</span>&nbsp;<span class="op" id="5677770">[</span><span class="num" id="5677771">64</span><span class="op" id="5677773">]</span><span class="builtintype" id="5677774">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677782">switch</span>&nbsp;<span class="ident" id="5677789">vf</span><span class="op" id="5677791">.</span><span class="ident" id="5677792">Kind</span><span class="op" id="5677796">(</span><span class="op" id="5677797">)</span>&nbsp;<span class="op" id="5677799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677804">case</span>&nbsp;<span class="ident" id="5677809">reflect</span><span class="op" id="5677816">.</span><span class="ident" id="5677817">Int</span><span class="op" id="5677820">,</span>&nbsp;<span class="ident" id="5677822">reflect</span><span class="op" id="5677829">.</span><span class="ident" id="5677830">Int8</span><span class="op" id="5677834">,</span>&nbsp;<span class="ident" id="5677836">reflect</span><span class="op" id="5677843">.</span><span class="ident" id="5677844">Int16</span><span class="op" id="5677849">,</span>&nbsp;<span class="ident" id="5677851">reflect</span><span class="op" id="5677858">.</span><span class="ident" id="5677859">Int32</span><span class="op" id="5677864">,</span>&nbsp;<span class="ident" id="5677866">reflect</span><span class="op" id="5677873">.</span><span class="ident" id="5677874">Int64</span><span class="op" id="5677879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5677885">Escape</span><span class="op" id="5677891">(</span><span class="ident" id="5677892">p</span><span class="op" id="5677893">,</span>&nbsp;<span class="ident" id="5677895">strconv</span><span class="op" id="5677902">.</span><span class="ident" id="5677903">AppendInt</span><span class="op" id="5677912">(</span><span class="ident" id="5677913">scratch</span><span class="op" id="5677920">[</span><span class="op" id="5677921">:</span><span class="num" id="5677922">0</span><span class="op" id="5677923">]</span><span class="op" id="5677924">,</span>&nbsp;<span class="ident" id="5677926">vf</span><span class="op" id="5677928">.</span><span class="ident" id="5677929">Int</span><span class="op" id="5677932">(</span><span class="op" id="5677933">)</span><span class="op" id="5677934">,</span>&nbsp;<span class="num" id="5677936">10</span><span class="op" id="5677938">)</span><span class="op" id="5677939">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5677944">case</span>&nbsp;<span class="ident" id="5677949">reflect</span><span class="op" id="5677956">.</span><span class="ident" id="5677957">Uint</span><span class="op" id="5677961">,</span>&nbsp;<span class="ident" id="5677963">reflect</span><span class="op" id="5677970">.</span><span class="ident" id="5677971">Uint8</span><span class="op" id="5677976">,</span>&nbsp;<span class="ident" id="5677978">reflect</span><span class="op" id="5677985">.</span><span class="ident" id="5677986">Uint16</span><span class="op" id="5677992">,</span>&nbsp;<span class="ident" id="5677994">reflect</span><span class="op" id="5678001">.</span><span class="ident" id="5678002">Uint32</span><span class="op" id="5678008">,</span>&nbsp;<span class="ident" id="5678010">reflect</span><span class="op" id="5678017">.</span><span class="ident" id="5678018">Uint64</span><span class="op" id="5678024">,</span>&nbsp;<span class="ident" id="5678026">reflect</span><span class="op" id="5678033">.</span><span class="ident" id="5678034">Uintptr</span><span class="op" id="5678041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678047">Escape</span><span class="op" id="5678053">(</span><span class="ident" id="5678054">p</span><span class="op" id="5678055">,</span>&nbsp;<span class="ident" id="5678057">strconv</span><span class="op" id="5678064">.</span><span class="ident" id="5678065">AppendUint</span><span class="op" id="5678075">(</span><span class="ident" id="5678076">scratch</span><span class="op" id="5678083">[</span><span class="op" id="5678084">:</span><span class="num" id="5678085">0</span><span class="op" id="5678086">]</span><span class="op" id="5678087">,</span>&nbsp;<span class="ident" id="5678089">vf</span><span class="op" id="5678091">.</span><span class="ident" id="5678092">Uint</span><span class="op" id="5678096">(</span><span class="op" id="5678097">)</span><span class="op" id="5678098">,</span>&nbsp;<span class="num" id="5678100">10</span><span class="op" id="5678102">)</span><span class="op" id="5678103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678108">case</span>&nbsp;<span class="ident" id="5678113">reflect</span><span class="op" id="5678120">.</span><span class="ident" id="5678121">Float32</span><span class="op" id="5678128">,</span>&nbsp;<span class="ident" id="5678130">reflect</span><span class="op" id="5678137">.</span><span class="ident" id="5678138">Float64</span><span class="op" id="5678145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678151">Escape</span><span class="op" id="5678157">(</span><span class="ident" id="5678158">p</span><span class="op" id="5678159">,</span>&nbsp;<span class="ident" id="5678161">strconv</span><span class="op" id="5678168">.</span><span class="ident" id="5678169">AppendFloat</span><span class="op" id="5678180">(</span><span class="ident" id="5678181">scratch</span><span class="op" id="5678188">[</span><span class="op" id="5678189">:</span><span class="num" id="5678190">0</span><span class="op" id="5678191">]</span><span class="op" id="5678192">,</span>&nbsp;<span class="ident" id="5678194">vf</span><span class="op" id="5678196">.</span><span class="ident" id="5678197">Float</span><span class="op" id="5678202">(</span><span class="op" id="5678203">)</span><span class="op" id="5678204">,</span>&nbsp;<span class="string" id="5678206">&#39;g&#39;</span><span class="op" id="5678209">,</span>&nbsp;<span class="op" id="5678211">-</span><span class="num" id="5678212">1</span><span class="op" id="5678213">,</span>&nbsp;<span class="ident" id="5678215">vf</span><span class="op" id="5678217">.</span><span class="ident" id="5678218">Type</span><span class="op" id="5678222">(</span><span class="op" id="5678223">)</span><span class="op" id="5678224">.</span><span class="ident" id="5678225">Bits</span><span class="op" id="5678229">(</span><span class="op" id="5678230">)</span><span class="op" id="5678231">)</span><span class="op" id="5678232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678237">case</span>&nbsp;<span class="ident" id="5678242">reflect</span><span class="op" id="5678249">.</span><span class="ident" id="5678250">Bool</span><span class="op" id="5678254">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678260">Escape</span><span class="op" id="5678266">(</span><span class="ident" id="5678267">p</span><span class="op" id="5678268">,</span>&nbsp;<span class="ident" id="5678270">strconv</span><span class="op" id="5678277">.</span><span class="ident" id="5678278">AppendBool</span><span class="op" id="5678288">(</span><span class="ident" id="5678289">scratch</span><span class="op" id="5678296">[</span><span class="op" id="5678297">:</span><span class="num" id="5678298">0</span><span class="op" id="5678299">]</span><span class="op" id="5678300">,</span>&nbsp;<span class="ident" id="5678302">vf</span><span class="op" id="5678304">.</span><span class="ident" id="5678305">Bool</span><span class="op" id="5678309">(</span><span class="op" id="5678310">)</span><span class="op" id="5678311">)</span><span class="op" id="5678312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678317">case</span>&nbsp;<span class="ident" id="5678322">reflect</span><span class="op" id="5678329">.</span><span class="ident" id="5678330">String</span><span class="op" id="5678336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678342">if</span>&nbsp;<span class="ident" id="5678345">err</span>&nbsp;<span class="op" id="5678349">:=</span>&nbsp;<span class="ident" id="5678352">EscapeText</span><span class="op" id="5678362">(</span><span class="ident" id="5678363">p</span><span class="op" id="5678364">,</span>&nbsp;<span class="op" id="5678366">[</span><span class="op" id="5678367">]</span><span class="builtintype" id="5678368">byte</span><span class="op" id="5678372">(</span><span class="ident" id="5678373">vf</span><span class="op" id="5678375">.</span><span class="ident" id="5678376">String</span><span class="op" id="5678382">(</span><span class="op" id="5678383">)</span><span class="op" id="5678384">)</span><span class="op" id="5678385">)</span><span class="op" id="5678386">;</span>&nbsp;<span class="ident" id="5678388">err</span>&nbsp;<span class="op" id="5678392">!=</span>&nbsp;<span class="builtintype" id="5678395">nil</span>&nbsp;<span class="op" id="5678399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678406">return</span>&nbsp;<span class="ident" id="5678413">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678421">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678426">case</span>&nbsp;<span class="ident" id="5678431">reflect</span><span class="op" id="5678438">.</span><span class="ident" id="5678439">Slice</span><span class="op" id="5678444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678450">if</span>&nbsp;<span class="ident" id="5678453">elem</span><span class="op" id="5678457">,</span>&nbsp;<span class="ident" id="5678459">ok</span>&nbsp;<span class="op" id="5678462">:=</span>&nbsp;<span class="ident" id="5678465">vf</span><span class="op" id="5678467">.</span><span class="ident" id="5678468">Interface</span><span class="op" id="5678477">(</span><span class="op" id="5678478">)</span><span class="op" id="5678479">.</span><span class="op" id="5678480">(</span><span class="op" id="5678481">[</span><span class="op" id="5678482">]</span><span class="builtintype" id="5678483">byte</span><span class="op" id="5678487">)</span><span class="op" id="5678488">;</span>&nbsp;<span class="ident" id="5678490">ok</span>&nbsp;<span class="op" id="5678493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678500">if</span>&nbsp;<span class="ident" id="5678503">err</span>&nbsp;<span class="op" id="5678507">:=</span>&nbsp;<span class="ident" id="5678510">EscapeText</span><span class="op" id="5678520">(</span><span class="ident" id="5678521">p</span><span class="op" id="5678522">,</span>&nbsp;<span class="ident" id="5678524">elem</span><span class="op" id="5678528">)</span><span class="op" id="5678529">;</span>&nbsp;<span class="ident" id="5678531">err</span>&nbsp;<span class="op" id="5678535">!=</span>&nbsp;<span class="builtintype" id="5678538">nil</span>&nbsp;<span class="op" id="5678542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678550">return</span>&nbsp;<span class="ident" id="5678557">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678566">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678582">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678594">case</span>&nbsp;<span class="ident" id="5678599">fComment</span><span class="op" id="5678607">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678612">k</span>&nbsp;<span class="op" id="5678614">:=</span>&nbsp;<span class="ident" id="5678617">vf</span><span class="op" id="5678619">.</span><span class="ident" id="5678620">Kind</span><span class="op" id="5678624">(</span><span class="op" id="5678625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678630">if</span>&nbsp;<span class="op" id="5678633">!</span><span class="op" id="5678634">(</span><span class="ident" id="5678635">k</span>&nbsp;<span class="op" id="5678637">==</span>&nbsp;<span class="ident" id="5678640">reflect</span><span class="op" id="5678647">.</span><span class="ident" id="5678648">String</span>&nbsp;<span class="op" id="5678655">||</span>&nbsp;<span class="ident" id="5678658">k</span>&nbsp;<span class="op" id="5678660">==</span>&nbsp;<span class="ident" id="5678663">reflect</span><span class="op" id="5678670">.</span><span class="ident" id="5678671">Slice</span>&nbsp;<span class="op" id="5678677">&amp;&amp;</span>&nbsp;<span class="ident" id="5678680">vf</span><span class="op" id="5678682">.</span><span class="ident" id="5678683">Type</span><span class="op" id="5678687">(</span><span class="op" id="5678688">)</span><span class="op" id="5678689">.</span><span class="ident" id="5678690">Elem</span><span class="op" id="5678694">(</span><span class="op" id="5678695">)</span><span class="op" id="5678696">.</span><span class="ident" id="5678697">Kind</span><span class="op" id="5678701">(</span><span class="op" id="5678702">)</span>&nbsp;<span class="op" id="5678704">==</span>&nbsp;<span class="ident" id="5678707">reflect</span><span class="op" id="5678714">.</span><span class="ident" id="5678715">Uint8</span><span class="op" id="5678720">)</span>&nbsp;<span class="op" id="5678722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678728">return</span>&nbsp;<span class="ident" id="5678735">fmt</span><span class="op" id="5678738">.</span><span class="ident" id="5678739">Errorf</span><span class="op" id="5678745">(</span><span class="string" id="5678746">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="5678785">,</span>&nbsp;<span class="ident" id="5678787">val</span><span class="op" id="5678790">.</span><span class="ident" id="5678791">Type</span><span class="op" id="5678795">(</span><span class="op" id="5678796">)</span><span class="op" id="5678797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678807">if</span>&nbsp;<span class="ident" id="5678810">vf</span><span class="op" id="5678812">.</span><span class="ident" id="5678813">Len</span><span class="op" id="5678816">(</span><span class="op" id="5678817">)</span>&nbsp;<span class="op" id="5678819">==</span>&nbsp;<span class="num" id="5678822">0</span>&nbsp;<span class="op" id="5678824">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678830">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678847">p</span><span class="op" id="5678848">.</span><span class="ident" id="5678849">writeIndent</span><span class="op" id="5678860">(</span><span class="num" id="5678861">0</span><span class="op" id="5678862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678867">p</span><span class="op" id="5678868">.</span><span class="ident" id="5678869">WriteString</span><span class="op" id="5678880">(</span><span class="string" id="5678881">&#34;&lt;!--&#34;</span><span class="op" id="5678887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678892">dashDash</span>&nbsp;<span class="op" id="5678901">:=</span>&nbsp;<span class="builtintype" id="5678904">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678913">dashLast</span>&nbsp;<span class="op" id="5678922">:=</span>&nbsp;<span class="builtintype" id="5678925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678934">switch</span>&nbsp;<span class="ident" id="5678941">k</span>&nbsp;<span class="op" id="5678943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5678948">case</span>&nbsp;<span class="ident" id="5678953">reflect</span><span class="op" id="5678960">.</span><span class="ident" id="5678961">String</span><span class="op" id="5678967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678973">s</span>&nbsp;<span class="op" id="5678975">:=</span>&nbsp;<span class="ident" id="5678978">vf</span><span class="op" id="5678980">.</span><span class="ident" id="5678981">String</span><span class="op" id="5678987">(</span><span class="op" id="5678988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678994">dashDash</span>&nbsp;<span class="op" id="5679003">=</span>&nbsp;<span class="ident" id="5679005">strings</span><span class="op" id="5679012">.</span><span class="ident" id="5679013">Index</span><span class="op" id="5679018">(</span><span class="ident" id="5679019">s</span><span class="op" id="5679020">,</span>&nbsp;<span class="string" id="5679022">&#34;--&#34;</span><span class="op" id="5679026">)</span>&nbsp;<span class="op" id="5679028">&gt;=</span>&nbsp;<span class="num" id="5679031">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679037">dashLast</span>&nbsp;<span class="op" id="5679046">=</span>&nbsp;<span class="ident" id="5679048">s</span><span class="op" id="5679049">[</span><span class="builtinfunc" id="5679050">len</span><span class="op" id="5679053">(</span><span class="ident" id="5679054">s</span><span class="op" id="5679055">)</span><span class="op" id="5679056">-</span><span class="num" id="5679057">1</span><span class="op" id="5679058">]</span>&nbsp;<span class="op" id="5679060">==</span>&nbsp;<span class="string" id="5679063">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679071">if</span>&nbsp;<span class="op" id="5679074">!</span><span class="ident" id="5679075">dashDash</span>&nbsp;<span class="op" id="5679084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679091">p</span><span class="op" id="5679092">.</span><span class="ident" id="5679093">WriteString</span><span class="op" id="5679104">(</span><span class="ident" id="5679105">s</span><span class="op" id="5679106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679117">case</span>&nbsp;<span class="ident" id="5679122">reflect</span><span class="op" id="5679129">.</span><span class="ident" id="5679130">Slice</span><span class="op" id="5679135">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679141">b</span>&nbsp;<span class="op" id="5679143">:=</span>&nbsp;<span class="ident" id="5679146">vf</span><span class="op" id="5679148">.</span><span class="ident" id="5679149">Bytes</span><span class="op" id="5679154">(</span><span class="op" id="5679155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679161">dashDash</span>&nbsp;<span class="op" id="5679170">=</span>&nbsp;<span class="ident" id="5679172">bytes</span><span class="op" id="5679177">.</span><span class="ident" id="5679178">Index</span><span class="op" id="5679183">(</span><span class="ident" id="5679184">b</span><span class="op" id="5679185">,</span>&nbsp;<span class="ident" id="5679187">ddBytes</span><span class="op" id="5679194">)</span>&nbsp;<span class="op" id="5679196">&gt;=</span>&nbsp;<span class="num" id="5679199">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679205">dashLast</span>&nbsp;<span class="op" id="5679214">=</span>&nbsp;<span class="ident" id="5679216">b</span><span class="op" id="5679217">[</span><span class="builtinfunc" id="5679218">len</span><span class="op" id="5679221">(</span><span class="ident" id="5679222">b</span><span class="op" id="5679223">)</span><span class="op" id="5679224">-</span><span class="num" id="5679225">1</span><span class="op" id="5679226">]</span>&nbsp;<span class="op" id="5679228">==</span>&nbsp;<span class="string" id="5679231">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679239">if</span>&nbsp;<span class="op" id="5679242">!</span><span class="ident" id="5679243">dashDash</span>&nbsp;<span class="op" id="5679252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679259">p</span><span class="op" id="5679260">.</span><span class="ident" id="5679261">Write</span><span class="op" id="5679266">(</span><span class="ident" id="5679267">b</span><span class="op" id="5679268">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679279">default</span><span class="op" id="5679286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5679292">panic</span><span class="op" id="5679297">(</span><span class="string" id="5679298">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="5679312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679322">if</span>&nbsp;<span class="ident" id="5679325">dashDash</span>&nbsp;<span class="op" id="5679334">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679340">return</span>&nbsp;<span class="ident" id="5679347">fmt</span><span class="op" id="5679350">.</span><span class="ident" id="5679351">Errorf</span><span class="op" id="5679357">(</span><span class="string" id="5679358">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="5679395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679405">if</span>&nbsp;<span class="ident" id="5679408">dashLast</span>&nbsp;<span class="op" id="5679417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5679423">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679473">p</span><span class="op" id="5679474">.</span><span class="ident" id="5679475">WriteByte</span><span class="op" id="5679484">(</span><span class="string" id="5679485">&#39;&nbsp;&#39;</span><span class="op" id="5679488">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679498">p</span><span class="op" id="5679499">.</span><span class="ident" id="5679500">WriteString</span><span class="op" id="5679511">(</span><span class="string" id="5679512">&#34;--&gt;&#34;</span><span class="op" id="5679517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679522">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679534">case</span>&nbsp;<span class="ident" id="5679539">fInnerXml</span><span class="op" id="5679548">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679553">iface</span>&nbsp;<span class="op" id="5679559">:=</span>&nbsp;<span class="ident" id="5679562">vf</span><span class="op" id="5679564">.</span><span class="ident" id="5679565">Interface</span><span class="op" id="5679574">(</span><span class="op" id="5679575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679580">switch</span>&nbsp;<span class="ident" id="5679587">raw</span>&nbsp;<span class="op" id="5679591">:=</span>&nbsp;<span class="ident" id="5679594">iface</span><span class="op" id="5679599">.</span><span class="op" id="5679600">(</span><span class="keyword" id="5679601">type</span><span class="op" id="5679605">)</span>&nbsp;<span class="op" id="5679607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679612">case</span>&nbsp;<span class="op" id="5679617">[</span><span class="op" id="5679618">]</span><span class="builtintype" id="5679619">byte</span><span class="op" id="5679623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679629">p</span><span class="op" id="5679630">.</span><span class="ident" id="5679631">Write</span><span class="op" id="5679636">(</span><span class="ident" id="5679637">raw</span><span class="op" id="5679640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679646">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679658">case</span>&nbsp;<span class="builtintype" id="5679663">string</span><span class="op" id="5679669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5679675">p</span><span class="op" id="5679676">.</span><span class="ident" id="5679677">WriteString</span><span class="op" id="5679688">(</span><span class="ident" id="5679689">raw</span><span class="op" id="5679692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679698">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679715">case</span>&nbsp;<span class="ident" id="5679720">fElement</span><span class="op" id="5679728">,</span>&nbsp;<span class="ident" id="5679730">fElement</span>&nbsp;<span class="op" id="5679739">|</span>&nbsp;<span class="ident" id="5679741">fAny</span><span class="op" id="5679745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679750">if</span>&nbsp;<span class="ident" id="5679753">err</span>&nbsp;<span class="op" id="5679757">:=</span>&nbsp;<span class="ident" id="5679760">s</span><span class="op" id="5679761">.</span><span class="ident" id="5679762">trim</span><span class="op" id="5679766">(</span><span class="ident" id="5679767">finfo</span><span class="op" id="5679772">.</span><span class="ident" id="5679773">parents</span><span class="op" id="5679780">)</span><span class="op" id="5679781">;</span>&nbsp;<span class="ident" id="5679783">err</span>&nbsp;<span class="op" id="5679787">!=</span>&nbsp;<span class="builtintype" id="5679790">nil</span>&nbsp;<span class="op" id="5679794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679800">return</span>&nbsp;<span class="ident" id="5679807">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5679814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679819">if</span>&nbsp;<span class="builtinfunc" id="5679822">len</span><span class="op" id="5679825">(</span><span class="ident" id="5679826">finfo</span><span class="op" id="5679831">.</span><span class="ident" id="5679832">parents</span><span class="op" id="5679839">)</span>&nbsp;<span class="op" id="5679841">&gt;</span>&nbsp;<span class="builtinfunc" id="5679843">len</span><span class="op" id="5679846">(</span><span class="ident" id="5679847">s</span><span class="op" id="5679848">.</span><span class="ident" id="5679849">stack</span><span class="op" id="5679854">)</span>&nbsp;<span class="op" id="5679856">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679862">if</span>&nbsp;<span class="ident" id="5679865">vf</span><span class="op" id="5679867">.</span><span class="ident" id="5679868">Kind</span><span class="op" id="5679872">(</span><span class="op" id="5679873">)</span>&nbsp;<span class="op" id="5679875">!=</span>&nbsp;<span class="ident" id="5679878">reflect</span><span class="op" id="5679885">.</span><span class="ident" id="5679886">Ptr</span>&nbsp;<span class="op" id="5679890">&amp;&amp;</span>&nbsp;<span class="ident" id="5679893">vf</span><span class="op" id="5679895">.</span><span class="ident" id="5679896">Kind</span><span class="op" id="5679900">(</span><span class="op" id="5679901">)</span>&nbsp;<span class="op" id="5679903">!=</span>&nbsp;<span class="ident" id="5679906">reflect</span><span class="op" id="5679913">.</span><span class="ident" id="5679914">Interface</span>&nbsp;<span class="op" id="5679924">||</span>&nbsp;<span class="op" id="5679927">!</span><span class="ident" id="5679928">vf</span><span class="op" id="5679930">.</span><span class="ident" id="5679931">IsNil</span><span class="op" id="5679936">(</span><span class="op" id="5679937">)</span>&nbsp;<span class="op" id="5679939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5679946">if</span>&nbsp;<span class="ident" id="5679949">err</span>&nbsp;<span class="op" id="5679953">:=</span>&nbsp;<span class="ident" id="5679956">s</span><span class="op" id="5679957">.</span><span class="ident" id="5679958">push</span><span class="op" id="5679962">(</span><span class="ident" id="5679963">finfo</span><span class="op" id="5679968">.</span><span class="ident" id="5679969">parents</span><span class="op" id="5679976">[</span><span class="builtinfunc" id="5679977">len</span><span class="op" id="5679980">(</span><span class="ident" id="5679981">s</span><span class="op" id="5679982">.</span><span class="ident" id="5679983">stack</span><span class="op" id="5679988">)</span><span class="op" id="5679989">:</span><span class="op" id="5679990">]</span><span class="op" id="5679991">)</span><span class="op" id="5679992">;</span>&nbsp;<span class="ident" id="5679994">err</span>&nbsp;<span class="op" id="5679998">!=</span>&nbsp;<span class="builtintype" id="5680001">nil</span>&nbsp;<span class="op" id="5680005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680013">return</span>&nbsp;<span class="ident" id="5680020">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680035">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680048">if</span>&nbsp;<span class="ident" id="5680051">err</span>&nbsp;<span class="op" id="5680055">:=</span>&nbsp;<span class="ident" id="5680058">p</span><span class="op" id="5680059">.</span><span class="ident" id="5680060">marshalValue</span><span class="op" id="5680072">(</span><span class="ident" id="5680073">vf</span><span class="op" id="5680075">,</span>&nbsp;<span class="ident" id="5680077">finfo</span><span class="op" id="5680082">,</span>&nbsp;<span class="builtintype" id="5680084">nil</span><span class="op" id="5680087">)</span><span class="op" id="5680088">;</span>&nbsp;<span class="ident" id="5680090">err</span>&nbsp;<span class="op" id="5680094">!=</span>&nbsp;<span class="builtintype" id="5680097">nil</span>&nbsp;<span class="op" id="5680101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680106">return</span>&nbsp;<span class="ident" id="5680113">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680119">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680125">s</span><span class="op" id="5680126">.</span><span class="ident" id="5680127">trim</span><span class="op" id="5680131">(</span><span class="builtintype" id="5680132">nil</span><span class="op" id="5680135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680138">return</span>&nbsp;<span class="ident" id="5680145">p</span><span class="op" id="5680146">.</span><span class="ident" id="5680147">cachedWriteError</span><span class="op" id="5680163">(</span><span class="op" id="5680164">)</span><br>
<span class="lineno"></span><span class="op" id="5680166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="5680169">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="5680217">func</span>&nbsp;<span class="op" id="5680222">(</span><span class="ident" id="5680223">p</span>&nbsp;<span class="op" id="5680225">*</span><span class="ident" id="5680226">printer</span><span class="op" id="5680233">)</span>&nbsp;<span class="ident" id="5680235">cachedWriteError</span><span class="op" id="5680251">(</span><span class="op" id="5680252">)</span>&nbsp;<span class="builtintype" id="5680254">error</span>&nbsp;<span class="op" id="5680260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680263">_</span><span class="op" id="5680264">,</span>&nbsp;<span class="ident" id="5680266">err</span>&nbsp;<span class="op" id="5680270">:=</span>&nbsp;<span class="ident" id="5680273">p</span><span class="op" id="5680274">.</span><span class="ident" id="5680275">Write</span><span class="op" id="5680280">(</span><span class="builtintype" id="5680281">nil</span><span class="op" id="5680284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680287">return</span>&nbsp;<span class="ident" id="5680294">err</span><br>
<span class="lineno"></span><span class="op" id="5680298">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="5680301">func</span>&nbsp;<span class="op" id="5680306">(</span><span class="ident" id="5680307">p</span>&nbsp;<span class="op" id="5680309">*</span><span class="ident" id="5680310">printer</span><span class="op" id="5680317">)</span>&nbsp;<span class="ident" id="5680319">writeIndent</span><span class="op" id="5680330">(</span><span class="ident" id="5680331">depthDelta</span>&nbsp;<span class="builtintype" id="5680342">int</span><span class="op" id="5680345">)</span>&nbsp;<span class="op" id="5680347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680350">if</span>&nbsp;<span class="builtinfunc" id="5680353">len</span><span class="op" id="5680356">(</span><span class="ident" id="5680357">p</span><span class="op" id="5680358">.</span><span class="ident" id="5680359">prefix</span><span class="op" id="5680365">)</span>&nbsp;<span class="op" id="5680367">==</span>&nbsp;<span class="num" id="5680370">0</span>&nbsp;<span class="op" id="5680372">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5680375">len</span><span class="op" id="5680378">(</span><span class="ident" id="5680379">p</span><span class="op" id="5680380">.</span><span class="ident" id="5680381">indent</span><span class="op" id="5680387">)</span>&nbsp;<span class="op" id="5680389">==</span>&nbsp;<span class="num" id="5680392">0</span>&nbsp;<span class="op" id="5680394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680398">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680406">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680409">if</span>&nbsp;<span class="ident" id="5680412">depthDelta</span>&nbsp;<span class="op" id="5680423">&lt;</span>&nbsp;<span class="num" id="5680425">0</span>&nbsp;<span class="op" id="5680427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680431">p</span><span class="op" id="5680432">.</span><span class="ident" id="5680433">depth</span><span class="op" id="5680438">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680443">if</span>&nbsp;<span class="ident" id="5680446">p</span><span class="op" id="5680447">.</span><span class="ident" id="5680448">indentedIn</span>&nbsp;<span class="op" id="5680459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680464">p</span><span class="op" id="5680465">.</span><span class="ident" id="5680466">indentedIn</span>&nbsp;<span class="op" id="5680477">=</span>&nbsp;<span class="builtintype" id="5680479">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680488">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680501">p</span><span class="op" id="5680502">.</span><span class="ident" id="5680503">indentedIn</span>&nbsp;<span class="op" id="5680514">=</span>&nbsp;<span class="builtintype" id="5680516">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680526">if</span>&nbsp;<span class="ident" id="5680529">p</span><span class="op" id="5680530">.</span><span class="ident" id="5680531">putNewline</span>&nbsp;<span class="op" id="5680542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680546">p</span><span class="op" id="5680547">.</span><span class="ident" id="5680548">WriteByte</span><span class="op" id="5680557">(</span><span class="string" id="5680558">&#39;\n&#39;</span><span class="op" id="5680562">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680565">}</span>&nbsp;<span class="keyword" id="5680567">else</span>&nbsp;<span class="op" id="5680572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680576">p</span><span class="op" id="5680577">.</span><span class="ident" id="5680578">putNewline</span>&nbsp;<span class="op" id="5680589">=</span>&nbsp;<span class="builtintype" id="5680591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680600">if</span>&nbsp;<span class="builtinfunc" id="5680603">len</span><span class="op" id="5680606">(</span><span class="ident" id="5680607">p</span><span class="op" id="5680608">.</span><span class="ident" id="5680609">prefix</span><span class="op" id="5680615">)</span>&nbsp;<span class="op" id="5680617">&gt;</span>&nbsp;<span class="num" id="5680619">0</span>&nbsp;<span class="op" id="5680621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680625">p</span><span class="op" id="5680626">.</span><span class="ident" id="5680627">WriteString</span><span class="op" id="5680638">(</span><span class="ident" id="5680639">p</span><span class="op" id="5680640">.</span><span class="ident" id="5680641">prefix</span><span class="op" id="5680647">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680653">if</span>&nbsp;<span class="builtinfunc" id="5680656">len</span><span class="op" id="5680659">(</span><span class="ident" id="5680660">p</span><span class="op" id="5680661">.</span><span class="ident" id="5680662">indent</span><span class="op" id="5680668">)</span>&nbsp;<span class="op" id="5680670">&gt;</span>&nbsp;<span class="num" id="5680672">0</span>&nbsp;<span class="op" id="5680674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680678">for</span>&nbsp;<span class="ident" id="5680682">i</span>&nbsp;<span class="op" id="5680684">:=</span>&nbsp;<span class="num" id="5680687">0</span><span class="op" id="5680688">;</span>&nbsp;<span class="ident" id="5680690">i</span>&nbsp;<span class="op" id="5680692">&lt;</span>&nbsp;<span class="ident" id="5680694">p</span><span class="op" id="5680695">.</span><span class="ident" id="5680696">depth</span><span class="op" id="5680701">;</span>&nbsp;<span class="ident" id="5680703">i</span><span class="op" id="5680704">++</span>&nbsp;<span class="op" id="5680707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680712">p</span><span class="op" id="5680713">.</span><span class="ident" id="5680714">WriteString</span><span class="op" id="5680725">(</span><span class="ident" id="5680726">p</span><span class="op" id="5680727">.</span><span class="ident" id="5680728">indent</span><span class="op" id="5680734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680738">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5680744">if</span>&nbsp;<span class="ident" id="5680747">depthDelta</span>&nbsp;<span class="op" id="5680758">&gt;</span>&nbsp;<span class="num" id="5680760">0</span>&nbsp;<span class="op" id="5680762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680766">p</span><span class="op" id="5680767">.</span><span class="ident" id="5680768">depth</span><span class="op" id="5680773">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680778">p</span><span class="op" id="5680779">.</span><span class="ident" id="5680780">indentedIn</span>&nbsp;<span class="op" id="5680791">=</span>&nbsp;<span class="builtintype" id="5680793">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680799">}</span><br>
<span class="lineno">875</span><span class="op" id="5680801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5680804">type</span>&nbsp;<span class="ident" id="5680809">parentStack</span>&nbsp;<span class="keyword" id="5680821">struct</span>&nbsp;<span class="op" id="5680828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680831">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680837">*</span><span class="ident" id="5680838">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5680847">stack</span>&nbsp;<span class="op" id="5680853">[</span><span class="op" id="5680854">]</span><span class="builtintype" id="5680855">string</span><br>
<span class="lineno">880</span><span class="op" id="5680862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5680865">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="5680945">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="5681019">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="5681088">func</span>&nbsp;<span class="op" id="5681093">(</span><span class="ident" id="5681094">s</span>&nbsp;<span class="op" id="5681096">*</span><span class="ident" id="5681097">parentStack</span><span class="op" id="5681108">)</span>&nbsp;<span class="ident" id="5681110">trim</span><span class="op" id="5681114">(</span><span class="ident" id="5681115">parents</span>&nbsp;<span class="op" id="5681123">[</span><span class="op" id="5681124">]</span><span class="builtintype" id="5681125">string</span><span class="op" id="5681131">)</span>&nbsp;<span class="builtintype" id="5681133">error</span>&nbsp;<span class="op" id="5681139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5681142">split</span>&nbsp;<span class="op" id="5681148">:=</span>&nbsp;<span class="num" id="5681151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681154">for</span>&nbsp;<span class="op" id="5681158">;</span>&nbsp;<span class="ident" id="5681160">split</span>&nbsp;<span class="op" id="5681166">&lt;</span>&nbsp;<span class="builtinfunc" id="5681168">len</span><span class="op" id="5681171">(</span><span class="ident" id="5681172">parents</span><span class="op" id="5681179">)</span>&nbsp;<span class="op" id="5681181">&amp;&amp;</span>&nbsp;<span class="ident" id="5681184">split</span>&nbsp;<span class="op" id="5681190">&lt;</span>&nbsp;<span class="builtinfunc" id="5681192">len</span><span class="op" id="5681195">(</span><span class="ident" id="5681196">s</span><span class="op" id="5681197">.</span><span class="ident" id="5681198">stack</span><span class="op" id="5681203">)</span><span class="op" id="5681204">;</span>&nbsp;<span class="ident" id="5681206">split</span><span class="op" id="5681211">++</span>&nbsp;<span class="op" id="5681214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681218">if</span>&nbsp;<span class="ident" id="5681221">parents</span><span class="op" id="5681228">[</span><span class="ident" id="5681229">split</span><span class="op" id="5681234">]</span>&nbsp;<span class="op" id="5681236">!=</span>&nbsp;<span class="ident" id="5681239">s</span><span class="op" id="5681240">.</span><span class="ident" id="5681241">stack</span><span class="op" id="5681246">[</span><span class="ident" id="5681247">split</span><span class="op" id="5681252">]</span>&nbsp;<span class="op" id="5681254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681259">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681273">for</span>&nbsp;<span class="ident" id="5681277">i</span>&nbsp;<span class="op" id="5681279">:=</span>&nbsp;<span class="builtinfunc" id="5681282">len</span><span class="op" id="5681285">(</span><span class="ident" id="5681286">s</span><span class="op" id="5681287">.</span><span class="ident" id="5681288">stack</span><span class="op" id="5681293">)</span>&nbsp;<span class="op" id="5681295">-</span>&nbsp;<span class="num" id="5681297">1</span><span class="op" id="5681298">;</span>&nbsp;<span class="ident" id="5681300">i</span>&nbsp;<span class="op" id="5681302">&gt;=</span>&nbsp;<span class="ident" id="5681305">split</span><span class="op" id="5681310">;</span>&nbsp;<span class="ident" id="5681312">i</span><span class="op" id="5681313">--</span>&nbsp;<span class="op" id="5681316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681320">if</span>&nbsp;<span class="ident" id="5681323">err</span>&nbsp;<span class="op" id="5681327">:=</span>&nbsp;<span class="ident" id="5681330">s</span><span class="op" id="5681331">.</span><span class="ident" id="5681332">p</span><span class="op" id="5681333">.</span><span class="ident" id="5681334">writeEnd</span><span class="op" id="5681342">(</span><span class="ident" id="5681343">Name</span><span class="op" id="5681347">{</span><span class="ident" id="5681348">Local</span><span class="op" id="5681353">:</span>&nbsp;<span class="ident" id="5681355">s</span><span class="op" id="5681356">.</span><span class="ident" id="5681357">stack</span><span class="op" id="5681362">[</span><span class="ident" id="5681363">i</span><span class="op" id="5681364">]</span><span class="op" id="5681365">}</span><span class="op" id="5681366">)</span><span class="op" id="5681367">;</span>&nbsp;<span class="ident" id="5681369">err</span>&nbsp;<span class="op" id="5681373">!=</span>&nbsp;<span class="builtintype" id="5681376">nil</span>&nbsp;<span class="op" id="5681380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681385">return</span>&nbsp;<span class="ident" id="5681392">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5681404">s</span><span class="op" id="5681405">.</span><span class="ident" id="5681406">stack</span>&nbsp;<span class="op" id="5681412">=</span>&nbsp;<span class="ident" id="5681414">parents</span><span class="op" id="5681421">[</span><span class="op" id="5681422">:</span><span class="ident" id="5681423">split</span><span class="op" id="5681428">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681431">return</span>&nbsp;<span class="builtintype" id="5681438">nil</span><br>
<span class="lineno"></span><span class="op" id="5681442">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="5681445">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="5681509">func</span>&nbsp;<span class="op" id="5681514">(</span><span class="ident" id="5681515">s</span>&nbsp;<span class="op" id="5681517">*</span><span class="ident" id="5681518">parentStack</span><span class="op" id="5681529">)</span>&nbsp;<span class="ident" id="5681531">push</span><span class="op" id="5681535">(</span><span class="ident" id="5681536">parents</span>&nbsp;<span class="op" id="5681544">[</span><span class="op" id="5681545">]</span><span class="builtintype" id="5681546">string</span><span class="op" id="5681552">)</span>&nbsp;<span class="builtintype" id="5681554">error</span>&nbsp;<span class="op" id="5681560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681563">for</span>&nbsp;<span class="ident" id="5681567">i</span>&nbsp;<span class="op" id="5681569">:=</span>&nbsp;<span class="num" id="5681572">0</span><span class="op" id="5681573">;</span>&nbsp;<span class="ident" id="5681575">i</span>&nbsp;<span class="op" id="5681577">&lt;</span>&nbsp;<span class="builtinfunc" id="5681579">len</span><span class="op" id="5681582">(</span><span class="ident" id="5681583">parents</span><span class="op" id="5681590">)</span><span class="op" id="5681591">;</span>&nbsp;<span class="ident" id="5681593">i</span><span class="op" id="5681594">++</span>&nbsp;<span class="op" id="5681597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681601">if</span>&nbsp;<span class="ident" id="5681604">err</span>&nbsp;<span class="op" id="5681608">:=</span>&nbsp;<span class="ident" id="5681611">s</span><span class="op" id="5681612">.</span><span class="ident" id="5681613">p</span><span class="op" id="5681614">.</span><span class="ident" id="5681615">writeStart</span><span class="op" id="5681625">(</span><span class="op" id="5681626">&amp;</span><span class="ident" id="5681627">StartElement</span><span class="op" id="5681639">{</span><span class="ident" id="5681640">Name</span><span class="op" id="5681644">:</span>&nbsp;<span class="ident" id="5681646">Name</span><span class="op" id="5681650">{</span><span class="ident" id="5681651">Local</span><span class="op" id="5681656">:</span>&nbsp;<span class="ident" id="5681658">parents</span><span class="op" id="5681665">[</span><span class="ident" id="5681666">i</span><span class="op" id="5681667">]</span><span class="op" id="5681668">}</span><span class="op" id="5681669">}</span><span class="op" id="5681670">)</span><span class="op" id="5681671">;</span>&nbsp;<span class="ident" id="5681673">err</span>&nbsp;<span class="op" id="5681677">!=</span>&nbsp;<span class="builtintype" id="5681680">nil</span>&nbsp;<span class="op" id="5681684">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681689">return</span>&nbsp;<span class="ident" id="5681696">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5681708">s</span><span class="op" id="5681709">.</span><span class="ident" id="5681710">stack</span>&nbsp;<span class="op" id="5681716">=</span>&nbsp;<span class="builtinfunc" id="5681718">append</span><span class="op" id="5681724">(</span><span class="ident" id="5681725">s</span><span class="op" id="5681726">.</span><span class="ident" id="5681727">stack</span><span class="op" id="5681732">,</span>&nbsp;<span class="ident" id="5681734">parents</span><span class="op" id="5681741">...</span><span class="op" id="5681744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681747">return</span>&nbsp;<span class="builtintype" id="5681754">nil</span><br>
<span class="lineno">910</span><span class="op" id="5681758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5681761">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5681825">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="5681863">type</span>&nbsp;<span class="ident" id="5681868">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="5681889">struct</span>&nbsp;<span class="op" id="5681896">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5681899">Type</span>&nbsp;<span class="ident" id="5681904">reflect</span><span class="op" id="5681911">.</span><span class="ident" id="5681912">Type</span><br>
<span class="lineno"></span><span class="op" id="5681917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5681920">func</span>&nbsp;<span class="op" id="5681925">(</span><span class="ident" id="5681926">e</span>&nbsp;<span class="op" id="5681928">*</span><span class="ident" id="5681929">UnsupportedTypeError</span><span class="op" id="5681949">)</span>&nbsp;<span class="ident" id="5681951">Error</span><span class="op" id="5681956">(</span><span class="op" id="5681957">)</span>&nbsp;<span class="builtintype" id="5681959">string</span>&nbsp;<span class="op" id="5681966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5681969">return</span>&nbsp;<span class="string" id="5681976">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="5682002">+</span>&nbsp;<span class="ident" id="5682004">e</span><span class="op" id="5682005">.</span><span class="ident" id="5682006">Type</span><span class="op" id="5682010">.</span><span class="ident" id="5682011">String</span><span class="op" id="5682017">(</span><span class="op" id="5682018">)</span><br>
<span class="lineno">920</span><span class="op" id="5682020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5682023">func</span>&nbsp;<span class="ident" id="5682028">isEmptyValue</span><span class="op" id="5682040">(</span><span class="ident" id="5682041">v</span>&nbsp;<span class="ident" id="5682043">reflect</span><span class="op" id="5682050">.</span><span class="ident" id="5682051">Value</span><span class="op" id="5682056">)</span>&nbsp;<span class="builtintype" id="5682058">bool</span>&nbsp;<span class="op" id="5682063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682066">switch</span>&nbsp;<span class="ident" id="5682073">v</span><span class="op" id="5682074">.</span><span class="ident" id="5682075">Kind</span><span class="op" id="5682079">(</span><span class="op" id="5682080">)</span>&nbsp;<span class="op" id="5682082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682085">case</span>&nbsp;<span class="ident" id="5682090">reflect</span><span class="op" id="5682097">.</span><span class="ident" id="5682098">Array</span><span class="op" id="5682103">,</span>&nbsp;<span class="ident" id="5682105">reflect</span><span class="op" id="5682112">.</span><span class="ident" id="5682113">Map</span><span class="op" id="5682116">,</span>&nbsp;<span class="ident" id="5682118">reflect</span><span class="op" id="5682125">.</span><span class="ident" id="5682126">Slice</span><span class="op" id="5682131">,</span>&nbsp;<span class="ident" id="5682133">reflect</span><span class="op" id="5682140">.</span><span class="ident" id="5682141">String</span><span class="op" id="5682147">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682151">return</span>&nbsp;<span class="ident" id="5682158">v</span><span class="op" id="5682159">.</span><span class="ident" id="5682160">Len</span><span class="op" id="5682163">(</span><span class="op" id="5682164">)</span>&nbsp;<span class="op" id="5682166">==</span>&nbsp;<span class="num" id="5682169">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682172">case</span>&nbsp;<span class="ident" id="5682177">reflect</span><span class="op" id="5682184">.</span><span class="ident" id="5682185">Bool</span><span class="op" id="5682189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682193">return</span>&nbsp;<span class="op" id="5682200">!</span><span class="ident" id="5682201">v</span><span class="op" id="5682202">.</span><span class="ident" id="5682203">Bool</span><span class="op" id="5682207">(</span><span class="op" id="5682208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682211">case</span>&nbsp;<span class="ident" id="5682216">reflect</span><span class="op" id="5682223">.</span><span class="ident" id="5682224">Int</span><span class="op" id="5682227">,</span>&nbsp;<span class="ident" id="5682229">reflect</span><span class="op" id="5682236">.</span><span class="ident" id="5682237">Int8</span><span class="op" id="5682241">,</span>&nbsp;<span class="ident" id="5682243">reflect</span><span class="op" id="5682250">.</span><span class="ident" id="5682251">Int16</span><span class="op" id="5682256">,</span>&nbsp;<span class="ident" id="5682258">reflect</span><span class="op" id="5682265">.</span><span class="ident" id="5682266">Int32</span><span class="op" id="5682271">,</span>&nbsp;<span class="ident" id="5682273">reflect</span><span class="op" id="5682280">.</span><span class="ident" id="5682281">Int64</span><span class="op" id="5682286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682290">return</span>&nbsp;<span class="ident" id="5682297">v</span><span class="op" id="5682298">.</span><span class="ident" id="5682299">Int</span><span class="op" id="5682302">(</span><span class="op" id="5682303">)</span>&nbsp;<span class="op" id="5682305">==</span>&nbsp;<span class="num" id="5682308">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682311">case</span>&nbsp;<span class="ident" id="5682316">reflect</span><span class="op" id="5682323">.</span><span class="ident" id="5682324">Uint</span><span class="op" id="5682328">,</span>&nbsp;<span class="ident" id="5682330">reflect</span><span class="op" id="5682337">.</span><span class="ident" id="5682338">Uint8</span><span class="op" id="5682343">,</span>&nbsp;<span class="ident" id="5682345">reflect</span><span class="op" id="5682352">.</span><span class="ident" id="5682353">Uint16</span><span class="op" id="5682359">,</span>&nbsp;<span class="ident" id="5682361">reflect</span><span class="op" id="5682368">.</span><span class="ident" id="5682369">Uint32</span><span class="op" id="5682375">,</span>&nbsp;<span class="ident" id="5682377">reflect</span><span class="op" id="5682384">.</span><span class="ident" id="5682385">Uint64</span><span class="op" id="5682391">,</span>&nbsp;<span class="ident" id="5682393">reflect</span><span class="op" id="5682400">.</span><span class="ident" id="5682401">Uintptr</span><span class="op" id="5682408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682412">return</span>&nbsp;<span class="ident" id="5682419">v</span><span class="op" id="5682420">.</span><span class="ident" id="5682421">Uint</span><span class="op" id="5682425">(</span><span class="op" id="5682426">)</span>&nbsp;<span class="op" id="5682428">==</span>&nbsp;<span class="num" id="5682431">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682434">case</span>&nbsp;<span class="ident" id="5682439">reflect</span><span class="op" id="5682446">.</span><span class="ident" id="5682447">Float32</span><span class="op" id="5682454">,</span>&nbsp;<span class="ident" id="5682456">reflect</span><span class="op" id="5682463">.</span><span class="ident" id="5682464">Float64</span><span class="op" id="5682471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682475">return</span>&nbsp;<span class="ident" id="5682482">v</span><span class="op" id="5682483">.</span><span class="ident" id="5682484">Float</span><span class="op" id="5682489">(</span><span class="op" id="5682490">)</span>&nbsp;<span class="op" id="5682492">==</span>&nbsp;<span class="num" id="5682495">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682498">case</span>&nbsp;<span class="ident" id="5682503">reflect</span><span class="op" id="5682510">.</span><span class="ident" id="5682511">Interface</span><span class="op" id="5682520">,</span>&nbsp;<span class="ident" id="5682522">reflect</span><span class="op" id="5682529">.</span><span class="ident" id="5682530">Ptr</span><span class="op" id="5682533">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682537">return</span>&nbsp;<span class="ident" id="5682544">v</span><span class="op" id="5682545">.</span><span class="ident" id="5682546">IsNil</span><span class="op" id="5682551">(</span><span class="op" id="5682552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5682555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5682558">return</span>&nbsp;<span class="builtintype" id="5682565">false</span><br>
<span class="lineno"></span><span class="op" id="5682571">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
