<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html" class="current">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2484491">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2484547">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2484601">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2484652">//&nbsp;General&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2484687">package</span>&nbsp;<span class="ident" id="2484695">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2484699">import</span>&nbsp;<span class="string" id="2484706">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2484717">//&nbsp;Expand&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;mapping&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2484796">//&nbsp;For&nbsp;example,&nbsp;os.ExpandEnv(s)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;os.Expand(s,&nbsp;os.Getenv).</span><br>
<span class="lineno"></span><span class="keyword" id="2484870">func</span>&nbsp;<span class="ident" id="2484875">Expand</span><span class="op" id="2484881">(</span><span class="ident" id="2484882">s</span>&nbsp;<span class="builtintype" id="2484884">string</span><span class="op" id="2484890">,</span>&nbsp;<span class="ident" id="2484892">mapping</span>&nbsp;<span class="keyword" id="2484900">func</span><span class="op" id="2484904">(</span><span class="builtintype" id="2484905">string</span><span class="op" id="2484911">)</span>&nbsp;<span class="builtintype" id="2484913">string</span><span class="op" id="2484919">)</span>&nbsp;<span class="builtintype" id="2484921">string</span>&nbsp;<span class="op" id="2484928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484931">buf</span>&nbsp;<span class="op" id="2484935">:=</span>&nbsp;<span class="builtinfunc" id="2484938">make</span><span class="op" id="2484942">(</span><span class="op" id="2484943">[</span><span class="op" id="2484944">]</span><span class="builtintype" id="2484945">byte</span><span class="op" id="2484949">,</span>&nbsp;<span class="num" id="2484951">0</span><span class="op" id="2484952">,</span>&nbsp;<span class="num" id="2484954">2</span><span class="op" id="2484955">*</span><span class="builtinfunc" id="2484956">len</span><span class="op" id="2484959">(</span><span class="ident" id="2484960">s</span><span class="op" id="2484961">)</span><span class="op" id="2484962">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484965">//&nbsp;${}&nbsp;is&nbsp;all&nbsp;ASCII,&nbsp;so&nbsp;bytes&nbsp;are&nbsp;fine&nbsp;for&nbsp;this&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485025">i</span>&nbsp;<span class="op" id="2485027">:=</span>&nbsp;<span class="num" id="2485030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485033">for</span>&nbsp;<span class="ident" id="2485037">j</span>&nbsp;<span class="op" id="2485039">:=</span>&nbsp;<span class="num" id="2485042">0</span><span class="op" id="2485043">;</span>&nbsp;<span class="ident" id="2485045">j</span>&nbsp;<span class="op" id="2485047">&lt;</span>&nbsp;<span class="builtinfunc" id="2485049">len</span><span class="op" id="2485052">(</span><span class="ident" id="2485053">s</span><span class="op" id="2485054">)</span><span class="op" id="2485055">;</span>&nbsp;<span class="ident" id="2485057">j</span><span class="op" id="2485058">++</span>&nbsp;<span class="op" id="2485061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485065">if</span>&nbsp;<span class="ident" id="2485068">s</span><span class="op" id="2485069">[</span><span class="ident" id="2485070">j</span><span class="op" id="2485071">]</span>&nbsp;<span class="op" id="2485073">==</span>&nbsp;<span class="string" id="2485076">&#39;$&#39;</span>&nbsp;<span class="op" id="2485080">&amp;&amp;</span>&nbsp;<span class="ident" id="2485083">j</span><span class="op" id="2485084">+</span><span class="num" id="2485085">1</span>&nbsp;<span class="op" id="2485087">&lt;</span>&nbsp;<span class="builtinfunc" id="2485089">len</span><span class="op" id="2485092">(</span><span class="ident" id="2485093">s</span><span class="op" id="2485094">)</span>&nbsp;<span class="op" id="2485096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485101">buf</span>&nbsp;<span class="op" id="2485105">=</span>&nbsp;<span class="builtinfunc" id="2485107">append</span><span class="op" id="2485113">(</span><span class="ident" id="2485114">buf</span><span class="op" id="2485117">,</span>&nbsp;<span class="ident" id="2485119">s</span><span class="op" id="2485120">[</span><span class="ident" id="2485121">i</span><span class="op" id="2485122">:</span><span class="ident" id="2485123">j</span><span class="op" id="2485124">]</span><span class="op" id="2485125">...</span><span class="op" id="2485128">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485133">name</span><span class="op" id="2485137">,</span>&nbsp;<span class="ident" id="2485139">w</span>&nbsp;<span class="op" id="2485141">:=</span>&nbsp;<span class="ident" id="2485144">getShellName</span><span class="op" id="2485156">(</span><span class="ident" id="2485157">s</span><span class="op" id="2485158">[</span><span class="ident" id="2485159">j</span><span class="op" id="2485160">+</span><span class="num" id="2485161">1</span><span class="op" id="2485162">:</span><span class="op" id="2485163">]</span><span class="op" id="2485164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485169">buf</span>&nbsp;<span class="op" id="2485173">=</span>&nbsp;<span class="builtinfunc" id="2485175">append</span><span class="op" id="2485181">(</span><span class="ident" id="2485182">buf</span><span class="op" id="2485185">,</span>&nbsp;<span class="ident" id="2485187">mapping</span><span class="op" id="2485194">(</span><span class="ident" id="2485195">name</span><span class="op" id="2485199">)</span><span class="op" id="2485200">...</span><span class="op" id="2485203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485208">j</span>&nbsp;<span class="op" id="2485210">+=</span>&nbsp;<span class="ident" id="2485213">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485218">i</span>&nbsp;<span class="op" id="2485220">=</span>&nbsp;<span class="ident" id="2485222">j</span>&nbsp;<span class="op" id="2485224">+</span>&nbsp;<span class="num" id="2485226">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485230">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485236">return</span>&nbsp;<span class="builtintype" id="2485243">string</span><span class="op" id="2485249">(</span><span class="ident" id="2485250">buf</span><span class="op" id="2485253">)</span>&nbsp;<span class="op" id="2485255">+</span>&nbsp;<span class="ident" id="2485257">s</span><span class="op" id="2485258">[</span><span class="ident" id="2485259">i</span><span class="op" id="2485260">:</span><span class="op" id="2485261">]</span><br>
<span class="lineno"></span><span class="op" id="2485263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2485266">//&nbsp;ExpandEnv&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;according&nbsp;to&nbsp;the&nbsp;values</span><br>
<span class="lineno">30</span><span class="comment" id="2485341">//&nbsp;of&nbsp;the&nbsp;current&nbsp;environment&nbsp;variables.&nbsp;&nbsp;References&nbsp;to&nbsp;undefined</span><br>
<span class="lineno"></span><span class="comment" id="2485407">//&nbsp;variables&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2485454">func</span>&nbsp;<span class="ident" id="2485459">ExpandEnv</span><span class="op" id="2485468">(</span><span class="ident" id="2485469">s</span>&nbsp;<span class="builtintype" id="2485471">string</span><span class="op" id="2485477">)</span>&nbsp;<span class="builtintype" id="2485479">string</span>&nbsp;<span class="op" id="2485486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485489">return</span>&nbsp;<span class="ident" id="2485496">Expand</span><span class="op" id="2485502">(</span><span class="ident" id="2485503">s</span><span class="op" id="2485504">,</span>&nbsp;<span class="ident" id="2485506">Getenv</span><span class="op" id="2485512">)</span><br>
<span class="lineno"></span><span class="op" id="2485514">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="2485517">//&nbsp;isSpellSpecialVar&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;identifies&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2485589">//&nbsp;shell&nbsp;variable&nbsp;such&nbsp;as&nbsp;$*.</span><br>
<span class="lineno"></span><span class="keyword" id="2485619">func</span>&nbsp;<span class="ident" id="2485624">isShellSpecialVar</span><span class="op" id="2485641">(</span><span class="ident" id="2485642">c</span>&nbsp;<span class="builtintype" id="2485644">uint8</span><span class="op" id="2485649">)</span>&nbsp;<span class="builtintype" id="2485651">bool</span>&nbsp;<span class="op" id="2485656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485659">switch</span>&nbsp;<span class="ident" id="2485666">c</span>&nbsp;<span class="op" id="2485668">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485671">case</span>&nbsp;<span class="string" id="2485676">&#39;*&#39;</span><span class="op" id="2485679">,</span>&nbsp;<span class="string" id="2485681">&#39;#&#39;</span><span class="op" id="2485684">,</span>&nbsp;<span class="string" id="2485686">&#39;$&#39;</span><span class="op" id="2485689">,</span>&nbsp;<span class="string" id="2485691">&#39;@&#39;</span><span class="op" id="2485694">,</span>&nbsp;<span class="string" id="2485696">&#39;!&#39;</span><span class="op" id="2485699">,</span>&nbsp;<span class="string" id="2485701">&#39;?&#39;</span><span class="op" id="2485704">,</span>&nbsp;<span class="string" id="2485706">&#39;0&#39;</span><span class="op" id="2485709">,</span>&nbsp;<span class="string" id="2485711">&#39;1&#39;</span><span class="op" id="2485714">,</span>&nbsp;<span class="string" id="2485716">&#39;2&#39;</span><span class="op" id="2485719">,</span>&nbsp;<span class="string" id="2485721">&#39;3&#39;</span><span class="op" id="2485724">,</span>&nbsp;<span class="string" id="2485726">&#39;4&#39;</span><span class="op" id="2485729">,</span>&nbsp;<span class="string" id="2485731">&#39;5&#39;</span><span class="op" id="2485734">,</span>&nbsp;<span class="string" id="2485736">&#39;6&#39;</span><span class="op" id="2485739">,</span>&nbsp;<span class="string" id="2485741">&#39;7&#39;</span><span class="op" id="2485744">,</span>&nbsp;<span class="string" id="2485746">&#39;8&#39;</span><span class="op" id="2485749">,</span>&nbsp;<span class="string" id="2485751">&#39;9&#39;</span><span class="op" id="2485754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485758">return</span>&nbsp;<span class="builtintype" id="2485765">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485774">return</span>&nbsp;<span class="builtintype" id="2485781">false</span><br>
<span class="lineno"></span><span class="op" id="2485787">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="2485790">//&nbsp;isAlphaNum&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;letter,&nbsp;number,&nbsp;or&nbsp;underscore</span><br>
<span class="lineno"></span><span class="keyword" id="2485871">func</span>&nbsp;<span class="ident" id="2485876">isAlphaNum</span><span class="op" id="2485886">(</span><span class="ident" id="2485887">c</span>&nbsp;<span class="builtintype" id="2485889">uint8</span><span class="op" id="2485894">)</span>&nbsp;<span class="builtintype" id="2485896">bool</span>&nbsp;<span class="op" id="2485901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485904">return</span>&nbsp;<span class="ident" id="2485911">c</span>&nbsp;<span class="op" id="2485913">==</span>&nbsp;<span class="string" id="2485916">&#39;_&#39;</span>&nbsp;<span class="op" id="2485920">||</span>&nbsp;<span class="string" id="2485923">&#39;0&#39;</span>&nbsp;<span class="op" id="2485927">&lt;=</span>&nbsp;<span class="ident" id="2485930">c</span>&nbsp;<span class="op" id="2485932">&amp;&amp;</span>&nbsp;<span class="ident" id="2485935">c</span>&nbsp;<span class="op" id="2485937">&lt;=</span>&nbsp;<span class="string" id="2485940">&#39;9&#39;</span>&nbsp;<span class="op" id="2485944">||</span>&nbsp;<span class="string" id="2485947">&#39;a&#39;</span>&nbsp;<span class="op" id="2485951">&lt;=</span>&nbsp;<span class="ident" id="2485954">c</span>&nbsp;<span class="op" id="2485956">&amp;&amp;</span>&nbsp;<span class="ident" id="2485959">c</span>&nbsp;<span class="op" id="2485961">&lt;=</span>&nbsp;<span class="string" id="2485964">&#39;z&#39;</span>&nbsp;<span class="op" id="2485968">||</span>&nbsp;<span class="string" id="2485971">&#39;A&#39;</span>&nbsp;<span class="op" id="2485975">&lt;=</span>&nbsp;<span class="ident" id="2485978">c</span>&nbsp;<span class="op" id="2485980">&amp;&amp;</span>&nbsp;<span class="ident" id="2485983">c</span>&nbsp;<span class="op" id="2485985">&lt;=</span>&nbsp;<span class="string" id="2485988">&#39;Z&#39;</span><br>
<span class="lineno"></span><span class="op" id="2485992">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="2485995">//&nbsp;getName&nbsp;returns&nbsp;the&nbsp;name&nbsp;that&nbsp;begins&nbsp;the&nbsp;string&nbsp;and&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="2486070">//&nbsp;consumed&nbsp;to&nbsp;extract&nbsp;it.&nbsp;&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;enclosed&nbsp;in&nbsp;{},&nbsp;it&#39;s&nbsp;part&nbsp;of&nbsp;a&nbsp;${}</span><br>
<span class="lineno"></span><span class="comment" id="2486148">//&nbsp;expansion&nbsp;and&nbsp;two&nbsp;more&nbsp;bytes&nbsp;are&nbsp;needed&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2486220">func</span>&nbsp;<span class="ident" id="2486225">getShellName</span><span class="op" id="2486237">(</span><span class="ident" id="2486238">s</span>&nbsp;<span class="builtintype" id="2486240">string</span><span class="op" id="2486246">)</span>&nbsp;<span class="op" id="2486248">(</span><span class="builtintype" id="2486249">string</span><span class="op" id="2486255">,</span>&nbsp;<span class="builtintype" id="2486257">int</span><span class="op" id="2486260">)</span>&nbsp;<span class="op" id="2486262">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486265">switch</span>&nbsp;<span class="op" id="2486272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486275">case</span>&nbsp;<span class="ident" id="2486280">s</span><span class="op" id="2486281">[</span><span class="num" id="2486282">0</span><span class="op" id="2486283">]</span>&nbsp;<span class="op" id="2486285">==</span>&nbsp;<span class="string" id="2486288">&#39;{&#39;</span><span class="op" id="2486291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486295">if</span>&nbsp;<span class="builtinfunc" id="2486298">len</span><span class="op" id="2486301">(</span><span class="ident" id="2486302">s</span><span class="op" id="2486303">)</span>&nbsp;<span class="op" id="2486305">&gt;</span>&nbsp;<span class="num" id="2486307">2</span>&nbsp;<span class="op" id="2486309">&amp;&amp;</span>&nbsp;<span class="ident" id="2486312">isShellSpecialVar</span><span class="op" id="2486329">(</span><span class="ident" id="2486330">s</span><span class="op" id="2486331">[</span><span class="num" id="2486332">1</span><span class="op" id="2486333">]</span><span class="op" id="2486334">)</span>&nbsp;<span class="op" id="2486336">&amp;&amp;</span>&nbsp;<span class="ident" id="2486339">s</span><span class="op" id="2486340">[</span><span class="num" id="2486341">2</span><span class="op" id="2486342">]</span>&nbsp;<span class="op" id="2486344">==</span>&nbsp;<span class="string" id="2486347">&#39;}&#39;</span>&nbsp;<span class="op" id="2486351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486356">return</span>&nbsp;<span class="ident" id="2486363">s</span><span class="op" id="2486364">[</span><span class="num" id="2486365">1</span><span class="op" id="2486366">:</span><span class="num" id="2486367">2</span><span class="op" id="2486368">]</span><span class="op" id="2486369">,</span>&nbsp;<span class="num" id="2486371">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486375">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486379">//&nbsp;Scan&nbsp;to&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486406">for</span>&nbsp;<span class="ident" id="2486410">i</span>&nbsp;<span class="op" id="2486412">:=</span>&nbsp;<span class="num" id="2486415">1</span><span class="op" id="2486416">;</span>&nbsp;<span class="ident" id="2486418">i</span>&nbsp;<span class="op" id="2486420">&lt;</span>&nbsp;<span class="builtinfunc" id="2486422">len</span><span class="op" id="2486425">(</span><span class="ident" id="2486426">s</span><span class="op" id="2486427">)</span><span class="op" id="2486428">;</span>&nbsp;<span class="ident" id="2486430">i</span><span class="op" id="2486431">++</span>&nbsp;<span class="op" id="2486434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486439">if</span>&nbsp;<span class="ident" id="2486442">s</span><span class="op" id="2486443">[</span><span class="ident" id="2486444">i</span><span class="op" id="2486445">]</span>&nbsp;<span class="op" id="2486447">==</span>&nbsp;<span class="string" id="2486450">&#39;}&#39;</span>&nbsp;<span class="op" id="2486454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486460">return</span>&nbsp;<span class="ident" id="2486467">s</span><span class="op" id="2486468">[</span><span class="num" id="2486469">1</span><span class="op" id="2486470">:</span><span class="ident" id="2486471">i</span><span class="op" id="2486472">]</span><span class="op" id="2486473">,</span>&nbsp;<span class="ident" id="2486475">i</span>&nbsp;<span class="op" id="2486477">+</span>&nbsp;<span class="num" id="2486479">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486484">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486492">return</span>&nbsp;<span class="string" id="2486499">&#34;&#34;</span><span class="op" id="2486501">,</span>&nbsp;<span class="num" id="2486503">1</span>&nbsp;<span class="comment" id="2486505">//&nbsp;Bad&nbsp;syntax;&nbsp;just&nbsp;eat&nbsp;the&nbsp;brace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486541">case</span>&nbsp;<span class="ident" id="2486546">isShellSpecialVar</span><span class="op" id="2486563">(</span><span class="ident" id="2486564">s</span><span class="op" id="2486565">[</span><span class="num" id="2486566">0</span><span class="op" id="2486567">]</span><span class="op" id="2486568">)</span><span class="op" id="2486569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486573">return</span>&nbsp;<span class="ident" id="2486580">s</span><span class="op" id="2486581">[</span><span class="num" id="2486582">0</span><span class="op" id="2486583">:</span><span class="num" id="2486584">1</span><span class="op" id="2486585">]</span><span class="op" id="2486586">,</span>&nbsp;<span class="num" id="2486588">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486591">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486594">//&nbsp;Scan&nbsp;alphanumerics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486618">var</span>&nbsp;<span class="ident" id="2486622">i</span>&nbsp;<span class="builtintype" id="2486624">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486629">for</span>&nbsp;<span class="ident" id="2486633">i</span>&nbsp;<span class="op" id="2486635">=</span>&nbsp;<span class="num" id="2486637">0</span><span class="op" id="2486638">;</span>&nbsp;<span class="ident" id="2486640">i</span>&nbsp;<span class="op" id="2486642">&lt;</span>&nbsp;<span class="builtinfunc" id="2486644">len</span><span class="op" id="2486647">(</span><span class="ident" id="2486648">s</span><span class="op" id="2486649">)</span>&nbsp;<span class="op" id="2486651">&amp;&amp;</span>&nbsp;<span class="ident" id="2486654">isAlphaNum</span><span class="op" id="2486664">(</span><span class="ident" id="2486665">s</span><span class="op" id="2486666">[</span><span class="ident" id="2486667">i</span><span class="op" id="2486668">]</span><span class="op" id="2486669">)</span><span class="op" id="2486670">;</span>&nbsp;<span class="ident" id="2486672">i</span><span class="op" id="2486673">++</span>&nbsp;<span class="op" id="2486676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486682">return</span>&nbsp;<span class="ident" id="2486689">s</span><span class="op" id="2486690">[</span><span class="op" id="2486691">:</span><span class="ident" id="2486692">i</span><span class="op" id="2486693">]</span><span class="op" id="2486694">,</span>&nbsp;<span class="ident" id="2486696">i</span><br>
<span class="lineno">75</span><span class="op" id="2486698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2486701">//&nbsp;Getenv&nbsp;retrieves&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="2486777">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;value,&nbsp;which&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2486854">func</span>&nbsp;<span class="ident" id="2486859">Getenv</span><span class="op" id="2486865">(</span><span class="ident" id="2486866">key</span>&nbsp;<span class="builtintype" id="2486870">string</span><span class="op" id="2486876">)</span>&nbsp;<span class="builtintype" id="2486878">string</span>&nbsp;<span class="op" id="2486885">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486888">v</span><span class="op" id="2486889">,</span>&nbsp;<span class="ident" id="2486891">_</span>&nbsp;<span class="op" id="2486893">:=</span>&nbsp;<span class="ident" id="2486896">syscall</span><span class="op" id="2486903">.</span><span class="ident" id="2486904">Getenv</span><span class="op" id="2486910">(</span><span class="ident" id="2486911">key</span><span class="op" id="2486914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486917">return</span>&nbsp;<span class="ident" id="2486924">v</span><br>
<span class="lineno"></span><span class="op" id="2486926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2486929">//&nbsp;Setenv&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno">85</span><span class="comment" id="2487000">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2487032">func</span>&nbsp;<span class="ident" id="2487037">Setenv</span><span class="op" id="2487043">(</span><span class="ident" id="2487044">key</span><span class="op" id="2487047">,</span>&nbsp;<span class="ident" id="2487049">value</span>&nbsp;<span class="builtintype" id="2487055">string</span><span class="op" id="2487061">)</span>&nbsp;<span class="builtintype" id="2487063">error</span>&nbsp;<span class="op" id="2487069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487072">err</span>&nbsp;<span class="op" id="2487076">:=</span>&nbsp;<span class="ident" id="2487079">syscall</span><span class="op" id="2487086">.</span><span class="ident" id="2487087">Setenv</span><span class="op" id="2487093">(</span><span class="ident" id="2487094">key</span><span class="op" id="2487097">,</span>&nbsp;<span class="ident" id="2487099">value</span><span class="op" id="2487104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487107">if</span>&nbsp;<span class="ident" id="2487110">err</span>&nbsp;<span class="op" id="2487114">!=</span>&nbsp;<span class="ident" id="2487117">nil</span>&nbsp;<span class="op" id="2487121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487125">return</span>&nbsp;<span class="ident" id="2487132">NewSyscallError</span><span class="op" id="2487147">(</span><span class="string" id="2487148">&#34;setenv&#34;</span><span class="op" id="2487156">,</span>&nbsp;<span class="ident" id="2487158">err</span><span class="op" id="2487161">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487167">return</span>&nbsp;<span class="ident" id="2487174">nil</span><br>
<span class="lineno"></span><span class="op" id="2487178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487181">//&nbsp;Unsetenv&nbsp;unsets&nbsp;a&nbsp;single&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno">95</span><span class="keyword" id="2487231">func</span>&nbsp;<span class="ident" id="2487236">Unsetenv</span><span class="op" id="2487244">(</span><span class="ident" id="2487245">key</span>&nbsp;<span class="builtintype" id="2487249">string</span><span class="op" id="2487255">)</span>&nbsp;<span class="builtintype" id="2487257">error</span>&nbsp;<span class="op" id="2487263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487266">return</span>&nbsp;<span class="ident" id="2487273">syscall</span><span class="op" id="2487280">.</span><span class="ident" id="2487281">Unsetenv</span><span class="op" id="2487289">(</span><span class="ident" id="2487290">key</span><span class="op" id="2487293">)</span><br>
<span class="lineno"></span><span class="op" id="2487295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487298">//&nbsp;Clearenv&nbsp;deletes&nbsp;all&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno">100</span><span class="keyword" id="2487345">func</span>&nbsp;<span class="ident" id="2487350">Clearenv</span><span class="op" id="2487358">(</span><span class="op" id="2487359">)</span>&nbsp;<span class="op" id="2487361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487364">syscall</span><span class="op" id="2487371">.</span><span class="ident" id="2487372">Clearenv</span><span class="op" id="2487380">(</span><span class="op" id="2487381">)</span><br>
<span class="lineno"></span><span class="op" id="2487383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487386">//&nbsp;Environ&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;environment,</span><br>
<span class="lineno">105</span><span class="comment" id="2487453">//&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;key=value&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2487481">func</span>&nbsp;<span class="ident" id="2487486">Environ</span><span class="op" id="2487493">(</span><span class="op" id="2487494">)</span>&nbsp;<span class="op" id="2487496">[</span><span class="op" id="2487497">]</span><span class="builtintype" id="2487498">string</span>&nbsp;<span class="op" id="2487505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487508">return</span>&nbsp;<span class="ident" id="2487515">syscall</span><span class="op" id="2487522">.</span><span class="ident" id="2487523">Environ</span><span class="op" id="2487530">(</span><span class="op" id="2487531">)</span><br>
<span class="lineno"></span><span class="op" id="2487533">}</span>
</div>
</body>
</html>
