<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8250741">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8250796">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8250850">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8250901">package</span>&nbsp;<span class="ident" id="8250909">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8250914">import</span>&nbsp;<span class="op" id="8250921">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250924">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250933">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250940">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250949">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250964">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250977">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8250987">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8250990">func</span>&nbsp;<span class="ident" id="8250995">diff</span><span class="op" id="8250999">(</span><span class="ident" id="8251000">m0</span><span class="op" id="8251002">,</span>&nbsp;<span class="ident" id="8251004">m1</span>&nbsp;<span class="ident" id="8251007">image</span><span class="op" id="8251012">.</span><span class="ident" id="8251013">Image</span><span class="op" id="8251018">)</span>&nbsp;<span class="builtintype" id="8251020">error</span>&nbsp;<span class="op" id="8251026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251029">b0</span><span class="op" id="8251031">,</span>&nbsp;<span class="ident" id="8251033">b1</span>&nbsp;<span class="op" id="8251036">:=</span>&nbsp;<span class="ident" id="8251039">m0</span><span class="op" id="8251041">.</span><span class="ident" id="8251042">Bounds</span><span class="op" id="8251048">(</span><span class="op" id="8251049">)</span><span class="op" id="8251050">,</span>&nbsp;<span class="ident" id="8251052">m1</span><span class="op" id="8251054">.</span><span class="ident" id="8251055">Bounds</span><span class="op" id="8251061">(</span><span class="op" id="8251062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251065">if</span>&nbsp;<span class="op" id="8251068">!</span><span class="ident" id="8251069">b0</span><span class="op" id="8251071">.</span><span class="ident" id="8251072">Size</span><span class="op" id="8251076">(</span><span class="op" id="8251077">)</span><span class="op" id="8251078">.</span><span class="ident" id="8251079">Eq</span><span class="op" id="8251081">(</span><span class="ident" id="8251082">b1</span><span class="op" id="8251084">.</span><span class="ident" id="8251085">Size</span><span class="op" id="8251089">(</span><span class="op" id="8251090">)</span><span class="op" id="8251091">)</span>&nbsp;<span class="op" id="8251093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251097">return</span>&nbsp;<span class="ident" id="8251104">fmt</span><span class="op" id="8251107">.</span><span class="ident" id="8251108">Errorf</span><span class="op" id="8251114">(</span><span class="string" id="8251115">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8251144">,</span>&nbsp;<span class="ident" id="8251146">b0</span><span class="op" id="8251148">,</span>&nbsp;<span class="ident" id="8251150">b1</span><span class="op" id="8251152">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251158">dx</span>&nbsp;<span class="op" id="8251161">:=</span>&nbsp;<span class="ident" id="8251164">b1</span><span class="op" id="8251166">.</span><span class="ident" id="8251167">Min</span><span class="op" id="8251170">.</span><span class="ident" id="8251171">X</span>&nbsp;<span class="op" id="8251173">-</span>&nbsp;<span class="ident" id="8251175">b0</span><span class="op" id="8251177">.</span><span class="ident" id="8251178">Min</span><span class="op" id="8251181">.</span><span class="ident" id="8251182">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251185">dy</span>&nbsp;<span class="op" id="8251188">:=</span>&nbsp;<span class="ident" id="8251191">b1</span><span class="op" id="8251193">.</span><span class="ident" id="8251194">Min</span><span class="op" id="8251197">.</span><span class="ident" id="8251198">Y</span>&nbsp;<span class="op" id="8251200">-</span>&nbsp;<span class="ident" id="8251202">b0</span><span class="op" id="8251204">.</span><span class="ident" id="8251205">Min</span><span class="op" id="8251208">.</span><span class="ident" id="8251209">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251212">for</span>&nbsp;<span class="ident" id="8251216">y</span>&nbsp;<span class="op" id="8251218">:=</span>&nbsp;<span class="ident" id="8251221">b0</span><span class="op" id="8251223">.</span><span class="ident" id="8251224">Min</span><span class="op" id="8251227">.</span><span class="ident" id="8251228">Y</span><span class="op" id="8251229">;</span>&nbsp;<span class="ident" id="8251231">y</span>&nbsp;<span class="op" id="8251233">&lt;</span>&nbsp;<span class="ident" id="8251235">b0</span><span class="op" id="8251237">.</span><span class="ident" id="8251238">Max</span><span class="op" id="8251241">.</span><span class="ident" id="8251242">Y</span><span class="op" id="8251243">;</span>&nbsp;<span class="ident" id="8251245">y</span><span class="op" id="8251246">++</span>&nbsp;<span class="op" id="8251249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251253">for</span>&nbsp;<span class="ident" id="8251257">x</span>&nbsp;<span class="op" id="8251259">:=</span>&nbsp;<span class="ident" id="8251262">b0</span><span class="op" id="8251264">.</span><span class="ident" id="8251265">Min</span><span class="op" id="8251268">.</span><span class="ident" id="8251269">X</span><span class="op" id="8251270">;</span>&nbsp;<span class="ident" id="8251272">x</span>&nbsp;<span class="op" id="8251274">&lt;</span>&nbsp;<span class="ident" id="8251276">b0</span><span class="op" id="8251278">.</span><span class="ident" id="8251279">Max</span><span class="op" id="8251282">.</span><span class="ident" id="8251283">X</span><span class="op" id="8251284">;</span>&nbsp;<span class="ident" id="8251286">x</span><span class="op" id="8251287">++</span>&nbsp;<span class="op" id="8251290">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251295">c0</span>&nbsp;<span class="op" id="8251298">:=</span>&nbsp;<span class="ident" id="8251301">m0</span><span class="op" id="8251303">.</span><span class="ident" id="8251304">At</span><span class="op" id="8251306">(</span><span class="ident" id="8251307">x</span><span class="op" id="8251308">,</span>&nbsp;<span class="ident" id="8251310">y</span><span class="op" id="8251311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251316">c1</span>&nbsp;<span class="op" id="8251319">:=</span>&nbsp;<span class="ident" id="8251322">m1</span><span class="op" id="8251324">.</span><span class="ident" id="8251325">At</span><span class="op" id="8251327">(</span><span class="ident" id="8251328">x</span><span class="op" id="8251329">+</span><span class="ident" id="8251330">dx</span><span class="op" id="8251332">,</span>&nbsp;<span class="ident" id="8251334">y</span><span class="op" id="8251335">+</span><span class="ident" id="8251336">dy</span><span class="op" id="8251338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251343">r0</span><span class="op" id="8251345">,</span>&nbsp;<span class="ident" id="8251347">g0</span><span class="op" id="8251349">,</span>&nbsp;<span class="ident" id="8251351">b0</span><span class="op" id="8251353">,</span>&nbsp;<span class="ident" id="8251355">a0</span>&nbsp;<span class="op" id="8251358">:=</span>&nbsp;<span class="ident" id="8251361">c0</span><span class="op" id="8251363">.</span><span class="ident" id="8251364">RGBA</span><span class="op" id="8251368">(</span><span class="op" id="8251369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251374">r1</span><span class="op" id="8251376">,</span>&nbsp;<span class="ident" id="8251378">g1</span><span class="op" id="8251380">,</span>&nbsp;<span class="ident" id="8251382">b1</span><span class="op" id="8251384">,</span>&nbsp;<span class="ident" id="8251386">a1</span>&nbsp;<span class="op" id="8251389">:=</span>&nbsp;<span class="ident" id="8251392">c1</span><span class="op" id="8251394">.</span><span class="ident" id="8251395">RGBA</span><span class="op" id="8251399">(</span><span class="op" id="8251400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251405">if</span>&nbsp;<span class="ident" id="8251408">r0</span>&nbsp;<span class="op" id="8251411">!=</span>&nbsp;<span class="ident" id="8251414">r1</span>&nbsp;<span class="op" id="8251417">||</span>&nbsp;<span class="ident" id="8251420">g0</span>&nbsp;<span class="op" id="8251423">!=</span>&nbsp;<span class="ident" id="8251426">g1</span>&nbsp;<span class="op" id="8251429">||</span>&nbsp;<span class="ident" id="8251432">b0</span>&nbsp;<span class="op" id="8251435">!=</span>&nbsp;<span class="ident" id="8251438">b1</span>&nbsp;<span class="op" id="8251441">||</span>&nbsp;<span class="ident" id="8251444">a0</span>&nbsp;<span class="op" id="8251447">!=</span>&nbsp;<span class="ident" id="8251450">a1</span>&nbsp;<span class="op" id="8251453">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251459">return</span>&nbsp;<span class="ident" id="8251466">fmt</span><span class="op" id="8251469">.</span><span class="ident" id="8251470">Errorf</span><span class="op" id="8251476">(</span><span class="string" id="8251477">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8251514">,</span>&nbsp;<span class="ident" id="8251516">x</span><span class="op" id="8251517">,</span>&nbsp;<span class="ident" id="8251519">y</span><span class="op" id="8251520">,</span>&nbsp;<span class="ident" id="8251522">c0</span><span class="op" id="8251524">,</span>&nbsp;<span class="ident" id="8251526">c1</span><span class="op" id="8251528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251543">return</span>&nbsp;<span class="ident" id="8251550">nil</span><br>
<span class="lineno">35</span><span class="op" id="8251554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8251557">func</span>&nbsp;<span class="ident" id="8251562">encodeDecode</span><span class="op" id="8251574">(</span><span class="ident" id="8251575">m</span>&nbsp;<span class="ident" id="8251577">image</span><span class="op" id="8251582">.</span><span class="ident" id="8251583">Image</span><span class="op" id="8251588">)</span>&nbsp;<span class="op" id="8251590">(</span><span class="ident" id="8251591">image</span><span class="op" id="8251596">.</span><span class="ident" id="8251597">Image</span><span class="op" id="8251602">,</span>&nbsp;<span class="builtintype" id="8251604">error</span><span class="op" id="8251609">)</span>&nbsp;<span class="op" id="8251611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251614">var</span>&nbsp;<span class="ident" id="8251618">b</span>&nbsp;<span class="ident" id="8251620">bytes</span><span class="op" id="8251625">.</span><span class="ident" id="8251626">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251634">err</span>&nbsp;<span class="op" id="8251638">:=</span>&nbsp;<span class="ident" id="8251641">Encode</span><span class="op" id="8251647">(</span><span class="op" id="8251648">&amp;</span><span class="ident" id="8251649">b</span><span class="op" id="8251650">,</span>&nbsp;<span class="ident" id="8251652">m</span><span class="op" id="8251653">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251656">if</span>&nbsp;<span class="ident" id="8251659">err</span>&nbsp;<span class="op" id="8251663">!=</span>&nbsp;<span class="ident" id="8251666">nil</span>&nbsp;<span class="op" id="8251670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251674">return</span>&nbsp;<span class="ident" id="8251681">nil</span><span class="op" id="8251684">,</span>&nbsp;<span class="ident" id="8251686">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251694">return</span>&nbsp;<span class="ident" id="8251701">Decode</span><span class="op" id="8251707">(</span><span class="op" id="8251708">&amp;</span><span class="ident" id="8251709">b</span><span class="op" id="8251710">)</span><br>
<span class="lineno"></span><span class="op" id="8251712">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8251715">func</span>&nbsp;<span class="ident" id="8251720">TestWriter</span><span class="op" id="8251730">(</span><span class="ident" id="8251731">t</span>&nbsp;<span class="op" id="8251733">*</span><span class="ident" id="8251734">testing</span><span class="op" id="8251741">.</span><span class="ident" id="8251742">T</span><span class="op" id="8251743">)</span>&nbsp;<span class="op" id="8251745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8251748">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251806">names</span>&nbsp;<span class="op" id="8251812">:=</span>&nbsp;<span class="ident" id="8251815">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251826">if</span>&nbsp;<span class="ident" id="8251829">testing</span><span class="op" id="8251836">.</span><span class="ident" id="8251837">Short</span><span class="op" id="8251842">(</span><span class="op" id="8251843">)</span>&nbsp;<span class="op" id="8251845">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251849">names</span>&nbsp;<span class="op" id="8251855">=</span>&nbsp;<span class="ident" id="8251857">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251876">for</span>&nbsp;<span class="ident" id="8251880">_</span><span class="op" id="8251881">,</span>&nbsp;<span class="ident" id="8251883">fn</span>&nbsp;<span class="op" id="8251886">:=</span>&nbsp;<span class="keyword" id="8251889">range</span>&nbsp;<span class="ident" id="8251895">names</span>&nbsp;<span class="op" id="8251901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251905">qfn</span>&nbsp;<span class="op" id="8251909">:=</span>&nbsp;<span class="string" id="8251912">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8251933">+</span>&nbsp;<span class="ident" id="8251935">fn</span>&nbsp;<span class="op" id="8251938">+</span>&nbsp;<span class="string" id="8251940">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8251949">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251970">m0</span><span class="op" id="8251972">,</span>&nbsp;<span class="ident" id="8251974">err</span>&nbsp;<span class="op" id="8251978">:=</span>&nbsp;<span class="ident" id="8251981">readPNG</span><span class="op" id="8251988">(</span><span class="ident" id="8251989">qfn</span><span class="op" id="8251992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251996">if</span>&nbsp;<span class="ident" id="8251999">err</span>&nbsp;<span class="op" id="8252003">!=</span>&nbsp;<span class="ident" id="8252006">nil</span>&nbsp;<span class="op" id="8252010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252015">t</span><span class="op" id="8252016">.</span><span class="ident" id="8252017">Error</span><span class="op" id="8252022">(</span><span class="ident" id="8252023">fn</span><span class="op" id="8252025">,</span>&nbsp;<span class="ident" id="8252027">err</span><span class="op" id="8252030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252035">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252046">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8252050">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252103">m1</span><span class="op" id="8252105">,</span>&nbsp;<span class="ident" id="8252107">err</span>&nbsp;<span class="op" id="8252111">:=</span>&nbsp;<span class="ident" id="8252114">readPNG</span><span class="op" id="8252121">(</span><span class="ident" id="8252122">qfn</span><span class="op" id="8252125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252129">if</span>&nbsp;<span class="ident" id="8252132">err</span>&nbsp;<span class="op" id="8252136">!=</span>&nbsp;<span class="ident" id="8252139">nil</span>&nbsp;<span class="op" id="8252143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252148">t</span><span class="op" id="8252149">.</span><span class="ident" id="8252150">Error</span><span class="op" id="8252155">(</span><span class="ident" id="8252156">fn</span><span class="op" id="8252158">,</span>&nbsp;<span class="ident" id="8252160">err</span><span class="op" id="8252163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252168">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252181">m2</span><span class="op" id="8252183">,</span>&nbsp;<span class="ident" id="8252185">err</span>&nbsp;<span class="op" id="8252189">:=</span>&nbsp;<span class="ident" id="8252192">encodeDecode</span><span class="op" id="8252204">(</span><span class="ident" id="8252205">m1</span><span class="op" id="8252207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252211">if</span>&nbsp;<span class="ident" id="8252214">err</span>&nbsp;<span class="op" id="8252218">!=</span>&nbsp;<span class="ident" id="8252221">nil</span>&nbsp;<span class="op" id="8252225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252230">t</span><span class="op" id="8252231">.</span><span class="ident" id="8252232">Error</span><span class="op" id="8252237">(</span><span class="ident" id="8252238">fn</span><span class="op" id="8252240">,</span>&nbsp;<span class="ident" id="8252242">err</span><span class="op" id="8252245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252250">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8252263">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252285">err</span>&nbsp;<span class="op" id="8252289">=</span>&nbsp;<span class="ident" id="8252291">diff</span><span class="op" id="8252295">(</span><span class="ident" id="8252296">m0</span><span class="op" id="8252298">,</span>&nbsp;<span class="ident" id="8252300">m2</span><span class="op" id="8252302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252306">if</span>&nbsp;<span class="ident" id="8252309">err</span>&nbsp;<span class="op" id="8252313">!=</span>&nbsp;<span class="ident" id="8252316">nil</span>&nbsp;<span class="op" id="8252320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252325">t</span><span class="op" id="8252326">.</span><span class="ident" id="8252327">Error</span><span class="op" id="8252332">(</span><span class="ident" id="8252333">fn</span><span class="op" id="8252335">,</span>&nbsp;<span class="ident" id="8252337">err</span><span class="op" id="8252340">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252345">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252359">}</span><br>
<span class="lineno"></span><span class="op" id="8252361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8252364">func</span>&nbsp;<span class="ident" id="8252369">TestWriterLevels</span><span class="op" id="8252385">(</span><span class="ident" id="8252386">t</span>&nbsp;<span class="op" id="8252388">*</span><span class="ident" id="8252389">testing</span><span class="op" id="8252396">.</span><span class="ident" id="8252397">T</span><span class="op" id="8252398">)</span>&nbsp;<span class="op" id="8252400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252403">m</span>&nbsp;<span class="op" id="8252405">:=</span>&nbsp;<span class="ident" id="8252408">image</span><span class="op" id="8252413">.</span><span class="ident" id="8252414">NewNRGBA</span><span class="op" id="8252422">(</span><span class="ident" id="8252423">image</span><span class="op" id="8252428">.</span><span class="ident" id="8252429">Rect</span><span class="op" id="8252433">(</span><span class="num" id="8252434">0</span><span class="op" id="8252435">,</span>&nbsp;<span class="num" id="8252437">0</span><span class="op" id="8252438">,</span>&nbsp;<span class="num" id="8252440">100</span><span class="op" id="8252443">,</span>&nbsp;<span class="num" id="8252445">100</span><span class="op" id="8252448">)</span><span class="op" id="8252449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252453">var</span>&nbsp;<span class="ident" id="8252457">b1</span><span class="op" id="8252459">,</span>&nbsp;<span class="ident" id="8252461">b2</span>&nbsp;<span class="ident" id="8252464">bytes</span><span class="op" id="8252469">.</span><span class="ident" id="8252470">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252478">if</span>&nbsp;<span class="ident" id="8252481">err</span>&nbsp;<span class="op" id="8252485">:=</span>&nbsp;<span class="op" id="8252488">(</span><span class="op" id="8252489">&amp;</span><span class="ident" id="8252490">Encoder</span><span class="op" id="8252497">{</span><span class="op" id="8252498">}</span><span class="op" id="8252499">)</span><span class="op" id="8252500">.</span><span class="ident" id="8252501">Encode</span><span class="op" id="8252507">(</span><span class="op" id="8252508">&amp;</span><span class="ident" id="8252509">b1</span><span class="op" id="8252511">,</span>&nbsp;<span class="ident" id="8252513">m</span><span class="op" id="8252514">)</span><span class="op" id="8252515">;</span>&nbsp;<span class="ident" id="8252517">err</span>&nbsp;<span class="op" id="8252521">!=</span>&nbsp;<span class="ident" id="8252524">nil</span>&nbsp;<span class="op" id="8252528">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252532">t</span><span class="op" id="8252533">.</span><span class="ident" id="8252534">Fatal</span><span class="op" id="8252539">(</span><span class="ident" id="8252540">err</span><span class="op" id="8252543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252549">noenc</span>&nbsp;<span class="op" id="8252555">:=</span>&nbsp;<span class="op" id="8252558">&amp;</span><span class="ident" id="8252559">Encoder</span><span class="op" id="8252566">{</span><span class="ident" id="8252567">CompressionLevel</span><span class="op" id="8252583">:</span>&nbsp;<span class="ident" id="8252585">NoCompression</span><span class="op" id="8252598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252601">if</span>&nbsp;<span class="ident" id="8252604">err</span>&nbsp;<span class="op" id="8252608">:=</span>&nbsp;<span class="ident" id="8252611">noenc</span><span class="op" id="8252616">.</span><span class="ident" id="8252617">Encode</span><span class="op" id="8252623">(</span><span class="op" id="8252624">&amp;</span><span class="ident" id="8252625">b2</span><span class="op" id="8252627">,</span>&nbsp;<span class="ident" id="8252629">m</span><span class="op" id="8252630">)</span><span class="op" id="8252631">;</span>&nbsp;<span class="ident" id="8252633">err</span>&nbsp;<span class="op" id="8252637">!=</span>&nbsp;<span class="ident" id="8252640">nil</span>&nbsp;<span class="op" id="8252644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252648">t</span><span class="op" id="8252649">.</span><span class="ident" id="8252650">Fatal</span><span class="op" id="8252655">(</span><span class="ident" id="8252656">err</span><span class="op" id="8252659">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252666">if</span>&nbsp;<span class="ident" id="8252669">b2</span><span class="op" id="8252671">.</span><span class="ident" id="8252672">Len</span><span class="op" id="8252675">(</span><span class="op" id="8252676">)</span>&nbsp;<span class="op" id="8252678">&lt;=</span>&nbsp;<span class="ident" id="8252681">b1</span><span class="op" id="8252683">.</span><span class="ident" id="8252684">Len</span><span class="op" id="8252687">(</span><span class="op" id="8252688">)</span>&nbsp;<span class="op" id="8252690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252694">t</span><span class="op" id="8252695">.</span><span class="ident" id="8252696">Error</span><span class="op" id="8252701">(</span><span class="string" id="8252702">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="8252770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252773">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252776">if</span>&nbsp;<span class="ident" id="8252779">_</span><span class="op" id="8252780">,</span>&nbsp;<span class="ident" id="8252782">err</span>&nbsp;<span class="op" id="8252786">:=</span>&nbsp;<span class="ident" id="8252789">Decode</span><span class="op" id="8252795">(</span><span class="op" id="8252796">&amp;</span><span class="ident" id="8252797">b1</span><span class="op" id="8252799">)</span><span class="op" id="8252800">;</span>&nbsp;<span class="ident" id="8252802">err</span>&nbsp;<span class="op" id="8252806">!=</span>&nbsp;<span class="ident" id="8252809">nil</span>&nbsp;<span class="op" id="8252813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252817">t</span><span class="op" id="8252818">.</span><span class="ident" id="8252819">Error</span><span class="op" id="8252824">(</span><span class="string" id="8252825">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="8252859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8252865">if</span>&nbsp;<span class="ident" id="8252868">_</span><span class="op" id="8252869">,</span>&nbsp;<span class="ident" id="8252871">err</span>&nbsp;<span class="op" id="8252875">:=</span>&nbsp;<span class="ident" id="8252878">Decode</span><span class="op" id="8252884">(</span><span class="op" id="8252885">&amp;</span><span class="ident" id="8252886">b2</span><span class="op" id="8252888">)</span><span class="op" id="8252889">;</span>&nbsp;<span class="ident" id="8252891">err</span>&nbsp;<span class="op" id="8252895">!=</span>&nbsp;<span class="ident" id="8252898">nil</span>&nbsp;<span class="op" id="8252902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252906">t</span><span class="op" id="8252907">.</span><span class="ident" id="8252908">Error</span><span class="op" id="8252913">(</span><span class="string" id="8252914">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="8252943">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8252946">}</span><br>
<span class="lineno"></span><span class="op" id="8252948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8252951">func</span>&nbsp;<span class="ident" id="8252956">TestSubImage</span><span class="op" id="8252968">(</span><span class="ident" id="8252969">t</span>&nbsp;<span class="op" id="8252971">*</span><span class="ident" id="8252972">testing</span><span class="op" id="8252979">.</span><span class="ident" id="8252980">T</span><span class="op" id="8252981">)</span>&nbsp;<span class="op" id="8252983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8252986">m0</span>&nbsp;<span class="op" id="8252989">:=</span>&nbsp;<span class="ident" id="8252992">image</span><span class="op" id="8252997">.</span><span class="ident" id="8252998">NewRGBA</span><span class="op" id="8253005">(</span><span class="ident" id="8253006">image</span><span class="op" id="8253011">.</span><span class="ident" id="8253012">Rect</span><span class="op" id="8253016">(</span><span class="num" id="8253017">0</span><span class="op" id="8253018">,</span>&nbsp;<span class="num" id="8253020">0</span><span class="op" id="8253021">,</span>&nbsp;<span class="num" id="8253023">256</span><span class="op" id="8253026">,</span>&nbsp;<span class="num" id="8253028">256</span><span class="op" id="8253031">)</span><span class="op" id="8253032">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253035">for</span>&nbsp;<span class="ident" id="8253039">y</span>&nbsp;<span class="op" id="8253041">:=</span>&nbsp;<span class="num" id="8253044">0</span><span class="op" id="8253045">;</span>&nbsp;<span class="ident" id="8253047">y</span>&nbsp;<span class="op" id="8253049">&lt;</span>&nbsp;<span class="num" id="8253051">256</span><span class="op" id="8253054">;</span>&nbsp;<span class="ident" id="8253056">y</span><span class="op" id="8253057">++</span>&nbsp;<span class="op" id="8253060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253064">for</span>&nbsp;<span class="ident" id="8253068">x</span>&nbsp;<span class="op" id="8253070">:=</span>&nbsp;<span class="num" id="8253073">0</span><span class="op" id="8253074">;</span>&nbsp;<span class="ident" id="8253076">x</span>&nbsp;<span class="op" id="8253078">&lt;</span>&nbsp;<span class="num" id="8253080">256</span><span class="op" id="8253083">;</span>&nbsp;<span class="ident" id="8253085">x</span><span class="op" id="8253086">++</span>&nbsp;<span class="op" id="8253089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253094">m0</span><span class="op" id="8253096">.</span><span class="ident" id="8253097">Set</span><span class="op" id="8253100">(</span><span class="ident" id="8253101">x</span><span class="op" id="8253102">,</span>&nbsp;<span class="ident" id="8253104">y</span><span class="op" id="8253105">,</span>&nbsp;<span class="ident" id="8253107">color</span><span class="op" id="8253112">.</span><span class="ident" id="8253113">RGBA</span><span class="op" id="8253117">{</span><span class="builtintype" id="8253118">uint8</span><span class="op" id="8253123">(</span><span class="ident" id="8253124">x</span><span class="op" id="8253125">)</span><span class="op" id="8253126">,</span>&nbsp;<span class="builtintype" id="8253128">uint8</span><span class="op" id="8253133">(</span><span class="ident" id="8253134">y</span><span class="op" id="8253135">)</span><span class="op" id="8253136">,</span>&nbsp;<span class="num" id="8253138">0</span><span class="op" id="8253139">,</span>&nbsp;<span class="num" id="8253141">255</span><span class="op" id="8253144">}</span><span class="op" id="8253145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253152">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253155">m0</span>&nbsp;<span class="op" id="8253158">=</span>&nbsp;<span class="ident" id="8253160">m0</span><span class="op" id="8253162">.</span><span class="ident" id="8253163">SubImage</span><span class="op" id="8253171">(</span><span class="ident" id="8253172">image</span><span class="op" id="8253177">.</span><span class="ident" id="8253178">Rect</span><span class="op" id="8253182">(</span><span class="num" id="8253183">50</span><span class="op" id="8253185">,</span>&nbsp;<span class="num" id="8253187">30</span><span class="op" id="8253189">,</span>&nbsp;<span class="num" id="8253191">250</span><span class="op" id="8253194">,</span>&nbsp;<span class="num" id="8253196">130</span><span class="op" id="8253199">)</span><span class="op" id="8253200">)</span><span class="op" id="8253201">.</span><span class="op" id="8253202">(</span><span class="op" id="8253203">*</span><span class="ident" id="8253204">image</span><span class="op" id="8253209">.</span><span class="ident" id="8253210">RGBA</span><span class="op" id="8253214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253217">m1</span><span class="op" id="8253219">,</span>&nbsp;<span class="ident" id="8253221">err</span>&nbsp;<span class="op" id="8253225">:=</span>&nbsp;<span class="ident" id="8253228">encodeDecode</span><span class="op" id="8253240">(</span><span class="ident" id="8253241">m0</span><span class="op" id="8253243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253246">if</span>&nbsp;<span class="ident" id="8253249">err</span>&nbsp;<span class="op" id="8253253">!=</span>&nbsp;<span class="ident" id="8253256">nil</span>&nbsp;<span class="op" id="8253260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253264">t</span><span class="op" id="8253265">.</span><span class="ident" id="8253266">Error</span><span class="op" id="8253271">(</span><span class="ident" id="8253272">err</span><span class="op" id="8253275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253279">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253290">err</span>&nbsp;<span class="op" id="8253294">=</span>&nbsp;<span class="ident" id="8253296">diff</span><span class="op" id="8253300">(</span><span class="ident" id="8253301">m0</span><span class="op" id="8253303">,</span>&nbsp;<span class="ident" id="8253305">m1</span><span class="op" id="8253307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253310">if</span>&nbsp;<span class="ident" id="8253313">err</span>&nbsp;<span class="op" id="8253317">!=</span>&nbsp;<span class="ident" id="8253320">nil</span>&nbsp;<span class="op" id="8253324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253328">t</span><span class="op" id="8253329">.</span><span class="ident" id="8253330">Error</span><span class="op" id="8253335">(</span><span class="ident" id="8253336">err</span><span class="op" id="8253339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253343">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253351">}</span><br>
<span class="lineno"></span><span class="op" id="8253353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253356">func</span>&nbsp;<span class="ident" id="8253361">BenchmarkEncodeGray</span><span class="op" id="8253380">(</span><span class="ident" id="8253381">b</span>&nbsp;<span class="op" id="8253383">*</span><span class="ident" id="8253384">testing</span><span class="op" id="8253391">.</span><span class="ident" id="8253392">B</span><span class="op" id="8253393">)</span>&nbsp;<span class="op" id="8253395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253398">b</span><span class="op" id="8253399">.</span><span class="ident" id="8253400">StopTimer</span><span class="op" id="8253409">(</span><span class="op" id="8253410">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253413">img</span>&nbsp;<span class="op" id="8253417">:=</span>&nbsp;<span class="ident" id="8253420">image</span><span class="op" id="8253425">.</span><span class="ident" id="8253426">NewGray</span><span class="op" id="8253433">(</span><span class="ident" id="8253434">image</span><span class="op" id="8253439">.</span><span class="ident" id="8253440">Rect</span><span class="op" id="8253444">(</span><span class="num" id="8253445">0</span><span class="op" id="8253446">,</span>&nbsp;<span class="num" id="8253448">0</span><span class="op" id="8253449">,</span>&nbsp;<span class="num" id="8253451">640</span><span class="op" id="8253454">,</span>&nbsp;<span class="num" id="8253456">480</span><span class="op" id="8253459">)</span><span class="op" id="8253460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253463">b</span><span class="op" id="8253464">.</span><span class="ident" id="8253465">SetBytes</span><span class="op" id="8253473">(</span><span class="num" id="8253474">640</span>&nbsp;<span class="op" id="8253478">*</span>&nbsp;<span class="num" id="8253480">480</span>&nbsp;<span class="op" id="8253484">*</span>&nbsp;<span class="num" id="8253486">1</span><span class="op" id="8253487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253490">b</span><span class="op" id="8253491">.</span><span class="ident" id="8253492">StartTimer</span><span class="op" id="8253502">(</span><span class="op" id="8253503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253506">for</span>&nbsp;<span class="ident" id="8253510">i</span>&nbsp;<span class="op" id="8253512">:=</span>&nbsp;<span class="num" id="8253515">0</span><span class="op" id="8253516">;</span>&nbsp;<span class="ident" id="8253518">i</span>&nbsp;<span class="op" id="8253520">&lt;</span>&nbsp;<span class="ident" id="8253522">b</span><span class="op" id="8253523">.</span><span class="ident" id="8253524">N</span><span class="op" id="8253525">;</span>&nbsp;<span class="ident" id="8253527">i</span><span class="op" id="8253528">++</span>&nbsp;<span class="op" id="8253531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253535">Encode</span><span class="op" id="8253541">(</span><span class="ident" id="8253542">ioutil</span><span class="op" id="8253548">.</span><span class="ident" id="8253549">Discard</span><span class="op" id="8253556">,</span>&nbsp;<span class="ident" id="8253558">img</span><span class="op" id="8253561">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253564">}</span><br>
<span class="lineno"></span><span class="op" id="8253566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253569">func</span>&nbsp;<span class="ident" id="8253574">BenchmarkEncodeNRGBOpaque</span><span class="op" id="8253599">(</span><span class="ident" id="8253600">b</span>&nbsp;<span class="op" id="8253602">*</span><span class="ident" id="8253603">testing</span><span class="op" id="8253610">.</span><span class="ident" id="8253611">B</span><span class="op" id="8253612">)</span>&nbsp;<span class="op" id="8253614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253617">b</span><span class="op" id="8253618">.</span><span class="ident" id="8253619">StopTimer</span><span class="op" id="8253628">(</span><span class="op" id="8253629">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253632">img</span>&nbsp;<span class="op" id="8253636">:=</span>&nbsp;<span class="ident" id="8253639">image</span><span class="op" id="8253644">.</span><span class="ident" id="8253645">NewNRGBA</span><span class="op" id="8253653">(</span><span class="ident" id="8253654">image</span><span class="op" id="8253659">.</span><span class="ident" id="8253660">Rect</span><span class="op" id="8253664">(</span><span class="num" id="8253665">0</span><span class="op" id="8253666">,</span>&nbsp;<span class="num" id="8253668">0</span><span class="op" id="8253669">,</span>&nbsp;<span class="num" id="8253671">640</span><span class="op" id="8253674">,</span>&nbsp;<span class="num" id="8253676">480</span><span class="op" id="8253679">)</span><span class="op" id="8253680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8253683">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253738">bo</span>&nbsp;<span class="op" id="8253741">:=</span>&nbsp;<span class="ident" id="8253744">img</span><span class="op" id="8253747">.</span><span class="ident" id="8253748">Bounds</span><span class="op" id="8253754">(</span><span class="op" id="8253755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253758">for</span>&nbsp;<span class="ident" id="8253762">y</span>&nbsp;<span class="op" id="8253764">:=</span>&nbsp;<span class="ident" id="8253767">bo</span><span class="op" id="8253769">.</span><span class="ident" id="8253770">Min</span><span class="op" id="8253773">.</span><span class="ident" id="8253774">Y</span><span class="op" id="8253775">;</span>&nbsp;<span class="ident" id="8253777">y</span>&nbsp;<span class="op" id="8253779">&lt;</span>&nbsp;<span class="ident" id="8253781">bo</span><span class="op" id="8253783">.</span><span class="ident" id="8253784">Max</span><span class="op" id="8253787">.</span><span class="ident" id="8253788">Y</span><span class="op" id="8253789">;</span>&nbsp;<span class="ident" id="8253791">y</span><span class="op" id="8253792">++</span>&nbsp;<span class="op" id="8253795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253799">for</span>&nbsp;<span class="ident" id="8253803">x</span>&nbsp;<span class="op" id="8253805">:=</span>&nbsp;<span class="ident" id="8253808">bo</span><span class="op" id="8253810">.</span><span class="ident" id="8253811">Min</span><span class="op" id="8253814">.</span><span class="ident" id="8253815">X</span><span class="op" id="8253816">;</span>&nbsp;<span class="ident" id="8253818">x</span>&nbsp;<span class="op" id="8253820">&lt;</span>&nbsp;<span class="ident" id="8253822">bo</span><span class="op" id="8253824">.</span><span class="ident" id="8253825">Max</span><span class="op" id="8253828">.</span><span class="ident" id="8253829">X</span><span class="op" id="8253830">;</span>&nbsp;<span class="ident" id="8253832">x</span><span class="op" id="8253833">++</span>&nbsp;<span class="op" id="8253836">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253841">img</span><span class="op" id="8253844">.</span><span class="ident" id="8253845">Set</span><span class="op" id="8253848">(</span><span class="ident" id="8253849">x</span><span class="op" id="8253850">,</span>&nbsp;<span class="ident" id="8253852">y</span><span class="op" id="8253853">,</span>&nbsp;<span class="ident" id="8253855">color</span><span class="op" id="8253860">.</span><span class="ident" id="8253861">NRGBA</span><span class="op" id="8253866">{</span><span class="num" id="8253867">0</span><span class="op" id="8253868">,</span>&nbsp;<span class="num" id="8253870">0</span><span class="op" id="8253871">,</span>&nbsp;<span class="num" id="8253873">0</span><span class="op" id="8253874">,</span>&nbsp;<span class="num" id="8253876">255</span><span class="op" id="8253879">}</span><span class="op" id="8253880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253890">if</span>&nbsp;<span class="op" id="8253893">!</span><span class="ident" id="8253894">img</span><span class="op" id="8253897">.</span><span class="ident" id="8253898">Opaque</span><span class="op" id="8253904">(</span><span class="op" id="8253905">)</span>&nbsp;<span class="op" id="8253907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253911">b</span><span class="op" id="8253912">.</span><span class="ident" id="8253913">Fatal</span><span class="op" id="8253918">(</span><span class="string" id="8253919">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8253948">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8253951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253954">b</span><span class="op" id="8253955">.</span><span class="ident" id="8253956">SetBytes</span><span class="op" id="8253964">(</span><span class="num" id="8253965">640</span>&nbsp;<span class="op" id="8253969">*</span>&nbsp;<span class="num" id="8253971">480</span>&nbsp;<span class="op" id="8253975">*</span>&nbsp;<span class="num" id="8253977">4</span><span class="op" id="8253978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8253981">b</span><span class="op" id="8253982">.</span><span class="ident" id="8253983">StartTimer</span><span class="op" id="8253993">(</span><span class="op" id="8253994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8253997">for</span>&nbsp;<span class="ident" id="8254001">i</span>&nbsp;<span class="op" id="8254003">:=</span>&nbsp;<span class="num" id="8254006">0</span><span class="op" id="8254007">;</span>&nbsp;<span class="ident" id="8254009">i</span>&nbsp;<span class="op" id="8254011">&lt;</span>&nbsp;<span class="ident" id="8254013">b</span><span class="op" id="8254014">.</span><span class="ident" id="8254015">N</span><span class="op" id="8254016">;</span>&nbsp;<span class="ident" id="8254018">i</span><span class="op" id="8254019">++</span>&nbsp;<span class="op" id="8254022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254026">Encode</span><span class="op" id="8254032">(</span><span class="ident" id="8254033">ioutil</span><span class="op" id="8254039">.</span><span class="ident" id="8254040">Discard</span><span class="op" id="8254047">,</span>&nbsp;<span class="ident" id="8254049">img</span><span class="op" id="8254052">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254055">}</span><br>
<span class="lineno"></span><span class="op" id="8254057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8254060">func</span>&nbsp;<span class="ident" id="8254065">BenchmarkEncodeNRGBA</span><span class="op" id="8254085">(</span><span class="ident" id="8254086">b</span>&nbsp;<span class="op" id="8254088">*</span><span class="ident" id="8254089">testing</span><span class="op" id="8254096">.</span><span class="ident" id="8254097">B</span><span class="op" id="8254098">)</span>&nbsp;<span class="op" id="8254100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254103">b</span><span class="op" id="8254104">.</span><span class="ident" id="8254105">StopTimer</span><span class="op" id="8254114">(</span><span class="op" id="8254115">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254118">img</span>&nbsp;<span class="op" id="8254122">:=</span>&nbsp;<span class="ident" id="8254125">image</span><span class="op" id="8254130">.</span><span class="ident" id="8254131">NewNRGBA</span><span class="op" id="8254139">(</span><span class="ident" id="8254140">image</span><span class="op" id="8254145">.</span><span class="ident" id="8254146">Rect</span><span class="op" id="8254150">(</span><span class="num" id="8254151">0</span><span class="op" id="8254152">,</span>&nbsp;<span class="num" id="8254154">0</span><span class="op" id="8254155">,</span>&nbsp;<span class="num" id="8254157">640</span><span class="op" id="8254160">,</span>&nbsp;<span class="num" id="8254162">480</span><span class="op" id="8254165">)</span><span class="op" id="8254166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254169">if</span>&nbsp;<span class="ident" id="8254172">img</span><span class="op" id="8254175">.</span><span class="ident" id="8254176">Opaque</span><span class="op" id="8254182">(</span><span class="op" id="8254183">)</span>&nbsp;<span class="op" id="8254185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254189">b</span><span class="op" id="8254190">.</span><span class="ident" id="8254191">Fatal</span><span class="op" id="8254196">(</span><span class="string" id="8254197">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8254230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254236">b</span><span class="op" id="8254237">.</span><span class="ident" id="8254238">SetBytes</span><span class="op" id="8254246">(</span><span class="num" id="8254247">640</span>&nbsp;<span class="op" id="8254251">*</span>&nbsp;<span class="num" id="8254253">480</span>&nbsp;<span class="op" id="8254257">*</span>&nbsp;<span class="num" id="8254259">4</span><span class="op" id="8254260">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254263">b</span><span class="op" id="8254264">.</span><span class="ident" id="8254265">StartTimer</span><span class="op" id="8254275">(</span><span class="op" id="8254276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254279">for</span>&nbsp;<span class="ident" id="8254283">i</span>&nbsp;<span class="op" id="8254285">:=</span>&nbsp;<span class="num" id="8254288">0</span><span class="op" id="8254289">;</span>&nbsp;<span class="ident" id="8254291">i</span>&nbsp;<span class="op" id="8254293">&lt;</span>&nbsp;<span class="ident" id="8254295">b</span><span class="op" id="8254296">.</span><span class="ident" id="8254297">N</span><span class="op" id="8254298">;</span>&nbsp;<span class="ident" id="8254300">i</span><span class="op" id="8254301">++</span>&nbsp;<span class="op" id="8254304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254308">Encode</span><span class="op" id="8254314">(</span><span class="ident" id="8254315">ioutil</span><span class="op" id="8254321">.</span><span class="ident" id="8254322">Discard</span><span class="op" id="8254329">,</span>&nbsp;<span class="ident" id="8254331">img</span><span class="op" id="8254334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254337">}</span><br>
<span class="lineno"></span><span class="op" id="8254339">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="8254342">func</span>&nbsp;<span class="ident" id="8254347">BenchmarkEncodePaletted</span><span class="op" id="8254370">(</span><span class="ident" id="8254371">b</span>&nbsp;<span class="op" id="8254373">*</span><span class="ident" id="8254374">testing</span><span class="op" id="8254381">.</span><span class="ident" id="8254382">B</span><span class="op" id="8254383">)</span>&nbsp;<span class="op" id="8254385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254388">b</span><span class="op" id="8254389">.</span><span class="ident" id="8254390">StopTimer</span><span class="op" id="8254399">(</span><span class="op" id="8254400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254403">img</span>&nbsp;<span class="op" id="8254407">:=</span>&nbsp;<span class="ident" id="8254410">image</span><span class="op" id="8254415">.</span><span class="ident" id="8254416">NewPaletted</span><span class="op" id="8254427">(</span><span class="ident" id="8254428">image</span><span class="op" id="8254433">.</span><span class="ident" id="8254434">Rect</span><span class="op" id="8254438">(</span><span class="num" id="8254439">0</span><span class="op" id="8254440">,</span>&nbsp;<span class="num" id="8254442">0</span><span class="op" id="8254443">,</span>&nbsp;<span class="num" id="8254445">640</span><span class="op" id="8254448">,</span>&nbsp;<span class="num" id="8254450">480</span><span class="op" id="8254453">)</span><span class="op" id="8254454">,</span>&nbsp;<span class="ident" id="8254456">color</span><span class="op" id="8254461">.</span><span class="ident" id="8254462">Palette</span><span class="op" id="8254469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254473">color</span><span class="op" id="8254478">.</span><span class="ident" id="8254479">RGBA</span><span class="op" id="8254483">{</span><span class="num" id="8254484">0</span><span class="op" id="8254485">,</span>&nbsp;<span class="num" id="8254487">0</span><span class="op" id="8254488">,</span>&nbsp;<span class="num" id="8254490">0</span><span class="op" id="8254491">,</span>&nbsp;<span class="num" id="8254493">255</span><span class="op" id="8254496">}</span><span class="op" id="8254497">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254501">color</span><span class="op" id="8254506">.</span><span class="ident" id="8254507">RGBA</span><span class="op" id="8254511">{</span><span class="num" id="8254512">255</span><span class="op" id="8254515">,</span>&nbsp;<span class="num" id="8254517">255</span><span class="op" id="8254520">,</span>&nbsp;<span class="num" id="8254522">255</span><span class="op" id="8254525">,</span>&nbsp;<span class="num" id="8254527">255</span><span class="op" id="8254530">}</span><span class="op" id="8254531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254534">}</span><span class="op" id="8254535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254538">b</span><span class="op" id="8254539">.</span><span class="ident" id="8254540">SetBytes</span><span class="op" id="8254548">(</span><span class="num" id="8254549">640</span>&nbsp;<span class="op" id="8254553">*</span>&nbsp;<span class="num" id="8254555">480</span>&nbsp;<span class="op" id="8254559">*</span>&nbsp;<span class="num" id="8254561">1</span><span class="op" id="8254562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254565">b</span><span class="op" id="8254566">.</span><span class="ident" id="8254567">StartTimer</span><span class="op" id="8254577">(</span><span class="op" id="8254578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254581">for</span>&nbsp;<span class="ident" id="8254585">i</span>&nbsp;<span class="op" id="8254587">:=</span>&nbsp;<span class="num" id="8254590">0</span><span class="op" id="8254591">;</span>&nbsp;<span class="ident" id="8254593">i</span>&nbsp;<span class="op" id="8254595">&lt;</span>&nbsp;<span class="ident" id="8254597">b</span><span class="op" id="8254598">.</span><span class="ident" id="8254599">N</span><span class="op" id="8254600">;</span>&nbsp;<span class="ident" id="8254602">i</span><span class="op" id="8254603">++</span>&nbsp;<span class="op" id="8254606">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254610">Encode</span><span class="op" id="8254616">(</span><span class="ident" id="8254617">ioutil</span><span class="op" id="8254623">.</span><span class="ident" id="8254624">Discard</span><span class="op" id="8254631">,</span>&nbsp;<span class="ident" id="8254633">img</span><span class="op" id="8254636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254639">}</span><br>
<span class="lineno"></span><span class="op" id="8254641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8254644">func</span>&nbsp;<span class="ident" id="8254649">BenchmarkEncodeRGBOpaque</span><span class="op" id="8254673">(</span><span class="ident" id="8254674">b</span>&nbsp;<span class="op" id="8254676">*</span><span class="ident" id="8254677">testing</span><span class="op" id="8254684">.</span><span class="ident" id="8254685">B</span><span class="op" id="8254686">)</span>&nbsp;<span class="op" id="8254688">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254691">b</span><span class="op" id="8254692">.</span><span class="ident" id="8254693">StopTimer</span><span class="op" id="8254702">(</span><span class="op" id="8254703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254706">img</span>&nbsp;<span class="op" id="8254710">:=</span>&nbsp;<span class="ident" id="8254713">image</span><span class="op" id="8254718">.</span><span class="ident" id="8254719">NewRGBA</span><span class="op" id="8254726">(</span><span class="ident" id="8254727">image</span><span class="op" id="8254732">.</span><span class="ident" id="8254733">Rect</span><span class="op" id="8254737">(</span><span class="num" id="8254738">0</span><span class="op" id="8254739">,</span>&nbsp;<span class="num" id="8254741">0</span><span class="op" id="8254742">,</span>&nbsp;<span class="num" id="8254744">640</span><span class="op" id="8254747">,</span>&nbsp;<span class="num" id="8254749">480</span><span class="op" id="8254752">)</span><span class="op" id="8254753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8254756">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254811">bo</span>&nbsp;<span class="op" id="8254814">:=</span>&nbsp;<span class="ident" id="8254817">img</span><span class="op" id="8254820">.</span><span class="ident" id="8254821">Bounds</span><span class="op" id="8254827">(</span><span class="op" id="8254828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254831">for</span>&nbsp;<span class="ident" id="8254835">y</span>&nbsp;<span class="op" id="8254837">:=</span>&nbsp;<span class="ident" id="8254840">bo</span><span class="op" id="8254842">.</span><span class="ident" id="8254843">Min</span><span class="op" id="8254846">.</span><span class="ident" id="8254847">Y</span><span class="op" id="8254848">;</span>&nbsp;<span class="ident" id="8254850">y</span>&nbsp;<span class="op" id="8254852">&lt;</span>&nbsp;<span class="ident" id="8254854">bo</span><span class="op" id="8254856">.</span><span class="ident" id="8254857">Max</span><span class="op" id="8254860">.</span><span class="ident" id="8254861">Y</span><span class="op" id="8254862">;</span>&nbsp;<span class="ident" id="8254864">y</span><span class="op" id="8254865">++</span>&nbsp;<span class="op" id="8254868">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254872">for</span>&nbsp;<span class="ident" id="8254876">x</span>&nbsp;<span class="op" id="8254878">:=</span>&nbsp;<span class="ident" id="8254881">bo</span><span class="op" id="8254883">.</span><span class="ident" id="8254884">Min</span><span class="op" id="8254887">.</span><span class="ident" id="8254888">X</span><span class="op" id="8254889">;</span>&nbsp;<span class="ident" id="8254891">x</span>&nbsp;<span class="op" id="8254893">&lt;</span>&nbsp;<span class="ident" id="8254895">bo</span><span class="op" id="8254897">.</span><span class="ident" id="8254898">Max</span><span class="op" id="8254901">.</span><span class="ident" id="8254902">X</span><span class="op" id="8254903">;</span>&nbsp;<span class="ident" id="8254905">x</span><span class="op" id="8254906">++</span>&nbsp;<span class="op" id="8254909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254914">img</span><span class="op" id="8254917">.</span><span class="ident" id="8254918">Set</span><span class="op" id="8254921">(</span><span class="ident" id="8254922">x</span><span class="op" id="8254923">,</span>&nbsp;<span class="ident" id="8254925">y</span><span class="op" id="8254926">,</span>&nbsp;<span class="ident" id="8254928">color</span><span class="op" id="8254933">.</span><span class="ident" id="8254934">RGBA</span><span class="op" id="8254938">{</span><span class="num" id="8254939">0</span><span class="op" id="8254940">,</span>&nbsp;<span class="num" id="8254942">0</span><span class="op" id="8254943">,</span>&nbsp;<span class="num" id="8254945">0</span><span class="op" id="8254946">,</span>&nbsp;<span class="num" id="8254948">255</span><span class="op" id="8254951">}</span><span class="op" id="8254952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8254962">if</span>&nbsp;<span class="op" id="8254965">!</span><span class="ident" id="8254966">img</span><span class="op" id="8254969">.</span><span class="ident" id="8254970">Opaque</span><span class="op" id="8254976">(</span><span class="op" id="8254977">)</span>&nbsp;<span class="op" id="8254979">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254983">b</span><span class="op" id="8254984">.</span><span class="ident" id="8254985">Fatal</span><span class="op" id="8254990">(</span><span class="string" id="8254991">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8255020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255026">b</span><span class="op" id="8255027">.</span><span class="ident" id="8255028">SetBytes</span><span class="op" id="8255036">(</span><span class="num" id="8255037">640</span>&nbsp;<span class="op" id="8255041">*</span>&nbsp;<span class="num" id="8255043">480</span>&nbsp;<span class="op" id="8255047">*</span>&nbsp;<span class="num" id="8255049">4</span><span class="op" id="8255050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255053">b</span><span class="op" id="8255054">.</span><span class="ident" id="8255055">StartTimer</span><span class="op" id="8255065">(</span><span class="op" id="8255066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255069">for</span>&nbsp;<span class="ident" id="8255073">i</span>&nbsp;<span class="op" id="8255075">:=</span>&nbsp;<span class="num" id="8255078">0</span><span class="op" id="8255079">;</span>&nbsp;<span class="ident" id="8255081">i</span>&nbsp;<span class="op" id="8255083">&lt;</span>&nbsp;<span class="ident" id="8255085">b</span><span class="op" id="8255086">.</span><span class="ident" id="8255087">N</span><span class="op" id="8255088">;</span>&nbsp;<span class="ident" id="8255090">i</span><span class="op" id="8255091">++</span>&nbsp;<span class="op" id="8255094">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255098">Encode</span><span class="op" id="8255104">(</span><span class="ident" id="8255105">ioutil</span><span class="op" id="8255111">.</span><span class="ident" id="8255112">Discard</span><span class="op" id="8255119">,</span>&nbsp;<span class="ident" id="8255121">img</span><span class="op" id="8255124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255127">}</span><br>
<span class="lineno"></span><span class="op" id="8255129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8255132">func</span>&nbsp;<span class="ident" id="8255137">BenchmarkEncodeRGBA</span><span class="op" id="8255156">(</span><span class="ident" id="8255157">b</span>&nbsp;<span class="op" id="8255159">*</span><span class="ident" id="8255160">testing</span><span class="op" id="8255167">.</span><span class="ident" id="8255168">B</span><span class="op" id="8255169">)</span>&nbsp;<span class="op" id="8255171">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255174">b</span><span class="op" id="8255175">.</span><span class="ident" id="8255176">StopTimer</span><span class="op" id="8255185">(</span><span class="op" id="8255186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255189">img</span>&nbsp;<span class="op" id="8255193">:=</span>&nbsp;<span class="ident" id="8255196">image</span><span class="op" id="8255201">.</span><span class="ident" id="8255202">NewRGBA</span><span class="op" id="8255209">(</span><span class="ident" id="8255210">image</span><span class="op" id="8255215">.</span><span class="ident" id="8255216">Rect</span><span class="op" id="8255220">(</span><span class="num" id="8255221">0</span><span class="op" id="8255222">,</span>&nbsp;<span class="num" id="8255224">0</span><span class="op" id="8255225">,</span>&nbsp;<span class="num" id="8255227">640</span><span class="op" id="8255230">,</span>&nbsp;<span class="num" id="8255232">480</span><span class="op" id="8255235">)</span><span class="op" id="8255236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255239">if</span>&nbsp;<span class="ident" id="8255242">img</span><span class="op" id="8255245">.</span><span class="ident" id="8255246">Opaque</span><span class="op" id="8255252">(</span><span class="op" id="8255253">)</span>&nbsp;<span class="op" id="8255255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255259">b</span><span class="op" id="8255260">.</span><span class="ident" id="8255261">Fatal</span><span class="op" id="8255266">(</span><span class="string" id="8255267">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8255300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255303">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255306">b</span><span class="op" id="8255307">.</span><span class="ident" id="8255308">SetBytes</span><span class="op" id="8255316">(</span><span class="num" id="8255317">640</span>&nbsp;<span class="op" id="8255321">*</span>&nbsp;<span class="num" id="8255323">480</span>&nbsp;<span class="op" id="8255327">*</span>&nbsp;<span class="num" id="8255329">4</span><span class="op" id="8255330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255333">b</span><span class="op" id="8255334">.</span><span class="ident" id="8255335">StartTimer</span><span class="op" id="8255345">(</span><span class="op" id="8255346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255349">for</span>&nbsp;<span class="ident" id="8255353">i</span>&nbsp;<span class="op" id="8255355">:=</span>&nbsp;<span class="num" id="8255358">0</span><span class="op" id="8255359">;</span>&nbsp;<span class="ident" id="8255361">i</span>&nbsp;<span class="op" id="8255363">&lt;</span>&nbsp;<span class="ident" id="8255365">b</span><span class="op" id="8255366">.</span><span class="ident" id="8255367">N</span><span class="op" id="8255368">;</span>&nbsp;<span class="ident" id="8255370">i</span><span class="op" id="8255371">++</span>&nbsp;<span class="op" id="8255374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255378">Encode</span><span class="op" id="8255384">(</span><span class="ident" id="8255385">ioutil</span><span class="op" id="8255391">.</span><span class="ident" id="8255392">Discard</span><span class="op" id="8255399">,</span>&nbsp;<span class="ident" id="8255401">img</span><span class="op" id="8255404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255407">}</span><br>
<span class="lineno">210</span><span class="op" id="8255409">}</span>
</div>
</body>
</html>
