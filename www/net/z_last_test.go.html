<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7597582">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7597637">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7597691">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7597742">package</span>&nbsp;<span class="ident" id="7597750">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7597755">import</span>&nbsp;<span class="op" id="7597762">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7597765">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7597773">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7597780">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7597791">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7597798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7597801">var</span>&nbsp;<span class="ident" id="7597805">testDNSFlood</span>&nbsp;<span class="op" id="7597818">=</span>&nbsp;<span class="ident" id="7597820">flag</span><span class="op" id="7597824">.</span><span class="ident" id="7597825">Bool</span><span class="op" id="7597829">(</span><span class="string" id="7597830">&#34;dnsflood&#34;</span><span class="op" id="7597840">,</span>&nbsp;<span class="ident" id="7597842">false</span><span class="op" id="7597847">,</span>&nbsp;<span class="string" id="7597849">&#34;whether&nbsp;to&nbsp;test&nbsp;dns&nbsp;query&nbsp;flooding&#34;</span><span class="op" id="7597885">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7597888">func</span>&nbsp;<span class="ident" id="7597893">TestDNSThreadLimit</span><span class="op" id="7597911">(</span><span class="ident" id="7597912">t</span>&nbsp;<span class="op" id="7597914">*</span><span class="ident" id="7597915">testing</span><span class="op" id="7597922">.</span><span class="ident" id="7597923">T</span><span class="op" id="7597924">)</span>&nbsp;<span class="op" id="7597926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7597929">if</span>&nbsp;<span class="op" id="7597932">!</span><span class="op" id="7597933">*</span><span class="ident" id="7597934">testDNSFlood</span>&nbsp;<span class="op" id="7597947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7597951">t</span><span class="op" id="7597952">.</span><span class="ident" id="7597953">Skip</span><span class="op" id="7597957">(</span><span class="string" id="7597958">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7597998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598001">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598005">const</span>&nbsp;<span class="ident" id="7598011">N</span>&nbsp;<span class="op" id="7598013">=</span>&nbsp;<span class="num" id="7598015">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598022">c</span>&nbsp;<span class="op" id="7598024">:=</span>&nbsp;<span class="builtinfunc" id="7598027">make</span><span class="op" id="7598031">(</span><span class="keyword" id="7598032">chan</span>&nbsp;<span class="builtintype" id="7598037">int</span><span class="op" id="7598040">,</span>&nbsp;<span class="ident" id="7598042">N</span><span class="op" id="7598043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598046">for</span>&nbsp;<span class="ident" id="7598050">i</span>&nbsp;<span class="op" id="7598052">:=</span>&nbsp;<span class="num" id="7598055">0</span><span class="op" id="7598056">;</span>&nbsp;<span class="ident" id="7598058">i</span>&nbsp;<span class="op" id="7598060">&lt;</span>&nbsp;<span class="ident" id="7598062">N</span><span class="op" id="7598063">;</span>&nbsp;<span class="ident" id="7598065">i</span><span class="op" id="7598066">++</span>&nbsp;<span class="op" id="7598069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598073">go</span>&nbsp;<span class="keyword" id="7598076">func</span><span class="op" id="7598080">(</span><span class="ident" id="7598081">i</span>&nbsp;<span class="builtintype" id="7598083">int</span><span class="op" id="7598086">)</span>&nbsp;<span class="op" id="7598088">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598093">LookupIP</span><span class="op" id="7598101">(</span><span class="ident" id="7598102">fmt</span><span class="op" id="7598105">.</span><span class="ident" id="7598106">Sprintf</span><span class="op" id="7598113">(</span><span class="string" id="7598114">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="7598138">,</span>&nbsp;<span class="ident" id="7598140">i</span><span class="op" id="7598141">)</span><span class="op" id="7598142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598147">c</span>&nbsp;<span class="op" id="7598149">&lt;-</span>&nbsp;<span class="num" id="7598152">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598156">}</span><span class="op" id="7598157">(</span><span class="ident" id="7598158">i</span><span class="op" id="7598159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7598165">//&nbsp;Don&#39;t&nbsp;bother&nbsp;waiting&nbsp;for&nbsp;the&nbsp;stragglers;&nbsp;stop&nbsp;at&nbsp;0.9&nbsp;N.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598225">for</span>&nbsp;<span class="ident" id="7598229">i</span>&nbsp;<span class="op" id="7598231">:=</span>&nbsp;<span class="num" id="7598234">0</span><span class="op" id="7598235">;</span>&nbsp;<span class="ident" id="7598237">i</span>&nbsp;<span class="op" id="7598239">&lt;</span>&nbsp;<span class="ident" id="7598241">N</span><span class="op" id="7598242">*</span><span class="num" id="7598243">9</span><span class="op" id="7598244">/</span><span class="num" id="7598245">10</span><span class="op" id="7598247">;</span>&nbsp;<span class="ident" id="7598249">i</span><span class="op" id="7598250">++</span>&nbsp;<span class="op" id="7598253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598257">if</span>&nbsp;<span class="ident" id="7598260">i</span><span class="op" id="7598261">%</span><span class="num" id="7598262">100</span>&nbsp;<span class="op" id="7598266">==</span>&nbsp;<span class="num" id="7598269">0</span>&nbsp;<span class="op" id="7598271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7598276">//println(&#34;TestDNSThreadLimit:&#34;,&nbsp;i)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598318">&lt;-</span><span class="ident" id="7598320">c</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7598327">//&nbsp;If&nbsp;we&#39;re&nbsp;still&nbsp;here,&nbsp;it&nbsp;worked.</span><br>
<span class="lineno"></span><span class="op" id="7598362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="7598365">func</span>&nbsp;<span class="ident" id="7598370">TestLookupIPDeadline</span><span class="op" id="7598390">(</span><span class="ident" id="7598391">t</span>&nbsp;<span class="op" id="7598393">*</span><span class="ident" id="7598394">testing</span><span class="op" id="7598401">.</span><span class="ident" id="7598402">T</span><span class="op" id="7598403">)</span>&nbsp;<span class="op" id="7598405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598408">if</span>&nbsp;<span class="op" id="7598411">!</span><span class="op" id="7598412">*</span><span class="ident" id="7598413">testDNSFlood</span>&nbsp;<span class="op" id="7598426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598430">t</span><span class="op" id="7598431">.</span><span class="ident" id="7598432">Skip</span><span class="op" id="7598436">(</span><span class="string" id="7598437">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7598477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598484">const</span>&nbsp;<span class="ident" id="7598490">N</span>&nbsp;<span class="op" id="7598492">=</span>&nbsp;<span class="num" id="7598494">5000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598500">const</span>&nbsp;<span class="ident" id="7598506">timeout</span>&nbsp;<span class="op" id="7598514">=</span>&nbsp;<span class="num" id="7598516">3</span>&nbsp;<span class="op" id="7598518">*</span>&nbsp;<span class="ident" id="7598520">time</span><span class="op" id="7598524">.</span><span class="ident" id="7598525">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598533">c</span>&nbsp;<span class="op" id="7598535">:=</span>&nbsp;<span class="builtinfunc" id="7598538">make</span><span class="op" id="7598542">(</span><span class="keyword" id="7598543">chan</span>&nbsp;<span class="builtintype" id="7598548">error</span><span class="op" id="7598553">,</span>&nbsp;<span class="num" id="7598555">2</span><span class="op" id="7598556">*</span><span class="ident" id="7598557">N</span><span class="op" id="7598558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598561">for</span>&nbsp;<span class="ident" id="7598565">i</span>&nbsp;<span class="op" id="7598567">:=</span>&nbsp;<span class="num" id="7598570">0</span><span class="op" id="7598571">;</span>&nbsp;<span class="ident" id="7598573">i</span>&nbsp;<span class="op" id="7598575">&lt;</span>&nbsp;<span class="ident" id="7598577">N</span><span class="op" id="7598578">;</span>&nbsp;<span class="ident" id="7598580">i</span><span class="op" id="7598581">++</span>&nbsp;<span class="op" id="7598584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598588">name</span>&nbsp;<span class="op" id="7598593">:=</span>&nbsp;<span class="ident" id="7598596">fmt</span><span class="op" id="7598599">.</span><span class="ident" id="7598600">Sprintf</span><span class="op" id="7598607">(</span><span class="string" id="7598608">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="7598632">,</span>&nbsp;<span class="ident" id="7598634">i</span><span class="op" id="7598635">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598639">go</span>&nbsp;<span class="keyword" id="7598642">func</span><span class="op" id="7598646">(</span><span class="op" id="7598647">)</span>&nbsp;<span class="op" id="7598649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598654">_</span><span class="op" id="7598655">,</span>&nbsp;<span class="ident" id="7598657">err</span>&nbsp;<span class="op" id="7598661">:=</span>&nbsp;<span class="ident" id="7598664">lookupIPDeadline</span><span class="op" id="7598680">(</span><span class="ident" id="7598681">name</span><span class="op" id="7598685">,</span>&nbsp;<span class="ident" id="7598687">time</span><span class="op" id="7598691">.</span><span class="ident" id="7598692">Now</span><span class="op" id="7598695">(</span><span class="op" id="7598696">)</span><span class="op" id="7598697">.</span><span class="ident" id="7598698">Add</span><span class="op" id="7598701">(</span><span class="ident" id="7598702">timeout</span><span class="op" id="7598709">/</span><span class="num" id="7598710">2</span><span class="op" id="7598711">)</span><span class="op" id="7598712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598717">c</span>&nbsp;<span class="op" id="7598719">&lt;-</span>&nbsp;<span class="ident" id="7598722">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598728">}</span><span class="op" id="7598729">(</span><span class="op" id="7598730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598734">go</span>&nbsp;<span class="keyword" id="7598737">func</span><span class="op" id="7598741">(</span><span class="op" id="7598742">)</span>&nbsp;<span class="op" id="7598744">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598749">_</span><span class="op" id="7598750">,</span>&nbsp;<span class="ident" id="7598752">err</span>&nbsp;<span class="op" id="7598756">:=</span>&nbsp;<span class="ident" id="7598759">lookupIPDeadline</span><span class="op" id="7598775">(</span><span class="ident" id="7598776">name</span><span class="op" id="7598780">,</span>&nbsp;<span class="ident" id="7598782">time</span><span class="op" id="7598786">.</span><span class="ident" id="7598787">Now</span><span class="op" id="7598790">(</span><span class="op" id="7598791">)</span><span class="op" id="7598792">.</span><span class="ident" id="7598793">Add</span><span class="op" id="7598796">(</span><span class="ident" id="7598797">timeout</span><span class="op" id="7598804">)</span><span class="op" id="7598805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598810">c</span>&nbsp;<span class="op" id="7598812">&lt;-</span>&nbsp;<span class="ident" id="7598815">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598821">}</span><span class="op" id="7598822">(</span><span class="op" id="7598823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598829">qstats</span>&nbsp;<span class="op" id="7598836">:=</span>&nbsp;<span class="keyword" id="7598839">struct</span>&nbsp;<span class="op" id="7598846">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598850">succeeded</span><span class="op" id="7598859">,</span>&nbsp;<span class="ident" id="7598861">failed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7598876">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598882">timeout</span><span class="op" id="7598889">,</span>&nbsp;<span class="ident" id="7598891">temporary</span><span class="op" id="7598900">,</span>&nbsp;<span class="ident" id="7598902">other</span>&nbsp;<span class="builtintype" id="7598908">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598914">unknown</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7598940">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7598945">}</span><span class="op" id="7598946">{</span><span class="op" id="7598947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7598950">deadline</span>&nbsp;<span class="op" id="7598959">:=</span>&nbsp;<span class="ident" id="7598962">time</span><span class="op" id="7598966">.</span><span class="ident" id="7598967">After</span><span class="op" id="7598972">(</span><span class="ident" id="7598973">timeout</span>&nbsp;<span class="op" id="7598981">+</span>&nbsp;<span class="ident" id="7598983">time</span><span class="op" id="7598987">.</span><span class="ident" id="7598988">Second</span><span class="op" id="7598994">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7598997">for</span>&nbsp;<span class="ident" id="7599001">i</span>&nbsp;<span class="op" id="7599003">:=</span>&nbsp;<span class="num" id="7599006">0</span><span class="op" id="7599007">;</span>&nbsp;<span class="ident" id="7599009">i</span>&nbsp;<span class="op" id="7599011">&lt;</span>&nbsp;<span class="num" id="7599013">2</span><span class="op" id="7599014">*</span><span class="ident" id="7599015">N</span><span class="op" id="7599016">;</span>&nbsp;<span class="ident" id="7599018">i</span><span class="op" id="7599019">++</span>&nbsp;<span class="op" id="7599022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599026">select</span>&nbsp;<span class="op" id="7599033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599037">case</span>&nbsp;<span class="op" id="7599042">&lt;-</span><span class="ident" id="7599044">deadline</span><span class="op" id="7599052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599057">t</span><span class="op" id="7599058">.</span><span class="ident" id="7599059">Fatal</span><span class="op" id="7599064">(</span><span class="string" id="7599065">&#34;deadline&nbsp;exceeded&#34;</span><span class="op" id="7599084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599088">case</span>&nbsp;<span class="ident" id="7599093">err</span>&nbsp;<span class="op" id="7599097">:=</span>&nbsp;<span class="op" id="7599100">&lt;-</span><span class="ident" id="7599102">c</span><span class="op" id="7599103">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599108">switch</span>&nbsp;<span class="ident" id="7599115">err</span>&nbsp;<span class="op" id="7599119">:=</span>&nbsp;<span class="ident" id="7599122">err</span><span class="op" id="7599125">.</span><span class="op" id="7599126">(</span><span class="keyword" id="7599127">type</span><span class="op" id="7599131">)</span>&nbsp;<span class="op" id="7599133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599138">case</span>&nbsp;<span class="ident" id="7599143">nil</span><span class="op" id="7599146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599152">qstats</span><span class="op" id="7599158">.</span><span class="ident" id="7599159">succeeded</span><span class="op" id="7599168">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599174">case</span>&nbsp;<span class="ident" id="7599179">Error</span><span class="op" id="7599184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599190">qstats</span><span class="op" id="7599196">.</span><span class="ident" id="7599197">failed</span><span class="op" id="7599203">++</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599210">if</span>&nbsp;<span class="ident" id="7599213">err</span><span class="op" id="7599216">.</span><span class="ident" id="7599217">Timeout</span><span class="op" id="7599224">(</span><span class="op" id="7599225">)</span>&nbsp;<span class="op" id="7599227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599234">qstats</span><span class="op" id="7599240">.</span><span class="ident" id="7599241">timeout</span><span class="op" id="7599248">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599261">if</span>&nbsp;<span class="ident" id="7599264">err</span><span class="op" id="7599267">.</span><span class="ident" id="7599268">Temporary</span><span class="op" id="7599277">(</span><span class="op" id="7599278">)</span>&nbsp;<span class="op" id="7599280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599287">qstats</span><span class="op" id="7599293">.</span><span class="ident" id="7599294">temporary</span><span class="op" id="7599303">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599316">if</span>&nbsp;<span class="op" id="7599319">!</span><span class="ident" id="7599320">err</span><span class="op" id="7599323">.</span><span class="ident" id="7599324">Timeout</span><span class="op" id="7599331">(</span><span class="op" id="7599332">)</span>&nbsp;<span class="op" id="7599334">&amp;&amp;</span>&nbsp;<span class="op" id="7599337">!</span><span class="ident" id="7599338">err</span><span class="op" id="7599341">.</span><span class="ident" id="7599342">Temporary</span><span class="op" id="7599351">(</span><span class="op" id="7599352">)</span>&nbsp;<span class="op" id="7599354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599361">qstats</span><span class="op" id="7599367">.</span><span class="ident" id="7599368">other</span><span class="op" id="7599373">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7599385">default</span><span class="op" id="7599392">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599398">qstats</span><span class="op" id="7599404">.</span><span class="ident" id="7599405">failed</span><span class="op" id="7599411">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599418">qstats</span><span class="op" id="7599424">.</span><span class="ident" id="7599425">unknown</span><span class="op" id="7599432">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599445">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599449">//&nbsp;A&nbsp;high&nbsp;volume&nbsp;of&nbsp;DNS&nbsp;queries&nbsp;for&nbsp;sub-domain&nbsp;of&nbsp;golang.org</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599511">//&nbsp;would&nbsp;be&nbsp;coordinated&nbsp;by&nbsp;authoritative&nbsp;or&nbsp;recursive&nbsp;server,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599574">//&nbsp;or&nbsp;stub&nbsp;resolver&nbsp;which&nbsp;implements&nbsp;query-response&nbsp;rate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599632">//&nbsp;limitation,&nbsp;so&nbsp;we&nbsp;can&nbsp;expect&nbsp;some&nbsp;query&nbsp;successes&nbsp;and&nbsp;more</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599695">//&nbsp;failures&nbsp;including&nbsp;timeout,&nbsp;temporary&nbsp;and&nbsp;other&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599753">//&nbsp;As&nbsp;a&nbsp;rule,&nbsp;unknown&nbsp;must&nbsp;not&nbsp;be&nbsp;shown&nbsp;but&nbsp;it&nbsp;might&nbsp;possibly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7599816">//&nbsp;happen&nbsp;due&nbsp;to&nbsp;issue&nbsp;4856&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599854">t</span><span class="op" id="7599855">.</span><span class="ident" id="7599856">Logf</span><span class="op" id="7599860">(</span><span class="string" id="7599861">&#34;%v&nbsp;succeeded,&nbsp;%v&nbsp;failed&nbsp;(%v&nbsp;timeout,&nbsp;%v&nbsp;temporary,&nbsp;%v&nbsp;other,&nbsp;%v&nbsp;unknown)&#34;</span><span class="op" id="7599935">,</span>&nbsp;<span class="ident" id="7599937">qstats</span><span class="op" id="7599943">.</span><span class="ident" id="7599944">succeeded</span><span class="op" id="7599953">,</span>&nbsp;<span class="ident" id="7599955">qstats</span><span class="op" id="7599961">.</span><span class="ident" id="7599962">failed</span><span class="op" id="7599968">,</span>&nbsp;<span class="ident" id="7599970">qstats</span><span class="op" id="7599976">.</span><span class="ident" id="7599977">timeout</span><span class="op" id="7599984">,</span>&nbsp;<span class="ident" id="7599986">qstats</span><span class="op" id="7599992">.</span><span class="ident" id="7599993">temporary</span><span class="op" id="7600002">,</span>&nbsp;<span class="ident" id="7600004">qstats</span><span class="op" id="7600010">.</span><span class="ident" id="7600011">other</span><span class="op" id="7600016">,</span>&nbsp;<span class="ident" id="7600018">qstats</span><span class="op" id="7600024">.</span><span class="ident" id="7600025">unknown</span><span class="op" id="7600032">)</span><br>
<span class="lineno"></span><span class="op" id="7600034">}</span>
</div>
</body>
</html>
