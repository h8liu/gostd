<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2802121">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2802176">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2802230">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2802281">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2802354">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2802434">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2802510">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2802551">//</span><br>
<span class="lineno">10</span><span class="comment" id="2802554">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2802623">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2802690">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2802708">//</span><br>
<span class="lineno"></span><span class="comment" id="2802711">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2802784">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2802842">package</span>&nbsp;<span class="ident" id="2802850">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2802859">import</span>&nbsp;<span class="op" id="2802866">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2802869">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2802880">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2802891">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2802899">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2802908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2802911">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2802955">//</span><br>
<span class="lineno"></span><span class="comment" id="2802958">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2803021">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2803080">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2803139">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2803191">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2803253">type</span>&nbsp;<span class="ident" id="2803258">Type</span>&nbsp;<span class="keyword" id="2803263">interface</span>&nbsp;<span class="op" id="2803273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803276">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803314">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803369">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803409">Align</span><span class="op" id="2803414">(</span><span class="op" id="2803415">)</span>&nbsp;<span class="builtintype" id="2803417">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803423">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803483">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803531">FieldAlign</span><span class="op" id="2803541">(</span><span class="op" id="2803542">)</span>&nbsp;<span class="builtintype" id="2803544">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803550">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803611">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803668">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803672">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803746">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803815">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803819">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803889">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803958">Method</span><span class="op" id="2803964">(</span><span class="builtintype" id="2803965">int</span><span class="op" id="2803968">)</span>&nbsp;<span class="ident" id="2803970">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803979">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804044">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804109">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804113">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804187">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804256">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804260">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804330">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804399">MethodByName</span><span class="op" id="2804411">(</span><span class="builtintype" id="2804412">string</span><span class="op" id="2804418">)</span>&nbsp;<span class="op" id="2804420">(</span><span class="ident" id="2804421">Method</span><span class="op" id="2804427">,</span>&nbsp;<span class="builtintype" id="2804429">bool</span><span class="op" id="2804433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804437">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804507">NumMethod</span><span class="op" id="2804516">(</span><span class="op" id="2804517">)</span>&nbsp;<span class="builtintype" id="2804519">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804525">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804578">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804628">Name</span><span class="op" id="2804632">(</span><span class="op" id="2804633">)</span>&nbsp;<span class="builtintype" id="2804635">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804644">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804718">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804787">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804869">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804916">PkgPath</span><span class="op" id="2804923">(</span><span class="op" id="2804924">)</span>&nbsp;<span class="builtintype" id="2804926">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804935">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2804988">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805053">Size</span><span class="op" id="2805057">(</span><span class="op" id="2805058">)</span>&nbsp;<span class="builtintype" id="2805060">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805070">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805126">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805188">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805247">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805311">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805343">String</span><span class="op" id="2805349">(</span><span class="op" id="2805350">)</span>&nbsp;<span class="builtintype" id="2805352">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805361">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805410">Kind</span><span class="op" id="2805414">(</span><span class="op" id="2805415">)</span>&nbsp;<span class="ident" id="2805417">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805424">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805497">Implements</span><span class="op" id="2805507">(</span><span class="ident" id="2805508">u</span>&nbsp;<span class="ident" id="2805510">Type</span><span class="op" id="2805514">)</span>&nbsp;<span class="builtintype" id="2805516">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805523">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805601">AssignableTo</span><span class="op" id="2805613">(</span><span class="ident" id="2805614">u</span>&nbsp;<span class="ident" id="2805616">Type</span><span class="op" id="2805620">)</span>&nbsp;<span class="builtintype" id="2805622">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805629">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805709">ConvertibleTo</span><span class="op" id="2805722">(</span><span class="ident" id="2805723">u</span>&nbsp;<span class="ident" id="2805725">Type</span><span class="op" id="2805729">)</span>&nbsp;<span class="builtintype" id="2805731">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805738">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805805">Comparable</span><span class="op" id="2805815">(</span><span class="op" id="2805816">)</span>&nbsp;<span class="builtintype" id="2805818">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805825">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805887">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805930">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805934">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805974">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805995">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806019">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806065">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806084">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806098">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806114">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806187">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806234">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806285">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806342">Bits</span><span class="op" id="2806346">(</span><span class="op" id="2806347">)</span>&nbsp;<span class="builtintype" id="2806349">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806355">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806403">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806449">ChanDir</span><span class="op" id="2806456">(</span><span class="op" id="2806457">)</span>&nbsp;<span class="ident" id="2806459">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806469">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806540">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806618">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806648">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806652">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806723">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806727">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806746">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806788">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806836">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806863">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806867">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806921">IsVariadic</span><span class="op" id="2806931">(</span><span class="op" id="2806932">)</span>&nbsp;<span class="builtintype" id="2806934">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806941">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806981">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807054">Elem</span><span class="op" id="2807058">(</span><span class="op" id="2807059">)</span>&nbsp;<span class="ident" id="2807061">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807068">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807114">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807162">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807218">Field</span><span class="op" id="2807223">(</span><span class="ident" id="2807224">i</span>&nbsp;<span class="builtintype" id="2807226">int</span><span class="op" id="2807229">)</span>&nbsp;<span class="ident" id="2807231">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807245">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807301">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807363">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807398">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807446">FieldByIndex</span><span class="op" id="2807458">(</span><span class="ident" id="2807459">index</span>&nbsp;<span class="op" id="2807465">[</span><span class="op" id="2807466">]</span><span class="builtintype" id="2807467">int</span><span class="op" id="2807470">)</span>&nbsp;<span class="ident" id="2807472">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807486">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807547">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807600">FieldByName</span><span class="op" id="2807611">(</span><span class="ident" id="2807612">name</span>&nbsp;<span class="builtintype" id="2807617">string</span><span class="op" id="2807623">)</span>&nbsp;<span class="op" id="2807625">(</span><span class="ident" id="2807626">StructField</span><span class="op" id="2807637">,</span>&nbsp;<span class="builtintype" id="2807639">bool</span><span class="op" id="2807643">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807647">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807710">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807776">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807801">FieldByNameFunc</span><span class="op" id="2807816">(</span><span class="ident" id="2807817">match</span>&nbsp;<span class="keyword" id="2807823">func</span><span class="op" id="2807827">(</span><span class="builtintype" id="2807828">string</span><span class="op" id="2807834">)</span>&nbsp;<span class="builtintype" id="2807836">bool</span><span class="op" id="2807840">)</span>&nbsp;<span class="op" id="2807842">(</span><span class="ident" id="2807843">StructField</span><span class="op" id="2807854">,</span>&nbsp;<span class="builtintype" id="2807856">bool</span><span class="op" id="2807860">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807864">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807931">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807977">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808030">In</span><span class="op" id="2808032">(</span><span class="ident" id="2808033">i</span>&nbsp;<span class="builtintype" id="2808035">int</span><span class="op" id="2808038">)</span>&nbsp;<span class="ident" id="2808040">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808047">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808086">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808131">Key</span><span class="op" id="2808134">(</span><span class="op" id="2808135">)</span>&nbsp;<span class="ident" id="2808137">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808144">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808184">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808231">Len</span><span class="op" id="2808234">(</span><span class="op" id="2808235">)</span>&nbsp;<span class="builtintype" id="2808237">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808243">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808293">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808341">NumField</span><span class="op" id="2808349">(</span><span class="op" id="2808350">)</span>&nbsp;<span class="builtintype" id="2808352">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808358">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808417">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808463">NumIn</span><span class="op" id="2808468">(</span><span class="op" id="2808469">)</span>&nbsp;<span class="builtintype" id="2808471">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808477">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808538">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808584">NumOut</span><span class="op" id="2808590">(</span><span class="op" id="2808591">)</span>&nbsp;<span class="builtintype" id="2808593">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808599">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808668">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808714">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808768">Out</span><span class="op" id="2808771">(</span><span class="ident" id="2808772">i</span>&nbsp;<span class="builtintype" id="2808774">int</span><span class="op" id="2808777">)</span>&nbsp;<span class="ident" id="2808779">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808786">common</span><span class="op" id="2808792">(</span><span class="op" id="2808793">)</span>&nbsp;<span class="op" id="2808795">*</span><span class="ident" id="2808796">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808803">uncommon</span><span class="op" id="2808811">(</span><span class="op" id="2808812">)</span>&nbsp;<span class="op" id="2808814">*</span><span class="ident" id="2808815">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2808828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2808831">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2808918">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2808991">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2809068">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2809140">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2809203">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2809290">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2809338">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2809533">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2809604">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2809642">type</span>&nbsp;<span class="ident" id="2809647">Kind</span>&nbsp;<span class="builtintype" id="2809652">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2809658">const</span>&nbsp;<span class="op" id="2809664">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809667">Invalid</span>&nbsp;<span class="ident" id="2809675">Kind</span>&nbsp;<span class="op" id="2809680">=</span>&nbsp;<span class="ident" id="2809682">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809688">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809694">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809699">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809705">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809712">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809719">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809726">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809732">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809739">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809747">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809755">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809763">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809772">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809781">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809790">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809801">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809813">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809820">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809826">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809832">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809843">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809848">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809853">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809860">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809868">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809876">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2809890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2809893">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2809947">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2810007">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2810070">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2810136">type</span>&nbsp;<span class="ident" id="2810141">rtype</span>&nbsp;<span class="keyword" id="2810147">struct</span>&nbsp;<span class="op" id="2810154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810157">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810171">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810180">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810194">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810212">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810264">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810278">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810296">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810315">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810329">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810347">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810388">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810402">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810420">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810465">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2810479">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810497">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810519">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810533">*</span><span class="ident" id="2810534">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810551">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810599">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810613">[</span><span class="num" id="2810614">2</span><span class="op" id="2810615">]</span><span class="ident" id="2810616">unsafe</span><span class="op" id="2810622">.</span><span class="ident" id="2810623">Pointer</span>&nbsp;<span class="comment" id="2810631">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2810659">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810673">*</span><span class="builtintype" id="2810674">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810691">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810742">*</span><span class="ident" id="2810743">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810774">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810807">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810821">*</span><span class="ident" id="2810822">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810839">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810907">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810921">unsafe</span><span class="op" id="2810927">.</span><span class="ident" id="2810928">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810939">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2810964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2810967">type</span>&nbsp;<span class="ident" id="2810972">typeAlg</span>&nbsp;<span class="keyword" id="2810980">struct</span>&nbsp;<span class="op" id="2810987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810990">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811036">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811076">hash</span>&nbsp;<span class="keyword" id="2811081">func</span><span class="op" id="2811085">(</span><span class="ident" id="2811086">unsafe</span><span class="op" id="2811092">.</span><span class="ident" id="2811093">Pointer</span><span class="op" id="2811100">,</span>&nbsp;<span class="builtintype" id="2811102">uintptr</span><span class="op" id="2811109">,</span>&nbsp;<span class="builtintype" id="2811111">uintptr</span><span class="op" id="2811118">)</span>&nbsp;<span class="builtintype" id="2811120">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811129">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811177">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811229">equal</span>&nbsp;<span class="keyword" id="2811235">func</span><span class="op" id="2811239">(</span><span class="ident" id="2811240">unsafe</span><span class="op" id="2811246">.</span><span class="ident" id="2811247">Pointer</span><span class="op" id="2811254">,</span>&nbsp;<span class="ident" id="2811256">unsafe</span><span class="op" id="2811262">.</span><span class="ident" id="2811263">Pointer</span><span class="op" id="2811270">,</span>&nbsp;<span class="builtintype" id="2811272">uintptr</span><span class="op" id="2811279">)</span>&nbsp;<span class="builtintype" id="2811281">bool</span><br>
<span class="lineno"></span><span class="op" id="2811286">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2811289">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2811321">type</span>&nbsp;<span class="ident" id="2811326">method</span>&nbsp;<span class="keyword" id="2811333">struct</span>&nbsp;<span class="op" id="2811340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811343">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811351">*</span><span class="builtintype" id="2811352">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811366">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811385">pkgPath</span>&nbsp;<span class="op" id="2811393">*</span><span class="builtintype" id="2811394">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811408">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811458">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811466">*</span><span class="ident" id="2811467">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811481">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811516">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811524">*</span><span class="ident" id="2811525">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811539">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811583">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811591">unsafe</span><span class="op" id="2811597">.</span><span class="ident" id="2811598">Pointer</span>&nbsp;<span class="comment" id="2811606">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811656">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811664">unsafe</span><span class="op" id="2811670">.</span><span class="ident" id="2811671">Pointer</span>&nbsp;<span class="comment" id="2811679">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2811713">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2811716">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2811780">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2811852">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2811920">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2811968">type</span>&nbsp;<span class="ident" id="2811973">uncommonType</span>&nbsp;<span class="keyword" id="2811986">struct</span>&nbsp;<span class="op" id="2811993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811996">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812004">*</span><span class="builtintype" id="2812005">string</span>&nbsp;&nbsp;<span class="comment" id="2812013">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812030">pkgPath</span>&nbsp;<span class="op" id="2812038">*</span><span class="builtintype" id="2812039">string</span>&nbsp;&nbsp;<span class="comment" id="2812047">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812104">methods</span>&nbsp;<span class="op" id="2812112">[</span><span class="op" id="2812113">]</span><span class="ident" id="2812114">method</span>&nbsp;<span class="comment" id="2812121">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2812153">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2812156">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2812206">type</span>&nbsp;<span class="ident" id="2812211">ChanDir</span>&nbsp;<span class="builtintype" id="2812219">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2812224">const</span>&nbsp;<span class="op" id="2812230">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812233">RecvDir</span>&nbsp;<span class="ident" id="2812241">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812261">=</span>&nbsp;<span class="num" id="2812263">1</span>&nbsp;<span class="op" id="2812265">&lt;&lt;</span>&nbsp;<span class="ident" id="2812268">iota</span>&nbsp;<span class="comment" id="2812273">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812284">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812324">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812335">BothDir</span>&nbsp;<span class="op" id="2812343">=</span>&nbsp;<span class="ident" id="2812345">RecvDir</span>&nbsp;<span class="op" id="2812353">|</span>&nbsp;<span class="ident" id="2812355">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812375">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2812383">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2812386">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2812430">type</span>&nbsp;<span class="ident" id="2812435">arrayType</span>&nbsp;<span class="keyword" id="2812445">struct</span>&nbsp;<span class="op" id="2812452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812455">rtype</span>&nbsp;<span class="string" id="2812461">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812480">elem</span>&nbsp;&nbsp;<span class="op" id="2812486">*</span><span class="ident" id="2812487">rtype</span>&nbsp;<span class="comment" id="2812493">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812516">slice</span>&nbsp;<span class="op" id="2812522">*</span><span class="ident" id="2812523">rtype</span>&nbsp;<span class="comment" id="2812529">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2812544">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2812550">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2812558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812561">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2812600">type</span>&nbsp;<span class="ident" id="2812605">chanType</span>&nbsp;<span class="keyword" id="2812614">struct</span>&nbsp;<span class="op" id="2812621">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812624">rtype</span>&nbsp;<span class="string" id="2812630">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812648">elem</span>&nbsp;&nbsp;<span class="op" id="2812654">*</span><span class="ident" id="2812655">rtype</span>&nbsp;&nbsp;<span class="comment" id="2812662">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812687">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2812693">uintptr</span>&nbsp;<span class="comment" id="2812701">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2812732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2812735">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2812775">type</span>&nbsp;<span class="ident" id="2812780">funcType</span>&nbsp;<span class="keyword" id="2812789">struct</span>&nbsp;<span class="op" id="2812796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812799">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2812809">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812827">dotdotdot</span>&nbsp;<span class="builtintype" id="2812837">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812846">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812878">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812888">[</span><span class="op" id="2812889">]</span><span class="op" id="2812890">*</span><span class="ident" id="2812891">rtype</span>&nbsp;<span class="comment" id="2812897">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812923">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812933">[</span><span class="op" id="2812934">]</span><span class="op" id="2812935">*</span><span class="ident" id="2812936">rtype</span>&nbsp;<span class="comment" id="2812942">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2812968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812971">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2813023">type</span>&nbsp;<span class="ident" id="2813028">imethod</span>&nbsp;<span class="keyword" id="2813036">struct</span>&nbsp;<span class="op" id="2813043">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813046">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813054">*</span><span class="builtintype" id="2813055">string</span>&nbsp;<span class="comment" id="2813062">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813081">pkgPath</span>&nbsp;<span class="op" id="2813089">*</span><span class="builtintype" id="2813090">string</span>&nbsp;<span class="comment" id="2813097">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813147">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813155">*</span><span class="ident" id="2813156">rtype</span>&nbsp;&nbsp;<span class="comment" id="2813163">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2813190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2813193">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2813240">type</span>&nbsp;<span class="ident" id="2813245">interfaceType</span>&nbsp;<span class="keyword" id="2813259">struct</span>&nbsp;<span class="op" id="2813266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813269">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2813277">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813300">methods</span>&nbsp;<span class="op" id="2813308">[</span><span class="op" id="2813309">]</span><span class="ident" id="2813310">imethod</span>&nbsp;<span class="comment" id="2813318">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2813336">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2813339">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2813373">type</span>&nbsp;<span class="ident" id="2813378">mapType</span>&nbsp;<span class="keyword" id="2813386">struct</span>&nbsp;<span class="op" id="2813393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813396">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2813410">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813427">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813441">*</span><span class="ident" id="2813442">rtype</span>&nbsp;<span class="comment" id="2813448">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813465">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813479">*</span><span class="ident" id="2813480">rtype</span>&nbsp;<span class="comment" id="2813486">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813515">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813529">*</span><span class="ident" id="2813530">rtype</span>&nbsp;<span class="comment" id="2813536">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813566">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813580">*</span><span class="ident" id="2813581">rtype</span>&nbsp;<span class="comment" id="2813587">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813611">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2813625">uint8</span>&nbsp;&nbsp;<span class="comment" id="2813632">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813653">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2813667">uint8</span>&nbsp;&nbsp;<span class="comment" id="2813674">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813717">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2813731">uint8</span>&nbsp;&nbsp;<span class="comment" id="2813738">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813761">indirectvalue</span>&nbsp;<span class="builtintype" id="2813775">uint8</span>&nbsp;&nbsp;<span class="comment" id="2813782">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813829">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2813843">uint16</span>&nbsp;<span class="comment" id="2813850">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2813868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2813871">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2813909">type</span>&nbsp;<span class="ident" id="2813914">ptrType</span>&nbsp;<span class="keyword" id="2813922">struct</span>&nbsp;<span class="op" id="2813929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813932">rtype</span>&nbsp;<span class="string" id="2813938">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813955">elem</span>&nbsp;&nbsp;<span class="op" id="2813961">*</span><span class="ident" id="2813962">rtype</span>&nbsp;<span class="comment" id="2813968">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2814005">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2814008">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2814046">type</span>&nbsp;<span class="ident" id="2814051">sliceType</span>&nbsp;<span class="keyword" id="2814061">struct</span>&nbsp;<span class="op" id="2814068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814071">rtype</span>&nbsp;<span class="string" id="2814077">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814096">elem</span>&nbsp;&nbsp;<span class="op" id="2814102">*</span><span class="ident" id="2814103">rtype</span>&nbsp;<span class="comment" id="2814109">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2814131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814134">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2814150">type</span>&nbsp;<span class="ident" id="2814155">structField</span>&nbsp;<span class="keyword" id="2814167">struct</span>&nbsp;<span class="op" id="2814174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814177">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814185">*</span><span class="builtintype" id="2814186">string</span>&nbsp;<span class="comment" id="2814193">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814221">pkgPath</span>&nbsp;<span class="op" id="2814229">*</span><span class="builtintype" id="2814230">string</span>&nbsp;<span class="comment" id="2814237">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814287">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814295">*</span><span class="ident" id="2814296">rtype</span>&nbsp;&nbsp;<span class="comment" id="2814303">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814321">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814329">*</span><span class="builtintype" id="2814330">string</span>&nbsp;<span class="comment" id="2814337">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814355">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2814363">uintptr</span>&nbsp;<span class="comment" id="2814371">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2814409">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2814412">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2814452">type</span>&nbsp;<span class="ident" id="2814457">structType</span>&nbsp;<span class="keyword" id="2814468">struct</span>&nbsp;<span class="op" id="2814475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814478">rtype</span>&nbsp;&nbsp;<span class="string" id="2814485">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814505">fields</span>&nbsp;<span class="op" id="2814512">[</span><span class="op" id="2814513">]</span><span class="ident" id="2814514">structField</span>&nbsp;<span class="comment" id="2814526">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2814546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814549">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814705">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2814743">type</span>&nbsp;<span class="ident" id="2814748">Method</span>&nbsp;<span class="keyword" id="2814755">struct</span>&nbsp;<span class="op" id="2814762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814765">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814794">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814867">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814937">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815006">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815027">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815088">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2815096">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815104">PkgPath</span>&nbsp;<span class="builtintype" id="2815112">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815121">Type</span>&nbsp;&nbsp;<span class="ident" id="2815127">Type</span>&nbsp;&nbsp;<span class="comment" id="2815133">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815149">Func</span>&nbsp;&nbsp;<span class="ident" id="2815155">Value</span>&nbsp;<span class="comment" id="2815161">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815202">Index</span>&nbsp;<span class="builtintype" id="2815208">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2815214">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2815239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2815242">const</span>&nbsp;<span class="op" id="2815248">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815251">kindDirectIface</span>&nbsp;<span class="op" id="2815267">=</span>&nbsp;<span class="num" id="2815269">1</span>&nbsp;<span class="op" id="2815271">&lt;&lt;</span>&nbsp;<span class="num" id="2815274">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815277">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815293">=</span>&nbsp;<span class="num" id="2815295">1</span>&nbsp;<span class="op" id="2815297">&lt;&lt;</span>&nbsp;<span class="num" id="2815300">6</span>&nbsp;<span class="comment" id="2815302">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815335">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2815351">=</span>&nbsp;<span class="num" id="2815353">1</span>&nbsp;<span class="op" id="2815355">&lt;&lt;</span>&nbsp;<span class="num" id="2815358">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815361">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815377">=</span>&nbsp;<span class="op" id="2815379">(</span><span class="num" id="2815380">1</span>&nbsp;<span class="op" id="2815382">&lt;&lt;</span>&nbsp;<span class="num" id="2815385">5</span><span class="op" id="2815386">)</span>&nbsp;<span class="op" id="2815388">-</span>&nbsp;<span class="num" id="2815390">1</span><br>
<span class="lineno"></span><span class="op" id="2815392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2815395">func</span>&nbsp;<span class="op" id="2815400">(</span><span class="ident" id="2815401">k</span>&nbsp;<span class="ident" id="2815403">Kind</span><span class="op" id="2815407">)</span>&nbsp;<span class="ident" id="2815409">String</span><span class="op" id="2815415">(</span><span class="op" id="2815416">)</span>&nbsp;<span class="builtintype" id="2815418">string</span>&nbsp;<span class="op" id="2815425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815428">if</span>&nbsp;<span class="builtintype" id="2815431">int</span><span class="op" id="2815434">(</span><span class="ident" id="2815435">k</span><span class="op" id="2815436">)</span>&nbsp;<span class="op" id="2815438">&lt;</span>&nbsp;<span class="builtinfunc" id="2815440">len</span><span class="op" id="2815443">(</span><span class="ident" id="2815444">kindNames</span><span class="op" id="2815453">)</span>&nbsp;<span class="op" id="2815455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815459">return</span>&nbsp;<span class="ident" id="2815466">kindNames</span><span class="op" id="2815475">[</span><span class="ident" id="2815476">k</span><span class="op" id="2815477">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2815480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815483">return</span>&nbsp;<span class="string" id="2815490">&#34;kind&#34;</span>&nbsp;<span class="op" id="2815497">+</span>&nbsp;<span class="ident" id="2815499">strconv</span><span class="op" id="2815506">.</span><span class="ident" id="2815507">Itoa</span><span class="op" id="2815511">(</span><span class="builtintype" id="2815512">int</span><span class="op" id="2815515">(</span><span class="ident" id="2815516">k</span><span class="op" id="2815517">)</span><span class="op" id="2815518">)</span><br>
<span class="lineno">410</span><span class="op" id="2815520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2815523">var</span>&nbsp;<span class="ident" id="2815527">kindNames</span>&nbsp;<span class="op" id="2815537">=</span>&nbsp;<span class="op" id="2815539">[</span><span class="op" id="2815540">]</span><span class="builtintype" id="2815541">string</span><span class="op" id="2815547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815550">Invalid</span><span class="op" id="2815557">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815565">&#34;invalid&#34;</span><span class="op" id="2815574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815577">Bool</span><span class="op" id="2815581">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815592">&#34;bool&#34;</span><span class="op" id="2815598">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815601">Int</span><span class="op" id="2815604">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815616">&#34;int&#34;</span><span class="op" id="2815621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815624">Int8</span><span class="op" id="2815628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815639">&#34;int8&#34;</span><span class="op" id="2815645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815648">Int16</span><span class="op" id="2815653">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815663">&#34;int16&#34;</span><span class="op" id="2815670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815673">Int32</span><span class="op" id="2815678">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815688">&#34;int32&#34;</span><span class="op" id="2815695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815698">Int64</span><span class="op" id="2815703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815713">&#34;int64&#34;</span><span class="op" id="2815720">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815723">Uint</span><span class="op" id="2815727">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815738">&#34;uint&#34;</span><span class="op" id="2815744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815747">Uint8</span><span class="op" id="2815752">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815762">&#34;uint8&#34;</span><span class="op" id="2815769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815772">Uint16</span><span class="op" id="2815778">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815787">&#34;uint16&#34;</span><span class="op" id="2815795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815798">Uint32</span><span class="op" id="2815804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815813">&#34;uint32&#34;</span><span class="op" id="2815821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815824">Uint64</span><span class="op" id="2815830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815839">&#34;uint64&#34;</span><span class="op" id="2815847">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815850">Uintptr</span><span class="op" id="2815857">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815865">&#34;uintptr&#34;</span><span class="op" id="2815874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815877">Float32</span><span class="op" id="2815884">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815892">&#34;float32&#34;</span><span class="op" id="2815901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815904">Float64</span><span class="op" id="2815911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815919">&#34;float64&#34;</span><span class="op" id="2815928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815931">Complex64</span><span class="op" id="2815940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815946">&#34;complex64&#34;</span><span class="op" id="2815957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815960">Complex128</span><span class="op" id="2815970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2815975">&#34;complex128&#34;</span><span class="op" id="2815987">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815990">Array</span><span class="op" id="2815995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816005">&#34;array&#34;</span><span class="op" id="2816012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816015">Chan</span><span class="op" id="2816019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816030">&#34;chan&#34;</span><span class="op" id="2816036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816039">Func</span><span class="op" id="2816043">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816054">&#34;func&#34;</span><span class="op" id="2816060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816063">Interface</span><span class="op" id="2816072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816078">&#34;interface&#34;</span><span class="op" id="2816089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816092">Map</span><span class="op" id="2816095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816107">&#34;map&#34;</span><span class="op" id="2816112">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816115">Ptr</span><span class="op" id="2816118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816130">&#34;ptr&#34;</span><span class="op" id="2816135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816138">Slice</span><span class="op" id="2816143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816153">&#34;slice&#34;</span><span class="op" id="2816160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816163">String</span><span class="op" id="2816169">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816178">&#34;string&#34;</span><span class="op" id="2816186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816189">Struct</span><span class="op" id="2816195">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816204">&#34;struct&#34;</span><span class="op" id="2816212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816215">UnsafePointer</span><span class="op" id="2816228">:</span>&nbsp;<span class="string" id="2816230">&#34;unsafe.Pointer&#34;</span><span class="op" id="2816246">,</span><br>
<span class="lineno">440</span><span class="op" id="2816248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816251">func</span>&nbsp;<span class="op" id="2816256">(</span><span class="ident" id="2816257">t</span>&nbsp;<span class="op" id="2816259">*</span><span class="ident" id="2816260">uncommonType</span><span class="op" id="2816272">)</span>&nbsp;<span class="ident" id="2816274">uncommon</span><span class="op" id="2816282">(</span><span class="op" id="2816283">)</span>&nbsp;<span class="op" id="2816285">*</span><span class="ident" id="2816286">uncommonType</span>&nbsp;<span class="op" id="2816299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816302">return</span>&nbsp;<span class="ident" id="2816309">t</span><br>
<span class="lineno"></span><span class="op" id="2816311">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2816314">func</span>&nbsp;<span class="op" id="2816319">(</span><span class="ident" id="2816320">t</span>&nbsp;<span class="op" id="2816322">*</span><span class="ident" id="2816323">uncommonType</span><span class="op" id="2816335">)</span>&nbsp;<span class="ident" id="2816337">PkgPath</span><span class="op" id="2816344">(</span><span class="op" id="2816345">)</span>&nbsp;<span class="builtintype" id="2816347">string</span>&nbsp;<span class="op" id="2816354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816357">if</span>&nbsp;<span class="ident" id="2816360">t</span>&nbsp;<span class="op" id="2816362">==</span>&nbsp;<span class="ident" id="2816365">nil</span>&nbsp;<span class="op" id="2816369">||</span>&nbsp;<span class="ident" id="2816372">t</span><span class="op" id="2816373">.</span><span class="ident" id="2816374">pkgPath</span>&nbsp;<span class="op" id="2816382">==</span>&nbsp;<span class="ident" id="2816385">nil</span>&nbsp;<span class="op" id="2816389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816393">return</span>&nbsp;<span class="string" id="2816400">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816404">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816407">return</span>&nbsp;<span class="op" id="2816414">*</span><span class="ident" id="2816415">t</span><span class="op" id="2816416">.</span><span class="ident" id="2816417">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2816425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816428">func</span>&nbsp;<span class="op" id="2816433">(</span><span class="ident" id="2816434">t</span>&nbsp;<span class="op" id="2816436">*</span><span class="ident" id="2816437">uncommonType</span><span class="op" id="2816449">)</span>&nbsp;<span class="ident" id="2816451">Name</span><span class="op" id="2816455">(</span><span class="op" id="2816456">)</span>&nbsp;<span class="builtintype" id="2816458">string</span>&nbsp;<span class="op" id="2816465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816468">if</span>&nbsp;<span class="ident" id="2816471">t</span>&nbsp;<span class="op" id="2816473">==</span>&nbsp;<span class="ident" id="2816476">nil</span>&nbsp;<span class="op" id="2816480">||</span>&nbsp;<span class="ident" id="2816483">t</span><span class="op" id="2816484">.</span><span class="ident" id="2816485">name</span>&nbsp;<span class="op" id="2816490">==</span>&nbsp;<span class="ident" id="2816493">nil</span>&nbsp;<span class="op" id="2816497">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816501">return</span>&nbsp;<span class="string" id="2816508">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816515">return</span>&nbsp;<span class="op" id="2816522">*</span><span class="ident" id="2816523">t</span><span class="op" id="2816524">.</span><span class="ident" id="2816525">name</span><br>
<span class="lineno"></span><span class="op" id="2816530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2816533">func</span>&nbsp;<span class="op" id="2816538">(</span><span class="ident" id="2816539">t</span>&nbsp;<span class="op" id="2816541">*</span><span class="ident" id="2816542">rtype</span><span class="op" id="2816547">)</span>&nbsp;<span class="ident" id="2816549">String</span><span class="op" id="2816555">(</span><span class="op" id="2816556">)</span>&nbsp;<span class="builtintype" id="2816558">string</span>&nbsp;<span class="op" id="2816565">{</span>&nbsp;<span class="keyword" id="2816567">return</span>&nbsp;<span class="op" id="2816574">*</span><span class="ident" id="2816575">t</span><span class="op" id="2816576">.</span><span class="builtintype" id="2816577">string</span>&nbsp;<span class="op" id="2816584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816587">func</span>&nbsp;<span class="op" id="2816592">(</span><span class="ident" id="2816593">t</span>&nbsp;<span class="op" id="2816595">*</span><span class="ident" id="2816596">rtype</span><span class="op" id="2816601">)</span>&nbsp;<span class="ident" id="2816603">Size</span><span class="op" id="2816607">(</span><span class="op" id="2816608">)</span>&nbsp;<span class="builtintype" id="2816610">uintptr</span>&nbsp;<span class="op" id="2816618">{</span>&nbsp;<span class="keyword" id="2816620">return</span>&nbsp;<span class="ident" id="2816627">t</span><span class="op" id="2816628">.</span><span class="ident" id="2816629">size</span>&nbsp;<span class="op" id="2816634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816637">func</span>&nbsp;<span class="op" id="2816642">(</span><span class="ident" id="2816643">t</span>&nbsp;<span class="op" id="2816645">*</span><span class="ident" id="2816646">rtype</span><span class="op" id="2816651">)</span>&nbsp;<span class="ident" id="2816653">Bits</span><span class="op" id="2816657">(</span><span class="op" id="2816658">)</span>&nbsp;<span class="builtintype" id="2816660">int</span>&nbsp;<span class="op" id="2816664">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816667">if</span>&nbsp;<span class="ident" id="2816670">t</span>&nbsp;<span class="op" id="2816672">==</span>&nbsp;<span class="ident" id="2816675">nil</span>&nbsp;<span class="op" id="2816679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2816683">panic</span><span class="op" id="2816688">(</span><span class="string" id="2816689">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2816716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816722">k</span>&nbsp;<span class="op" id="2816724">:=</span>&nbsp;<span class="ident" id="2816727">t</span><span class="op" id="2816728">.</span><span class="ident" id="2816729">Kind</span><span class="op" id="2816733">(</span><span class="op" id="2816734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816737">if</span>&nbsp;<span class="ident" id="2816740">k</span>&nbsp;<span class="op" id="2816742">&lt;</span>&nbsp;<span class="ident" id="2816744">Int</span>&nbsp;<span class="op" id="2816748">||</span>&nbsp;<span class="ident" id="2816751">k</span>&nbsp;<span class="op" id="2816753">&gt;</span>&nbsp;<span class="ident" id="2816755">Complex128</span>&nbsp;<span class="op" id="2816766">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2816770">panic</span><span class="op" id="2816775">(</span><span class="string" id="2816776">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2816816">+</span>&nbsp;<span class="ident" id="2816818">t</span><span class="op" id="2816819">.</span><span class="ident" id="2816820">String</span><span class="op" id="2816826">(</span><span class="op" id="2816827">)</span><span class="op" id="2816828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816834">return</span>&nbsp;<span class="builtintype" id="2816841">int</span><span class="op" id="2816844">(</span><span class="ident" id="2816845">t</span><span class="op" id="2816846">.</span><span class="ident" id="2816847">size</span><span class="op" id="2816851">)</span>&nbsp;<span class="op" id="2816853">*</span>&nbsp;<span class="num" id="2816855">8</span><br>
<span class="lineno"></span><span class="op" id="2816857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2816860">func</span>&nbsp;<span class="op" id="2816865">(</span><span class="ident" id="2816866">t</span>&nbsp;<span class="op" id="2816868">*</span><span class="ident" id="2816869">rtype</span><span class="op" id="2816874">)</span>&nbsp;<span class="ident" id="2816876">Align</span><span class="op" id="2816881">(</span><span class="op" id="2816882">)</span>&nbsp;<span class="builtintype" id="2816884">int</span>&nbsp;<span class="op" id="2816888">{</span>&nbsp;<span class="keyword" id="2816890">return</span>&nbsp;<span class="builtintype" id="2816897">int</span><span class="op" id="2816900">(</span><span class="ident" id="2816901">t</span><span class="op" id="2816902">.</span><span class="ident" id="2816903">align</span><span class="op" id="2816908">)</span>&nbsp;<span class="op" id="2816910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816913">func</span>&nbsp;<span class="op" id="2816918">(</span><span class="ident" id="2816919">t</span>&nbsp;<span class="op" id="2816921">*</span><span class="ident" id="2816922">rtype</span><span class="op" id="2816927">)</span>&nbsp;<span class="ident" id="2816929">FieldAlign</span><span class="op" id="2816939">(</span><span class="op" id="2816940">)</span>&nbsp;<span class="builtintype" id="2816942">int</span>&nbsp;<span class="op" id="2816946">{</span>&nbsp;<span class="keyword" id="2816948">return</span>&nbsp;<span class="builtintype" id="2816955">int</span><span class="op" id="2816958">(</span><span class="ident" id="2816959">t</span><span class="op" id="2816960">.</span><span class="ident" id="2816961">fieldAlign</span><span class="op" id="2816971">)</span>&nbsp;<span class="op" id="2816973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816976">func</span>&nbsp;<span class="op" id="2816981">(</span><span class="ident" id="2816982">t</span>&nbsp;<span class="op" id="2816984">*</span><span class="ident" id="2816985">rtype</span><span class="op" id="2816990">)</span>&nbsp;<span class="ident" id="2816992">Kind</span><span class="op" id="2816996">(</span><span class="op" id="2816997">)</span>&nbsp;<span class="ident" id="2816999">Kind</span>&nbsp;<span class="op" id="2817004">{</span>&nbsp;<span class="keyword" id="2817006">return</span>&nbsp;<span class="ident" id="2817013">Kind</span><span class="op" id="2817017">(</span><span class="ident" id="2817018">t</span><span class="op" id="2817019">.</span><span class="ident" id="2817020">kind</span>&nbsp;<span class="op" id="2817025">&amp;</span>&nbsp;<span class="ident" id="2817027">kindMask</span><span class="op" id="2817035">)</span>&nbsp;<span class="op" id="2817037">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2817040">func</span>&nbsp;<span class="op" id="2817045">(</span><span class="ident" id="2817046">t</span>&nbsp;<span class="op" id="2817048">*</span><span class="ident" id="2817049">rtype</span><span class="op" id="2817054">)</span>&nbsp;<span class="ident" id="2817056">pointers</span><span class="op" id="2817064">(</span><span class="op" id="2817065">)</span>&nbsp;<span class="builtintype" id="2817067">bool</span>&nbsp;<span class="op" id="2817072">{</span>&nbsp;<span class="keyword" id="2817074">return</span>&nbsp;<span class="ident" id="2817081">t</span><span class="op" id="2817082">.</span><span class="ident" id="2817083">kind</span><span class="op" id="2817087">&amp;</span><span class="ident" id="2817088">kindNoPointers</span>&nbsp;<span class="op" id="2817103">==</span>&nbsp;<span class="num" id="2817106">0</span>&nbsp;<span class="op" id="2817108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2817111">func</span>&nbsp;<span class="op" id="2817116">(</span><span class="ident" id="2817117">t</span>&nbsp;<span class="op" id="2817119">*</span><span class="ident" id="2817120">rtype</span><span class="op" id="2817125">)</span>&nbsp;<span class="ident" id="2817127">common</span><span class="op" id="2817133">(</span><span class="op" id="2817134">)</span>&nbsp;<span class="op" id="2817136">*</span><span class="ident" id="2817137">rtype</span>&nbsp;<span class="op" id="2817143">{</span>&nbsp;<span class="keyword" id="2817145">return</span>&nbsp;<span class="ident" id="2817152">t</span>&nbsp;<span class="op" id="2817154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2817157">func</span>&nbsp;<span class="op" id="2817162">(</span><span class="ident" id="2817163">t</span>&nbsp;<span class="op" id="2817165">*</span><span class="ident" id="2817166">uncommonType</span><span class="op" id="2817178">)</span>&nbsp;<span class="ident" id="2817180">Method</span><span class="op" id="2817186">(</span><span class="ident" id="2817187">i</span>&nbsp;<span class="builtintype" id="2817189">int</span><span class="op" id="2817192">)</span>&nbsp;<span class="op" id="2817194">(</span><span class="ident" id="2817195">m</span>&nbsp;<span class="ident" id="2817197">Method</span><span class="op" id="2817203">)</span>&nbsp;<span class="op" id="2817205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817208">if</span>&nbsp;<span class="ident" id="2817211">t</span>&nbsp;<span class="op" id="2817213">==</span>&nbsp;<span class="ident" id="2817216">nil</span>&nbsp;<span class="op" id="2817220">||</span>&nbsp;<span class="ident" id="2817223">i</span>&nbsp;<span class="op" id="2817225">&lt;</span>&nbsp;<span class="num" id="2817227">0</span>&nbsp;<span class="op" id="2817229">||</span>&nbsp;<span class="ident" id="2817232">i</span>&nbsp;<span class="op" id="2817234">&gt;=</span>&nbsp;<span class="builtinfunc" id="2817237">len</span><span class="op" id="2817240">(</span><span class="ident" id="2817241">t</span><span class="op" id="2817242">.</span><span class="ident" id="2817243">methods</span><span class="op" id="2817250">)</span>&nbsp;<span class="op" id="2817252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2817256">panic</span><span class="op" id="2817261">(</span><span class="string" id="2817262">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2817298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817304">p</span>&nbsp;<span class="op" id="2817306">:=</span>&nbsp;<span class="op" id="2817309">&amp;</span><span class="ident" id="2817310">t</span><span class="op" id="2817311">.</span><span class="ident" id="2817312">methods</span><span class="op" id="2817319">[</span><span class="ident" id="2817320">i</span><span class="op" id="2817321">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817324">if</span>&nbsp;<span class="ident" id="2817327">p</span><span class="op" id="2817328">.</span><span class="ident" id="2817329">name</span>&nbsp;<span class="op" id="2817334">!=</span>&nbsp;<span class="ident" id="2817337">nil</span>&nbsp;<span class="op" id="2817341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817345">m</span><span class="op" id="2817346">.</span><span class="ident" id="2817347">Name</span>&nbsp;<span class="op" id="2817352">=</span>&nbsp;<span class="op" id="2817354">*</span><span class="ident" id="2817355">p</span><span class="op" id="2817356">.</span><span class="ident" id="2817357">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817366">fl</span>&nbsp;<span class="op" id="2817369">:=</span>&nbsp;<span class="ident" id="2817372">flag</span><span class="op" id="2817376">(</span><span class="ident" id="2817377">Func</span><span class="op" id="2817381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817384">if</span>&nbsp;<span class="ident" id="2817387">p</span><span class="op" id="2817388">.</span><span class="ident" id="2817389">pkgPath</span>&nbsp;<span class="op" id="2817397">!=</span>&nbsp;<span class="ident" id="2817400">nil</span>&nbsp;<span class="op" id="2817404">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817408">m</span><span class="op" id="2817409">.</span><span class="ident" id="2817410">PkgPath</span>&nbsp;<span class="op" id="2817418">=</span>&nbsp;<span class="op" id="2817420">*</span><span class="ident" id="2817421">p</span><span class="op" id="2817422">.</span><span class="ident" id="2817423">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817433">fl</span>&nbsp;<span class="op" id="2817436">|=</span>&nbsp;<span class="ident" id="2817439">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817450">mt</span>&nbsp;<span class="op" id="2817453">:=</span>&nbsp;<span class="ident" id="2817456">p</span><span class="op" id="2817457">.</span><span class="ident" id="2817458">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817463">m</span><span class="op" id="2817464">.</span><span class="ident" id="2817465">Type</span>&nbsp;<span class="op" id="2817470">=</span>&nbsp;<span class="ident" id="2817472">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817476">fn</span>&nbsp;<span class="op" id="2817479">:=</span>&nbsp;<span class="ident" id="2817482">unsafe</span><span class="op" id="2817488">.</span><span class="ident" id="2817489">Pointer</span><span class="op" id="2817496">(</span><span class="op" id="2817497">&amp;</span><span class="ident" id="2817498">p</span><span class="op" id="2817499">.</span><span class="ident" id="2817500">tfn</span><span class="op" id="2817503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817506">m</span><span class="op" id="2817507">.</span><span class="ident" id="2817508">Func</span>&nbsp;<span class="op" id="2817513">=</span>&nbsp;<span class="ident" id="2817515">Value</span><span class="op" id="2817520">{</span><span class="ident" id="2817521">mt</span><span class="op" id="2817523">,</span>&nbsp;<span class="ident" id="2817525">fn</span><span class="op" id="2817527">,</span>&nbsp;<span class="ident" id="2817529">fl</span><span class="op" id="2817531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817534">m</span><span class="op" id="2817535">.</span><span class="ident" id="2817536">Index</span>&nbsp;<span class="op" id="2817542">=</span>&nbsp;<span class="ident" id="2817544">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817547">return</span><br>
<span class="lineno"></span><span class="op" id="2817554">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2817557">func</span>&nbsp;<span class="op" id="2817562">(</span><span class="ident" id="2817563">t</span>&nbsp;<span class="op" id="2817565">*</span><span class="ident" id="2817566">uncommonType</span><span class="op" id="2817578">)</span>&nbsp;<span class="ident" id="2817580">NumMethod</span><span class="op" id="2817589">(</span><span class="op" id="2817590">)</span>&nbsp;<span class="builtintype" id="2817592">int</span>&nbsp;<span class="op" id="2817596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817599">if</span>&nbsp;<span class="ident" id="2817602">t</span>&nbsp;<span class="op" id="2817604">==</span>&nbsp;<span class="ident" id="2817607">nil</span>&nbsp;<span class="op" id="2817611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817615">return</span>&nbsp;<span class="num" id="2817622">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817625">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817628">return</span>&nbsp;<span class="builtinfunc" id="2817635">len</span><span class="op" id="2817638">(</span><span class="ident" id="2817639">t</span><span class="op" id="2817640">.</span><span class="ident" id="2817641">methods</span><span class="op" id="2817648">)</span><br>
<span class="lineno"></span><span class="op" id="2817650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2817653">func</span>&nbsp;<span class="op" id="2817658">(</span><span class="ident" id="2817659">t</span>&nbsp;<span class="op" id="2817661">*</span><span class="ident" id="2817662">uncommonType</span><span class="op" id="2817674">)</span>&nbsp;<span class="ident" id="2817676">MethodByName</span><span class="op" id="2817688">(</span><span class="ident" id="2817689">name</span>&nbsp;<span class="builtintype" id="2817694">string</span><span class="op" id="2817700">)</span>&nbsp;<span class="op" id="2817702">(</span><span class="ident" id="2817703">m</span>&nbsp;<span class="ident" id="2817705">Method</span><span class="op" id="2817711">,</span>&nbsp;<span class="ident" id="2817713">ok</span>&nbsp;<span class="builtintype" id="2817716">bool</span><span class="op" id="2817720">)</span>&nbsp;<span class="op" id="2817722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817725">if</span>&nbsp;<span class="ident" id="2817728">t</span>&nbsp;<span class="op" id="2817730">==</span>&nbsp;<span class="ident" id="2817733">nil</span>&nbsp;<span class="op" id="2817737">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817752">var</span>&nbsp;<span class="ident" id="2817756">p</span>&nbsp;<span class="op" id="2817758">*</span><span class="ident" id="2817759">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817767">for</span>&nbsp;<span class="ident" id="2817771">i</span>&nbsp;<span class="op" id="2817773">:=</span>&nbsp;<span class="keyword" id="2817776">range</span>&nbsp;<span class="ident" id="2817782">t</span><span class="op" id="2817783">.</span><span class="ident" id="2817784">methods</span>&nbsp;<span class="op" id="2817792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817796">p</span>&nbsp;<span class="op" id="2817798">=</span>&nbsp;<span class="op" id="2817800">&amp;</span><span class="ident" id="2817801">t</span><span class="op" id="2817802">.</span><span class="ident" id="2817803">methods</span><span class="op" id="2817810">[</span><span class="ident" id="2817811">i</span><span class="op" id="2817812">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817816">if</span>&nbsp;<span class="ident" id="2817819">p</span><span class="op" id="2817820">.</span><span class="ident" id="2817821">name</span>&nbsp;<span class="op" id="2817826">!=</span>&nbsp;<span class="ident" id="2817829">nil</span>&nbsp;<span class="op" id="2817833">&amp;&amp;</span>&nbsp;<span class="op" id="2817836">*</span><span class="ident" id="2817837">p</span><span class="op" id="2817838">.</span><span class="ident" id="2817839">name</span>&nbsp;<span class="op" id="2817844">==</span>&nbsp;<span class="ident" id="2817847">name</span>&nbsp;<span class="op" id="2817852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817857">return</span>&nbsp;<span class="ident" id="2817864">t</span><span class="op" id="2817865">.</span><span class="ident" id="2817866">Method</span><span class="op" id="2817872">(</span><span class="ident" id="2817873">i</span><span class="op" id="2817874">)</span><span class="op" id="2817875">,</span>&nbsp;<span class="builtintype" id="2817877">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2817887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2817890">return</span><br>
<span class="lineno">525</span><span class="op" id="2817897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2817900">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2817950">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2818005">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2818043">func</span>&nbsp;<span class="op" id="2818048">(</span><span class="ident" id="2818049">t</span>&nbsp;<span class="op" id="2818051">*</span><span class="ident" id="2818052">rtype</span><span class="op" id="2818057">)</span>&nbsp;<span class="ident" id="2818059">NumMethod</span><span class="op" id="2818068">(</span><span class="op" id="2818069">)</span>&nbsp;<span class="builtintype" id="2818071">int</span>&nbsp;<span class="op" id="2818075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818078">if</span>&nbsp;<span class="ident" id="2818081">t</span><span class="op" id="2818082">.</span><span class="ident" id="2818083">Kind</span><span class="op" id="2818087">(</span><span class="op" id="2818088">)</span>&nbsp;<span class="op" id="2818090">==</span>&nbsp;<span class="ident" id="2818093">Interface</span>&nbsp;<span class="op" id="2818103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818107">tt</span>&nbsp;<span class="op" id="2818110">:=</span>&nbsp;<span class="op" id="2818113">(</span><span class="op" id="2818114">*</span><span class="ident" id="2818115">interfaceType</span><span class="op" id="2818128">)</span><span class="op" id="2818129">(</span><span class="ident" id="2818130">unsafe</span><span class="op" id="2818136">.</span><span class="ident" id="2818137">Pointer</span><span class="op" id="2818144">(</span><span class="ident" id="2818145">t</span><span class="op" id="2818146">)</span><span class="op" id="2818147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818151">return</span>&nbsp;<span class="ident" id="2818158">tt</span><span class="op" id="2818160">.</span><span class="ident" id="2818161">NumMethod</span><span class="op" id="2818170">(</span><span class="op" id="2818171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818174">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818177">return</span>&nbsp;<span class="ident" id="2818184">t</span><span class="op" id="2818185">.</span><span class="ident" id="2818186">uncommonType</span><span class="op" id="2818198">.</span><span class="ident" id="2818199">NumMethod</span><span class="op" id="2818208">(</span><span class="op" id="2818209">)</span><br>
<span class="lineno"></span><span class="op" id="2818211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2818214">func</span>&nbsp;<span class="op" id="2818219">(</span><span class="ident" id="2818220">t</span>&nbsp;<span class="op" id="2818222">*</span><span class="ident" id="2818223">rtype</span><span class="op" id="2818228">)</span>&nbsp;<span class="ident" id="2818230">Method</span><span class="op" id="2818236">(</span><span class="ident" id="2818237">i</span>&nbsp;<span class="builtintype" id="2818239">int</span><span class="op" id="2818242">)</span>&nbsp;<span class="op" id="2818244">(</span><span class="ident" id="2818245">m</span>&nbsp;<span class="ident" id="2818247">Method</span><span class="op" id="2818253">)</span>&nbsp;<span class="op" id="2818255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818258">if</span>&nbsp;<span class="ident" id="2818261">t</span><span class="op" id="2818262">.</span><span class="ident" id="2818263">Kind</span><span class="op" id="2818267">(</span><span class="op" id="2818268">)</span>&nbsp;<span class="op" id="2818270">==</span>&nbsp;<span class="ident" id="2818273">Interface</span>&nbsp;<span class="op" id="2818283">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818287">tt</span>&nbsp;<span class="op" id="2818290">:=</span>&nbsp;<span class="op" id="2818293">(</span><span class="op" id="2818294">*</span><span class="ident" id="2818295">interfaceType</span><span class="op" id="2818308">)</span><span class="op" id="2818309">(</span><span class="ident" id="2818310">unsafe</span><span class="op" id="2818316">.</span><span class="ident" id="2818317">Pointer</span><span class="op" id="2818324">(</span><span class="ident" id="2818325">t</span><span class="op" id="2818326">)</span><span class="op" id="2818327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818331">return</span>&nbsp;<span class="ident" id="2818338">tt</span><span class="op" id="2818340">.</span><span class="ident" id="2818341">Method</span><span class="op" id="2818347">(</span><span class="ident" id="2818348">i</span><span class="op" id="2818349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818355">return</span>&nbsp;<span class="ident" id="2818362">t</span><span class="op" id="2818363">.</span><span class="ident" id="2818364">uncommonType</span><span class="op" id="2818376">.</span><span class="ident" id="2818377">Method</span><span class="op" id="2818383">(</span><span class="ident" id="2818384">i</span><span class="op" id="2818385">)</span><br>
<span class="lineno"></span><span class="op" id="2818387">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2818390">func</span>&nbsp;<span class="op" id="2818395">(</span><span class="ident" id="2818396">t</span>&nbsp;<span class="op" id="2818398">*</span><span class="ident" id="2818399">rtype</span><span class="op" id="2818404">)</span>&nbsp;<span class="ident" id="2818406">MethodByName</span><span class="op" id="2818418">(</span><span class="ident" id="2818419">name</span>&nbsp;<span class="builtintype" id="2818424">string</span><span class="op" id="2818430">)</span>&nbsp;<span class="op" id="2818432">(</span><span class="ident" id="2818433">m</span>&nbsp;<span class="ident" id="2818435">Method</span><span class="op" id="2818441">,</span>&nbsp;<span class="ident" id="2818443">ok</span>&nbsp;<span class="builtintype" id="2818446">bool</span><span class="op" id="2818450">)</span>&nbsp;<span class="op" id="2818452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818455">if</span>&nbsp;<span class="ident" id="2818458">t</span><span class="op" id="2818459">.</span><span class="ident" id="2818460">Kind</span><span class="op" id="2818464">(</span><span class="op" id="2818465">)</span>&nbsp;<span class="op" id="2818467">==</span>&nbsp;<span class="ident" id="2818470">Interface</span>&nbsp;<span class="op" id="2818480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818484">tt</span>&nbsp;<span class="op" id="2818487">:=</span>&nbsp;<span class="op" id="2818490">(</span><span class="op" id="2818491">*</span><span class="ident" id="2818492">interfaceType</span><span class="op" id="2818505">)</span><span class="op" id="2818506">(</span><span class="ident" id="2818507">unsafe</span><span class="op" id="2818513">.</span><span class="ident" id="2818514">Pointer</span><span class="op" id="2818521">(</span><span class="ident" id="2818522">t</span><span class="op" id="2818523">)</span><span class="op" id="2818524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818528">return</span>&nbsp;<span class="ident" id="2818535">tt</span><span class="op" id="2818537">.</span><span class="ident" id="2818538">MethodByName</span><span class="op" id="2818550">(</span><span class="ident" id="2818551">name</span><span class="op" id="2818555">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818561">return</span>&nbsp;<span class="ident" id="2818568">t</span><span class="op" id="2818569">.</span><span class="ident" id="2818570">uncommonType</span><span class="op" id="2818582">.</span><span class="ident" id="2818583">MethodByName</span><span class="op" id="2818595">(</span><span class="ident" id="2818596">name</span><span class="op" id="2818600">)</span><br>
<span class="lineno"></span><span class="op" id="2818602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2818605">func</span>&nbsp;<span class="op" id="2818610">(</span><span class="ident" id="2818611">t</span>&nbsp;<span class="op" id="2818613">*</span><span class="ident" id="2818614">rtype</span><span class="op" id="2818619">)</span>&nbsp;<span class="ident" id="2818621">PkgPath</span><span class="op" id="2818628">(</span><span class="op" id="2818629">)</span>&nbsp;<span class="builtintype" id="2818631">string</span>&nbsp;<span class="op" id="2818638">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818641">return</span>&nbsp;<span class="ident" id="2818648">t</span><span class="op" id="2818649">.</span><span class="ident" id="2818650">uncommonType</span><span class="op" id="2818662">.</span><span class="ident" id="2818663">PkgPath</span><span class="op" id="2818670">(</span><span class="op" id="2818671">)</span><br>
<span class="lineno"></span><span class="op" id="2818673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2818676">func</span>&nbsp;<span class="op" id="2818681">(</span><span class="ident" id="2818682">t</span>&nbsp;<span class="op" id="2818684">*</span><span class="ident" id="2818685">rtype</span><span class="op" id="2818690">)</span>&nbsp;<span class="ident" id="2818692">Name</span><span class="op" id="2818696">(</span><span class="op" id="2818697">)</span>&nbsp;<span class="builtintype" id="2818699">string</span>&nbsp;<span class="op" id="2818706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818709">return</span>&nbsp;<span class="ident" id="2818716">t</span><span class="op" id="2818717">.</span><span class="ident" id="2818718">uncommonType</span><span class="op" id="2818730">.</span><span class="ident" id="2818731">Name</span><span class="op" id="2818735">(</span><span class="op" id="2818736">)</span><br>
<span class="lineno">560</span><span class="op" id="2818738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2818741">func</span>&nbsp;<span class="op" id="2818746">(</span><span class="ident" id="2818747">t</span>&nbsp;<span class="op" id="2818749">*</span><span class="ident" id="2818750">rtype</span><span class="op" id="2818755">)</span>&nbsp;<span class="ident" id="2818757">ChanDir</span><span class="op" id="2818764">(</span><span class="op" id="2818765">)</span>&nbsp;<span class="ident" id="2818767">ChanDir</span>&nbsp;<span class="op" id="2818775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818778">if</span>&nbsp;<span class="ident" id="2818781">t</span><span class="op" id="2818782">.</span><span class="ident" id="2818783">Kind</span><span class="op" id="2818787">(</span><span class="op" id="2818788">)</span>&nbsp;<span class="op" id="2818790">!=</span>&nbsp;<span class="ident" id="2818793">Chan</span>&nbsp;<span class="op" id="2818798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2818802">panic</span><span class="op" id="2818807">(</span><span class="string" id="2818808">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2818843">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818849">tt</span>&nbsp;<span class="op" id="2818852">:=</span>&nbsp;<span class="op" id="2818855">(</span><span class="op" id="2818856">*</span><span class="ident" id="2818857">chanType</span><span class="op" id="2818865">)</span><span class="op" id="2818866">(</span><span class="ident" id="2818867">unsafe</span><span class="op" id="2818873">.</span><span class="ident" id="2818874">Pointer</span><span class="op" id="2818881">(</span><span class="ident" id="2818882">t</span><span class="op" id="2818883">)</span><span class="op" id="2818884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818887">return</span>&nbsp;<span class="ident" id="2818894">ChanDir</span><span class="op" id="2818901">(</span><span class="ident" id="2818902">tt</span><span class="op" id="2818904">.</span><span class="ident" id="2818905">dir</span><span class="op" id="2818908">)</span><br>
<span class="lineno"></span><span class="op" id="2818910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2818913">func</span>&nbsp;<span class="op" id="2818918">(</span><span class="ident" id="2818919">t</span>&nbsp;<span class="op" id="2818921">*</span><span class="ident" id="2818922">rtype</span><span class="op" id="2818927">)</span>&nbsp;<span class="ident" id="2818929">IsVariadic</span><span class="op" id="2818939">(</span><span class="op" id="2818940">)</span>&nbsp;<span class="builtintype" id="2818942">bool</span>&nbsp;<span class="op" id="2818947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818950">if</span>&nbsp;<span class="ident" id="2818953">t</span><span class="op" id="2818954">.</span><span class="ident" id="2818955">Kind</span><span class="op" id="2818959">(</span><span class="op" id="2818960">)</span>&nbsp;<span class="op" id="2818962">!=</span>&nbsp;<span class="ident" id="2818965">Func</span>&nbsp;<span class="op" id="2818970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2818974">panic</span><span class="op" id="2818979">(</span><span class="string" id="2818980">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2819018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819024">tt</span>&nbsp;<span class="op" id="2819027">:=</span>&nbsp;<span class="op" id="2819030">(</span><span class="op" id="2819031">*</span><span class="ident" id="2819032">funcType</span><span class="op" id="2819040">)</span><span class="op" id="2819041">(</span><span class="ident" id="2819042">unsafe</span><span class="op" id="2819048">.</span><span class="ident" id="2819049">Pointer</span><span class="op" id="2819056">(</span><span class="ident" id="2819057">t</span><span class="op" id="2819058">)</span><span class="op" id="2819059">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819062">return</span>&nbsp;<span class="ident" id="2819069">tt</span><span class="op" id="2819071">.</span><span class="ident" id="2819072">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2819082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819085">func</span>&nbsp;<span class="op" id="2819090">(</span><span class="ident" id="2819091">t</span>&nbsp;<span class="op" id="2819093">*</span><span class="ident" id="2819094">rtype</span><span class="op" id="2819099">)</span>&nbsp;<span class="ident" id="2819101">Elem</span><span class="op" id="2819105">(</span><span class="op" id="2819106">)</span>&nbsp;<span class="ident" id="2819108">Type</span>&nbsp;<span class="op" id="2819113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819116">switch</span>&nbsp;<span class="ident" id="2819123">t</span><span class="op" id="2819124">.</span><span class="ident" id="2819125">Kind</span><span class="op" id="2819129">(</span><span class="op" id="2819130">)</span>&nbsp;<span class="op" id="2819132">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819135">case</span>&nbsp;<span class="ident" id="2819140">Array</span><span class="op" id="2819145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819149">tt</span>&nbsp;<span class="op" id="2819152">:=</span>&nbsp;<span class="op" id="2819155">(</span><span class="op" id="2819156">*</span><span class="ident" id="2819157">arrayType</span><span class="op" id="2819166">)</span><span class="op" id="2819167">(</span><span class="ident" id="2819168">unsafe</span><span class="op" id="2819174">.</span><span class="ident" id="2819175">Pointer</span><span class="op" id="2819182">(</span><span class="ident" id="2819183">t</span><span class="op" id="2819184">)</span><span class="op" id="2819185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819189">return</span>&nbsp;<span class="ident" id="2819196">toType</span><span class="op" id="2819202">(</span><span class="ident" id="2819203">tt</span><span class="op" id="2819205">.</span><span class="ident" id="2819206">elem</span><span class="op" id="2819210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819213">case</span>&nbsp;<span class="ident" id="2819218">Chan</span><span class="op" id="2819222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819226">tt</span>&nbsp;<span class="op" id="2819229">:=</span>&nbsp;<span class="op" id="2819232">(</span><span class="op" id="2819233">*</span><span class="ident" id="2819234">chanType</span><span class="op" id="2819242">)</span><span class="op" id="2819243">(</span><span class="ident" id="2819244">unsafe</span><span class="op" id="2819250">.</span><span class="ident" id="2819251">Pointer</span><span class="op" id="2819258">(</span><span class="ident" id="2819259">t</span><span class="op" id="2819260">)</span><span class="op" id="2819261">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819265">return</span>&nbsp;<span class="ident" id="2819272">toType</span><span class="op" id="2819278">(</span><span class="ident" id="2819279">tt</span><span class="op" id="2819281">.</span><span class="ident" id="2819282">elem</span><span class="op" id="2819286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819289">case</span>&nbsp;<span class="ident" id="2819294">Map</span><span class="op" id="2819297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819301">tt</span>&nbsp;<span class="op" id="2819304">:=</span>&nbsp;<span class="op" id="2819307">(</span><span class="op" id="2819308">*</span><span class="ident" id="2819309">mapType</span><span class="op" id="2819316">)</span><span class="op" id="2819317">(</span><span class="ident" id="2819318">unsafe</span><span class="op" id="2819324">.</span><span class="ident" id="2819325">Pointer</span><span class="op" id="2819332">(</span><span class="ident" id="2819333">t</span><span class="op" id="2819334">)</span><span class="op" id="2819335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819339">return</span>&nbsp;<span class="ident" id="2819346">toType</span><span class="op" id="2819352">(</span><span class="ident" id="2819353">tt</span><span class="op" id="2819355">.</span><span class="ident" id="2819356">elem</span><span class="op" id="2819360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819363">case</span>&nbsp;<span class="ident" id="2819368">Ptr</span><span class="op" id="2819371">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819375">tt</span>&nbsp;<span class="op" id="2819378">:=</span>&nbsp;<span class="op" id="2819381">(</span><span class="op" id="2819382">*</span><span class="ident" id="2819383">ptrType</span><span class="op" id="2819390">)</span><span class="op" id="2819391">(</span><span class="ident" id="2819392">unsafe</span><span class="op" id="2819398">.</span><span class="ident" id="2819399">Pointer</span><span class="op" id="2819406">(</span><span class="ident" id="2819407">t</span><span class="op" id="2819408">)</span><span class="op" id="2819409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819413">return</span>&nbsp;<span class="ident" id="2819420">toType</span><span class="op" id="2819426">(</span><span class="ident" id="2819427">tt</span><span class="op" id="2819429">.</span><span class="ident" id="2819430">elem</span><span class="op" id="2819434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819437">case</span>&nbsp;<span class="ident" id="2819442">Slice</span><span class="op" id="2819447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819451">tt</span>&nbsp;<span class="op" id="2819454">:=</span>&nbsp;<span class="op" id="2819457">(</span><span class="op" id="2819458">*</span><span class="ident" id="2819459">sliceType</span><span class="op" id="2819468">)</span><span class="op" id="2819469">(</span><span class="ident" id="2819470">unsafe</span><span class="op" id="2819476">.</span><span class="ident" id="2819477">Pointer</span><span class="op" id="2819484">(</span><span class="ident" id="2819485">t</span><span class="op" id="2819486">)</span><span class="op" id="2819487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819491">return</span>&nbsp;<span class="ident" id="2819498">toType</span><span class="op" id="2819504">(</span><span class="ident" id="2819505">tt</span><span class="op" id="2819507">.</span><span class="ident" id="2819508">elem</span><span class="op" id="2819512">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2819518">panic</span><span class="op" id="2819523">(</span><span class="string" id="2819524">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2819555">)</span><br>
<span class="lineno"></span><span class="op" id="2819557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819560">func</span>&nbsp;<span class="op" id="2819565">(</span><span class="ident" id="2819566">t</span>&nbsp;<span class="op" id="2819568">*</span><span class="ident" id="2819569">rtype</span><span class="op" id="2819574">)</span>&nbsp;<span class="ident" id="2819576">Field</span><span class="op" id="2819581">(</span><span class="ident" id="2819582">i</span>&nbsp;<span class="builtintype" id="2819584">int</span><span class="op" id="2819587">)</span>&nbsp;<span class="ident" id="2819589">StructField</span>&nbsp;<span class="op" id="2819601">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819604">if</span>&nbsp;<span class="ident" id="2819607">t</span><span class="op" id="2819608">.</span><span class="ident" id="2819609">Kind</span><span class="op" id="2819613">(</span><span class="op" id="2819614">)</span>&nbsp;<span class="op" id="2819616">!=</span>&nbsp;<span class="ident" id="2819619">Struct</span>&nbsp;<span class="op" id="2819626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2819630">panic</span><span class="op" id="2819635">(</span><span class="string" id="2819636">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2819671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819677">tt</span>&nbsp;<span class="op" id="2819680">:=</span>&nbsp;<span class="op" id="2819683">(</span><span class="op" id="2819684">*</span><span class="ident" id="2819685">structType</span><span class="op" id="2819695">)</span><span class="op" id="2819696">(</span><span class="ident" id="2819697">unsafe</span><span class="op" id="2819703">.</span><span class="ident" id="2819704">Pointer</span><span class="op" id="2819711">(</span><span class="ident" id="2819712">t</span><span class="op" id="2819713">)</span><span class="op" id="2819714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819717">return</span>&nbsp;<span class="ident" id="2819724">tt</span><span class="op" id="2819726">.</span><span class="ident" id="2819727">Field</span><span class="op" id="2819732">(</span><span class="ident" id="2819733">i</span><span class="op" id="2819734">)</span><br>
<span class="lineno">605</span><span class="op" id="2819736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819739">func</span>&nbsp;<span class="op" id="2819744">(</span><span class="ident" id="2819745">t</span>&nbsp;<span class="op" id="2819747">*</span><span class="ident" id="2819748">rtype</span><span class="op" id="2819753">)</span>&nbsp;<span class="ident" id="2819755">FieldByIndex</span><span class="op" id="2819767">(</span><span class="ident" id="2819768">index</span>&nbsp;<span class="op" id="2819774">[</span><span class="op" id="2819775">]</span><span class="builtintype" id="2819776">int</span><span class="op" id="2819779">)</span>&nbsp;<span class="ident" id="2819781">StructField</span>&nbsp;<span class="op" id="2819793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819796">if</span>&nbsp;<span class="ident" id="2819799">t</span><span class="op" id="2819800">.</span><span class="ident" id="2819801">Kind</span><span class="op" id="2819805">(</span><span class="op" id="2819806">)</span>&nbsp;<span class="op" id="2819808">!=</span>&nbsp;<span class="ident" id="2819811">Struct</span>&nbsp;<span class="op" id="2819818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2819822">panic</span><span class="op" id="2819827">(</span><span class="string" id="2819828">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2819870">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819876">tt</span>&nbsp;<span class="op" id="2819879">:=</span>&nbsp;<span class="op" id="2819882">(</span><span class="op" id="2819883">*</span><span class="ident" id="2819884">structType</span><span class="op" id="2819894">)</span><span class="op" id="2819895">(</span><span class="ident" id="2819896">unsafe</span><span class="op" id="2819902">.</span><span class="ident" id="2819903">Pointer</span><span class="op" id="2819910">(</span><span class="ident" id="2819911">t</span><span class="op" id="2819912">)</span><span class="op" id="2819913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819916">return</span>&nbsp;<span class="ident" id="2819923">tt</span><span class="op" id="2819925">.</span><span class="ident" id="2819926">FieldByIndex</span><span class="op" id="2819938">(</span><span class="ident" id="2819939">index</span><span class="op" id="2819944">)</span><br>
<span class="lineno"></span><span class="op" id="2819946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2819949">func</span>&nbsp;<span class="op" id="2819954">(</span><span class="ident" id="2819955">t</span>&nbsp;<span class="op" id="2819957">*</span><span class="ident" id="2819958">rtype</span><span class="op" id="2819963">)</span>&nbsp;<span class="ident" id="2819965">FieldByName</span><span class="op" id="2819976">(</span><span class="ident" id="2819977">name</span>&nbsp;<span class="builtintype" id="2819982">string</span><span class="op" id="2819988">)</span>&nbsp;<span class="op" id="2819990">(</span><span class="ident" id="2819991">StructField</span><span class="op" id="2820002">,</span>&nbsp;<span class="builtintype" id="2820004">bool</span><span class="op" id="2820008">)</span>&nbsp;<span class="op" id="2820010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820013">if</span>&nbsp;<span class="ident" id="2820016">t</span><span class="op" id="2820017">.</span><span class="ident" id="2820018">Kind</span><span class="op" id="2820022">(</span><span class="op" id="2820023">)</span>&nbsp;<span class="op" id="2820025">!=</span>&nbsp;<span class="ident" id="2820028">Struct</span>&nbsp;<span class="op" id="2820035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820039">panic</span><span class="op" id="2820044">(</span><span class="string" id="2820045">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2820086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820092">tt</span>&nbsp;<span class="op" id="2820095">:=</span>&nbsp;<span class="op" id="2820098">(</span><span class="op" id="2820099">*</span><span class="ident" id="2820100">structType</span><span class="op" id="2820110">)</span><span class="op" id="2820111">(</span><span class="ident" id="2820112">unsafe</span><span class="op" id="2820118">.</span><span class="ident" id="2820119">Pointer</span><span class="op" id="2820126">(</span><span class="ident" id="2820127">t</span><span class="op" id="2820128">)</span><span class="op" id="2820129">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820132">return</span>&nbsp;<span class="ident" id="2820139">tt</span><span class="op" id="2820141">.</span><span class="ident" id="2820142">FieldByName</span><span class="op" id="2820153">(</span><span class="ident" id="2820154">name</span><span class="op" id="2820158">)</span><br>
<span class="lineno"></span><span class="op" id="2820160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2820163">func</span>&nbsp;<span class="op" id="2820168">(</span><span class="ident" id="2820169">t</span>&nbsp;<span class="op" id="2820171">*</span><span class="ident" id="2820172">rtype</span><span class="op" id="2820177">)</span>&nbsp;<span class="ident" id="2820179">FieldByNameFunc</span><span class="op" id="2820194">(</span><span class="ident" id="2820195">match</span>&nbsp;<span class="keyword" id="2820201">func</span><span class="op" id="2820205">(</span><span class="builtintype" id="2820206">string</span><span class="op" id="2820212">)</span>&nbsp;<span class="builtintype" id="2820214">bool</span><span class="op" id="2820218">)</span>&nbsp;<span class="op" id="2820220">(</span><span class="ident" id="2820221">StructField</span><span class="op" id="2820232">,</span>&nbsp;<span class="builtintype" id="2820234">bool</span><span class="op" id="2820238">)</span>&nbsp;<span class="op" id="2820240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820243">if</span>&nbsp;<span class="ident" id="2820246">t</span><span class="op" id="2820247">.</span><span class="ident" id="2820248">Kind</span><span class="op" id="2820252">(</span><span class="op" id="2820253">)</span>&nbsp;<span class="op" id="2820255">!=</span>&nbsp;<span class="ident" id="2820258">Struct</span>&nbsp;<span class="op" id="2820265">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820269">panic</span><span class="op" id="2820274">(</span><span class="string" id="2820275">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2820320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820326">tt</span>&nbsp;<span class="op" id="2820329">:=</span>&nbsp;<span class="op" id="2820332">(</span><span class="op" id="2820333">*</span><span class="ident" id="2820334">structType</span><span class="op" id="2820344">)</span><span class="op" id="2820345">(</span><span class="ident" id="2820346">unsafe</span><span class="op" id="2820352">.</span><span class="ident" id="2820353">Pointer</span><span class="op" id="2820360">(</span><span class="ident" id="2820361">t</span><span class="op" id="2820362">)</span><span class="op" id="2820363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820366">return</span>&nbsp;<span class="ident" id="2820373">tt</span><span class="op" id="2820375">.</span><span class="ident" id="2820376">FieldByNameFunc</span><span class="op" id="2820391">(</span><span class="ident" id="2820392">match</span><span class="op" id="2820397">)</span><br>
<span class="lineno"></span><span class="op" id="2820399">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2820402">func</span>&nbsp;<span class="op" id="2820407">(</span><span class="ident" id="2820408">t</span>&nbsp;<span class="op" id="2820410">*</span><span class="ident" id="2820411">rtype</span><span class="op" id="2820416">)</span>&nbsp;<span class="ident" id="2820418">In</span><span class="op" id="2820420">(</span><span class="ident" id="2820421">i</span>&nbsp;<span class="builtintype" id="2820423">int</span><span class="op" id="2820426">)</span>&nbsp;<span class="ident" id="2820428">Type</span>&nbsp;<span class="op" id="2820433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820436">if</span>&nbsp;<span class="ident" id="2820439">t</span><span class="op" id="2820440">.</span><span class="ident" id="2820441">Kind</span><span class="op" id="2820445">(</span><span class="op" id="2820446">)</span>&nbsp;<span class="op" id="2820448">!=</span>&nbsp;<span class="ident" id="2820451">Func</span>&nbsp;<span class="op" id="2820456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820460">panic</span><span class="op" id="2820465">(</span><span class="string" id="2820466">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2820496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820499">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820502">tt</span>&nbsp;<span class="op" id="2820505">:=</span>&nbsp;<span class="op" id="2820508">(</span><span class="op" id="2820509">*</span><span class="ident" id="2820510">funcType</span><span class="op" id="2820518">)</span><span class="op" id="2820519">(</span><span class="ident" id="2820520">unsafe</span><span class="op" id="2820526">.</span><span class="ident" id="2820527">Pointer</span><span class="op" id="2820534">(</span><span class="ident" id="2820535">t</span><span class="op" id="2820536">)</span><span class="op" id="2820537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820540">return</span>&nbsp;<span class="ident" id="2820547">toType</span><span class="op" id="2820553">(</span><span class="ident" id="2820554">tt</span><span class="op" id="2820556">.</span><span class="ident" id="2820557">in</span><span class="op" id="2820559">[</span><span class="ident" id="2820560">i</span><span class="op" id="2820561">]</span><span class="op" id="2820562">)</span><br>
<span class="lineno"></span><span class="op" id="2820564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2820567">func</span>&nbsp;<span class="op" id="2820572">(</span><span class="ident" id="2820573">t</span>&nbsp;<span class="op" id="2820575">*</span><span class="ident" id="2820576">rtype</span><span class="op" id="2820581">)</span>&nbsp;<span class="ident" id="2820583">Key</span><span class="op" id="2820586">(</span><span class="op" id="2820587">)</span>&nbsp;<span class="ident" id="2820589">Type</span>&nbsp;<span class="op" id="2820594">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820597">if</span>&nbsp;<span class="ident" id="2820600">t</span><span class="op" id="2820601">.</span><span class="ident" id="2820602">Kind</span><span class="op" id="2820606">(</span><span class="op" id="2820607">)</span>&nbsp;<span class="op" id="2820609">!=</span>&nbsp;<span class="ident" id="2820612">Map</span>&nbsp;<span class="op" id="2820616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820620">panic</span><span class="op" id="2820625">(</span><span class="string" id="2820626">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2820656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820662">tt</span>&nbsp;<span class="op" id="2820665">:=</span>&nbsp;<span class="op" id="2820668">(</span><span class="op" id="2820669">*</span><span class="ident" id="2820670">mapType</span><span class="op" id="2820677">)</span><span class="op" id="2820678">(</span><span class="ident" id="2820679">unsafe</span><span class="op" id="2820685">.</span><span class="ident" id="2820686">Pointer</span><span class="op" id="2820693">(</span><span class="ident" id="2820694">t</span><span class="op" id="2820695">)</span><span class="op" id="2820696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820699">return</span>&nbsp;<span class="ident" id="2820706">toType</span><span class="op" id="2820712">(</span><span class="ident" id="2820713">tt</span><span class="op" id="2820715">.</span><span class="ident" id="2820716">key</span><span class="op" id="2820719">)</span><br>
<span class="lineno">645</span><span class="op" id="2820721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2820724">func</span>&nbsp;<span class="op" id="2820729">(</span><span class="ident" id="2820730">t</span>&nbsp;<span class="op" id="2820732">*</span><span class="ident" id="2820733">rtype</span><span class="op" id="2820738">)</span>&nbsp;<span class="ident" id="2820740">Len</span><span class="op" id="2820743">(</span><span class="op" id="2820744">)</span>&nbsp;<span class="builtintype" id="2820746">int</span>&nbsp;<span class="op" id="2820750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820753">if</span>&nbsp;<span class="ident" id="2820756">t</span><span class="op" id="2820757">.</span><span class="ident" id="2820758">Kind</span><span class="op" id="2820762">(</span><span class="op" id="2820763">)</span>&nbsp;<span class="op" id="2820765">!=</span>&nbsp;<span class="ident" id="2820768">Array</span>&nbsp;<span class="op" id="2820774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820778">panic</span><span class="op" id="2820783">(</span><span class="string" id="2820784">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2820816">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820822">tt</span>&nbsp;<span class="op" id="2820825">:=</span>&nbsp;<span class="op" id="2820828">(</span><span class="op" id="2820829">*</span><span class="ident" id="2820830">arrayType</span><span class="op" id="2820839">)</span><span class="op" id="2820840">(</span><span class="ident" id="2820841">unsafe</span><span class="op" id="2820847">.</span><span class="ident" id="2820848">Pointer</span><span class="op" id="2820855">(</span><span class="ident" id="2820856">t</span><span class="op" id="2820857">)</span><span class="op" id="2820858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820861">return</span>&nbsp;<span class="builtintype" id="2820868">int</span><span class="op" id="2820871">(</span><span class="ident" id="2820872">tt</span><span class="op" id="2820874">.</span><span class="builtinfunc" id="2820875">len</span><span class="op" id="2820878">)</span><br>
<span class="lineno"></span><span class="op" id="2820880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2820883">func</span>&nbsp;<span class="op" id="2820888">(</span><span class="ident" id="2820889">t</span>&nbsp;<span class="op" id="2820891">*</span><span class="ident" id="2820892">rtype</span><span class="op" id="2820897">)</span>&nbsp;<span class="ident" id="2820899">NumField</span><span class="op" id="2820907">(</span><span class="op" id="2820908">)</span>&nbsp;<span class="builtintype" id="2820910">int</span>&nbsp;<span class="op" id="2820914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820917">if</span>&nbsp;<span class="ident" id="2820920">t</span><span class="op" id="2820921">.</span><span class="ident" id="2820922">Kind</span><span class="op" id="2820926">(</span><span class="op" id="2820927">)</span>&nbsp;<span class="op" id="2820929">!=</span>&nbsp;<span class="ident" id="2820932">Struct</span>&nbsp;<span class="op" id="2820939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2820943">panic</span><span class="op" id="2820948">(</span><span class="string" id="2820949">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2820987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820993">tt</span>&nbsp;<span class="op" id="2820996">:=</span>&nbsp;<span class="op" id="2820999">(</span><span class="op" id="2821000">*</span><span class="ident" id="2821001">structType</span><span class="op" id="2821011">)</span><span class="op" id="2821012">(</span><span class="ident" id="2821013">unsafe</span><span class="op" id="2821019">.</span><span class="ident" id="2821020">Pointer</span><span class="op" id="2821027">(</span><span class="ident" id="2821028">t</span><span class="op" id="2821029">)</span><span class="op" id="2821030">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821033">return</span>&nbsp;<span class="builtinfunc" id="2821040">len</span><span class="op" id="2821043">(</span><span class="ident" id="2821044">tt</span><span class="op" id="2821046">.</span><span class="ident" id="2821047">fields</span><span class="op" id="2821053">)</span><br>
<span class="lineno"></span><span class="op" id="2821055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2821058">func</span>&nbsp;<span class="op" id="2821063">(</span><span class="ident" id="2821064">t</span>&nbsp;<span class="op" id="2821066">*</span><span class="ident" id="2821067">rtype</span><span class="op" id="2821072">)</span>&nbsp;<span class="ident" id="2821074">NumIn</span><span class="op" id="2821079">(</span><span class="op" id="2821080">)</span>&nbsp;<span class="builtintype" id="2821082">int</span>&nbsp;<span class="op" id="2821086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821089">if</span>&nbsp;<span class="ident" id="2821092">t</span><span class="op" id="2821093">.</span><span class="ident" id="2821094">Kind</span><span class="op" id="2821098">(</span><span class="op" id="2821099">)</span>&nbsp;<span class="op" id="2821101">!=</span>&nbsp;<span class="ident" id="2821104">Func</span>&nbsp;<span class="op" id="2821109">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2821113">panic</span><span class="op" id="2821118">(</span><span class="string" id="2821119">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2821152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821158">tt</span>&nbsp;<span class="op" id="2821161">:=</span>&nbsp;<span class="op" id="2821164">(</span><span class="op" id="2821165">*</span><span class="ident" id="2821166">funcType</span><span class="op" id="2821174">)</span><span class="op" id="2821175">(</span><span class="ident" id="2821176">unsafe</span><span class="op" id="2821182">.</span><span class="ident" id="2821183">Pointer</span><span class="op" id="2821190">(</span><span class="ident" id="2821191">t</span><span class="op" id="2821192">)</span><span class="op" id="2821193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821196">return</span>&nbsp;<span class="builtinfunc" id="2821203">len</span><span class="op" id="2821206">(</span><span class="ident" id="2821207">tt</span><span class="op" id="2821209">.</span><span class="ident" id="2821210">in</span><span class="op" id="2821212">)</span><br>
<span class="lineno"></span><span class="op" id="2821214">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2821217">func</span>&nbsp;<span class="op" id="2821222">(</span><span class="ident" id="2821223">t</span>&nbsp;<span class="op" id="2821225">*</span><span class="ident" id="2821226">rtype</span><span class="op" id="2821231">)</span>&nbsp;<span class="ident" id="2821233">NumOut</span><span class="op" id="2821239">(</span><span class="op" id="2821240">)</span>&nbsp;<span class="builtintype" id="2821242">int</span>&nbsp;<span class="op" id="2821246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821249">if</span>&nbsp;<span class="ident" id="2821252">t</span><span class="op" id="2821253">.</span><span class="ident" id="2821254">Kind</span><span class="op" id="2821258">(</span><span class="op" id="2821259">)</span>&nbsp;<span class="op" id="2821261">!=</span>&nbsp;<span class="ident" id="2821264">Func</span>&nbsp;<span class="op" id="2821269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2821273">panic</span><span class="op" id="2821278">(</span><span class="string" id="2821279">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2821313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821316">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821319">tt</span>&nbsp;<span class="op" id="2821322">:=</span>&nbsp;<span class="op" id="2821325">(</span><span class="op" id="2821326">*</span><span class="ident" id="2821327">funcType</span><span class="op" id="2821335">)</span><span class="op" id="2821336">(</span><span class="ident" id="2821337">unsafe</span><span class="op" id="2821343">.</span><span class="ident" id="2821344">Pointer</span><span class="op" id="2821351">(</span><span class="ident" id="2821352">t</span><span class="op" id="2821353">)</span><span class="op" id="2821354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821357">return</span>&nbsp;<span class="builtinfunc" id="2821364">len</span><span class="op" id="2821367">(</span><span class="ident" id="2821368">tt</span><span class="op" id="2821370">.</span><span class="ident" id="2821371">out</span><span class="op" id="2821374">)</span><br>
<span class="lineno"></span><span class="op" id="2821376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2821379">func</span>&nbsp;<span class="op" id="2821384">(</span><span class="ident" id="2821385">t</span>&nbsp;<span class="op" id="2821387">*</span><span class="ident" id="2821388">rtype</span><span class="op" id="2821393">)</span>&nbsp;<span class="ident" id="2821395">Out</span><span class="op" id="2821398">(</span><span class="ident" id="2821399">i</span>&nbsp;<span class="builtintype" id="2821401">int</span><span class="op" id="2821404">)</span>&nbsp;<span class="ident" id="2821406">Type</span>&nbsp;<span class="op" id="2821411">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821414">if</span>&nbsp;<span class="ident" id="2821417">t</span><span class="op" id="2821418">.</span><span class="ident" id="2821419">Kind</span><span class="op" id="2821423">(</span><span class="op" id="2821424">)</span>&nbsp;<span class="op" id="2821426">!=</span>&nbsp;<span class="ident" id="2821429">Func</span>&nbsp;<span class="op" id="2821434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2821438">panic</span><span class="op" id="2821443">(</span><span class="string" id="2821444">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2821475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821481">tt</span>&nbsp;<span class="op" id="2821484">:=</span>&nbsp;<span class="op" id="2821487">(</span><span class="op" id="2821488">*</span><span class="ident" id="2821489">funcType</span><span class="op" id="2821497">)</span><span class="op" id="2821498">(</span><span class="ident" id="2821499">unsafe</span><span class="op" id="2821505">.</span><span class="ident" id="2821506">Pointer</span><span class="op" id="2821513">(</span><span class="ident" id="2821514">t</span><span class="op" id="2821515">)</span><span class="op" id="2821516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821519">return</span>&nbsp;<span class="ident" id="2821526">toType</span><span class="op" id="2821532">(</span><span class="ident" id="2821533">tt</span><span class="op" id="2821535">.</span><span class="ident" id="2821536">out</span><span class="op" id="2821539">[</span><span class="ident" id="2821540">i</span><span class="op" id="2821541">]</span><span class="op" id="2821542">)</span><br>
<span class="lineno">685</span><span class="op" id="2821544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2821547">func</span>&nbsp;<span class="op" id="2821552">(</span><span class="ident" id="2821553">d</span>&nbsp;<span class="ident" id="2821555">ChanDir</span><span class="op" id="2821562">)</span>&nbsp;<span class="ident" id="2821564">String</span><span class="op" id="2821570">(</span><span class="op" id="2821571">)</span>&nbsp;<span class="builtintype" id="2821573">string</span>&nbsp;<span class="op" id="2821580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821583">switch</span>&nbsp;<span class="ident" id="2821590">d</span>&nbsp;<span class="op" id="2821592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821595">case</span>&nbsp;<span class="ident" id="2821600">SendDir</span><span class="op" id="2821607">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821611">return</span>&nbsp;<span class="string" id="2821618">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821628">case</span>&nbsp;<span class="ident" id="2821633">RecvDir</span><span class="op" id="2821640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821644">return</span>&nbsp;<span class="string" id="2821651">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821661">case</span>&nbsp;<span class="ident" id="2821666">BothDir</span><span class="op" id="2821673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821677">return</span>&nbsp;<span class="string" id="2821684">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821695">return</span>&nbsp;<span class="string" id="2821702">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2821712">+</span>&nbsp;<span class="ident" id="2821714">strconv</span><span class="op" id="2821721">.</span><span class="ident" id="2821722">Itoa</span><span class="op" id="2821726">(</span><span class="builtintype" id="2821727">int</span><span class="op" id="2821730">(</span><span class="ident" id="2821731">d</span><span class="op" id="2821732">)</span><span class="op" id="2821733">)</span><br>
<span class="lineno"></span><span class="op" id="2821735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2821738">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2821798">func</span>&nbsp;<span class="op" id="2821803">(</span><span class="ident" id="2821804">t</span>&nbsp;<span class="op" id="2821806">*</span><span class="ident" id="2821807">interfaceType</span><span class="op" id="2821820">)</span>&nbsp;<span class="ident" id="2821822">Method</span><span class="op" id="2821828">(</span><span class="ident" id="2821829">i</span>&nbsp;<span class="builtintype" id="2821831">int</span><span class="op" id="2821834">)</span>&nbsp;<span class="op" id="2821836">(</span><span class="ident" id="2821837">m</span>&nbsp;<span class="ident" id="2821839">Method</span><span class="op" id="2821845">)</span>&nbsp;<span class="op" id="2821847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821850">if</span>&nbsp;<span class="ident" id="2821853">i</span>&nbsp;<span class="op" id="2821855">&lt;</span>&nbsp;<span class="num" id="2821857">0</span>&nbsp;<span class="op" id="2821859">||</span>&nbsp;<span class="ident" id="2821862">i</span>&nbsp;<span class="op" id="2821864">&gt;=</span>&nbsp;<span class="builtinfunc" id="2821867">len</span><span class="op" id="2821870">(</span><span class="ident" id="2821871">t</span><span class="op" id="2821872">.</span><span class="ident" id="2821873">methods</span><span class="op" id="2821880">)</span>&nbsp;<span class="op" id="2821882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821886">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821897">p</span>&nbsp;<span class="op" id="2821899">:=</span>&nbsp;<span class="op" id="2821902">&amp;</span><span class="ident" id="2821903">t</span><span class="op" id="2821904">.</span><span class="ident" id="2821905">methods</span><span class="op" id="2821912">[</span><span class="ident" id="2821913">i</span><span class="op" id="2821914">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821917">m</span><span class="op" id="2821918">.</span><span class="ident" id="2821919">Name</span>&nbsp;<span class="op" id="2821924">=</span>&nbsp;<span class="op" id="2821926">*</span><span class="ident" id="2821927">p</span><span class="op" id="2821928">.</span><span class="ident" id="2821929">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2821935">if</span>&nbsp;<span class="ident" id="2821938">p</span><span class="op" id="2821939">.</span><span class="ident" id="2821940">pkgPath</span>&nbsp;<span class="op" id="2821948">!=</span>&nbsp;<span class="ident" id="2821951">nil</span>&nbsp;<span class="op" id="2821955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821959">m</span><span class="op" id="2821960">.</span><span class="ident" id="2821961">PkgPath</span>&nbsp;<span class="op" id="2821969">=</span>&nbsp;<span class="op" id="2821971">*</span><span class="ident" id="2821972">p</span><span class="op" id="2821973">.</span><span class="ident" id="2821974">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2821983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821986">m</span><span class="op" id="2821987">.</span><span class="ident" id="2821988">Type</span>&nbsp;<span class="op" id="2821993">=</span>&nbsp;<span class="ident" id="2821995">toType</span><span class="op" id="2822001">(</span><span class="ident" id="2822002">p</span><span class="op" id="2822003">.</span><span class="ident" id="2822004">typ</span><span class="op" id="2822007">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822010">m</span><span class="op" id="2822011">.</span><span class="ident" id="2822012">Index</span>&nbsp;<span class="op" id="2822018">=</span>&nbsp;<span class="ident" id="2822020">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822023">return</span><br>
<span class="lineno"></span><span class="op" id="2822030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822033">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2822112">func</span>&nbsp;<span class="op" id="2822117">(</span><span class="ident" id="2822118">t</span>&nbsp;<span class="op" id="2822120">*</span><span class="ident" id="2822121">interfaceType</span><span class="op" id="2822134">)</span>&nbsp;<span class="ident" id="2822136">NumMethod</span><span class="op" id="2822145">(</span><span class="op" id="2822146">)</span>&nbsp;<span class="builtintype" id="2822148">int</span>&nbsp;<span class="op" id="2822152">{</span>&nbsp;<span class="keyword" id="2822154">return</span>&nbsp;<span class="builtinfunc" id="2822161">len</span><span class="op" id="2822164">(</span><span class="ident" id="2822165">t</span><span class="op" id="2822166">.</span><span class="ident" id="2822167">methods</span><span class="op" id="2822174">)</span>&nbsp;<span class="op" id="2822176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822179">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2822248">func</span>&nbsp;<span class="op" id="2822253">(</span><span class="ident" id="2822254">t</span>&nbsp;<span class="op" id="2822256">*</span><span class="ident" id="2822257">interfaceType</span><span class="op" id="2822270">)</span>&nbsp;<span class="ident" id="2822272">MethodByName</span><span class="op" id="2822284">(</span><span class="ident" id="2822285">name</span>&nbsp;<span class="builtintype" id="2822290">string</span><span class="op" id="2822296">)</span>&nbsp;<span class="op" id="2822298">(</span><span class="ident" id="2822299">m</span>&nbsp;<span class="ident" id="2822301">Method</span><span class="op" id="2822307">,</span>&nbsp;<span class="ident" id="2822309">ok</span>&nbsp;<span class="builtintype" id="2822312">bool</span><span class="op" id="2822316">)</span>&nbsp;<span class="op" id="2822318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822321">if</span>&nbsp;<span class="ident" id="2822324">t</span>&nbsp;<span class="op" id="2822326">==</span>&nbsp;<span class="ident" id="2822329">nil</span>&nbsp;<span class="op" id="2822333">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822337">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2822345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822348">var</span>&nbsp;<span class="ident" id="2822352">p</span>&nbsp;<span class="op" id="2822354">*</span><span class="ident" id="2822355">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822364">for</span>&nbsp;<span class="ident" id="2822368">i</span>&nbsp;<span class="op" id="2822370">:=</span>&nbsp;<span class="keyword" id="2822373">range</span>&nbsp;<span class="ident" id="2822379">t</span><span class="op" id="2822380">.</span><span class="ident" id="2822381">methods</span>&nbsp;<span class="op" id="2822389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822393">p</span>&nbsp;<span class="op" id="2822395">=</span>&nbsp;<span class="op" id="2822397">&amp;</span><span class="ident" id="2822398">t</span><span class="op" id="2822399">.</span><span class="ident" id="2822400">methods</span><span class="op" id="2822407">[</span><span class="ident" id="2822408">i</span><span class="op" id="2822409">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822413">if</span>&nbsp;<span class="op" id="2822416">*</span><span class="ident" id="2822417">p</span><span class="op" id="2822418">.</span><span class="ident" id="2822419">name</span>&nbsp;<span class="op" id="2822424">==</span>&nbsp;<span class="ident" id="2822427">name</span>&nbsp;<span class="op" id="2822432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822437">return</span>&nbsp;<span class="ident" id="2822444">t</span><span class="op" id="2822445">.</span><span class="ident" id="2822446">Method</span><span class="op" id="2822452">(</span><span class="ident" id="2822453">i</span><span class="op" id="2822454">)</span><span class="op" id="2822455">,</span>&nbsp;<span class="builtintype" id="2822457">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2822464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2822467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2822470">return</span><br>
<span class="lineno">730</span><span class="op" id="2822477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822480">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2822535">type</span>&nbsp;<span class="ident" id="2822540">StructField</span>&nbsp;<span class="keyword" id="2822552">struct</span>&nbsp;<span class="op" id="2822559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2822562">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2822590">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2822663">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2822731">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822792">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2822800">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822808">PkgPath</span>&nbsp;<span class="builtintype" id="2822816">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822825">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822835">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822845">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822860">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822870">StructTag</span>&nbsp;<span class="comment" id="2822880">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822901">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2822911">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2822921">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822956">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822966">[</span><span class="op" id="2822967">]</span><span class="builtintype" id="2822968">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822976">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823017">Anonymous</span>&nbsp;<span class="builtintype" id="2823027">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2823037">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2823061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823064">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2823116">//</span><br>
<span class="lineno">750</span><span class="comment" id="2823119">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2823172">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2823221">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2823281">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2823346">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2823412">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2823456">type</span>&nbsp;<span class="ident" id="2823461">StructTag</span>&nbsp;<span class="builtintype" id="2823471">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823479">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2823543">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2823612">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2823675">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2823710">func</span>&nbsp;<span class="op" id="2823715">(</span><span class="ident" id="2823716">tag</span>&nbsp;<span class="ident" id="2823720">StructTag</span><span class="op" id="2823729">)</span>&nbsp;<span class="ident" id="2823731">Get</span><span class="op" id="2823734">(</span><span class="ident" id="2823735">key</span>&nbsp;<span class="builtintype" id="2823739">string</span><span class="op" id="2823745">)</span>&nbsp;<span class="builtintype" id="2823747">string</span>&nbsp;<span class="op" id="2823754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823757">for</span>&nbsp;<span class="ident" id="2823761">tag</span>&nbsp;<span class="op" id="2823765">!=</span>&nbsp;<span class="string" id="2823768">&#34;&#34;</span>&nbsp;<span class="op" id="2823771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2823775">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823799">i</span>&nbsp;<span class="op" id="2823801">:=</span>&nbsp;<span class="num" id="2823804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823808">for</span>&nbsp;<span class="ident" id="2823812">i</span>&nbsp;<span class="op" id="2823814">&lt;</span>&nbsp;<span class="builtinfunc" id="2823816">len</span><span class="op" id="2823819">(</span><span class="ident" id="2823820">tag</span><span class="op" id="2823823">)</span>&nbsp;<span class="op" id="2823825">&amp;&amp;</span>&nbsp;<span class="ident" id="2823828">tag</span><span class="op" id="2823831">[</span><span class="ident" id="2823832">i</span><span class="op" id="2823833">]</span>&nbsp;<span class="op" id="2823835">==</span>&nbsp;<span class="string" id="2823838">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2823842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823847">i</span><span class="op" id="2823848">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2823853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823857">tag</span>&nbsp;<span class="op" id="2823861">=</span>&nbsp;<span class="ident" id="2823863">tag</span><span class="op" id="2823866">[</span><span class="ident" id="2823867">i</span><span class="op" id="2823868">:</span><span class="op" id="2823869">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823873">if</span>&nbsp;<span class="ident" id="2823876">tag</span>&nbsp;<span class="op" id="2823880">==</span>&nbsp;<span class="string" id="2823883">&#34;&#34;</span>&nbsp;<span class="op" id="2823886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823891">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2823899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2823904">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2823924">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823966">i</span>&nbsp;<span class="op" id="2823968">=</span>&nbsp;<span class="num" id="2823970">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2823974">for</span>&nbsp;<span class="ident" id="2823978">i</span>&nbsp;<span class="op" id="2823980">&lt;</span>&nbsp;<span class="builtinfunc" id="2823982">len</span><span class="op" id="2823985">(</span><span class="ident" id="2823986">tag</span><span class="op" id="2823989">)</span>&nbsp;<span class="op" id="2823991">&amp;&amp;</span>&nbsp;<span class="ident" id="2823994">tag</span><span class="op" id="2823997">[</span><span class="ident" id="2823998">i</span><span class="op" id="2823999">]</span>&nbsp;<span class="op" id="2824001">!=</span>&nbsp;<span class="string" id="2824004">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2824008">&amp;&amp;</span>&nbsp;<span class="ident" id="2824011">tag</span><span class="op" id="2824014">[</span><span class="ident" id="2824015">i</span><span class="op" id="2824016">]</span>&nbsp;<span class="op" id="2824018">!=</span>&nbsp;<span class="string" id="2824021">&#39;:&#39;</span>&nbsp;<span class="op" id="2824025">&amp;&amp;</span>&nbsp;<span class="ident" id="2824028">tag</span><span class="op" id="2824031">[</span><span class="ident" id="2824032">i</span><span class="op" id="2824033">]</span>&nbsp;<span class="op" id="2824035">!=</span>&nbsp;<span class="string" id="2824038">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2824042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824047">i</span><span class="op" id="2824048">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824053">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824057">if</span>&nbsp;<span class="ident" id="2824060">i</span><span class="op" id="2824061">+</span><span class="num" id="2824062">1</span>&nbsp;<span class="op" id="2824064">&gt;=</span>&nbsp;<span class="builtinfunc" id="2824067">len</span><span class="op" id="2824070">(</span><span class="ident" id="2824071">tag</span><span class="op" id="2824074">)</span>&nbsp;<span class="op" id="2824076">||</span>&nbsp;<span class="ident" id="2824079">tag</span><span class="op" id="2824082">[</span><span class="ident" id="2824083">i</span><span class="op" id="2824084">]</span>&nbsp;<span class="op" id="2824086">!=</span>&nbsp;<span class="string" id="2824089">&#39;:&#39;</span>&nbsp;<span class="op" id="2824093">||</span>&nbsp;<span class="ident" id="2824096">tag</span><span class="op" id="2824099">[</span><span class="ident" id="2824100">i</span><span class="op" id="2824101">+</span><span class="num" id="2824102">1</span><span class="op" id="2824103">]</span>&nbsp;<span class="op" id="2824105">!=</span>&nbsp;<span class="string" id="2824108">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2824112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824117">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824129">name</span>&nbsp;<span class="op" id="2824134">:=</span>&nbsp;<span class="builtintype" id="2824137">string</span><span class="op" id="2824143">(</span><span class="ident" id="2824144">tag</span><span class="op" id="2824147">[</span><span class="op" id="2824148">:</span><span class="ident" id="2824149">i</span><span class="op" id="2824150">]</span><span class="op" id="2824151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824155">tag</span>&nbsp;<span class="op" id="2824159">=</span>&nbsp;<span class="ident" id="2824161">tag</span><span class="op" id="2824164">[</span><span class="ident" id="2824165">i</span><span class="op" id="2824166">+</span><span class="num" id="2824167">1</span><span class="op" id="2824168">:</span><span class="op" id="2824169">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824174">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824212">i</span>&nbsp;<span class="op" id="2824214">=</span>&nbsp;<span class="num" id="2824216">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824220">for</span>&nbsp;<span class="ident" id="2824224">i</span>&nbsp;<span class="op" id="2824226">&lt;</span>&nbsp;<span class="builtinfunc" id="2824228">len</span><span class="op" id="2824231">(</span><span class="ident" id="2824232">tag</span><span class="op" id="2824235">)</span>&nbsp;<span class="op" id="2824237">&amp;&amp;</span>&nbsp;<span class="ident" id="2824240">tag</span><span class="op" id="2824243">[</span><span class="ident" id="2824244">i</span><span class="op" id="2824245">]</span>&nbsp;<span class="op" id="2824247">!=</span>&nbsp;<span class="string" id="2824250">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2824254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824259">if</span>&nbsp;<span class="ident" id="2824262">tag</span><span class="op" id="2824265">[</span><span class="ident" id="2824266">i</span><span class="op" id="2824267">]</span>&nbsp;<span class="op" id="2824269">==</span>&nbsp;<span class="string" id="2824272">&#39;\\&#39;</span>&nbsp;<span class="op" id="2824277">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824283">i</span><span class="op" id="2824284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824295">i</span><span class="op" id="2824296">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824305">if</span>&nbsp;<span class="ident" id="2824308">i</span>&nbsp;<span class="op" id="2824310">&gt;=</span>&nbsp;<span class="builtinfunc" id="2824313">len</span><span class="op" id="2824316">(</span><span class="ident" id="2824317">tag</span><span class="op" id="2824320">)</span>&nbsp;<span class="op" id="2824322">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824327">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824339">qvalue</span>&nbsp;<span class="op" id="2824346">:=</span>&nbsp;<span class="builtintype" id="2824349">string</span><span class="op" id="2824355">(</span><span class="ident" id="2824356">tag</span><span class="op" id="2824359">[</span><span class="op" id="2824360">:</span><span class="ident" id="2824361">i</span><span class="op" id="2824362">+</span><span class="num" id="2824363">1</span><span class="op" id="2824364">]</span><span class="op" id="2824365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824369">tag</span>&nbsp;<span class="op" id="2824373">=</span>&nbsp;<span class="ident" id="2824375">tag</span><span class="op" id="2824378">[</span><span class="ident" id="2824379">i</span><span class="op" id="2824380">+</span><span class="num" id="2824381">1</span><span class="op" id="2824382">:</span><span class="op" id="2824383">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824388">if</span>&nbsp;<span class="ident" id="2824391">key</span>&nbsp;<span class="op" id="2824395">==</span>&nbsp;<span class="ident" id="2824398">name</span>&nbsp;<span class="op" id="2824403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824408">value</span><span class="op" id="2824413">,</span>&nbsp;<span class="ident" id="2824415">_</span>&nbsp;<span class="op" id="2824417">:=</span>&nbsp;<span class="ident" id="2824420">strconv</span><span class="op" id="2824427">.</span><span class="ident" id="2824428">Unquote</span><span class="op" id="2824435">(</span><span class="ident" id="2824436">qvalue</span><span class="op" id="2824442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824447">return</span>&nbsp;<span class="ident" id="2824454">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824465">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824468">return</span>&nbsp;<span class="string" id="2824475">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2824478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2824481">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2824521">func</span>&nbsp;<span class="op" id="2824526">(</span><span class="ident" id="2824527">t</span>&nbsp;<span class="op" id="2824529">*</span><span class="ident" id="2824530">structType</span><span class="op" id="2824540">)</span>&nbsp;<span class="ident" id="2824542">Field</span><span class="op" id="2824547">(</span><span class="ident" id="2824548">i</span>&nbsp;<span class="builtintype" id="2824550">int</span><span class="op" id="2824553">)</span>&nbsp;<span class="op" id="2824555">(</span><span class="ident" id="2824556">f</span>&nbsp;<span class="ident" id="2824558">StructField</span><span class="op" id="2824569">)</span>&nbsp;<span class="op" id="2824571">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824574">if</span>&nbsp;<span class="ident" id="2824577">i</span>&nbsp;<span class="op" id="2824579">&lt;</span>&nbsp;<span class="num" id="2824581">0</span>&nbsp;<span class="op" id="2824583">||</span>&nbsp;<span class="ident" id="2824586">i</span>&nbsp;<span class="op" id="2824588">&gt;=</span>&nbsp;<span class="builtinfunc" id="2824591">len</span><span class="op" id="2824594">(</span><span class="ident" id="2824595">t</span><span class="op" id="2824596">.</span><span class="ident" id="2824597">fields</span><span class="op" id="2824603">)</span>&nbsp;<span class="op" id="2824605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824620">p</span>&nbsp;<span class="op" id="2824622">:=</span>&nbsp;<span class="op" id="2824625">&amp;</span><span class="ident" id="2824626">t</span><span class="op" id="2824627">.</span><span class="ident" id="2824628">fields</span><span class="op" id="2824634">[</span><span class="ident" id="2824635">i</span><span class="op" id="2824636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824639">f</span><span class="op" id="2824640">.</span><span class="ident" id="2824641">Type</span>&nbsp;<span class="op" id="2824646">=</span>&nbsp;<span class="ident" id="2824648">toType</span><span class="op" id="2824654">(</span><span class="ident" id="2824655">p</span><span class="op" id="2824656">.</span><span class="ident" id="2824657">typ</span><span class="op" id="2824660">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824663">if</span>&nbsp;<span class="ident" id="2824666">p</span><span class="op" id="2824667">.</span><span class="ident" id="2824668">name</span>&nbsp;<span class="op" id="2824673">!=</span>&nbsp;<span class="ident" id="2824676">nil</span>&nbsp;<span class="op" id="2824680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824684">f</span><span class="op" id="2824685">.</span><span class="ident" id="2824686">Name</span>&nbsp;<span class="op" id="2824691">=</span>&nbsp;<span class="op" id="2824693">*</span><span class="ident" id="2824694">p</span><span class="op" id="2824695">.</span><span class="ident" id="2824696">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824702">}</span>&nbsp;<span class="keyword" id="2824704">else</span>&nbsp;<span class="op" id="2824709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824713">t</span>&nbsp;<span class="op" id="2824715">:=</span>&nbsp;<span class="ident" id="2824718">f</span><span class="op" id="2824719">.</span><span class="ident" id="2824720">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824727">if</span>&nbsp;<span class="ident" id="2824730">t</span><span class="op" id="2824731">.</span><span class="ident" id="2824732">Kind</span><span class="op" id="2824736">(</span><span class="op" id="2824737">)</span>&nbsp;<span class="op" id="2824739">==</span>&nbsp;<span class="ident" id="2824742">Ptr</span>&nbsp;<span class="op" id="2824746">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824751">t</span>&nbsp;<span class="op" id="2824753">=</span>&nbsp;<span class="ident" id="2824755">t</span><span class="op" id="2824756">.</span><span class="ident" id="2824757">Elem</span><span class="op" id="2824761">(</span><span class="op" id="2824762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824770">f</span><span class="op" id="2824771">.</span><span class="ident" id="2824772">Name</span>&nbsp;<span class="op" id="2824777">=</span>&nbsp;<span class="ident" id="2824779">t</span><span class="op" id="2824780">.</span><span class="ident" id="2824781">Name</span><span class="op" id="2824785">(</span><span class="op" id="2824786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824790">f</span><span class="op" id="2824791">.</span><span class="ident" id="2824792">Anonymous</span>&nbsp;<span class="op" id="2824802">=</span>&nbsp;<span class="builtintype" id="2824804">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824810">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824813">if</span>&nbsp;<span class="ident" id="2824816">p</span><span class="op" id="2824817">.</span><span class="ident" id="2824818">pkgPath</span>&nbsp;<span class="op" id="2824826">!=</span>&nbsp;<span class="ident" id="2824829">nil</span>&nbsp;<span class="op" id="2824833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824837">f</span><span class="op" id="2824838">.</span><span class="ident" id="2824839">PkgPath</span>&nbsp;<span class="op" id="2824847">=</span>&nbsp;<span class="op" id="2824849">*</span><span class="ident" id="2824850">p</span><span class="op" id="2824851">.</span><span class="ident" id="2824852">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824864">if</span>&nbsp;<span class="ident" id="2824867">p</span><span class="op" id="2824868">.</span><span class="ident" id="2824869">tag</span>&nbsp;<span class="op" id="2824873">!=</span>&nbsp;<span class="ident" id="2824876">nil</span>&nbsp;<span class="op" id="2824880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824884">f</span><span class="op" id="2824885">.</span><span class="ident" id="2824886">Tag</span>&nbsp;<span class="op" id="2824890">=</span>&nbsp;<span class="ident" id="2824892">StructTag</span><span class="op" id="2824901">(</span><span class="op" id="2824902">*</span><span class="ident" id="2824903">p</span><span class="op" id="2824904">.</span><span class="ident" id="2824905">tag</span><span class="op" id="2824908">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824914">f</span><span class="op" id="2824915">.</span><span class="ident" id="2824916">Offset</span>&nbsp;<span class="op" id="2824923">=</span>&nbsp;<span class="ident" id="2824925">p</span><span class="op" id="2824926">.</span><span class="ident" id="2824927">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824936">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824996">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2825057">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2825116">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2825176">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2825236">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2825294">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825345">f</span><span class="op" id="2825346">.</span><span class="ident" id="2825347">Index</span>&nbsp;<span class="op" id="2825353">=</span>&nbsp;<span class="op" id="2825355">[</span><span class="op" id="2825356">]</span><span class="builtintype" id="2825357">int</span><span class="op" id="2825360">{</span><span class="ident" id="2825361">i</span><span class="op" id="2825362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825365">return</span><br>
<span class="lineno"></span><span class="op" id="2825372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2825375">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2825442">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2825484">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2825549">func</span>&nbsp;<span class="op" id="2825554">(</span><span class="ident" id="2825555">t</span>&nbsp;<span class="op" id="2825557">*</span><span class="ident" id="2825558">structType</span><span class="op" id="2825568">)</span>&nbsp;<span class="ident" id="2825570">FieldByIndex</span><span class="op" id="2825582">(</span><span class="ident" id="2825583">index</span>&nbsp;<span class="op" id="2825589">[</span><span class="op" id="2825590">]</span><span class="builtintype" id="2825591">int</span><span class="op" id="2825594">)</span>&nbsp;<span class="op" id="2825596">(</span><span class="ident" id="2825597">f</span>&nbsp;<span class="ident" id="2825599">StructField</span><span class="op" id="2825610">)</span>&nbsp;<span class="op" id="2825612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825615">f</span><span class="op" id="2825616">.</span><span class="ident" id="2825617">Type</span>&nbsp;<span class="op" id="2825622">=</span>&nbsp;<span class="ident" id="2825624">toType</span><span class="op" id="2825630">(</span><span class="op" id="2825631">&amp;</span><span class="ident" id="2825632">t</span><span class="op" id="2825633">.</span><span class="ident" id="2825634">rtype</span><span class="op" id="2825639">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825642">for</span>&nbsp;<span class="ident" id="2825646">i</span><span class="op" id="2825647">,</span>&nbsp;<span class="ident" id="2825649">x</span>&nbsp;<span class="op" id="2825651">:=</span>&nbsp;<span class="keyword" id="2825654">range</span>&nbsp;<span class="ident" id="2825660">index</span>&nbsp;<span class="op" id="2825666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825670">if</span>&nbsp;<span class="ident" id="2825673">i</span>&nbsp;<span class="op" id="2825675">&gt;</span>&nbsp;<span class="num" id="2825677">0</span>&nbsp;<span class="op" id="2825679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825684">ft</span>&nbsp;<span class="op" id="2825687">:=</span>&nbsp;<span class="ident" id="2825690">f</span><span class="op" id="2825691">.</span><span class="ident" id="2825692">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825700">if</span>&nbsp;<span class="ident" id="2825703">ft</span><span class="op" id="2825705">.</span><span class="ident" id="2825706">Kind</span><span class="op" id="2825710">(</span><span class="op" id="2825711">)</span>&nbsp;<span class="op" id="2825713">==</span>&nbsp;<span class="ident" id="2825716">Ptr</span>&nbsp;<span class="op" id="2825720">&amp;&amp;</span>&nbsp;<span class="ident" id="2825723">ft</span><span class="op" id="2825725">.</span><span class="ident" id="2825726">Elem</span><span class="op" id="2825730">(</span><span class="op" id="2825731">)</span><span class="op" id="2825732">.</span><span class="ident" id="2825733">Kind</span><span class="op" id="2825737">(</span><span class="op" id="2825738">)</span>&nbsp;<span class="op" id="2825740">==</span>&nbsp;<span class="ident" id="2825743">Struct</span>&nbsp;<span class="op" id="2825750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825756">ft</span>&nbsp;<span class="op" id="2825759">=</span>&nbsp;<span class="ident" id="2825761">ft</span><span class="op" id="2825763">.</span><span class="ident" id="2825764">Elem</span><span class="op" id="2825768">(</span><span class="op" id="2825769">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2825774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825779">f</span><span class="op" id="2825780">.</span><span class="ident" id="2825781">Type</span>&nbsp;<span class="op" id="2825786">=</span>&nbsp;<span class="ident" id="2825788">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2825793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825797">f</span>&nbsp;<span class="op" id="2825799">=</span>&nbsp;<span class="ident" id="2825801">f</span><span class="op" id="2825802">.</span><span class="ident" id="2825803">Type</span><span class="op" id="2825807">.</span><span class="ident" id="2825808">Field</span><span class="op" id="2825813">(</span><span class="ident" id="2825814">x</span><span class="op" id="2825815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2825818">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825821">return</span><br>
<span class="lineno"></span><span class="op" id="2825828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2825831">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2825904">type</span>&nbsp;<span class="ident" id="2825909">fieldScan</span>&nbsp;<span class="keyword" id="2825919">struct</span>&nbsp;<span class="op" id="2825926">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825929">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2825935">*</span><span class="ident" id="2825936">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825948">index</span>&nbsp;<span class="op" id="2825954">[</span><span class="op" id="2825955">]</span><span class="builtintype" id="2825956">int</span><br>
<span class="lineno"></span><span class="op" id="2825960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2825963">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2826038">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2826106">func</span>&nbsp;<span class="op" id="2826111">(</span><span class="ident" id="2826112">t</span>&nbsp;<span class="op" id="2826114">*</span><span class="ident" id="2826115">structType</span><span class="op" id="2826125">)</span>&nbsp;<span class="ident" id="2826127">FieldByNameFunc</span><span class="op" id="2826142">(</span><span class="ident" id="2826143">match</span>&nbsp;<span class="keyword" id="2826149">func</span><span class="op" id="2826153">(</span><span class="builtintype" id="2826154">string</span><span class="op" id="2826160">)</span>&nbsp;<span class="builtintype" id="2826162">bool</span><span class="op" id="2826166">)</span>&nbsp;<span class="op" id="2826168">(</span><span class="ident" id="2826169">result</span>&nbsp;<span class="ident" id="2826176">StructField</span><span class="op" id="2826187">,</span>&nbsp;<span class="ident" id="2826189">ok</span>&nbsp;<span class="builtintype" id="2826192">bool</span><span class="op" id="2826196">)</span>&nbsp;<span class="op" id="2826198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826201">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826293">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826384">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826476">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826547">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826596">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826655">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826710">current</span>&nbsp;<span class="op" id="2826718">:=</span>&nbsp;<span class="op" id="2826721">[</span><span class="op" id="2826722">]</span><span class="ident" id="2826723">fieldScan</span><span class="op" id="2826732">{</span><span class="op" id="2826733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826736">next</span>&nbsp;<span class="op" id="2826741">:=</span>&nbsp;<span class="op" id="2826744">[</span><span class="op" id="2826745">]</span><span class="ident" id="2826746">fieldScan</span><span class="op" id="2826755">{</span><span class="op" id="2826756">{</span><span class="ident" id="2826757">typ</span><span class="op" id="2826760">:</span>&nbsp;<span class="ident" id="2826762">t</span><span class="op" id="2826763">}</span><span class="op" id="2826764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826768">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826836">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826901">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2826970">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827047">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827120">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827155">var</span>&nbsp;<span class="ident" id="2827159">nextCount</span>&nbsp;<span class="keyword" id="2827169">map</span><span class="op" id="2827172">[</span><span class="op" id="2827173">*</span><span class="ident" id="2827174">structType</span><span class="op" id="2827184">]</span><span class="builtintype" id="2827185">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827191">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827258">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827320">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827389">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827461">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827536">visited</span>&nbsp;<span class="op" id="2827544">:=</span>&nbsp;<span class="keyword" id="2827547">map</span><span class="op" id="2827550">[</span><span class="op" id="2827551">*</span><span class="ident" id="2827552">structType</span><span class="op" id="2827562">]</span><span class="builtintype" id="2827563">bool</span><span class="op" id="2827567">{</span><span class="op" id="2827568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827572">for</span>&nbsp;<span class="builtinfunc" id="2827576">len</span><span class="op" id="2827579">(</span><span class="ident" id="2827580">next</span><span class="op" id="2827584">)</span>&nbsp;<span class="op" id="2827586">&gt;</span>&nbsp;<span class="num" id="2827588">0</span>&nbsp;<span class="op" id="2827590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827594">current</span><span class="op" id="2827601">,</span>&nbsp;<span class="ident" id="2827603">next</span>&nbsp;<span class="op" id="2827608">=</span>&nbsp;<span class="ident" id="2827610">next</span><span class="op" id="2827614">,</span>&nbsp;<span class="ident" id="2827616">current</span><span class="op" id="2827623">[</span><span class="op" id="2827624">:</span><span class="num" id="2827625">0</span><span class="op" id="2827626">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827630">count</span>&nbsp;<span class="op" id="2827636">:=</span>&nbsp;<span class="ident" id="2827639">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827651">nextCount</span>&nbsp;<span class="op" id="2827661">=</span>&nbsp;<span class="ident" id="2827663">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827670">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827738">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827823">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2827898">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827987">for</span>&nbsp;<span class="ident" id="2827991">_</span><span class="op" id="2827992">,</span>&nbsp;<span class="ident" id="2827994">scan</span>&nbsp;<span class="op" id="2827999">:=</span>&nbsp;<span class="keyword" id="2828002">range</span>&nbsp;<span class="ident" id="2828008">current</span>&nbsp;<span class="op" id="2828016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828021">t</span>&nbsp;<span class="op" id="2828023">:=</span>&nbsp;<span class="ident" id="2828026">scan</span><span class="op" id="2828030">.</span><span class="ident" id="2828031">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828038">if</span>&nbsp;<span class="ident" id="2828041">visited</span><span class="op" id="2828048">[</span><span class="ident" id="2828049">t</span><span class="op" id="2828050">]</span>&nbsp;<span class="op" id="2828052">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828058">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828123">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828191">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828244">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828256">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828261">visited</span><span class="op" id="2828268">[</span><span class="ident" id="2828269">t</span><span class="op" id="2828270">]</span>&nbsp;<span class="op" id="2828272">=</span>&nbsp;<span class="builtintype" id="2828274">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828282">for</span>&nbsp;<span class="ident" id="2828286">i</span>&nbsp;<span class="op" id="2828288">:=</span>&nbsp;<span class="keyword" id="2828291">range</span>&nbsp;<span class="ident" id="2828297">t</span><span class="op" id="2828298">.</span><span class="ident" id="2828299">fields</span>&nbsp;<span class="op" id="2828306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828312">f</span>&nbsp;<span class="op" id="2828314">:=</span>&nbsp;<span class="op" id="2828317">&amp;</span><span class="ident" id="2828318">t</span><span class="op" id="2828319">.</span><span class="ident" id="2828320">fields</span><span class="op" id="2828326">[</span><span class="ident" id="2828327">i</span><span class="op" id="2828328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828334">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828373">var</span>&nbsp;<span class="ident" id="2828377">fname</span>&nbsp;<span class="builtintype" id="2828383">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828394">var</span>&nbsp;<span class="ident" id="2828398">ntyp</span>&nbsp;<span class="op" id="2828403">*</span><span class="ident" id="2828404">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828414">if</span>&nbsp;<span class="ident" id="2828417">f</span><span class="op" id="2828418">.</span><span class="ident" id="2828419">name</span>&nbsp;<span class="op" id="2828424">!=</span>&nbsp;<span class="ident" id="2828427">nil</span>&nbsp;<span class="op" id="2828431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828438">fname</span>&nbsp;<span class="op" id="2828444">=</span>&nbsp;<span class="op" id="2828446">*</span><span class="ident" id="2828447">f</span><span class="op" id="2828448">.</span><span class="ident" id="2828449">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828458">}</span>&nbsp;<span class="keyword" id="2828460">else</span>&nbsp;<span class="op" id="2828465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828472">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828513">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828543">ntyp</span>&nbsp;<span class="op" id="2828548">=</span>&nbsp;<span class="ident" id="2828550">f</span><span class="op" id="2828551">.</span><span class="ident" id="2828552">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828561">if</span>&nbsp;<span class="ident" id="2828564">ntyp</span><span class="op" id="2828568">.</span><span class="ident" id="2828569">Kind</span><span class="op" id="2828573">(</span><span class="op" id="2828574">)</span>&nbsp;<span class="op" id="2828576">==</span>&nbsp;<span class="ident" id="2828579">Ptr</span>&nbsp;<span class="op" id="2828583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828591">ntyp</span>&nbsp;<span class="op" id="2828596">=</span>&nbsp;<span class="ident" id="2828598">ntyp</span><span class="op" id="2828602">.</span><span class="ident" id="2828603">Elem</span><span class="op" id="2828607">(</span><span class="op" id="2828608">)</span><span class="op" id="2828609">.</span><span class="ident" id="2828610">common</span><span class="op" id="2828616">(</span><span class="op" id="2828617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828624">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828631">fname</span>&nbsp;<span class="op" id="2828637">=</span>&nbsp;<span class="ident" id="2828639">ntyp</span><span class="op" id="2828643">.</span><span class="ident" id="2828644">Name</span><span class="op" id="2828648">(</span><span class="op" id="2828649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828662">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828684">if</span>&nbsp;<span class="ident" id="2828687">match</span><span class="op" id="2828692">(</span><span class="ident" id="2828693">fname</span><span class="op" id="2828698">)</span>&nbsp;<span class="op" id="2828700">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828707">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828731">if</span>&nbsp;<span class="ident" id="2828734">count</span><span class="op" id="2828739">[</span><span class="ident" id="2828740">t</span><span class="op" id="2828741">]</span>&nbsp;<span class="op" id="2828743">&gt;</span>&nbsp;<span class="num" id="2828745">1</span>&nbsp;<span class="op" id="2828747">||</span>&nbsp;<span class="ident" id="2828750">ok</span>&nbsp;<span class="op" id="2828753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2828761">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828826">return</span>&nbsp;<span class="ident" id="2828833">StructField</span><span class="op" id="2828844">{</span><span class="op" id="2828845">}</span><span class="op" id="2828846">,</span>&nbsp;<span class="builtintype" id="2828848">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828859">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828866">result</span>&nbsp;<span class="op" id="2828873">=</span>&nbsp;<span class="ident" id="2828875">t</span><span class="op" id="2828876">.</span><span class="ident" id="2828877">Field</span><span class="op" id="2828882">(</span><span class="ident" id="2828883">i</span><span class="op" id="2828884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828891">result</span><span class="op" id="2828897">.</span><span class="ident" id="2828898">Index</span>&nbsp;<span class="op" id="2828904">=</span>&nbsp;<span class="ident" id="2828906">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828915">result</span><span class="op" id="2828921">.</span><span class="ident" id="2828922">Index</span>&nbsp;<span class="op" id="2828928">=</span>&nbsp;<span class="builtinfunc" id="2828930">append</span><span class="op" id="2828936">(</span><span class="ident" id="2828937">result</span><span class="op" id="2828943">.</span><span class="ident" id="2828944">Index</span><span class="op" id="2828949">,</span>&nbsp;<span class="ident" id="2828951">scan</span><span class="op" id="2828955">.</span><span class="ident" id="2828956">index</span><span class="op" id="2828961">...</span><span class="op" id="2828964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828971">result</span><span class="op" id="2828977">.</span><span class="ident" id="2828978">Index</span>&nbsp;<span class="op" id="2828984">=</span>&nbsp;<span class="builtinfunc" id="2828986">append</span><span class="op" id="2828992">(</span><span class="ident" id="2828993">result</span><span class="op" id="2828999">.</span><span class="ident" id="2829000">Index</span><span class="op" id="2829005">,</span>&nbsp;<span class="ident" id="2829007">i</span><span class="op" id="2829008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829015">ok</span>&nbsp;<span class="op" id="2829018">=</span>&nbsp;<span class="builtintype" id="2829020">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829030">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2829050">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2829118">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2829188">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829246">if</span>&nbsp;<span class="ident" id="2829249">ok</span>&nbsp;<span class="op" id="2829252">||</span>&nbsp;<span class="ident" id="2829255">ntyp</span>&nbsp;<span class="op" id="2829260">==</span>&nbsp;<span class="ident" id="2829263">nil</span>&nbsp;<span class="op" id="2829267">||</span>&nbsp;<span class="ident" id="2829270">ntyp</span><span class="op" id="2829274">.</span><span class="ident" id="2829275">Kind</span><span class="op" id="2829279">(</span><span class="op" id="2829280">)</span>&nbsp;<span class="op" id="2829282">!=</span>&nbsp;<span class="ident" id="2829285">Struct</span>&nbsp;<span class="op" id="2829292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829299">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829318">styp</span>&nbsp;<span class="op" id="2829323">:=</span>&nbsp;<span class="op" id="2829326">(</span><span class="op" id="2829327">*</span><span class="ident" id="2829328">structType</span><span class="op" id="2829338">)</span><span class="op" id="2829339">(</span><span class="ident" id="2829340">unsafe</span><span class="op" id="2829346">.</span><span class="ident" id="2829347">Pointer</span><span class="op" id="2829354">(</span><span class="ident" id="2829355">ntyp</span><span class="op" id="2829359">)</span><span class="op" id="2829360">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829366">if</span>&nbsp;<span class="ident" id="2829369">nextCount</span><span class="op" id="2829378">[</span><span class="ident" id="2829379">styp</span><span class="op" id="2829383">]</span>&nbsp;<span class="op" id="2829385">&gt;</span>&nbsp;<span class="num" id="2829387">0</span>&nbsp;<span class="op" id="2829389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829396">nextCount</span><span class="op" id="2829405">[</span><span class="ident" id="2829406">styp</span><span class="op" id="2829410">]</span>&nbsp;<span class="op" id="2829412">=</span>&nbsp;<span class="num" id="2829414">2</span>&nbsp;<span class="comment" id="2829416">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829454">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829473">if</span>&nbsp;<span class="ident" id="2829476">nextCount</span>&nbsp;<span class="op" id="2829486">==</span>&nbsp;<span class="ident" id="2829489">nil</span>&nbsp;<span class="op" id="2829493">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829500">nextCount</span>&nbsp;<span class="op" id="2829510">=</span>&nbsp;<span class="keyword" id="2829512">map</span><span class="op" id="2829515">[</span><span class="op" id="2829516">*</span><span class="ident" id="2829517">structType</span><span class="op" id="2829527">]</span><span class="builtintype" id="2829528">int</span><span class="op" id="2829531">{</span><span class="op" id="2829532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829544">nextCount</span><span class="op" id="2829553">[</span><span class="ident" id="2829554">styp</span><span class="op" id="2829558">]</span>&nbsp;<span class="op" id="2829560">=</span>&nbsp;<span class="num" id="2829562">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829568">if</span>&nbsp;<span class="ident" id="2829571">count</span><span class="op" id="2829576">[</span><span class="ident" id="2829577">t</span><span class="op" id="2829578">]</span>&nbsp;<span class="op" id="2829580">&gt;</span>&nbsp;<span class="num" id="2829582">1</span>&nbsp;<span class="op" id="2829584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829591">nextCount</span><span class="op" id="2829600">[</span><span class="ident" id="2829601">styp</span><span class="op" id="2829605">]</span>&nbsp;<span class="op" id="2829607">=</span>&nbsp;<span class="num" id="2829609">2</span>&nbsp;<span class="comment" id="2829611">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829654">var</span>&nbsp;<span class="ident" id="2829658">index</span>&nbsp;<span class="op" id="2829664">[</span><span class="op" id="2829665">]</span><span class="builtintype" id="2829666">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829674">index</span>&nbsp;<span class="op" id="2829680">=</span>&nbsp;<span class="builtinfunc" id="2829682">append</span><span class="op" id="2829688">(</span><span class="ident" id="2829689">index</span><span class="op" id="2829694">,</span>&nbsp;<span class="ident" id="2829696">scan</span><span class="op" id="2829700">.</span><span class="ident" id="2829701">index</span><span class="op" id="2829706">...</span><span class="op" id="2829709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829715">index</span>&nbsp;<span class="op" id="2829721">=</span>&nbsp;<span class="builtinfunc" id="2829723">append</span><span class="op" id="2829729">(</span><span class="ident" id="2829730">index</span><span class="op" id="2829735">,</span>&nbsp;<span class="ident" id="2829737">i</span><span class="op" id="2829738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829744">next</span>&nbsp;<span class="op" id="2829749">=</span>&nbsp;<span class="builtinfunc" id="2829751">append</span><span class="op" id="2829757">(</span><span class="ident" id="2829758">next</span><span class="op" id="2829762">,</span>&nbsp;<span class="ident" id="2829764">fieldScan</span><span class="op" id="2829773">{</span><span class="ident" id="2829774">styp</span><span class="op" id="2829778">,</span>&nbsp;<span class="ident" id="2829780">index</span><span class="op" id="2829785">}</span><span class="op" id="2829786">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829799">if</span>&nbsp;<span class="ident" id="2829802">ok</span>&nbsp;<span class="op" id="2829805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829810">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829818">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829824">return</span><br>
<span class="lineno"></span><span class="op" id="2829831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2829834">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2829894">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2829947">func</span>&nbsp;<span class="op" id="2829952">(</span><span class="ident" id="2829953">t</span>&nbsp;<span class="op" id="2829955">*</span><span class="ident" id="2829956">structType</span><span class="op" id="2829966">)</span>&nbsp;<span class="ident" id="2829968">FieldByName</span><span class="op" id="2829979">(</span><span class="ident" id="2829980">name</span>&nbsp;<span class="builtintype" id="2829985">string</span><span class="op" id="2829991">)</span>&nbsp;<span class="op" id="2829993">(</span><span class="ident" id="2829994">f</span>&nbsp;<span class="ident" id="2829996">StructField</span><span class="op" id="2830007">,</span>&nbsp;<span class="ident" id="2830009">present</span>&nbsp;<span class="builtintype" id="2830017">bool</span><span class="op" id="2830021">)</span>&nbsp;<span class="op" id="2830023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2830026">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830098">hasAnon</span>&nbsp;<span class="op" id="2830106">:=</span>&nbsp;<span class="builtintype" id="2830109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830116">if</span>&nbsp;<span class="ident" id="2830119">name</span>&nbsp;<span class="op" id="2830124">!=</span>&nbsp;<span class="string" id="2830127">&#34;&#34;</span>&nbsp;<span class="op" id="2830130">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830134">for</span>&nbsp;<span class="ident" id="2830138">i</span>&nbsp;<span class="op" id="2830140">:=</span>&nbsp;<span class="keyword" id="2830143">range</span>&nbsp;<span class="ident" id="2830149">t</span><span class="op" id="2830150">.</span><span class="ident" id="2830151">fields</span>&nbsp;<span class="op" id="2830158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830163">tf</span>&nbsp;<span class="op" id="2830166">:=</span>&nbsp;<span class="op" id="2830169">&amp;</span><span class="ident" id="2830170">t</span><span class="op" id="2830171">.</span><span class="ident" id="2830172">fields</span><span class="op" id="2830178">[</span><span class="ident" id="2830179">i</span><span class="op" id="2830180">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830185">if</span>&nbsp;<span class="ident" id="2830188">tf</span><span class="op" id="2830190">.</span><span class="ident" id="2830191">name</span>&nbsp;<span class="op" id="2830196">==</span>&nbsp;<span class="ident" id="2830199">nil</span>&nbsp;<span class="op" id="2830203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830209">hasAnon</span>&nbsp;<span class="op" id="2830217">=</span>&nbsp;<span class="builtintype" id="2830219">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830228">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830245">if</span>&nbsp;<span class="op" id="2830248">*</span><span class="ident" id="2830249">tf</span><span class="op" id="2830251">.</span><span class="ident" id="2830252">name</span>&nbsp;<span class="op" id="2830257">==</span>&nbsp;<span class="ident" id="2830260">name</span>&nbsp;<span class="op" id="2830265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830271">return</span>&nbsp;<span class="ident" id="2830278">t</span><span class="op" id="2830279">.</span><span class="ident" id="2830280">Field</span><span class="op" id="2830285">(</span><span class="ident" id="2830286">i</span><span class="op" id="2830287">)</span><span class="op" id="2830288">,</span>&nbsp;<span class="builtintype" id="2830290">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830302">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830308">if</span>&nbsp;<span class="op" id="2830311">!</span><span class="ident" id="2830312">hasAnon</span>&nbsp;<span class="op" id="2830320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830324">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830335">return</span>&nbsp;<span class="ident" id="2830342">t</span><span class="op" id="2830343">.</span><span class="ident" id="2830344">FieldByNameFunc</span><span class="op" id="2830359">(</span><span class="keyword" id="2830360">func</span><span class="op" id="2830364">(</span><span class="ident" id="2830365">s</span>&nbsp;<span class="builtintype" id="2830367">string</span><span class="op" id="2830373">)</span>&nbsp;<span class="builtintype" id="2830375">bool</span>&nbsp;<span class="op" id="2830380">{</span>&nbsp;<span class="keyword" id="2830382">return</span>&nbsp;<span class="ident" id="2830389">s</span>&nbsp;<span class="op" id="2830391">==</span>&nbsp;<span class="ident" id="2830394">name</span>&nbsp;<span class="op" id="2830399">}</span><span class="op" id="2830400">)</span><br>
<span class="lineno">1000</span><span class="op" id="2830402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2830405">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2830476">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2830504">func</span>&nbsp;<span class="ident" id="2830509">TypeOf</span><span class="op" id="2830515">(</span><span class="ident" id="2830516">i</span>&nbsp;<span class="keyword" id="2830518">interface</span><span class="op" id="2830527">{</span><span class="op" id="2830528">}</span><span class="op" id="2830529">)</span>&nbsp;<span class="ident" id="2830531">Type</span>&nbsp;<span class="op" id="2830536">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830539">eface</span>&nbsp;<span class="op" id="2830545">:=</span>&nbsp;<span class="op" id="2830548">*</span><span class="op" id="2830549">(</span><span class="op" id="2830550">*</span><span class="ident" id="2830551">emptyInterface</span><span class="op" id="2830565">)</span><span class="op" id="2830566">(</span><span class="ident" id="2830567">unsafe</span><span class="op" id="2830573">.</span><span class="ident" id="2830574">Pointer</span><span class="op" id="2830581">(</span><span class="op" id="2830582">&amp;</span><span class="ident" id="2830583">i</span><span class="op" id="2830584">)</span><span class="op" id="2830585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830588">return</span>&nbsp;<span class="ident" id="2830595">toType</span><span class="op" id="2830601">(</span><span class="ident" id="2830602">eface</span><span class="op" id="2830607">.</span><span class="ident" id="2830608">typ</span><span class="op" id="2830611">)</span><br>
<span class="lineno"></span><span class="op" id="2830613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2830616">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2830650">var</span>&nbsp;<span class="ident" id="2830654">ptrMap</span>&nbsp;<span class="keyword" id="2830661">struct</span>&nbsp;<span class="op" id="2830668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830671">sync</span><span class="op" id="2830675">.</span><span class="ident" id="2830676">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830685">m</span>&nbsp;<span class="keyword" id="2830687">map</span><span class="op" id="2830690">[</span><span class="op" id="2830691">*</span><span class="ident" id="2830692">rtype</span><span class="op" id="2830697">]</span><span class="op" id="2830698">*</span><span class="ident" id="2830699">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2830707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2830710">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2830760">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2830828">func</span>&nbsp;<span class="ident" id="2830833">PtrTo</span><span class="op" id="2830838">(</span><span class="ident" id="2830839">t</span>&nbsp;<span class="ident" id="2830841">Type</span><span class="op" id="2830845">)</span>&nbsp;<span class="ident" id="2830847">Type</span>&nbsp;<span class="op" id="2830852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830855">return</span>&nbsp;<span class="ident" id="2830862">t</span><span class="op" id="2830863">.</span><span class="op" id="2830864">(</span><span class="op" id="2830865">*</span><span class="ident" id="2830866">rtype</span><span class="op" id="2830871">)</span><span class="op" id="2830872">.</span><span class="ident" id="2830873">ptrTo</span><span class="op" id="2830878">(</span><span class="op" id="2830879">)</span><br>
<span class="lineno"></span><span class="op" id="2830881">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2830884">func</span>&nbsp;<span class="op" id="2830889">(</span><span class="ident" id="2830890">t</span>&nbsp;<span class="op" id="2830892">*</span><span class="ident" id="2830893">rtype</span><span class="op" id="2830898">)</span>&nbsp;<span class="ident" id="2830900">ptrTo</span><span class="op" id="2830905">(</span><span class="op" id="2830906">)</span>&nbsp;<span class="op" id="2830908">*</span><span class="ident" id="2830909">rtype</span>&nbsp;<span class="op" id="2830915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830918">if</span>&nbsp;<span class="ident" id="2830921">p</span>&nbsp;<span class="op" id="2830923">:=</span>&nbsp;<span class="ident" id="2830926">t</span><span class="op" id="2830927">.</span><span class="ident" id="2830928">ptrToThis</span><span class="op" id="2830937">;</span>&nbsp;<span class="ident" id="2830939">p</span>&nbsp;<span class="op" id="2830941">!=</span>&nbsp;<span class="ident" id="2830944">nil</span>&nbsp;<span class="op" id="2830948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830952">return</span>&nbsp;<span class="ident" id="2830959">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830962">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2830966">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2830997">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831049">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831103">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831162">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831207">ptrMap</span><span class="op" id="2831213">.</span><span class="ident" id="2831214">RLock</span><span class="op" id="2831219">(</span><span class="op" id="2831220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831223">if</span>&nbsp;<span class="ident" id="2831226">m</span>&nbsp;<span class="op" id="2831228">:=</span>&nbsp;<span class="ident" id="2831231">ptrMap</span><span class="op" id="2831237">.</span><span class="ident" id="2831238">m</span><span class="op" id="2831239">;</span>&nbsp;<span class="ident" id="2831241">m</span>&nbsp;<span class="op" id="2831243">!=</span>&nbsp;<span class="ident" id="2831246">nil</span>&nbsp;<span class="op" id="2831250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831254">if</span>&nbsp;<span class="ident" id="2831257">p</span>&nbsp;<span class="op" id="2831259">:=</span>&nbsp;<span class="ident" id="2831262">m</span><span class="op" id="2831263">[</span><span class="ident" id="2831264">t</span><span class="op" id="2831265">]</span><span class="op" id="2831266">;</span>&nbsp;<span class="ident" id="2831268">p</span>&nbsp;<span class="op" id="2831270">!=</span>&nbsp;<span class="ident" id="2831273">nil</span>&nbsp;<span class="op" id="2831277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831282">ptrMap</span><span class="op" id="2831288">.</span><span class="ident" id="2831289">RUnlock</span><span class="op" id="2831296">(</span><span class="op" id="2831297">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831302">return</span>&nbsp;<span class="op" id="2831309">&amp;</span><span class="ident" id="2831310">p</span><span class="op" id="2831311">.</span><span class="ident" id="2831312">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831326">ptrMap</span><span class="op" id="2831332">.</span><span class="ident" id="2831333">RUnlock</span><span class="op" id="2831340">(</span><span class="op" id="2831341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831344">ptrMap</span><span class="op" id="2831350">.</span><span class="ident" id="2831351">Lock</span><span class="op" id="2831355">(</span><span class="op" id="2831356">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831359">if</span>&nbsp;<span class="ident" id="2831362">ptrMap</span><span class="op" id="2831368">.</span><span class="ident" id="2831369">m</span>&nbsp;<span class="op" id="2831371">==</span>&nbsp;<span class="ident" id="2831374">nil</span>&nbsp;<span class="op" id="2831378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831382">ptrMap</span><span class="op" id="2831388">.</span><span class="ident" id="2831389">m</span>&nbsp;<span class="op" id="2831391">=</span>&nbsp;<span class="builtinfunc" id="2831393">make</span><span class="op" id="2831397">(</span><span class="keyword" id="2831398">map</span><span class="op" id="2831401">[</span><span class="op" id="2831402">*</span><span class="ident" id="2831403">rtype</span><span class="op" id="2831408">]</span><span class="op" id="2831409">*</span><span class="ident" id="2831410">ptrType</span><span class="op" id="2831417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831423">p</span>&nbsp;<span class="op" id="2831425">:=</span>&nbsp;<span class="ident" id="2831428">ptrMap</span><span class="op" id="2831434">.</span><span class="ident" id="2831435">m</span><span class="op" id="2831436">[</span><span class="ident" id="2831437">t</span><span class="op" id="2831438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831441">if</span>&nbsp;<span class="ident" id="2831444">p</span>&nbsp;<span class="op" id="2831446">!=</span>&nbsp;<span class="ident" id="2831449">nil</span>&nbsp;<span class="op" id="2831453">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831457">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831511">ptrMap</span><span class="op" id="2831517">.</span><span class="ident" id="2831518">Unlock</span><span class="op" id="2831524">(</span><span class="op" id="2831525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831529">return</span>&nbsp;<span class="op" id="2831536">&amp;</span><span class="ident" id="2831537">p</span><span class="op" id="2831538">.</span><span class="ident" id="2831539">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831550">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831605">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831632">p</span>&nbsp;<span class="op" id="2831634">=</span>&nbsp;<span class="builtinfunc" id="2831636">new</span><span class="op" id="2831639">(</span><span class="ident" id="2831640">ptrType</span><span class="op" id="2831647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831650">var</span>&nbsp;<span class="ident" id="2831654">iptr</span>&nbsp;<span class="keyword" id="2831659">interface</span><span class="op" id="2831668">{</span><span class="op" id="2831669">}</span>&nbsp;<span class="op" id="2831671">=</span>&nbsp;<span class="op" id="2831673">(</span><span class="op" id="2831674">*</span><span class="ident" id="2831675">unsafe</span><span class="op" id="2831681">.</span><span class="ident" id="2831682">Pointer</span><span class="op" id="2831689">)</span><span class="op" id="2831690">(</span><span class="ident" id="2831691">nil</span><span class="op" id="2831694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831697">prototype</span>&nbsp;<span class="op" id="2831707">:=</span>&nbsp;<span class="op" id="2831710">*</span><span class="op" id="2831711">(</span><span class="op" id="2831712">*</span><span class="op" id="2831713">*</span><span class="ident" id="2831714">ptrType</span><span class="op" id="2831721">)</span><span class="op" id="2831722">(</span><span class="ident" id="2831723">unsafe</span><span class="op" id="2831729">.</span><span class="ident" id="2831730">Pointer</span><span class="op" id="2831737">(</span><span class="op" id="2831738">&amp;</span><span class="ident" id="2831739">iptr</span><span class="op" id="2831743">)</span><span class="op" id="2831744">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831747">*</span><span class="ident" id="2831748">p</span>&nbsp;<span class="op" id="2831750">=</span>&nbsp;<span class="op" id="2831752">*</span><span class="ident" id="2831753">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831765">s</span>&nbsp;<span class="op" id="2831767">:=</span>&nbsp;<span class="string" id="2831770">&#34;*&#34;</span>&nbsp;<span class="op" id="2831774">+</span>&nbsp;<span class="op" id="2831776">*</span><span class="ident" id="2831777">t</span><span class="op" id="2831778">.</span><span class="builtintype" id="2831779">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831787">p</span><span class="op" id="2831788">.</span><span class="builtintype" id="2831789">string</span>&nbsp;<span class="op" id="2831796">=</span>&nbsp;<span class="op" id="2831798">&amp;</span><span class="ident" id="2831799">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831803">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831859">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831908">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2831959">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2832011">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832041">p</span><span class="op" id="2832042">.</span><span class="ident" id="2832043">hash</span>&nbsp;<span class="op" id="2832048">=</span>&nbsp;<span class="ident" id="2832050">fnv1</span><span class="op" id="2832054">(</span><span class="ident" id="2832055">t</span><span class="op" id="2832056">.</span><span class="ident" id="2832057">hash</span><span class="op" id="2832061">,</span>&nbsp;<span class="string" id="2832063">&#39;*&#39;</span><span class="op" id="2832066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832070">p</span><span class="op" id="2832071">.</span><span class="ident" id="2832072">uncommonType</span>&nbsp;<span class="op" id="2832085">=</span>&nbsp;<span class="ident" id="2832087">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832092">p</span><span class="op" id="2832093">.</span><span class="ident" id="2832094">ptrToThis</span>&nbsp;<span class="op" id="2832104">=</span>&nbsp;<span class="ident" id="2832106">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832111">p</span><span class="op" id="2832112">.</span><span class="ident" id="2832113">zero</span>&nbsp;<span class="op" id="2832118">=</span>&nbsp;<span class="ident" id="2832120">unsafe</span><span class="op" id="2832126">.</span><span class="ident" id="2832127">Pointer</span><span class="op" id="2832134">(</span><span class="op" id="2832135">&amp;</span><span class="builtinfunc" id="2832136">make</span><span class="op" id="2832140">(</span><span class="op" id="2832141">[</span><span class="op" id="2832142">]</span><span class="builtintype" id="2832143">byte</span><span class="op" id="2832147">,</span>&nbsp;<span class="ident" id="2832149">p</span><span class="op" id="2832150">.</span><span class="ident" id="2832151">size</span><span class="op" id="2832155">)</span><span class="op" id="2832156">[</span><span class="num" id="2832157">0</span><span class="op" id="2832158">]</span><span class="op" id="2832159">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832162">p</span><span class="op" id="2832163">.</span><span class="ident" id="2832164">elem</span>&nbsp;<span class="op" id="2832169">=</span>&nbsp;<span class="ident" id="2832171">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832175">ptrMap</span><span class="op" id="2832181">.</span><span class="ident" id="2832182">m</span><span class="op" id="2832183">[</span><span class="ident" id="2832184">t</span><span class="op" id="2832185">]</span>&nbsp;<span class="op" id="2832187">=</span>&nbsp;<span class="ident" id="2832189">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832192">ptrMap</span><span class="op" id="2832198">.</span><span class="ident" id="2832199">Unlock</span><span class="op" id="2832205">(</span><span class="op" id="2832206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832209">return</span>&nbsp;<span class="op" id="2832216">&amp;</span><span class="ident" id="2832217">p</span><span class="op" id="2832218">.</span><span class="ident" id="2832219">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2832225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2832228">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2832314">func</span>&nbsp;<span class="ident" id="2832319">fnv1</span><span class="op" id="2832323">(</span><span class="ident" id="2832324">x</span>&nbsp;<span class="builtintype" id="2832326">uint32</span><span class="op" id="2832332">,</span>&nbsp;<span class="ident" id="2832334">list</span>&nbsp;<span class="op" id="2832339">...</span><span class="builtintype" id="2832342">byte</span><span class="op" id="2832346">)</span>&nbsp;<span class="builtintype" id="2832348">uint32</span>&nbsp;<span class="op" id="2832355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832358">for</span>&nbsp;<span class="ident" id="2832362">_</span><span class="op" id="2832363">,</span>&nbsp;<span class="ident" id="2832365">b</span>&nbsp;<span class="op" id="2832367">:=</span>&nbsp;<span class="keyword" id="2832370">range</span>&nbsp;<span class="ident" id="2832376">list</span>&nbsp;<span class="op" id="2832381">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832385">x</span>&nbsp;<span class="op" id="2832387">=</span>&nbsp;<span class="ident" id="2832389">x</span><span class="op" id="2832390">*</span><span class="num" id="2832391">16777619</span>&nbsp;<span class="op" id="2832400">^</span>&nbsp;<span class="builtintype" id="2832402">uint32</span><span class="op" id="2832408">(</span><span class="ident" id="2832409">b</span><span class="op" id="2832410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2832413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832416">return</span>&nbsp;<span class="ident" id="2832423">x</span><br>
<span class="lineno"></span><span class="op" id="2832425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2832428">func</span>&nbsp;<span class="op" id="2832433">(</span><span class="ident" id="2832434">t</span>&nbsp;<span class="op" id="2832436">*</span><span class="ident" id="2832437">rtype</span><span class="op" id="2832442">)</span>&nbsp;<span class="ident" id="2832444">Implements</span><span class="op" id="2832454">(</span><span class="ident" id="2832455">u</span>&nbsp;<span class="ident" id="2832457">Type</span><span class="op" id="2832461">)</span>&nbsp;<span class="builtintype" id="2832463">bool</span>&nbsp;<span class="op" id="2832468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832471">if</span>&nbsp;<span class="ident" id="2832474">u</span>&nbsp;<span class="op" id="2832476">==</span>&nbsp;<span class="ident" id="2832479">nil</span>&nbsp;<span class="op" id="2832483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2832487">panic</span><span class="op" id="2832492">(</span><span class="string" id="2832493">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2832538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2832541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832544">if</span>&nbsp;<span class="ident" id="2832547">u</span><span class="op" id="2832548">.</span><span class="ident" id="2832549">Kind</span><span class="op" id="2832553">(</span><span class="op" id="2832554">)</span>&nbsp;<span class="op" id="2832556">!=</span>&nbsp;<span class="ident" id="2832559">Interface</span>&nbsp;<span class="op" id="2832569">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2832573">panic</span><span class="op" id="2832578">(</span><span class="string" id="2832579">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2832634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2832637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832640">return</span>&nbsp;<span class="ident" id="2832647">implements</span><span class="op" id="2832657">(</span><span class="ident" id="2832658">u</span><span class="op" id="2832659">.</span><span class="op" id="2832660">(</span><span class="op" id="2832661">*</span><span class="ident" id="2832662">rtype</span><span class="op" id="2832667">)</span><span class="op" id="2832668">,</span>&nbsp;<span class="ident" id="2832670">t</span><span class="op" id="2832671">)</span><br>
<span class="lineno"></span><span class="op" id="2832673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2832676">func</span>&nbsp;<span class="op" id="2832681">(</span><span class="ident" id="2832682">t</span>&nbsp;<span class="op" id="2832684">*</span><span class="ident" id="2832685">rtype</span><span class="op" id="2832690">)</span>&nbsp;<span class="ident" id="2832692">AssignableTo</span><span class="op" id="2832704">(</span><span class="ident" id="2832705">u</span>&nbsp;<span class="ident" id="2832707">Type</span><span class="op" id="2832711">)</span>&nbsp;<span class="builtintype" id="2832713">bool</span>&nbsp;<span class="op" id="2832718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832721">if</span>&nbsp;<span class="ident" id="2832724">u</span>&nbsp;<span class="op" id="2832726">==</span>&nbsp;<span class="ident" id="2832729">nil</span>&nbsp;<span class="op" id="2832733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2832737">panic</span><span class="op" id="2832742">(</span><span class="string" id="2832743">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2832790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2832793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832796">uu</span>&nbsp;<span class="op" id="2832799">:=</span>&nbsp;<span class="ident" id="2832802">u</span><span class="op" id="2832803">.</span><span class="op" id="2832804">(</span><span class="op" id="2832805">*</span><span class="ident" id="2832806">rtype</span><span class="op" id="2832811">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832814">return</span>&nbsp;<span class="ident" id="2832821">directlyAssignable</span><span class="op" id="2832839">(</span><span class="ident" id="2832840">uu</span><span class="op" id="2832842">,</span>&nbsp;<span class="ident" id="2832844">t</span><span class="op" id="2832845">)</span>&nbsp;<span class="op" id="2832847">||</span>&nbsp;<span class="ident" id="2832850">implements</span><span class="op" id="2832860">(</span><span class="ident" id="2832861">uu</span><span class="op" id="2832863">,</span>&nbsp;<span class="ident" id="2832865">t</span><span class="op" id="2832866">)</span><br>
<span class="lineno"></span><span class="op" id="2832868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2832871">func</span>&nbsp;<span class="op" id="2832876">(</span><span class="ident" id="2832877">t</span>&nbsp;<span class="op" id="2832879">*</span><span class="ident" id="2832880">rtype</span><span class="op" id="2832885">)</span>&nbsp;<span class="ident" id="2832887">ConvertibleTo</span><span class="op" id="2832900">(</span><span class="ident" id="2832901">u</span>&nbsp;<span class="ident" id="2832903">Type</span><span class="op" id="2832907">)</span>&nbsp;<span class="builtintype" id="2832909">bool</span>&nbsp;<span class="op" id="2832914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2832917">if</span>&nbsp;<span class="ident" id="2832920">u</span>&nbsp;<span class="op" id="2832922">==</span>&nbsp;<span class="ident" id="2832925">nil</span>&nbsp;<span class="op" id="2832929">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2832933">panic</span><span class="op" id="2832938">(</span><span class="string" id="2832939">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2832987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2832990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832993">uu</span>&nbsp;<span class="op" id="2832996">:=</span>&nbsp;<span class="ident" id="2832999">u</span><span class="op" id="2833000">.</span><span class="op" id="2833001">(</span><span class="op" id="2833002">*</span><span class="ident" id="2833003">rtype</span><span class="op" id="2833008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833011">return</span>&nbsp;<span class="ident" id="2833018">convertOp</span><span class="op" id="2833027">(</span><span class="ident" id="2833028">uu</span><span class="op" id="2833030">,</span>&nbsp;<span class="ident" id="2833032">t</span><span class="op" id="2833033">)</span>&nbsp;<span class="op" id="2833035">!=</span>&nbsp;<span class="ident" id="2833038">nil</span><br>
<span class="lineno"></span><span class="op" id="2833042">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2833045">func</span>&nbsp;<span class="op" id="2833050">(</span><span class="ident" id="2833051">t</span>&nbsp;<span class="op" id="2833053">*</span><span class="ident" id="2833054">rtype</span><span class="op" id="2833059">)</span>&nbsp;<span class="ident" id="2833061">Comparable</span><span class="op" id="2833071">(</span><span class="op" id="2833072">)</span>&nbsp;<span class="builtintype" id="2833074">bool</span>&nbsp;<span class="op" id="2833079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833082">return</span>&nbsp;<span class="ident" id="2833089">t</span><span class="op" id="2833090">.</span><span class="ident" id="2833091">alg</span>&nbsp;<span class="op" id="2833095">!=</span>&nbsp;<span class="ident" id="2833098">nil</span>&nbsp;<span class="op" id="2833102">&amp;&amp;</span>&nbsp;<span class="ident" id="2833105">t</span><span class="op" id="2833106">.</span><span class="ident" id="2833107">alg</span><span class="op" id="2833110">.</span><span class="ident" id="2833111">equal</span>&nbsp;<span class="op" id="2833117">!=</span>&nbsp;<span class="ident" id="2833120">nil</span><br>
<span class="lineno"></span><span class="op" id="2833124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2833127">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2833201">func</span>&nbsp;<span class="ident" id="2833206">implements</span><span class="op" id="2833216">(</span><span class="ident" id="2833217">T</span><span class="op" id="2833218">,</span>&nbsp;<span class="ident" id="2833220">V</span>&nbsp;<span class="op" id="2833222">*</span><span class="ident" id="2833223">rtype</span><span class="op" id="2833228">)</span>&nbsp;<span class="builtintype" id="2833230">bool</span>&nbsp;<span class="op" id="2833235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833238">if</span>&nbsp;<span class="ident" id="2833241">T</span><span class="op" id="2833242">.</span><span class="ident" id="2833243">Kind</span><span class="op" id="2833247">(</span><span class="op" id="2833248">)</span>&nbsp;<span class="op" id="2833250">!=</span>&nbsp;<span class="ident" id="2833253">Interface</span>&nbsp;<span class="op" id="2833263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833267">return</span>&nbsp;<span class="builtintype" id="2833274">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833281">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833284">t</span>&nbsp;<span class="op" id="2833286">:=</span>&nbsp;<span class="op" id="2833289">(</span><span class="op" id="2833290">*</span><span class="ident" id="2833291">interfaceType</span><span class="op" id="2833304">)</span><span class="op" id="2833305">(</span><span class="ident" id="2833306">unsafe</span><span class="op" id="2833312">.</span><span class="ident" id="2833313">Pointer</span><span class="op" id="2833320">(</span><span class="ident" id="2833321">T</span><span class="op" id="2833322">)</span><span class="op" id="2833323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833326">if</span>&nbsp;<span class="builtinfunc" id="2833329">len</span><span class="op" id="2833332">(</span><span class="ident" id="2833333">t</span><span class="op" id="2833334">.</span><span class="ident" id="2833335">methods</span><span class="op" id="2833342">)</span>&nbsp;<span class="op" id="2833344">==</span>&nbsp;<span class="num" id="2833347">0</span>&nbsp;<span class="op" id="2833349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833353">return</span>&nbsp;<span class="builtintype" id="2833360">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833370">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833424">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833484">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833530">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833592">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833650">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833710">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833771">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833828">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833887">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833951">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834005">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834038">if</span>&nbsp;<span class="ident" id="2834041">V</span><span class="op" id="2834042">.</span><span class="ident" id="2834043">Kind</span><span class="op" id="2834047">(</span><span class="op" id="2834048">)</span>&nbsp;<span class="op" id="2834050">==</span>&nbsp;<span class="ident" id="2834053">Interface</span>&nbsp;<span class="op" id="2834063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834067">v</span>&nbsp;<span class="op" id="2834069">:=</span>&nbsp;<span class="op" id="2834072">(</span><span class="op" id="2834073">*</span><span class="ident" id="2834074">interfaceType</span><span class="op" id="2834087">)</span><span class="op" id="2834088">(</span><span class="ident" id="2834089">unsafe</span><span class="op" id="2834095">.</span><span class="ident" id="2834096">Pointer</span><span class="op" id="2834103">(</span><span class="ident" id="2834104">V</span><span class="op" id="2834105">)</span><span class="op" id="2834106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834110">i</span>&nbsp;<span class="op" id="2834112">:=</span>&nbsp;<span class="num" id="2834115">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834119">for</span>&nbsp;<span class="ident" id="2834123">j</span>&nbsp;<span class="op" id="2834125">:=</span>&nbsp;<span class="num" id="2834128">0</span><span class="op" id="2834129">;</span>&nbsp;<span class="ident" id="2834131">j</span>&nbsp;<span class="op" id="2834133">&lt;</span>&nbsp;<span class="builtinfunc" id="2834135">len</span><span class="op" id="2834138">(</span><span class="ident" id="2834139">v</span><span class="op" id="2834140">.</span><span class="ident" id="2834141">methods</span><span class="op" id="2834148">)</span><span class="op" id="2834149">;</span>&nbsp;<span class="ident" id="2834151">j</span><span class="op" id="2834152">++</span>&nbsp;<span class="op" id="2834155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834160">tm</span>&nbsp;<span class="op" id="2834163">:=</span>&nbsp;<span class="op" id="2834166">&amp;</span><span class="ident" id="2834167">t</span><span class="op" id="2834168">.</span><span class="ident" id="2834169">methods</span><span class="op" id="2834176">[</span><span class="ident" id="2834177">i</span><span class="op" id="2834178">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834183">vm</span>&nbsp;<span class="op" id="2834186">:=</span>&nbsp;<span class="op" id="2834189">&amp;</span><span class="ident" id="2834190">v</span><span class="op" id="2834191">.</span><span class="ident" id="2834192">methods</span><span class="op" id="2834199">[</span><span class="ident" id="2834200">j</span><span class="op" id="2834201">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834206">if</span>&nbsp;<span class="ident" id="2834209">vm</span><span class="op" id="2834211">.</span><span class="ident" id="2834212">name</span>&nbsp;<span class="op" id="2834217">==</span>&nbsp;<span class="ident" id="2834220">tm</span><span class="op" id="2834222">.</span><span class="ident" id="2834223">name</span>&nbsp;<span class="op" id="2834228">&amp;&amp;</span>&nbsp;<span class="ident" id="2834231">vm</span><span class="op" id="2834233">.</span><span class="ident" id="2834234">pkgPath</span>&nbsp;<span class="op" id="2834242">==</span>&nbsp;<span class="ident" id="2834245">tm</span><span class="op" id="2834247">.</span><span class="ident" id="2834248">pkgPath</span>&nbsp;<span class="op" id="2834256">&amp;&amp;</span>&nbsp;<span class="ident" id="2834259">vm</span><span class="op" id="2834261">.</span><span class="ident" id="2834262">typ</span>&nbsp;<span class="op" id="2834266">==</span>&nbsp;<span class="ident" id="2834269">tm</span><span class="op" id="2834271">.</span><span class="ident" id="2834272">typ</span>&nbsp;<span class="op" id="2834276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834282">if</span>&nbsp;<span class="ident" id="2834285">i</span><span class="op" id="2834286">++</span><span class="op" id="2834288">;</span>&nbsp;<span class="ident" id="2834290">i</span>&nbsp;<span class="op" id="2834292">&gt;=</span>&nbsp;<span class="builtinfunc" id="2834295">len</span><span class="op" id="2834298">(</span><span class="ident" id="2834299">t</span><span class="op" id="2834300">.</span><span class="ident" id="2834301">methods</span><span class="op" id="2834308">)</span>&nbsp;<span class="op" id="2834310">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834317">return</span>&nbsp;<span class="builtintype" id="2834324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834346">return</span>&nbsp;<span class="builtintype" id="2834353">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834364">v</span>&nbsp;<span class="op" id="2834366">:=</span>&nbsp;<span class="ident" id="2834369">V</span><span class="op" id="2834370">.</span><span class="ident" id="2834371">uncommon</span><span class="op" id="2834379">(</span><span class="op" id="2834380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834383">if</span>&nbsp;<span class="ident" id="2834386">v</span>&nbsp;<span class="op" id="2834388">==</span>&nbsp;<span class="ident" id="2834391">nil</span>&nbsp;<span class="op" id="2834395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834399">return</span>&nbsp;<span class="builtintype" id="2834406">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834416">i</span>&nbsp;<span class="op" id="2834418">:=</span>&nbsp;<span class="num" id="2834421">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834424">for</span>&nbsp;<span class="ident" id="2834428">j</span>&nbsp;<span class="op" id="2834430">:=</span>&nbsp;<span class="num" id="2834433">0</span><span class="op" id="2834434">;</span>&nbsp;<span class="ident" id="2834436">j</span>&nbsp;<span class="op" id="2834438">&lt;</span>&nbsp;<span class="builtinfunc" id="2834440">len</span><span class="op" id="2834443">(</span><span class="ident" id="2834444">v</span><span class="op" id="2834445">.</span><span class="ident" id="2834446">methods</span><span class="op" id="2834453">)</span><span class="op" id="2834454">;</span>&nbsp;<span class="ident" id="2834456">j</span><span class="op" id="2834457">++</span>&nbsp;<span class="op" id="2834460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834464">tm</span>&nbsp;<span class="op" id="2834467">:=</span>&nbsp;<span class="op" id="2834470">&amp;</span><span class="ident" id="2834471">t</span><span class="op" id="2834472">.</span><span class="ident" id="2834473">methods</span><span class="op" id="2834480">[</span><span class="ident" id="2834481">i</span><span class="op" id="2834482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834486">vm</span>&nbsp;<span class="op" id="2834489">:=</span>&nbsp;<span class="op" id="2834492">&amp;</span><span class="ident" id="2834493">v</span><span class="op" id="2834494">.</span><span class="ident" id="2834495">methods</span><span class="op" id="2834502">[</span><span class="ident" id="2834503">j</span><span class="op" id="2834504">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834508">if</span>&nbsp;<span class="ident" id="2834511">vm</span><span class="op" id="2834513">.</span><span class="ident" id="2834514">name</span>&nbsp;<span class="op" id="2834519">==</span>&nbsp;<span class="ident" id="2834522">tm</span><span class="op" id="2834524">.</span><span class="ident" id="2834525">name</span>&nbsp;<span class="op" id="2834530">&amp;&amp;</span>&nbsp;<span class="ident" id="2834533">vm</span><span class="op" id="2834535">.</span><span class="ident" id="2834536">pkgPath</span>&nbsp;<span class="op" id="2834544">==</span>&nbsp;<span class="ident" id="2834547">tm</span><span class="op" id="2834549">.</span><span class="ident" id="2834550">pkgPath</span>&nbsp;<span class="op" id="2834558">&amp;&amp;</span>&nbsp;<span class="ident" id="2834561">vm</span><span class="op" id="2834563">.</span><span class="ident" id="2834564">mtyp</span>&nbsp;<span class="op" id="2834569">==</span>&nbsp;<span class="ident" id="2834572">tm</span><span class="op" id="2834574">.</span><span class="ident" id="2834575">typ</span>&nbsp;<span class="op" id="2834579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834584">if</span>&nbsp;<span class="ident" id="2834587">i</span><span class="op" id="2834588">++</span><span class="op" id="2834590">;</span>&nbsp;<span class="ident" id="2834592">i</span>&nbsp;<span class="op" id="2834594">&gt;=</span>&nbsp;<span class="builtinfunc" id="2834597">len</span><span class="op" id="2834600">(</span><span class="ident" id="2834601">t</span><span class="op" id="2834602">.</span><span class="ident" id="2834603">methods</span><span class="op" id="2834610">)</span>&nbsp;<span class="op" id="2834612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834618">return</span>&nbsp;<span class="builtintype" id="2834625">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834637">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834643">return</span>&nbsp;<span class="builtintype" id="2834650">false</span><br>
<span class="lineno"></span><span class="op" id="2834656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2834659">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2834733">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2834783">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2834835">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2834891">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2834957">func</span>&nbsp;<span class="ident" id="2834962">directlyAssignable</span><span class="op" id="2834980">(</span><span class="ident" id="2834981">T</span><span class="op" id="2834982">,</span>&nbsp;<span class="ident" id="2834984">V</span>&nbsp;<span class="op" id="2834986">*</span><span class="ident" id="2834987">rtype</span><span class="op" id="2834992">)</span>&nbsp;<span class="builtintype" id="2834994">bool</span>&nbsp;<span class="op" id="2834999">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835002">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835036">if</span>&nbsp;<span class="ident" id="2835039">T</span>&nbsp;<span class="op" id="2835041">==</span>&nbsp;<span class="ident" id="2835044">V</span>&nbsp;<span class="op" id="2835046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835050">return</span>&nbsp;<span class="builtintype" id="2835057">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835067">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835121">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835159">if</span>&nbsp;<span class="ident" id="2835162">T</span><span class="op" id="2835163">.</span><span class="ident" id="2835164">Name</span><span class="op" id="2835168">(</span><span class="op" id="2835169">)</span>&nbsp;<span class="op" id="2835171">!=</span>&nbsp;<span class="string" id="2835174">&#34;&#34;</span>&nbsp;<span class="op" id="2835177">&amp;&amp;</span>&nbsp;<span class="ident" id="2835180">V</span><span class="op" id="2835181">.</span><span class="ident" id="2835182">Name</span><span class="op" id="2835186">(</span><span class="op" id="2835187">)</span>&nbsp;<span class="op" id="2835189">!=</span>&nbsp;<span class="string" id="2835192">&#34;&#34;</span>&nbsp;<span class="op" id="2835195">||</span>&nbsp;<span class="ident" id="2835198">T</span><span class="op" id="2835199">.</span><span class="ident" id="2835200">Kind</span><span class="op" id="2835204">(</span><span class="op" id="2835205">)</span>&nbsp;<span class="op" id="2835207">!=</span>&nbsp;<span class="ident" id="2835210">V</span><span class="op" id="2835211">.</span><span class="ident" id="2835212">Kind</span><span class="op" id="2835216">(</span><span class="op" id="2835217">)</span>&nbsp;<span class="op" id="2835219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835223">return</span>&nbsp;<span class="builtintype" id="2835230">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835237">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835241">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835301">return</span>&nbsp;<span class="ident" id="2835308">haveIdenticalUnderlyingType</span><span class="op" id="2835335">(</span><span class="ident" id="2835336">T</span><span class="op" id="2835337">,</span>&nbsp;<span class="ident" id="2835339">V</span><span class="op" id="2835340">)</span><br>
<span class="lineno"></span><span class="op" id="2835342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2835345">func</span>&nbsp;<span class="ident" id="2835350">haveIdenticalUnderlyingType</span><span class="op" id="2835377">(</span><span class="ident" id="2835378">T</span><span class="op" id="2835379">,</span>&nbsp;<span class="ident" id="2835381">V</span>&nbsp;<span class="op" id="2835383">*</span><span class="ident" id="2835384">rtype</span><span class="op" id="2835389">)</span>&nbsp;<span class="builtintype" id="2835391">bool</span>&nbsp;<span class="op" id="2835396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835399">if</span>&nbsp;<span class="ident" id="2835402">T</span>&nbsp;<span class="op" id="2835404">==</span>&nbsp;<span class="ident" id="2835407">V</span>&nbsp;<span class="op" id="2835409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835413">return</span>&nbsp;<span class="builtintype" id="2835420">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835430">kind</span>&nbsp;<span class="op" id="2835435">:=</span>&nbsp;<span class="ident" id="2835438">T</span><span class="op" id="2835439">.</span><span class="ident" id="2835440">Kind</span><span class="op" id="2835444">(</span><span class="op" id="2835445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835448">if</span>&nbsp;<span class="ident" id="2835451">kind</span>&nbsp;<span class="op" id="2835456">!=</span>&nbsp;<span class="ident" id="2835459">V</span><span class="op" id="2835460">.</span><span class="ident" id="2835461">Kind</span><span class="op" id="2835465">(</span><span class="op" id="2835466">)</span>&nbsp;<span class="op" id="2835468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835472">return</span>&nbsp;<span class="builtintype" id="2835479">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835490">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835554">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835597">if</span>&nbsp;<span class="ident" id="2835600">Bool</span>&nbsp;<span class="op" id="2835605">&lt;=</span>&nbsp;<span class="ident" id="2835608">kind</span>&nbsp;<span class="op" id="2835613">&amp;&amp;</span>&nbsp;<span class="ident" id="2835616">kind</span>&nbsp;<span class="op" id="2835621">&lt;=</span>&nbsp;<span class="ident" id="2835624">Complex128</span>&nbsp;<span class="op" id="2835635">||</span>&nbsp;<span class="ident" id="2835638">kind</span>&nbsp;<span class="op" id="2835643">==</span>&nbsp;<span class="ident" id="2835646">String</span>&nbsp;<span class="op" id="2835653">||</span>&nbsp;<span class="ident" id="2835656">kind</span>&nbsp;<span class="op" id="2835661">==</span>&nbsp;<span class="ident" id="2835664">UnsafePointer</span>&nbsp;<span class="op" id="2835678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835682">return</span>&nbsp;<span class="builtintype" id="2835689">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835695">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835699">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835720">switch</span>&nbsp;<span class="ident" id="2835727">kind</span>&nbsp;<span class="op" id="2835732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835735">case</span>&nbsp;<span class="ident" id="2835740">Array</span><span class="op" id="2835745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835749">return</span>&nbsp;<span class="ident" id="2835756">T</span><span class="op" id="2835757">.</span><span class="ident" id="2835758">Elem</span><span class="op" id="2835762">(</span><span class="op" id="2835763">)</span>&nbsp;<span class="op" id="2835765">==</span>&nbsp;<span class="ident" id="2835768">V</span><span class="op" id="2835769">.</span><span class="ident" id="2835770">Elem</span><span class="op" id="2835774">(</span><span class="op" id="2835775">)</span>&nbsp;<span class="op" id="2835777">&amp;&amp;</span>&nbsp;<span class="ident" id="2835780">T</span><span class="op" id="2835781">.</span><span class="ident" id="2835782">Len</span><span class="op" id="2835785">(</span><span class="op" id="2835786">)</span>&nbsp;<span class="op" id="2835788">==</span>&nbsp;<span class="ident" id="2835791">V</span><span class="op" id="2835792">.</span><span class="ident" id="2835793">Len</span><span class="op" id="2835796">(</span><span class="op" id="2835797">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835801">case</span>&nbsp;<span class="ident" id="2835806">Chan</span><span class="op" id="2835810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835814">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835833">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835895">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835951">if</span>&nbsp;<span class="ident" id="2835954">V</span><span class="op" id="2835955">.</span><span class="ident" id="2835956">ChanDir</span><span class="op" id="2835963">(</span><span class="op" id="2835964">)</span>&nbsp;<span class="op" id="2835966">==</span>&nbsp;<span class="ident" id="2835969">BothDir</span>&nbsp;<span class="op" id="2835977">&amp;&amp;</span>&nbsp;<span class="ident" id="2835980">T</span><span class="op" id="2835981">.</span><span class="ident" id="2835982">Elem</span><span class="op" id="2835986">(</span><span class="op" id="2835987">)</span>&nbsp;<span class="op" id="2835989">==</span>&nbsp;<span class="ident" id="2835992">V</span><span class="op" id="2835993">.</span><span class="ident" id="2835994">Elem</span><span class="op" id="2835998">(</span><span class="op" id="2835999">)</span>&nbsp;<span class="op" id="2836001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836006">return</span>&nbsp;<span class="builtintype" id="2836013">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836025">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836085">return</span>&nbsp;<span class="ident" id="2836092">V</span><span class="op" id="2836093">.</span><span class="ident" id="2836094">ChanDir</span><span class="op" id="2836101">(</span><span class="op" id="2836102">)</span>&nbsp;<span class="op" id="2836104">==</span>&nbsp;<span class="ident" id="2836107">T</span><span class="op" id="2836108">.</span><span class="ident" id="2836109">ChanDir</span><span class="op" id="2836116">(</span><span class="op" id="2836117">)</span>&nbsp;<span class="op" id="2836119">&amp;&amp;</span>&nbsp;<span class="ident" id="2836122">T</span><span class="op" id="2836123">.</span><span class="ident" id="2836124">Elem</span><span class="op" id="2836128">(</span><span class="op" id="2836129">)</span>&nbsp;<span class="op" id="2836131">==</span>&nbsp;<span class="ident" id="2836134">V</span><span class="op" id="2836135">.</span><span class="ident" id="2836136">Elem</span><span class="op" id="2836140">(</span><span class="op" id="2836141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836145">case</span>&nbsp;<span class="ident" id="2836150">Func</span><span class="op" id="2836154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836158">t</span>&nbsp;<span class="op" id="2836160">:=</span>&nbsp;<span class="op" id="2836163">(</span><span class="op" id="2836164">*</span><span class="ident" id="2836165">funcType</span><span class="op" id="2836173">)</span><span class="op" id="2836174">(</span><span class="ident" id="2836175">unsafe</span><span class="op" id="2836181">.</span><span class="ident" id="2836182">Pointer</span><span class="op" id="2836189">(</span><span class="ident" id="2836190">T</span><span class="op" id="2836191">)</span><span class="op" id="2836192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836196">v</span>&nbsp;<span class="op" id="2836198">:=</span>&nbsp;<span class="op" id="2836201">(</span><span class="op" id="2836202">*</span><span class="ident" id="2836203">funcType</span><span class="op" id="2836211">)</span><span class="op" id="2836212">(</span><span class="ident" id="2836213">unsafe</span><span class="op" id="2836219">.</span><span class="ident" id="2836220">Pointer</span><span class="op" id="2836227">(</span><span class="ident" id="2836228">V</span><span class="op" id="2836229">)</span><span class="op" id="2836230">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836234">if</span>&nbsp;<span class="ident" id="2836237">t</span><span class="op" id="2836238">.</span><span class="ident" id="2836239">dotdotdot</span>&nbsp;<span class="op" id="2836249">!=</span>&nbsp;<span class="ident" id="2836252">v</span><span class="op" id="2836253">.</span><span class="ident" id="2836254">dotdotdot</span>&nbsp;<span class="op" id="2836264">||</span>&nbsp;<span class="builtinfunc" id="2836267">len</span><span class="op" id="2836270">(</span><span class="ident" id="2836271">t</span><span class="op" id="2836272">.</span><span class="ident" id="2836273">in</span><span class="op" id="2836275">)</span>&nbsp;<span class="op" id="2836277">!=</span>&nbsp;<span class="builtinfunc" id="2836280">len</span><span class="op" id="2836283">(</span><span class="ident" id="2836284">v</span><span class="op" id="2836285">.</span><span class="ident" id="2836286">in</span><span class="op" id="2836288">)</span>&nbsp;<span class="op" id="2836290">||</span>&nbsp;<span class="builtinfunc" id="2836293">len</span><span class="op" id="2836296">(</span><span class="ident" id="2836297">t</span><span class="op" id="2836298">.</span><span class="ident" id="2836299">out</span><span class="op" id="2836302">)</span>&nbsp;<span class="op" id="2836304">!=</span>&nbsp;<span class="builtinfunc" id="2836307">len</span><span class="op" id="2836310">(</span><span class="ident" id="2836311">v</span><span class="op" id="2836312">.</span><span class="ident" id="2836313">out</span><span class="op" id="2836316">)</span>&nbsp;<span class="op" id="2836318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836323">return</span>&nbsp;<span class="builtintype" id="2836330">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836342">for</span>&nbsp;<span class="ident" id="2836346">i</span><span class="op" id="2836347">,</span>&nbsp;<span class="ident" id="2836349">typ</span>&nbsp;<span class="op" id="2836353">:=</span>&nbsp;<span class="keyword" id="2836356">range</span>&nbsp;<span class="ident" id="2836362">t</span><span class="op" id="2836363">.</span><span class="ident" id="2836364">in</span>&nbsp;<span class="op" id="2836367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836372">if</span>&nbsp;<span class="ident" id="2836375">typ</span>&nbsp;<span class="op" id="2836379">!=</span>&nbsp;<span class="ident" id="2836382">v</span><span class="op" id="2836383">.</span><span class="ident" id="2836384">in</span><span class="op" id="2836386">[</span><span class="ident" id="2836387">i</span><span class="op" id="2836388">]</span>&nbsp;<span class="op" id="2836390">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836396">return</span>&nbsp;<span class="builtintype" id="2836403">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836420">for</span>&nbsp;<span class="ident" id="2836424">i</span><span class="op" id="2836425">,</span>&nbsp;<span class="ident" id="2836427">typ</span>&nbsp;<span class="op" id="2836431">:=</span>&nbsp;<span class="keyword" id="2836434">range</span>&nbsp;<span class="ident" id="2836440">t</span><span class="op" id="2836441">.</span><span class="ident" id="2836442">out</span>&nbsp;<span class="op" id="2836446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836451">if</span>&nbsp;<span class="ident" id="2836454">typ</span>&nbsp;<span class="op" id="2836458">!=</span>&nbsp;<span class="ident" id="2836461">v</span><span class="op" id="2836462">.</span><span class="ident" id="2836463">out</span><span class="op" id="2836466">[</span><span class="ident" id="2836467">i</span><span class="op" id="2836468">]</span>&nbsp;<span class="op" id="2836470">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836476">return</span>&nbsp;<span class="builtintype" id="2836483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836500">return</span>&nbsp;<span class="builtintype" id="2836507">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836514">case</span>&nbsp;<span class="ident" id="2836519">Interface</span><span class="op" id="2836528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836532">t</span>&nbsp;<span class="op" id="2836534">:=</span>&nbsp;<span class="op" id="2836537">(</span><span class="op" id="2836538">*</span><span class="ident" id="2836539">interfaceType</span><span class="op" id="2836552">)</span><span class="op" id="2836553">(</span><span class="ident" id="2836554">unsafe</span><span class="op" id="2836560">.</span><span class="ident" id="2836561">Pointer</span><span class="op" id="2836568">(</span><span class="ident" id="2836569">T</span><span class="op" id="2836570">)</span><span class="op" id="2836571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836575">v</span>&nbsp;<span class="op" id="2836577">:=</span>&nbsp;<span class="op" id="2836580">(</span><span class="op" id="2836581">*</span><span class="ident" id="2836582">interfaceType</span><span class="op" id="2836595">)</span><span class="op" id="2836596">(</span><span class="ident" id="2836597">unsafe</span><span class="op" id="2836603">.</span><span class="ident" id="2836604">Pointer</span><span class="op" id="2836611">(</span><span class="ident" id="2836612">V</span><span class="op" id="2836613">)</span><span class="op" id="2836614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836618">if</span>&nbsp;<span class="builtinfunc" id="2836621">len</span><span class="op" id="2836624">(</span><span class="ident" id="2836625">t</span><span class="op" id="2836626">.</span><span class="ident" id="2836627">methods</span><span class="op" id="2836634">)</span>&nbsp;<span class="op" id="2836636">==</span>&nbsp;<span class="num" id="2836639">0</span>&nbsp;<span class="op" id="2836641">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2836644">len</span><span class="op" id="2836647">(</span><span class="ident" id="2836648">v</span><span class="op" id="2836649">.</span><span class="ident" id="2836650">methods</span><span class="op" id="2836657">)</span>&nbsp;<span class="op" id="2836659">==</span>&nbsp;<span class="num" id="2836662">0</span>&nbsp;<span class="op" id="2836664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836669">return</span>&nbsp;<span class="builtintype" id="2836676">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2836683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836687">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836730">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836763">return</span>&nbsp;<span class="builtintype" id="2836770">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836778">case</span>&nbsp;<span class="ident" id="2836783">Map</span><span class="op" id="2836786">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836790">return</span>&nbsp;<span class="ident" id="2836797">T</span><span class="op" id="2836798">.</span><span class="ident" id="2836799">Key</span><span class="op" id="2836802">(</span><span class="op" id="2836803">)</span>&nbsp;<span class="op" id="2836805">==</span>&nbsp;<span class="ident" id="2836808">V</span><span class="op" id="2836809">.</span><span class="ident" id="2836810">Key</span><span class="op" id="2836813">(</span><span class="op" id="2836814">)</span>&nbsp;<span class="op" id="2836816">&amp;&amp;</span>&nbsp;<span class="ident" id="2836819">T</span><span class="op" id="2836820">.</span><span class="ident" id="2836821">Elem</span><span class="op" id="2836825">(</span><span class="op" id="2836826">)</span>&nbsp;<span class="op" id="2836828">==</span>&nbsp;<span class="ident" id="2836831">V</span><span class="op" id="2836832">.</span><span class="ident" id="2836833">Elem</span><span class="op" id="2836837">(</span><span class="op" id="2836838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836842">case</span>&nbsp;<span class="ident" id="2836847">Ptr</span><span class="op" id="2836850">,</span>&nbsp;<span class="ident" id="2836852">Slice</span><span class="op" id="2836857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836861">return</span>&nbsp;<span class="ident" id="2836868">T</span><span class="op" id="2836869">.</span><span class="ident" id="2836870">Elem</span><span class="op" id="2836874">(</span><span class="op" id="2836875">)</span>&nbsp;<span class="op" id="2836877">==</span>&nbsp;<span class="ident" id="2836880">V</span><span class="op" id="2836881">.</span><span class="ident" id="2836882">Elem</span><span class="op" id="2836886">(</span><span class="op" id="2836887">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836891">case</span>&nbsp;<span class="ident" id="2836896">Struct</span><span class="op" id="2836902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836906">t</span>&nbsp;<span class="op" id="2836908">:=</span>&nbsp;<span class="op" id="2836911">(</span><span class="op" id="2836912">*</span><span class="ident" id="2836913">structType</span><span class="op" id="2836923">)</span><span class="op" id="2836924">(</span><span class="ident" id="2836925">unsafe</span><span class="op" id="2836931">.</span><span class="ident" id="2836932">Pointer</span><span class="op" id="2836939">(</span><span class="ident" id="2836940">T</span><span class="op" id="2836941">)</span><span class="op" id="2836942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836946">v</span>&nbsp;<span class="op" id="2836948">:=</span>&nbsp;<span class="op" id="2836951">(</span><span class="op" id="2836952">*</span><span class="ident" id="2836953">structType</span><span class="op" id="2836963">)</span><span class="op" id="2836964">(</span><span class="ident" id="2836965">unsafe</span><span class="op" id="2836971">.</span><span class="ident" id="2836972">Pointer</span><span class="op" id="2836979">(</span><span class="ident" id="2836980">V</span><span class="op" id="2836981">)</span><span class="op" id="2836982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836986">if</span>&nbsp;<span class="builtinfunc" id="2836989">len</span><span class="op" id="2836992">(</span><span class="ident" id="2836993">t</span><span class="op" id="2836994">.</span><span class="ident" id="2836995">fields</span><span class="op" id="2837001">)</span>&nbsp;<span class="op" id="2837003">!=</span>&nbsp;<span class="builtinfunc" id="2837006">len</span><span class="op" id="2837009">(</span><span class="ident" id="2837010">v</span><span class="op" id="2837011">.</span><span class="ident" id="2837012">fields</span><span class="op" id="2837018">)</span>&nbsp;<span class="op" id="2837020">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837025">return</span>&nbsp;<span class="builtintype" id="2837032">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837044">for</span>&nbsp;<span class="ident" id="2837048">i</span>&nbsp;<span class="op" id="2837050">:=</span>&nbsp;<span class="keyword" id="2837053">range</span>&nbsp;<span class="ident" id="2837059">t</span><span class="op" id="2837060">.</span><span class="ident" id="2837061">fields</span>&nbsp;<span class="op" id="2837068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837073">tf</span>&nbsp;<span class="op" id="2837076">:=</span>&nbsp;<span class="op" id="2837079">&amp;</span><span class="ident" id="2837080">t</span><span class="op" id="2837081">.</span><span class="ident" id="2837082">fields</span><span class="op" id="2837088">[</span><span class="ident" id="2837089">i</span><span class="op" id="2837090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837095">vf</span>&nbsp;<span class="op" id="2837098">:=</span>&nbsp;<span class="op" id="2837101">&amp;</span><span class="ident" id="2837102">v</span><span class="op" id="2837103">.</span><span class="ident" id="2837104">fields</span><span class="op" id="2837110">[</span><span class="ident" id="2837111">i</span><span class="op" id="2837112">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837117">if</span>&nbsp;<span class="ident" id="2837120">tf</span><span class="op" id="2837122">.</span><span class="ident" id="2837123">name</span>&nbsp;<span class="op" id="2837128">!=</span>&nbsp;<span class="ident" id="2837131">vf</span><span class="op" id="2837133">.</span><span class="ident" id="2837134">name</span>&nbsp;<span class="op" id="2837139">&amp;&amp;</span>&nbsp;<span class="op" id="2837142">(</span><span class="ident" id="2837143">tf</span><span class="op" id="2837145">.</span><span class="ident" id="2837146">name</span>&nbsp;<span class="op" id="2837151">==</span>&nbsp;<span class="ident" id="2837154">nil</span>&nbsp;<span class="op" id="2837158">||</span>&nbsp;<span class="ident" id="2837161">vf</span><span class="op" id="2837163">.</span><span class="ident" id="2837164">name</span>&nbsp;<span class="op" id="2837169">==</span>&nbsp;<span class="ident" id="2837172">nil</span>&nbsp;<span class="op" id="2837176">||</span>&nbsp;<span class="op" id="2837179">*</span><span class="ident" id="2837180">tf</span><span class="op" id="2837182">.</span><span class="ident" id="2837183">name</span>&nbsp;<span class="op" id="2837188">!=</span>&nbsp;<span class="op" id="2837191">*</span><span class="ident" id="2837192">vf</span><span class="op" id="2837194">.</span><span class="ident" id="2837195">name</span><span class="op" id="2837199">)</span>&nbsp;<span class="op" id="2837201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837207">return</span>&nbsp;<span class="builtintype" id="2837214">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837228">if</span>&nbsp;<span class="ident" id="2837231">tf</span><span class="op" id="2837233">.</span><span class="ident" id="2837234">pkgPath</span>&nbsp;<span class="op" id="2837242">!=</span>&nbsp;<span class="ident" id="2837245">vf</span><span class="op" id="2837247">.</span><span class="ident" id="2837248">pkgPath</span>&nbsp;<span class="op" id="2837256">&amp;&amp;</span>&nbsp;<span class="op" id="2837259">(</span><span class="ident" id="2837260">tf</span><span class="op" id="2837262">.</span><span class="ident" id="2837263">pkgPath</span>&nbsp;<span class="op" id="2837271">==</span>&nbsp;<span class="ident" id="2837274">nil</span>&nbsp;<span class="op" id="2837278">||</span>&nbsp;<span class="ident" id="2837281">vf</span><span class="op" id="2837283">.</span><span class="ident" id="2837284">pkgPath</span>&nbsp;<span class="op" id="2837292">==</span>&nbsp;<span class="ident" id="2837295">nil</span>&nbsp;<span class="op" id="2837299">||</span>&nbsp;<span class="op" id="2837302">*</span><span class="ident" id="2837303">tf</span><span class="op" id="2837305">.</span><span class="ident" id="2837306">pkgPath</span>&nbsp;<span class="op" id="2837314">!=</span>&nbsp;<span class="op" id="2837317">*</span><span class="ident" id="2837318">vf</span><span class="op" id="2837320">.</span><span class="ident" id="2837321">pkgPath</span><span class="op" id="2837328">)</span>&nbsp;<span class="op" id="2837330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837336">return</span>&nbsp;<span class="builtintype" id="2837343">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837357">if</span>&nbsp;<span class="ident" id="2837360">tf</span><span class="op" id="2837362">.</span><span class="ident" id="2837363">typ</span>&nbsp;<span class="op" id="2837367">!=</span>&nbsp;<span class="ident" id="2837370">vf</span><span class="op" id="2837372">.</span><span class="ident" id="2837373">typ</span>&nbsp;<span class="op" id="2837377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837383">return</span>&nbsp;<span class="builtintype" id="2837390">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837404">if</span>&nbsp;<span class="ident" id="2837407">tf</span><span class="op" id="2837409">.</span><span class="ident" id="2837410">tag</span>&nbsp;<span class="op" id="2837414">!=</span>&nbsp;<span class="ident" id="2837417">vf</span><span class="op" id="2837419">.</span><span class="ident" id="2837420">tag</span>&nbsp;<span class="op" id="2837424">&amp;&amp;</span>&nbsp;<span class="op" id="2837427">(</span><span class="ident" id="2837428">tf</span><span class="op" id="2837430">.</span><span class="ident" id="2837431">tag</span>&nbsp;<span class="op" id="2837435">==</span>&nbsp;<span class="ident" id="2837438">nil</span>&nbsp;<span class="op" id="2837442">||</span>&nbsp;<span class="ident" id="2837445">vf</span><span class="op" id="2837447">.</span><span class="ident" id="2837448">tag</span>&nbsp;<span class="op" id="2837452">==</span>&nbsp;<span class="ident" id="2837455">nil</span>&nbsp;<span class="op" id="2837459">||</span>&nbsp;<span class="op" id="2837462">*</span><span class="ident" id="2837463">tf</span><span class="op" id="2837465">.</span><span class="ident" id="2837466">tag</span>&nbsp;<span class="op" id="2837470">!=</span>&nbsp;<span class="op" id="2837473">*</span><span class="ident" id="2837474">vf</span><span class="op" id="2837476">.</span><span class="ident" id="2837477">tag</span><span class="op" id="2837480">)</span>&nbsp;<span class="op" id="2837482">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837488">return</span>&nbsp;<span class="builtintype" id="2837495">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837509">if</span>&nbsp;<span class="ident" id="2837512">tf</span><span class="op" id="2837514">.</span><span class="ident" id="2837515">offset</span>&nbsp;<span class="op" id="2837522">!=</span>&nbsp;<span class="ident" id="2837525">vf</span><span class="op" id="2837527">.</span><span class="ident" id="2837528">offset</span>&nbsp;<span class="op" id="2837535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837541">return</span>&nbsp;<span class="builtintype" id="2837548">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837557">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837565">return</span>&nbsp;<span class="builtintype" id="2837572">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837582">return</span>&nbsp;<span class="builtintype" id="2837589">false</span><br>
<span class="lineno">1285</span><span class="op" id="2837595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2837598">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2837646">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2837717">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2837778">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2837837">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2837888">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2837941">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2837980">func</span>&nbsp;<span class="ident" id="2837985">typelinks</span><span class="op" id="2837994">(</span><span class="op" id="2837995">)</span>&nbsp;<span class="op" id="2837997">[</span><span class="op" id="2837998">]</span><span class="op" id="2837999">*</span><span class="ident" id="2838000">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2838007">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2838080">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2838116">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2838181">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2838237">func</span>&nbsp;<span class="ident" id="2838242">typesByString</span><span class="op" id="2838255">(</span><span class="ident" id="2838256">s</span>&nbsp;<span class="builtintype" id="2838258">string</span><span class="op" id="2838264">)</span>&nbsp;<span class="op" id="2838266">[</span><span class="op" id="2838267">]</span><span class="op" id="2838268">*</span><span class="ident" id="2838269">rtype</span>&nbsp;<span class="op" id="2838275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838278">typ</span>&nbsp;<span class="op" id="2838282">:=</span>&nbsp;<span class="ident" id="2838285">typelinks</span><span class="op" id="2838294">(</span><span class="op" id="2838295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838299">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838371">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838451">i</span><span class="op" id="2838452">,</span>&nbsp;<span class="ident" id="2838454">j</span>&nbsp;<span class="op" id="2838456">:=</span>&nbsp;<span class="num" id="2838459">0</span><span class="op" id="2838460">,</span>&nbsp;<span class="builtinfunc" id="2838462">len</span><span class="op" id="2838465">(</span><span class="ident" id="2838466">typ</span><span class="op" id="2838469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838472">for</span>&nbsp;<span class="ident" id="2838476">i</span>&nbsp;<span class="op" id="2838478">&lt;</span>&nbsp;<span class="ident" id="2838480">j</span>&nbsp;<span class="op" id="2838482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838486">h</span>&nbsp;<span class="op" id="2838488">:=</span>&nbsp;<span class="ident" id="2838491">i</span>&nbsp;<span class="op" id="2838493">+</span>&nbsp;<span class="op" id="2838495">(</span><span class="ident" id="2838496">j</span><span class="op" id="2838497">-</span><span class="ident" id="2838498">i</span><span class="op" id="2838499">)</span><span class="op" id="2838500">/</span><span class="num" id="2838501">2</span>&nbsp;<span class="comment" id="2838503">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838540">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838557">if</span>&nbsp;<span class="op" id="2838560">!</span><span class="op" id="2838561">(</span><span class="op" id="2838562">*</span><span class="ident" id="2838563">typ</span><span class="op" id="2838566">[</span><span class="ident" id="2838567">h</span><span class="op" id="2838568">]</span><span class="op" id="2838569">.</span><span class="builtintype" id="2838570">string</span>&nbsp;<span class="op" id="2838577">&gt;=</span>&nbsp;<span class="ident" id="2838580">s</span><span class="op" id="2838581">)</span>&nbsp;<span class="op" id="2838583">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838588">i</span>&nbsp;<span class="op" id="2838590">=</span>&nbsp;<span class="ident" id="2838592">h</span>&nbsp;<span class="op" id="2838594">+</span>&nbsp;<span class="num" id="2838596">1</span>&nbsp;<span class="comment" id="2838598">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838629">}</span>&nbsp;<span class="keyword" id="2838631">else</span>&nbsp;<span class="op" id="2838636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838641">j</span>&nbsp;<span class="op" id="2838643">=</span>&nbsp;<span class="ident" id="2838645">h</span>&nbsp;<span class="comment" id="2838647">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838678">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838681">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838755">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838821">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838885">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838917">j</span>&nbsp;<span class="op" id="2838919">=</span>&nbsp;<span class="ident" id="2838921">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838924">for</span>&nbsp;<span class="ident" id="2838928">j</span>&nbsp;<span class="op" id="2838930">&lt;</span>&nbsp;<span class="builtinfunc" id="2838932">len</span><span class="op" id="2838935">(</span><span class="ident" id="2838936">typ</span><span class="op" id="2838939">)</span>&nbsp;<span class="op" id="2838941">&amp;&amp;</span>&nbsp;<span class="op" id="2838944">*</span><span class="ident" id="2838945">typ</span><span class="op" id="2838948">[</span><span class="ident" id="2838949">j</span><span class="op" id="2838950">]</span><span class="op" id="2838951">.</span><span class="builtintype" id="2838952">string</span>&nbsp;<span class="op" id="2838959">==</span>&nbsp;<span class="ident" id="2838962">s</span>&nbsp;<span class="op" id="2838964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838968">j</span><span class="op" id="2838969">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838977">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839034">return</span>&nbsp;<span class="ident" id="2839041">typ</span><span class="op" id="2839044">[</span><span class="ident" id="2839045">i</span><span class="op" id="2839046">:</span><span class="ident" id="2839047">j</span><span class="op" id="2839048">]</span><br>
<span class="lineno"></span><span class="op" id="2839050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839053">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2839115">var</span>&nbsp;<span class="ident" id="2839119">lookupCache</span>&nbsp;<span class="keyword" id="2839131">struct</span>&nbsp;<span class="op" id="2839138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839141">sync</span><span class="op" id="2839145">.</span><span class="ident" id="2839146">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839155">m</span>&nbsp;<span class="keyword" id="2839157">map</span><span class="op" id="2839160">[</span><span class="ident" id="2839161">cacheKey</span><span class="op" id="2839169">]</span><span class="op" id="2839170">*</span><span class="ident" id="2839171">rtype</span><br>
<span class="lineno"></span><span class="op" id="2839177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2839180">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2839233">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2839294">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2839351">type</span>&nbsp;<span class="ident" id="2839356">cacheKey</span>&nbsp;<span class="keyword" id="2839365">struct</span>&nbsp;<span class="op" id="2839372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839375">kind</span>&nbsp;&nbsp;<span class="ident" id="2839381">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839387">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2839393">*</span><span class="ident" id="2839394">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839401">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2839407">*</span><span class="ident" id="2839408">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839415">extra</span>&nbsp;<span class="builtintype" id="2839421">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2839429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2839432">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2839497">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2839539">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2839588">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2839651">func</span>&nbsp;<span class="ident" id="2839656">cacheGet</span><span class="op" id="2839664">(</span><span class="ident" id="2839665">k</span>&nbsp;<span class="ident" id="2839667">cacheKey</span><span class="op" id="2839675">)</span>&nbsp;<span class="ident" id="2839677">Type</span>&nbsp;<span class="op" id="2839682">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839685">lookupCache</span><span class="op" id="2839696">.</span><span class="ident" id="2839697">RLock</span><span class="op" id="2839702">(</span><span class="op" id="2839703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839706">t</span>&nbsp;<span class="op" id="2839708">:=</span>&nbsp;<span class="ident" id="2839711">lookupCache</span><span class="op" id="2839722">.</span><span class="ident" id="2839723">m</span><span class="op" id="2839724">[</span><span class="ident" id="2839725">k</span><span class="op" id="2839726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839729">lookupCache</span><span class="op" id="2839740">.</span><span class="ident" id="2839741">RUnlock</span><span class="op" id="2839748">(</span><span class="op" id="2839749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839752">if</span>&nbsp;<span class="ident" id="2839755">t</span>&nbsp;<span class="op" id="2839757">!=</span>&nbsp;<span class="ident" id="2839760">nil</span>&nbsp;<span class="op" id="2839764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839768">return</span>&nbsp;<span class="ident" id="2839775">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839782">lookupCache</span><span class="op" id="2839793">.</span><span class="ident" id="2839794">Lock</span><span class="op" id="2839798">(</span><span class="op" id="2839799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839802">t</span>&nbsp;<span class="op" id="2839804">=</span>&nbsp;<span class="ident" id="2839806">lookupCache</span><span class="op" id="2839817">.</span><span class="ident" id="2839818">m</span><span class="op" id="2839819">[</span><span class="ident" id="2839820">k</span><span class="op" id="2839821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839824">if</span>&nbsp;<span class="ident" id="2839827">t</span>&nbsp;<span class="op" id="2839829">!=</span>&nbsp;<span class="ident" id="2839832">nil</span>&nbsp;<span class="op" id="2839836">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839840">lookupCache</span><span class="op" id="2839851">.</span><span class="ident" id="2839852">Unlock</span><span class="op" id="2839858">(</span><span class="op" id="2839859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839863">return</span>&nbsp;<span class="ident" id="2839870">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839877">if</span>&nbsp;<span class="ident" id="2839880">lookupCache</span><span class="op" id="2839891">.</span><span class="ident" id="2839892">m</span>&nbsp;<span class="op" id="2839894">==</span>&nbsp;<span class="ident" id="2839897">nil</span>&nbsp;<span class="op" id="2839901">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839905">lookupCache</span><span class="op" id="2839916">.</span><span class="ident" id="2839917">m</span>&nbsp;<span class="op" id="2839919">=</span>&nbsp;<span class="builtinfunc" id="2839921">make</span><span class="op" id="2839925">(</span><span class="keyword" id="2839926">map</span><span class="op" id="2839929">[</span><span class="ident" id="2839930">cacheKey</span><span class="op" id="2839938">]</span><span class="op" id="2839939">*</span><span class="ident" id="2839940">rtype</span><span class="op" id="2839945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839952">return</span>&nbsp;<span class="ident" id="2839959">nil</span><br>
<span class="lineno"></span><span class="op" id="2839963">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2839966">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2840033">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2840098">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2840132">func</span>&nbsp;<span class="ident" id="2840137">cachePut</span><span class="op" id="2840145">(</span><span class="ident" id="2840146">k</span>&nbsp;<span class="ident" id="2840148">cacheKey</span><span class="op" id="2840156">,</span>&nbsp;<span class="ident" id="2840158">t</span>&nbsp;<span class="op" id="2840160">*</span><span class="ident" id="2840161">rtype</span><span class="op" id="2840166">)</span>&nbsp;<span class="ident" id="2840168">Type</span>&nbsp;<span class="op" id="2840173">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840176">lookupCache</span><span class="op" id="2840187">.</span><span class="ident" id="2840188">m</span><span class="op" id="2840189">[</span><span class="ident" id="2840190">k</span><span class="op" id="2840191">]</span>&nbsp;<span class="op" id="2840193">=</span>&nbsp;<span class="ident" id="2840195">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840198">lookupCache</span><span class="op" id="2840209">.</span><span class="ident" id="2840210">Unlock</span><span class="op" id="2840216">(</span><span class="op" id="2840217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840220">return</span>&nbsp;<span class="ident" id="2840227">t</span><br>
<span class="lineno"></span><span class="op" id="2840229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2840232">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2840310">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2840389">//</span><br>
<span class="lineno"></span><span class="comment" id="2840392">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2840461">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2840526">func</span>&nbsp;<span class="ident" id="2840531">ChanOf</span><span class="op" id="2840537">(</span><span class="ident" id="2840538">dir</span>&nbsp;<span class="ident" id="2840542">ChanDir</span><span class="op" id="2840549">,</span>&nbsp;<span class="ident" id="2840551">t</span>&nbsp;<span class="ident" id="2840553">Type</span><span class="op" id="2840557">)</span>&nbsp;<span class="ident" id="2840559">Type</span>&nbsp;<span class="op" id="2840564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840567">typ</span>&nbsp;<span class="op" id="2840571">:=</span>&nbsp;<span class="ident" id="2840574">t</span><span class="op" id="2840575">.</span><span class="op" id="2840576">(</span><span class="op" id="2840577">*</span><span class="ident" id="2840578">rtype</span><span class="op" id="2840583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840587">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840606">ckey</span>&nbsp;<span class="op" id="2840611">:=</span>&nbsp;<span class="ident" id="2840614">cacheKey</span><span class="op" id="2840622">{</span><span class="ident" id="2840623">Chan</span><span class="op" id="2840627">,</span>&nbsp;<span class="ident" id="2840629">typ</span><span class="op" id="2840632">,</span>&nbsp;<span class="ident" id="2840634">nil</span><span class="op" id="2840637">,</span>&nbsp;<span class="builtintype" id="2840639">uintptr</span><span class="op" id="2840646">(</span><span class="ident" id="2840647">dir</span><span class="op" id="2840650">)</span><span class="op" id="2840651">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840654">if</span>&nbsp;<span class="ident" id="2840657">ch</span>&nbsp;<span class="op" id="2840660">:=</span>&nbsp;<span class="ident" id="2840663">cacheGet</span><span class="op" id="2840671">(</span><span class="ident" id="2840672">ckey</span><span class="op" id="2840676">)</span><span class="op" id="2840677">;</span>&nbsp;<span class="ident" id="2840679">ch</span>&nbsp;<span class="op" id="2840682">!=</span>&nbsp;<span class="ident" id="2840685">nil</span>&nbsp;<span class="op" id="2840689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840693">return</span>&nbsp;<span class="ident" id="2840700">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840708">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840776">if</span>&nbsp;<span class="ident" id="2840779">typ</span><span class="op" id="2840782">.</span><span class="ident" id="2840783">size</span>&nbsp;<span class="op" id="2840788">&gt;=</span>&nbsp;<span class="num" id="2840791">1</span><span class="op" id="2840792">&lt;&lt;</span><span class="num" id="2840794">16</span>&nbsp;<span class="op" id="2840797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840801">lookupCache</span><span class="op" id="2840812">.</span><span class="ident" id="2840813">Unlock</span><span class="op" id="2840819">(</span><span class="op" id="2840820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2840824">panic</span><span class="op" id="2840829">(</span><span class="string" id="2840830">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2840870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840877">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840902">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840949">var</span>&nbsp;<span class="ident" id="2840953">s</span>&nbsp;<span class="builtintype" id="2840955">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840963">switch</span>&nbsp;<span class="ident" id="2840970">dir</span>&nbsp;<span class="op" id="2840974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840977">default</span><span class="op" id="2840984">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840988">lookupCache</span><span class="op" id="2840999">.</span><span class="ident" id="2841000">Unlock</span><span class="op" id="2841006">(</span><span class="op" id="2841007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2841011">panic</span><span class="op" id="2841016">(</span><span class="string" id="2841017">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2841046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841049">case</span>&nbsp;<span class="ident" id="2841054">SendDir</span><span class="op" id="2841061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841065">s</span>&nbsp;<span class="op" id="2841067">=</span>&nbsp;<span class="string" id="2841069">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2841079">+</span>&nbsp;<span class="op" id="2841081">*</span><span class="ident" id="2841082">typ</span><span class="op" id="2841085">.</span><span class="builtintype" id="2841086">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841094">case</span>&nbsp;<span class="ident" id="2841099">RecvDir</span><span class="op" id="2841106">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841110">s</span>&nbsp;<span class="op" id="2841112">=</span>&nbsp;<span class="string" id="2841114">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2841124">+</span>&nbsp;<span class="op" id="2841126">*</span><span class="ident" id="2841127">typ</span><span class="op" id="2841130">.</span><span class="builtintype" id="2841131">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841139">case</span>&nbsp;<span class="ident" id="2841144">BothDir</span><span class="op" id="2841151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841155">s</span>&nbsp;<span class="op" id="2841157">=</span>&nbsp;<span class="string" id="2841159">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2841167">+</span>&nbsp;<span class="op" id="2841169">*</span><span class="ident" id="2841170">typ</span><span class="op" id="2841173">.</span><span class="builtintype" id="2841174">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841185">for</span>&nbsp;<span class="ident" id="2841189">_</span><span class="op" id="2841190">,</span>&nbsp;<span class="ident" id="2841192">tt</span>&nbsp;<span class="op" id="2841195">:=</span>&nbsp;<span class="keyword" id="2841198">range</span>&nbsp;<span class="ident" id="2841204">typesByString</span><span class="op" id="2841217">(</span><span class="ident" id="2841218">s</span><span class="op" id="2841219">)</span>&nbsp;<span class="op" id="2841221">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841225">ch</span>&nbsp;<span class="op" id="2841228">:=</span>&nbsp;<span class="op" id="2841231">(</span><span class="op" id="2841232">*</span><span class="ident" id="2841233">chanType</span><span class="op" id="2841241">)</span><span class="op" id="2841242">(</span><span class="ident" id="2841243">unsafe</span><span class="op" id="2841249">.</span><span class="ident" id="2841250">Pointer</span><span class="op" id="2841257">(</span><span class="ident" id="2841258">tt</span><span class="op" id="2841260">)</span><span class="op" id="2841261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841265">if</span>&nbsp;<span class="ident" id="2841268">ch</span><span class="op" id="2841270">.</span><span class="ident" id="2841271">elem</span>&nbsp;<span class="op" id="2841276">==</span>&nbsp;<span class="ident" id="2841279">typ</span>&nbsp;<span class="op" id="2841283">&amp;&amp;</span>&nbsp;<span class="ident" id="2841286">ch</span><span class="op" id="2841288">.</span><span class="ident" id="2841289">dir</span>&nbsp;<span class="op" id="2841293">==</span>&nbsp;<span class="builtintype" id="2841296">uintptr</span><span class="op" id="2841303">(</span><span class="ident" id="2841304">dir</span><span class="op" id="2841307">)</span>&nbsp;<span class="op" id="2841309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841314">return</span>&nbsp;<span class="ident" id="2841321">cachePut</span><span class="op" id="2841329">(</span><span class="ident" id="2841330">ckey</span><span class="op" id="2841334">,</span>&nbsp;<span class="ident" id="2841336">tt</span><span class="op" id="2841338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841345">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841349">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841374">var</span>&nbsp;<span class="ident" id="2841378">ichan</span>&nbsp;<span class="keyword" id="2841384">interface</span><span class="op" id="2841393">{</span><span class="op" id="2841394">}</span>&nbsp;<span class="op" id="2841396">=</span>&nbsp;<span class="op" id="2841398">(</span><span class="keyword" id="2841399">chan</span>&nbsp;<span class="ident" id="2841404">unsafe</span><span class="op" id="2841410">.</span><span class="ident" id="2841411">Pointer</span><span class="op" id="2841418">)</span><span class="op" id="2841419">(</span><span class="ident" id="2841420">nil</span><span class="op" id="2841423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841426">prototype</span>&nbsp;<span class="op" id="2841436">:=</span>&nbsp;<span class="op" id="2841439">*</span><span class="op" id="2841440">(</span><span class="op" id="2841441">*</span><span class="op" id="2841442">*</span><span class="ident" id="2841443">chanType</span><span class="op" id="2841451">)</span><span class="op" id="2841452">(</span><span class="ident" id="2841453">unsafe</span><span class="op" id="2841459">.</span><span class="ident" id="2841460">Pointer</span><span class="op" id="2841467">(</span><span class="op" id="2841468">&amp;</span><span class="ident" id="2841469">ichan</span><span class="op" id="2841474">)</span><span class="op" id="2841475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841478">ch</span>&nbsp;<span class="op" id="2841481">:=</span>&nbsp;<span class="builtinfunc" id="2841484">new</span><span class="op" id="2841487">(</span><span class="ident" id="2841488">chanType</span><span class="op" id="2841496">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841499">*</span><span class="ident" id="2841500">ch</span>&nbsp;<span class="op" id="2841503">=</span>&nbsp;<span class="op" id="2841505">*</span><span class="ident" id="2841506">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841517">ch</span><span class="op" id="2841519">.</span><span class="builtintype" id="2841520">string</span>&nbsp;<span class="op" id="2841527">=</span>&nbsp;<span class="op" id="2841529">&amp;</span><span class="ident" id="2841530">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841533">ch</span><span class="op" id="2841535">.</span><span class="ident" id="2841536">hash</span>&nbsp;<span class="op" id="2841541">=</span>&nbsp;<span class="ident" id="2841543">fnv1</span><span class="op" id="2841547">(</span><span class="ident" id="2841548">typ</span><span class="op" id="2841551">.</span><span class="ident" id="2841552">hash</span><span class="op" id="2841556">,</span>&nbsp;<span class="string" id="2841558">&#39;c&#39;</span><span class="op" id="2841561">,</span>&nbsp;<span class="builtintype" id="2841563">byte</span><span class="op" id="2841567">(</span><span class="ident" id="2841568">dir</span><span class="op" id="2841571">)</span><span class="op" id="2841572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841575">ch</span><span class="op" id="2841577">.</span><span class="ident" id="2841578">elem</span>&nbsp;<span class="op" id="2841583">=</span>&nbsp;<span class="ident" id="2841585">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841590">ch</span><span class="op" id="2841592">.</span><span class="ident" id="2841593">uncommonType</span>&nbsp;<span class="op" id="2841606">=</span>&nbsp;<span class="ident" id="2841608">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841613">ch</span><span class="op" id="2841615">.</span><span class="ident" id="2841616">ptrToThis</span>&nbsp;<span class="op" id="2841626">=</span>&nbsp;<span class="ident" id="2841628">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841633">ch</span><span class="op" id="2841635">.</span><span class="ident" id="2841636">zero</span>&nbsp;<span class="op" id="2841641">=</span>&nbsp;<span class="ident" id="2841643">unsafe</span><span class="op" id="2841649">.</span><span class="ident" id="2841650">Pointer</span><span class="op" id="2841657">(</span><span class="op" id="2841658">&amp;</span><span class="builtinfunc" id="2841659">make</span><span class="op" id="2841663">(</span><span class="op" id="2841664">[</span><span class="op" id="2841665">]</span><span class="builtintype" id="2841666">byte</span><span class="op" id="2841670">,</span>&nbsp;<span class="ident" id="2841672">ch</span><span class="op" id="2841674">.</span><span class="ident" id="2841675">size</span><span class="op" id="2841679">)</span><span class="op" id="2841680">[</span><span class="num" id="2841681">0</span><span class="op" id="2841682">]</span><span class="op" id="2841683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841687">return</span>&nbsp;<span class="ident" id="2841694">cachePut</span><span class="op" id="2841702">(</span><span class="ident" id="2841703">ckey</span><span class="op" id="2841707">,</span>&nbsp;<span class="op" id="2841709">&amp;</span><span class="ident" id="2841710">ch</span><span class="op" id="2841712">.</span><span class="ident" id="2841713">rtype</span><span class="op" id="2841718">)</span><br>
<span class="lineno"></span><span class="op" id="2841720">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2841723">func</span>&nbsp;<span class="ident" id="2841728">ismapkey</span><span class="op" id="2841736">(</span><span class="op" id="2841737">*</span><span class="ident" id="2841738">rtype</span><span class="op" id="2841743">)</span>&nbsp;<span class="builtintype" id="2841745">bool</span>&nbsp;<span class="comment" id="2841750">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2841777">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2841845">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2841906">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2841948">//</span><br>
<span class="lineno"></span><span class="comment" id="2841951">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2842019">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2842069">func</span>&nbsp;<span class="ident" id="2842074">MapOf</span><span class="op" id="2842079">(</span><span class="ident" id="2842080">key</span><span class="op" id="2842083">,</span>&nbsp;<span class="ident" id="2842085">elem</span>&nbsp;<span class="ident" id="2842090">Type</span><span class="op" id="2842094">)</span>&nbsp;<span class="ident" id="2842096">Type</span>&nbsp;<span class="op" id="2842101">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842104">ktyp</span>&nbsp;<span class="op" id="2842109">:=</span>&nbsp;<span class="ident" id="2842112">key</span><span class="op" id="2842115">.</span><span class="op" id="2842116">(</span><span class="op" id="2842117">*</span><span class="ident" id="2842118">rtype</span><span class="op" id="2842123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842126">etyp</span>&nbsp;<span class="op" id="2842131">:=</span>&nbsp;<span class="ident" id="2842134">elem</span><span class="op" id="2842138">.</span><span class="op" id="2842139">(</span><span class="op" id="2842140">*</span><span class="ident" id="2842141">rtype</span><span class="op" id="2842146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842150">if</span>&nbsp;<span class="op" id="2842153">!</span><span class="ident" id="2842154">ismapkey</span><span class="op" id="2842162">(</span><span class="ident" id="2842163">ktyp</span><span class="op" id="2842167">)</span>&nbsp;<span class="op" id="2842169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2842173">panic</span><span class="op" id="2842178">(</span><span class="string" id="2842179">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2842214">+</span>&nbsp;<span class="ident" id="2842216">ktyp</span><span class="op" id="2842220">.</span><span class="ident" id="2842221">String</span><span class="op" id="2842227">(</span><span class="op" id="2842228">)</span><span class="op" id="2842229">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842236">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842255">ckey</span>&nbsp;<span class="op" id="2842260">:=</span>&nbsp;<span class="ident" id="2842263">cacheKey</span><span class="op" id="2842271">{</span><span class="ident" id="2842272">Map</span><span class="op" id="2842275">,</span>&nbsp;<span class="ident" id="2842277">ktyp</span><span class="op" id="2842281">,</span>&nbsp;<span class="ident" id="2842283">etyp</span><span class="op" id="2842287">,</span>&nbsp;<span class="num" id="2842289">0</span><span class="op" id="2842290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842293">if</span>&nbsp;<span class="ident" id="2842296">mt</span>&nbsp;<span class="op" id="2842299">:=</span>&nbsp;<span class="ident" id="2842302">cacheGet</span><span class="op" id="2842310">(</span><span class="ident" id="2842311">ckey</span><span class="op" id="2842315">)</span><span class="op" id="2842316">;</span>&nbsp;<span class="ident" id="2842318">mt</span>&nbsp;<span class="op" id="2842321">!=</span>&nbsp;<span class="ident" id="2842324">nil</span>&nbsp;<span class="op" id="2842328">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842332">return</span>&nbsp;<span class="ident" id="2842339">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842347">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842372">s</span>&nbsp;<span class="op" id="2842374">:=</span>&nbsp;<span class="string" id="2842377">&#34;map[&#34;</span>&nbsp;<span class="op" id="2842384">+</span>&nbsp;<span class="op" id="2842386">*</span><span class="ident" id="2842387">ktyp</span><span class="op" id="2842391">.</span><span class="builtintype" id="2842392">string</span>&nbsp;<span class="op" id="2842399">+</span>&nbsp;<span class="string" id="2842401">&#34;]&#34;</span>&nbsp;<span class="op" id="2842405">+</span>&nbsp;<span class="op" id="2842407">*</span><span class="ident" id="2842408">etyp</span><span class="op" id="2842412">.</span><span class="builtintype" id="2842413">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842421">for</span>&nbsp;<span class="ident" id="2842425">_</span><span class="op" id="2842426">,</span>&nbsp;<span class="ident" id="2842428">tt</span>&nbsp;<span class="op" id="2842431">:=</span>&nbsp;<span class="keyword" id="2842434">range</span>&nbsp;<span class="ident" id="2842440">typesByString</span><span class="op" id="2842453">(</span><span class="ident" id="2842454">s</span><span class="op" id="2842455">)</span>&nbsp;<span class="op" id="2842457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842461">mt</span>&nbsp;<span class="op" id="2842464">:=</span>&nbsp;<span class="op" id="2842467">(</span><span class="op" id="2842468">*</span><span class="ident" id="2842469">mapType</span><span class="op" id="2842476">)</span><span class="op" id="2842477">(</span><span class="ident" id="2842478">unsafe</span><span class="op" id="2842484">.</span><span class="ident" id="2842485">Pointer</span><span class="op" id="2842492">(</span><span class="ident" id="2842493">tt</span><span class="op" id="2842495">)</span><span class="op" id="2842496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842500">if</span>&nbsp;<span class="ident" id="2842503">mt</span><span class="op" id="2842505">.</span><span class="ident" id="2842506">key</span>&nbsp;<span class="op" id="2842510">==</span>&nbsp;<span class="ident" id="2842513">ktyp</span>&nbsp;<span class="op" id="2842518">&amp;&amp;</span>&nbsp;<span class="ident" id="2842521">mt</span><span class="op" id="2842523">.</span><span class="ident" id="2842524">elem</span>&nbsp;<span class="op" id="2842529">==</span>&nbsp;<span class="ident" id="2842532">etyp</span>&nbsp;<span class="op" id="2842537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842542">return</span>&nbsp;<span class="ident" id="2842549">cachePut</span><span class="op" id="2842557">(</span><span class="ident" id="2842558">ckey</span><span class="op" id="2842562">,</span>&nbsp;<span class="ident" id="2842564">tt</span><span class="op" id="2842566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842570">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842577">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842598">var</span>&nbsp;<span class="ident" id="2842602">imap</span>&nbsp;<span class="keyword" id="2842607">interface</span><span class="op" id="2842616">{</span><span class="op" id="2842617">}</span>&nbsp;<span class="op" id="2842619">=</span>&nbsp;<span class="op" id="2842621">(</span><span class="keyword" id="2842622">map</span><span class="op" id="2842625">[</span><span class="ident" id="2842626">unsafe</span><span class="op" id="2842632">.</span><span class="ident" id="2842633">Pointer</span><span class="op" id="2842640">]</span><span class="ident" id="2842641">unsafe</span><span class="op" id="2842647">.</span><span class="ident" id="2842648">Pointer</span><span class="op" id="2842655">)</span><span class="op" id="2842656">(</span><span class="ident" id="2842657">nil</span><span class="op" id="2842660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842663">prototype</span>&nbsp;<span class="op" id="2842673">:=</span>&nbsp;<span class="op" id="2842676">*</span><span class="op" id="2842677">(</span><span class="op" id="2842678">*</span><span class="op" id="2842679">*</span><span class="ident" id="2842680">mapType</span><span class="op" id="2842687">)</span><span class="op" id="2842688">(</span><span class="ident" id="2842689">unsafe</span><span class="op" id="2842695">.</span><span class="ident" id="2842696">Pointer</span><span class="op" id="2842703">(</span><span class="op" id="2842704">&amp;</span><span class="ident" id="2842705">imap</span><span class="op" id="2842709">)</span><span class="op" id="2842710">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842713">mt</span>&nbsp;<span class="op" id="2842716">:=</span>&nbsp;<span class="builtinfunc" id="2842719">new</span><span class="op" id="2842722">(</span><span class="ident" id="2842723">mapType</span><span class="op" id="2842730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842733">*</span><span class="ident" id="2842734">mt</span>&nbsp;<span class="op" id="2842737">=</span>&nbsp;<span class="op" id="2842739">*</span><span class="ident" id="2842740">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842751">mt</span><span class="op" id="2842753">.</span><span class="builtintype" id="2842754">string</span>&nbsp;<span class="op" id="2842761">=</span>&nbsp;<span class="op" id="2842763">&amp;</span><span class="ident" id="2842764">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842767">mt</span><span class="op" id="2842769">.</span><span class="ident" id="2842770">hash</span>&nbsp;<span class="op" id="2842775">=</span>&nbsp;<span class="ident" id="2842777">fnv1</span><span class="op" id="2842781">(</span><span class="ident" id="2842782">etyp</span><span class="op" id="2842786">.</span><span class="ident" id="2842787">hash</span><span class="op" id="2842791">,</span>&nbsp;<span class="string" id="2842793">&#39;m&#39;</span><span class="op" id="2842796">,</span>&nbsp;<span class="builtintype" id="2842798">byte</span><span class="op" id="2842802">(</span><span class="ident" id="2842803">ktyp</span><span class="op" id="2842807">.</span><span class="ident" id="2842808">hash</span><span class="op" id="2842812">&gt;&gt;</span><span class="num" id="2842814">24</span><span class="op" id="2842816">)</span><span class="op" id="2842817">,</span>&nbsp;<span class="builtintype" id="2842819">byte</span><span class="op" id="2842823">(</span><span class="ident" id="2842824">ktyp</span><span class="op" id="2842828">.</span><span class="ident" id="2842829">hash</span><span class="op" id="2842833">&gt;&gt;</span><span class="num" id="2842835">16</span><span class="op" id="2842837">)</span><span class="op" id="2842838">,</span>&nbsp;<span class="builtintype" id="2842840">byte</span><span class="op" id="2842844">(</span><span class="ident" id="2842845">ktyp</span><span class="op" id="2842849">.</span><span class="ident" id="2842850">hash</span><span class="op" id="2842854">&gt;&gt;</span><span class="num" id="2842856">8</span><span class="op" id="2842857">)</span><span class="op" id="2842858">,</span>&nbsp;<span class="builtintype" id="2842860">byte</span><span class="op" id="2842864">(</span><span class="ident" id="2842865">ktyp</span><span class="op" id="2842869">.</span><span class="ident" id="2842870">hash</span><span class="op" id="2842874">)</span><span class="op" id="2842875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842878">mt</span><span class="op" id="2842880">.</span><span class="ident" id="2842881">key</span>&nbsp;<span class="op" id="2842885">=</span>&nbsp;<span class="ident" id="2842887">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842893">mt</span><span class="op" id="2842895">.</span><span class="ident" id="2842896">elem</span>&nbsp;<span class="op" id="2842901">=</span>&nbsp;<span class="ident" id="2842903">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842909">mt</span><span class="op" id="2842911">.</span><span class="ident" id="2842912">bucket</span>&nbsp;<span class="op" id="2842919">=</span>&nbsp;<span class="ident" id="2842921">bucketOf</span><span class="op" id="2842929">(</span><span class="ident" id="2842930">ktyp</span><span class="op" id="2842934">,</span>&nbsp;<span class="ident" id="2842936">etyp</span><span class="op" id="2842940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842943">if</span>&nbsp;<span class="ident" id="2842946">ktyp</span><span class="op" id="2842950">.</span><span class="ident" id="2842951">size</span>&nbsp;<span class="op" id="2842956">&gt;</span>&nbsp;<span class="ident" id="2842958">maxKeySize</span>&nbsp;<span class="op" id="2842969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842973">mt</span><span class="op" id="2842975">.</span><span class="ident" id="2842976">keysize</span>&nbsp;<span class="op" id="2842984">=</span>&nbsp;<span class="builtintype" id="2842986">uint8</span><span class="op" id="2842991">(</span><span class="ident" id="2842992">ptrSize</span><span class="op" id="2842999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843003">mt</span><span class="op" id="2843005">.</span><span class="ident" id="2843006">indirectkey</span>&nbsp;<span class="op" id="2843018">=</span>&nbsp;<span class="num" id="2843020">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843023">}</span>&nbsp;<span class="keyword" id="2843025">else</span>&nbsp;<span class="op" id="2843030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843034">mt</span><span class="op" id="2843036">.</span><span class="ident" id="2843037">keysize</span>&nbsp;<span class="op" id="2843045">=</span>&nbsp;<span class="builtintype" id="2843047">uint8</span><span class="op" id="2843052">(</span><span class="ident" id="2843053">ktyp</span><span class="op" id="2843057">.</span><span class="ident" id="2843058">size</span><span class="op" id="2843062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843066">mt</span><span class="op" id="2843068">.</span><span class="ident" id="2843069">indirectkey</span>&nbsp;<span class="op" id="2843081">=</span>&nbsp;<span class="num" id="2843083">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843089">if</span>&nbsp;<span class="ident" id="2843092">etyp</span><span class="op" id="2843096">.</span><span class="ident" id="2843097">size</span>&nbsp;<span class="op" id="2843102">&gt;</span>&nbsp;<span class="ident" id="2843104">maxValSize</span>&nbsp;<span class="op" id="2843115">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843119">mt</span><span class="op" id="2843121">.</span><span class="ident" id="2843122">valuesize</span>&nbsp;<span class="op" id="2843132">=</span>&nbsp;<span class="builtintype" id="2843134">uint8</span><span class="op" id="2843139">(</span><span class="ident" id="2843140">ptrSize</span><span class="op" id="2843147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843151">mt</span><span class="op" id="2843153">.</span><span class="ident" id="2843154">indirectvalue</span>&nbsp;<span class="op" id="2843168">=</span>&nbsp;<span class="num" id="2843170">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843173">}</span>&nbsp;<span class="keyword" id="2843175">else</span>&nbsp;<span class="op" id="2843180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843184">mt</span><span class="op" id="2843186">.</span><span class="ident" id="2843187">valuesize</span>&nbsp;<span class="op" id="2843197">=</span>&nbsp;<span class="builtintype" id="2843199">uint8</span><span class="op" id="2843204">(</span><span class="ident" id="2843205">etyp</span><span class="op" id="2843209">.</span><span class="ident" id="2843210">size</span><span class="op" id="2843214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843218">mt</span><span class="op" id="2843220">.</span><span class="ident" id="2843221">indirectvalue</span>&nbsp;<span class="op" id="2843235">=</span>&nbsp;<span class="num" id="2843237">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843243">mt</span><span class="op" id="2843245">.</span><span class="ident" id="2843246">bucketsize</span>&nbsp;<span class="op" id="2843257">=</span>&nbsp;<span class="builtintype" id="2843259">uint16</span><span class="op" id="2843265">(</span><span class="ident" id="2843266">mt</span><span class="op" id="2843268">.</span><span class="ident" id="2843269">bucket</span><span class="op" id="2843275">.</span><span class="ident" id="2843276">size</span><span class="op" id="2843280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843283">mt</span><span class="op" id="2843285">.</span><span class="ident" id="2843286">uncommonType</span>&nbsp;<span class="op" id="2843299">=</span>&nbsp;<span class="ident" id="2843301">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843306">mt</span><span class="op" id="2843308">.</span><span class="ident" id="2843309">ptrToThis</span>&nbsp;<span class="op" id="2843319">=</span>&nbsp;<span class="ident" id="2843321">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843326">mt</span><span class="op" id="2843328">.</span><span class="ident" id="2843329">zero</span>&nbsp;<span class="op" id="2843334">=</span>&nbsp;<span class="ident" id="2843336">unsafe</span><span class="op" id="2843342">.</span><span class="ident" id="2843343">Pointer</span><span class="op" id="2843350">(</span><span class="op" id="2843351">&amp;</span><span class="builtinfunc" id="2843352">make</span><span class="op" id="2843356">(</span><span class="op" id="2843357">[</span><span class="op" id="2843358">]</span><span class="builtintype" id="2843359">byte</span><span class="op" id="2843363">,</span>&nbsp;<span class="ident" id="2843365">mt</span><span class="op" id="2843367">.</span><span class="ident" id="2843368">size</span><span class="op" id="2843372">)</span><span class="op" id="2843373">[</span><span class="num" id="2843374">0</span><span class="op" id="2843375">]</span><span class="op" id="2843376">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843380">return</span>&nbsp;<span class="ident" id="2843387">cachePut</span><span class="op" id="2843395">(</span><span class="ident" id="2843396">ckey</span><span class="op" id="2843400">,</span>&nbsp;<span class="op" id="2843402">&amp;</span><span class="ident" id="2843403">mt</span><span class="op" id="2843405">.</span><span class="ident" id="2843406">rtype</span><span class="op" id="2843411">)</span><br>
<span class="lineno"></span><span class="op" id="2843413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2843416">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2843480">type</span>&nbsp;<span class="ident" id="2843485">gcProg</span>&nbsp;<span class="keyword" id="2843492">struct</span>&nbsp;<span class="op" id="2843499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843502">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2843507">[</span><span class="op" id="2843508">]</span><span class="builtintype" id="2843509">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843515">size</span>&nbsp;<span class="builtintype" id="2843520">uintptr</span>&nbsp;<span class="comment" id="2843528">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2843553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2843556">func</span>&nbsp;<span class="op" id="2843561">(</span><span class="ident" id="2843562">gc</span>&nbsp;<span class="op" id="2843565">*</span><span class="ident" id="2843566">gcProg</span><span class="op" id="2843572">)</span>&nbsp;<span class="builtinfunc" id="2843574">append</span><span class="op" id="2843580">(</span><span class="ident" id="2843581">v</span>&nbsp;<span class="builtintype" id="2843583">byte</span><span class="op" id="2843587">)</span>&nbsp;<span class="op" id="2843589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843592">gc</span><span class="op" id="2843594">.</span><span class="ident" id="2843595">align</span><span class="op" id="2843600">(</span><span class="ident" id="2843601">unsafe</span><span class="op" id="2843607">.</span><span class="ident" id="2843608">Sizeof</span><span class="op" id="2843614">(</span><span class="builtintype" id="2843615">uintptr</span><span class="op" id="2843622">(</span><span class="num" id="2843623">0</span><span class="op" id="2843624">)</span><span class="op" id="2843625">)</span><span class="op" id="2843626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843629">gc</span><span class="op" id="2843631">.</span><span class="ident" id="2843632">appendWord</span><span class="op" id="2843642">(</span><span class="ident" id="2843643">v</span><span class="op" id="2843644">)</span><br>
<span class="lineno"></span><span class="op" id="2843646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2843649">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2843698">func</span>&nbsp;<span class="op" id="2843703">(</span><span class="ident" id="2843704">gc</span>&nbsp;<span class="op" id="2843707">*</span><span class="ident" id="2843708">gcProg</span><span class="op" id="2843714">)</span>&nbsp;<span class="ident" id="2843716">appendProg</span><span class="op" id="2843726">(</span><span class="ident" id="2843727">t</span>&nbsp;<span class="op" id="2843729">*</span><span class="ident" id="2843730">rtype</span><span class="op" id="2843735">)</span>&nbsp;<span class="op" id="2843737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843740">gc</span><span class="op" id="2843742">.</span><span class="ident" id="2843743">align</span><span class="op" id="2843748">(</span><span class="builtintype" id="2843749">uintptr</span><span class="op" id="2843756">(</span><span class="ident" id="2843757">t</span><span class="op" id="2843758">.</span><span class="ident" id="2843759">align</span><span class="op" id="2843764">)</span><span class="op" id="2843765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843768">if</span>&nbsp;<span class="op" id="2843771">!</span><span class="ident" id="2843772">t</span><span class="op" id="2843773">.</span><span class="ident" id="2843774">pointers</span><span class="op" id="2843782">(</span><span class="op" id="2843783">)</span>&nbsp;<span class="op" id="2843785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843789">gc</span><span class="op" id="2843791">.</span><span class="ident" id="2843792">size</span>&nbsp;<span class="op" id="2843797">+=</span>&nbsp;<span class="ident" id="2843800">t</span><span class="op" id="2843801">.</span><span class="ident" id="2843802">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843809">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843820">switch</span>&nbsp;<span class="ident" id="2843827">t</span><span class="op" id="2843828">.</span><span class="ident" id="2843829">Kind</span><span class="op" id="2843833">(</span><span class="op" id="2843834">)</span>&nbsp;<span class="op" id="2843836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843839">default</span><span class="op" id="2843846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2843850">panic</span><span class="op" id="2843855">(</span><span class="string" id="2843856">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2843909">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843912">case</span>&nbsp;<span class="ident" id="2843917">Ptr</span><span class="op" id="2843920">,</span>&nbsp;<span class="ident" id="2843922">UnsafePointer</span><span class="op" id="2843935">,</span>&nbsp;<span class="ident" id="2843937">Chan</span><span class="op" id="2843941">,</span>&nbsp;<span class="ident" id="2843943">Func</span><span class="op" id="2843947">,</span>&nbsp;<span class="ident" id="2843949">Map</span><span class="op" id="2843952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843956">gc</span><span class="op" id="2843958">.</span><span class="ident" id="2843959">appendWord</span><span class="op" id="2843969">(</span><span class="ident" id="2843970">bitsPointer</span><span class="op" id="2843981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843984">case</span>&nbsp;<span class="ident" id="2843989">Slice</span><span class="op" id="2843994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843998">gc</span><span class="op" id="2844000">.</span><span class="ident" id="2844001">appendWord</span><span class="op" id="2844011">(</span><span class="ident" id="2844012">bitsPointer</span><span class="op" id="2844023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844027">gc</span><span class="op" id="2844029">.</span><span class="ident" id="2844030">appendWord</span><span class="op" id="2844040">(</span><span class="ident" id="2844041">bitsScalar</span><span class="op" id="2844051">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844055">gc</span><span class="op" id="2844057">.</span><span class="ident" id="2844058">appendWord</span><span class="op" id="2844068">(</span><span class="ident" id="2844069">bitsScalar</span><span class="op" id="2844079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844082">case</span>&nbsp;<span class="ident" id="2844087">String</span><span class="op" id="2844093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844097">gc</span><span class="op" id="2844099">.</span><span class="ident" id="2844100">appendWord</span><span class="op" id="2844110">(</span><span class="ident" id="2844111">bitsPointer</span><span class="op" id="2844122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844126">gc</span><span class="op" id="2844128">.</span><span class="ident" id="2844129">appendWord</span><span class="op" id="2844139">(</span><span class="ident" id="2844140">bitsScalar</span><span class="op" id="2844150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844153">case</span>&nbsp;<span class="ident" id="2844158">Array</span><span class="op" id="2844163">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844167">c</span>&nbsp;<span class="op" id="2844169">:=</span>&nbsp;<span class="ident" id="2844172">t</span><span class="op" id="2844173">.</span><span class="ident" id="2844174">Len</span><span class="op" id="2844177">(</span><span class="op" id="2844178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844182">e</span>&nbsp;<span class="op" id="2844184">:=</span>&nbsp;<span class="ident" id="2844187">t</span><span class="op" id="2844188">.</span><span class="ident" id="2844189">Elem</span><span class="op" id="2844193">(</span><span class="op" id="2844194">)</span><span class="op" id="2844195">.</span><span class="ident" id="2844196">common</span><span class="op" id="2844202">(</span><span class="op" id="2844203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844207">for</span>&nbsp;<span class="ident" id="2844211">i</span>&nbsp;<span class="op" id="2844213">:=</span>&nbsp;<span class="num" id="2844216">0</span><span class="op" id="2844217">;</span>&nbsp;<span class="ident" id="2844219">i</span>&nbsp;<span class="op" id="2844221">&lt;</span>&nbsp;<span class="ident" id="2844223">c</span><span class="op" id="2844224">;</span>&nbsp;<span class="ident" id="2844226">i</span><span class="op" id="2844227">++</span>&nbsp;<span class="op" id="2844230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844235">gc</span><span class="op" id="2844237">.</span><span class="ident" id="2844238">appendProg</span><span class="op" id="2844248">(</span><span class="ident" id="2844249">e</span><span class="op" id="2844250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844254">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844257">case</span>&nbsp;<span class="ident" id="2844262">Interface</span><span class="op" id="2844271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844275">gc</span><span class="op" id="2844277">.</span><span class="ident" id="2844278">appendWord</span><span class="op" id="2844288">(</span><span class="ident" id="2844289">bitsMultiWord</span><span class="op" id="2844302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844306">if</span>&nbsp;<span class="ident" id="2844309">t</span><span class="op" id="2844310">.</span><span class="ident" id="2844311">NumMethod</span><span class="op" id="2844320">(</span><span class="op" id="2844321">)</span>&nbsp;<span class="op" id="2844323">==</span>&nbsp;<span class="num" id="2844326">0</span>&nbsp;<span class="op" id="2844328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844333">gc</span><span class="op" id="2844335">.</span><span class="ident" id="2844336">appendWord</span><span class="op" id="2844346">(</span><span class="ident" id="2844347">bitsEface</span><span class="op" id="2844356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844360">}</span>&nbsp;<span class="keyword" id="2844362">else</span>&nbsp;<span class="op" id="2844367">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844372">gc</span><span class="op" id="2844374">.</span><span class="ident" id="2844375">appendWord</span><span class="op" id="2844385">(</span><span class="ident" id="2844386">bitsIface</span><span class="op" id="2844395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844402">case</span>&nbsp;<span class="ident" id="2844407">Struct</span><span class="op" id="2844413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844417">c</span>&nbsp;<span class="op" id="2844419">:=</span>&nbsp;<span class="ident" id="2844422">t</span><span class="op" id="2844423">.</span><span class="ident" id="2844424">NumField</span><span class="op" id="2844432">(</span><span class="op" id="2844433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844437">for</span>&nbsp;<span class="ident" id="2844441">i</span>&nbsp;<span class="op" id="2844443">:=</span>&nbsp;<span class="num" id="2844446">0</span><span class="op" id="2844447">;</span>&nbsp;<span class="ident" id="2844449">i</span>&nbsp;<span class="op" id="2844451">&lt;</span>&nbsp;<span class="ident" id="2844453">c</span><span class="op" id="2844454">;</span>&nbsp;<span class="ident" id="2844456">i</span><span class="op" id="2844457">++</span>&nbsp;<span class="op" id="2844460">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844465">gc</span><span class="op" id="2844467">.</span><span class="ident" id="2844468">appendProg</span><span class="op" id="2844478">(</span><span class="ident" id="2844479">t</span><span class="op" id="2844480">.</span><span class="ident" id="2844481">Field</span><span class="op" id="2844486">(</span><span class="ident" id="2844487">i</span><span class="op" id="2844488">)</span><span class="op" id="2844489">.</span><span class="ident" id="2844490">Type</span><span class="op" id="2844494">.</span><span class="ident" id="2844495">common</span><span class="op" id="2844501">(</span><span class="op" id="2844502">)</span><span class="op" id="2844503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844511">gc</span><span class="op" id="2844513">.</span><span class="ident" id="2844514">align</span><span class="op" id="2844519">(</span><span class="builtintype" id="2844520">uintptr</span><span class="op" id="2844527">(</span><span class="ident" id="2844528">t</span><span class="op" id="2844529">.</span><span class="ident" id="2844530">align</span><span class="op" id="2844535">)</span><span class="op" id="2844536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844539">}</span><br>
<span class="lineno"></span><span class="op" id="2844541">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2844544">func</span>&nbsp;<span class="op" id="2844549">(</span><span class="ident" id="2844550">gc</span>&nbsp;<span class="op" id="2844553">*</span><span class="ident" id="2844554">gcProg</span><span class="op" id="2844560">)</span>&nbsp;<span class="ident" id="2844562">appendWord</span><span class="op" id="2844572">(</span><span class="ident" id="2844573">v</span>&nbsp;<span class="builtintype" id="2844575">byte</span><span class="op" id="2844579">)</span>&nbsp;<span class="op" id="2844581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844584">ptrsize</span>&nbsp;<span class="op" id="2844592">:=</span>&nbsp;<span class="ident" id="2844595">unsafe</span><span class="op" id="2844601">.</span><span class="ident" id="2844602">Sizeof</span><span class="op" id="2844608">(</span><span class="builtintype" id="2844609">uintptr</span><span class="op" id="2844616">(</span><span class="num" id="2844617">0</span><span class="op" id="2844618">)</span><span class="op" id="2844619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844622">if</span>&nbsp;<span class="ident" id="2844625">gc</span><span class="op" id="2844627">.</span><span class="ident" id="2844628">size</span><span class="op" id="2844632">%</span><span class="ident" id="2844633">ptrsize</span>&nbsp;<span class="op" id="2844641">!=</span>&nbsp;<span class="num" id="2844644">0</span>&nbsp;<span class="op" id="2844646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2844650">panic</span><span class="op" id="2844655">(</span><span class="string" id="2844656">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2844687">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844693">nptr</span>&nbsp;<span class="op" id="2844698">:=</span>&nbsp;<span class="ident" id="2844701">gc</span><span class="op" id="2844703">.</span><span class="ident" id="2844704">size</span>&nbsp;<span class="op" id="2844709">/</span>&nbsp;<span class="ident" id="2844711">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844720">for</span>&nbsp;<span class="builtintype" id="2844724">uintptr</span><span class="op" id="2844731">(</span><span class="builtinfunc" id="2844732">len</span><span class="op" id="2844735">(</span><span class="ident" id="2844736">gc</span><span class="op" id="2844738">.</span><span class="ident" id="2844739">gc</span><span class="op" id="2844741">)</span><span class="op" id="2844742">)</span>&nbsp;<span class="op" id="2844744">&lt;</span>&nbsp;<span class="ident" id="2844746">nptr</span><span class="op" id="2844750">/</span><span class="num" id="2844751">2</span><span class="op" id="2844752">+</span><span class="num" id="2844753">1</span>&nbsp;<span class="op" id="2844755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844759">gc</span><span class="op" id="2844761">.</span><span class="ident" id="2844762">gc</span>&nbsp;<span class="op" id="2844765">=</span>&nbsp;<span class="builtinfunc" id="2844767">append</span><span class="op" id="2844773">(</span><span class="ident" id="2844774">gc</span><span class="op" id="2844776">.</span><span class="ident" id="2844777">gc</span><span class="op" id="2844779">,</span>&nbsp;<span class="num" id="2844781">0x44</span><span class="op" id="2844785">)</span>&nbsp;<span class="comment" id="2844787">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844802">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844805">gc</span><span class="op" id="2844807">.</span><span class="ident" id="2844808">gc</span><span class="op" id="2844810">[</span><span class="ident" id="2844811">nptr</span><span class="op" id="2844815">/</span><span class="num" id="2844816">2</span><span class="op" id="2844817">]</span>&nbsp;<span class="op" id="2844819">&amp;=</span>&nbsp;<span class="op" id="2844822">^</span><span class="op" id="2844823">(</span><span class="num" id="2844824">3</span>&nbsp;<span class="op" id="2844826">&lt;&lt;</span>&nbsp;<span class="op" id="2844829">(</span><span class="op" id="2844830">(</span><span class="ident" id="2844831">nptr</span><span class="op" id="2844835">%</span><span class="num" id="2844836">2</span><span class="op" id="2844837">)</span><span class="op" id="2844838">*</span><span class="num" id="2844839">4</span>&nbsp;<span class="op" id="2844841">+</span>&nbsp;<span class="num" id="2844843">2</span><span class="op" id="2844844">)</span><span class="op" id="2844845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844848">gc</span><span class="op" id="2844850">.</span><span class="ident" id="2844851">gc</span><span class="op" id="2844853">[</span><span class="ident" id="2844854">nptr</span><span class="op" id="2844858">/</span><span class="num" id="2844859">2</span><span class="op" id="2844860">]</span>&nbsp;<span class="op" id="2844862">|=</span>&nbsp;<span class="ident" id="2844865">v</span>&nbsp;<span class="op" id="2844867">&lt;&lt;</span>&nbsp;<span class="op" id="2844870">(</span><span class="op" id="2844871">(</span><span class="ident" id="2844872">nptr</span><span class="op" id="2844876">%</span><span class="num" id="2844877">2</span><span class="op" id="2844878">)</span><span class="op" id="2844879">*</span><span class="num" id="2844880">4</span>&nbsp;<span class="op" id="2844882">+</span>&nbsp;<span class="num" id="2844884">2</span><span class="op" id="2844885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844888">gc</span><span class="op" id="2844890">.</span><span class="ident" id="2844891">size</span>&nbsp;<span class="op" id="2844896">+=</span>&nbsp;<span class="ident" id="2844899">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2844907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2844910">func</span>&nbsp;<span class="op" id="2844915">(</span><span class="ident" id="2844916">gc</span>&nbsp;<span class="op" id="2844919">*</span><span class="ident" id="2844920">gcProg</span><span class="op" id="2844926">)</span>&nbsp;<span class="ident" id="2844928">finalize</span><span class="op" id="2844936">(</span><span class="op" id="2844937">)</span>&nbsp;<span class="ident" id="2844939">unsafe</span><span class="op" id="2844945">.</span><span class="ident" id="2844946">Pointer</span>&nbsp;<span class="op" id="2844954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844957">if</span>&nbsp;<span class="ident" id="2844960">gc</span><span class="op" id="2844962">.</span><span class="ident" id="2844963">size</span>&nbsp;<span class="op" id="2844968">==</span>&nbsp;<span class="num" id="2844971">0</span>&nbsp;<span class="op" id="2844973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844977">return</span>&nbsp;<span class="ident" id="2844984">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844992">ptrsize</span>&nbsp;<span class="op" id="2845000">:=</span>&nbsp;<span class="ident" id="2845003">unsafe</span><span class="op" id="2845009">.</span><span class="ident" id="2845010">Sizeof</span><span class="op" id="2845016">(</span><span class="builtintype" id="2845017">uintptr</span><span class="op" id="2845024">(</span><span class="num" id="2845025">0</span><span class="op" id="2845026">)</span><span class="op" id="2845027">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845030">gc</span><span class="op" id="2845032">.</span><span class="ident" id="2845033">align</span><span class="op" id="2845038">(</span><span class="ident" id="2845039">ptrsize</span><span class="op" id="2845046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845049">nptr</span>&nbsp;<span class="op" id="2845054">:=</span>&nbsp;<span class="ident" id="2845057">gc</span><span class="op" id="2845059">.</span><span class="ident" id="2845060">size</span>&nbsp;<span class="op" id="2845065">/</span>&nbsp;<span class="ident" id="2845067">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845076">for</span>&nbsp;<span class="builtintype" id="2845080">uintptr</span><span class="op" id="2845087">(</span><span class="builtinfunc" id="2845088">len</span><span class="op" id="2845091">(</span><span class="ident" id="2845092">gc</span><span class="op" id="2845094">.</span><span class="ident" id="2845095">gc</span><span class="op" id="2845097">)</span><span class="op" id="2845098">)</span>&nbsp;<span class="op" id="2845100">&lt;</span>&nbsp;<span class="ident" id="2845102">nptr</span><span class="op" id="2845106">/</span><span class="num" id="2845107">2</span><span class="op" id="2845108">+</span><span class="num" id="2845109">1</span>&nbsp;<span class="op" id="2845111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845115">gc</span><span class="op" id="2845117">.</span><span class="ident" id="2845118">gc</span>&nbsp;<span class="op" id="2845121">=</span>&nbsp;<span class="builtinfunc" id="2845123">append</span><span class="op" id="2845129">(</span><span class="ident" id="2845130">gc</span><span class="op" id="2845132">.</span><span class="ident" id="2845133">gc</span><span class="op" id="2845135">,</span>&nbsp;<span class="num" id="2845137">0x44</span><span class="op" id="2845141">)</span>&nbsp;<span class="comment" id="2845143">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845158">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845161">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845215">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845243">if</span>&nbsp;<span class="ident" id="2845246">nptr</span><span class="op" id="2845250">%</span><span class="num" id="2845251">2</span>&nbsp;<span class="op" id="2845253">!=</span>&nbsp;<span class="num" id="2845256">0</span>&nbsp;<span class="op" id="2845258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845262">for</span>&nbsp;<span class="ident" id="2845266">i</span>&nbsp;<span class="op" id="2845268">:=</span>&nbsp;<span class="builtintype" id="2845271">uintptr</span><span class="op" id="2845278">(</span><span class="num" id="2845279">0</span><span class="op" id="2845280">)</span><span class="op" id="2845281">;</span>&nbsp;<span class="ident" id="2845283">i</span>&nbsp;<span class="op" id="2845285">&lt;</span>&nbsp;<span class="ident" id="2845287">nptr</span><span class="op" id="2845291">;</span>&nbsp;<span class="ident" id="2845293">i</span><span class="op" id="2845294">++</span>&nbsp;<span class="op" id="2845297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845302">gc</span><span class="op" id="2845304">.</span><span class="ident" id="2845305">appendWord</span><span class="op" id="2845315">(</span><span class="ident" id="2845316">extractGCWord</span><span class="op" id="2845329">(</span><span class="ident" id="2845330">gc</span><span class="op" id="2845332">.</span><span class="ident" id="2845333">gc</span><span class="op" id="2845335">,</span>&nbsp;<span class="ident" id="2845337">i</span><span class="op" id="2845338">)</span><span class="op" id="2845339">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845349">return</span>&nbsp;<span class="ident" id="2845356">unsafe</span><span class="op" id="2845362">.</span><span class="ident" id="2845363">Pointer</span><span class="op" id="2845370">(</span><span class="op" id="2845371">&amp;</span><span class="ident" id="2845372">gc</span><span class="op" id="2845374">.</span><span class="ident" id="2845375">gc</span><span class="op" id="2845377">[</span><span class="num" id="2845378">0</span><span class="op" id="2845379">]</span><span class="op" id="2845380">)</span><br>
<span class="lineno"></span><span class="op" id="2845382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2845385">func</span>&nbsp;<span class="ident" id="2845390">extractGCWord</span><span class="op" id="2845403">(</span><span class="ident" id="2845404">gc</span>&nbsp;<span class="op" id="2845407">[</span><span class="op" id="2845408">]</span><span class="builtintype" id="2845409">byte</span><span class="op" id="2845413">,</span>&nbsp;<span class="ident" id="2845415">i</span>&nbsp;<span class="builtintype" id="2845417">uintptr</span><span class="op" id="2845424">)</span>&nbsp;<span class="builtintype" id="2845426">byte</span>&nbsp;<span class="op" id="2845431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845434">return</span>&nbsp;<span class="op" id="2845441">(</span><span class="ident" id="2845442">gc</span><span class="op" id="2845444">[</span><span class="ident" id="2845445">i</span><span class="op" id="2845446">/</span><span class="num" id="2845447">2</span><span class="op" id="2845448">]</span>&nbsp;<span class="op" id="2845450">&gt;&gt;</span>&nbsp;<span class="op" id="2845453">(</span><span class="op" id="2845454">(</span><span class="ident" id="2845455">i</span><span class="op" id="2845456">%</span><span class="num" id="2845457">2</span><span class="op" id="2845458">)</span><span class="op" id="2845459">*</span><span class="num" id="2845460">4</span>&nbsp;<span class="op" id="2845462">+</span>&nbsp;<span class="num" id="2845464">2</span><span class="op" id="2845465">)</span><span class="op" id="2845466">)</span>&nbsp;<span class="op" id="2845468">&amp;</span>&nbsp;<span class="num" id="2845470">3</span><br>
<span class="lineno"></span><span class="op" id="2845472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2845475">func</span>&nbsp;<span class="op" id="2845480">(</span><span class="ident" id="2845481">gc</span>&nbsp;<span class="op" id="2845484">*</span><span class="ident" id="2845485">gcProg</span><span class="op" id="2845491">)</span>&nbsp;<span class="ident" id="2845493">align</span><span class="op" id="2845498">(</span><span class="ident" id="2845499">a</span>&nbsp;<span class="builtintype" id="2845501">uintptr</span><span class="op" id="2845508">)</span>&nbsp;<span class="op" id="2845510">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845513">gc</span><span class="op" id="2845515">.</span><span class="ident" id="2845516">size</span>&nbsp;<span class="op" id="2845521">=</span>&nbsp;<span class="ident" id="2845523">align</span><span class="op" id="2845528">(</span><span class="ident" id="2845529">gc</span><span class="op" id="2845531">.</span><span class="ident" id="2845532">size</span><span class="op" id="2845536">,</span>&nbsp;<span class="ident" id="2845538">a</span><span class="op" id="2845539">)</span><br>
<span class="lineno"></span><span class="op" id="2845541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2845544">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2845605">const</span>&nbsp;<span class="op" id="2845611">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845614">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2845628">=</span>&nbsp;<span class="num" id="2845630">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845633">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2845647">=</span>&nbsp;<span class="num" id="2845649">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845652">bitsMultiWord</span>&nbsp;<span class="op" id="2845666">=</span>&nbsp;<span class="num" id="2845668">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845672">bitsIface</span>&nbsp;<span class="op" id="2845682">=</span>&nbsp;<span class="num" id="2845684">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845687">bitsEface</span>&nbsp;<span class="op" id="2845697">=</span>&nbsp;<span class="num" id="2845699">3</span><br>
<span class="lineno"></span><span class="op" id="2845701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2845704">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2845776">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2845848">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2845923">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2845954">const</span>&nbsp;<span class="op" id="2845960">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845963">bucketSize</span>&nbsp;<span class="op" id="2845974">=</span>&nbsp;<span class="num" id="2845976">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845979">maxKeySize</span>&nbsp;<span class="op" id="2845990">=</span>&nbsp;<span class="num" id="2845992">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845997">maxValSize</span>&nbsp;<span class="op" id="2846008">=</span>&nbsp;<span class="num" id="2846010">128</span><br>
<span class="lineno"></span><span class="op" id="2846014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2846017">func</span>&nbsp;<span class="ident" id="2846022">bucketOf</span><span class="op" id="2846030">(</span><span class="ident" id="2846031">ktyp</span><span class="op" id="2846035">,</span>&nbsp;<span class="ident" id="2846037">etyp</span>&nbsp;<span class="op" id="2846042">*</span><span class="ident" id="2846043">rtype</span><span class="op" id="2846048">)</span>&nbsp;<span class="op" id="2846050">*</span><span class="ident" id="2846051">rtype</span>&nbsp;<span class="op" id="2846057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846060">if</span>&nbsp;<span class="ident" id="2846063">ktyp</span><span class="op" id="2846067">.</span><span class="ident" id="2846068">size</span>&nbsp;<span class="op" id="2846073">&gt;</span>&nbsp;<span class="ident" id="2846075">maxKeySize</span>&nbsp;<span class="op" id="2846086">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846090">ktyp</span>&nbsp;<span class="op" id="2846095">=</span>&nbsp;<span class="ident" id="2846097">PtrTo</span><span class="op" id="2846102">(</span><span class="ident" id="2846103">ktyp</span><span class="op" id="2846107">)</span><span class="op" id="2846108">.</span><span class="op" id="2846109">(</span><span class="op" id="2846110">*</span><span class="ident" id="2846111">rtype</span><span class="op" id="2846116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846122">if</span>&nbsp;<span class="ident" id="2846125">etyp</span><span class="op" id="2846129">.</span><span class="ident" id="2846130">size</span>&nbsp;<span class="op" id="2846135">&gt;</span>&nbsp;<span class="ident" id="2846137">maxValSize</span>&nbsp;<span class="op" id="2846148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846152">etyp</span>&nbsp;<span class="op" id="2846157">=</span>&nbsp;<span class="ident" id="2846159">PtrTo</span><span class="op" id="2846164">(</span><span class="ident" id="2846165">etyp</span><span class="op" id="2846169">)</span><span class="op" id="2846170">.</span><span class="op" id="2846171">(</span><span class="op" id="2846172">*</span><span class="ident" id="2846173">rtype</span><span class="op" id="2846178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846181">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846184">ptrsize</span>&nbsp;<span class="op" id="2846192">:=</span>&nbsp;<span class="ident" id="2846195">unsafe</span><span class="op" id="2846201">.</span><span class="ident" id="2846202">Sizeof</span><span class="op" id="2846208">(</span><span class="builtintype" id="2846209">uintptr</span><span class="op" id="2846216">(</span><span class="num" id="2846217">0</span><span class="op" id="2846218">)</span><span class="op" id="2846219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846223">var</span>&nbsp;<span class="ident" id="2846227">gc</span>&nbsp;<span class="ident" id="2846230">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846238">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846250">for</span>&nbsp;<span class="ident" id="2846254">i</span>&nbsp;<span class="op" id="2846256">:=</span>&nbsp;<span class="num" id="2846259">0</span><span class="op" id="2846260">;</span>&nbsp;<span class="ident" id="2846262">i</span>&nbsp;<span class="op" id="2846264">&lt;</span>&nbsp;<span class="builtintype" id="2846266">int</span><span class="op" id="2846269">(</span><span class="ident" id="2846270">bucketSize</span><span class="op" id="2846280">*</span><span class="ident" id="2846281">unsafe</span><span class="op" id="2846287">.</span><span class="ident" id="2846288">Sizeof</span><span class="op" id="2846294">(</span><span class="builtintype" id="2846295">uint8</span><span class="op" id="2846300">(</span><span class="num" id="2846301">0</span><span class="op" id="2846302">)</span><span class="op" id="2846303">)</span><span class="op" id="2846304">/</span><span class="ident" id="2846305">ptrsize</span><span class="op" id="2846312">)</span><span class="op" id="2846313">;</span>&nbsp;<span class="ident" id="2846315">i</span><span class="op" id="2846316">++</span>&nbsp;<span class="op" id="2846319">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846323">gc</span><span class="op" id="2846325">.</span><span class="builtinfunc" id="2846326">append</span><span class="op" id="2846332">(</span><span class="ident" id="2846333">bitsScalar</span><span class="op" id="2846343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846349">gc</span><span class="op" id="2846351">.</span><span class="builtinfunc" id="2846352">append</span><span class="op" id="2846358">(</span><span class="ident" id="2846359">bitsPointer</span><span class="op" id="2846370">)</span>&nbsp;<span class="comment" id="2846372">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846385">if</span>&nbsp;<span class="ident" id="2846388">runtime</span><span class="op" id="2846395">.</span><span class="ident" id="2846396">GOARCH</span>&nbsp;<span class="op" id="2846403">==</span>&nbsp;<span class="string" id="2846406">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2846417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846421">gc</span><span class="op" id="2846423">.</span><span class="builtinfunc" id="2846424">append</span><span class="op" id="2846430">(</span><span class="ident" id="2846431">bitsScalar</span><span class="op" id="2846441">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846447">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846456">for</span>&nbsp;<span class="ident" id="2846460">i</span>&nbsp;<span class="op" id="2846462">:=</span>&nbsp;<span class="num" id="2846465">0</span><span class="op" id="2846466">;</span>&nbsp;<span class="ident" id="2846468">i</span>&nbsp;<span class="op" id="2846470">&lt;</span>&nbsp;<span class="ident" id="2846472">bucketSize</span><span class="op" id="2846482">;</span>&nbsp;<span class="ident" id="2846484">i</span><span class="op" id="2846485">++</span>&nbsp;<span class="op" id="2846488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846492">gc</span><span class="op" id="2846494">.</span><span class="ident" id="2846495">appendProg</span><span class="op" id="2846505">(</span><span class="ident" id="2846506">ktyp</span><span class="op" id="2846510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846513">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846516">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846527">for</span>&nbsp;<span class="ident" id="2846531">i</span>&nbsp;<span class="op" id="2846533">:=</span>&nbsp;<span class="num" id="2846536">0</span><span class="op" id="2846537">;</span>&nbsp;<span class="ident" id="2846539">i</span>&nbsp;<span class="op" id="2846541">&lt;</span>&nbsp;<span class="ident" id="2846543">bucketSize</span><span class="op" id="2846553">;</span>&nbsp;<span class="ident" id="2846555">i</span><span class="op" id="2846556">++</span>&nbsp;<span class="op" id="2846559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846563">gc</span><span class="op" id="2846565">.</span><span class="ident" id="2846566">appendProg</span><span class="op" id="2846576">(</span><span class="ident" id="2846577">etyp</span><span class="op" id="2846581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846588">b</span>&nbsp;<span class="op" id="2846590">:=</span>&nbsp;<span class="builtinfunc" id="2846593">new</span><span class="op" id="2846596">(</span><span class="ident" id="2846597">rtype</span><span class="op" id="2846602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846605">b</span><span class="op" id="2846606">.</span><span class="ident" id="2846607">size</span>&nbsp;<span class="op" id="2846612">=</span>&nbsp;<span class="ident" id="2846614">gc</span><span class="op" id="2846616">.</span><span class="ident" id="2846617">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846623">b</span><span class="op" id="2846624">.</span><span class="ident" id="2846625">gc</span><span class="op" id="2846627">[</span><span class="num" id="2846628">0</span><span class="op" id="2846629">]</span>&nbsp;<span class="op" id="2846631">=</span>&nbsp;<span class="ident" id="2846633">gc</span><span class="op" id="2846635">.</span><span class="ident" id="2846636">finalize</span><span class="op" id="2846644">(</span><span class="op" id="2846645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846648">s</span>&nbsp;<span class="op" id="2846650">:=</span>&nbsp;<span class="string" id="2846653">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2846663">+</span>&nbsp;<span class="op" id="2846665">*</span><span class="ident" id="2846666">ktyp</span><span class="op" id="2846670">.</span><span class="builtintype" id="2846671">string</span>&nbsp;<span class="op" id="2846678">+</span>&nbsp;<span class="string" id="2846680">&#34;,&#34;</span>&nbsp;<span class="op" id="2846684">+</span>&nbsp;<span class="op" id="2846686">*</span><span class="ident" id="2846687">etyp</span><span class="op" id="2846691">.</span><span class="builtintype" id="2846692">string</span>&nbsp;<span class="op" id="2846699">+</span>&nbsp;<span class="string" id="2846701">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846706">b</span><span class="op" id="2846707">.</span><span class="builtintype" id="2846708">string</span>&nbsp;<span class="op" id="2846715">=</span>&nbsp;<span class="op" id="2846717">&amp;</span><span class="ident" id="2846718">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846721">return</span>&nbsp;<span class="ident" id="2846728">b</span><br>
<span class="lineno"></span><span class="op" id="2846730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2846733">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2846788">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2846854">func</span>&nbsp;<span class="ident" id="2846859">SliceOf</span><span class="op" id="2846866">(</span><span class="ident" id="2846867">t</span>&nbsp;<span class="ident" id="2846869">Type</span><span class="op" id="2846873">)</span>&nbsp;<span class="ident" id="2846875">Type</span>&nbsp;<span class="op" id="2846880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846883">typ</span>&nbsp;<span class="op" id="2846887">:=</span>&nbsp;<span class="ident" id="2846890">t</span><span class="op" id="2846891">.</span><span class="op" id="2846892">(</span><span class="op" id="2846893">*</span><span class="ident" id="2846894">rtype</span><span class="op" id="2846899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846903">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846922">ckey</span>&nbsp;<span class="op" id="2846927">:=</span>&nbsp;<span class="ident" id="2846930">cacheKey</span><span class="op" id="2846938">{</span><span class="ident" id="2846939">Slice</span><span class="op" id="2846944">,</span>&nbsp;<span class="ident" id="2846946">typ</span><span class="op" id="2846949">,</span>&nbsp;<span class="ident" id="2846951">nil</span><span class="op" id="2846954">,</span>&nbsp;<span class="num" id="2846956">0</span><span class="op" id="2846957">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846960">if</span>&nbsp;<span class="ident" id="2846963">slice</span>&nbsp;<span class="op" id="2846969">:=</span>&nbsp;<span class="ident" id="2846972">cacheGet</span><span class="op" id="2846980">(</span><span class="ident" id="2846981">ckey</span><span class="op" id="2846985">)</span><span class="op" id="2846986">;</span>&nbsp;<span class="ident" id="2846988">slice</span>&nbsp;<span class="op" id="2846994">!=</span>&nbsp;<span class="ident" id="2846997">nil</span>&nbsp;<span class="op" id="2847001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847005">return</span>&nbsp;<span class="ident" id="2847012">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2847023">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847048">s</span>&nbsp;<span class="op" id="2847050">:=</span>&nbsp;<span class="string" id="2847053">&#34;[]&#34;</span>&nbsp;<span class="op" id="2847058">+</span>&nbsp;<span class="op" id="2847060">*</span><span class="ident" id="2847061">typ</span><span class="op" id="2847064">.</span><span class="builtintype" id="2847065">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847073">for</span>&nbsp;<span class="ident" id="2847077">_</span><span class="op" id="2847078">,</span>&nbsp;<span class="ident" id="2847080">tt</span>&nbsp;<span class="op" id="2847083">:=</span>&nbsp;<span class="keyword" id="2847086">range</span>&nbsp;<span class="ident" id="2847092">typesByString</span><span class="op" id="2847105">(</span><span class="ident" id="2847106">s</span><span class="op" id="2847107">)</span>&nbsp;<span class="op" id="2847109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847113">slice</span>&nbsp;<span class="op" id="2847119">:=</span>&nbsp;<span class="op" id="2847122">(</span><span class="op" id="2847123">*</span><span class="ident" id="2847124">sliceType</span><span class="op" id="2847133">)</span><span class="op" id="2847134">(</span><span class="ident" id="2847135">unsafe</span><span class="op" id="2847141">.</span><span class="ident" id="2847142">Pointer</span><span class="op" id="2847149">(</span><span class="ident" id="2847150">tt</span><span class="op" id="2847152">)</span><span class="op" id="2847153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847157">if</span>&nbsp;<span class="ident" id="2847160">slice</span><span class="op" id="2847165">.</span><span class="ident" id="2847166">elem</span>&nbsp;<span class="op" id="2847171">==</span>&nbsp;<span class="ident" id="2847174">typ</span>&nbsp;<span class="op" id="2847178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847183">return</span>&nbsp;<span class="ident" id="2847190">cachePut</span><span class="op" id="2847198">(</span><span class="ident" id="2847199">ckey</span><span class="op" id="2847203">,</span>&nbsp;<span class="ident" id="2847205">tt</span><span class="op" id="2847207">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2847218">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847241">var</span>&nbsp;<span class="ident" id="2847245">islice</span>&nbsp;<span class="keyword" id="2847252">interface</span><span class="op" id="2847261">{</span><span class="op" id="2847262">}</span>&nbsp;<span class="op" id="2847264">=</span>&nbsp;<span class="op" id="2847266">(</span><span class="op" id="2847267">[</span><span class="op" id="2847268">]</span><span class="ident" id="2847269">unsafe</span><span class="op" id="2847275">.</span><span class="ident" id="2847276">Pointer</span><span class="op" id="2847283">)</span><span class="op" id="2847284">(</span><span class="ident" id="2847285">nil</span><span class="op" id="2847288">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847291">prototype</span>&nbsp;<span class="op" id="2847301">:=</span>&nbsp;<span class="op" id="2847304">*</span><span class="op" id="2847305">(</span><span class="op" id="2847306">*</span><span class="op" id="2847307">*</span><span class="ident" id="2847308">sliceType</span><span class="op" id="2847317">)</span><span class="op" id="2847318">(</span><span class="ident" id="2847319">unsafe</span><span class="op" id="2847325">.</span><span class="ident" id="2847326">Pointer</span><span class="op" id="2847333">(</span><span class="op" id="2847334">&amp;</span><span class="ident" id="2847335">islice</span><span class="op" id="2847341">)</span><span class="op" id="2847342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847345">slice</span>&nbsp;<span class="op" id="2847351">:=</span>&nbsp;<span class="builtinfunc" id="2847354">new</span><span class="op" id="2847357">(</span><span class="ident" id="2847358">sliceType</span><span class="op" id="2847367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847370">*</span><span class="ident" id="2847371">slice</span>&nbsp;<span class="op" id="2847377">=</span>&nbsp;<span class="op" id="2847379">*</span><span class="ident" id="2847380">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847391">slice</span><span class="op" id="2847396">.</span><span class="builtintype" id="2847397">string</span>&nbsp;<span class="op" id="2847404">=</span>&nbsp;<span class="op" id="2847406">&amp;</span><span class="ident" id="2847407">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847410">slice</span><span class="op" id="2847415">.</span><span class="ident" id="2847416">hash</span>&nbsp;<span class="op" id="2847421">=</span>&nbsp;<span class="ident" id="2847423">fnv1</span><span class="op" id="2847427">(</span><span class="ident" id="2847428">typ</span><span class="op" id="2847431">.</span><span class="ident" id="2847432">hash</span><span class="op" id="2847436">,</span>&nbsp;<span class="string" id="2847438">&#39;[&#39;</span><span class="op" id="2847441">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847444">slice</span><span class="op" id="2847449">.</span><span class="ident" id="2847450">elem</span>&nbsp;<span class="op" id="2847455">=</span>&nbsp;<span class="ident" id="2847457">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847462">slice</span><span class="op" id="2847467">.</span><span class="ident" id="2847468">uncommonType</span>&nbsp;<span class="op" id="2847481">=</span>&nbsp;<span class="ident" id="2847483">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847488">slice</span><span class="op" id="2847493">.</span><span class="ident" id="2847494">ptrToThis</span>&nbsp;<span class="op" id="2847504">=</span>&nbsp;<span class="ident" id="2847506">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847511">slice</span><span class="op" id="2847516">.</span><span class="ident" id="2847517">zero</span>&nbsp;<span class="op" id="2847522">=</span>&nbsp;<span class="ident" id="2847524">unsafe</span><span class="op" id="2847530">.</span><span class="ident" id="2847531">Pointer</span><span class="op" id="2847538">(</span><span class="op" id="2847539">&amp;</span><span class="builtinfunc" id="2847540">make</span><span class="op" id="2847544">(</span><span class="op" id="2847545">[</span><span class="op" id="2847546">]</span><span class="builtintype" id="2847547">byte</span><span class="op" id="2847551">,</span>&nbsp;<span class="ident" id="2847553">slice</span><span class="op" id="2847558">.</span><span class="ident" id="2847559">size</span><span class="op" id="2847563">)</span><span class="op" id="2847564">[</span><span class="num" id="2847565">0</span><span class="op" id="2847566">]</span><span class="op" id="2847567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847571">return</span>&nbsp;<span class="ident" id="2847578">cachePut</span><span class="op" id="2847586">(</span><span class="ident" id="2847587">ckey</span><span class="op" id="2847591">,</span>&nbsp;<span class="op" id="2847593">&amp;</span><span class="ident" id="2847594">slice</span><span class="op" id="2847599">.</span><span class="ident" id="2847600">rtype</span><span class="op" id="2847605">)</span><br>
<span class="lineno"></span><span class="op" id="2847607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2847610">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2847683">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2847753">//</span><br>
<span class="lineno"></span><span class="comment" id="2847756">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2847831">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2847850">//</span><br>
<span class="lineno"></span><span class="comment" id="2847853">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2847930">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2847982">//</span><br>
<span class="lineno"></span><span class="comment" id="2847985">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2848040">func</span>&nbsp;<span class="ident" id="2848045">arrayOf</span><span class="op" id="2848052">(</span><span class="ident" id="2848053">count</span>&nbsp;<span class="builtintype" id="2848059">int</span><span class="op" id="2848062">,</span>&nbsp;<span class="ident" id="2848064">elem</span>&nbsp;<span class="ident" id="2848069">Type</span><span class="op" id="2848073">)</span>&nbsp;<span class="ident" id="2848075">Type</span>&nbsp;<span class="op" id="2848080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848083">typ</span>&nbsp;<span class="op" id="2848087">:=</span>&nbsp;<span class="ident" id="2848090">elem</span><span class="op" id="2848094">.</span><span class="op" id="2848095">(</span><span class="op" id="2848096">*</span><span class="ident" id="2848097">rtype</span><span class="op" id="2848102">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848105">slice</span>&nbsp;<span class="op" id="2848111">:=</span>&nbsp;<span class="ident" id="2848114">SliceOf</span><span class="op" id="2848121">(</span><span class="ident" id="2848122">elem</span><span class="op" id="2848126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848130">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848149">ckey</span>&nbsp;<span class="op" id="2848154">:=</span>&nbsp;<span class="ident" id="2848157">cacheKey</span><span class="op" id="2848165">{</span><span class="ident" id="2848166">Array</span><span class="op" id="2848171">,</span>&nbsp;<span class="ident" id="2848173">typ</span><span class="op" id="2848176">,</span>&nbsp;<span class="ident" id="2848178">nil</span><span class="op" id="2848181">,</span>&nbsp;<span class="builtintype" id="2848183">uintptr</span><span class="op" id="2848190">(</span><span class="ident" id="2848191">count</span><span class="op" id="2848196">)</span><span class="op" id="2848197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848200">if</span>&nbsp;<span class="ident" id="2848203">slice</span>&nbsp;<span class="op" id="2848209">:=</span>&nbsp;<span class="ident" id="2848212">cacheGet</span><span class="op" id="2848220">(</span><span class="ident" id="2848221">ckey</span><span class="op" id="2848225">)</span><span class="op" id="2848226">;</span>&nbsp;<span class="ident" id="2848228">slice</span>&nbsp;<span class="op" id="2848234">!=</span>&nbsp;<span class="ident" id="2848237">nil</span>&nbsp;<span class="op" id="2848241">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848245">return</span>&nbsp;<span class="ident" id="2848252">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848263">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848288">s</span>&nbsp;<span class="op" id="2848290">:=</span>&nbsp;<span class="string" id="2848293">&#34;[&#34;</span>&nbsp;<span class="op" id="2848297">+</span>&nbsp;<span class="ident" id="2848299">strconv</span><span class="op" id="2848306">.</span><span class="ident" id="2848307">Itoa</span><span class="op" id="2848311">(</span><span class="ident" id="2848312">count</span><span class="op" id="2848317">)</span>&nbsp;<span class="op" id="2848319">+</span>&nbsp;<span class="string" id="2848321">&#34;]&#34;</span>&nbsp;<span class="op" id="2848325">+</span>&nbsp;<span class="op" id="2848327">*</span><span class="ident" id="2848328">typ</span><span class="op" id="2848331">.</span><span class="builtintype" id="2848332">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848340">for</span>&nbsp;<span class="ident" id="2848344">_</span><span class="op" id="2848345">,</span>&nbsp;<span class="ident" id="2848347">tt</span>&nbsp;<span class="op" id="2848350">:=</span>&nbsp;<span class="keyword" id="2848353">range</span>&nbsp;<span class="ident" id="2848359">typesByString</span><span class="op" id="2848372">(</span><span class="ident" id="2848373">s</span><span class="op" id="2848374">)</span>&nbsp;<span class="op" id="2848376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848380">slice</span>&nbsp;<span class="op" id="2848386">:=</span>&nbsp;<span class="op" id="2848389">(</span><span class="op" id="2848390">*</span><span class="ident" id="2848391">sliceType</span><span class="op" id="2848400">)</span><span class="op" id="2848401">(</span><span class="ident" id="2848402">unsafe</span><span class="op" id="2848408">.</span><span class="ident" id="2848409">Pointer</span><span class="op" id="2848416">(</span><span class="ident" id="2848417">tt</span><span class="op" id="2848419">)</span><span class="op" id="2848420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848424">if</span>&nbsp;<span class="ident" id="2848427">slice</span><span class="op" id="2848432">.</span><span class="ident" id="2848433">elem</span>&nbsp;<span class="op" id="2848438">==</span>&nbsp;<span class="ident" id="2848441">typ</span>&nbsp;<span class="op" id="2848445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848450">return</span>&nbsp;<span class="ident" id="2848457">cachePut</span><span class="op" id="2848465">(</span><span class="ident" id="2848466">ckey</span><span class="op" id="2848470">,</span>&nbsp;<span class="ident" id="2848472">tt</span><span class="op" id="2848474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848478">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848485">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848509">var</span>&nbsp;<span class="ident" id="2848513">iarray</span>&nbsp;<span class="keyword" id="2848520">interface</span><span class="op" id="2848529">{</span><span class="op" id="2848530">}</span>&nbsp;<span class="op" id="2848532">=</span>&nbsp;<span class="op" id="2848534">[</span><span class="num" id="2848535">1</span><span class="op" id="2848536">]</span><span class="ident" id="2848537">unsafe</span><span class="op" id="2848543">.</span><span class="ident" id="2848544">Pointer</span><span class="op" id="2848551">{</span><span class="op" id="2848552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848555">prototype</span>&nbsp;<span class="op" id="2848565">:=</span>&nbsp;<span class="op" id="2848568">*</span><span class="op" id="2848569">(</span><span class="op" id="2848570">*</span><span class="op" id="2848571">*</span><span class="ident" id="2848572">arrayType</span><span class="op" id="2848581">)</span><span class="op" id="2848582">(</span><span class="ident" id="2848583">unsafe</span><span class="op" id="2848589">.</span><span class="ident" id="2848590">Pointer</span><span class="op" id="2848597">(</span><span class="op" id="2848598">&amp;</span><span class="ident" id="2848599">iarray</span><span class="op" id="2848605">)</span><span class="op" id="2848606">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848609">array</span>&nbsp;<span class="op" id="2848615">:=</span>&nbsp;<span class="builtinfunc" id="2848618">new</span><span class="op" id="2848621">(</span><span class="ident" id="2848622">arrayType</span><span class="op" id="2848631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848634">*</span><span class="ident" id="2848635">array</span>&nbsp;<span class="op" id="2848641">=</span>&nbsp;<span class="op" id="2848643">*</span><span class="ident" id="2848644">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848655">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848696">array</span><span class="op" id="2848701">.</span><span class="builtintype" id="2848702">string</span>&nbsp;<span class="op" id="2848709">=</span>&nbsp;<span class="op" id="2848711">&amp;</span><span class="ident" id="2848712">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848715">array</span><span class="op" id="2848720">.</span><span class="ident" id="2848721">hash</span>&nbsp;<span class="op" id="2848726">=</span>&nbsp;<span class="ident" id="2848728">fnv1</span><span class="op" id="2848732">(</span><span class="ident" id="2848733">typ</span><span class="op" id="2848736">.</span><span class="ident" id="2848737">hash</span><span class="op" id="2848741">,</span>&nbsp;<span class="string" id="2848743">&#39;[&#39;</span><span class="op" id="2848746">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848749">for</span>&nbsp;<span class="ident" id="2848753">n</span>&nbsp;<span class="op" id="2848755">:=</span>&nbsp;<span class="builtintype" id="2848758">uint32</span><span class="op" id="2848764">(</span><span class="ident" id="2848765">count</span><span class="op" id="2848770">)</span><span class="op" id="2848771">;</span>&nbsp;<span class="ident" id="2848773">n</span>&nbsp;<span class="op" id="2848775">&gt;</span>&nbsp;<span class="num" id="2848777">0</span><span class="op" id="2848778">;</span>&nbsp;<span class="ident" id="2848780">n</span>&nbsp;<span class="op" id="2848782">&gt;&gt;=</span>&nbsp;<span class="num" id="2848786">8</span>&nbsp;<span class="op" id="2848788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848792">array</span><span class="op" id="2848797">.</span><span class="ident" id="2848798">hash</span>&nbsp;<span class="op" id="2848803">=</span>&nbsp;<span class="ident" id="2848805">fnv1</span><span class="op" id="2848809">(</span><span class="ident" id="2848810">array</span><span class="op" id="2848815">.</span><span class="ident" id="2848816">hash</span><span class="op" id="2848820">,</span>&nbsp;<span class="builtintype" id="2848822">byte</span><span class="op" id="2848826">(</span><span class="ident" id="2848827">n</span><span class="op" id="2848828">)</span><span class="op" id="2848829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848835">array</span><span class="op" id="2848840">.</span><span class="ident" id="2848841">hash</span>&nbsp;<span class="op" id="2848846">=</span>&nbsp;<span class="ident" id="2848848">fnv1</span><span class="op" id="2848852">(</span><span class="ident" id="2848853">array</span><span class="op" id="2848858">.</span><span class="ident" id="2848859">hash</span><span class="op" id="2848863">,</span>&nbsp;<span class="string" id="2848865">&#39;]&#39;</span><span class="op" id="2848868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848871">array</span><span class="op" id="2848876">.</span><span class="ident" id="2848877">elem</span>&nbsp;<span class="op" id="2848882">=</span>&nbsp;<span class="ident" id="2848884">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848889">max</span>&nbsp;<span class="op" id="2848893">:=</span>&nbsp;<span class="op" id="2848896">^</span><span class="builtintype" id="2848897">uintptr</span><span class="op" id="2848904">(</span><span class="num" id="2848905">0</span><span class="op" id="2848906">)</span>&nbsp;<span class="op" id="2848908">/</span>&nbsp;<span class="ident" id="2848910">typ</span><span class="op" id="2848913">.</span><span class="ident" id="2848914">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848920">if</span>&nbsp;<span class="builtintype" id="2848923">uintptr</span><span class="op" id="2848930">(</span><span class="ident" id="2848931">count</span><span class="op" id="2848936">)</span>&nbsp;<span class="op" id="2848938">&gt;</span>&nbsp;<span class="ident" id="2848940">max</span>&nbsp;<span class="op" id="2848944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2848948">panic</span><span class="op" id="2848953">(</span><span class="string" id="2848954">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2849018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2849021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849024">array</span><span class="op" id="2849029">.</span><span class="ident" id="2849030">size</span>&nbsp;<span class="op" id="2849035">=</span>&nbsp;<span class="ident" id="2849037">typ</span><span class="op" id="2849040">.</span><span class="ident" id="2849041">size</span>&nbsp;<span class="op" id="2849046">*</span>&nbsp;<span class="builtintype" id="2849048">uintptr</span><span class="op" id="2849055">(</span><span class="ident" id="2849056">count</span><span class="op" id="2849061">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849064">array</span><span class="op" id="2849069">.</span><span class="ident" id="2849070">align</span>&nbsp;<span class="op" id="2849076">=</span>&nbsp;<span class="ident" id="2849078">typ</span><span class="op" id="2849081">.</span><span class="ident" id="2849082">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849089">array</span><span class="op" id="2849094">.</span><span class="ident" id="2849095">fieldAlign</span>&nbsp;<span class="op" id="2849106">=</span>&nbsp;<span class="ident" id="2849108">typ</span><span class="op" id="2849111">.</span><span class="ident" id="2849112">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2849124">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2849144">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2849163">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849173">array</span><span class="op" id="2849178">.</span><span class="ident" id="2849179">uncommonType</span>&nbsp;<span class="op" id="2849192">=</span>&nbsp;<span class="ident" id="2849194">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849199">array</span><span class="op" id="2849204">.</span><span class="ident" id="2849205">ptrToThis</span>&nbsp;<span class="op" id="2849215">=</span>&nbsp;<span class="ident" id="2849217">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849222">array</span><span class="op" id="2849227">.</span><span class="ident" id="2849228">zero</span>&nbsp;<span class="op" id="2849233">=</span>&nbsp;<span class="ident" id="2849235">unsafe</span><span class="op" id="2849241">.</span><span class="ident" id="2849242">Pointer</span><span class="op" id="2849249">(</span><span class="op" id="2849250">&amp;</span><span class="builtinfunc" id="2849251">make</span><span class="op" id="2849255">(</span><span class="op" id="2849256">[</span><span class="op" id="2849257">]</span><span class="builtintype" id="2849258">byte</span><span class="op" id="2849262">,</span>&nbsp;<span class="ident" id="2849264">array</span><span class="op" id="2849269">.</span><span class="ident" id="2849270">size</span><span class="op" id="2849274">)</span><span class="op" id="2849275">[</span><span class="num" id="2849276">0</span><span class="op" id="2849277">]</span><span class="op" id="2849278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849281">array</span><span class="op" id="2849286">.</span><span class="builtinfunc" id="2849287">len</span>&nbsp;<span class="op" id="2849291">=</span>&nbsp;<span class="builtintype" id="2849293">uintptr</span><span class="op" id="2849300">(</span><span class="ident" id="2849301">count</span><span class="op" id="2849306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849309">array</span><span class="op" id="2849314">.</span><span class="ident" id="2849315">slice</span>&nbsp;<span class="op" id="2849321">=</span>&nbsp;<span class="ident" id="2849323">slice</span><span class="op" id="2849328">.</span><span class="op" id="2849329">(</span><span class="op" id="2849330">*</span><span class="ident" id="2849331">rtype</span><span class="op" id="2849336">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849340">return</span>&nbsp;<span class="ident" id="2849347">cachePut</span><span class="op" id="2849355">(</span><span class="ident" id="2849356">ckey</span><span class="op" id="2849360">,</span>&nbsp;<span class="op" id="2849362">&amp;</span><span class="ident" id="2849363">array</span><span class="op" id="2849368">.</span><span class="ident" id="2849369">rtype</span><span class="op" id="2849374">)</span><br>
<span class="lineno"></span><span class="op" id="2849376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2849379">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2849443">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2849512">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2849578">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2849647">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2849689">func</span>&nbsp;<span class="ident" id="2849694">toType</span><span class="op" id="2849700">(</span><span class="ident" id="2849701">t</span>&nbsp;<span class="op" id="2849703">*</span><span class="ident" id="2849704">rtype</span><span class="op" id="2849709">)</span>&nbsp;<span class="ident" id="2849711">Type</span>&nbsp;<span class="op" id="2849716">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849719">if</span>&nbsp;<span class="ident" id="2849722">t</span>&nbsp;<span class="op" id="2849724">==</span>&nbsp;<span class="ident" id="2849727">nil</span>&nbsp;<span class="op" id="2849731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849735">return</span>&nbsp;<span class="ident" id="2849742">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2849747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849750">return</span>&nbsp;<span class="ident" id="2849757">t</span><br>
<span class="lineno"></span><span class="op" id="2849759">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2849762">type</span>&nbsp;<span class="ident" id="2849767">layoutKey</span>&nbsp;<span class="keyword" id="2849777">struct</span>&nbsp;<span class="op" id="2849784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849787">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849792">*</span><span class="ident" id="2849793">rtype</span>&nbsp;<span class="comment" id="2849799">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849822">rcvr</span>&nbsp;<span class="op" id="2849827">*</span><span class="ident" id="2849828">rtype</span>&nbsp;<span class="comment" id="2849834">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2849867">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2849870">type</span>&nbsp;<span class="ident" id="2849875">layoutType</span>&nbsp;<span class="keyword" id="2849886">struct</span>&nbsp;<span class="op" id="2849893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849896">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849906">*</span><span class="ident" id="2849907">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849914">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2849924">uintptr</span>&nbsp;<span class="comment" id="2849932">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849954">retOffset</span>&nbsp;<span class="builtintype" id="2849964">uintptr</span>&nbsp;<span class="comment" id="2849972">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850001">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850011">*</span><span class="ident" id="2850012">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2850022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2850025">var</span>&nbsp;<span class="ident" id="2850029">layoutCache</span>&nbsp;<span class="keyword" id="2850041">struct</span>&nbsp;<span class="op" id="2850048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850051">sync</span><span class="op" id="2850055">.</span><span class="ident" id="2850056">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850065">m</span>&nbsp;<span class="keyword" id="2850067">map</span><span class="op" id="2850070">[</span><span class="ident" id="2850071">layoutKey</span><span class="op" id="2850080">]</span><span class="ident" id="2850081">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2850092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2850095">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2850163">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2850228">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2850288">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2850367">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2850435">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2850475">func</span>&nbsp;<span class="ident" id="2850480">funcLayout</span><span class="op" id="2850490">(</span><span class="ident" id="2850491">t</span>&nbsp;<span class="op" id="2850493">*</span><span class="ident" id="2850494">rtype</span><span class="op" id="2850499">,</span>&nbsp;<span class="ident" id="2850501">rcvr</span>&nbsp;<span class="op" id="2850506">*</span><span class="ident" id="2850507">rtype</span><span class="op" id="2850512">)</span>&nbsp;<span class="op" id="2850514">(</span><span class="ident" id="2850515">frametype</span>&nbsp;<span class="op" id="2850525">*</span><span class="ident" id="2850526">rtype</span><span class="op" id="2850531">,</span>&nbsp;<span class="ident" id="2850533">argSize</span><span class="op" id="2850540">,</span>&nbsp;<span class="ident" id="2850542">retOffset</span>&nbsp;<span class="builtintype" id="2850552">uintptr</span><span class="op" id="2850559">,</span>&nbsp;<span class="ident" id="2850561">stack</span>&nbsp;<span class="op" id="2850567">*</span><span class="ident" id="2850568">bitVector</span><span class="op" id="2850577">)</span>&nbsp;<span class="op" id="2850579">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850582">if</span>&nbsp;<span class="ident" id="2850585">t</span><span class="op" id="2850586">.</span><span class="ident" id="2850587">Kind</span><span class="op" id="2850591">(</span><span class="op" id="2850592">)</span>&nbsp;<span class="op" id="2850594">!=</span>&nbsp;<span class="ident" id="2850597">Func</span>&nbsp;<span class="op" id="2850602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2850606">panic</span><span class="op" id="2850611">(</span><span class="string" id="2850612">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2850650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850656">if</span>&nbsp;<span class="ident" id="2850659">rcvr</span>&nbsp;<span class="op" id="2850664">!=</span>&nbsp;<span class="ident" id="2850667">nil</span>&nbsp;<span class="op" id="2850671">&amp;&amp;</span>&nbsp;<span class="ident" id="2850674">rcvr</span><span class="op" id="2850678">.</span><span class="ident" id="2850679">Kind</span><span class="op" id="2850683">(</span><span class="op" id="2850684">)</span>&nbsp;<span class="op" id="2850686">==</span>&nbsp;<span class="ident" id="2850689">Interface</span>&nbsp;<span class="op" id="2850699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2850703">panic</span><span class="op" id="2850708">(</span><span class="string" id="2850709">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2850756">+</span>&nbsp;<span class="ident" id="2850758">rcvr</span><span class="op" id="2850762">.</span><span class="ident" id="2850763">String</span><span class="op" id="2850769">(</span><span class="op" id="2850770">)</span><span class="op" id="2850771">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850777">k</span>&nbsp;<span class="op" id="2850779">:=</span>&nbsp;<span class="ident" id="2850782">layoutKey</span><span class="op" id="2850791">{</span><span class="ident" id="2850792">t</span><span class="op" id="2850793">,</span>&nbsp;<span class="ident" id="2850795">rcvr</span><span class="op" id="2850799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850802">layoutCache</span><span class="op" id="2850813">.</span><span class="ident" id="2850814">RLock</span><span class="op" id="2850819">(</span><span class="op" id="2850820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850823">if</span>&nbsp;<span class="ident" id="2850826">x</span>&nbsp;<span class="op" id="2850828">:=</span>&nbsp;<span class="ident" id="2850831">layoutCache</span><span class="op" id="2850842">.</span><span class="ident" id="2850843">m</span><span class="op" id="2850844">[</span><span class="ident" id="2850845">k</span><span class="op" id="2850846">]</span><span class="op" id="2850847">;</span>&nbsp;<span class="ident" id="2850849">x</span><span class="op" id="2850850">.</span><span class="ident" id="2850851">t</span>&nbsp;<span class="op" id="2850853">!=</span>&nbsp;<span class="ident" id="2850856">nil</span>&nbsp;<span class="op" id="2850860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850864">layoutCache</span><span class="op" id="2850875">.</span><span class="ident" id="2850876">RUnlock</span><span class="op" id="2850883">(</span><span class="op" id="2850884">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850888">return</span>&nbsp;<span class="ident" id="2850895">x</span><span class="op" id="2850896">.</span><span class="ident" id="2850897">t</span><span class="op" id="2850898">,</span>&nbsp;<span class="ident" id="2850900">x</span><span class="op" id="2850901">.</span><span class="ident" id="2850902">argSize</span><span class="op" id="2850909">,</span>&nbsp;<span class="ident" id="2850911">x</span><span class="op" id="2850912">.</span><span class="ident" id="2850913">retOffset</span><span class="op" id="2850922">,</span>&nbsp;<span class="ident" id="2850924">x</span><span class="op" id="2850925">.</span><span class="ident" id="2850926">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850936">layoutCache</span><span class="op" id="2850947">.</span><span class="ident" id="2850948">RUnlock</span><span class="op" id="2850955">(</span><span class="op" id="2850956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850959">layoutCache</span><span class="op" id="2850970">.</span><span class="ident" id="2850971">Lock</span><span class="op" id="2850975">(</span><span class="op" id="2850976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850979">if</span>&nbsp;<span class="ident" id="2850982">x</span>&nbsp;<span class="op" id="2850984">:=</span>&nbsp;<span class="ident" id="2850987">layoutCache</span><span class="op" id="2850998">.</span><span class="ident" id="2850999">m</span><span class="op" id="2851000">[</span><span class="ident" id="2851001">k</span><span class="op" id="2851002">]</span><span class="op" id="2851003">;</span>&nbsp;<span class="ident" id="2851005">x</span><span class="op" id="2851006">.</span><span class="ident" id="2851007">t</span>&nbsp;<span class="op" id="2851009">!=</span>&nbsp;<span class="ident" id="2851012">nil</span>&nbsp;<span class="op" id="2851016">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851020">layoutCache</span><span class="op" id="2851031">.</span><span class="ident" id="2851032">Unlock</span><span class="op" id="2851038">(</span><span class="op" id="2851039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851043">return</span>&nbsp;<span class="ident" id="2851050">x</span><span class="op" id="2851051">.</span><span class="ident" id="2851052">t</span><span class="op" id="2851053">,</span>&nbsp;<span class="ident" id="2851055">x</span><span class="op" id="2851056">.</span><span class="ident" id="2851057">argSize</span><span class="op" id="2851064">,</span>&nbsp;<span class="ident" id="2851066">x</span><span class="op" id="2851067">.</span><span class="ident" id="2851068">retOffset</span><span class="op" id="2851077">,</span>&nbsp;<span class="ident" id="2851079">x</span><span class="op" id="2851080">.</span><span class="ident" id="2851081">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851092">tt</span>&nbsp;<span class="op" id="2851095">:=</span>&nbsp;<span class="op" id="2851098">(</span><span class="op" id="2851099">*</span><span class="ident" id="2851100">funcType</span><span class="op" id="2851108">)</span><span class="op" id="2851109">(</span><span class="ident" id="2851110">unsafe</span><span class="op" id="2851116">.</span><span class="ident" id="2851117">Pointer</span><span class="op" id="2851124">(</span><span class="ident" id="2851125">t</span><span class="op" id="2851126">)</span><span class="op" id="2851127">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851131">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851183">stack</span>&nbsp;<span class="op" id="2851189">=</span>&nbsp;<span class="builtinfunc" id="2851191">new</span><span class="op" id="2851194">(</span><span class="ident" id="2851195">bitVector</span><span class="op" id="2851204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851207">var</span>&nbsp;<span class="ident" id="2851211">gc</span>&nbsp;<span class="ident" id="2851214">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851222">var</span>&nbsp;<span class="ident" id="2851226">offset</span>&nbsp;<span class="builtintype" id="2851233">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851242">if</span>&nbsp;<span class="ident" id="2851245">rcvr</span>&nbsp;<span class="op" id="2851250">!=</span>&nbsp;<span class="ident" id="2851253">nil</span>&nbsp;<span class="op" id="2851257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851261">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851318">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851374">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851422">if</span>&nbsp;<span class="ident" id="2851425">ifaceIndir</span><span class="op" id="2851435">(</span><span class="ident" id="2851436">rcvr</span><span class="op" id="2851440">)</span>&nbsp;<span class="op" id="2851442">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851447">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851488">gc</span><span class="op" id="2851490">.</span><span class="builtinfunc" id="2851491">append</span><span class="op" id="2851497">(</span><span class="ident" id="2851498">bitsPointer</span><span class="op" id="2851509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851514">stack</span><span class="op" id="2851519">.</span><span class="ident" id="2851520">append2</span><span class="op" id="2851527">(</span><span class="ident" id="2851528">bitsPointer</span><span class="op" id="2851539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851543">}</span>&nbsp;<span class="keyword" id="2851545">else</span>&nbsp;<span class="keyword" id="2851550">if</span>&nbsp;<span class="ident" id="2851553">rcvr</span><span class="op" id="2851557">.</span><span class="ident" id="2851558">pointers</span><span class="op" id="2851566">(</span><span class="op" id="2851567">)</span>&nbsp;<span class="op" id="2851569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851574">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851631">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851664">gc</span><span class="op" id="2851666">.</span><span class="builtinfunc" id="2851667">append</span><span class="op" id="2851673">(</span><span class="ident" id="2851674">bitsPointer</span><span class="op" id="2851685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851690">stack</span><span class="op" id="2851695">.</span><span class="ident" id="2851696">append2</span><span class="op" id="2851703">(</span><span class="ident" id="2851704">bitsPointer</span><span class="op" id="2851715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851719">}</span>&nbsp;<span class="keyword" id="2851721">else</span>&nbsp;<span class="op" id="2851726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851731">gc</span><span class="op" id="2851733">.</span><span class="builtinfunc" id="2851734">append</span><span class="op" id="2851740">(</span><span class="ident" id="2851741">bitsScalar</span><span class="op" id="2851751">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851756">stack</span><span class="op" id="2851761">.</span><span class="ident" id="2851762">append2</span><span class="op" id="2851769">(</span><span class="ident" id="2851770">bitsScalar</span><span class="op" id="2851780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851788">offset</span>&nbsp;<span class="op" id="2851795">+=</span>&nbsp;<span class="ident" id="2851798">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851810">for</span>&nbsp;<span class="ident" id="2851814">_</span><span class="op" id="2851815">,</span>&nbsp;<span class="ident" id="2851817">arg</span>&nbsp;<span class="op" id="2851821">:=</span>&nbsp;<span class="keyword" id="2851824">range</span>&nbsp;<span class="ident" id="2851830">tt</span><span class="op" id="2851832">.</span><span class="ident" id="2851833">in</span>&nbsp;<span class="op" id="2851836">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851840">gc</span><span class="op" id="2851842">.</span><span class="ident" id="2851843">appendProg</span><span class="op" id="2851853">(</span><span class="ident" id="2851854">arg</span><span class="op" id="2851857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851861">addTypeBits</span><span class="op" id="2851872">(</span><span class="ident" id="2851873">stack</span><span class="op" id="2851878">,</span>&nbsp;<span class="op" id="2851880">&amp;</span><span class="ident" id="2851881">offset</span><span class="op" id="2851887">,</span>&nbsp;<span class="ident" id="2851889">arg</span><span class="op" id="2851892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851898">argSize</span>&nbsp;<span class="op" id="2851906">=</span>&nbsp;<span class="ident" id="2851908">gc</span><span class="op" id="2851910">.</span><span class="ident" id="2851911">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851917">if</span>&nbsp;<span class="ident" id="2851920">runtime</span><span class="op" id="2851927">.</span><span class="ident" id="2851928">GOARCH</span>&nbsp;<span class="op" id="2851935">==</span>&nbsp;<span class="string" id="2851938">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2851949">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851953">gc</span><span class="op" id="2851955">.</span><span class="ident" id="2851956">align</span><span class="op" id="2851961">(</span><span class="num" id="2851962">8</span><span class="op" id="2851963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851969">gc</span><span class="op" id="2851971">.</span><span class="ident" id="2851972">align</span><span class="op" id="2851977">(</span><span class="ident" id="2851978">ptrSize</span><span class="op" id="2851985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851988">retOffset</span>&nbsp;<span class="op" id="2851998">=</span>&nbsp;<span class="ident" id="2852000">gc</span><span class="op" id="2852002">.</span><span class="ident" id="2852003">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852009">for</span>&nbsp;<span class="ident" id="2852013">_</span><span class="op" id="2852014">,</span>&nbsp;<span class="ident" id="2852016">res</span>&nbsp;<span class="op" id="2852020">:=</span>&nbsp;<span class="keyword" id="2852023">range</span>&nbsp;<span class="ident" id="2852029">tt</span><span class="op" id="2852031">.</span><span class="ident" id="2852032">out</span>&nbsp;<span class="op" id="2852036">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852040">gc</span><span class="op" id="2852042">.</span><span class="ident" id="2852043">appendProg</span><span class="op" id="2852053">(</span><span class="ident" id="2852054">res</span><span class="op" id="2852057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852061">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852104">gc</span><span class="op" id="2852106">.</span><span class="ident" id="2852107">align</span><span class="op" id="2852112">(</span><span class="ident" id="2852113">ptrSize</span><span class="op" id="2852120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852124">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852165">x</span>&nbsp;<span class="op" id="2852167">:=</span>&nbsp;<span class="builtinfunc" id="2852170">new</span><span class="op" id="2852173">(</span><span class="ident" id="2852174">rtype</span><span class="op" id="2852179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852182">x</span><span class="op" id="2852183">.</span><span class="ident" id="2852184">size</span>&nbsp;<span class="op" id="2852189">=</span>&nbsp;<span class="ident" id="2852191">gc</span><span class="op" id="2852193">.</span><span class="ident" id="2852194">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852200">x</span><span class="op" id="2852201">.</span><span class="ident" id="2852202">gc</span><span class="op" id="2852204">[</span><span class="num" id="2852205">0</span><span class="op" id="2852206">]</span>&nbsp;<span class="op" id="2852208">=</span>&nbsp;<span class="ident" id="2852210">gc</span><span class="op" id="2852212">.</span><span class="ident" id="2852213">finalize</span><span class="op" id="2852221">(</span><span class="op" id="2852222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852225">var</span>&nbsp;<span class="ident" id="2852229">s</span>&nbsp;<span class="builtintype" id="2852231">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852239">if</span>&nbsp;<span class="ident" id="2852242">rcvr</span>&nbsp;<span class="op" id="2852247">!=</span>&nbsp;<span class="ident" id="2852250">nil</span>&nbsp;<span class="op" id="2852254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852258">s</span>&nbsp;<span class="op" id="2852260">=</span>&nbsp;<span class="string" id="2852262">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2852276">+</span>&nbsp;<span class="op" id="2852278">*</span><span class="ident" id="2852279">rcvr</span><span class="op" id="2852283">.</span><span class="builtintype" id="2852284">string</span>&nbsp;<span class="op" id="2852291">+</span>&nbsp;<span class="string" id="2852293">&#34;)(&#34;</span>&nbsp;<span class="op" id="2852298">+</span>&nbsp;<span class="op" id="2852300">*</span><span class="ident" id="2852301">t</span><span class="op" id="2852302">.</span><span class="builtintype" id="2852303">string</span>&nbsp;<span class="op" id="2852310">+</span>&nbsp;<span class="string" id="2852312">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852317">}</span>&nbsp;<span class="keyword" id="2852319">else</span>&nbsp;<span class="op" id="2852324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852328">s</span>&nbsp;<span class="op" id="2852330">=</span>&nbsp;<span class="string" id="2852332">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2852344">+</span>&nbsp;<span class="op" id="2852346">*</span><span class="ident" id="2852347">t</span><span class="op" id="2852348">.</span><span class="builtintype" id="2852349">string</span>&nbsp;<span class="op" id="2852356">+</span>&nbsp;<span class="string" id="2852358">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852363">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852366">x</span><span class="op" id="2852367">.</span><span class="builtintype" id="2852368">string</span>&nbsp;<span class="op" id="2852375">=</span>&nbsp;<span class="op" id="2852377">&amp;</span><span class="ident" id="2852378">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852382">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852418">if</span>&nbsp;<span class="ident" id="2852421">layoutCache</span><span class="op" id="2852432">.</span><span class="ident" id="2852433">m</span>&nbsp;<span class="op" id="2852435">==</span>&nbsp;<span class="ident" id="2852438">nil</span>&nbsp;<span class="op" id="2852442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852446">layoutCache</span><span class="op" id="2852457">.</span><span class="ident" id="2852458">m</span>&nbsp;<span class="op" id="2852460">=</span>&nbsp;<span class="builtinfunc" id="2852462">make</span><span class="op" id="2852466">(</span><span class="keyword" id="2852467">map</span><span class="op" id="2852470">[</span><span class="ident" id="2852471">layoutKey</span><span class="op" id="2852480">]</span><span class="ident" id="2852481">layoutType</span><span class="op" id="2852491">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852497">layoutCache</span><span class="op" id="2852508">.</span><span class="ident" id="2852509">m</span><span class="op" id="2852510">[</span><span class="ident" id="2852511">k</span><span class="op" id="2852512">]</span>&nbsp;<span class="op" id="2852514">=</span>&nbsp;<span class="ident" id="2852516">layoutType</span><span class="op" id="2852526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852530">t</span><span class="op" id="2852531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852541">x</span><span class="op" id="2852542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852546">argSize</span><span class="op" id="2852553">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2852557">argSize</span><span class="op" id="2852564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852568">retOffset</span><span class="op" id="2852577">:</span>&nbsp;<span class="ident" id="2852579">retOffset</span><span class="op" id="2852588">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852592">stack</span><span class="op" id="2852597">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852603">stack</span><span class="op" id="2852608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852614">layoutCache</span><span class="op" id="2852625">.</span><span class="ident" id="2852626">Unlock</span><span class="op" id="2852632">(</span><span class="op" id="2852633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852636">return</span>&nbsp;<span class="ident" id="2852643">x</span><span class="op" id="2852644">,</span>&nbsp;<span class="ident" id="2852646">argSize</span><span class="op" id="2852653">,</span>&nbsp;<span class="ident" id="2852655">retOffset</span><span class="op" id="2852664">,</span>&nbsp;<span class="ident" id="2852666">stack</span><br>
<span class="lineno"></span><span class="op" id="2852672">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2852675">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2852751">func</span>&nbsp;<span class="ident" id="2852756">ifaceIndir</span><span class="op" id="2852766">(</span><span class="ident" id="2852767">t</span>&nbsp;<span class="op" id="2852769">*</span><span class="ident" id="2852770">rtype</span><span class="op" id="2852775">)</span>&nbsp;<span class="builtintype" id="2852777">bool</span>&nbsp;<span class="op" id="2852782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852785">return</span>&nbsp;<span class="ident" id="2852792">t</span><span class="op" id="2852793">.</span><span class="ident" id="2852794">kind</span><span class="op" id="2852798">&amp;</span><span class="ident" id="2852799">kindDirectIface</span>&nbsp;<span class="op" id="2852815">==</span>&nbsp;<span class="num" id="2852818">0</span><br>
<span class="lineno"></span><span class="op" id="2852820">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2852823">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2852874">type</span>&nbsp;<span class="ident" id="2852879">bitVector</span>&nbsp;<span class="keyword" id="2852889">struct</span>&nbsp;<span class="op" id="2852896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852899">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2852904">uint32</span>&nbsp;<span class="comment" id="2852911">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852930">data</span>&nbsp;<span class="op" id="2852935">[</span><span class="op" id="2852936">]</span><span class="builtintype" id="2852937">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2852942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2852945">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2852981">func</span>&nbsp;<span class="op" id="2852986">(</span><span class="ident" id="2852987">bv</span>&nbsp;<span class="op" id="2852990">*</span><span class="ident" id="2852991">bitVector</span><span class="op" id="2853000">)</span>&nbsp;<span class="ident" id="2853002">append2</span><span class="op" id="2853009">(</span><span class="ident" id="2853010">bits</span>&nbsp;<span class="builtintype" id="2853015">uint8</span><span class="op" id="2853020">)</span>&nbsp;<span class="op" id="2853022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853025">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853098">if</span>&nbsp;<span class="ident" id="2853101">bv</span><span class="op" id="2853103">.</span><span class="ident" id="2853104">n</span><span class="op" id="2853105">%</span><span class="num" id="2853106">8</span>&nbsp;<span class="op" id="2853108">==</span>&nbsp;<span class="num" id="2853111">0</span>&nbsp;<span class="op" id="2853113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853117">bv</span><span class="op" id="2853119">.</span><span class="ident" id="2853120">data</span>&nbsp;<span class="op" id="2853125">=</span>&nbsp;<span class="builtinfunc" id="2853127">append</span><span class="op" id="2853133">(</span><span class="ident" id="2853134">bv</span><span class="op" id="2853136">.</span><span class="ident" id="2853137">data</span><span class="op" id="2853141">,</span>&nbsp;<span class="num" id="2853143">0</span><span class="op" id="2853144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853150">bv</span><span class="op" id="2853152">.</span><span class="ident" id="2853153">data</span><span class="op" id="2853157">[</span><span class="ident" id="2853158">bv</span><span class="op" id="2853160">.</span><span class="ident" id="2853161">n</span><span class="op" id="2853162">/</span><span class="num" id="2853163">8</span><span class="op" id="2853164">]</span>&nbsp;<span class="op" id="2853166">|=</span>&nbsp;<span class="ident" id="2853169">bits</span>&nbsp;<span class="op" id="2853174">&lt;&lt;</span>&nbsp;<span class="op" id="2853177">(</span><span class="ident" id="2853178">bv</span><span class="op" id="2853180">.</span><span class="ident" id="2853181">n</span>&nbsp;<span class="op" id="2853183">%</span>&nbsp;<span class="num" id="2853185">8</span><span class="op" id="2853186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853189">bv</span><span class="op" id="2853191">.</span><span class="ident" id="2853192">n</span>&nbsp;<span class="op" id="2853194">+=</span>&nbsp;<span class="num" id="2853197">2</span><br>
<span class="lineno">1885</span><span class="op" id="2853199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2853202">func</span>&nbsp;<span class="ident" id="2853207">addTypeBits</span><span class="op" id="2853218">(</span><span class="ident" id="2853219">bv</span>&nbsp;<span class="op" id="2853222">*</span><span class="ident" id="2853223">bitVector</span><span class="op" id="2853232">,</span>&nbsp;<span class="ident" id="2853234">offset</span>&nbsp;<span class="op" id="2853241">*</span><span class="builtintype" id="2853242">uintptr</span><span class="op" id="2853249">,</span>&nbsp;<span class="ident" id="2853251">t</span>&nbsp;<span class="op" id="2853253">*</span><span class="ident" id="2853254">rtype</span><span class="op" id="2853259">)</span>&nbsp;<span class="op" id="2853261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853264">*</span><span class="ident" id="2853265">offset</span>&nbsp;<span class="op" id="2853272">=</span>&nbsp;<span class="ident" id="2853274">align</span><span class="op" id="2853279">(</span><span class="op" id="2853280">*</span><span class="ident" id="2853281">offset</span><span class="op" id="2853287">,</span>&nbsp;<span class="builtintype" id="2853289">uintptr</span><span class="op" id="2853296">(</span><span class="ident" id="2853297">t</span><span class="op" id="2853298">.</span><span class="ident" id="2853299">align</span><span class="op" id="2853304">)</span><span class="op" id="2853305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853308">if</span>&nbsp;<span class="ident" id="2853311">t</span><span class="op" id="2853312">.</span><span class="ident" id="2853313">kind</span><span class="op" id="2853317">&amp;</span><span class="ident" id="2853318">kindNoPointers</span>&nbsp;<span class="op" id="2853333">!=</span>&nbsp;<span class="num" id="2853336">0</span>&nbsp;<span class="op" id="2853338">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853342">*</span><span class="ident" id="2853343">offset</span>&nbsp;<span class="op" id="2853350">+=</span>&nbsp;<span class="ident" id="2853353">t</span><span class="op" id="2853354">.</span><span class="ident" id="2853355">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853362">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853374">switch</span>&nbsp;<span class="ident" id="2853381">Kind</span><span class="op" id="2853385">(</span><span class="ident" id="2853386">t</span><span class="op" id="2853387">.</span><span class="ident" id="2853388">kind</span>&nbsp;<span class="op" id="2853393">&amp;</span>&nbsp;<span class="ident" id="2853395">kindMask</span><span class="op" id="2853403">)</span>&nbsp;<span class="op" id="2853405">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853408">case</span>&nbsp;<span class="ident" id="2853413">Chan</span><span class="op" id="2853417">,</span>&nbsp;<span class="ident" id="2853419">Func</span><span class="op" id="2853423">,</span>&nbsp;<span class="ident" id="2853425">Map</span><span class="op" id="2853428">,</span>&nbsp;<span class="ident" id="2853430">Ptr</span><span class="op" id="2853433">,</span>&nbsp;<span class="ident" id="2853435">Slice</span><span class="op" id="2853440">,</span>&nbsp;<span class="ident" id="2853442">String</span><span class="op" id="2853448">,</span>&nbsp;<span class="ident" id="2853450">UnsafePointer</span><span class="op" id="2853463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853467">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853509">for</span>&nbsp;<span class="ident" id="2853513">bv</span><span class="op" id="2853515">.</span><span class="ident" id="2853516">n</span>&nbsp;<span class="op" id="2853518">&lt;</span>&nbsp;<span class="num" id="2853520">2</span><span class="op" id="2853521">*</span><span class="builtintype" id="2853522">uint32</span><span class="op" id="2853528">(</span><span class="op" id="2853529">*</span><span class="ident" id="2853530">offset</span><span class="op" id="2853536">/</span><span class="builtintype" id="2853537">uintptr</span><span class="op" id="2853544">(</span><span class="ident" id="2853545">ptrSize</span><span class="op" id="2853552">)</span><span class="op" id="2853553">)</span>&nbsp;<span class="op" id="2853555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853560">bv</span><span class="op" id="2853562">.</span><span class="ident" id="2853563">append2</span><span class="op" id="2853570">(</span><span class="ident" id="2853571">bitsScalar</span><span class="op" id="2853581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853585">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853589">bv</span><span class="op" id="2853591">.</span><span class="ident" id="2853592">append2</span><span class="op" id="2853599">(</span><span class="ident" id="2853600">bitsPointer</span><span class="op" id="2853611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853615">case</span>&nbsp;<span class="ident" id="2853620">Interface</span><span class="op" id="2853629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853633">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853649">for</span>&nbsp;<span class="ident" id="2853653">bv</span><span class="op" id="2853655">.</span><span class="ident" id="2853656">n</span>&nbsp;<span class="op" id="2853658">&lt;</span>&nbsp;<span class="num" id="2853660">2</span><span class="op" id="2853661">*</span><span class="builtintype" id="2853662">uint32</span><span class="op" id="2853668">(</span><span class="op" id="2853669">*</span><span class="ident" id="2853670">offset</span><span class="op" id="2853676">/</span><span class="builtintype" id="2853677">uintptr</span><span class="op" id="2853684">(</span><span class="ident" id="2853685">ptrSize</span><span class="op" id="2853692">)</span><span class="op" id="2853693">)</span>&nbsp;<span class="op" id="2853695">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853700">bv</span><span class="op" id="2853702">.</span><span class="ident" id="2853703">append2</span><span class="op" id="2853710">(</span><span class="ident" id="2853711">bitsScalar</span><span class="op" id="2853721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853729">bv</span><span class="op" id="2853731">.</span><span class="ident" id="2853732">append2</span><span class="op" id="2853739">(</span><span class="ident" id="2853740">bitsPointer</span><span class="op" id="2853751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853755">bv</span><span class="op" id="2853757">.</span><span class="ident" id="2853758">append2</span><span class="op" id="2853765">(</span><span class="ident" id="2853766">bitsPointer</span><span class="op" id="2853777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853781">case</span>&nbsp;<span class="ident" id="2853786">Array</span><span class="op" id="2853791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853795">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853818">tt</span>&nbsp;<span class="op" id="2853821">:=</span>&nbsp;<span class="op" id="2853824">(</span><span class="op" id="2853825">*</span><span class="ident" id="2853826">arrayType</span><span class="op" id="2853835">)</span><span class="op" id="2853836">(</span><span class="ident" id="2853837">unsafe</span><span class="op" id="2853843">.</span><span class="ident" id="2853844">Pointer</span><span class="op" id="2853851">(</span><span class="ident" id="2853852">t</span><span class="op" id="2853853">)</span><span class="op" id="2853854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853858">for</span>&nbsp;<span class="ident" id="2853862">i</span>&nbsp;<span class="op" id="2853864">:=</span>&nbsp;<span class="num" id="2853867">0</span><span class="op" id="2853868">;</span>&nbsp;<span class="ident" id="2853870">i</span>&nbsp;<span class="op" id="2853872">&lt;</span>&nbsp;<span class="builtintype" id="2853874">int</span><span class="op" id="2853877">(</span><span class="ident" id="2853878">tt</span><span class="op" id="2853880">.</span><span class="builtinfunc" id="2853881">len</span><span class="op" id="2853884">)</span><span class="op" id="2853885">;</span>&nbsp;<span class="ident" id="2853887">i</span><span class="op" id="2853888">++</span>&nbsp;<span class="op" id="2853891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853896">addTypeBits</span><span class="op" id="2853907">(</span><span class="ident" id="2853908">bv</span><span class="op" id="2853910">,</span>&nbsp;<span class="ident" id="2853912">offset</span><span class="op" id="2853918">,</span>&nbsp;<span class="ident" id="2853920">tt</span><span class="op" id="2853922">.</span><span class="ident" id="2853923">elem</span><span class="op" id="2853927">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853935">case</span>&nbsp;<span class="ident" id="2853940">Struct</span><span class="op" id="2853946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2853950">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853968">tt</span>&nbsp;<span class="op" id="2853971">:=</span>&nbsp;<span class="op" id="2853974">(</span><span class="op" id="2853975">*</span><span class="ident" id="2853976">structType</span><span class="op" id="2853986">)</span><span class="op" id="2853987">(</span><span class="ident" id="2853988">unsafe</span><span class="op" id="2853994">.</span><span class="ident" id="2853995">Pointer</span><span class="op" id="2854002">(</span><span class="ident" id="2854003">t</span><span class="op" id="2854004">)</span><span class="op" id="2854005">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854009">start</span>&nbsp;<span class="op" id="2854015">:=</span>&nbsp;<span class="op" id="2854018">*</span><span class="ident" id="2854019">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854028">for</span>&nbsp;<span class="ident" id="2854032">i</span>&nbsp;<span class="op" id="2854034">:=</span>&nbsp;<span class="keyword" id="2854037">range</span>&nbsp;<span class="ident" id="2854043">tt</span><span class="op" id="2854045">.</span><span class="ident" id="2854046">fields</span>&nbsp;<span class="op" id="2854053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854058">f</span>&nbsp;<span class="op" id="2854060">:=</span>&nbsp;<span class="op" id="2854063">&amp;</span><span class="ident" id="2854064">tt</span><span class="op" id="2854066">.</span><span class="ident" id="2854067">fields</span><span class="op" id="2854073">[</span><span class="ident" id="2854074">i</span><span class="op" id="2854075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854080">off</span>&nbsp;<span class="op" id="2854084">:=</span>&nbsp;<span class="ident" id="2854087">start</span>&nbsp;<span class="op" id="2854093">+</span>&nbsp;<span class="ident" id="2854095">f</span><span class="op" id="2854096">.</span><span class="ident" id="2854097">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854107">addTypeBits</span><span class="op" id="2854118">(</span><span class="ident" id="2854119">bv</span><span class="op" id="2854121">,</span>&nbsp;<span class="op" id="2854123">&amp;</span><span class="ident" id="2854124">off</span><span class="op" id="2854127">,</span>&nbsp;<span class="ident" id="2854129">f</span><span class="op" id="2854130">.</span><span class="ident" id="2854131">typ</span><span class="op" id="2854134">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854145">*</span><span class="ident" id="2854146">offset</span>&nbsp;<span class="op" id="2854153">+=</span>&nbsp;<span class="ident" id="2854156">t</span><span class="op" id="2854157">.</span><span class="ident" id="2854158">size</span><br>
<span class="lineno"></span><span class="op" id="2854163">}</span>
</div>
</body>
</html>
