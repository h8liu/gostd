<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4379207">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4379262">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4379316">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4379367">package</span>&nbsp;<span class="ident" id="4379375">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4379385">import</span>&nbsp;<span class="op" id="4379392">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4379395">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4379401">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4379404">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4379481">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="4379551">//</span><br>
<span class="lineno"></span><span class="comment" id="4379554">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="4379629">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4379672">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="4379722">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="4379760">type</span>&nbsp;<span class="ident" id="4379765">context</span>&nbsp;<span class="keyword" id="4379773">struct</span>&nbsp;<span class="op" id="4379780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379783">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4379791">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379798">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4379806">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379813">urlPart</span>&nbsp;<span class="ident" id="4379821">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379830">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4379838">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379845">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379853">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379859">element</span>&nbsp;<span class="ident" id="4379867">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379876">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379884">*</span><span class="ident" id="4379885">Error</span><br>
<span class="lineno"></span><span class="op" id="4379891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4379894">func</span>&nbsp;<span class="op" id="4379899">(</span><span class="ident" id="4379900">c</span>&nbsp;<span class="ident" id="4379902">context</span><span class="op" id="4379909">)</span>&nbsp;<span class="ident" id="4379911">String</span><span class="op" id="4379917">(</span><span class="op" id="4379918">)</span>&nbsp;<span class="builtintype" id="4379920">string</span>&nbsp;<span class="op" id="4379927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379930">return</span>&nbsp;<span class="ident" id="4379937">fmt</span><span class="op" id="4379940">.</span><span class="ident" id="4379941">Sprintf</span><span class="op" id="4379948">(</span><span class="string" id="4379949">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="4379973">,</span>&nbsp;<span class="ident" id="4379975">c</span><span class="op" id="4379976">.</span><span class="ident" id="4379977">state</span><span class="op" id="4379982">,</span>&nbsp;<span class="ident" id="4379984">c</span><span class="op" id="4379985">.</span><span class="ident" id="4379986">delim</span><span class="op" id="4379991">,</span>&nbsp;<span class="ident" id="4379993">c</span><span class="op" id="4379994">.</span><span class="ident" id="4379995">urlPart</span><span class="op" id="4380002">,</span>&nbsp;<span class="ident" id="4380004">c</span><span class="op" id="4380005">.</span><span class="ident" id="4380006">jsCtx</span><span class="op" id="4380011">,</span>&nbsp;<span class="ident" id="4380013">c</span><span class="op" id="4380014">.</span><span class="ident" id="4380015">attr</span><span class="op" id="4380019">,</span>&nbsp;<span class="ident" id="4380021">c</span><span class="op" id="4380022">.</span><span class="ident" id="4380023">element</span><span class="op" id="4380030">,</span>&nbsp;<span class="ident" id="4380032">c</span><span class="op" id="4380033">.</span><span class="ident" id="4380034">err</span><span class="op" id="4380037">)</span><br>
<span class="lineno">30</span><span class="op" id="4380039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380042">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="4380088">func</span>&nbsp;<span class="op" id="4380093">(</span><span class="ident" id="4380094">c</span>&nbsp;<span class="ident" id="4380096">context</span><span class="op" id="4380103">)</span>&nbsp;<span class="ident" id="4380105">eq</span><span class="op" id="4380107">(</span><span class="ident" id="4380108">d</span>&nbsp;<span class="ident" id="4380110">context</span><span class="op" id="4380117">)</span>&nbsp;<span class="builtintype" id="4380119">bool</span>&nbsp;<span class="op" id="4380124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380127">return</span>&nbsp;<span class="ident" id="4380134">c</span><span class="op" id="4380135">.</span><span class="ident" id="4380136">state</span>&nbsp;<span class="op" id="4380142">==</span>&nbsp;<span class="ident" id="4380145">d</span><span class="op" id="4380146">.</span><span class="ident" id="4380147">state</span>&nbsp;<span class="op" id="4380153">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380158">c</span><span class="op" id="4380159">.</span><span class="ident" id="4380160">delim</span>&nbsp;<span class="op" id="4380166">==</span>&nbsp;<span class="ident" id="4380169">d</span><span class="op" id="4380170">.</span><span class="ident" id="4380171">delim</span>&nbsp;<span class="op" id="4380177">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380182">c</span><span class="op" id="4380183">.</span><span class="ident" id="4380184">urlPart</span>&nbsp;<span class="op" id="4380192">==</span>&nbsp;<span class="ident" id="4380195">d</span><span class="op" id="4380196">.</span><span class="ident" id="4380197">urlPart</span>&nbsp;<span class="op" id="4380205">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380210">c</span><span class="op" id="4380211">.</span><span class="ident" id="4380212">jsCtx</span>&nbsp;<span class="op" id="4380218">==</span>&nbsp;<span class="ident" id="4380221">d</span><span class="op" id="4380222">.</span><span class="ident" id="4380223">jsCtx</span>&nbsp;<span class="op" id="4380229">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380234">c</span><span class="op" id="4380235">.</span><span class="ident" id="4380236">attr</span>&nbsp;<span class="op" id="4380241">==</span>&nbsp;<span class="ident" id="4380244">d</span><span class="op" id="4380245">.</span><span class="ident" id="4380246">attr</span>&nbsp;<span class="op" id="4380251">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380256">c</span><span class="op" id="4380257">.</span><span class="ident" id="4380258">element</span>&nbsp;<span class="op" id="4380266">==</span>&nbsp;<span class="ident" id="4380269">d</span><span class="op" id="4380270">.</span><span class="ident" id="4380271">element</span>&nbsp;<span class="op" id="4380279">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380284">c</span><span class="op" id="4380285">.</span><span class="ident" id="4380286">err</span>&nbsp;<span class="op" id="4380290">==</span>&nbsp;<span class="ident" id="4380293">d</span><span class="op" id="4380294">.</span><span class="ident" id="4380295">err</span><br>
<span class="lineno"></span><span class="op" id="4380299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380302">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4380380">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="4380436">func</span>&nbsp;<span class="op" id="4380441">(</span><span class="ident" id="4380442">c</span>&nbsp;<span class="ident" id="4380444">context</span><span class="op" id="4380451">)</span>&nbsp;<span class="ident" id="4380453">mangle</span><span class="op" id="4380459">(</span><span class="ident" id="4380460">templateName</span>&nbsp;<span class="builtintype" id="4380473">string</span><span class="op" id="4380479">)</span>&nbsp;<span class="builtintype" id="4380481">string</span>&nbsp;<span class="op" id="4380488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4380491">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380563">if</span>&nbsp;<span class="ident" id="4380566">c</span><span class="op" id="4380567">.</span><span class="ident" id="4380568">state</span>&nbsp;<span class="op" id="4380574">==</span>&nbsp;<span class="ident" id="4380577">stateText</span>&nbsp;<span class="op" id="4380587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380591">return</span>&nbsp;<span class="ident" id="4380598">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380612">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380615">s</span>&nbsp;<span class="op" id="4380617">:=</span>&nbsp;<span class="ident" id="4380620">templateName</span>&nbsp;<span class="op" id="4380633">+</span>&nbsp;<span class="string" id="4380635">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="4380652">+</span>&nbsp;<span class="ident" id="4380654">c</span><span class="op" id="4380655">.</span><span class="ident" id="4380656">state</span><span class="op" id="4380661">.</span><span class="ident" id="4380662">String</span><span class="op" id="4380668">(</span><span class="op" id="4380669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380672">if</span>&nbsp;<span class="ident" id="4380675">c</span><span class="op" id="4380676">.</span><span class="ident" id="4380677">delim</span>&nbsp;<span class="op" id="4380683">!=</span>&nbsp;<span class="num" id="4380686">0</span>&nbsp;<span class="op" id="4380688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380692">s</span>&nbsp;<span class="op" id="4380694">+=</span>&nbsp;<span class="string" id="4380697">&#34;_&#34;</span>&nbsp;<span class="op" id="4380701">+</span>&nbsp;<span class="ident" id="4380703">c</span><span class="op" id="4380704">.</span><span class="ident" id="4380705">delim</span><span class="op" id="4380710">.</span><span class="ident" id="4380711">String</span><span class="op" id="4380717">(</span><span class="op" id="4380718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380724">if</span>&nbsp;<span class="ident" id="4380727">c</span><span class="op" id="4380728">.</span><span class="ident" id="4380729">urlPart</span>&nbsp;<span class="op" id="4380737">!=</span>&nbsp;<span class="num" id="4380740">0</span>&nbsp;<span class="op" id="4380742">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380746">s</span>&nbsp;<span class="op" id="4380748">+=</span>&nbsp;<span class="string" id="4380751">&#34;_&#34;</span>&nbsp;<span class="op" id="4380755">+</span>&nbsp;<span class="ident" id="4380757">c</span><span class="op" id="4380758">.</span><span class="ident" id="4380759">urlPart</span><span class="op" id="4380766">.</span><span class="ident" id="4380767">String</span><span class="op" id="4380773">(</span><span class="op" id="4380774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380780">if</span>&nbsp;<span class="ident" id="4380783">c</span><span class="op" id="4380784">.</span><span class="ident" id="4380785">jsCtx</span>&nbsp;<span class="op" id="4380791">!=</span>&nbsp;<span class="num" id="4380794">0</span>&nbsp;<span class="op" id="4380796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380800">s</span>&nbsp;<span class="op" id="4380802">+=</span>&nbsp;<span class="string" id="4380805">&#34;_&#34;</span>&nbsp;<span class="op" id="4380809">+</span>&nbsp;<span class="ident" id="4380811">c</span><span class="op" id="4380812">.</span><span class="ident" id="4380813">jsCtx</span><span class="op" id="4380818">.</span><span class="ident" id="4380819">String</span><span class="op" id="4380825">(</span><span class="op" id="4380826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380829">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380832">if</span>&nbsp;<span class="ident" id="4380835">c</span><span class="op" id="4380836">.</span><span class="ident" id="4380837">attr</span>&nbsp;<span class="op" id="4380842">!=</span>&nbsp;<span class="num" id="4380845">0</span>&nbsp;<span class="op" id="4380847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380851">s</span>&nbsp;<span class="op" id="4380853">+=</span>&nbsp;<span class="string" id="4380856">&#34;_&#34;</span>&nbsp;<span class="op" id="4380860">+</span>&nbsp;<span class="ident" id="4380862">c</span><span class="op" id="4380863">.</span><span class="ident" id="4380864">attr</span><span class="op" id="4380868">.</span><span class="ident" id="4380869">String</span><span class="op" id="4380875">(</span><span class="op" id="4380876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380882">if</span>&nbsp;<span class="ident" id="4380885">c</span><span class="op" id="4380886">.</span><span class="ident" id="4380887">element</span>&nbsp;<span class="op" id="4380895">!=</span>&nbsp;<span class="num" id="4380898">0</span>&nbsp;<span class="op" id="4380900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380904">s</span>&nbsp;<span class="op" id="4380906">+=</span>&nbsp;<span class="string" id="4380909">&#34;_&#34;</span>&nbsp;<span class="op" id="4380913">+</span>&nbsp;<span class="ident" id="4380915">c</span><span class="op" id="4380916">.</span><span class="ident" id="4380917">element</span><span class="op" id="4380924">.</span><span class="ident" id="4380925">String</span><span class="op" id="4380931">(</span><span class="op" id="4380932">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380938">return</span>&nbsp;<span class="ident" id="4380945">s</span><br>
<span class="lineno"></span><span class="op" id="4380947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380950">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="4381001">//</span><br>
<span class="lineno"></span><span class="comment" id="4381004">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="4381083">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4381160">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="4381233">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="4381313">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4381343">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4381381">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4381459">type</span>&nbsp;<span class="ident" id="4381464">state</span>&nbsp;<span class="builtintype" id="4381470">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4381477">const</span>&nbsp;<span class="op" id="4381483">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381486">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381547">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381610">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381660">stateText</span>&nbsp;<span class="ident" id="4381670">state</span>&nbsp;<span class="op" id="4381676">=</span>&nbsp;<span class="ident" id="4381678">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381684">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381750">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381760">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381811">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381863">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381878">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381948">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382013">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382029">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382101">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382153">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382171">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382228">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382242">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382314">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382384">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382397">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382466">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382477">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382546">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382556">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382618">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382627">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382693">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382707">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382773">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382787">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382848">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382863">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382931">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382948">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383011">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383027">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383092">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383102">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383162">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383177">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383237">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383252">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383316">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383331">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383395">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383410">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383465">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383478">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383540">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383558">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383615">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383632">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383694">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383721">stateError</span><br>
<span class="lineno"></span><span class="op" id="4383732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383735">var</span>&nbsp;<span class="ident" id="4383739">stateNames</span>&nbsp;<span class="op" id="4383750">=</span>&nbsp;<span class="op" id="4383752">[</span><span class="op" id="4383753">...</span><span class="op" id="4383756">]</span><span class="builtintype" id="4383757">string</span><span class="op" id="4383763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383766">stateText</span><span class="op" id="4383775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4383784">&#34;stateText&#34;</span><span class="op" id="4383795">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383798">stateTag</span><span class="op" id="4383806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4383816">&#34;stateTag&#34;</span><span class="op" id="4383826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383829">stateAttrName</span><span class="op" id="4383842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4383847">&#34;stateAttrName&#34;</span><span class="op" id="4383862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383865">stateAfterName</span><span class="op" id="4383879">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4383883">&#34;stateAfterName&#34;</span><span class="op" id="4383899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383902">stateBeforeValue</span><span class="op" id="4383918">:</span>&nbsp;<span class="string" id="4383920">&#34;stateBeforeValue&#34;</span><span class="op" id="4383938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383941">stateHTMLCmt</span><span class="op" id="4383953">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4383959">&#34;stateHTMLCmt&#34;</span><span class="op" id="4383973">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383976">stateRCDATA</span><span class="op" id="4383987">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4383994">&#34;stateRCDATA&#34;</span><span class="op" id="4384007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384010">stateAttr</span><span class="op" id="4384019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384028">&#34;stateAttr&#34;</span><span class="op" id="4384039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384042">stateURL</span><span class="op" id="4384050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384060">&#34;stateURL&#34;</span><span class="op" id="4384070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384073">stateJS</span><span class="op" id="4384080">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384091">&#34;stateJS&#34;</span><span class="op" id="4384100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384103">stateJSDqStr</span><span class="op" id="4384115">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384121">&#34;stateJSDqStr&#34;</span><span class="op" id="4384135">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384138">stateJSSqStr</span><span class="op" id="4384150">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384156">&#34;stateJSSqStr&#34;</span><span class="op" id="4384170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384173">stateJSRegexp</span><span class="op" id="4384186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384191">&#34;stateJSRegexp&#34;</span><span class="op" id="4384206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384209">stateJSBlockCmt</span><span class="op" id="4384224">:</span>&nbsp;&nbsp;<span class="string" id="4384227">&#34;stateJSBlockCmt&#34;</span><span class="op" id="4384244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384247">stateJSLineCmt</span><span class="op" id="4384261">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4384265">&#34;stateJSLineCmt&#34;</span><span class="op" id="4384281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384284">stateCSS</span><span class="op" id="4384292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384302">&#34;stateCSS&#34;</span><span class="op" id="4384312">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384315">stateCSSDqStr</span><span class="op" id="4384328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384333">&#34;stateCSSDqStr&#34;</span><span class="op" id="4384348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384351">stateCSSSqStr</span><span class="op" id="4384364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384369">&#34;stateCSSSqStr&#34;</span><span class="op" id="4384384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384387">stateCSSDqURL</span><span class="op" id="4384400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384405">&#34;stateCSSDqURL&#34;</span><span class="op" id="4384420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384423">stateCSSSqURL</span><span class="op" id="4384436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384441">&#34;stateCSSSqURL&#34;</span><span class="op" id="4384456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384459">stateCSSURL</span><span class="op" id="4384470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384477">&#34;stateCSSURL&#34;</span><span class="op" id="4384490">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384493">stateCSSBlockCmt</span><span class="op" id="4384509">:</span>&nbsp;<span class="string" id="4384511">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="4384529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384532">stateCSSLineCmt</span><span class="op" id="4384547">:</span>&nbsp;&nbsp;<span class="string" id="4384550">&#34;stateCSSLineCmt&#34;</span><span class="op" id="4384567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384570">stateError</span><span class="op" id="4384580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4384588">&#34;stateError&#34;</span><span class="op" id="4384600">,</span><br>
<span class="lineno"></span><span class="op" id="4384602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="4384605">func</span>&nbsp;<span class="op" id="4384610">(</span><span class="ident" id="4384611">s</span>&nbsp;<span class="ident" id="4384613">state</span><span class="op" id="4384618">)</span>&nbsp;<span class="ident" id="4384620">String</span><span class="op" id="4384626">(</span><span class="op" id="4384627">)</span>&nbsp;<span class="builtintype" id="4384629">string</span>&nbsp;<span class="op" id="4384636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384639">if</span>&nbsp;<span class="builtintype" id="4384642">int</span><span class="op" id="4384645">(</span><span class="ident" id="4384646">s</span><span class="op" id="4384647">)</span>&nbsp;<span class="op" id="4384649">&lt;</span>&nbsp;<span class="builtinfunc" id="4384651">len</span><span class="op" id="4384654">(</span><span class="ident" id="4384655">stateNames</span><span class="op" id="4384665">)</span>&nbsp;<span class="op" id="4384667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384671">return</span>&nbsp;<span class="ident" id="4384678">stateNames</span><span class="op" id="4384688">[</span><span class="ident" id="4384689">s</span><span class="op" id="4384690">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384696">return</span>&nbsp;<span class="ident" id="4384703">fmt</span><span class="op" id="4384706">.</span><span class="ident" id="4384707">Sprintf</span><span class="op" id="4384714">(</span><span class="string" id="4384715">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="4384733">,</span>&nbsp;<span class="builtintype" id="4384735">int</span><span class="op" id="4384738">(</span><span class="ident" id="4384739">s</span><span class="op" id="4384740">)</span><span class="op" id="4384741">)</span><br>
<span class="lineno">170</span><span class="op" id="4384743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4384746">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4384822">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="4384879">func</span>&nbsp;<span class="ident" id="4384884">isComment</span><span class="op" id="4384893">(</span><span class="ident" id="4384894">s</span>&nbsp;<span class="ident" id="4384896">state</span><span class="op" id="4384901">)</span>&nbsp;<span class="builtintype" id="4384903">bool</span>&nbsp;<span class="op" id="4384908">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384911">switch</span>&nbsp;<span class="ident" id="4384918">s</span>&nbsp;<span class="op" id="4384920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384923">case</span>&nbsp;<span class="ident" id="4384928">stateHTMLCmt</span><span class="op" id="4384940">,</span>&nbsp;<span class="ident" id="4384942">stateJSBlockCmt</span><span class="op" id="4384957">,</span>&nbsp;<span class="ident" id="4384959">stateJSLineCmt</span><span class="op" id="4384973">,</span>&nbsp;<span class="ident" id="4384975">stateCSSBlockCmt</span><span class="op" id="4384991">,</span>&nbsp;<span class="ident" id="4384993">stateCSSLineCmt</span><span class="op" id="4385008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385012">return</span>&nbsp;<span class="ident" id="4385019">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385028">return</span>&nbsp;<span class="ident" id="4385035">false</span><br>
<span class="lineno">180</span><span class="op" id="4385041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385044">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4385106">func</span>&nbsp;<span class="ident" id="4385111">isInTag</span><span class="op" id="4385118">(</span><span class="ident" id="4385119">s</span>&nbsp;<span class="ident" id="4385121">state</span><span class="op" id="4385126">)</span>&nbsp;<span class="builtintype" id="4385128">bool</span>&nbsp;<span class="op" id="4385133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385136">switch</span>&nbsp;<span class="ident" id="4385143">s</span>&nbsp;<span class="op" id="4385145">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385148">case</span>&nbsp;<span class="ident" id="4385153">stateTag</span><span class="op" id="4385161">,</span>&nbsp;<span class="ident" id="4385163">stateAttrName</span><span class="op" id="4385176">,</span>&nbsp;<span class="ident" id="4385178">stateAfterName</span><span class="op" id="4385192">,</span>&nbsp;<span class="ident" id="4385194">stateBeforeValue</span><span class="op" id="4385210">,</span>&nbsp;<span class="ident" id="4385212">stateAttr</span><span class="op" id="4385221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385225">return</span>&nbsp;<span class="ident" id="4385232">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385241">return</span>&nbsp;<span class="ident" id="4385248">false</span><br>
<span class="lineno"></span><span class="op" id="4385254">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4385257">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="4385325">type</span>&nbsp;<span class="ident" id="4385330">delim</span>&nbsp;<span class="builtintype" id="4385336">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4385343">const</span>&nbsp;<span class="op" id="4385349">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385352">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385396">delimNone</span>&nbsp;<span class="ident" id="4385406">delim</span>&nbsp;<span class="op" id="4385412">=</span>&nbsp;<span class="ident" id="4385414">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385420">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385494">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385512">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385586">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385604">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385674">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385700">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="4385719">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4385722">var</span>&nbsp;<span class="ident" id="4385726">delimNames</span>&nbsp;<span class="op" id="4385737">=</span>&nbsp;<span class="op" id="4385739">[</span><span class="op" id="4385740">...</span><span class="op" id="4385743">]</span><span class="builtintype" id="4385744">string</span><span class="op" id="4385750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385753">delimNone</span><span class="op" id="4385762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4385773">&#34;delimNone&#34;</span><span class="op" id="4385784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385787">delimDoubleQuote</span><span class="op" id="4385803">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4385807">&#34;delimDoubleQuote&#34;</span><span class="op" id="4385825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385828">delimSingleQuote</span><span class="op" id="4385844">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4385848">&#34;delimSingleQuote&#34;</span><span class="op" id="4385866">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385869">delimSpaceOrTagEnd</span><span class="op" id="4385887">:</span>&nbsp;<span class="string" id="4385889">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="4385909">,</span><br>
<span class="lineno"></span><span class="op" id="4385911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4385914">func</span>&nbsp;<span class="op" id="4385919">(</span><span class="ident" id="4385920">d</span>&nbsp;<span class="ident" id="4385922">delim</span><span class="op" id="4385927">)</span>&nbsp;<span class="ident" id="4385929">String</span><span class="op" id="4385935">(</span><span class="op" id="4385936">)</span>&nbsp;<span class="builtintype" id="4385938">string</span>&nbsp;<span class="op" id="4385945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385948">if</span>&nbsp;<span class="builtintype" id="4385951">int</span><span class="op" id="4385954">(</span><span class="ident" id="4385955">d</span><span class="op" id="4385956">)</span>&nbsp;<span class="op" id="4385958">&lt;</span>&nbsp;<span class="builtinfunc" id="4385960">len</span><span class="op" id="4385963">(</span><span class="ident" id="4385964">delimNames</span><span class="op" id="4385974">)</span>&nbsp;<span class="op" id="4385976">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385980">return</span>&nbsp;<span class="ident" id="4385987">delimNames</span><span class="op" id="4385997">[</span><span class="ident" id="4385998">d</span><span class="op" id="4385999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386005">return</span>&nbsp;<span class="ident" id="4386012">fmt</span><span class="op" id="4386015">.</span><span class="ident" id="4386016">Sprintf</span><span class="op" id="4386023">(</span><span class="string" id="4386024">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="4386042">,</span>&nbsp;<span class="builtintype" id="4386044">int</span><span class="op" id="4386047">(</span><span class="ident" id="4386048">d</span><span class="op" id="4386049">)</span><span class="op" id="4386050">)</span><br>
<span class="lineno"></span><span class="op" id="4386052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="4386055">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4386135">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="4386159">type</span>&nbsp;<span class="ident" id="4386164">urlPart</span>&nbsp;<span class="builtintype" id="4386172">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4386179">const</span>&nbsp;<span class="op" id="4386185">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386188">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386256">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386295">urlPartNone</span>&nbsp;<span class="ident" id="4386307">urlPart</span>&nbsp;<span class="op" id="4386315">=</span>&nbsp;<span class="ident" id="4386317">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386323">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386397">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386438">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386455">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386524">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386559">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386579">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386648">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386679">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="4386694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4386697">var</span>&nbsp;<span class="ident" id="4386701">urlPartNames</span>&nbsp;<span class="op" id="4386714">=</span>&nbsp;<span class="op" id="4386716">[</span><span class="op" id="4386717">...</span><span class="op" id="4386720">]</span><span class="builtintype" id="4386721">string</span><span class="op" id="4386727">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386730">urlPartNone</span><span class="op" id="4386741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4386750">&#34;urlPartNone&#34;</span><span class="op" id="4386763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386766">urlPartPreQuery</span><span class="op" id="4386781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4386786">&#34;urlPartPreQuery&#34;</span><span class="op" id="4386803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386806">urlPartQueryOrFrag</span><span class="op" id="4386824">:</span>&nbsp;<span class="string" id="4386826">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="4386846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386849">urlPartUnknown</span><span class="op" id="4386863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4386869">&#34;urlPartUnknown&#34;</span><span class="op" id="4386885">,</span><br>
<span class="lineno"></span><span class="op" id="4386887">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4386890">func</span>&nbsp;<span class="op" id="4386895">(</span><span class="ident" id="4386896">u</span>&nbsp;<span class="ident" id="4386898">urlPart</span><span class="op" id="4386905">)</span>&nbsp;<span class="ident" id="4386907">String</span><span class="op" id="4386913">(</span><span class="op" id="4386914">)</span>&nbsp;<span class="builtintype" id="4386916">string</span>&nbsp;<span class="op" id="4386923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386926">if</span>&nbsp;<span class="builtintype" id="4386929">int</span><span class="op" id="4386932">(</span><span class="ident" id="4386933">u</span><span class="op" id="4386934">)</span>&nbsp;<span class="op" id="4386936">&lt;</span>&nbsp;<span class="builtinfunc" id="4386938">len</span><span class="op" id="4386941">(</span><span class="ident" id="4386942">urlPartNames</span><span class="op" id="4386954">)</span>&nbsp;<span class="op" id="4386956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386960">return</span>&nbsp;<span class="ident" id="4386967">urlPartNames</span><span class="op" id="4386979">[</span><span class="ident" id="4386980">u</span><span class="op" id="4386981">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386984">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386987">return</span>&nbsp;<span class="ident" id="4386994">fmt</span><span class="op" id="4386997">.</span><span class="ident" id="4386998">Sprintf</span><span class="op" id="4387005">(</span><span class="string" id="4387006">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="4387026">,</span>&nbsp;<span class="builtintype" id="4387028">int</span><span class="op" id="4387031">(</span><span class="ident" id="4387032">u</span><span class="op" id="4387033">)</span><span class="op" id="4387034">)</span><br>
<span class="lineno"></span><span class="op" id="4387036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4387039">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4387114">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="4387136">type</span>&nbsp;<span class="ident" id="4387141">jsCtx</span>&nbsp;<span class="builtintype" id="4387147">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4387154">const</span>&nbsp;<span class="op" id="4387160">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387163">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387228">jsCtxRegexp</span>&nbsp;<span class="ident" id="4387240">jsCtx</span>&nbsp;<span class="op" id="4387246">=</span>&nbsp;<span class="ident" id="4387248">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387254">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387321">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387333">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387406">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="4387419">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4387422">func</span>&nbsp;<span class="op" id="4387427">(</span><span class="ident" id="4387428">c</span>&nbsp;<span class="ident" id="4387430">jsCtx</span><span class="op" id="4387435">)</span>&nbsp;<span class="ident" id="4387437">String</span><span class="op" id="4387443">(</span><span class="op" id="4387444">)</span>&nbsp;<span class="builtintype" id="4387446">string</span>&nbsp;<span class="op" id="4387453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387456">switch</span>&nbsp;<span class="ident" id="4387463">c</span>&nbsp;<span class="op" id="4387465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387468">case</span>&nbsp;<span class="ident" id="4387473">jsCtxRegexp</span><span class="op" id="4387484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387488">return</span>&nbsp;<span class="string" id="4387495">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387510">case</span>&nbsp;<span class="ident" id="4387515">jsCtxDivOp</span><span class="op" id="4387525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387529">return</span>&nbsp;<span class="string" id="4387536">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387550">case</span>&nbsp;<span class="ident" id="4387555">jsCtxUnknown</span><span class="op" id="4387567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387571">return</span>&nbsp;<span class="string" id="4387578">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387594">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387597">return</span>&nbsp;<span class="ident" id="4387604">fmt</span><span class="op" id="4387607">.</span><span class="ident" id="4387608">Sprintf</span><span class="op" id="4387615">(</span><span class="string" id="4387616">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="4387634">,</span>&nbsp;<span class="builtintype" id="4387636">int</span><span class="op" id="4387639">(</span><span class="ident" id="4387640">c</span><span class="op" id="4387641">)</span><span class="op" id="4387642">)</span><br>
<span class="lineno"></span><span class="op" id="4387644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4387647">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="4387727">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="4387807">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4387881">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4387960">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4387991">type</span>&nbsp;<span class="ident" id="4387996">element</span>&nbsp;<span class="builtintype" id="4388004">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4388011">const</span>&nbsp;<span class="op" id="4388017">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388020">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388090">elementNone</span>&nbsp;<span class="ident" id="4388102">element</span>&nbsp;<span class="op" id="4388110">=</span>&nbsp;<span class="ident" id="4388112">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388118">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388182">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388197">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388259">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388273">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388339">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388356">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388416">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="4388429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4388432">var</span>&nbsp;<span class="ident" id="4388436">elementNames</span>&nbsp;<span class="op" id="4388449">=</span>&nbsp;<span class="op" id="4388451">[</span><span class="op" id="4388452">...</span><span class="op" id="4388455">]</span><span class="builtintype" id="4388456">string</span><span class="op" id="4388462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388465">elementNone</span><span class="op" id="4388476">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4388482">&#34;elementNone&#34;</span><span class="op" id="4388495">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388498">elementScript</span><span class="op" id="4388511">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4388515">&#34;elementScript&#34;</span><span class="op" id="4388530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388533">elementStyle</span><span class="op" id="4388545">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4388550">&#34;elementStyle&#34;</span><span class="op" id="4388564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388567">elementTextarea</span><span class="op" id="4388582">:</span>&nbsp;<span class="string" id="4388584">&#34;elementTextarea&#34;</span><span class="op" id="4388601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388604">elementTitle</span><span class="op" id="4388616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4388621">&#34;elementTitle&#34;</span><span class="op" id="4388635">,</span><br>
<span class="lineno"></span><span class="op" id="4388637">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="4388640">func</span>&nbsp;<span class="op" id="4388645">(</span><span class="ident" id="4388646">e</span>&nbsp;<span class="ident" id="4388648">element</span><span class="op" id="4388655">)</span>&nbsp;<span class="ident" id="4388657">String</span><span class="op" id="4388663">(</span><span class="op" id="4388664">)</span>&nbsp;<span class="builtintype" id="4388666">string</span>&nbsp;<span class="op" id="4388673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388676">if</span>&nbsp;<span class="builtintype" id="4388679">int</span><span class="op" id="4388682">(</span><span class="ident" id="4388683">e</span><span class="op" id="4388684">)</span>&nbsp;<span class="op" id="4388686">&lt;</span>&nbsp;<span class="builtinfunc" id="4388688">len</span><span class="op" id="4388691">(</span><span class="ident" id="4388692">elementNames</span><span class="op" id="4388704">)</span>&nbsp;<span class="op" id="4388706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388710">return</span>&nbsp;<span class="ident" id="4388717">elementNames</span><span class="op" id="4388729">[</span><span class="ident" id="4388730">e</span><span class="op" id="4388731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388734">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388737">return</span>&nbsp;<span class="ident" id="4388744">fmt</span><span class="op" id="4388747">.</span><span class="ident" id="4388748">Sprintf</span><span class="op" id="4388755">(</span><span class="string" id="4388756">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="4388776">,</span>&nbsp;<span class="builtintype" id="4388778">int</span><span class="op" id="4388781">(</span><span class="ident" id="4388782">e</span><span class="op" id="4388783">)</span><span class="op" id="4388784">)</span><br>
<span class="lineno"></span><span class="op" id="4388786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4388789">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4388864">type</span>&nbsp;<span class="ident" id="4388869">attr</span>&nbsp;<span class="builtintype" id="4388874">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4388881">const</span>&nbsp;<span class="op" id="4388887">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388890">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388954">attrNone</span>&nbsp;<span class="ident" id="4388963">attr</span>&nbsp;<span class="op" id="4388968">=</span>&nbsp;<span class="ident" id="4388970">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4388976">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389034">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389046">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389115">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389126">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389188">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="4389196">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389199">var</span>&nbsp;<span class="ident" id="4389203">attrNames</span>&nbsp;<span class="op" id="4389213">=</span>&nbsp;<span class="op" id="4389215">[</span><span class="op" id="4389216">...</span><span class="op" id="4389219">]</span><span class="builtintype" id="4389220">string</span><span class="op" id="4389226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389229">attrNone</span><span class="op" id="4389237">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4389241">&#34;attrNone&#34;</span><span class="op" id="4389251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389254">attrScript</span><span class="op" id="4389264">:</span>&nbsp;<span class="string" id="4389266">&#34;attrScript&#34;</span><span class="op" id="4389278">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389281">attrStyle</span><span class="op" id="4389290">:</span>&nbsp;&nbsp;<span class="string" id="4389293">&#34;attrStyle&#34;</span><span class="op" id="4389304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389307">attrURL</span><span class="op" id="4389314">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4389319">&#34;attrURL&#34;</span><span class="op" id="4389328">,</span><br>
<span class="lineno"></span><span class="op" id="4389330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389333">func</span>&nbsp;<span class="op" id="4389338">(</span><span class="ident" id="4389339">a</span>&nbsp;<span class="ident" id="4389341">attr</span><span class="op" id="4389345">)</span>&nbsp;<span class="ident" id="4389347">String</span><span class="op" id="4389353">(</span><span class="op" id="4389354">)</span>&nbsp;<span class="builtintype" id="4389356">string</span>&nbsp;<span class="op" id="4389363">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389366">if</span>&nbsp;<span class="builtintype" id="4389369">int</span><span class="op" id="4389372">(</span><span class="ident" id="4389373">a</span><span class="op" id="4389374">)</span>&nbsp;<span class="op" id="4389376">&lt;</span>&nbsp;<span class="builtinfunc" id="4389378">len</span><span class="op" id="4389381">(</span><span class="ident" id="4389382">attrNames</span><span class="op" id="4389391">)</span>&nbsp;<span class="op" id="4389393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389397">return</span>&nbsp;<span class="ident" id="4389404">attrNames</span><span class="op" id="4389413">[</span><span class="ident" id="4389414">a</span><span class="op" id="4389415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389421">return</span>&nbsp;<span class="ident" id="4389428">fmt</span><span class="op" id="4389431">.</span><span class="ident" id="4389432">Sprintf</span><span class="op" id="4389439">(</span><span class="string" id="4389440">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="4389457">,</span>&nbsp;<span class="builtintype" id="4389459">int</span><span class="op" id="4389462">(</span><span class="ident" id="4389463">a</span><span class="op" id="4389464">)</span><span class="op" id="4389465">)</span><br>
<span class="lineno"></span><span class="op" id="4389467">}</span>
</div>
</body>
</html>
