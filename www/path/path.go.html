<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3865185">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3865240">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3865294">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3865345">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="3865422">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3865432">package</span>&nbsp;<span class="ident" id="3865440">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865446">import</span>&nbsp;<span class="op" id="3865453">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3865456">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3865466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3865469">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3865519">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="3865577">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3865643">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3865700">type</span>&nbsp;<span class="ident" id="3865705">lazybuf</span>&nbsp;<span class="keyword" id="3865713">struct</span>&nbsp;<span class="op" id="3865720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865723">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3865727">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865735">buf</span>&nbsp;<span class="op" id="3865739">[</span><span class="op" id="3865740">]</span><span class="builtintype" id="3865741">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865747">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3865751">int</span><br>
<span class="lineno"></span><span class="op" id="3865755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865758">func</span>&nbsp;<span class="op" id="3865763">(</span><span class="ident" id="3865764">b</span>&nbsp;<span class="op" id="3865766">*</span><span class="ident" id="3865767">lazybuf</span><span class="op" id="3865774">)</span>&nbsp;<span class="ident" id="3865776">index</span><span class="op" id="3865781">(</span><span class="ident" id="3865782">i</span>&nbsp;<span class="builtintype" id="3865784">int</span><span class="op" id="3865787">)</span>&nbsp;<span class="builtintype" id="3865789">byte</span>&nbsp;<span class="op" id="3865794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865797">if</span>&nbsp;<span class="ident" id="3865800">b</span><span class="op" id="3865801">.</span><span class="ident" id="3865802">buf</span>&nbsp;<span class="op" id="3865806">!=</span>&nbsp;<span class="ident" id="3865809">nil</span>&nbsp;<span class="op" id="3865813">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865817">return</span>&nbsp;<span class="ident" id="3865824">b</span><span class="op" id="3865825">.</span><span class="ident" id="3865826">buf</span><span class="op" id="3865829">[</span><span class="ident" id="3865830">i</span><span class="op" id="3865831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865837">return</span>&nbsp;<span class="ident" id="3865844">b</span><span class="op" id="3865845">.</span><span class="ident" id="3865846">s</span><span class="op" id="3865847">[</span><span class="ident" id="3865848">i</span><span class="op" id="3865849">]</span><br>
<span class="lineno"></span><span class="op" id="3865851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3865854">func</span>&nbsp;<span class="op" id="3865859">(</span><span class="ident" id="3865860">b</span>&nbsp;<span class="op" id="3865862">*</span><span class="ident" id="3865863">lazybuf</span><span class="op" id="3865870">)</span>&nbsp;<span class="builtinfunc" id="3865872">append</span><span class="op" id="3865878">(</span><span class="ident" id="3865879">c</span>&nbsp;<span class="builtintype" id="3865881">byte</span><span class="op" id="3865885">)</span>&nbsp;<span class="op" id="3865887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865890">if</span>&nbsp;<span class="ident" id="3865893">b</span><span class="op" id="3865894">.</span><span class="ident" id="3865895">buf</span>&nbsp;<span class="op" id="3865899">==</span>&nbsp;<span class="ident" id="3865902">nil</span>&nbsp;<span class="op" id="3865906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865910">if</span>&nbsp;<span class="ident" id="3865913">b</span><span class="op" id="3865914">.</span><span class="ident" id="3865915">w</span>&nbsp;<span class="op" id="3865917">&lt;</span>&nbsp;<span class="builtinfunc" id="3865919">len</span><span class="op" id="3865922">(</span><span class="ident" id="3865923">b</span><span class="op" id="3865924">.</span><span class="ident" id="3865925">s</span><span class="op" id="3865926">)</span>&nbsp;<span class="op" id="3865928">&amp;&amp;</span>&nbsp;<span class="ident" id="3865931">b</span><span class="op" id="3865932">.</span><span class="ident" id="3865933">s</span><span class="op" id="3865934">[</span><span class="ident" id="3865935">b</span><span class="op" id="3865936">.</span><span class="ident" id="3865937">w</span><span class="op" id="3865938">]</span>&nbsp;<span class="op" id="3865940">==</span>&nbsp;<span class="ident" id="3865943">c</span>&nbsp;<span class="op" id="3865945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865950">b</span><span class="op" id="3865951">.</span><span class="ident" id="3865952">w</span><span class="op" id="3865953">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865959">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865972">b</span><span class="op" id="3865973">.</span><span class="ident" id="3865974">buf</span>&nbsp;<span class="op" id="3865978">=</span>&nbsp;<span class="builtinfunc" id="3865980">make</span><span class="op" id="3865984">(</span><span class="op" id="3865985">[</span><span class="op" id="3865986">]</span><span class="builtintype" id="3865987">byte</span><span class="op" id="3865991">,</span>&nbsp;<span class="builtinfunc" id="3865993">len</span><span class="op" id="3865996">(</span><span class="ident" id="3865997">b</span><span class="op" id="3865998">.</span><span class="ident" id="3865999">s</span><span class="op" id="3866000">)</span><span class="op" id="3866001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3866005">copy</span><span class="op" id="3866009">(</span><span class="ident" id="3866010">b</span><span class="op" id="3866011">.</span><span class="ident" id="3866012">buf</span><span class="op" id="3866015">,</span>&nbsp;<span class="ident" id="3866017">b</span><span class="op" id="3866018">.</span><span class="ident" id="3866019">s</span><span class="op" id="3866020">[</span><span class="op" id="3866021">:</span><span class="ident" id="3866022">b</span><span class="op" id="3866023">.</span><span class="ident" id="3866024">w</span><span class="op" id="3866025">]</span><span class="op" id="3866026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866032">b</span><span class="op" id="3866033">.</span><span class="ident" id="3866034">buf</span><span class="op" id="3866037">[</span><span class="ident" id="3866038">b</span><span class="op" id="3866039">.</span><span class="ident" id="3866040">w</span><span class="op" id="3866041">]</span>&nbsp;<span class="op" id="3866043">=</span>&nbsp;<span class="ident" id="3866045">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866048">b</span><span class="op" id="3866049">.</span><span class="ident" id="3866050">w</span><span class="op" id="3866051">++</span><br>
<span class="lineno"></span><span class="op" id="3866054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866057">func</span>&nbsp;<span class="op" id="3866062">(</span><span class="ident" id="3866063">b</span>&nbsp;<span class="op" id="3866065">*</span><span class="ident" id="3866066">lazybuf</span><span class="op" id="3866073">)</span>&nbsp;<span class="builtintype" id="3866075">string</span><span class="op" id="3866081">(</span><span class="op" id="3866082">)</span>&nbsp;<span class="builtintype" id="3866084">string</span>&nbsp;<span class="op" id="3866091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866094">if</span>&nbsp;<span class="ident" id="3866097">b</span><span class="op" id="3866098">.</span><span class="ident" id="3866099">buf</span>&nbsp;<span class="op" id="3866103">==</span>&nbsp;<span class="ident" id="3866106">nil</span>&nbsp;<span class="op" id="3866110">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866114">return</span>&nbsp;<span class="ident" id="3866121">b</span><span class="op" id="3866122">.</span><span class="ident" id="3866123">s</span><span class="op" id="3866124">[</span><span class="op" id="3866125">:</span><span class="ident" id="3866126">b</span><span class="op" id="3866127">.</span><span class="ident" id="3866128">w</span><span class="op" id="3866129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866135">return</span>&nbsp;<span class="builtintype" id="3866142">string</span><span class="op" id="3866148">(</span><span class="ident" id="3866149">b</span><span class="op" id="3866150">.</span><span class="ident" id="3866151">buf</span><span class="op" id="3866154">[</span><span class="op" id="3866155">:</span><span class="ident" id="3866156">b</span><span class="op" id="3866157">.</span><span class="ident" id="3866158">w</span><span class="op" id="3866159">]</span><span class="op" id="3866160">)</span><br>
<span class="lineno"></span><span class="op" id="3866162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3866165">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3866224">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3866289">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3866345">//</span><br>
<span class="lineno"></span><span class="comment" id="3866348">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="3866400">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3866466">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3866537">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3866591">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3866645">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="3866709">//</span><br>
<span class="lineno"></span><span class="comment" id="3866712">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3866777">//</span><br>
<span class="lineno"></span><span class="comment" id="3866780">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3866839">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="3866866">//</span><br>
<span class="lineno"></span><span class="comment" id="3866869">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3866925">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3866953">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3867005">func</span>&nbsp;<span class="ident" id="3867010">Clean</span><span class="op" id="3867015">(</span><span class="ident" id="3867016">path</span>&nbsp;<span class="builtintype" id="3867021">string</span><span class="op" id="3867027">)</span>&nbsp;<span class="builtintype" id="3867029">string</span>&nbsp;<span class="op" id="3867036">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867039">if</span>&nbsp;<span class="ident" id="3867042">path</span>&nbsp;<span class="op" id="3867047">==</span>&nbsp;<span class="string" id="3867050">&#34;&#34;</span>&nbsp;<span class="op" id="3867053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867057">return</span>&nbsp;<span class="string" id="3867064">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867073">rooted</span>&nbsp;<span class="op" id="3867080">:=</span>&nbsp;<span class="ident" id="3867083">path</span><span class="op" id="3867087">[</span><span class="num" id="3867088">0</span><span class="op" id="3867089">]</span>&nbsp;<span class="op" id="3867091">==</span>&nbsp;<span class="string" id="3867094">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867099">n</span>&nbsp;<span class="op" id="3867101">:=</span>&nbsp;<span class="builtinfunc" id="3867104">len</span><span class="op" id="3867107">(</span><span class="ident" id="3867108">path</span><span class="op" id="3867112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867116">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867132">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867191">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867245">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867307">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867372">out</span>&nbsp;<span class="op" id="3867376">:=</span>&nbsp;<span class="ident" id="3867379">lazybuf</span><span class="op" id="3867386">{</span><span class="ident" id="3867387">s</span><span class="op" id="3867388">:</span>&nbsp;<span class="ident" id="3867390">path</span><span class="op" id="3867394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867397">r</span><span class="op" id="3867398">,</span>&nbsp;<span class="ident" id="3867400">dotdot</span>&nbsp;<span class="op" id="3867407">:=</span>&nbsp;<span class="num" id="3867410">0</span><span class="op" id="3867411">,</span>&nbsp;<span class="num" id="3867413">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867416">if</span>&nbsp;<span class="ident" id="3867419">rooted</span>&nbsp;<span class="op" id="3867426">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867430">out</span><span class="op" id="3867433">.</span><span class="builtinfunc" id="3867434">append</span><span class="op" id="3867440">(</span><span class="string" id="3867441">&#39;/&#39;</span><span class="op" id="3867444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867448">r</span><span class="op" id="3867449">,</span>&nbsp;<span class="ident" id="3867451">dotdot</span>&nbsp;<span class="op" id="3867458">=</span>&nbsp;<span class="num" id="3867460">1</span><span class="op" id="3867461">,</span>&nbsp;<span class="num" id="3867463">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867470">for</span>&nbsp;<span class="ident" id="3867474">r</span>&nbsp;<span class="op" id="3867476">&lt;</span>&nbsp;<span class="ident" id="3867478">n</span>&nbsp;<span class="op" id="3867480">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867484">switch</span>&nbsp;<span class="op" id="3867491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867495">case</span>&nbsp;<span class="ident" id="3867500">path</span><span class="op" id="3867504">[</span><span class="ident" id="3867505">r</span><span class="op" id="3867506">]</span>&nbsp;<span class="op" id="3867508">==</span>&nbsp;<span class="string" id="3867511">&#39;/&#39;</span><span class="op" id="3867514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867519">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867544">r</span><span class="op" id="3867545">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867550">case</span>&nbsp;<span class="ident" id="3867555">path</span><span class="op" id="3867559">[</span><span class="ident" id="3867560">r</span><span class="op" id="3867561">]</span>&nbsp;<span class="op" id="3867563">==</span>&nbsp;<span class="string" id="3867566">&#39;.&#39;</span>&nbsp;<span class="op" id="3867570">&amp;&amp;</span>&nbsp;<span class="op" id="3867573">(</span><span class="ident" id="3867574">r</span><span class="op" id="3867575">+</span><span class="num" id="3867576">1</span>&nbsp;<span class="op" id="3867578">==</span>&nbsp;<span class="ident" id="3867581">n</span>&nbsp;<span class="op" id="3867583">||</span>&nbsp;<span class="ident" id="3867586">path</span><span class="op" id="3867590">[</span><span class="ident" id="3867591">r</span><span class="op" id="3867592">+</span><span class="num" id="3867593">1</span><span class="op" id="3867594">]</span>&nbsp;<span class="op" id="3867596">==</span>&nbsp;<span class="string" id="3867599">&#39;/&#39;</span><span class="op" id="3867602">)</span><span class="op" id="3867603">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867608">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867624">r</span><span class="op" id="3867625">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867630">case</span>&nbsp;<span class="ident" id="3867635">path</span><span class="op" id="3867639">[</span><span class="ident" id="3867640">r</span><span class="op" id="3867641">]</span>&nbsp;<span class="op" id="3867643">==</span>&nbsp;<span class="string" id="3867646">&#39;.&#39;</span>&nbsp;<span class="op" id="3867650">&amp;&amp;</span>&nbsp;<span class="ident" id="3867653">path</span><span class="op" id="3867657">[</span><span class="ident" id="3867658">r</span><span class="op" id="3867659">+</span><span class="num" id="3867660">1</span><span class="op" id="3867661">]</span>&nbsp;<span class="op" id="3867663">==</span>&nbsp;<span class="string" id="3867666">&#39;.&#39;</span>&nbsp;<span class="op" id="3867670">&amp;&amp;</span>&nbsp;<span class="op" id="3867673">(</span><span class="ident" id="3867674">r</span><span class="op" id="3867675">+</span><span class="num" id="3867676">2</span>&nbsp;<span class="op" id="3867678">==</span>&nbsp;<span class="ident" id="3867681">n</span>&nbsp;<span class="op" id="3867683">||</span>&nbsp;<span class="ident" id="3867686">path</span><span class="op" id="3867690">[</span><span class="ident" id="3867691">r</span><span class="op" id="3867692">+</span><span class="num" id="3867693">2</span><span class="op" id="3867694">]</span>&nbsp;<span class="op" id="3867696">==</span>&nbsp;<span class="string" id="3867699">&#39;/&#39;</span><span class="op" id="3867702">)</span><span class="op" id="3867703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867708">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867743">r</span>&nbsp;<span class="op" id="3867745">+=</span>&nbsp;<span class="num" id="3867748">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867753">switch</span>&nbsp;<span class="op" id="3867760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867765">case</span>&nbsp;<span class="ident" id="3867770">out</span><span class="op" id="3867773">.</span><span class="ident" id="3867774">w</span>&nbsp;<span class="op" id="3867776">&gt;</span>&nbsp;<span class="ident" id="3867778">dotdot</span><span class="op" id="3867784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867790">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867811">out</span><span class="op" id="3867814">.</span><span class="ident" id="3867815">w</span><span class="op" id="3867816">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867823">for</span>&nbsp;<span class="ident" id="3867827">out</span><span class="op" id="3867830">.</span><span class="ident" id="3867831">w</span>&nbsp;<span class="op" id="3867833">&gt;</span>&nbsp;<span class="ident" id="3867835">dotdot</span>&nbsp;<span class="op" id="3867842">&amp;&amp;</span>&nbsp;<span class="ident" id="3867845">out</span><span class="op" id="3867848">.</span><span class="ident" id="3867849">index</span><span class="op" id="3867854">(</span><span class="ident" id="3867855">out</span><span class="op" id="3867858">.</span><span class="ident" id="3867859">w</span><span class="op" id="3867860">)</span>&nbsp;<span class="op" id="3867862">!=</span>&nbsp;<span class="string" id="3867865">&#39;/&#39;</span>&nbsp;<span class="op" id="3867869">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867876">out</span><span class="op" id="3867879">.</span><span class="ident" id="3867880">w</span><span class="op" id="3867881">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867893">case</span>&nbsp;<span class="op" id="3867898">!</span><span class="ident" id="3867899">rooted</span><span class="op" id="3867905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3867911">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867974">if</span>&nbsp;<span class="ident" id="3867977">out</span><span class="op" id="3867980">.</span><span class="ident" id="3867981">w</span>&nbsp;<span class="op" id="3867983">&gt;</span>&nbsp;<span class="num" id="3867985">0</span>&nbsp;<span class="op" id="3867987">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867994">out</span><span class="op" id="3867997">.</span><span class="builtinfunc" id="3867998">append</span><span class="op" id="3868004">(</span><span class="string" id="3868005">&#39;/&#39;</span><span class="op" id="3868008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868020">out</span><span class="op" id="3868023">.</span><span class="builtinfunc" id="3868024">append</span><span class="op" id="3868030">(</span><span class="string" id="3868031">&#39;.&#39;</span><span class="op" id="3868034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868040">out</span><span class="op" id="3868043">.</span><span class="builtinfunc" id="3868044">append</span><span class="op" id="3868050">(</span><span class="string" id="3868051">&#39;.&#39;</span><span class="op" id="3868054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868060">dotdot</span>&nbsp;<span class="op" id="3868067">=</span>&nbsp;<span class="ident" id="3868069">out</span><span class="op" id="3868072">.</span><span class="ident" id="3868073">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868082">default</span><span class="op" id="3868089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868094">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868119">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868145">if</span>&nbsp;<span class="ident" id="3868148">rooted</span>&nbsp;<span class="op" id="3868155">&amp;&amp;</span>&nbsp;<span class="ident" id="3868158">out</span><span class="op" id="3868161">.</span><span class="ident" id="3868162">w</span>&nbsp;<span class="op" id="3868164">!=</span>&nbsp;<span class="num" id="3868167">1</span>&nbsp;<span class="op" id="3868169">||</span>&nbsp;<span class="op" id="3868172">!</span><span class="ident" id="3868173">rooted</span>&nbsp;<span class="op" id="3868180">&amp;&amp;</span>&nbsp;<span class="ident" id="3868183">out</span><span class="op" id="3868186">.</span><span class="ident" id="3868187">w</span>&nbsp;<span class="op" id="3868189">!=</span>&nbsp;<span class="num" id="3868192">0</span>&nbsp;<span class="op" id="3868194">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868200">out</span><span class="op" id="3868203">.</span><span class="builtinfunc" id="3868204">append</span><span class="op" id="3868210">(</span><span class="string" id="3868211">&#39;/&#39;</span><span class="op" id="3868214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868224">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868243">for</span>&nbsp;<span class="op" id="3868247">;</span>&nbsp;<span class="ident" id="3868249">r</span>&nbsp;<span class="op" id="3868251">&lt;</span>&nbsp;<span class="ident" id="3868253">n</span>&nbsp;<span class="op" id="3868255">&amp;&amp;</span>&nbsp;<span class="ident" id="3868258">path</span><span class="op" id="3868262">[</span><span class="ident" id="3868263">r</span><span class="op" id="3868264">]</span>&nbsp;<span class="op" id="3868266">!=</span>&nbsp;<span class="string" id="3868269">&#39;/&#39;</span><span class="op" id="3868272">;</span>&nbsp;<span class="ident" id="3868274">r</span><span class="op" id="3868275">++</span>&nbsp;<span class="op" id="3868278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868284">out</span><span class="op" id="3868287">.</span><span class="builtinfunc" id="3868288">append</span><span class="op" id="3868294">(</span><span class="ident" id="3868295">path</span><span class="op" id="3868299">[</span><span class="ident" id="3868300">r</span><span class="op" id="3868301">]</span><span class="op" id="3868302">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868318">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868349">if</span>&nbsp;<span class="ident" id="3868352">out</span><span class="op" id="3868355">.</span><span class="ident" id="3868356">w</span>&nbsp;<span class="op" id="3868358">==</span>&nbsp;<span class="num" id="3868361">0</span>&nbsp;<span class="op" id="3868363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868367">return</span>&nbsp;<span class="string" id="3868374">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868383">return</span>&nbsp;<span class="ident" id="3868390">out</span><span class="op" id="3868393">.</span><span class="builtintype" id="3868394">string</span><span class="op" id="3868400">(</span><span class="op" id="3868401">)</span><br>
<span class="lineno">135</span><span class="op" id="3868403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3868406">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="3868466">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3868525">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="3868586">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3868607">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3868670">func</span>&nbsp;<span class="ident" id="3868675">Split</span><span class="op" id="3868680">(</span><span class="ident" id="3868681">path</span>&nbsp;<span class="builtintype" id="3868686">string</span><span class="op" id="3868692">)</span>&nbsp;<span class="op" id="3868694">(</span><span class="ident" id="3868695">dir</span><span class="op" id="3868698">,</span>&nbsp;<span class="ident" id="3868700">file</span>&nbsp;<span class="builtintype" id="3868705">string</span><span class="op" id="3868711">)</span>&nbsp;<span class="op" id="3868713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868716">i</span>&nbsp;<span class="op" id="3868718">:=</span>&nbsp;<span class="ident" id="3868721">strings</span><span class="op" id="3868728">.</span><span class="ident" id="3868729">LastIndex</span><span class="op" id="3868738">(</span><span class="ident" id="3868739">path</span><span class="op" id="3868743">,</span>&nbsp;<span class="string" id="3868745">&#34;/&#34;</span><span class="op" id="3868748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868751">return</span>&nbsp;<span class="ident" id="3868758">path</span><span class="op" id="3868762">[</span><span class="op" id="3868763">:</span><span class="ident" id="3868764">i</span><span class="op" id="3868765">+</span><span class="num" id="3868766">1</span><span class="op" id="3868767">]</span><span class="op" id="3868768">,</span>&nbsp;<span class="ident" id="3868770">path</span><span class="op" id="3868774">[</span><span class="ident" id="3868775">i</span><span class="op" id="3868776">+</span><span class="num" id="3868777">1</span><span class="op" id="3868778">:</span><span class="op" id="3868779">]</span><br>
<span class="lineno">145</span><span class="op" id="3868781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3868784">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3868855">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="3868927">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="3868961">func</span>&nbsp;<span class="ident" id="3868966">Join</span><span class="op" id="3868970">(</span><span class="ident" id="3868971">elem</span>&nbsp;<span class="op" id="3868976">...</span><span class="builtintype" id="3868979">string</span><span class="op" id="3868985">)</span>&nbsp;<span class="builtintype" id="3868987">string</span>&nbsp;<span class="op" id="3868994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868997">for</span>&nbsp;<span class="ident" id="3869001">i</span><span class="op" id="3869002">,</span>&nbsp;<span class="ident" id="3869004">e</span>&nbsp;<span class="op" id="3869006">:=</span>&nbsp;<span class="keyword" id="3869009">range</span>&nbsp;<span class="ident" id="3869015">elem</span>&nbsp;<span class="op" id="3869020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869024">if</span>&nbsp;<span class="ident" id="3869027">e</span>&nbsp;<span class="op" id="3869029">!=</span>&nbsp;<span class="string" id="3869032">&#34;&#34;</span>&nbsp;<span class="op" id="3869035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869040">return</span>&nbsp;<span class="ident" id="3869047">Clean</span><span class="op" id="3869052">(</span><span class="ident" id="3869053">strings</span><span class="op" id="3869060">.</span><span class="ident" id="3869061">Join</span><span class="op" id="3869065">(</span><span class="ident" id="3869066">elem</span><span class="op" id="3869070">[</span><span class="ident" id="3869071">i</span><span class="op" id="3869072">:</span><span class="op" id="3869073">]</span><span class="op" id="3869074">,</span>&nbsp;<span class="string" id="3869076">&#34;/&#34;</span><span class="op" id="3869079">)</span><span class="op" id="3869080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869084">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869090">return</span>&nbsp;<span class="string" id="3869097">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3869100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3869103">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="3869156">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="3869214">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="3869263">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3869298">func</span>&nbsp;<span class="ident" id="3869303">Ext</span><span class="op" id="3869306">(</span><span class="ident" id="3869307">path</span>&nbsp;<span class="builtintype" id="3869312">string</span><span class="op" id="3869318">)</span>&nbsp;<span class="builtintype" id="3869320">string</span>&nbsp;<span class="op" id="3869327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869330">for</span>&nbsp;<span class="ident" id="3869334">i</span>&nbsp;<span class="op" id="3869336">:=</span>&nbsp;<span class="builtinfunc" id="3869339">len</span><span class="op" id="3869342">(</span><span class="ident" id="3869343">path</span><span class="op" id="3869347">)</span>&nbsp;<span class="op" id="3869349">-</span>&nbsp;<span class="num" id="3869351">1</span><span class="op" id="3869352">;</span>&nbsp;<span class="ident" id="3869354">i</span>&nbsp;<span class="op" id="3869356">&gt;=</span>&nbsp;<span class="num" id="3869359">0</span>&nbsp;<span class="op" id="3869361">&amp;&amp;</span>&nbsp;<span class="ident" id="3869364">path</span><span class="op" id="3869368">[</span><span class="ident" id="3869369">i</span><span class="op" id="3869370">]</span>&nbsp;<span class="op" id="3869372">!=</span>&nbsp;<span class="string" id="3869375">&#39;/&#39;</span><span class="op" id="3869378">;</span>&nbsp;<span class="ident" id="3869380">i</span><span class="op" id="3869381">--</span>&nbsp;<span class="op" id="3869384">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869388">if</span>&nbsp;<span class="ident" id="3869391">path</span><span class="op" id="3869395">[</span><span class="ident" id="3869396">i</span><span class="op" id="3869397">]</span>&nbsp;<span class="op" id="3869399">==</span>&nbsp;<span class="string" id="3869402">&#39;.&#39;</span>&nbsp;<span class="op" id="3869406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869411">return</span>&nbsp;<span class="ident" id="3869418">path</span><span class="op" id="3869422">[</span><span class="ident" id="3869423">i</span><span class="op" id="3869424">:</span><span class="op" id="3869425">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869435">return</span>&nbsp;<span class="string" id="3869442">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="3869445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3869448">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3869490">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="3869558">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="3869601">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3869664">func</span>&nbsp;<span class="ident" id="3869669">Base</span><span class="op" id="3869673">(</span><span class="ident" id="3869674">path</span>&nbsp;<span class="builtintype" id="3869679">string</span><span class="op" id="3869685">)</span>&nbsp;<span class="builtintype" id="3869687">string</span>&nbsp;<span class="op" id="3869694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869697">if</span>&nbsp;<span class="ident" id="3869700">path</span>&nbsp;<span class="op" id="3869705">==</span>&nbsp;<span class="string" id="3869708">&#34;&#34;</span>&nbsp;<span class="op" id="3869711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869715">return</span>&nbsp;<span class="string" id="3869722">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869727">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3869730">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869758">for</span>&nbsp;<span class="builtinfunc" id="3869762">len</span><span class="op" id="3869765">(</span><span class="ident" id="3869766">path</span><span class="op" id="3869770">)</span>&nbsp;<span class="op" id="3869772">&gt;</span>&nbsp;<span class="num" id="3869774">0</span>&nbsp;<span class="op" id="3869776">&amp;&amp;</span>&nbsp;<span class="ident" id="3869779">path</span><span class="op" id="3869783">[</span><span class="builtinfunc" id="3869784">len</span><span class="op" id="3869787">(</span><span class="ident" id="3869788">path</span><span class="op" id="3869792">)</span><span class="op" id="3869793">-</span><span class="num" id="3869794">1</span><span class="op" id="3869795">]</span>&nbsp;<span class="op" id="3869797">==</span>&nbsp;<span class="string" id="3869800">&#39;/&#39;</span>&nbsp;<span class="op" id="3869804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869808">path</span>&nbsp;<span class="op" id="3869813">=</span>&nbsp;<span class="ident" id="3869815">path</span><span class="op" id="3869819">[</span><span class="num" id="3869820">0</span>&nbsp;<span class="op" id="3869822">:</span>&nbsp;<span class="builtinfunc" id="3869824">len</span><span class="op" id="3869827">(</span><span class="ident" id="3869828">path</span><span class="op" id="3869832">)</span><span class="op" id="3869833">-</span><span class="num" id="3869834">1</span><span class="op" id="3869835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3869841">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869867">if</span>&nbsp;<span class="ident" id="3869870">i</span>&nbsp;<span class="op" id="3869872">:=</span>&nbsp;<span class="ident" id="3869875">strings</span><span class="op" id="3869882">.</span><span class="ident" id="3869883">LastIndex</span><span class="op" id="3869892">(</span><span class="ident" id="3869893">path</span><span class="op" id="3869897">,</span>&nbsp;<span class="string" id="3869899">&#34;/&#34;</span><span class="op" id="3869902">)</span><span class="op" id="3869903">;</span>&nbsp;<span class="ident" id="3869905">i</span>&nbsp;<span class="op" id="3869907">&gt;=</span>&nbsp;<span class="num" id="3869910">0</span>&nbsp;<span class="op" id="3869912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869916">path</span>&nbsp;<span class="op" id="3869921">=</span>&nbsp;<span class="ident" id="3869923">path</span><span class="op" id="3869927">[</span><span class="ident" id="3869928">i</span><span class="op" id="3869929">+</span><span class="num" id="3869930">1</span><span class="op" id="3869931">:</span><span class="op" id="3869932">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3869938">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869977">if</span>&nbsp;<span class="ident" id="3869980">path</span>&nbsp;<span class="op" id="3869985">==</span>&nbsp;<span class="string" id="3869988">&#34;&#34;</span>&nbsp;<span class="op" id="3869991">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869995">return</span>&nbsp;<span class="string" id="3870002">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870010">return</span>&nbsp;<span class="ident" id="3870017">path</span><br>
<span class="lineno"></span><span class="op" id="3870022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3870025">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="3870072">func</span>&nbsp;<span class="ident" id="3870077">IsAbs</span><span class="op" id="3870082">(</span><span class="ident" id="3870083">path</span>&nbsp;<span class="builtintype" id="3870088">string</span><span class="op" id="3870094">)</span>&nbsp;<span class="builtintype" id="3870096">bool</span>&nbsp;<span class="op" id="3870101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870104">return</span>&nbsp;<span class="builtinfunc" id="3870111">len</span><span class="op" id="3870114">(</span><span class="ident" id="3870115">path</span><span class="op" id="3870119">)</span>&nbsp;<span class="op" id="3870121">&gt;</span>&nbsp;<span class="num" id="3870123">0</span>&nbsp;<span class="op" id="3870125">&amp;&amp;</span>&nbsp;<span class="ident" id="3870128">path</span><span class="op" id="3870132">[</span><span class="num" id="3870133">0</span><span class="op" id="3870134">]</span>&nbsp;<span class="op" id="3870136">==</span>&nbsp;<span class="string" id="3870139">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="3870143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3870146">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3870227">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3870309">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="3870333">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3870375">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="3870452">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3870534">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="3870544">func</span>&nbsp;<span class="ident" id="3870549">Dir</span><span class="op" id="3870552">(</span><span class="ident" id="3870553">path</span>&nbsp;<span class="builtintype" id="3870558">string</span><span class="op" id="3870564">)</span>&nbsp;<span class="builtintype" id="3870566">string</span>&nbsp;<span class="op" id="3870573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870576">dir</span><span class="op" id="3870579">,</span>&nbsp;<span class="ident" id="3870581">_</span>&nbsp;<span class="op" id="3870583">:=</span>&nbsp;<span class="ident" id="3870586">Split</span><span class="op" id="3870591">(</span><span class="ident" id="3870592">path</span><span class="op" id="3870596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870599">return</span>&nbsp;<span class="ident" id="3870606">Clean</span><span class="op" id="3870611">(</span><span class="ident" id="3870612">dir</span><span class="op" id="3870615">)</span><br>
<span class="lineno">210</span><span class="op" id="3870617">}</span>
</div>
</body>
</html>
