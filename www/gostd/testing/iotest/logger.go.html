<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5868632">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5868687">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5868741">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5868792">package</span>&nbsp;<span class="ident" id="5868800">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5868808">import</span>&nbsp;<span class="op" id="5868815">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5868818">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5868824">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="5868830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5868833">type</span>&nbsp;<span class="ident" id="5868838">writeLogger</span>&nbsp;<span class="keyword" id="5868850">struct</span>&nbsp;<span class="op" id="5868857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868860">prefix</span>&nbsp;<span class="builtintype" id="5868867">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868875">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868882">io</span><span class="op" id="5868884">.</span><span class="ident" id="5868885">Writer</span><br>
<span class="lineno">15</span><span class="op" id="5868892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5868895">func</span>&nbsp;<span class="op" id="5868900">(</span><span class="ident" id="5868901">l</span>&nbsp;<span class="op" id="5868903">*</span><span class="ident" id="5868904">writeLogger</span><span class="op" id="5868915">)</span>&nbsp;<span class="ident" id="5868917">Write</span><span class="op" id="5868922">(</span><span class="ident" id="5868923">p</span>&nbsp;<span class="op" id="5868925">[</span><span class="op" id="5868926">]</span><span class="builtintype" id="5868927">byte</span><span class="op" id="5868931">)</span>&nbsp;<span class="op" id="5868933">(</span><span class="ident" id="5868934">n</span>&nbsp;<span class="builtintype" id="5868936">int</span><span class="op" id="5868939">,</span>&nbsp;<span class="ident" id="5868941">err</span>&nbsp;<span class="builtintype" id="5868945">error</span><span class="op" id="5868950">)</span>&nbsp;<span class="op" id="5868952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868955">n</span><span class="op" id="5868956">,</span>&nbsp;<span class="ident" id="5868958">err</span>&nbsp;<span class="op" id="5868962">=</span>&nbsp;<span class="ident" id="5868964">l</span><span class="op" id="5868965">.</span><span class="ident" id="5868966">w</span><span class="op" id="5868967">.</span><span class="ident" id="5868968">Write</span><span class="op" id="5868973">(</span><span class="ident" id="5868974">p</span><span class="op" id="5868975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868978">if</span>&nbsp;<span class="ident" id="5868981">err</span>&nbsp;<span class="op" id="5868985">!=</span>&nbsp;<span class="ident" id="5868988">nil</span>&nbsp;<span class="op" id="5868992">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868996">log</span><span class="op" id="5868999">.</span><span class="ident" id="5869000">Printf</span><span class="op" id="5869006">(</span><span class="string" id="5869007">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5869018">,</span>&nbsp;<span class="ident" id="5869020">l</span><span class="op" id="5869021">.</span><span class="ident" id="5869022">prefix</span><span class="op" id="5869028">,</span>&nbsp;<span class="ident" id="5869030">p</span><span class="op" id="5869031">[</span><span class="num" id="5869032">0</span><span class="op" id="5869033">:</span><span class="ident" id="5869034">n</span><span class="op" id="5869035">]</span><span class="op" id="5869036">,</span>&nbsp;<span class="ident" id="5869038">err</span><span class="op" id="5869041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869044">}</span>&nbsp;<span class="keyword" id="5869046">else</span>&nbsp;<span class="op" id="5869051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869055">log</span><span class="op" id="5869058">.</span><span class="ident" id="5869059">Printf</span><span class="op" id="5869065">(</span><span class="string" id="5869066">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5869073">,</span>&nbsp;<span class="ident" id="5869075">l</span><span class="op" id="5869076">.</span><span class="ident" id="5869077">prefix</span><span class="op" id="5869083">,</span>&nbsp;<span class="ident" id="5869085">p</span><span class="op" id="5869086">[</span><span class="num" id="5869087">0</span><span class="op" id="5869088">:</span><span class="ident" id="5869089">n</span><span class="op" id="5869090">]</span><span class="op" id="5869091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869097">return</span><br>
<span class="lineno">25</span><span class="op" id="5869104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5869107">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="5869169">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5869234">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="5869291">func</span>&nbsp;<span class="ident" id="5869296">NewWriteLogger</span><span class="op" id="5869310">(</span><span class="ident" id="5869311">prefix</span>&nbsp;<span class="builtintype" id="5869318">string</span><span class="op" id="5869324">,</span>&nbsp;<span class="ident" id="5869326">w</span>&nbsp;<span class="ident" id="5869328">io</span><span class="op" id="5869330">.</span><span class="ident" id="5869331">Writer</span><span class="op" id="5869337">)</span>&nbsp;<span class="ident" id="5869339">io</span><span class="op" id="5869341">.</span><span class="ident" id="5869342">Writer</span>&nbsp;<span class="op" id="5869349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869352">return</span>&nbsp;<span class="op" id="5869359">&amp;</span><span class="ident" id="5869360">writeLogger</span><span class="op" id="5869371">{</span><span class="ident" id="5869372">prefix</span><span class="op" id="5869378">,</span>&nbsp;<span class="ident" id="5869380">w</span><span class="op" id="5869381">}</span><br>
<span class="lineno"></span><span class="op" id="5869383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5869386">type</span>&nbsp;<span class="ident" id="5869391">readLogger</span>&nbsp;<span class="keyword" id="5869402">struct</span>&nbsp;<span class="op" id="5869409">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869412">prefix</span>&nbsp;<span class="builtintype" id="5869419">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869427">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869434">io</span><span class="op" id="5869436">.</span><span class="ident" id="5869437">Reader</span><br>
<span class="lineno"></span><span class="op" id="5869444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5869447">func</span>&nbsp;<span class="op" id="5869452">(</span><span class="ident" id="5869453">l</span>&nbsp;<span class="op" id="5869455">*</span><span class="ident" id="5869456">readLogger</span><span class="op" id="5869466">)</span>&nbsp;<span class="ident" id="5869468">Read</span><span class="op" id="5869472">(</span><span class="ident" id="5869473">p</span>&nbsp;<span class="op" id="5869475">[</span><span class="op" id="5869476">]</span><span class="builtintype" id="5869477">byte</span><span class="op" id="5869481">)</span>&nbsp;<span class="op" id="5869483">(</span><span class="ident" id="5869484">n</span>&nbsp;<span class="builtintype" id="5869486">int</span><span class="op" id="5869489">,</span>&nbsp;<span class="ident" id="5869491">err</span>&nbsp;<span class="builtintype" id="5869495">error</span><span class="op" id="5869500">)</span>&nbsp;<span class="op" id="5869502">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869505">n</span><span class="op" id="5869506">,</span>&nbsp;<span class="ident" id="5869508">err</span>&nbsp;<span class="op" id="5869512">=</span>&nbsp;<span class="ident" id="5869514">l</span><span class="op" id="5869515">.</span><span class="ident" id="5869516">r</span><span class="op" id="5869517">.</span><span class="ident" id="5869518">Read</span><span class="op" id="5869522">(</span><span class="ident" id="5869523">p</span><span class="op" id="5869524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869527">if</span>&nbsp;<span class="ident" id="5869530">err</span>&nbsp;<span class="op" id="5869534">!=</span>&nbsp;<span class="ident" id="5869537">nil</span>&nbsp;<span class="op" id="5869541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869545">log</span><span class="op" id="5869548">.</span><span class="ident" id="5869549">Printf</span><span class="op" id="5869555">(</span><span class="string" id="5869556">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5869567">,</span>&nbsp;<span class="ident" id="5869569">l</span><span class="op" id="5869570">.</span><span class="ident" id="5869571">prefix</span><span class="op" id="5869577">,</span>&nbsp;<span class="ident" id="5869579">p</span><span class="op" id="5869580">[</span><span class="num" id="5869581">0</span><span class="op" id="5869582">:</span><span class="ident" id="5869583">n</span><span class="op" id="5869584">]</span><span class="op" id="5869585">,</span>&nbsp;<span class="ident" id="5869587">err</span><span class="op" id="5869590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869593">}</span>&nbsp;<span class="keyword" id="5869595">else</span>&nbsp;<span class="op" id="5869600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869604">log</span><span class="op" id="5869607">.</span><span class="ident" id="5869608">Printf</span><span class="op" id="5869614">(</span><span class="string" id="5869615">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5869622">,</span>&nbsp;<span class="ident" id="5869624">l</span><span class="op" id="5869625">.</span><span class="ident" id="5869626">prefix</span><span class="op" id="5869632">,</span>&nbsp;<span class="ident" id="5869634">p</span><span class="op" id="5869635">[</span><span class="num" id="5869636">0</span><span class="op" id="5869637">:</span><span class="ident" id="5869638">n</span><span class="op" id="5869639">]</span><span class="op" id="5869640">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869646">return</span><br>
<span class="lineno"></span><span class="op" id="5869653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5869656">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="5869717">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5869780">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="5869837">func</span>&nbsp;<span class="ident" id="5869842">NewReadLogger</span><span class="op" id="5869855">(</span><span class="ident" id="5869856">prefix</span>&nbsp;<span class="builtintype" id="5869863">string</span><span class="op" id="5869869">,</span>&nbsp;<span class="ident" id="5869871">r</span>&nbsp;<span class="ident" id="5869873">io</span><span class="op" id="5869875">.</span><span class="ident" id="5869876">Reader</span><span class="op" id="5869882">)</span>&nbsp;<span class="ident" id="5869884">io</span><span class="op" id="5869886">.</span><span class="ident" id="5869887">Reader</span>&nbsp;<span class="op" id="5869894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869897">return</span>&nbsp;<span class="op" id="5869904">&amp;</span><span class="ident" id="5869905">readLogger</span><span class="op" id="5869915">{</span><span class="ident" id="5869916">prefix</span><span class="op" id="5869922">,</span>&nbsp;<span class="ident" id="5869924">r</span><span class="op" id="5869925">}</span><br>
<span class="lineno"></span><span class="op" id="5869927">}</span>
</div>
</body>
</html>
