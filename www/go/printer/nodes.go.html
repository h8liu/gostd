<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5705414">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5705469">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5705523">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5705574">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5705634">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5705695">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5705750">package</span>&nbsp;<span class="ident" id="5705758">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5705767">import</span>&nbsp;<span class="op" id="5705774">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705777">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705786">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705796">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705808">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5705823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705826">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5705848">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5705943">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5706038">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5706058">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5706094">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5706173">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5706249">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5706329">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5706351">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5706428">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5706506">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5706582">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5706634">//</span><br>
<span class="lineno"></span><span class="comment" id="5706637">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5706716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5706791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5706869">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5706947">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5707026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5707101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5707172">//</span><br>
<span class="lineno"></span><span class="keyword" id="5707175">func</span>&nbsp;<span class="op" id="5707180">(</span><span class="ident" id="5707181">p</span>&nbsp;<span class="op" id="5707183">*</span><span class="ident" id="5707184">printer</span><span class="op" id="5707191">)</span>&nbsp;<span class="ident" id="5707193">linebreak</span><span class="op" id="5707202">(</span><span class="ident" id="5707203">line</span><span class="op" id="5707207">,</span>&nbsp;<span class="ident" id="5707209">min</span>&nbsp;<span class="builtintype" id="5707213">int</span><span class="op" id="5707216">,</span>&nbsp;<span class="ident" id="5707218">ws</span>&nbsp;<span class="ident" id="5707221">whiteSpace</span><span class="op" id="5707231">,</span>&nbsp;<span class="ident" id="5707233">newSection</span>&nbsp;<span class="builtintype" id="5707244">bool</span><span class="op" id="5707248">)</span>&nbsp;<span class="op" id="5707250">(</span><span class="ident" id="5707251">printedBreak</span>&nbsp;<span class="builtintype" id="5707264">bool</span><span class="op" id="5707268">)</span>&nbsp;<span class="op" id="5707270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707273">n</span>&nbsp;<span class="op" id="5707275">:=</span>&nbsp;<span class="ident" id="5707278">nlimit</span><span class="op" id="5707284">(</span><span class="ident" id="5707285">line</span>&nbsp;<span class="op" id="5707290">-</span>&nbsp;<span class="ident" id="5707292">p</span><span class="op" id="5707293">.</span><span class="ident" id="5707294">pos</span><span class="op" id="5707297">.</span><span class="ident" id="5707298">Line</span><span class="op" id="5707302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707305">if</span>&nbsp;<span class="ident" id="5707308">n</span>&nbsp;<span class="op" id="5707310">&lt;</span>&nbsp;<span class="ident" id="5707312">min</span>&nbsp;<span class="op" id="5707316">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707320">n</span>&nbsp;<span class="op" id="5707322">=</span>&nbsp;<span class="ident" id="5707324">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707332">if</span>&nbsp;<span class="ident" id="5707335">n</span>&nbsp;<span class="op" id="5707337">&gt;</span>&nbsp;<span class="num" id="5707339">0</span>&nbsp;<span class="op" id="5707341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707345">p</span><span class="op" id="5707346">.</span><span class="builtinfunc" id="5707347">print</span><span class="op" id="5707352">(</span><span class="ident" id="5707353">ws</span><span class="op" id="5707355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707359">if</span>&nbsp;<span class="ident" id="5707362">newSection</span>&nbsp;<span class="op" id="5707373">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707378">p</span><span class="op" id="5707379">.</span><span class="builtinfunc" id="5707380">print</span><span class="op" id="5707385">(</span><span class="ident" id="5707386">formfeed</span><span class="op" id="5707394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707399">n</span><span class="op" id="5707400">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707409">for</span>&nbsp;<span class="op" id="5707413">;</span>&nbsp;<span class="ident" id="5707415">n</span>&nbsp;<span class="op" id="5707417">&gt;</span>&nbsp;<span class="num" id="5707419">0</span><span class="op" id="5707420">;</span>&nbsp;<span class="ident" id="5707422">n</span><span class="op" id="5707423">--</span>&nbsp;<span class="op" id="5707426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707431">p</span><span class="op" id="5707432">.</span><span class="builtinfunc" id="5707433">print</span><span class="op" id="5707438">(</span><span class="ident" id="5707439">newline</span><span class="op" id="5707446">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707454">printedBreak</span>&nbsp;<span class="op" id="5707467">=</span>&nbsp;<span class="ident" id="5707469">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707478">return</span><br>
<span class="lineno"></span><span class="op" id="5707485">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5707488">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5707562">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5707638">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5707716">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5707775">func</span>&nbsp;<span class="op" id="5707780">(</span><span class="ident" id="5707781">p</span>&nbsp;<span class="op" id="5707783">*</span><span class="ident" id="5707784">printer</span><span class="op" id="5707791">)</span>&nbsp;<span class="ident" id="5707793">setComment</span><span class="op" id="5707803">(</span><span class="ident" id="5707804">g</span>&nbsp;<span class="op" id="5707806">*</span><span class="ident" id="5707807">ast</span><span class="op" id="5707810">.</span><span class="ident" id="5707811">CommentGroup</span><span class="op" id="5707823">)</span>&nbsp;<span class="op" id="5707825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707828">if</span>&nbsp;<span class="ident" id="5707831">g</span>&nbsp;<span class="op" id="5707833">==</span>&nbsp;<span class="ident" id="5707836">nil</span>&nbsp;<span class="op" id="5707840">||</span>&nbsp;<span class="op" id="5707843">!</span><span class="ident" id="5707844">p</span><span class="op" id="5707845">.</span><span class="ident" id="5707846">useNodeComments</span>&nbsp;<span class="op" id="5707862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707866">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707877">if</span>&nbsp;<span class="ident" id="5707880">p</span><span class="op" id="5707881">.</span><span class="ident" id="5707882">comments</span>&nbsp;<span class="op" id="5707891">==</span>&nbsp;<span class="ident" id="5707894">nil</span>&nbsp;<span class="op" id="5707898">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707902">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707936">p</span><span class="op" id="5707937">.</span><span class="ident" id="5707938">comments</span>&nbsp;<span class="op" id="5707947">=</span>&nbsp;<span class="builtinfunc" id="5707949">make</span><span class="op" id="5707953">(</span><span class="op" id="5707954">[</span><span class="op" id="5707955">]</span><span class="op" id="5707956">*</span><span class="ident" id="5707957">ast</span><span class="op" id="5707960">.</span><span class="ident" id="5707961">CommentGroup</span><span class="op" id="5707973">,</span>&nbsp;<span class="num" id="5707975">1</span><span class="op" id="5707976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707979">}</span>&nbsp;<span class="keyword" id="5707981">else</span>&nbsp;<span class="keyword" id="5707986">if</span>&nbsp;<span class="ident" id="5707989">p</span><span class="op" id="5707990">.</span><span class="ident" id="5707991">cindex</span>&nbsp;<span class="op" id="5707998">&lt;</span>&nbsp;<span class="builtinfunc" id="5708000">len</span><span class="op" id="5708003">(</span><span class="ident" id="5708004">p</span><span class="op" id="5708005">.</span><span class="ident" id="5708006">comments</span><span class="op" id="5708014">)</span>&nbsp;<span class="op" id="5708016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708020">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708074">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708129">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708183">p</span><span class="op" id="5708184">.</span><span class="ident" id="5708185">flush</span><span class="op" id="5708190">(</span><span class="ident" id="5708191">p</span><span class="op" id="5708192">.</span><span class="ident" id="5708193">posFor</span><span class="op" id="5708199">(</span><span class="ident" id="5708200">g</span><span class="op" id="5708201">.</span><span class="ident" id="5708202">List</span><span class="op" id="5708206">[</span><span class="num" id="5708207">0</span><span class="op" id="5708208">]</span><span class="op" id="5708209">.</span><span class="ident" id="5708210">Pos</span><span class="op" id="5708213">(</span><span class="op" id="5708214">)</span><span class="op" id="5708215">)</span><span class="op" id="5708216">,</span>&nbsp;<span class="ident" id="5708218">token</span><span class="op" id="5708223">.</span><span class="ident" id="5708224">ILLEGAL</span><span class="op" id="5708231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708235">p</span><span class="op" id="5708236">.</span><span class="ident" id="5708237">comments</span>&nbsp;<span class="op" id="5708246">=</span>&nbsp;<span class="ident" id="5708248">p</span><span class="op" id="5708249">.</span><span class="ident" id="5708250">comments</span><span class="op" id="5708258">[</span><span class="num" id="5708259">0</span><span class="op" id="5708260">:</span><span class="num" id="5708261">1</span><span class="op" id="5708262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708266">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708299">p</span><span class="op" id="5708300">.</span><span class="ident" id="5708301">internalError</span><span class="op" id="5708314">(</span><span class="string" id="5708315">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5708350">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708356">p</span><span class="op" id="5708357">.</span><span class="ident" id="5708358">comments</span><span class="op" id="5708366">[</span><span class="num" id="5708367">0</span><span class="op" id="5708368">]</span>&nbsp;<span class="op" id="5708370">=</span>&nbsp;<span class="ident" id="5708372">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708375">p</span><span class="op" id="5708376">.</span><span class="ident" id="5708377">cindex</span>&nbsp;<span class="op" id="5708384">=</span>&nbsp;<span class="num" id="5708386">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708389">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708452">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708511">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708568">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708588">if</span>&nbsp;<span class="ident" id="5708591">p</span><span class="op" id="5708592">.</span><span class="ident" id="5708593">commentOffset</span>&nbsp;<span class="op" id="5708607">==</span>&nbsp;<span class="ident" id="5708610">infinity</span>&nbsp;<span class="op" id="5708619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708623">p</span><span class="op" id="5708624">.</span><span class="ident" id="5708625">nextComment</span><span class="op" id="5708636">(</span><span class="op" id="5708637">)</span>&nbsp;<span class="comment" id="5708639">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708669">}</span><br>
<span class="lineno">90</span><span class="op" id="5708671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5708674">type</span>&nbsp;<span class="ident" id="5708679">exprListMode</span>&nbsp;<span class="builtintype" id="5708692">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5708698">const</span>&nbsp;<span class="op" id="5708704">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708707">commaTerm</span>&nbsp;<span class="ident" id="5708717">exprListMode</span>&nbsp;<span class="op" id="5708730">=</span>&nbsp;<span class="num" id="5708732">1</span>&nbsp;<span class="op" id="5708734">&lt;&lt;</span>&nbsp;<span class="ident" id="5708737">iota</span>&nbsp;<span class="comment" id="5708742">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708787">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708822">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5708866">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5708869">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5708941">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5708973">func</span>&nbsp;<span class="op" id="5708978">(</span><span class="ident" id="5708979">p</span>&nbsp;<span class="op" id="5708981">*</span><span class="ident" id="5708982">printer</span><span class="op" id="5708989">)</span>&nbsp;<span class="ident" id="5708991">identList</span><span class="op" id="5709000">(</span><span class="ident" id="5709001">list</span>&nbsp;<span class="op" id="5709006">[</span><span class="op" id="5709007">]</span><span class="op" id="5709008">*</span><span class="ident" id="5709009">ast</span><span class="op" id="5709012">.</span><span class="ident" id="5709013">Ident</span><span class="op" id="5709018">,</span>&nbsp;<span class="ident" id="5709020">indent</span>&nbsp;<span class="builtintype" id="5709027">bool</span><span class="op" id="5709031">)</span>&nbsp;<span class="op" id="5709033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709036">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709109">xlist</span>&nbsp;<span class="op" id="5709115">:=</span>&nbsp;<span class="builtinfunc" id="5709118">make</span><span class="op" id="5709122">(</span><span class="op" id="5709123">[</span><span class="op" id="5709124">]</span><span class="ident" id="5709125">ast</span><span class="op" id="5709128">.</span><span class="ident" id="5709129">Expr</span><span class="op" id="5709133">,</span>&nbsp;<span class="builtinfunc" id="5709135">len</span><span class="op" id="5709138">(</span><span class="ident" id="5709139">list</span><span class="op" id="5709143">)</span><span class="op" id="5709144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709147">for</span>&nbsp;<span class="ident" id="5709151">i</span><span class="op" id="5709152">,</span>&nbsp;<span class="ident" id="5709154">x</span>&nbsp;<span class="op" id="5709156">:=</span>&nbsp;<span class="keyword" id="5709159">range</span>&nbsp;<span class="ident" id="5709165">list</span>&nbsp;<span class="op" id="5709170">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709174">xlist</span><span class="op" id="5709179">[</span><span class="ident" id="5709180">i</span><span class="op" id="5709181">]</span>&nbsp;<span class="op" id="5709183">=</span>&nbsp;<span class="ident" id="5709185">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709191">var</span>&nbsp;<span class="ident" id="5709195">mode</span>&nbsp;<span class="ident" id="5709200">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709214">if</span>&nbsp;<span class="op" id="5709217">!</span><span class="ident" id="5709218">indent</span>&nbsp;<span class="op" id="5709225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709229">mode</span>&nbsp;<span class="op" id="5709234">=</span>&nbsp;<span class="ident" id="5709236">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709249">p</span><span class="op" id="5709250">.</span><span class="ident" id="5709251">exprList</span><span class="op" id="5709259">(</span><span class="ident" id="5709260">token</span><span class="op" id="5709265">.</span><span class="ident" id="5709266">NoPos</span><span class="op" id="5709271">,</span>&nbsp;<span class="ident" id="5709273">xlist</span><span class="op" id="5709278">,</span>&nbsp;<span class="num" id="5709280">1</span><span class="op" id="5709281">,</span>&nbsp;<span class="ident" id="5709283">mode</span><span class="op" id="5709287">,</span>&nbsp;<span class="ident" id="5709289">token</span><span class="op" id="5709294">.</span><span class="ident" id="5709295">NoPos</span><span class="op" id="5709300">)</span><br>
<span class="lineno"></span><span class="op" id="5709302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5709305">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5709364">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5709428">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5709444">//</span><br>
<span class="lineno"></span><span class="comment" id="5709447">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5709516">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5709583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5709649">func</span>&nbsp;<span class="op" id="5709654">(</span><span class="ident" id="5709655">p</span>&nbsp;<span class="op" id="5709657">*</span><span class="ident" id="5709658">printer</span><span class="op" id="5709665">)</span>&nbsp;<span class="ident" id="5709667">exprList</span><span class="op" id="5709675">(</span><span class="ident" id="5709676">prev0</span>&nbsp;<span class="ident" id="5709682">token</span><span class="op" id="5709687">.</span><span class="ident" id="5709688">Pos</span><span class="op" id="5709691">,</span>&nbsp;<span class="ident" id="5709693">list</span>&nbsp;<span class="op" id="5709698">[</span><span class="op" id="5709699">]</span><span class="ident" id="5709700">ast</span><span class="op" id="5709703">.</span><span class="ident" id="5709704">Expr</span><span class="op" id="5709708">,</span>&nbsp;<span class="ident" id="5709710">depth</span>&nbsp;<span class="builtintype" id="5709716">int</span><span class="op" id="5709719">,</span>&nbsp;<span class="ident" id="5709721">mode</span>&nbsp;<span class="ident" id="5709726">exprListMode</span><span class="op" id="5709738">,</span>&nbsp;<span class="ident" id="5709740">next0</span>&nbsp;<span class="ident" id="5709746">token</span><span class="op" id="5709751">.</span><span class="ident" id="5709752">Pos</span><span class="op" id="5709755">)</span>&nbsp;<span class="op" id="5709757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709760">if</span>&nbsp;<span class="builtinfunc" id="5709763">len</span><span class="op" id="5709766">(</span><span class="ident" id="5709767">list</span><span class="op" id="5709771">)</span>&nbsp;<span class="op" id="5709773">==</span>&nbsp;<span class="num" id="5709776">0</span>&nbsp;<span class="op" id="5709778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709782">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709790">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709794">prev</span>&nbsp;<span class="op" id="5709799">:=</span>&nbsp;<span class="ident" id="5709802">p</span><span class="op" id="5709803">.</span><span class="ident" id="5709804">posFor</span><span class="op" id="5709810">(</span><span class="ident" id="5709811">prev0</span><span class="op" id="5709816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709819">next</span>&nbsp;<span class="op" id="5709824">:=</span>&nbsp;<span class="ident" id="5709827">p</span><span class="op" id="5709828">.</span><span class="ident" id="5709829">posFor</span><span class="op" id="5709835">(</span><span class="ident" id="5709836">next0</span><span class="op" id="5709841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709844">line</span>&nbsp;<span class="op" id="5709849">:=</span>&nbsp;<span class="ident" id="5709852">p</span><span class="op" id="5709853">.</span><span class="ident" id="5709854">lineFor</span><span class="op" id="5709861">(</span><span class="ident" id="5709862">list</span><span class="op" id="5709866">[</span><span class="num" id="5709867">0</span><span class="op" id="5709868">]</span><span class="op" id="5709869">.</span><span class="ident" id="5709870">Pos</span><span class="op" id="5709873">(</span><span class="op" id="5709874">)</span><span class="op" id="5709875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709878">endLine</span>&nbsp;<span class="op" id="5709886">:=</span>&nbsp;<span class="ident" id="5709889">p</span><span class="op" id="5709890">.</span><span class="ident" id="5709891">lineFor</span><span class="op" id="5709898">(</span><span class="ident" id="5709899">list</span><span class="op" id="5709903">[</span><span class="builtinfunc" id="5709904">len</span><span class="op" id="5709907">(</span><span class="ident" id="5709908">list</span><span class="op" id="5709912">)</span><span class="op" id="5709913">-</span><span class="num" id="5709914">1</span><span class="op" id="5709915">]</span><span class="op" id="5709916">.</span><span class="ident" id="5709917">End</span><span class="op" id="5709920">(</span><span class="op" id="5709921">)</span><span class="op" id="5709922">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709926">if</span>&nbsp;<span class="ident" id="5709929">prev</span><span class="op" id="5709933">.</span><span class="ident" id="5709934">IsValid</span><span class="op" id="5709941">(</span><span class="op" id="5709942">)</span>&nbsp;<span class="op" id="5709944">&amp;&amp;</span>&nbsp;<span class="ident" id="5709947">prev</span><span class="op" id="5709951">.</span><span class="ident" id="5709952">Line</span>&nbsp;<span class="op" id="5709957">==</span>&nbsp;<span class="ident" id="5709960">line</span>&nbsp;<span class="op" id="5709965">&amp;&amp;</span>&nbsp;<span class="ident" id="5709968">line</span>&nbsp;<span class="op" id="5709973">==</span>&nbsp;<span class="ident" id="5709976">endLine</span>&nbsp;<span class="op" id="5709984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709988">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710027">for</span>&nbsp;<span class="ident" id="5710031">i</span><span class="op" id="5710032">,</span>&nbsp;<span class="ident" id="5710034">x</span>&nbsp;<span class="op" id="5710036">:=</span>&nbsp;<span class="keyword" id="5710039">range</span>&nbsp;<span class="ident" id="5710045">list</span>&nbsp;<span class="op" id="5710050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710055">if</span>&nbsp;<span class="ident" id="5710058">i</span>&nbsp;<span class="op" id="5710060">&gt;</span>&nbsp;<span class="num" id="5710062">0</span>&nbsp;<span class="op" id="5710064">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710070">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710127">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710179">p</span><span class="op" id="5710180">.</span><span class="builtinfunc" id="5710181">print</span><span class="op" id="5710186">(</span><span class="ident" id="5710187">x</span><span class="op" id="5710188">.</span><span class="ident" id="5710189">Pos</span><span class="op" id="5710192">(</span><span class="op" id="5710193">)</span><span class="op" id="5710194">,</span>&nbsp;<span class="ident" id="5710196">token</span><span class="op" id="5710201">.</span><span class="ident" id="5710202">COMMA</span><span class="op" id="5710207">,</span>&nbsp;<span class="ident" id="5710209">blank</span><span class="op" id="5710214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710224">p</span><span class="op" id="5710225">.</span><span class="ident" id="5710226">expr0</span><span class="op" id="5710231">(</span><span class="ident" id="5710232">x</span><span class="op" id="5710233">,</span>&nbsp;<span class="ident" id="5710235">depth</span><span class="op" id="5710240">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710260">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710298">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710350">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710402">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710460">ws</span>&nbsp;<span class="op" id="5710463">:=</span>&nbsp;<span class="ident" id="5710466">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710474">if</span>&nbsp;<span class="ident" id="5710477">mode</span><span class="op" id="5710481">&amp;</span><span class="ident" id="5710482">noIndent</span>&nbsp;<span class="op" id="5710491">==</span>&nbsp;<span class="num" id="5710494">0</span>&nbsp;<span class="op" id="5710496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710500">ws</span>&nbsp;<span class="op" id="5710503">=</span>&nbsp;<span class="ident" id="5710505">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710517">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710590">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710628">prevBreak</span>&nbsp;<span class="op" id="5710638">:=</span>&nbsp;<span class="op" id="5710641">-</span><span class="num" id="5710642">1</span>&nbsp;<span class="comment" id="5710644">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710706">if</span>&nbsp;<span class="ident" id="5710709">prev</span><span class="op" id="5710713">.</span><span class="ident" id="5710714">IsValid</span><span class="op" id="5710721">(</span><span class="op" id="5710722">)</span>&nbsp;<span class="op" id="5710724">&amp;&amp;</span>&nbsp;<span class="ident" id="5710727">prev</span><span class="op" id="5710731">.</span><span class="ident" id="5710732">Line</span>&nbsp;<span class="op" id="5710737">&lt;</span>&nbsp;<span class="ident" id="5710739">line</span>&nbsp;<span class="op" id="5710744">&amp;&amp;</span>&nbsp;<span class="ident" id="5710747">p</span><span class="op" id="5710748">.</span><span class="ident" id="5710749">linebreak</span><span class="op" id="5710758">(</span><span class="ident" id="5710759">line</span><span class="op" id="5710763">,</span>&nbsp;<span class="num" id="5710765">0</span><span class="op" id="5710766">,</span>&nbsp;<span class="ident" id="5710768">ws</span><span class="op" id="5710770">,</span>&nbsp;<span class="ident" id="5710772">true</span><span class="op" id="5710776">)</span>&nbsp;<span class="op" id="5710778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710782">ws</span>&nbsp;<span class="op" id="5710785">=</span>&nbsp;<span class="ident" id="5710787">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710796">prevBreak</span>&nbsp;<span class="op" id="5710806">=</span>&nbsp;<span class="num" id="5710808">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710815">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710912">size</span>&nbsp;<span class="op" id="5710917">:=</span>&nbsp;<span class="num" id="5710920">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710924">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710952">prevLine</span>&nbsp;<span class="op" id="5710961">:=</span>&nbsp;<span class="ident" id="5710964">prev</span><span class="op" id="5710968">.</span><span class="ident" id="5710969">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710975">for</span>&nbsp;<span class="ident" id="5710979">i</span><span class="op" id="5710980">,</span>&nbsp;<span class="ident" id="5710982">x</span>&nbsp;<span class="op" id="5710984">:=</span>&nbsp;<span class="keyword" id="5710987">range</span>&nbsp;<span class="ident" id="5710993">list</span>&nbsp;<span class="op" id="5710998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711002">line</span>&nbsp;<span class="op" id="5711007">=</span>&nbsp;<span class="ident" id="5711009">p</span><span class="op" id="5711010">.</span><span class="ident" id="5711011">lineFor</span><span class="op" id="5711018">(</span><span class="ident" id="5711019">x</span><span class="op" id="5711020">.</span><span class="ident" id="5711021">Pos</span><span class="op" id="5711024">(</span><span class="op" id="5711025">)</span><span class="op" id="5711026">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711031">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711100">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711168">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711213">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711282">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711349">useFF</span>&nbsp;<span class="op" id="5711355">:=</span>&nbsp;<span class="ident" id="5711358">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711366">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711429">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711495">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711564">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711578">prevSize</span>&nbsp;<span class="op" id="5711587">:=</span>&nbsp;<span class="ident" id="5711590">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711597">const</span>&nbsp;<span class="ident" id="5711603">infinity</span>&nbsp;<span class="op" id="5711612">=</span>&nbsp;<span class="num" id="5711614">1e6</span>&nbsp;<span class="comment" id="5711618">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711651">size</span>&nbsp;<span class="op" id="5711656">=</span>&nbsp;<span class="ident" id="5711658">p</span><span class="op" id="5711659">.</span><span class="ident" id="5711660">nodeSize</span><span class="op" id="5711668">(</span><span class="ident" id="5711669">x</span><span class="op" id="5711670">,</span>&nbsp;<span class="ident" id="5711672">infinity</span><span class="op" id="5711680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711684">pair</span><span class="op" id="5711688">,</span>&nbsp;<span class="ident" id="5711690">isPair</span>&nbsp;<span class="op" id="5711697">:=</span>&nbsp;<span class="ident" id="5711700">x</span><span class="op" id="5711701">.</span><span class="op" id="5711702">(</span><span class="op" id="5711703">*</span><span class="ident" id="5711704">ast</span><span class="op" id="5711707">.</span><span class="ident" id="5711708">KeyValueExpr</span><span class="op" id="5711720">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711724">if</span>&nbsp;<span class="ident" id="5711727">size</span>&nbsp;<span class="op" id="5711732">&lt;=</span>&nbsp;<span class="ident" id="5711735">infinity</span>&nbsp;<span class="op" id="5711744">&amp;&amp;</span>&nbsp;<span class="ident" id="5711747">prev</span><span class="op" id="5711751">.</span><span class="ident" id="5711752">IsValid</span><span class="op" id="5711759">(</span><span class="op" id="5711760">)</span>&nbsp;<span class="op" id="5711762">&amp;&amp;</span>&nbsp;<span class="ident" id="5711765">next</span><span class="op" id="5711769">.</span><span class="ident" id="5711770">IsValid</span><span class="op" id="5711777">(</span><span class="op" id="5711778">)</span>&nbsp;<span class="op" id="5711780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711785">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711815">if</span>&nbsp;<span class="ident" id="5711818">isPair</span>&nbsp;<span class="op" id="5711825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711831">size</span>&nbsp;<span class="op" id="5711836">=</span>&nbsp;<span class="ident" id="5711838">p</span><span class="op" id="5711839">.</span><span class="ident" id="5711840">nodeSize</span><span class="op" id="5711848">(</span><span class="ident" id="5711849">pair</span><span class="op" id="5711853">.</span><span class="ident" id="5711854">Key</span><span class="op" id="5711857">,</span>&nbsp;<span class="ident" id="5711859">infinity</span><span class="op" id="5711867">)</span>&nbsp;<span class="comment" id="5711869">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711892">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711896">}</span>&nbsp;<span class="keyword" id="5711898">else</span>&nbsp;<span class="op" id="5711903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711908">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711970">size</span>&nbsp;<span class="op" id="5711975">=</span>&nbsp;<span class="num" id="5711977">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711986">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712045">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712102">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712157">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712211">if</span>&nbsp;<span class="ident" id="5712214">prevSize</span>&nbsp;<span class="op" id="5712223">&gt;</span>&nbsp;<span class="num" id="5712225">0</span>&nbsp;<span class="op" id="5712227">&amp;&amp;</span>&nbsp;<span class="ident" id="5712230">size</span>&nbsp;<span class="op" id="5712235">&gt;</span>&nbsp;<span class="num" id="5712237">0</span>&nbsp;<span class="op" id="5712239">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712244">const</span>&nbsp;<span class="ident" id="5712250">smallSize</span>&nbsp;<span class="op" id="5712260">=</span>&nbsp;<span class="num" id="5712262">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712268">if</span>&nbsp;<span class="ident" id="5712271">prevSize</span>&nbsp;<span class="op" id="5712280">&lt;=</span>&nbsp;<span class="ident" id="5712283">smallSize</span>&nbsp;<span class="op" id="5712293">&amp;&amp;</span>&nbsp;<span class="ident" id="5712296">size</span>&nbsp;<span class="op" id="5712301">&lt;=</span>&nbsp;<span class="ident" id="5712304">smallSize</span>&nbsp;<span class="op" id="5712314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712320">useFF</span>&nbsp;<span class="op" id="5712326">=</span>&nbsp;<span class="ident" id="5712328">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712337">}</span>&nbsp;<span class="keyword" id="5712339">else</span>&nbsp;<span class="op" id="5712344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712350">const</span>&nbsp;<span class="ident" id="5712356">r</span>&nbsp;<span class="op" id="5712358">=</span>&nbsp;<span class="num" id="5712360">4</span>&nbsp;<span class="comment" id="5712362">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712379">ratio</span>&nbsp;<span class="op" id="5712385">:=</span>&nbsp;<span class="builtintype" id="5712388">float64</span><span class="op" id="5712395">(</span><span class="ident" id="5712396">size</span><span class="op" id="5712400">)</span>&nbsp;<span class="op" id="5712402">/</span>&nbsp;<span class="builtintype" id="5712404">float64</span><span class="op" id="5712411">(</span><span class="ident" id="5712412">prevSize</span><span class="op" id="5712420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712426">useFF</span>&nbsp;<span class="op" id="5712432">=</span>&nbsp;<span class="ident" id="5712434">ratio</span>&nbsp;<span class="op" id="5712440">&lt;=</span>&nbsp;<span class="num" id="5712443">1.0</span><span class="op" id="5712446">/</span><span class="ident" id="5712447">r</span>&nbsp;<span class="op" id="5712449">||</span>&nbsp;<span class="ident" id="5712452">r</span>&nbsp;<span class="op" id="5712454">&lt;=</span>&nbsp;<span class="ident" id="5712457">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712475">needsLinebreak</span>&nbsp;<span class="op" id="5712490">:=</span>&nbsp;<span class="num" id="5712493">0</span>&nbsp;<span class="op" id="5712495">&lt;</span>&nbsp;<span class="ident" id="5712497">prevLine</span>&nbsp;<span class="op" id="5712506">&amp;&amp;</span>&nbsp;<span class="ident" id="5712509">prevLine</span>&nbsp;<span class="op" id="5712518">&lt;</span>&nbsp;<span class="ident" id="5712520">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712527">if</span>&nbsp;<span class="ident" id="5712530">i</span>&nbsp;<span class="op" id="5712532">&gt;</span>&nbsp;<span class="num" id="5712534">0</span>&nbsp;<span class="op" id="5712536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712541">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712597">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712653">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712702">if</span>&nbsp;<span class="op" id="5712705">!</span><span class="ident" id="5712706">needsLinebreak</span>&nbsp;<span class="op" id="5712721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712727">p</span><span class="op" id="5712728">.</span><span class="builtinfunc" id="5712729">print</span><span class="op" id="5712734">(</span><span class="ident" id="5712735">x</span><span class="op" id="5712736">.</span><span class="ident" id="5712737">Pos</span><span class="op" id="5712740">(</span><span class="op" id="5712741">)</span><span class="op" id="5712742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712752">p</span><span class="op" id="5712753">.</span><span class="builtinfunc" id="5712754">print</span><span class="op" id="5712759">(</span><span class="ident" id="5712760">token</span><span class="op" id="5712765">.</span><span class="ident" id="5712766">COMMA</span><span class="op" id="5712771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712776">needsBlank</span>&nbsp;<span class="op" id="5712787">:=</span>&nbsp;<span class="ident" id="5712790">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712798">if</span>&nbsp;<span class="ident" id="5712801">needsLinebreak</span>&nbsp;<span class="op" id="5712816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712822">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712888">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712954">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713006">if</span>&nbsp;<span class="ident" id="5713009">p</span><span class="op" id="5713010">.</span><span class="ident" id="5713011">linebreak</span><span class="op" id="5713020">(</span><span class="ident" id="5713021">line</span><span class="op" id="5713025">,</span>&nbsp;<span class="num" id="5713027">0</span><span class="op" id="5713028">,</span>&nbsp;<span class="ident" id="5713030">ws</span><span class="op" id="5713032">,</span>&nbsp;<span class="ident" id="5713034">useFF</span>&nbsp;<span class="op" id="5713040">||</span>&nbsp;<span class="ident" id="5713043">prevBreak</span><span class="op" id="5713052">+</span><span class="num" id="5713053">1</span>&nbsp;<span class="op" id="5713055">&lt;</span>&nbsp;<span class="ident" id="5713057">i</span><span class="op" id="5713058">)</span>&nbsp;<span class="op" id="5713060">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713067">ws</span>&nbsp;<span class="op" id="5713070">=</span>&nbsp;<span class="ident" id="5713072">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713084">prevBreak</span>&nbsp;<span class="op" id="5713094">=</span>&nbsp;<span class="ident" id="5713096">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713103">needsBlank</span>&nbsp;<span class="op" id="5713114">=</span>&nbsp;<span class="ident" id="5713116">false</span>&nbsp;<span class="comment" id="5713122">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713162">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713167">if</span>&nbsp;<span class="ident" id="5713170">needsBlank</span>&nbsp;<span class="op" id="5713181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713187">p</span><span class="op" id="5713188">.</span><span class="builtinfunc" id="5713189">print</span><span class="op" id="5713194">(</span><span class="ident" id="5713195">blank</span><span class="op" id="5713200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713214">if</span>&nbsp;<span class="builtinfunc" id="5713217">len</span><span class="op" id="5713220">(</span><span class="ident" id="5713221">list</span><span class="op" id="5713225">)</span>&nbsp;<span class="op" id="5713227">&gt;</span>&nbsp;<span class="num" id="5713229">1</span>&nbsp;<span class="op" id="5713231">&amp;&amp;</span>&nbsp;<span class="ident" id="5713234">isPair</span>&nbsp;<span class="op" id="5713241">&amp;&amp;</span>&nbsp;<span class="ident" id="5713244">size</span>&nbsp;<span class="op" id="5713249">&gt;</span>&nbsp;<span class="num" id="5713251">0</span>&nbsp;<span class="op" id="5713253">&amp;&amp;</span>&nbsp;<span class="ident" id="5713256">needsLinebreak</span>&nbsp;<span class="op" id="5713271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713276">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713337">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713398">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713459">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713487">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713549">p</span><span class="op" id="5713550">.</span><span class="ident" id="5713551">expr</span><span class="op" id="5713555">(</span><span class="ident" id="5713556">pair</span><span class="op" id="5713560">.</span><span class="ident" id="5713561">Key</span><span class="op" id="5713564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713569">p</span><span class="op" id="5713570">.</span><span class="builtinfunc" id="5713571">print</span><span class="op" id="5713576">(</span><span class="ident" id="5713577">pair</span><span class="op" id="5713581">.</span><span class="ident" id="5713582">Colon</span><span class="op" id="5713587">,</span>&nbsp;<span class="ident" id="5713589">token</span><span class="op" id="5713594">.</span><span class="ident" id="5713595">COLON</span><span class="op" id="5713600">,</span>&nbsp;<span class="ident" id="5713602">vtab</span><span class="op" id="5713606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713611">p</span><span class="op" id="5713612">.</span><span class="ident" id="5713613">expr</span><span class="op" id="5713617">(</span><span class="ident" id="5713618">pair</span><span class="op" id="5713622">.</span><span class="ident" id="5713623">Value</span><span class="op" id="5713628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713632">}</span>&nbsp;<span class="keyword" id="5713634">else</span>&nbsp;<span class="op" id="5713639">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713644">p</span><span class="op" id="5713645">.</span><span class="ident" id="5713646">expr0</span><span class="op" id="5713651">(</span><span class="ident" id="5713652">x</span><span class="op" id="5713653">,</span>&nbsp;<span class="ident" id="5713655">depth</span><span class="op" id="5713660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713669">prevLine</span>&nbsp;<span class="op" id="5713678">=</span>&nbsp;<span class="ident" id="5713680">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713686">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713690">if</span>&nbsp;<span class="ident" id="5713693">mode</span><span class="op" id="5713697">&amp;</span><span class="ident" id="5713698">commaTerm</span>&nbsp;<span class="op" id="5713708">!=</span>&nbsp;<span class="num" id="5713711">0</span>&nbsp;<span class="op" id="5713713">&amp;&amp;</span>&nbsp;<span class="ident" id="5713716">next</span><span class="op" id="5713720">.</span><span class="ident" id="5713721">IsValid</span><span class="op" id="5713728">(</span><span class="op" id="5713729">)</span>&nbsp;<span class="op" id="5713731">&amp;&amp;</span>&nbsp;<span class="ident" id="5713734">p</span><span class="op" id="5713735">.</span><span class="ident" id="5713736">pos</span><span class="op" id="5713739">.</span><span class="ident" id="5713740">Line</span>&nbsp;<span class="op" id="5713745">&lt;</span>&nbsp;<span class="ident" id="5713747">next</span><span class="op" id="5713751">.</span><span class="ident" id="5713752">Line</span>&nbsp;<span class="op" id="5713757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713761">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713827">p</span><span class="op" id="5713828">.</span><span class="builtinfunc" id="5713829">print</span><span class="op" id="5713834">(</span><span class="ident" id="5713835">token</span><span class="op" id="5713840">.</span><span class="ident" id="5713841">COMMA</span><span class="op" id="5713846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713850">if</span>&nbsp;<span class="ident" id="5713853">ws</span>&nbsp;<span class="op" id="5713856">==</span>&nbsp;<span class="ident" id="5713859">ignore</span>&nbsp;<span class="op" id="5713866">&amp;&amp;</span>&nbsp;<span class="ident" id="5713869">mode</span><span class="op" id="5713873">&amp;</span><span class="ident" id="5713874">noIndent</span>&nbsp;<span class="op" id="5713883">==</span>&nbsp;<span class="num" id="5713886">0</span>&nbsp;<span class="op" id="5713888">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713893">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713923">p</span><span class="op" id="5713924">.</span><span class="builtinfunc" id="5713925">print</span><span class="op" id="5713930">(</span><span class="ident" id="5713931">unindent</span><span class="op" id="5713939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713947">p</span><span class="op" id="5713948">.</span><span class="builtinfunc" id="5713949">print</span><span class="op" id="5713954">(</span><span class="ident" id="5713955">formfeed</span><span class="op" id="5713963">)</span>&nbsp;<span class="comment" id="5713965">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714020">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714032">if</span>&nbsp;<span class="ident" id="5714035">ws</span>&nbsp;<span class="op" id="5714038">==</span>&nbsp;<span class="ident" id="5714041">ignore</span>&nbsp;<span class="op" id="5714048">&amp;&amp;</span>&nbsp;<span class="ident" id="5714051">mode</span><span class="op" id="5714055">&amp;</span><span class="ident" id="5714056">noIndent</span>&nbsp;<span class="op" id="5714065">==</span>&nbsp;<span class="num" id="5714068">0</span>&nbsp;<span class="op" id="5714070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714074">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714103">p</span><span class="op" id="5714104">.</span><span class="builtinfunc" id="5714105">print</span><span class="op" id="5714110">(</span><span class="ident" id="5714111">unindent</span><span class="op" id="5714119">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714122">}</span><br>
<span class="lineno"></span><span class="op" id="5714124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714127">func</span>&nbsp;<span class="op" id="5714132">(</span><span class="ident" id="5714133">p</span>&nbsp;<span class="op" id="5714135">*</span><span class="ident" id="5714136">printer</span><span class="op" id="5714143">)</span>&nbsp;<span class="ident" id="5714145">parameters</span><span class="op" id="5714155">(</span><span class="ident" id="5714156">fields</span>&nbsp;<span class="op" id="5714163">*</span><span class="ident" id="5714164">ast</span><span class="op" id="5714167">.</span><span class="ident" id="5714168">FieldList</span><span class="op" id="5714177">)</span>&nbsp;<span class="op" id="5714179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714182">p</span><span class="op" id="5714183">.</span><span class="builtinfunc" id="5714184">print</span><span class="op" id="5714189">(</span><span class="ident" id="5714190">fields</span><span class="op" id="5714196">.</span><span class="ident" id="5714197">Opening</span><span class="op" id="5714204">,</span>&nbsp;<span class="ident" id="5714206">token</span><span class="op" id="5714211">.</span><span class="ident" id="5714212">LPAREN</span><span class="op" id="5714218">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714221">if</span>&nbsp;<span class="builtinfunc" id="5714224">len</span><span class="op" id="5714227">(</span><span class="ident" id="5714228">fields</span><span class="op" id="5714234">.</span><span class="ident" id="5714235">List</span><span class="op" id="5714239">)</span>&nbsp;<span class="op" id="5714241">&gt;</span>&nbsp;<span class="num" id="5714243">0</span>&nbsp;<span class="op" id="5714245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714249">prevLine</span>&nbsp;<span class="op" id="5714258">:=</span>&nbsp;<span class="ident" id="5714261">p</span><span class="op" id="5714262">.</span><span class="ident" id="5714263">lineFor</span><span class="op" id="5714270">(</span><span class="ident" id="5714271">fields</span><span class="op" id="5714277">.</span><span class="ident" id="5714278">Opening</span><span class="op" id="5714285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714289">ws</span>&nbsp;<span class="op" id="5714292">:=</span>&nbsp;<span class="ident" id="5714295">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714304">for</span>&nbsp;<span class="ident" id="5714308">i</span><span class="op" id="5714309">,</span>&nbsp;<span class="ident" id="5714311">par</span>&nbsp;<span class="op" id="5714315">:=</span>&nbsp;<span class="keyword" id="5714318">range</span>&nbsp;<span class="ident" id="5714324">fields</span><span class="op" id="5714330">.</span><span class="ident" id="5714331">List</span>&nbsp;<span class="op" id="5714336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714341">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714398">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714455">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714496">var</span>&nbsp;<span class="ident" id="5714500">parLineBeg</span>&nbsp;<span class="builtintype" id="5714511">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714518">if</span>&nbsp;<span class="builtinfunc" id="5714521">len</span><span class="op" id="5714524">(</span><span class="ident" id="5714525">par</span><span class="op" id="5714528">.</span><span class="ident" id="5714529">Names</span><span class="op" id="5714534">)</span>&nbsp;<span class="op" id="5714536">&gt;</span>&nbsp;<span class="num" id="5714538">0</span>&nbsp;<span class="op" id="5714540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714546">parLineBeg</span>&nbsp;<span class="op" id="5714557">=</span>&nbsp;<span class="ident" id="5714559">p</span><span class="op" id="5714560">.</span><span class="ident" id="5714561">lineFor</span><span class="op" id="5714568">(</span><span class="ident" id="5714569">par</span><span class="op" id="5714572">.</span><span class="ident" id="5714573">Names</span><span class="op" id="5714578">[</span><span class="num" id="5714579">0</span><span class="op" id="5714580">]</span><span class="op" id="5714581">.</span><span class="ident" id="5714582">Pos</span><span class="op" id="5714585">(</span><span class="op" id="5714586">)</span><span class="op" id="5714587">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714592">}</span>&nbsp;<span class="keyword" id="5714594">else</span>&nbsp;<span class="op" id="5714599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714605">parLineBeg</span>&nbsp;<span class="op" id="5714616">=</span>&nbsp;<span class="ident" id="5714618">p</span><span class="op" id="5714619">.</span><span class="ident" id="5714620">lineFor</span><span class="op" id="5714627">(</span><span class="ident" id="5714628">par</span><span class="op" id="5714631">.</span><span class="ident" id="5714632">Type</span><span class="op" id="5714636">.</span><span class="ident" id="5714637">Pos</span><span class="op" id="5714640">(</span><span class="op" id="5714641">)</span><span class="op" id="5714642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714652">var</span>&nbsp;<span class="ident" id="5714656">parLineEnd</span>&nbsp;<span class="op" id="5714667">=</span>&nbsp;<span class="ident" id="5714669">p</span><span class="op" id="5714670">.</span><span class="ident" id="5714671">lineFor</span><span class="op" id="5714678">(</span><span class="ident" id="5714679">par</span><span class="op" id="5714682">.</span><span class="ident" id="5714683">Type</span><span class="op" id="5714687">.</span><span class="ident" id="5714688">End</span><span class="op" id="5714691">(</span><span class="op" id="5714692">)</span><span class="op" id="5714693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714698">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714729">needsLinebreak</span>&nbsp;<span class="op" id="5714744">:=</span>&nbsp;<span class="num" id="5714747">0</span>&nbsp;<span class="op" id="5714749">&lt;</span>&nbsp;<span class="ident" id="5714751">prevLine</span>&nbsp;<span class="op" id="5714760">&amp;&amp;</span>&nbsp;<span class="ident" id="5714763">prevLine</span>&nbsp;<span class="op" id="5714772">&lt;</span>&nbsp;<span class="ident" id="5714774">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714788">if</span>&nbsp;<span class="ident" id="5714791">i</span>&nbsp;<span class="op" id="5714793">&gt;</span>&nbsp;<span class="num" id="5714795">0</span>&nbsp;<span class="op" id="5714797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714803">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714859">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714914">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714968">if</span>&nbsp;<span class="op" id="5714971">!</span><span class="ident" id="5714972">needsLinebreak</span>&nbsp;<span class="op" id="5714987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714994">p</span><span class="op" id="5714995">.</span><span class="builtinfunc" id="5714996">print</span><span class="op" id="5715001">(</span><span class="ident" id="5715002">par</span><span class="op" id="5715005">.</span><span class="ident" id="5715006">Pos</span><span class="op" id="5715009">(</span><span class="op" id="5715010">)</span><span class="op" id="5715011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715023">p</span><span class="op" id="5715024">.</span><span class="builtinfunc" id="5715025">print</span><span class="op" id="5715030">(</span><span class="ident" id="5715031">token</span><span class="op" id="5715036">.</span><span class="ident" id="5715037">COMMA</span><span class="op" id="5715042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715047">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715052">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715099">if</span>&nbsp;<span class="ident" id="5715102">needsLinebreak</span>&nbsp;<span class="op" id="5715117">&amp;&amp;</span>&nbsp;<span class="ident" id="5715120">p</span><span class="op" id="5715121">.</span><span class="ident" id="5715122">linebreak</span><span class="op" id="5715131">(</span><span class="ident" id="5715132">parLineBeg</span><span class="op" id="5715142">,</span>&nbsp;<span class="num" id="5715144">0</span><span class="op" id="5715145">,</span>&nbsp;<span class="ident" id="5715147">ws</span><span class="op" id="5715149">,</span>&nbsp;<span class="ident" id="5715151">true</span><span class="op" id="5715155">)</span>&nbsp;<span class="op" id="5715157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715163">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715248">ws</span>&nbsp;<span class="op" id="5715251">=</span>&nbsp;<span class="ident" id="5715253">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715263">}</span>&nbsp;<span class="keyword" id="5715265">else</span>&nbsp;<span class="keyword" id="5715270">if</span>&nbsp;<span class="ident" id="5715273">i</span>&nbsp;<span class="op" id="5715275">&gt;</span>&nbsp;<span class="num" id="5715277">0</span>&nbsp;<span class="op" id="5715279">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715285">p</span><span class="op" id="5715286">.</span><span class="builtinfunc" id="5715287">print</span><span class="op" id="5715292">(</span><span class="ident" id="5715293">blank</span><span class="op" id="5715298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715308">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715330">if</span>&nbsp;<span class="builtinfunc" id="5715333">len</span><span class="op" id="5715336">(</span><span class="ident" id="5715337">par</span><span class="op" id="5715340">.</span><span class="ident" id="5715341">Names</span><span class="op" id="5715346">)</span>&nbsp;<span class="op" id="5715348">&gt;</span>&nbsp;<span class="num" id="5715350">0</span>&nbsp;<span class="op" id="5715352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715358">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715426">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715497">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715570">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715646">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715723">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715755">p</span><span class="op" id="5715756">.</span><span class="ident" id="5715757">identList</span><span class="op" id="5715766">(</span><span class="ident" id="5715767">par</span><span class="op" id="5715770">.</span><span class="ident" id="5715771">Names</span><span class="op" id="5715776">,</span>&nbsp;<span class="ident" id="5715778">ws</span>&nbsp;<span class="op" id="5715781">==</span>&nbsp;<span class="ident" id="5715784">indent</span><span class="op" id="5715790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715796">p</span><span class="op" id="5715797">.</span><span class="builtinfunc" id="5715798">print</span><span class="op" id="5715803">(</span><span class="ident" id="5715804">blank</span><span class="op" id="5715809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715819">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715840">p</span><span class="op" id="5715841">.</span><span class="ident" id="5715842">expr</span><span class="op" id="5715846">(</span><span class="ident" id="5715847">stripParensAlways</span><span class="op" id="5715864">(</span><span class="ident" id="5715865">par</span><span class="op" id="5715868">.</span><span class="ident" id="5715869">Type</span><span class="op" id="5715873">)</span><span class="op" id="5715874">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715879">prevLine</span>&nbsp;<span class="op" id="5715888">=</span>&nbsp;<span class="ident" id="5715890">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715907">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715978">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716022">if</span>&nbsp;<span class="ident" id="5716025">closing</span>&nbsp;<span class="op" id="5716033">:=</span>&nbsp;<span class="ident" id="5716036">p</span><span class="op" id="5716037">.</span><span class="ident" id="5716038">lineFor</span><span class="op" id="5716045">(</span><span class="ident" id="5716046">fields</span><span class="op" id="5716052">.</span><span class="ident" id="5716053">Closing</span><span class="op" id="5716060">)</span><span class="op" id="5716061">;</span>&nbsp;<span class="num" id="5716063">0</span>&nbsp;<span class="op" id="5716065">&lt;</span>&nbsp;<span class="ident" id="5716067">prevLine</span>&nbsp;<span class="op" id="5716076">&amp;&amp;</span>&nbsp;<span class="ident" id="5716079">prevLine</span>&nbsp;<span class="op" id="5716088">&lt;</span>&nbsp;<span class="ident" id="5716090">closing</span>&nbsp;<span class="op" id="5716098">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716103">p</span><span class="op" id="5716104">.</span><span class="builtinfunc" id="5716105">print</span><span class="op" id="5716110">(</span><span class="ident" id="5716111">token</span><span class="op" id="5716116">.</span><span class="ident" id="5716117">COMMA</span><span class="op" id="5716122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716127">p</span><span class="op" id="5716128">.</span><span class="ident" id="5716129">linebreak</span><span class="op" id="5716138">(</span><span class="ident" id="5716139">closing</span><span class="op" id="5716146">,</span>&nbsp;<span class="num" id="5716148">0</span><span class="op" id="5716149">,</span>&nbsp;<span class="ident" id="5716151">ignore</span><span class="op" id="5716157">,</span>&nbsp;<span class="ident" id="5716159">true</span><span class="op" id="5716163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5716171">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716200">if</span>&nbsp;<span class="ident" id="5716203">ws</span>&nbsp;<span class="op" id="5716206">==</span>&nbsp;<span class="ident" id="5716209">ignore</span>&nbsp;<span class="op" id="5716216">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716221">p</span><span class="op" id="5716222">.</span><span class="builtinfunc" id="5716223">print</span><span class="op" id="5716228">(</span><span class="ident" id="5716229">unindent</span><span class="op" id="5716237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716247">p</span><span class="op" id="5716248">.</span><span class="builtinfunc" id="5716249">print</span><span class="op" id="5716254">(</span><span class="ident" id="5716255">fields</span><span class="op" id="5716261">.</span><span class="ident" id="5716262">Closing</span><span class="op" id="5716269">,</span>&nbsp;<span class="ident" id="5716271">token</span><span class="op" id="5716276">.</span><span class="ident" id="5716277">RPAREN</span><span class="op" id="5716283">)</span><br>
<span class="lineno"></span><span class="op" id="5716285">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5716288">func</span>&nbsp;<span class="op" id="5716293">(</span><span class="ident" id="5716294">p</span>&nbsp;<span class="op" id="5716296">*</span><span class="ident" id="5716297">printer</span><span class="op" id="5716304">)</span>&nbsp;<span class="ident" id="5716306">signature</span><span class="op" id="5716315">(</span><span class="ident" id="5716316">params</span><span class="op" id="5716322">,</span>&nbsp;<span class="ident" id="5716324">result</span>&nbsp;<span class="op" id="5716331">*</span><span class="ident" id="5716332">ast</span><span class="op" id="5716335">.</span><span class="ident" id="5716336">FieldList</span><span class="op" id="5716345">)</span>&nbsp;<span class="op" id="5716347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716350">if</span>&nbsp;<span class="ident" id="5716353">params</span>&nbsp;<span class="op" id="5716360">!=</span>&nbsp;<span class="ident" id="5716363">nil</span>&nbsp;<span class="op" id="5716367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716371">p</span><span class="op" id="5716372">.</span><span class="ident" id="5716373">parameters</span><span class="op" id="5716383">(</span><span class="ident" id="5716384">params</span><span class="op" id="5716390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716393">}</span>&nbsp;<span class="keyword" id="5716395">else</span>&nbsp;<span class="op" id="5716400">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716404">p</span><span class="op" id="5716405">.</span><span class="builtinfunc" id="5716406">print</span><span class="op" id="5716411">(</span><span class="ident" id="5716412">token</span><span class="op" id="5716417">.</span><span class="ident" id="5716418">LPAREN</span><span class="op" id="5716424">,</span>&nbsp;<span class="ident" id="5716426">token</span><span class="op" id="5716431">.</span><span class="ident" id="5716432">RPAREN</span><span class="op" id="5716438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716444">n</span>&nbsp;<span class="op" id="5716446">:=</span>&nbsp;<span class="ident" id="5716449">result</span><span class="op" id="5716455">.</span><span class="ident" id="5716456">NumFields</span><span class="op" id="5716465">(</span><span class="op" id="5716466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716469">if</span>&nbsp;<span class="ident" id="5716472">n</span>&nbsp;<span class="op" id="5716474">&gt;</span>&nbsp;<span class="num" id="5716476">0</span>&nbsp;<span class="op" id="5716478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5716482">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716501">p</span><span class="op" id="5716502">.</span><span class="builtinfunc" id="5716503">print</span><span class="op" id="5716508">(</span><span class="ident" id="5716509">blank</span><span class="op" id="5716514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716518">if</span>&nbsp;<span class="ident" id="5716521">n</span>&nbsp;<span class="op" id="5716523">==</span>&nbsp;<span class="num" id="5716526">1</span>&nbsp;<span class="op" id="5716528">&amp;&amp;</span>&nbsp;<span class="ident" id="5716531">result</span><span class="op" id="5716537">.</span><span class="ident" id="5716538">List</span><span class="op" id="5716542">[</span><span class="num" id="5716543">0</span><span class="op" id="5716544">]</span><span class="op" id="5716545">.</span><span class="ident" id="5716546">Names</span>&nbsp;<span class="op" id="5716552">==</span>&nbsp;<span class="ident" id="5716555">nil</span>&nbsp;<span class="op" id="5716559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5716564">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716603">p</span><span class="op" id="5716604">.</span><span class="ident" id="5716605">expr</span><span class="op" id="5716609">(</span><span class="ident" id="5716610">stripParensAlways</span><span class="op" id="5716627">(</span><span class="ident" id="5716628">result</span><span class="op" id="5716634">.</span><span class="ident" id="5716635">List</span><span class="op" id="5716639">[</span><span class="num" id="5716640">0</span><span class="op" id="5716641">]</span><span class="op" id="5716642">.</span><span class="ident" id="5716643">Type</span><span class="op" id="5716647">)</span><span class="op" id="5716648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716653">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716666">p</span><span class="op" id="5716667">.</span><span class="ident" id="5716668">parameters</span><span class="op" id="5716678">(</span><span class="ident" id="5716679">result</span><span class="op" id="5716685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716688">}</span><br>
<span class="lineno"></span><span class="op" id="5716690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5716693">func</span>&nbsp;<span class="ident" id="5716698">identListSize</span><span class="op" id="5716711">(</span><span class="ident" id="5716712">list</span>&nbsp;<span class="op" id="5716717">[</span><span class="op" id="5716718">]</span><span class="op" id="5716719">*</span><span class="ident" id="5716720">ast</span><span class="op" id="5716723">.</span><span class="ident" id="5716724">Ident</span><span class="op" id="5716729">,</span>&nbsp;<span class="ident" id="5716731">maxSize</span>&nbsp;<span class="builtintype" id="5716739">int</span><span class="op" id="5716742">)</span>&nbsp;<span class="op" id="5716744">(</span><span class="ident" id="5716745">size</span>&nbsp;<span class="builtintype" id="5716750">int</span><span class="op" id="5716753">)</span>&nbsp;<span class="op" id="5716755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716758">for</span>&nbsp;<span class="ident" id="5716762">i</span><span class="op" id="5716763">,</span>&nbsp;<span class="ident" id="5716765">x</span>&nbsp;<span class="op" id="5716767">:=</span>&nbsp;<span class="keyword" id="5716770">range</span>&nbsp;<span class="ident" id="5716776">list</span>&nbsp;<span class="op" id="5716781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716785">if</span>&nbsp;<span class="ident" id="5716788">i</span>&nbsp;<span class="op" id="5716790">&gt;</span>&nbsp;<span class="num" id="5716792">0</span>&nbsp;<span class="op" id="5716794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716799">size</span>&nbsp;<span class="op" id="5716804">+=</span>&nbsp;<span class="builtinfunc" id="5716807">len</span><span class="op" id="5716810">(</span><span class="string" id="5716811">&#34;,&nbsp;&#34;</span><span class="op" id="5716815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716819">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716823">size</span>&nbsp;<span class="op" id="5716828">+=</span>&nbsp;<span class="ident" id="5716831">utf8</span><span class="op" id="5716835">.</span><span class="ident" id="5716836">RuneCountInString</span><span class="op" id="5716853">(</span><span class="ident" id="5716854">x</span><span class="op" id="5716855">.</span><span class="ident" id="5716856">Name</span><span class="op" id="5716860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716864">if</span>&nbsp;<span class="ident" id="5716867">size</span>&nbsp;<span class="op" id="5716872">&gt;=</span>&nbsp;<span class="ident" id="5716875">maxSize</span>&nbsp;<span class="op" id="5716883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716888">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716899">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716902">return</span><br>
<span class="lineno"></span><span class="op" id="5716909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5716912">func</span>&nbsp;<span class="op" id="5716917">(</span><span class="ident" id="5716918">p</span>&nbsp;<span class="op" id="5716920">*</span><span class="ident" id="5716921">printer</span><span class="op" id="5716928">)</span>&nbsp;<span class="ident" id="5716930">isOneLineFieldList</span><span class="op" id="5716948">(</span><span class="ident" id="5716949">list</span>&nbsp;<span class="op" id="5716954">[</span><span class="op" id="5716955">]</span><span class="op" id="5716956">*</span><span class="ident" id="5716957">ast</span><span class="op" id="5716960">.</span><span class="ident" id="5716961">Field</span><span class="op" id="5716966">)</span>&nbsp;<span class="builtintype" id="5716968">bool</span>&nbsp;<span class="op" id="5716973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716976">if</span>&nbsp;<span class="builtinfunc" id="5716979">len</span><span class="op" id="5716982">(</span><span class="ident" id="5716983">list</span><span class="op" id="5716987">)</span>&nbsp;<span class="op" id="5716989">!=</span>&nbsp;<span class="num" id="5716992">1</span>&nbsp;<span class="op" id="5716994">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716998">return</span>&nbsp;<span class="ident" id="5717005">false</span>&nbsp;<span class="comment" id="5717011">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717039">f</span>&nbsp;<span class="op" id="5717041">:=</span>&nbsp;<span class="ident" id="5717044">list</span><span class="op" id="5717048">[</span><span class="num" id="5717049">0</span><span class="op" id="5717050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717053">if</span>&nbsp;<span class="ident" id="5717056">f</span><span class="op" id="5717057">.</span><span class="ident" id="5717058">Tag</span>&nbsp;<span class="op" id="5717062">!=</span>&nbsp;<span class="ident" id="5717065">nil</span>&nbsp;<span class="op" id="5717069">||</span>&nbsp;<span class="ident" id="5717072">f</span><span class="op" id="5717073">.</span><span class="ident" id="5717074">Comment</span>&nbsp;<span class="op" id="5717082">!=</span>&nbsp;<span class="ident" id="5717085">nil</span>&nbsp;<span class="op" id="5717089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717093">return</span>&nbsp;<span class="ident" id="5717100">false</span>&nbsp;<span class="comment" id="5717106">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717142">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717168">const</span>&nbsp;<span class="ident" id="5717174">maxSize</span>&nbsp;<span class="op" id="5717182">=</span>&nbsp;<span class="num" id="5717184">30</span>&nbsp;<span class="comment" id="5717187">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717243">namesSize</span>&nbsp;<span class="op" id="5717253">:=</span>&nbsp;<span class="ident" id="5717256">identListSize</span><span class="op" id="5717269">(</span><span class="ident" id="5717270">f</span><span class="op" id="5717271">.</span><span class="ident" id="5717272">Names</span><span class="op" id="5717277">,</span>&nbsp;<span class="ident" id="5717279">maxSize</span><span class="op" id="5717286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717289">if</span>&nbsp;<span class="ident" id="5717292">namesSize</span>&nbsp;<span class="op" id="5717302">&gt;</span>&nbsp;<span class="num" id="5717304">0</span>&nbsp;<span class="op" id="5717306">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717310">namesSize</span>&nbsp;<span class="op" id="5717320">=</span>&nbsp;<span class="num" id="5717322">1</span>&nbsp;<span class="comment" id="5717324">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717361">typeSize</span>&nbsp;<span class="op" id="5717370">:=</span>&nbsp;<span class="ident" id="5717373">p</span><span class="op" id="5717374">.</span><span class="ident" id="5717375">nodeSize</span><span class="op" id="5717383">(</span><span class="ident" id="5717384">f</span><span class="op" id="5717385">.</span><span class="ident" id="5717386">Type</span><span class="op" id="5717390">,</span>&nbsp;<span class="ident" id="5717392">maxSize</span><span class="op" id="5717399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717402">return</span>&nbsp;<span class="ident" id="5717409">namesSize</span><span class="op" id="5717418">+</span><span class="ident" id="5717419">typeSize</span>&nbsp;<span class="op" id="5717428">&lt;=</span>&nbsp;<span class="ident" id="5717431">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5717439">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5717442">func</span>&nbsp;<span class="op" id="5717447">(</span><span class="ident" id="5717448">p</span>&nbsp;<span class="op" id="5717450">*</span><span class="ident" id="5717451">printer</span><span class="op" id="5717458">)</span>&nbsp;<span class="ident" id="5717460">setLineComment</span><span class="op" id="5717474">(</span><span class="ident" id="5717475">text</span>&nbsp;<span class="builtintype" id="5717480">string</span><span class="op" id="5717486">)</span>&nbsp;<span class="op" id="5717488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717491">p</span><span class="op" id="5717492">.</span><span class="ident" id="5717493">setComment</span><span class="op" id="5717503">(</span><span class="op" id="5717504">&amp;</span><span class="ident" id="5717505">ast</span><span class="op" id="5717508">.</span><span class="ident" id="5717509">CommentGroup</span><span class="op" id="5717521">{</span><span class="ident" id="5717522">List</span><span class="op" id="5717526">:</span>&nbsp;<span class="op" id="5717528">[</span><span class="op" id="5717529">]</span><span class="op" id="5717530">*</span><span class="ident" id="5717531">ast</span><span class="op" id="5717534">.</span><span class="ident" id="5717535">Comment</span><span class="op" id="5717542">{</span><span class="op" id="5717543">{</span><span class="ident" id="5717544">Slash</span><span class="op" id="5717549">:</span>&nbsp;<span class="ident" id="5717551">token</span><span class="op" id="5717556">.</span><span class="ident" id="5717557">NoPos</span><span class="op" id="5717562">,</span>&nbsp;<span class="ident" id="5717564">Text</span><span class="op" id="5717568">:</span>&nbsp;<span class="ident" id="5717570">text</span><span class="op" id="5717574">}</span><span class="op" id="5717575">}</span><span class="op" id="5717576">}</span><span class="op" id="5717577">)</span><br>
<span class="lineno"></span><span class="op" id="5717579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5717582">func</span>&nbsp;<span class="op" id="5717587">(</span><span class="ident" id="5717588">p</span>&nbsp;<span class="op" id="5717590">*</span><span class="ident" id="5717591">printer</span><span class="op" id="5717598">)</span>&nbsp;<span class="ident" id="5717600">fieldList</span><span class="op" id="5717609">(</span><span class="ident" id="5717610">fields</span>&nbsp;<span class="op" id="5717617">*</span><span class="ident" id="5717618">ast</span><span class="op" id="5717621">.</span><span class="ident" id="5717622">FieldList</span><span class="op" id="5717631">,</span>&nbsp;<span class="ident" id="5717633">isStruct</span><span class="op" id="5717641">,</span>&nbsp;<span class="ident" id="5717643">isIncomplete</span>&nbsp;<span class="builtintype" id="5717656">bool</span><span class="op" id="5717660">)</span>&nbsp;<span class="op" id="5717662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717665">lbrace</span>&nbsp;<span class="op" id="5717672">:=</span>&nbsp;<span class="ident" id="5717675">fields</span><span class="op" id="5717681">.</span><span class="ident" id="5717682">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717691">list</span>&nbsp;<span class="op" id="5717696">:=</span>&nbsp;<span class="ident" id="5717699">fields</span><span class="op" id="5717705">.</span><span class="ident" id="5717706">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717712">rbrace</span>&nbsp;<span class="op" id="5717719">:=</span>&nbsp;<span class="ident" id="5717722">fields</span><span class="op" id="5717728">.</span><span class="ident" id="5717729">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717738">hasComments</span>&nbsp;<span class="op" id="5717750">:=</span>&nbsp;<span class="ident" id="5717753">isIncomplete</span>&nbsp;<span class="op" id="5717766">||</span>&nbsp;<span class="ident" id="5717769">p</span><span class="op" id="5717770">.</span><span class="ident" id="5717771">commentBefore</span><span class="op" id="5717784">(</span><span class="ident" id="5717785">p</span><span class="op" id="5717786">.</span><span class="ident" id="5717787">posFor</span><span class="op" id="5717793">(</span><span class="ident" id="5717794">rbrace</span><span class="op" id="5717800">)</span><span class="op" id="5717801">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717804">srcIsOneLine</span>&nbsp;<span class="op" id="5717817">:=</span>&nbsp;<span class="ident" id="5717820">lbrace</span><span class="op" id="5717826">.</span><span class="ident" id="5717827">IsValid</span><span class="op" id="5717834">(</span><span class="op" id="5717835">)</span>&nbsp;<span class="op" id="5717837">&amp;&amp;</span>&nbsp;<span class="ident" id="5717840">rbrace</span><span class="op" id="5717846">.</span><span class="ident" id="5717847">IsValid</span><span class="op" id="5717854">(</span><span class="op" id="5717855">)</span>&nbsp;<span class="op" id="5717857">&amp;&amp;</span>&nbsp;<span class="ident" id="5717860">p</span><span class="op" id="5717861">.</span><span class="ident" id="5717862">lineFor</span><span class="op" id="5717869">(</span><span class="ident" id="5717870">lbrace</span><span class="op" id="5717876">)</span>&nbsp;<span class="op" id="5717878">==</span>&nbsp;<span class="ident" id="5717881">p</span><span class="op" id="5717882">.</span><span class="ident" id="5717883">lineFor</span><span class="op" id="5717890">(</span><span class="ident" id="5717891">rbrace</span><span class="op" id="5717897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717901">if</span>&nbsp;<span class="op" id="5717904">!</span><span class="ident" id="5717905">hasComments</span>&nbsp;<span class="op" id="5717917">&amp;&amp;</span>&nbsp;<span class="ident" id="5717920">srcIsOneLine</span>&nbsp;<span class="op" id="5717933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717937">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717979">if</span>&nbsp;<span class="builtinfunc" id="5717982">len</span><span class="op" id="5717985">(</span><span class="ident" id="5717986">list</span><span class="op" id="5717990">)</span>&nbsp;<span class="op" id="5717992">==</span>&nbsp;<span class="num" id="5717995">0</span>&nbsp;<span class="op" id="5717997">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718002">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718053">p</span><span class="op" id="5718054">.</span><span class="builtinfunc" id="5718055">print</span><span class="op" id="5718060">(</span><span class="ident" id="5718061">lbrace</span><span class="op" id="5718067">,</span>&nbsp;<span class="ident" id="5718069">token</span><span class="op" id="5718074">.</span><span class="ident" id="5718075">LBRACE</span><span class="op" id="5718081">,</span>&nbsp;<span class="ident" id="5718083">rbrace</span><span class="op" id="5718089">,</span>&nbsp;<span class="ident" id="5718091">token</span><span class="op" id="5718096">.</span><span class="ident" id="5718097">RBRACE</span><span class="op" id="5718103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718108">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718117">}</span>&nbsp;<span class="keyword" id="5718119">else</span>&nbsp;<span class="keyword" id="5718124">if</span>&nbsp;<span class="ident" id="5718127">isStruct</span>&nbsp;<span class="op" id="5718136">&amp;&amp;</span>&nbsp;<span class="ident" id="5718139">p</span><span class="op" id="5718140">.</span><span class="ident" id="5718141">isOneLineFieldList</span><span class="op" id="5718159">(</span><span class="ident" id="5718160">list</span><span class="op" id="5718164">)</span>&nbsp;<span class="op" id="5718166">{</span>&nbsp;<span class="comment" id="5718168">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718200">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718239">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718297">p</span><span class="op" id="5718298">.</span><span class="builtinfunc" id="5718299">print</span><span class="op" id="5718304">(</span><span class="ident" id="5718305">lbrace</span><span class="op" id="5718311">,</span>&nbsp;<span class="ident" id="5718313">token</span><span class="op" id="5718318">.</span><span class="ident" id="5718319">LBRACE</span><span class="op" id="5718325">,</span>&nbsp;<span class="ident" id="5718327">blank</span><span class="op" id="5718332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718337">f</span>&nbsp;<span class="op" id="5718339">:=</span>&nbsp;<span class="ident" id="5718342">list</span><span class="op" id="5718346">[</span><span class="num" id="5718347">0</span><span class="op" id="5718348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718353">for</span>&nbsp;<span class="ident" id="5718357">i</span><span class="op" id="5718358">,</span>&nbsp;<span class="ident" id="5718360">x</span>&nbsp;<span class="op" id="5718362">:=</span>&nbsp;<span class="keyword" id="5718365">range</span>&nbsp;<span class="ident" id="5718371">f</span><span class="op" id="5718372">.</span><span class="ident" id="5718373">Names</span>&nbsp;<span class="op" id="5718379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718385">if</span>&nbsp;<span class="ident" id="5718388">i</span>&nbsp;<span class="op" id="5718390">&gt;</span>&nbsp;<span class="num" id="5718392">0</span>&nbsp;<span class="op" id="5718394">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718401">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718451">p</span><span class="op" id="5718452">.</span><span class="builtinfunc" id="5718453">print</span><span class="op" id="5718458">(</span><span class="ident" id="5718459">token</span><span class="op" id="5718464">.</span><span class="ident" id="5718465">COMMA</span><span class="op" id="5718470">,</span>&nbsp;<span class="ident" id="5718472">blank</span><span class="op" id="5718477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718489">p</span><span class="op" id="5718490">.</span><span class="ident" id="5718491">expr</span><span class="op" id="5718495">(</span><span class="ident" id="5718496">x</span><span class="op" id="5718497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718502">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718507">if</span>&nbsp;<span class="builtinfunc" id="5718510">len</span><span class="op" id="5718513">(</span><span class="ident" id="5718514">f</span><span class="op" id="5718515">.</span><span class="ident" id="5718516">Names</span><span class="op" id="5718521">)</span>&nbsp;<span class="op" id="5718523">&gt;</span>&nbsp;<span class="num" id="5718525">0</span>&nbsp;<span class="op" id="5718527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718533">p</span><span class="op" id="5718534">.</span><span class="builtinfunc" id="5718535">print</span><span class="op" id="5718540">(</span><span class="ident" id="5718541">blank</span><span class="op" id="5718546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718556">p</span><span class="op" id="5718557">.</span><span class="ident" id="5718558">expr</span><span class="op" id="5718562">(</span><span class="ident" id="5718563">f</span><span class="op" id="5718564">.</span><span class="ident" id="5718565">Type</span><span class="op" id="5718569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718574">p</span><span class="op" id="5718575">.</span><span class="builtinfunc" id="5718576">print</span><span class="op" id="5718581">(</span><span class="ident" id="5718582">blank</span><span class="op" id="5718587">,</span>&nbsp;<span class="ident" id="5718589">rbrace</span><span class="op" id="5718595">,</span>&nbsp;<span class="ident" id="5718597">token</span><span class="op" id="5718602">.</span><span class="ident" id="5718603">RBRACE</span><span class="op" id="5718609">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718614">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718629">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718663">p</span><span class="op" id="5718664">.</span><span class="builtinfunc" id="5718665">print</span><span class="op" id="5718670">(</span><span class="ident" id="5718671">blank</span><span class="op" id="5718676">,</span>&nbsp;<span class="ident" id="5718678">lbrace</span><span class="op" id="5718684">,</span>&nbsp;<span class="ident" id="5718686">token</span><span class="op" id="5718691">.</span><span class="ident" id="5718692">LBRACE</span><span class="op" id="5718698">,</span>&nbsp;<span class="ident" id="5718700">indent</span><span class="op" id="5718706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718709">if</span>&nbsp;<span class="ident" id="5718712">hasComments</span>&nbsp;<span class="op" id="5718724">||</span>&nbsp;<span class="builtinfunc" id="5718727">len</span><span class="op" id="5718730">(</span><span class="ident" id="5718731">list</span><span class="op" id="5718735">)</span>&nbsp;<span class="op" id="5718737">&gt;</span>&nbsp;<span class="num" id="5718739">0</span>&nbsp;<span class="op" id="5718741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718745">p</span><span class="op" id="5718746">.</span><span class="builtinfunc" id="5718747">print</span><span class="op" id="5718752">(</span><span class="ident" id="5718753">formfeed</span><span class="op" id="5718761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718768">if</span>&nbsp;<span class="ident" id="5718771">isStruct</span>&nbsp;<span class="op" id="5718780">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718785">sep</span>&nbsp;<span class="op" id="5718789">:=</span>&nbsp;<span class="ident" id="5718792">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718799">if</span>&nbsp;<span class="builtinfunc" id="5718802">len</span><span class="op" id="5718805">(</span><span class="ident" id="5718806">list</span><span class="op" id="5718810">)</span>&nbsp;<span class="op" id="5718812">==</span>&nbsp;<span class="num" id="5718815">1</span>&nbsp;<span class="op" id="5718817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718822">sep</span>&nbsp;<span class="op" id="5718826">=</span>&nbsp;<span class="ident" id="5718828">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718840">var</span>&nbsp;<span class="ident" id="5718844">line</span>&nbsp;<span class="builtintype" id="5718849">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718855">for</span>&nbsp;<span class="ident" id="5718859">i</span><span class="op" id="5718860">,</span>&nbsp;<span class="ident" id="5718862">f</span>&nbsp;<span class="op" id="5718864">:=</span>&nbsp;<span class="keyword" id="5718867">range</span>&nbsp;<span class="ident" id="5718873">list</span>&nbsp;<span class="op" id="5718878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718883">if</span>&nbsp;<span class="ident" id="5718886">i</span>&nbsp;<span class="op" id="5718888">&gt;</span>&nbsp;<span class="num" id="5718890">0</span>&nbsp;<span class="op" id="5718892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718898">p</span><span class="op" id="5718899">.</span><span class="ident" id="5718900">linebreak</span><span class="op" id="5718909">(</span><span class="ident" id="5718910">p</span><span class="op" id="5718911">.</span><span class="ident" id="5718912">lineFor</span><span class="op" id="5718919">(</span><span class="ident" id="5718920">f</span><span class="op" id="5718921">.</span><span class="ident" id="5718922">Pos</span><span class="op" id="5718925">(</span><span class="op" id="5718926">)</span><span class="op" id="5718927">)</span><span class="op" id="5718928">,</span>&nbsp;<span class="num" id="5718930">1</span><span class="op" id="5718931">,</span>&nbsp;<span class="ident" id="5718933">ignore</span><span class="op" id="5718939">,</span>&nbsp;<span class="ident" id="5718941">p</span><span class="op" id="5718942">.</span><span class="ident" id="5718943">linesFrom</span><span class="op" id="5718952">(</span><span class="ident" id="5718953">line</span><span class="op" id="5718957">)</span>&nbsp;<span class="op" id="5718959">&gt;</span>&nbsp;<span class="num" id="5718961">0</span><span class="op" id="5718962">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718972">extraTabs</span>&nbsp;<span class="op" id="5718982">:=</span>&nbsp;<span class="num" id="5718985">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718990">p</span><span class="op" id="5718991">.</span><span class="ident" id="5718992">setComment</span><span class="op" id="5719002">(</span><span class="ident" id="5719003">f</span><span class="op" id="5719004">.</span><span class="ident" id="5719005">Doc</span><span class="op" id="5719008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719013">p</span><span class="op" id="5719014">.</span><span class="ident" id="5719015">recordLine</span><span class="op" id="5719025">(</span><span class="op" id="5719026">&amp;</span><span class="ident" id="5719027">line</span><span class="op" id="5719031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719036">if</span>&nbsp;<span class="builtinfunc" id="5719039">len</span><span class="op" id="5719042">(</span><span class="ident" id="5719043">f</span><span class="op" id="5719044">.</span><span class="ident" id="5719045">Names</span><span class="op" id="5719050">)</span>&nbsp;<span class="op" id="5719052">&gt;</span>&nbsp;<span class="num" id="5719054">0</span>&nbsp;<span class="op" id="5719056">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719062">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719082">p</span><span class="op" id="5719083">.</span><span class="ident" id="5719084">identList</span><span class="op" id="5719093">(</span><span class="ident" id="5719094">f</span><span class="op" id="5719095">.</span><span class="ident" id="5719096">Names</span><span class="op" id="5719101">,</span>&nbsp;<span class="ident" id="5719103">false</span><span class="op" id="5719108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719114">p</span><span class="op" id="5719115">.</span><span class="builtinfunc" id="5719116">print</span><span class="op" id="5719121">(</span><span class="ident" id="5719122">sep</span><span class="op" id="5719125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719131">p</span><span class="op" id="5719132">.</span><span class="ident" id="5719133">expr</span><span class="op" id="5719137">(</span><span class="ident" id="5719138">f</span><span class="op" id="5719139">.</span><span class="ident" id="5719140">Type</span><span class="op" id="5719144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719150">extraTabs</span>&nbsp;<span class="op" id="5719160">=</span>&nbsp;<span class="num" id="5719162">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719167">}</span>&nbsp;<span class="keyword" id="5719169">else</span>&nbsp;<span class="op" id="5719174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719180">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719203">p</span><span class="op" id="5719204">.</span><span class="ident" id="5719205">expr</span><span class="op" id="5719209">(</span><span class="ident" id="5719210">f</span><span class="op" id="5719211">.</span><span class="ident" id="5719212">Type</span><span class="op" id="5719216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719222">extraTabs</span>&nbsp;<span class="op" id="5719232">=</span>&nbsp;<span class="num" id="5719234">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719239">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719244">if</span>&nbsp;<span class="ident" id="5719247">f</span><span class="op" id="5719248">.</span><span class="ident" id="5719249">Tag</span>&nbsp;<span class="op" id="5719253">!=</span>&nbsp;<span class="ident" id="5719256">nil</span>&nbsp;<span class="op" id="5719260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719266">if</span>&nbsp;<span class="builtinfunc" id="5719269">len</span><span class="op" id="5719272">(</span><span class="ident" id="5719273">f</span><span class="op" id="5719274">.</span><span class="ident" id="5719275">Names</span><span class="op" id="5719280">)</span>&nbsp;<span class="op" id="5719282">&gt;</span>&nbsp;<span class="num" id="5719284">0</span>&nbsp;<span class="op" id="5719286">&amp;&amp;</span>&nbsp;<span class="ident" id="5719289">sep</span>&nbsp;<span class="op" id="5719293">==</span>&nbsp;<span class="ident" id="5719296">vtab</span>&nbsp;<span class="op" id="5719301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719308">p</span><span class="op" id="5719309">.</span><span class="builtinfunc" id="5719310">print</span><span class="op" id="5719315">(</span><span class="ident" id="5719316">sep</span><span class="op" id="5719319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719331">p</span><span class="op" id="5719332">.</span><span class="builtinfunc" id="5719333">print</span><span class="op" id="5719338">(</span><span class="ident" id="5719339">sep</span><span class="op" id="5719342">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719348">p</span><span class="op" id="5719349">.</span><span class="ident" id="5719350">expr</span><span class="op" id="5719354">(</span><span class="ident" id="5719355">f</span><span class="op" id="5719356">.</span><span class="ident" id="5719357">Tag</span><span class="op" id="5719360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719366">extraTabs</span>&nbsp;<span class="op" id="5719376">=</span>&nbsp;<span class="num" id="5719378">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719388">if</span>&nbsp;<span class="ident" id="5719391">f</span><span class="op" id="5719392">.</span><span class="ident" id="5719393">Comment</span>&nbsp;<span class="op" id="5719401">!=</span>&nbsp;<span class="ident" id="5719404">nil</span>&nbsp;<span class="op" id="5719408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719414">for</span>&nbsp;<span class="op" id="5719418">;</span>&nbsp;<span class="ident" id="5719420">extraTabs</span>&nbsp;<span class="op" id="5719430">&gt;</span>&nbsp;<span class="num" id="5719432">0</span><span class="op" id="5719433">;</span>&nbsp;<span class="ident" id="5719435">extraTabs</span><span class="op" id="5719444">--</span>&nbsp;<span class="op" id="5719447">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719454">p</span><span class="op" id="5719455">.</span><span class="builtinfunc" id="5719456">print</span><span class="op" id="5719461">(</span><span class="ident" id="5719462">sep</span><span class="op" id="5719465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719477">p</span><span class="op" id="5719478">.</span><span class="ident" id="5719479">setComment</span><span class="op" id="5719489">(</span><span class="ident" id="5719490">f</span><span class="op" id="5719491">.</span><span class="ident" id="5719492">Comment</span><span class="op" id="5719499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719508">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719512">if</span>&nbsp;<span class="ident" id="5719515">isIncomplete</span>&nbsp;<span class="op" id="5719528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719533">if</span>&nbsp;<span class="builtinfunc" id="5719536">len</span><span class="op" id="5719539">(</span><span class="ident" id="5719540">list</span><span class="op" id="5719544">)</span>&nbsp;<span class="op" id="5719546">&gt;</span>&nbsp;<span class="num" id="5719548">0</span>&nbsp;<span class="op" id="5719550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719556">p</span><span class="op" id="5719557">.</span><span class="builtinfunc" id="5719558">print</span><span class="op" id="5719563">(</span><span class="ident" id="5719564">formfeed</span><span class="op" id="5719572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719582">p</span><span class="op" id="5719583">.</span><span class="ident" id="5719584">flush</span><span class="op" id="5719589">(</span><span class="ident" id="5719590">p</span><span class="op" id="5719591">.</span><span class="ident" id="5719592">posFor</span><span class="op" id="5719598">(</span><span class="ident" id="5719599">rbrace</span><span class="op" id="5719605">)</span><span class="op" id="5719606">,</span>&nbsp;<span class="ident" id="5719608">token</span><span class="op" id="5719613">.</span><span class="ident" id="5719614">RBRACE</span><span class="op" id="5719620">)</span>&nbsp;<span class="comment" id="5719622">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719674">p</span><span class="op" id="5719675">.</span><span class="ident" id="5719676">setLineComment</span><span class="op" id="5719690">(</span><span class="string" id="5719691">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5719734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719742">}</span>&nbsp;<span class="keyword" id="5719744">else</span>&nbsp;<span class="op" id="5719749">{</span>&nbsp;<span class="comment" id="5719751">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719767">var</span>&nbsp;<span class="ident" id="5719771">line</span>&nbsp;<span class="builtintype" id="5719776">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719782">for</span>&nbsp;<span class="ident" id="5719786">i</span><span class="op" id="5719787">,</span>&nbsp;<span class="ident" id="5719789">f</span>&nbsp;<span class="op" id="5719791">:=</span>&nbsp;<span class="keyword" id="5719794">range</span>&nbsp;<span class="ident" id="5719800">list</span>&nbsp;<span class="op" id="5719805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719810">if</span>&nbsp;<span class="ident" id="5719813">i</span>&nbsp;<span class="op" id="5719815">&gt;</span>&nbsp;<span class="num" id="5719817">0</span>&nbsp;<span class="op" id="5719819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719825">p</span><span class="op" id="5719826">.</span><span class="ident" id="5719827">linebreak</span><span class="op" id="5719836">(</span><span class="ident" id="5719837">p</span><span class="op" id="5719838">.</span><span class="ident" id="5719839">lineFor</span><span class="op" id="5719846">(</span><span class="ident" id="5719847">f</span><span class="op" id="5719848">.</span><span class="ident" id="5719849">Pos</span><span class="op" id="5719852">(</span><span class="op" id="5719853">)</span><span class="op" id="5719854">)</span><span class="op" id="5719855">,</span>&nbsp;<span class="num" id="5719857">1</span><span class="op" id="5719858">,</span>&nbsp;<span class="ident" id="5719860">ignore</span><span class="op" id="5719866">,</span>&nbsp;<span class="ident" id="5719868">p</span><span class="op" id="5719869">.</span><span class="ident" id="5719870">linesFrom</span><span class="op" id="5719879">(</span><span class="ident" id="5719880">line</span><span class="op" id="5719884">)</span>&nbsp;<span class="op" id="5719886">&gt;</span>&nbsp;<span class="num" id="5719888">0</span><span class="op" id="5719889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719894">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719899">p</span><span class="op" id="5719900">.</span><span class="ident" id="5719901">setComment</span><span class="op" id="5719911">(</span><span class="ident" id="5719912">f</span><span class="op" id="5719913">.</span><span class="ident" id="5719914">Doc</span><span class="op" id="5719917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719922">p</span><span class="op" id="5719923">.</span><span class="ident" id="5719924">recordLine</span><span class="op" id="5719934">(</span><span class="op" id="5719935">&amp;</span><span class="ident" id="5719936">line</span><span class="op" id="5719940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719945">if</span>&nbsp;<span class="ident" id="5719948">ftyp</span><span class="op" id="5719952">,</span>&nbsp;<span class="ident" id="5719954">isFtyp</span>&nbsp;<span class="op" id="5719961">:=</span>&nbsp;<span class="ident" id="5719964">f</span><span class="op" id="5719965">.</span><span class="ident" id="5719966">Type</span><span class="op" id="5719970">.</span><span class="op" id="5719971">(</span><span class="op" id="5719972">*</span><span class="ident" id="5719973">ast</span><span class="op" id="5719976">.</span><span class="ident" id="5719977">FuncType</span><span class="op" id="5719985">)</span><span class="op" id="5719986">;</span>&nbsp;<span class="ident" id="5719988">isFtyp</span>&nbsp;<span class="op" id="5719995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5720001">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720015">p</span><span class="op" id="5720016">.</span><span class="ident" id="5720017">expr</span><span class="op" id="5720021">(</span><span class="ident" id="5720022">f</span><span class="op" id="5720023">.</span><span class="ident" id="5720024">Names</span><span class="op" id="5720029">[</span><span class="num" id="5720030">0</span><span class="op" id="5720031">]</span><span class="op" id="5720032">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720038">p</span><span class="op" id="5720039">.</span><span class="ident" id="5720040">signature</span><span class="op" id="5720049">(</span><span class="ident" id="5720050">ftyp</span><span class="op" id="5720054">.</span><span class="ident" id="5720055">Params</span><span class="op" id="5720061">,</span>&nbsp;<span class="ident" id="5720063">ftyp</span><span class="op" id="5720067">.</span><span class="ident" id="5720068">Results</span><span class="op" id="5720075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720080">}</span>&nbsp;<span class="keyword" id="5720082">else</span>&nbsp;<span class="op" id="5720087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5720093">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720119">p</span><span class="op" id="5720120">.</span><span class="ident" id="5720121">expr</span><span class="op" id="5720125">(</span><span class="ident" id="5720126">f</span><span class="op" id="5720127">.</span><span class="ident" id="5720128">Type</span><span class="op" id="5720132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720137">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720142">p</span><span class="op" id="5720143">.</span><span class="ident" id="5720144">setComment</span><span class="op" id="5720154">(</span><span class="ident" id="5720155">f</span><span class="op" id="5720156">.</span><span class="ident" id="5720157">Comment</span><span class="op" id="5720164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720172">if</span>&nbsp;<span class="ident" id="5720175">isIncomplete</span>&nbsp;<span class="op" id="5720188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720193">if</span>&nbsp;<span class="builtinfunc" id="5720196">len</span><span class="op" id="5720199">(</span><span class="ident" id="5720200">list</span><span class="op" id="5720204">)</span>&nbsp;<span class="op" id="5720206">&gt;</span>&nbsp;<span class="num" id="5720208">0</span>&nbsp;<span class="op" id="5720210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720216">p</span><span class="op" id="5720217">.</span><span class="builtinfunc" id="5720218">print</span><span class="op" id="5720223">(</span><span class="ident" id="5720224">formfeed</span><span class="op" id="5720232">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720242">p</span><span class="op" id="5720243">.</span><span class="ident" id="5720244">flush</span><span class="op" id="5720249">(</span><span class="ident" id="5720250">p</span><span class="op" id="5720251">.</span><span class="ident" id="5720252">posFor</span><span class="op" id="5720258">(</span><span class="ident" id="5720259">rbrace</span><span class="op" id="5720265">)</span><span class="op" id="5720266">,</span>&nbsp;<span class="ident" id="5720268">token</span><span class="op" id="5720273">.</span><span class="ident" id="5720274">RBRACE</span><span class="op" id="5720280">)</span>&nbsp;<span class="comment" id="5720282">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720334">p</span><span class="op" id="5720335">.</span><span class="ident" id="5720336">setLineComment</span><span class="op" id="5720350">(</span><span class="string" id="5720351">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5720395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720406">p</span><span class="op" id="5720407">.</span><span class="builtinfunc" id="5720408">print</span><span class="op" id="5720413">(</span><span class="ident" id="5720414">unindent</span><span class="op" id="5720422">,</span>&nbsp;<span class="ident" id="5720424">formfeed</span><span class="op" id="5720432">,</span>&nbsp;<span class="ident" id="5720434">rbrace</span><span class="op" id="5720440">,</span>&nbsp;<span class="ident" id="5720442">token</span><span class="op" id="5720447">.</span><span class="ident" id="5720448">RBRACE</span><span class="op" id="5720454">)</span><br>
<span class="lineno"></span><span class="op" id="5720456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720459">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5720539">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720555">func</span>&nbsp;<span class="ident" id="5720560">walkBinary</span><span class="op" id="5720570">(</span><span class="ident" id="5720571">e</span>&nbsp;<span class="op" id="5720573">*</span><span class="ident" id="5720574">ast</span><span class="op" id="5720577">.</span><span class="ident" id="5720578">BinaryExpr</span><span class="op" id="5720588">)</span>&nbsp;<span class="op" id="5720590">(</span><span class="ident" id="5720591">has4</span><span class="op" id="5720595">,</span>&nbsp;<span class="ident" id="5720597">has5</span>&nbsp;<span class="builtintype" id="5720602">bool</span><span class="op" id="5720606">,</span>&nbsp;<span class="ident" id="5720608">maxProblem</span>&nbsp;<span class="builtintype" id="5720619">int</span><span class="op" id="5720622">)</span>&nbsp;<span class="op" id="5720624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720627">switch</span>&nbsp;<span class="ident" id="5720634">e</span><span class="op" id="5720635">.</span><span class="ident" id="5720636">Op</span><span class="op" id="5720638">.</span><span class="ident" id="5720639">Precedence</span><span class="op" id="5720649">(</span><span class="op" id="5720650">)</span>&nbsp;<span class="op" id="5720652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720655">case</span>&nbsp;<span class="num" id="5720660">4</span><span class="op" id="5720661">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720665">has4</span>&nbsp;<span class="op" id="5720670">=</span>&nbsp;<span class="ident" id="5720672">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720678">case</span>&nbsp;<span class="num" id="5720683">5</span><span class="op" id="5720684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720688">has5</span>&nbsp;<span class="op" id="5720693">=</span>&nbsp;<span class="ident" id="5720695">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720705">switch</span>&nbsp;<span class="ident" id="5720712">l</span>&nbsp;<span class="op" id="5720714">:=</span>&nbsp;<span class="ident" id="5720717">e</span><span class="op" id="5720718">.</span><span class="ident" id="5720719">X</span><span class="op" id="5720720">.</span><span class="op" id="5720721">(</span><span class="keyword" id="5720722">type</span><span class="op" id="5720726">)</span>&nbsp;<span class="op" id="5720728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720731">case</span>&nbsp;<span class="op" id="5720736">*</span><span class="ident" id="5720737">ast</span><span class="op" id="5720740">.</span><span class="ident" id="5720741">BinaryExpr</span><span class="op" id="5720751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720755">if</span>&nbsp;<span class="ident" id="5720758">l</span><span class="op" id="5720759">.</span><span class="ident" id="5720760">Op</span><span class="op" id="5720762">.</span><span class="ident" id="5720763">Precedence</span><span class="op" id="5720773">(</span><span class="op" id="5720774">)</span>&nbsp;<span class="op" id="5720776">&lt;</span>&nbsp;<span class="ident" id="5720778">e</span><span class="op" id="5720779">.</span><span class="ident" id="5720780">Op</span><span class="op" id="5720782">.</span><span class="ident" id="5720783">Precedence</span><span class="op" id="5720793">(</span><span class="op" id="5720794">)</span>&nbsp;<span class="op" id="5720796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5720801">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5720832">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720888">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720900">h4</span><span class="op" id="5720902">,</span>&nbsp;<span class="ident" id="5720904">h5</span><span class="op" id="5720906">,</span>&nbsp;<span class="ident" id="5720908">mp</span>&nbsp;<span class="op" id="5720911">:=</span>&nbsp;<span class="ident" id="5720914">walkBinary</span><span class="op" id="5720924">(</span><span class="ident" id="5720925">l</span><span class="op" id="5720926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720930">has4</span>&nbsp;<span class="op" id="5720935">=</span>&nbsp;<span class="ident" id="5720937">has4</span>&nbsp;<span class="op" id="5720942">||</span>&nbsp;<span class="ident" id="5720945">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720950">has5</span>&nbsp;<span class="op" id="5720955">=</span>&nbsp;<span class="ident" id="5720957">has5</span>&nbsp;<span class="op" id="5720962">||</span>&nbsp;<span class="ident" id="5720965">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720970">if</span>&nbsp;<span class="ident" id="5720973">maxProblem</span>&nbsp;<span class="op" id="5720984">&lt;</span>&nbsp;<span class="ident" id="5720986">mp</span>&nbsp;<span class="op" id="5720989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720994">maxProblem</span>&nbsp;<span class="op" id="5721005">=</span>&nbsp;<span class="ident" id="5721007">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721019">switch</span>&nbsp;<span class="ident" id="5721026">r</span>&nbsp;<span class="op" id="5721028">:=</span>&nbsp;<span class="ident" id="5721031">e</span><span class="op" id="5721032">.</span><span class="ident" id="5721033">Y</span><span class="op" id="5721034">.</span><span class="op" id="5721035">(</span><span class="keyword" id="5721036">type</span><span class="op" id="5721040">)</span>&nbsp;<span class="op" id="5721042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721045">case</span>&nbsp;<span class="op" id="5721050">*</span><span class="ident" id="5721051">ast</span><span class="op" id="5721054">.</span><span class="ident" id="5721055">BinaryExpr</span><span class="op" id="5721065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721069">if</span>&nbsp;<span class="ident" id="5721072">r</span><span class="op" id="5721073">.</span><span class="ident" id="5721074">Op</span><span class="op" id="5721076">.</span><span class="ident" id="5721077">Precedence</span><span class="op" id="5721087">(</span><span class="op" id="5721088">)</span>&nbsp;<span class="op" id="5721090">&lt;=</span>&nbsp;<span class="ident" id="5721093">e</span><span class="op" id="5721094">.</span><span class="ident" id="5721095">Op</span><span class="op" id="5721097">.</span><span class="ident" id="5721098">Precedence</span><span class="op" id="5721108">(</span><span class="op" id="5721109">)</span>&nbsp;<span class="op" id="5721111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721116">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721147">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721203">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721215">h4</span><span class="op" id="5721217">,</span>&nbsp;<span class="ident" id="5721219">h5</span><span class="op" id="5721221">,</span>&nbsp;<span class="ident" id="5721223">mp</span>&nbsp;<span class="op" id="5721226">:=</span>&nbsp;<span class="ident" id="5721229">walkBinary</span><span class="op" id="5721239">(</span><span class="ident" id="5721240">r</span><span class="op" id="5721241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721245">has4</span>&nbsp;<span class="op" id="5721250">=</span>&nbsp;<span class="ident" id="5721252">has4</span>&nbsp;<span class="op" id="5721257">||</span>&nbsp;<span class="ident" id="5721260">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721265">has5</span>&nbsp;<span class="op" id="5721270">=</span>&nbsp;<span class="ident" id="5721272">has5</span>&nbsp;<span class="op" id="5721277">||</span>&nbsp;<span class="ident" id="5721280">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721285">if</span>&nbsp;<span class="ident" id="5721288">maxProblem</span>&nbsp;<span class="op" id="5721299">&lt;</span>&nbsp;<span class="ident" id="5721301">mp</span>&nbsp;<span class="op" id="5721304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721309">maxProblem</span>&nbsp;<span class="op" id="5721320">=</span>&nbsp;<span class="ident" id="5721322">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721331">case</span>&nbsp;<span class="op" id="5721336">*</span><span class="ident" id="5721337">ast</span><span class="op" id="5721340">.</span><span class="ident" id="5721341">StarExpr</span><span class="op" id="5721349">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721353">if</span>&nbsp;<span class="ident" id="5721356">e</span><span class="op" id="5721357">.</span><span class="ident" id="5721358">Op</span>&nbsp;<span class="op" id="5721361">==</span>&nbsp;<span class="ident" id="5721364">token</span><span class="op" id="5721369">.</span><span class="ident" id="5721370">QUO</span>&nbsp;<span class="op" id="5721374">{</span>&nbsp;<span class="comment" id="5721376">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721387">maxProblem</span>&nbsp;<span class="op" id="5721398">=</span>&nbsp;<span class="num" id="5721400">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721408">case</span>&nbsp;<span class="op" id="5721413">*</span><span class="ident" id="5721414">ast</span><span class="op" id="5721417">.</span><span class="ident" id="5721418">UnaryExpr</span><span class="op" id="5721427">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721431">switch</span>&nbsp;<span class="ident" id="5721438">e</span><span class="op" id="5721439">.</span><span class="ident" id="5721440">Op</span><span class="op" id="5721442">.</span><span class="ident" id="5721443">String</span><span class="op" id="5721449">(</span><span class="op" id="5721450">)</span>&nbsp;<span class="op" id="5721452">+</span>&nbsp;<span class="ident" id="5721454">r</span><span class="op" id="5721455">.</span><span class="ident" id="5721456">Op</span><span class="op" id="5721458">.</span><span class="ident" id="5721459">String</span><span class="op" id="5721465">(</span><span class="op" id="5721466">)</span>&nbsp;<span class="op" id="5721468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721472">case</span>&nbsp;<span class="string" id="5721477">&#34;/*&#34;</span><span class="op" id="5721481">,</span>&nbsp;<span class="string" id="5721483">&#34;&amp;&amp;&#34;</span><span class="op" id="5721487">,</span>&nbsp;<span class="string" id="5721489">&#34;&amp;^&#34;</span><span class="op" id="5721493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721498">maxProblem</span>&nbsp;<span class="op" id="5721509">=</span>&nbsp;<span class="num" id="5721511">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721515">case</span>&nbsp;<span class="string" id="5721520">&#34;++&#34;</span><span class="op" id="5721524">,</span>&nbsp;<span class="string" id="5721526">&#34;--&#34;</span><span class="op" id="5721530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721535">if</span>&nbsp;<span class="ident" id="5721538">maxProblem</span>&nbsp;<span class="op" id="5721549">&lt;</span>&nbsp;<span class="num" id="5721551">4</span>&nbsp;<span class="op" id="5721553">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721559">maxProblem</span>&nbsp;<span class="op" id="5721570">=</span>&nbsp;<span class="num" id="5721572">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721587">return</span><br>
<span class="lineno">560</span><span class="op" id="5721594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721597">func</span>&nbsp;<span class="ident" id="5721602">cutoff</span><span class="op" id="5721608">(</span><span class="ident" id="5721609">e</span>&nbsp;<span class="op" id="5721611">*</span><span class="ident" id="5721612">ast</span><span class="op" id="5721615">.</span><span class="ident" id="5721616">BinaryExpr</span><span class="op" id="5721626">,</span>&nbsp;<span class="ident" id="5721628">depth</span>&nbsp;<span class="builtintype" id="5721634">int</span><span class="op" id="5721637">)</span>&nbsp;<span class="builtintype" id="5721639">int</span>&nbsp;<span class="op" id="5721643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721646">has4</span><span class="op" id="5721650">,</span>&nbsp;<span class="ident" id="5721652">has5</span><span class="op" id="5721656">,</span>&nbsp;<span class="ident" id="5721658">maxProblem</span>&nbsp;<span class="op" id="5721669">:=</span>&nbsp;<span class="ident" id="5721672">walkBinary</span><span class="op" id="5721682">(</span><span class="ident" id="5721683">e</span><span class="op" id="5721684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721687">if</span>&nbsp;<span class="ident" id="5721690">maxProblem</span>&nbsp;<span class="op" id="5721701">&gt;</span>&nbsp;<span class="num" id="5721703">0</span>&nbsp;<span class="op" id="5721705">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721709">return</span>&nbsp;<span class="ident" id="5721716">maxProblem</span>&nbsp;<span class="op" id="5721727">+</span>&nbsp;<span class="num" id="5721729">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721735">if</span>&nbsp;<span class="ident" id="5721738">has4</span>&nbsp;<span class="op" id="5721743">&amp;&amp;</span>&nbsp;<span class="ident" id="5721746">has5</span>&nbsp;<span class="op" id="5721751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721755">if</span>&nbsp;<span class="ident" id="5721758">depth</span>&nbsp;<span class="op" id="5721764">==</span>&nbsp;<span class="num" id="5721767">1</span>&nbsp;<span class="op" id="5721769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721774">return</span>&nbsp;<span class="num" id="5721781">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721789">return</span>&nbsp;<span class="num" id="5721796">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721802">if</span>&nbsp;<span class="ident" id="5721805">depth</span>&nbsp;<span class="op" id="5721811">==</span>&nbsp;<span class="num" id="5721814">1</span>&nbsp;<span class="op" id="5721816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721820">return</span>&nbsp;<span class="num" id="5721827">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721833">return</span>&nbsp;<span class="num" id="5721840">4</span><br>
<span class="lineno"></span><span class="op" id="5721842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721845">func</span>&nbsp;<span class="ident" id="5721850">diffPrec</span><span class="op" id="5721858">(</span><span class="ident" id="5721859">expr</span>&nbsp;<span class="ident" id="5721864">ast</span><span class="op" id="5721867">.</span><span class="ident" id="5721868">Expr</span><span class="op" id="5721872">,</span>&nbsp;<span class="ident" id="5721874">prec</span>&nbsp;<span class="builtintype" id="5721879">int</span><span class="op" id="5721882">)</span>&nbsp;<span class="builtintype" id="5721884">int</span>&nbsp;<span class="op" id="5721888">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721891">x</span><span class="op" id="5721892">,</span>&nbsp;<span class="ident" id="5721894">ok</span>&nbsp;<span class="op" id="5721897">:=</span>&nbsp;<span class="ident" id="5721900">expr</span><span class="op" id="5721904">.</span><span class="op" id="5721905">(</span><span class="op" id="5721906">*</span><span class="ident" id="5721907">ast</span><span class="op" id="5721910">.</span><span class="ident" id="5721911">BinaryExpr</span><span class="op" id="5721921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721924">if</span>&nbsp;<span class="op" id="5721927">!</span><span class="ident" id="5721928">ok</span>&nbsp;<span class="op" id="5721931">||</span>&nbsp;<span class="ident" id="5721934">prec</span>&nbsp;<span class="op" id="5721939">!=</span>&nbsp;<span class="ident" id="5721942">x</span><span class="op" id="5721943">.</span><span class="ident" id="5721944">Op</span><span class="op" id="5721946">.</span><span class="ident" id="5721947">Precedence</span><span class="op" id="5721957">(</span><span class="op" id="5721958">)</span>&nbsp;<span class="op" id="5721960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721964">return</span>&nbsp;<span class="num" id="5721971">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721977">return</span>&nbsp;<span class="num" id="5721984">0</span><br>
<span class="lineno">585</span><span class="op" id="5721986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721989">func</span>&nbsp;<span class="ident" id="5721994">reduceDepth</span><span class="op" id="5722005">(</span><span class="ident" id="5722006">depth</span>&nbsp;<span class="builtintype" id="5722012">int</span><span class="op" id="5722015">)</span>&nbsp;<span class="builtintype" id="5722017">int</span>&nbsp;<span class="op" id="5722021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722024">depth</span><span class="op" id="5722029">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722033">if</span>&nbsp;<span class="ident" id="5722036">depth</span>&nbsp;<span class="op" id="5722042">&lt;</span>&nbsp;<span class="num" id="5722044">1</span>&nbsp;<span class="op" id="5722046">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722050">depth</span>&nbsp;<span class="op" id="5722056">=</span>&nbsp;<span class="num" id="5722058">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722064">return</span>&nbsp;<span class="ident" id="5722071">depth</span><br>
<span class="lineno"></span><span class="op" id="5722077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5722080">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5722148">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5722214">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5722253">//</span><br>
<span class="lineno"></span><span class="comment" id="5722256">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5722280">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5722320">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5722348">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5722386">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5722406">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5722426">//</span><br>
<span class="lineno"></span><span class="comment" id="5722429">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5722505">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5722592">//</span><br>
<span class="lineno"></span><span class="comment" id="5722595">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5722671">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5722748">//</span><br>
<span class="lineno"></span><span class="comment" id="5722751">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5722819">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5722890">//</span><br>
<span class="lineno">615</span><span class="comment" id="5722893">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5722902">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5722911">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5722920">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="5722929">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="5722938">//</span><br>
<span class="lineno"></span><span class="comment" id="5722941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5723007">//</span><br>
<span class="lineno"></span><span class="comment" id="5723010">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5723084">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5723149">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5723197">//</span><br>
<span class="lineno"></span><span class="comment" id="5723200">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5723274">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5723327">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5723375">//</span><br>
<span class="lineno"></span><span class="keyword" id="5723378">func</span>&nbsp;<span class="op" id="5723383">(</span><span class="ident" id="5723384">p</span>&nbsp;<span class="op" id="5723386">*</span><span class="ident" id="5723387">printer</span><span class="op" id="5723394">)</span>&nbsp;<span class="ident" id="5723396">binaryExpr</span><span class="op" id="5723406">(</span><span class="ident" id="5723407">x</span>&nbsp;<span class="op" id="5723409">*</span><span class="ident" id="5723410">ast</span><span class="op" id="5723413">.</span><span class="ident" id="5723414">BinaryExpr</span><span class="op" id="5723424">,</span>&nbsp;<span class="ident" id="5723426">prec1</span><span class="op" id="5723431">,</span>&nbsp;<span class="ident" id="5723433">cutoff</span><span class="op" id="5723439">,</span>&nbsp;<span class="ident" id="5723441">depth</span>&nbsp;<span class="builtintype" id="5723447">int</span><span class="op" id="5723450">)</span>&nbsp;<span class="op" id="5723452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723455">prec</span>&nbsp;<span class="op" id="5723460">:=</span>&nbsp;<span class="ident" id="5723463">x</span><span class="op" id="5723464">.</span><span class="ident" id="5723465">Op</span><span class="op" id="5723467">.</span><span class="ident" id="5723468">Precedence</span><span class="op" id="5723478">(</span><span class="op" id="5723479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723482">if</span>&nbsp;<span class="ident" id="5723485">prec</span>&nbsp;<span class="op" id="5723490">&lt;</span>&nbsp;<span class="ident" id="5723492">prec1</span>&nbsp;<span class="op" id="5723498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723502">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723526">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723662">p</span><span class="op" id="5723663">.</span><span class="builtinfunc" id="5723664">print</span><span class="op" id="5723669">(</span><span class="ident" id="5723670">token</span><span class="op" id="5723675">.</span><span class="ident" id="5723676">LPAREN</span><span class="op" id="5723682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723686">p</span><span class="op" id="5723687">.</span><span class="ident" id="5723688">expr0</span><span class="op" id="5723693">(</span><span class="ident" id="5723694">x</span><span class="op" id="5723695">,</span>&nbsp;<span class="ident" id="5723697">reduceDepth</span><span class="op" id="5723708">(</span><span class="ident" id="5723709">depth</span><span class="op" id="5723714">)</span><span class="op" id="5723715">)</span>&nbsp;<span class="comment" id="5723717">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723758">p</span><span class="op" id="5723759">.</span><span class="builtinfunc" id="5723760">print</span><span class="op" id="5723765">(</span><span class="ident" id="5723766">token</span><span class="op" id="5723771">.</span><span class="ident" id="5723772">RPAREN</span><span class="op" id="5723778">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723782">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723794">printBlank</span>&nbsp;<span class="op" id="5723805">:=</span>&nbsp;<span class="ident" id="5723808">prec</span>&nbsp;<span class="op" id="5723813">&lt;</span>&nbsp;<span class="ident" id="5723815">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723824">ws</span>&nbsp;<span class="op" id="5723827">:=</span>&nbsp;<span class="ident" id="5723830">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723838">p</span><span class="op" id="5723839">.</span><span class="ident" id="5723840">expr1</span><span class="op" id="5723845">(</span><span class="ident" id="5723846">x</span><span class="op" id="5723847">.</span><span class="ident" id="5723848">X</span><span class="op" id="5723849">,</span>&nbsp;<span class="ident" id="5723851">prec</span><span class="op" id="5723855">,</span>&nbsp;<span class="ident" id="5723857">depth</span><span class="op" id="5723862">+</span><span class="ident" id="5723863">diffPrec</span><span class="op" id="5723871">(</span><span class="ident" id="5723872">x</span><span class="op" id="5723873">.</span><span class="ident" id="5723874">X</span><span class="op" id="5723875">,</span>&nbsp;<span class="ident" id="5723877">prec</span><span class="op" id="5723881">)</span><span class="op" id="5723882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723885">if</span>&nbsp;<span class="ident" id="5723888">printBlank</span>&nbsp;<span class="op" id="5723899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723903">p</span><span class="op" id="5723904">.</span><span class="builtinfunc" id="5723905">print</span><span class="op" id="5723910">(</span><span class="ident" id="5723911">blank</span><span class="op" id="5723916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723919">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723922">xline</span>&nbsp;<span class="op" id="5723928">:=</span>&nbsp;<span class="ident" id="5723931">p</span><span class="op" id="5723932">.</span><span class="ident" id="5723933">pos</span><span class="op" id="5723936">.</span><span class="ident" id="5723937">Line</span>&nbsp;<span class="comment" id="5723942">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723996">yline</span>&nbsp;<span class="op" id="5724002">:=</span>&nbsp;<span class="ident" id="5724005">p</span><span class="op" id="5724006">.</span><span class="ident" id="5724007">lineFor</span><span class="op" id="5724014">(</span><span class="ident" id="5724015">x</span><span class="op" id="5724016">.</span><span class="ident" id="5724017">Y</span><span class="op" id="5724018">.</span><span class="ident" id="5724019">Pos</span><span class="op" id="5724022">(</span><span class="op" id="5724023">)</span><span class="op" id="5724024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724027">p</span><span class="op" id="5724028">.</span><span class="builtinfunc" id="5724029">print</span><span class="op" id="5724034">(</span><span class="ident" id="5724035">x</span><span class="op" id="5724036">.</span><span class="ident" id="5724037">OpPos</span><span class="op" id="5724042">,</span>&nbsp;<span class="ident" id="5724044">x</span><span class="op" id="5724045">.</span><span class="ident" id="5724046">Op</span><span class="op" id="5724048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724051">if</span>&nbsp;<span class="ident" id="5724054">xline</span>&nbsp;<span class="op" id="5724060">!=</span>&nbsp;<span class="ident" id="5724063">yline</span>&nbsp;<span class="op" id="5724069">&amp;&amp;</span>&nbsp;<span class="ident" id="5724072">xline</span>&nbsp;<span class="op" id="5724078">&gt;</span>&nbsp;<span class="num" id="5724080">0</span>&nbsp;<span class="op" id="5724082">&amp;&amp;</span>&nbsp;<span class="ident" id="5724085">yline</span>&nbsp;<span class="op" id="5724091">&gt;</span>&nbsp;<span class="num" id="5724093">0</span>&nbsp;<span class="op" id="5724095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724099">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724161">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724180">if</span>&nbsp;<span class="ident" id="5724183">p</span><span class="op" id="5724184">.</span><span class="ident" id="5724185">linebreak</span><span class="op" id="5724194">(</span><span class="ident" id="5724195">yline</span><span class="op" id="5724200">,</span>&nbsp;<span class="num" id="5724202">1</span><span class="op" id="5724203">,</span>&nbsp;<span class="ident" id="5724205">ws</span><span class="op" id="5724207">,</span>&nbsp;<span class="ident" id="5724209">true</span><span class="op" id="5724213">)</span>&nbsp;<span class="op" id="5724215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724220">ws</span>&nbsp;<span class="op" id="5724223">=</span>&nbsp;<span class="ident" id="5724225">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724235">printBlank</span>&nbsp;<span class="op" id="5724246">=</span>&nbsp;<span class="ident" id="5724248">false</span>&nbsp;<span class="comment" id="5724254">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724285">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724291">if</span>&nbsp;<span class="ident" id="5724294">printBlank</span>&nbsp;<span class="op" id="5724305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724309">p</span><span class="op" id="5724310">.</span><span class="builtinfunc" id="5724311">print</span><span class="op" id="5724316">(</span><span class="ident" id="5724317">blank</span><span class="op" id="5724322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724328">p</span><span class="op" id="5724329">.</span><span class="ident" id="5724330">expr1</span><span class="op" id="5724335">(</span><span class="ident" id="5724336">x</span><span class="op" id="5724337">.</span><span class="ident" id="5724338">Y</span><span class="op" id="5724339">,</span>&nbsp;<span class="ident" id="5724341">prec</span><span class="op" id="5724345">+</span><span class="num" id="5724346">1</span><span class="op" id="5724347">,</span>&nbsp;<span class="ident" id="5724349">depth</span><span class="op" id="5724354">+</span><span class="num" id="5724355">1</span><span class="op" id="5724356">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724359">if</span>&nbsp;<span class="ident" id="5724362">ws</span>&nbsp;<span class="op" id="5724365">==</span>&nbsp;<span class="ident" id="5724368">ignore</span>&nbsp;<span class="op" id="5724375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724379">p</span><span class="op" id="5724380">.</span><span class="builtinfunc" id="5724381">print</span><span class="op" id="5724386">(</span><span class="ident" id="5724387">unindent</span><span class="op" id="5724395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724398">}</span><br>
<span class="lineno"></span><span class="op" id="5724400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5724403">func</span>&nbsp;<span class="ident" id="5724408">isBinary</span><span class="op" id="5724416">(</span><span class="ident" id="5724417">expr</span>&nbsp;<span class="ident" id="5724422">ast</span><span class="op" id="5724425">.</span><span class="ident" id="5724426">Expr</span><span class="op" id="5724430">)</span>&nbsp;<span class="builtintype" id="5724432">bool</span>&nbsp;<span class="op" id="5724437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724440">_</span><span class="op" id="5724441">,</span>&nbsp;<span class="ident" id="5724443">ok</span>&nbsp;<span class="op" id="5724446">:=</span>&nbsp;<span class="ident" id="5724449">expr</span><span class="op" id="5724453">.</span><span class="op" id="5724454">(</span><span class="op" id="5724455">*</span><span class="ident" id="5724456">ast</span><span class="op" id="5724459">.</span><span class="ident" id="5724460">BinaryExpr</span><span class="op" id="5724470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724473">return</span>&nbsp;<span class="ident" id="5724480">ok</span><br>
<span class="lineno"></span><span class="op" id="5724483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5724486">func</span>&nbsp;<span class="op" id="5724491">(</span><span class="ident" id="5724492">p</span>&nbsp;<span class="op" id="5724494">*</span><span class="ident" id="5724495">printer</span><span class="op" id="5724502">)</span>&nbsp;<span class="ident" id="5724504">expr1</span><span class="op" id="5724509">(</span><span class="ident" id="5724510">expr</span>&nbsp;<span class="ident" id="5724515">ast</span><span class="op" id="5724518">.</span><span class="ident" id="5724519">Expr</span><span class="op" id="5724523">,</span>&nbsp;<span class="ident" id="5724525">prec1</span><span class="op" id="5724530">,</span>&nbsp;<span class="ident" id="5724532">depth</span>&nbsp;<span class="builtintype" id="5724538">int</span><span class="op" id="5724541">)</span>&nbsp;<span class="op" id="5724543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724546">p</span><span class="op" id="5724547">.</span><span class="builtinfunc" id="5724548">print</span><span class="op" id="5724553">(</span><span class="ident" id="5724554">expr</span><span class="op" id="5724558">.</span><span class="ident" id="5724559">Pos</span><span class="op" id="5724562">(</span><span class="op" id="5724563">)</span><span class="op" id="5724564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724568">switch</span>&nbsp;<span class="ident" id="5724575">x</span>&nbsp;<span class="op" id="5724577">:=</span>&nbsp;<span class="ident" id="5724580">expr</span><span class="op" id="5724584">.</span><span class="op" id="5724585">(</span><span class="keyword" id="5724586">type</span><span class="op" id="5724590">)</span>&nbsp;<span class="op" id="5724592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724595">case</span>&nbsp;<span class="op" id="5724600">*</span><span class="ident" id="5724601">ast</span><span class="op" id="5724604">.</span><span class="ident" id="5724605">BadExpr</span><span class="op" id="5724612">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724616">p</span><span class="op" id="5724617">.</span><span class="builtinfunc" id="5724618">print</span><span class="op" id="5724623">(</span><span class="string" id="5724624">&#34;BadExpr&#34;</span><span class="op" id="5724633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724637">case</span>&nbsp;<span class="op" id="5724642">*</span><span class="ident" id="5724643">ast</span><span class="op" id="5724646">.</span><span class="ident" id="5724647">Ident</span><span class="op" id="5724652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724656">p</span><span class="op" id="5724657">.</span><span class="builtinfunc" id="5724658">print</span><span class="op" id="5724663">(</span><span class="ident" id="5724664">x</span><span class="op" id="5724665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724669">case</span>&nbsp;<span class="op" id="5724674">*</span><span class="ident" id="5724675">ast</span><span class="op" id="5724678">.</span><span class="ident" id="5724679">BinaryExpr</span><span class="op" id="5724689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724693">if</span>&nbsp;<span class="ident" id="5724696">depth</span>&nbsp;<span class="op" id="5724702">&lt;</span>&nbsp;<span class="num" id="5724704">1</span>&nbsp;<span class="op" id="5724706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724711">p</span><span class="op" id="5724712">.</span><span class="ident" id="5724713">internalError</span><span class="op" id="5724726">(</span><span class="string" id="5724727">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5724739">,</span>&nbsp;<span class="ident" id="5724741">depth</span><span class="op" id="5724746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724751">depth</span>&nbsp;<span class="op" id="5724757">=</span>&nbsp;<span class="num" id="5724759">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724763">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724767">p</span><span class="op" id="5724768">.</span><span class="ident" id="5724769">binaryExpr</span><span class="op" id="5724779">(</span><span class="ident" id="5724780">x</span><span class="op" id="5724781">,</span>&nbsp;<span class="ident" id="5724783">prec1</span><span class="op" id="5724788">,</span>&nbsp;<span class="ident" id="5724790">cutoff</span><span class="op" id="5724796">(</span><span class="ident" id="5724797">x</span><span class="op" id="5724798">,</span>&nbsp;<span class="ident" id="5724800">depth</span><span class="op" id="5724805">)</span><span class="op" id="5724806">,</span>&nbsp;<span class="ident" id="5724808">depth</span><span class="op" id="5724813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724817">case</span>&nbsp;<span class="op" id="5724822">*</span><span class="ident" id="5724823">ast</span><span class="op" id="5724826">.</span><span class="ident" id="5724827">KeyValueExpr</span><span class="op" id="5724839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724843">p</span><span class="op" id="5724844">.</span><span class="ident" id="5724845">expr</span><span class="op" id="5724849">(</span><span class="ident" id="5724850">x</span><span class="op" id="5724851">.</span><span class="ident" id="5724852">Key</span><span class="op" id="5724855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724859">p</span><span class="op" id="5724860">.</span><span class="builtinfunc" id="5724861">print</span><span class="op" id="5724866">(</span><span class="ident" id="5724867">x</span><span class="op" id="5724868">.</span><span class="ident" id="5724869">Colon</span><span class="op" id="5724874">,</span>&nbsp;<span class="ident" id="5724876">token</span><span class="op" id="5724881">.</span><span class="ident" id="5724882">COLON</span><span class="op" id="5724887">,</span>&nbsp;<span class="ident" id="5724889">blank</span><span class="op" id="5724894">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724898">p</span><span class="op" id="5724899">.</span><span class="ident" id="5724900">expr</span><span class="op" id="5724904">(</span><span class="ident" id="5724905">x</span><span class="op" id="5724906">.</span><span class="ident" id="5724907">Value</span><span class="op" id="5724912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724916">case</span>&nbsp;<span class="op" id="5724921">*</span><span class="ident" id="5724922">ast</span><span class="op" id="5724925">.</span><span class="ident" id="5724926">StarExpr</span><span class="op" id="5724934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724938">const</span>&nbsp;<span class="ident" id="5724944">prec</span>&nbsp;<span class="op" id="5724949">=</span>&nbsp;<span class="ident" id="5724951">token</span><span class="op" id="5724956">.</span><span class="ident" id="5724957">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724969">if</span>&nbsp;<span class="ident" id="5724972">prec</span>&nbsp;<span class="op" id="5724977">&lt;</span>&nbsp;<span class="ident" id="5724979">prec1</span>&nbsp;<span class="op" id="5724985">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724990">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725015">p</span><span class="op" id="5725016">.</span><span class="builtinfunc" id="5725017">print</span><span class="op" id="5725022">(</span><span class="ident" id="5725023">token</span><span class="op" id="5725028">.</span><span class="ident" id="5725029">LPAREN</span><span class="op" id="5725035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725040">p</span><span class="op" id="5725041">.</span><span class="builtinfunc" id="5725042">print</span><span class="op" id="5725047">(</span><span class="ident" id="5725048">token</span><span class="op" id="5725053">.</span><span class="ident" id="5725054">MUL</span><span class="op" id="5725057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725062">p</span><span class="op" id="5725063">.</span><span class="ident" id="5725064">expr</span><span class="op" id="5725068">(</span><span class="ident" id="5725069">x</span><span class="op" id="5725070">.</span><span class="ident" id="5725071">X</span><span class="op" id="5725072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725077">p</span><span class="op" id="5725078">.</span><span class="builtinfunc" id="5725079">print</span><span class="op" id="5725084">(</span><span class="ident" id="5725085">token</span><span class="op" id="5725090">.</span><span class="ident" id="5725091">RPAREN</span><span class="op" id="5725097">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725101">}</span>&nbsp;<span class="keyword" id="5725103">else</span>&nbsp;<span class="op" id="5725108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725113">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725141">p</span><span class="op" id="5725142">.</span><span class="builtinfunc" id="5725143">print</span><span class="op" id="5725148">(</span><span class="ident" id="5725149">token</span><span class="op" id="5725154">.</span><span class="ident" id="5725155">MUL</span><span class="op" id="5725158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725163">p</span><span class="op" id="5725164">.</span><span class="ident" id="5725165">expr</span><span class="op" id="5725169">(</span><span class="ident" id="5725170">x</span><span class="op" id="5725171">.</span><span class="ident" id="5725172">X</span><span class="op" id="5725173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725177">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725181">case</span>&nbsp;<span class="op" id="5725186">*</span><span class="ident" id="5725187">ast</span><span class="op" id="5725190">.</span><span class="ident" id="5725191">UnaryExpr</span><span class="op" id="5725200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725204">const</span>&nbsp;<span class="ident" id="5725210">prec</span>&nbsp;<span class="op" id="5725215">=</span>&nbsp;<span class="ident" id="5725217">token</span><span class="op" id="5725222">.</span><span class="ident" id="5725223">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725235">if</span>&nbsp;<span class="ident" id="5725238">prec</span>&nbsp;<span class="op" id="5725243">&lt;</span>&nbsp;<span class="ident" id="5725245">prec1</span>&nbsp;<span class="op" id="5725251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725256">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725281">p</span><span class="op" id="5725282">.</span><span class="builtinfunc" id="5725283">print</span><span class="op" id="5725288">(</span><span class="ident" id="5725289">token</span><span class="op" id="5725294">.</span><span class="ident" id="5725295">LPAREN</span><span class="op" id="5725301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725306">p</span><span class="op" id="5725307">.</span><span class="ident" id="5725308">expr</span><span class="op" id="5725312">(</span><span class="ident" id="5725313">x</span><span class="op" id="5725314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725319">p</span><span class="op" id="5725320">.</span><span class="builtinfunc" id="5725321">print</span><span class="op" id="5725326">(</span><span class="ident" id="5725327">token</span><span class="op" id="5725332">.</span><span class="ident" id="5725333">RPAREN</span><span class="op" id="5725339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725343">}</span>&nbsp;<span class="keyword" id="5725345">else</span>&nbsp;<span class="op" id="5725350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725355">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725383">p</span><span class="op" id="5725384">.</span><span class="builtinfunc" id="5725385">print</span><span class="op" id="5725390">(</span><span class="ident" id="5725391">x</span><span class="op" id="5725392">.</span><span class="ident" id="5725393">Op</span><span class="op" id="5725395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725400">if</span>&nbsp;<span class="ident" id="5725403">x</span><span class="op" id="5725404">.</span><span class="ident" id="5725405">Op</span>&nbsp;<span class="op" id="5725408">==</span>&nbsp;<span class="ident" id="5725411">token</span><span class="op" id="5725416">.</span><span class="ident" id="5725417">RANGE</span>&nbsp;<span class="op" id="5725423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725429">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725488">p</span><span class="op" id="5725489">.</span><span class="builtinfunc" id="5725490">print</span><span class="op" id="5725495">(</span><span class="ident" id="5725496">blank</span><span class="op" id="5725501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725506">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725511">p</span><span class="op" id="5725512">.</span><span class="ident" id="5725513">expr1</span><span class="op" id="5725518">(</span><span class="ident" id="5725519">x</span><span class="op" id="5725520">.</span><span class="ident" id="5725521">X</span><span class="op" id="5725522">,</span>&nbsp;<span class="ident" id="5725524">prec</span><span class="op" id="5725528">,</span>&nbsp;<span class="ident" id="5725530">depth</span><span class="op" id="5725535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725543">case</span>&nbsp;<span class="op" id="5725548">*</span><span class="ident" id="5725549">ast</span><span class="op" id="5725552">.</span><span class="ident" id="5725553">BasicLit</span><span class="op" id="5725561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725565">p</span><span class="op" id="5725566">.</span><span class="builtinfunc" id="5725567">print</span><span class="op" id="5725572">(</span><span class="ident" id="5725573">x</span><span class="op" id="5725574">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725578">case</span>&nbsp;<span class="op" id="5725583">*</span><span class="ident" id="5725584">ast</span><span class="op" id="5725587">.</span><span class="ident" id="5725588">FuncLit</span><span class="op" id="5725595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725599">p</span><span class="op" id="5725600">.</span><span class="ident" id="5725601">expr</span><span class="op" id="5725605">(</span><span class="ident" id="5725606">x</span><span class="op" id="5725607">.</span><span class="ident" id="5725608">Type</span><span class="op" id="5725612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725616">p</span><span class="op" id="5725617">.</span><span class="ident" id="5725618">adjBlock</span><span class="op" id="5725626">(</span><span class="ident" id="5725627">p</span><span class="op" id="5725628">.</span><span class="ident" id="5725629">distanceFrom</span><span class="op" id="5725641">(</span><span class="ident" id="5725642">x</span><span class="op" id="5725643">.</span><span class="ident" id="5725644">Type</span><span class="op" id="5725648">.</span><span class="ident" id="5725649">Pos</span><span class="op" id="5725652">(</span><span class="op" id="5725653">)</span><span class="op" id="5725654">)</span><span class="op" id="5725655">,</span>&nbsp;<span class="ident" id="5725657">blank</span><span class="op" id="5725662">,</span>&nbsp;<span class="ident" id="5725664">x</span><span class="op" id="5725665">.</span><span class="ident" id="5725666">Body</span><span class="op" id="5725670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725674">case</span>&nbsp;<span class="op" id="5725679">*</span><span class="ident" id="5725680">ast</span><span class="op" id="5725683">.</span><span class="ident" id="5725684">ParenExpr</span><span class="op" id="5725693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725697">if</span>&nbsp;<span class="ident" id="5725700">_</span><span class="op" id="5725701">,</span>&nbsp;<span class="ident" id="5725703">hasParens</span>&nbsp;<span class="op" id="5725713">:=</span>&nbsp;<span class="ident" id="5725716">x</span><span class="op" id="5725717">.</span><span class="ident" id="5725718">X</span><span class="op" id="5725719">.</span><span class="op" id="5725720">(</span><span class="op" id="5725721">*</span><span class="ident" id="5725722">ast</span><span class="op" id="5725725">.</span><span class="ident" id="5725726">ParenExpr</span><span class="op" id="5725735">)</span><span class="op" id="5725736">;</span>&nbsp;<span class="ident" id="5725738">hasParens</span>&nbsp;<span class="op" id="5725748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725753">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725826">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725910">p</span><span class="op" id="5725911">.</span><span class="ident" id="5725912">expr0</span><span class="op" id="5725917">(</span><span class="ident" id="5725918">x</span><span class="op" id="5725919">.</span><span class="ident" id="5725920">X</span><span class="op" id="5725921">,</span>&nbsp;<span class="ident" id="5725923">depth</span><span class="op" id="5725928">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725932">}</span>&nbsp;<span class="keyword" id="5725934">else</span>&nbsp;<span class="op" id="5725939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725944">p</span><span class="op" id="5725945">.</span><span class="builtinfunc" id="5725946">print</span><span class="op" id="5725951">(</span><span class="ident" id="5725952">token</span><span class="op" id="5725957">.</span><span class="ident" id="5725958">LPAREN</span><span class="op" id="5725964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725969">p</span><span class="op" id="5725970">.</span><span class="ident" id="5725971">expr0</span><span class="op" id="5725976">(</span><span class="ident" id="5725977">x</span><span class="op" id="5725978">.</span><span class="ident" id="5725979">X</span><span class="op" id="5725980">,</span>&nbsp;<span class="ident" id="5725982">reduceDepth</span><span class="op" id="5725993">(</span><span class="ident" id="5725994">depth</span><span class="op" id="5725999">)</span><span class="op" id="5726000">)</span>&nbsp;<span class="comment" id="5726002">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726044">p</span><span class="op" id="5726045">.</span><span class="builtinfunc" id="5726046">print</span><span class="op" id="5726051">(</span><span class="ident" id="5726052">x</span><span class="op" id="5726053">.</span><span class="ident" id="5726054">Rparen</span><span class="op" id="5726060">,</span>&nbsp;<span class="ident" id="5726062">token</span><span class="op" id="5726067">.</span><span class="ident" id="5726068">RPAREN</span><span class="op" id="5726074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726078">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726082">case</span>&nbsp;<span class="op" id="5726087">*</span><span class="ident" id="5726088">ast</span><span class="op" id="5726091">.</span><span class="ident" id="5726092">SelectorExpr</span><span class="op" id="5726104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726108">p</span><span class="op" id="5726109">.</span><span class="ident" id="5726110">expr1</span><span class="op" id="5726115">(</span><span class="ident" id="5726116">x</span><span class="op" id="5726117">.</span><span class="ident" id="5726118">X</span><span class="op" id="5726119">,</span>&nbsp;<span class="ident" id="5726121">token</span><span class="op" id="5726126">.</span><span class="ident" id="5726127">HighestPrec</span><span class="op" id="5726138">,</span>&nbsp;<span class="ident" id="5726140">depth</span><span class="op" id="5726145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726149">p</span><span class="op" id="5726150">.</span><span class="builtinfunc" id="5726151">print</span><span class="op" id="5726156">(</span><span class="ident" id="5726157">token</span><span class="op" id="5726162">.</span><span class="ident" id="5726163">PERIOD</span><span class="op" id="5726169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726173">if</span>&nbsp;<span class="ident" id="5726176">line</span>&nbsp;<span class="op" id="5726181">:=</span>&nbsp;<span class="ident" id="5726184">p</span><span class="op" id="5726185">.</span><span class="ident" id="5726186">lineFor</span><span class="op" id="5726193">(</span><span class="ident" id="5726194">x</span><span class="op" id="5726195">.</span><span class="ident" id="5726196">Sel</span><span class="op" id="5726199">.</span><span class="ident" id="5726200">Pos</span><span class="op" id="5726203">(</span><span class="op" id="5726204">)</span><span class="op" id="5726205">)</span><span class="op" id="5726206">;</span>&nbsp;<span class="ident" id="5726208">p</span><span class="op" id="5726209">.</span><span class="ident" id="5726210">pos</span><span class="op" id="5726213">.</span><span class="ident" id="5726214">IsValid</span><span class="op" id="5726221">(</span><span class="op" id="5726222">)</span>&nbsp;<span class="op" id="5726224">&amp;&amp;</span>&nbsp;<span class="ident" id="5726227">p</span><span class="op" id="5726228">.</span><span class="ident" id="5726229">pos</span><span class="op" id="5726232">.</span><span class="ident" id="5726233">Line</span>&nbsp;<span class="op" id="5726238">&lt;</span>&nbsp;<span class="ident" id="5726240">line</span>&nbsp;<span class="op" id="5726245">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726250">p</span><span class="op" id="5726251">.</span><span class="builtinfunc" id="5726252">print</span><span class="op" id="5726257">(</span><span class="ident" id="5726258">indent</span><span class="op" id="5726264">,</span>&nbsp;<span class="ident" id="5726266">newline</span><span class="op" id="5726273">,</span>&nbsp;<span class="ident" id="5726275">x</span><span class="op" id="5726276">.</span><span class="ident" id="5726277">Sel</span><span class="op" id="5726280">.</span><span class="ident" id="5726281">Pos</span><span class="op" id="5726284">(</span><span class="op" id="5726285">)</span><span class="op" id="5726286">,</span>&nbsp;<span class="ident" id="5726288">x</span><span class="op" id="5726289">.</span><span class="ident" id="5726290">Sel</span><span class="op" id="5726293">,</span>&nbsp;<span class="ident" id="5726295">unindent</span><span class="op" id="5726303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726307">}</span>&nbsp;<span class="keyword" id="5726309">else</span>&nbsp;<span class="op" id="5726314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726319">p</span><span class="op" id="5726320">.</span><span class="builtinfunc" id="5726321">print</span><span class="op" id="5726326">(</span><span class="ident" id="5726327">x</span><span class="op" id="5726328">.</span><span class="ident" id="5726329">Sel</span><span class="op" id="5726332">.</span><span class="ident" id="5726333">Pos</span><span class="op" id="5726336">(</span><span class="op" id="5726337">)</span><span class="op" id="5726338">,</span>&nbsp;<span class="ident" id="5726340">x</span><span class="op" id="5726341">.</span><span class="ident" id="5726342">Sel</span><span class="op" id="5726345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726353">case</span>&nbsp;<span class="op" id="5726358">*</span><span class="ident" id="5726359">ast</span><span class="op" id="5726362">.</span><span class="ident" id="5726363">TypeAssertExpr</span><span class="op" id="5726377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726381">p</span><span class="op" id="5726382">.</span><span class="ident" id="5726383">expr1</span><span class="op" id="5726388">(</span><span class="ident" id="5726389">x</span><span class="op" id="5726390">.</span><span class="ident" id="5726391">X</span><span class="op" id="5726392">,</span>&nbsp;<span class="ident" id="5726394">token</span><span class="op" id="5726399">.</span><span class="ident" id="5726400">HighestPrec</span><span class="op" id="5726411">,</span>&nbsp;<span class="ident" id="5726413">depth</span><span class="op" id="5726418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726422">p</span><span class="op" id="5726423">.</span><span class="builtinfunc" id="5726424">print</span><span class="op" id="5726429">(</span><span class="ident" id="5726430">token</span><span class="op" id="5726435">.</span><span class="ident" id="5726436">PERIOD</span><span class="op" id="5726442">,</span>&nbsp;<span class="ident" id="5726444">x</span><span class="op" id="5726445">.</span><span class="ident" id="5726446">Lparen</span><span class="op" id="5726452">,</span>&nbsp;<span class="ident" id="5726454">token</span><span class="op" id="5726459">.</span><span class="ident" id="5726460">LPAREN</span><span class="op" id="5726466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726470">if</span>&nbsp;<span class="ident" id="5726473">x</span><span class="op" id="5726474">.</span><span class="ident" id="5726475">Type</span>&nbsp;<span class="op" id="5726480">!=</span>&nbsp;<span class="ident" id="5726483">nil</span>&nbsp;<span class="op" id="5726487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726492">p</span><span class="op" id="5726493">.</span><span class="ident" id="5726494">expr</span><span class="op" id="5726498">(</span><span class="ident" id="5726499">x</span><span class="op" id="5726500">.</span><span class="ident" id="5726501">Type</span><span class="op" id="5726505">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726509">}</span>&nbsp;<span class="keyword" id="5726511">else</span>&nbsp;<span class="op" id="5726516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726521">p</span><span class="op" id="5726522">.</span><span class="builtinfunc" id="5726523">print</span><span class="op" id="5726528">(</span><span class="ident" id="5726529">token</span><span class="op" id="5726534">.</span><span class="ident" id="5726535">TYPE</span><span class="op" id="5726539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726547">p</span><span class="op" id="5726548">.</span><span class="builtinfunc" id="5726549">print</span><span class="op" id="5726554">(</span><span class="ident" id="5726555">x</span><span class="op" id="5726556">.</span><span class="ident" id="5726557">Rparen</span><span class="op" id="5726563">,</span>&nbsp;<span class="ident" id="5726565">token</span><span class="op" id="5726570">.</span><span class="ident" id="5726571">RPAREN</span><span class="op" id="5726577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726581">case</span>&nbsp;<span class="op" id="5726586">*</span><span class="ident" id="5726587">ast</span><span class="op" id="5726590">.</span><span class="ident" id="5726591">IndexExpr</span><span class="op" id="5726600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726604">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726680">p</span><span class="op" id="5726681">.</span><span class="ident" id="5726682">expr1</span><span class="op" id="5726687">(</span><span class="ident" id="5726688">x</span><span class="op" id="5726689">.</span><span class="ident" id="5726690">X</span><span class="op" id="5726691">,</span>&nbsp;<span class="ident" id="5726693">token</span><span class="op" id="5726698">.</span><span class="ident" id="5726699">HighestPrec</span><span class="op" id="5726710">,</span>&nbsp;<span class="num" id="5726712">1</span><span class="op" id="5726713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726717">p</span><span class="op" id="5726718">.</span><span class="builtinfunc" id="5726719">print</span><span class="op" id="5726724">(</span><span class="ident" id="5726725">x</span><span class="op" id="5726726">.</span><span class="ident" id="5726727">Lbrack</span><span class="op" id="5726733">,</span>&nbsp;<span class="ident" id="5726735">token</span><span class="op" id="5726740">.</span><span class="ident" id="5726741">LBRACK</span><span class="op" id="5726747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726751">p</span><span class="op" id="5726752">.</span><span class="ident" id="5726753">expr0</span><span class="op" id="5726758">(</span><span class="ident" id="5726759">x</span><span class="op" id="5726760">.</span><span class="ident" id="5726761">Index</span><span class="op" id="5726766">,</span>&nbsp;<span class="ident" id="5726768">depth</span><span class="op" id="5726773">+</span><span class="num" id="5726774">1</span><span class="op" id="5726775">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726779">p</span><span class="op" id="5726780">.</span><span class="builtinfunc" id="5726781">print</span><span class="op" id="5726786">(</span><span class="ident" id="5726787">x</span><span class="op" id="5726788">.</span><span class="ident" id="5726789">Rbrack</span><span class="op" id="5726795">,</span>&nbsp;<span class="ident" id="5726797">token</span><span class="op" id="5726802">.</span><span class="ident" id="5726803">RBRACK</span><span class="op" id="5726809">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726813">case</span>&nbsp;<span class="op" id="5726818">*</span><span class="ident" id="5726819">ast</span><span class="op" id="5726822">.</span><span class="ident" id="5726823">SliceExpr</span><span class="op" id="5726832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726836">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726912">p</span><span class="op" id="5726913">.</span><span class="ident" id="5726914">expr1</span><span class="op" id="5726919">(</span><span class="ident" id="5726920">x</span><span class="op" id="5726921">.</span><span class="ident" id="5726922">X</span><span class="op" id="5726923">,</span>&nbsp;<span class="ident" id="5726925">token</span><span class="op" id="5726930">.</span><span class="ident" id="5726931">HighestPrec</span><span class="op" id="5726942">,</span>&nbsp;<span class="num" id="5726944">1</span><span class="op" id="5726945">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726949">p</span><span class="op" id="5726950">.</span><span class="builtinfunc" id="5726951">print</span><span class="op" id="5726956">(</span><span class="ident" id="5726957">x</span><span class="op" id="5726958">.</span><span class="ident" id="5726959">Lbrack</span><span class="op" id="5726965">,</span>&nbsp;<span class="ident" id="5726967">token</span><span class="op" id="5726972">.</span><span class="ident" id="5726973">LBRACK</span><span class="op" id="5726979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726983">indices</span>&nbsp;<span class="op" id="5726991">:=</span>&nbsp;<span class="op" id="5726994">[</span><span class="op" id="5726995">]</span><span class="ident" id="5726996">ast</span><span class="op" id="5726999">.</span><span class="ident" id="5727000">Expr</span><span class="op" id="5727004">{</span><span class="ident" id="5727005">x</span><span class="op" id="5727006">.</span><span class="ident" id="5727007">Low</span><span class="op" id="5727010">,</span>&nbsp;<span class="ident" id="5727012">x</span><span class="op" id="5727013">.</span><span class="ident" id="5727014">High</span><span class="op" id="5727018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727022">if</span>&nbsp;<span class="ident" id="5727025">x</span><span class="op" id="5727026">.</span><span class="ident" id="5727027">Max</span>&nbsp;<span class="op" id="5727031">!=</span>&nbsp;<span class="ident" id="5727034">nil</span>&nbsp;<span class="op" id="5727038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727043">indices</span>&nbsp;<span class="op" id="5727051">=</span>&nbsp;<span class="builtinfunc" id="5727053">append</span><span class="op" id="5727059">(</span><span class="ident" id="5727060">indices</span><span class="op" id="5727067">,</span>&nbsp;<span class="ident" id="5727069">x</span><span class="op" id="5727070">.</span><span class="ident" id="5727071">Max</span><span class="op" id="5727074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727078">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727082">for</span>&nbsp;<span class="ident" id="5727086">i</span><span class="op" id="5727087">,</span>&nbsp;<span class="ident" id="5727089">y</span>&nbsp;<span class="op" id="5727091">:=</span>&nbsp;<span class="keyword" id="5727094">range</span>&nbsp;<span class="ident" id="5727100">indices</span>&nbsp;<span class="op" id="5727108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727113">if</span>&nbsp;<span class="ident" id="5727116">i</span>&nbsp;<span class="op" id="5727118">&gt;</span>&nbsp;<span class="num" id="5727120">0</span>&nbsp;<span class="op" id="5727122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727128">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727212">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727295">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727337">x</span>&nbsp;<span class="op" id="5727339">:=</span>&nbsp;<span class="ident" id="5727342">indices</span><span class="op" id="5727349">[</span><span class="ident" id="5727350">i</span><span class="op" id="5727351">-</span><span class="num" id="5727352">1</span><span class="op" id="5727353">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727359">if</span>&nbsp;<span class="ident" id="5727362">depth</span>&nbsp;<span class="op" id="5727368">&lt;=</span>&nbsp;<span class="num" id="5727371">1</span>&nbsp;<span class="op" id="5727373">&amp;&amp;</span>&nbsp;<span class="ident" id="5727376">x</span>&nbsp;<span class="op" id="5727378">!=</span>&nbsp;<span class="ident" id="5727381">nil</span>&nbsp;<span class="op" id="5727385">&amp;&amp;</span>&nbsp;<span class="ident" id="5727388">y</span>&nbsp;<span class="op" id="5727390">!=</span>&nbsp;<span class="ident" id="5727393">nil</span>&nbsp;<span class="op" id="5727397">&amp;&amp;</span>&nbsp;<span class="op" id="5727400">(</span><span class="ident" id="5727401">isBinary</span><span class="op" id="5727409">(</span><span class="ident" id="5727410">x</span><span class="op" id="5727411">)</span>&nbsp;<span class="op" id="5727413">||</span>&nbsp;<span class="ident" id="5727416">isBinary</span><span class="op" id="5727424">(</span><span class="ident" id="5727425">y</span><span class="op" id="5727426">)</span><span class="op" id="5727427">)</span>&nbsp;<span class="op" id="5727429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727436">p</span><span class="op" id="5727437">.</span><span class="builtinfunc" id="5727438">print</span><span class="op" id="5727443">(</span><span class="ident" id="5727444">blank</span><span class="op" id="5727449">,</span>&nbsp;<span class="ident" id="5727451">token</span><span class="op" id="5727456">.</span><span class="ident" id="5727457">COLON</span><span class="op" id="5727462">,</span>&nbsp;<span class="ident" id="5727464">blank</span><span class="op" id="5727469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727475">}</span>&nbsp;<span class="keyword" id="5727477">else</span>&nbsp;<span class="op" id="5727482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727489">p</span><span class="op" id="5727490">.</span><span class="builtinfunc" id="5727491">print</span><span class="op" id="5727496">(</span><span class="ident" id="5727497">token</span><span class="op" id="5727502">.</span><span class="ident" id="5727503">COLON</span><span class="op" id="5727508">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727524">if</span>&nbsp;<span class="ident" id="5727527">y</span>&nbsp;<span class="op" id="5727529">!=</span>&nbsp;<span class="ident" id="5727532">nil</span>&nbsp;<span class="op" id="5727536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727542">p</span><span class="op" id="5727543">.</span><span class="ident" id="5727544">expr0</span><span class="op" id="5727549">(</span><span class="ident" id="5727550">y</span><span class="op" id="5727551">,</span>&nbsp;<span class="ident" id="5727553">depth</span><span class="op" id="5727558">+</span><span class="num" id="5727559">1</span><span class="op" id="5727560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727565">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727573">p</span><span class="op" id="5727574">.</span><span class="builtinfunc" id="5727575">print</span><span class="op" id="5727580">(</span><span class="ident" id="5727581">x</span><span class="op" id="5727582">.</span><span class="ident" id="5727583">Rbrack</span><span class="op" id="5727589">,</span>&nbsp;<span class="ident" id="5727591">token</span><span class="op" id="5727596">.</span><span class="ident" id="5727597">RBRACK</span><span class="op" id="5727603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727607">case</span>&nbsp;<span class="op" id="5727612">*</span><span class="ident" id="5727613">ast</span><span class="op" id="5727616">.</span><span class="ident" id="5727617">CallExpr</span><span class="op" id="5727625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727629">if</span>&nbsp;<span class="builtinfunc" id="5727632">len</span><span class="op" id="5727635">(</span><span class="ident" id="5727636">x</span><span class="op" id="5727637">.</span><span class="ident" id="5727638">Args</span><span class="op" id="5727642">)</span>&nbsp;<span class="op" id="5727644">&gt;</span>&nbsp;<span class="num" id="5727646">1</span>&nbsp;<span class="op" id="5727648">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727653">depth</span><span class="op" id="5727658">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727667">if</span>&nbsp;<span class="ident" id="5727670">_</span><span class="op" id="5727671">,</span>&nbsp;<span class="ident" id="5727673">ok</span>&nbsp;<span class="op" id="5727676">:=</span>&nbsp;<span class="ident" id="5727679">x</span><span class="op" id="5727680">.</span><span class="ident" id="5727681">Fun</span><span class="op" id="5727684">.</span><span class="op" id="5727685">(</span><span class="op" id="5727686">*</span><span class="ident" id="5727687">ast</span><span class="op" id="5727690">.</span><span class="ident" id="5727691">FuncType</span><span class="op" id="5727699">)</span><span class="op" id="5727700">;</span>&nbsp;<span class="ident" id="5727702">ok</span>&nbsp;<span class="op" id="5727705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727710">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727790">p</span><span class="op" id="5727791">.</span><span class="builtinfunc" id="5727792">print</span><span class="op" id="5727797">(</span><span class="ident" id="5727798">token</span><span class="op" id="5727803">.</span><span class="ident" id="5727804">LPAREN</span><span class="op" id="5727810">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727815">p</span><span class="op" id="5727816">.</span><span class="ident" id="5727817">expr1</span><span class="op" id="5727822">(</span><span class="ident" id="5727823">x</span><span class="op" id="5727824">.</span><span class="ident" id="5727825">Fun</span><span class="op" id="5727828">,</span>&nbsp;<span class="ident" id="5727830">token</span><span class="op" id="5727835">.</span><span class="ident" id="5727836">HighestPrec</span><span class="op" id="5727847">,</span>&nbsp;<span class="ident" id="5727849">depth</span><span class="op" id="5727854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727859">p</span><span class="op" id="5727860">.</span><span class="builtinfunc" id="5727861">print</span><span class="op" id="5727866">(</span><span class="ident" id="5727867">token</span><span class="op" id="5727872">.</span><span class="ident" id="5727873">RPAREN</span><span class="op" id="5727879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727883">}</span>&nbsp;<span class="keyword" id="5727885">else</span>&nbsp;<span class="op" id="5727890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727895">p</span><span class="op" id="5727896">.</span><span class="ident" id="5727897">expr1</span><span class="op" id="5727902">(</span><span class="ident" id="5727903">x</span><span class="op" id="5727904">.</span><span class="ident" id="5727905">Fun</span><span class="op" id="5727908">,</span>&nbsp;<span class="ident" id="5727910">token</span><span class="op" id="5727915">.</span><span class="ident" id="5727916">HighestPrec</span><span class="op" id="5727927">,</span>&nbsp;<span class="ident" id="5727929">depth</span><span class="op" id="5727934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727938">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727942">p</span><span class="op" id="5727943">.</span><span class="builtinfunc" id="5727944">print</span><span class="op" id="5727949">(</span><span class="ident" id="5727950">x</span><span class="op" id="5727951">.</span><span class="ident" id="5727952">Lparen</span><span class="op" id="5727958">,</span>&nbsp;<span class="ident" id="5727960">token</span><span class="op" id="5727965">.</span><span class="ident" id="5727966">LPAREN</span><span class="op" id="5727972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727976">if</span>&nbsp;<span class="ident" id="5727979">x</span><span class="op" id="5727980">.</span><span class="ident" id="5727981">Ellipsis</span><span class="op" id="5727989">.</span><span class="ident" id="5727990">IsValid</span><span class="op" id="5727997">(</span><span class="op" id="5727998">)</span>&nbsp;<span class="op" id="5728000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728005">p</span><span class="op" id="5728006">.</span><span class="ident" id="5728007">exprList</span><span class="op" id="5728015">(</span><span class="ident" id="5728016">x</span><span class="op" id="5728017">.</span><span class="ident" id="5728018">Lparen</span><span class="op" id="5728024">,</span>&nbsp;<span class="ident" id="5728026">x</span><span class="op" id="5728027">.</span><span class="ident" id="5728028">Args</span><span class="op" id="5728032">,</span>&nbsp;<span class="ident" id="5728034">depth</span><span class="op" id="5728039">,</span>&nbsp;<span class="num" id="5728041">0</span><span class="op" id="5728042">,</span>&nbsp;<span class="ident" id="5728044">x</span><span class="op" id="5728045">.</span><span class="ident" id="5728046">Ellipsis</span><span class="op" id="5728054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728059">p</span><span class="op" id="5728060">.</span><span class="builtinfunc" id="5728061">print</span><span class="op" id="5728066">(</span><span class="ident" id="5728067">x</span><span class="op" id="5728068">.</span><span class="ident" id="5728069">Ellipsis</span><span class="op" id="5728077">,</span>&nbsp;<span class="ident" id="5728079">token</span><span class="op" id="5728084">.</span><span class="ident" id="5728085">ELLIPSIS</span><span class="op" id="5728093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728098">if</span>&nbsp;<span class="ident" id="5728101">x</span><span class="op" id="5728102">.</span><span class="ident" id="5728103">Rparen</span><span class="op" id="5728109">.</span><span class="ident" id="5728110">IsValid</span><span class="op" id="5728117">(</span><span class="op" id="5728118">)</span>&nbsp;<span class="op" id="5728120">&amp;&amp;</span>&nbsp;<span class="ident" id="5728123">p</span><span class="op" id="5728124">.</span><span class="ident" id="5728125">lineFor</span><span class="op" id="5728132">(</span><span class="ident" id="5728133">x</span><span class="op" id="5728134">.</span><span class="ident" id="5728135">Ellipsis</span><span class="op" id="5728143">)</span>&nbsp;<span class="op" id="5728145">&lt;</span>&nbsp;<span class="ident" id="5728147">p</span><span class="op" id="5728148">.</span><span class="ident" id="5728149">lineFor</span><span class="op" id="5728156">(</span><span class="ident" id="5728157">x</span><span class="op" id="5728158">.</span><span class="ident" id="5728159">Rparen</span><span class="op" id="5728165">)</span>&nbsp;<span class="op" id="5728167">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728173">p</span><span class="op" id="5728174">.</span><span class="builtinfunc" id="5728175">print</span><span class="op" id="5728180">(</span><span class="ident" id="5728181">token</span><span class="op" id="5728186">.</span><span class="ident" id="5728187">COMMA</span><span class="op" id="5728192">,</span>&nbsp;<span class="ident" id="5728194">formfeed</span><span class="op" id="5728202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728211">}</span>&nbsp;<span class="keyword" id="5728213">else</span>&nbsp;<span class="op" id="5728218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728223">p</span><span class="op" id="5728224">.</span><span class="ident" id="5728225">exprList</span><span class="op" id="5728233">(</span><span class="ident" id="5728234">x</span><span class="op" id="5728235">.</span><span class="ident" id="5728236">Lparen</span><span class="op" id="5728242">,</span>&nbsp;<span class="ident" id="5728244">x</span><span class="op" id="5728245">.</span><span class="ident" id="5728246">Args</span><span class="op" id="5728250">,</span>&nbsp;<span class="ident" id="5728252">depth</span><span class="op" id="5728257">,</span>&nbsp;<span class="ident" id="5728259">commaTerm</span><span class="op" id="5728268">,</span>&nbsp;<span class="ident" id="5728270">x</span><span class="op" id="5728271">.</span><span class="ident" id="5728272">Rparen</span><span class="op" id="5728278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728282">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728286">p</span><span class="op" id="5728287">.</span><span class="builtinfunc" id="5728288">print</span><span class="op" id="5728293">(</span><span class="ident" id="5728294">x</span><span class="op" id="5728295">.</span><span class="ident" id="5728296">Rparen</span><span class="op" id="5728302">,</span>&nbsp;<span class="ident" id="5728304">token</span><span class="op" id="5728309">.</span><span class="ident" id="5728310">RPAREN</span><span class="op" id="5728316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728320">case</span>&nbsp;<span class="op" id="5728325">*</span><span class="ident" id="5728326">ast</span><span class="op" id="5728329">.</span><span class="ident" id="5728330">CompositeLit</span><span class="op" id="5728342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728346">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728443">if</span>&nbsp;<span class="ident" id="5728446">x</span><span class="op" id="5728447">.</span><span class="ident" id="5728448">Type</span>&nbsp;<span class="op" id="5728453">!=</span>&nbsp;<span class="ident" id="5728456">nil</span>&nbsp;<span class="op" id="5728460">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728465">p</span><span class="op" id="5728466">.</span><span class="ident" id="5728467">expr1</span><span class="op" id="5728472">(</span><span class="ident" id="5728473">x</span><span class="op" id="5728474">.</span><span class="ident" id="5728475">Type</span><span class="op" id="5728479">,</span>&nbsp;<span class="ident" id="5728481">token</span><span class="op" id="5728486">.</span><span class="ident" id="5728487">HighestPrec</span><span class="op" id="5728498">,</span>&nbsp;<span class="ident" id="5728500">depth</span><span class="op" id="5728505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728513">p</span><span class="op" id="5728514">.</span><span class="builtinfunc" id="5728515">print</span><span class="op" id="5728520">(</span><span class="ident" id="5728521">x</span><span class="op" id="5728522">.</span><span class="ident" id="5728523">Lbrace</span><span class="op" id="5728529">,</span>&nbsp;<span class="ident" id="5728531">token</span><span class="op" id="5728536">.</span><span class="ident" id="5728537">LBRACE</span><span class="op" id="5728543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728547">p</span><span class="op" id="5728548">.</span><span class="ident" id="5728549">exprList</span><span class="op" id="5728557">(</span><span class="ident" id="5728558">x</span><span class="op" id="5728559">.</span><span class="ident" id="5728560">Lbrace</span><span class="op" id="5728566">,</span>&nbsp;<span class="ident" id="5728568">x</span><span class="op" id="5728569">.</span><span class="ident" id="5728570">Elts</span><span class="op" id="5728574">,</span>&nbsp;<span class="num" id="5728576">1</span><span class="op" id="5728577">,</span>&nbsp;<span class="ident" id="5728579">commaTerm</span><span class="op" id="5728588">,</span>&nbsp;<span class="ident" id="5728590">x</span><span class="op" id="5728591">.</span><span class="ident" id="5728592">Rbrace</span><span class="op" id="5728598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728602">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728667">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728731">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728755">mode</span>&nbsp;<span class="op" id="5728760">:=</span>&nbsp;<span class="ident" id="5728763">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728782">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728842">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728898">if</span>&nbsp;<span class="builtinfunc" id="5728901">len</span><span class="op" id="5728904">(</span><span class="ident" id="5728905">x</span><span class="op" id="5728906">.</span><span class="ident" id="5728907">Elts</span><span class="op" id="5728911">)</span>&nbsp;<span class="op" id="5728913">&gt;</span>&nbsp;<span class="num" id="5728915">0</span>&nbsp;<span class="op" id="5728917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728922">mode</span>&nbsp;<span class="op" id="5728927">|=</span>&nbsp;<span class="ident" id="5728930">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728949">p</span><span class="op" id="5728950">.</span><span class="builtinfunc" id="5728951">print</span><span class="op" id="5728956">(</span><span class="ident" id="5728957">mode</span><span class="op" id="5728961">,</span>&nbsp;<span class="ident" id="5728963">x</span><span class="op" id="5728964">.</span><span class="ident" id="5728965">Rbrace</span><span class="op" id="5728971">,</span>&nbsp;<span class="ident" id="5728973">token</span><span class="op" id="5728978">.</span><span class="ident" id="5728979">RBRACE</span><span class="op" id="5728985">,</span>&nbsp;<span class="ident" id="5728987">mode</span><span class="op" id="5728991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728995">case</span>&nbsp;<span class="op" id="5729000">*</span><span class="ident" id="5729001">ast</span><span class="op" id="5729004">.</span><span class="ident" id="5729005">Ellipsis</span><span class="op" id="5729013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729017">p</span><span class="op" id="5729018">.</span><span class="builtinfunc" id="5729019">print</span><span class="op" id="5729024">(</span><span class="ident" id="5729025">token</span><span class="op" id="5729030">.</span><span class="ident" id="5729031">ELLIPSIS</span><span class="op" id="5729039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729043">if</span>&nbsp;<span class="ident" id="5729046">x</span><span class="op" id="5729047">.</span><span class="ident" id="5729048">Elt</span>&nbsp;<span class="op" id="5729052">!=</span>&nbsp;<span class="ident" id="5729055">nil</span>&nbsp;<span class="op" id="5729059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729064">p</span><span class="op" id="5729065">.</span><span class="ident" id="5729066">expr</span><span class="op" id="5729070">(</span><span class="ident" id="5729071">x</span><span class="op" id="5729072">.</span><span class="ident" id="5729073">Elt</span><span class="op" id="5729076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729080">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729084">case</span>&nbsp;<span class="op" id="5729089">*</span><span class="ident" id="5729090">ast</span><span class="op" id="5729093">.</span><span class="ident" id="5729094">ArrayType</span><span class="op" id="5729103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729107">p</span><span class="op" id="5729108">.</span><span class="builtinfunc" id="5729109">print</span><span class="op" id="5729114">(</span><span class="ident" id="5729115">token</span><span class="op" id="5729120">.</span><span class="ident" id="5729121">LBRACK</span><span class="op" id="5729127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729131">if</span>&nbsp;<span class="ident" id="5729134">x</span><span class="op" id="5729135">.</span><span class="ident" id="5729136">Len</span>&nbsp;<span class="op" id="5729140">!=</span>&nbsp;<span class="ident" id="5729143">nil</span>&nbsp;<span class="op" id="5729147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729152">p</span><span class="op" id="5729153">.</span><span class="ident" id="5729154">expr</span><span class="op" id="5729158">(</span><span class="ident" id="5729159">x</span><span class="op" id="5729160">.</span><span class="ident" id="5729161">Len</span><span class="op" id="5729164">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729172">p</span><span class="op" id="5729173">.</span><span class="builtinfunc" id="5729174">print</span><span class="op" id="5729179">(</span><span class="ident" id="5729180">token</span><span class="op" id="5729185">.</span><span class="ident" id="5729186">RBRACK</span><span class="op" id="5729192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729196">p</span><span class="op" id="5729197">.</span><span class="ident" id="5729198">expr</span><span class="op" id="5729202">(</span><span class="ident" id="5729203">x</span><span class="op" id="5729204">.</span><span class="ident" id="5729205">Elt</span><span class="op" id="5729208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729212">case</span>&nbsp;<span class="op" id="5729217">*</span><span class="ident" id="5729218">ast</span><span class="op" id="5729221">.</span><span class="ident" id="5729222">StructType</span><span class="op" id="5729232">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729236">p</span><span class="op" id="5729237">.</span><span class="builtinfunc" id="5729238">print</span><span class="op" id="5729243">(</span><span class="ident" id="5729244">token</span><span class="op" id="5729249">.</span><span class="ident" id="5729250">STRUCT</span><span class="op" id="5729256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729260">p</span><span class="op" id="5729261">.</span><span class="ident" id="5729262">fieldList</span><span class="op" id="5729271">(</span><span class="ident" id="5729272">x</span><span class="op" id="5729273">.</span><span class="ident" id="5729274">Fields</span><span class="op" id="5729280">,</span>&nbsp;<span class="ident" id="5729282">true</span><span class="op" id="5729286">,</span>&nbsp;<span class="ident" id="5729288">x</span><span class="op" id="5729289">.</span><span class="ident" id="5729290">Incomplete</span><span class="op" id="5729300">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729304">case</span>&nbsp;<span class="op" id="5729309">*</span><span class="ident" id="5729310">ast</span><span class="op" id="5729313">.</span><span class="ident" id="5729314">FuncType</span><span class="op" id="5729322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729326">p</span><span class="op" id="5729327">.</span><span class="builtinfunc" id="5729328">print</span><span class="op" id="5729333">(</span><span class="ident" id="5729334">token</span><span class="op" id="5729339">.</span><span class="ident" id="5729340">FUNC</span><span class="op" id="5729344">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729348">p</span><span class="op" id="5729349">.</span><span class="ident" id="5729350">signature</span><span class="op" id="5729359">(</span><span class="ident" id="5729360">x</span><span class="op" id="5729361">.</span><span class="ident" id="5729362">Params</span><span class="op" id="5729368">,</span>&nbsp;<span class="ident" id="5729370">x</span><span class="op" id="5729371">.</span><span class="ident" id="5729372">Results</span><span class="op" id="5729379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729383">case</span>&nbsp;<span class="op" id="5729388">*</span><span class="ident" id="5729389">ast</span><span class="op" id="5729392">.</span><span class="ident" id="5729393">InterfaceType</span><span class="op" id="5729406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729410">p</span><span class="op" id="5729411">.</span><span class="builtinfunc" id="5729412">print</span><span class="op" id="5729417">(</span><span class="ident" id="5729418">token</span><span class="op" id="5729423">.</span><span class="ident" id="5729424">INTERFACE</span><span class="op" id="5729433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729437">p</span><span class="op" id="5729438">.</span><span class="ident" id="5729439">fieldList</span><span class="op" id="5729448">(</span><span class="ident" id="5729449">x</span><span class="op" id="5729450">.</span><span class="ident" id="5729451">Methods</span><span class="op" id="5729458">,</span>&nbsp;<span class="ident" id="5729460">false</span><span class="op" id="5729465">,</span>&nbsp;<span class="ident" id="5729467">x</span><span class="op" id="5729468">.</span><span class="ident" id="5729469">Incomplete</span><span class="op" id="5729479">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729483">case</span>&nbsp;<span class="op" id="5729488">*</span><span class="ident" id="5729489">ast</span><span class="op" id="5729492">.</span><span class="ident" id="5729493">MapType</span><span class="op" id="5729500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729504">p</span><span class="op" id="5729505">.</span><span class="builtinfunc" id="5729506">print</span><span class="op" id="5729511">(</span><span class="ident" id="5729512">token</span><span class="op" id="5729517">.</span><span class="ident" id="5729518">MAP</span><span class="op" id="5729521">,</span>&nbsp;<span class="ident" id="5729523">token</span><span class="op" id="5729528">.</span><span class="ident" id="5729529">LBRACK</span><span class="op" id="5729535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729539">p</span><span class="op" id="5729540">.</span><span class="ident" id="5729541">expr</span><span class="op" id="5729545">(</span><span class="ident" id="5729546">x</span><span class="op" id="5729547">.</span><span class="ident" id="5729548">Key</span><span class="op" id="5729551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729555">p</span><span class="op" id="5729556">.</span><span class="builtinfunc" id="5729557">print</span><span class="op" id="5729562">(</span><span class="ident" id="5729563">token</span><span class="op" id="5729568">.</span><span class="ident" id="5729569">RBRACK</span><span class="op" id="5729575">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729579">p</span><span class="op" id="5729580">.</span><span class="ident" id="5729581">expr</span><span class="op" id="5729585">(</span><span class="ident" id="5729586">x</span><span class="op" id="5729587">.</span><span class="ident" id="5729588">Value</span><span class="op" id="5729593">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729597">case</span>&nbsp;<span class="op" id="5729602">*</span><span class="ident" id="5729603">ast</span><span class="op" id="5729606">.</span><span class="ident" id="5729607">ChanType</span><span class="op" id="5729615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729619">switch</span>&nbsp;<span class="ident" id="5729626">x</span><span class="op" id="5729627">.</span><span class="ident" id="5729628">Dir</span>&nbsp;<span class="op" id="5729632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729636">case</span>&nbsp;<span class="ident" id="5729641">ast</span><span class="op" id="5729644">.</span><span class="ident" id="5729645">SEND</span>&nbsp;<span class="op" id="5729650">|</span>&nbsp;<span class="ident" id="5729652">ast</span><span class="op" id="5729655">.</span><span class="ident" id="5729656">RECV</span><span class="op" id="5729660">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729665">p</span><span class="op" id="5729666">.</span><span class="builtinfunc" id="5729667">print</span><span class="op" id="5729672">(</span><span class="ident" id="5729673">token</span><span class="op" id="5729678">.</span><span class="ident" id="5729679">CHAN</span><span class="op" id="5729683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729687">case</span>&nbsp;<span class="ident" id="5729692">ast</span><span class="op" id="5729695">.</span><span class="ident" id="5729696">RECV</span><span class="op" id="5729700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729705">p</span><span class="op" id="5729706">.</span><span class="builtinfunc" id="5729707">print</span><span class="op" id="5729712">(</span><span class="ident" id="5729713">token</span><span class="op" id="5729718">.</span><span class="ident" id="5729719">ARROW</span><span class="op" id="5729724">,</span>&nbsp;<span class="ident" id="5729726">token</span><span class="op" id="5729731">.</span><span class="ident" id="5729732">CHAN</span><span class="op" id="5729736">)</span>&nbsp;<span class="comment" id="5729738">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729776">case</span>&nbsp;<span class="ident" id="5729781">ast</span><span class="op" id="5729784">.</span><span class="ident" id="5729785">SEND</span><span class="op" id="5729789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729794">p</span><span class="op" id="5729795">.</span><span class="builtinfunc" id="5729796">print</span><span class="op" id="5729801">(</span><span class="ident" id="5729802">token</span><span class="op" id="5729807">.</span><span class="ident" id="5729808">CHAN</span><span class="op" id="5729812">,</span>&nbsp;<span class="ident" id="5729814">x</span><span class="op" id="5729815">.</span><span class="ident" id="5729816">Arrow</span><span class="op" id="5729821">,</span>&nbsp;<span class="ident" id="5729823">token</span><span class="op" id="5729828">.</span><span class="ident" id="5729829">ARROW</span><span class="op" id="5729834">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729842">p</span><span class="op" id="5729843">.</span><span class="builtinfunc" id="5729844">print</span><span class="op" id="5729849">(</span><span class="ident" id="5729850">blank</span><span class="op" id="5729855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729859">p</span><span class="op" id="5729860">.</span><span class="ident" id="5729861">expr</span><span class="op" id="5729865">(</span><span class="ident" id="5729866">x</span><span class="op" id="5729867">.</span><span class="ident" id="5729868">Value</span><span class="op" id="5729873">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729877">default</span><span class="op" id="5729884">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5729888">panic</span><span class="op" id="5729893">(</span><span class="string" id="5729894">&#34;unreachable&#34;</span><span class="op" id="5729907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729914">return</span><br>
<span class="lineno"></span><span class="op" id="5729921">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5729924">func</span>&nbsp;<span class="op" id="5729929">(</span><span class="ident" id="5729930">p</span>&nbsp;<span class="op" id="5729932">*</span><span class="ident" id="5729933">printer</span><span class="op" id="5729940">)</span>&nbsp;<span class="ident" id="5729942">expr0</span><span class="op" id="5729947">(</span><span class="ident" id="5729948">x</span>&nbsp;<span class="ident" id="5729950">ast</span><span class="op" id="5729953">.</span><span class="ident" id="5729954">Expr</span><span class="op" id="5729958">,</span>&nbsp;<span class="ident" id="5729960">depth</span>&nbsp;<span class="builtintype" id="5729966">int</span><span class="op" id="5729969">)</span>&nbsp;<span class="op" id="5729971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729974">p</span><span class="op" id="5729975">.</span><span class="ident" id="5729976">expr1</span><span class="op" id="5729981">(</span><span class="ident" id="5729982">x</span><span class="op" id="5729983">,</span>&nbsp;<span class="ident" id="5729985">token</span><span class="op" id="5729990">.</span><span class="ident" id="5729991">LowestPrec</span><span class="op" id="5730001">,</span>&nbsp;<span class="ident" id="5730003">depth</span><span class="op" id="5730008">)</span><br>
<span class="lineno"></span><span class="op" id="5730010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5730013">func</span>&nbsp;<span class="op" id="5730018">(</span><span class="ident" id="5730019">p</span>&nbsp;<span class="op" id="5730021">*</span><span class="ident" id="5730022">printer</span><span class="op" id="5730029">)</span>&nbsp;<span class="ident" id="5730031">expr</span><span class="op" id="5730035">(</span><span class="ident" id="5730036">x</span>&nbsp;<span class="ident" id="5730038">ast</span><span class="op" id="5730041">.</span><span class="ident" id="5730042">Expr</span><span class="op" id="5730046">)</span>&nbsp;<span class="op" id="5730048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730051">const</span>&nbsp;<span class="ident" id="5730057">depth</span>&nbsp;<span class="op" id="5730063">=</span>&nbsp;<span class="num" id="5730065">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5730068">p</span><span class="op" id="5730069">.</span><span class="ident" id="5730070">expr1</span><span class="op" id="5730075">(</span><span class="ident" id="5730076">x</span><span class="op" id="5730077">,</span>&nbsp;<span class="ident" id="5730079">token</span><span class="op" id="5730084">.</span><span class="ident" id="5730085">LowestPrec</span><span class="op" id="5730095">,</span>&nbsp;<span class="ident" id="5730097">depth</span><span class="op" id="5730102">)</span><br>
<span class="lineno"></span><span class="op" id="5730104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5730107">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5730187">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5730202">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5730288">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5730372">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5730417">func</span>&nbsp;<span class="op" id="5730422">(</span><span class="ident" id="5730423">p</span>&nbsp;<span class="op" id="5730425">*</span><span class="ident" id="5730426">printer</span><span class="op" id="5730433">)</span>&nbsp;<span class="ident" id="5730435">stmtList</span><span class="op" id="5730443">(</span><span class="ident" id="5730444">list</span>&nbsp;<span class="op" id="5730449">[</span><span class="op" id="5730450">]</span><span class="ident" id="5730451">ast</span><span class="op" id="5730454">.</span><span class="ident" id="5730455">Stmt</span><span class="op" id="5730459">,</span>&nbsp;<span class="ident" id="5730461">nindent</span>&nbsp;<span class="builtintype" id="5730469">int</span><span class="op" id="5730472">,</span>&nbsp;<span class="ident" id="5730474">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5730487">bool</span><span class="op" id="5730491">)</span>&nbsp;<span class="op" id="5730493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730496">if</span>&nbsp;<span class="ident" id="5730499">nindent</span>&nbsp;<span class="op" id="5730507">&gt;</span>&nbsp;<span class="num" id="5730509">0</span>&nbsp;<span class="op" id="5730511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5730515">p</span><span class="op" id="5730516">.</span><span class="builtinfunc" id="5730517">print</span><span class="op" id="5730522">(</span><span class="ident" id="5730523">indent</span><span class="op" id="5730529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730532">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730535">var</span>&nbsp;<span class="ident" id="5730539">line</span>&nbsp;<span class="builtintype" id="5730544">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5730549">i</span>&nbsp;<span class="op" id="5730551">:=</span>&nbsp;<span class="num" id="5730554">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730557">for</span>&nbsp;<span class="ident" id="5730561">_</span><span class="op" id="5730562">,</span>&nbsp;<span class="ident" id="5730564">s</span>&nbsp;<span class="op" id="5730566">:=</span>&nbsp;<span class="keyword" id="5730569">range</span>&nbsp;<span class="ident" id="5730575">list</span>&nbsp;<span class="op" id="5730580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5730584">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730630">if</span>&nbsp;<span class="ident" id="5730633">_</span><span class="op" id="5730634">,</span>&nbsp;<span class="ident" id="5730636">isEmpty</span>&nbsp;<span class="op" id="5730644">:=</span>&nbsp;<span class="ident" id="5730647">s</span><span class="op" id="5730648">.</span><span class="op" id="5730649">(</span><span class="op" id="5730650">*</span><span class="ident" id="5730651">ast</span><span class="op" id="5730654">.</span><span class="ident" id="5730655">EmptyStmt</span><span class="op" id="5730664">)</span><span class="op" id="5730665">;</span>&nbsp;<span class="op" id="5730667">!</span><span class="ident" id="5730668">isEmpty</span>&nbsp;<span class="op" id="5730676">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5730681">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5730746">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730796">if</span>&nbsp;<span class="builtinfunc" id="5730799">len</span><span class="op" id="5730802">(</span><span class="ident" id="5730803">p</span><span class="op" id="5730804">.</span><span class="ident" id="5730805">output</span><span class="op" id="5730811">)</span>&nbsp;<span class="op" id="5730813">&gt;</span>&nbsp;<span class="num" id="5730815">0</span>&nbsp;<span class="op" id="5730817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5730823">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5730897">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5730955">p</span><span class="op" id="5730956">.</span><span class="ident" id="5730957">linebreak</span><span class="op" id="5730966">(</span><span class="ident" id="5730967">p</span><span class="op" id="5730968">.</span><span class="ident" id="5730969">lineFor</span><span class="op" id="5730976">(</span><span class="ident" id="5730977">s</span><span class="op" id="5730978">.</span><span class="ident" id="5730979">Pos</span><span class="op" id="5730982">(</span><span class="op" id="5730983">)</span><span class="op" id="5730984">)</span><span class="op" id="5730985">,</span>&nbsp;<span class="num" id="5730987">1</span><span class="op" id="5730988">,</span>&nbsp;<span class="ident" id="5730990">ignore</span><span class="op" id="5730996">,</span>&nbsp;<span class="ident" id="5730998">i</span>&nbsp;<span class="op" id="5731000">==</span>&nbsp;<span class="num" id="5731003">0</span>&nbsp;<span class="op" id="5731005">||</span>&nbsp;<span class="ident" id="5731008">nindent</span>&nbsp;<span class="op" id="5731016">==</span>&nbsp;<span class="num" id="5731019">0</span>&nbsp;<span class="op" id="5731021">||</span>&nbsp;<span class="ident" id="5731024">p</span><span class="op" id="5731025">.</span><span class="ident" id="5731026">linesFrom</span><span class="op" id="5731035">(</span><span class="ident" id="5731036">line</span><span class="op" id="5731040">)</span>&nbsp;<span class="op" id="5731042">&gt;</span>&nbsp;<span class="num" id="5731044">0</span><span class="op" id="5731045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731055">p</span><span class="op" id="5731056">.</span><span class="ident" id="5731057">recordLine</span><span class="op" id="5731067">(</span><span class="op" id="5731068">&amp;</span><span class="ident" id="5731069">line</span><span class="op" id="5731073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731078">p</span><span class="op" id="5731079">.</span><span class="ident" id="5731080">stmt</span><span class="op" id="5731084">(</span><span class="ident" id="5731085">s</span><span class="op" id="5731086">,</span>&nbsp;<span class="ident" id="5731088">nextIsRBrace</span>&nbsp;<span class="op" id="5731101">&amp;&amp;</span>&nbsp;<span class="ident" id="5731104">i</span>&nbsp;<span class="op" id="5731106">==</span>&nbsp;<span class="builtinfunc" id="5731109">len</span><span class="op" id="5731112">(</span><span class="ident" id="5731113">list</span><span class="op" id="5731117">)</span><span class="op" id="5731118">-</span><span class="num" id="5731119">1</span><span class="op" id="5731120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5731125">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5731190">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5731254">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731304">for</span>&nbsp;<span class="ident" id="5731308">t</span>&nbsp;<span class="op" id="5731310">:=</span>&nbsp;<span class="ident" id="5731313">s</span><span class="op" id="5731314">;</span>&nbsp;<span class="op" id="5731316">;</span>&nbsp;<span class="op" id="5731318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731324">lt</span><span class="op" id="5731326">,</span>&nbsp;<span class="ident" id="5731328">_</span>&nbsp;<span class="op" id="5731330">:=</span>&nbsp;<span class="ident" id="5731333">t</span><span class="op" id="5731334">.</span><span class="op" id="5731335">(</span><span class="op" id="5731336">*</span><span class="ident" id="5731337">ast</span><span class="op" id="5731340">.</span><span class="ident" id="5731341">LabeledStmt</span><span class="op" id="5731352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731358">if</span>&nbsp;<span class="ident" id="5731361">lt</span>&nbsp;<span class="op" id="5731364">==</span>&nbsp;<span class="ident" id="5731367">nil</span>&nbsp;<span class="op" id="5731371">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731378">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731394">line</span><span class="op" id="5731398">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731405">t</span>&nbsp;<span class="op" id="5731407">=</span>&nbsp;<span class="ident" id="5731409">lt</span><span class="op" id="5731411">.</span><span class="ident" id="5731412">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731420">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731425">i</span><span class="op" id="5731426">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731437">if</span>&nbsp;<span class="ident" id="5731440">nindent</span>&nbsp;<span class="op" id="5731448">&gt;</span>&nbsp;<span class="num" id="5731450">0</span>&nbsp;<span class="op" id="5731452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731456">p</span><span class="op" id="5731457">.</span><span class="builtinfunc" id="5731458">print</span><span class="op" id="5731463">(</span><span class="ident" id="5731464">unindent</span><span class="op" id="5731472">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731475">}</span><br>
<span class="lineno"></span><span class="op" id="5731477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5731480">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5731551">func</span>&nbsp;<span class="op" id="5731556">(</span><span class="ident" id="5731557">p</span>&nbsp;<span class="op" id="5731559">*</span><span class="ident" id="5731560">printer</span><span class="op" id="5731567">)</span>&nbsp;<span class="ident" id="5731569">block</span><span class="op" id="5731574">(</span><span class="ident" id="5731575">b</span>&nbsp;<span class="op" id="5731577">*</span><span class="ident" id="5731578">ast</span><span class="op" id="5731581">.</span><span class="ident" id="5731582">BlockStmt</span><span class="op" id="5731591">,</span>&nbsp;<span class="ident" id="5731593">nindent</span>&nbsp;<span class="builtintype" id="5731601">int</span><span class="op" id="5731604">)</span>&nbsp;<span class="op" id="5731606">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731609">p</span><span class="op" id="5731610">.</span><span class="builtinfunc" id="5731611">print</span><span class="op" id="5731616">(</span><span class="ident" id="5731617">b</span><span class="op" id="5731618">.</span><span class="ident" id="5731619">Lbrace</span><span class="op" id="5731625">,</span>&nbsp;<span class="ident" id="5731627">token</span><span class="op" id="5731632">.</span><span class="ident" id="5731633">LBRACE</span><span class="op" id="5731639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731642">p</span><span class="op" id="5731643">.</span><span class="ident" id="5731644">stmtList</span><span class="op" id="5731652">(</span><span class="ident" id="5731653">b</span><span class="op" id="5731654">.</span><span class="ident" id="5731655">List</span><span class="op" id="5731659">,</span>&nbsp;<span class="ident" id="5731661">nindent</span><span class="op" id="5731668">,</span>&nbsp;<span class="ident" id="5731670">true</span><span class="op" id="5731674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731677">p</span><span class="op" id="5731678">.</span><span class="ident" id="5731679">linebreak</span><span class="op" id="5731688">(</span><span class="ident" id="5731689">p</span><span class="op" id="5731690">.</span><span class="ident" id="5731691">lineFor</span><span class="op" id="5731698">(</span><span class="ident" id="5731699">b</span><span class="op" id="5731700">.</span><span class="ident" id="5731701">Rbrace</span><span class="op" id="5731707">)</span><span class="op" id="5731708">,</span>&nbsp;<span class="num" id="5731710">1</span><span class="op" id="5731711">,</span>&nbsp;<span class="ident" id="5731713">ignore</span><span class="op" id="5731719">,</span>&nbsp;<span class="ident" id="5731721">true</span><span class="op" id="5731725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731728">p</span><span class="op" id="5731729">.</span><span class="builtinfunc" id="5731730">print</span><span class="op" id="5731735">(</span><span class="ident" id="5731736">b</span><span class="op" id="5731737">.</span><span class="ident" id="5731738">Rbrace</span><span class="op" id="5731744">,</span>&nbsp;<span class="ident" id="5731746">token</span><span class="op" id="5731751">.</span><span class="ident" id="5731752">RBRACE</span><span class="op" id="5731758">)</span><br>
<span class="lineno"></span><span class="op" id="5731760">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5731763">func</span>&nbsp;<span class="ident" id="5731768">isTypeName</span><span class="op" id="5731778">(</span><span class="ident" id="5731779">x</span>&nbsp;<span class="ident" id="5731781">ast</span><span class="op" id="5731784">.</span><span class="ident" id="5731785">Expr</span><span class="op" id="5731789">)</span>&nbsp;<span class="builtintype" id="5731791">bool</span>&nbsp;<span class="op" id="5731796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731799">switch</span>&nbsp;<span class="ident" id="5731806">t</span>&nbsp;<span class="op" id="5731808">:=</span>&nbsp;<span class="ident" id="5731811">x</span><span class="op" id="5731812">.</span><span class="op" id="5731813">(</span><span class="keyword" id="5731814">type</span><span class="op" id="5731818">)</span>&nbsp;<span class="op" id="5731820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731823">case</span>&nbsp;<span class="op" id="5731828">*</span><span class="ident" id="5731829">ast</span><span class="op" id="5731832">.</span><span class="ident" id="5731833">Ident</span><span class="op" id="5731838">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731842">return</span>&nbsp;<span class="ident" id="5731849">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731855">case</span>&nbsp;<span class="op" id="5731860">*</span><span class="ident" id="5731861">ast</span><span class="op" id="5731864">.</span><span class="ident" id="5731865">SelectorExpr</span><span class="op" id="5731877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731881">return</span>&nbsp;<span class="ident" id="5731888">isTypeName</span><span class="op" id="5731898">(</span><span class="ident" id="5731899">t</span><span class="op" id="5731900">.</span><span class="ident" id="5731901">X</span><span class="op" id="5731902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731908">return</span>&nbsp;<span class="ident" id="5731915">false</span><br>
<span class="lineno"></span><span class="op" id="5731921">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5731924">func</span>&nbsp;<span class="ident" id="5731929">stripParens</span><span class="op" id="5731940">(</span><span class="ident" id="5731941">x</span>&nbsp;<span class="ident" id="5731943">ast</span><span class="op" id="5731946">.</span><span class="ident" id="5731947">Expr</span><span class="op" id="5731951">)</span>&nbsp;<span class="ident" id="5731953">ast</span><span class="op" id="5731956">.</span><span class="ident" id="5731957">Expr</span>&nbsp;<span class="op" id="5731962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731965">if</span>&nbsp;<span class="ident" id="5731968">px</span><span class="op" id="5731970">,</span>&nbsp;<span class="ident" id="5731972">strip</span>&nbsp;<span class="op" id="5731978">:=</span>&nbsp;<span class="ident" id="5731981">x</span><span class="op" id="5731982">.</span><span class="op" id="5731983">(</span><span class="op" id="5731984">*</span><span class="ident" id="5731985">ast</span><span class="op" id="5731988">.</span><span class="ident" id="5731989">ParenExpr</span><span class="op" id="5731998">)</span><span class="op" id="5731999">;</span>&nbsp;<span class="ident" id="5732001">strip</span>&nbsp;<span class="op" id="5732007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732011">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732066">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732120">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732137">ast</span><span class="op" id="5732140">.</span><span class="ident" id="5732141">Inspect</span><span class="op" id="5732148">(</span><span class="ident" id="5732149">px</span><span class="op" id="5732151">.</span><span class="ident" id="5732152">X</span><span class="op" id="5732153">,</span>&nbsp;<span class="keyword" id="5732155">func</span><span class="op" id="5732159">(</span><span class="ident" id="5732160">node</span>&nbsp;<span class="ident" id="5732165">ast</span><span class="op" id="5732168">.</span><span class="ident" id="5732169">Node</span><span class="op" id="5732173">)</span>&nbsp;<span class="builtintype" id="5732175">bool</span>&nbsp;<span class="op" id="5732180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732185">switch</span>&nbsp;<span class="ident" id="5732192">x</span>&nbsp;<span class="op" id="5732194">:=</span>&nbsp;<span class="ident" id="5732197">node</span><span class="op" id="5732201">.</span><span class="op" id="5732202">(</span><span class="keyword" id="5732203">type</span><span class="op" id="5732207">)</span>&nbsp;<span class="op" id="5732209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732214">case</span>&nbsp;<span class="op" id="5732219">*</span><span class="ident" id="5732220">ast</span><span class="op" id="5732223">.</span><span class="ident" id="5732224">ParenExpr</span><span class="op" id="5732233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732239">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732294">return</span>&nbsp;<span class="ident" id="5732301">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732310">case</span>&nbsp;<span class="op" id="5732315">*</span><span class="ident" id="5732316">ast</span><span class="op" id="5732319">.</span><span class="ident" id="5732320">CompositeLit</span><span class="op" id="5732332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732338">if</span>&nbsp;<span class="ident" id="5732341">isTypeName</span><span class="op" id="5732351">(</span><span class="ident" id="5732352">x</span><span class="op" id="5732353">.</span><span class="ident" id="5732354">Type</span><span class="op" id="5732358">)</span>&nbsp;<span class="op" id="5732360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732367">strip</span>&nbsp;<span class="op" id="5732373">=</span>&nbsp;<span class="ident" id="5732375">false</span>&nbsp;<span class="comment" id="5732381">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732413">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732419">return</span>&nbsp;<span class="ident" id="5732426">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732440">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732482">return</span>&nbsp;<span class="ident" id="5732489">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732496">}</span><span class="op" id="5732497">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732501">if</span>&nbsp;<span class="ident" id="5732504">strip</span>&nbsp;<span class="op" id="5732510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732515">return</span>&nbsp;<span class="ident" id="5732522">stripParens</span><span class="op" id="5732533">(</span><span class="ident" id="5732534">px</span><span class="op" id="5732536">.</span><span class="ident" id="5732537">X</span><span class="op" id="5732538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732548">return</span>&nbsp;<span class="ident" id="5732555">x</span><br>
<span class="lineno">985</span><span class="op" id="5732557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5732560">func</span>&nbsp;<span class="ident" id="5732565">stripParensAlways</span><span class="op" id="5732582">(</span><span class="ident" id="5732583">x</span>&nbsp;<span class="ident" id="5732585">ast</span><span class="op" id="5732588">.</span><span class="ident" id="5732589">Expr</span><span class="op" id="5732593">)</span>&nbsp;<span class="ident" id="5732595">ast</span><span class="op" id="5732598">.</span><span class="ident" id="5732599">Expr</span>&nbsp;<span class="op" id="5732604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732607">if</span>&nbsp;<span class="ident" id="5732610">x</span><span class="op" id="5732611">,</span>&nbsp;<span class="ident" id="5732613">ok</span>&nbsp;<span class="op" id="5732616">:=</span>&nbsp;<span class="ident" id="5732619">x</span><span class="op" id="5732620">.</span><span class="op" id="5732621">(</span><span class="op" id="5732622">*</span><span class="ident" id="5732623">ast</span><span class="op" id="5732626">.</span><span class="ident" id="5732627">ParenExpr</span><span class="op" id="5732636">)</span><span class="op" id="5732637">;</span>&nbsp;<span class="ident" id="5732639">ok</span>&nbsp;<span class="op" id="5732642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732646">return</span>&nbsp;<span class="ident" id="5732653">stripParensAlways</span><span class="op" id="5732670">(</span><span class="ident" id="5732671">x</span><span class="op" id="5732672">.</span><span class="ident" id="5732673">X</span><span class="op" id="5732674">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732680">return</span>&nbsp;<span class="ident" id="5732687">x</span><br>
<span class="lineno"></span><span class="op" id="5732689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5732692">func</span>&nbsp;<span class="op" id="5732697">(</span><span class="ident" id="5732698">p</span>&nbsp;<span class="op" id="5732700">*</span><span class="ident" id="5732701">printer</span><span class="op" id="5732708">)</span>&nbsp;<span class="ident" id="5732710">controlClause</span><span class="op" id="5732723">(</span><span class="ident" id="5732724">isForStmt</span>&nbsp;<span class="builtintype" id="5732734">bool</span><span class="op" id="5732738">,</span>&nbsp;<span class="ident" id="5732740">init</span>&nbsp;<span class="ident" id="5732745">ast</span><span class="op" id="5732748">.</span><span class="ident" id="5732749">Stmt</span><span class="op" id="5732753">,</span>&nbsp;<span class="ident" id="5732755">expr</span>&nbsp;<span class="ident" id="5732760">ast</span><span class="op" id="5732763">.</span><span class="ident" id="5732764">Expr</span><span class="op" id="5732768">,</span>&nbsp;<span class="ident" id="5732770">post</span>&nbsp;<span class="ident" id="5732775">ast</span><span class="op" id="5732778">.</span><span class="ident" id="5732779">Stmt</span><span class="op" id="5732783">)</span>&nbsp;<span class="op" id="5732785">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732788">p</span><span class="op" id="5732789">.</span><span class="builtinfunc" id="5732790">print</span><span class="op" id="5732795">(</span><span class="ident" id="5732796">blank</span><span class="op" id="5732801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732804">needsBlank</span>&nbsp;<span class="op" id="5732815">:=</span>&nbsp;<span class="ident" id="5732818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732825">if</span>&nbsp;<span class="ident" id="5732828">init</span>&nbsp;<span class="op" id="5732833">==</span>&nbsp;<span class="ident" id="5732836">nil</span>&nbsp;<span class="op" id="5732840">&amp;&amp;</span>&nbsp;<span class="ident" id="5732843">post</span>&nbsp;<span class="op" id="5732848">==</span>&nbsp;<span class="ident" id="5732851">nil</span>&nbsp;<span class="op" id="5732855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732859">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732887">if</span>&nbsp;<span class="ident" id="5732890">expr</span>&nbsp;<span class="op" id="5732895">!=</span>&nbsp;<span class="ident" id="5732898">nil</span>&nbsp;<span class="op" id="5732902">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732907">p</span><span class="op" id="5732908">.</span><span class="ident" id="5732909">expr</span><span class="op" id="5732913">(</span><span class="ident" id="5732914">stripParens</span><span class="op" id="5732925">(</span><span class="ident" id="5732926">expr</span><span class="op" id="5732930">)</span><span class="op" id="5732931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732936">needsBlank</span>&nbsp;<span class="op" id="5732947">=</span>&nbsp;<span class="ident" id="5732949">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732959">}</span>&nbsp;<span class="keyword" id="5732961">else</span>&nbsp;<span class="op" id="5732966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732970">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732999">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733053">if</span>&nbsp;<span class="ident" id="5733056">init</span>&nbsp;<span class="op" id="5733061">!=</span>&nbsp;<span class="ident" id="5733064">nil</span>&nbsp;<span class="op" id="5733068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733073">p</span><span class="op" id="5733074">.</span><span class="ident" id="5733075">stmt</span><span class="op" id="5733079">(</span><span class="ident" id="5733080">init</span><span class="op" id="5733084">,</span>&nbsp;<span class="ident" id="5733086">false</span><span class="op" id="5733091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733099">p</span><span class="op" id="5733100">.</span><span class="builtinfunc" id="5733101">print</span><span class="op" id="5733106">(</span><span class="ident" id="5733107">token</span><span class="op" id="5733112">.</span><span class="ident" id="5733113">SEMICOLON</span><span class="op" id="5733122">,</span>&nbsp;<span class="ident" id="5733124">blank</span><span class="op" id="5733129">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733133">if</span>&nbsp;<span class="ident" id="5733136">expr</span>&nbsp;<span class="op" id="5733141">!=</span>&nbsp;<span class="ident" id="5733144">nil</span>&nbsp;<span class="op" id="5733148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733153">p</span><span class="op" id="5733154">.</span><span class="ident" id="5733155">expr</span><span class="op" id="5733159">(</span><span class="ident" id="5733160">stripParens</span><span class="op" id="5733171">(</span><span class="ident" id="5733172">expr</span><span class="op" id="5733176">)</span><span class="op" id="5733177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733182">needsBlank</span>&nbsp;<span class="op" id="5733193">=</span>&nbsp;<span class="ident" id="5733195">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733206">if</span>&nbsp;<span class="ident" id="5733209">isForStmt</span>&nbsp;<span class="op" id="5733219">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733224">p</span><span class="op" id="5733225">.</span><span class="builtinfunc" id="5733226">print</span><span class="op" id="5733231">(</span><span class="ident" id="5733232">token</span><span class="op" id="5733237">.</span><span class="ident" id="5733238">SEMICOLON</span><span class="op" id="5733247">,</span>&nbsp;<span class="ident" id="5733249">blank</span><span class="op" id="5733254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733259">needsBlank</span>&nbsp;<span class="op" id="5733270">=</span>&nbsp;<span class="ident" id="5733272">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733281">if</span>&nbsp;<span class="ident" id="5733284">post</span>&nbsp;<span class="op" id="5733289">!=</span>&nbsp;<span class="ident" id="5733292">nil</span>&nbsp;<span class="op" id="5733296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733302">p</span><span class="op" id="5733303">.</span><span class="ident" id="5733304">stmt</span><span class="op" id="5733308">(</span><span class="ident" id="5733309">post</span><span class="op" id="5733313">,</span>&nbsp;<span class="ident" id="5733315">false</span><span class="op" id="5733320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733326">needsBlank</span>&nbsp;<span class="op" id="5733337">=</span>&nbsp;<span class="ident" id="5733339">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733357">if</span>&nbsp;<span class="ident" id="5733360">needsBlank</span>&nbsp;<span class="op" id="5733371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733375">p</span><span class="op" id="5733376">.</span><span class="builtinfunc" id="5733377">print</span><span class="op" id="5733382">(</span><span class="ident" id="5733383">blank</span><span class="op" id="5733388">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733391">}</span><br>
<span class="lineno"></span><span class="op" id="5733393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5733396">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5733469">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5733542">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5733585">//</span><br>
<span class="lineno"></span><span class="keyword" id="5733588">func</span>&nbsp;<span class="op" id="5733593">(</span><span class="ident" id="5733594">p</span>&nbsp;<span class="op" id="5733596">*</span><span class="ident" id="5733597">printer</span><span class="op" id="5733604">)</span>&nbsp;<span class="ident" id="5733606">indentList</span><span class="op" id="5733616">(</span><span class="ident" id="5733617">list</span>&nbsp;<span class="op" id="5733622">[</span><span class="op" id="5733623">]</span><span class="ident" id="5733624">ast</span><span class="op" id="5733627">.</span><span class="ident" id="5733628">Expr</span><span class="op" id="5733632">)</span>&nbsp;<span class="builtintype" id="5733634">bool</span>&nbsp;<span class="op" id="5733639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733642">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733715">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733784">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733840">if</span>&nbsp;<span class="builtinfunc" id="5733843">len</span><span class="op" id="5733846">(</span><span class="ident" id="5733847">list</span><span class="op" id="5733851">)</span>&nbsp;<span class="op" id="5733853">&gt;=</span>&nbsp;<span class="num" id="5733856">2</span>&nbsp;<span class="op" id="5733858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733862">var</span>&nbsp;<span class="ident" id="5733866">b</span>&nbsp;<span class="op" id="5733868">=</span>&nbsp;<span class="ident" id="5733870">p</span><span class="op" id="5733871">.</span><span class="ident" id="5733872">lineFor</span><span class="op" id="5733879">(</span><span class="ident" id="5733880">list</span><span class="op" id="5733884">[</span><span class="num" id="5733885">0</span><span class="op" id="5733886">]</span><span class="op" id="5733887">.</span><span class="ident" id="5733888">Pos</span><span class="op" id="5733891">(</span><span class="op" id="5733892">)</span><span class="op" id="5733893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733897">var</span>&nbsp;<span class="ident" id="5733901">e</span>&nbsp;<span class="op" id="5733903">=</span>&nbsp;<span class="ident" id="5733905">p</span><span class="op" id="5733906">.</span><span class="ident" id="5733907">lineFor</span><span class="op" id="5733914">(</span><span class="ident" id="5733915">list</span><span class="op" id="5733919">[</span><span class="builtinfunc" id="5733920">len</span><span class="op" id="5733923">(</span><span class="ident" id="5733924">list</span><span class="op" id="5733928">)</span><span class="op" id="5733929">-</span><span class="num" id="5733930">1</span><span class="op" id="5733931">]</span><span class="op" id="5733932">.</span><span class="ident" id="5733933">End</span><span class="op" id="5733936">(</span><span class="op" id="5733937">)</span><span class="op" id="5733938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733942">if</span>&nbsp;<span class="num" id="5733945">0</span>&nbsp;<span class="op" id="5733947">&lt;</span>&nbsp;<span class="ident" id="5733949">b</span>&nbsp;<span class="op" id="5733951">&amp;&amp;</span>&nbsp;<span class="ident" id="5733954">b</span>&nbsp;<span class="op" id="5733956">&lt;</span>&nbsp;<span class="ident" id="5733958">e</span>&nbsp;<span class="op" id="5733960">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733965">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733997">n</span>&nbsp;<span class="op" id="5733999">:=</span>&nbsp;<span class="num" id="5734002">0</span>&nbsp;<span class="comment" id="5734004">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734035">line</span>&nbsp;<span class="op" id="5734040">:=</span>&nbsp;<span class="ident" id="5734043">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734048">for</span>&nbsp;<span class="ident" id="5734052">_</span><span class="op" id="5734053">,</span>&nbsp;<span class="ident" id="5734055">x</span>&nbsp;<span class="op" id="5734057">:=</span>&nbsp;<span class="keyword" id="5734060">range</span>&nbsp;<span class="ident" id="5734066">list</span>&nbsp;<span class="op" id="5734071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734077">xb</span>&nbsp;<span class="op" id="5734080">:=</span>&nbsp;<span class="ident" id="5734083">p</span><span class="op" id="5734084">.</span><span class="ident" id="5734085">lineFor</span><span class="op" id="5734092">(</span><span class="ident" id="5734093">x</span><span class="op" id="5734094">.</span><span class="ident" id="5734095">Pos</span><span class="op" id="5734098">(</span><span class="op" id="5734099">)</span><span class="op" id="5734100">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734106">xe</span>&nbsp;<span class="op" id="5734109">:=</span>&nbsp;<span class="ident" id="5734112">p</span><span class="op" id="5734113">.</span><span class="ident" id="5734114">lineFor</span><span class="op" id="5734121">(</span><span class="ident" id="5734122">x</span><span class="op" id="5734123">.</span><span class="ident" id="5734124">End</span><span class="op" id="5734127">(</span><span class="op" id="5734128">)</span><span class="op" id="5734129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734135">if</span>&nbsp;<span class="ident" id="5734138">line</span>&nbsp;<span class="op" id="5734143">&lt;</span>&nbsp;<span class="ident" id="5734145">xb</span>&nbsp;<span class="op" id="5734148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734155">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734193">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734232">return</span>&nbsp;<span class="ident" id="5734239">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734254">if</span>&nbsp;<span class="ident" id="5734257">xb</span>&nbsp;<span class="op" id="5734260">&lt;</span>&nbsp;<span class="ident" id="5734262">xe</span>&nbsp;<span class="op" id="5734265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734272">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734306">n</span><span class="op" id="5734307">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734314">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734320">line</span>&nbsp;<span class="op" id="5734325">=</span>&nbsp;<span class="ident" id="5734327">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734338">return</span>&nbsp;<span class="ident" id="5734345">n</span>&nbsp;<span class="op" id="5734347">&gt;</span>&nbsp;<span class="num" id="5734349">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734356">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734359">return</span>&nbsp;<span class="ident" id="5734366">false</span><br>
<span class="lineno"></span><span class="op" id="5734372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5734375">func</span>&nbsp;<span class="op" id="5734380">(</span><span class="ident" id="5734381">p</span>&nbsp;<span class="op" id="5734383">*</span><span class="ident" id="5734384">printer</span><span class="op" id="5734391">)</span>&nbsp;<span class="ident" id="5734393">stmt</span><span class="op" id="5734397">(</span><span class="ident" id="5734398">stmt</span>&nbsp;<span class="ident" id="5734403">ast</span><span class="op" id="5734406">.</span><span class="ident" id="5734407">Stmt</span><span class="op" id="5734411">,</span>&nbsp;<span class="ident" id="5734413">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5734426">bool</span><span class="op" id="5734430">)</span>&nbsp;<span class="op" id="5734432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734435">p</span><span class="op" id="5734436">.</span><span class="builtinfunc" id="5734437">print</span><span class="op" id="5734442">(</span><span class="ident" id="5734443">stmt</span><span class="op" id="5734447">.</span><span class="ident" id="5734448">Pos</span><span class="op" id="5734451">(</span><span class="op" id="5734452">)</span><span class="op" id="5734453">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734457">switch</span>&nbsp;<span class="ident" id="5734464">s</span>&nbsp;<span class="op" id="5734466">:=</span>&nbsp;<span class="ident" id="5734469">stmt</span><span class="op" id="5734473">.</span><span class="op" id="5734474">(</span><span class="keyword" id="5734475">type</span><span class="op" id="5734479">)</span>&nbsp;<span class="op" id="5734481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734484">case</span>&nbsp;<span class="op" id="5734489">*</span><span class="ident" id="5734490">ast</span><span class="op" id="5734493">.</span><span class="ident" id="5734494">BadStmt</span><span class="op" id="5734501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734505">p</span><span class="op" id="5734506">.</span><span class="builtinfunc" id="5734507">print</span><span class="op" id="5734512">(</span><span class="string" id="5734513">&#34;BadStmt&#34;</span><span class="op" id="5734522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734526">case</span>&nbsp;<span class="op" id="5734531">*</span><span class="ident" id="5734532">ast</span><span class="op" id="5734535">.</span><span class="ident" id="5734536">DeclStmt</span><span class="op" id="5734544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734548">p</span><span class="op" id="5734549">.</span><span class="ident" id="5734550">decl</span><span class="op" id="5734554">(</span><span class="ident" id="5734555">s</span><span class="op" id="5734556">.</span><span class="ident" id="5734557">Decl</span><span class="op" id="5734561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734565">case</span>&nbsp;<span class="op" id="5734570">*</span><span class="ident" id="5734571">ast</span><span class="op" id="5734574">.</span><span class="ident" id="5734575">EmptyStmt</span><span class="op" id="5734584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734588">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734607">case</span>&nbsp;<span class="op" id="5734612">*</span><span class="ident" id="5734613">ast</span><span class="op" id="5734616">.</span><span class="ident" id="5734617">LabeledStmt</span><span class="op" id="5734628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734632">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734696">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734757">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734792">p</span><span class="op" id="5734793">.</span><span class="builtinfunc" id="5734794">print</span><span class="op" id="5734799">(</span><span class="ident" id="5734800">unindent</span><span class="op" id="5734808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734812">p</span><span class="op" id="5734813">.</span><span class="ident" id="5734814">expr</span><span class="op" id="5734818">(</span><span class="ident" id="5734819">s</span><span class="op" id="5734820">.</span><span class="ident" id="5734821">Label</span><span class="op" id="5734826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734830">p</span><span class="op" id="5734831">.</span><span class="builtinfunc" id="5734832">print</span><span class="op" id="5734837">(</span><span class="ident" id="5734838">s</span><span class="op" id="5734839">.</span><span class="ident" id="5734840">Colon</span><span class="op" id="5734845">,</span>&nbsp;<span class="ident" id="5734847">token</span><span class="op" id="5734852">.</span><span class="ident" id="5734853">COLON</span><span class="op" id="5734858">,</span>&nbsp;<span class="ident" id="5734860">indent</span><span class="op" id="5734866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734870">if</span>&nbsp;<span class="ident" id="5734873">e</span><span class="op" id="5734874">,</span>&nbsp;<span class="ident" id="5734876">isEmpty</span>&nbsp;<span class="op" id="5734884">:=</span>&nbsp;<span class="ident" id="5734887">s</span><span class="op" id="5734888">.</span><span class="ident" id="5734889">Stmt</span><span class="op" id="5734893">.</span><span class="op" id="5734894">(</span><span class="op" id="5734895">*</span><span class="ident" id="5734896">ast</span><span class="op" id="5734899">.</span><span class="ident" id="5734900">EmptyStmt</span><span class="op" id="5734909">)</span><span class="op" id="5734910">;</span>&nbsp;<span class="ident" id="5734912">isEmpty</span>&nbsp;<span class="op" id="5734920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734925">if</span>&nbsp;<span class="op" id="5734928">!</span><span class="ident" id="5734929">nextIsRBrace</span>&nbsp;<span class="op" id="5734942">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734948">p</span><span class="op" id="5734949">.</span><span class="builtinfunc" id="5734950">print</span><span class="op" id="5734955">(</span><span class="ident" id="5734956">newline</span><span class="op" id="5734963">,</span>&nbsp;<span class="ident" id="5734965">e</span><span class="op" id="5734966">.</span><span class="ident" id="5734967">Pos</span><span class="op" id="5734970">(</span><span class="op" id="5734971">)</span><span class="op" id="5734972">,</span>&nbsp;<span class="ident" id="5734974">token</span><span class="op" id="5734979">.</span><span class="ident" id="5734980">SEMICOLON</span><span class="op" id="5734989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734995">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735008">}</span>&nbsp;<span class="keyword" id="5735010">else</span>&nbsp;<span class="op" id="5735015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735020">p</span><span class="op" id="5735021">.</span><span class="ident" id="5735022">linebreak</span><span class="op" id="5735031">(</span><span class="ident" id="5735032">p</span><span class="op" id="5735033">.</span><span class="ident" id="5735034">lineFor</span><span class="op" id="5735041">(</span><span class="ident" id="5735042">s</span><span class="op" id="5735043">.</span><span class="ident" id="5735044">Stmt</span><span class="op" id="5735048">.</span><span class="ident" id="5735049">Pos</span><span class="op" id="5735052">(</span><span class="op" id="5735053">)</span><span class="op" id="5735054">)</span><span class="op" id="5735055">,</span>&nbsp;<span class="num" id="5735057">1</span><span class="op" id="5735058">,</span>&nbsp;<span class="ident" id="5735060">ignore</span><span class="op" id="5735066">,</span>&nbsp;<span class="ident" id="5735068">true</span><span class="op" id="5735072">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735080">p</span><span class="op" id="5735081">.</span><span class="ident" id="5735082">stmt</span><span class="op" id="5735086">(</span><span class="ident" id="5735087">s</span><span class="op" id="5735088">.</span><span class="ident" id="5735089">Stmt</span><span class="op" id="5735093">,</span>&nbsp;<span class="ident" id="5735095">nextIsRBrace</span><span class="op" id="5735107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735111">case</span>&nbsp;<span class="op" id="5735116">*</span><span class="ident" id="5735117">ast</span><span class="op" id="5735120">.</span><span class="ident" id="5735121">ExprStmt</span><span class="op" id="5735129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735133">const</span>&nbsp;<span class="ident" id="5735139">depth</span>&nbsp;<span class="op" id="5735145">=</span>&nbsp;<span class="num" id="5735147">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735151">p</span><span class="op" id="5735152">.</span><span class="ident" id="5735153">expr0</span><span class="op" id="5735158">(</span><span class="ident" id="5735159">s</span><span class="op" id="5735160">.</span><span class="ident" id="5735161">X</span><span class="op" id="5735162">,</span>&nbsp;<span class="ident" id="5735164">depth</span><span class="op" id="5735169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735173">case</span>&nbsp;<span class="op" id="5735178">*</span><span class="ident" id="5735179">ast</span><span class="op" id="5735182">.</span><span class="ident" id="5735183">SendStmt</span><span class="op" id="5735191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735195">const</span>&nbsp;<span class="ident" id="5735201">depth</span>&nbsp;<span class="op" id="5735207">=</span>&nbsp;<span class="num" id="5735209">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735213">p</span><span class="op" id="5735214">.</span><span class="ident" id="5735215">expr0</span><span class="op" id="5735220">(</span><span class="ident" id="5735221">s</span><span class="op" id="5735222">.</span><span class="ident" id="5735223">Chan</span><span class="op" id="5735227">,</span>&nbsp;<span class="ident" id="5735229">depth</span><span class="op" id="5735234">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735238">p</span><span class="op" id="5735239">.</span><span class="builtinfunc" id="5735240">print</span><span class="op" id="5735245">(</span><span class="ident" id="5735246">blank</span><span class="op" id="5735251">,</span>&nbsp;<span class="ident" id="5735253">s</span><span class="op" id="5735254">.</span><span class="ident" id="5735255">Arrow</span><span class="op" id="5735260">,</span>&nbsp;<span class="ident" id="5735262">token</span><span class="op" id="5735267">.</span><span class="ident" id="5735268">ARROW</span><span class="op" id="5735273">,</span>&nbsp;<span class="ident" id="5735275">blank</span><span class="op" id="5735280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735284">p</span><span class="op" id="5735285">.</span><span class="ident" id="5735286">expr0</span><span class="op" id="5735291">(</span><span class="ident" id="5735292">s</span><span class="op" id="5735293">.</span><span class="ident" id="5735294">Value</span><span class="op" id="5735299">,</span>&nbsp;<span class="ident" id="5735301">depth</span><span class="op" id="5735306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735310">case</span>&nbsp;<span class="op" id="5735315">*</span><span class="ident" id="5735316">ast</span><span class="op" id="5735319">.</span><span class="ident" id="5735320">IncDecStmt</span><span class="op" id="5735330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735334">const</span>&nbsp;<span class="ident" id="5735340">depth</span>&nbsp;<span class="op" id="5735346">=</span>&nbsp;<span class="num" id="5735348">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735352">p</span><span class="op" id="5735353">.</span><span class="ident" id="5735354">expr0</span><span class="op" id="5735359">(</span><span class="ident" id="5735360">s</span><span class="op" id="5735361">.</span><span class="ident" id="5735362">X</span><span class="op" id="5735363">,</span>&nbsp;<span class="ident" id="5735365">depth</span><span class="op" id="5735370">+</span><span class="num" id="5735371">1</span><span class="op" id="5735372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735376">p</span><span class="op" id="5735377">.</span><span class="builtinfunc" id="5735378">print</span><span class="op" id="5735383">(</span><span class="ident" id="5735384">s</span><span class="op" id="5735385">.</span><span class="ident" id="5735386">TokPos</span><span class="op" id="5735392">,</span>&nbsp;<span class="ident" id="5735394">s</span><span class="op" id="5735395">.</span><span class="ident" id="5735396">Tok</span><span class="op" id="5735399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735403">case</span>&nbsp;<span class="op" id="5735408">*</span><span class="ident" id="5735409">ast</span><span class="op" id="5735412">.</span><span class="ident" id="5735413">AssignStmt</span><span class="op" id="5735423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735427">var</span>&nbsp;<span class="ident" id="5735431">depth</span>&nbsp;<span class="op" id="5735437">=</span>&nbsp;<span class="num" id="5735439">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735443">if</span>&nbsp;<span class="builtinfunc" id="5735446">len</span><span class="op" id="5735449">(</span><span class="ident" id="5735450">s</span><span class="op" id="5735451">.</span><span class="ident" id="5735452">Lhs</span><span class="op" id="5735455">)</span>&nbsp;<span class="op" id="5735457">&gt;</span>&nbsp;<span class="num" id="5735459">1</span>&nbsp;<span class="op" id="5735461">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5735464">len</span><span class="op" id="5735467">(</span><span class="ident" id="5735468">s</span><span class="op" id="5735469">.</span><span class="ident" id="5735470">Rhs</span><span class="op" id="5735473">)</span>&nbsp;<span class="op" id="5735475">&gt;</span>&nbsp;<span class="num" id="5735477">1</span>&nbsp;<span class="op" id="5735479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735484">depth</span><span class="op" id="5735489">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735498">p</span><span class="op" id="5735499">.</span><span class="ident" id="5735500">exprList</span><span class="op" id="5735508">(</span><span class="ident" id="5735509">s</span><span class="op" id="5735510">.</span><span class="ident" id="5735511">Pos</span><span class="op" id="5735514">(</span><span class="op" id="5735515">)</span><span class="op" id="5735516">,</span>&nbsp;<span class="ident" id="5735518">s</span><span class="op" id="5735519">.</span><span class="ident" id="5735520">Lhs</span><span class="op" id="5735523">,</span>&nbsp;<span class="ident" id="5735525">depth</span><span class="op" id="5735530">,</span>&nbsp;<span class="num" id="5735532">0</span><span class="op" id="5735533">,</span>&nbsp;<span class="ident" id="5735535">s</span><span class="op" id="5735536">.</span><span class="ident" id="5735537">TokPos</span><span class="op" id="5735543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735547">p</span><span class="op" id="5735548">.</span><span class="builtinfunc" id="5735549">print</span><span class="op" id="5735554">(</span><span class="ident" id="5735555">blank</span><span class="op" id="5735560">,</span>&nbsp;<span class="ident" id="5735562">s</span><span class="op" id="5735563">.</span><span class="ident" id="5735564">TokPos</span><span class="op" id="5735570">,</span>&nbsp;<span class="ident" id="5735572">s</span><span class="op" id="5735573">.</span><span class="ident" id="5735574">Tok</span><span class="op" id="5735577">,</span>&nbsp;<span class="ident" id="5735579">blank</span><span class="op" id="5735584">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735588">p</span><span class="op" id="5735589">.</span><span class="ident" id="5735590">exprList</span><span class="op" id="5735598">(</span><span class="ident" id="5735599">s</span><span class="op" id="5735600">.</span><span class="ident" id="5735601">TokPos</span><span class="op" id="5735607">,</span>&nbsp;<span class="ident" id="5735609">s</span><span class="op" id="5735610">.</span><span class="ident" id="5735611">Rhs</span><span class="op" id="5735614">,</span>&nbsp;<span class="ident" id="5735616">depth</span><span class="op" id="5735621">,</span>&nbsp;<span class="num" id="5735623">0</span><span class="op" id="5735624">,</span>&nbsp;<span class="ident" id="5735626">token</span><span class="op" id="5735631">.</span><span class="ident" id="5735632">NoPos</span><span class="op" id="5735637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735641">case</span>&nbsp;<span class="op" id="5735646">*</span><span class="ident" id="5735647">ast</span><span class="op" id="5735650">.</span><span class="ident" id="5735651">GoStmt</span><span class="op" id="5735657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735661">p</span><span class="op" id="5735662">.</span><span class="builtinfunc" id="5735663">print</span><span class="op" id="5735668">(</span><span class="ident" id="5735669">token</span><span class="op" id="5735674">.</span><span class="ident" id="5735675">GO</span><span class="op" id="5735677">,</span>&nbsp;<span class="ident" id="5735679">blank</span><span class="op" id="5735684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735688">p</span><span class="op" id="5735689">.</span><span class="ident" id="5735690">expr</span><span class="op" id="5735694">(</span><span class="ident" id="5735695">s</span><span class="op" id="5735696">.</span><span class="ident" id="5735697">Call</span><span class="op" id="5735701">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735705">case</span>&nbsp;<span class="op" id="5735710">*</span><span class="ident" id="5735711">ast</span><span class="op" id="5735714">.</span><span class="ident" id="5735715">DeferStmt</span><span class="op" id="5735724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735728">p</span><span class="op" id="5735729">.</span><span class="builtinfunc" id="5735730">print</span><span class="op" id="5735735">(</span><span class="ident" id="5735736">token</span><span class="op" id="5735741">.</span><span class="ident" id="5735742">DEFER</span><span class="op" id="5735747">,</span>&nbsp;<span class="ident" id="5735749">blank</span><span class="op" id="5735754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735758">p</span><span class="op" id="5735759">.</span><span class="ident" id="5735760">expr</span><span class="op" id="5735764">(</span><span class="ident" id="5735765">s</span><span class="op" id="5735766">.</span><span class="ident" id="5735767">Call</span><span class="op" id="5735771">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735775">case</span>&nbsp;<span class="op" id="5735780">*</span><span class="ident" id="5735781">ast</span><span class="op" id="5735784">.</span><span class="ident" id="5735785">ReturnStmt</span><span class="op" id="5735795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735799">p</span><span class="op" id="5735800">.</span><span class="builtinfunc" id="5735801">print</span><span class="op" id="5735806">(</span><span class="ident" id="5735807">token</span><span class="op" id="5735812">.</span><span class="ident" id="5735813">RETURN</span><span class="op" id="5735819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735823">if</span>&nbsp;<span class="ident" id="5735826">s</span><span class="op" id="5735827">.</span><span class="ident" id="5735828">Results</span>&nbsp;<span class="op" id="5735836">!=</span>&nbsp;<span class="ident" id="5735839">nil</span>&nbsp;<span class="op" id="5735843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735848">p</span><span class="op" id="5735849">.</span><span class="builtinfunc" id="5735850">print</span><span class="op" id="5735855">(</span><span class="ident" id="5735856">blank</span><span class="op" id="5735861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5735866">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5735923">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5735983">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5736037">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5736093">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736146">if</span>&nbsp;<span class="ident" id="5736149">p</span><span class="op" id="5736150">.</span><span class="ident" id="5736151">indentList</span><span class="op" id="5736161">(</span><span class="ident" id="5736162">s</span><span class="op" id="5736163">.</span><span class="ident" id="5736164">Results</span><span class="op" id="5736171">)</span>&nbsp;<span class="op" id="5736173">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736179">p</span><span class="op" id="5736180">.</span><span class="builtinfunc" id="5736181">print</span><span class="op" id="5736186">(</span><span class="ident" id="5736187">indent</span><span class="op" id="5736193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736199">p</span><span class="op" id="5736200">.</span><span class="ident" id="5736201">exprList</span><span class="op" id="5736209">(</span><span class="ident" id="5736210">s</span><span class="op" id="5736211">.</span><span class="ident" id="5736212">Pos</span><span class="op" id="5736215">(</span><span class="op" id="5736216">)</span><span class="op" id="5736217">,</span>&nbsp;<span class="ident" id="5736219">s</span><span class="op" id="5736220">.</span><span class="ident" id="5736221">Results</span><span class="op" id="5736228">,</span>&nbsp;<span class="num" id="5736230">1</span><span class="op" id="5736231">,</span>&nbsp;<span class="ident" id="5736233">noIndent</span><span class="op" id="5736241">,</span>&nbsp;<span class="ident" id="5736243">token</span><span class="op" id="5736248">.</span><span class="ident" id="5736249">NoPos</span><span class="op" id="5736254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736260">p</span><span class="op" id="5736261">.</span><span class="builtinfunc" id="5736262">print</span><span class="op" id="5736267">(</span><span class="ident" id="5736268">unindent</span><span class="op" id="5736276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736281">}</span>&nbsp;<span class="keyword" id="5736283">else</span>&nbsp;<span class="op" id="5736288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736294">p</span><span class="op" id="5736295">.</span><span class="ident" id="5736296">exprList</span><span class="op" id="5736304">(</span><span class="ident" id="5736305">s</span><span class="op" id="5736306">.</span><span class="ident" id="5736307">Pos</span><span class="op" id="5736310">(</span><span class="op" id="5736311">)</span><span class="op" id="5736312">,</span>&nbsp;<span class="ident" id="5736314">s</span><span class="op" id="5736315">.</span><span class="ident" id="5736316">Results</span><span class="op" id="5736323">,</span>&nbsp;<span class="num" id="5736325">1</span><span class="op" id="5736326">,</span>&nbsp;<span class="num" id="5736328">0</span><span class="op" id="5736329">,</span>&nbsp;<span class="ident" id="5736331">token</span><span class="op" id="5736336">.</span><span class="ident" id="5736337">NoPos</span><span class="op" id="5736342">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736355">case</span>&nbsp;<span class="op" id="5736360">*</span><span class="ident" id="5736361">ast</span><span class="op" id="5736364">.</span><span class="ident" id="5736365">BranchStmt</span><span class="op" id="5736375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736379">p</span><span class="op" id="5736380">.</span><span class="builtinfunc" id="5736381">print</span><span class="op" id="5736386">(</span><span class="ident" id="5736387">s</span><span class="op" id="5736388">.</span><span class="ident" id="5736389">Tok</span><span class="op" id="5736392">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736396">if</span>&nbsp;<span class="ident" id="5736399">s</span><span class="op" id="5736400">.</span><span class="ident" id="5736401">Label</span>&nbsp;<span class="op" id="5736407">!=</span>&nbsp;<span class="ident" id="5736410">nil</span>&nbsp;<span class="op" id="5736414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736419">p</span><span class="op" id="5736420">.</span><span class="builtinfunc" id="5736421">print</span><span class="op" id="5736426">(</span><span class="ident" id="5736427">blank</span><span class="op" id="5736432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736437">p</span><span class="op" id="5736438">.</span><span class="ident" id="5736439">expr</span><span class="op" id="5736443">(</span><span class="ident" id="5736444">s</span><span class="op" id="5736445">.</span><span class="ident" id="5736446">Label</span><span class="op" id="5736451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736459">case</span>&nbsp;<span class="op" id="5736464">*</span><span class="ident" id="5736465">ast</span><span class="op" id="5736468">.</span><span class="ident" id="5736469">BlockStmt</span><span class="op" id="5736478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736482">p</span><span class="op" id="5736483">.</span><span class="ident" id="5736484">block</span><span class="op" id="5736489">(</span><span class="ident" id="5736490">s</span><span class="op" id="5736491">,</span>&nbsp;<span class="num" id="5736493">1</span><span class="op" id="5736494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736498">case</span>&nbsp;<span class="op" id="5736503">*</span><span class="ident" id="5736504">ast</span><span class="op" id="5736507">.</span><span class="ident" id="5736508">IfStmt</span><span class="op" id="5736514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736518">p</span><span class="op" id="5736519">.</span><span class="builtinfunc" id="5736520">print</span><span class="op" id="5736525">(</span><span class="ident" id="5736526">token</span><span class="op" id="5736531">.</span><span class="ident" id="5736532">IF</span><span class="op" id="5736534">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736538">p</span><span class="op" id="5736539">.</span><span class="ident" id="5736540">controlClause</span><span class="op" id="5736553">(</span><span class="ident" id="5736554">false</span><span class="op" id="5736559">,</span>&nbsp;<span class="ident" id="5736561">s</span><span class="op" id="5736562">.</span><span class="ident" id="5736563">Init</span><span class="op" id="5736567">,</span>&nbsp;<span class="ident" id="5736569">s</span><span class="op" id="5736570">.</span><span class="ident" id="5736571">Cond</span><span class="op" id="5736575">,</span>&nbsp;<span class="ident" id="5736577">nil</span><span class="op" id="5736580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736584">p</span><span class="op" id="5736585">.</span><span class="ident" id="5736586">block</span><span class="op" id="5736591">(</span><span class="ident" id="5736592">s</span><span class="op" id="5736593">.</span><span class="ident" id="5736594">Body</span><span class="op" id="5736598">,</span>&nbsp;<span class="num" id="5736600">1</span><span class="op" id="5736601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736605">if</span>&nbsp;<span class="ident" id="5736608">s</span><span class="op" id="5736609">.</span><span class="ident" id="5736610">Else</span>&nbsp;<span class="op" id="5736615">!=</span>&nbsp;<span class="ident" id="5736618">nil</span>&nbsp;<span class="op" id="5736622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736627">p</span><span class="op" id="5736628">.</span><span class="builtinfunc" id="5736629">print</span><span class="op" id="5736634">(</span><span class="ident" id="5736635">blank</span><span class="op" id="5736640">,</span>&nbsp;<span class="ident" id="5736642">token</span><span class="op" id="5736647">.</span><span class="ident" id="5736648">ELSE</span><span class="op" id="5736652">,</span>&nbsp;<span class="ident" id="5736654">blank</span><span class="op" id="5736659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736664">switch</span>&nbsp;<span class="ident" id="5736671">s</span><span class="op" id="5736672">.</span><span class="ident" id="5736673">Else</span><span class="op" id="5736677">.</span><span class="op" id="5736678">(</span><span class="keyword" id="5736679">type</span><span class="op" id="5736683">)</span>&nbsp;<span class="op" id="5736685">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736690">case</span>&nbsp;<span class="op" id="5736695">*</span><span class="ident" id="5736696">ast</span><span class="op" id="5736699">.</span><span class="ident" id="5736700">BlockStmt</span><span class="op" id="5736709">,</span>&nbsp;<span class="op" id="5736711">*</span><span class="ident" id="5736712">ast</span><span class="op" id="5736715">.</span><span class="ident" id="5736716">IfStmt</span><span class="op" id="5736722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736728">p</span><span class="op" id="5736729">.</span><span class="ident" id="5736730">stmt</span><span class="op" id="5736734">(</span><span class="ident" id="5736735">s</span><span class="op" id="5736736">.</span><span class="ident" id="5736737">Else</span><span class="op" id="5736741">,</span>&nbsp;<span class="ident" id="5736743">nextIsRBrace</span><span class="op" id="5736755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736760">default</span><span class="op" id="5736767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736773">p</span><span class="op" id="5736774">.</span><span class="builtinfunc" id="5736775">print</span><span class="op" id="5736780">(</span><span class="ident" id="5736781">token</span><span class="op" id="5736786">.</span><span class="ident" id="5736787">LBRACE</span><span class="op" id="5736793">,</span>&nbsp;<span class="ident" id="5736795">indent</span><span class="op" id="5736801">,</span>&nbsp;<span class="ident" id="5736803">formfeed</span><span class="op" id="5736811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736817">p</span><span class="op" id="5736818">.</span><span class="ident" id="5736819">stmt</span><span class="op" id="5736823">(</span><span class="ident" id="5736824">s</span><span class="op" id="5736825">.</span><span class="ident" id="5736826">Else</span><span class="op" id="5736830">,</span>&nbsp;<span class="ident" id="5736832">true</span><span class="op" id="5736836">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736842">p</span><span class="op" id="5736843">.</span><span class="builtinfunc" id="5736844">print</span><span class="op" id="5736849">(</span><span class="ident" id="5736850">unindent</span><span class="op" id="5736858">,</span>&nbsp;<span class="ident" id="5736860">formfeed</span><span class="op" id="5736868">,</span>&nbsp;<span class="ident" id="5736870">token</span><span class="op" id="5736875">.</span><span class="ident" id="5736876">RBRACE</span><span class="op" id="5736882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736895">case</span>&nbsp;<span class="op" id="5736900">*</span><span class="ident" id="5736901">ast</span><span class="op" id="5736904">.</span><span class="ident" id="5736905">CaseClause</span><span class="op" id="5736915">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736919">if</span>&nbsp;<span class="ident" id="5736922">s</span><span class="op" id="5736923">.</span><span class="ident" id="5736924">List</span>&nbsp;<span class="op" id="5736929">!=</span>&nbsp;<span class="ident" id="5736932">nil</span>&nbsp;<span class="op" id="5736936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736941">p</span><span class="op" id="5736942">.</span><span class="builtinfunc" id="5736943">print</span><span class="op" id="5736948">(</span><span class="ident" id="5736949">token</span><span class="op" id="5736954">.</span><span class="ident" id="5736955">CASE</span><span class="op" id="5736959">,</span>&nbsp;<span class="ident" id="5736961">blank</span><span class="op" id="5736966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736971">p</span><span class="op" id="5736972">.</span><span class="ident" id="5736973">exprList</span><span class="op" id="5736981">(</span><span class="ident" id="5736982">s</span><span class="op" id="5736983">.</span><span class="ident" id="5736984">Pos</span><span class="op" id="5736987">(</span><span class="op" id="5736988">)</span><span class="op" id="5736989">,</span>&nbsp;<span class="ident" id="5736991">s</span><span class="op" id="5736992">.</span><span class="ident" id="5736993">List</span><span class="op" id="5736997">,</span>&nbsp;<span class="num" id="5736999">1</span><span class="op" id="5737000">,</span>&nbsp;<span class="num" id="5737002">0</span><span class="op" id="5737003">,</span>&nbsp;<span class="ident" id="5737005">s</span><span class="op" id="5737006">.</span><span class="ident" id="5737007">Colon</span><span class="op" id="5737012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737016">}</span>&nbsp;<span class="keyword" id="5737018">else</span>&nbsp;<span class="op" id="5737023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737028">p</span><span class="op" id="5737029">.</span><span class="builtinfunc" id="5737030">print</span><span class="op" id="5737035">(</span><span class="ident" id="5737036">token</span><span class="op" id="5737041">.</span><span class="ident" id="5737042">DEFAULT</span><span class="op" id="5737049">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737057">p</span><span class="op" id="5737058">.</span><span class="builtinfunc" id="5737059">print</span><span class="op" id="5737064">(</span><span class="ident" id="5737065">s</span><span class="op" id="5737066">.</span><span class="ident" id="5737067">Colon</span><span class="op" id="5737072">,</span>&nbsp;<span class="ident" id="5737074">token</span><span class="op" id="5737079">.</span><span class="ident" id="5737080">COLON</span><span class="op" id="5737085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737089">p</span><span class="op" id="5737090">.</span><span class="ident" id="5737091">stmtList</span><span class="op" id="5737099">(</span><span class="ident" id="5737100">s</span><span class="op" id="5737101">.</span><span class="ident" id="5737102">Body</span><span class="op" id="5737106">,</span>&nbsp;<span class="num" id="5737108">1</span><span class="op" id="5737109">,</span>&nbsp;<span class="ident" id="5737111">nextIsRBrace</span><span class="op" id="5737123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737127">case</span>&nbsp;<span class="op" id="5737132">*</span><span class="ident" id="5737133">ast</span><span class="op" id="5737136">.</span><span class="ident" id="5737137">SwitchStmt</span><span class="op" id="5737147">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737151">p</span><span class="op" id="5737152">.</span><span class="builtinfunc" id="5737153">print</span><span class="op" id="5737158">(</span><span class="ident" id="5737159">token</span><span class="op" id="5737164">.</span><span class="ident" id="5737165">SWITCH</span><span class="op" id="5737171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737175">p</span><span class="op" id="5737176">.</span><span class="ident" id="5737177">controlClause</span><span class="op" id="5737190">(</span><span class="ident" id="5737191">false</span><span class="op" id="5737196">,</span>&nbsp;<span class="ident" id="5737198">s</span><span class="op" id="5737199">.</span><span class="ident" id="5737200">Init</span><span class="op" id="5737204">,</span>&nbsp;<span class="ident" id="5737206">s</span><span class="op" id="5737207">.</span><span class="ident" id="5737208">Tag</span><span class="op" id="5737211">,</span>&nbsp;<span class="ident" id="5737213">nil</span><span class="op" id="5737216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737220">p</span><span class="op" id="5737221">.</span><span class="ident" id="5737222">block</span><span class="op" id="5737227">(</span><span class="ident" id="5737228">s</span><span class="op" id="5737229">.</span><span class="ident" id="5737230">Body</span><span class="op" id="5737234">,</span>&nbsp;<span class="num" id="5737236">0</span><span class="op" id="5737237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737241">case</span>&nbsp;<span class="op" id="5737246">*</span><span class="ident" id="5737247">ast</span><span class="op" id="5737250">.</span><span class="ident" id="5737251">TypeSwitchStmt</span><span class="op" id="5737265">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737269">p</span><span class="op" id="5737270">.</span><span class="builtinfunc" id="5737271">print</span><span class="op" id="5737276">(</span><span class="ident" id="5737277">token</span><span class="op" id="5737282">.</span><span class="ident" id="5737283">SWITCH</span><span class="op" id="5737289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737293">if</span>&nbsp;<span class="ident" id="5737296">s</span><span class="op" id="5737297">.</span><span class="ident" id="5737298">Init</span>&nbsp;<span class="op" id="5737303">!=</span>&nbsp;<span class="ident" id="5737306">nil</span>&nbsp;<span class="op" id="5737310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737315">p</span><span class="op" id="5737316">.</span><span class="builtinfunc" id="5737317">print</span><span class="op" id="5737322">(</span><span class="ident" id="5737323">blank</span><span class="op" id="5737328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737333">p</span><span class="op" id="5737334">.</span><span class="ident" id="5737335">stmt</span><span class="op" id="5737339">(</span><span class="ident" id="5737340">s</span><span class="op" id="5737341">.</span><span class="ident" id="5737342">Init</span><span class="op" id="5737346">,</span>&nbsp;<span class="ident" id="5737348">false</span><span class="op" id="5737353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737358">p</span><span class="op" id="5737359">.</span><span class="builtinfunc" id="5737360">print</span><span class="op" id="5737365">(</span><span class="ident" id="5737366">token</span><span class="op" id="5737371">.</span><span class="ident" id="5737372">SEMICOLON</span><span class="op" id="5737381">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737389">p</span><span class="op" id="5737390">.</span><span class="builtinfunc" id="5737391">print</span><span class="op" id="5737396">(</span><span class="ident" id="5737397">blank</span><span class="op" id="5737402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737406">p</span><span class="op" id="5737407">.</span><span class="ident" id="5737408">stmt</span><span class="op" id="5737412">(</span><span class="ident" id="5737413">s</span><span class="op" id="5737414">.</span><span class="ident" id="5737415">Assign</span><span class="op" id="5737421">,</span>&nbsp;<span class="ident" id="5737423">false</span><span class="op" id="5737428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737432">p</span><span class="op" id="5737433">.</span><span class="builtinfunc" id="5737434">print</span><span class="op" id="5737439">(</span><span class="ident" id="5737440">blank</span><span class="op" id="5737445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737449">p</span><span class="op" id="5737450">.</span><span class="ident" id="5737451">block</span><span class="op" id="5737456">(</span><span class="ident" id="5737457">s</span><span class="op" id="5737458">.</span><span class="ident" id="5737459">Body</span><span class="op" id="5737463">,</span>&nbsp;<span class="num" id="5737465">0</span><span class="op" id="5737466">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737470">case</span>&nbsp;<span class="op" id="5737475">*</span><span class="ident" id="5737476">ast</span><span class="op" id="5737479">.</span><span class="ident" id="5737480">CommClause</span><span class="op" id="5737490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737494">if</span>&nbsp;<span class="ident" id="5737497">s</span><span class="op" id="5737498">.</span><span class="ident" id="5737499">Comm</span>&nbsp;<span class="op" id="5737504">!=</span>&nbsp;<span class="ident" id="5737507">nil</span>&nbsp;<span class="op" id="5737511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737516">p</span><span class="op" id="5737517">.</span><span class="builtinfunc" id="5737518">print</span><span class="op" id="5737523">(</span><span class="ident" id="5737524">token</span><span class="op" id="5737529">.</span><span class="ident" id="5737530">CASE</span><span class="op" id="5737534">,</span>&nbsp;<span class="ident" id="5737536">blank</span><span class="op" id="5737541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737546">p</span><span class="op" id="5737547">.</span><span class="ident" id="5737548">stmt</span><span class="op" id="5737552">(</span><span class="ident" id="5737553">s</span><span class="op" id="5737554">.</span><span class="ident" id="5737555">Comm</span><span class="op" id="5737559">,</span>&nbsp;<span class="ident" id="5737561">false</span><span class="op" id="5737566">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737570">}</span>&nbsp;<span class="keyword" id="5737572">else</span>&nbsp;<span class="op" id="5737577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737582">p</span><span class="op" id="5737583">.</span><span class="builtinfunc" id="5737584">print</span><span class="op" id="5737589">(</span><span class="ident" id="5737590">token</span><span class="op" id="5737595">.</span><span class="ident" id="5737596">DEFAULT</span><span class="op" id="5737603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737611">p</span><span class="op" id="5737612">.</span><span class="builtinfunc" id="5737613">print</span><span class="op" id="5737618">(</span><span class="ident" id="5737619">s</span><span class="op" id="5737620">.</span><span class="ident" id="5737621">Colon</span><span class="op" id="5737626">,</span>&nbsp;<span class="ident" id="5737628">token</span><span class="op" id="5737633">.</span><span class="ident" id="5737634">COLON</span><span class="op" id="5737639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737643">p</span><span class="op" id="5737644">.</span><span class="ident" id="5737645">stmtList</span><span class="op" id="5737653">(</span><span class="ident" id="5737654">s</span><span class="op" id="5737655">.</span><span class="ident" id="5737656">Body</span><span class="op" id="5737660">,</span>&nbsp;<span class="num" id="5737662">1</span><span class="op" id="5737663">,</span>&nbsp;<span class="ident" id="5737665">nextIsRBrace</span><span class="op" id="5737677">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737681">case</span>&nbsp;<span class="op" id="5737686">*</span><span class="ident" id="5737687">ast</span><span class="op" id="5737690">.</span><span class="ident" id="5737691">SelectStmt</span><span class="op" id="5737701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737705">p</span><span class="op" id="5737706">.</span><span class="builtinfunc" id="5737707">print</span><span class="op" id="5737712">(</span><span class="ident" id="5737713">token</span><span class="op" id="5737718">.</span><span class="ident" id="5737719">SELECT</span><span class="op" id="5737725">,</span>&nbsp;<span class="ident" id="5737727">blank</span><span class="op" id="5737732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737736">body</span>&nbsp;<span class="op" id="5737741">:=</span>&nbsp;<span class="ident" id="5737744">s</span><span class="op" id="5737745">.</span><span class="ident" id="5737746">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737753">if</span>&nbsp;<span class="builtinfunc" id="5737756">len</span><span class="op" id="5737759">(</span><span class="ident" id="5737760">body</span><span class="op" id="5737764">.</span><span class="ident" id="5737765">List</span><span class="op" id="5737769">)</span>&nbsp;<span class="op" id="5737771">==</span>&nbsp;<span class="num" id="5737774">0</span>&nbsp;<span class="op" id="5737776">&amp;&amp;</span>&nbsp;<span class="op" id="5737779">!</span><span class="ident" id="5737780">p</span><span class="op" id="5737781">.</span><span class="ident" id="5737782">commentBefore</span><span class="op" id="5737795">(</span><span class="ident" id="5737796">p</span><span class="op" id="5737797">.</span><span class="ident" id="5737798">posFor</span><span class="op" id="5737804">(</span><span class="ident" id="5737805">body</span><span class="op" id="5737809">.</span><span class="ident" id="5737810">Rbrace</span><span class="op" id="5737816">)</span><span class="op" id="5737817">)</span>&nbsp;<span class="op" id="5737819">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5737824">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737884">p</span><span class="op" id="5737885">.</span><span class="builtinfunc" id="5737886">print</span><span class="op" id="5737891">(</span><span class="ident" id="5737892">body</span><span class="op" id="5737896">.</span><span class="ident" id="5737897">Lbrace</span><span class="op" id="5737903">,</span>&nbsp;<span class="ident" id="5737905">token</span><span class="op" id="5737910">.</span><span class="ident" id="5737911">LBRACE</span><span class="op" id="5737917">,</span>&nbsp;<span class="ident" id="5737919">body</span><span class="op" id="5737923">.</span><span class="ident" id="5737924">Rbrace</span><span class="op" id="5737930">,</span>&nbsp;<span class="ident" id="5737932">token</span><span class="op" id="5737937">.</span><span class="ident" id="5737938">RBRACE</span><span class="op" id="5737944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737948">}</span>&nbsp;<span class="keyword" id="5737950">else</span>&nbsp;<span class="op" id="5737955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5737960">p</span><span class="op" id="5737961">.</span><span class="ident" id="5737962">block</span><span class="op" id="5737967">(</span><span class="ident" id="5737968">body</span><span class="op" id="5737972">,</span>&nbsp;<span class="num" id="5737974">0</span><span class="op" id="5737975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5737979">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5737983">case</span>&nbsp;<span class="op" id="5737988">*</span><span class="ident" id="5737989">ast</span><span class="op" id="5737992">.</span><span class="ident" id="5737993">ForStmt</span><span class="op" id="5738000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738004">p</span><span class="op" id="5738005">.</span><span class="builtinfunc" id="5738006">print</span><span class="op" id="5738011">(</span><span class="ident" id="5738012">token</span><span class="op" id="5738017">.</span><span class="ident" id="5738018">FOR</span><span class="op" id="5738021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738025">p</span><span class="op" id="5738026">.</span><span class="ident" id="5738027">controlClause</span><span class="op" id="5738040">(</span><span class="ident" id="5738041">true</span><span class="op" id="5738045">,</span>&nbsp;<span class="ident" id="5738047">s</span><span class="op" id="5738048">.</span><span class="ident" id="5738049">Init</span><span class="op" id="5738053">,</span>&nbsp;<span class="ident" id="5738055">s</span><span class="op" id="5738056">.</span><span class="ident" id="5738057">Cond</span><span class="op" id="5738061">,</span>&nbsp;<span class="ident" id="5738063">s</span><span class="op" id="5738064">.</span><span class="ident" id="5738065">Post</span><span class="op" id="5738069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738073">p</span><span class="op" id="5738074">.</span><span class="ident" id="5738075">block</span><span class="op" id="5738080">(</span><span class="ident" id="5738081">s</span><span class="op" id="5738082">.</span><span class="ident" id="5738083">Body</span><span class="op" id="5738087">,</span>&nbsp;<span class="num" id="5738089">1</span><span class="op" id="5738090">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5738094">case</span>&nbsp;<span class="op" id="5738099">*</span><span class="ident" id="5738100">ast</span><span class="op" id="5738103">.</span><span class="ident" id="5738104">RangeStmt</span><span class="op" id="5738113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738117">p</span><span class="op" id="5738118">.</span><span class="builtinfunc" id="5738119">print</span><span class="op" id="5738124">(</span><span class="ident" id="5738125">token</span><span class="op" id="5738130">.</span><span class="ident" id="5738131">FOR</span><span class="op" id="5738134">,</span>&nbsp;<span class="ident" id="5738136">blank</span><span class="op" id="5738141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5738145">if</span>&nbsp;<span class="ident" id="5738148">s</span><span class="op" id="5738149">.</span><span class="ident" id="5738150">Key</span>&nbsp;<span class="op" id="5738154">!=</span>&nbsp;<span class="ident" id="5738157">nil</span>&nbsp;<span class="op" id="5738161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738166">p</span><span class="op" id="5738167">.</span><span class="ident" id="5738168">expr</span><span class="op" id="5738172">(</span><span class="ident" id="5738173">s</span><span class="op" id="5738174">.</span><span class="ident" id="5738175">Key</span><span class="op" id="5738178">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5738183">if</span>&nbsp;<span class="ident" id="5738186">s</span><span class="op" id="5738187">.</span><span class="ident" id="5738188">Value</span>&nbsp;<span class="op" id="5738194">!=</span>&nbsp;<span class="ident" id="5738197">nil</span>&nbsp;<span class="op" id="5738201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5738207">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5738259">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738311">p</span><span class="op" id="5738312">.</span><span class="builtinfunc" id="5738313">print</span><span class="op" id="5738318">(</span><span class="ident" id="5738319">s</span><span class="op" id="5738320">.</span><span class="ident" id="5738321">Value</span><span class="op" id="5738326">.</span><span class="ident" id="5738327">Pos</span><span class="op" id="5738330">(</span><span class="op" id="5738331">)</span><span class="op" id="5738332">,</span>&nbsp;<span class="ident" id="5738334">token</span><span class="op" id="5738339">.</span><span class="ident" id="5738340">COMMA</span><span class="op" id="5738345">,</span>&nbsp;<span class="ident" id="5738347">blank</span><span class="op" id="5738352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738358">p</span><span class="op" id="5738359">.</span><span class="ident" id="5738360">expr</span><span class="op" id="5738364">(</span><span class="ident" id="5738365">s</span><span class="op" id="5738366">.</span><span class="ident" id="5738367">Value</span><span class="op" id="5738372">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5738377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738382">p</span><span class="op" id="5738383">.</span><span class="builtinfunc" id="5738384">print</span><span class="op" id="5738389">(</span><span class="ident" id="5738390">blank</span><span class="op" id="5738395">,</span>&nbsp;<span class="ident" id="5738397">s</span><span class="op" id="5738398">.</span><span class="ident" id="5738399">TokPos</span><span class="op" id="5738405">,</span>&nbsp;<span class="ident" id="5738407">s</span><span class="op" id="5738408">.</span><span class="ident" id="5738409">Tok</span><span class="op" id="5738412">,</span>&nbsp;<span class="ident" id="5738414">blank</span><span class="op" id="5738419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5738423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738427">p</span><span class="op" id="5738428">.</span><span class="builtinfunc" id="5738429">print</span><span class="op" id="5738434">(</span><span class="ident" id="5738435">token</span><span class="op" id="5738440">.</span><span class="ident" id="5738441">RANGE</span><span class="op" id="5738446">,</span>&nbsp;<span class="ident" id="5738448">blank</span><span class="op" id="5738453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738457">p</span><span class="op" id="5738458">.</span><span class="ident" id="5738459">expr</span><span class="op" id="5738463">(</span><span class="ident" id="5738464">stripParens</span><span class="op" id="5738475">(</span><span class="ident" id="5738476">s</span><span class="op" id="5738477">.</span><span class="ident" id="5738478">X</span><span class="op" id="5738479">)</span><span class="op" id="5738480">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738484">p</span><span class="op" id="5738485">.</span><span class="builtinfunc" id="5738486">print</span><span class="op" id="5738491">(</span><span class="ident" id="5738492">blank</span><span class="op" id="5738497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5738501">p</span><span class="op" id="5738502">.</span><span class="ident" id="5738503">block</span><span class="op" id="5738508">(</span><span class="ident" id="5738509">s</span><span class="op" id="5738510">.</span><span class="ident" id="5738511">Body</span><span class="op" id="5738515">,</span>&nbsp;<span class="num" id="5738517">1</span><span class="op" id="5738518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5738522">default</span><span class="op" id="5738529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5738533">panic</span><span class="op" id="5738538">(</span><span class="string" id="5738539">&#34;unreachable&#34;</span><span class="op" id="5738552">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5738555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5738559">return</span><br>
<span class="lineno"></span><span class="op" id="5738566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5738569">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5738649">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5738666">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5738742">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5738818">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5738893">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5738968">//</span><br>
<span class="lineno"></span><span class="comment" id="5738971">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5739004">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5739007">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5739018">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5739049">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5739080">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="5739088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5739114">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="5739119">//</span><br>
<span class="lineno"></span><span class="comment" id="5739122">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5739195">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5739270">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5739347">//</span><br>
<span class="lineno"></span><span class="comment" id="5739350">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5739388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5739417">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5739487">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5739548">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5739585">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5739651">//</span><br>
<span class="lineno"></span><span class="keyword" id="5739654">func</span>&nbsp;<span class="ident" id="5739659">keepTypeColumn</span><span class="op" id="5739673">(</span><span class="ident" id="5739674">specs</span>&nbsp;<span class="op" id="5739680">[</span><span class="op" id="5739681">]</span><span class="ident" id="5739682">ast</span><span class="op" id="5739685">.</span><span class="ident" id="5739686">Spec</span><span class="op" id="5739690">)</span>&nbsp;<span class="op" id="5739692">[</span><span class="op" id="5739693">]</span><span class="builtintype" id="5739694">bool</span>&nbsp;<span class="op" id="5739699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5739702">m</span>&nbsp;<span class="op" id="5739704">:=</span>&nbsp;<span class="builtinfunc" id="5739707">make</span><span class="op" id="5739711">(</span><span class="op" id="5739712">[</span><span class="op" id="5739713">]</span><span class="builtintype" id="5739714">bool</span><span class="op" id="5739718">,</span>&nbsp;<span class="builtinfunc" id="5739720">len</span><span class="op" id="5739723">(</span><span class="ident" id="5739724">specs</span><span class="op" id="5739729">)</span><span class="op" id="5739730">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5739734">populate</span>&nbsp;<span class="op" id="5739743">:=</span>&nbsp;<span class="keyword" id="5739746">func</span><span class="op" id="5739750">(</span><span class="ident" id="5739751">i</span><span class="op" id="5739752">,</span>&nbsp;<span class="ident" id="5739754">j</span>&nbsp;<span class="builtintype" id="5739756">int</span><span class="op" id="5739759">,</span>&nbsp;<span class="ident" id="5739761">keepType</span>&nbsp;<span class="builtintype" id="5739770">bool</span><span class="op" id="5739774">)</span>&nbsp;<span class="op" id="5739776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5739780">if</span>&nbsp;<span class="ident" id="5739783">keepType</span>&nbsp;<span class="op" id="5739792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5739797">for</span>&nbsp;<span class="op" id="5739801">;</span>&nbsp;<span class="ident" id="5739803">i</span>&nbsp;<span class="op" id="5739805">&lt;</span>&nbsp;<span class="ident" id="5739807">j</span><span class="op" id="5739808">;</span>&nbsp;<span class="ident" id="5739810">i</span><span class="op" id="5739811">++</span>&nbsp;<span class="op" id="5739814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5739820">m</span><span class="op" id="5739821">[</span><span class="ident" id="5739822">i</span><span class="op" id="5739823">]</span>&nbsp;<span class="op" id="5739825">=</span>&nbsp;<span class="ident" id="5739827">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5739835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5739839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5739842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5739846">i0</span>&nbsp;<span class="op" id="5739849">:=</span>&nbsp;<span class="op" id="5739852">-</span><span class="num" id="5739853">1</span>&nbsp;<span class="comment" id="5739855">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5739917">var</span>&nbsp;<span class="ident" id="5739921">keepType</span>&nbsp;<span class="builtintype" id="5739930">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5739936">for</span>&nbsp;<span class="ident" id="5739940">i</span><span class="op" id="5739941">,</span>&nbsp;<span class="ident" id="5739943">s</span>&nbsp;<span class="op" id="5739945">:=</span>&nbsp;<span class="keyword" id="5739948">range</span>&nbsp;<span class="ident" id="5739954">specs</span>&nbsp;<span class="op" id="5739960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5739964">t</span>&nbsp;<span class="op" id="5739966">:=</span>&nbsp;<span class="ident" id="5739969">s</span><span class="op" id="5739970">.</span><span class="op" id="5739971">(</span><span class="op" id="5739972">*</span><span class="ident" id="5739973">ast</span><span class="op" id="5739976">.</span><span class="ident" id="5739977">ValueSpec</span><span class="op" id="5739986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5739990">if</span>&nbsp;<span class="ident" id="5739993">t</span><span class="op" id="5739994">.</span><span class="ident" id="5739995">Values</span>&nbsp;<span class="op" id="5740002">!=</span>&nbsp;<span class="ident" id="5740005">nil</span>&nbsp;<span class="op" id="5740009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740014">if</span>&nbsp;<span class="ident" id="5740017">i0</span>&nbsp;<span class="op" id="5740020">&lt;</span>&nbsp;<span class="num" id="5740022">0</span>&nbsp;<span class="op" id="5740024">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5740030">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740086">i0</span>&nbsp;<span class="op" id="5740089">=</span>&nbsp;<span class="ident" id="5740091">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740097">keepType</span>&nbsp;<span class="op" id="5740106">=</span>&nbsp;<span class="ident" id="5740108">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740121">}</span>&nbsp;<span class="keyword" id="5740123">else</span>&nbsp;<span class="op" id="5740128">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740133">if</span>&nbsp;<span class="ident" id="5740136">i0</span>&nbsp;<span class="op" id="5740139">&gt;=</span>&nbsp;<span class="num" id="5740142">0</span>&nbsp;<span class="op" id="5740144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5740150">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740170">populate</span><span class="op" id="5740178">(</span><span class="ident" id="5740179">i0</span><span class="op" id="5740181">,</span>&nbsp;<span class="ident" id="5740183">i</span><span class="op" id="5740184">,</span>&nbsp;<span class="ident" id="5740186">keepType</span><span class="op" id="5740194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740200">i0</span>&nbsp;<span class="op" id="5740203">=</span>&nbsp;<span class="op" id="5740205">-</span><span class="num" id="5740206">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740211">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740219">if</span>&nbsp;<span class="ident" id="5740222">t</span><span class="op" id="5740223">.</span><span class="ident" id="5740224">Type</span>&nbsp;<span class="op" id="5740229">!=</span>&nbsp;<span class="ident" id="5740232">nil</span>&nbsp;<span class="op" id="5740236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740241">keepType</span>&nbsp;<span class="op" id="5740250">=</span>&nbsp;<span class="ident" id="5740252">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740262">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740265">if</span>&nbsp;<span class="ident" id="5740268">i0</span>&nbsp;<span class="op" id="5740271">&gt;=</span>&nbsp;<span class="num" id="5740274">0</span>&nbsp;<span class="op" id="5740276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5740280">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740298">populate</span><span class="op" id="5740306">(</span><span class="ident" id="5740307">i0</span><span class="op" id="5740309">,</span>&nbsp;<span class="builtinfunc" id="5740311">len</span><span class="op" id="5740314">(</span><span class="ident" id="5740315">specs</span><span class="op" id="5740320">)</span><span class="op" id="5740321">,</span>&nbsp;<span class="ident" id="5740323">keepType</span><span class="op" id="5740331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740338">return</span>&nbsp;<span class="ident" id="5740345">m</span><br>
<span class="lineno"></span><span class="op" id="5740347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5740350">func</span>&nbsp;<span class="op" id="5740355">(</span><span class="ident" id="5740356">p</span>&nbsp;<span class="op" id="5740358">*</span><span class="ident" id="5740359">printer</span><span class="op" id="5740366">)</span>&nbsp;<span class="ident" id="5740368">valueSpec</span><span class="op" id="5740377">(</span><span class="ident" id="5740378">s</span>&nbsp;<span class="op" id="5740380">*</span><span class="ident" id="5740381">ast</span><span class="op" id="5740384">.</span><span class="ident" id="5740385">ValueSpec</span><span class="op" id="5740394">,</span>&nbsp;<span class="ident" id="5740396">keepType</span>&nbsp;<span class="builtintype" id="5740405">bool</span><span class="op" id="5740409">)</span>&nbsp;<span class="op" id="5740411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740414">p</span><span class="op" id="5740415">.</span><span class="ident" id="5740416">setComment</span><span class="op" id="5740426">(</span><span class="ident" id="5740427">s</span><span class="op" id="5740428">.</span><span class="ident" id="5740429">Doc</span><span class="op" id="5740432">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740435">p</span><span class="op" id="5740436">.</span><span class="ident" id="5740437">identList</span><span class="op" id="5740446">(</span><span class="ident" id="5740447">s</span><span class="op" id="5740448">.</span><span class="ident" id="5740449">Names</span><span class="op" id="5740454">,</span>&nbsp;<span class="ident" id="5740456">false</span><span class="op" id="5740461">)</span>&nbsp;<span class="comment" id="5740463">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740482">extraTabs</span>&nbsp;<span class="op" id="5740492">:=</span>&nbsp;<span class="num" id="5740495">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740498">if</span>&nbsp;<span class="ident" id="5740501">s</span><span class="op" id="5740502">.</span><span class="ident" id="5740503">Type</span>&nbsp;<span class="op" id="5740508">!=</span>&nbsp;<span class="ident" id="5740511">nil</span>&nbsp;<span class="op" id="5740515">||</span>&nbsp;<span class="ident" id="5740518">keepType</span>&nbsp;<span class="op" id="5740527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740531">p</span><span class="op" id="5740532">.</span><span class="builtinfunc" id="5740533">print</span><span class="op" id="5740538">(</span><span class="ident" id="5740539">vtab</span><span class="op" id="5740543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740547">extraTabs</span><span class="op" id="5740556">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740563">if</span>&nbsp;<span class="ident" id="5740566">s</span><span class="op" id="5740567">.</span><span class="ident" id="5740568">Type</span>&nbsp;<span class="op" id="5740573">!=</span>&nbsp;<span class="ident" id="5740576">nil</span>&nbsp;<span class="op" id="5740580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740584">p</span><span class="op" id="5740585">.</span><span class="ident" id="5740586">expr</span><span class="op" id="5740590">(</span><span class="ident" id="5740591">s</span><span class="op" id="5740592">.</span><span class="ident" id="5740593">Type</span><span class="op" id="5740597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740603">if</span>&nbsp;<span class="ident" id="5740606">s</span><span class="op" id="5740607">.</span><span class="ident" id="5740608">Values</span>&nbsp;<span class="op" id="5740615">!=</span>&nbsp;<span class="ident" id="5740618">nil</span>&nbsp;<span class="op" id="5740622">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740626">p</span><span class="op" id="5740627">.</span><span class="builtinfunc" id="5740628">print</span><span class="op" id="5740633">(</span><span class="ident" id="5740634">vtab</span><span class="op" id="5740638">,</span>&nbsp;<span class="ident" id="5740640">token</span><span class="op" id="5740645">.</span><span class="ident" id="5740646">ASSIGN</span><span class="op" id="5740652">,</span>&nbsp;<span class="ident" id="5740654">blank</span><span class="op" id="5740659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740663">p</span><span class="op" id="5740664">.</span><span class="ident" id="5740665">exprList</span><span class="op" id="5740673">(</span><span class="ident" id="5740674">token</span><span class="op" id="5740679">.</span><span class="ident" id="5740680">NoPos</span><span class="op" id="5740685">,</span>&nbsp;<span class="ident" id="5740687">s</span><span class="op" id="5740688">.</span><span class="ident" id="5740689">Values</span><span class="op" id="5740695">,</span>&nbsp;<span class="num" id="5740697">1</span><span class="op" id="5740698">,</span>&nbsp;<span class="num" id="5740700">0</span><span class="op" id="5740701">,</span>&nbsp;<span class="ident" id="5740703">token</span><span class="op" id="5740708">.</span><span class="ident" id="5740709">NoPos</span><span class="op" id="5740714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740718">extraTabs</span><span class="op" id="5740727">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740734">if</span>&nbsp;<span class="ident" id="5740737">s</span><span class="op" id="5740738">.</span><span class="ident" id="5740739">Comment</span>&nbsp;<span class="op" id="5740747">!=</span>&nbsp;<span class="ident" id="5740750">nil</span>&nbsp;<span class="op" id="5740754">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5740758">for</span>&nbsp;<span class="op" id="5740762">;</span>&nbsp;<span class="ident" id="5740764">extraTabs</span>&nbsp;<span class="op" id="5740774">&gt;</span>&nbsp;<span class="num" id="5740776">0</span><span class="op" id="5740777">;</span>&nbsp;<span class="ident" id="5740779">extraTabs</span><span class="op" id="5740788">--</span>&nbsp;<span class="op" id="5740791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740796">p</span><span class="op" id="5740797">.</span><span class="builtinfunc" id="5740798">print</span><span class="op" id="5740803">(</span><span class="ident" id="5740804">vtab</span><span class="op" id="5740808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5740816">p</span><span class="op" id="5740817">.</span><span class="ident" id="5740818">setComment</span><span class="op" id="5740828">(</span><span class="ident" id="5740829">s</span><span class="op" id="5740830">.</span><span class="ident" id="5740831">Comment</span><span class="op" id="5740838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5740841">}</span><br>
<span class="lineno">1335</span><span class="op" id="5740843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5740846">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5740922">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5740993">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5741022">//</span><br>
<span class="lineno"></span><span class="keyword" id="5741025">func</span>&nbsp;<span class="op" id="5741030">(</span><span class="ident" id="5741031">p</span>&nbsp;<span class="op" id="5741033">*</span><span class="ident" id="5741034">printer</span><span class="op" id="5741041">)</span>&nbsp;<span class="ident" id="5741043">spec</span><span class="op" id="5741047">(</span><span class="ident" id="5741048">spec</span>&nbsp;<span class="ident" id="5741053">ast</span><span class="op" id="5741056">.</span><span class="ident" id="5741057">Spec</span><span class="op" id="5741061">,</span>&nbsp;<span class="ident" id="5741063">n</span>&nbsp;<span class="builtintype" id="5741065">int</span><span class="op" id="5741068">,</span>&nbsp;<span class="ident" id="5741070">doIndent</span>&nbsp;<span class="builtintype" id="5741079">bool</span><span class="op" id="5741083">)</span>&nbsp;<span class="op" id="5741085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741088">switch</span>&nbsp;<span class="ident" id="5741095">s</span>&nbsp;<span class="op" id="5741097">:=</span>&nbsp;<span class="ident" id="5741100">spec</span><span class="op" id="5741104">.</span><span class="op" id="5741105">(</span><span class="keyword" id="5741106">type</span><span class="op" id="5741110">)</span>&nbsp;<span class="op" id="5741112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741115">case</span>&nbsp;<span class="op" id="5741120">*</span><span class="ident" id="5741121">ast</span><span class="op" id="5741124">.</span><span class="ident" id="5741125">ImportSpec</span><span class="op" id="5741135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741139">p</span><span class="op" id="5741140">.</span><span class="ident" id="5741141">setComment</span><span class="op" id="5741151">(</span><span class="ident" id="5741152">s</span><span class="op" id="5741153">.</span><span class="ident" id="5741154">Doc</span><span class="op" id="5741157">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741161">if</span>&nbsp;<span class="ident" id="5741164">s</span><span class="op" id="5741165">.</span><span class="ident" id="5741166">Name</span>&nbsp;<span class="op" id="5741171">!=</span>&nbsp;<span class="ident" id="5741174">nil</span>&nbsp;<span class="op" id="5741178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741183">p</span><span class="op" id="5741184">.</span><span class="ident" id="5741185">expr</span><span class="op" id="5741189">(</span><span class="ident" id="5741190">s</span><span class="op" id="5741191">.</span><span class="ident" id="5741192">Name</span><span class="op" id="5741196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741201">p</span><span class="op" id="5741202">.</span><span class="builtinfunc" id="5741203">print</span><span class="op" id="5741208">(</span><span class="ident" id="5741209">blank</span><span class="op" id="5741214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741222">p</span><span class="op" id="5741223">.</span><span class="ident" id="5741224">expr</span><span class="op" id="5741228">(</span><span class="ident" id="5741229">s</span><span class="op" id="5741230">.</span><span class="ident" id="5741231">Path</span><span class="op" id="5741235">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741239">p</span><span class="op" id="5741240">.</span><span class="ident" id="5741241">setComment</span><span class="op" id="5741251">(</span><span class="ident" id="5741252">s</span><span class="op" id="5741253">.</span><span class="ident" id="5741254">Comment</span><span class="op" id="5741261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741265">p</span><span class="op" id="5741266">.</span><span class="builtinfunc" id="5741267">print</span><span class="op" id="5741272">(</span><span class="ident" id="5741273">s</span><span class="op" id="5741274">.</span><span class="ident" id="5741275">EndPos</span><span class="op" id="5741281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741285">case</span>&nbsp;<span class="op" id="5741290">*</span><span class="ident" id="5741291">ast</span><span class="op" id="5741294">.</span><span class="ident" id="5741295">ValueSpec</span><span class="op" id="5741304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741308">if</span>&nbsp;<span class="ident" id="5741311">n</span>&nbsp;<span class="op" id="5741313">!=</span>&nbsp;<span class="num" id="5741316">1</span>&nbsp;<span class="op" id="5741318">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741323">p</span><span class="op" id="5741324">.</span><span class="ident" id="5741325">internalError</span><span class="op" id="5741338">(</span><span class="string" id="5741339">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5741360">,</span>&nbsp;<span class="ident" id="5741362">n</span><span class="op" id="5741363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741371">p</span><span class="op" id="5741372">.</span><span class="ident" id="5741373">setComment</span><span class="op" id="5741383">(</span><span class="ident" id="5741384">s</span><span class="op" id="5741385">.</span><span class="ident" id="5741386">Doc</span><span class="op" id="5741389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741393">p</span><span class="op" id="5741394">.</span><span class="ident" id="5741395">identList</span><span class="op" id="5741404">(</span><span class="ident" id="5741405">s</span><span class="op" id="5741406">.</span><span class="ident" id="5741407">Names</span><span class="op" id="5741412">,</span>&nbsp;<span class="ident" id="5741414">doIndent</span><span class="op" id="5741422">)</span>&nbsp;<span class="comment" id="5741424">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741444">if</span>&nbsp;<span class="ident" id="5741447">s</span><span class="op" id="5741448">.</span><span class="ident" id="5741449">Type</span>&nbsp;<span class="op" id="5741454">!=</span>&nbsp;<span class="ident" id="5741457">nil</span>&nbsp;<span class="op" id="5741461">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741466">p</span><span class="op" id="5741467">.</span><span class="builtinfunc" id="5741468">print</span><span class="op" id="5741473">(</span><span class="ident" id="5741474">blank</span><span class="op" id="5741479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741484">p</span><span class="op" id="5741485">.</span><span class="ident" id="5741486">expr</span><span class="op" id="5741490">(</span><span class="ident" id="5741491">s</span><span class="op" id="5741492">.</span><span class="ident" id="5741493">Type</span><span class="op" id="5741497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741505">if</span>&nbsp;<span class="ident" id="5741508">s</span><span class="op" id="5741509">.</span><span class="ident" id="5741510">Values</span>&nbsp;<span class="op" id="5741517">!=</span>&nbsp;<span class="ident" id="5741520">nil</span>&nbsp;<span class="op" id="5741524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741529">p</span><span class="op" id="5741530">.</span><span class="builtinfunc" id="5741531">print</span><span class="op" id="5741536">(</span><span class="ident" id="5741537">blank</span><span class="op" id="5741542">,</span>&nbsp;<span class="ident" id="5741544">token</span><span class="op" id="5741549">.</span><span class="ident" id="5741550">ASSIGN</span><span class="op" id="5741556">,</span>&nbsp;<span class="ident" id="5741558">blank</span><span class="op" id="5741563">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741568">p</span><span class="op" id="5741569">.</span><span class="ident" id="5741570">exprList</span><span class="op" id="5741578">(</span><span class="ident" id="5741579">token</span><span class="op" id="5741584">.</span><span class="ident" id="5741585">NoPos</span><span class="op" id="5741590">,</span>&nbsp;<span class="ident" id="5741592">s</span><span class="op" id="5741593">.</span><span class="ident" id="5741594">Values</span><span class="op" id="5741600">,</span>&nbsp;<span class="num" id="5741602">1</span><span class="op" id="5741603">,</span>&nbsp;<span class="num" id="5741605">0</span><span class="op" id="5741606">,</span>&nbsp;<span class="ident" id="5741608">token</span><span class="op" id="5741613">.</span><span class="ident" id="5741614">NoPos</span><span class="op" id="5741619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741627">p</span><span class="op" id="5741628">.</span><span class="ident" id="5741629">setComment</span><span class="op" id="5741639">(</span><span class="ident" id="5741640">s</span><span class="op" id="5741641">.</span><span class="ident" id="5741642">Comment</span><span class="op" id="5741649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741653">case</span>&nbsp;<span class="op" id="5741658">*</span><span class="ident" id="5741659">ast</span><span class="op" id="5741662">.</span><span class="ident" id="5741663">TypeSpec</span><span class="op" id="5741671">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741675">p</span><span class="op" id="5741676">.</span><span class="ident" id="5741677">setComment</span><span class="op" id="5741687">(</span><span class="ident" id="5741688">s</span><span class="op" id="5741689">.</span><span class="ident" id="5741690">Doc</span><span class="op" id="5741693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741697">p</span><span class="op" id="5741698">.</span><span class="ident" id="5741699">expr</span><span class="op" id="5741703">(</span><span class="ident" id="5741704">s</span><span class="op" id="5741705">.</span><span class="ident" id="5741706">Name</span><span class="op" id="5741710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741714">if</span>&nbsp;<span class="ident" id="5741717">n</span>&nbsp;<span class="op" id="5741719">==</span>&nbsp;<span class="num" id="5741722">1</span>&nbsp;<span class="op" id="5741724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741729">p</span><span class="op" id="5741730">.</span><span class="builtinfunc" id="5741731">print</span><span class="op" id="5741736">(</span><span class="ident" id="5741737">blank</span><span class="op" id="5741742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741746">}</span>&nbsp;<span class="keyword" id="5741748">else</span>&nbsp;<span class="op" id="5741753">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741758">p</span><span class="op" id="5741759">.</span><span class="builtinfunc" id="5741760">print</span><span class="op" id="5741765">(</span><span class="ident" id="5741766">vtab</span><span class="op" id="5741770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741778">p</span><span class="op" id="5741779">.</span><span class="ident" id="5741780">expr</span><span class="op" id="5741784">(</span><span class="ident" id="5741785">s</span><span class="op" id="5741786">.</span><span class="ident" id="5741787">Type</span><span class="op" id="5741791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741795">p</span><span class="op" id="5741796">.</span><span class="ident" id="5741797">setComment</span><span class="op" id="5741807">(</span><span class="ident" id="5741808">s</span><span class="op" id="5741809">.</span><span class="ident" id="5741810">Comment</span><span class="op" id="5741817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741821">default</span><span class="op" id="5741828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5741832">panic</span><span class="op" id="5741837">(</span><span class="string" id="5741838">&#34;unreachable&#34;</span><span class="op" id="5741851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5741854">}</span><br>
<span class="lineno"></span><span class="op" id="5741856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5741859">func</span>&nbsp;<span class="op" id="5741864">(</span><span class="ident" id="5741865">p</span>&nbsp;<span class="op" id="5741867">*</span><span class="ident" id="5741868">printer</span><span class="op" id="5741875">)</span>&nbsp;<span class="ident" id="5741877">genDecl</span><span class="op" id="5741884">(</span><span class="ident" id="5741885">d</span>&nbsp;<span class="op" id="5741887">*</span><span class="ident" id="5741888">ast</span><span class="op" id="5741891">.</span><span class="ident" id="5741892">GenDecl</span><span class="op" id="5741899">)</span>&nbsp;<span class="op" id="5741901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741904">p</span><span class="op" id="5741905">.</span><span class="ident" id="5741906">setComment</span><span class="op" id="5741916">(</span><span class="ident" id="5741917">d</span><span class="op" id="5741918">.</span><span class="ident" id="5741919">Doc</span><span class="op" id="5741922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5741925">p</span><span class="op" id="5741926">.</span><span class="builtinfunc" id="5741927">print</span><span class="op" id="5741932">(</span><span class="ident" id="5741933">d</span><span class="op" id="5741934">.</span><span class="ident" id="5741935">Pos</span><span class="op" id="5741938">(</span><span class="op" id="5741939">)</span><span class="op" id="5741940">,</span>&nbsp;<span class="ident" id="5741942">d</span><span class="op" id="5741943">.</span><span class="ident" id="5741944">Tok</span><span class="op" id="5741947">,</span>&nbsp;<span class="ident" id="5741949">blank</span><span class="op" id="5741954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5741958">if</span>&nbsp;<span class="ident" id="5741961">d</span><span class="op" id="5741962">.</span><span class="ident" id="5741963">Lparen</span><span class="op" id="5741969">.</span><span class="ident" id="5741970">IsValid</span><span class="op" id="5741977">(</span><span class="op" id="5741978">)</span>&nbsp;<span class="op" id="5741980">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5741984">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742025">p</span><span class="op" id="5742026">.</span><span class="builtinfunc" id="5742027">print</span><span class="op" id="5742032">(</span><span class="ident" id="5742033">d</span><span class="op" id="5742034">.</span><span class="ident" id="5742035">Lparen</span><span class="op" id="5742041">,</span>&nbsp;<span class="ident" id="5742043">token</span><span class="op" id="5742048">.</span><span class="ident" id="5742049">LPAREN</span><span class="op" id="5742055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742059">if</span>&nbsp;<span class="ident" id="5742062">n</span>&nbsp;<span class="op" id="5742064">:=</span>&nbsp;<span class="builtinfunc" id="5742067">len</span><span class="op" id="5742070">(</span><span class="ident" id="5742071">d</span><span class="op" id="5742072">.</span><span class="ident" id="5742073">Specs</span><span class="op" id="5742078">)</span><span class="op" id="5742079">;</span>&nbsp;<span class="ident" id="5742081">n</span>&nbsp;<span class="op" id="5742083">&gt;</span>&nbsp;<span class="num" id="5742085">0</span>&nbsp;<span class="op" id="5742087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742092">p</span><span class="op" id="5742093">.</span><span class="builtinfunc" id="5742094">print</span><span class="op" id="5742099">(</span><span class="ident" id="5742100">indent</span><span class="op" id="5742106">,</span>&nbsp;<span class="ident" id="5742108">formfeed</span><span class="op" id="5742116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742121">if</span>&nbsp;<span class="ident" id="5742124">n</span>&nbsp;<span class="op" id="5742126">&gt;</span>&nbsp;<span class="num" id="5742128">1</span>&nbsp;<span class="op" id="5742130">&amp;&amp;</span>&nbsp;<span class="op" id="5742133">(</span><span class="ident" id="5742134">d</span><span class="op" id="5742135">.</span><span class="ident" id="5742136">Tok</span>&nbsp;<span class="op" id="5742140">==</span>&nbsp;<span class="ident" id="5742143">token</span><span class="op" id="5742148">.</span><span class="ident" id="5742149">CONST</span>&nbsp;<span class="op" id="5742155">||</span>&nbsp;<span class="ident" id="5742158">d</span><span class="op" id="5742159">.</span><span class="ident" id="5742160">Tok</span>&nbsp;<span class="op" id="5742164">==</span>&nbsp;<span class="ident" id="5742167">token</span><span class="op" id="5742172">.</span><span class="ident" id="5742173">VAR</span><span class="op" id="5742176">)</span>&nbsp;<span class="op" id="5742178">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5742184">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5742235">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742284">keepType</span>&nbsp;<span class="op" id="5742293">:=</span>&nbsp;<span class="ident" id="5742296">keepTypeColumn</span><span class="op" id="5742310">(</span><span class="ident" id="5742311">d</span><span class="op" id="5742312">.</span><span class="ident" id="5742313">Specs</span><span class="op" id="5742318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742324">var</span>&nbsp;<span class="ident" id="5742328">line</span>&nbsp;<span class="builtintype" id="5742333">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742341">for</span>&nbsp;<span class="ident" id="5742345">i</span><span class="op" id="5742346">,</span>&nbsp;<span class="ident" id="5742348">s</span>&nbsp;<span class="op" id="5742350">:=</span>&nbsp;<span class="keyword" id="5742353">range</span>&nbsp;<span class="ident" id="5742359">d</span><span class="op" id="5742360">.</span><span class="ident" id="5742361">Specs</span>&nbsp;<span class="op" id="5742367">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742374">if</span>&nbsp;<span class="ident" id="5742377">i</span>&nbsp;<span class="op" id="5742379">&gt;</span>&nbsp;<span class="num" id="5742381">0</span>&nbsp;<span class="op" id="5742383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742391">p</span><span class="op" id="5742392">.</span><span class="ident" id="5742393">linebreak</span><span class="op" id="5742402">(</span><span class="ident" id="5742403">p</span><span class="op" id="5742404">.</span><span class="ident" id="5742405">lineFor</span><span class="op" id="5742412">(</span><span class="ident" id="5742413">s</span><span class="op" id="5742414">.</span><span class="ident" id="5742415">Pos</span><span class="op" id="5742418">(</span><span class="op" id="5742419">)</span><span class="op" id="5742420">)</span><span class="op" id="5742421">,</span>&nbsp;<span class="num" id="5742423">1</span><span class="op" id="5742424">,</span>&nbsp;<span class="ident" id="5742426">ignore</span><span class="op" id="5742432">,</span>&nbsp;<span class="ident" id="5742434">p</span><span class="op" id="5742435">.</span><span class="ident" id="5742436">linesFrom</span><span class="op" id="5742445">(</span><span class="ident" id="5742446">line</span><span class="op" id="5742450">)</span>&nbsp;<span class="op" id="5742452">&gt;</span>&nbsp;<span class="num" id="5742454">0</span><span class="op" id="5742455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742469">p</span><span class="op" id="5742470">.</span><span class="ident" id="5742471">recordLine</span><span class="op" id="5742481">(</span><span class="op" id="5742482">&amp;</span><span class="ident" id="5742483">line</span><span class="op" id="5742487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742494">p</span><span class="op" id="5742495">.</span><span class="ident" id="5742496">valueSpec</span><span class="op" id="5742505">(</span><span class="ident" id="5742506">s</span><span class="op" id="5742507">.</span><span class="op" id="5742508">(</span><span class="op" id="5742509">*</span><span class="ident" id="5742510">ast</span><span class="op" id="5742513">.</span><span class="ident" id="5742514">ValueSpec</span><span class="op" id="5742523">)</span><span class="op" id="5742524">,</span>&nbsp;<span class="ident" id="5742526">keepType</span><span class="op" id="5742534">[</span><span class="ident" id="5742535">i</span><span class="op" id="5742536">]</span><span class="op" id="5742537">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742548">}</span>&nbsp;<span class="keyword" id="5742550">else</span>&nbsp;<span class="op" id="5742555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742561">var</span>&nbsp;<span class="ident" id="5742565">line</span>&nbsp;<span class="builtintype" id="5742570">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742578">for</span>&nbsp;<span class="ident" id="5742582">i</span><span class="op" id="5742583">,</span>&nbsp;<span class="ident" id="5742585">s</span>&nbsp;<span class="op" id="5742587">:=</span>&nbsp;<span class="keyword" id="5742590">range</span>&nbsp;<span class="ident" id="5742596">d</span><span class="op" id="5742597">.</span><span class="ident" id="5742598">Specs</span>&nbsp;<span class="op" id="5742604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5742611">if</span>&nbsp;<span class="ident" id="5742614">i</span>&nbsp;<span class="op" id="5742616">&gt;</span>&nbsp;<span class="num" id="5742618">0</span>&nbsp;<span class="op" id="5742620">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742628">p</span><span class="op" id="5742629">.</span><span class="ident" id="5742630">linebreak</span><span class="op" id="5742639">(</span><span class="ident" id="5742640">p</span><span class="op" id="5742641">.</span><span class="ident" id="5742642">lineFor</span><span class="op" id="5742649">(</span><span class="ident" id="5742650">s</span><span class="op" id="5742651">.</span><span class="ident" id="5742652">Pos</span><span class="op" id="5742655">(</span><span class="op" id="5742656">)</span><span class="op" id="5742657">)</span><span class="op" id="5742658">,</span>&nbsp;<span class="num" id="5742660">1</span><span class="op" id="5742661">,</span>&nbsp;<span class="ident" id="5742663">ignore</span><span class="op" id="5742669">,</span>&nbsp;<span class="ident" id="5742671">p</span><span class="op" id="5742672">.</span><span class="ident" id="5742673">linesFrom</span><span class="op" id="5742682">(</span><span class="ident" id="5742683">line</span><span class="op" id="5742687">)</span>&nbsp;<span class="op" id="5742689">&gt;</span>&nbsp;<span class="num" id="5742691">0</span><span class="op" id="5742692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742706">p</span><span class="op" id="5742707">.</span><span class="ident" id="5742708">recordLine</span><span class="op" id="5742718">(</span><span class="op" id="5742719">&amp;</span><span class="ident" id="5742720">line</span><span class="op" id="5742724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742731">p</span><span class="op" id="5742732">.</span><span class="ident" id="5742733">spec</span><span class="op" id="5742737">(</span><span class="ident" id="5742738">s</span><span class="op" id="5742739">,</span>&nbsp;<span class="ident" id="5742741">n</span><span class="op" id="5742742">,</span>&nbsp;<span class="ident" id="5742744">false</span><span class="op" id="5742749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742755">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742765">p</span><span class="op" id="5742766">.</span><span class="builtinfunc" id="5742767">print</span><span class="op" id="5742772">(</span><span class="ident" id="5742773">unindent</span><span class="op" id="5742781">,</span>&nbsp;<span class="ident" id="5742783">formfeed</span><span class="op" id="5742791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742799">p</span><span class="op" id="5742800">.</span><span class="builtinfunc" id="5742801">print</span><span class="op" id="5742806">(</span><span class="ident" id="5742807">d</span><span class="op" id="5742808">.</span><span class="ident" id="5742809">Rparen</span><span class="op" id="5742815">,</span>&nbsp;<span class="ident" id="5742817">token</span><span class="op" id="5742822">.</span><span class="ident" id="5742823">RPAREN</span><span class="op" id="5742829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742833">}</span>&nbsp;<span class="keyword" id="5742835">else</span>&nbsp;<span class="op" id="5742840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5742844">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5742868">p</span><span class="op" id="5742869">.</span><span class="ident" id="5742870">spec</span><span class="op" id="5742874">(</span><span class="ident" id="5742875">d</span><span class="op" id="5742876">.</span><span class="ident" id="5742877">Specs</span><span class="op" id="5742882">[</span><span class="num" id="5742883">0</span><span class="op" id="5742884">]</span><span class="op" id="5742885">,</span>&nbsp;<span class="num" id="5742887">1</span><span class="op" id="5742888">,</span>&nbsp;<span class="ident" id="5742890">true</span><span class="op" id="5742894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5742897">}</span><br>
<span class="lineno"></span><span class="op" id="5742899">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5742902">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5742966">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5743031">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5743094">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5743152">//</span><br>
<span class="lineno"></span><span class="keyword" id="5743155">func</span>&nbsp;<span class="op" id="5743160">(</span><span class="ident" id="5743161">p</span>&nbsp;<span class="op" id="5743163">*</span><span class="ident" id="5743164">printer</span><span class="op" id="5743171">)</span>&nbsp;<span class="ident" id="5743173">nodeSize</span><span class="op" id="5743181">(</span><span class="ident" id="5743182">n</span>&nbsp;<span class="ident" id="5743184">ast</span><span class="op" id="5743187">.</span><span class="ident" id="5743188">Node</span><span class="op" id="5743192">,</span>&nbsp;<span class="ident" id="5743194">maxSize</span>&nbsp;<span class="builtintype" id="5743202">int</span><span class="op" id="5743205">)</span>&nbsp;<span class="op" id="5743207">(</span><span class="ident" id="5743208">size</span>&nbsp;<span class="builtintype" id="5743213">int</span><span class="op" id="5743216">)</span>&nbsp;<span class="op" id="5743218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743221">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743281">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743341">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743397">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743450">if</span>&nbsp;<span class="ident" id="5743453">size</span><span class="op" id="5743457">,</span>&nbsp;<span class="ident" id="5743459">found</span>&nbsp;<span class="op" id="5743465">:=</span>&nbsp;<span class="ident" id="5743468">p</span><span class="op" id="5743469">.</span><span class="ident" id="5743470">nodeSizes</span><span class="op" id="5743479">[</span><span class="ident" id="5743480">n</span><span class="op" id="5743481">]</span><span class="op" id="5743482">;</span>&nbsp;<span class="ident" id="5743484">found</span>&nbsp;<span class="op" id="5743490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743494">return</span>&nbsp;<span class="ident" id="5743501">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5743507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5743511">size</span>&nbsp;<span class="op" id="5743516">=</span>&nbsp;<span class="ident" id="5743518">maxSize</span>&nbsp;<span class="op" id="5743526">+</span>&nbsp;<span class="num" id="5743528">1</span>&nbsp;<span class="comment" id="5743530">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5743555">p</span><span class="op" id="5743556">.</span><span class="ident" id="5743557">nodeSizes</span><span class="op" id="5743566">[</span><span class="ident" id="5743567">n</span><span class="op" id="5743568">]</span>&nbsp;<span class="op" id="5743570">=</span>&nbsp;<span class="ident" id="5743572">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743579">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743638">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5743695">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5743712">cfg</span>&nbsp;<span class="op" id="5743716">:=</span>&nbsp;<span class="ident" id="5743719">Config</span><span class="op" id="5743725">{</span><span class="ident" id="5743726">Mode</span><span class="op" id="5743730">:</span>&nbsp;<span class="ident" id="5743732">RawFormat</span><span class="op" id="5743741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743744">var</span>&nbsp;<span class="ident" id="5743748">buf</span>&nbsp;<span class="ident" id="5743752">bytes</span><span class="op" id="5743757">.</span><span class="ident" id="5743758">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743766">if</span>&nbsp;<span class="ident" id="5743769">err</span>&nbsp;<span class="op" id="5743773">:=</span>&nbsp;<span class="ident" id="5743776">cfg</span><span class="op" id="5743779">.</span><span class="ident" id="5743780">fprint</span><span class="op" id="5743786">(</span><span class="op" id="5743787">&amp;</span><span class="ident" id="5743788">buf</span><span class="op" id="5743791">,</span>&nbsp;<span class="ident" id="5743793">p</span><span class="op" id="5743794">.</span><span class="ident" id="5743795">fset</span><span class="op" id="5743799">,</span>&nbsp;<span class="ident" id="5743801">n</span><span class="op" id="5743802">,</span>&nbsp;<span class="ident" id="5743804">p</span><span class="op" id="5743805">.</span><span class="ident" id="5743806">nodeSizes</span><span class="op" id="5743815">)</span><span class="op" id="5743816">;</span>&nbsp;<span class="ident" id="5743818">err</span>&nbsp;<span class="op" id="5743822">!=</span>&nbsp;<span class="ident" id="5743825">nil</span>&nbsp;<span class="op" id="5743829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743833">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5743841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743844">if</span>&nbsp;<span class="ident" id="5743847">buf</span><span class="op" id="5743850">.</span><span class="ident" id="5743851">Len</span><span class="op" id="5743854">(</span><span class="op" id="5743855">)</span>&nbsp;<span class="op" id="5743857">&lt;=</span>&nbsp;<span class="ident" id="5743860">maxSize</span>&nbsp;<span class="op" id="5743868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743872">for</span>&nbsp;<span class="ident" id="5743876">_</span><span class="op" id="5743877">,</span>&nbsp;<span class="ident" id="5743879">ch</span>&nbsp;<span class="op" id="5743882">:=</span>&nbsp;<span class="keyword" id="5743885">range</span>&nbsp;<span class="ident" id="5743891">buf</span><span class="op" id="5743894">.</span><span class="ident" id="5743895">Bytes</span><span class="op" id="5743900">(</span><span class="op" id="5743901">)</span>&nbsp;<span class="op" id="5743903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743908">if</span>&nbsp;<span class="ident" id="5743911">ch</span>&nbsp;<span class="op" id="5743914">&lt;</span>&nbsp;<span class="string" id="5743916">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5743920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743926">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5743936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5743940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5743944">size</span>&nbsp;<span class="op" id="5743949">=</span>&nbsp;<span class="ident" id="5743951">buf</span><span class="op" id="5743954">.</span><span class="ident" id="5743955">Len</span><span class="op" id="5743958">(</span><span class="op" id="5743959">)</span>&nbsp;<span class="comment" id="5743961">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5743973">p</span><span class="op" id="5743974">.</span><span class="ident" id="5743975">nodeSizes</span><span class="op" id="5743984">[</span><span class="ident" id="5743985">n</span><span class="op" id="5743986">]</span>&nbsp;<span class="op" id="5743988">=</span>&nbsp;<span class="ident" id="5743990">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5743996">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5743999">return</span><br>
<span class="lineno"></span><span class="op" id="5744006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5744009">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5744082">func</span>&nbsp;<span class="op" id="5744087">(</span><span class="ident" id="5744088">p</span>&nbsp;<span class="op" id="5744090">*</span><span class="ident" id="5744091">printer</span><span class="op" id="5744098">)</span>&nbsp;<span class="ident" id="5744100">bodySize</span><span class="op" id="5744108">(</span><span class="ident" id="5744109">b</span>&nbsp;<span class="op" id="5744111">*</span><span class="ident" id="5744112">ast</span><span class="op" id="5744115">.</span><span class="ident" id="5744116">BlockStmt</span><span class="op" id="5744125">,</span>&nbsp;<span class="ident" id="5744127">maxSize</span>&nbsp;<span class="builtintype" id="5744135">int</span><span class="op" id="5744138">)</span>&nbsp;<span class="builtintype" id="5744140">int</span>&nbsp;<span class="op" id="5744144">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5744147">pos1</span>&nbsp;<span class="op" id="5744152">:=</span>&nbsp;<span class="ident" id="5744155">b</span><span class="op" id="5744156">.</span><span class="ident" id="5744157">Pos</span><span class="op" id="5744160">(</span><span class="op" id="5744161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5744164">pos2</span>&nbsp;<span class="op" id="5744169">:=</span>&nbsp;<span class="ident" id="5744172">b</span><span class="op" id="5744173">.</span><span class="ident" id="5744174">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744182">if</span>&nbsp;<span class="ident" id="5744185">pos1</span><span class="op" id="5744189">.</span><span class="ident" id="5744190">IsValid</span><span class="op" id="5744197">(</span><span class="op" id="5744198">)</span>&nbsp;<span class="op" id="5744200">&amp;&amp;</span>&nbsp;<span class="ident" id="5744203">pos2</span><span class="op" id="5744207">.</span><span class="ident" id="5744208">IsValid</span><span class="op" id="5744215">(</span><span class="op" id="5744216">)</span>&nbsp;<span class="op" id="5744218">&amp;&amp;</span>&nbsp;<span class="ident" id="5744221">p</span><span class="op" id="5744222">.</span><span class="ident" id="5744223">lineFor</span><span class="op" id="5744230">(</span><span class="ident" id="5744231">pos1</span><span class="op" id="5744235">)</span>&nbsp;<span class="op" id="5744237">!=</span>&nbsp;<span class="ident" id="5744240">p</span><span class="op" id="5744241">.</span><span class="ident" id="5744242">lineFor</span><span class="op" id="5744249">(</span><span class="ident" id="5744250">pos2</span><span class="op" id="5744254">)</span>&nbsp;<span class="op" id="5744256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5744260">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744342">return</span>&nbsp;<span class="ident" id="5744349">maxSize</span>&nbsp;<span class="op" id="5744357">+</span>&nbsp;<span class="num" id="5744359">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5744362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744365">if</span>&nbsp;<span class="builtinfunc" id="5744368">len</span><span class="op" id="5744371">(</span><span class="ident" id="5744372">b</span><span class="op" id="5744373">.</span><span class="ident" id="5744374">List</span><span class="op" id="5744378">)</span>&nbsp;<span class="op" id="5744380">&gt;</span>&nbsp;<span class="num" id="5744382">5</span>&nbsp;<span class="op" id="5744384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5744388">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744441">return</span>&nbsp;<span class="ident" id="5744448">maxSize</span>&nbsp;<span class="op" id="5744456">+</span>&nbsp;<span class="num" id="5744458">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5744461">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5744464">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5744498">bodySize</span>&nbsp;<span class="op" id="5744507">:=</span>&nbsp;<span class="ident" id="5744510">p</span><span class="op" id="5744511">.</span><span class="ident" id="5744512">commentSizeBefore</span><span class="op" id="5744529">(</span><span class="ident" id="5744530">p</span><span class="op" id="5744531">.</span><span class="ident" id="5744532">posFor</span><span class="op" id="5744538">(</span><span class="ident" id="5744539">pos2</span><span class="op" id="5744543">)</span><span class="op" id="5744544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744547">for</span>&nbsp;<span class="ident" id="5744551">i</span><span class="op" id="5744552">,</span>&nbsp;<span class="ident" id="5744554">s</span>&nbsp;<span class="op" id="5744556">:=</span>&nbsp;<span class="keyword" id="5744559">range</span>&nbsp;<span class="ident" id="5744565">b</span><span class="op" id="5744566">.</span><span class="ident" id="5744567">List</span>&nbsp;<span class="op" id="5744572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744576">if</span>&nbsp;<span class="ident" id="5744579">bodySize</span>&nbsp;<span class="op" id="5744588">&gt;</span>&nbsp;<span class="ident" id="5744590">maxSize</span>&nbsp;<span class="op" id="5744598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744603">break</span>&nbsp;<span class="comment" id="5744609">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5744634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744638">if</span>&nbsp;<span class="ident" id="5744641">i</span>&nbsp;<span class="op" id="5744643">&gt;</span>&nbsp;<span class="num" id="5744645">0</span>&nbsp;<span class="op" id="5744647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5744652">bodySize</span>&nbsp;<span class="op" id="5744661">+=</span>&nbsp;<span class="num" id="5744664">2</span>&nbsp;<span class="comment" id="5744666">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5744703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5744707">bodySize</span>&nbsp;<span class="op" id="5744716">+=</span>&nbsp;<span class="ident" id="5744719">p</span><span class="op" id="5744720">.</span><span class="ident" id="5744721">nodeSize</span><span class="op" id="5744729">(</span><span class="ident" id="5744730">s</span><span class="op" id="5744731">,</span>&nbsp;<span class="ident" id="5744733">maxSize</span><span class="op" id="5744740">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5744743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5744746">return</span>&nbsp;<span class="ident" id="5744753">bodySize</span><br>
<span class="lineno"></span><span class="op" id="5744762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5744765">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="5744850">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="5744939">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5745028">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5745117">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5745206">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="5745263">//</span><br>
<span class="lineno"></span><span class="keyword" id="5745266">func</span>&nbsp;<span class="op" id="5745271">(</span><span class="ident" id="5745272">p</span>&nbsp;<span class="op" id="5745274">*</span><span class="ident" id="5745275">printer</span><span class="op" id="5745282">)</span>&nbsp;<span class="ident" id="5745284">adjBlock</span><span class="op" id="5745292">(</span><span class="ident" id="5745293">headerSize</span>&nbsp;<span class="builtintype" id="5745304">int</span><span class="op" id="5745307">,</span>&nbsp;<span class="ident" id="5745309">sep</span>&nbsp;<span class="ident" id="5745313">whiteSpace</span><span class="op" id="5745323">,</span>&nbsp;<span class="ident" id="5745325">b</span>&nbsp;<span class="op" id="5745327">*</span><span class="ident" id="5745328">ast</span><span class="op" id="5745331">.</span><span class="ident" id="5745332">BlockStmt</span><span class="op" id="5745341">)</span>&nbsp;<span class="op" id="5745343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745346">if</span>&nbsp;<span class="ident" id="5745349">b</span>&nbsp;<span class="op" id="5745351">==</span>&nbsp;<span class="ident" id="5745354">nil</span>&nbsp;<span class="op" id="5745358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745362">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745370">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745374">const</span>&nbsp;<span class="ident" id="5745380">maxSize</span>&nbsp;<span class="op" id="5745388">=</span>&nbsp;<span class="num" id="5745390">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745395">if</span>&nbsp;<span class="ident" id="5745398">headerSize</span><span class="op" id="5745408">+</span><span class="ident" id="5745409">p</span><span class="op" id="5745410">.</span><span class="ident" id="5745411">bodySize</span><span class="op" id="5745419">(</span><span class="ident" id="5745420">b</span><span class="op" id="5745421">,</span>&nbsp;<span class="ident" id="5745423">maxSize</span><span class="op" id="5745430">)</span>&nbsp;<span class="op" id="5745432">&lt;=</span>&nbsp;<span class="ident" id="5745435">maxSize</span>&nbsp;<span class="op" id="5745443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745447">p</span><span class="op" id="5745448">.</span><span class="builtinfunc" id="5745449">print</span><span class="op" id="5745454">(</span><span class="ident" id="5745455">sep</span><span class="op" id="5745458">,</span>&nbsp;<span class="ident" id="5745460">b</span><span class="op" id="5745461">.</span><span class="ident" id="5745462">Lbrace</span><span class="op" id="5745468">,</span>&nbsp;<span class="ident" id="5745470">token</span><span class="op" id="5745475">.</span><span class="ident" id="5745476">LBRACE</span><span class="op" id="5745482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745486">if</span>&nbsp;<span class="builtinfunc" id="5745489">len</span><span class="op" id="5745492">(</span><span class="ident" id="5745493">b</span><span class="op" id="5745494">.</span><span class="ident" id="5745495">List</span><span class="op" id="5745499">)</span>&nbsp;<span class="op" id="5745501">&gt;</span>&nbsp;<span class="num" id="5745503">0</span>&nbsp;<span class="op" id="5745505">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745510">p</span><span class="op" id="5745511">.</span><span class="builtinfunc" id="5745512">print</span><span class="op" id="5745517">(</span><span class="ident" id="5745518">blank</span><span class="op" id="5745523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745528">for</span>&nbsp;<span class="ident" id="5745532">i</span><span class="op" id="5745533">,</span>&nbsp;<span class="ident" id="5745535">s</span>&nbsp;<span class="op" id="5745537">:=</span>&nbsp;<span class="keyword" id="5745540">range</span>&nbsp;<span class="ident" id="5745546">b</span><span class="op" id="5745547">.</span><span class="ident" id="5745548">List</span>&nbsp;<span class="op" id="5745553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745559">if</span>&nbsp;<span class="ident" id="5745562">i</span>&nbsp;<span class="op" id="5745564">&gt;</span>&nbsp;<span class="num" id="5745566">0</span>&nbsp;<span class="op" id="5745568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745575">p</span><span class="op" id="5745576">.</span><span class="builtinfunc" id="5745577">print</span><span class="op" id="5745582">(</span><span class="ident" id="5745583">token</span><span class="op" id="5745588">.</span><span class="ident" id="5745589">SEMICOLON</span><span class="op" id="5745598">,</span>&nbsp;<span class="ident" id="5745600">blank</span><span class="op" id="5745605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745611">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745617">p</span><span class="op" id="5745618">.</span><span class="ident" id="5745619">stmt</span><span class="op" id="5745623">(</span><span class="ident" id="5745624">s</span><span class="op" id="5745625">,</span>&nbsp;<span class="ident" id="5745627">i</span>&nbsp;<span class="op" id="5745629">==</span>&nbsp;<span class="builtinfunc" id="5745632">len</span><span class="op" id="5745635">(</span><span class="ident" id="5745636">b</span><span class="op" id="5745637">.</span><span class="ident" id="5745638">List</span><span class="op" id="5745642">)</span><span class="op" id="5745643">-</span><span class="num" id="5745644">1</span><span class="op" id="5745645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745655">p</span><span class="op" id="5745656">.</span><span class="builtinfunc" id="5745657">print</span><span class="op" id="5745662">(</span><span class="ident" id="5745663">blank</span><span class="op" id="5745668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745676">p</span><span class="op" id="5745677">.</span><span class="builtinfunc" id="5745678">print</span><span class="op" id="5745683">(</span><span class="ident" id="5745684">noExtraLinebreak</span><span class="op" id="5745700">,</span>&nbsp;<span class="ident" id="5745702">b</span><span class="op" id="5745703">.</span><span class="ident" id="5745704">Rbrace</span><span class="op" id="5745710">,</span>&nbsp;<span class="ident" id="5745712">token</span><span class="op" id="5745717">.</span><span class="ident" id="5745718">RBRACE</span><span class="op" id="5745724">,</span>&nbsp;<span class="ident" id="5745726">noExtraLinebreak</span><span class="op" id="5745742">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745746">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5745758">if</span>&nbsp;<span class="ident" id="5745761">sep</span>&nbsp;<span class="op" id="5745765">!=</span>&nbsp;<span class="ident" id="5745768">ignore</span>&nbsp;<span class="op" id="5745775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745779">p</span><span class="op" id="5745780">.</span><span class="builtinfunc" id="5745781">print</span><span class="op" id="5745786">(</span><span class="ident" id="5745787">blank</span><span class="op" id="5745792">)</span>&nbsp;<span class="comment" id="5745794">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5745815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5745818">p</span><span class="op" id="5745819">.</span><span class="ident" id="5745820">block</span><span class="op" id="5745825">(</span><span class="ident" id="5745826">b</span><span class="op" id="5745827">,</span>&nbsp;<span class="num" id="5745829">1</span><span class="op" id="5745830">)</span><br>
<span class="lineno"></span><span class="op" id="5745832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5745835">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="5745917">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="5746001">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="5746041">func</span>&nbsp;<span class="op" id="5746046">(</span><span class="ident" id="5746047">p</span>&nbsp;<span class="op" id="5746049">*</span><span class="ident" id="5746050">printer</span><span class="op" id="5746057">)</span>&nbsp;<span class="ident" id="5746059">distanceFrom</span><span class="op" id="5746071">(</span><span class="ident" id="5746072">from</span>&nbsp;<span class="ident" id="5746077">token</span><span class="op" id="5746082">.</span><span class="ident" id="5746083">Pos</span><span class="op" id="5746086">)</span>&nbsp;<span class="builtintype" id="5746088">int</span>&nbsp;<span class="op" id="5746092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746095">if</span>&nbsp;<span class="ident" id="5746098">from</span><span class="op" id="5746102">.</span><span class="ident" id="5746103">IsValid</span><span class="op" id="5746110">(</span><span class="op" id="5746111">)</span>&nbsp;<span class="op" id="5746113">&amp;&amp;</span>&nbsp;<span class="ident" id="5746116">p</span><span class="op" id="5746117">.</span><span class="ident" id="5746118">pos</span><span class="op" id="5746121">.</span><span class="ident" id="5746122">IsValid</span><span class="op" id="5746129">(</span><span class="op" id="5746130">)</span>&nbsp;<span class="op" id="5746132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746136">if</span>&nbsp;<span class="ident" id="5746139">f</span>&nbsp;<span class="op" id="5746141">:=</span>&nbsp;<span class="ident" id="5746144">p</span><span class="op" id="5746145">.</span><span class="ident" id="5746146">posFor</span><span class="op" id="5746152">(</span><span class="ident" id="5746153">from</span><span class="op" id="5746157">)</span><span class="op" id="5746158">;</span>&nbsp;<span class="ident" id="5746160">f</span><span class="op" id="5746161">.</span><span class="ident" id="5746162">Line</span>&nbsp;<span class="op" id="5746167">==</span>&nbsp;<span class="ident" id="5746170">p</span><span class="op" id="5746171">.</span><span class="ident" id="5746172">pos</span><span class="op" id="5746175">.</span><span class="ident" id="5746176">Line</span>&nbsp;<span class="op" id="5746181">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746186">return</span>&nbsp;<span class="ident" id="5746193">p</span><span class="op" id="5746194">.</span><span class="ident" id="5746195">pos</span><span class="op" id="5746198">.</span><span class="ident" id="5746199">Column</span>&nbsp;<span class="op" id="5746206">-</span>&nbsp;<span class="ident" id="5746208">f</span><span class="op" id="5746209">.</span><span class="ident" id="5746210">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5746219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5746222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746225">return</span>&nbsp;<span class="ident" id="5746232">infinity</span><br>
<span class="lineno"></span><span class="op" id="5746241">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="5746244">func</span>&nbsp;<span class="op" id="5746249">(</span><span class="ident" id="5746250">p</span>&nbsp;<span class="op" id="5746252">*</span><span class="ident" id="5746253">printer</span><span class="op" id="5746260">)</span>&nbsp;<span class="ident" id="5746262">funcDecl</span><span class="op" id="5746270">(</span><span class="ident" id="5746271">d</span>&nbsp;<span class="op" id="5746273">*</span><span class="ident" id="5746274">ast</span><span class="op" id="5746277">.</span><span class="ident" id="5746278">FuncDecl</span><span class="op" id="5746286">)</span>&nbsp;<span class="op" id="5746288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746291">p</span><span class="op" id="5746292">.</span><span class="ident" id="5746293">setComment</span><span class="op" id="5746303">(</span><span class="ident" id="5746304">d</span><span class="op" id="5746305">.</span><span class="ident" id="5746306">Doc</span><span class="op" id="5746309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746312">p</span><span class="op" id="5746313">.</span><span class="builtinfunc" id="5746314">print</span><span class="op" id="5746319">(</span><span class="ident" id="5746320">d</span><span class="op" id="5746321">.</span><span class="ident" id="5746322">Pos</span><span class="op" id="5746325">(</span><span class="op" id="5746326">)</span><span class="op" id="5746327">,</span>&nbsp;<span class="ident" id="5746329">token</span><span class="op" id="5746334">.</span><span class="ident" id="5746335">FUNC</span><span class="op" id="5746339">,</span>&nbsp;<span class="ident" id="5746341">blank</span><span class="op" id="5746346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746349">if</span>&nbsp;<span class="ident" id="5746352">d</span><span class="op" id="5746353">.</span><span class="ident" id="5746354">Recv</span>&nbsp;<span class="op" id="5746359">!=</span>&nbsp;<span class="ident" id="5746362">nil</span>&nbsp;<span class="op" id="5746366">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746370">p</span><span class="op" id="5746371">.</span><span class="ident" id="5746372">parameters</span><span class="op" id="5746382">(</span><span class="ident" id="5746383">d</span><span class="op" id="5746384">.</span><span class="ident" id="5746385">Recv</span><span class="op" id="5746389">)</span>&nbsp;<span class="comment" id="5746391">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746419">p</span><span class="op" id="5746420">.</span><span class="builtinfunc" id="5746421">print</span><span class="op" id="5746426">(</span><span class="ident" id="5746427">blank</span><span class="op" id="5746432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5746435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746438">p</span><span class="op" id="5746439">.</span><span class="ident" id="5746440">expr</span><span class="op" id="5746444">(</span><span class="ident" id="5746445">d</span><span class="op" id="5746446">.</span><span class="ident" id="5746447">Name</span><span class="op" id="5746451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746454">p</span><span class="op" id="5746455">.</span><span class="ident" id="5746456">signature</span><span class="op" id="5746465">(</span><span class="ident" id="5746466">d</span><span class="op" id="5746467">.</span><span class="ident" id="5746468">Type</span><span class="op" id="5746472">.</span><span class="ident" id="5746473">Params</span><span class="op" id="5746479">,</span>&nbsp;<span class="ident" id="5746481">d</span><span class="op" id="5746482">.</span><span class="ident" id="5746483">Type</span><span class="op" id="5746487">.</span><span class="ident" id="5746488">Results</span><span class="op" id="5746495">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746498">p</span><span class="op" id="5746499">.</span><span class="ident" id="5746500">adjBlock</span><span class="op" id="5746508">(</span><span class="ident" id="5746509">p</span><span class="op" id="5746510">.</span><span class="ident" id="5746511">distanceFrom</span><span class="op" id="5746523">(</span><span class="ident" id="5746524">d</span><span class="op" id="5746525">.</span><span class="ident" id="5746526">Pos</span><span class="op" id="5746529">(</span><span class="op" id="5746530">)</span><span class="op" id="5746531">)</span><span class="op" id="5746532">,</span>&nbsp;<span class="ident" id="5746534">vtab</span><span class="op" id="5746538">,</span>&nbsp;<span class="ident" id="5746540">d</span><span class="op" id="5746541">.</span><span class="ident" id="5746542">Body</span><span class="op" id="5746546">)</span><br>
<span class="lineno"></span><span class="op" id="5746548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5746551">func</span>&nbsp;<span class="op" id="5746556">(</span><span class="ident" id="5746557">p</span>&nbsp;<span class="op" id="5746559">*</span><span class="ident" id="5746560">printer</span><span class="op" id="5746567">)</span>&nbsp;<span class="ident" id="5746569">decl</span><span class="op" id="5746573">(</span><span class="ident" id="5746574">decl</span>&nbsp;<span class="ident" id="5746579">ast</span><span class="op" id="5746582">.</span><span class="ident" id="5746583">Decl</span><span class="op" id="5746587">)</span>&nbsp;<span class="op" id="5746589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746592">switch</span>&nbsp;<span class="ident" id="5746599">d</span>&nbsp;<span class="op" id="5746601">:=</span>&nbsp;<span class="ident" id="5746604">decl</span><span class="op" id="5746608">.</span><span class="op" id="5746609">(</span><span class="keyword" id="5746610">type</span><span class="op" id="5746614">)</span>&nbsp;<span class="op" id="5746616">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746619">case</span>&nbsp;<span class="op" id="5746624">*</span><span class="ident" id="5746625">ast</span><span class="op" id="5746628">.</span><span class="ident" id="5746629">BadDecl</span><span class="op" id="5746636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746640">p</span><span class="op" id="5746641">.</span><span class="builtinfunc" id="5746642">print</span><span class="op" id="5746647">(</span><span class="ident" id="5746648">d</span><span class="op" id="5746649">.</span><span class="ident" id="5746650">Pos</span><span class="op" id="5746653">(</span><span class="op" id="5746654">)</span><span class="op" id="5746655">,</span>&nbsp;<span class="string" id="5746657">&#34;BadDecl&#34;</span><span class="op" id="5746666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746669">case</span>&nbsp;<span class="op" id="5746674">*</span><span class="ident" id="5746675">ast</span><span class="op" id="5746678">.</span><span class="ident" id="5746679">GenDecl</span><span class="op" id="5746686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746690">p</span><span class="op" id="5746691">.</span><span class="ident" id="5746692">genDecl</span><span class="op" id="5746699">(</span><span class="ident" id="5746700">d</span><span class="op" id="5746701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746704">case</span>&nbsp;<span class="op" id="5746709">*</span><span class="ident" id="5746710">ast</span><span class="op" id="5746713">.</span><span class="ident" id="5746714">FuncDecl</span><span class="op" id="5746722">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746726">p</span><span class="op" id="5746727">.</span><span class="ident" id="5746728">funcDecl</span><span class="op" id="5746736">(</span><span class="ident" id="5746737">d</span><span class="op" id="5746738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746741">default</span><span class="op" id="5746748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5746752">panic</span><span class="op" id="5746757">(</span><span class="string" id="5746758">&#34;unreachable&#34;</span><span class="op" id="5746771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5746774">}</span><br>
<span class="lineno"></span><span class="op" id="5746776">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="5746779">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5746859">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5746869">func</span>&nbsp;<span class="ident" id="5746874">declToken</span><span class="op" id="5746883">(</span><span class="ident" id="5746884">decl</span>&nbsp;<span class="ident" id="5746889">ast</span><span class="op" id="5746892">.</span><span class="ident" id="5746893">Decl</span><span class="op" id="5746897">)</span>&nbsp;<span class="op" id="5746899">(</span><span class="ident" id="5746900">tok</span>&nbsp;<span class="ident" id="5746904">token</span><span class="op" id="5746909">.</span><span class="ident" id="5746910">Token</span><span class="op" id="5746915">)</span>&nbsp;<span class="op" id="5746917">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746920">tok</span>&nbsp;<span class="op" id="5746924">=</span>&nbsp;<span class="ident" id="5746926">token</span><span class="op" id="5746931">.</span><span class="ident" id="5746932">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746941">switch</span>&nbsp;<span class="ident" id="5746948">d</span>&nbsp;<span class="op" id="5746950">:=</span>&nbsp;<span class="ident" id="5746953">decl</span><span class="op" id="5746957">.</span><span class="op" id="5746958">(</span><span class="keyword" id="5746959">type</span><span class="op" id="5746963">)</span>&nbsp;<span class="op" id="5746965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5746968">case</span>&nbsp;<span class="op" id="5746973">*</span><span class="ident" id="5746974">ast</span><span class="op" id="5746977">.</span><span class="ident" id="5746978">GenDecl</span><span class="op" id="5746985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5746989">tok</span>&nbsp;<span class="op" id="5746993">=</span>&nbsp;<span class="ident" id="5746995">d</span><span class="op" id="5746996">.</span><span class="ident" id="5746997">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5747002">case</span>&nbsp;<span class="op" id="5747007">*</span><span class="ident" id="5747008">ast</span><span class="op" id="5747011">.</span><span class="ident" id="5747012">FuncDecl</span><span class="op" id="5747020">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747024">tok</span>&nbsp;<span class="op" id="5747028">=</span>&nbsp;<span class="ident" id="5747030">token</span><span class="op" id="5747035">.</span><span class="ident" id="5747036">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5747042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5747045">return</span><br>
<span class="lineno"></span><span class="op" id="5747052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="5747055">func</span>&nbsp;<span class="op" id="5747060">(</span><span class="ident" id="5747061">p</span>&nbsp;<span class="op" id="5747063">*</span><span class="ident" id="5747064">printer</span><span class="op" id="5747071">)</span>&nbsp;<span class="ident" id="5747073">declList</span><span class="op" id="5747081">(</span><span class="ident" id="5747082">list</span>&nbsp;<span class="op" id="5747087">[</span><span class="op" id="5747088">]</span><span class="ident" id="5747089">ast</span><span class="op" id="5747092">.</span><span class="ident" id="5747093">Decl</span><span class="op" id="5747097">)</span>&nbsp;<span class="op" id="5747099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747102">tok</span>&nbsp;<span class="op" id="5747106">:=</span>&nbsp;<span class="ident" id="5747109">token</span><span class="op" id="5747114">.</span><span class="ident" id="5747115">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5747124">for</span>&nbsp;<span class="ident" id="5747128">_</span><span class="op" id="5747129">,</span>&nbsp;<span class="ident" id="5747131">d</span>&nbsp;<span class="op" id="5747133">:=</span>&nbsp;<span class="keyword" id="5747136">range</span>&nbsp;<span class="ident" id="5747142">list</span>&nbsp;<span class="op" id="5747147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747151">prev</span>&nbsp;<span class="op" id="5747156">:=</span>&nbsp;<span class="ident" id="5747159">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747165">tok</span>&nbsp;<span class="op" id="5747169">=</span>&nbsp;<span class="ident" id="5747171">declToken</span><span class="op" id="5747180">(</span><span class="ident" id="5747181">d</span><span class="op" id="5747182">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747186">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747251">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747318">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747375">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747441">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747510">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747577">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5747634">if</span>&nbsp;<span class="builtinfunc" id="5747637">len</span><span class="op" id="5747640">(</span><span class="ident" id="5747641">p</span><span class="op" id="5747642">.</span><span class="ident" id="5747643">output</span><span class="op" id="5747649">)</span>&nbsp;<span class="op" id="5747651">&gt;</span>&nbsp;<span class="num" id="5747653">0</span>&nbsp;<span class="op" id="5747655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747660">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5747733">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747790">min</span>&nbsp;<span class="op" id="5747794">:=</span>&nbsp;<span class="num" id="5747797">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5747802">if</span>&nbsp;<span class="ident" id="5747805">prev</span>&nbsp;<span class="op" id="5747810">!=</span>&nbsp;<span class="ident" id="5747813">tok</span>&nbsp;<span class="op" id="5747817">||</span>&nbsp;<span class="ident" id="5747820">getDoc</span><span class="op" id="5747826">(</span><span class="ident" id="5747827">d</span><span class="op" id="5747828">)</span>&nbsp;<span class="op" id="5747830">!=</span>&nbsp;<span class="ident" id="5747833">nil</span>&nbsp;<span class="op" id="5747837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747843">min</span>&nbsp;<span class="op" id="5747847">=</span>&nbsp;<span class="num" id="5747849">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5747854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747859">p</span><span class="op" id="5747860">.</span><span class="ident" id="5747861">linebreak</span><span class="op" id="5747870">(</span><span class="ident" id="5747871">p</span><span class="op" id="5747872">.</span><span class="ident" id="5747873">lineFor</span><span class="op" id="5747880">(</span><span class="ident" id="5747881">d</span><span class="op" id="5747882">.</span><span class="ident" id="5747883">Pos</span><span class="op" id="5747886">(</span><span class="op" id="5747887">)</span><span class="op" id="5747888">)</span><span class="op" id="5747889">,</span>&nbsp;<span class="ident" id="5747891">min</span><span class="op" id="5747894">,</span>&nbsp;<span class="ident" id="5747896">ignore</span><span class="op" id="5747902">,</span>&nbsp;<span class="ident" id="5747904">false</span><span class="op" id="5747909">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5747913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747917">p</span><span class="op" id="5747918">.</span><span class="ident" id="5747919">decl</span><span class="op" id="5747923">(</span><span class="ident" id="5747924">d</span><span class="op" id="5747925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5747928">}</span><br>
<span class="lineno"></span><span class="op" id="5747930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="5747933">func</span>&nbsp;<span class="op" id="5747938">(</span><span class="ident" id="5747939">p</span>&nbsp;<span class="op" id="5747941">*</span><span class="ident" id="5747942">printer</span><span class="op" id="5747949">)</span>&nbsp;<span class="ident" id="5747951">file</span><span class="op" id="5747955">(</span><span class="ident" id="5747956">src</span>&nbsp;<span class="op" id="5747960">*</span><span class="ident" id="5747961">ast</span><span class="op" id="5747964">.</span><span class="ident" id="5747965">File</span><span class="op" id="5747969">)</span>&nbsp;<span class="op" id="5747971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747974">p</span><span class="op" id="5747975">.</span><span class="ident" id="5747976">setComment</span><span class="op" id="5747986">(</span><span class="ident" id="5747987">src</span><span class="op" id="5747990">.</span><span class="ident" id="5747991">Doc</span><span class="op" id="5747994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5747997">p</span><span class="op" id="5747998">.</span><span class="builtinfunc" id="5747999">print</span><span class="op" id="5748004">(</span><span class="ident" id="5748005">src</span><span class="op" id="5748008">.</span><span class="ident" id="5748009">Pos</span><span class="op" id="5748012">(</span><span class="op" id="5748013">)</span><span class="op" id="5748014">,</span>&nbsp;<span class="ident" id="5748016">token</span><span class="op" id="5748021">.</span><span class="ident" id="5748022">PACKAGE</span><span class="op" id="5748029">,</span>&nbsp;<span class="ident" id="5748031">blank</span><span class="op" id="5748036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5748039">p</span><span class="op" id="5748040">.</span><span class="ident" id="5748041">expr</span><span class="op" id="5748045">(</span><span class="ident" id="5748046">src</span><span class="op" id="5748049">.</span><span class="ident" id="5748050">Name</span><span class="op" id="5748054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5748057">p</span><span class="op" id="5748058">.</span><span class="ident" id="5748059">declList</span><span class="op" id="5748067">(</span><span class="ident" id="5748068">src</span><span class="op" id="5748071">.</span><span class="ident" id="5748072">Decls</span><span class="op" id="5748077">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5748080">p</span><span class="op" id="5748081">.</span><span class="builtinfunc" id="5748082">print</span><span class="op" id="5748087">(</span><span class="ident" id="5748088">newline</span><span class="op" id="5748095">)</span><br>
<span class="lineno"></span><span class="op" id="5748097">}</span>
</div>
</body>
</html>
