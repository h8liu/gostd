<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5694589">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5694644">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5694698">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5694749">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5694825">package</span>&nbsp;<span class="ident" id="5694833">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694841">import</span>&nbsp;<span class="op" id="5694848">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5694851">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5694861">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5694866">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5694869">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5694919">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5694970">func</span>&nbsp;<span class="ident" id="5694975">OneByteReader</span><span class="op" id="5694988">(</span><span class="ident" id="5694989">r</span>&nbsp;<span class="ident" id="5694991">io</span><span class="op" id="5694993">.</span><span class="ident" id="5694994">Reader</span><span class="op" id="5695000">)</span>&nbsp;<span class="ident" id="5695002">io</span><span class="op" id="5695004">.</span><span class="ident" id="5695005">Reader</span>&nbsp;<span class="op" id="5695012">{</span>&nbsp;<span class="keyword" id="5695014">return</span>&nbsp;<span class="op" id="5695021">&amp;</span><span class="ident" id="5695022">oneByteReader</span><span class="op" id="5695035">{</span><span class="ident" id="5695036">r</span><span class="op" id="5695037">}</span>&nbsp;<span class="op" id="5695039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695042">type</span>&nbsp;<span class="ident" id="5695047">oneByteReader</span>&nbsp;<span class="keyword" id="5695061">struct</span>&nbsp;<span class="op" id="5695068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695071">r</span>&nbsp;<span class="ident" id="5695073">io</span><span class="op" id="5695075">.</span><span class="ident" id="5695076">Reader</span><br>
<span class="lineno"></span><span class="op" id="5695083">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5695086">func</span>&nbsp;<span class="op" id="5695091">(</span><span class="ident" id="5695092">r</span>&nbsp;<span class="op" id="5695094">*</span><span class="ident" id="5695095">oneByteReader</span><span class="op" id="5695108">)</span>&nbsp;<span class="ident" id="5695110">Read</span><span class="op" id="5695114">(</span><span class="ident" id="5695115">p</span>&nbsp;<span class="op" id="5695117">[</span><span class="op" id="5695118">]</span><span class="builtintype" id="5695119">byte</span><span class="op" id="5695123">)</span>&nbsp;<span class="op" id="5695125">(</span><span class="builtintype" id="5695126">int</span><span class="op" id="5695129">,</span>&nbsp;<span class="builtintype" id="5695131">error</span><span class="op" id="5695136">)</span>&nbsp;<span class="op" id="5695138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695141">if</span>&nbsp;<span class="builtinfunc" id="5695144">len</span><span class="op" id="5695147">(</span><span class="ident" id="5695148">p</span><span class="op" id="5695149">)</span>&nbsp;<span class="op" id="5695151">==</span>&nbsp;<span class="num" id="5695154">0</span>&nbsp;<span class="op" id="5695156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695160">return</span>&nbsp;<span class="num" id="5695167">0</span><span class="op" id="5695168">,</span>&nbsp;<span class="builtintype" id="5695170">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695175">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695178">return</span>&nbsp;<span class="ident" id="5695185">r</span><span class="op" id="5695186">.</span><span class="ident" id="5695187">r</span><span class="op" id="5695188">.</span><span class="ident" id="5695189">Read</span><span class="op" id="5695193">(</span><span class="ident" id="5695194">p</span><span class="op" id="5695195">[</span><span class="num" id="5695196">0</span><span class="op" id="5695197">:</span><span class="num" id="5695198">1</span><span class="op" id="5695199">]</span><span class="op" id="5695200">)</span><br>
<span class="lineno"></span><span class="op" id="5695202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5695205">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5695257">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5695308">func</span>&nbsp;<span class="ident" id="5695313">HalfReader</span><span class="op" id="5695323">(</span><span class="ident" id="5695324">r</span>&nbsp;<span class="ident" id="5695326">io</span><span class="op" id="5695328">.</span><span class="ident" id="5695329">Reader</span><span class="op" id="5695335">)</span>&nbsp;<span class="ident" id="5695337">io</span><span class="op" id="5695339">.</span><span class="ident" id="5695340">Reader</span>&nbsp;<span class="op" id="5695347">{</span>&nbsp;<span class="keyword" id="5695349">return</span>&nbsp;<span class="op" id="5695356">&amp;</span><span class="ident" id="5695357">halfReader</span><span class="op" id="5695367">{</span><span class="ident" id="5695368">r</span><span class="op" id="5695369">}</span>&nbsp;<span class="op" id="5695371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695374">type</span>&nbsp;<span class="ident" id="5695379">halfReader</span>&nbsp;<span class="keyword" id="5695390">struct</span>&nbsp;<span class="op" id="5695397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695400">r</span>&nbsp;<span class="ident" id="5695402">io</span><span class="op" id="5695404">.</span><span class="ident" id="5695405">Reader</span><br>
<span class="lineno"></span><span class="op" id="5695412">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5695415">func</span>&nbsp;<span class="op" id="5695420">(</span><span class="ident" id="5695421">r</span>&nbsp;<span class="op" id="5695423">*</span><span class="ident" id="5695424">halfReader</span><span class="op" id="5695434">)</span>&nbsp;<span class="ident" id="5695436">Read</span><span class="op" id="5695440">(</span><span class="ident" id="5695441">p</span>&nbsp;<span class="op" id="5695443">[</span><span class="op" id="5695444">]</span><span class="builtintype" id="5695445">byte</span><span class="op" id="5695449">)</span>&nbsp;<span class="op" id="5695451">(</span><span class="builtintype" id="5695452">int</span><span class="op" id="5695455">,</span>&nbsp;<span class="builtintype" id="5695457">error</span><span class="op" id="5695462">)</span>&nbsp;<span class="op" id="5695464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695467">return</span>&nbsp;<span class="ident" id="5695474">r</span><span class="op" id="5695475">.</span><span class="ident" id="5695476">r</span><span class="op" id="5695477">.</span><span class="ident" id="5695478">Read</span><span class="op" id="5695482">(</span><span class="ident" id="5695483">p</span><span class="op" id="5695484">[</span><span class="num" id="5695485">0</span>&nbsp;<span class="op" id="5695487">:</span>&nbsp;<span class="op" id="5695489">(</span><span class="builtinfunc" id="5695490">len</span><span class="op" id="5695493">(</span><span class="ident" id="5695494">p</span><span class="op" id="5695495">)</span><span class="op" id="5695496">+</span><span class="num" id="5695497">1</span><span class="op" id="5695498">)</span><span class="op" id="5695499">/</span><span class="num" id="5695500">2</span><span class="op" id="5695501">]</span><span class="op" id="5695502">)</span><br>
<span class="lineno"></span><span class="op" id="5695504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5695507">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5695584">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5695662">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5695738">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5695816">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5695862">func</span>&nbsp;<span class="ident" id="5695867">DataErrReader</span><span class="op" id="5695880">(</span><span class="ident" id="5695881">r</span>&nbsp;<span class="ident" id="5695883">io</span><span class="op" id="5695885">.</span><span class="ident" id="5695886">Reader</span><span class="op" id="5695892">)</span>&nbsp;<span class="ident" id="5695894">io</span><span class="op" id="5695896">.</span><span class="ident" id="5695897">Reader</span>&nbsp;<span class="op" id="5695904">{</span>&nbsp;<span class="keyword" id="5695906">return</span>&nbsp;<span class="op" id="5695913">&amp;</span><span class="ident" id="5695914">dataErrReader</span><span class="op" id="5695927">{</span><span class="ident" id="5695928">r</span><span class="op" id="5695929">,</span>&nbsp;<span class="builtintype" id="5695931">nil</span><span class="op" id="5695934">,</span>&nbsp;<span class="builtinfunc" id="5695936">make</span><span class="op" id="5695940">(</span><span class="op" id="5695941">[</span><span class="op" id="5695942">]</span><span class="builtintype" id="5695943">byte</span><span class="op" id="5695947">,</span>&nbsp;<span class="num" id="5695949">1024</span><span class="op" id="5695953">)</span><span class="op" id="5695954">}</span>&nbsp;<span class="op" id="5695956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695959">type</span>&nbsp;<span class="ident" id="5695964">dataErrReader</span>&nbsp;<span class="keyword" id="5695978">struct</span>&nbsp;<span class="op" id="5695985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695988">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695995">io</span><span class="op" id="5695997">.</span><span class="ident" id="5695998">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696006">unread</span>&nbsp;<span class="op" id="5696013">[</span><span class="op" id="5696014">]</span><span class="builtintype" id="5696015">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696021">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5696028">[</span><span class="op" id="5696029">]</span><span class="builtintype" id="5696030">byte</span><br>
<span class="lineno"></span><span class="op" id="5696035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5696038">func</span>&nbsp;<span class="op" id="5696043">(</span><span class="ident" id="5696044">r</span>&nbsp;<span class="op" id="5696046">*</span><span class="ident" id="5696047">dataErrReader</span><span class="op" id="5696060">)</span>&nbsp;<span class="ident" id="5696062">Read</span><span class="op" id="5696066">(</span><span class="ident" id="5696067">p</span>&nbsp;<span class="op" id="5696069">[</span><span class="op" id="5696070">]</span><span class="builtintype" id="5696071">byte</span><span class="op" id="5696075">)</span>&nbsp;<span class="op" id="5696077">(</span><span class="ident" id="5696078">n</span>&nbsp;<span class="builtintype" id="5696080">int</span><span class="op" id="5696083">,</span>&nbsp;<span class="ident" id="5696085">err</span>&nbsp;<span class="builtintype" id="5696089">error</span><span class="op" id="5696094">)</span>&nbsp;<span class="op" id="5696096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696099">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696144">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696199">for</span>&nbsp;<span class="op" id="5696203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696207">if</span>&nbsp;<span class="builtinfunc" id="5696210">len</span><span class="op" id="5696213">(</span><span class="ident" id="5696214">r</span><span class="op" id="5696215">.</span><span class="ident" id="5696216">unread</span><span class="op" id="5696222">)</span>&nbsp;<span class="op" id="5696224">==</span>&nbsp;<span class="num" id="5696227">0</span>&nbsp;<span class="op" id="5696229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696234">n1</span><span class="op" id="5696236">,</span>&nbsp;<span class="ident" id="5696238">err1</span>&nbsp;<span class="op" id="5696243">:=</span>&nbsp;<span class="ident" id="5696246">r</span><span class="op" id="5696247">.</span><span class="ident" id="5696248">r</span><span class="op" id="5696249">.</span><span class="ident" id="5696250">Read</span><span class="op" id="5696254">(</span><span class="ident" id="5696255">r</span><span class="op" id="5696256">.</span><span class="ident" id="5696257">data</span><span class="op" id="5696261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696266">r</span><span class="op" id="5696267">.</span><span class="ident" id="5696268">unread</span>&nbsp;<span class="op" id="5696275">=</span>&nbsp;<span class="ident" id="5696277">r</span><span class="op" id="5696278">.</span><span class="ident" id="5696279">data</span><span class="op" id="5696283">[</span><span class="num" id="5696284">0</span><span class="op" id="5696285">:</span><span class="ident" id="5696286">n1</span><span class="op" id="5696288">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696293">err</span>&nbsp;<span class="op" id="5696297">=</span>&nbsp;<span class="ident" id="5696299">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696310">if</span>&nbsp;<span class="ident" id="5696313">n</span>&nbsp;<span class="op" id="5696315">&gt;</span>&nbsp;<span class="num" id="5696317">0</span>&nbsp;<span class="op" id="5696319">||</span>&nbsp;<span class="ident" id="5696322">err</span>&nbsp;<span class="op" id="5696326">!=</span>&nbsp;<span class="builtintype" id="5696329">nil</span>&nbsp;<span class="op" id="5696333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696338">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696346">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696350">n</span>&nbsp;<span class="op" id="5696352">=</span>&nbsp;<span class="builtinfunc" id="5696354">copy</span><span class="op" id="5696358">(</span><span class="ident" id="5696359">p</span><span class="op" id="5696360">,</span>&nbsp;<span class="ident" id="5696362">r</span><span class="op" id="5696363">.</span><span class="ident" id="5696364">unread</span><span class="op" id="5696370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696374">r</span><span class="op" id="5696375">.</span><span class="ident" id="5696376">unread</span>&nbsp;<span class="op" id="5696383">=</span>&nbsp;<span class="ident" id="5696385">r</span><span class="op" id="5696386">.</span><span class="ident" id="5696387">unread</span><span class="op" id="5696393">[</span><span class="ident" id="5696394">n</span><span class="op" id="5696395">:</span><span class="op" id="5696396">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696402">return</span><br>
<span class="lineno"></span><span class="op" id="5696409">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5696412">var</span>&nbsp;<span class="ident" id="5696416">ErrTimeout</span>&nbsp;<span class="op" id="5696427">=</span>&nbsp;<span class="ident" id="5696429">errors</span><span class="op" id="5696435">.</span><span class="ident" id="5696436">New</span><span class="op" id="5696439">(</span><span class="string" id="5696440">&#34;timeout&#34;</span><span class="op" id="5696449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5696452">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5696507">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5696559">func</span>&nbsp;<span class="ident" id="5696564">TimeoutReader</span><span class="op" id="5696577">(</span><span class="ident" id="5696578">r</span>&nbsp;<span class="ident" id="5696580">io</span><span class="op" id="5696582">.</span><span class="ident" id="5696583">Reader</span><span class="op" id="5696589">)</span>&nbsp;<span class="ident" id="5696591">io</span><span class="op" id="5696593">.</span><span class="ident" id="5696594">Reader</span>&nbsp;<span class="op" id="5696601">{</span>&nbsp;<span class="keyword" id="5696603">return</span>&nbsp;<span class="op" id="5696610">&amp;</span><span class="ident" id="5696611">timeoutReader</span><span class="op" id="5696624">{</span><span class="ident" id="5696625">r</span><span class="op" id="5696626">,</span>&nbsp;<span class="num" id="5696628">0</span><span class="op" id="5696629">}</span>&nbsp;<span class="op" id="5696631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5696634">type</span>&nbsp;<span class="ident" id="5696639">timeoutReader</span>&nbsp;<span class="keyword" id="5696653">struct</span>&nbsp;<span class="op" id="5696660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696663">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696669">io</span><span class="op" id="5696671">.</span><span class="ident" id="5696672">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696680">count</span>&nbsp;<span class="builtintype" id="5696686">int</span><br>
<span class="lineno">80</span><span class="op" id="5696690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5696693">func</span>&nbsp;<span class="op" id="5696698">(</span><span class="ident" id="5696699">r</span>&nbsp;<span class="op" id="5696701">*</span><span class="ident" id="5696702">timeoutReader</span><span class="op" id="5696715">)</span>&nbsp;<span class="ident" id="5696717">Read</span><span class="op" id="5696721">(</span><span class="ident" id="5696722">p</span>&nbsp;<span class="op" id="5696724">[</span><span class="op" id="5696725">]</span><span class="builtintype" id="5696726">byte</span><span class="op" id="5696730">)</span>&nbsp;<span class="op" id="5696732">(</span><span class="builtintype" id="5696733">int</span><span class="op" id="5696736">,</span>&nbsp;<span class="builtintype" id="5696738">error</span><span class="op" id="5696743">)</span>&nbsp;<span class="op" id="5696745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696748">r</span><span class="op" id="5696749">.</span><span class="ident" id="5696750">count</span><span class="op" id="5696755">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696759">if</span>&nbsp;<span class="ident" id="5696762">r</span><span class="op" id="5696763">.</span><span class="ident" id="5696764">count</span>&nbsp;<span class="op" id="5696770">==</span>&nbsp;<span class="num" id="5696773">2</span>&nbsp;<span class="op" id="5696775">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696779">return</span>&nbsp;<span class="num" id="5696786">0</span><span class="op" id="5696787">,</span>&nbsp;<span class="ident" id="5696789">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696804">return</span>&nbsp;<span class="ident" id="5696811">r</span><span class="op" id="5696812">.</span><span class="ident" id="5696813">r</span><span class="op" id="5696814">.</span><span class="ident" id="5696815">Read</span><span class="op" id="5696819">(</span><span class="ident" id="5696820">p</span><span class="op" id="5696821">)</span><br>
<span class="lineno"></span><span class="op" id="5696823">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
