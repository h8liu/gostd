<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html" class="current">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6940349">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6940404">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6940458">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6940509">package</span>&nbsp;<span class="ident" id="6940517">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6940522">import</span>&nbsp;<span class="op" id="6940529">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6940532">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6940541">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6940554">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6940564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6940567">func</span>&nbsp;<span class="ident" id="6940572">slowAbs</span><span class="op" id="6940579">(</span><span class="ident" id="6940580">x</span>&nbsp;<span class="builtintype" id="6940582">int</span><span class="op" id="6940585">)</span>&nbsp;<span class="builtintype" id="6940587">int</span>&nbsp;<span class="op" id="6940591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940594">if</span>&nbsp;<span class="ident" id="6940597">x</span>&nbsp;<span class="op" id="6940599">&lt;</span>&nbsp;<span class="num" id="6940601">0</span>&nbsp;<span class="op" id="6940603">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940607">return</span>&nbsp;<span class="op" id="6940614">-</span><span class="ident" id="6940615">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940621">return</span>&nbsp;<span class="ident" id="6940628">x</span><br>
<span class="lineno"></span><span class="op" id="6940630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6940633">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="6940705">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="6940779">func</span>&nbsp;<span class="ident" id="6940784">slowPaeth</span><span class="op" id="6940793">(</span><span class="ident" id="6940794">a</span><span class="op" id="6940795">,</span>&nbsp;<span class="ident" id="6940797">b</span><span class="op" id="6940798">,</span>&nbsp;<span class="ident" id="6940800">c</span>&nbsp;<span class="builtintype" id="6940802">uint8</span><span class="op" id="6940807">)</span>&nbsp;<span class="builtintype" id="6940809">uint8</span>&nbsp;<span class="op" id="6940815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940818">p</span>&nbsp;<span class="op" id="6940820">:=</span>&nbsp;<span class="builtintype" id="6940823">int</span><span class="op" id="6940826">(</span><span class="ident" id="6940827">a</span><span class="op" id="6940828">)</span>&nbsp;<span class="op" id="6940830">+</span>&nbsp;<span class="builtintype" id="6940832">int</span><span class="op" id="6940835">(</span><span class="ident" id="6940836">b</span><span class="op" id="6940837">)</span>&nbsp;<span class="op" id="6940839">-</span>&nbsp;<span class="builtintype" id="6940841">int</span><span class="op" id="6940844">(</span><span class="ident" id="6940845">c</span><span class="op" id="6940846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940849">pa</span>&nbsp;<span class="op" id="6940852">:=</span>&nbsp;<span class="ident" id="6940855">slowAbs</span><span class="op" id="6940862">(</span><span class="ident" id="6940863">p</span>&nbsp;<span class="op" id="6940865">-</span>&nbsp;<span class="builtintype" id="6940867">int</span><span class="op" id="6940870">(</span><span class="ident" id="6940871">a</span><span class="op" id="6940872">)</span><span class="op" id="6940873">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940876">pb</span>&nbsp;<span class="op" id="6940879">:=</span>&nbsp;<span class="ident" id="6940882">slowAbs</span><span class="op" id="6940889">(</span><span class="ident" id="6940890">p</span>&nbsp;<span class="op" id="6940892">-</span>&nbsp;<span class="builtintype" id="6940894">int</span><span class="op" id="6940897">(</span><span class="ident" id="6940898">b</span><span class="op" id="6940899">)</span><span class="op" id="6940900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940903">pc</span>&nbsp;<span class="op" id="6940906">:=</span>&nbsp;<span class="ident" id="6940909">slowAbs</span><span class="op" id="6940916">(</span><span class="ident" id="6940917">p</span>&nbsp;<span class="op" id="6940919">-</span>&nbsp;<span class="builtintype" id="6940921">int</span><span class="op" id="6940924">(</span><span class="ident" id="6940925">c</span><span class="op" id="6940926">)</span><span class="op" id="6940927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940930">if</span>&nbsp;<span class="ident" id="6940933">pa</span>&nbsp;<span class="op" id="6940936">&lt;=</span>&nbsp;<span class="ident" id="6940939">pb</span>&nbsp;<span class="op" id="6940942">&amp;&amp;</span>&nbsp;<span class="ident" id="6940945">pa</span>&nbsp;<span class="op" id="6940948">&lt;=</span>&nbsp;<span class="ident" id="6940951">pc</span>&nbsp;<span class="op" id="6940954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940958">return</span>&nbsp;<span class="ident" id="6940965">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940968">}</span>&nbsp;<span class="keyword" id="6940970">else</span>&nbsp;<span class="keyword" id="6940975">if</span>&nbsp;<span class="ident" id="6940978">pb</span>&nbsp;<span class="op" id="6940981">&lt;=</span>&nbsp;<span class="ident" id="6940984">pc</span>&nbsp;<span class="op" id="6940987">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940991">return</span>&nbsp;<span class="ident" id="6940998">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941004">return</span>&nbsp;<span class="ident" id="6941011">c</span><br>
<span class="lineno"></span><span class="op" id="6941013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="6941016">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="6941092">func</span>&nbsp;<span class="ident" id="6941097">slowFilterPaeth</span><span class="op" id="6941112">(</span><span class="ident" id="6941113">cdat</span><span class="op" id="6941117">,</span>&nbsp;<span class="ident" id="6941119">pdat</span>&nbsp;<span class="op" id="6941124">[</span><span class="op" id="6941125">]</span><span class="builtintype" id="6941126">byte</span><span class="op" id="6941130">,</span>&nbsp;<span class="ident" id="6941132">bytesPerPixel</span>&nbsp;<span class="builtintype" id="6941146">int</span><span class="op" id="6941149">)</span>&nbsp;<span class="op" id="6941151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941154">for</span>&nbsp;<span class="ident" id="6941158">i</span>&nbsp;<span class="op" id="6941160">:=</span>&nbsp;<span class="num" id="6941163">0</span><span class="op" id="6941164">;</span>&nbsp;<span class="ident" id="6941166">i</span>&nbsp;<span class="op" id="6941168">&lt;</span>&nbsp;<span class="ident" id="6941170">bytesPerPixel</span><span class="op" id="6941183">;</span>&nbsp;<span class="ident" id="6941185">i</span><span class="op" id="6941186">++</span>&nbsp;<span class="op" id="6941189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941193">cdat</span><span class="op" id="6941197">[</span><span class="ident" id="6941198">i</span><span class="op" id="6941199">]</span>&nbsp;<span class="op" id="6941201">+=</span>&nbsp;<span class="ident" id="6941204">paeth</span><span class="op" id="6941209">(</span><span class="num" id="6941210">0</span><span class="op" id="6941211">,</span>&nbsp;<span class="ident" id="6941213">pdat</span><span class="op" id="6941217">[</span><span class="ident" id="6941218">i</span><span class="op" id="6941219">]</span><span class="op" id="6941220">,</span>&nbsp;<span class="num" id="6941222">0</span><span class="op" id="6941223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941226">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941229">for</span>&nbsp;<span class="ident" id="6941233">i</span>&nbsp;<span class="op" id="6941235">:=</span>&nbsp;<span class="ident" id="6941238">bytesPerPixel</span><span class="op" id="6941251">;</span>&nbsp;<span class="ident" id="6941253">i</span>&nbsp;<span class="op" id="6941255">&lt;</span>&nbsp;<span class="builtinfunc" id="6941257">len</span><span class="op" id="6941260">(</span><span class="ident" id="6941261">cdat</span><span class="op" id="6941265">)</span><span class="op" id="6941266">;</span>&nbsp;<span class="ident" id="6941268">i</span><span class="op" id="6941269">++</span>&nbsp;<span class="op" id="6941272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941276">cdat</span><span class="op" id="6941280">[</span><span class="ident" id="6941281">i</span><span class="op" id="6941282">]</span>&nbsp;<span class="op" id="6941284">+=</span>&nbsp;<span class="ident" id="6941287">paeth</span><span class="op" id="6941292">(</span><span class="ident" id="6941293">cdat</span><span class="op" id="6941297">[</span><span class="ident" id="6941298">i</span><span class="op" id="6941299">-</span><span class="ident" id="6941300">bytesPerPixel</span><span class="op" id="6941313">]</span><span class="op" id="6941314">,</span>&nbsp;<span class="ident" id="6941316">pdat</span><span class="op" id="6941320">[</span><span class="ident" id="6941321">i</span><span class="op" id="6941322">]</span><span class="op" id="6941323">,</span>&nbsp;<span class="ident" id="6941325">pdat</span><span class="op" id="6941329">[</span><span class="ident" id="6941330">i</span><span class="op" id="6941331">-</span><span class="ident" id="6941332">bytesPerPixel</span><span class="op" id="6941345">]</span><span class="op" id="6941346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941349">}</span><br>
<span class="lineno"></span><span class="op" id="6941351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6941354">func</span>&nbsp;<span class="ident" id="6941359">TestPaeth</span><span class="op" id="6941368">(</span><span class="ident" id="6941369">t</span>&nbsp;<span class="op" id="6941371">*</span><span class="ident" id="6941372">testing</span><span class="op" id="6941379">.</span><span class="ident" id="6941380">T</span><span class="op" id="6941381">)</span>&nbsp;<span class="op" id="6941383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941386">for</span>&nbsp;<span class="ident" id="6941390">a</span>&nbsp;<span class="op" id="6941392">:=</span>&nbsp;<span class="num" id="6941395">0</span><span class="op" id="6941396">;</span>&nbsp;<span class="ident" id="6941398">a</span>&nbsp;<span class="op" id="6941400">&lt;</span>&nbsp;<span class="num" id="6941402">256</span><span class="op" id="6941405">;</span>&nbsp;<span class="ident" id="6941407">a</span>&nbsp;<span class="op" id="6941409">+=</span>&nbsp;<span class="num" id="6941412">15</span>&nbsp;<span class="op" id="6941415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941419">for</span>&nbsp;<span class="ident" id="6941423">b</span>&nbsp;<span class="op" id="6941425">:=</span>&nbsp;<span class="num" id="6941428">0</span><span class="op" id="6941429">;</span>&nbsp;<span class="ident" id="6941431">b</span>&nbsp;<span class="op" id="6941433">&lt;</span>&nbsp;<span class="num" id="6941435">256</span><span class="op" id="6941438">;</span>&nbsp;<span class="ident" id="6941440">b</span>&nbsp;<span class="op" id="6941442">+=</span>&nbsp;<span class="num" id="6941445">15</span>&nbsp;<span class="op" id="6941448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941453">for</span>&nbsp;<span class="ident" id="6941457">c</span>&nbsp;<span class="op" id="6941459">:=</span>&nbsp;<span class="num" id="6941462">0</span><span class="op" id="6941463">;</span>&nbsp;<span class="ident" id="6941465">c</span>&nbsp;<span class="op" id="6941467">&lt;</span>&nbsp;<span class="num" id="6941469">256</span><span class="op" id="6941472">;</span>&nbsp;<span class="ident" id="6941474">c</span>&nbsp;<span class="op" id="6941476">+=</span>&nbsp;<span class="num" id="6941479">15</span>&nbsp;<span class="op" id="6941482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941488">got</span>&nbsp;<span class="op" id="6941492">:=</span>&nbsp;<span class="ident" id="6941495">paeth</span><span class="op" id="6941500">(</span><span class="builtintype" id="6941501">uint8</span><span class="op" id="6941506">(</span><span class="ident" id="6941507">a</span><span class="op" id="6941508">)</span><span class="op" id="6941509">,</span>&nbsp;<span class="builtintype" id="6941511">uint8</span><span class="op" id="6941516">(</span><span class="ident" id="6941517">b</span><span class="op" id="6941518">)</span><span class="op" id="6941519">,</span>&nbsp;<span class="builtintype" id="6941521">uint8</span><span class="op" id="6941526">(</span><span class="ident" id="6941527">c</span><span class="op" id="6941528">)</span><span class="op" id="6941529">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941535">want</span>&nbsp;<span class="op" id="6941540">:=</span>&nbsp;<span class="ident" id="6941543">slowPaeth</span><span class="op" id="6941552">(</span><span class="builtintype" id="6941553">uint8</span><span class="op" id="6941558">(</span><span class="ident" id="6941559">a</span><span class="op" id="6941560">)</span><span class="op" id="6941561">,</span>&nbsp;<span class="builtintype" id="6941563">uint8</span><span class="op" id="6941568">(</span><span class="ident" id="6941569">b</span><span class="op" id="6941570">)</span><span class="op" id="6941571">,</span>&nbsp;<span class="builtintype" id="6941573">uint8</span><span class="op" id="6941578">(</span><span class="ident" id="6941579">c</span><span class="op" id="6941580">)</span><span class="op" id="6941581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941587">if</span>&nbsp;<span class="ident" id="6941590">got</span>&nbsp;<span class="op" id="6941594">!=</span>&nbsp;<span class="ident" id="6941597">want</span>&nbsp;<span class="op" id="6941602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941609">t</span><span class="op" id="6941610">.</span><span class="ident" id="6941611">Errorf</span><span class="op" id="6941617">(</span><span class="string" id="6941618">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6941657">,</span>&nbsp;<span class="ident" id="6941659">a</span><span class="op" id="6941660">,</span>&nbsp;<span class="ident" id="6941662">b</span><span class="op" id="6941663">,</span>&nbsp;<span class="ident" id="6941665">c</span><span class="op" id="6941666">,</span>&nbsp;<span class="ident" id="6941668">got</span><span class="op" id="6941671">,</span>&nbsp;<span class="ident" id="6941673">want</span><span class="op" id="6941677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941688">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941695">}</span><br>
<span class="lineno"></span><span class="op" id="6941697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6941700">func</span>&nbsp;<span class="ident" id="6941705">BenchmarkPaeth</span><span class="op" id="6941719">(</span><span class="ident" id="6941720">b</span>&nbsp;<span class="op" id="6941722">*</span><span class="ident" id="6941723">testing</span><span class="op" id="6941730">.</span><span class="ident" id="6941731">B</span><span class="op" id="6941732">)</span>&nbsp;<span class="op" id="6941734">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941737">for</span>&nbsp;<span class="ident" id="6941741">i</span>&nbsp;<span class="op" id="6941743">:=</span>&nbsp;<span class="num" id="6941746">0</span><span class="op" id="6941747">;</span>&nbsp;<span class="ident" id="6941749">i</span>&nbsp;<span class="op" id="6941751">&lt;</span>&nbsp;<span class="ident" id="6941753">b</span><span class="op" id="6941754">.</span><span class="ident" id="6941755">N</span><span class="op" id="6941756">;</span>&nbsp;<span class="ident" id="6941758">i</span><span class="op" id="6941759">++</span>&nbsp;<span class="op" id="6941762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941766">paeth</span><span class="op" id="6941771">(</span><span class="builtintype" id="6941772">uint8</span><span class="op" id="6941777">(</span><span class="ident" id="6941778">i</span><span class="op" id="6941779">&gt;&gt;</span><span class="num" id="6941781">16</span><span class="op" id="6941783">)</span><span class="op" id="6941784">,</span>&nbsp;<span class="builtintype" id="6941786">uint8</span><span class="op" id="6941791">(</span><span class="ident" id="6941792">i</span><span class="op" id="6941793">&gt;&gt;</span><span class="num" id="6941795">8</span><span class="op" id="6941796">)</span><span class="op" id="6941797">,</span>&nbsp;<span class="builtintype" id="6941799">uint8</span><span class="op" id="6941804">(</span><span class="ident" id="6941805">i</span><span class="op" id="6941806">)</span><span class="op" id="6941807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941810">}</span><br>
<span class="lineno"></span><span class="op" id="6941812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6941815">func</span>&nbsp;<span class="ident" id="6941820">TestPaethDecode</span><span class="op" id="6941835">(</span><span class="ident" id="6941836">t</span>&nbsp;<span class="op" id="6941838">*</span><span class="ident" id="6941839">testing</span><span class="op" id="6941846">.</span><span class="ident" id="6941847">T</span><span class="op" id="6941848">)</span>&nbsp;<span class="op" id="6941850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941853">pdat0</span>&nbsp;<span class="op" id="6941859">:=</span>&nbsp;<span class="builtinfunc" id="6941862">make</span><span class="op" id="6941866">(</span><span class="op" id="6941867">[</span><span class="op" id="6941868">]</span><span class="builtintype" id="6941869">byte</span><span class="op" id="6941873">,</span>&nbsp;<span class="num" id="6941875">32</span><span class="op" id="6941877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941880">pdat1</span>&nbsp;<span class="op" id="6941886">:=</span>&nbsp;<span class="builtinfunc" id="6941889">make</span><span class="op" id="6941893">(</span><span class="op" id="6941894">[</span><span class="op" id="6941895">]</span><span class="builtintype" id="6941896">byte</span><span class="op" id="6941900">,</span>&nbsp;<span class="num" id="6941902">32</span><span class="op" id="6941904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941907">pdat2</span>&nbsp;<span class="op" id="6941913">:=</span>&nbsp;<span class="builtinfunc" id="6941916">make</span><span class="op" id="6941920">(</span><span class="op" id="6941921">[</span><span class="op" id="6941922">]</span><span class="builtintype" id="6941923">byte</span><span class="op" id="6941927">,</span>&nbsp;<span class="num" id="6941929">32</span><span class="op" id="6941931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941934">cdat0</span>&nbsp;<span class="op" id="6941940">:=</span>&nbsp;<span class="builtinfunc" id="6941943">make</span><span class="op" id="6941947">(</span><span class="op" id="6941948">[</span><span class="op" id="6941949">]</span><span class="builtintype" id="6941950">byte</span><span class="op" id="6941954">,</span>&nbsp;<span class="num" id="6941956">32</span><span class="op" id="6941958">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941961">cdat1</span>&nbsp;<span class="op" id="6941967">:=</span>&nbsp;<span class="builtinfunc" id="6941970">make</span><span class="op" id="6941974">(</span><span class="op" id="6941975">[</span><span class="op" id="6941976">]</span><span class="builtintype" id="6941977">byte</span><span class="op" id="6941981">,</span>&nbsp;<span class="num" id="6941983">32</span><span class="op" id="6941985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941988">cdat2</span>&nbsp;<span class="op" id="6941994">:=</span>&nbsp;<span class="builtinfunc" id="6941997">make</span><span class="op" id="6942001">(</span><span class="op" id="6942002">[</span><span class="op" id="6942003">]</span><span class="builtintype" id="6942004">byte</span><span class="op" id="6942008">,</span>&nbsp;<span class="num" id="6942010">32</span><span class="op" id="6942012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942015">r</span>&nbsp;<span class="op" id="6942017">:=</span>&nbsp;<span class="ident" id="6942020">rand</span><span class="op" id="6942024">.</span><span class="ident" id="6942025">New</span><span class="op" id="6942028">(</span><span class="ident" id="6942029">rand</span><span class="op" id="6942033">.</span><span class="ident" id="6942034">NewSource</span><span class="op" id="6942043">(</span><span class="num" id="6942044">1</span><span class="op" id="6942045">)</span><span class="op" id="6942046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942049">for</span>&nbsp;<span class="ident" id="6942053">bytesPerPixel</span>&nbsp;<span class="op" id="6942067">:=</span>&nbsp;<span class="num" id="6942070">1</span><span class="op" id="6942071">;</span>&nbsp;<span class="ident" id="6942073">bytesPerPixel</span>&nbsp;<span class="op" id="6942087">&lt;=</span>&nbsp;<span class="num" id="6942090">8</span><span class="op" id="6942091">;</span>&nbsp;<span class="ident" id="6942093">bytesPerPixel</span><span class="op" id="6942106">++</span>&nbsp;<span class="op" id="6942109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942113">for</span>&nbsp;<span class="ident" id="6942117">i</span>&nbsp;<span class="op" id="6942119">:=</span>&nbsp;<span class="num" id="6942122">0</span><span class="op" id="6942123">;</span>&nbsp;<span class="ident" id="6942125">i</span>&nbsp;<span class="op" id="6942127">&lt;</span>&nbsp;<span class="num" id="6942129">100</span><span class="op" id="6942132">;</span>&nbsp;<span class="ident" id="6942134">i</span><span class="op" id="6942135">++</span>&nbsp;<span class="op" id="6942138">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942143">for</span>&nbsp;<span class="ident" id="6942147">j</span>&nbsp;<span class="op" id="6942149">:=</span>&nbsp;<span class="keyword" id="6942152">range</span>&nbsp;<span class="ident" id="6942158">pdat0</span>&nbsp;<span class="op" id="6942164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942170">pdat0</span><span class="op" id="6942175">[</span><span class="ident" id="6942176">j</span><span class="op" id="6942177">]</span>&nbsp;<span class="op" id="6942179">=</span>&nbsp;<span class="builtintype" id="6942181">uint8</span><span class="op" id="6942186">(</span><span class="ident" id="6942187">r</span><span class="op" id="6942188">.</span><span class="ident" id="6942189">Uint32</span><span class="op" id="6942195">(</span><span class="op" id="6942196">)</span><span class="op" id="6942197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942203">cdat0</span><span class="op" id="6942208">[</span><span class="ident" id="6942209">j</span><span class="op" id="6942210">]</span>&nbsp;<span class="op" id="6942212">=</span>&nbsp;<span class="builtintype" id="6942214">uint8</span><span class="op" id="6942219">(</span><span class="ident" id="6942220">r</span><span class="op" id="6942221">.</span><span class="ident" id="6942222">Uint32</span><span class="op" id="6942228">(</span><span class="op" id="6942229">)</span><span class="op" id="6942230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6942240">copy</span><span class="op" id="6942244">(</span><span class="ident" id="6942245">pdat1</span><span class="op" id="6942250">,</span>&nbsp;<span class="ident" id="6942252">pdat0</span><span class="op" id="6942257">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6942262">copy</span><span class="op" id="6942266">(</span><span class="ident" id="6942267">pdat2</span><span class="op" id="6942272">,</span>&nbsp;<span class="ident" id="6942274">pdat0</span><span class="op" id="6942279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6942284">copy</span><span class="op" id="6942288">(</span><span class="ident" id="6942289">cdat1</span><span class="op" id="6942294">,</span>&nbsp;<span class="ident" id="6942296">cdat0</span><span class="op" id="6942301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6942306">copy</span><span class="op" id="6942310">(</span><span class="ident" id="6942311">cdat2</span><span class="op" id="6942316">,</span>&nbsp;<span class="ident" id="6942318">cdat0</span><span class="op" id="6942323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942328">filterPaeth</span><span class="op" id="6942339">(</span><span class="ident" id="6942340">cdat1</span><span class="op" id="6942345">,</span>&nbsp;<span class="ident" id="6942347">pdat1</span><span class="op" id="6942352">,</span>&nbsp;<span class="ident" id="6942354">bytesPerPixel</span><span class="op" id="6942367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942372">slowFilterPaeth</span><span class="op" id="6942387">(</span><span class="ident" id="6942388">cdat2</span><span class="op" id="6942393">,</span>&nbsp;<span class="ident" id="6942395">pdat2</span><span class="op" id="6942400">,</span>&nbsp;<span class="ident" id="6942402">bytesPerPixel</span><span class="op" id="6942415">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942420">if</span>&nbsp;<span class="op" id="6942423">!</span><span class="ident" id="6942424">bytes</span><span class="op" id="6942429">.</span><span class="ident" id="6942430">Equal</span><span class="op" id="6942435">(</span><span class="ident" id="6942436">cdat1</span><span class="op" id="6942441">,</span>&nbsp;<span class="ident" id="6942443">cdat2</span><span class="op" id="6942448">)</span>&nbsp;<span class="op" id="6942450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942456">t</span><span class="op" id="6942457">.</span><span class="ident" id="6942458">Errorf</span><span class="op" id="6942464">(</span><span class="string" id="6942465">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="6942532">,</span>&nbsp;<span class="ident" id="6942534">bytesPerPixel</span><span class="op" id="6942547">,</span>&nbsp;<span class="ident" id="6942549">pdat0</span><span class="op" id="6942554">,</span>&nbsp;<span class="ident" id="6942556">cdat0</span><span class="op" id="6942561">,</span>&nbsp;<span class="ident" id="6942563">cdat1</span><span class="op" id="6942568">,</span>&nbsp;<span class="ident" id="6942570">cdat2</span><span class="op" id="6942575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942581">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942594">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942597">}</span><br>
<span class="lineno"></span><span class="op" id="6942599">}</span>
</div>
</body>
</html>
