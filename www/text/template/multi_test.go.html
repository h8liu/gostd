<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8095497">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8095552">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8095606">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8095657">package</span>&nbsp;<span class="ident" id="8095665">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8095675">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8095730">import</span>&nbsp;<span class="op" id="8095737">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8095740">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8095749">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8095756">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8095767">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8095778">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8095800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8095803">const</span>&nbsp;<span class="op" id="8095809">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095812">noError</span>&nbsp;&nbsp;<span class="op" id="8095821">=</span>&nbsp;<span class="ident" id="8095823">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095829">hasError</span>&nbsp;<span class="op" id="8095838">=</span>&nbsp;<span class="ident" id="8095840">false</span><br>
<span class="lineno">20</span><span class="op" id="8095846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8095849">type</span>&nbsp;<span class="ident" id="8095854">multiParseTest</span>&nbsp;<span class="keyword" id="8095869">struct</span>&nbsp;<span class="op" id="8095876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095879">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8095887">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095895">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8095903">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095911">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8095919">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095925">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8095933">[</span><span class="op" id="8095934">]</span><span class="builtintype" id="8095935">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8095943">results</span>&nbsp;<span class="op" id="8095951">[</span><span class="op" id="8095952">]</span><span class="builtintype" id="8095953">string</span><br>
<span class="lineno"></span><span class="op" id="8095960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8095963">var</span>&nbsp;<span class="ident" id="8095967">multiParseTests</span>&nbsp;<span class="op" id="8095983">=</span>&nbsp;<span class="op" id="8095985">[</span><span class="op" id="8095986">]</span><span class="ident" id="8095987">multiParseTest</span><span class="op" id="8096001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096004">{</span><span class="string" id="8096005">&#34;empty&#34;</span><span class="op" id="8096012">,</span>&nbsp;<span class="string" id="8096014">&#34;&#34;</span><span class="op" id="8096016">,</span>&nbsp;<span class="ident" id="8096018">noError</span><span class="op" id="8096025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096029">nil</span><span class="op" id="8096032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096036">nil</span><span class="op" id="8096039">}</span><span class="op" id="8096040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096043">{</span><span class="string" id="8096044">&#34;one&#34;</span><span class="op" id="8096049">,</span>&nbsp;<span class="string" id="8096051">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="8096081">,</span>&nbsp;<span class="ident" id="8096083">noError</span><span class="op" id="8096090">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096094">[</span><span class="op" id="8096095">]</span><span class="builtintype" id="8096096">string</span><span class="op" id="8096102">{</span><span class="string" id="8096103">&#34;foo&#34;</span><span class="op" id="8096108">}</span><span class="op" id="8096109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096113">[</span><span class="op" id="8096114">]</span><span class="builtintype" id="8096115">string</span><span class="op" id="8096121">{</span><span class="string" id="8096122">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8096129">}</span><span class="op" id="8096130">}</span><span class="op" id="8096131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096134">{</span><span class="string" id="8096135">&#34;two&#34;</span><span class="op" id="8096140">,</span>&nbsp;<span class="string" id="8096142">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="8096200">,</span>&nbsp;<span class="ident" id="8096202">noError</span><span class="op" id="8096209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096213">[</span><span class="op" id="8096214">]</span><span class="builtintype" id="8096215">string</span><span class="op" id="8096221">{</span><span class="string" id="8096222">&#34;foo&#34;</span><span class="op" id="8096227">,</span>&nbsp;<span class="string" id="8096229">&#34;bar&#34;</span><span class="op" id="8096234">}</span><span class="op" id="8096235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096239">[</span><span class="op" id="8096240">]</span><span class="builtintype" id="8096241">string</span><span class="op" id="8096247">{</span><span class="string" id="8096248">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8096255">,</span>&nbsp;<span class="string" id="8096257">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="8096264">}</span><span class="op" id="8096265">}</span><span class="op" id="8096266">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8096269">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096280">{</span><span class="string" id="8096281">&#34;missing&nbsp;end&#34;</span><span class="op" id="8096294">,</span>&nbsp;<span class="string" id="8096296">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="8096319">,</span>&nbsp;<span class="ident" id="8096321">hasError</span><span class="op" id="8096329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096333">nil</span><span class="op" id="8096336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096340">nil</span><span class="op" id="8096343">}</span><span class="op" id="8096344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096347">{</span><span class="string" id="8096348">&#34;malformed&nbsp;name&#34;</span><span class="op" id="8096364">,</span>&nbsp;<span class="string" id="8096366">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="8096388">,</span>&nbsp;<span class="ident" id="8096390">hasError</span><span class="op" id="8096398">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096402">nil</span><span class="op" id="8096405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096409">nil</span><span class="op" id="8096412">}</span><span class="op" id="8096413">,</span><br>
<span class="lineno"></span><span class="op" id="8096415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8096418">func</span>&nbsp;<span class="ident" id="8096423">TestMultiParse</span><span class="op" id="8096437">(</span><span class="ident" id="8096438">t</span>&nbsp;<span class="op" id="8096440">*</span><span class="ident" id="8096441">testing</span><span class="op" id="8096448">.</span><span class="ident" id="8096449">T</span><span class="op" id="8096450">)</span>&nbsp;<span class="op" id="8096452">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096455">for</span>&nbsp;<span class="ident" id="8096459">_</span><span class="op" id="8096460">,</span>&nbsp;<span class="ident" id="8096462">test</span>&nbsp;<span class="op" id="8096467">:=</span>&nbsp;<span class="keyword" id="8096470">range</span>&nbsp;<span class="ident" id="8096476">multiParseTests</span>&nbsp;<span class="op" id="8096492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096496">template</span><span class="op" id="8096504">,</span>&nbsp;<span class="ident" id="8096506">err</span>&nbsp;<span class="op" id="8096510">:=</span>&nbsp;<span class="ident" id="8096513">New</span><span class="op" id="8096516">(</span><span class="string" id="8096517">&#34;root&#34;</span><span class="op" id="8096523">)</span><span class="op" id="8096524">.</span><span class="ident" id="8096525">Parse</span><span class="op" id="8096530">(</span><span class="ident" id="8096531">test</span><span class="op" id="8096535">.</span><span class="ident" id="8096536">input</span><span class="op" id="8096541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096545">switch</span>&nbsp;<span class="op" id="8096552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096556">case</span>&nbsp;<span class="ident" id="8096561">err</span>&nbsp;<span class="op" id="8096565">==</span>&nbsp;<span class="ident" id="8096568">nil</span>&nbsp;<span class="op" id="8096572">&amp;&amp;</span>&nbsp;<span class="op" id="8096575">!</span><span class="ident" id="8096576">test</span><span class="op" id="8096580">.</span><span class="ident" id="8096581">ok</span><span class="op" id="8096583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096588">t</span><span class="op" id="8096589">.</span><span class="ident" id="8096590">Errorf</span><span class="op" id="8096596">(</span><span class="string" id="8096597">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8096627">,</span>&nbsp;<span class="ident" id="8096629">test</span><span class="op" id="8096633">.</span><span class="ident" id="8096634">name</span><span class="op" id="8096638">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096643">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096654">case</span>&nbsp;<span class="ident" id="8096659">err</span>&nbsp;<span class="op" id="8096663">!=</span>&nbsp;<span class="ident" id="8096666">nil</span>&nbsp;<span class="op" id="8096670">&amp;&amp;</span>&nbsp;<span class="ident" id="8096673">test</span><span class="op" id="8096677">.</span><span class="ident" id="8096678">ok</span><span class="op" id="8096680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096685">t</span><span class="op" id="8096686">.</span><span class="ident" id="8096687">Errorf</span><span class="op" id="8096693">(</span><span class="string" id="8096694">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8096720">,</span>&nbsp;<span class="ident" id="8096722">test</span><span class="op" id="8096726">.</span><span class="ident" id="8096727">name</span><span class="op" id="8096731">,</span>&nbsp;<span class="ident" id="8096733">err</span><span class="op" id="8096736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096741">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096752">case</span>&nbsp;<span class="ident" id="8096757">err</span>&nbsp;<span class="op" id="8096761">!=</span>&nbsp;<span class="ident" id="8096764">nil</span>&nbsp;<span class="op" id="8096768">&amp;&amp;</span>&nbsp;<span class="op" id="8096771">!</span><span class="ident" id="8096772">test</span><span class="op" id="8096776">.</span><span class="ident" id="8096777">ok</span><span class="op" id="8096779">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8096784">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096814">if</span>&nbsp;<span class="op" id="8096817">*</span><span class="ident" id="8096818">debug</span>&nbsp;<span class="op" id="8096824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8096830">fmt</span><span class="op" id="8096833">.</span><span class="ident" id="8096834">Printf</span><span class="op" id="8096840">(</span><span class="string" id="8096841">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="8096857">,</span>&nbsp;<span class="ident" id="8096859">test</span><span class="op" id="8096863">.</span><span class="ident" id="8096864">name</span><span class="op" id="8096868">,</span>&nbsp;<span class="ident" id="8096870">test</span><span class="op" id="8096874">.</span><span class="ident" id="8096875">input</span><span class="op" id="8096880">,</span>&nbsp;<span class="ident" id="8096882">err</span><span class="op" id="8096885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096895">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096910">if</span>&nbsp;<span class="ident" id="8096913">template</span>&nbsp;<span class="op" id="8096922">==</span>&nbsp;<span class="ident" id="8096925">nil</span>&nbsp;<span class="op" id="8096929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096934">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8096945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8096949">if</span>&nbsp;<span class="builtinfunc" id="8096952">len</span><span class="op" id="8096955">(</span><span class="ident" id="8096956">template</span><span class="op" id="8096964">.</span><span class="ident" id="8096965">tmpl</span><span class="op" id="8096969">)</span>&nbsp;<span class="op" id="8096971">!=</span>&nbsp;<span class="builtinfunc" id="8096974">len</span><span class="op" id="8096977">(</span><span class="ident" id="8096978">test</span><span class="op" id="8096982">.</span><span class="ident" id="8096983">names</span><span class="op" id="8096988">)</span><span class="op" id="8096989">+</span><span class="num" id="8096990">1</span>&nbsp;<span class="op" id="8096992">{</span>&nbsp;<span class="comment" id="8096994">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8097012">t</span><span class="op" id="8097013">.</span><span class="ident" id="8097014">Errorf</span><span class="op" id="8097020">(</span><span class="string" id="8097021">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8097070">,</span>&nbsp;<span class="ident" id="8097072">test</span><span class="op" id="8097076">.</span><span class="ident" id="8097077">name</span><span class="op" id="8097081">,</span>&nbsp;<span class="builtinfunc" id="8097083">len</span><span class="op" id="8097086">(</span><span class="ident" id="8097087">test</span><span class="op" id="8097091">.</span><span class="ident" id="8097092">names</span><span class="op" id="8097097">)</span><span class="op" id="8097098">,</span>&nbsp;<span class="builtinfunc" id="8097100">len</span><span class="op" id="8097103">(</span><span class="ident" id="8097104">template</span><span class="op" id="8097112">.</span><span class="ident" id="8097113">tmpl</span><span class="op" id="8097117">)</span><span class="op" id="8097118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8097123">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8097138">for</span>&nbsp;<span class="ident" id="8097142">i</span><span class="op" id="8097143">,</span>&nbsp;<span class="ident" id="8097145">name</span>&nbsp;<span class="op" id="8097150">:=</span>&nbsp;<span class="keyword" id="8097153">range</span>&nbsp;<span class="ident" id="8097159">test</span><span class="op" id="8097163">.</span><span class="ident" id="8097164">names</span>&nbsp;<span class="op" id="8097170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8097175">tmpl</span><span class="op" id="8097179">,</span>&nbsp;<span class="ident" id="8097181">ok</span>&nbsp;<span class="op" id="8097184">:=</span>&nbsp;<span class="ident" id="8097187">template</span><span class="op" id="8097195">.</span><span class="ident" id="8097196">tmpl</span><span class="op" id="8097200">[</span><span class="ident" id="8097201">name</span><span class="op" id="8097205">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8097210">if</span>&nbsp;<span class="op" id="8097213">!</span><span class="ident" id="8097214">ok</span>&nbsp;<span class="op" id="8097217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8097223">t</span><span class="op" id="8097224">.</span><span class="ident" id="8097225">Errorf</span><span class="op" id="8097231">(</span><span class="string" id="8097232">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="8097260">,</span>&nbsp;<span class="ident" id="8097262">test</span><span class="op" id="8097266">.</span><span class="ident" id="8097267">name</span><span class="op" id="8097271">,</span>&nbsp;<span class="ident" id="8097273">name</span><span class="op" id="8097277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8097283">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8097300">result</span>&nbsp;<span class="op" id="8097307">:=</span>&nbsp;<span class="ident" id="8097310">tmpl</span><span class="op" id="8097314">.</span><span class="ident" id="8097315">Root</span><span class="op" id="8097319">.</span><span class="ident" id="8097320">String</span><span class="op" id="8097326">(</span><span class="op" id="8097327">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8097332">if</span>&nbsp;<span class="ident" id="8097335">result</span>&nbsp;<span class="op" id="8097342">!=</span>&nbsp;<span class="ident" id="8097345">test</span><span class="op" id="8097349">.</span><span class="ident" id="8097350">results</span><span class="op" id="8097357">[</span><span class="ident" id="8097358">i</span><span class="op" id="8097359">]</span>&nbsp;<span class="op" id="8097361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8097367">t</span><span class="op" id="8097368">.</span><span class="ident" id="8097369">Errorf</span><span class="op" id="8097375">(</span><span class="string" id="8097376">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="8097412">,</span>&nbsp;<span class="ident" id="8097414">test</span><span class="op" id="8097418">.</span><span class="ident" id="8097419">name</span><span class="op" id="8097423">,</span>&nbsp;<span class="ident" id="8097425">test</span><span class="op" id="8097429">.</span><span class="ident" id="8097430">input</span><span class="op" id="8097435">,</span>&nbsp;<span class="ident" id="8097437">result</span><span class="op" id="8097443">,</span>&nbsp;<span class="ident" id="8097445">test</span><span class="op" id="8097449">.</span><span class="ident" id="8097450">results</span><span class="op" id="8097457">[</span><span class="ident" id="8097458">i</span><span class="op" id="8097459">]</span><span class="op" id="8097460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097472">}</span><br>
<span class="lineno">85</span><span class="op" id="8097474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8097477">var</span>&nbsp;<span class="ident" id="8097481">multiExecTests</span>&nbsp;<span class="op" id="8097496">=</span>&nbsp;<span class="op" id="8097498">[</span><span class="op" id="8097499">]</span><span class="ident" id="8097500">execTest</span><span class="op" id="8097508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097511">{</span><span class="string" id="8097512">&#34;empty&#34;</span><span class="op" id="8097519">,</span>&nbsp;<span class="string" id="8097521">&#34;&#34;</span><span class="op" id="8097523">,</span>&nbsp;<span class="string" id="8097525">&#34;&#34;</span><span class="op" id="8097527">,</span>&nbsp;<span class="ident" id="8097529">nil</span><span class="op" id="8097532">,</span>&nbsp;<span class="ident" id="8097534">true</span><span class="op" id="8097538">}</span><span class="op" id="8097539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097542">{</span><span class="string" id="8097543">&#34;text&#34;</span><span class="op" id="8097549">,</span>&nbsp;<span class="string" id="8097551">&#34;some&nbsp;text&#34;</span><span class="op" id="8097562">,</span>&nbsp;<span class="string" id="8097564">&#34;some&nbsp;text&#34;</span><span class="op" id="8097575">,</span>&nbsp;<span class="ident" id="8097577">nil</span><span class="op" id="8097580">,</span>&nbsp;<span class="ident" id="8097582">true</span><span class="op" id="8097586">}</span><span class="op" id="8097587">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097590">{</span><span class="string" id="8097591">&#34;invoke&nbsp;x&#34;</span><span class="op" id="8097601">,</span>&nbsp;<span class="string" id="8097603">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="8097625">,</span>&nbsp;<span class="string" id="8097627">&#34;TEXT&#34;</span><span class="op" id="8097633">,</span>&nbsp;<span class="ident" id="8097635">tVal</span><span class="op" id="8097639">,</span>&nbsp;<span class="ident" id="8097641">true</span><span class="op" id="8097645">}</span><span class="op" id="8097646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097649">{</span><span class="string" id="8097650">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="8097668">,</span>&nbsp;<span class="string" id="8097670">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="8097688">,</span>&nbsp;<span class="string" id="8097690">&#34;TEXT&#34;</span><span class="op" id="8097696">,</span>&nbsp;<span class="ident" id="8097698">tVal</span><span class="op" id="8097702">,</span>&nbsp;<span class="ident" id="8097704">true</span><span class="op" id="8097708">}</span><span class="op" id="8097709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097712">{</span><span class="string" id="8097713">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="8097729">,</span>&nbsp;<span class="string" id="8097731">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="8097754">,</span>&nbsp;<span class="string" id="8097756">&#34;17&#34;</span><span class="op" id="8097760">,</span>&nbsp;<span class="ident" id="8097762">tVal</span><span class="op" id="8097766">,</span>&nbsp;<span class="ident" id="8097768">true</span><span class="op" id="8097772">}</span><span class="op" id="8097773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097776">{</span><span class="string" id="8097777">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="8097795">,</span>&nbsp;<span class="string" id="8097797">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="8097821">,</span>&nbsp;<span class="string" id="8097823">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="8097832">,</span>&nbsp;<span class="ident" id="8097834">tVal</span><span class="op" id="8097838">,</span>&nbsp;<span class="ident" id="8097840">true</span><span class="op" id="8097844">}</span><span class="op" id="8097845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097848">{</span><span class="string" id="8097849">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="8097862">,</span>&nbsp;<span class="string" id="8097864">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="8097888">,</span>&nbsp;<span class="string" id="8097890">&#34;v&#34;</span><span class="op" id="8097893">,</span>&nbsp;<span class="ident" id="8097895">tVal</span><span class="op" id="8097899">,</span>&nbsp;<span class="ident" id="8097901">true</span><span class="op" id="8097905">}</span><span class="op" id="8097906">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097909">{</span><span class="string" id="8097910">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="8097929">,</span>&nbsp;<span class="string" id="8097931">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="8097957">,</span>&nbsp;<span class="string" id="8097959">&#34;17&#34;</span><span class="op" id="8097963">,</span>&nbsp;<span class="ident" id="8097965">tVal</span><span class="op" id="8097969">,</span>&nbsp;<span class="ident" id="8097971">true</span><span class="op" id="8097975">}</span><span class="op" id="8097976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8097979">{</span><span class="string" id="8097980">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="8098011">,</span>&nbsp;<span class="string" id="8098013">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="8098059">,</span>&nbsp;<span class="string" id="8098061">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="8098072">,</span>&nbsp;<span class="ident" id="8098074">tVal</span><span class="op" id="8098078">,</span>&nbsp;<span class="ident" id="8098080">true</span><span class="op" id="8098084">}</span><span class="op" id="8098085">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8098089">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8098141">{</span><span class="string" id="8098142">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="8098160">,</span>&nbsp;<span class="string" id="8098162">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="8098180">,</span>&nbsp;<span class="string" id="8098182">&#34;oneArg=joe&#34;</span><span class="op" id="8098194">,</span>&nbsp;<span class="ident" id="8098196">tVal</span><span class="op" id="8098200">,</span>&nbsp;<span class="ident" id="8098202">true</span><span class="op" id="8098206">}</span><span class="op" id="8098207">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8098210">{</span><span class="string" id="8098211">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="8098223">,</span>&nbsp;<span class="string" id="8098225">`{{oneArg&nbsp;.}}`</span><span class="op" id="8098239">,</span>&nbsp;<span class="string" id="8098241">&#34;oneArg=joe&#34;</span><span class="op" id="8098253">,</span>&nbsp;<span class="string" id="8098255">&#34;joe&#34;</span><span class="op" id="8098260">,</span>&nbsp;<span class="ident" id="8098262">true</span><span class="op" id="8098266">}</span><span class="op" id="8098267">,</span><br>
<span class="lineno"></span><span class="op" id="8098269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8098272">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="8098313">const</span>&nbsp;<span class="ident" id="8098319">multiText1</span>&nbsp;<span class="op" id="8098330">=</span>&nbsp;<span class="string" id="8098332">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8098396">const</span>&nbsp;<span class="ident" id="8098402">multiText2</span>&nbsp;<span class="op" id="8098413">=</span>&nbsp;<span class="string" id="8098415">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8098498">func</span>&nbsp;<span class="ident" id="8098503">TestMultiExecute</span><span class="op" id="8098519">(</span><span class="ident" id="8098520">t</span>&nbsp;<span class="op" id="8098522">*</span><span class="ident" id="8098523">testing</span><span class="op" id="8098530">.</span><span class="ident" id="8098531">T</span><span class="op" id="8098532">)</span>&nbsp;<span class="op" id="8098534">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8098537">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098578">template</span><span class="op" id="8098586">,</span>&nbsp;<span class="ident" id="8098588">err</span>&nbsp;<span class="op" id="8098592">:=</span>&nbsp;<span class="ident" id="8098595">New</span><span class="op" id="8098598">(</span><span class="string" id="8098599">&#34;root&#34;</span><span class="op" id="8098605">)</span><span class="op" id="8098606">.</span><span class="ident" id="8098607">Parse</span><span class="op" id="8098612">(</span><span class="ident" id="8098613">multiText1</span><span class="op" id="8098623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8098626">if</span>&nbsp;<span class="ident" id="8098629">err</span>&nbsp;<span class="op" id="8098633">!=</span>&nbsp;<span class="ident" id="8098636">nil</span>&nbsp;<span class="op" id="8098640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098644">t</span><span class="op" id="8098645">.</span><span class="ident" id="8098646">Fatalf</span><span class="op" id="8098652">(</span><span class="string" id="8098653">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="8098676">,</span>&nbsp;<span class="ident" id="8098678">err</span><span class="op" id="8098681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8098684">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098687">_</span><span class="op" id="8098688">,</span>&nbsp;<span class="ident" id="8098690">err</span>&nbsp;<span class="op" id="8098694">=</span>&nbsp;<span class="ident" id="8098696">template</span><span class="op" id="8098704">.</span><span class="ident" id="8098705">Parse</span><span class="op" id="8098710">(</span><span class="ident" id="8098711">multiText2</span><span class="op" id="8098721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8098724">if</span>&nbsp;<span class="ident" id="8098727">err</span>&nbsp;<span class="op" id="8098731">!=</span>&nbsp;<span class="ident" id="8098734">nil</span>&nbsp;<span class="op" id="8098738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098742">t</span><span class="op" id="8098743">.</span><span class="ident" id="8098744">Fatalf</span><span class="op" id="8098750">(</span><span class="string" id="8098751">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="8098774">,</span>&nbsp;<span class="ident" id="8098776">err</span><span class="op" id="8098779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8098782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098785">testExecute</span><span class="op" id="8098796">(</span><span class="ident" id="8098797">multiExecTests</span><span class="op" id="8098811">,</span>&nbsp;<span class="ident" id="8098813">template</span><span class="op" id="8098821">,</span>&nbsp;<span class="ident" id="8098823">t</span><span class="op" id="8098824">)</span><br>
<span class="lineno">125</span><span class="op" id="8098826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8098829">func</span>&nbsp;<span class="ident" id="8098834">TestParseFiles</span><span class="op" id="8098848">(</span><span class="ident" id="8098849">t</span>&nbsp;<span class="op" id="8098851">*</span><span class="ident" id="8098852">testing</span><span class="op" id="8098859">.</span><span class="ident" id="8098860">T</span><span class="op" id="8098861">)</span>&nbsp;<span class="op" id="8098863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098866">_</span><span class="op" id="8098867">,</span>&nbsp;<span class="ident" id="8098869">err</span>&nbsp;<span class="op" id="8098873">:=</span>&nbsp;<span class="ident" id="8098876">ParseFiles</span><span class="op" id="8098886">(</span><span class="string" id="8098887">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8098903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8098906">if</span>&nbsp;<span class="ident" id="8098909">err</span>&nbsp;<span class="op" id="8098913">==</span>&nbsp;<span class="ident" id="8098916">nil</span>&nbsp;<span class="op" id="8098920">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098924">t</span><span class="op" id="8098925">.</span><span class="ident" id="8098926">Error</span><span class="op" id="8098931">(</span><span class="string" id="8098932">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8098980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8098983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8098986">template</span>&nbsp;<span class="op" id="8098995">:=</span>&nbsp;<span class="ident" id="8098998">New</span><span class="op" id="8099001">(</span><span class="string" id="8099002">&#34;root&#34;</span><span class="op" id="8099008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099011">_</span><span class="op" id="8099012">,</span>&nbsp;<span class="ident" id="8099014">err</span>&nbsp;<span class="op" id="8099018">=</span>&nbsp;<span class="ident" id="8099020">template</span><span class="op" id="8099028">.</span><span class="ident" id="8099029">ParseFiles</span><span class="op" id="8099039">(</span><span class="string" id="8099040">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="8099061">,</span>&nbsp;<span class="string" id="8099063">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="8099084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8099087">if</span>&nbsp;<span class="ident" id="8099090">err</span>&nbsp;<span class="op" id="8099094">!=</span>&nbsp;<span class="ident" id="8099097">nil</span>&nbsp;<span class="op" id="8099101">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099105">t</span><span class="op" id="8099106">.</span><span class="ident" id="8099107">Fatalf</span><span class="op" id="8099113">(</span><span class="string" id="8099114">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8099139">,</span>&nbsp;<span class="ident" id="8099141">err</span><span class="op" id="8099144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8099147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099150">testExecute</span><span class="op" id="8099161">(</span><span class="ident" id="8099162">multiExecTests</span><span class="op" id="8099176">,</span>&nbsp;<span class="ident" id="8099178">template</span><span class="op" id="8099186">,</span>&nbsp;<span class="ident" id="8099188">t</span><span class="op" id="8099189">)</span><br>
<span class="lineno"></span><span class="op" id="8099191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8099194">func</span>&nbsp;<span class="ident" id="8099199">TestParseGlob</span><span class="op" id="8099212">(</span><span class="ident" id="8099213">t</span>&nbsp;<span class="op" id="8099215">*</span><span class="ident" id="8099216">testing</span><span class="op" id="8099223">.</span><span class="ident" id="8099224">T</span><span class="op" id="8099225">)</span>&nbsp;<span class="op" id="8099227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099230">_</span><span class="op" id="8099231">,</span>&nbsp;<span class="ident" id="8099233">err</span>&nbsp;<span class="op" id="8099237">:=</span>&nbsp;<span class="ident" id="8099240">ParseGlob</span><span class="op" id="8099249">(</span><span class="string" id="8099250">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8099266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8099269">if</span>&nbsp;<span class="ident" id="8099272">err</span>&nbsp;<span class="op" id="8099276">==</span>&nbsp;<span class="ident" id="8099279">nil</span>&nbsp;<span class="op" id="8099283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099287">t</span><span class="op" id="8099288">.</span><span class="ident" id="8099289">Error</span><span class="op" id="8099294">(</span><span class="string" id="8099295">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8099343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8099346">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099349">_</span><span class="op" id="8099350">,</span>&nbsp;<span class="ident" id="8099352">err</span>&nbsp;<span class="op" id="8099356">=</span>&nbsp;<span class="ident" id="8099358">New</span><span class="op" id="8099361">(</span><span class="string" id="8099362">&#34;error&#34;</span><span class="op" id="8099369">)</span><span class="op" id="8099370">.</span><span class="ident" id="8099371">ParseGlob</span><span class="op" id="8099380">(</span><span class="string" id="8099381">&#34;[x&#34;</span><span class="op" id="8099385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8099388">if</span>&nbsp;<span class="ident" id="8099391">err</span>&nbsp;<span class="op" id="8099395">==</span>&nbsp;<span class="ident" id="8099398">nil</span>&nbsp;<span class="op" id="8099402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099406">t</span><span class="op" id="8099407">.</span><span class="ident" id="8099408">Error</span><span class="op" id="8099413">(</span><span class="string" id="8099414">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8099456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8099459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099462">template</span>&nbsp;<span class="op" id="8099471">:=</span>&nbsp;<span class="ident" id="8099474">New</span><span class="op" id="8099477">(</span><span class="string" id="8099478">&#34;root&#34;</span><span class="op" id="8099484">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099487">_</span><span class="op" id="8099488">,</span>&nbsp;<span class="ident" id="8099490">err</span>&nbsp;<span class="op" id="8099494">=</span>&nbsp;<span class="ident" id="8099496">template</span><span class="op" id="8099504">.</span><span class="ident" id="8099505">ParseGlob</span><span class="op" id="8099514">(</span><span class="string" id="8099515">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="8099536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8099539">if</span>&nbsp;<span class="ident" id="8099542">err</span>&nbsp;<span class="op" id="8099546">!=</span>&nbsp;<span class="ident" id="8099549">nil</span>&nbsp;<span class="op" id="8099553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099557">t</span><span class="op" id="8099558">.</span><span class="ident" id="8099559">Fatalf</span><span class="op" id="8099565">(</span><span class="string" id="8099566">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8099591">,</span>&nbsp;<span class="ident" id="8099593">err</span><span class="op" id="8099596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8099599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099602">testExecute</span><span class="op" id="8099613">(</span><span class="ident" id="8099614">multiExecTests</span><span class="op" id="8099628">,</span>&nbsp;<span class="ident" id="8099630">template</span><span class="op" id="8099638">,</span>&nbsp;<span class="ident" id="8099640">t</span><span class="op" id="8099641">)</span><br>
<span class="lineno">155</span><span class="op" id="8099643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8099646">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8099742">var</span>&nbsp;<span class="ident" id="8099746">templateFileExecTests</span>&nbsp;<span class="op" id="8099768">=</span>&nbsp;<span class="op" id="8099770">[</span><span class="op" id="8099771">]</span><span class="ident" id="8099772">execTest</span><span class="op" id="8099780">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8099783">{</span><span class="string" id="8099784">&#34;test&#34;</span><span class="op" id="8099790">,</span>&nbsp;<span class="string" id="8099792">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="8099844">,</span>&nbsp;<span class="string" id="8099846">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="8099880">,</span>&nbsp;<span class="num" id="8099882">0</span><span class="op" id="8099883">,</span>&nbsp;<span class="ident" id="8099885">true</span><span class="op" id="8099889">}</span><span class="op" id="8099890">,</span><br>
<span class="lineno"></span><span class="op" id="8099892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8099895">func</span>&nbsp;<span class="ident" id="8099900">TestParseFilesWithData</span><span class="op" id="8099922">(</span><span class="ident" id="8099923">t</span>&nbsp;<span class="op" id="8099925">*</span><span class="ident" id="8099926">testing</span><span class="op" id="8099933">.</span><span class="ident" id="8099934">T</span><span class="op" id="8099935">)</span>&nbsp;<span class="op" id="8099937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8099940">template</span><span class="op" id="8099948">,</span>&nbsp;<span class="ident" id="8099950">err</span>&nbsp;<span class="op" id="8099954">:=</span>&nbsp;<span class="ident" id="8099957">New</span><span class="op" id="8099960">(</span><span class="string" id="8099961">&#34;root&#34;</span><span class="op" id="8099967">)</span><span class="op" id="8099968">.</span><span class="ident" id="8099969">ParseFiles</span><span class="op" id="8099979">(</span><span class="string" id="8099980">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="8100001">,</span>&nbsp;<span class="string" id="8100003">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="8100024">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100027">if</span>&nbsp;<span class="ident" id="8100030">err</span>&nbsp;<span class="op" id="8100034">!=</span>&nbsp;<span class="ident" id="8100037">nil</span>&nbsp;<span class="op" id="8100041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100045">t</span><span class="op" id="8100046">.</span><span class="ident" id="8100047">Fatalf</span><span class="op" id="8100053">(</span><span class="string" id="8100054">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8100079">,</span>&nbsp;<span class="ident" id="8100081">err</span><span class="op" id="8100084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100090">testExecute</span><span class="op" id="8100101">(</span><span class="ident" id="8100102">templateFileExecTests</span><span class="op" id="8100123">,</span>&nbsp;<span class="ident" id="8100125">template</span><span class="op" id="8100133">,</span>&nbsp;<span class="ident" id="8100135">t</span><span class="op" id="8100136">)</span><br>
<span class="lineno"></span><span class="op" id="8100138">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8100141">func</span>&nbsp;<span class="ident" id="8100146">TestParseGlobWithData</span><span class="op" id="8100167">(</span><span class="ident" id="8100168">t</span>&nbsp;<span class="op" id="8100170">*</span><span class="ident" id="8100171">testing</span><span class="op" id="8100178">.</span><span class="ident" id="8100179">T</span><span class="op" id="8100180">)</span>&nbsp;<span class="op" id="8100182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100185">template</span><span class="op" id="8100193">,</span>&nbsp;<span class="ident" id="8100195">err</span>&nbsp;<span class="op" id="8100199">:=</span>&nbsp;<span class="ident" id="8100202">New</span><span class="op" id="8100205">(</span><span class="string" id="8100206">&#34;root&#34;</span><span class="op" id="8100212">)</span><span class="op" id="8100213">.</span><span class="ident" id="8100214">ParseGlob</span><span class="op" id="8100223">(</span><span class="string" id="8100224">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="8100245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100248">if</span>&nbsp;<span class="ident" id="8100251">err</span>&nbsp;<span class="op" id="8100255">!=</span>&nbsp;<span class="ident" id="8100258">nil</span>&nbsp;<span class="op" id="8100262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100266">t</span><span class="op" id="8100267">.</span><span class="ident" id="8100268">Fatalf</span><span class="op" id="8100274">(</span><span class="string" id="8100275">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8100300">,</span>&nbsp;<span class="ident" id="8100302">err</span><span class="op" id="8100305">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100311">testExecute</span><span class="op" id="8100322">(</span><span class="ident" id="8100323">templateFileExecTests</span><span class="op" id="8100344">,</span>&nbsp;<span class="ident" id="8100346">template</span><span class="op" id="8100354">,</span>&nbsp;<span class="ident" id="8100356">t</span><span class="op" id="8100357">)</span><br>
<span class="lineno"></span><span class="op" id="8100359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8100362">const</span>&nbsp;<span class="op" id="8100368">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100371">cloneText1</span>&nbsp;<span class="op" id="8100382">=</span>&nbsp;<span class="string" id="8100384">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100441">cloneText2</span>&nbsp;<span class="op" id="8100452">=</span>&nbsp;<span class="string" id="8100454">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100480">cloneText3</span>&nbsp;<span class="op" id="8100491">=</span>&nbsp;<span class="string" id="8100493">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100522">cloneText4</span>&nbsp;<span class="op" id="8100533">=</span>&nbsp;<span class="string" id="8100535">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="8100564">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="8100567">func</span>&nbsp;<span class="ident" id="8100572">TestClone</span><span class="op" id="8100581">(</span><span class="ident" id="8100582">t</span>&nbsp;<span class="op" id="8100584">*</span><span class="ident" id="8100585">testing</span><span class="op" id="8100592">.</span><span class="ident" id="8100593">T</span><span class="op" id="8100594">)</span>&nbsp;<span class="op" id="8100596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8100599">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100645">root</span><span class="op" id="8100649">,</span>&nbsp;<span class="ident" id="8100651">err</span>&nbsp;<span class="op" id="8100655">:=</span>&nbsp;<span class="ident" id="8100658">New</span><span class="op" id="8100661">(</span><span class="string" id="8100662">&#34;root&#34;</span><span class="op" id="8100668">)</span><span class="op" id="8100669">.</span><span class="ident" id="8100670">Parse</span><span class="op" id="8100675">(</span><span class="ident" id="8100676">cloneText1</span><span class="op" id="8100686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100689">if</span>&nbsp;<span class="ident" id="8100692">err</span>&nbsp;<span class="op" id="8100696">!=</span>&nbsp;<span class="ident" id="8100699">nil</span>&nbsp;<span class="op" id="8100703">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100707">t</span><span class="op" id="8100708">.</span><span class="ident" id="8100709">Fatal</span><span class="op" id="8100714">(</span><span class="ident" id="8100715">err</span><span class="op" id="8100718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100724">_</span><span class="op" id="8100725">,</span>&nbsp;<span class="ident" id="8100727">err</span>&nbsp;<span class="op" id="8100731">=</span>&nbsp;<span class="ident" id="8100733">root</span><span class="op" id="8100737">.</span><span class="ident" id="8100738">Parse</span><span class="op" id="8100743">(</span><span class="ident" id="8100744">cloneText2</span><span class="op" id="8100754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100757">if</span>&nbsp;<span class="ident" id="8100760">err</span>&nbsp;<span class="op" id="8100764">!=</span>&nbsp;<span class="ident" id="8100767">nil</span>&nbsp;<span class="op" id="8100771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100775">t</span><span class="op" id="8100776">.</span><span class="ident" id="8100777">Fatal</span><span class="op" id="8100782">(</span><span class="ident" id="8100783">err</span><span class="op" id="8100786">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100792">clone</span>&nbsp;<span class="op" id="8100798">:=</span>&nbsp;<span class="ident" id="8100801">Must</span><span class="op" id="8100805">(</span><span class="ident" id="8100806">root</span><span class="op" id="8100810">.</span><span class="ident" id="8100811">Clone</span><span class="op" id="8100816">(</span><span class="op" id="8100817">)</span><span class="op" id="8100818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8100821">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100847">_</span><span class="op" id="8100848">,</span>&nbsp;<span class="ident" id="8100850">err</span>&nbsp;<span class="op" id="8100854">=</span>&nbsp;<span class="ident" id="8100856">root</span><span class="op" id="8100860">.</span><span class="ident" id="8100861">Parse</span><span class="op" id="8100866">(</span><span class="ident" id="8100867">cloneText3</span><span class="op" id="8100877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100880">if</span>&nbsp;<span class="ident" id="8100883">err</span>&nbsp;<span class="op" id="8100887">!=</span>&nbsp;<span class="ident" id="8100890">nil</span>&nbsp;<span class="op" id="8100894">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100898">t</span><span class="op" id="8100899">.</span><span class="ident" id="8100900">Fatal</span><span class="op" id="8100905">(</span><span class="ident" id="8100906">err</span><span class="op" id="8100909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100915">_</span><span class="op" id="8100916">,</span>&nbsp;<span class="ident" id="8100918">err</span>&nbsp;<span class="op" id="8100922">=</span>&nbsp;<span class="ident" id="8100924">clone</span><span class="op" id="8100929">.</span><span class="ident" id="8100930">Parse</span><span class="op" id="8100935">(</span><span class="ident" id="8100936">cloneText4</span><span class="op" id="8100946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8100949">if</span>&nbsp;<span class="ident" id="8100952">err</span>&nbsp;<span class="op" id="8100956">!=</span>&nbsp;<span class="ident" id="8100959">nil</span>&nbsp;<span class="op" id="8100963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8100967">t</span><span class="op" id="8100968">.</span><span class="ident" id="8100969">Fatal</span><span class="op" id="8100974">(</span><span class="ident" id="8100975">err</span><span class="op" id="8100978">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8100981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8100984">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101030">for</span>&nbsp;<span class="ident" id="8101034">k</span><span class="op" id="8101035">,</span>&nbsp;<span class="ident" id="8101037">v</span>&nbsp;<span class="op" id="8101039">:=</span>&nbsp;<span class="keyword" id="8101042">range</span>&nbsp;<span class="ident" id="8101048">clone</span><span class="op" id="8101053">.</span><span class="ident" id="8101054">tmpl</span>&nbsp;<span class="op" id="8101059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101063">if</span>&nbsp;<span class="ident" id="8101066">k</span>&nbsp;<span class="op" id="8101068">==</span>&nbsp;<span class="ident" id="8101071">clone</span><span class="op" id="8101076">.</span><span class="ident" id="8101077">name</span>&nbsp;<span class="op" id="8101082">&amp;&amp;</span>&nbsp;<span class="ident" id="8101085">v</span><span class="op" id="8101086">.</span><span class="ident" id="8101087">tmpl</span><span class="op" id="8101091">[</span><span class="ident" id="8101092">k</span><span class="op" id="8101093">]</span>&nbsp;<span class="op" id="8101095">!=</span>&nbsp;<span class="ident" id="8101098">clone</span>&nbsp;<span class="op" id="8101104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101109">t</span><span class="op" id="8101110">.</span><span class="ident" id="8101111">Error</span><span class="op" id="8101116">(</span><span class="string" id="8101117">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="8101146">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101154">if</span>&nbsp;<span class="ident" id="8101157">v</span>&nbsp;<span class="op" id="8101159">!=</span>&nbsp;<span class="ident" id="8101162">v</span><span class="op" id="8101163">.</span><span class="ident" id="8101164">tmpl</span><span class="op" id="8101168">[</span><span class="ident" id="8101169">v</span><span class="op" id="8101170">.</span><span class="ident" id="8101171">name</span><span class="op" id="8101175">]</span>&nbsp;<span class="op" id="8101177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101182">t</span><span class="op" id="8101183">.</span><span class="ident" id="8101184">Errorf</span><span class="op" id="8101190">(</span><span class="string" id="8101191">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="8101227">,</span>&nbsp;<span class="ident" id="8101229">k</span><span class="op" id="8101230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101237">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8101240">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101258">var</span>&nbsp;<span class="ident" id="8101262">b</span>&nbsp;<span class="ident" id="8101264">bytes</span><span class="op" id="8101269">.</span><span class="ident" id="8101270">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101278">err</span>&nbsp;<span class="op" id="8101282">=</span>&nbsp;<span class="ident" id="8101284">root</span><span class="op" id="8101288">.</span><span class="ident" id="8101289">ExecuteTemplate</span><span class="op" id="8101304">(</span><span class="op" id="8101305">&amp;</span><span class="ident" id="8101306">b</span><span class="op" id="8101307">,</span>&nbsp;<span class="string" id="8101309">&#34;a&#34;</span><span class="op" id="8101312">,</span>&nbsp;<span class="num" id="8101314">0</span><span class="op" id="8101315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101318">if</span>&nbsp;<span class="ident" id="8101321">err</span>&nbsp;<span class="op" id="8101325">!=</span>&nbsp;<span class="ident" id="8101328">nil</span>&nbsp;<span class="op" id="8101332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101336">t</span><span class="op" id="8101337">.</span><span class="ident" id="8101338">Fatal</span><span class="op" id="8101343">(</span><span class="ident" id="8101344">err</span><span class="op" id="8101347">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101353">if</span>&nbsp;<span class="ident" id="8101356">b</span><span class="op" id="8101357">.</span><span class="ident" id="8101358">String</span><span class="op" id="8101364">(</span><span class="op" id="8101365">)</span>&nbsp;<span class="op" id="8101367">!=</span>&nbsp;<span class="string" id="8101370">&#34;broot&#34;</span>&nbsp;<span class="op" id="8101378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101382">t</span><span class="op" id="8101383">.</span><span class="ident" id="8101384">Errorf</span><span class="op" id="8101390">(</span><span class="string" id="8101391">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8101411">,</span>&nbsp;<span class="string" id="8101413">&#34;broot&#34;</span><span class="op" id="8101420">,</span>&nbsp;<span class="ident" id="8101422">b</span><span class="op" id="8101423">.</span><span class="ident" id="8101424">String</span><span class="op" id="8101430">(</span><span class="op" id="8101431">)</span><span class="op" id="8101432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8101438">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101456">b</span><span class="op" id="8101457">.</span><span class="ident" id="8101458">Reset</span><span class="op" id="8101463">(</span><span class="op" id="8101464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101467">err</span>&nbsp;<span class="op" id="8101471">=</span>&nbsp;<span class="ident" id="8101473">clone</span><span class="op" id="8101478">.</span><span class="ident" id="8101479">ExecuteTemplate</span><span class="op" id="8101494">(</span><span class="op" id="8101495">&amp;</span><span class="ident" id="8101496">b</span><span class="op" id="8101497">,</span>&nbsp;<span class="string" id="8101499">&#34;a&#34;</span><span class="op" id="8101502">,</span>&nbsp;<span class="num" id="8101504">0</span><span class="op" id="8101505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101508">if</span>&nbsp;<span class="ident" id="8101511">err</span>&nbsp;<span class="op" id="8101515">!=</span>&nbsp;<span class="ident" id="8101518">nil</span>&nbsp;<span class="op" id="8101522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101526">t</span><span class="op" id="8101527">.</span><span class="ident" id="8101528">Fatal</span><span class="op" id="8101533">(</span><span class="ident" id="8101534">err</span><span class="op" id="8101537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101540">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101543">if</span>&nbsp;<span class="ident" id="8101546">b</span><span class="op" id="8101547">.</span><span class="ident" id="8101548">String</span><span class="op" id="8101554">(</span><span class="op" id="8101555">)</span>&nbsp;<span class="op" id="8101557">!=</span>&nbsp;<span class="string" id="8101560">&#34;bclone&#34;</span>&nbsp;<span class="op" id="8101569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101573">t</span><span class="op" id="8101574">.</span><span class="ident" id="8101575">Errorf</span><span class="op" id="8101581">(</span><span class="string" id="8101582">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8101602">,</span>&nbsp;<span class="string" id="8101604">&#34;bclone&#34;</span><span class="op" id="8101612">,</span>&nbsp;<span class="ident" id="8101614">b</span><span class="op" id="8101615">.</span><span class="ident" id="8101616">String</span><span class="op" id="8101622">(</span><span class="op" id="8101623">)</span><span class="op" id="8101624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101627">}</span><br>
<span class="lineno"></span><span class="op" id="8101629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8101632">func</span>&nbsp;<span class="ident" id="8101637">TestAddParseTree</span><span class="op" id="8101653">(</span><span class="ident" id="8101654">t</span>&nbsp;<span class="op" id="8101656">*</span><span class="ident" id="8101657">testing</span><span class="op" id="8101664">.</span><span class="ident" id="8101665">T</span><span class="op" id="8101666">)</span>&nbsp;<span class="op" id="8101668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8101671">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101698">root</span><span class="op" id="8101702">,</span>&nbsp;<span class="ident" id="8101704">err</span>&nbsp;<span class="op" id="8101708">:=</span>&nbsp;<span class="ident" id="8101711">New</span><span class="op" id="8101714">(</span><span class="string" id="8101715">&#34;root&#34;</span><span class="op" id="8101721">)</span><span class="op" id="8101722">.</span><span class="ident" id="8101723">Parse</span><span class="op" id="8101728">(</span><span class="ident" id="8101729">cloneText1</span><span class="op" id="8101739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101742">if</span>&nbsp;<span class="ident" id="8101745">err</span>&nbsp;<span class="op" id="8101749">!=</span>&nbsp;<span class="ident" id="8101752">nil</span>&nbsp;<span class="op" id="8101756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101760">t</span><span class="op" id="8101761">.</span><span class="ident" id="8101762">Fatal</span><span class="op" id="8101767">(</span><span class="ident" id="8101768">err</span><span class="op" id="8101771">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101777">_</span><span class="op" id="8101778">,</span>&nbsp;<span class="ident" id="8101780">err</span>&nbsp;<span class="op" id="8101784">=</span>&nbsp;<span class="ident" id="8101786">root</span><span class="op" id="8101790">.</span><span class="ident" id="8101791">Parse</span><span class="op" id="8101796">(</span><span class="ident" id="8101797">cloneText2</span><span class="op" id="8101807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101810">if</span>&nbsp;<span class="ident" id="8101813">err</span>&nbsp;<span class="op" id="8101817">!=</span>&nbsp;<span class="ident" id="8101820">nil</span>&nbsp;<span class="op" id="8101824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101828">t</span><span class="op" id="8101829">.</span><span class="ident" id="8101830">Fatal</span><span class="op" id="8101835">(</span><span class="ident" id="8101836">err</span><span class="op" id="8101839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101842">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8101845">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101871">tree</span><span class="op" id="8101875">,</span>&nbsp;<span class="ident" id="8101877">err</span>&nbsp;<span class="op" id="8101881">:=</span>&nbsp;<span class="ident" id="8101884">parse</span><span class="op" id="8101889">.</span><span class="ident" id="8101890">Parse</span><span class="op" id="8101895">(</span><span class="string" id="8101896">&#34;cloneText3&#34;</span><span class="op" id="8101908">,</span>&nbsp;<span class="ident" id="8101910">cloneText3</span><span class="op" id="8101920">,</span>&nbsp;<span class="string" id="8101922">&#34;&#34;</span><span class="op" id="8101924">,</span>&nbsp;<span class="string" id="8101926">&#34;&#34;</span><span class="op" id="8101928">,</span>&nbsp;<span class="ident" id="8101930">nil</span><span class="op" id="8101933">,</span>&nbsp;<span class="ident" id="8101935">builtins</span><span class="op" id="8101943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8101946">if</span>&nbsp;<span class="ident" id="8101949">err</span>&nbsp;<span class="op" id="8101953">!=</span>&nbsp;<span class="ident" id="8101956">nil</span>&nbsp;<span class="op" id="8101960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101964">t</span><span class="op" id="8101965">.</span><span class="ident" id="8101966">Fatal</span><span class="op" id="8101971">(</span><span class="ident" id="8101972">err</span><span class="op" id="8101975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8101978">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8101981">added</span><span class="op" id="8101986">,</span>&nbsp;<span class="ident" id="8101988">err</span>&nbsp;<span class="op" id="8101992">:=</span>&nbsp;<span class="ident" id="8101995">root</span><span class="op" id="8101999">.</span><span class="ident" id="8102000">AddParseTree</span><span class="op" id="8102012">(</span><span class="string" id="8102013">&#34;c&#34;</span><span class="op" id="8102016">,</span>&nbsp;<span class="ident" id="8102018">tree</span><span class="op" id="8102022">[</span><span class="string" id="8102023">&#34;c&#34;</span><span class="op" id="8102026">]</span><span class="op" id="8102027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8102030">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102043">var</span>&nbsp;<span class="ident" id="8102047">b</span>&nbsp;<span class="ident" id="8102049">bytes</span><span class="op" id="8102054">.</span><span class="ident" id="8102055">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102063">err</span>&nbsp;<span class="op" id="8102067">=</span>&nbsp;<span class="ident" id="8102069">added</span><span class="op" id="8102074">.</span><span class="ident" id="8102075">ExecuteTemplate</span><span class="op" id="8102090">(</span><span class="op" id="8102091">&amp;</span><span class="ident" id="8102092">b</span><span class="op" id="8102093">,</span>&nbsp;<span class="string" id="8102095">&#34;a&#34;</span><span class="op" id="8102098">,</span>&nbsp;<span class="num" id="8102100">0</span><span class="op" id="8102101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102104">if</span>&nbsp;<span class="ident" id="8102107">err</span>&nbsp;<span class="op" id="8102111">!=</span>&nbsp;<span class="ident" id="8102114">nil</span>&nbsp;<span class="op" id="8102118">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102122">t</span><span class="op" id="8102123">.</span><span class="ident" id="8102124">Fatal</span><span class="op" id="8102129">(</span><span class="ident" id="8102130">err</span><span class="op" id="8102133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102139">if</span>&nbsp;<span class="ident" id="8102142">b</span><span class="op" id="8102143">.</span><span class="ident" id="8102144">String</span><span class="op" id="8102150">(</span><span class="op" id="8102151">)</span>&nbsp;<span class="op" id="8102153">!=</span>&nbsp;<span class="string" id="8102156">&#34;broot&#34;</span>&nbsp;<span class="op" id="8102164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102168">t</span><span class="op" id="8102169">.</span><span class="ident" id="8102170">Errorf</span><span class="op" id="8102176">(</span><span class="string" id="8102177">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8102197">,</span>&nbsp;<span class="string" id="8102199">&#34;broot&#34;</span><span class="op" id="8102206">,</span>&nbsp;<span class="ident" id="8102208">b</span><span class="op" id="8102209">.</span><span class="ident" id="8102210">String</span><span class="op" id="8102216">(</span><span class="op" id="8102217">)</span><span class="op" id="8102218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102221">}</span><br>
<span class="lineno">260</span><span class="op" id="8102223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8102226">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="8102240">func</span>&nbsp;<span class="ident" id="8102245">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="8102279">(</span><span class="ident" id="8102280">t</span>&nbsp;<span class="op" id="8102282">*</span><span class="ident" id="8102283">testing</span><span class="op" id="8102290">.</span><span class="ident" id="8102291">T</span><span class="op" id="8102292">)</span>&nbsp;<span class="op" id="8102294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102297">master</span>&nbsp;<span class="op" id="8102304">:=</span>&nbsp;<span class="string" id="8102307">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102339">tmpl</span>&nbsp;<span class="op" id="8102344">:=</span>&nbsp;<span class="ident" id="8102347">New</span><span class="op" id="8102350">(</span><span class="string" id="8102351">&#34;master&#34;</span><span class="op" id="8102359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102362">tree</span><span class="op" id="8102366">,</span>&nbsp;<span class="ident" id="8102368">err</span>&nbsp;<span class="op" id="8102372">:=</span>&nbsp;<span class="ident" id="8102375">parse</span><span class="op" id="8102380">.</span><span class="ident" id="8102381">Parse</span><span class="op" id="8102386">(</span><span class="string" id="8102387">&#34;master&#34;</span><span class="op" id="8102395">,</span>&nbsp;<span class="ident" id="8102397">master</span><span class="op" id="8102403">,</span>&nbsp;<span class="string" id="8102405">&#34;&#34;</span><span class="op" id="8102407">,</span>&nbsp;<span class="string" id="8102409">&#34;&#34;</span><span class="op" id="8102411">,</span>&nbsp;<span class="ident" id="8102413">nil</span><span class="op" id="8102416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102419">if</span>&nbsp;<span class="ident" id="8102422">err</span>&nbsp;<span class="op" id="8102426">!=</span>&nbsp;<span class="ident" id="8102429">nil</span>&nbsp;<span class="op" id="8102433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102437">t</span><span class="op" id="8102438">.</span><span class="ident" id="8102439">Fatalf</span><span class="op" id="8102445">(</span><span class="string" id="8102446">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="8102472">,</span>&nbsp;<span class="ident" id="8102474">err</span><span class="op" id="8102477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102480">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102483">masterTree</span>&nbsp;<span class="op" id="8102494">:=</span>&nbsp;<span class="ident" id="8102497">tree</span><span class="op" id="8102501">[</span><span class="string" id="8102502">&#34;master&#34;</span><span class="op" id="8102510">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102513">tmpl</span><span class="op" id="8102517">.</span><span class="ident" id="8102518">AddParseTree</span><span class="op" id="8102530">(</span><span class="string" id="8102531">&#34;master&#34;</span><span class="op" id="8102539">,</span>&nbsp;<span class="ident" id="8102541">masterTree</span><span class="op" id="8102551">)</span>&nbsp;<span class="comment" id="8102553">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="8102570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8102573">func</span>&nbsp;<span class="ident" id="8102578">TestRedefinition</span><span class="op" id="8102594">(</span><span class="ident" id="8102595">t</span>&nbsp;<span class="op" id="8102597">*</span><span class="ident" id="8102598">testing</span><span class="op" id="8102605">.</span><span class="ident" id="8102606">T</span><span class="op" id="8102607">)</span>&nbsp;<span class="op" id="8102609">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102612">var</span>&nbsp;<span class="ident" id="8102616">tmpl</span>&nbsp;<span class="op" id="8102621">*</span><span class="ident" id="8102622">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102632">var</span>&nbsp;<span class="ident" id="8102636">err</span>&nbsp;<span class="builtintype" id="8102640">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102647">if</span>&nbsp;<span class="ident" id="8102650">tmpl</span><span class="op" id="8102654">,</span>&nbsp;<span class="ident" id="8102656">err</span>&nbsp;<span class="op" id="8102660">=</span>&nbsp;<span class="ident" id="8102662">New</span><span class="op" id="8102665">(</span><span class="string" id="8102666">&#34;tmpl1&#34;</span><span class="op" id="8102673">)</span><span class="op" id="8102674">.</span><span class="ident" id="8102675">Parse</span><span class="op" id="8102680">(</span><span class="string" id="8102681">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="8102710">)</span><span class="op" id="8102711">;</span>&nbsp;<span class="ident" id="8102713">err</span>&nbsp;<span class="op" id="8102717">!=</span>&nbsp;<span class="ident" id="8102720">nil</span>&nbsp;<span class="op" id="8102724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102728">t</span><span class="op" id="8102729">.</span><span class="ident" id="8102730">Fatalf</span><span class="op" id="8102736">(</span><span class="string" id="8102737">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="8102750">,</span>&nbsp;<span class="ident" id="8102752">err</span><span class="op" id="8102755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102758">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102761">if</span>&nbsp;<span class="ident" id="8102764">_</span><span class="op" id="8102765">,</span>&nbsp;<span class="ident" id="8102767">err</span>&nbsp;<span class="op" id="8102771">=</span>&nbsp;<span class="ident" id="8102773">tmpl</span><span class="op" id="8102777">.</span><span class="ident" id="8102778">Parse</span><span class="op" id="8102783">(</span><span class="string" id="8102784">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8102813">)</span><span class="op" id="8102814">;</span>&nbsp;<span class="ident" id="8102816">err</span>&nbsp;<span class="op" id="8102820">==</span>&nbsp;<span class="ident" id="8102823">nil</span>&nbsp;<span class="op" id="8102827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102831">t</span><span class="op" id="8102832">.</span><span class="ident" id="8102833">Fatal</span><span class="op" id="8102838">(</span><span class="string" id="8102839">&#34;expected&nbsp;error&#34;</span><span class="op" id="8102855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102861">if</span>&nbsp;<span class="op" id="8102864">!</span><span class="ident" id="8102865">strings</span><span class="op" id="8102872">.</span><span class="ident" id="8102873">Contains</span><span class="op" id="8102881">(</span><span class="ident" id="8102882">err</span><span class="op" id="8102885">.</span><span class="ident" id="8102886">Error</span><span class="op" id="8102891">(</span><span class="op" id="8102892">)</span><span class="op" id="8102893">,</span>&nbsp;<span class="string" id="8102895">&#34;redefinition&#34;</span><span class="op" id="8102909">)</span>&nbsp;<span class="op" id="8102911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8102915">t</span><span class="op" id="8102916">.</span><span class="ident" id="8102917">Fatalf</span><span class="op" id="8102923">(</span><span class="string" id="8102924">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8102961">,</span>&nbsp;<span class="ident" id="8102963">err</span><span class="op" id="8102966">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8102969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8102972">if</span>&nbsp;<span class="ident" id="8102975">_</span><span class="op" id="8102976">,</span>&nbsp;<span class="ident" id="8102978">err</span>&nbsp;<span class="op" id="8102982">=</span>&nbsp;<span class="ident" id="8102984">tmpl</span><span class="op" id="8102988">.</span><span class="ident" id="8102989">New</span><span class="op" id="8102992">(</span><span class="string" id="8102993">&#34;tmpl2&#34;</span><span class="op" id="8103000">)</span><span class="op" id="8103001">.</span><span class="ident" id="8103002">Parse</span><span class="op" id="8103007">(</span><span class="string" id="8103008">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8103037">)</span><span class="op" id="8103038">;</span>&nbsp;<span class="ident" id="8103040">err</span>&nbsp;<span class="op" id="8103044">==</span>&nbsp;<span class="ident" id="8103047">nil</span>&nbsp;<span class="op" id="8103051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103055">t</span><span class="op" id="8103056">.</span><span class="ident" id="8103057">Fatal</span><span class="op" id="8103062">(</span><span class="string" id="8103063">&#34;expected&nbsp;error&#34;</span><span class="op" id="8103079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8103085">if</span>&nbsp;<span class="op" id="8103088">!</span><span class="ident" id="8103089">strings</span><span class="op" id="8103096">.</span><span class="ident" id="8103097">Contains</span><span class="op" id="8103105">(</span><span class="ident" id="8103106">err</span><span class="op" id="8103109">.</span><span class="ident" id="8103110">Error</span><span class="op" id="8103115">(</span><span class="op" id="8103116">)</span><span class="op" id="8103117">,</span>&nbsp;<span class="string" id="8103119">&#34;redefinition&#34;</span><span class="op" id="8103133">)</span>&nbsp;<span class="op" id="8103135">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103139">t</span><span class="op" id="8103140">.</span><span class="ident" id="8103141">Fatalf</span><span class="op" id="8103147">(</span><span class="string" id="8103148">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8103185">,</span>&nbsp;<span class="ident" id="8103187">err</span><span class="op" id="8103190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103193">}</span><br>
<span class="lineno"></span><span class="op" id="8103195">}</span>
</div>
</body>
</html>
