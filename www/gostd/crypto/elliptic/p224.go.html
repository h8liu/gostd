<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4468836">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4468892">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4468946">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4468997">package</span>&nbsp;<span class="ident" id="4469005">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4469015">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4469090">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4469108">//</span><br>
<span class="lineno">10</span><span class="comment" id="4469111">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4469191">import</span>&nbsp;<span class="op" id="4469198">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4469201">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4469212">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4469215">var</span>&nbsp;<span class="ident" id="4469219">p224</span>&nbsp;<span class="ident" id="4469224">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4469235">type</span>&nbsp;<span class="ident" id="4469240">p224Curve</span>&nbsp;<span class="keyword" id="4469250">struct</span>&nbsp;<span class="op" id="4469257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4469260">*</span><span class="ident" id="4469261">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469274">gx</span><span class="op" id="4469276">,</span>&nbsp;<span class="ident" id="4469278">gy</span><span class="op" id="4469280">,</span>&nbsp;<span class="ident" id="4469282">b</span>&nbsp;<span class="ident" id="4469284">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4469301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4469304">func</span>&nbsp;<span class="ident" id="4469309">initP224</span><span class="op" id="4469317">(</span><span class="op" id="4469318">)</span>&nbsp;<span class="op" id="4469320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4469323">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469357">p224</span><span class="op" id="4469361">.</span><span class="ident" id="4469362">CurveParams</span>&nbsp;<span class="op" id="4469374">=</span>&nbsp;<span class="builtinfunc" id="4469376">new</span><span class="op" id="4469379">(</span><span class="ident" id="4469380">CurveParams</span><span class="op" id="4469391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469394">p224</span><span class="op" id="4469398">.</span><span class="ident" id="4469399">P</span><span class="op" id="4469400">,</span>&nbsp;<span class="ident" id="4469402">_</span>&nbsp;<span class="op" id="4469404">=</span>&nbsp;<span class="builtinfunc" id="4469406">new</span><span class="op" id="4469409">(</span><span class="ident" id="4469410">big</span><span class="op" id="4469413">.</span><span class="ident" id="4469414">Int</span><span class="op" id="4469417">)</span><span class="op" id="4469418">.</span><span class="ident" id="4469419">SetString</span><span class="op" id="4469428">(</span><span class="string" id="4469429">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4469499">,</span>&nbsp;<span class="num" id="4469501">10</span><span class="op" id="4469503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469506">p224</span><span class="op" id="4469510">.</span><span class="ident" id="4469511">N</span><span class="op" id="4469512">,</span>&nbsp;<span class="ident" id="4469514">_</span>&nbsp;<span class="op" id="4469516">=</span>&nbsp;<span class="builtinfunc" id="4469518">new</span><span class="op" id="4469521">(</span><span class="ident" id="4469522">big</span><span class="op" id="4469525">.</span><span class="ident" id="4469526">Int</span><span class="op" id="4469529">)</span><span class="op" id="4469530">.</span><span class="ident" id="4469531">SetString</span><span class="op" id="4469540">(</span><span class="string" id="4469541">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4469611">,</span>&nbsp;<span class="num" id="4469613">10</span><span class="op" id="4469615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469618">p224</span><span class="op" id="4469622">.</span><span class="ident" id="4469623">B</span><span class="op" id="4469624">,</span>&nbsp;<span class="ident" id="4469626">_</span>&nbsp;<span class="op" id="4469628">=</span>&nbsp;<span class="builtinfunc" id="4469630">new</span><span class="op" id="4469633">(</span><span class="ident" id="4469634">big</span><span class="op" id="4469637">.</span><span class="ident" id="4469638">Int</span><span class="op" id="4469641">)</span><span class="op" id="4469642">.</span><span class="ident" id="4469643">SetString</span><span class="op" id="4469652">(</span><span class="string" id="4469653">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4469711">,</span>&nbsp;<span class="num" id="4469713">16</span><span class="op" id="4469715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469718">p224</span><span class="op" id="4469722">.</span><span class="ident" id="4469723">Gx</span><span class="op" id="4469725">,</span>&nbsp;<span class="ident" id="4469727">_</span>&nbsp;<span class="op" id="4469729">=</span>&nbsp;<span class="builtinfunc" id="4469731">new</span><span class="op" id="4469734">(</span><span class="ident" id="4469735">big</span><span class="op" id="4469738">.</span><span class="ident" id="4469739">Int</span><span class="op" id="4469742">)</span><span class="op" id="4469743">.</span><span class="ident" id="4469744">SetString</span><span class="op" id="4469753">(</span><span class="string" id="4469754">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4469812">,</span>&nbsp;<span class="num" id="4469814">16</span><span class="op" id="4469816">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469819">p224</span><span class="op" id="4469823">.</span><span class="ident" id="4469824">Gy</span><span class="op" id="4469826">,</span>&nbsp;<span class="ident" id="4469828">_</span>&nbsp;<span class="op" id="4469830">=</span>&nbsp;<span class="builtinfunc" id="4469832">new</span><span class="op" id="4469835">(</span><span class="ident" id="4469836">big</span><span class="op" id="4469839">.</span><span class="ident" id="4469840">Int</span><span class="op" id="4469843">)</span><span class="op" id="4469844">.</span><span class="ident" id="4469845">SetString</span><span class="op" id="4469854">(</span><span class="string" id="4469855">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4469913">,</span>&nbsp;<span class="num" id="4469915">16</span><span class="op" id="4469917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469920">p224</span><span class="op" id="4469924">.</span><span class="ident" id="4469925">BitSize</span>&nbsp;<span class="op" id="4469933">=</span>&nbsp;<span class="num" id="4469935">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469941">p224FromBig</span><span class="op" id="4469952">(</span><span class="op" id="4469953">&amp;</span><span class="ident" id="4469954">p224</span><span class="op" id="4469958">.</span><span class="ident" id="4469959">gx</span><span class="op" id="4469961">,</span>&nbsp;<span class="ident" id="4469963">p224</span><span class="op" id="4469967">.</span><span class="ident" id="4469968">Gx</span><span class="op" id="4469970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4469973">p224FromBig</span><span class="op" id="4469984">(</span><span class="op" id="4469985">&amp;</span><span class="ident" id="4469986">p224</span><span class="op" id="4469990">.</span><span class="ident" id="4469991">gy</span><span class="op" id="4469993">,</span>&nbsp;<span class="ident" id="4469995">p224</span><span class="op" id="4469999">.</span><span class="ident" id="4470000">Gy</span><span class="op" id="4470002">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470005">p224FromBig</span><span class="op" id="4470016">(</span><span class="op" id="4470017">&amp;</span><span class="ident" id="4470018">p224</span><span class="op" id="4470022">.</span><span class="ident" id="4470023">b</span><span class="op" id="4470024">,</span>&nbsp;<span class="ident" id="4470026">p224</span><span class="op" id="4470030">.</span><span class="ident" id="4470031">B</span><span class="op" id="4470032">)</span><br>
<span class="lineno"></span><span class="op" id="4470034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4470037">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4470116">func</span>&nbsp;<span class="ident" id="4470121">P224</span><span class="op" id="4470125">(</span><span class="op" id="4470126">)</span>&nbsp;<span class="ident" id="4470128">Curve</span>&nbsp;<span class="op" id="4470134">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470137">initonce</span><span class="op" id="4470145">.</span><span class="ident" id="4470146">Do</span><span class="op" id="4470148">(</span><span class="ident" id="4470149">initAll</span><span class="op" id="4470156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470159">return</span>&nbsp;<span class="ident" id="4470166">p224</span><br>
<span class="lineno"></span><span class="op" id="4470171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4470174">func</span>&nbsp;<span class="op" id="4470179">(</span><span class="ident" id="4470180">curve</span>&nbsp;<span class="ident" id="4470186">p224Curve</span><span class="op" id="4470195">)</span>&nbsp;<span class="ident" id="4470197">Params</span><span class="op" id="4470203">(</span><span class="op" id="4470204">)</span>&nbsp;<span class="op" id="4470206">*</span><span class="ident" id="4470207">CurveParams</span>&nbsp;<span class="op" id="4470219">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470222">return</span>&nbsp;<span class="ident" id="4470229">curve</span><span class="op" id="4470234">.</span><span class="ident" id="4470235">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4470247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4470250">func</span>&nbsp;<span class="op" id="4470255">(</span><span class="ident" id="4470256">curve</span>&nbsp;<span class="ident" id="4470262">p224Curve</span><span class="op" id="4470271">)</span>&nbsp;<span class="ident" id="4470273">IsOnCurve</span><span class="op" id="4470282">(</span><span class="ident" id="4470283">bigX</span><span class="op" id="4470287">,</span>&nbsp;<span class="ident" id="4470289">bigY</span>&nbsp;<span class="op" id="4470294">*</span><span class="ident" id="4470295">big</span><span class="op" id="4470298">.</span><span class="ident" id="4470299">Int</span><span class="op" id="4470302">)</span>&nbsp;<span class="builtintype" id="4470304">bool</span>&nbsp;<span class="op" id="4470309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470312">var</span>&nbsp;<span class="ident" id="4470316">x</span><span class="op" id="4470317">,</span>&nbsp;<span class="ident" id="4470319">y</span>&nbsp;<span class="ident" id="4470321">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470339">p224FromBig</span><span class="op" id="4470350">(</span><span class="op" id="4470351">&amp;</span><span class="ident" id="4470352">x</span><span class="op" id="4470353">,</span>&nbsp;<span class="ident" id="4470355">bigX</span><span class="op" id="4470359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470362">p224FromBig</span><span class="op" id="4470373">(</span><span class="op" id="4470374">&amp;</span><span class="ident" id="4470375">y</span><span class="op" id="4470376">,</span>&nbsp;<span class="ident" id="4470378">bigY</span><span class="op" id="4470382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4470386">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470409">var</span>&nbsp;<span class="ident" id="4470413">tmp</span>&nbsp;<span class="ident" id="4470417">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470440">var</span>&nbsp;<span class="ident" id="4470444">x3</span>&nbsp;<span class="ident" id="4470447">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470465">p224Square</span><span class="op" id="4470475">(</span><span class="op" id="4470476">&amp;</span><span class="ident" id="4470477">x3</span><span class="op" id="4470479">,</span>&nbsp;<span class="op" id="4470481">&amp;</span><span class="ident" id="4470482">x</span><span class="op" id="4470483">,</span>&nbsp;<span class="op" id="4470485">&amp;</span><span class="ident" id="4470486">tmp</span><span class="op" id="4470489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470492">p224Mul</span><span class="op" id="4470499">(</span><span class="op" id="4470500">&amp;</span><span class="ident" id="4470501">x3</span><span class="op" id="4470503">,</span>&nbsp;<span class="op" id="4470505">&amp;</span><span class="ident" id="4470506">x3</span><span class="op" id="4470508">,</span>&nbsp;<span class="op" id="4470510">&amp;</span><span class="ident" id="4470511">x</span><span class="op" id="4470512">,</span>&nbsp;<span class="op" id="4470514">&amp;</span><span class="ident" id="4470515">tmp</span><span class="op" id="4470518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470522">for</span>&nbsp;<span class="ident" id="4470526">i</span>&nbsp;<span class="op" id="4470528">:=</span>&nbsp;<span class="num" id="4470531">0</span><span class="op" id="4470532">;</span>&nbsp;<span class="ident" id="4470534">i</span>&nbsp;<span class="op" id="4470536">&lt;</span>&nbsp;<span class="num" id="4470538">8</span><span class="op" id="4470539">;</span>&nbsp;<span class="ident" id="4470541">i</span><span class="op" id="4470542">++</span>&nbsp;<span class="op" id="4470545">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470549">x</span><span class="op" id="4470550">[</span><span class="ident" id="4470551">i</span><span class="op" id="4470552">]</span>&nbsp;<span class="op" id="4470554">*=</span>&nbsp;<span class="num" id="4470557">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4470560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470563">p224Sub</span><span class="op" id="4470570">(</span><span class="op" id="4470571">&amp;</span><span class="ident" id="4470572">x3</span><span class="op" id="4470574">,</span>&nbsp;<span class="op" id="4470576">&amp;</span><span class="ident" id="4470577">x3</span><span class="op" id="4470579">,</span>&nbsp;<span class="op" id="4470581">&amp;</span><span class="ident" id="4470582">x</span><span class="op" id="4470583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470586">p224Reduce</span><span class="op" id="4470596">(</span><span class="op" id="4470597">&amp;</span><span class="ident" id="4470598">x3</span><span class="op" id="4470600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470603">p224Add</span><span class="op" id="4470610">(</span><span class="op" id="4470611">&amp;</span><span class="ident" id="4470612">x3</span><span class="op" id="4470614">,</span>&nbsp;<span class="op" id="4470616">&amp;</span><span class="ident" id="4470617">x3</span><span class="op" id="4470619">,</span>&nbsp;<span class="op" id="4470621">&amp;</span><span class="ident" id="4470622">curve</span><span class="op" id="4470627">.</span><span class="ident" id="4470628">b</span><span class="op" id="4470629">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470632">p224Contract</span><span class="op" id="4470644">(</span><span class="op" id="4470645">&amp;</span><span class="ident" id="4470646">x3</span><span class="op" id="4470648">,</span>&nbsp;<span class="op" id="4470650">&amp;</span><span class="ident" id="4470651">x3</span><span class="op" id="4470653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470657">p224Square</span><span class="op" id="4470667">(</span><span class="op" id="4470668">&amp;</span><span class="ident" id="4470669">y</span><span class="op" id="4470670">,</span>&nbsp;<span class="op" id="4470672">&amp;</span><span class="ident" id="4470673">y</span><span class="op" id="4470674">,</span>&nbsp;<span class="op" id="4470676">&amp;</span><span class="ident" id="4470677">tmp</span><span class="op" id="4470680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470683">p224Contract</span><span class="op" id="4470695">(</span><span class="op" id="4470696">&amp;</span><span class="ident" id="4470697">y</span><span class="op" id="4470698">,</span>&nbsp;<span class="op" id="4470700">&amp;</span><span class="ident" id="4470701">y</span><span class="op" id="4470702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470706">for</span>&nbsp;<span class="ident" id="4470710">i</span>&nbsp;<span class="op" id="4470712">:=</span>&nbsp;<span class="num" id="4470715">0</span><span class="op" id="4470716">;</span>&nbsp;<span class="ident" id="4470718">i</span>&nbsp;<span class="op" id="4470720">&lt;</span>&nbsp;<span class="num" id="4470722">8</span><span class="op" id="4470723">;</span>&nbsp;<span class="ident" id="4470725">i</span><span class="op" id="4470726">++</span>&nbsp;<span class="op" id="4470729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470733">if</span>&nbsp;<span class="ident" id="4470736">y</span><span class="op" id="4470737">[</span><span class="ident" id="4470738">i</span><span class="op" id="4470739">]</span>&nbsp;<span class="op" id="4470741">!=</span>&nbsp;<span class="ident" id="4470744">x3</span><span class="op" id="4470746">[</span><span class="ident" id="4470747">i</span><span class="op" id="4470748">]</span>&nbsp;<span class="op" id="4470750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470755">return</span>&nbsp;<span class="builtintype" id="4470762">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4470770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4470773">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470776">return</span>&nbsp;<span class="builtintype" id="4470783">true</span><br>
<span class="lineno"></span><span class="op" id="4470788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4470791">func</span>&nbsp;<span class="op" id="4470796">(</span><span class="ident" id="4470797">p224Curve</span><span class="op" id="4470806">)</span>&nbsp;<span class="ident" id="4470808">Add</span><span class="op" id="4470811">(</span><span class="ident" id="4470812">bigX1</span><span class="op" id="4470817">,</span>&nbsp;<span class="ident" id="4470819">bigY1</span><span class="op" id="4470824">,</span>&nbsp;<span class="ident" id="4470826">bigX2</span><span class="op" id="4470831">,</span>&nbsp;<span class="ident" id="4470833">bigY2</span>&nbsp;<span class="op" id="4470839">*</span><span class="ident" id="4470840">big</span><span class="op" id="4470843">.</span><span class="ident" id="4470844">Int</span><span class="op" id="4470847">)</span>&nbsp;<span class="op" id="4470849">(</span><span class="ident" id="4470850">x</span><span class="op" id="4470851">,</span>&nbsp;<span class="ident" id="4470853">y</span>&nbsp;<span class="op" id="4470855">*</span><span class="ident" id="4470856">big</span><span class="op" id="4470859">.</span><span class="ident" id="4470860">Int</span><span class="op" id="4470863">)</span>&nbsp;<span class="op" id="4470865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470868">var</span>&nbsp;<span class="ident" id="4470872">x1</span><span class="op" id="4470874">,</span>&nbsp;<span class="ident" id="4470876">y1</span><span class="op" id="4470878">,</span>&nbsp;<span class="ident" id="4470880">z1</span><span class="op" id="4470882">,</span>&nbsp;<span class="ident" id="4470884">x2</span><span class="op" id="4470886">,</span>&nbsp;<span class="ident" id="4470888">y2</span><span class="op" id="4470890">,</span>&nbsp;<span class="ident" id="4470892">z2</span><span class="op" id="4470894">,</span>&nbsp;<span class="ident" id="4470896">x3</span><span class="op" id="4470898">,</span>&nbsp;<span class="ident" id="4470900">y3</span><span class="op" id="4470902">,</span>&nbsp;<span class="ident" id="4470904">z3</span>&nbsp;<span class="ident" id="4470907">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470926">p224FromBig</span><span class="op" id="4470937">(</span><span class="op" id="4470938">&amp;</span><span class="ident" id="4470939">x1</span><span class="op" id="4470941">,</span>&nbsp;<span class="ident" id="4470943">bigX1</span><span class="op" id="4470948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4470951">p224FromBig</span><span class="op" id="4470962">(</span><span class="op" id="4470963">&amp;</span><span class="ident" id="4470964">y1</span><span class="op" id="4470966">,</span>&nbsp;<span class="ident" id="4470968">bigY1</span><span class="op" id="4470973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4470976">if</span>&nbsp;<span class="ident" id="4470979">bigX1</span><span class="op" id="4470984">.</span><span class="ident" id="4470985">Sign</span><span class="op" id="4470989">(</span><span class="op" id="4470990">)</span>&nbsp;<span class="op" id="4470992">!=</span>&nbsp;<span class="num" id="4470995">0</span>&nbsp;<span class="op" id="4470997">||</span>&nbsp;<span class="ident" id="4471000">bigY1</span><span class="op" id="4471005">.</span><span class="ident" id="4471006">Sign</span><span class="op" id="4471010">(</span><span class="op" id="4471011">)</span>&nbsp;<span class="op" id="4471013">!=</span>&nbsp;<span class="num" id="4471016">0</span>&nbsp;<span class="op" id="4471018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471022">z1</span><span class="op" id="4471024">[</span><span class="num" id="4471025">0</span><span class="op" id="4471026">]</span>&nbsp;<span class="op" id="4471028">=</span>&nbsp;<span class="num" id="4471030">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4471033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471036">p224FromBig</span><span class="op" id="4471047">(</span><span class="op" id="4471048">&amp;</span><span class="ident" id="4471049">x2</span><span class="op" id="4471051">,</span>&nbsp;<span class="ident" id="4471053">bigX2</span><span class="op" id="4471058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471061">p224FromBig</span><span class="op" id="4471072">(</span><span class="op" id="4471073">&amp;</span><span class="ident" id="4471074">y2</span><span class="op" id="4471076">,</span>&nbsp;<span class="ident" id="4471078">bigY2</span><span class="op" id="4471083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471086">if</span>&nbsp;<span class="ident" id="4471089">bigX2</span><span class="op" id="4471094">.</span><span class="ident" id="4471095">Sign</span><span class="op" id="4471099">(</span><span class="op" id="4471100">)</span>&nbsp;<span class="op" id="4471102">!=</span>&nbsp;<span class="num" id="4471105">0</span>&nbsp;<span class="op" id="4471107">||</span>&nbsp;<span class="ident" id="4471110">bigY2</span><span class="op" id="4471115">.</span><span class="ident" id="4471116">Sign</span><span class="op" id="4471120">(</span><span class="op" id="4471121">)</span>&nbsp;<span class="op" id="4471123">!=</span>&nbsp;<span class="num" id="4471126">0</span>&nbsp;<span class="op" id="4471128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471132">z2</span><span class="op" id="4471134">[</span><span class="num" id="4471135">0</span><span class="op" id="4471136">]</span>&nbsp;<span class="op" id="4471138">=</span>&nbsp;<span class="num" id="4471140">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4471143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471147">p224AddJacobian</span><span class="op" id="4471162">(</span><span class="op" id="4471163">&amp;</span><span class="ident" id="4471164">x3</span><span class="op" id="4471166">,</span>&nbsp;<span class="op" id="4471168">&amp;</span><span class="ident" id="4471169">y3</span><span class="op" id="4471171">,</span>&nbsp;<span class="op" id="4471173">&amp;</span><span class="ident" id="4471174">z3</span><span class="op" id="4471176">,</span>&nbsp;<span class="op" id="4471178">&amp;</span><span class="ident" id="4471179">x1</span><span class="op" id="4471181">,</span>&nbsp;<span class="op" id="4471183">&amp;</span><span class="ident" id="4471184">y1</span><span class="op" id="4471186">,</span>&nbsp;<span class="op" id="4471188">&amp;</span><span class="ident" id="4471189">z1</span><span class="op" id="4471191">,</span>&nbsp;<span class="op" id="4471193">&amp;</span><span class="ident" id="4471194">x2</span><span class="op" id="4471196">,</span>&nbsp;<span class="op" id="4471198">&amp;</span><span class="ident" id="4471199">y2</span><span class="op" id="4471201">,</span>&nbsp;<span class="op" id="4471203">&amp;</span><span class="ident" id="4471204">z2</span><span class="op" id="4471206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471209">return</span>&nbsp;<span class="ident" id="4471216">p224ToAffine</span><span class="op" id="4471228">(</span><span class="op" id="4471229">&amp;</span><span class="ident" id="4471230">x3</span><span class="op" id="4471232">,</span>&nbsp;<span class="op" id="4471234">&amp;</span><span class="ident" id="4471235">y3</span><span class="op" id="4471237">,</span>&nbsp;<span class="op" id="4471239">&amp;</span><span class="ident" id="4471240">z3</span><span class="op" id="4471242">)</span><br>
<span class="lineno"></span><span class="op" id="4471244">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4471247">func</span>&nbsp;<span class="op" id="4471252">(</span><span class="ident" id="4471253">p224Curve</span><span class="op" id="4471262">)</span>&nbsp;<span class="ident" id="4471264">Double</span><span class="op" id="4471270">(</span><span class="ident" id="4471271">bigX1</span><span class="op" id="4471276">,</span>&nbsp;<span class="ident" id="4471278">bigY1</span>&nbsp;<span class="op" id="4471284">*</span><span class="ident" id="4471285">big</span><span class="op" id="4471288">.</span><span class="ident" id="4471289">Int</span><span class="op" id="4471292">)</span>&nbsp;<span class="op" id="4471294">(</span><span class="ident" id="4471295">x</span><span class="op" id="4471296">,</span>&nbsp;<span class="ident" id="4471298">y</span>&nbsp;<span class="op" id="4471300">*</span><span class="ident" id="4471301">big</span><span class="op" id="4471304">.</span><span class="ident" id="4471305">Int</span><span class="op" id="4471308">)</span>&nbsp;<span class="op" id="4471310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471313">var</span>&nbsp;<span class="ident" id="4471317">x1</span><span class="op" id="4471319">,</span>&nbsp;<span class="ident" id="4471321">y1</span><span class="op" id="4471323">,</span>&nbsp;<span class="ident" id="4471325">z1</span><span class="op" id="4471327">,</span>&nbsp;<span class="ident" id="4471329">x2</span><span class="op" id="4471331">,</span>&nbsp;<span class="ident" id="4471333">y2</span><span class="op" id="4471335">,</span>&nbsp;<span class="ident" id="4471337">z2</span>&nbsp;<span class="ident" id="4471340">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471359">p224FromBig</span><span class="op" id="4471370">(</span><span class="op" id="4471371">&amp;</span><span class="ident" id="4471372">x1</span><span class="op" id="4471374">,</span>&nbsp;<span class="ident" id="4471376">bigX1</span><span class="op" id="4471381">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471384">p224FromBig</span><span class="op" id="4471395">(</span><span class="op" id="4471396">&amp;</span><span class="ident" id="4471397">y1</span><span class="op" id="4471399">,</span>&nbsp;<span class="ident" id="4471401">bigY1</span><span class="op" id="4471406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471409">z1</span><span class="op" id="4471411">[</span><span class="num" id="4471412">0</span><span class="op" id="4471413">]</span>&nbsp;<span class="op" id="4471415">=</span>&nbsp;<span class="num" id="4471417">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471421">p224DoubleJacobian</span><span class="op" id="4471439">(</span><span class="op" id="4471440">&amp;</span><span class="ident" id="4471441">x2</span><span class="op" id="4471443">,</span>&nbsp;<span class="op" id="4471445">&amp;</span><span class="ident" id="4471446">y2</span><span class="op" id="4471448">,</span>&nbsp;<span class="op" id="4471450">&amp;</span><span class="ident" id="4471451">z2</span><span class="op" id="4471453">,</span>&nbsp;<span class="op" id="4471455">&amp;</span><span class="ident" id="4471456">x1</span><span class="op" id="4471458">,</span>&nbsp;<span class="op" id="4471460">&amp;</span><span class="ident" id="4471461">y1</span><span class="op" id="4471463">,</span>&nbsp;<span class="op" id="4471465">&amp;</span><span class="ident" id="4471466">z1</span><span class="op" id="4471468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471471">return</span>&nbsp;<span class="ident" id="4471478">p224ToAffine</span><span class="op" id="4471490">(</span><span class="op" id="4471491">&amp;</span><span class="ident" id="4471492">x2</span><span class="op" id="4471494">,</span>&nbsp;<span class="op" id="4471496">&amp;</span><span class="ident" id="4471497">y2</span><span class="op" id="4471499">,</span>&nbsp;<span class="op" id="4471501">&amp;</span><span class="ident" id="4471502">z2</span><span class="op" id="4471504">)</span><br>
<span class="lineno">105</span><span class="op" id="4471506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4471509">func</span>&nbsp;<span class="op" id="4471514">(</span><span class="ident" id="4471515">p224Curve</span><span class="op" id="4471524">)</span>&nbsp;<span class="ident" id="4471526">ScalarMult</span><span class="op" id="4471536">(</span><span class="ident" id="4471537">bigX1</span><span class="op" id="4471542">,</span>&nbsp;<span class="ident" id="4471544">bigY1</span>&nbsp;<span class="op" id="4471550">*</span><span class="ident" id="4471551">big</span><span class="op" id="4471554">.</span><span class="ident" id="4471555">Int</span><span class="op" id="4471558">,</span>&nbsp;<span class="ident" id="4471560">scalar</span>&nbsp;<span class="op" id="4471567">[</span><span class="op" id="4471568">]</span><span class="builtintype" id="4471569">byte</span><span class="op" id="4471573">)</span>&nbsp;<span class="op" id="4471575">(</span><span class="ident" id="4471576">x</span><span class="op" id="4471577">,</span>&nbsp;<span class="ident" id="4471579">y</span>&nbsp;<span class="op" id="4471581">*</span><span class="ident" id="4471582">big</span><span class="op" id="4471585">.</span><span class="ident" id="4471586">Int</span><span class="op" id="4471589">)</span>&nbsp;<span class="op" id="4471591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471594">var</span>&nbsp;<span class="ident" id="4471598">x1</span><span class="op" id="4471600">,</span>&nbsp;<span class="ident" id="4471602">y1</span><span class="op" id="4471604">,</span>&nbsp;<span class="ident" id="4471606">z1</span><span class="op" id="4471608">,</span>&nbsp;<span class="ident" id="4471610">x2</span><span class="op" id="4471612">,</span>&nbsp;<span class="ident" id="4471614">y2</span><span class="op" id="4471616">,</span>&nbsp;<span class="ident" id="4471618">z2</span>&nbsp;<span class="ident" id="4471621">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471640">p224FromBig</span><span class="op" id="4471651">(</span><span class="op" id="4471652">&amp;</span><span class="ident" id="4471653">x1</span><span class="op" id="4471655">,</span>&nbsp;<span class="ident" id="4471657">bigX1</span><span class="op" id="4471662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471665">p224FromBig</span><span class="op" id="4471676">(</span><span class="op" id="4471677">&amp;</span><span class="ident" id="4471678">y1</span><span class="op" id="4471680">,</span>&nbsp;<span class="ident" id="4471682">bigY1</span><span class="op" id="4471687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471690">z1</span><span class="op" id="4471692">[</span><span class="num" id="4471693">0</span><span class="op" id="4471694">]</span>&nbsp;<span class="op" id="4471696">=</span>&nbsp;<span class="num" id="4471698">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471702">p224ScalarMult</span><span class="op" id="4471716">(</span><span class="op" id="4471717">&amp;</span><span class="ident" id="4471718">x2</span><span class="op" id="4471720">,</span>&nbsp;<span class="op" id="4471722">&amp;</span><span class="ident" id="4471723">y2</span><span class="op" id="4471725">,</span>&nbsp;<span class="op" id="4471727">&amp;</span><span class="ident" id="4471728">z2</span><span class="op" id="4471730">,</span>&nbsp;<span class="op" id="4471732">&amp;</span><span class="ident" id="4471733">x1</span><span class="op" id="4471735">,</span>&nbsp;<span class="op" id="4471737">&amp;</span><span class="ident" id="4471738">y1</span><span class="op" id="4471740">,</span>&nbsp;<span class="op" id="4471742">&amp;</span><span class="ident" id="4471743">z1</span><span class="op" id="4471745">,</span>&nbsp;<span class="ident" id="4471747">scalar</span><span class="op" id="4471753">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471756">return</span>&nbsp;<span class="ident" id="4471763">p224ToAffine</span><span class="op" id="4471775">(</span><span class="op" id="4471776">&amp;</span><span class="ident" id="4471777">x2</span><span class="op" id="4471779">,</span>&nbsp;<span class="op" id="4471781">&amp;</span><span class="ident" id="4471782">y2</span><span class="op" id="4471784">,</span>&nbsp;<span class="op" id="4471786">&amp;</span><span class="ident" id="4471787">z2</span><span class="op" id="4471789">)</span><br>
<span class="lineno"></span><span class="op" id="4471791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4471794">func</span>&nbsp;<span class="op" id="4471799">(</span><span class="ident" id="4471800">curve</span>&nbsp;<span class="ident" id="4471806">p224Curve</span><span class="op" id="4471815">)</span>&nbsp;<span class="ident" id="4471817">ScalarBaseMult</span><span class="op" id="4471831">(</span><span class="ident" id="4471832">scalar</span>&nbsp;<span class="op" id="4471839">[</span><span class="op" id="4471840">]</span><span class="builtintype" id="4471841">byte</span><span class="op" id="4471845">)</span>&nbsp;<span class="op" id="4471847">(</span><span class="ident" id="4471848">x</span><span class="op" id="4471849">,</span>&nbsp;<span class="ident" id="4471851">y</span>&nbsp;<span class="op" id="4471853">*</span><span class="ident" id="4471854">big</span><span class="op" id="4471857">.</span><span class="ident" id="4471858">Int</span><span class="op" id="4471861">)</span>&nbsp;<span class="op" id="4471863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471866">var</span>&nbsp;<span class="ident" id="4471870">z1</span><span class="op" id="4471872">,</span>&nbsp;<span class="ident" id="4471874">x2</span><span class="op" id="4471876">,</span>&nbsp;<span class="ident" id="4471878">y2</span><span class="op" id="4471880">,</span>&nbsp;<span class="ident" id="4471882">z2</span>&nbsp;<span class="ident" id="4471885">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471904">z1</span><span class="op" id="4471906">[</span><span class="num" id="4471907">0</span><span class="op" id="4471908">]</span>&nbsp;<span class="op" id="4471910">=</span>&nbsp;<span class="num" id="4471912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4471915">p224ScalarMult</span><span class="op" id="4471929">(</span><span class="op" id="4471930">&amp;</span><span class="ident" id="4471931">x2</span><span class="op" id="4471933">,</span>&nbsp;<span class="op" id="4471935">&amp;</span><span class="ident" id="4471936">y2</span><span class="op" id="4471938">,</span>&nbsp;<span class="op" id="4471940">&amp;</span><span class="ident" id="4471941">z2</span><span class="op" id="4471943">,</span>&nbsp;<span class="op" id="4471945">&amp;</span><span class="ident" id="4471946">curve</span><span class="op" id="4471951">.</span><span class="ident" id="4471952">gx</span><span class="op" id="4471954">,</span>&nbsp;<span class="op" id="4471956">&amp;</span><span class="ident" id="4471957">curve</span><span class="op" id="4471962">.</span><span class="ident" id="4471963">gy</span><span class="op" id="4471965">,</span>&nbsp;<span class="op" id="4471967">&amp;</span><span class="ident" id="4471968">z1</span><span class="op" id="4471970">,</span>&nbsp;<span class="ident" id="4471972">scalar</span><span class="op" id="4471978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4471981">return</span>&nbsp;<span class="ident" id="4471988">p224ToAffine</span><span class="op" id="4472000">(</span><span class="op" id="4472001">&amp;</span><span class="ident" id="4472002">x2</span><span class="op" id="4472004">,</span>&nbsp;<span class="op" id="4472006">&amp;</span><span class="ident" id="4472007">y2</span><span class="op" id="4472009">,</span>&nbsp;<span class="op" id="4472011">&amp;</span><span class="ident" id="4472012">z2</span><span class="op" id="4472014">)</span><br>
<span class="lineno"></span><span class="op" id="4472016">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4472019">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4472047">//</span><br>
<span class="lineno"></span><span class="comment" id="4472050">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4472129">//</span><br>
<span class="lineno">130</span><span class="comment" id="4472132">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4472210">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4472270">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4472329">//</span><br>
<span class="lineno"></span><span class="comment" id="4472332">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4472412">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4472491">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4472554">type</span>&nbsp;<span class="ident" id="4472559">p224FieldElement</span>&nbsp;<span class="op" id="4472576">[</span><span class="num" id="4472577">8</span><span class="op" id="4472578">]</span><span class="builtintype" id="4472579">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4472587">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4472658">var</span>&nbsp;<span class="ident" id="4472662">p224P</span>&nbsp;<span class="op" id="4472668">=</span>&nbsp;<span class="op" id="4472670">[</span><span class="num" id="4472671">8</span><span class="op" id="4472672">]</span><span class="builtintype" id="4472673">uint32</span><span class="op" id="4472679">{</span><span class="num" id="4472680">1</span><span class="op" id="4472681">,</span>&nbsp;<span class="num" id="4472683">0</span><span class="op" id="4472684">,</span>&nbsp;<span class="num" id="4472686">0</span><span class="op" id="4472687">,</span>&nbsp;<span class="num" id="4472689">0xffff000</span><span class="op" id="4472698">,</span>&nbsp;<span class="num" id="4472700">0xfffffff</span><span class="op" id="4472709">,</span>&nbsp;<span class="num" id="4472711">0xfffffff</span><span class="op" id="4472720">,</span>&nbsp;<span class="num" id="4472722">0xfffffff</span><span class="op" id="4472731">,</span>&nbsp;<span class="num" id="4472733">0xfffffff</span><span class="op" id="4472742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4472745">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4472802">//</span><br>
<span class="lineno"></span><span class="comment" id="4472805">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4472821">func</span>&nbsp;<span class="ident" id="4472826">p224IsZero</span><span class="op" id="4472836">(</span><span class="ident" id="4472837">a</span>&nbsp;<span class="op" id="4472839">*</span><span class="ident" id="4472840">p224FieldElement</span><span class="op" id="4472856">)</span>&nbsp;<span class="builtintype" id="4472858">uint32</span>&nbsp;<span class="op" id="4472865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4472868">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4472938">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4472973">var</span>&nbsp;<span class="ident" id="4472977">minimal</span>&nbsp;<span class="ident" id="4472985">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473003">p224Contract</span><span class="op" id="4473015">(</span><span class="op" id="4473016">&amp;</span><span class="ident" id="4473017">minimal</span><span class="op" id="4473024">,</span>&nbsp;<span class="ident" id="4473026">a</span><span class="op" id="4473027">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4473031">var</span>&nbsp;<span class="ident" id="4473035">isZero</span><span class="op" id="4473041">,</span>&nbsp;<span class="ident" id="4473043">isP</span>&nbsp;<span class="builtintype" id="4473047">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4473055">for</span>&nbsp;<span class="ident" id="4473059">i</span><span class="op" id="4473060">,</span>&nbsp;<span class="ident" id="4473062">v</span>&nbsp;<span class="op" id="4473064">:=</span>&nbsp;<span class="keyword" id="4473067">range</span>&nbsp;<span class="ident" id="4473073">minimal</span>&nbsp;<span class="op" id="4473081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473085">isZero</span>&nbsp;<span class="op" id="4473092">|=</span>&nbsp;<span class="ident" id="4473095">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473099">isP</span>&nbsp;<span class="op" id="4473103">|=</span>&nbsp;<span class="ident" id="4473106">v</span>&nbsp;<span class="op" id="4473108">-</span>&nbsp;<span class="ident" id="4473110">p224P</span><span class="op" id="4473115">[</span><span class="ident" id="4473116">i</span><span class="op" id="4473117">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4473120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4473124">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473183">isZero</span>&nbsp;<span class="op" id="4473190">|=</span>&nbsp;<span class="ident" id="4473193">isZero</span>&nbsp;<span class="op" id="4473200">&gt;&gt;</span>&nbsp;<span class="num" id="4473203">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473207">isZero</span>&nbsp;<span class="op" id="4473214">|=</span>&nbsp;<span class="ident" id="4473217">isZero</span>&nbsp;<span class="op" id="4473224">&gt;&gt;</span>&nbsp;<span class="num" id="4473227">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473230">isZero</span>&nbsp;<span class="op" id="4473237">|=</span>&nbsp;<span class="ident" id="4473240">isZero</span>&nbsp;<span class="op" id="4473247">&gt;&gt;</span>&nbsp;<span class="num" id="4473250">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473253">isZero</span>&nbsp;<span class="op" id="4473260">|=</span>&nbsp;<span class="ident" id="4473263">isZero</span>&nbsp;<span class="op" id="4473270">&gt;&gt;</span>&nbsp;<span class="num" id="4473273">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473276">isZero</span>&nbsp;<span class="op" id="4473283">|=</span>&nbsp;<span class="ident" id="4473286">isZero</span>&nbsp;<span class="op" id="4473293">&gt;&gt;</span>&nbsp;<span class="num" id="4473296">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473300">isP</span>&nbsp;<span class="op" id="4473304">|=</span>&nbsp;<span class="ident" id="4473307">isP</span>&nbsp;<span class="op" id="4473311">&gt;&gt;</span>&nbsp;<span class="num" id="4473314">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473318">isP</span>&nbsp;<span class="op" id="4473322">|=</span>&nbsp;<span class="ident" id="4473325">isP</span>&nbsp;<span class="op" id="4473329">&gt;&gt;</span>&nbsp;<span class="num" id="4473332">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473335">isP</span>&nbsp;<span class="op" id="4473339">|=</span>&nbsp;<span class="ident" id="4473342">isP</span>&nbsp;<span class="op" id="4473346">&gt;&gt;</span>&nbsp;<span class="num" id="4473349">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473352">isP</span>&nbsp;<span class="op" id="4473356">|=</span>&nbsp;<span class="ident" id="4473359">isP</span>&nbsp;<span class="op" id="4473363">&gt;&gt;</span>&nbsp;<span class="num" id="4473366">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473369">isP</span>&nbsp;<span class="op" id="4473373">|=</span>&nbsp;<span class="ident" id="4473376">isP</span>&nbsp;<span class="op" id="4473380">&gt;&gt;</span>&nbsp;<span class="num" id="4473383">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4473387">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473451">result</span>&nbsp;<span class="op" id="4473458">:=</span>&nbsp;<span class="ident" id="4473461">isZero</span>&nbsp;<span class="op" id="4473468">&amp;</span>&nbsp;<span class="ident" id="4473470">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473475">result</span>&nbsp;<span class="op" id="4473482">=</span>&nbsp;<span class="op" id="4473484">(</span><span class="op" id="4473485">^</span><span class="ident" id="4473486">result</span><span class="op" id="4473492">)</span>&nbsp;<span class="op" id="4473494">&amp;</span>&nbsp;<span class="num" id="4473496">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4473500">return</span>&nbsp;<span class="ident" id="4473507">result</span><br>
<span class="lineno">175</span><span class="op" id="4473514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4473517">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4473548">//</span><br>
<span class="lineno"></span><span class="comment" id="4473551">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4473574">func</span>&nbsp;<span class="ident" id="4473579">p224Add</span><span class="op" id="4473586">(</span><span class="ident" id="4473587">out</span><span class="op" id="4473590">,</span>&nbsp;<span class="ident" id="4473592">a</span><span class="op" id="4473593">,</span>&nbsp;<span class="ident" id="4473595">b</span>&nbsp;<span class="op" id="4473597">*</span><span class="ident" id="4473598">p224FieldElement</span><span class="op" id="4473614">)</span>&nbsp;<span class="op" id="4473616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4473619">for</span>&nbsp;<span class="ident" id="4473623">i</span>&nbsp;<span class="op" id="4473625">:=</span>&nbsp;<span class="num" id="4473628">0</span><span class="op" id="4473629">;</span>&nbsp;<span class="ident" id="4473631">i</span>&nbsp;<span class="op" id="4473633">&lt;</span>&nbsp;<span class="num" id="4473635">8</span><span class="op" id="4473636">;</span>&nbsp;<span class="ident" id="4473638">i</span><span class="op" id="4473639">++</span>&nbsp;<span class="op" id="4473642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4473646">out</span><span class="op" id="4473649">[</span><span class="ident" id="4473650">i</span><span class="op" id="4473651">]</span>&nbsp;<span class="op" id="4473653">=</span>&nbsp;<span class="ident" id="4473655">a</span><span class="op" id="4473656">[</span><span class="ident" id="4473657">i</span><span class="op" id="4473658">]</span>&nbsp;<span class="op" id="4473660">+</span>&nbsp;<span class="ident" id="4473662">b</span><span class="op" id="4473663">[</span><span class="ident" id="4473664">i</span><span class="op" id="4473665">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4473668">}</span><br>
<span class="lineno"></span><span class="op" id="4473670">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4473673">const</span>&nbsp;<span class="ident" id="4473679">two31p3</span>&nbsp;<span class="op" id="4473687">=</span>&nbsp;<span class="num" id="4473689">1</span><span class="op" id="4473690">&lt;&lt;</span><span class="num" id="4473692">31</span>&nbsp;<span class="op" id="4473695">+</span>&nbsp;<span class="num" id="4473697">1</span><span class="op" id="4473698">&lt;&lt;</span><span class="num" id="4473700">3</span><br>
<span class="lineno"></span><span class="keyword" id="4473702">const</span>&nbsp;<span class="ident" id="4473708">two31m3</span>&nbsp;<span class="op" id="4473716">=</span>&nbsp;<span class="num" id="4473718">1</span><span class="op" id="4473719">&lt;&lt;</span><span class="num" id="4473721">31</span>&nbsp;<span class="op" id="4473724">-</span>&nbsp;<span class="num" id="4473726">1</span><span class="op" id="4473727">&lt;&lt;</span><span class="num" id="4473729">3</span><br>
<span class="lineno"></span><span class="keyword" id="4473731">const</span>&nbsp;<span class="ident" id="4473737">two31m15m3</span>&nbsp;<span class="op" id="4473748">=</span>&nbsp;<span class="num" id="4473750">1</span><span class="op" id="4473751">&lt;&lt;</span><span class="num" id="4473753">31</span>&nbsp;<span class="op" id="4473756">-</span>&nbsp;<span class="num" id="4473758">1</span><span class="op" id="4473759">&lt;&lt;</span><span class="num" id="4473761">15</span>&nbsp;<span class="op" id="4473764">-</span>&nbsp;<span class="num" id="4473766">1</span><span class="op" id="4473767">&lt;&lt;</span><span class="num" id="4473769">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4473772">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4473849">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4473929">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4473951">var</span>&nbsp;<span class="ident" id="4473955">p224ZeroModP31</span>&nbsp;<span class="op" id="4473970">=</span>&nbsp;<span class="op" id="4473972">[</span><span class="op" id="4473973">]</span><span class="builtintype" id="4473974">uint32</span><span class="op" id="4473980">{</span><span class="ident" id="4473981">two31p3</span><span class="op" id="4473988">,</span>&nbsp;<span class="ident" id="4473990">two31m3</span><span class="op" id="4473997">,</span>&nbsp;<span class="ident" id="4473999">two31m3</span><span class="op" id="4474006">,</span>&nbsp;<span class="ident" id="4474008">two31m15m3</span><span class="op" id="4474018">,</span>&nbsp;<span class="ident" id="4474020">two31m3</span><span class="op" id="4474027">,</span>&nbsp;<span class="ident" id="4474029">two31m3</span><span class="op" id="4474036">,</span>&nbsp;<span class="ident" id="4474038">two31m3</span><span class="op" id="4474045">,</span>&nbsp;<span class="ident" id="4474047">two31m3</span><span class="op" id="4474054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4474057">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4474088">//</span><br>
<span class="lineno"></span><span class="comment" id="4474091">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4474113">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4474131">func</span>&nbsp;<span class="ident" id="4474136">p224Sub</span><span class="op" id="4474143">(</span><span class="ident" id="4474144">out</span><span class="op" id="4474147">,</span>&nbsp;<span class="ident" id="4474149">a</span><span class="op" id="4474150">,</span>&nbsp;<span class="ident" id="4474152">b</span>&nbsp;<span class="op" id="4474154">*</span><span class="ident" id="4474155">p224FieldElement</span><span class="op" id="4474171">)</span>&nbsp;<span class="op" id="4474173">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4474176">for</span>&nbsp;<span class="ident" id="4474180">i</span>&nbsp;<span class="op" id="4474182">:=</span>&nbsp;<span class="num" id="4474185">0</span><span class="op" id="4474186">;</span>&nbsp;<span class="ident" id="4474188">i</span>&nbsp;<span class="op" id="4474190">&lt;</span>&nbsp;<span class="num" id="4474192">8</span><span class="op" id="4474193">;</span>&nbsp;<span class="ident" id="4474195">i</span><span class="op" id="4474196">++</span>&nbsp;<span class="op" id="4474199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4474203">out</span><span class="op" id="4474206">[</span><span class="ident" id="4474207">i</span><span class="op" id="4474208">]</span>&nbsp;<span class="op" id="4474210">=</span>&nbsp;<span class="ident" id="4474212">a</span><span class="op" id="4474213">[</span><span class="ident" id="4474214">i</span><span class="op" id="4474215">]</span>&nbsp;<span class="op" id="4474217">+</span>&nbsp;<span class="ident" id="4474219">p224ZeroModP31</span><span class="op" id="4474233">[</span><span class="ident" id="4474234">i</span><span class="op" id="4474235">]</span>&nbsp;<span class="op" id="4474237">-</span>&nbsp;<span class="ident" id="4474239">b</span><span class="op" id="4474240">[</span><span class="ident" id="4474241">i</span><span class="op" id="4474242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4474245">}</span><br>
<span class="lineno"></span><span class="op" id="4474247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4474250">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4474326">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4474404">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4474452">type</span>&nbsp;<span class="ident" id="4474457">p224LargeFieldElement</span>&nbsp;<span class="op" id="4474479">[</span><span class="num" id="4474480">15</span><span class="op" id="4474482">]</span><span class="ident" id="4474483">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4474491">const</span>&nbsp;<span class="ident" id="4474497">two63p35</span>&nbsp;<span class="op" id="4474506">=</span>&nbsp;<span class="num" id="4474508">1</span><span class="op" id="4474509">&lt;&lt;</span><span class="num" id="4474511">63</span>&nbsp;<span class="op" id="4474514">+</span>&nbsp;<span class="num" id="4474516">1</span><span class="op" id="4474517">&lt;&lt;</span><span class="num" id="4474519">35</span><br>
<span class="lineno"></span><span class="keyword" id="4474522">const</span>&nbsp;<span class="ident" id="4474528">two63m35</span>&nbsp;<span class="op" id="4474537">=</span>&nbsp;<span class="num" id="4474539">1</span><span class="op" id="4474540">&lt;&lt;</span><span class="num" id="4474542">63</span>&nbsp;<span class="op" id="4474545">-</span>&nbsp;<span class="num" id="4474547">1</span><span class="op" id="4474548">&lt;&lt;</span><span class="num" id="4474550">35</span><br>
<span class="lineno"></span><span class="keyword" id="4474553">const</span>&nbsp;<span class="ident" id="4474559">two63m35m19</span>&nbsp;<span class="op" id="4474571">=</span>&nbsp;<span class="num" id="4474573">1</span><span class="op" id="4474574">&lt;&lt;</span><span class="num" id="4474576">63</span>&nbsp;<span class="op" id="4474579">-</span>&nbsp;<span class="num" id="4474581">1</span><span class="op" id="4474582">&lt;&lt;</span><span class="num" id="4474584">35</span>&nbsp;<span class="op" id="4474587">-</span>&nbsp;<span class="num" id="4474589">1</span><span class="op" id="4474590">&lt;&lt;</span><span class="num" id="4474592">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4474596">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4474675">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4474708">var</span>&nbsp;<span class="ident" id="4474712">p224ZeroModP63</span>&nbsp;<span class="op" id="4474727">=</span>&nbsp;<span class="op" id="4474729">[</span><span class="num" id="4474730">8</span><span class="op" id="4474731">]</span><span class="ident" id="4474732">uint64</span><span class="op" id="4474738">{</span><span class="ident" id="4474739">two63p35</span><span class="op" id="4474747">,</span>&nbsp;<span class="ident" id="4474749">two63m35</span><span class="op" id="4474757">,</span>&nbsp;<span class="ident" id="4474759">two63m35</span><span class="op" id="4474767">,</span>&nbsp;<span class="ident" id="4474769">two63m35</span><span class="op" id="4474777">,</span>&nbsp;<span class="ident" id="4474779">two63m35m19</span><span class="op" id="4474790">,</span>&nbsp;<span class="ident" id="4474792">two63m35</span><span class="op" id="4474800">,</span>&nbsp;<span class="ident" id="4474802">two63m35</span><span class="op" id="4474810">,</span>&nbsp;<span class="ident" id="4474812">two63m35</span><span class="op" id="4474820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4474823">const</span>&nbsp;<span class="ident" id="4474829">bottom12Bits</span>&nbsp;<span class="op" id="4474842">=</span>&nbsp;<span class="num" id="4474844">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4474850">const</span>&nbsp;<span class="ident" id="4474856">bottom28Bits</span>&nbsp;<span class="op" id="4474869">=</span>&nbsp;<span class="num" id="4474871">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4474882">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4474913">//</span><br>
<span class="lineno"></span><span class="comment" id="4474916">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4474962">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4474980">func</span>&nbsp;<span class="ident" id="4474985">p224Mul</span><span class="op" id="4474992">(</span><span class="ident" id="4474993">out</span><span class="op" id="4474996">,</span>&nbsp;<span class="ident" id="4474998">a</span><span class="op" id="4474999">,</span>&nbsp;<span class="ident" id="4475001">b</span>&nbsp;<span class="op" id="4475003">*</span><span class="ident" id="4475004">p224FieldElement</span><span class="op" id="4475020">,</span>&nbsp;<span class="ident" id="4475022">tmp</span>&nbsp;<span class="op" id="4475026">*</span><span class="ident" id="4475027">p224LargeFieldElement</span><span class="op" id="4475048">)</span>&nbsp;<span class="op" id="4475050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475053">for</span>&nbsp;<span class="ident" id="4475057">i</span>&nbsp;<span class="op" id="4475059">:=</span>&nbsp;<span class="num" id="4475062">0</span><span class="op" id="4475063">;</span>&nbsp;<span class="ident" id="4475065">i</span>&nbsp;<span class="op" id="4475067">&lt;</span>&nbsp;<span class="num" id="4475069">15</span><span class="op" id="4475071">;</span>&nbsp;<span class="ident" id="4475073">i</span><span class="op" id="4475074">++</span>&nbsp;<span class="op" id="4475077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475081">tmp</span><span class="op" id="4475084">[</span><span class="ident" id="4475085">i</span><span class="op" id="4475086">]</span>&nbsp;<span class="op" id="4475088">=</span>&nbsp;<span class="num" id="4475090">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475097">for</span>&nbsp;<span class="ident" id="4475101">i</span>&nbsp;<span class="op" id="4475103">:=</span>&nbsp;<span class="num" id="4475106">0</span><span class="op" id="4475107">;</span>&nbsp;<span class="ident" id="4475109">i</span>&nbsp;<span class="op" id="4475111">&lt;</span>&nbsp;<span class="num" id="4475113">8</span><span class="op" id="4475114">;</span>&nbsp;<span class="ident" id="4475116">i</span><span class="op" id="4475117">++</span>&nbsp;<span class="op" id="4475120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475124">for</span>&nbsp;<span class="ident" id="4475128">j</span>&nbsp;<span class="op" id="4475130">:=</span>&nbsp;<span class="num" id="4475133">0</span><span class="op" id="4475134">;</span>&nbsp;<span class="ident" id="4475136">j</span>&nbsp;<span class="op" id="4475138">&lt;</span>&nbsp;<span class="num" id="4475140">8</span><span class="op" id="4475141">;</span>&nbsp;<span class="ident" id="4475143">j</span><span class="op" id="4475144">++</span>&nbsp;<span class="op" id="4475147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475152">tmp</span><span class="op" id="4475155">[</span><span class="ident" id="4475156">i</span><span class="op" id="4475157">+</span><span class="ident" id="4475158">j</span><span class="op" id="4475159">]</span>&nbsp;<span class="op" id="4475161">+=</span>&nbsp;<span class="ident" id="4475164">uint64</span><span class="op" id="4475170">(</span><span class="ident" id="4475171">a</span><span class="op" id="4475172">[</span><span class="ident" id="4475173">i</span><span class="op" id="4475174">]</span><span class="op" id="4475175">)</span>&nbsp;<span class="op" id="4475177">*</span>&nbsp;<span class="ident" id="4475179">uint64</span><span class="op" id="4475185">(</span><span class="ident" id="4475186">b</span><span class="op" id="4475187">[</span><span class="ident" id="4475188">j</span><span class="op" id="4475189">]</span><span class="op" id="4475190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475197">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475201">p224ReduceLarge</span><span class="op" id="4475216">(</span><span class="ident" id="4475217">out</span><span class="op" id="4475220">,</span>&nbsp;<span class="ident" id="4475222">tmp</span><span class="op" id="4475225">)</span><br>
<span class="lineno"></span><span class="op" id="4475227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4475230">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4475260">//</span><br>
<span class="lineno"></span><span class="comment" id="4475263">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4475279">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4475297">func</span>&nbsp;<span class="ident" id="4475302">p224Square</span><span class="op" id="4475312">(</span><span class="ident" id="4475313">out</span><span class="op" id="4475316">,</span>&nbsp;<span class="ident" id="4475318">a</span>&nbsp;<span class="op" id="4475320">*</span><span class="ident" id="4475321">p224FieldElement</span><span class="op" id="4475337">,</span>&nbsp;<span class="ident" id="4475339">tmp</span>&nbsp;<span class="op" id="4475343">*</span><span class="ident" id="4475344">p224LargeFieldElement</span><span class="op" id="4475365">)</span>&nbsp;<span class="op" id="4475367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475370">for</span>&nbsp;<span class="ident" id="4475374">i</span>&nbsp;<span class="op" id="4475376">:=</span>&nbsp;<span class="num" id="4475379">0</span><span class="op" id="4475380">;</span>&nbsp;<span class="ident" id="4475382">i</span>&nbsp;<span class="op" id="4475384">&lt;</span>&nbsp;<span class="num" id="4475386">15</span><span class="op" id="4475388">;</span>&nbsp;<span class="ident" id="4475390">i</span><span class="op" id="4475391">++</span>&nbsp;<span class="op" id="4475394">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475398">tmp</span><span class="op" id="4475401">[</span><span class="ident" id="4475402">i</span><span class="op" id="4475403">]</span>&nbsp;<span class="op" id="4475405">=</span>&nbsp;<span class="num" id="4475407">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475414">for</span>&nbsp;<span class="ident" id="4475418">i</span>&nbsp;<span class="op" id="4475420">:=</span>&nbsp;<span class="num" id="4475423">0</span><span class="op" id="4475424">;</span>&nbsp;<span class="ident" id="4475426">i</span>&nbsp;<span class="op" id="4475428">&lt;</span>&nbsp;<span class="num" id="4475430">8</span><span class="op" id="4475431">;</span>&nbsp;<span class="ident" id="4475433">i</span><span class="op" id="4475434">++</span>&nbsp;<span class="op" id="4475437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475441">for</span>&nbsp;<span class="ident" id="4475445">j</span>&nbsp;<span class="op" id="4475447">:=</span>&nbsp;<span class="num" id="4475450">0</span><span class="op" id="4475451">;</span>&nbsp;<span class="ident" id="4475453">j</span>&nbsp;<span class="op" id="4475455">&lt;=</span>&nbsp;<span class="ident" id="4475458">i</span><span class="op" id="4475459">;</span>&nbsp;<span class="ident" id="4475461">j</span><span class="op" id="4475462">++</span>&nbsp;<span class="op" id="4475465">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475470">r</span>&nbsp;<span class="op" id="4475472">:=</span>&nbsp;<span class="ident" id="4475475">uint64</span><span class="op" id="4475481">(</span><span class="ident" id="4475482">a</span><span class="op" id="4475483">[</span><span class="ident" id="4475484">i</span><span class="op" id="4475485">]</span><span class="op" id="4475486">)</span>&nbsp;<span class="op" id="4475488">*</span>&nbsp;<span class="ident" id="4475490">uint64</span><span class="op" id="4475496">(</span><span class="ident" id="4475497">a</span><span class="op" id="4475498">[</span><span class="ident" id="4475499">j</span><span class="op" id="4475500">]</span><span class="op" id="4475501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475506">if</span>&nbsp;<span class="ident" id="4475509">i</span>&nbsp;<span class="op" id="4475511">==</span>&nbsp;<span class="ident" id="4475514">j</span>&nbsp;<span class="op" id="4475516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475522">tmp</span><span class="op" id="4475525">[</span><span class="ident" id="4475526">i</span><span class="op" id="4475527">+</span><span class="ident" id="4475528">j</span><span class="op" id="4475529">]</span>&nbsp;<span class="op" id="4475531">+=</span>&nbsp;<span class="ident" id="4475534">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475539">}</span>&nbsp;<span class="keyword" id="4475541">else</span>&nbsp;<span class="op" id="4475546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475552">tmp</span><span class="op" id="4475555">[</span><span class="ident" id="4475556">i</span><span class="op" id="4475557">+</span><span class="ident" id="4475558">j</span><span class="op" id="4475559">]</span>&nbsp;<span class="op" id="4475561">+=</span>&nbsp;<span class="ident" id="4475564">r</span>&nbsp;<span class="op" id="4475566">&lt;&lt;</span>&nbsp;<span class="num" id="4475569">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475585">p224ReduceLarge</span><span class="op" id="4475600">(</span><span class="ident" id="4475601">out</span><span class="op" id="4475604">,</span>&nbsp;<span class="ident" id="4475606">tmp</span><span class="op" id="4475609">)</span><br>
<span class="lineno">260</span><span class="op" id="4475611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4475614">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4475685">//</span><br>
<span class="lineno"></span><span class="comment" id="4475688">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4475705">func</span>&nbsp;<span class="ident" id="4475710">p224ReduceLarge</span><span class="op" id="4475725">(</span><span class="ident" id="4475726">out</span>&nbsp;<span class="op" id="4475730">*</span><span class="ident" id="4475731">p224FieldElement</span><span class="op" id="4475747">,</span>&nbsp;<span class="ident" id="4475749">in</span>&nbsp;<span class="op" id="4475752">*</span><span class="ident" id="4475753">p224LargeFieldElement</span><span class="op" id="4475774">)</span>&nbsp;<span class="op" id="4475776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475779">for</span>&nbsp;<span class="ident" id="4475783">i</span>&nbsp;<span class="op" id="4475785">:=</span>&nbsp;<span class="num" id="4475788">0</span><span class="op" id="4475789">;</span>&nbsp;<span class="ident" id="4475791">i</span>&nbsp;<span class="op" id="4475793">&lt;</span>&nbsp;<span class="num" id="4475795">8</span><span class="op" id="4475796">;</span>&nbsp;<span class="ident" id="4475798">i</span><span class="op" id="4475799">++</span>&nbsp;<span class="op" id="4475802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475806">in</span><span class="op" id="4475808">[</span><span class="ident" id="4475809">i</span><span class="op" id="4475810">]</span>&nbsp;<span class="op" id="4475812">+=</span>&nbsp;<span class="ident" id="4475815">p224ZeroModP63</span><span class="op" id="4475829">[</span><span class="ident" id="4475830">i</span><span class="op" id="4475831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4475834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4475838">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4475892">for</span>&nbsp;<span class="ident" id="4475896">i</span>&nbsp;<span class="op" id="4475898">:=</span>&nbsp;<span class="num" id="4475901">14</span><span class="op" id="4475903">;</span>&nbsp;<span class="ident" id="4475905">i</span>&nbsp;<span class="op" id="4475907">&gt;=</span>&nbsp;<span class="num" id="4475910">8</span><span class="op" id="4475911">;</span>&nbsp;<span class="ident" id="4475913">i</span><span class="op" id="4475914">--</span>&nbsp;<span class="op" id="4475917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475921">in</span><span class="op" id="4475923">[</span><span class="ident" id="4475924">i</span><span class="op" id="4475925">-</span><span class="num" id="4475926">8</span><span class="op" id="4475927">]</span>&nbsp;<span class="op" id="4475929">-=</span>&nbsp;<span class="ident" id="4475932">in</span><span class="op" id="4475934">[</span><span class="ident" id="4475935">i</span><span class="op" id="4475936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475940">in</span><span class="op" id="4475942">[</span><span class="ident" id="4475943">i</span><span class="op" id="4475944">-</span><span class="num" id="4475945">5</span><span class="op" id="4475946">]</span>&nbsp;<span class="op" id="4475948">+=</span>&nbsp;<span class="op" id="4475951">(</span><span class="ident" id="4475952">in</span><span class="op" id="4475954">[</span><span class="ident" id="4475955">i</span><span class="op" id="4475956">]</span>&nbsp;<span class="op" id="4475958">&amp;</span>&nbsp;<span class="num" id="4475960">0xffff</span><span class="op" id="4475966">)</span>&nbsp;<span class="op" id="4475968">&lt;&lt;</span>&nbsp;<span class="num" id="4475971">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4475976">in</span><span class="op" id="4475978">[</span><span class="ident" id="4475979">i</span><span class="op" id="4475980">-</span><span class="num" id="4475981">4</span><span class="op" id="4475982">]</span>&nbsp;<span class="op" id="4475984">+=</span>&nbsp;<span class="ident" id="4475987">in</span><span class="op" id="4475989">[</span><span class="ident" id="4475990">i</span><span class="op" id="4475991">]</span>&nbsp;<span class="op" id="4475993">&gt;&gt;</span>&nbsp;<span class="num" id="4475996">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4476000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476003">in</span><span class="op" id="4476005">[</span><span class="num" id="4476006">8</span><span class="op" id="4476007">]</span>&nbsp;<span class="op" id="4476009">=</span>&nbsp;<span class="num" id="4476011">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476014">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476036">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476107">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4476138">for</span>&nbsp;<span class="ident" id="4476142">i</span>&nbsp;<span class="op" id="4476144">:=</span>&nbsp;<span class="num" id="4476147">1</span><span class="op" id="4476148">;</span>&nbsp;<span class="ident" id="4476150">i</span>&nbsp;<span class="op" id="4476152">&lt;</span>&nbsp;<span class="num" id="4476154">8</span><span class="op" id="4476155">;</span>&nbsp;<span class="ident" id="4476157">i</span><span class="op" id="4476158">++</span>&nbsp;<span class="op" id="4476161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476165">in</span><span class="op" id="4476167">[</span><span class="ident" id="4476168">i</span><span class="op" id="4476169">+</span><span class="num" id="4476170">1</span><span class="op" id="4476171">]</span>&nbsp;<span class="op" id="4476173">+=</span>&nbsp;<span class="ident" id="4476176">in</span><span class="op" id="4476178">[</span><span class="ident" id="4476179">i</span><span class="op" id="4476180">]</span>&nbsp;<span class="op" id="4476182">&gt;&gt;</span>&nbsp;<span class="num" id="4476185">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476190">out</span><span class="op" id="4476193">[</span><span class="ident" id="4476194">i</span><span class="op" id="4476195">]</span>&nbsp;<span class="op" id="4476197">=</span>&nbsp;<span class="builtintype" id="4476199">uint32</span><span class="op" id="4476205">(</span><span class="ident" id="4476206">in</span><span class="op" id="4476208">[</span><span class="ident" id="4476209">i</span><span class="op" id="4476210">]</span>&nbsp;<span class="op" id="4476212">&amp;</span>&nbsp;<span class="ident" id="4476214">bottom28Bits</span><span class="op" id="4476226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4476229">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476232">in</span><span class="op" id="4476234">[</span><span class="num" id="4476235">0</span><span class="op" id="4476236">]</span>&nbsp;<span class="op" id="4476238">-=</span>&nbsp;<span class="ident" id="4476241">in</span><span class="op" id="4476243">[</span><span class="num" id="4476244">8</span><span class="op" id="4476245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476248">out</span><span class="op" id="4476251">[</span><span class="num" id="4476252">3</span><span class="op" id="4476253">]</span>&nbsp;<span class="op" id="4476255">+=</span>&nbsp;<span class="builtintype" id="4476258">uint32</span><span class="op" id="4476264">(</span><span class="ident" id="4476265">in</span><span class="op" id="4476267">[</span><span class="num" id="4476268">8</span><span class="op" id="4476269">]</span><span class="op" id="4476270">&amp;</span><span class="num" id="4476271">0xffff</span><span class="op" id="4476277">)</span>&nbsp;<span class="op" id="4476279">&lt;&lt;</span>&nbsp;<span class="num" id="4476282">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476286">out</span><span class="op" id="4476289">[</span><span class="num" id="4476290">4</span><span class="op" id="4476291">]</span>&nbsp;<span class="op" id="4476293">+=</span>&nbsp;<span class="builtintype" id="4476296">uint32</span><span class="op" id="4476302">(</span><span class="ident" id="4476303">in</span><span class="op" id="4476305">[</span><span class="num" id="4476306">8</span><span class="op" id="4476307">]</span>&nbsp;<span class="op" id="4476309">&gt;&gt;</span>&nbsp;<span class="num" id="4476312">16</span><span class="op" id="4476314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476317">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476335">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476354">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476373">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476400">out</span><span class="op" id="4476403">[</span><span class="num" id="4476404">0</span><span class="op" id="4476405">]</span>&nbsp;<span class="op" id="4476407">=</span>&nbsp;<span class="builtintype" id="4476409">uint32</span><span class="op" id="4476415">(</span><span class="ident" id="4476416">in</span><span class="op" id="4476418">[</span><span class="num" id="4476419">0</span><span class="op" id="4476420">]</span>&nbsp;<span class="op" id="4476422">&amp;</span>&nbsp;<span class="ident" id="4476424">bottom28Bits</span><span class="op" id="4476436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476439">out</span><span class="op" id="4476442">[</span><span class="num" id="4476443">1</span><span class="op" id="4476444">]</span>&nbsp;<span class="op" id="4476446">+=</span>&nbsp;<span class="builtintype" id="4476449">uint32</span><span class="op" id="4476455">(</span><span class="op" id="4476456">(</span><span class="ident" id="4476457">in</span><span class="op" id="4476459">[</span><span class="num" id="4476460">0</span><span class="op" id="4476461">]</span>&nbsp;<span class="op" id="4476463">&gt;&gt;</span>&nbsp;<span class="num" id="4476466">28</span><span class="op" id="4476468">)</span>&nbsp;<span class="op" id="4476470">&amp;</span>&nbsp;<span class="ident" id="4476472">bottom28Bits</span><span class="op" id="4476484">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476487">out</span><span class="op" id="4476490">[</span><span class="num" id="4476491">2</span><span class="op" id="4476492">]</span>&nbsp;<span class="op" id="4476494">+=</span>&nbsp;<span class="builtintype" id="4476497">uint32</span><span class="op" id="4476503">(</span><span class="ident" id="4476504">in</span><span class="op" id="4476506">[</span><span class="num" id="4476507">0</span><span class="op" id="4476508">]</span>&nbsp;<span class="op" id="4476510">&gt;&gt;</span>&nbsp;<span class="num" id="4476513">56</span><span class="op" id="4476515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476518">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476537">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476559">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4476580">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4476583">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4476642">//</span><br>
<span class="lineno"></span><span class="comment" id="4476645">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4476679">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4476704">func</span>&nbsp;<span class="ident" id="4476709">p224Reduce</span><span class="op" id="4476719">(</span><span class="ident" id="4476720">a</span>&nbsp;<span class="op" id="4476722">*</span><span class="ident" id="4476723">p224FieldElement</span><span class="op" id="4476739">)</span>&nbsp;<span class="op" id="4476741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4476744">for</span>&nbsp;<span class="ident" id="4476748">i</span>&nbsp;<span class="op" id="4476750">:=</span>&nbsp;<span class="num" id="4476753">0</span><span class="op" id="4476754">;</span>&nbsp;<span class="ident" id="4476756">i</span>&nbsp;<span class="op" id="4476758">&lt;</span>&nbsp;<span class="num" id="4476760">7</span><span class="op" id="4476761">;</span>&nbsp;<span class="ident" id="4476763">i</span><span class="op" id="4476764">++</span>&nbsp;<span class="op" id="4476767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476771">a</span><span class="op" id="4476772">[</span><span class="ident" id="4476773">i</span><span class="op" id="4476774">+</span><span class="num" id="4476775">1</span><span class="op" id="4476776">]</span>&nbsp;<span class="op" id="4476778">+=</span>&nbsp;<span class="ident" id="4476781">a</span><span class="op" id="4476782">[</span><span class="ident" id="4476783">i</span><span class="op" id="4476784">]</span>&nbsp;<span class="op" id="4476786">&gt;&gt;</span>&nbsp;<span class="num" id="4476789">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476794">a</span><span class="op" id="4476795">[</span><span class="ident" id="4476796">i</span><span class="op" id="4476797">]</span>&nbsp;<span class="op" id="4476799">&amp;=</span>&nbsp;<span class="ident" id="4476802">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4476816">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476819">top</span>&nbsp;<span class="op" id="4476823">:=</span>&nbsp;<span class="ident" id="4476826">a</span><span class="op" id="4476827">[</span><span class="num" id="4476828">7</span><span class="op" id="4476829">]</span>&nbsp;<span class="op" id="4476831">&gt;&gt;</span>&nbsp;<span class="num" id="4476834">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476838">a</span><span class="op" id="4476839">[</span><span class="num" id="4476840">7</span><span class="op" id="4476841">]</span>&nbsp;<span class="op" id="4476843">&amp;=</span>&nbsp;<span class="ident" id="4476846">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476861">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476876">mask</span>&nbsp;<span class="op" id="4476881">:=</span>&nbsp;<span class="ident" id="4476884">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476889">mask</span>&nbsp;<span class="op" id="4476894">|=</span>&nbsp;<span class="ident" id="4476897">mask</span>&nbsp;<span class="op" id="4476902">&gt;&gt;</span>&nbsp;<span class="num" id="4476905">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476908">mask</span>&nbsp;<span class="op" id="4476913">|=</span>&nbsp;<span class="ident" id="4476916">mask</span>&nbsp;<span class="op" id="4476921">&gt;&gt;</span>&nbsp;<span class="num" id="4476924">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476927">mask</span>&nbsp;<span class="op" id="4476932">&lt;&lt;=</span>&nbsp;<span class="num" id="4476936">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4476940">mask</span>&nbsp;<span class="op" id="4476945">=</span>&nbsp;<span class="builtintype" id="4476947">uint32</span><span class="op" id="4476953">(</span><span class="builtintype" id="4476954">int32</span><span class="op" id="4476959">(</span><span class="ident" id="4476960">mask</span><span class="op" id="4476964">)</span>&nbsp;<span class="op" id="4476966">&gt;&gt;</span>&nbsp;<span class="num" id="4476969">31</span><span class="op" id="4476971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4476974">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477028">a</span><span class="op" id="4477029">[</span><span class="num" id="4477030">0</span><span class="op" id="4477031">]</span>&nbsp;<span class="op" id="4477033">-=</span>&nbsp;<span class="ident" id="4477036">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477041">a</span><span class="op" id="4477042">[</span><span class="num" id="4477043">3</span><span class="op" id="4477044">]</span>&nbsp;<span class="op" id="4477046">+=</span>&nbsp;<span class="ident" id="4477049">top</span>&nbsp;<span class="op" id="4477053">&lt;&lt;</span>&nbsp;<span class="num" id="4477056">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4477061">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4477130">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4477200">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477224">a</span><span class="op" id="4477225">[</span><span class="num" id="4477226">3</span><span class="op" id="4477227">]</span>&nbsp;<span class="op" id="4477229">-=</span>&nbsp;<span class="num" id="4477232">1</span>&nbsp;<span class="op" id="4477234">&amp;</span>&nbsp;<span class="ident" id="4477236">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477242">a</span><span class="op" id="4477243">[</span><span class="num" id="4477244">2</span><span class="op" id="4477245">]</span>&nbsp;<span class="op" id="4477247">+=</span>&nbsp;<span class="ident" id="4477250">mask</span>&nbsp;<span class="op" id="4477255">&amp;</span>&nbsp;<span class="op" id="4477257">(</span><span class="num" id="4477258">1</span><span class="op" id="4477259">&lt;&lt;</span><span class="num" id="4477261">28</span>&nbsp;<span class="op" id="4477264">-</span>&nbsp;<span class="num" id="4477266">1</span><span class="op" id="4477267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477270">a</span><span class="op" id="4477271">[</span><span class="num" id="4477272">1</span><span class="op" id="4477273">]</span>&nbsp;<span class="op" id="4477275">+=</span>&nbsp;<span class="ident" id="4477278">mask</span>&nbsp;<span class="op" id="4477283">&amp;</span>&nbsp;<span class="op" id="4477285">(</span><span class="num" id="4477286">1</span><span class="op" id="4477287">&lt;&lt;</span><span class="num" id="4477289">28</span>&nbsp;<span class="op" id="4477292">-</span>&nbsp;<span class="num" id="4477294">1</span><span class="op" id="4477295">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477298">a</span><span class="op" id="4477299">[</span><span class="num" id="4477300">0</span><span class="op" id="4477301">]</span>&nbsp;<span class="op" id="4477303">+=</span>&nbsp;<span class="ident" id="4477306">mask</span>&nbsp;<span class="op" id="4477311">&amp;</span>&nbsp;<span class="op" id="4477313">(</span><span class="num" id="4477314">1</span>&nbsp;<span class="op" id="4477316">&lt;&lt;</span>&nbsp;<span class="num" id="4477319">28</span><span class="op" id="4477321">)</span><br>
<span class="lineno"></span><span class="op" id="4477323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4477326">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4477404">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4477437">func</span>&nbsp;<span class="ident" id="4477442">p224Invert</span><span class="op" id="4477452">(</span><span class="ident" id="4477453">out</span><span class="op" id="4477456">,</span>&nbsp;<span class="ident" id="4477458">in</span>&nbsp;<span class="op" id="4477461">*</span><span class="ident" id="4477462">p224FieldElement</span><span class="op" id="4477478">)</span>&nbsp;<span class="op" id="4477480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4477483">var</span>&nbsp;<span class="ident" id="4477487">f1</span><span class="op" id="4477489">,</span>&nbsp;<span class="ident" id="4477491">f2</span><span class="op" id="4477493">,</span>&nbsp;<span class="ident" id="4477495">f3</span><span class="op" id="4477497">,</span>&nbsp;<span class="ident" id="4477499">f4</span>&nbsp;<span class="ident" id="4477502">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4477520">var</span>&nbsp;<span class="ident" id="4477524">c</span>&nbsp;<span class="ident" id="4477526">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477550">p224Square</span><span class="op" id="4477560">(</span><span class="op" id="4477561">&amp;</span><span class="ident" id="4477562">f1</span><span class="op" id="4477564">,</span>&nbsp;<span class="ident" id="4477566">in</span><span class="op" id="4477568">,</span>&nbsp;<span class="op" id="4477570">&amp;</span><span class="ident" id="4477571">c</span><span class="op" id="4477572">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477577">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477583">p224Mul</span><span class="op" id="4477590">(</span><span class="op" id="4477591">&amp;</span><span class="ident" id="4477592">f1</span><span class="op" id="4477594">,</span>&nbsp;<span class="op" id="4477596">&amp;</span><span class="ident" id="4477597">f1</span><span class="op" id="4477599">,</span>&nbsp;<span class="ident" id="4477601">in</span><span class="op" id="4477603">,</span>&nbsp;<span class="op" id="4477605">&amp;</span><span class="ident" id="4477606">c</span><span class="op" id="4477607">)</span>&nbsp;&nbsp;<span class="comment" id="4477610">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477623">p224Square</span><span class="op" id="4477633">(</span><span class="op" id="4477634">&amp;</span><span class="ident" id="4477635">f1</span><span class="op" id="4477637">,</span>&nbsp;<span class="op" id="4477639">&amp;</span><span class="ident" id="4477640">f1</span><span class="op" id="4477642">,</span>&nbsp;<span class="op" id="4477644">&amp;</span><span class="ident" id="4477645">c</span><span class="op" id="4477646">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477650">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477663">p224Mul</span><span class="op" id="4477670">(</span><span class="op" id="4477671">&amp;</span><span class="ident" id="4477672">f1</span><span class="op" id="4477674">,</span>&nbsp;<span class="op" id="4477676">&amp;</span><span class="ident" id="4477677">f1</span><span class="op" id="4477679">,</span>&nbsp;<span class="ident" id="4477681">in</span><span class="op" id="4477683">,</span>&nbsp;<span class="op" id="4477685">&amp;</span><span class="ident" id="4477686">c</span><span class="op" id="4477687">)</span>&nbsp;&nbsp;<span class="comment" id="4477690">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477703">p224Square</span><span class="op" id="4477713">(</span><span class="op" id="4477714">&amp;</span><span class="ident" id="4477715">f2</span><span class="op" id="4477717">,</span>&nbsp;<span class="op" id="4477719">&amp;</span><span class="ident" id="4477720">f1</span><span class="op" id="4477722">,</span>&nbsp;<span class="op" id="4477724">&amp;</span><span class="ident" id="4477725">c</span><span class="op" id="4477726">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477730">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477743">p224Square</span><span class="op" id="4477753">(</span><span class="op" id="4477754">&amp;</span><span class="ident" id="4477755">f2</span><span class="op" id="4477757">,</span>&nbsp;<span class="op" id="4477759">&amp;</span><span class="ident" id="4477760">f2</span><span class="op" id="4477762">,</span>&nbsp;<span class="op" id="4477764">&amp;</span><span class="ident" id="4477765">c</span><span class="op" id="4477766">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477770">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477783">p224Square</span><span class="op" id="4477793">(</span><span class="op" id="4477794">&amp;</span><span class="ident" id="4477795">f2</span><span class="op" id="4477797">,</span>&nbsp;<span class="op" id="4477799">&amp;</span><span class="ident" id="4477800">f2</span><span class="op" id="4477802">,</span>&nbsp;<span class="op" id="4477804">&amp;</span><span class="ident" id="4477805">c</span><span class="op" id="4477806">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477810">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477823">p224Mul</span><span class="op" id="4477830">(</span><span class="op" id="4477831">&amp;</span><span class="ident" id="4477832">f1</span><span class="op" id="4477834">,</span>&nbsp;<span class="op" id="4477836">&amp;</span><span class="ident" id="4477837">f1</span><span class="op" id="4477839">,</span>&nbsp;<span class="op" id="4477841">&amp;</span><span class="ident" id="4477842">f2</span><span class="op" id="4477844">,</span>&nbsp;<span class="op" id="4477846">&amp;</span><span class="ident" id="4477847">c</span><span class="op" id="4477848">)</span>&nbsp;<span class="comment" id="4477850">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477863">p224Square</span><span class="op" id="4477873">(</span><span class="op" id="4477874">&amp;</span><span class="ident" id="4477875">f2</span><span class="op" id="4477877">,</span>&nbsp;<span class="op" id="4477879">&amp;</span><span class="ident" id="4477880">f1</span><span class="op" id="4477882">,</span>&nbsp;<span class="op" id="4477884">&amp;</span><span class="ident" id="4477885">c</span><span class="op" id="4477886">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477890">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4477903">for</span>&nbsp;<span class="ident" id="4477907">i</span>&nbsp;<span class="op" id="4477909">:=</span>&nbsp;<span class="num" id="4477912">0</span><span class="op" id="4477913">;</span>&nbsp;<span class="ident" id="4477915">i</span>&nbsp;<span class="op" id="4477917">&lt;</span>&nbsp;<span class="num" id="4477919">5</span><span class="op" id="4477920">;</span>&nbsp;<span class="ident" id="4477922">i</span><span class="op" id="4477923">++</span>&nbsp;<span class="op" id="4477926">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4477930">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477948">p224Square</span><span class="op" id="4477958">(</span><span class="op" id="4477959">&amp;</span><span class="ident" id="4477960">f2</span><span class="op" id="4477962">,</span>&nbsp;<span class="op" id="4477964">&amp;</span><span class="ident" id="4477965">f2</span><span class="op" id="4477967">,</span>&nbsp;<span class="op" id="4477969">&amp;</span><span class="ident" id="4477970">c</span><span class="op" id="4477971">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4477974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4477977">p224Mul</span><span class="op" id="4477984">(</span><span class="op" id="4477985">&amp;</span><span class="ident" id="4477986">f2</span><span class="op" id="4477988">,</span>&nbsp;<span class="op" id="4477990">&amp;</span><span class="ident" id="4477991">f2</span><span class="op" id="4477993">,</span>&nbsp;<span class="op" id="4477995">&amp;</span><span class="ident" id="4477996">f1</span><span class="op" id="4477998">,</span>&nbsp;<span class="op" id="4478000">&amp;</span><span class="ident" id="4478001">c</span><span class="op" id="4478002">)</span>&nbsp;<span class="comment" id="4478004">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478018">p224Square</span><span class="op" id="4478028">(</span><span class="op" id="4478029">&amp;</span><span class="ident" id="4478030">f3</span><span class="op" id="4478032">,</span>&nbsp;<span class="op" id="4478034">&amp;</span><span class="ident" id="4478035">f2</span><span class="op" id="4478037">,</span>&nbsp;<span class="op" id="4478039">&amp;</span><span class="ident" id="4478040">c</span><span class="op" id="4478041">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478045">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478059">for</span>&nbsp;<span class="ident" id="4478063">i</span>&nbsp;<span class="op" id="4478065">:=</span>&nbsp;<span class="num" id="4478068">0</span><span class="op" id="4478069">;</span>&nbsp;<span class="ident" id="4478071">i</span>&nbsp;<span class="op" id="4478073">&lt;</span>&nbsp;<span class="num" id="4478075">11</span><span class="op" id="4478077">;</span>&nbsp;<span class="ident" id="4478079">i</span><span class="op" id="4478080">++</span>&nbsp;<span class="op" id="4478083">{</span>&nbsp;&nbsp;<span class="comment" id="4478086">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478105">p224Square</span><span class="op" id="4478115">(</span><span class="op" id="4478116">&amp;</span><span class="ident" id="4478117">f3</span><span class="op" id="4478119">,</span>&nbsp;<span class="op" id="4478121">&amp;</span><span class="ident" id="4478122">f3</span><span class="op" id="4478124">,</span>&nbsp;<span class="op" id="4478126">&amp;</span><span class="ident" id="4478127">c</span><span class="op" id="4478128">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478134">p224Mul</span><span class="op" id="4478141">(</span><span class="op" id="4478142">&amp;</span><span class="ident" id="4478143">f2</span><span class="op" id="4478145">,</span>&nbsp;<span class="op" id="4478147">&amp;</span><span class="ident" id="4478148">f3</span><span class="op" id="4478150">,</span>&nbsp;<span class="op" id="4478152">&amp;</span><span class="ident" id="4478153">f2</span><span class="op" id="4478155">,</span>&nbsp;<span class="op" id="4478157">&amp;</span><span class="ident" id="4478158">c</span><span class="op" id="4478159">)</span>&nbsp;<span class="comment" id="4478161">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478175">p224Square</span><span class="op" id="4478185">(</span><span class="op" id="4478186">&amp;</span><span class="ident" id="4478187">f3</span><span class="op" id="4478189">,</span>&nbsp;<span class="op" id="4478191">&amp;</span><span class="ident" id="4478192">f2</span><span class="op" id="4478194">,</span>&nbsp;<span class="op" id="4478196">&amp;</span><span class="ident" id="4478197">c</span><span class="op" id="4478198">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478202">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478216">for</span>&nbsp;<span class="ident" id="4478220">i</span>&nbsp;<span class="op" id="4478222">:=</span>&nbsp;<span class="num" id="4478225">0</span><span class="op" id="4478226">;</span>&nbsp;<span class="ident" id="4478228">i</span>&nbsp;<span class="op" id="4478230">&lt;</span>&nbsp;<span class="num" id="4478232">23</span><span class="op" id="4478234">;</span>&nbsp;<span class="ident" id="4478236">i</span><span class="op" id="4478237">++</span>&nbsp;<span class="op" id="4478240">{</span>&nbsp;&nbsp;<span class="comment" id="4478243">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478262">p224Square</span><span class="op" id="4478272">(</span><span class="op" id="4478273">&amp;</span><span class="ident" id="4478274">f3</span><span class="op" id="4478276">,</span>&nbsp;<span class="op" id="4478278">&amp;</span><span class="ident" id="4478279">f3</span><span class="op" id="4478281">,</span>&nbsp;<span class="op" id="4478283">&amp;</span><span class="ident" id="4478284">c</span><span class="op" id="4478285">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478291">p224Mul</span><span class="op" id="4478298">(</span><span class="op" id="4478299">&amp;</span><span class="ident" id="4478300">f3</span><span class="op" id="4478302">,</span>&nbsp;<span class="op" id="4478304">&amp;</span><span class="ident" id="4478305">f3</span><span class="op" id="4478307">,</span>&nbsp;<span class="op" id="4478309">&amp;</span><span class="ident" id="4478310">f2</span><span class="op" id="4478312">,</span>&nbsp;<span class="op" id="4478314">&amp;</span><span class="ident" id="4478315">c</span><span class="op" id="4478316">)</span>&nbsp;<span class="comment" id="4478318">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478332">p224Square</span><span class="op" id="4478342">(</span><span class="op" id="4478343">&amp;</span><span class="ident" id="4478344">f4</span><span class="op" id="4478346">,</span>&nbsp;<span class="op" id="4478348">&amp;</span><span class="ident" id="4478349">f3</span><span class="op" id="4478351">,</span>&nbsp;<span class="op" id="4478353">&amp;</span><span class="ident" id="4478354">c</span><span class="op" id="4478355">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478359">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478373">for</span>&nbsp;<span class="ident" id="4478377">i</span>&nbsp;<span class="op" id="4478379">:=</span>&nbsp;<span class="num" id="4478382">0</span><span class="op" id="4478383">;</span>&nbsp;<span class="ident" id="4478385">i</span>&nbsp;<span class="op" id="4478387">&lt;</span>&nbsp;<span class="num" id="4478389">47</span><span class="op" id="4478391">;</span>&nbsp;<span class="ident" id="4478393">i</span><span class="op" id="4478394">++</span>&nbsp;<span class="op" id="4478397">{</span>&nbsp;&nbsp;<span class="comment" id="4478400">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478419">p224Square</span><span class="op" id="4478429">(</span><span class="op" id="4478430">&amp;</span><span class="ident" id="4478431">f4</span><span class="op" id="4478433">,</span>&nbsp;<span class="op" id="4478435">&amp;</span><span class="ident" id="4478436">f4</span><span class="op" id="4478438">,</span>&nbsp;<span class="op" id="4478440">&amp;</span><span class="ident" id="4478441">c</span><span class="op" id="4478442">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478448">p224Mul</span><span class="op" id="4478455">(</span><span class="op" id="4478456">&amp;</span><span class="ident" id="4478457">f3</span><span class="op" id="4478459">,</span>&nbsp;<span class="op" id="4478461">&amp;</span><span class="ident" id="4478462">f3</span><span class="op" id="4478464">,</span>&nbsp;<span class="op" id="4478466">&amp;</span><span class="ident" id="4478467">f4</span><span class="op" id="4478469">,</span>&nbsp;<span class="op" id="4478471">&amp;</span><span class="ident" id="4478472">c</span><span class="op" id="4478473">)</span>&nbsp;<span class="comment" id="4478475">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478489">p224Square</span><span class="op" id="4478499">(</span><span class="op" id="4478500">&amp;</span><span class="ident" id="4478501">f4</span><span class="op" id="4478503">,</span>&nbsp;<span class="op" id="4478505">&amp;</span><span class="ident" id="4478506">f3</span><span class="op" id="4478508">,</span>&nbsp;<span class="op" id="4478510">&amp;</span><span class="ident" id="4478511">c</span><span class="op" id="4478512">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478516">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478530">for</span>&nbsp;<span class="ident" id="4478534">i</span>&nbsp;<span class="op" id="4478536">:=</span>&nbsp;<span class="num" id="4478539">0</span><span class="op" id="4478540">;</span>&nbsp;<span class="ident" id="4478542">i</span>&nbsp;<span class="op" id="4478544">&lt;</span>&nbsp;<span class="num" id="4478546">23</span><span class="op" id="4478548">;</span>&nbsp;<span class="ident" id="4478550">i</span><span class="op" id="4478551">++</span>&nbsp;<span class="op" id="4478554">{</span>&nbsp;&nbsp;<span class="comment" id="4478557">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478577">p224Square</span><span class="op" id="4478587">(</span><span class="op" id="4478588">&amp;</span><span class="ident" id="4478589">f4</span><span class="op" id="4478591">,</span>&nbsp;<span class="op" id="4478593">&amp;</span><span class="ident" id="4478594">f4</span><span class="op" id="4478596">,</span>&nbsp;<span class="op" id="4478598">&amp;</span><span class="ident" id="4478599">c</span><span class="op" id="4478600">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478606">p224Mul</span><span class="op" id="4478613">(</span><span class="op" id="4478614">&amp;</span><span class="ident" id="4478615">f2</span><span class="op" id="4478617">,</span>&nbsp;<span class="op" id="4478619">&amp;</span><span class="ident" id="4478620">f4</span><span class="op" id="4478622">,</span>&nbsp;<span class="op" id="4478624">&amp;</span><span class="ident" id="4478625">f2</span><span class="op" id="4478627">,</span>&nbsp;<span class="op" id="4478629">&amp;</span><span class="ident" id="4478630">c</span><span class="op" id="4478631">)</span>&nbsp;<span class="comment" id="4478633">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478648">for</span>&nbsp;<span class="ident" id="4478652">i</span>&nbsp;<span class="op" id="4478654">:=</span>&nbsp;<span class="num" id="4478657">0</span><span class="op" id="4478658">;</span>&nbsp;<span class="ident" id="4478660">i</span>&nbsp;<span class="op" id="4478662">&lt;</span>&nbsp;<span class="num" id="4478664">6</span><span class="op" id="4478665">;</span>&nbsp;<span class="ident" id="4478667">i</span><span class="op" id="4478668">++</span>&nbsp;<span class="op" id="4478671">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478675">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478694">p224Square</span><span class="op" id="4478704">(</span><span class="op" id="4478705">&amp;</span><span class="ident" id="4478706">f2</span><span class="op" id="4478708">,</span>&nbsp;<span class="op" id="4478710">&amp;</span><span class="ident" id="4478711">f2</span><span class="op" id="4478713">,</span>&nbsp;<span class="op" id="4478715">&amp;</span><span class="ident" id="4478716">c</span><span class="op" id="4478717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478720">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478723">p224Mul</span><span class="op" id="4478730">(</span><span class="op" id="4478731">&amp;</span><span class="ident" id="4478732">f1</span><span class="op" id="4478734">,</span>&nbsp;<span class="op" id="4478736">&amp;</span><span class="ident" id="4478737">f1</span><span class="op" id="4478739">,</span>&nbsp;<span class="op" id="4478741">&amp;</span><span class="ident" id="4478742">f2</span><span class="op" id="4478744">,</span>&nbsp;<span class="op" id="4478746">&amp;</span><span class="ident" id="4478747">c</span><span class="op" id="4478748">)</span>&nbsp;<span class="comment" id="4478750">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478765">p224Square</span><span class="op" id="4478775">(</span><span class="op" id="4478776">&amp;</span><span class="ident" id="4478777">f1</span><span class="op" id="4478779">,</span>&nbsp;<span class="op" id="4478781">&amp;</span><span class="ident" id="4478782">f1</span><span class="op" id="4478784">,</span>&nbsp;<span class="op" id="4478786">&amp;</span><span class="ident" id="4478787">c</span><span class="op" id="4478788">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4478792">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478807">p224Mul</span><span class="op" id="4478814">(</span><span class="op" id="4478815">&amp;</span><span class="ident" id="4478816">f1</span><span class="op" id="4478818">,</span>&nbsp;<span class="op" id="4478820">&amp;</span><span class="ident" id="4478821">f1</span><span class="op" id="4478823">,</span>&nbsp;<span class="ident" id="4478825">in</span><span class="op" id="4478827">,</span>&nbsp;<span class="op" id="4478829">&amp;</span><span class="ident" id="4478830">c</span><span class="op" id="4478831">)</span>&nbsp;&nbsp;<span class="comment" id="4478834">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4478849">for</span>&nbsp;<span class="ident" id="4478853">i</span>&nbsp;<span class="op" id="4478855">:=</span>&nbsp;<span class="num" id="4478858">0</span><span class="op" id="4478859">;</span>&nbsp;<span class="ident" id="4478861">i</span>&nbsp;<span class="op" id="4478863">&lt;</span>&nbsp;<span class="num" id="4478865">97</span><span class="op" id="4478867">;</span>&nbsp;<span class="ident" id="4478869">i</span><span class="op" id="4478870">++</span>&nbsp;<span class="op" id="4478873">{</span>&nbsp;&nbsp;<span class="comment" id="4478876">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478896">p224Square</span><span class="op" id="4478906">(</span><span class="op" id="4478907">&amp;</span><span class="ident" id="4478908">f1</span><span class="op" id="4478910">,</span>&nbsp;<span class="op" id="4478912">&amp;</span><span class="ident" id="4478913">f1</span><span class="op" id="4478915">,</span>&nbsp;<span class="op" id="4478917">&amp;</span><span class="ident" id="4478918">c</span><span class="op" id="4478919">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4478922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4478925">p224Mul</span><span class="op" id="4478932">(</span><span class="ident" id="4478933">out</span><span class="op" id="4478936">,</span>&nbsp;<span class="op" id="4478938">&amp;</span><span class="ident" id="4478939">f1</span><span class="op" id="4478941">,</span>&nbsp;<span class="op" id="4478943">&amp;</span><span class="ident" id="4478944">f3</span><span class="op" id="4478946">,</span>&nbsp;<span class="op" id="4478948">&amp;</span><span class="ident" id="4478949">c</span><span class="op" id="4478950">)</span>&nbsp;<span class="comment" id="4478952">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4478974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4478977">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4479046">//</span><br>
<span class="lineno"></span><span class="comment" id="4479049">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4479076">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4479102">func</span>&nbsp;<span class="ident" id="4479107">p224Contract</span><span class="op" id="4479119">(</span><span class="ident" id="4479120">out</span><span class="op" id="4479123">,</span>&nbsp;<span class="ident" id="4479125">in</span>&nbsp;<span class="op" id="4479128">*</span><span class="ident" id="4479129">p224FieldElement</span><span class="op" id="4479145">)</span>&nbsp;<span class="op" id="4479147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4479150">copy</span><span class="op" id="4479154">(</span><span class="ident" id="4479155">out</span><span class="op" id="4479158">[</span><span class="op" id="4479159">:</span><span class="op" id="4479160">]</span><span class="op" id="4479161">,</span>&nbsp;<span class="ident" id="4479163">in</span><span class="op" id="4479165">[</span><span class="op" id="4479166">:</span><span class="op" id="4479167">]</span><span class="op" id="4479168">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4479172">for</span>&nbsp;<span class="ident" id="4479176">i</span>&nbsp;<span class="op" id="4479178">:=</span>&nbsp;<span class="num" id="4479181">0</span><span class="op" id="4479182">;</span>&nbsp;<span class="ident" id="4479184">i</span>&nbsp;<span class="op" id="4479186">&lt;</span>&nbsp;<span class="num" id="4479188">7</span><span class="op" id="4479189">;</span>&nbsp;<span class="ident" id="4479191">i</span><span class="op" id="4479192">++</span>&nbsp;<span class="op" id="4479195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479199">out</span><span class="op" id="4479202">[</span><span class="ident" id="4479203">i</span><span class="op" id="4479204">+</span><span class="num" id="4479205">1</span><span class="op" id="4479206">]</span>&nbsp;<span class="op" id="4479208">+=</span>&nbsp;<span class="ident" id="4479211">out</span><span class="op" id="4479214">[</span><span class="ident" id="4479215">i</span><span class="op" id="4479216">]</span>&nbsp;<span class="op" id="4479218">&gt;&gt;</span>&nbsp;<span class="num" id="4479221">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479226">out</span><span class="op" id="4479229">[</span><span class="ident" id="4479230">i</span><span class="op" id="4479231">]</span>&nbsp;<span class="op" id="4479233">&amp;=</span>&nbsp;<span class="ident" id="4479236">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4479250">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479253">top</span>&nbsp;<span class="op" id="4479257">:=</span>&nbsp;<span class="ident" id="4479260">out</span><span class="op" id="4479263">[</span><span class="num" id="4479264">7</span><span class="op" id="4479265">]</span>&nbsp;<span class="op" id="4479267">&gt;&gt;</span>&nbsp;<span class="num" id="4479270">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479274">out</span><span class="op" id="4479277">[</span><span class="num" id="4479278">7</span><span class="op" id="4479279">]</span>&nbsp;<span class="op" id="4479281">&amp;=</span>&nbsp;<span class="ident" id="4479284">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479299">out</span><span class="op" id="4479302">[</span><span class="num" id="4479303">0</span><span class="op" id="4479304">]</span>&nbsp;<span class="op" id="4479306">-=</span>&nbsp;<span class="ident" id="4479309">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479314">out</span><span class="op" id="4479317">[</span><span class="num" id="4479318">3</span><span class="op" id="4479319">]</span>&nbsp;<span class="op" id="4479321">+=</span>&nbsp;<span class="ident" id="4479324">top</span>&nbsp;<span class="op" id="4479328">&lt;&lt;</span>&nbsp;<span class="num" id="4479331">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479336">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479408">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479478">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4479511">for</span>&nbsp;<span class="ident" id="4479515">i</span>&nbsp;<span class="op" id="4479517">:=</span>&nbsp;<span class="num" id="4479520">0</span><span class="op" id="4479521">;</span>&nbsp;<span class="ident" id="4479523">i</span>&nbsp;<span class="op" id="4479525">&lt;</span>&nbsp;<span class="num" id="4479527">3</span><span class="op" id="4479528">;</span>&nbsp;<span class="ident" id="4479530">i</span><span class="op" id="4479531">++</span>&nbsp;<span class="op" id="4479534">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479538">mask</span>&nbsp;<span class="op" id="4479543">:=</span>&nbsp;<span class="builtintype" id="4479546">uint32</span><span class="op" id="4479552">(</span><span class="builtintype" id="4479553">int32</span><span class="op" id="4479558">(</span><span class="ident" id="4479559">out</span><span class="op" id="4479562">[</span><span class="ident" id="4479563">i</span><span class="op" id="4479564">]</span><span class="op" id="4479565">)</span>&nbsp;<span class="op" id="4479567">&gt;&gt;</span>&nbsp;<span class="num" id="4479570">31</span><span class="op" id="4479572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479576">out</span><span class="op" id="4479579">[</span><span class="ident" id="4479580">i</span><span class="op" id="4479581">]</span>&nbsp;<span class="op" id="4479583">+=</span>&nbsp;<span class="op" id="4479586">(</span><span class="num" id="4479587">1</span>&nbsp;<span class="op" id="4479589">&lt;&lt;</span>&nbsp;<span class="num" id="4479592">28</span><span class="op" id="4479594">)</span>&nbsp;<span class="op" id="4479596">&amp;</span>&nbsp;<span class="ident" id="4479598">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479605">out</span><span class="op" id="4479608">[</span><span class="ident" id="4479609">i</span><span class="op" id="4479610">+</span><span class="num" id="4479611">1</span><span class="op" id="4479612">]</span>&nbsp;<span class="op" id="4479614">-=</span>&nbsp;<span class="num" id="4479617">1</span>&nbsp;<span class="op" id="4479619">&amp;</span>&nbsp;<span class="ident" id="4479621">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4479627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479631">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479706">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4479723">for</span>&nbsp;<span class="ident" id="4479727">i</span>&nbsp;<span class="op" id="4479729">:=</span>&nbsp;<span class="num" id="4479732">3</span><span class="op" id="4479733">;</span>&nbsp;<span class="ident" id="4479735">i</span>&nbsp;<span class="op" id="4479737">&lt;</span>&nbsp;<span class="num" id="4479739">7</span><span class="op" id="4479740">;</span>&nbsp;<span class="ident" id="4479742">i</span><span class="op" id="4479743">++</span>&nbsp;<span class="op" id="4479746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479750">out</span><span class="op" id="4479753">[</span><span class="ident" id="4479754">i</span><span class="op" id="4479755">+</span><span class="num" id="4479756">1</span><span class="op" id="4479757">]</span>&nbsp;<span class="op" id="4479759">+=</span>&nbsp;<span class="ident" id="4479762">out</span><span class="op" id="4479765">[</span><span class="ident" id="4479766">i</span><span class="op" id="4479767">]</span>&nbsp;<span class="op" id="4479769">&gt;&gt;</span>&nbsp;<span class="num" id="4479772">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479777">out</span><span class="op" id="4479780">[</span><span class="ident" id="4479781">i</span><span class="op" id="4479782">]</span>&nbsp;<span class="op" id="4479784">&amp;=</span>&nbsp;<span class="ident" id="4479787">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4479801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479804">top</span>&nbsp;<span class="op" id="4479808">=</span>&nbsp;<span class="ident" id="4479810">out</span><span class="op" id="4479813">[</span><span class="num" id="4479814">7</span><span class="op" id="4479815">]</span>&nbsp;<span class="op" id="4479817">&gt;&gt;</span>&nbsp;<span class="num" id="4479820">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479824">out</span><span class="op" id="4479827">[</span><span class="num" id="4479828">7</span><span class="op" id="4479829">]</span>&nbsp;<span class="op" id="4479831">&amp;=</span>&nbsp;<span class="ident" id="4479834">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479849">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479907">out</span><span class="op" id="4479910">[</span><span class="num" id="4479911">0</span><span class="op" id="4479912">]</span>&nbsp;<span class="op" id="4479914">-=</span>&nbsp;<span class="ident" id="4479917">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4479922">out</span><span class="op" id="4479925">[</span><span class="num" id="4479926">3</span><span class="op" id="4479927">]</span>&nbsp;<span class="op" id="4479929">+=</span>&nbsp;<span class="ident" id="4479932">top</span>&nbsp;<span class="op" id="4479936">&lt;&lt;</span>&nbsp;<span class="num" id="4479939">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479944">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4479992">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480172">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480481">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480560">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480583">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480660">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480730">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4480757">for</span>&nbsp;<span class="ident" id="4480761">i</span>&nbsp;<span class="op" id="4480763">:=</span>&nbsp;<span class="num" id="4480766">0</span><span class="op" id="4480767">;</span>&nbsp;<span class="ident" id="4480769">i</span>&nbsp;<span class="op" id="4480771">&lt;</span>&nbsp;<span class="num" id="4480773">3</span><span class="op" id="4480774">;</span>&nbsp;<span class="ident" id="4480776">i</span><span class="op" id="4480777">++</span>&nbsp;<span class="op" id="4480780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4480784">mask</span>&nbsp;<span class="op" id="4480789">:=</span>&nbsp;<span class="builtintype" id="4480792">uint32</span><span class="op" id="4480798">(</span><span class="builtintype" id="4480799">int32</span><span class="op" id="4480804">(</span><span class="ident" id="4480805">out</span><span class="op" id="4480808">[</span><span class="ident" id="4480809">i</span><span class="op" id="4480810">]</span><span class="op" id="4480811">)</span>&nbsp;<span class="op" id="4480813">&gt;&gt;</span>&nbsp;<span class="num" id="4480816">31</span><span class="op" id="4480818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4480822">out</span><span class="op" id="4480825">[</span><span class="ident" id="4480826">i</span><span class="op" id="4480827">]</span>&nbsp;<span class="op" id="4480829">+=</span>&nbsp;<span class="op" id="4480832">(</span><span class="num" id="4480833">1</span>&nbsp;<span class="op" id="4480835">&lt;&lt;</span>&nbsp;<span class="num" id="4480838">28</span><span class="op" id="4480840">)</span>&nbsp;<span class="op" id="4480842">&amp;</span>&nbsp;<span class="ident" id="4480844">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4480851">out</span><span class="op" id="4480854">[</span><span class="ident" id="4480855">i</span><span class="op" id="4480856">+</span><span class="num" id="4480857">1</span><span class="op" id="4480858">]</span>&nbsp;<span class="op" id="4480860">-=</span>&nbsp;<span class="num" id="4480863">1</span>&nbsp;<span class="op" id="4480865">&amp;</span>&nbsp;<span class="ident" id="4480867">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4480873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480877">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4480938">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481007">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481076">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481147">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481157">top4AllOnes</span>&nbsp;<span class="op" id="4481169">:=</span>&nbsp;<span class="builtintype" id="4481172">uint32</span><span class="op" id="4481178">(</span><span class="num" id="4481179">0xffffffff</span><span class="op" id="4481189">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4481192">for</span>&nbsp;<span class="ident" id="4481196">i</span>&nbsp;<span class="op" id="4481198">:=</span>&nbsp;<span class="num" id="4481201">4</span><span class="op" id="4481202">;</span>&nbsp;<span class="ident" id="4481204">i</span>&nbsp;<span class="op" id="4481206">&lt;</span>&nbsp;<span class="num" id="4481208">8</span><span class="op" id="4481209">;</span>&nbsp;<span class="ident" id="4481211">i</span><span class="op" id="4481212">++</span>&nbsp;<span class="op" id="4481215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481219">top4AllOnes</span>&nbsp;<span class="op" id="4481231">&amp;=</span>&nbsp;<span class="ident" id="4481234">out</span><span class="op" id="4481237">[</span><span class="ident" id="4481238">i</span><span class="op" id="4481239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4481242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481245">top4AllOnes</span>&nbsp;<span class="op" id="4481257">|=</span>&nbsp;<span class="num" id="4481260">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481272">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481339">top4AllOnes</span>&nbsp;<span class="op" id="4481351">&amp;=</span>&nbsp;<span class="ident" id="4481354">top4AllOnes</span>&nbsp;<span class="op" id="4481366">&gt;&gt;</span>&nbsp;<span class="num" id="4481369">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481373">top4AllOnes</span>&nbsp;<span class="op" id="4481385">&amp;=</span>&nbsp;<span class="ident" id="4481388">top4AllOnes</span>&nbsp;<span class="op" id="4481400">&gt;&gt;</span>&nbsp;<span class="num" id="4481403">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481406">top4AllOnes</span>&nbsp;<span class="op" id="4481418">&amp;=</span>&nbsp;<span class="ident" id="4481421">top4AllOnes</span>&nbsp;<span class="op" id="4481433">&gt;&gt;</span>&nbsp;<span class="num" id="4481436">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481439">top4AllOnes</span>&nbsp;<span class="op" id="4481451">&amp;=</span>&nbsp;<span class="ident" id="4481454">top4AllOnes</span>&nbsp;<span class="op" id="4481466">&gt;&gt;</span>&nbsp;<span class="num" id="4481469">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481472">top4AllOnes</span>&nbsp;<span class="op" id="4481484">&amp;=</span>&nbsp;<span class="ident" id="4481487">top4AllOnes</span>&nbsp;<span class="op" id="4481499">&gt;&gt;</span>&nbsp;<span class="num" id="4481502">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481505">top4AllOnes</span>&nbsp;<span class="op" id="4481517">=</span>&nbsp;<span class="builtintype" id="4481519">uint32</span><span class="op" id="4481525">(</span><span class="builtintype" id="4481526">int32</span><span class="op" id="4481531">(</span><span class="ident" id="4481532">top4AllOnes</span><span class="op" id="4481543">&lt;&lt;</span><span class="num" id="4481545">31</span><span class="op" id="4481547">)</span>&nbsp;<span class="op" id="4481549">&gt;&gt;</span>&nbsp;<span class="num" id="4481552">31</span><span class="op" id="4481554">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481558">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481619">bottom3NonZero</span>&nbsp;<span class="op" id="4481634">:=</span>&nbsp;<span class="ident" id="4481637">out</span><span class="op" id="4481640">[</span><span class="num" id="4481641">0</span><span class="op" id="4481642">]</span>&nbsp;<span class="op" id="4481644">|</span>&nbsp;<span class="ident" id="4481646">out</span><span class="op" id="4481649">[</span><span class="num" id="4481650">1</span><span class="op" id="4481651">]</span>&nbsp;<span class="op" id="4481653">|</span>&nbsp;<span class="ident" id="4481655">out</span><span class="op" id="4481658">[</span><span class="num" id="4481659">2</span><span class="op" id="4481660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481663">bottom3NonZero</span>&nbsp;<span class="op" id="4481678">|=</span>&nbsp;<span class="ident" id="4481681">bottom3NonZero</span>&nbsp;<span class="op" id="4481696">&gt;&gt;</span>&nbsp;<span class="num" id="4481699">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481703">bottom3NonZero</span>&nbsp;<span class="op" id="4481718">|=</span>&nbsp;<span class="ident" id="4481721">bottom3NonZero</span>&nbsp;<span class="op" id="4481736">&gt;&gt;</span>&nbsp;<span class="num" id="4481739">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481742">bottom3NonZero</span>&nbsp;<span class="op" id="4481757">|=</span>&nbsp;<span class="ident" id="4481760">bottom3NonZero</span>&nbsp;<span class="op" id="4481775">&gt;&gt;</span>&nbsp;<span class="num" id="4481778">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481781">bottom3NonZero</span>&nbsp;<span class="op" id="4481796">|=</span>&nbsp;<span class="ident" id="4481799">bottom3NonZero</span>&nbsp;<span class="op" id="4481814">&gt;&gt;</span>&nbsp;<span class="num" id="4481817">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481820">bottom3NonZero</span>&nbsp;<span class="op" id="4481835">|=</span>&nbsp;<span class="ident" id="4481838">bottom3NonZero</span>&nbsp;<span class="op" id="4481853">&gt;&gt;</span>&nbsp;<span class="num" id="4481856">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4481859">bottom3NonZero</span>&nbsp;<span class="op" id="4481874">=</span>&nbsp;<span class="builtintype" id="4481876">uint32</span><span class="op" id="4481882">(</span><span class="builtintype" id="4481883">int32</span><span class="op" id="4481888">(</span><span class="ident" id="4481889">bottom3NonZero</span><span class="op" id="4481903">&lt;&lt;</span><span class="num" id="4481905">31</span><span class="op" id="4481907">)</span>&nbsp;<span class="op" id="4481909">&gt;&gt;</span>&nbsp;<span class="num" id="4481912">31</span><span class="op" id="4481914">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481918">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4481965">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4482042">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4482115">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4482153">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482209">n</span>&nbsp;<span class="op" id="4482211">:=</span>&nbsp;<span class="ident" id="4482214">out</span><span class="op" id="4482217">[</span><span class="num" id="4482218">3</span><span class="op" id="4482219">]</span>&nbsp;<span class="op" id="4482221">-</span>&nbsp;<span class="num" id="4482223">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482234">out3Equal</span>&nbsp;<span class="op" id="4482244">:=</span>&nbsp;<span class="ident" id="4482247">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482250">out3Equal</span>&nbsp;<span class="op" id="4482260">|=</span>&nbsp;<span class="ident" id="4482263">out3Equal</span>&nbsp;<span class="op" id="4482273">&gt;&gt;</span>&nbsp;<span class="num" id="4482276">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482280">out3Equal</span>&nbsp;<span class="op" id="4482290">|=</span>&nbsp;<span class="ident" id="4482293">out3Equal</span>&nbsp;<span class="op" id="4482303">&gt;&gt;</span>&nbsp;<span class="num" id="4482306">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482309">out3Equal</span>&nbsp;<span class="op" id="4482319">|=</span>&nbsp;<span class="ident" id="4482322">out3Equal</span>&nbsp;<span class="op" id="4482332">&gt;&gt;</span>&nbsp;<span class="num" id="4482335">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482338">out3Equal</span>&nbsp;<span class="op" id="4482348">|=</span>&nbsp;<span class="ident" id="4482351">out3Equal</span>&nbsp;<span class="op" id="4482361">&gt;&gt;</span>&nbsp;<span class="num" id="4482364">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482367">out3Equal</span>&nbsp;<span class="op" id="4482377">|=</span>&nbsp;<span class="ident" id="4482380">out3Equal</span>&nbsp;<span class="op" id="4482390">&gt;&gt;</span>&nbsp;<span class="num" id="4482393">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482396">out3Equal</span>&nbsp;<span class="op" id="4482406">=</span>&nbsp;<span class="op" id="4482408">^</span><span class="builtintype" id="4482409">uint32</span><span class="op" id="4482415">(</span><span class="builtintype" id="4482416">int32</span><span class="op" id="4482421">(</span><span class="ident" id="4482422">out3Equal</span><span class="op" id="4482431">&lt;&lt;</span><span class="num" id="4482433">31</span><span class="op" id="4482435">)</span>&nbsp;<span class="op" id="4482437">&gt;&gt;</span>&nbsp;<span class="num" id="4482440">31</span><span class="op" id="4482442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4482446">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482499">out3GT</span>&nbsp;<span class="op" id="4482506">:=</span>&nbsp;<span class="op" id="4482509">^</span><span class="builtintype" id="4482510">uint32</span><span class="op" id="4482516">(</span><span class="builtintype" id="4482517">int32</span><span class="op" id="4482522">(</span><span class="ident" id="4482523">n</span><span class="op" id="4482524">)</span>&nbsp;<span class="op" id="4482526">&gt;&gt;</span>&nbsp;<span class="num" id="4482529">31</span><span class="op" id="4482531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482535">mask</span>&nbsp;<span class="op" id="4482540">:=</span>&nbsp;<span class="ident" id="4482543">top4AllOnes</span>&nbsp;<span class="op" id="4482555">&amp;</span>&nbsp;<span class="op" id="4482557">(</span><span class="op" id="4482558">(</span><span class="ident" id="4482559">out3Equal</span>&nbsp;<span class="op" id="4482569">&amp;</span>&nbsp;<span class="ident" id="4482571">bottom3NonZero</span><span class="op" id="4482585">)</span>&nbsp;<span class="op" id="4482587">|</span>&nbsp;<span class="ident" id="4482589">out3GT</span><span class="op" id="4482595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482598">out</span><span class="op" id="4482601">[</span><span class="num" id="4482602">0</span><span class="op" id="4482603">]</span>&nbsp;<span class="op" id="4482605">-=</span>&nbsp;<span class="num" id="4482608">1</span>&nbsp;<span class="op" id="4482610">&amp;</span>&nbsp;<span class="ident" id="4482612">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482618">out</span><span class="op" id="4482621">[</span><span class="num" id="4482622">3</span><span class="op" id="4482623">]</span>&nbsp;<span class="op" id="4482625">-=</span>&nbsp;<span class="num" id="4482628">0xffff000</span>&nbsp;<span class="op" id="4482638">&amp;</span>&nbsp;<span class="ident" id="4482640">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482646">out</span><span class="op" id="4482649">[</span><span class="num" id="4482650">4</span><span class="op" id="4482651">]</span>&nbsp;<span class="op" id="4482653">-=</span>&nbsp;<span class="num" id="4482656">0xfffffff</span>&nbsp;<span class="op" id="4482666">&amp;</span>&nbsp;<span class="ident" id="4482668">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482674">out</span><span class="op" id="4482677">[</span><span class="num" id="4482678">5</span><span class="op" id="4482679">]</span>&nbsp;<span class="op" id="4482681">-=</span>&nbsp;<span class="num" id="4482684">0xfffffff</span>&nbsp;<span class="op" id="4482694">&amp;</span>&nbsp;<span class="ident" id="4482696">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482702">out</span><span class="op" id="4482705">[</span><span class="num" id="4482706">6</span><span class="op" id="4482707">]</span>&nbsp;<span class="op" id="4482709">-=</span>&nbsp;<span class="num" id="4482712">0xfffffff</span>&nbsp;<span class="op" id="4482722">&amp;</span>&nbsp;<span class="ident" id="4482724">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4482730">out</span><span class="op" id="4482733">[</span><span class="num" id="4482734">7</span><span class="op" id="4482735">]</span>&nbsp;<span class="op" id="4482737">-=</span>&nbsp;<span class="num" id="4482740">0xfffffff</span>&nbsp;<span class="op" id="4482750">&amp;</span>&nbsp;<span class="ident" id="4482752">mask</span><br>
<span class="lineno">495</span><span class="op" id="4482757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4482760">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4482788">//</span><br>
<span class="lineno"></span><span class="comment" id="4482791">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4482867">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4482927">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4482980">func</span>&nbsp;<span class="ident" id="4482985">p224AddJacobian</span><span class="op" id="4483000">(</span><span class="ident" id="4483001">x3</span><span class="op" id="4483003">,</span>&nbsp;<span class="ident" id="4483005">y3</span><span class="op" id="4483007">,</span>&nbsp;<span class="ident" id="4483009">z3</span><span class="op" id="4483011">,</span>&nbsp;<span class="ident" id="4483013">x1</span><span class="op" id="4483015">,</span>&nbsp;<span class="ident" id="4483017">y1</span><span class="op" id="4483019">,</span>&nbsp;<span class="ident" id="4483021">z1</span><span class="op" id="4483023">,</span>&nbsp;<span class="ident" id="4483025">x2</span><span class="op" id="4483027">,</span>&nbsp;<span class="ident" id="4483029">y2</span><span class="op" id="4483031">,</span>&nbsp;<span class="ident" id="4483033">z2</span>&nbsp;<span class="op" id="4483036">*</span><span class="ident" id="4483037">p224FieldElement</span><span class="op" id="4483053">)</span>&nbsp;<span class="op" id="4483055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483058">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483152">var</span>&nbsp;<span class="ident" id="4483156">z1z1</span><span class="op" id="4483160">,</span>&nbsp;<span class="ident" id="4483162">z2z2</span><span class="op" id="4483166">,</span>&nbsp;<span class="ident" id="4483168">u1</span><span class="op" id="4483170">,</span>&nbsp;<span class="ident" id="4483172">u2</span><span class="op" id="4483174">,</span>&nbsp;<span class="ident" id="4483176">s1</span><span class="op" id="4483178">,</span>&nbsp;<span class="ident" id="4483180">s2</span><span class="op" id="4483182">,</span>&nbsp;<span class="ident" id="4483184">h</span><span class="op" id="4483185">,</span>&nbsp;<span class="ident" id="4483187">i</span><span class="op" id="4483188">,</span>&nbsp;<span class="ident" id="4483190">j</span><span class="op" id="4483191">,</span>&nbsp;<span class="ident" id="4483193">r</span><span class="op" id="4483194">,</span>&nbsp;<span class="ident" id="4483196">v</span>&nbsp;<span class="ident" id="4483198">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483216">var</span>&nbsp;<span class="ident" id="4483220">c</span>&nbsp;<span class="ident" id="4483222">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483246">z1IsZero</span>&nbsp;<span class="op" id="4483255">:=</span>&nbsp;<span class="ident" id="4483258">p224IsZero</span><span class="op" id="4483268">(</span><span class="ident" id="4483269">z1</span><span class="op" id="4483271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483274">z2IsZero</span>&nbsp;<span class="op" id="4483283">:=</span>&nbsp;<span class="ident" id="4483286">p224IsZero</span><span class="op" id="4483296">(</span><span class="ident" id="4483297">z2</span><span class="op" id="4483299">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483303">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483319">p224Square</span><span class="op" id="4483329">(</span><span class="op" id="4483330">&amp;</span><span class="ident" id="4483331">z1z1</span><span class="op" id="4483335">,</span>&nbsp;<span class="ident" id="4483337">z1</span><span class="op" id="4483339">,</span>&nbsp;<span class="op" id="4483341">&amp;</span><span class="ident" id="4483342">c</span><span class="op" id="4483343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483346">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483362">p224Square</span><span class="op" id="4483372">(</span><span class="op" id="4483373">&amp;</span><span class="ident" id="4483374">z2z2</span><span class="op" id="4483378">,</span>&nbsp;<span class="ident" id="4483380">z2</span><span class="op" id="4483382">,</span>&nbsp;<span class="op" id="4483384">&amp;</span><span class="ident" id="4483385">c</span><span class="op" id="4483386">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483389">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483406">p224Mul</span><span class="op" id="4483413">(</span><span class="op" id="4483414">&amp;</span><span class="ident" id="4483415">u1</span><span class="op" id="4483417">,</span>&nbsp;<span class="ident" id="4483419">x1</span><span class="op" id="4483421">,</span>&nbsp;<span class="op" id="4483423">&amp;</span><span class="ident" id="4483424">z2z2</span><span class="op" id="4483428">,</span>&nbsp;<span class="op" id="4483430">&amp;</span><span class="ident" id="4483431">c</span><span class="op" id="4483432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483435">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483452">p224Mul</span><span class="op" id="4483459">(</span><span class="op" id="4483460">&amp;</span><span class="ident" id="4483461">u2</span><span class="op" id="4483463">,</span>&nbsp;<span class="ident" id="4483465">x2</span><span class="op" id="4483467">,</span>&nbsp;<span class="op" id="4483469">&amp;</span><span class="ident" id="4483470">z1z1</span><span class="op" id="4483474">,</span>&nbsp;<span class="op" id="4483476">&amp;</span><span class="ident" id="4483477">c</span><span class="op" id="4483478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483481">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483501">p224Mul</span><span class="op" id="4483508">(</span><span class="op" id="4483509">&amp;</span><span class="ident" id="4483510">s1</span><span class="op" id="4483512">,</span>&nbsp;<span class="ident" id="4483514">z2</span><span class="op" id="4483516">,</span>&nbsp;<span class="op" id="4483518">&amp;</span><span class="ident" id="4483519">z2z2</span><span class="op" id="4483523">,</span>&nbsp;<span class="op" id="4483525">&amp;</span><span class="ident" id="4483526">c</span><span class="op" id="4483527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483530">p224Mul</span><span class="op" id="4483537">(</span><span class="op" id="4483538">&amp;</span><span class="ident" id="4483539">s1</span><span class="op" id="4483541">,</span>&nbsp;<span class="ident" id="4483543">y1</span><span class="op" id="4483545">,</span>&nbsp;<span class="op" id="4483547">&amp;</span><span class="ident" id="4483548">s1</span><span class="op" id="4483550">,</span>&nbsp;<span class="op" id="4483552">&amp;</span><span class="ident" id="4483553">c</span><span class="op" id="4483554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483557">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483577">p224Mul</span><span class="op" id="4483584">(</span><span class="op" id="4483585">&amp;</span><span class="ident" id="4483586">s2</span><span class="op" id="4483588">,</span>&nbsp;<span class="ident" id="4483590">z1</span><span class="op" id="4483592">,</span>&nbsp;<span class="op" id="4483594">&amp;</span><span class="ident" id="4483595">z1z1</span><span class="op" id="4483599">,</span>&nbsp;<span class="op" id="4483601">&amp;</span><span class="ident" id="4483602">c</span><span class="op" id="4483603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483606">p224Mul</span><span class="op" id="4483613">(</span><span class="op" id="4483614">&amp;</span><span class="ident" id="4483615">s2</span><span class="op" id="4483617">,</span>&nbsp;<span class="ident" id="4483619">y2</span><span class="op" id="4483621">,</span>&nbsp;<span class="op" id="4483623">&amp;</span><span class="ident" id="4483624">s2</span><span class="op" id="4483626">,</span>&nbsp;<span class="op" id="4483628">&amp;</span><span class="ident" id="4483629">c</span><span class="op" id="4483630">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483633">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483647">p224Sub</span><span class="op" id="4483654">(</span><span class="op" id="4483655">&amp;</span><span class="ident" id="4483656">h</span><span class="op" id="4483657">,</span>&nbsp;<span class="op" id="4483659">&amp;</span><span class="ident" id="4483660">u2</span><span class="op" id="4483662">,</span>&nbsp;<span class="op" id="4483664">&amp;</span><span class="ident" id="4483665">u1</span><span class="op" id="4483667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483670">p224Reduce</span><span class="op" id="4483680">(</span><span class="op" id="4483681">&amp;</span><span class="ident" id="4483682">h</span><span class="op" id="4483683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483686">xEqual</span>&nbsp;<span class="op" id="4483693">:=</span>&nbsp;<span class="ident" id="4483696">p224IsZero</span><span class="op" id="4483706">(</span><span class="op" id="4483707">&amp;</span><span class="ident" id="4483708">h</span><span class="op" id="4483709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483712">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483728">for</span>&nbsp;<span class="ident" id="4483732">j</span>&nbsp;<span class="op" id="4483734">:=</span>&nbsp;<span class="num" id="4483737">0</span><span class="op" id="4483738">;</span>&nbsp;<span class="ident" id="4483740">j</span>&nbsp;<span class="op" id="4483742">&lt;</span>&nbsp;<span class="num" id="4483744">8</span><span class="op" id="4483745">;</span>&nbsp;<span class="ident" id="4483747">j</span><span class="op" id="4483748">++</span>&nbsp;<span class="op" id="4483751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483755">i</span><span class="op" id="4483756">[</span><span class="ident" id="4483757">j</span><span class="op" id="4483758">]</span>&nbsp;<span class="op" id="4483760">=</span>&nbsp;<span class="ident" id="4483762">h</span><span class="op" id="4483763">[</span><span class="ident" id="4483764">j</span><span class="op" id="4483765">]</span>&nbsp;<span class="op" id="4483767">&lt;&lt;</span>&nbsp;<span class="num" id="4483770">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4483773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483776">p224Reduce</span><span class="op" id="4483786">(</span><span class="op" id="4483787">&amp;</span><span class="ident" id="4483788">i</span><span class="op" id="4483789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483792">p224Square</span><span class="op" id="4483802">(</span><span class="op" id="4483803">&amp;</span><span class="ident" id="4483804">i</span><span class="op" id="4483805">,</span>&nbsp;<span class="op" id="4483807">&amp;</span><span class="ident" id="4483808">i</span><span class="op" id="4483809">,</span>&nbsp;<span class="op" id="4483811">&amp;</span><span class="ident" id="4483812">c</span><span class="op" id="4483813">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483816">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483828">p224Mul</span><span class="op" id="4483835">(</span><span class="op" id="4483836">&amp;</span><span class="ident" id="4483837">j</span><span class="op" id="4483838">,</span>&nbsp;<span class="op" id="4483840">&amp;</span><span class="ident" id="4483841">h</span><span class="op" id="4483842">,</span>&nbsp;<span class="op" id="4483844">&amp;</span><span class="ident" id="4483845">i</span><span class="op" id="4483846">,</span>&nbsp;<span class="op" id="4483848">&amp;</span><span class="ident" id="4483849">c</span><span class="op" id="4483850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4483853">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483871">p224Sub</span><span class="op" id="4483878">(</span><span class="op" id="4483879">&amp;</span><span class="ident" id="4483880">r</span><span class="op" id="4483881">,</span>&nbsp;<span class="op" id="4483883">&amp;</span><span class="ident" id="4483884">s2</span><span class="op" id="4483886">,</span>&nbsp;<span class="op" id="4483888">&amp;</span><span class="ident" id="4483889">s1</span><span class="op" id="4483891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483894">p224Reduce</span><span class="op" id="4483904">(</span><span class="op" id="4483905">&amp;</span><span class="ident" id="4483906">r</span><span class="op" id="4483907">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4483910">yEqual</span>&nbsp;<span class="op" id="4483917">:=</span>&nbsp;<span class="ident" id="4483920">p224IsZero</span><span class="op" id="4483930">(</span><span class="op" id="4483931">&amp;</span><span class="ident" id="4483932">r</span><span class="op" id="4483933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4483936">if</span>&nbsp;<span class="ident" id="4483939">xEqual</span>&nbsp;<span class="op" id="4483946">==</span>&nbsp;<span class="num" id="4483949">1</span>&nbsp;<span class="op" id="4483951">&amp;&amp;</span>&nbsp;<span class="ident" id="4483954">yEqual</span>&nbsp;<span class="op" id="4483961">==</span>&nbsp;<span class="num" id="4483964">1</span>&nbsp;<span class="op" id="4483966">&amp;&amp;</span>&nbsp;<span class="ident" id="4483969">z1IsZero</span>&nbsp;<span class="op" id="4483978">==</span>&nbsp;<span class="num" id="4483981">0</span>&nbsp;<span class="op" id="4483983">&amp;&amp;</span>&nbsp;<span class="ident" id="4483986">z2IsZero</span>&nbsp;<span class="op" id="4483995">==</span>&nbsp;<span class="num" id="4483998">0</span>&nbsp;<span class="op" id="4484000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484004">p224DoubleJacobian</span><span class="op" id="4484022">(</span><span class="ident" id="4484023">x3</span><span class="op" id="4484025">,</span>&nbsp;<span class="ident" id="4484027">y3</span><span class="op" id="4484029">,</span>&nbsp;<span class="ident" id="4484031">z3</span><span class="op" id="4484033">,</span>&nbsp;<span class="ident" id="4484035">x1</span><span class="op" id="4484037">,</span>&nbsp;<span class="ident" id="4484039">y1</span><span class="op" id="4484041">,</span>&nbsp;<span class="ident" id="4484043">z1</span><span class="op" id="4484045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484049">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484057">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484060">for</span>&nbsp;<span class="ident" id="4484064">i</span>&nbsp;<span class="op" id="4484066">:=</span>&nbsp;<span class="num" id="4484069">0</span><span class="op" id="4484070">;</span>&nbsp;<span class="ident" id="4484072">i</span>&nbsp;<span class="op" id="4484074">&lt;</span>&nbsp;<span class="num" id="4484076">8</span><span class="op" id="4484077">;</span>&nbsp;<span class="ident" id="4484079">i</span><span class="op" id="4484080">++</span>&nbsp;<span class="op" id="4484083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484087">r</span><span class="op" id="4484088">[</span><span class="ident" id="4484089">i</span><span class="op" id="4484090">]</span>&nbsp;<span class="op" id="4484092">&lt;&lt;=</span>&nbsp;<span class="num" id="4484096">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484102">p224Reduce</span><span class="op" id="4484112">(</span><span class="op" id="4484113">&amp;</span><span class="ident" id="4484114">r</span><span class="op" id="4484115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484118">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484131">p224Mul</span><span class="op" id="4484138">(</span><span class="op" id="4484139">&amp;</span><span class="ident" id="4484140">v</span><span class="op" id="4484141">,</span>&nbsp;<span class="op" id="4484143">&amp;</span><span class="ident" id="4484144">u1</span><span class="op" id="4484146">,</span>&nbsp;<span class="op" id="4484148">&amp;</span><span class="ident" id="4484149">i</span><span class="op" id="4484150">,</span>&nbsp;<span class="op" id="4484152">&amp;</span><span class="ident" id="4484153">c</span><span class="op" id="4484154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484157">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484190">p224Add</span><span class="op" id="4484197">(</span><span class="op" id="4484198">&amp;</span><span class="ident" id="4484199">z1z1</span><span class="op" id="4484203">,</span>&nbsp;<span class="op" id="4484205">&amp;</span><span class="ident" id="4484206">z1z1</span><span class="op" id="4484210">,</span>&nbsp;<span class="op" id="4484212">&amp;</span><span class="ident" id="4484213">z2z2</span><span class="op" id="4484217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484220">p224Add</span><span class="op" id="4484227">(</span><span class="op" id="4484228">&amp;</span><span class="ident" id="4484229">z2z2</span><span class="op" id="4484233">,</span>&nbsp;<span class="ident" id="4484235">z1</span><span class="op" id="4484237">,</span>&nbsp;<span class="ident" id="4484239">z2</span><span class="op" id="4484241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484244">p224Reduce</span><span class="op" id="4484254">(</span><span class="op" id="4484255">&amp;</span><span class="ident" id="4484256">z2z2</span><span class="op" id="4484260">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484263">p224Square</span><span class="op" id="4484273">(</span><span class="op" id="4484274">&amp;</span><span class="ident" id="4484275">z2z2</span><span class="op" id="4484279">,</span>&nbsp;<span class="op" id="4484281">&amp;</span><span class="ident" id="4484282">z2z2</span><span class="op" id="4484286">,</span>&nbsp;<span class="op" id="4484288">&amp;</span><span class="ident" id="4484289">c</span><span class="op" id="4484290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484293">p224Sub</span><span class="op" id="4484300">(</span><span class="ident" id="4484301">z3</span><span class="op" id="4484303">,</span>&nbsp;<span class="op" id="4484305">&amp;</span><span class="ident" id="4484306">z2z2</span><span class="op" id="4484310">,</span>&nbsp;<span class="op" id="4484312">&amp;</span><span class="ident" id="4484313">z1z1</span><span class="op" id="4484317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484320">p224Reduce</span><span class="op" id="4484330">(</span><span class="ident" id="4484331">z3</span><span class="op" id="4484333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484336">p224Mul</span><span class="op" id="4484343">(</span><span class="ident" id="4484344">z3</span><span class="op" id="4484346">,</span>&nbsp;<span class="ident" id="4484348">z3</span><span class="op" id="4484350">,</span>&nbsp;<span class="op" id="4484352">&amp;</span><span class="ident" id="4484353">h</span><span class="op" id="4484354">,</span>&nbsp;<span class="op" id="4484356">&amp;</span><span class="ident" id="4484357">c</span><span class="op" id="4484358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484361">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484380">for</span>&nbsp;<span class="ident" id="4484384">i</span>&nbsp;<span class="op" id="4484386">:=</span>&nbsp;<span class="num" id="4484389">0</span><span class="op" id="4484390">;</span>&nbsp;<span class="ident" id="4484392">i</span>&nbsp;<span class="op" id="4484394">&lt;</span>&nbsp;<span class="num" id="4484396">8</span><span class="op" id="4484397">;</span>&nbsp;<span class="ident" id="4484399">i</span><span class="op" id="4484400">++</span>&nbsp;<span class="op" id="4484403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484407">z1z1</span><span class="op" id="4484411">[</span><span class="ident" id="4484412">i</span><span class="op" id="4484413">]</span>&nbsp;<span class="op" id="4484415">=</span>&nbsp;<span class="ident" id="4484417">v</span><span class="op" id="4484418">[</span><span class="ident" id="4484419">i</span><span class="op" id="4484420">]</span>&nbsp;<span class="op" id="4484422">&lt;&lt;</span>&nbsp;<span class="num" id="4484425">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484431">p224Add</span><span class="op" id="4484438">(</span><span class="op" id="4484439">&amp;</span><span class="ident" id="4484440">z1z1</span><span class="op" id="4484444">,</span>&nbsp;<span class="op" id="4484446">&amp;</span><span class="ident" id="4484447">j</span><span class="op" id="4484448">,</span>&nbsp;<span class="op" id="4484450">&amp;</span><span class="ident" id="4484451">z1z1</span><span class="op" id="4484455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484458">p224Reduce</span><span class="op" id="4484468">(</span><span class="op" id="4484469">&amp;</span><span class="ident" id="4484470">z1z1</span><span class="op" id="4484474">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484477">p224Square</span><span class="op" id="4484487">(</span><span class="ident" id="4484488">x3</span><span class="op" id="4484490">,</span>&nbsp;<span class="op" id="4484492">&amp;</span><span class="ident" id="4484493">r</span><span class="op" id="4484494">,</span>&nbsp;<span class="op" id="4484496">&amp;</span><span class="ident" id="4484497">c</span><span class="op" id="4484498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484501">p224Sub</span><span class="op" id="4484508">(</span><span class="ident" id="4484509">x3</span><span class="op" id="4484511">,</span>&nbsp;<span class="ident" id="4484513">x3</span><span class="op" id="4484515">,</span>&nbsp;<span class="op" id="4484517">&amp;</span><span class="ident" id="4484518">z1z1</span><span class="op" id="4484522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484525">p224Reduce</span><span class="op" id="4484535">(</span><span class="ident" id="4484536">x3</span><span class="op" id="4484538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4484541">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4484566">for</span>&nbsp;<span class="ident" id="4484570">i</span>&nbsp;<span class="op" id="4484572">:=</span>&nbsp;<span class="num" id="4484575">0</span><span class="op" id="4484576">;</span>&nbsp;<span class="ident" id="4484578">i</span>&nbsp;<span class="op" id="4484580">&lt;</span>&nbsp;<span class="num" id="4484582">8</span><span class="op" id="4484583">;</span>&nbsp;<span class="ident" id="4484585">i</span><span class="op" id="4484586">++</span>&nbsp;<span class="op" id="4484589">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484593">s1</span><span class="op" id="4484595">[</span><span class="ident" id="4484596">i</span><span class="op" id="4484597">]</span>&nbsp;<span class="op" id="4484599">&lt;&lt;=</span>&nbsp;<span class="num" id="4484603">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4484606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484609">p224Mul</span><span class="op" id="4484616">(</span><span class="op" id="4484617">&amp;</span><span class="ident" id="4484618">s1</span><span class="op" id="4484620">,</span>&nbsp;<span class="op" id="4484622">&amp;</span><span class="ident" id="4484623">s1</span><span class="op" id="4484625">,</span>&nbsp;<span class="op" id="4484627">&amp;</span><span class="ident" id="4484628">j</span><span class="op" id="4484629">,</span>&nbsp;<span class="op" id="4484631">&amp;</span><span class="ident" id="4484632">c</span><span class="op" id="4484633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484636">p224Sub</span><span class="op" id="4484643">(</span><span class="op" id="4484644">&amp;</span><span class="ident" id="4484645">z1z1</span><span class="op" id="4484649">,</span>&nbsp;<span class="op" id="4484651">&amp;</span><span class="ident" id="4484652">v</span><span class="op" id="4484653">,</span>&nbsp;<span class="ident" id="4484655">x3</span><span class="op" id="4484657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484660">p224Reduce</span><span class="op" id="4484670">(</span><span class="op" id="4484671">&amp;</span><span class="ident" id="4484672">z1z1</span><span class="op" id="4484676">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484679">p224Mul</span><span class="op" id="4484686">(</span><span class="op" id="4484687">&amp;</span><span class="ident" id="4484688">z1z1</span><span class="op" id="4484692">,</span>&nbsp;<span class="op" id="4484694">&amp;</span><span class="ident" id="4484695">z1z1</span><span class="op" id="4484699">,</span>&nbsp;<span class="op" id="4484701">&amp;</span><span class="ident" id="4484702">r</span><span class="op" id="4484703">,</span>&nbsp;<span class="op" id="4484705">&amp;</span><span class="ident" id="4484706">c</span><span class="op" id="4484707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484710">p224Sub</span><span class="op" id="4484717">(</span><span class="ident" id="4484718">y3</span><span class="op" id="4484720">,</span>&nbsp;<span class="op" id="4484722">&amp;</span><span class="ident" id="4484723">z1z1</span><span class="op" id="4484727">,</span>&nbsp;<span class="op" id="4484729">&amp;</span><span class="ident" id="4484730">s1</span><span class="op" id="4484732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484735">p224Reduce</span><span class="op" id="4484745">(</span><span class="ident" id="4484746">y3</span><span class="op" id="4484748">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484752">p224CopyConditional</span><span class="op" id="4484771">(</span><span class="ident" id="4484772">x3</span><span class="op" id="4484774">,</span>&nbsp;<span class="ident" id="4484776">x2</span><span class="op" id="4484778">,</span>&nbsp;<span class="ident" id="4484780">z1IsZero</span><span class="op" id="4484788">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484791">p224CopyConditional</span><span class="op" id="4484810">(</span><span class="ident" id="4484811">x3</span><span class="op" id="4484813">,</span>&nbsp;<span class="ident" id="4484815">x1</span><span class="op" id="4484817">,</span>&nbsp;<span class="ident" id="4484819">z2IsZero</span><span class="op" id="4484827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484830">p224CopyConditional</span><span class="op" id="4484849">(</span><span class="ident" id="4484850">y3</span><span class="op" id="4484852">,</span>&nbsp;<span class="ident" id="4484854">y2</span><span class="op" id="4484856">,</span>&nbsp;<span class="ident" id="4484858">z1IsZero</span><span class="op" id="4484866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484869">p224CopyConditional</span><span class="op" id="4484888">(</span><span class="ident" id="4484889">y3</span><span class="op" id="4484891">,</span>&nbsp;<span class="ident" id="4484893">y1</span><span class="op" id="4484895">,</span>&nbsp;<span class="ident" id="4484897">z2IsZero</span><span class="op" id="4484905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484908">p224CopyConditional</span><span class="op" id="4484927">(</span><span class="ident" id="4484928">z3</span><span class="op" id="4484930">,</span>&nbsp;<span class="ident" id="4484932">z2</span><span class="op" id="4484934">,</span>&nbsp;<span class="ident" id="4484936">z1IsZero</span><span class="op" id="4484944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4484947">p224CopyConditional</span><span class="op" id="4484966">(</span><span class="ident" id="4484967">z3</span><span class="op" id="4484969">,</span>&nbsp;<span class="ident" id="4484971">z1</span><span class="op" id="4484973">,</span>&nbsp;<span class="ident" id="4484975">z2IsZero</span><span class="op" id="4484983">)</span><br>
<span class="lineno">585</span><span class="op" id="4484985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4484988">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4485031">func</span>&nbsp;<span class="ident" id="4485036">p224DoubleJacobian</span><span class="op" id="4485054">(</span><span class="ident" id="4485055">x3</span><span class="op" id="4485057">,</span>&nbsp;<span class="ident" id="4485059">y3</span><span class="op" id="4485061">,</span>&nbsp;<span class="ident" id="4485063">z3</span><span class="op" id="4485065">,</span>&nbsp;<span class="ident" id="4485067">x1</span><span class="op" id="4485069">,</span>&nbsp;<span class="ident" id="4485071">y1</span><span class="op" id="4485073">,</span>&nbsp;<span class="ident" id="4485075">z1</span>&nbsp;<span class="op" id="4485078">*</span><span class="ident" id="4485079">p224FieldElement</span><span class="op" id="4485095">)</span>&nbsp;<span class="op" id="4485097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485100">var</span>&nbsp;<span class="ident" id="4485104">delta</span><span class="op" id="4485109">,</span>&nbsp;<span class="ident" id="4485111">gamma</span><span class="op" id="4485116">,</span>&nbsp;<span class="ident" id="4485118">beta</span><span class="op" id="4485122">,</span>&nbsp;<span class="ident" id="4485124">alpha</span><span class="op" id="4485129">,</span>&nbsp;<span class="ident" id="4485131">t</span>&nbsp;<span class="ident" id="4485133">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485151">var</span>&nbsp;<span class="ident" id="4485155">c</span>&nbsp;<span class="ident" id="4485157">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485181">p224Square</span><span class="op" id="4485191">(</span><span class="op" id="4485192">&amp;</span><span class="ident" id="4485193">delta</span><span class="op" id="4485198">,</span>&nbsp;<span class="ident" id="4485200">z1</span><span class="op" id="4485202">,</span>&nbsp;<span class="op" id="4485204">&amp;</span><span class="ident" id="4485205">c</span><span class="op" id="4485206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485209">p224Square</span><span class="op" id="4485219">(</span><span class="op" id="4485220">&amp;</span><span class="ident" id="4485221">gamma</span><span class="op" id="4485226">,</span>&nbsp;<span class="ident" id="4485228">y1</span><span class="op" id="4485230">,</span>&nbsp;<span class="op" id="4485232">&amp;</span><span class="ident" id="4485233">c</span><span class="op" id="4485234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485237">p224Mul</span><span class="op" id="4485244">(</span><span class="op" id="4485245">&amp;</span><span class="ident" id="4485246">beta</span><span class="op" id="4485250">,</span>&nbsp;<span class="ident" id="4485252">x1</span><span class="op" id="4485254">,</span>&nbsp;<span class="op" id="4485256">&amp;</span><span class="ident" id="4485257">gamma</span><span class="op" id="4485262">,</span>&nbsp;<span class="op" id="4485264">&amp;</span><span class="ident" id="4485265">c</span><span class="op" id="4485266">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485270">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485306">p224Add</span><span class="op" id="4485313">(</span><span class="op" id="4485314">&amp;</span><span class="ident" id="4485315">t</span><span class="op" id="4485316">,</span>&nbsp;<span class="ident" id="4485318">x1</span><span class="op" id="4485320">,</span>&nbsp;<span class="op" id="4485322">&amp;</span><span class="ident" id="4485323">delta</span><span class="op" id="4485328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485331">for</span>&nbsp;<span class="ident" id="4485335">i</span>&nbsp;<span class="op" id="4485337">:=</span>&nbsp;<span class="num" id="4485340">0</span><span class="op" id="4485341">;</span>&nbsp;<span class="ident" id="4485343">i</span>&nbsp;<span class="op" id="4485345">&lt;</span>&nbsp;<span class="num" id="4485347">8</span><span class="op" id="4485348">;</span>&nbsp;<span class="ident" id="4485350">i</span><span class="op" id="4485351">++</span>&nbsp;<span class="op" id="4485354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485358">t</span><span class="op" id="4485359">[</span><span class="ident" id="4485360">i</span><span class="op" id="4485361">]</span>&nbsp;<span class="op" id="4485363">+=</span>&nbsp;<span class="ident" id="4485366">t</span><span class="op" id="4485367">[</span><span class="ident" id="4485368">i</span><span class="op" id="4485369">]</span>&nbsp;<span class="op" id="4485371">&lt;&lt;</span>&nbsp;<span class="num" id="4485374">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4485377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485380">p224Reduce</span><span class="op" id="4485390">(</span><span class="op" id="4485391">&amp;</span><span class="ident" id="4485392">t</span><span class="op" id="4485393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485396">p224Sub</span><span class="op" id="4485403">(</span><span class="op" id="4485404">&amp;</span><span class="ident" id="4485405">alpha</span><span class="op" id="4485410">,</span>&nbsp;<span class="ident" id="4485412">x1</span><span class="op" id="4485414">,</span>&nbsp;<span class="op" id="4485416">&amp;</span><span class="ident" id="4485417">delta</span><span class="op" id="4485422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485425">p224Reduce</span><span class="op" id="4485435">(</span><span class="op" id="4485436">&amp;</span><span class="ident" id="4485437">alpha</span><span class="op" id="4485442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485445">p224Mul</span><span class="op" id="4485452">(</span><span class="op" id="4485453">&amp;</span><span class="ident" id="4485454">alpha</span><span class="op" id="4485459">,</span>&nbsp;<span class="op" id="4485461">&amp;</span><span class="ident" id="4485462">alpha</span><span class="op" id="4485467">,</span>&nbsp;<span class="op" id="4485469">&amp;</span><span class="ident" id="4485470">t</span><span class="op" id="4485471">,</span>&nbsp;<span class="op" id="4485473">&amp;</span><span class="ident" id="4485474">c</span><span class="op" id="4485475">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485479">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485510">p224Add</span><span class="op" id="4485517">(</span><span class="ident" id="4485518">z3</span><span class="op" id="4485520">,</span>&nbsp;<span class="ident" id="4485522">y1</span><span class="op" id="4485524">,</span>&nbsp;<span class="ident" id="4485526">z1</span><span class="op" id="4485528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485531">p224Reduce</span><span class="op" id="4485541">(</span><span class="ident" id="4485542">z3</span><span class="op" id="4485544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485547">p224Square</span><span class="op" id="4485557">(</span><span class="ident" id="4485558">z3</span><span class="op" id="4485560">,</span>&nbsp;<span class="ident" id="4485562">z3</span><span class="op" id="4485564">,</span>&nbsp;<span class="op" id="4485566">&amp;</span><span class="ident" id="4485567">c</span><span class="op" id="4485568">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485571">p224Sub</span><span class="op" id="4485578">(</span><span class="ident" id="4485579">z3</span><span class="op" id="4485581">,</span>&nbsp;<span class="ident" id="4485583">z3</span><span class="op" id="4485585">,</span>&nbsp;<span class="op" id="4485587">&amp;</span><span class="ident" id="4485588">gamma</span><span class="op" id="4485593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485596">p224Reduce</span><span class="op" id="4485606">(</span><span class="ident" id="4485607">z3</span><span class="op" id="4485609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485612">p224Sub</span><span class="op" id="4485619">(</span><span class="ident" id="4485620">z3</span><span class="op" id="4485622">,</span>&nbsp;<span class="ident" id="4485624">z3</span><span class="op" id="4485626">,</span>&nbsp;<span class="op" id="4485628">&amp;</span><span class="ident" id="4485629">delta</span><span class="op" id="4485634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485637">p224Reduce</span><span class="op" id="4485647">(</span><span class="ident" id="4485648">z3</span><span class="op" id="4485650">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485654">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485678">for</span>&nbsp;<span class="ident" id="4485682">i</span>&nbsp;<span class="op" id="4485684">:=</span>&nbsp;<span class="num" id="4485687">0</span><span class="op" id="4485688">;</span>&nbsp;<span class="ident" id="4485690">i</span>&nbsp;<span class="op" id="4485692">&lt;</span>&nbsp;<span class="num" id="4485694">8</span><span class="op" id="4485695">;</span>&nbsp;<span class="ident" id="4485697">i</span><span class="op" id="4485698">++</span>&nbsp;<span class="op" id="4485701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485705">delta</span><span class="op" id="4485710">[</span><span class="ident" id="4485711">i</span><span class="op" id="4485712">]</span>&nbsp;<span class="op" id="4485714">=</span>&nbsp;<span class="ident" id="4485716">beta</span><span class="op" id="4485720">[</span><span class="ident" id="4485721">i</span><span class="op" id="4485722">]</span>&nbsp;<span class="op" id="4485724">&lt;&lt;</span>&nbsp;<span class="num" id="4485727">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4485730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485733">p224Reduce</span><span class="op" id="4485743">(</span><span class="op" id="4485744">&amp;</span><span class="ident" id="4485745">delta</span><span class="op" id="4485750">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485753">p224Square</span><span class="op" id="4485763">(</span><span class="ident" id="4485764">x3</span><span class="op" id="4485766">,</span>&nbsp;<span class="op" id="4485768">&amp;</span><span class="ident" id="4485769">alpha</span><span class="op" id="4485774">,</span>&nbsp;<span class="op" id="4485776">&amp;</span><span class="ident" id="4485777">c</span><span class="op" id="4485778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485781">p224Sub</span><span class="op" id="4485788">(</span><span class="ident" id="4485789">x3</span><span class="op" id="4485791">,</span>&nbsp;<span class="ident" id="4485793">x3</span><span class="op" id="4485795">,</span>&nbsp;<span class="op" id="4485797">&amp;</span><span class="ident" id="4485798">delta</span><span class="op" id="4485803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485806">p224Reduce</span><span class="op" id="4485816">(</span><span class="ident" id="4485817">x3</span><span class="op" id="4485819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4485823">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485860">for</span>&nbsp;<span class="ident" id="4485864">i</span>&nbsp;<span class="op" id="4485866">:=</span>&nbsp;<span class="num" id="4485869">0</span><span class="op" id="4485870">;</span>&nbsp;<span class="ident" id="4485872">i</span>&nbsp;<span class="op" id="4485874">&lt;</span>&nbsp;<span class="num" id="4485876">8</span><span class="op" id="4485877">;</span>&nbsp;<span class="ident" id="4485879">i</span><span class="op" id="4485880">++</span>&nbsp;<span class="op" id="4485883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485887">beta</span><span class="op" id="4485891">[</span><span class="ident" id="4485892">i</span><span class="op" id="4485893">]</span>&nbsp;<span class="op" id="4485895">&lt;&lt;=</span>&nbsp;<span class="num" id="4485899">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4485902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485905">p224Sub</span><span class="op" id="4485912">(</span><span class="op" id="4485913">&amp;</span><span class="ident" id="4485914">beta</span><span class="op" id="4485918">,</span>&nbsp;<span class="op" id="4485920">&amp;</span><span class="ident" id="4485921">beta</span><span class="op" id="4485925">,</span>&nbsp;<span class="ident" id="4485927">x3</span><span class="op" id="4485929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485932">p224Reduce</span><span class="op" id="4485942">(</span><span class="op" id="4485943">&amp;</span><span class="ident" id="4485944">beta</span><span class="op" id="4485948">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4485951">p224Square</span><span class="op" id="4485961">(</span><span class="op" id="4485962">&amp;</span><span class="ident" id="4485963">gamma</span><span class="op" id="4485968">,</span>&nbsp;<span class="op" id="4485970">&amp;</span><span class="ident" id="4485971">gamma</span><span class="op" id="4485976">,</span>&nbsp;<span class="op" id="4485978">&amp;</span><span class="ident" id="4485979">c</span><span class="op" id="4485980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4485983">for</span>&nbsp;<span class="ident" id="4485987">i</span>&nbsp;<span class="op" id="4485989">:=</span>&nbsp;<span class="num" id="4485992">0</span><span class="op" id="4485993">;</span>&nbsp;<span class="ident" id="4485995">i</span>&nbsp;<span class="op" id="4485997">&lt;</span>&nbsp;<span class="num" id="4485999">8</span><span class="op" id="4486000">;</span>&nbsp;<span class="ident" id="4486002">i</span><span class="op" id="4486003">++</span>&nbsp;<span class="op" id="4486006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486010">gamma</span><span class="op" id="4486015">[</span><span class="ident" id="4486016">i</span><span class="op" id="4486017">]</span>&nbsp;<span class="op" id="4486019">&lt;&lt;=</span>&nbsp;<span class="num" id="4486023">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486029">p224Reduce</span><span class="op" id="4486039">(</span><span class="op" id="4486040">&amp;</span><span class="ident" id="4486041">gamma</span><span class="op" id="4486046">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486049">p224Mul</span><span class="op" id="4486056">(</span><span class="ident" id="4486057">y3</span><span class="op" id="4486059">,</span>&nbsp;<span class="op" id="4486061">&amp;</span><span class="ident" id="4486062">alpha</span><span class="op" id="4486067">,</span>&nbsp;<span class="op" id="4486069">&amp;</span><span class="ident" id="4486070">beta</span><span class="op" id="4486074">,</span>&nbsp;<span class="op" id="4486076">&amp;</span><span class="ident" id="4486077">c</span><span class="op" id="4486078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486081">p224Sub</span><span class="op" id="4486088">(</span><span class="ident" id="4486089">y3</span><span class="op" id="4486091">,</span>&nbsp;<span class="ident" id="4486093">y3</span><span class="op" id="4486095">,</span>&nbsp;<span class="op" id="4486097">&amp;</span><span class="ident" id="4486098">gamma</span><span class="op" id="4486103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486106">p224Reduce</span><span class="op" id="4486116">(</span><span class="ident" id="4486117">y3</span><span class="op" id="4486119">)</span><br>
<span class="lineno"></span><span class="op" id="4486121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4486124">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4486204">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4486246">func</span>&nbsp;<span class="ident" id="4486251">p224CopyConditional</span><span class="op" id="4486270">(</span><span class="ident" id="4486271">out</span><span class="op" id="4486274">,</span>&nbsp;<span class="ident" id="4486276">in</span>&nbsp;<span class="op" id="4486279">*</span><span class="ident" id="4486280">p224FieldElement</span><span class="op" id="4486296">,</span>&nbsp;<span class="ident" id="4486298">control</span>&nbsp;<span class="builtintype" id="4486306">uint32</span><span class="op" id="4486312">)</span>&nbsp;<span class="op" id="4486314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486317">control</span>&nbsp;<span class="op" id="4486325">&lt;&lt;=</span>&nbsp;<span class="num" id="4486329">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486333">control</span>&nbsp;<span class="op" id="4486341">=</span>&nbsp;<span class="builtintype" id="4486343">uint32</span><span class="op" id="4486349">(</span><span class="builtintype" id="4486350">int32</span><span class="op" id="4486355">(</span><span class="ident" id="4486356">control</span><span class="op" id="4486363">)</span>&nbsp;<span class="op" id="4486365">&gt;&gt;</span>&nbsp;<span class="num" id="4486368">31</span><span class="op" id="4486370">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486374">for</span>&nbsp;<span class="ident" id="4486378">i</span>&nbsp;<span class="op" id="4486380">:=</span>&nbsp;<span class="num" id="4486383">0</span><span class="op" id="4486384">;</span>&nbsp;<span class="ident" id="4486386">i</span>&nbsp;<span class="op" id="4486388">&lt;</span>&nbsp;<span class="num" id="4486390">8</span><span class="op" id="4486391">;</span>&nbsp;<span class="ident" id="4486393">i</span><span class="op" id="4486394">++</span>&nbsp;<span class="op" id="4486397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486401">out</span><span class="op" id="4486404">[</span><span class="ident" id="4486405">i</span><span class="op" id="4486406">]</span>&nbsp;<span class="op" id="4486408">^=</span>&nbsp;<span class="op" id="4486411">(</span><span class="ident" id="4486412">out</span><span class="op" id="4486415">[</span><span class="ident" id="4486416">i</span><span class="op" id="4486417">]</span>&nbsp;<span class="op" id="4486419">^</span>&nbsp;<span class="ident" id="4486421">in</span><span class="op" id="4486423">[</span><span class="ident" id="4486424">i</span><span class="op" id="4486425">]</span><span class="op" id="4486426">)</span>&nbsp;<span class="op" id="4486428">&amp;</span>&nbsp;<span class="ident" id="4486430">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486439">}</span><br>
<span class="lineno"></span><span class="op" id="4486441">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4486444">func</span>&nbsp;<span class="ident" id="4486449">p224ScalarMult</span><span class="op" id="4486463">(</span><span class="ident" id="4486464">outX</span><span class="op" id="4486468">,</span>&nbsp;<span class="ident" id="4486470">outY</span><span class="op" id="4486474">,</span>&nbsp;<span class="ident" id="4486476">outZ</span><span class="op" id="4486480">,</span>&nbsp;<span class="ident" id="4486482">inX</span><span class="op" id="4486485">,</span>&nbsp;<span class="ident" id="4486487">inY</span><span class="op" id="4486490">,</span>&nbsp;<span class="ident" id="4486492">inZ</span>&nbsp;<span class="op" id="4486496">*</span><span class="ident" id="4486497">p224FieldElement</span><span class="op" id="4486513">,</span>&nbsp;<span class="ident" id="4486515">scalar</span>&nbsp;<span class="op" id="4486522">[</span><span class="op" id="4486523">]</span><span class="builtintype" id="4486524">byte</span><span class="op" id="4486528">)</span>&nbsp;<span class="op" id="4486530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486533">var</span>&nbsp;<span class="ident" id="4486537">xx</span><span class="op" id="4486539">,</span>&nbsp;<span class="ident" id="4486541">yy</span><span class="op" id="4486543">,</span>&nbsp;<span class="ident" id="4486545">zz</span>&nbsp;<span class="ident" id="4486548">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486566">for</span>&nbsp;<span class="ident" id="4486570">i</span>&nbsp;<span class="op" id="4486572">:=</span>&nbsp;<span class="num" id="4486575">0</span><span class="op" id="4486576">;</span>&nbsp;<span class="ident" id="4486578">i</span>&nbsp;<span class="op" id="4486580">&lt;</span>&nbsp;<span class="num" id="4486582">8</span><span class="op" id="4486583">;</span>&nbsp;<span class="ident" id="4486585">i</span><span class="op" id="4486586">++</span>&nbsp;<span class="op" id="4486589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486593">outX</span><span class="op" id="4486597">[</span><span class="ident" id="4486598">i</span><span class="op" id="4486599">]</span>&nbsp;<span class="op" id="4486601">=</span>&nbsp;<span class="num" id="4486603">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486607">outY</span><span class="op" id="4486611">[</span><span class="ident" id="4486612">i</span><span class="op" id="4486613">]</span>&nbsp;<span class="op" id="4486615">=</span>&nbsp;<span class="num" id="4486617">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486621">outZ</span><span class="op" id="4486625">[</span><span class="ident" id="4486626">i</span><span class="op" id="4486627">]</span>&nbsp;<span class="op" id="4486629">=</span>&nbsp;<span class="num" id="4486631">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4486634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486638">for</span>&nbsp;<span class="ident" id="4486642">_</span><span class="op" id="4486643">,</span>&nbsp;<span class="builtintype" id="4486645">byte</span>&nbsp;<span class="op" id="4486650">:=</span>&nbsp;<span class="keyword" id="4486653">range</span>&nbsp;<span class="ident" id="4486659">scalar</span>&nbsp;<span class="op" id="4486666">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4486670">for</span>&nbsp;<span class="ident" id="4486674">bitNum</span>&nbsp;<span class="op" id="4486681">:=</span>&nbsp;<span class="builtintype" id="4486684">uint</span><span class="op" id="4486688">(</span><span class="num" id="4486689">0</span><span class="op" id="4486690">)</span><span class="op" id="4486691">;</span>&nbsp;<span class="ident" id="4486693">bitNum</span>&nbsp;<span class="op" id="4486700">&lt;</span>&nbsp;<span class="num" id="4486702">8</span><span class="op" id="4486703">;</span>&nbsp;<span class="ident" id="4486705">bitNum</span><span class="op" id="4486711">++</span>&nbsp;<span class="op" id="4486714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486719">p224DoubleJacobian</span><span class="op" id="4486737">(</span><span class="ident" id="4486738">outX</span><span class="op" id="4486742">,</span>&nbsp;<span class="ident" id="4486744">outY</span><span class="op" id="4486748">,</span>&nbsp;<span class="ident" id="4486750">outZ</span><span class="op" id="4486754">,</span>&nbsp;<span class="ident" id="4486756">outX</span><span class="op" id="4486760">,</span>&nbsp;<span class="ident" id="4486762">outY</span><span class="op" id="4486766">,</span>&nbsp;<span class="ident" id="4486768">outZ</span><span class="op" id="4486772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486777">bit</span>&nbsp;<span class="op" id="4486781">:=</span>&nbsp;<span class="builtintype" id="4486784">uint32</span><span class="op" id="4486790">(</span><span class="op" id="4486791">(</span><span class="builtintype" id="4486792">byte</span>&nbsp;<span class="op" id="4486797">&gt;&gt;</span>&nbsp;<span class="op" id="4486800">(</span><span class="num" id="4486801">7</span>&nbsp;<span class="op" id="4486803">-</span>&nbsp;<span class="ident" id="4486805">bitNum</span><span class="op" id="4486811">)</span><span class="op" id="4486812">)</span>&nbsp;<span class="op" id="4486814">&amp;</span>&nbsp;<span class="num" id="4486816">1</span><span class="op" id="4486817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486822">p224AddJacobian</span><span class="op" id="4486837">(</span><span class="op" id="4486838">&amp;</span><span class="ident" id="4486839">xx</span><span class="op" id="4486841">,</span>&nbsp;<span class="op" id="4486843">&amp;</span><span class="ident" id="4486844">yy</span><span class="op" id="4486846">,</span>&nbsp;<span class="op" id="4486848">&amp;</span><span class="ident" id="4486849">zz</span><span class="op" id="4486851">,</span>&nbsp;<span class="ident" id="4486853">inX</span><span class="op" id="4486856">,</span>&nbsp;<span class="ident" id="4486858">inY</span><span class="op" id="4486861">,</span>&nbsp;<span class="ident" id="4486863">inZ</span><span class="op" id="4486866">,</span>&nbsp;<span class="ident" id="4486868">outX</span><span class="op" id="4486872">,</span>&nbsp;<span class="ident" id="4486874">outY</span><span class="op" id="4486878">,</span>&nbsp;<span class="ident" id="4486880">outZ</span><span class="op" id="4486884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486889">p224CopyConditional</span><span class="op" id="4486908">(</span><span class="ident" id="4486909">outX</span><span class="op" id="4486913">,</span>&nbsp;<span class="op" id="4486915">&amp;</span><span class="ident" id="4486916">xx</span><span class="op" id="4486918">,</span>&nbsp;<span class="ident" id="4486920">bit</span><span class="op" id="4486923">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486928">p224CopyConditional</span><span class="op" id="4486947">(</span><span class="ident" id="4486948">outY</span><span class="op" id="4486952">,</span>&nbsp;<span class="op" id="4486954">&amp;</span><span class="ident" id="4486955">yy</span><span class="op" id="4486957">,</span>&nbsp;<span class="ident" id="4486959">bit</span><span class="op" id="4486962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4486967">p224CopyConditional</span><span class="op" id="4486986">(</span><span class="ident" id="4486987">outZ</span><span class="op" id="4486991">,</span>&nbsp;<span class="op" id="4486993">&amp;</span><span class="ident" id="4486994">zz</span><span class="op" id="4486996">,</span>&nbsp;<span class="ident" id="4486998">bit</span><span class="op" id="4487001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487008">}</span><br>
<span class="lineno"></span><span class="op" id="4487010">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4487013">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4487068">func</span>&nbsp;<span class="ident" id="4487073">p224ToAffine</span><span class="op" id="4487085">(</span><span class="ident" id="4487086">x</span><span class="op" id="4487087">,</span>&nbsp;<span class="ident" id="4487089">y</span><span class="op" id="4487090">,</span>&nbsp;<span class="ident" id="4487092">z</span>&nbsp;<span class="op" id="4487094">*</span><span class="ident" id="4487095">p224FieldElement</span><span class="op" id="4487111">)</span>&nbsp;<span class="op" id="4487113">(</span><span class="op" id="4487114">*</span><span class="ident" id="4487115">big</span><span class="op" id="4487118">.</span><span class="ident" id="4487119">Int</span><span class="op" id="4487122">,</span>&nbsp;<span class="op" id="4487124">*</span><span class="ident" id="4487125">big</span><span class="op" id="4487128">.</span><span class="ident" id="4487129">Int</span><span class="op" id="4487132">)</span>&nbsp;<span class="op" id="4487134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487137">var</span>&nbsp;<span class="ident" id="4487141">zinv</span><span class="op" id="4487145">,</span>&nbsp;<span class="ident" id="4487147">zinvsq</span><span class="op" id="4487153">,</span>&nbsp;<span class="ident" id="4487155">outx</span><span class="op" id="4487159">,</span>&nbsp;<span class="ident" id="4487161">outy</span>&nbsp;<span class="ident" id="4487166">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487184">var</span>&nbsp;<span class="ident" id="4487188">tmp</span>&nbsp;<span class="ident" id="4487192">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487216">if</span>&nbsp;<span class="ident" id="4487219">isPointAtInfinity</span>&nbsp;<span class="op" id="4487237">:=</span>&nbsp;<span class="ident" id="4487240">p224IsZero</span><span class="op" id="4487250">(</span><span class="ident" id="4487251">z</span><span class="op" id="4487252">)</span><span class="op" id="4487253">;</span>&nbsp;<span class="ident" id="4487255">isPointAtInfinity</span>&nbsp;<span class="op" id="4487273">==</span>&nbsp;<span class="num" id="4487276">1</span>&nbsp;<span class="op" id="4487278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487282">return</span>&nbsp;<span class="builtinfunc" id="4487289">new</span><span class="op" id="4487292">(</span><span class="ident" id="4487293">big</span><span class="op" id="4487296">.</span><span class="ident" id="4487297">Int</span><span class="op" id="4487300">)</span><span class="op" id="4487301">,</span>&nbsp;<span class="builtinfunc" id="4487303">new</span><span class="op" id="4487306">(</span><span class="ident" id="4487307">big</span><span class="op" id="4487310">.</span><span class="ident" id="4487311">Int</span><span class="op" id="4487314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4487317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487321">p224Invert</span><span class="op" id="4487331">(</span><span class="op" id="4487332">&amp;</span><span class="ident" id="4487333">zinv</span><span class="op" id="4487337">,</span>&nbsp;<span class="ident" id="4487339">z</span><span class="op" id="4487340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487343">p224Square</span><span class="op" id="4487353">(</span><span class="op" id="4487354">&amp;</span><span class="ident" id="4487355">zinvsq</span><span class="op" id="4487361">,</span>&nbsp;<span class="op" id="4487363">&amp;</span><span class="ident" id="4487364">zinv</span><span class="op" id="4487368">,</span>&nbsp;<span class="op" id="4487370">&amp;</span><span class="ident" id="4487371">tmp</span><span class="op" id="4487374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487377">p224Mul</span><span class="op" id="4487384">(</span><span class="ident" id="4487385">x</span><span class="op" id="4487386">,</span>&nbsp;<span class="ident" id="4487388">x</span><span class="op" id="4487389">,</span>&nbsp;<span class="op" id="4487391">&amp;</span><span class="ident" id="4487392">zinvsq</span><span class="op" id="4487398">,</span>&nbsp;<span class="op" id="4487400">&amp;</span><span class="ident" id="4487401">tmp</span><span class="op" id="4487404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487407">p224Mul</span><span class="op" id="4487414">(</span><span class="op" id="4487415">&amp;</span><span class="ident" id="4487416">zinvsq</span><span class="op" id="4487422">,</span>&nbsp;<span class="op" id="4487424">&amp;</span><span class="ident" id="4487425">zinvsq</span><span class="op" id="4487431">,</span>&nbsp;<span class="op" id="4487433">&amp;</span><span class="ident" id="4487434">zinv</span><span class="op" id="4487438">,</span>&nbsp;<span class="op" id="4487440">&amp;</span><span class="ident" id="4487441">tmp</span><span class="op" id="4487444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487447">p224Mul</span><span class="op" id="4487454">(</span><span class="ident" id="4487455">y</span><span class="op" id="4487456">,</span>&nbsp;<span class="ident" id="4487458">y</span><span class="op" id="4487459">,</span>&nbsp;<span class="op" id="4487461">&amp;</span><span class="ident" id="4487462">zinvsq</span><span class="op" id="4487468">,</span>&nbsp;<span class="op" id="4487470">&amp;</span><span class="ident" id="4487471">tmp</span><span class="op" id="4487474">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487478">p224Contract</span><span class="op" id="4487490">(</span><span class="op" id="4487491">&amp;</span><span class="ident" id="4487492">outx</span><span class="op" id="4487496">,</span>&nbsp;<span class="ident" id="4487498">x</span><span class="op" id="4487499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487502">p224Contract</span><span class="op" id="4487514">(</span><span class="op" id="4487515">&amp;</span><span class="ident" id="4487516">outy</span><span class="op" id="4487520">,</span>&nbsp;<span class="ident" id="4487522">y</span><span class="op" id="4487523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487526">return</span>&nbsp;<span class="ident" id="4487533">p224ToBig</span><span class="op" id="4487542">(</span><span class="op" id="4487543">&amp;</span><span class="ident" id="4487544">outx</span><span class="op" id="4487548">)</span><span class="op" id="4487549">,</span>&nbsp;<span class="ident" id="4487551">p224ToBig</span><span class="op" id="4487560">(</span><span class="op" id="4487561">&amp;</span><span class="ident" id="4487562">outy</span><span class="op" id="4487566">)</span><br>
<span class="lineno"></span><span class="op" id="4487568">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4487571">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4487646">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4487698">func</span>&nbsp;<span class="ident" id="4487703">get28BitsFromEnd</span><span class="op" id="4487719">(</span><span class="ident" id="4487720">buf</span>&nbsp;<span class="op" id="4487724">[</span><span class="op" id="4487725">]</span><span class="builtintype" id="4487726">byte</span><span class="op" id="4487730">,</span>&nbsp;<span class="ident" id="4487732">shift</span>&nbsp;<span class="builtintype" id="4487738">uint</span><span class="op" id="4487742">)</span>&nbsp;<span class="op" id="4487744">(</span><span class="builtintype" id="4487745">uint32</span><span class="op" id="4487751">,</span>&nbsp;<span class="op" id="4487753">[</span><span class="op" id="4487754">]</span><span class="builtintype" id="4487755">byte</span><span class="op" id="4487759">)</span>&nbsp;<span class="op" id="4487761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487764">var</span>&nbsp;<span class="ident" id="4487768">ret</span>&nbsp;<span class="builtintype" id="4487772">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487781">for</span>&nbsp;<span class="ident" id="4487785">i</span>&nbsp;<span class="op" id="4487787">:=</span>&nbsp;<span class="builtintype" id="4487790">uint</span><span class="op" id="4487794">(</span><span class="num" id="4487795">0</span><span class="op" id="4487796">)</span><span class="op" id="4487797">;</span>&nbsp;<span class="ident" id="4487799">i</span>&nbsp;<span class="op" id="4487801">&lt;</span>&nbsp;<span class="num" id="4487803">4</span><span class="op" id="4487804">;</span>&nbsp;<span class="ident" id="4487806">i</span><span class="op" id="4487807">++</span>&nbsp;<span class="op" id="4487810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487814">var</span>&nbsp;<span class="ident" id="4487818">b</span>&nbsp;<span class="builtintype" id="4487820">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487827">if</span>&nbsp;<span class="ident" id="4487830">l</span>&nbsp;<span class="op" id="4487832">:=</span>&nbsp;<span class="builtinfunc" id="4487835">len</span><span class="op" id="4487838">(</span><span class="ident" id="4487839">buf</span><span class="op" id="4487842">)</span><span class="op" id="4487843">;</span>&nbsp;<span class="ident" id="4487845">l</span>&nbsp;<span class="op" id="4487847">&gt;</span>&nbsp;<span class="num" id="4487849">0</span>&nbsp;<span class="op" id="4487851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487856">b</span>&nbsp;<span class="op" id="4487858">=</span>&nbsp;<span class="ident" id="4487860">buf</span><span class="op" id="4487863">[</span><span class="ident" id="4487864">l</span><span class="op" id="4487865">-</span><span class="num" id="4487866">1</span><span class="op" id="4487867">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4487872">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4487942">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4487967">if</span>&nbsp;<span class="ident" id="4487970">i</span>&nbsp;<span class="op" id="4487972">!=</span>&nbsp;<span class="num" id="4487975">3</span>&nbsp;<span class="op" id="4487977">||</span>&nbsp;<span class="ident" id="4487980">shift</span>&nbsp;<span class="op" id="4487986">==</span>&nbsp;<span class="num" id="4487989">4</span>&nbsp;<span class="op" id="4487991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4487997">buf</span>&nbsp;<span class="op" id="4488001">=</span>&nbsp;<span class="ident" id="4488003">buf</span><span class="op" id="4488006">[</span><span class="op" id="4488007">:</span><span class="ident" id="4488008">l</span><span class="op" id="4488009">-</span><span class="num" id="4488010">1</span><span class="op" id="4488011">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488016">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488024">ret</span>&nbsp;<span class="op" id="4488028">|=</span>&nbsp;<span class="builtintype" id="4488031">uint32</span><span class="op" id="4488037">(</span><span class="ident" id="4488038">b</span><span class="op" id="4488039">)</span>&nbsp;<span class="op" id="4488041">&lt;&lt;</span>&nbsp;<span class="op" id="4488044">(</span><span class="num" id="4488045">8</span>&nbsp;<span class="op" id="4488047">*</span>&nbsp;<span class="ident" id="4488049">i</span><span class="op" id="4488050">)</span>&nbsp;<span class="op" id="4488052">&gt;&gt;</span>&nbsp;<span class="ident" id="4488055">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4488062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488065">ret</span>&nbsp;<span class="op" id="4488069">&amp;=</span>&nbsp;<span class="ident" id="4488072">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488086">return</span>&nbsp;<span class="ident" id="4488093">ret</span><span class="op" id="4488096">,</span>&nbsp;<span class="ident" id="4488098">buf</span><br>
<span class="lineno">710</span><span class="op" id="4488102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4488105">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4488137">func</span>&nbsp;<span class="ident" id="4488142">p224FromBig</span><span class="op" id="4488153">(</span><span class="ident" id="4488154">out</span>&nbsp;<span class="op" id="4488158">*</span><span class="ident" id="4488159">p224FieldElement</span><span class="op" id="4488175">,</span>&nbsp;<span class="ident" id="4488177">in</span>&nbsp;<span class="op" id="4488180">*</span><span class="ident" id="4488181">big</span><span class="op" id="4488184">.</span><span class="ident" id="4488185">Int</span><span class="op" id="4488188">)</span>&nbsp;<span class="op" id="4488190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488193">bytes</span>&nbsp;<span class="op" id="4488199">:=</span>&nbsp;<span class="ident" id="4488202">in</span><span class="op" id="4488204">.</span><span class="ident" id="4488205">Bytes</span><span class="op" id="4488210">(</span><span class="op" id="4488211">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488214">out</span><span class="op" id="4488217">[</span><span class="num" id="4488218">0</span><span class="op" id="4488219">]</span><span class="op" id="4488220">,</span>&nbsp;<span class="ident" id="4488222">bytes</span>&nbsp;<span class="op" id="4488228">=</span>&nbsp;<span class="ident" id="4488230">get28BitsFromEnd</span><span class="op" id="4488246">(</span><span class="ident" id="4488247">bytes</span><span class="op" id="4488252">,</span>&nbsp;<span class="num" id="4488254">0</span><span class="op" id="4488255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488258">out</span><span class="op" id="4488261">[</span><span class="num" id="4488262">1</span><span class="op" id="4488263">]</span><span class="op" id="4488264">,</span>&nbsp;<span class="ident" id="4488266">bytes</span>&nbsp;<span class="op" id="4488272">=</span>&nbsp;<span class="ident" id="4488274">get28BitsFromEnd</span><span class="op" id="4488290">(</span><span class="ident" id="4488291">bytes</span><span class="op" id="4488296">,</span>&nbsp;<span class="num" id="4488298">4</span><span class="op" id="4488299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488302">out</span><span class="op" id="4488305">[</span><span class="num" id="4488306">2</span><span class="op" id="4488307">]</span><span class="op" id="4488308">,</span>&nbsp;<span class="ident" id="4488310">bytes</span>&nbsp;<span class="op" id="4488316">=</span>&nbsp;<span class="ident" id="4488318">get28BitsFromEnd</span><span class="op" id="4488334">(</span><span class="ident" id="4488335">bytes</span><span class="op" id="4488340">,</span>&nbsp;<span class="num" id="4488342">0</span><span class="op" id="4488343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488346">out</span><span class="op" id="4488349">[</span><span class="num" id="4488350">3</span><span class="op" id="4488351">]</span><span class="op" id="4488352">,</span>&nbsp;<span class="ident" id="4488354">bytes</span>&nbsp;<span class="op" id="4488360">=</span>&nbsp;<span class="ident" id="4488362">get28BitsFromEnd</span><span class="op" id="4488378">(</span><span class="ident" id="4488379">bytes</span><span class="op" id="4488384">,</span>&nbsp;<span class="num" id="4488386">4</span><span class="op" id="4488387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488390">out</span><span class="op" id="4488393">[</span><span class="num" id="4488394">4</span><span class="op" id="4488395">]</span><span class="op" id="4488396">,</span>&nbsp;<span class="ident" id="4488398">bytes</span>&nbsp;<span class="op" id="4488404">=</span>&nbsp;<span class="ident" id="4488406">get28BitsFromEnd</span><span class="op" id="4488422">(</span><span class="ident" id="4488423">bytes</span><span class="op" id="4488428">,</span>&nbsp;<span class="num" id="4488430">0</span><span class="op" id="4488431">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488434">out</span><span class="op" id="4488437">[</span><span class="num" id="4488438">5</span><span class="op" id="4488439">]</span><span class="op" id="4488440">,</span>&nbsp;<span class="ident" id="4488442">bytes</span>&nbsp;<span class="op" id="4488448">=</span>&nbsp;<span class="ident" id="4488450">get28BitsFromEnd</span><span class="op" id="4488466">(</span><span class="ident" id="4488467">bytes</span><span class="op" id="4488472">,</span>&nbsp;<span class="num" id="4488474">4</span><span class="op" id="4488475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488478">out</span><span class="op" id="4488481">[</span><span class="num" id="4488482">6</span><span class="op" id="4488483">]</span><span class="op" id="4488484">,</span>&nbsp;<span class="ident" id="4488486">bytes</span>&nbsp;<span class="op" id="4488492">=</span>&nbsp;<span class="ident" id="4488494">get28BitsFromEnd</span><span class="op" id="4488510">(</span><span class="ident" id="4488511">bytes</span><span class="op" id="4488516">,</span>&nbsp;<span class="num" id="4488518">0</span><span class="op" id="4488519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488522">out</span><span class="op" id="4488525">[</span><span class="num" id="4488526">7</span><span class="op" id="4488527">]</span><span class="op" id="4488528">,</span>&nbsp;<span class="ident" id="4488530">bytes</span>&nbsp;<span class="op" id="4488536">=</span>&nbsp;<span class="ident" id="4488538">get28BitsFromEnd</span><span class="op" id="4488554">(</span><span class="ident" id="4488555">bytes</span><span class="op" id="4488560">,</span>&nbsp;<span class="num" id="4488562">4</span><span class="op" id="4488563">)</span><br>
<span class="lineno"></span><span class="op" id="4488565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4488568">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4488606">func</span>&nbsp;<span class="ident" id="4488611">p224ToBig</span><span class="op" id="4488620">(</span><span class="ident" id="4488621">in</span>&nbsp;<span class="op" id="4488624">*</span><span class="ident" id="4488625">p224FieldElement</span><span class="op" id="4488641">)</span>&nbsp;<span class="op" id="4488643">*</span><span class="ident" id="4488644">big</span><span class="op" id="4488647">.</span><span class="ident" id="4488648">Int</span>&nbsp;<span class="op" id="4488652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4488655">var</span>&nbsp;<span class="ident" id="4488659">buf</span>&nbsp;<span class="op" id="4488663">[</span><span class="num" id="4488664">28</span><span class="op" id="4488666">]</span><span class="builtintype" id="4488667">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488673">buf</span><span class="op" id="4488676">[</span><span class="num" id="4488677">27</span><span class="op" id="4488679">]</span>&nbsp;<span class="op" id="4488681">=</span>&nbsp;<span class="builtintype" id="4488683">byte</span><span class="op" id="4488687">(</span><span class="ident" id="4488688">in</span><span class="op" id="4488690">[</span><span class="num" id="4488691">0</span><span class="op" id="4488692">]</span><span class="op" id="4488693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488696">buf</span><span class="op" id="4488699">[</span><span class="num" id="4488700">26</span><span class="op" id="4488702">]</span>&nbsp;<span class="op" id="4488704">=</span>&nbsp;<span class="builtintype" id="4488706">byte</span><span class="op" id="4488710">(</span><span class="ident" id="4488711">in</span><span class="op" id="4488713">[</span><span class="num" id="4488714">0</span><span class="op" id="4488715">]</span>&nbsp;<span class="op" id="4488717">&gt;&gt;</span>&nbsp;<span class="num" id="4488720">8</span><span class="op" id="4488721">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488724">buf</span><span class="op" id="4488727">[</span><span class="num" id="4488728">25</span><span class="op" id="4488730">]</span>&nbsp;<span class="op" id="4488732">=</span>&nbsp;<span class="builtintype" id="4488734">byte</span><span class="op" id="4488738">(</span><span class="ident" id="4488739">in</span><span class="op" id="4488741">[</span><span class="num" id="4488742">0</span><span class="op" id="4488743">]</span>&nbsp;<span class="op" id="4488745">&gt;&gt;</span>&nbsp;<span class="num" id="4488748">16</span><span class="op" id="4488750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488753">buf</span><span class="op" id="4488756">[</span><span class="num" id="4488757">24</span><span class="op" id="4488759">]</span>&nbsp;<span class="op" id="4488761">=</span>&nbsp;<span class="builtintype" id="4488763">byte</span><span class="op" id="4488767">(</span><span class="op" id="4488768">(</span><span class="op" id="4488769">(</span><span class="ident" id="4488770">in</span><span class="op" id="4488772">[</span><span class="num" id="4488773">0</span><span class="op" id="4488774">]</span>&nbsp;<span class="op" id="4488776">&gt;&gt;</span>&nbsp;<span class="num" id="4488779">24</span><span class="op" id="4488781">)</span>&nbsp;<span class="op" id="4488783">&amp;</span>&nbsp;<span class="num" id="4488785">0x0f</span><span class="op" id="4488789">)</span>&nbsp;<span class="op" id="4488791">|</span>&nbsp;<span class="op" id="4488793">(</span><span class="ident" id="4488794">in</span><span class="op" id="4488796">[</span><span class="num" id="4488797">1</span><span class="op" id="4488798">]</span><span class="op" id="4488799">&lt;&lt;</span><span class="num" id="4488801">4</span><span class="op" id="4488802">)</span><span class="op" id="4488803">&amp;</span><span class="num" id="4488804">0xf0</span><span class="op" id="4488808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488812">buf</span><span class="op" id="4488815">[</span><span class="num" id="4488816">23</span><span class="op" id="4488818">]</span>&nbsp;<span class="op" id="4488820">=</span>&nbsp;<span class="builtintype" id="4488822">byte</span><span class="op" id="4488826">(</span><span class="ident" id="4488827">in</span><span class="op" id="4488829">[</span><span class="num" id="4488830">1</span><span class="op" id="4488831">]</span>&nbsp;<span class="op" id="4488833">&gt;&gt;</span>&nbsp;<span class="num" id="4488836">4</span><span class="op" id="4488837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488840">buf</span><span class="op" id="4488843">[</span><span class="num" id="4488844">22</span><span class="op" id="4488846">]</span>&nbsp;<span class="op" id="4488848">=</span>&nbsp;<span class="builtintype" id="4488850">byte</span><span class="op" id="4488854">(</span><span class="ident" id="4488855">in</span><span class="op" id="4488857">[</span><span class="num" id="4488858">1</span><span class="op" id="4488859">]</span>&nbsp;<span class="op" id="4488861">&gt;&gt;</span>&nbsp;<span class="num" id="4488864">12</span><span class="op" id="4488866">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488869">buf</span><span class="op" id="4488872">[</span><span class="num" id="4488873">21</span><span class="op" id="4488875">]</span>&nbsp;<span class="op" id="4488877">=</span>&nbsp;<span class="builtintype" id="4488879">byte</span><span class="op" id="4488883">(</span><span class="ident" id="4488884">in</span><span class="op" id="4488886">[</span><span class="num" id="4488887">1</span><span class="op" id="4488888">]</span>&nbsp;<span class="op" id="4488890">&gt;&gt;</span>&nbsp;<span class="num" id="4488893">20</span><span class="op" id="4488895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488899">buf</span><span class="op" id="4488902">[</span><span class="num" id="4488903">20</span><span class="op" id="4488905">]</span>&nbsp;<span class="op" id="4488907">=</span>&nbsp;<span class="builtintype" id="4488909">byte</span><span class="op" id="4488913">(</span><span class="ident" id="4488914">in</span><span class="op" id="4488916">[</span><span class="num" id="4488917">2</span><span class="op" id="4488918">]</span><span class="op" id="4488919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488922">buf</span><span class="op" id="4488925">[</span><span class="num" id="4488926">19</span><span class="op" id="4488928">]</span>&nbsp;<span class="op" id="4488930">=</span>&nbsp;<span class="builtintype" id="4488932">byte</span><span class="op" id="4488936">(</span><span class="ident" id="4488937">in</span><span class="op" id="4488939">[</span><span class="num" id="4488940">2</span><span class="op" id="4488941">]</span>&nbsp;<span class="op" id="4488943">&gt;&gt;</span>&nbsp;<span class="num" id="4488946">8</span><span class="op" id="4488947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488950">buf</span><span class="op" id="4488953">[</span><span class="num" id="4488954">18</span><span class="op" id="4488956">]</span>&nbsp;<span class="op" id="4488958">=</span>&nbsp;<span class="builtintype" id="4488960">byte</span><span class="op" id="4488964">(</span><span class="ident" id="4488965">in</span><span class="op" id="4488967">[</span><span class="num" id="4488968">2</span><span class="op" id="4488969">]</span>&nbsp;<span class="op" id="4488971">&gt;&gt;</span>&nbsp;<span class="num" id="4488974">16</span><span class="op" id="4488976">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4488979">buf</span><span class="op" id="4488982">[</span><span class="num" id="4488983">17</span><span class="op" id="4488985">]</span>&nbsp;<span class="op" id="4488987">=</span>&nbsp;<span class="builtintype" id="4488989">byte</span><span class="op" id="4488993">(</span><span class="op" id="4488994">(</span><span class="op" id="4488995">(</span><span class="ident" id="4488996">in</span><span class="op" id="4488998">[</span><span class="num" id="4488999">2</span><span class="op" id="4489000">]</span>&nbsp;<span class="op" id="4489002">&gt;&gt;</span>&nbsp;<span class="num" id="4489005">24</span><span class="op" id="4489007">)</span>&nbsp;<span class="op" id="4489009">&amp;</span>&nbsp;<span class="num" id="4489011">0x0f</span><span class="op" id="4489015">)</span>&nbsp;<span class="op" id="4489017">|</span>&nbsp;<span class="op" id="4489019">(</span><span class="ident" id="4489020">in</span><span class="op" id="4489022">[</span><span class="num" id="4489023">3</span><span class="op" id="4489024">]</span><span class="op" id="4489025">&lt;&lt;</span><span class="num" id="4489027">4</span><span class="op" id="4489028">)</span><span class="op" id="4489029">&amp;</span><span class="num" id="4489030">0xf0</span><span class="op" id="4489034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489038">buf</span><span class="op" id="4489041">[</span><span class="num" id="4489042">16</span><span class="op" id="4489044">]</span>&nbsp;<span class="op" id="4489046">=</span>&nbsp;<span class="builtintype" id="4489048">byte</span><span class="op" id="4489052">(</span><span class="ident" id="4489053">in</span><span class="op" id="4489055">[</span><span class="num" id="4489056">3</span><span class="op" id="4489057">]</span>&nbsp;<span class="op" id="4489059">&gt;&gt;</span>&nbsp;<span class="num" id="4489062">4</span><span class="op" id="4489063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489066">buf</span><span class="op" id="4489069">[</span><span class="num" id="4489070">15</span><span class="op" id="4489072">]</span>&nbsp;<span class="op" id="4489074">=</span>&nbsp;<span class="builtintype" id="4489076">byte</span><span class="op" id="4489080">(</span><span class="ident" id="4489081">in</span><span class="op" id="4489083">[</span><span class="num" id="4489084">3</span><span class="op" id="4489085">]</span>&nbsp;<span class="op" id="4489087">&gt;&gt;</span>&nbsp;<span class="num" id="4489090">12</span><span class="op" id="4489092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489095">buf</span><span class="op" id="4489098">[</span><span class="num" id="4489099">14</span><span class="op" id="4489101">]</span>&nbsp;<span class="op" id="4489103">=</span>&nbsp;<span class="builtintype" id="4489105">byte</span><span class="op" id="4489109">(</span><span class="ident" id="4489110">in</span><span class="op" id="4489112">[</span><span class="num" id="4489113">3</span><span class="op" id="4489114">]</span>&nbsp;<span class="op" id="4489116">&gt;&gt;</span>&nbsp;<span class="num" id="4489119">20</span><span class="op" id="4489121">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489125">buf</span><span class="op" id="4489128">[</span><span class="num" id="4489129">13</span><span class="op" id="4489131">]</span>&nbsp;<span class="op" id="4489133">=</span>&nbsp;<span class="builtintype" id="4489135">byte</span><span class="op" id="4489139">(</span><span class="ident" id="4489140">in</span><span class="op" id="4489142">[</span><span class="num" id="4489143">4</span><span class="op" id="4489144">]</span><span class="op" id="4489145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489148">buf</span><span class="op" id="4489151">[</span><span class="num" id="4489152">12</span><span class="op" id="4489154">]</span>&nbsp;<span class="op" id="4489156">=</span>&nbsp;<span class="builtintype" id="4489158">byte</span><span class="op" id="4489162">(</span><span class="ident" id="4489163">in</span><span class="op" id="4489165">[</span><span class="num" id="4489166">4</span><span class="op" id="4489167">]</span>&nbsp;<span class="op" id="4489169">&gt;&gt;</span>&nbsp;<span class="num" id="4489172">8</span><span class="op" id="4489173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489176">buf</span><span class="op" id="4489179">[</span><span class="num" id="4489180">11</span><span class="op" id="4489182">]</span>&nbsp;<span class="op" id="4489184">=</span>&nbsp;<span class="builtintype" id="4489186">byte</span><span class="op" id="4489190">(</span><span class="ident" id="4489191">in</span><span class="op" id="4489193">[</span><span class="num" id="4489194">4</span><span class="op" id="4489195">]</span>&nbsp;<span class="op" id="4489197">&gt;&gt;</span>&nbsp;<span class="num" id="4489200">16</span><span class="op" id="4489202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489205">buf</span><span class="op" id="4489208">[</span><span class="num" id="4489209">10</span><span class="op" id="4489211">]</span>&nbsp;<span class="op" id="4489213">=</span>&nbsp;<span class="builtintype" id="4489215">byte</span><span class="op" id="4489219">(</span><span class="op" id="4489220">(</span><span class="op" id="4489221">(</span><span class="ident" id="4489222">in</span><span class="op" id="4489224">[</span><span class="num" id="4489225">4</span><span class="op" id="4489226">]</span>&nbsp;<span class="op" id="4489228">&gt;&gt;</span>&nbsp;<span class="num" id="4489231">24</span><span class="op" id="4489233">)</span>&nbsp;<span class="op" id="4489235">&amp;</span>&nbsp;<span class="num" id="4489237">0x0f</span><span class="op" id="4489241">)</span>&nbsp;<span class="op" id="4489243">|</span>&nbsp;<span class="op" id="4489245">(</span><span class="ident" id="4489246">in</span><span class="op" id="4489248">[</span><span class="num" id="4489249">5</span><span class="op" id="4489250">]</span><span class="op" id="4489251">&lt;&lt;</span><span class="num" id="4489253">4</span><span class="op" id="4489254">)</span><span class="op" id="4489255">&amp;</span><span class="num" id="4489256">0xf0</span><span class="op" id="4489260">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489264">buf</span><span class="op" id="4489267">[</span><span class="num" id="4489268">9</span><span class="op" id="4489269">]</span>&nbsp;<span class="op" id="4489271">=</span>&nbsp;<span class="builtintype" id="4489273">byte</span><span class="op" id="4489277">(</span><span class="ident" id="4489278">in</span><span class="op" id="4489280">[</span><span class="num" id="4489281">5</span><span class="op" id="4489282">]</span>&nbsp;<span class="op" id="4489284">&gt;&gt;</span>&nbsp;<span class="num" id="4489287">4</span><span class="op" id="4489288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489291">buf</span><span class="op" id="4489294">[</span><span class="num" id="4489295">8</span><span class="op" id="4489296">]</span>&nbsp;<span class="op" id="4489298">=</span>&nbsp;<span class="builtintype" id="4489300">byte</span><span class="op" id="4489304">(</span><span class="ident" id="4489305">in</span><span class="op" id="4489307">[</span><span class="num" id="4489308">5</span><span class="op" id="4489309">]</span>&nbsp;<span class="op" id="4489311">&gt;&gt;</span>&nbsp;<span class="num" id="4489314">12</span><span class="op" id="4489316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489319">buf</span><span class="op" id="4489322">[</span><span class="num" id="4489323">7</span><span class="op" id="4489324">]</span>&nbsp;<span class="op" id="4489326">=</span>&nbsp;<span class="builtintype" id="4489328">byte</span><span class="op" id="4489332">(</span><span class="ident" id="4489333">in</span><span class="op" id="4489335">[</span><span class="num" id="4489336">5</span><span class="op" id="4489337">]</span>&nbsp;<span class="op" id="4489339">&gt;&gt;</span>&nbsp;<span class="num" id="4489342">20</span><span class="op" id="4489344">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489348">buf</span><span class="op" id="4489351">[</span><span class="num" id="4489352">6</span><span class="op" id="4489353">]</span>&nbsp;<span class="op" id="4489355">=</span>&nbsp;<span class="builtintype" id="4489357">byte</span><span class="op" id="4489361">(</span><span class="ident" id="4489362">in</span><span class="op" id="4489364">[</span><span class="num" id="4489365">6</span><span class="op" id="4489366">]</span><span class="op" id="4489367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489370">buf</span><span class="op" id="4489373">[</span><span class="num" id="4489374">5</span><span class="op" id="4489375">]</span>&nbsp;<span class="op" id="4489377">=</span>&nbsp;<span class="builtintype" id="4489379">byte</span><span class="op" id="4489383">(</span><span class="ident" id="4489384">in</span><span class="op" id="4489386">[</span><span class="num" id="4489387">6</span><span class="op" id="4489388">]</span>&nbsp;<span class="op" id="4489390">&gt;&gt;</span>&nbsp;<span class="num" id="4489393">8</span><span class="op" id="4489394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489397">buf</span><span class="op" id="4489400">[</span><span class="num" id="4489401">4</span><span class="op" id="4489402">]</span>&nbsp;<span class="op" id="4489404">=</span>&nbsp;<span class="builtintype" id="4489406">byte</span><span class="op" id="4489410">(</span><span class="ident" id="4489411">in</span><span class="op" id="4489413">[</span><span class="num" id="4489414">6</span><span class="op" id="4489415">]</span>&nbsp;<span class="op" id="4489417">&gt;&gt;</span>&nbsp;<span class="num" id="4489420">16</span><span class="op" id="4489422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489425">buf</span><span class="op" id="4489428">[</span><span class="num" id="4489429">3</span><span class="op" id="4489430">]</span>&nbsp;<span class="op" id="4489432">=</span>&nbsp;<span class="builtintype" id="4489434">byte</span><span class="op" id="4489438">(</span><span class="op" id="4489439">(</span><span class="op" id="4489440">(</span><span class="ident" id="4489441">in</span><span class="op" id="4489443">[</span><span class="num" id="4489444">6</span><span class="op" id="4489445">]</span>&nbsp;<span class="op" id="4489447">&gt;&gt;</span>&nbsp;<span class="num" id="4489450">24</span><span class="op" id="4489452">)</span>&nbsp;<span class="op" id="4489454">&amp;</span>&nbsp;<span class="num" id="4489456">0x0f</span><span class="op" id="4489460">)</span>&nbsp;<span class="op" id="4489462">|</span>&nbsp;<span class="op" id="4489464">(</span><span class="ident" id="4489465">in</span><span class="op" id="4489467">[</span><span class="num" id="4489468">7</span><span class="op" id="4489469">]</span><span class="op" id="4489470">&lt;&lt;</span><span class="num" id="4489472">4</span><span class="op" id="4489473">)</span><span class="op" id="4489474">&amp;</span><span class="num" id="4489475">0xf0</span><span class="op" id="4489479">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489483">buf</span><span class="op" id="4489486">[</span><span class="num" id="4489487">2</span><span class="op" id="4489488">]</span>&nbsp;<span class="op" id="4489490">=</span>&nbsp;<span class="builtintype" id="4489492">byte</span><span class="op" id="4489496">(</span><span class="ident" id="4489497">in</span><span class="op" id="4489499">[</span><span class="num" id="4489500">7</span><span class="op" id="4489501">]</span>&nbsp;<span class="op" id="4489503">&gt;&gt;</span>&nbsp;<span class="num" id="4489506">4</span><span class="op" id="4489507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489510">buf</span><span class="op" id="4489513">[</span><span class="num" id="4489514">1</span><span class="op" id="4489515">]</span>&nbsp;<span class="op" id="4489517">=</span>&nbsp;<span class="builtintype" id="4489519">byte</span><span class="op" id="4489523">(</span><span class="ident" id="4489524">in</span><span class="op" id="4489526">[</span><span class="num" id="4489527">7</span><span class="op" id="4489528">]</span>&nbsp;<span class="op" id="4489530">&gt;&gt;</span>&nbsp;<span class="num" id="4489533">12</span><span class="op" id="4489535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4489538">buf</span><span class="op" id="4489541">[</span><span class="num" id="4489542">0</span><span class="op" id="4489543">]</span>&nbsp;<span class="op" id="4489545">=</span>&nbsp;<span class="builtintype" id="4489547">byte</span><span class="op" id="4489551">(</span><span class="ident" id="4489552">in</span><span class="op" id="4489554">[</span><span class="num" id="4489555">7</span><span class="op" id="4489556">]</span>&nbsp;<span class="op" id="4489558">&gt;&gt;</span>&nbsp;<span class="num" id="4489561">20</span><span class="op" id="4489563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4489567">return</span>&nbsp;<span class="builtinfunc" id="4489574">new</span><span class="op" id="4489577">(</span><span class="ident" id="4489578">big</span><span class="op" id="4489581">.</span><span class="ident" id="4489582">Int</span><span class="op" id="4489585">)</span><span class="op" id="4489586">.</span><span class="ident" id="4489587">SetBytes</span><span class="op" id="4489595">(</span><span class="ident" id="4489596">buf</span><span class="op" id="4489599">[</span><span class="op" id="4489600">:</span><span class="op" id="4489601">]</span><span class="op" id="4489602">)</span><br>
<span class="lineno">765</span><span class="op" id="4489604">}</span>
</div>
</body>
</html>
