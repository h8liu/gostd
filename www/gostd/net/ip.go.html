<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html" class="current">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3272695">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3272750">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3272804">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3272855">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3272883">//</span><br>
<span class="lineno"></span><span class="comment" id="3272886">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3272946">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3273004">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3273054">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3273115">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273146">package</span>&nbsp;<span class="ident" id="3273154">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3273159">import</span>&nbsp;<span class="string" id="3273166">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273176">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3273207">const</span>&nbsp;<span class="op" id="3273213">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273216">IPv4len</span>&nbsp;<span class="op" id="3273224">=</span>&nbsp;<span class="num" id="3273226">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273229">IPv6len</span>&nbsp;<span class="op" id="3273237">=</span>&nbsp;<span class="num" id="3273239">16</span><br>
<span class="lineno"></span><span class="op" id="3273242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273245">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3273296">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3273353">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3273391">//</span><br>
<span class="lineno"></span><span class="comment" id="3273394">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3273446">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3273498">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3273553">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3273608">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3273631">type</span>&nbsp;<span class="ident" id="3273636">IP</span>&nbsp;<span class="op" id="3273639">[</span><span class="op" id="3273640">]</span><span class="builtintype" id="3273641">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273647">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3273679">type</span>&nbsp;<span class="ident" id="3273684">IPMask</span>&nbsp;<span class="op" id="3273691">[</span><span class="op" id="3273692">]</span><span class="builtintype" id="3273693">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273699">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3273737">type</span>&nbsp;<span class="ident" id="3273742">IPNet</span>&nbsp;<span class="keyword" id="3273748">struct</span>&nbsp;<span class="op" id="3273755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273758">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3273763">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3273770">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273789">Mask</span>&nbsp;<span class="ident" id="3273794">IPMask</span>&nbsp;<span class="comment" id="3273801">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3273817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273820">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3273876">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3273901">func</span>&nbsp;<span class="ident" id="3273906">IPv4</span><span class="op" id="3273910">(</span><span class="ident" id="3273911">a</span><span class="op" id="3273912">,</span>&nbsp;<span class="ident" id="3273914">b</span><span class="op" id="3273915">,</span>&nbsp;<span class="ident" id="3273917">c</span><span class="op" id="3273918">,</span>&nbsp;<span class="ident" id="3273920">d</span>&nbsp;<span class="builtintype" id="3273922">byte</span><span class="op" id="3273926">)</span>&nbsp;<span class="ident" id="3273928">IP</span>&nbsp;<span class="op" id="3273931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273934">p</span>&nbsp;<span class="op" id="3273936">:=</span>&nbsp;<span class="builtinfunc" id="3273939">make</span><span class="op" id="3273943">(</span><span class="ident" id="3273944">IP</span><span class="op" id="3273946">,</span>&nbsp;<span class="ident" id="3273948">IPv6len</span><span class="op" id="3273955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3273958">copy</span><span class="op" id="3273962">(</span><span class="ident" id="3273963">p</span><span class="op" id="3273964">,</span>&nbsp;<span class="ident" id="3273966">v4InV6Prefix</span><span class="op" id="3273978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273981">p</span><span class="op" id="3273982">[</span><span class="num" id="3273983">12</span><span class="op" id="3273985">]</span>&nbsp;<span class="op" id="3273987">=</span>&nbsp;<span class="ident" id="3273989">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3273992">p</span><span class="op" id="3273993">[</span><span class="num" id="3273994">13</span><span class="op" id="3273996">]</span>&nbsp;<span class="op" id="3273998">=</span>&nbsp;<span class="ident" id="3274000">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274003">p</span><span class="op" id="3274004">[</span><span class="num" id="3274005">14</span><span class="op" id="3274007">]</span>&nbsp;<span class="op" id="3274009">=</span>&nbsp;<span class="ident" id="3274011">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274014">p</span><span class="op" id="3274015">[</span><span class="num" id="3274016">15</span><span class="op" id="3274018">]</span>&nbsp;<span class="op" id="3274020">=</span>&nbsp;<span class="ident" id="3274022">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274025">return</span>&nbsp;<span class="ident" id="3274032">p</span><br>
<span class="lineno"></span><span class="op" id="3274034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3274037">var</span>&nbsp;<span class="ident" id="3274041">v4InV6Prefix</span>&nbsp;<span class="op" id="3274054">=</span>&nbsp;<span class="op" id="3274056">[</span><span class="op" id="3274057">]</span><span class="builtintype" id="3274058">byte</span><span class="op" id="3274062">{</span><span class="num" id="3274063">0</span><span class="op" id="3274064">,</span>&nbsp;<span class="num" id="3274066">0</span><span class="op" id="3274067">,</span>&nbsp;<span class="num" id="3274069">0</span><span class="op" id="3274070">,</span>&nbsp;<span class="num" id="3274072">0</span><span class="op" id="3274073">,</span>&nbsp;<span class="num" id="3274075">0</span><span class="op" id="3274076">,</span>&nbsp;<span class="num" id="3274078">0</span><span class="op" id="3274079">,</span>&nbsp;<span class="num" id="3274081">0</span><span class="op" id="3274082">,</span>&nbsp;<span class="num" id="3274084">0</span><span class="op" id="3274085">,</span>&nbsp;<span class="num" id="3274087">0</span><span class="op" id="3274088">,</span>&nbsp;<span class="num" id="3274090">0</span><span class="op" id="3274091">,</span>&nbsp;<span class="num" id="3274093">0xff</span><span class="op" id="3274097">,</span>&nbsp;<span class="num" id="3274099">0xff</span><span class="op" id="3274103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3274106">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3274162">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3274184">func</span>&nbsp;<span class="ident" id="3274189">IPv4Mask</span><span class="op" id="3274197">(</span><span class="ident" id="3274198">a</span><span class="op" id="3274199">,</span>&nbsp;<span class="ident" id="3274201">b</span><span class="op" id="3274202">,</span>&nbsp;<span class="ident" id="3274204">c</span><span class="op" id="3274205">,</span>&nbsp;<span class="ident" id="3274207">d</span>&nbsp;<span class="builtintype" id="3274209">byte</span><span class="op" id="3274213">)</span>&nbsp;<span class="ident" id="3274215">IPMask</span>&nbsp;<span class="op" id="3274222">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274225">p</span>&nbsp;<span class="op" id="3274227">:=</span>&nbsp;<span class="builtinfunc" id="3274230">make</span><span class="op" id="3274234">(</span><span class="ident" id="3274235">IPMask</span><span class="op" id="3274241">,</span>&nbsp;<span class="ident" id="3274243">IPv4len</span><span class="op" id="3274250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274253">p</span><span class="op" id="3274254">[</span><span class="num" id="3274255">0</span><span class="op" id="3274256">]</span>&nbsp;<span class="op" id="3274258">=</span>&nbsp;<span class="ident" id="3274260">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274263">p</span><span class="op" id="3274264">[</span><span class="num" id="3274265">1</span><span class="op" id="3274266">]</span>&nbsp;<span class="op" id="3274268">=</span>&nbsp;<span class="ident" id="3274270">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274273">p</span><span class="op" id="3274274">[</span><span class="num" id="3274275">2</span><span class="op" id="3274276">]</span>&nbsp;<span class="op" id="3274278">=</span>&nbsp;<span class="ident" id="3274280">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274283">p</span><span class="op" id="3274284">[</span><span class="num" id="3274285">3</span><span class="op" id="3274286">]</span>&nbsp;<span class="op" id="3274288">=</span>&nbsp;<span class="ident" id="3274290">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274293">return</span>&nbsp;<span class="ident" id="3274300">p</span><br>
<span class="lineno"></span><span class="op" id="3274302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3274305">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3274363">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3274418">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3274486">func</span>&nbsp;<span class="ident" id="3274491">CIDRMask</span><span class="op" id="3274499">(</span><span class="ident" id="3274500">ones</span><span class="op" id="3274504">,</span>&nbsp;<span class="ident" id="3274506">bits</span>&nbsp;<span class="builtintype" id="3274511">int</span><span class="op" id="3274514">)</span>&nbsp;<span class="ident" id="3274516">IPMask</span>&nbsp;<span class="op" id="3274523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274526">if</span>&nbsp;<span class="ident" id="3274529">bits</span>&nbsp;<span class="op" id="3274534">!=</span>&nbsp;<span class="num" id="3274537">8</span><span class="op" id="3274538">*</span><span class="ident" id="3274539">IPv4len</span>&nbsp;<span class="op" id="3274547">&amp;&amp;</span>&nbsp;<span class="ident" id="3274550">bits</span>&nbsp;<span class="op" id="3274555">!=</span>&nbsp;<span class="num" id="3274558">8</span><span class="op" id="3274559">*</span><span class="ident" id="3274560">IPv6len</span>&nbsp;<span class="op" id="3274568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274572">return</span>&nbsp;<span class="builtintype" id="3274579">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274584">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274587">if</span>&nbsp;<span class="ident" id="3274590">ones</span>&nbsp;<span class="op" id="3274595">&lt;</span>&nbsp;<span class="num" id="3274597">0</span>&nbsp;<span class="op" id="3274599">||</span>&nbsp;<span class="ident" id="3274602">ones</span>&nbsp;<span class="op" id="3274607">&gt;</span>&nbsp;<span class="ident" id="3274609">bits</span>&nbsp;<span class="op" id="3274614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274618">return</span>&nbsp;<span class="builtintype" id="3274625">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274633">l</span>&nbsp;<span class="op" id="3274635">:=</span>&nbsp;<span class="ident" id="3274638">bits</span>&nbsp;<span class="op" id="3274643">/</span>&nbsp;<span class="num" id="3274645">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274648">m</span>&nbsp;<span class="op" id="3274650">:=</span>&nbsp;<span class="builtinfunc" id="3274653">make</span><span class="op" id="3274657">(</span><span class="ident" id="3274658">IPMask</span><span class="op" id="3274664">,</span>&nbsp;<span class="ident" id="3274666">l</span><span class="op" id="3274667">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274670">n</span>&nbsp;<span class="op" id="3274672">:=</span>&nbsp;<span class="builtintype" id="3274675">uint</span><span class="op" id="3274679">(</span><span class="ident" id="3274680">ones</span><span class="op" id="3274684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274687">for</span>&nbsp;<span class="ident" id="3274691">i</span>&nbsp;<span class="op" id="3274693">:=</span>&nbsp;<span class="num" id="3274696">0</span><span class="op" id="3274697">;</span>&nbsp;<span class="ident" id="3274699">i</span>&nbsp;<span class="op" id="3274701">&lt;</span>&nbsp;<span class="ident" id="3274703">l</span><span class="op" id="3274704">;</span>&nbsp;<span class="ident" id="3274706">i</span><span class="op" id="3274707">++</span>&nbsp;<span class="op" id="3274710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274714">if</span>&nbsp;<span class="ident" id="3274717">n</span>&nbsp;<span class="op" id="3274719">&gt;=</span>&nbsp;<span class="num" id="3274722">8</span>&nbsp;<span class="op" id="3274724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274729">m</span><span class="op" id="3274730">[</span><span class="ident" id="3274731">i</span><span class="op" id="3274732">]</span>&nbsp;<span class="op" id="3274734">=</span>&nbsp;<span class="num" id="3274736">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274744">n</span>&nbsp;<span class="op" id="3274746">-=</span>&nbsp;<span class="num" id="3274749">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274754">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274769">m</span><span class="op" id="3274770">[</span><span class="ident" id="3274771">i</span><span class="op" id="3274772">]</span>&nbsp;<span class="op" id="3274774">=</span>&nbsp;<span class="op" id="3274776">^</span><span class="builtintype" id="3274777">byte</span><span class="op" id="3274781">(</span><span class="num" id="3274782">0xff</span>&nbsp;<span class="op" id="3274787">&gt;&gt;</span>&nbsp;<span class="ident" id="3274790">n</span><span class="op" id="3274791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274795">n</span>&nbsp;<span class="op" id="3274797">=</span>&nbsp;<span class="num" id="3274799">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274802">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3274805">return</span>&nbsp;<span class="ident" id="3274812">m</span><br>
<span class="lineno"></span><span class="op" id="3274814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3274817">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3274846">var</span>&nbsp;<span class="op" id="3274850">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274853">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274867">=</span>&nbsp;<span class="ident" id="3274869">IPv4</span><span class="op" id="3274873">(</span><span class="num" id="3274874">255</span><span class="op" id="3274877">,</span>&nbsp;<span class="num" id="3274879">255</span><span class="op" id="3274882">,</span>&nbsp;<span class="num" id="3274884">255</span><span class="op" id="3274887">,</span>&nbsp;<span class="num" id="3274889">255</span><span class="op" id="3274892">)</span>&nbsp;<span class="comment" id="3274894">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274908">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274922">=</span>&nbsp;<span class="ident" id="3274924">IPv4</span><span class="op" id="3274928">(</span><span class="num" id="3274929">224</span><span class="op" id="3274932">,</span>&nbsp;<span class="num" id="3274934">0</span><span class="op" id="3274935">,</span>&nbsp;<span class="num" id="3274937">0</span><span class="op" id="3274938">,</span>&nbsp;<span class="num" id="3274940">1</span><span class="op" id="3274941">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3274949">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3274965">IPv4allrouter</span>&nbsp;<span class="op" id="3274979">=</span>&nbsp;<span class="ident" id="3274981">IPv4</span><span class="op" id="3274985">(</span><span class="num" id="3274986">224</span><span class="op" id="3274989">,</span>&nbsp;<span class="num" id="3274991">0</span><span class="op" id="3274992">,</span>&nbsp;<span class="num" id="3274994">0</span><span class="op" id="3274995">,</span>&nbsp;<span class="num" id="3274997">2</span><span class="op" id="3274998">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3275006">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275022">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275036">=</span>&nbsp;<span class="ident" id="3275038">IPv4</span><span class="op" id="3275042">(</span><span class="num" id="3275043">0</span><span class="op" id="3275044">,</span>&nbsp;<span class="num" id="3275046">0</span><span class="op" id="3275047">,</span>&nbsp;<span class="num" id="3275049">0</span><span class="op" id="3275050">,</span>&nbsp;<span class="num" id="3275052">0</span><span class="op" id="3275053">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3275063">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3275076">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3275079">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3275108">var</span>&nbsp;<span class="op" id="3275112">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275115">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275142">=</span>&nbsp;<span class="ident" id="3275144">IP</span><span class="op" id="3275146">{</span><span class="num" id="3275147">0</span><span class="op" id="3275148">,</span>&nbsp;<span class="num" id="3275150">0</span><span class="op" id="3275151">,</span>&nbsp;<span class="num" id="3275153">0</span><span class="op" id="3275154">,</span>&nbsp;<span class="num" id="3275156">0</span><span class="op" id="3275157">,</span>&nbsp;<span class="num" id="3275159">0</span><span class="op" id="3275160">,</span>&nbsp;<span class="num" id="3275162">0</span><span class="op" id="3275163">,</span>&nbsp;<span class="num" id="3275165">0</span><span class="op" id="3275166">,</span>&nbsp;<span class="num" id="3275168">0</span><span class="op" id="3275169">,</span>&nbsp;<span class="num" id="3275171">0</span><span class="op" id="3275172">,</span>&nbsp;<span class="num" id="3275174">0</span><span class="op" id="3275175">,</span>&nbsp;<span class="num" id="3275177">0</span><span class="op" id="3275178">,</span>&nbsp;<span class="num" id="3275180">0</span><span class="op" id="3275181">,</span>&nbsp;<span class="num" id="3275183">0</span><span class="op" id="3275184">,</span>&nbsp;<span class="num" id="3275186">0</span><span class="op" id="3275187">,</span>&nbsp;<span class="num" id="3275189">0</span><span class="op" id="3275190">,</span>&nbsp;<span class="num" id="3275192">0</span><span class="op" id="3275193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275196">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275223">=</span>&nbsp;<span class="ident" id="3275225">IP</span><span class="op" id="3275227">{</span><span class="num" id="3275228">0</span><span class="op" id="3275229">,</span>&nbsp;<span class="num" id="3275231">0</span><span class="op" id="3275232">,</span>&nbsp;<span class="num" id="3275234">0</span><span class="op" id="3275235">,</span>&nbsp;<span class="num" id="3275237">0</span><span class="op" id="3275238">,</span>&nbsp;<span class="num" id="3275240">0</span><span class="op" id="3275241">,</span>&nbsp;<span class="num" id="3275243">0</span><span class="op" id="3275244">,</span>&nbsp;<span class="num" id="3275246">0</span><span class="op" id="3275247">,</span>&nbsp;<span class="num" id="3275249">0</span><span class="op" id="3275250">,</span>&nbsp;<span class="num" id="3275252">0</span><span class="op" id="3275253">,</span>&nbsp;<span class="num" id="3275255">0</span><span class="op" id="3275256">,</span>&nbsp;<span class="num" id="3275258">0</span><span class="op" id="3275259">,</span>&nbsp;<span class="num" id="3275261">0</span><span class="op" id="3275262">,</span>&nbsp;<span class="num" id="3275264">0</span><span class="op" id="3275265">,</span>&nbsp;<span class="num" id="3275267">0</span><span class="op" id="3275268">,</span>&nbsp;<span class="num" id="3275270">0</span><span class="op" id="3275271">,</span>&nbsp;<span class="num" id="3275273">0</span><span class="op" id="3275274">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275277">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275304">=</span>&nbsp;<span class="ident" id="3275306">IP</span><span class="op" id="3275308">{</span><span class="num" id="3275309">0</span><span class="op" id="3275310">,</span>&nbsp;<span class="num" id="3275312">0</span><span class="op" id="3275313">,</span>&nbsp;<span class="num" id="3275315">0</span><span class="op" id="3275316">,</span>&nbsp;<span class="num" id="3275318">0</span><span class="op" id="3275319">,</span>&nbsp;<span class="num" id="3275321">0</span><span class="op" id="3275322">,</span>&nbsp;<span class="num" id="3275324">0</span><span class="op" id="3275325">,</span>&nbsp;<span class="num" id="3275327">0</span><span class="op" id="3275328">,</span>&nbsp;<span class="num" id="3275330">0</span><span class="op" id="3275331">,</span>&nbsp;<span class="num" id="3275333">0</span><span class="op" id="3275334">,</span>&nbsp;<span class="num" id="3275336">0</span><span class="op" id="3275337">,</span>&nbsp;<span class="num" id="3275339">0</span><span class="op" id="3275340">,</span>&nbsp;<span class="num" id="3275342">0</span><span class="op" id="3275343">,</span>&nbsp;<span class="num" id="3275345">0</span><span class="op" id="3275346">,</span>&nbsp;<span class="num" id="3275348">0</span><span class="op" id="3275349">,</span>&nbsp;<span class="num" id="3275351">0</span><span class="op" id="3275352">,</span>&nbsp;<span class="num" id="3275354">1</span><span class="op" id="3275355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275358">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3275385">=</span>&nbsp;<span class="ident" id="3275387">IP</span><span class="op" id="3275389">{</span><span class="num" id="3275390">0xff</span><span class="op" id="3275394">,</span>&nbsp;<span class="num" id="3275396">0x01</span><span class="op" id="3275400">,</span>&nbsp;<span class="num" id="3275402">0</span><span class="op" id="3275403">,</span>&nbsp;<span class="num" id="3275405">0</span><span class="op" id="3275406">,</span>&nbsp;<span class="num" id="3275408">0</span><span class="op" id="3275409">,</span>&nbsp;<span class="num" id="3275411">0</span><span class="op" id="3275412">,</span>&nbsp;<span class="num" id="3275414">0</span><span class="op" id="3275415">,</span>&nbsp;<span class="num" id="3275417">0</span><span class="op" id="3275418">,</span>&nbsp;<span class="num" id="3275420">0</span><span class="op" id="3275421">,</span>&nbsp;<span class="num" id="3275423">0</span><span class="op" id="3275424">,</span>&nbsp;<span class="num" id="3275426">0</span><span class="op" id="3275427">,</span>&nbsp;<span class="num" id="3275429">0</span><span class="op" id="3275430">,</span>&nbsp;<span class="num" id="3275432">0</span><span class="op" id="3275433">,</span>&nbsp;<span class="num" id="3275435">0</span><span class="op" id="3275436">,</span>&nbsp;<span class="num" id="3275438">0</span><span class="op" id="3275439">,</span>&nbsp;<span class="num" id="3275441">0x01</span><span class="op" id="3275445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275448">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275475">=</span>&nbsp;<span class="ident" id="3275477">IP</span><span class="op" id="3275479">{</span><span class="num" id="3275480">0xff</span><span class="op" id="3275484">,</span>&nbsp;<span class="num" id="3275486">0x02</span><span class="op" id="3275490">,</span>&nbsp;<span class="num" id="3275492">0</span><span class="op" id="3275493">,</span>&nbsp;<span class="num" id="3275495">0</span><span class="op" id="3275496">,</span>&nbsp;<span class="num" id="3275498">0</span><span class="op" id="3275499">,</span>&nbsp;<span class="num" id="3275501">0</span><span class="op" id="3275502">,</span>&nbsp;<span class="num" id="3275504">0</span><span class="op" id="3275505">,</span>&nbsp;<span class="num" id="3275507">0</span><span class="op" id="3275508">,</span>&nbsp;<span class="num" id="3275510">0</span><span class="op" id="3275511">,</span>&nbsp;<span class="num" id="3275513">0</span><span class="op" id="3275514">,</span>&nbsp;<span class="num" id="3275516">0</span><span class="op" id="3275517">,</span>&nbsp;<span class="num" id="3275519">0</span><span class="op" id="3275520">,</span>&nbsp;<span class="num" id="3275522">0</span><span class="op" id="3275523">,</span>&nbsp;<span class="num" id="3275525">0</span><span class="op" id="3275526">,</span>&nbsp;<span class="num" id="3275528">0</span><span class="op" id="3275529">,</span>&nbsp;<span class="num" id="3275531">0x01</span><span class="op" id="3275535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3275538">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275565">=</span>&nbsp;<span class="ident" id="3275567">IP</span><span class="op" id="3275569">{</span><span class="num" id="3275570">0xff</span><span class="op" id="3275574">,</span>&nbsp;<span class="num" id="3275576">0x02</span><span class="op" id="3275580">,</span>&nbsp;<span class="num" id="3275582">0</span><span class="op" id="3275583">,</span>&nbsp;<span class="num" id="3275585">0</span><span class="op" id="3275586">,</span>&nbsp;<span class="num" id="3275588">0</span><span class="op" id="3275589">,</span>&nbsp;<span class="num" id="3275591">0</span><span class="op" id="3275592">,</span>&nbsp;<span class="num" id="3275594">0</span><span class="op" id="3275595">,</span>&nbsp;<span class="num" id="3275597">0</span><span class="op" id="3275598">,</span>&nbsp;<span class="num" id="3275600">0</span><span class="op" id="3275601">,</span>&nbsp;<span class="num" id="3275603">0</span><span class="op" id="3275604">,</span>&nbsp;<span class="num" id="3275606">0</span><span class="op" id="3275607">,</span>&nbsp;<span class="num" id="3275609">0</span><span class="op" id="3275610">,</span>&nbsp;<span class="num" id="3275612">0</span><span class="op" id="3275613">,</span>&nbsp;<span class="num" id="3275615">0</span><span class="op" id="3275616">,</span>&nbsp;<span class="num" id="3275618">0</span><span class="op" id="3275619">,</span>&nbsp;<span class="num" id="3275621">0x02</span><span class="op" id="3275625">}</span><br>
<span class="lineno"></span><span class="op" id="3275627">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3275630">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3275693">func</span>&nbsp;<span class="op" id="3275698">(</span><span class="ident" id="3275699">ip</span>&nbsp;<span class="ident" id="3275702">IP</span><span class="op" id="3275704">)</span>&nbsp;<span class="ident" id="3275706">IsUnspecified</span><span class="op" id="3275719">(</span><span class="op" id="3275720">)</span>&nbsp;<span class="builtintype" id="3275722">bool</span>&nbsp;<span class="op" id="3275727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275730">if</span>&nbsp;<span class="ident" id="3275733">ip</span><span class="op" id="3275735">.</span><span class="ident" id="3275736">Equal</span><span class="op" id="3275741">(</span><span class="ident" id="3275742">IPv4zero</span><span class="op" id="3275750">)</span>&nbsp;<span class="op" id="3275752">||</span>&nbsp;<span class="ident" id="3275755">ip</span><span class="op" id="3275757">.</span><span class="ident" id="3275758">Equal</span><span class="op" id="3275763">(</span><span class="ident" id="3275764">IPv6unspecified</span><span class="op" id="3275779">)</span>&nbsp;<span class="op" id="3275781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275785">return</span>&nbsp;<span class="builtintype" id="3275792">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275801">return</span>&nbsp;<span class="builtintype" id="3275808">false</span><br>
<span class="lineno"></span><span class="op" id="3275814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275817">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3275873">func</span>&nbsp;<span class="op" id="3275878">(</span><span class="ident" id="3275879">ip</span>&nbsp;<span class="ident" id="3275882">IP</span><span class="op" id="3275884">)</span>&nbsp;<span class="ident" id="3275886">IsLoopback</span><span class="op" id="3275896">(</span><span class="op" id="3275897">)</span>&nbsp;<span class="builtintype" id="3275899">bool</span>&nbsp;<span class="op" id="3275904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275907">if</span>&nbsp;<span class="ident" id="3275910">ip4</span>&nbsp;<span class="op" id="3275914">:=</span>&nbsp;<span class="ident" id="3275917">ip</span><span class="op" id="3275919">.</span><span class="ident" id="3275920">To4</span><span class="op" id="3275923">(</span><span class="op" id="3275924">)</span><span class="op" id="3275925">;</span>&nbsp;<span class="ident" id="3275927">ip4</span>&nbsp;<span class="op" id="3275931">!=</span>&nbsp;<span class="builtintype" id="3275934">nil</span>&nbsp;<span class="op" id="3275938">&amp;&amp;</span>&nbsp;<span class="ident" id="3275941">ip4</span><span class="op" id="3275944">[</span><span class="num" id="3275945">0</span><span class="op" id="3275946">]</span>&nbsp;<span class="op" id="3275948">==</span>&nbsp;<span class="num" id="3275951">127</span>&nbsp;<span class="op" id="3275955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275959">return</span>&nbsp;<span class="builtintype" id="3275966">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3275975">return</span>&nbsp;<span class="ident" id="3275982">ip</span><span class="op" id="3275984">.</span><span class="ident" id="3275985">Equal</span><span class="op" id="3275990">(</span><span class="ident" id="3275991">IPv6loopback</span><span class="op" id="3276003">)</span><br>
<span class="lineno">125</span><span class="op" id="3276005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3276008">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3276066">func</span>&nbsp;<span class="op" id="3276071">(</span><span class="ident" id="3276072">ip</span>&nbsp;<span class="ident" id="3276075">IP</span><span class="op" id="3276077">)</span>&nbsp;<span class="ident" id="3276079">IsMulticast</span><span class="op" id="3276090">(</span><span class="op" id="3276091">)</span>&nbsp;<span class="builtintype" id="3276093">bool</span>&nbsp;<span class="op" id="3276098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276101">if</span>&nbsp;<span class="ident" id="3276104">ip4</span>&nbsp;<span class="op" id="3276108">:=</span>&nbsp;<span class="ident" id="3276111">ip</span><span class="op" id="3276113">.</span><span class="ident" id="3276114">To4</span><span class="op" id="3276117">(</span><span class="op" id="3276118">)</span><span class="op" id="3276119">;</span>&nbsp;<span class="ident" id="3276121">ip4</span>&nbsp;<span class="op" id="3276125">!=</span>&nbsp;<span class="builtintype" id="3276128">nil</span>&nbsp;<span class="op" id="3276132">&amp;&amp;</span>&nbsp;<span class="ident" id="3276135">ip4</span><span class="op" id="3276138">[</span><span class="num" id="3276139">0</span><span class="op" id="3276140">]</span><span class="op" id="3276141">&amp;</span><span class="num" id="3276142">0xf0</span>&nbsp;<span class="op" id="3276147">==</span>&nbsp;<span class="num" id="3276150">0xe0</span>&nbsp;<span class="op" id="3276155">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276159">return</span>&nbsp;<span class="builtintype" id="3276166">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3276172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276175">return</span>&nbsp;<span class="ident" id="3276182">ip</span><span class="op" id="3276184">[</span><span class="num" id="3276185">0</span><span class="op" id="3276186">]</span>&nbsp;<span class="op" id="3276188">==</span>&nbsp;<span class="num" id="3276191">0xff</span><br>
<span class="lineno"></span><span class="op" id="3276196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3276199">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3276254">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3276295">func</span>&nbsp;<span class="op" id="3276300">(</span><span class="ident" id="3276301">ip</span>&nbsp;<span class="ident" id="3276304">IP</span><span class="op" id="3276306">)</span>&nbsp;<span class="ident" id="3276308">IsInterfaceLocalMulticast</span><span class="op" id="3276333">(</span><span class="op" id="3276334">)</span>&nbsp;<span class="builtintype" id="3276336">bool</span>&nbsp;<span class="op" id="3276341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276344">return</span>&nbsp;<span class="builtinfunc" id="3276351">len</span><span class="op" id="3276354">(</span><span class="ident" id="3276355">ip</span><span class="op" id="3276357">)</span>&nbsp;<span class="op" id="3276359">==</span>&nbsp;<span class="ident" id="3276362">IPv6len</span>&nbsp;<span class="op" id="3276370">&amp;&amp;</span>&nbsp;<span class="ident" id="3276373">ip</span><span class="op" id="3276375">[</span><span class="num" id="3276376">0</span><span class="op" id="3276377">]</span>&nbsp;<span class="op" id="3276379">==</span>&nbsp;<span class="num" id="3276382">0xff</span>&nbsp;<span class="op" id="3276387">&amp;&amp;</span>&nbsp;<span class="ident" id="3276390">ip</span><span class="op" id="3276392">[</span><span class="num" id="3276393">1</span><span class="op" id="3276394">]</span><span class="op" id="3276395">&amp;</span><span class="num" id="3276396">0x0f</span>&nbsp;<span class="op" id="3276401">==</span>&nbsp;<span class="num" id="3276404">0x01</span><br>
<span class="lineno"></span><span class="op" id="3276409">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3276412">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3276471">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3276493">func</span>&nbsp;<span class="op" id="3276498">(</span><span class="ident" id="3276499">ip</span>&nbsp;<span class="ident" id="3276502">IP</span><span class="op" id="3276504">)</span>&nbsp;<span class="ident" id="3276506">IsLinkLocalMulticast</span><span class="op" id="3276526">(</span><span class="op" id="3276527">)</span>&nbsp;<span class="builtintype" id="3276529">bool</span>&nbsp;<span class="op" id="3276534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276537">if</span>&nbsp;<span class="ident" id="3276540">ip4</span>&nbsp;<span class="op" id="3276544">:=</span>&nbsp;<span class="ident" id="3276547">ip</span><span class="op" id="3276549">.</span><span class="ident" id="3276550">To4</span><span class="op" id="3276553">(</span><span class="op" id="3276554">)</span><span class="op" id="3276555">;</span>&nbsp;<span class="ident" id="3276557">ip4</span>&nbsp;<span class="op" id="3276561">!=</span>&nbsp;<span class="builtintype" id="3276564">nil</span>&nbsp;<span class="op" id="3276568">&amp;&amp;</span>&nbsp;<span class="ident" id="3276571">ip4</span><span class="op" id="3276574">[</span><span class="num" id="3276575">0</span><span class="op" id="3276576">]</span>&nbsp;<span class="op" id="3276578">==</span>&nbsp;<span class="num" id="3276581">224</span>&nbsp;<span class="op" id="3276585">&amp;&amp;</span>&nbsp;<span class="ident" id="3276588">ip4</span><span class="op" id="3276591">[</span><span class="num" id="3276592">1</span><span class="op" id="3276593">]</span>&nbsp;<span class="op" id="3276595">==</span>&nbsp;<span class="num" id="3276598">0</span>&nbsp;<span class="op" id="3276600">&amp;&amp;</span>&nbsp;<span class="ident" id="3276603">ip4</span><span class="op" id="3276606">[</span><span class="num" id="3276607">2</span><span class="op" id="3276608">]</span>&nbsp;<span class="op" id="3276610">==</span>&nbsp;<span class="num" id="3276613">0</span>&nbsp;<span class="op" id="3276615">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276619">return</span>&nbsp;<span class="builtintype" id="3276626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3276632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276635">return</span>&nbsp;<span class="ident" id="3276642">ip</span><span class="op" id="3276644">[</span><span class="num" id="3276645">0</span><span class="op" id="3276646">]</span>&nbsp;<span class="op" id="3276648">==</span>&nbsp;<span class="num" id="3276651">0xff</span>&nbsp;<span class="op" id="3276656">&amp;&amp;</span>&nbsp;<span class="ident" id="3276659">ip</span><span class="op" id="3276661">[</span><span class="num" id="3276662">1</span><span class="op" id="3276663">]</span><span class="op" id="3276664">&amp;</span><span class="num" id="3276665">0x0f</span>&nbsp;<span class="op" id="3276670">==</span>&nbsp;<span class="num" id="3276673">0x02</span><br>
<span class="lineno"></span><span class="op" id="3276678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3276681">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3276738">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3276758">func</span>&nbsp;<span class="op" id="3276763">(</span><span class="ident" id="3276764">ip</span>&nbsp;<span class="ident" id="3276767">IP</span><span class="op" id="3276769">)</span>&nbsp;<span class="ident" id="3276771">IsLinkLocalUnicast</span><span class="op" id="3276789">(</span><span class="op" id="3276790">)</span>&nbsp;<span class="builtintype" id="3276792">bool</span>&nbsp;<span class="op" id="3276797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276800">if</span>&nbsp;<span class="ident" id="3276803">ip4</span>&nbsp;<span class="op" id="3276807">:=</span>&nbsp;<span class="ident" id="3276810">ip</span><span class="op" id="3276812">.</span><span class="ident" id="3276813">To4</span><span class="op" id="3276816">(</span><span class="op" id="3276817">)</span><span class="op" id="3276818">;</span>&nbsp;<span class="ident" id="3276820">ip4</span>&nbsp;<span class="op" id="3276824">!=</span>&nbsp;<span class="builtintype" id="3276827">nil</span>&nbsp;<span class="op" id="3276831">&amp;&amp;</span>&nbsp;<span class="ident" id="3276834">ip4</span><span class="op" id="3276837">[</span><span class="num" id="3276838">0</span><span class="op" id="3276839">]</span>&nbsp;<span class="op" id="3276841">==</span>&nbsp;<span class="num" id="3276844">169</span>&nbsp;<span class="op" id="3276848">&amp;&amp;</span>&nbsp;<span class="ident" id="3276851">ip4</span><span class="op" id="3276854">[</span><span class="num" id="3276855">1</span><span class="op" id="3276856">]</span>&nbsp;<span class="op" id="3276858">==</span>&nbsp;<span class="num" id="3276861">254</span>&nbsp;<span class="op" id="3276865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276869">return</span>&nbsp;<span class="builtintype" id="3276876">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3276882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3276885">return</span>&nbsp;<span class="ident" id="3276892">ip</span><span class="op" id="3276894">[</span><span class="num" id="3276895">0</span><span class="op" id="3276896">]</span>&nbsp;<span class="op" id="3276898">==</span>&nbsp;<span class="num" id="3276901">0xfe</span>&nbsp;<span class="op" id="3276906">&amp;&amp;</span>&nbsp;<span class="ident" id="3276909">ip</span><span class="op" id="3276911">[</span><span class="num" id="3276912">1</span><span class="op" id="3276913">]</span><span class="op" id="3276914">&amp;</span><span class="num" id="3276915">0xc0</span>&nbsp;<span class="op" id="3276920">==</span>&nbsp;<span class="num" id="3276923">0x80</span><br>
<span class="lineno"></span><span class="op" id="3276928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3276931">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3276989">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3277001">func</span>&nbsp;<span class="op" id="3277006">(</span><span class="ident" id="3277007">ip</span>&nbsp;<span class="ident" id="3277010">IP</span><span class="op" id="3277012">)</span>&nbsp;<span class="ident" id="3277014">IsGlobalUnicast</span><span class="op" id="3277029">(</span><span class="op" id="3277030">)</span>&nbsp;<span class="builtintype" id="3277032">bool</span>&nbsp;<span class="op" id="3277037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277040">return</span>&nbsp;<span class="op" id="3277047">!</span><span class="ident" id="3277048">ip</span><span class="op" id="3277050">.</span><span class="ident" id="3277051">IsUnspecified</span><span class="op" id="3277064">(</span><span class="op" id="3277065">)</span>&nbsp;<span class="op" id="3277067">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277072">!</span><span class="ident" id="3277073">ip</span><span class="op" id="3277075">.</span><span class="ident" id="3277076">IsLoopback</span><span class="op" id="3277086">(</span><span class="op" id="3277087">)</span>&nbsp;<span class="op" id="3277089">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277094">!</span><span class="ident" id="3277095">ip</span><span class="op" id="3277097">.</span><span class="ident" id="3277098">IsMulticast</span><span class="op" id="3277109">(</span><span class="op" id="3277110">)</span>&nbsp;<span class="op" id="3277112">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277117">!</span><span class="ident" id="3277118">ip</span><span class="op" id="3277120">.</span><span class="ident" id="3277121">IsLinkLocalUnicast</span><span class="op" id="3277139">(</span><span class="op" id="3277140">)</span><br>
<span class="lineno"></span><span class="op" id="3277142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3277145">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3277164">func</span>&nbsp;<span class="ident" id="3277169">isZeros</span><span class="op" id="3277176">(</span><span class="ident" id="3277177">p</span>&nbsp;<span class="ident" id="3277179">IP</span><span class="op" id="3277181">)</span>&nbsp;<span class="builtintype" id="3277183">bool</span>&nbsp;<span class="op" id="3277188">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277191">for</span>&nbsp;<span class="ident" id="3277195">i</span>&nbsp;<span class="op" id="3277197">:=</span>&nbsp;<span class="num" id="3277200">0</span><span class="op" id="3277201">;</span>&nbsp;<span class="ident" id="3277203">i</span>&nbsp;<span class="op" id="3277205">&lt;</span>&nbsp;<span class="builtinfunc" id="3277207">len</span><span class="op" id="3277210">(</span><span class="ident" id="3277211">p</span><span class="op" id="3277212">)</span><span class="op" id="3277213">;</span>&nbsp;<span class="ident" id="3277215">i</span><span class="op" id="3277216">++</span>&nbsp;<span class="op" id="3277219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277223">if</span>&nbsp;<span class="ident" id="3277226">p</span><span class="op" id="3277227">[</span><span class="ident" id="3277228">i</span><span class="op" id="3277229">]</span>&nbsp;<span class="op" id="3277231">!=</span>&nbsp;<span class="num" id="3277234">0</span>&nbsp;<span class="op" id="3277236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277241">return</span>&nbsp;<span class="builtintype" id="3277248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277259">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277262">return</span>&nbsp;<span class="builtintype" id="3277269">true</span><br>
<span class="lineno"></span><span class="op" id="3277274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3277277">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3277341">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3277391">func</span>&nbsp;<span class="op" id="3277396">(</span><span class="ident" id="3277397">ip</span>&nbsp;<span class="ident" id="3277400">IP</span><span class="op" id="3277402">)</span>&nbsp;<span class="ident" id="3277404">To4</span><span class="op" id="3277407">(</span><span class="op" id="3277408">)</span>&nbsp;<span class="ident" id="3277410">IP</span>&nbsp;<span class="op" id="3277413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277416">if</span>&nbsp;<span class="builtinfunc" id="3277419">len</span><span class="op" id="3277422">(</span><span class="ident" id="3277423">ip</span><span class="op" id="3277425">)</span>&nbsp;<span class="op" id="3277427">==</span>&nbsp;<span class="ident" id="3277430">IPv4len</span>&nbsp;<span class="op" id="3277438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277442">return</span>&nbsp;<span class="ident" id="3277449">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277456">if</span>&nbsp;<span class="builtinfunc" id="3277459">len</span><span class="op" id="3277462">(</span><span class="ident" id="3277463">ip</span><span class="op" id="3277465">)</span>&nbsp;<span class="op" id="3277467">==</span>&nbsp;<span class="ident" id="3277470">IPv6len</span>&nbsp;<span class="op" id="3277478">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277483">isZeros</span><span class="op" id="3277490">(</span><span class="ident" id="3277491">ip</span><span class="op" id="3277493">[</span><span class="num" id="3277494">0</span><span class="op" id="3277495">:</span><span class="num" id="3277496">10</span><span class="op" id="3277498">]</span><span class="op" id="3277499">)</span>&nbsp;<span class="op" id="3277501">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277506">ip</span><span class="op" id="3277508">[</span><span class="num" id="3277509">10</span><span class="op" id="3277511">]</span>&nbsp;<span class="op" id="3277513">==</span>&nbsp;<span class="num" id="3277516">0xff</span>&nbsp;<span class="op" id="3277521">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277526">ip</span><span class="op" id="3277528">[</span><span class="num" id="3277529">11</span><span class="op" id="3277531">]</span>&nbsp;<span class="op" id="3277533">==</span>&nbsp;<span class="num" id="3277536">0xff</span>&nbsp;<span class="op" id="3277541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277545">return</span>&nbsp;<span class="ident" id="3277552">ip</span><span class="op" id="3277554">[</span><span class="num" id="3277555">12</span><span class="op" id="3277557">:</span><span class="num" id="3277558">16</span><span class="op" id="3277560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277563">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277566">return</span>&nbsp;<span class="builtintype" id="3277573">nil</span><br>
<span class="lineno"></span><span class="op" id="3277577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3277580">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3277644">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3277718">func</span>&nbsp;<span class="op" id="3277723">(</span><span class="ident" id="3277724">ip</span>&nbsp;<span class="ident" id="3277727">IP</span><span class="op" id="3277729">)</span>&nbsp;<span class="ident" id="3277731">To16</span><span class="op" id="3277735">(</span><span class="op" id="3277736">)</span>&nbsp;<span class="ident" id="3277738">IP</span>&nbsp;<span class="op" id="3277741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277744">if</span>&nbsp;<span class="builtinfunc" id="3277747">len</span><span class="op" id="3277750">(</span><span class="ident" id="3277751">ip</span><span class="op" id="3277753">)</span>&nbsp;<span class="op" id="3277755">==</span>&nbsp;<span class="ident" id="3277758">IPv4len</span>&nbsp;<span class="op" id="3277766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277770">return</span>&nbsp;<span class="ident" id="3277777">IPv4</span><span class="op" id="3277781">(</span><span class="ident" id="3277782">ip</span><span class="op" id="3277784">[</span><span class="num" id="3277785">0</span><span class="op" id="3277786">]</span><span class="op" id="3277787">,</span>&nbsp;<span class="ident" id="3277789">ip</span><span class="op" id="3277791">[</span><span class="num" id="3277792">1</span><span class="op" id="3277793">]</span><span class="op" id="3277794">,</span>&nbsp;<span class="ident" id="3277796">ip</span><span class="op" id="3277798">[</span><span class="num" id="3277799">2</span><span class="op" id="3277800">]</span><span class="op" id="3277801">,</span>&nbsp;<span class="ident" id="3277803">ip</span><span class="op" id="3277805">[</span><span class="num" id="3277806">3</span><span class="op" id="3277807">]</span><span class="op" id="3277808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277814">if</span>&nbsp;<span class="builtinfunc" id="3277817">len</span><span class="op" id="3277820">(</span><span class="ident" id="3277821">ip</span><span class="op" id="3277823">)</span>&nbsp;<span class="op" id="3277825">==</span>&nbsp;<span class="ident" id="3277828">IPv6len</span>&nbsp;<span class="op" id="3277836">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277840">return</span>&nbsp;<span class="ident" id="3277847">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3277851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3277854">return</span>&nbsp;<span class="builtintype" id="3277861">nil</span><br>
<span class="lineno"></span><span class="op" id="3277865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3277868">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3277901">var</span>&nbsp;<span class="op" id="3277905">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277908">classAMask</span>&nbsp;<span class="op" id="3277919">=</span>&nbsp;<span class="ident" id="3277921">IPv4Mask</span><span class="op" id="3277929">(</span><span class="num" id="3277930">0xff</span><span class="op" id="3277934">,</span>&nbsp;<span class="num" id="3277936">0</span><span class="op" id="3277937">,</span>&nbsp;<span class="num" id="3277939">0</span><span class="op" id="3277940">,</span>&nbsp;<span class="num" id="3277942">0</span><span class="op" id="3277943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277946">classBMask</span>&nbsp;<span class="op" id="3277957">=</span>&nbsp;<span class="ident" id="3277959">IPv4Mask</span><span class="op" id="3277967">(</span><span class="num" id="3277968">0xff</span><span class="op" id="3277972">,</span>&nbsp;<span class="num" id="3277974">0xff</span><span class="op" id="3277978">,</span>&nbsp;<span class="num" id="3277980">0</span><span class="op" id="3277981">,</span>&nbsp;<span class="num" id="3277983">0</span><span class="op" id="3277984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277987">classCMask</span>&nbsp;<span class="op" id="3277998">=</span>&nbsp;<span class="ident" id="3278000">IPv4Mask</span><span class="op" id="3278008">(</span><span class="num" id="3278009">0xff</span><span class="op" id="3278013">,</span>&nbsp;<span class="num" id="3278015">0xff</span><span class="op" id="3278019">,</span>&nbsp;<span class="num" id="3278021">0xff</span><span class="op" id="3278025">,</span>&nbsp;<span class="num" id="3278027">0</span><span class="op" id="3278028">)</span><br>
<span class="lineno">210</span><span class="op" id="3278030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3278033">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3278099">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3278162">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3278204">func</span>&nbsp;<span class="op" id="3278209">(</span><span class="ident" id="3278210">ip</span>&nbsp;<span class="ident" id="3278213">IP</span><span class="op" id="3278215">)</span>&nbsp;<span class="ident" id="3278217">DefaultMask</span><span class="op" id="3278228">(</span><span class="op" id="3278229">)</span>&nbsp;<span class="ident" id="3278231">IPMask</span>&nbsp;<span class="op" id="3278238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278241">if</span>&nbsp;<span class="ident" id="3278244">ip</span>&nbsp;<span class="op" id="3278247">=</span>&nbsp;<span class="ident" id="3278249">ip</span><span class="op" id="3278251">.</span><span class="ident" id="3278252">To4</span><span class="op" id="3278255">(</span><span class="op" id="3278256">)</span><span class="op" id="3278257">;</span>&nbsp;<span class="ident" id="3278259">ip</span>&nbsp;<span class="op" id="3278262">==</span>&nbsp;<span class="builtintype" id="3278265">nil</span>&nbsp;<span class="op" id="3278269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278273">return</span>&nbsp;<span class="builtintype" id="3278280">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278288">switch</span>&nbsp;<span class="builtintype" id="3278295">true</span>&nbsp;<span class="op" id="3278300">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278303">case</span>&nbsp;<span class="ident" id="3278308">ip</span><span class="op" id="3278310">[</span><span class="num" id="3278311">0</span><span class="op" id="3278312">]</span>&nbsp;<span class="op" id="3278314">&lt;</span>&nbsp;<span class="num" id="3278316">0x80</span><span class="op" id="3278320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278324">return</span>&nbsp;<span class="ident" id="3278331">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278343">case</span>&nbsp;<span class="ident" id="3278348">ip</span><span class="op" id="3278350">[</span><span class="num" id="3278351">0</span><span class="op" id="3278352">]</span>&nbsp;<span class="op" id="3278354">&lt;</span>&nbsp;<span class="num" id="3278356">0xC0</span><span class="op" id="3278360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278364">return</span>&nbsp;<span class="ident" id="3278371">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278383">default</span><span class="op" id="3278390">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278394">return</span>&nbsp;<span class="ident" id="3278401">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278413">}</span><br>
<span class="lineno"></span><span class="op" id="3278415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278418">func</span>&nbsp;<span class="ident" id="3278423">allFF</span><span class="op" id="3278428">(</span><span class="ident" id="3278429">b</span>&nbsp;<span class="op" id="3278431">[</span><span class="op" id="3278432">]</span><span class="builtintype" id="3278433">byte</span><span class="op" id="3278437">)</span>&nbsp;<span class="builtintype" id="3278439">bool</span>&nbsp;<span class="op" id="3278444">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278447">for</span>&nbsp;<span class="ident" id="3278451">_</span><span class="op" id="3278452">,</span>&nbsp;<span class="ident" id="3278454">c</span>&nbsp;<span class="op" id="3278456">:=</span>&nbsp;<span class="keyword" id="3278459">range</span>&nbsp;<span class="ident" id="3278465">b</span>&nbsp;<span class="op" id="3278467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278471">if</span>&nbsp;<span class="ident" id="3278474">c</span>&nbsp;<span class="op" id="3278476">!=</span>&nbsp;<span class="num" id="3278479">0xff</span>&nbsp;<span class="op" id="3278484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278489">return</span>&nbsp;<span class="builtintype" id="3278496">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278507">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278510">return</span>&nbsp;<span class="builtintype" id="3278517">true</span><br>
<span class="lineno"></span><span class="op" id="3278522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3278525">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3278592">func</span>&nbsp;<span class="op" id="3278597">(</span><span class="ident" id="3278598">ip</span>&nbsp;<span class="ident" id="3278601">IP</span><span class="op" id="3278603">)</span>&nbsp;<span class="ident" id="3278605">Mask</span><span class="op" id="3278609">(</span><span class="ident" id="3278610">mask</span>&nbsp;<span class="ident" id="3278615">IPMask</span><span class="op" id="3278621">)</span>&nbsp;<span class="ident" id="3278623">IP</span>&nbsp;<span class="op" id="3278626">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278629">if</span>&nbsp;<span class="builtinfunc" id="3278632">len</span><span class="op" id="3278635">(</span><span class="ident" id="3278636">mask</span><span class="op" id="3278640">)</span>&nbsp;<span class="op" id="3278642">==</span>&nbsp;<span class="ident" id="3278645">IPv6len</span>&nbsp;<span class="op" id="3278653">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3278656">len</span><span class="op" id="3278659">(</span><span class="ident" id="3278660">ip</span><span class="op" id="3278662">)</span>&nbsp;<span class="op" id="3278664">==</span>&nbsp;<span class="ident" id="3278667">IPv4len</span>&nbsp;<span class="op" id="3278675">&amp;&amp;</span>&nbsp;<span class="ident" id="3278678">allFF</span><span class="op" id="3278683">(</span><span class="ident" id="3278684">mask</span><span class="op" id="3278688">[</span><span class="op" id="3278689">:</span><span class="num" id="3278690">12</span><span class="op" id="3278692">]</span><span class="op" id="3278693">)</span>&nbsp;<span class="op" id="3278695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3278699">mask</span>&nbsp;<span class="op" id="3278704">=</span>&nbsp;<span class="ident" id="3278706">mask</span><span class="op" id="3278710">[</span><span class="num" id="3278711">12</span><span class="op" id="3278713">:</span><span class="op" id="3278714">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278720">if</span>&nbsp;<span class="builtinfunc" id="3278723">len</span><span class="op" id="3278726">(</span><span class="ident" id="3278727">mask</span><span class="op" id="3278731">)</span>&nbsp;<span class="op" id="3278733">==</span>&nbsp;<span class="ident" id="3278736">IPv4len</span>&nbsp;<span class="op" id="3278744">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3278747">len</span><span class="op" id="3278750">(</span><span class="ident" id="3278751">ip</span><span class="op" id="3278753">)</span>&nbsp;<span class="op" id="3278755">==</span>&nbsp;<span class="ident" id="3278758">IPv6len</span>&nbsp;<span class="op" id="3278766">&amp;&amp;</span>&nbsp;<span class="ident" id="3278769">bytesEqual</span><span class="op" id="3278779">(</span><span class="ident" id="3278780">ip</span><span class="op" id="3278782">[</span><span class="op" id="3278783">:</span><span class="num" id="3278784">12</span><span class="op" id="3278786">]</span><span class="op" id="3278787">,</span>&nbsp;<span class="ident" id="3278789">v4InV6Prefix</span><span class="op" id="3278801">)</span>&nbsp;<span class="op" id="3278803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3278807">ip</span>&nbsp;<span class="op" id="3278810">=</span>&nbsp;<span class="ident" id="3278812">ip</span><span class="op" id="3278814">[</span><span class="num" id="3278815">12</span><span class="op" id="3278817">:</span><span class="op" id="3278818">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3278824">n</span>&nbsp;<span class="op" id="3278826">:=</span>&nbsp;<span class="builtinfunc" id="3278829">len</span><span class="op" id="3278832">(</span><span class="ident" id="3278833">ip</span><span class="op" id="3278835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278838">if</span>&nbsp;<span class="ident" id="3278841">n</span>&nbsp;<span class="op" id="3278843">!=</span>&nbsp;<span class="builtinfunc" id="3278846">len</span><span class="op" id="3278849">(</span><span class="ident" id="3278850">mask</span><span class="op" id="3278854">)</span>&nbsp;<span class="op" id="3278856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278860">return</span>&nbsp;<span class="builtintype" id="3278867">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278872">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3278875">out</span>&nbsp;<span class="op" id="3278879">:=</span>&nbsp;<span class="builtinfunc" id="3278882">make</span><span class="op" id="3278886">(</span><span class="ident" id="3278887">IP</span><span class="op" id="3278889">,</span>&nbsp;<span class="ident" id="3278891">n</span><span class="op" id="3278892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278895">for</span>&nbsp;<span class="ident" id="3278899">i</span>&nbsp;<span class="op" id="3278901">:=</span>&nbsp;<span class="num" id="3278904">0</span><span class="op" id="3278905">;</span>&nbsp;<span class="ident" id="3278907">i</span>&nbsp;<span class="op" id="3278909">&lt;</span>&nbsp;<span class="ident" id="3278911">n</span><span class="op" id="3278912">;</span>&nbsp;<span class="ident" id="3278914">i</span><span class="op" id="3278915">++</span>&nbsp;<span class="op" id="3278918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3278922">out</span><span class="op" id="3278925">[</span><span class="ident" id="3278926">i</span><span class="op" id="3278927">]</span>&nbsp;<span class="op" id="3278929">=</span>&nbsp;<span class="ident" id="3278931">ip</span><span class="op" id="3278933">[</span><span class="ident" id="3278934">i</span><span class="op" id="3278935">]</span>&nbsp;<span class="op" id="3278937">&amp;</span>&nbsp;<span class="ident" id="3278939">mask</span><span class="op" id="3278943">[</span><span class="ident" id="3278944">i</span><span class="op" id="3278945">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3278951">return</span>&nbsp;<span class="ident" id="3278958">out</span><br>
<span class="lineno">255</span><span class="op" id="3278962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3278965">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3279021">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3279085">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3279154">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3279191">func</span>&nbsp;<span class="op" id="3279196">(</span><span class="ident" id="3279197">ip</span>&nbsp;<span class="ident" id="3279200">IP</span><span class="op" id="3279202">)</span>&nbsp;<span class="ident" id="3279204">String</span><span class="op" id="3279210">(</span><span class="op" id="3279211">)</span>&nbsp;<span class="builtintype" id="3279213">string</span>&nbsp;<span class="op" id="3279220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279223">p</span>&nbsp;<span class="op" id="3279225">:=</span>&nbsp;<span class="ident" id="3279228">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279233">if</span>&nbsp;<span class="builtinfunc" id="3279236">len</span><span class="op" id="3279239">(</span><span class="ident" id="3279240">ip</span><span class="op" id="3279242">)</span>&nbsp;<span class="op" id="3279244">==</span>&nbsp;<span class="num" id="3279247">0</span>&nbsp;<span class="op" id="3279249">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279253">return</span>&nbsp;<span class="string" id="3279260">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3279273">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279307">if</span>&nbsp;<span class="ident" id="3279310">p4</span>&nbsp;<span class="op" id="3279313">:=</span>&nbsp;<span class="ident" id="3279316">p</span><span class="op" id="3279317">.</span><span class="ident" id="3279318">To4</span><span class="op" id="3279321">(</span><span class="op" id="3279322">)</span><span class="op" id="3279323">;</span>&nbsp;<span class="builtinfunc" id="3279325">len</span><span class="op" id="3279328">(</span><span class="ident" id="3279329">p4</span><span class="op" id="3279331">)</span>&nbsp;<span class="op" id="3279333">==</span>&nbsp;<span class="ident" id="3279336">IPv4len</span>&nbsp;<span class="op" id="3279344">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279348">return</span>&nbsp;<span class="ident" id="3279355">itod</span><span class="op" id="3279359">(</span><span class="builtintype" id="3279360">uint</span><span class="op" id="3279364">(</span><span class="ident" id="3279365">p4</span><span class="op" id="3279367">[</span><span class="num" id="3279368">0</span><span class="op" id="3279369">]</span><span class="op" id="3279370">)</span><span class="op" id="3279371">)</span>&nbsp;<span class="op" id="3279373">+</span>&nbsp;<span class="string" id="3279375">&#34;.&#34;</span>&nbsp;<span class="op" id="3279379">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279384">itod</span><span class="op" id="3279388">(</span><span class="builtintype" id="3279389">uint</span><span class="op" id="3279393">(</span><span class="ident" id="3279394">p4</span><span class="op" id="3279396">[</span><span class="num" id="3279397">1</span><span class="op" id="3279398">]</span><span class="op" id="3279399">)</span><span class="op" id="3279400">)</span>&nbsp;<span class="op" id="3279402">+</span>&nbsp;<span class="string" id="3279404">&#34;.&#34;</span>&nbsp;<span class="op" id="3279408">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279413">itod</span><span class="op" id="3279417">(</span><span class="builtintype" id="3279418">uint</span><span class="op" id="3279422">(</span><span class="ident" id="3279423">p4</span><span class="op" id="3279425">[</span><span class="num" id="3279426">2</span><span class="op" id="3279427">]</span><span class="op" id="3279428">)</span><span class="op" id="3279429">)</span>&nbsp;<span class="op" id="3279431">+</span>&nbsp;<span class="string" id="3279433">&#34;.&#34;</span>&nbsp;<span class="op" id="3279437">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279442">itod</span><span class="op" id="3279446">(</span><span class="builtintype" id="3279447">uint</span><span class="op" id="3279451">(</span><span class="ident" id="3279452">p4</span><span class="op" id="3279454">[</span><span class="num" id="3279455">3</span><span class="op" id="3279456">]</span><span class="op" id="3279457">)</span><span class="op" id="3279458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279461">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279464">if</span>&nbsp;<span class="builtinfunc" id="3279467">len</span><span class="op" id="3279470">(</span><span class="ident" id="3279471">p</span><span class="op" id="3279472">)</span>&nbsp;<span class="op" id="3279474">!=</span>&nbsp;<span class="ident" id="3279477">IPv6len</span>&nbsp;<span class="op" id="3279485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279489">return</span>&nbsp;<span class="string" id="3279496">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3279505">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279536">e0</span>&nbsp;<span class="op" id="3279539">:=</span>&nbsp;<span class="op" id="3279542">-</span><span class="num" id="3279543">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279546">e1</span>&nbsp;<span class="op" id="3279549">:=</span>&nbsp;<span class="op" id="3279552">-</span><span class="num" id="3279553">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279556">for</span>&nbsp;<span class="ident" id="3279560">i</span>&nbsp;<span class="op" id="3279562">:=</span>&nbsp;<span class="num" id="3279565">0</span><span class="op" id="3279566">;</span>&nbsp;<span class="ident" id="3279568">i</span>&nbsp;<span class="op" id="3279570">&lt;</span>&nbsp;<span class="ident" id="3279572">IPv6len</span><span class="op" id="3279579">;</span>&nbsp;<span class="ident" id="3279581">i</span>&nbsp;<span class="op" id="3279583">+=</span>&nbsp;<span class="num" id="3279586">2</span>&nbsp;<span class="op" id="3279588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279592">j</span>&nbsp;<span class="op" id="3279594">:=</span>&nbsp;<span class="ident" id="3279597">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279601">for</span>&nbsp;<span class="ident" id="3279605">j</span>&nbsp;<span class="op" id="3279607">&lt;</span>&nbsp;<span class="ident" id="3279609">IPv6len</span>&nbsp;<span class="op" id="3279617">&amp;&amp;</span>&nbsp;<span class="ident" id="3279620">p</span><span class="op" id="3279621">[</span><span class="ident" id="3279622">j</span><span class="op" id="3279623">]</span>&nbsp;<span class="op" id="3279625">==</span>&nbsp;<span class="num" id="3279628">0</span>&nbsp;<span class="op" id="3279630">&amp;&amp;</span>&nbsp;<span class="ident" id="3279633">p</span><span class="op" id="3279634">[</span><span class="ident" id="3279635">j</span><span class="op" id="3279636">+</span><span class="num" id="3279637">1</span><span class="op" id="3279638">]</span>&nbsp;<span class="op" id="3279640">==</span>&nbsp;<span class="num" id="3279643">0</span>&nbsp;<span class="op" id="3279645">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279650">j</span>&nbsp;<span class="op" id="3279652">+=</span>&nbsp;<span class="num" id="3279655">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279663">if</span>&nbsp;<span class="ident" id="3279666">j</span>&nbsp;<span class="op" id="3279668">&gt;</span>&nbsp;<span class="ident" id="3279670">i</span>&nbsp;<span class="op" id="3279672">&amp;&amp;</span>&nbsp;<span class="ident" id="3279675">j</span><span class="op" id="3279676">-</span><span class="ident" id="3279677">i</span>&nbsp;<span class="op" id="3279679">&gt;</span>&nbsp;<span class="ident" id="3279681">e1</span><span class="op" id="3279683">-</span><span class="ident" id="3279684">e0</span>&nbsp;<span class="op" id="3279687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279692">e0</span>&nbsp;<span class="op" id="3279695">=</span>&nbsp;<span class="ident" id="3279697">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279702">e1</span>&nbsp;<span class="op" id="3279705">=</span>&nbsp;<span class="ident" id="3279707">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279712">i</span>&nbsp;<span class="op" id="3279714">=</span>&nbsp;<span class="ident" id="3279716">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3279726">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279799">if</span>&nbsp;<span class="ident" id="3279802">e1</span><span class="op" id="3279804">-</span><span class="ident" id="3279805">e0</span>&nbsp;<span class="op" id="3279808">&lt;=</span>&nbsp;<span class="num" id="3279811">2</span>&nbsp;<span class="op" id="3279813">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279817">e0</span>&nbsp;<span class="op" id="3279820">=</span>&nbsp;<span class="op" id="3279822">-</span><span class="num" id="3279823">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279827">e1</span>&nbsp;<span class="op" id="3279830">=</span>&nbsp;<span class="op" id="3279832">-</span><span class="num" id="3279833">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3279836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279840">const</span>&nbsp;<span class="ident" id="3279846">maxLen</span>&nbsp;<span class="op" id="3279853">=</span>&nbsp;<span class="builtinfunc" id="3279855">len</span><span class="op" id="3279858">(</span><span class="string" id="3279859">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3279900">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3279903">b</span>&nbsp;<span class="op" id="3279905">:=</span>&nbsp;<span class="builtinfunc" id="3279908">make</span><span class="op" id="3279912">(</span><span class="op" id="3279913">[</span><span class="op" id="3279914">]</span><span class="builtintype" id="3279915">byte</span><span class="op" id="3279919">,</span>&nbsp;<span class="num" id="3279921">0</span><span class="op" id="3279922">,</span>&nbsp;<span class="ident" id="3279924">maxLen</span><span class="op" id="3279930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3279934">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3279986">for</span>&nbsp;<span class="ident" id="3279990">i</span>&nbsp;<span class="op" id="3279992">:=</span>&nbsp;<span class="num" id="3279995">0</span><span class="op" id="3279996">;</span>&nbsp;<span class="ident" id="3279998">i</span>&nbsp;<span class="op" id="3280000">&lt;</span>&nbsp;<span class="ident" id="3280002">IPv6len</span><span class="op" id="3280009">;</span>&nbsp;<span class="ident" id="3280011">i</span>&nbsp;<span class="op" id="3280013">+=</span>&nbsp;<span class="num" id="3280016">2</span>&nbsp;<span class="op" id="3280018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280022">if</span>&nbsp;<span class="ident" id="3280025">i</span>&nbsp;<span class="op" id="3280027">==</span>&nbsp;<span class="ident" id="3280030">e0</span>&nbsp;<span class="op" id="3280033">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3280038">b</span>&nbsp;<span class="op" id="3280040">=</span>&nbsp;<span class="builtinfunc" id="3280042">append</span><span class="op" id="3280048">(</span><span class="ident" id="3280049">b</span><span class="op" id="3280050">,</span>&nbsp;<span class="string" id="3280052">&#39;:&#39;</span><span class="op" id="3280055">,</span>&nbsp;<span class="string" id="3280057">&#39;:&#39;</span><span class="op" id="3280060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3280065">i</span>&nbsp;<span class="op" id="3280067">=</span>&nbsp;<span class="ident" id="3280069">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280075">if</span>&nbsp;<span class="ident" id="3280078">i</span>&nbsp;<span class="op" id="3280080">&gt;=</span>&nbsp;<span class="ident" id="3280083">IPv6len</span>&nbsp;<span class="op" id="3280091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280097">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280106">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280110">}</span>&nbsp;<span class="keyword" id="3280112">else</span>&nbsp;<span class="keyword" id="3280117">if</span>&nbsp;<span class="ident" id="3280120">i</span>&nbsp;<span class="op" id="3280122">&gt;</span>&nbsp;<span class="num" id="3280124">0</span>&nbsp;<span class="op" id="3280126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3280131">b</span>&nbsp;<span class="op" id="3280133">=</span>&nbsp;<span class="builtinfunc" id="3280135">append</span><span class="op" id="3280141">(</span><span class="ident" id="3280142">b</span><span class="op" id="3280143">,</span>&nbsp;<span class="string" id="3280145">&#39;:&#39;</span><span class="op" id="3280148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3280156">b</span>&nbsp;<span class="op" id="3280158">=</span>&nbsp;<span class="ident" id="3280160">appendHex</span><span class="op" id="3280169">(</span><span class="ident" id="3280170">b</span><span class="op" id="3280171">,</span>&nbsp;<span class="op" id="3280173">(</span><span class="builtintype" id="3280174">uint32</span><span class="op" id="3280180">(</span><span class="ident" id="3280181">p</span><span class="op" id="3280182">[</span><span class="ident" id="3280183">i</span><span class="op" id="3280184">]</span><span class="op" id="3280185">)</span><span class="op" id="3280186">&lt;&lt;</span><span class="num" id="3280188">8</span><span class="op" id="3280189">)</span><span class="op" id="3280190">|</span><span class="builtintype" id="3280191">uint32</span><span class="op" id="3280197">(</span><span class="ident" id="3280198">p</span><span class="op" id="3280199">[</span><span class="ident" id="3280200">i</span><span class="op" id="3280201">+</span><span class="num" id="3280202">1</span><span class="op" id="3280203">]</span><span class="op" id="3280204">)</span><span class="op" id="3280205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280208">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280211">return</span>&nbsp;<span class="builtintype" id="3280218">string</span><span class="op" id="3280224">(</span><span class="ident" id="3280225">b</span><span class="op" id="3280226">)</span><br>
<span class="lineno"></span><span class="op" id="3280228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3280231">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3280289">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3280326">func</span>&nbsp;<span class="ident" id="3280331">ipEmptyString</span><span class="op" id="3280344">(</span><span class="ident" id="3280345">ip</span>&nbsp;<span class="ident" id="3280348">IP</span><span class="op" id="3280350">)</span>&nbsp;<span class="builtintype" id="3280352">string</span>&nbsp;<span class="op" id="3280359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280362">if</span>&nbsp;<span class="builtinfunc" id="3280365">len</span><span class="op" id="3280368">(</span><span class="ident" id="3280369">ip</span><span class="op" id="3280371">)</span>&nbsp;<span class="op" id="3280373">==</span>&nbsp;<span class="num" id="3280376">0</span>&nbsp;<span class="op" id="3280378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280382">return</span>&nbsp;<span class="string" id="3280389">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280396">return</span>&nbsp;<span class="ident" id="3280403">ip</span><span class="op" id="3280405">.</span><span class="ident" id="3280406">String</span><span class="op" id="3280412">(</span><span class="op" id="3280413">)</span><br>
<span class="lineno">325</span><span class="op" id="3280415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3280418">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3280482">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3280533">func</span>&nbsp;<span class="op" id="3280538">(</span><span class="ident" id="3280539">ip</span>&nbsp;<span class="ident" id="3280542">IP</span><span class="op" id="3280544">)</span>&nbsp;<span class="ident" id="3280546">MarshalText</span><span class="op" id="3280557">(</span><span class="op" id="3280558">)</span>&nbsp;<span class="op" id="3280560">(</span><span class="op" id="3280561">[</span><span class="op" id="3280562">]</span><span class="builtintype" id="3280563">byte</span><span class="op" id="3280567">,</span>&nbsp;<span class="builtintype" id="3280569">error</span><span class="op" id="3280574">)</span>&nbsp;<span class="op" id="3280576">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280579">if</span>&nbsp;<span class="builtinfunc" id="3280582">len</span><span class="op" id="3280585">(</span><span class="ident" id="3280586">ip</span><span class="op" id="3280588">)</span>&nbsp;<span class="op" id="3280590">==</span>&nbsp;<span class="num" id="3280593">0</span>&nbsp;<span class="op" id="3280595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280599">return</span>&nbsp;<span class="op" id="3280606">[</span><span class="op" id="3280607">]</span><span class="builtintype" id="3280608">byte</span><span class="op" id="3280612">(</span><span class="string" id="3280613">&#34;&#34;</span><span class="op" id="3280615">)</span><span class="op" id="3280616">,</span>&nbsp;<span class="builtintype" id="3280618">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280626">if</span>&nbsp;<span class="builtinfunc" id="3280629">len</span><span class="op" id="3280632">(</span><span class="ident" id="3280633">ip</span><span class="op" id="3280635">)</span>&nbsp;<span class="op" id="3280637">!=</span>&nbsp;<span class="ident" id="3280640">IPv4len</span>&nbsp;<span class="op" id="3280648">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3280651">len</span><span class="op" id="3280654">(</span><span class="ident" id="3280655">ip</span><span class="op" id="3280657">)</span>&nbsp;<span class="op" id="3280659">!=</span>&nbsp;<span class="ident" id="3280662">IPv6len</span>&nbsp;<span class="op" id="3280670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280674">return</span>&nbsp;<span class="builtintype" id="3280681">nil</span><span class="op" id="3280684">,</span>&nbsp;<span class="ident" id="3280686">errors</span><span class="op" id="3280692">.</span><span class="ident" id="3280693">New</span><span class="op" id="3280696">(</span><span class="string" id="3280697">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3280717">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280723">return</span>&nbsp;<span class="op" id="3280730">[</span><span class="op" id="3280731">]</span><span class="builtintype" id="3280732">byte</span><span class="op" id="3280736">(</span><span class="ident" id="3280737">ip</span><span class="op" id="3280739">.</span><span class="ident" id="3280740">String</span><span class="op" id="3280746">(</span><span class="op" id="3280747">)</span><span class="op" id="3280748">)</span><span class="op" id="3280749">,</span>&nbsp;<span class="builtintype" id="3280751">nil</span><br>
<span class="lineno"></span><span class="op" id="3280755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3280758">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3280826">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3280887">func</span>&nbsp;<span class="op" id="3280892">(</span><span class="ident" id="3280893">ip</span>&nbsp;<span class="op" id="3280896">*</span><span class="ident" id="3280897">IP</span><span class="op" id="3280899">)</span>&nbsp;<span class="ident" id="3280901">UnmarshalText</span><span class="op" id="3280914">(</span><span class="ident" id="3280915">text</span>&nbsp;<span class="op" id="3280920">[</span><span class="op" id="3280921">]</span><span class="builtintype" id="3280922">byte</span><span class="op" id="3280926">)</span>&nbsp;<span class="builtintype" id="3280928">error</span>&nbsp;<span class="op" id="3280934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280937">if</span>&nbsp;<span class="builtinfunc" id="3280940">len</span><span class="op" id="3280943">(</span><span class="ident" id="3280944">text</span><span class="op" id="3280948">)</span>&nbsp;<span class="op" id="3280950">==</span>&nbsp;<span class="num" id="3280953">0</span>&nbsp;<span class="op" id="3280955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280959">*</span><span class="ident" id="3280960">ip</span>&nbsp;<span class="op" id="3280963">=</span>&nbsp;<span class="builtintype" id="3280965">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3280971">return</span>&nbsp;<span class="builtintype" id="3280978">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3280986">s</span>&nbsp;<span class="op" id="3280988">:=</span>&nbsp;<span class="builtintype" id="3280991">string</span><span class="op" id="3280997">(</span><span class="ident" id="3280998">text</span><span class="op" id="3281002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3281005">x</span>&nbsp;<span class="op" id="3281007">:=</span>&nbsp;<span class="ident" id="3281010">ParseIP</span><span class="op" id="3281017">(</span><span class="ident" id="3281018">s</span><span class="op" id="3281019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281022">if</span>&nbsp;<span class="ident" id="3281025">x</span>&nbsp;<span class="op" id="3281027">==</span>&nbsp;<span class="builtintype" id="3281030">nil</span>&nbsp;<span class="op" id="3281034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281038">return</span>&nbsp;<span class="op" id="3281045">&amp;</span><span class="ident" id="3281046">ParseError</span><span class="op" id="3281056">{</span><span class="string" id="3281057">&#34;IP&nbsp;address&#34;</span><span class="op" id="3281069">,</span>&nbsp;<span class="ident" id="3281071">s</span><span class="op" id="3281072">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281078">*</span><span class="ident" id="3281079">ip</span>&nbsp;<span class="op" id="3281082">=</span>&nbsp;<span class="ident" id="3281084">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281087">return</span>&nbsp;<span class="builtintype" id="3281094">nil</span><br>
<span class="lineno"></span><span class="op" id="3281098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3281101">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3281160">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3281218">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3281245">func</span>&nbsp;<span class="op" id="3281250">(</span><span class="ident" id="3281251">ip</span>&nbsp;<span class="ident" id="3281254">IP</span><span class="op" id="3281256">)</span>&nbsp;<span class="ident" id="3281258">Equal</span><span class="op" id="3281263">(</span><span class="ident" id="3281264">x</span>&nbsp;<span class="ident" id="3281266">IP</span><span class="op" id="3281268">)</span>&nbsp;<span class="builtintype" id="3281270">bool</span>&nbsp;<span class="op" id="3281275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281278">if</span>&nbsp;<span class="builtinfunc" id="3281281">len</span><span class="op" id="3281284">(</span><span class="ident" id="3281285">ip</span><span class="op" id="3281287">)</span>&nbsp;<span class="op" id="3281289">==</span>&nbsp;<span class="builtinfunc" id="3281292">len</span><span class="op" id="3281295">(</span><span class="ident" id="3281296">x</span><span class="op" id="3281297">)</span>&nbsp;<span class="op" id="3281299">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281303">return</span>&nbsp;<span class="ident" id="3281310">bytesEqual</span><span class="op" id="3281320">(</span><span class="ident" id="3281321">ip</span><span class="op" id="3281323">,</span>&nbsp;<span class="ident" id="3281325">x</span><span class="op" id="3281326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281332">if</span>&nbsp;<span class="builtinfunc" id="3281335">len</span><span class="op" id="3281338">(</span><span class="ident" id="3281339">ip</span><span class="op" id="3281341">)</span>&nbsp;<span class="op" id="3281343">==</span>&nbsp;<span class="ident" id="3281346">IPv4len</span>&nbsp;<span class="op" id="3281354">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3281357">len</span><span class="op" id="3281360">(</span><span class="ident" id="3281361">x</span><span class="op" id="3281362">)</span>&nbsp;<span class="op" id="3281364">==</span>&nbsp;<span class="ident" id="3281367">IPv6len</span>&nbsp;<span class="op" id="3281375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281379">return</span>&nbsp;<span class="ident" id="3281386">bytesEqual</span><span class="op" id="3281396">(</span><span class="ident" id="3281397">x</span><span class="op" id="3281398">[</span><span class="num" id="3281399">0</span><span class="op" id="3281400">:</span><span class="num" id="3281401">12</span><span class="op" id="3281403">]</span><span class="op" id="3281404">,</span>&nbsp;<span class="ident" id="3281406">v4InV6Prefix</span><span class="op" id="3281418">)</span>&nbsp;<span class="op" id="3281420">&amp;&amp;</span>&nbsp;<span class="ident" id="3281423">bytesEqual</span><span class="op" id="3281433">(</span><span class="ident" id="3281434">ip</span><span class="op" id="3281436">,</span>&nbsp;<span class="ident" id="3281438">x</span><span class="op" id="3281439">[</span><span class="num" id="3281440">12</span><span class="op" id="3281442">:</span><span class="op" id="3281443">]</span><span class="op" id="3281444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281447">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281450">if</span>&nbsp;<span class="builtinfunc" id="3281453">len</span><span class="op" id="3281456">(</span><span class="ident" id="3281457">ip</span><span class="op" id="3281459">)</span>&nbsp;<span class="op" id="3281461">==</span>&nbsp;<span class="ident" id="3281464">IPv6len</span>&nbsp;<span class="op" id="3281472">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3281475">len</span><span class="op" id="3281478">(</span><span class="ident" id="3281479">x</span><span class="op" id="3281480">)</span>&nbsp;<span class="op" id="3281482">==</span>&nbsp;<span class="ident" id="3281485">IPv4len</span>&nbsp;<span class="op" id="3281493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281497">return</span>&nbsp;<span class="ident" id="3281504">bytesEqual</span><span class="op" id="3281514">(</span><span class="ident" id="3281515">ip</span><span class="op" id="3281517">[</span><span class="num" id="3281518">0</span><span class="op" id="3281519">:</span><span class="num" id="3281520">12</span><span class="op" id="3281522">]</span><span class="op" id="3281523">,</span>&nbsp;<span class="ident" id="3281525">v4InV6Prefix</span><span class="op" id="3281537">)</span>&nbsp;<span class="op" id="3281539">&amp;&amp;</span>&nbsp;<span class="ident" id="3281542">bytesEqual</span><span class="op" id="3281552">(</span><span class="ident" id="3281553">ip</span><span class="op" id="3281555">[</span><span class="num" id="3281556">12</span><span class="op" id="3281558">:</span><span class="op" id="3281559">]</span><span class="op" id="3281560">,</span>&nbsp;<span class="ident" id="3281562">x</span><span class="op" id="3281563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281569">return</span>&nbsp;<span class="builtintype" id="3281576">false</span><br>
<span class="lineno"></span><span class="op" id="3281582">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3281585">func</span>&nbsp;<span class="ident" id="3281590">bytesEqual</span><span class="op" id="3281600">(</span><span class="ident" id="3281601">x</span><span class="op" id="3281602">,</span>&nbsp;<span class="ident" id="3281604">y</span>&nbsp;<span class="op" id="3281606">[</span><span class="op" id="3281607">]</span><span class="builtintype" id="3281608">byte</span><span class="op" id="3281612">)</span>&nbsp;<span class="builtintype" id="3281614">bool</span>&nbsp;<span class="op" id="3281619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281622">if</span>&nbsp;<span class="builtinfunc" id="3281625">len</span><span class="op" id="3281628">(</span><span class="ident" id="3281629">x</span><span class="op" id="3281630">)</span>&nbsp;<span class="op" id="3281632">!=</span>&nbsp;<span class="builtinfunc" id="3281635">len</span><span class="op" id="3281638">(</span><span class="ident" id="3281639">y</span><span class="op" id="3281640">)</span>&nbsp;<span class="op" id="3281642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281646">return</span>&nbsp;<span class="builtintype" id="3281653">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281660">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281663">for</span>&nbsp;<span class="ident" id="3281667">i</span><span class="op" id="3281668">,</span>&nbsp;<span class="ident" id="3281670">b</span>&nbsp;<span class="op" id="3281672">:=</span>&nbsp;<span class="keyword" id="3281675">range</span>&nbsp;<span class="ident" id="3281681">x</span>&nbsp;<span class="op" id="3281683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281687">if</span>&nbsp;<span class="ident" id="3281690">y</span><span class="op" id="3281691">[</span><span class="ident" id="3281692">i</span><span class="op" id="3281693">]</span>&nbsp;<span class="op" id="3281695">!=</span>&nbsp;<span class="ident" id="3281698">b</span>&nbsp;<span class="op" id="3281700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281705">return</span>&nbsp;<span class="builtintype" id="3281712">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281723">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281726">return</span>&nbsp;<span class="builtintype" id="3281733">true</span><br>
<span class="lineno"></span><span class="op" id="3281738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3281741">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3281796">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3281828">func</span>&nbsp;<span class="ident" id="3281833">simpleMaskLength</span><span class="op" id="3281849">(</span><span class="ident" id="3281850">mask</span>&nbsp;<span class="ident" id="3281855">IPMask</span><span class="op" id="3281861">)</span>&nbsp;<span class="builtintype" id="3281863">int</span>&nbsp;<span class="op" id="3281867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281870">var</span>&nbsp;<span class="ident" id="3281874">n</span>&nbsp;<span class="builtintype" id="3281876">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281881">for</span>&nbsp;<span class="ident" id="3281885">i</span><span class="op" id="3281886">,</span>&nbsp;<span class="ident" id="3281888">v</span>&nbsp;<span class="op" id="3281890">:=</span>&nbsp;<span class="keyword" id="3281893">range</span>&nbsp;<span class="ident" id="3281899">mask</span>&nbsp;<span class="op" id="3281904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281908">if</span>&nbsp;<span class="ident" id="3281911">v</span>&nbsp;<span class="op" id="3281913">==</span>&nbsp;<span class="num" id="3281916">0xff</span>&nbsp;<span class="op" id="3281921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3281926">n</span>&nbsp;<span class="op" id="3281928">+=</span>&nbsp;<span class="num" id="3281931">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281936">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3281951">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3281974">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3281992">for</span>&nbsp;<span class="ident" id="3281996">v</span><span class="op" id="3281997">&amp;</span><span class="num" id="3281998">0x80</span>&nbsp;<span class="op" id="3282003">!=</span>&nbsp;<span class="num" id="3282006">0</span>&nbsp;<span class="op" id="3282008">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282013">n</span><span class="op" id="3282014">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282020">v</span>&nbsp;<span class="op" id="3282022">&lt;&lt;=</span>&nbsp;<span class="num" id="3282026">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3282034">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282059">if</span>&nbsp;<span class="ident" id="3282062">v</span>&nbsp;<span class="op" id="3282064">!=</span>&nbsp;<span class="num" id="3282067">0</span>&nbsp;<span class="op" id="3282069">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282074">return</span>&nbsp;<span class="op" id="3282081">-</span><span class="num" id="3282082">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282090">for</span>&nbsp;<span class="ident" id="3282094">i</span><span class="op" id="3282095">++</span><span class="op" id="3282097">;</span>&nbsp;<span class="ident" id="3282099">i</span>&nbsp;<span class="op" id="3282101">&lt;</span>&nbsp;<span class="builtinfunc" id="3282103">len</span><span class="op" id="3282106">(</span><span class="ident" id="3282107">mask</span><span class="op" id="3282111">)</span><span class="op" id="3282112">;</span>&nbsp;<span class="ident" id="3282114">i</span><span class="op" id="3282115">++</span>&nbsp;<span class="op" id="3282118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282123">if</span>&nbsp;<span class="ident" id="3282126">mask</span><span class="op" id="3282130">[</span><span class="ident" id="3282131">i</span><span class="op" id="3282132">]</span>&nbsp;<span class="op" id="3282134">!=</span>&nbsp;<span class="num" id="3282137">0</span>&nbsp;<span class="op" id="3282139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282145">return</span>&nbsp;<span class="op" id="3282152">-</span><span class="num" id="3282153">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282166">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282176">return</span>&nbsp;<span class="ident" id="3282183">n</span><br>
<span class="lineno">410</span><span class="op" id="3282185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3282188">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3282259">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3282333">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3282355">func</span>&nbsp;<span class="op" id="3282360">(</span><span class="ident" id="3282361">m</span>&nbsp;<span class="ident" id="3282363">IPMask</span><span class="op" id="3282369">)</span>&nbsp;<span class="ident" id="3282371">Size</span><span class="op" id="3282375">(</span><span class="op" id="3282376">)</span>&nbsp;<span class="op" id="3282378">(</span><span class="ident" id="3282379">ones</span><span class="op" id="3282383">,</span>&nbsp;<span class="ident" id="3282385">bits</span>&nbsp;<span class="builtintype" id="3282390">int</span><span class="op" id="3282393">)</span>&nbsp;<span class="op" id="3282395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282398">ones</span><span class="op" id="3282402">,</span>&nbsp;<span class="ident" id="3282404">bits</span>&nbsp;<span class="op" id="3282409">=</span>&nbsp;<span class="ident" id="3282411">simpleMaskLength</span><span class="op" id="3282427">(</span><span class="ident" id="3282428">m</span><span class="op" id="3282429">)</span><span class="op" id="3282430">,</span>&nbsp;<span class="builtinfunc" id="3282432">len</span><span class="op" id="3282435">(</span><span class="ident" id="3282436">m</span><span class="op" id="3282437">)</span><span class="op" id="3282438">*</span><span class="num" id="3282439">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282442">if</span>&nbsp;<span class="ident" id="3282445">ones</span>&nbsp;<span class="op" id="3282450">==</span>&nbsp;<span class="op" id="3282453">-</span><span class="num" id="3282454">1</span>&nbsp;<span class="op" id="3282456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282460">return</span>&nbsp;<span class="num" id="3282467">0</span><span class="op" id="3282468">,</span>&nbsp;<span class="num" id="3282470">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282473">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282476">return</span><br>
<span class="lineno"></span><span class="op" id="3282483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3282486">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3282552">func</span>&nbsp;<span class="op" id="3282557">(</span><span class="ident" id="3282558">m</span>&nbsp;<span class="ident" id="3282560">IPMask</span><span class="op" id="3282566">)</span>&nbsp;<span class="ident" id="3282568">String</span><span class="op" id="3282574">(</span><span class="op" id="3282575">)</span>&nbsp;<span class="builtintype" id="3282577">string</span>&nbsp;<span class="op" id="3282584">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282587">if</span>&nbsp;<span class="builtinfunc" id="3282590">len</span><span class="op" id="3282593">(</span><span class="ident" id="3282594">m</span><span class="op" id="3282595">)</span>&nbsp;<span class="op" id="3282597">==</span>&nbsp;<span class="num" id="3282600">0</span>&nbsp;<span class="op" id="3282602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282606">return</span>&nbsp;<span class="string" id="3282613">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282625">buf</span>&nbsp;<span class="op" id="3282629">:=</span>&nbsp;<span class="builtinfunc" id="3282632">make</span><span class="op" id="3282636">(</span><span class="op" id="3282637">[</span><span class="op" id="3282638">]</span><span class="builtintype" id="3282639">byte</span><span class="op" id="3282643">,</span>&nbsp;<span class="builtinfunc" id="3282645">len</span><span class="op" id="3282648">(</span><span class="ident" id="3282649">m</span><span class="op" id="3282650">)</span><span class="op" id="3282651">*</span><span class="num" id="3282652">2</span><span class="op" id="3282653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282656">for</span>&nbsp;<span class="ident" id="3282660">i</span><span class="op" id="3282661">,</span>&nbsp;<span class="ident" id="3282663">b</span>&nbsp;<span class="op" id="3282665">:=</span>&nbsp;<span class="keyword" id="3282668">range</span>&nbsp;<span class="ident" id="3282674">m</span>&nbsp;<span class="op" id="3282676">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282680">buf</span><span class="op" id="3282683">[</span><span class="ident" id="3282684">i</span><span class="op" id="3282685">*</span><span class="num" id="3282686">2</span><span class="op" id="3282687">]</span><span class="op" id="3282688">,</span>&nbsp;<span class="ident" id="3282690">buf</span><span class="op" id="3282693">[</span><span class="ident" id="3282694">i</span><span class="op" id="3282695">*</span><span class="num" id="3282696">2</span><span class="op" id="3282697">+</span><span class="num" id="3282698">1</span><span class="op" id="3282699">]</span>&nbsp;<span class="op" id="3282701">=</span>&nbsp;<span class="ident" id="3282703">hexDigit</span><span class="op" id="3282711">[</span><span class="ident" id="3282712">b</span><span class="op" id="3282713">&gt;&gt;</span><span class="num" id="3282715">4</span><span class="op" id="3282716">]</span><span class="op" id="3282717">,</span>&nbsp;<span class="ident" id="3282719">hexDigit</span><span class="op" id="3282727">[</span><span class="ident" id="3282728">b</span><span class="op" id="3282729">&amp;</span><span class="num" id="3282730">0xf</span><span class="op" id="3282733">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282739">return</span>&nbsp;<span class="builtintype" id="3282746">string</span><span class="op" id="3282752">(</span><span class="ident" id="3282753">buf</span><span class="op" id="3282756">)</span><br>
<span class="lineno"></span><span class="op" id="3282758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3282761">func</span>&nbsp;<span class="ident" id="3282766">networkNumberAndMask</span><span class="op" id="3282786">(</span><span class="ident" id="3282787">n</span>&nbsp;<span class="op" id="3282789">*</span><span class="ident" id="3282790">IPNet</span><span class="op" id="3282795">)</span>&nbsp;<span class="op" id="3282797">(</span><span class="ident" id="3282798">ip</span>&nbsp;<span class="ident" id="3282801">IP</span><span class="op" id="3282803">,</span>&nbsp;<span class="ident" id="3282805">m</span>&nbsp;<span class="ident" id="3282807">IPMask</span><span class="op" id="3282813">)</span>&nbsp;<span class="op" id="3282815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282818">if</span>&nbsp;<span class="ident" id="3282821">ip</span>&nbsp;<span class="op" id="3282824">=</span>&nbsp;<span class="ident" id="3282826">n</span><span class="op" id="3282827">.</span><span class="ident" id="3282828">IP</span><span class="op" id="3282830">.</span><span class="ident" id="3282831">To4</span><span class="op" id="3282834">(</span><span class="op" id="3282835">)</span><span class="op" id="3282836">;</span>&nbsp;<span class="ident" id="3282838">ip</span>&nbsp;<span class="op" id="3282841">==</span>&nbsp;<span class="builtintype" id="3282844">nil</span>&nbsp;<span class="op" id="3282848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282852">ip</span>&nbsp;<span class="op" id="3282855">=</span>&nbsp;<span class="ident" id="3282857">n</span><span class="op" id="3282858">.</span><span class="ident" id="3282859">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282864">if</span>&nbsp;<span class="builtinfunc" id="3282867">len</span><span class="op" id="3282870">(</span><span class="ident" id="3282871">ip</span><span class="op" id="3282873">)</span>&nbsp;<span class="op" id="3282875">!=</span>&nbsp;<span class="ident" id="3282878">IPv6len</span>&nbsp;<span class="op" id="3282886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282891">return</span>&nbsp;<span class="builtintype" id="3282898">nil</span><span class="op" id="3282901">,</span>&nbsp;<span class="builtintype" id="3282903">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3282915">m</span>&nbsp;<span class="op" id="3282917">=</span>&nbsp;<span class="ident" id="3282919">n</span><span class="op" id="3282920">.</span><span class="ident" id="3282921">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282927">switch</span>&nbsp;<span class="builtinfunc" id="3282934">len</span><span class="op" id="3282937">(</span><span class="ident" id="3282938">m</span><span class="op" id="3282939">)</span>&nbsp;<span class="op" id="3282941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282944">case</span>&nbsp;<span class="ident" id="3282949">IPv4len</span><span class="op" id="3282956">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282960">if</span>&nbsp;<span class="builtinfunc" id="3282963">len</span><span class="op" id="3282966">(</span><span class="ident" id="3282967">ip</span><span class="op" id="3282969">)</span>&nbsp;<span class="op" id="3282971">!=</span>&nbsp;<span class="ident" id="3282974">IPv4len</span>&nbsp;<span class="op" id="3282982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3282987">return</span>&nbsp;<span class="builtintype" id="3282994">nil</span><span class="op" id="3282997">,</span>&nbsp;<span class="builtintype" id="3282999">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283008">case</span>&nbsp;<span class="ident" id="3283013">IPv6len</span><span class="op" id="3283020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283024">if</span>&nbsp;<span class="builtinfunc" id="3283027">len</span><span class="op" id="3283030">(</span><span class="ident" id="3283031">ip</span><span class="op" id="3283033">)</span>&nbsp;<span class="op" id="3283035">==</span>&nbsp;<span class="ident" id="3283038">IPv4len</span>&nbsp;<span class="op" id="3283046">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283051">m</span>&nbsp;<span class="op" id="3283053">=</span>&nbsp;<span class="ident" id="3283055">m</span><span class="op" id="3283056">[</span><span class="num" id="3283057">12</span><span class="op" id="3283059">:</span><span class="op" id="3283060">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283067">default</span><span class="op" id="3283074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283078">return</span>&nbsp;<span class="builtintype" id="3283085">nil</span><span class="op" id="3283088">,</span>&nbsp;<span class="builtintype" id="3283090">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283095">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283098">return</span><br>
<span class="lineno"></span><span class="op" id="3283105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3283108">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3283161">func</span>&nbsp;<span class="op" id="3283166">(</span><span class="ident" id="3283167">n</span>&nbsp;<span class="op" id="3283169">*</span><span class="ident" id="3283170">IPNet</span><span class="op" id="3283175">)</span>&nbsp;<span class="ident" id="3283177">Contains</span><span class="op" id="3283185">(</span><span class="ident" id="3283186">ip</span>&nbsp;<span class="ident" id="3283189">IP</span><span class="op" id="3283191">)</span>&nbsp;<span class="builtintype" id="3283193">bool</span>&nbsp;<span class="op" id="3283198">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283201">nn</span><span class="op" id="3283203">,</span>&nbsp;<span class="ident" id="3283205">m</span>&nbsp;<span class="op" id="3283207">:=</span>&nbsp;<span class="ident" id="3283210">networkNumberAndMask</span><span class="op" id="3283230">(</span><span class="ident" id="3283231">n</span><span class="op" id="3283232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283235">if</span>&nbsp;<span class="ident" id="3283238">x</span>&nbsp;<span class="op" id="3283240">:=</span>&nbsp;<span class="ident" id="3283243">ip</span><span class="op" id="3283245">.</span><span class="ident" id="3283246">To4</span><span class="op" id="3283249">(</span><span class="op" id="3283250">)</span><span class="op" id="3283251">;</span>&nbsp;<span class="ident" id="3283253">x</span>&nbsp;<span class="op" id="3283255">!=</span>&nbsp;<span class="builtintype" id="3283258">nil</span>&nbsp;<span class="op" id="3283262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283266">ip</span>&nbsp;<span class="op" id="3283269">=</span>&nbsp;<span class="ident" id="3283271">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283277">l</span>&nbsp;<span class="op" id="3283279">:=</span>&nbsp;<span class="builtinfunc" id="3283282">len</span><span class="op" id="3283285">(</span><span class="ident" id="3283286">ip</span><span class="op" id="3283288">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283291">if</span>&nbsp;<span class="ident" id="3283294">l</span>&nbsp;<span class="op" id="3283296">!=</span>&nbsp;<span class="builtinfunc" id="3283299">len</span><span class="op" id="3283302">(</span><span class="ident" id="3283303">nn</span><span class="op" id="3283305">)</span>&nbsp;<span class="op" id="3283307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283311">return</span>&nbsp;<span class="builtintype" id="3283318">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283328">for</span>&nbsp;<span class="ident" id="3283332">i</span>&nbsp;<span class="op" id="3283334">:=</span>&nbsp;<span class="num" id="3283337">0</span><span class="op" id="3283338">;</span>&nbsp;<span class="ident" id="3283340">i</span>&nbsp;<span class="op" id="3283342">&lt;</span>&nbsp;<span class="ident" id="3283344">l</span><span class="op" id="3283345">;</span>&nbsp;<span class="ident" id="3283347">i</span><span class="op" id="3283348">++</span>&nbsp;<span class="op" id="3283351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283355">if</span>&nbsp;<span class="ident" id="3283358">nn</span><span class="op" id="3283360">[</span><span class="ident" id="3283361">i</span><span class="op" id="3283362">]</span><span class="op" id="3283363">&amp;</span><span class="ident" id="3283364">m</span><span class="op" id="3283365">[</span><span class="ident" id="3283366">i</span><span class="op" id="3283367">]</span>&nbsp;<span class="op" id="3283369">!=</span>&nbsp;<span class="ident" id="3283372">ip</span><span class="op" id="3283374">[</span><span class="ident" id="3283375">i</span><span class="op" id="3283376">]</span><span class="op" id="3283377">&amp;</span><span class="ident" id="3283378">m</span><span class="op" id="3283379">[</span><span class="ident" id="3283380">i</span><span class="op" id="3283381">]</span>&nbsp;<span class="op" id="3283383">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283388">return</span>&nbsp;<span class="builtintype" id="3283395">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283409">return</span>&nbsp;<span class="builtintype" id="3283416">true</span><br>
<span class="lineno"></span><span class="op" id="3283421">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3283424">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3283481">func</span>&nbsp;<span class="op" id="3283486">(</span><span class="ident" id="3283487">n</span>&nbsp;<span class="op" id="3283489">*</span><span class="ident" id="3283490">IPNet</span><span class="op" id="3283495">)</span>&nbsp;<span class="ident" id="3283497">Network</span><span class="op" id="3283504">(</span><span class="op" id="3283505">)</span>&nbsp;<span class="builtintype" id="3283507">string</span>&nbsp;<span class="op" id="3283514">{</span>&nbsp;<span class="keyword" id="3283516">return</span>&nbsp;<span class="string" id="3283523">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3283532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3283535">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3283600">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3283659">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3283719">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3283782">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3283844">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3283890">func</span>&nbsp;<span class="op" id="3283895">(</span><span class="ident" id="3283896">n</span>&nbsp;<span class="op" id="3283898">*</span><span class="ident" id="3283899">IPNet</span><span class="op" id="3283904">)</span>&nbsp;<span class="ident" id="3283906">String</span><span class="op" id="3283912">(</span><span class="op" id="3283913">)</span>&nbsp;<span class="builtintype" id="3283915">string</span>&nbsp;<span class="op" id="3283922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283925">nn</span><span class="op" id="3283927">,</span>&nbsp;<span class="ident" id="3283929">m</span>&nbsp;<span class="op" id="3283931">:=</span>&nbsp;<span class="ident" id="3283934">networkNumberAndMask</span><span class="op" id="3283954">(</span><span class="ident" id="3283955">n</span><span class="op" id="3283956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283959">if</span>&nbsp;<span class="ident" id="3283962">nn</span>&nbsp;<span class="op" id="3283965">==</span>&nbsp;<span class="builtintype" id="3283968">nil</span>&nbsp;<span class="op" id="3283972">||</span>&nbsp;<span class="ident" id="3283975">m</span>&nbsp;<span class="op" id="3283977">==</span>&nbsp;<span class="builtintype" id="3283980">nil</span>&nbsp;<span class="op" id="3283984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3283988">return</span>&nbsp;<span class="string" id="3283995">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284004">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284007">l</span>&nbsp;<span class="op" id="3284009">:=</span>&nbsp;<span class="ident" id="3284012">simpleMaskLength</span><span class="op" id="3284028">(</span><span class="ident" id="3284029">m</span><span class="op" id="3284030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284033">if</span>&nbsp;<span class="ident" id="3284036">l</span>&nbsp;<span class="op" id="3284038">==</span>&nbsp;<span class="op" id="3284041">-</span><span class="num" id="3284042">1</span>&nbsp;<span class="op" id="3284044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284048">return</span>&nbsp;<span class="ident" id="3284055">nn</span><span class="op" id="3284057">.</span><span class="ident" id="3284058">String</span><span class="op" id="3284064">(</span><span class="op" id="3284065">)</span>&nbsp;<span class="op" id="3284067">+</span>&nbsp;<span class="string" id="3284069">&#34;/&#34;</span>&nbsp;<span class="op" id="3284073">+</span>&nbsp;<span class="ident" id="3284075">m</span><span class="op" id="3284076">.</span><span class="ident" id="3284077">String</span><span class="op" id="3284083">(</span><span class="op" id="3284084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284090">return</span>&nbsp;<span class="ident" id="3284097">nn</span><span class="op" id="3284099">.</span><span class="ident" id="3284100">String</span><span class="op" id="3284106">(</span><span class="op" id="3284107">)</span>&nbsp;<span class="op" id="3284109">+</span>&nbsp;<span class="string" id="3284111">&#34;/&#34;</span>&nbsp;<span class="op" id="3284115">+</span>&nbsp;<span class="ident" id="3284117">itod</span><span class="op" id="3284121">(</span><span class="builtintype" id="3284122">uint</span><span class="op" id="3284126">(</span><span class="ident" id="3284127">l</span><span class="op" id="3284128">)</span><span class="op" id="3284129">)</span><br>
<span class="lineno">495</span><span class="op" id="3284131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3284134">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3284167">func</span>&nbsp;<span class="ident" id="3284172">parseIPv4</span><span class="op" id="3284181">(</span><span class="ident" id="3284182">s</span>&nbsp;<span class="builtintype" id="3284184">string</span><span class="op" id="3284190">)</span>&nbsp;<span class="ident" id="3284192">IP</span>&nbsp;<span class="op" id="3284195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284198">var</span>&nbsp;<span class="ident" id="3284202">p</span>&nbsp;<span class="op" id="3284204">[</span><span class="ident" id="3284205">IPv4len</span><span class="op" id="3284212">]</span><span class="builtintype" id="3284213">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284219">i</span>&nbsp;<span class="op" id="3284221">:=</span>&nbsp;<span class="num" id="3284224">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284227">for</span>&nbsp;<span class="ident" id="3284231">j</span>&nbsp;<span class="op" id="3284233">:=</span>&nbsp;<span class="num" id="3284236">0</span><span class="op" id="3284237">;</span>&nbsp;<span class="ident" id="3284239">j</span>&nbsp;<span class="op" id="3284241">&lt;</span>&nbsp;<span class="ident" id="3284243">IPv4len</span><span class="op" id="3284250">;</span>&nbsp;<span class="ident" id="3284252">j</span><span class="op" id="3284253">++</span>&nbsp;<span class="op" id="3284256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284260">if</span>&nbsp;<span class="ident" id="3284263">i</span>&nbsp;<span class="op" id="3284265">&gt;=</span>&nbsp;<span class="builtinfunc" id="3284268">len</span><span class="op" id="3284271">(</span><span class="ident" id="3284272">s</span><span class="op" id="3284273">)</span>&nbsp;<span class="op" id="3284275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3284280">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284302">return</span>&nbsp;<span class="builtintype" id="3284309">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284319">if</span>&nbsp;<span class="ident" id="3284322">j</span>&nbsp;<span class="op" id="3284324">&gt;</span>&nbsp;<span class="num" id="3284326">0</span>&nbsp;<span class="op" id="3284328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284333">if</span>&nbsp;<span class="ident" id="3284336">s</span><span class="op" id="3284337">[</span><span class="ident" id="3284338">i</span><span class="op" id="3284339">]</span>&nbsp;<span class="op" id="3284341">!=</span>&nbsp;<span class="string" id="3284344">&#39;.&#39;</span>&nbsp;<span class="op" id="3284348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284354">return</span>&nbsp;<span class="builtintype" id="3284361">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284368">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284373">i</span><span class="op" id="3284374">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284383">var</span>&nbsp;<span class="op" id="3284387">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284392">n</span>&nbsp;&nbsp;<span class="builtintype" id="3284395">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284402">ok</span>&nbsp;<span class="builtintype" id="3284405">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284416">n</span><span class="op" id="3284417">,</span>&nbsp;<span class="ident" id="3284419">i</span><span class="op" id="3284420">,</span>&nbsp;<span class="ident" id="3284422">ok</span>&nbsp;<span class="op" id="3284425">=</span>&nbsp;<span class="ident" id="3284427">dtoi</span><span class="op" id="3284431">(</span><span class="ident" id="3284432">s</span><span class="op" id="3284433">,</span>&nbsp;<span class="ident" id="3284435">i</span><span class="op" id="3284436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284440">if</span>&nbsp;<span class="op" id="3284443">!</span><span class="ident" id="3284444">ok</span>&nbsp;<span class="op" id="3284447">||</span>&nbsp;<span class="ident" id="3284450">n</span>&nbsp;<span class="op" id="3284452">&gt;</span>&nbsp;<span class="num" id="3284454">0xFF</span>&nbsp;<span class="op" id="3284459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284464">return</span>&nbsp;<span class="builtintype" id="3284471">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284477">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284481">p</span><span class="op" id="3284482">[</span><span class="ident" id="3284483">j</span><span class="op" id="3284484">]</span>&nbsp;<span class="op" id="3284486">=</span>&nbsp;<span class="builtintype" id="3284488">byte</span><span class="op" id="3284492">(</span><span class="ident" id="3284493">n</span><span class="op" id="3284494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284500">if</span>&nbsp;<span class="ident" id="3284503">i</span>&nbsp;<span class="op" id="3284505">!=</span>&nbsp;<span class="builtinfunc" id="3284508">len</span><span class="op" id="3284511">(</span><span class="ident" id="3284512">s</span><span class="op" id="3284513">)</span>&nbsp;<span class="op" id="3284515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284519">return</span>&nbsp;<span class="builtintype" id="3284526">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284531">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284534">return</span>&nbsp;<span class="ident" id="3284541">IPv4</span><span class="op" id="3284545">(</span><span class="ident" id="3284546">p</span><span class="op" id="3284547">[</span><span class="num" id="3284548">0</span><span class="op" id="3284549">]</span><span class="op" id="3284550">,</span>&nbsp;<span class="ident" id="3284552">p</span><span class="op" id="3284553">[</span><span class="num" id="3284554">1</span><span class="op" id="3284555">]</span><span class="op" id="3284556">,</span>&nbsp;<span class="ident" id="3284558">p</span><span class="op" id="3284559">[</span><span class="num" id="3284560">2</span><span class="op" id="3284561">]</span><span class="op" id="3284562">,</span>&nbsp;<span class="ident" id="3284564">p</span><span class="op" id="3284565">[</span><span class="num" id="3284566">3</span><span class="op" id="3284567">]</span><span class="op" id="3284568">)</span><br>
<span class="lineno"></span><span class="op" id="3284570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3284573">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3284643">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3284714">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3284784">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3284793">func</span>&nbsp;<span class="ident" id="3284798">parseIPv6</span><span class="op" id="3284807">(</span><span class="ident" id="3284808">s</span>&nbsp;<span class="builtintype" id="3284810">string</span><span class="op" id="3284816">,</span>&nbsp;<span class="ident" id="3284818">zoneAllowed</span>&nbsp;<span class="builtintype" id="3284830">bool</span><span class="op" id="3284834">)</span>&nbsp;<span class="op" id="3284836">(</span><span class="ident" id="3284837">ip</span>&nbsp;<span class="ident" id="3284840">IP</span><span class="op" id="3284842">,</span>&nbsp;<span class="ident" id="3284844">zone</span>&nbsp;<span class="builtintype" id="3284849">string</span><span class="op" id="3284855">)</span>&nbsp;<span class="op" id="3284857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284860">ip</span>&nbsp;<span class="op" id="3284863">=</span>&nbsp;<span class="builtinfunc" id="3284865">make</span><span class="op" id="3284869">(</span><span class="ident" id="3284870">IP</span><span class="op" id="3284872">,</span>&nbsp;<span class="ident" id="3284874">IPv6len</span><span class="op" id="3284881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284884">ellipsis</span>&nbsp;<span class="op" id="3284893">:=</span>&nbsp;<span class="op" id="3284896">-</span><span class="num" id="3284897">1</span>&nbsp;<span class="comment" id="3284899">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284929">i</span>&nbsp;<span class="op" id="3284931">:=</span>&nbsp;<span class="num" id="3284934">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3284944">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284967">if</span>&nbsp;<span class="ident" id="3284970">zoneAllowed</span>&nbsp;<span class="op" id="3284982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284986">s</span><span class="op" id="3284987">,</span>&nbsp;<span class="ident" id="3284989">zone</span>&nbsp;<span class="op" id="3284994">=</span>&nbsp;<span class="ident" id="3284996">splitHostZone</span><span class="op" id="3285009">(</span><span class="ident" id="3285010">s</span><span class="op" id="3285011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285014">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285018">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285050">if</span>&nbsp;<span class="builtinfunc" id="3285053">len</span><span class="op" id="3285056">(</span><span class="ident" id="3285057">s</span><span class="op" id="3285058">)</span>&nbsp;<span class="op" id="3285060">&gt;=</span>&nbsp;<span class="num" id="3285063">2</span>&nbsp;<span class="op" id="3285065">&amp;&amp;</span>&nbsp;<span class="ident" id="3285068">s</span><span class="op" id="3285069">[</span><span class="num" id="3285070">0</span><span class="op" id="3285071">]</span>&nbsp;<span class="op" id="3285073">==</span>&nbsp;<span class="string" id="3285076">&#39;:&#39;</span>&nbsp;<span class="op" id="3285080">&amp;&amp;</span>&nbsp;<span class="ident" id="3285083">s</span><span class="op" id="3285084">[</span><span class="num" id="3285085">1</span><span class="op" id="3285086">]</span>&nbsp;<span class="op" id="3285088">==</span>&nbsp;<span class="string" id="3285091">&#39;:&#39;</span>&nbsp;<span class="op" id="3285095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285099">ellipsis</span>&nbsp;<span class="op" id="3285108">=</span>&nbsp;<span class="num" id="3285110">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285114">i</span>&nbsp;<span class="op" id="3285116">=</span>&nbsp;<span class="num" id="3285118">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285122">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285150">if</span>&nbsp;<span class="ident" id="3285153">i</span>&nbsp;<span class="op" id="3285155">==</span>&nbsp;<span class="builtinfunc" id="3285158">len</span><span class="op" id="3285161">(</span><span class="ident" id="3285162">s</span><span class="op" id="3285163">)</span>&nbsp;<span class="op" id="3285165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285170">return</span>&nbsp;<span class="ident" id="3285177">ip</span><span class="op" id="3285179">,</span>&nbsp;<span class="ident" id="3285181">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285191">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285195">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285244">j</span>&nbsp;<span class="op" id="3285246">:=</span>&nbsp;<span class="num" id="3285249">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285252">for</span>&nbsp;<span class="ident" id="3285256">j</span>&nbsp;<span class="op" id="3285258">&lt;</span>&nbsp;<span class="ident" id="3285260">IPv6len</span>&nbsp;<span class="op" id="3285268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285272">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285289">n</span><span class="op" id="3285290">,</span>&nbsp;<span class="ident" id="3285292">i1</span><span class="op" id="3285294">,</span>&nbsp;<span class="ident" id="3285296">ok</span>&nbsp;<span class="op" id="3285299">:=</span>&nbsp;<span class="ident" id="3285302">xtoi</span><span class="op" id="3285306">(</span><span class="ident" id="3285307">s</span><span class="op" id="3285308">,</span>&nbsp;<span class="ident" id="3285310">i</span><span class="op" id="3285311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285315">if</span>&nbsp;<span class="op" id="3285318">!</span><span class="ident" id="3285319">ok</span>&nbsp;<span class="op" id="3285322">||</span>&nbsp;<span class="ident" id="3285325">n</span>&nbsp;<span class="op" id="3285327">&gt;</span>&nbsp;<span class="num" id="3285329">0xFFFF</span>&nbsp;<span class="op" id="3285336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285341">return</span>&nbsp;<span class="builtintype" id="3285348">nil</span><span class="op" id="3285351">,</span>&nbsp;<span class="ident" id="3285353">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285365">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285417">if</span>&nbsp;<span class="ident" id="3285420">i1</span>&nbsp;<span class="op" id="3285423">&lt;</span>&nbsp;<span class="builtinfunc" id="3285425">len</span><span class="op" id="3285428">(</span><span class="ident" id="3285429">s</span><span class="op" id="3285430">)</span>&nbsp;<span class="op" id="3285432">&amp;&amp;</span>&nbsp;<span class="ident" id="3285435">s</span><span class="op" id="3285436">[</span><span class="ident" id="3285437">i1</span><span class="op" id="3285439">]</span>&nbsp;<span class="op" id="3285441">==</span>&nbsp;<span class="string" id="3285444">&#39;.&#39;</span>&nbsp;<span class="op" id="3285448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285453">if</span>&nbsp;<span class="ident" id="3285456">ellipsis</span>&nbsp;<span class="op" id="3285465">&lt;</span>&nbsp;<span class="num" id="3285467">0</span>&nbsp;<span class="op" id="3285469">&amp;&amp;</span>&nbsp;<span class="ident" id="3285472">j</span>&nbsp;<span class="op" id="3285474">!=</span>&nbsp;<span class="ident" id="3285477">IPv6len</span><span class="op" id="3285484">-</span><span class="ident" id="3285485">IPv4len</span>&nbsp;<span class="op" id="3285493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285499">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285527">return</span>&nbsp;<span class="builtintype" id="3285534">nil</span><span class="op" id="3285537">,</span>&nbsp;<span class="ident" id="3285539">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285552">if</span>&nbsp;<span class="ident" id="3285555">j</span><span class="op" id="3285556">+</span><span class="ident" id="3285557">IPv4len</span>&nbsp;<span class="op" id="3285565">&gt;</span>&nbsp;<span class="ident" id="3285567">IPv6len</span>&nbsp;<span class="op" id="3285575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285581">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285605">return</span>&nbsp;<span class="builtintype" id="3285612">nil</span><span class="op" id="3285615">,</span>&nbsp;<span class="ident" id="3285617">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285625">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285630">ip4</span>&nbsp;<span class="op" id="3285634">:=</span>&nbsp;<span class="ident" id="3285637">parseIPv4</span><span class="op" id="3285646">(</span><span class="ident" id="3285647">s</span><span class="op" id="3285648">[</span><span class="ident" id="3285649">i</span><span class="op" id="3285650">:</span><span class="op" id="3285651">]</span><span class="op" id="3285652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285657">if</span>&nbsp;<span class="ident" id="3285660">ip4</span>&nbsp;<span class="op" id="3285664">==</span>&nbsp;<span class="builtintype" id="3285667">nil</span>&nbsp;<span class="op" id="3285671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285677">return</span>&nbsp;<span class="builtintype" id="3285684">nil</span><span class="op" id="3285687">,</span>&nbsp;<span class="ident" id="3285689">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285702">ip</span><span class="op" id="3285704">[</span><span class="ident" id="3285705">j</span><span class="op" id="3285706">]</span>&nbsp;<span class="op" id="3285708">=</span>&nbsp;<span class="ident" id="3285710">ip4</span><span class="op" id="3285713">[</span><span class="num" id="3285714">12</span><span class="op" id="3285716">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285721">ip</span><span class="op" id="3285723">[</span><span class="ident" id="3285724">j</span><span class="op" id="3285725">+</span><span class="num" id="3285726">1</span><span class="op" id="3285727">]</span>&nbsp;<span class="op" id="3285729">=</span>&nbsp;<span class="ident" id="3285731">ip4</span><span class="op" id="3285734">[</span><span class="num" id="3285735">13</span><span class="op" id="3285737">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285742">ip</span><span class="op" id="3285744">[</span><span class="ident" id="3285745">j</span><span class="op" id="3285746">+</span><span class="num" id="3285747">2</span><span class="op" id="3285748">]</span>&nbsp;<span class="op" id="3285750">=</span>&nbsp;<span class="ident" id="3285752">ip4</span><span class="op" id="3285755">[</span><span class="num" id="3285756">14</span><span class="op" id="3285758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285763">ip</span><span class="op" id="3285765">[</span><span class="ident" id="3285766">j</span><span class="op" id="3285767">+</span><span class="num" id="3285768">3</span><span class="op" id="3285769">]</span>&nbsp;<span class="op" id="3285771">=</span>&nbsp;<span class="ident" id="3285773">ip4</span><span class="op" id="3285776">[</span><span class="num" id="3285777">15</span><span class="op" id="3285779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285784">i</span>&nbsp;<span class="op" id="3285786">=</span>&nbsp;<span class="builtinfunc" id="3285788">len</span><span class="op" id="3285791">(</span><span class="ident" id="3285792">s</span><span class="op" id="3285793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285798">j</span>&nbsp;<span class="op" id="3285800">+=</span>&nbsp;<span class="ident" id="3285803">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285814">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285827">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285856">ip</span><span class="op" id="3285858">[</span><span class="ident" id="3285859">j</span><span class="op" id="3285860">]</span>&nbsp;<span class="op" id="3285862">=</span>&nbsp;<span class="builtintype" id="3285864">byte</span><span class="op" id="3285868">(</span><span class="ident" id="3285869">n</span>&nbsp;<span class="op" id="3285871">&gt;&gt;</span>&nbsp;<span class="num" id="3285874">8</span><span class="op" id="3285875">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285879">ip</span><span class="op" id="3285881">[</span><span class="ident" id="3285882">j</span><span class="op" id="3285883">+</span><span class="num" id="3285884">1</span><span class="op" id="3285885">]</span>&nbsp;<span class="op" id="3285887">=</span>&nbsp;<span class="builtintype" id="3285889">byte</span><span class="op" id="3285893">(</span><span class="ident" id="3285894">n</span><span class="op" id="3285895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285899">j</span>&nbsp;<span class="op" id="3285901">+=</span>&nbsp;<span class="num" id="3285904">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285909">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3285937">i</span>&nbsp;<span class="op" id="3285939">=</span>&nbsp;<span class="ident" id="3285941">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285946">if</span>&nbsp;<span class="ident" id="3285949">i</span>&nbsp;<span class="op" id="3285951">==</span>&nbsp;<span class="builtinfunc" id="3285954">len</span><span class="op" id="3285957">(</span><span class="ident" id="3285958">s</span><span class="op" id="3285959">)</span>&nbsp;<span class="op" id="3285961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3285966">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3285979">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286030">if</span>&nbsp;<span class="ident" id="3286033">s</span><span class="op" id="3286034">[</span><span class="ident" id="3286035">i</span><span class="op" id="3286036">]</span>&nbsp;<span class="op" id="3286038">!=</span>&nbsp;<span class="string" id="3286041">&#39;:&#39;</span>&nbsp;<span class="op" id="3286045">||</span>&nbsp;<span class="ident" id="3286048">i</span><span class="op" id="3286049">+</span><span class="num" id="3286050">1</span>&nbsp;<span class="op" id="3286052">==</span>&nbsp;<span class="builtinfunc" id="3286055">len</span><span class="op" id="3286058">(</span><span class="ident" id="3286059">s</span><span class="op" id="3286060">)</span>&nbsp;<span class="op" id="3286062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286067">return</span>&nbsp;<span class="builtintype" id="3286074">nil</span><span class="op" id="3286077">,</span>&nbsp;<span class="ident" id="3286079">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286090">i</span><span class="op" id="3286091">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3286097">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286121">if</span>&nbsp;<span class="ident" id="3286124">s</span><span class="op" id="3286125">[</span><span class="ident" id="3286126">i</span><span class="op" id="3286127">]</span>&nbsp;<span class="op" id="3286129">==</span>&nbsp;<span class="string" id="3286132">&#39;:&#39;</span>&nbsp;<span class="op" id="3286136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286141">if</span>&nbsp;<span class="ident" id="3286144">ellipsis</span>&nbsp;<span class="op" id="3286153">&gt;=</span>&nbsp;<span class="num" id="3286156">0</span>&nbsp;<span class="op" id="3286158">{</span>&nbsp;<span class="comment" id="3286160">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286184">return</span>&nbsp;<span class="builtintype" id="3286191">nil</span><span class="op" id="3286194">,</span>&nbsp;<span class="ident" id="3286196">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286204">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286209">ellipsis</span>&nbsp;<span class="op" id="3286218">=</span>&nbsp;<span class="ident" id="3286220">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286225">if</span>&nbsp;<span class="ident" id="3286228">i</span><span class="op" id="3286229">++</span><span class="op" id="3286231">;</span>&nbsp;<span class="ident" id="3286233">i</span>&nbsp;<span class="op" id="3286235">==</span>&nbsp;<span class="builtinfunc" id="3286238">len</span><span class="op" id="3286241">(</span><span class="ident" id="3286242">s</span><span class="op" id="3286243">)</span>&nbsp;<span class="op" id="3286245">{</span>&nbsp;<span class="comment" id="3286247">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286268">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286281">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3286288">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286322">if</span>&nbsp;<span class="ident" id="3286325">i</span>&nbsp;<span class="op" id="3286327">!=</span>&nbsp;<span class="builtinfunc" id="3286330">len</span><span class="op" id="3286333">(</span><span class="ident" id="3286334">s</span><span class="op" id="3286335">)</span>&nbsp;<span class="op" id="3286337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286341">return</span>&nbsp;<span class="builtintype" id="3286348">nil</span><span class="op" id="3286351">,</span>&nbsp;<span class="ident" id="3286353">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3286363">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286408">if</span>&nbsp;<span class="ident" id="3286411">j</span>&nbsp;<span class="op" id="3286413">&lt;</span>&nbsp;<span class="ident" id="3286415">IPv6len</span>&nbsp;<span class="op" id="3286423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286427">if</span>&nbsp;<span class="ident" id="3286430">ellipsis</span>&nbsp;<span class="op" id="3286439">&lt;</span>&nbsp;<span class="num" id="3286441">0</span>&nbsp;<span class="op" id="3286443">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286448">return</span>&nbsp;<span class="builtintype" id="3286455">nil</span><span class="op" id="3286458">,</span>&nbsp;<span class="ident" id="3286460">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286471">n</span>&nbsp;<span class="op" id="3286473">:=</span>&nbsp;<span class="ident" id="3286476">IPv6len</span>&nbsp;<span class="op" id="3286484">-</span>&nbsp;<span class="ident" id="3286486">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286490">for</span>&nbsp;<span class="ident" id="3286494">k</span>&nbsp;<span class="op" id="3286496">:=</span>&nbsp;<span class="ident" id="3286499">j</span>&nbsp;<span class="op" id="3286501">-</span>&nbsp;<span class="num" id="3286503">1</span><span class="op" id="3286504">;</span>&nbsp;<span class="ident" id="3286506">k</span>&nbsp;<span class="op" id="3286508">&gt;=</span>&nbsp;<span class="ident" id="3286511">ellipsis</span><span class="op" id="3286519">;</span>&nbsp;<span class="ident" id="3286521">k</span><span class="op" id="3286522">--</span>&nbsp;<span class="op" id="3286525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286530">ip</span><span class="op" id="3286532">[</span><span class="ident" id="3286533">k</span><span class="op" id="3286534">+</span><span class="ident" id="3286535">n</span><span class="op" id="3286536">]</span>&nbsp;<span class="op" id="3286538">=</span>&nbsp;<span class="ident" id="3286540">ip</span><span class="op" id="3286542">[</span><span class="ident" id="3286543">k</span><span class="op" id="3286544">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286552">for</span>&nbsp;<span class="ident" id="3286556">k</span>&nbsp;<span class="op" id="3286558">:=</span>&nbsp;<span class="ident" id="3286561">ellipsis</span>&nbsp;<span class="op" id="3286570">+</span>&nbsp;<span class="ident" id="3286572">n</span>&nbsp;<span class="op" id="3286574">-</span>&nbsp;<span class="num" id="3286576">1</span><span class="op" id="3286577">;</span>&nbsp;<span class="ident" id="3286579">k</span>&nbsp;<span class="op" id="3286581">&gt;=</span>&nbsp;<span class="ident" id="3286584">ellipsis</span><span class="op" id="3286592">;</span>&nbsp;<span class="ident" id="3286594">k</span><span class="op" id="3286595">--</span>&nbsp;<span class="op" id="3286598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286603">ip</span><span class="op" id="3286605">[</span><span class="ident" id="3286606">k</span><span class="op" id="3286607">]</span>&nbsp;<span class="op" id="3286609">=</span>&nbsp;<span class="num" id="3286611">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286618">}</span>&nbsp;<span class="keyword" id="3286620">else</span>&nbsp;<span class="keyword" id="3286625">if</span>&nbsp;<span class="ident" id="3286628">ellipsis</span>&nbsp;<span class="op" id="3286637">&gt;=</span>&nbsp;<span class="num" id="3286640">0</span>&nbsp;<span class="op" id="3286642">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3286646">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286697">return</span>&nbsp;<span class="builtintype" id="3286704">nil</span><span class="op" id="3286707">,</span>&nbsp;<span class="ident" id="3286709">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286718">return</span>&nbsp;<span class="ident" id="3286725">ip</span><span class="op" id="3286727">,</span>&nbsp;<span class="ident" id="3286729">zone</span><br>
<span class="lineno"></span><span class="op" id="3286734">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3286737">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3286830">type</span>&nbsp;<span class="ident" id="3286835">ParseError</span>&nbsp;<span class="keyword" id="3286846">struct</span>&nbsp;<span class="op" id="3286853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286856">Type</span>&nbsp;<span class="builtintype" id="3286861">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3286869">Text</span>&nbsp;<span class="builtintype" id="3286874">string</span><br>
<span class="lineno">640</span><span class="op" id="3286881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3286884">func</span>&nbsp;<span class="op" id="3286889">(</span><span class="ident" id="3286890">e</span>&nbsp;<span class="op" id="3286892">*</span><span class="ident" id="3286893">ParseError</span><span class="op" id="3286903">)</span>&nbsp;<span class="ident" id="3286905">Error</span><span class="op" id="3286910">(</span><span class="op" id="3286911">)</span>&nbsp;<span class="builtintype" id="3286913">string</span>&nbsp;<span class="op" id="3286920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3286923">return</span>&nbsp;<span class="string" id="3286930">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3286941">+</span>&nbsp;<span class="ident" id="3286943">e</span><span class="op" id="3286944">.</span><span class="ident" id="3286945">Type</span>&nbsp;<span class="op" id="3286950">+</span>&nbsp;<span class="string" id="3286952">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3286957">+</span>&nbsp;<span class="ident" id="3286959">e</span><span class="op" id="3286960">.</span><span class="ident" id="3286961">Text</span><br>
<span class="lineno"></span><span class="op" id="3286966">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3286969">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3287029">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3287087">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3287129">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3287193">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3287217">func</span>&nbsp;<span class="ident" id="3287222">ParseIP</span><span class="op" id="3287229">(</span><span class="ident" id="3287230">s</span>&nbsp;<span class="builtintype" id="3287232">string</span><span class="op" id="3287238">)</span>&nbsp;<span class="ident" id="3287240">IP</span>&nbsp;<span class="op" id="3287243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287246">for</span>&nbsp;<span class="ident" id="3287250">i</span>&nbsp;<span class="op" id="3287252">:=</span>&nbsp;<span class="num" id="3287255">0</span><span class="op" id="3287256">;</span>&nbsp;<span class="ident" id="3287258">i</span>&nbsp;<span class="op" id="3287260">&lt;</span>&nbsp;<span class="builtinfunc" id="3287262">len</span><span class="op" id="3287265">(</span><span class="ident" id="3287266">s</span><span class="op" id="3287267">)</span><span class="op" id="3287268">;</span>&nbsp;<span class="ident" id="3287270">i</span><span class="op" id="3287271">++</span>&nbsp;<span class="op" id="3287274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287278">switch</span>&nbsp;<span class="ident" id="3287285">s</span><span class="op" id="3287286">[</span><span class="ident" id="3287287">i</span><span class="op" id="3287288">]</span>&nbsp;<span class="op" id="3287290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287294">case</span>&nbsp;<span class="string" id="3287299">&#39;.&#39;</span><span class="op" id="3287302">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287307">return</span>&nbsp;<span class="ident" id="3287314">parseIPv4</span><span class="op" id="3287323">(</span><span class="ident" id="3287324">s</span><span class="op" id="3287325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287329">case</span>&nbsp;<span class="string" id="3287334">&#39;:&#39;</span><span class="op" id="3287337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287342">ip</span><span class="op" id="3287344">,</span>&nbsp;<span class="ident" id="3287346">_</span>&nbsp;<span class="op" id="3287348">:=</span>&nbsp;<span class="ident" id="3287351">parseIPv6</span><span class="op" id="3287360">(</span><span class="ident" id="3287361">s</span><span class="op" id="3287362">,</span>&nbsp;<span class="builtintype" id="3287364">false</span><span class="op" id="3287369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287374">return</span>&nbsp;<span class="ident" id="3287381">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3287386">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3287389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287392">return</span>&nbsp;<span class="builtintype" id="3287399">nil</span><br>
<span class="lineno"></span><span class="op" id="3287403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3287406">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3287468">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3287529">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3287555">//</span><br>
<span class="lineno"></span><span class="comment" id="3287558">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3287621">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3287686">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3287750">func</span>&nbsp;<span class="ident" id="3287755">ParseCIDR</span><span class="op" id="3287764">(</span><span class="ident" id="3287765">s</span>&nbsp;<span class="builtintype" id="3287767">string</span><span class="op" id="3287773">)</span>&nbsp;<span class="op" id="3287775">(</span><span class="ident" id="3287776">IP</span><span class="op" id="3287778">,</span>&nbsp;<span class="op" id="3287780">*</span><span class="ident" id="3287781">IPNet</span><span class="op" id="3287786">,</span>&nbsp;<span class="builtintype" id="3287788">error</span><span class="op" id="3287793">)</span>&nbsp;<span class="op" id="3287795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287798">i</span>&nbsp;<span class="op" id="3287800">:=</span>&nbsp;<span class="ident" id="3287803">byteIndex</span><span class="op" id="3287812">(</span><span class="ident" id="3287813">s</span><span class="op" id="3287814">,</span>&nbsp;<span class="string" id="3287816">&#39;/&#39;</span><span class="op" id="3287819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287822">if</span>&nbsp;<span class="ident" id="3287825">i</span>&nbsp;<span class="op" id="3287827">&lt;</span>&nbsp;<span class="num" id="3287829">0</span>&nbsp;<span class="op" id="3287831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287835">return</span>&nbsp;<span class="builtintype" id="3287842">nil</span><span class="op" id="3287845">,</span>&nbsp;<span class="builtintype" id="3287847">nil</span><span class="op" id="3287850">,</span>&nbsp;<span class="op" id="3287852">&amp;</span><span class="ident" id="3287853">ParseError</span><span class="op" id="3287863">{</span><span class="string" id="3287864">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3287878">,</span>&nbsp;<span class="ident" id="3287880">s</span><span class="op" id="3287881">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3287884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287887">addr</span><span class="op" id="3287891">,</span>&nbsp;<span class="ident" id="3287893">mask</span>&nbsp;<span class="op" id="3287898">:=</span>&nbsp;<span class="ident" id="3287901">s</span><span class="op" id="3287902">[</span><span class="op" id="3287903">:</span><span class="ident" id="3287904">i</span><span class="op" id="3287905">]</span><span class="op" id="3287906">,</span>&nbsp;<span class="ident" id="3287908">s</span><span class="op" id="3287909">[</span><span class="ident" id="3287910">i</span><span class="op" id="3287911">+</span><span class="num" id="3287912">1</span><span class="op" id="3287913">:</span><span class="op" id="3287914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287917">iplen</span>&nbsp;<span class="op" id="3287923">:=</span>&nbsp;<span class="ident" id="3287926">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287935">ip</span>&nbsp;<span class="op" id="3287938">:=</span>&nbsp;<span class="ident" id="3287941">parseIPv4</span><span class="op" id="3287950">(</span><span class="ident" id="3287951">addr</span><span class="op" id="3287955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3287958">if</span>&nbsp;<span class="ident" id="3287961">ip</span>&nbsp;<span class="op" id="3287964">==</span>&nbsp;<span class="builtintype" id="3287967">nil</span>&nbsp;<span class="op" id="3287971">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287975">iplen</span>&nbsp;<span class="op" id="3287981">=</span>&nbsp;<span class="ident" id="3287983">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3287993">ip</span><span class="op" id="3287995">,</span>&nbsp;<span class="ident" id="3287997">_</span>&nbsp;<span class="op" id="3287999">=</span>&nbsp;<span class="ident" id="3288001">parseIPv6</span><span class="op" id="3288010">(</span><span class="ident" id="3288011">addr</span><span class="op" id="3288015">,</span>&nbsp;<span class="builtintype" id="3288017">false</span><span class="op" id="3288022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3288025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3288028">n</span><span class="op" id="3288029">,</span>&nbsp;<span class="ident" id="3288031">i</span><span class="op" id="3288032">,</span>&nbsp;<span class="ident" id="3288034">ok</span>&nbsp;<span class="op" id="3288037">:=</span>&nbsp;<span class="ident" id="3288040">dtoi</span><span class="op" id="3288044">(</span><span class="ident" id="3288045">mask</span><span class="op" id="3288049">,</span>&nbsp;<span class="num" id="3288051">0</span><span class="op" id="3288052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3288055">if</span>&nbsp;<span class="ident" id="3288058">ip</span>&nbsp;<span class="op" id="3288061">==</span>&nbsp;<span class="builtintype" id="3288064">nil</span>&nbsp;<span class="op" id="3288068">||</span>&nbsp;<span class="op" id="3288071">!</span><span class="ident" id="3288072">ok</span>&nbsp;<span class="op" id="3288075">||</span>&nbsp;<span class="ident" id="3288078">i</span>&nbsp;<span class="op" id="3288080">!=</span>&nbsp;<span class="builtinfunc" id="3288083">len</span><span class="op" id="3288086">(</span><span class="ident" id="3288087">mask</span><span class="op" id="3288091">)</span>&nbsp;<span class="op" id="3288093">||</span>&nbsp;<span class="ident" id="3288096">n</span>&nbsp;<span class="op" id="3288098">&lt;</span>&nbsp;<span class="num" id="3288100">0</span>&nbsp;<span class="op" id="3288102">||</span>&nbsp;<span class="ident" id="3288105">n</span>&nbsp;<span class="op" id="3288107">&gt;</span>&nbsp;<span class="num" id="3288109">8</span><span class="op" id="3288110">*</span><span class="ident" id="3288111">iplen</span>&nbsp;<span class="op" id="3288117">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3288121">return</span>&nbsp;<span class="builtintype" id="3288128">nil</span><span class="op" id="3288131">,</span>&nbsp;<span class="builtintype" id="3288133">nil</span><span class="op" id="3288136">,</span>&nbsp;<span class="op" id="3288138">&amp;</span><span class="ident" id="3288139">ParseError</span><span class="op" id="3288149">{</span><span class="string" id="3288150">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3288164">,</span>&nbsp;<span class="ident" id="3288166">s</span><span class="op" id="3288167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3288170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3288173">m</span>&nbsp;<span class="op" id="3288175">:=</span>&nbsp;<span class="ident" id="3288178">CIDRMask</span><span class="op" id="3288186">(</span><span class="ident" id="3288187">n</span><span class="op" id="3288188">,</span>&nbsp;<span class="num" id="3288190">8</span><span class="op" id="3288191">*</span><span class="ident" id="3288192">iplen</span><span class="op" id="3288197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3288200">return</span>&nbsp;<span class="ident" id="3288207">ip</span><span class="op" id="3288209">,</span>&nbsp;<span class="op" id="3288211">&amp;</span><span class="ident" id="3288212">IPNet</span><span class="op" id="3288217">{</span><span class="ident" id="3288218">IP</span><span class="op" id="3288220">:</span>&nbsp;<span class="ident" id="3288222">ip</span><span class="op" id="3288224">.</span><span class="ident" id="3288225">Mask</span><span class="op" id="3288229">(</span><span class="ident" id="3288230">m</span><span class="op" id="3288231">)</span><span class="op" id="3288232">,</span>&nbsp;<span class="ident" id="3288234">Mask</span><span class="op" id="3288238">:</span>&nbsp;<span class="ident" id="3288240">m</span><span class="op" id="3288241">}</span><span class="op" id="3288242">,</span>&nbsp;<span class="builtintype" id="3288244">nil</span><br>
<span class="lineno"></span><span class="op" id="3288248">}</span>
</div>
</body>
</html>
