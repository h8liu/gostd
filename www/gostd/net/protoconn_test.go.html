<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html" class="current">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6751632">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6751688">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6751742">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6751793">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6751872">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6751881">package</span>&nbsp;<span class="ident" id="6751889">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6751894">import</span>&nbsp;<span class="op" id="6751901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6751904">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6751917">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6751923">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6751934">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6751945">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6751952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6751955">//&nbsp;testUnixAddr&nbsp;uses&nbsp;ioutil.TempFile&nbsp;to&nbsp;get&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;unique.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="6752025">//&nbsp;also&nbsp;uses&nbsp;/tmp&nbsp;directory&nbsp;in&nbsp;case&nbsp;it&nbsp;is&nbsp;prohibited&nbsp;to&nbsp;create&nbsp;UNIX</span><br>
<span class="lineno">20</span><span class="comment" id="6752093">//&nbsp;sockets&nbsp;in&nbsp;TMPDIR.</span><br>
<span class="lineno"></span><span class="keyword" id="6752115">func</span>&nbsp;<span class="ident" id="6752120">testUnixAddr</span><span class="op" id="6752132">(</span><span class="op" id="6752133">)</span>&nbsp;<span class="builtintype" id="6752135">string</span>&nbsp;<span class="op" id="6752142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752145">f</span><span class="op" id="6752146">,</span>&nbsp;<span class="ident" id="6752148">err</span>&nbsp;<span class="op" id="6752152">:=</span>&nbsp;<span class="ident" id="6752155">ioutil</span><span class="op" id="6752161">.</span><span class="ident" id="6752162">TempFile</span><span class="op" id="6752170">(</span><span class="string" id="6752171">&#34;&#34;</span><span class="op" id="6752173">,</span>&nbsp;<span class="string" id="6752175">&#34;nettest&#34;</span><span class="op" id="6752184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752187">if</span>&nbsp;<span class="ident" id="6752190">err</span>&nbsp;<span class="op" id="6752194">!=</span>&nbsp;<span class="builtintype" id="6752197">nil</span>&nbsp;<span class="op" id="6752201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6752205">panic</span><span class="op" id="6752210">(</span><span class="ident" id="6752211">err</span><span class="op" id="6752214">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752220">addr</span>&nbsp;<span class="op" id="6752225">:=</span>&nbsp;<span class="ident" id="6752228">f</span><span class="op" id="6752229">.</span><span class="ident" id="6752230">Name</span><span class="op" id="6752234">(</span><span class="op" id="6752235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752238">f</span><span class="op" id="6752239">.</span><span class="ident" id="6752240">Close</span><span class="op" id="6752245">(</span><span class="op" id="6752246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752249">os</span><span class="op" id="6752251">.</span><span class="ident" id="6752252">Remove</span><span class="op" id="6752258">(</span><span class="ident" id="6752259">addr</span><span class="op" id="6752263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752266">return</span>&nbsp;<span class="ident" id="6752273">addr</span><br>
<span class="lineno">30</span><span class="op" id="6752278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6752281">var</span>&nbsp;<span class="ident" id="6752285">condFatalf</span>&nbsp;<span class="op" id="6752296">=</span>&nbsp;<span class="keyword" id="6752298">func</span><span class="op" id="6752302">(</span><span class="op" id="6752303">)</span>&nbsp;<span class="keyword" id="6752305">func</span><span class="op" id="6752309">(</span><span class="op" id="6752310">*</span><span class="ident" id="6752311">testing</span><span class="op" id="6752318">.</span><span class="ident" id="6752319">T</span><span class="op" id="6752320">,</span>&nbsp;<span class="builtintype" id="6752322">string</span><span class="op" id="6752328">,</span>&nbsp;<span class="op" id="6752330">...</span><span class="keyword" id="6752333">interface</span><span class="op" id="6752342">{</span><span class="op" id="6752343">}</span><span class="op" id="6752344">)</span>&nbsp;<span class="op" id="6752346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6752349">//&nbsp;A&nbsp;few&nbsp;APIs&nbsp;are&nbsp;not&nbsp;implemented&nbsp;yet&nbsp;on&nbsp;both&nbsp;Plan&nbsp;9&nbsp;and&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752416">switch</span>&nbsp;<span class="ident" id="6752423">runtime</span><span class="op" id="6752430">.</span><span class="ident" id="6752431">GOOS</span>&nbsp;<span class="op" id="6752436">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752439">case</span>&nbsp;<span class="string" id="6752444">&#34;plan9&#34;</span><span class="op" id="6752451">,</span>&nbsp;<span class="string" id="6752453">&#34;windows&#34;</span><span class="op" id="6752462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752466">return</span>&nbsp;<span class="op" id="6752473">(</span><span class="op" id="6752474">*</span><span class="ident" id="6752475">testing</span><span class="op" id="6752482">.</span><span class="ident" id="6752483">T</span><span class="op" id="6752484">)</span><span class="op" id="6752485">.</span><span class="ident" id="6752486">Logf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752495">return</span>&nbsp;<span class="op" id="6752502">(</span><span class="op" id="6752503">*</span><span class="ident" id="6752504">testing</span><span class="op" id="6752511">.</span><span class="ident" id="6752512">T</span><span class="op" id="6752513">)</span><span class="op" id="6752514">.</span><span class="ident" id="6752515">Fatalf</span><br>
<span class="lineno"></span><span class="op" id="6752522">}</span><span class="op" id="6752523">(</span><span class="op" id="6752524">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="6752527">func</span>&nbsp;<span class="ident" id="6752532">TestTCPListenerSpecificMethods</span><span class="op" id="6752562">(</span><span class="ident" id="6752563">t</span>&nbsp;<span class="op" id="6752565">*</span><span class="ident" id="6752566">testing</span><span class="op" id="6752573">.</span><span class="ident" id="6752574">T</span><span class="op" id="6752575">)</span>&nbsp;<span class="op" id="6752577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752580">switch</span>&nbsp;<span class="ident" id="6752587">runtime</span><span class="op" id="6752594">.</span><span class="ident" id="6752595">GOOS</span>&nbsp;<span class="op" id="6752600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752603">case</span>&nbsp;<span class="string" id="6752608">&#34;plan9&#34;</span><span class="op" id="6752615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752619">t</span><span class="op" id="6752620">.</span><span class="ident" id="6752621">Skipf</span><span class="op" id="6752626">(</span><span class="string" id="6752627">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6752648">,</span>&nbsp;<span class="ident" id="6752650">runtime</span><span class="op" id="6752657">.</span><span class="ident" id="6752658">GOOS</span><span class="op" id="6752662">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752669">la</span><span class="op" id="6752671">,</span>&nbsp;<span class="ident" id="6752673">err</span>&nbsp;<span class="op" id="6752677">:=</span>&nbsp;<span class="ident" id="6752680">ResolveTCPAddr</span><span class="op" id="6752694">(</span><span class="string" id="6752695">&#34;tcp4&#34;</span><span class="op" id="6752701">,</span>&nbsp;<span class="string" id="6752703">&#34;127.0.0.1:0&#34;</span><span class="op" id="6752716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752719">if</span>&nbsp;<span class="ident" id="6752722">err</span>&nbsp;<span class="op" id="6752726">!=</span>&nbsp;<span class="builtintype" id="6752729">nil</span>&nbsp;<span class="op" id="6752733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752737">t</span><span class="op" id="6752738">.</span><span class="ident" id="6752739">Fatalf</span><span class="op" id="6752745">(</span><span class="string" id="6752746">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6752773">,</span>&nbsp;<span class="ident" id="6752775">err</span><span class="op" id="6752778">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752784">ln</span><span class="op" id="6752786">,</span>&nbsp;<span class="ident" id="6752788">err</span>&nbsp;<span class="op" id="6752792">:=</span>&nbsp;<span class="ident" id="6752795">ListenTCP</span><span class="op" id="6752804">(</span><span class="string" id="6752805">&#34;tcp4&#34;</span><span class="op" id="6752811">,</span>&nbsp;<span class="ident" id="6752813">la</span><span class="op" id="6752815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752818">if</span>&nbsp;<span class="ident" id="6752821">err</span>&nbsp;<span class="op" id="6752825">!=</span>&nbsp;<span class="builtintype" id="6752828">nil</span>&nbsp;<span class="op" id="6752832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752836">t</span><span class="op" id="6752837">.</span><span class="ident" id="6752838">Fatalf</span><span class="op" id="6752844">(</span><span class="string" id="6752845">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6752867">,</span>&nbsp;<span class="ident" id="6752869">err</span><span class="op" id="6752872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752875">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752878">defer</span>&nbsp;<span class="ident" id="6752884">ln</span><span class="op" id="6752886">.</span><span class="ident" id="6752887">Close</span><span class="op" id="6752892">(</span><span class="op" id="6752893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752896">ln</span><span class="op" id="6752898">.</span><span class="ident" id="6752899">Addr</span><span class="op" id="6752903">(</span><span class="op" id="6752904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752907">ln</span><span class="op" id="6752909">.</span><span class="ident" id="6752910">SetDeadline</span><span class="op" id="6752921">(</span><span class="ident" id="6752922">time</span><span class="op" id="6752926">.</span><span class="ident" id="6752927">Now</span><span class="op" id="6752930">(</span><span class="op" id="6752931">)</span><span class="op" id="6752932">.</span><span class="ident" id="6752933">Add</span><span class="op" id="6752936">(</span><span class="num" id="6752937">30</span>&nbsp;<span class="op" id="6752940">*</span>&nbsp;<span class="ident" id="6752942">time</span><span class="op" id="6752946">.</span><span class="ident" id="6752947">Nanosecond</span><span class="op" id="6752957">)</span><span class="op" id="6752958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752962">if</span>&nbsp;<span class="ident" id="6752965">c</span><span class="op" id="6752966">,</span>&nbsp;<span class="ident" id="6752968">err</span>&nbsp;<span class="op" id="6752972">:=</span>&nbsp;<span class="ident" id="6752975">ln</span><span class="op" id="6752977">.</span><span class="ident" id="6752978">Accept</span><span class="op" id="6752984">(</span><span class="op" id="6752985">)</span><span class="op" id="6752986">;</span>&nbsp;<span class="ident" id="6752988">err</span>&nbsp;<span class="op" id="6752992">!=</span>&nbsp;<span class="builtintype" id="6752995">nil</span>&nbsp;<span class="op" id="6752999">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753003">if</span>&nbsp;<span class="op" id="6753006">!</span><span class="ident" id="6753007">err</span><span class="op" id="6753010">.</span><span class="op" id="6753011">(</span><span class="ident" id="6753012">Error</span><span class="op" id="6753017">)</span><span class="op" id="6753018">.</span><span class="ident" id="6753019">Timeout</span><span class="op" id="6753026">(</span><span class="op" id="6753027">)</span>&nbsp;<span class="op" id="6753029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753034">t</span><span class="op" id="6753035">.</span><span class="ident" id="6753036">Fatalf</span><span class="op" id="6753042">(</span><span class="string" id="6753043">&#34;TCPListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753074">,</span>&nbsp;<span class="ident" id="6753076">err</span><span class="op" id="6753079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753086">}</span>&nbsp;<span class="keyword" id="6753088">else</span>&nbsp;<span class="op" id="6753093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753097">c</span><span class="op" id="6753098">.</span><span class="ident" id="6753099">Close</span><span class="op" id="6753104">(</span><span class="op" id="6753105">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753111">if</span>&nbsp;<span class="ident" id="6753114">c</span><span class="op" id="6753115">,</span>&nbsp;<span class="ident" id="6753117">err</span>&nbsp;<span class="op" id="6753121">:=</span>&nbsp;<span class="ident" id="6753124">ln</span><span class="op" id="6753126">.</span><span class="ident" id="6753127">AcceptTCP</span><span class="op" id="6753136">(</span><span class="op" id="6753137">)</span><span class="op" id="6753138">;</span>&nbsp;<span class="ident" id="6753140">err</span>&nbsp;<span class="op" id="6753144">!=</span>&nbsp;<span class="builtintype" id="6753147">nil</span>&nbsp;<span class="op" id="6753151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753155">if</span>&nbsp;<span class="op" id="6753158">!</span><span class="ident" id="6753159">err</span><span class="op" id="6753162">.</span><span class="op" id="6753163">(</span><span class="ident" id="6753164">Error</span><span class="op" id="6753169">)</span><span class="op" id="6753170">.</span><span class="ident" id="6753171">Timeout</span><span class="op" id="6753178">(</span><span class="op" id="6753179">)</span>&nbsp;<span class="op" id="6753181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753186">t</span><span class="op" id="6753187">.</span><span class="ident" id="6753188">Fatalf</span><span class="op" id="6753194">(</span><span class="string" id="6753195">&#34;TCPListener.AcceptTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753229">,</span>&nbsp;<span class="ident" id="6753231">err</span><span class="op" id="6753234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753238">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753241">}</span>&nbsp;<span class="keyword" id="6753243">else</span>&nbsp;<span class="op" id="6753248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753252">c</span><span class="op" id="6753253">.</span><span class="ident" id="6753254">Close</span><span class="op" id="6753259">(</span><span class="op" id="6753260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753267">if</span>&nbsp;<span class="ident" id="6753270">f</span><span class="op" id="6753271">,</span>&nbsp;<span class="ident" id="6753273">err</span>&nbsp;<span class="op" id="6753277">:=</span>&nbsp;<span class="ident" id="6753280">ln</span><span class="op" id="6753282">.</span><span class="ident" id="6753283">File</span><span class="op" id="6753287">(</span><span class="op" id="6753288">)</span><span class="op" id="6753289">;</span>&nbsp;<span class="ident" id="6753291">err</span>&nbsp;<span class="op" id="6753295">!=</span>&nbsp;<span class="builtintype" id="6753298">nil</span>&nbsp;<span class="op" id="6753302">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753306">condFatalf</span><span class="op" id="6753316">(</span><span class="ident" id="6753317">t</span><span class="op" id="6753318">,</span>&nbsp;<span class="string" id="6753320">&#34;TCPListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753349">,</span>&nbsp;<span class="ident" id="6753351">err</span><span class="op" id="6753354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753357">}</span>&nbsp;<span class="keyword" id="6753359">else</span>&nbsp;<span class="op" id="6753364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753368">f</span><span class="op" id="6753369">.</span><span class="ident" id="6753370">Close</span><span class="op" id="6753375">(</span><span class="op" id="6753376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753379">}</span><br>
<span class="lineno"></span><span class="op" id="6753381">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="6753384">func</span>&nbsp;<span class="ident" id="6753389">TestTCPConnSpecificMethods</span><span class="op" id="6753415">(</span><span class="ident" id="6753416">t</span>&nbsp;<span class="op" id="6753418">*</span><span class="ident" id="6753419">testing</span><span class="op" id="6753426">.</span><span class="ident" id="6753427">T</span><span class="op" id="6753428">)</span>&nbsp;<span class="op" id="6753430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753433">la</span><span class="op" id="6753435">,</span>&nbsp;<span class="ident" id="6753437">err</span>&nbsp;<span class="op" id="6753441">:=</span>&nbsp;<span class="ident" id="6753444">ResolveTCPAddr</span><span class="op" id="6753458">(</span><span class="string" id="6753459">&#34;tcp4&#34;</span><span class="op" id="6753465">,</span>&nbsp;<span class="string" id="6753467">&#34;127.0.0.1:0&#34;</span><span class="op" id="6753480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753483">if</span>&nbsp;<span class="ident" id="6753486">err</span>&nbsp;<span class="op" id="6753490">!=</span>&nbsp;<span class="builtintype" id="6753493">nil</span>&nbsp;<span class="op" id="6753497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753501">t</span><span class="op" id="6753502">.</span><span class="ident" id="6753503">Fatalf</span><span class="op" id="6753509">(</span><span class="string" id="6753510">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753537">,</span>&nbsp;<span class="ident" id="6753539">err</span><span class="op" id="6753542">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753548">ln</span><span class="op" id="6753550">,</span>&nbsp;<span class="ident" id="6753552">err</span>&nbsp;<span class="op" id="6753556">:=</span>&nbsp;<span class="ident" id="6753559">ListenTCP</span><span class="op" id="6753568">(</span><span class="string" id="6753569">&#34;tcp4&#34;</span><span class="op" id="6753575">,</span>&nbsp;<span class="ident" id="6753577">la</span><span class="op" id="6753579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753582">if</span>&nbsp;<span class="ident" id="6753585">err</span>&nbsp;<span class="op" id="6753589">!=</span>&nbsp;<span class="builtintype" id="6753592">nil</span>&nbsp;<span class="op" id="6753596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753600">t</span><span class="op" id="6753601">.</span><span class="ident" id="6753602">Fatalf</span><span class="op" id="6753608">(</span><span class="string" id="6753609">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753631">,</span>&nbsp;<span class="ident" id="6753633">err</span><span class="op" id="6753636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753639">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753642">defer</span>&nbsp;<span class="ident" id="6753648">ln</span><span class="op" id="6753650">.</span><span class="ident" id="6753651">Close</span><span class="op" id="6753656">(</span><span class="op" id="6753657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753660">ln</span><span class="op" id="6753662">.</span><span class="ident" id="6753663">Addr</span><span class="op" id="6753667">(</span><span class="op" id="6753668">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753672">done</span>&nbsp;<span class="op" id="6753677">:=</span>&nbsp;<span class="builtinfunc" id="6753680">make</span><span class="op" id="6753684">(</span><span class="keyword" id="6753685">chan</span>&nbsp;<span class="builtintype" id="6753690">int</span><span class="op" id="6753693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753696">go</span>&nbsp;<span class="ident" id="6753699">transponder</span><span class="op" id="6753710">(</span><span class="ident" id="6753711">t</span><span class="op" id="6753712">,</span>&nbsp;<span class="ident" id="6753714">ln</span><span class="op" id="6753716">,</span>&nbsp;<span class="ident" id="6753718">done</span><span class="op" id="6753722">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753726">ra</span><span class="op" id="6753728">,</span>&nbsp;<span class="ident" id="6753730">err</span>&nbsp;<span class="op" id="6753734">:=</span>&nbsp;<span class="ident" id="6753737">ResolveTCPAddr</span><span class="op" id="6753751">(</span><span class="string" id="6753752">&#34;tcp4&#34;</span><span class="op" id="6753758">,</span>&nbsp;<span class="ident" id="6753760">ln</span><span class="op" id="6753762">.</span><span class="ident" id="6753763">Addr</span><span class="op" id="6753767">(</span><span class="op" id="6753768">)</span><span class="op" id="6753769">.</span><span class="ident" id="6753770">String</span><span class="op" id="6753776">(</span><span class="op" id="6753777">)</span><span class="op" id="6753778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753781">if</span>&nbsp;<span class="ident" id="6753784">err</span>&nbsp;<span class="op" id="6753788">!=</span>&nbsp;<span class="builtintype" id="6753791">nil</span>&nbsp;<span class="op" id="6753795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753799">t</span><span class="op" id="6753800">.</span><span class="ident" id="6753801">Fatalf</span><span class="op" id="6753807">(</span><span class="string" id="6753808">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753835">,</span>&nbsp;<span class="ident" id="6753837">err</span><span class="op" id="6753840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753843">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753846">c</span><span class="op" id="6753847">,</span>&nbsp;<span class="ident" id="6753849">err</span>&nbsp;<span class="op" id="6753853">:=</span>&nbsp;<span class="ident" id="6753856">DialTCP</span><span class="op" id="6753863">(</span><span class="string" id="6753864">&#34;tcp4&#34;</span><span class="op" id="6753870">,</span>&nbsp;<span class="builtintype" id="6753872">nil</span><span class="op" id="6753875">,</span>&nbsp;<span class="ident" id="6753877">ra</span><span class="op" id="6753879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753882">if</span>&nbsp;<span class="ident" id="6753885">err</span>&nbsp;<span class="op" id="6753889">!=</span>&nbsp;<span class="builtintype" id="6753892">nil</span>&nbsp;<span class="op" id="6753896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753900">t</span><span class="op" id="6753901">.</span><span class="ident" id="6753902">Fatalf</span><span class="op" id="6753908">(</span><span class="string" id="6753909">&#34;DialTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6753929">,</span>&nbsp;<span class="ident" id="6753931">err</span><span class="op" id="6753934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753940">defer</span>&nbsp;<span class="ident" id="6753946">c</span><span class="op" id="6753947">.</span><span class="ident" id="6753948">Close</span><span class="op" id="6753953">(</span><span class="op" id="6753954">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753957">c</span><span class="op" id="6753958">.</span><span class="ident" id="6753959">SetKeepAlive</span><span class="op" id="6753971">(</span><span class="builtintype" id="6753972">false</span><span class="op" id="6753977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753980">c</span><span class="op" id="6753981">.</span><span class="ident" id="6753982">SetKeepAlivePeriod</span><span class="op" id="6754000">(</span><span class="num" id="6754001">3</span>&nbsp;<span class="op" id="6754003">*</span>&nbsp;<span class="ident" id="6754005">time</span><span class="op" id="6754009">.</span><span class="ident" id="6754010">Second</span><span class="op" id="6754016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754019">c</span><span class="op" id="6754020">.</span><span class="ident" id="6754021">SetLinger</span><span class="op" id="6754030">(</span><span class="num" id="6754031">0</span><span class="op" id="6754032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754035">c</span><span class="op" id="6754036">.</span><span class="ident" id="6754037">SetNoDelay</span><span class="op" id="6754047">(</span><span class="builtintype" id="6754048">false</span><span class="op" id="6754053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754056">c</span><span class="op" id="6754057">.</span><span class="ident" id="6754058">LocalAddr</span><span class="op" id="6754067">(</span><span class="op" id="6754068">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754071">c</span><span class="op" id="6754072">.</span><span class="ident" id="6754073">RemoteAddr</span><span class="op" id="6754083">(</span><span class="op" id="6754084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754087">c</span><span class="op" id="6754088">.</span><span class="ident" id="6754089">SetDeadline</span><span class="op" id="6754100">(</span><span class="ident" id="6754101">time</span><span class="op" id="6754105">.</span><span class="ident" id="6754106">Now</span><span class="op" id="6754109">(</span><span class="op" id="6754110">)</span><span class="op" id="6754111">.</span><span class="ident" id="6754112">Add</span><span class="op" id="6754115">(</span><span class="ident" id="6754116">someTimeout</span><span class="op" id="6754127">)</span><span class="op" id="6754128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754131">c</span><span class="op" id="6754132">.</span><span class="ident" id="6754133">SetReadDeadline</span><span class="op" id="6754148">(</span><span class="ident" id="6754149">time</span><span class="op" id="6754153">.</span><span class="ident" id="6754154">Now</span><span class="op" id="6754157">(</span><span class="op" id="6754158">)</span><span class="op" id="6754159">.</span><span class="ident" id="6754160">Add</span><span class="op" id="6754163">(</span><span class="ident" id="6754164">someTimeout</span><span class="op" id="6754175">)</span><span class="op" id="6754176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754179">c</span><span class="op" id="6754180">.</span><span class="ident" id="6754181">SetWriteDeadline</span><span class="op" id="6754197">(</span><span class="ident" id="6754198">time</span><span class="op" id="6754202">.</span><span class="ident" id="6754203">Now</span><span class="op" id="6754206">(</span><span class="op" id="6754207">)</span><span class="op" id="6754208">.</span><span class="ident" id="6754209">Add</span><span class="op" id="6754212">(</span><span class="ident" id="6754213">someTimeout</span><span class="op" id="6754224">)</span><span class="op" id="6754225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754229">if</span>&nbsp;<span class="ident" id="6754232">_</span><span class="op" id="6754233">,</span>&nbsp;<span class="ident" id="6754235">err</span>&nbsp;<span class="op" id="6754239">:=</span>&nbsp;<span class="ident" id="6754242">c</span><span class="op" id="6754243">.</span><span class="ident" id="6754244">Write</span><span class="op" id="6754249">(</span><span class="op" id="6754250">[</span><span class="op" id="6754251">]</span><span class="builtintype" id="6754252">byte</span><span class="op" id="6754256">(</span><span class="string" id="6754257">&#34;TCPCONN&nbsp;TEST&#34;</span><span class="op" id="6754271">)</span><span class="op" id="6754272">)</span><span class="op" id="6754273">;</span>&nbsp;<span class="ident" id="6754275">err</span>&nbsp;<span class="op" id="6754279">!=</span>&nbsp;<span class="builtintype" id="6754282">nil</span>&nbsp;<span class="op" id="6754286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754290">t</span><span class="op" id="6754291">.</span><span class="ident" id="6754292">Fatalf</span><span class="op" id="6754298">(</span><span class="string" id="6754299">&#34;TCPConn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6754325">,</span>&nbsp;<span class="ident" id="6754327">err</span><span class="op" id="6754330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754336">rb</span>&nbsp;<span class="op" id="6754339">:=</span>&nbsp;<span class="builtinfunc" id="6754342">make</span><span class="op" id="6754346">(</span><span class="op" id="6754347">[</span><span class="op" id="6754348">]</span><span class="builtintype" id="6754349">byte</span><span class="op" id="6754353">,</span>&nbsp;<span class="num" id="6754355">128</span><span class="op" id="6754358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754361">if</span>&nbsp;<span class="ident" id="6754364">_</span><span class="op" id="6754365">,</span>&nbsp;<span class="ident" id="6754367">err</span>&nbsp;<span class="op" id="6754371">:=</span>&nbsp;<span class="ident" id="6754374">c</span><span class="op" id="6754375">.</span><span class="ident" id="6754376">Read</span><span class="op" id="6754380">(</span><span class="ident" id="6754381">rb</span><span class="op" id="6754383">)</span><span class="op" id="6754384">;</span>&nbsp;<span class="ident" id="6754386">err</span>&nbsp;<span class="op" id="6754390">!=</span>&nbsp;<span class="builtintype" id="6754393">nil</span>&nbsp;<span class="op" id="6754397">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754401">t</span><span class="op" id="6754402">.</span><span class="ident" id="6754403">Fatalf</span><span class="op" id="6754409">(</span><span class="string" id="6754410">&#34;TCPConn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6754435">,</span>&nbsp;<span class="ident" id="6754437">err</span><span class="op" id="6754440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754447">&lt;-</span><span class="ident" id="6754449">done</span><br>
<span class="lineno"></span><span class="op" id="6754454">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6754457">func</span>&nbsp;<span class="ident" id="6754462">TestUDPConnSpecificMethods</span><span class="op" id="6754488">(</span><span class="ident" id="6754489">t</span>&nbsp;<span class="op" id="6754491">*</span><span class="ident" id="6754492">testing</span><span class="op" id="6754499">.</span><span class="ident" id="6754500">T</span><span class="op" id="6754501">)</span>&nbsp;<span class="op" id="6754503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754506">la</span><span class="op" id="6754508">,</span>&nbsp;<span class="ident" id="6754510">err</span>&nbsp;<span class="op" id="6754514">:=</span>&nbsp;<span class="ident" id="6754517">ResolveUDPAddr</span><span class="op" id="6754531">(</span><span class="string" id="6754532">&#34;udp4&#34;</span><span class="op" id="6754538">,</span>&nbsp;<span class="string" id="6754540">&#34;127.0.0.1:0&#34;</span><span class="op" id="6754553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754556">if</span>&nbsp;<span class="ident" id="6754559">err</span>&nbsp;<span class="op" id="6754563">!=</span>&nbsp;<span class="builtintype" id="6754566">nil</span>&nbsp;<span class="op" id="6754570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754574">t</span><span class="op" id="6754575">.</span><span class="ident" id="6754576">Fatalf</span><span class="op" id="6754582">(</span><span class="string" id="6754583">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6754610">,</span>&nbsp;<span class="ident" id="6754612">err</span><span class="op" id="6754615">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754621">c</span><span class="op" id="6754622">,</span>&nbsp;<span class="ident" id="6754624">err</span>&nbsp;<span class="op" id="6754628">:=</span>&nbsp;<span class="ident" id="6754631">ListenUDP</span><span class="op" id="6754640">(</span><span class="string" id="6754641">&#34;udp4&#34;</span><span class="op" id="6754647">,</span>&nbsp;<span class="ident" id="6754649">la</span><span class="op" id="6754651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754654">if</span>&nbsp;<span class="ident" id="6754657">err</span>&nbsp;<span class="op" id="6754661">!=</span>&nbsp;<span class="builtintype" id="6754664">nil</span>&nbsp;<span class="op" id="6754668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754672">t</span><span class="op" id="6754673">.</span><span class="ident" id="6754674">Fatalf</span><span class="op" id="6754680">(</span><span class="string" id="6754681">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6754703">,</span>&nbsp;<span class="ident" id="6754705">err</span><span class="op" id="6754708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754711">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754714">defer</span>&nbsp;<span class="ident" id="6754720">c</span><span class="op" id="6754721">.</span><span class="ident" id="6754722">Close</span><span class="op" id="6754727">(</span><span class="op" id="6754728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754731">c</span><span class="op" id="6754732">.</span><span class="ident" id="6754733">LocalAddr</span><span class="op" id="6754742">(</span><span class="op" id="6754743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754746">c</span><span class="op" id="6754747">.</span><span class="ident" id="6754748">RemoteAddr</span><span class="op" id="6754758">(</span><span class="op" id="6754759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754762">c</span><span class="op" id="6754763">.</span><span class="ident" id="6754764">SetDeadline</span><span class="op" id="6754775">(</span><span class="ident" id="6754776">time</span><span class="op" id="6754780">.</span><span class="ident" id="6754781">Now</span><span class="op" id="6754784">(</span><span class="op" id="6754785">)</span><span class="op" id="6754786">.</span><span class="ident" id="6754787">Add</span><span class="op" id="6754790">(</span><span class="ident" id="6754791">someTimeout</span><span class="op" id="6754802">)</span><span class="op" id="6754803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754806">c</span><span class="op" id="6754807">.</span><span class="ident" id="6754808">SetReadDeadline</span><span class="op" id="6754823">(</span><span class="ident" id="6754824">time</span><span class="op" id="6754828">.</span><span class="ident" id="6754829">Now</span><span class="op" id="6754832">(</span><span class="op" id="6754833">)</span><span class="op" id="6754834">.</span><span class="ident" id="6754835">Add</span><span class="op" id="6754838">(</span><span class="ident" id="6754839">someTimeout</span><span class="op" id="6754850">)</span><span class="op" id="6754851">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754854">c</span><span class="op" id="6754855">.</span><span class="ident" id="6754856">SetWriteDeadline</span><span class="op" id="6754872">(</span><span class="ident" id="6754873">time</span><span class="op" id="6754877">.</span><span class="ident" id="6754878">Now</span><span class="op" id="6754881">(</span><span class="op" id="6754882">)</span><span class="op" id="6754883">.</span><span class="ident" id="6754884">Add</span><span class="op" id="6754887">(</span><span class="ident" id="6754888">someTimeout</span><span class="op" id="6754899">)</span><span class="op" id="6754900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754903">c</span><span class="op" id="6754904">.</span><span class="ident" id="6754905">SetReadBuffer</span><span class="op" id="6754918">(</span><span class="num" id="6754919">2048</span><span class="op" id="6754923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754926">c</span><span class="op" id="6754927">.</span><span class="ident" id="6754928">SetWriteBuffer</span><span class="op" id="6754942">(</span><span class="num" id="6754943">2048</span><span class="op" id="6754947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754951">wb</span>&nbsp;<span class="op" id="6754954">:=</span>&nbsp;<span class="op" id="6754957">[</span><span class="op" id="6754958">]</span><span class="builtintype" id="6754959">byte</span><span class="op" id="6754963">(</span><span class="string" id="6754964">&#34;UDPCONN&nbsp;TEST&#34;</span><span class="op" id="6754978">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754981">rb</span>&nbsp;<span class="op" id="6754984">:=</span>&nbsp;<span class="builtinfunc" id="6754987">make</span><span class="op" id="6754991">(</span><span class="op" id="6754992">[</span><span class="op" id="6754993">]</span><span class="builtintype" id="6754994">byte</span><span class="op" id="6754998">,</span>&nbsp;<span class="num" id="6755000">128</span><span class="op" id="6755003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755006">if</span>&nbsp;<span class="ident" id="6755009">_</span><span class="op" id="6755010">,</span>&nbsp;<span class="ident" id="6755012">err</span>&nbsp;<span class="op" id="6755016">:=</span>&nbsp;<span class="ident" id="6755019">c</span><span class="op" id="6755020">.</span><span class="ident" id="6755021">WriteToUDP</span><span class="op" id="6755031">(</span><span class="ident" id="6755032">wb</span><span class="op" id="6755034">,</span>&nbsp;<span class="ident" id="6755036">c</span><span class="op" id="6755037">.</span><span class="ident" id="6755038">LocalAddr</span><span class="op" id="6755047">(</span><span class="op" id="6755048">)</span><span class="op" id="6755049">.</span><span class="op" id="6755050">(</span><span class="op" id="6755051">*</span><span class="ident" id="6755052">UDPAddr</span><span class="op" id="6755059">)</span><span class="op" id="6755060">)</span><span class="op" id="6755061">;</span>&nbsp;<span class="ident" id="6755063">err</span>&nbsp;<span class="op" id="6755067">!=</span>&nbsp;<span class="builtintype" id="6755070">nil</span>&nbsp;<span class="op" id="6755074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755078">t</span><span class="op" id="6755079">.</span><span class="ident" id="6755080">Fatalf</span><span class="op" id="6755086">(</span><span class="string" id="6755087">&#34;UDPConn.WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755118">,</span>&nbsp;<span class="ident" id="6755120">err</span><span class="op" id="6755123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755129">if</span>&nbsp;<span class="ident" id="6755132">_</span><span class="op" id="6755133">,</span>&nbsp;<span class="ident" id="6755135">_</span><span class="op" id="6755136">,</span>&nbsp;<span class="ident" id="6755138">err</span>&nbsp;<span class="op" id="6755142">:=</span>&nbsp;<span class="ident" id="6755145">c</span><span class="op" id="6755146">.</span><span class="ident" id="6755147">ReadFromUDP</span><span class="op" id="6755158">(</span><span class="ident" id="6755159">rb</span><span class="op" id="6755161">)</span><span class="op" id="6755162">;</span>&nbsp;<span class="ident" id="6755164">err</span>&nbsp;<span class="op" id="6755168">!=</span>&nbsp;<span class="builtintype" id="6755171">nil</span>&nbsp;<span class="op" id="6755175">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755179">t</span><span class="op" id="6755180">.</span><span class="ident" id="6755181">Fatalf</span><span class="op" id="6755187">(</span><span class="string" id="6755188">&#34;UDPConn.ReadFromUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755220">,</span>&nbsp;<span class="ident" id="6755222">err</span><span class="op" id="6755225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755231">if</span>&nbsp;<span class="ident" id="6755234">_</span><span class="op" id="6755235">,</span>&nbsp;<span class="ident" id="6755237">_</span><span class="op" id="6755238">,</span>&nbsp;<span class="ident" id="6755240">err</span>&nbsp;<span class="op" id="6755244">:=</span>&nbsp;<span class="ident" id="6755247">c</span><span class="op" id="6755248">.</span><span class="ident" id="6755249">WriteMsgUDP</span><span class="op" id="6755260">(</span><span class="ident" id="6755261">wb</span><span class="op" id="6755263">,</span>&nbsp;<span class="builtintype" id="6755265">nil</span><span class="op" id="6755268">,</span>&nbsp;<span class="ident" id="6755270">c</span><span class="op" id="6755271">.</span><span class="ident" id="6755272">LocalAddr</span><span class="op" id="6755281">(</span><span class="op" id="6755282">)</span><span class="op" id="6755283">.</span><span class="op" id="6755284">(</span><span class="op" id="6755285">*</span><span class="ident" id="6755286">UDPAddr</span><span class="op" id="6755293">)</span><span class="op" id="6755294">)</span><span class="op" id="6755295">;</span>&nbsp;<span class="ident" id="6755297">err</span>&nbsp;<span class="op" id="6755301">!=</span>&nbsp;<span class="builtintype" id="6755304">nil</span>&nbsp;<span class="op" id="6755308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755312">condFatalf</span><span class="op" id="6755322">(</span><span class="ident" id="6755323">t</span><span class="op" id="6755324">,</span>&nbsp;<span class="string" id="6755326">&#34;UDPConn.WriteMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755358">,</span>&nbsp;<span class="ident" id="6755360">err</span><span class="op" id="6755363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755366">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755369">if</span>&nbsp;<span class="ident" id="6755372">_</span><span class="op" id="6755373">,</span>&nbsp;<span class="ident" id="6755375">_</span><span class="op" id="6755376">,</span>&nbsp;<span class="ident" id="6755378">_</span><span class="op" id="6755379">,</span>&nbsp;<span class="ident" id="6755381">_</span><span class="op" id="6755382">,</span>&nbsp;<span class="ident" id="6755384">err</span>&nbsp;<span class="op" id="6755388">:=</span>&nbsp;<span class="ident" id="6755391">c</span><span class="op" id="6755392">.</span><span class="ident" id="6755393">ReadMsgUDP</span><span class="op" id="6755403">(</span><span class="ident" id="6755404">rb</span><span class="op" id="6755406">,</span>&nbsp;<span class="builtintype" id="6755408">nil</span><span class="op" id="6755411">)</span><span class="op" id="6755412">;</span>&nbsp;<span class="ident" id="6755414">err</span>&nbsp;<span class="op" id="6755418">!=</span>&nbsp;<span class="builtintype" id="6755421">nil</span>&nbsp;<span class="op" id="6755425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755429">condFatalf</span><span class="op" id="6755439">(</span><span class="ident" id="6755440">t</span><span class="op" id="6755441">,</span>&nbsp;<span class="string" id="6755443">&#34;UDPConn.ReadMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755474">,</span>&nbsp;<span class="ident" id="6755476">err</span><span class="op" id="6755479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755486">if</span>&nbsp;<span class="ident" id="6755489">f</span><span class="op" id="6755490">,</span>&nbsp;<span class="ident" id="6755492">err</span>&nbsp;<span class="op" id="6755496">:=</span>&nbsp;<span class="ident" id="6755499">c</span><span class="op" id="6755500">.</span><span class="ident" id="6755501">File</span><span class="op" id="6755505">(</span><span class="op" id="6755506">)</span><span class="op" id="6755507">;</span>&nbsp;<span class="ident" id="6755509">err</span>&nbsp;<span class="op" id="6755513">!=</span>&nbsp;<span class="builtintype" id="6755516">nil</span>&nbsp;<span class="op" id="6755520">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755524">condFatalf</span><span class="op" id="6755534">(</span><span class="ident" id="6755535">t</span><span class="op" id="6755536">,</span>&nbsp;<span class="string" id="6755538">&#34;UDPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755563">,</span>&nbsp;<span class="ident" id="6755565">err</span><span class="op" id="6755568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755571">}</span>&nbsp;<span class="keyword" id="6755573">else</span>&nbsp;<span class="op" id="6755578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755582">f</span><span class="op" id="6755583">.</span><span class="ident" id="6755584">Close</span><span class="op" id="6755589">(</span><span class="op" id="6755590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755597">defer</span>&nbsp;<span class="keyword" id="6755603">func</span><span class="op" id="6755607">(</span><span class="op" id="6755608">)</span>&nbsp;<span class="op" id="6755610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755614">if</span>&nbsp;<span class="ident" id="6755617">p</span>&nbsp;<span class="op" id="6755619">:=</span>&nbsp;<span class="builtinfunc" id="6755622">recover</span><span class="op" id="6755629">(</span><span class="op" id="6755630">)</span><span class="op" id="6755631">;</span>&nbsp;<span class="ident" id="6755633">p</span>&nbsp;<span class="op" id="6755635">!=</span>&nbsp;<span class="builtintype" id="6755638">nil</span>&nbsp;<span class="op" id="6755642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755647">t</span><span class="op" id="6755648">.</span><span class="ident" id="6755649">Fatalf</span><span class="op" id="6755655">(</span><span class="string" id="6755656">&#34;UDPConn.WriteToUDP&nbsp;or&nbsp;WriteMsgUDP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6755704">,</span>&nbsp;<span class="ident" id="6755706">p</span><span class="op" id="6755707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755714">}</span><span class="op" id="6755715">(</span><span class="op" id="6755716">)</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755720">c</span><span class="op" id="6755721">.</span><span class="ident" id="6755722">WriteToUDP</span><span class="op" id="6755732">(</span><span class="ident" id="6755733">wb</span><span class="op" id="6755735">,</span>&nbsp;<span class="builtintype" id="6755737">nil</span><span class="op" id="6755740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755743">c</span><span class="op" id="6755744">.</span><span class="ident" id="6755745">WriteMsgUDP</span><span class="op" id="6755756">(</span><span class="ident" id="6755757">wb</span><span class="op" id="6755759">,</span>&nbsp;<span class="builtintype" id="6755761">nil</span><span class="op" id="6755764">,</span>&nbsp;<span class="builtintype" id="6755766">nil</span><span class="op" id="6755769">)</span><br>
<span class="lineno"></span><span class="op" id="6755771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6755774">func</span>&nbsp;<span class="ident" id="6755779">TestIPConnSpecificMethods</span><span class="op" id="6755804">(</span><span class="ident" id="6755805">t</span>&nbsp;<span class="op" id="6755807">*</span><span class="ident" id="6755808">testing</span><span class="op" id="6755815">.</span><span class="ident" id="6755816">T</span><span class="op" id="6755817">)</span>&nbsp;<span class="op" id="6755819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755822">if</span>&nbsp;<span class="ident" id="6755825">skip</span><span class="op" id="6755829">,</span>&nbsp;<span class="ident" id="6755831">skipmsg</span>&nbsp;<span class="op" id="6755839">:=</span>&nbsp;<span class="ident" id="6755842">skipRawSocketTest</span><span class="op" id="6755859">(</span><span class="ident" id="6755860">t</span><span class="op" id="6755861">)</span><span class="op" id="6755862">;</span>&nbsp;<span class="ident" id="6755864">skip</span>&nbsp;<span class="op" id="6755869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755873">t</span><span class="op" id="6755874">.</span><span class="ident" id="6755875">Skip</span><span class="op" id="6755879">(</span><span class="ident" id="6755880">skipmsg</span><span class="op" id="6755887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755894">la</span><span class="op" id="6755896">,</span>&nbsp;<span class="ident" id="6755898">err</span>&nbsp;<span class="op" id="6755902">:=</span>&nbsp;<span class="ident" id="6755905">ResolveIPAddr</span><span class="op" id="6755918">(</span><span class="string" id="6755919">&#34;ip4&#34;</span><span class="op" id="6755924">,</span>&nbsp;<span class="string" id="6755926">&#34;127.0.0.1&#34;</span><span class="op" id="6755937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755940">if</span>&nbsp;<span class="ident" id="6755943">err</span>&nbsp;<span class="op" id="6755947">!=</span>&nbsp;<span class="builtintype" id="6755950">nil</span>&nbsp;<span class="op" id="6755954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755958">t</span><span class="op" id="6755959">.</span><span class="ident" id="6755960">Fatalf</span><span class="op" id="6755966">(</span><span class="string" id="6755967">&#34;ResolveIPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6755993">,</span>&nbsp;<span class="ident" id="6755995">err</span><span class="op" id="6755998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756004">c</span><span class="op" id="6756005">,</span>&nbsp;<span class="ident" id="6756007">err</span>&nbsp;<span class="op" id="6756011">:=</span>&nbsp;<span class="ident" id="6756014">ListenIP</span><span class="op" id="6756022">(</span><span class="string" id="6756023">&#34;ip4:icmp&#34;</span><span class="op" id="6756033">,</span>&nbsp;<span class="ident" id="6756035">la</span><span class="op" id="6756037">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756040">if</span>&nbsp;<span class="ident" id="6756043">err</span>&nbsp;<span class="op" id="6756047">!=</span>&nbsp;<span class="builtintype" id="6756050">nil</span>&nbsp;<span class="op" id="6756054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756058">t</span><span class="op" id="6756059">.</span><span class="ident" id="6756060">Fatalf</span><span class="op" id="6756066">(</span><span class="string" id="6756067">&#34;ListenIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6756088">,</span>&nbsp;<span class="ident" id="6756090">err</span><span class="op" id="6756093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756099">defer</span>&nbsp;<span class="ident" id="6756105">c</span><span class="op" id="6756106">.</span><span class="ident" id="6756107">Close</span><span class="op" id="6756112">(</span><span class="op" id="6756113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756116">c</span><span class="op" id="6756117">.</span><span class="ident" id="6756118">LocalAddr</span><span class="op" id="6756127">(</span><span class="op" id="6756128">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756131">c</span><span class="op" id="6756132">.</span><span class="ident" id="6756133">RemoteAddr</span><span class="op" id="6756143">(</span><span class="op" id="6756144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756147">c</span><span class="op" id="6756148">.</span><span class="ident" id="6756149">SetDeadline</span><span class="op" id="6756160">(</span><span class="ident" id="6756161">time</span><span class="op" id="6756165">.</span><span class="ident" id="6756166">Now</span><span class="op" id="6756169">(</span><span class="op" id="6756170">)</span><span class="op" id="6756171">.</span><span class="ident" id="6756172">Add</span><span class="op" id="6756175">(</span><span class="ident" id="6756176">someTimeout</span><span class="op" id="6756187">)</span><span class="op" id="6756188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756191">c</span><span class="op" id="6756192">.</span><span class="ident" id="6756193">SetReadDeadline</span><span class="op" id="6756208">(</span><span class="ident" id="6756209">time</span><span class="op" id="6756213">.</span><span class="ident" id="6756214">Now</span><span class="op" id="6756217">(</span><span class="op" id="6756218">)</span><span class="op" id="6756219">.</span><span class="ident" id="6756220">Add</span><span class="op" id="6756223">(</span><span class="ident" id="6756224">someTimeout</span><span class="op" id="6756235">)</span><span class="op" id="6756236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756239">c</span><span class="op" id="6756240">.</span><span class="ident" id="6756241">SetWriteDeadline</span><span class="op" id="6756257">(</span><span class="ident" id="6756258">time</span><span class="op" id="6756262">.</span><span class="ident" id="6756263">Now</span><span class="op" id="6756266">(</span><span class="op" id="6756267">)</span><span class="op" id="6756268">.</span><span class="ident" id="6756269">Add</span><span class="op" id="6756272">(</span><span class="ident" id="6756273">someTimeout</span><span class="op" id="6756284">)</span><span class="op" id="6756285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756288">c</span><span class="op" id="6756289">.</span><span class="ident" id="6756290">SetReadBuffer</span><span class="op" id="6756303">(</span><span class="num" id="6756304">2048</span><span class="op" id="6756308">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756311">c</span><span class="op" id="6756312">.</span><span class="ident" id="6756313">SetWriteBuffer</span><span class="op" id="6756327">(</span><span class="num" id="6756328">2048</span><span class="op" id="6756332">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756336">wb</span><span class="op" id="6756338">,</span>&nbsp;<span class="ident" id="6756340">err</span>&nbsp;<span class="op" id="6756344">:=</span>&nbsp;<span class="op" id="6756347">(</span><span class="op" id="6756348">&amp;</span><span class="ident" id="6756349">icmpMessage</span><span class="op" id="6756360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756364">Type</span><span class="op" id="6756368">:</span>&nbsp;<span class="ident" id="6756370">icmpv4EchoRequest</span><span class="op" id="6756387">,</span>&nbsp;<span class="ident" id="6756389">Code</span><span class="op" id="6756393">:</span>&nbsp;<span class="num" id="6756395">0</span><span class="op" id="6756396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756400">Body</span><span class="op" id="6756404">:</span>&nbsp;<span class="op" id="6756406">&amp;</span><span class="ident" id="6756407">icmpEcho</span><span class="op" id="6756415">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756420">ID</span><span class="op" id="6756422">:</span>&nbsp;<span class="ident" id="6756424">os</span><span class="op" id="6756426">.</span><span class="ident" id="6756427">Getpid</span><span class="op" id="6756433">(</span><span class="op" id="6756434">)</span>&nbsp;<span class="op" id="6756436">&amp;</span>&nbsp;<span class="num" id="6756438">0xffff</span><span class="op" id="6756444">,</span>&nbsp;<span class="ident" id="6756446">Seq</span><span class="op" id="6756449">:</span>&nbsp;<span class="num" id="6756451">1</span><span class="op" id="6756452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756457">Data</span><span class="op" id="6756461">:</span>&nbsp;<span class="op" id="6756463">[</span><span class="op" id="6756464">]</span><span class="builtintype" id="6756465">byte</span><span class="op" id="6756469">(</span><span class="string" id="6756470">&#34;IPCONN&nbsp;TEST&nbsp;&#34;</span><span class="op" id="6756484">)</span><span class="op" id="6756485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756489">}</span><span class="op" id="6756490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756493">}</span><span class="op" id="6756494">)</span><span class="op" id="6756495">.</span><span class="ident" id="6756496">Marshal</span><span class="op" id="6756503">(</span><span class="op" id="6756504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756507">if</span>&nbsp;<span class="ident" id="6756510">err</span>&nbsp;<span class="op" id="6756514">!=</span>&nbsp;<span class="builtintype" id="6756517">nil</span>&nbsp;<span class="op" id="6756521">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756525">t</span><span class="op" id="6756526">.</span><span class="ident" id="6756527">Fatalf</span><span class="op" id="6756533">(</span><span class="string" id="6756534">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6756566">,</span>&nbsp;<span class="ident" id="6756568">err</span><span class="op" id="6756571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756577">rb</span>&nbsp;<span class="op" id="6756580">:=</span>&nbsp;<span class="builtinfunc" id="6756583">make</span><span class="op" id="6756587">(</span><span class="op" id="6756588">[</span><span class="op" id="6756589">]</span><span class="builtintype" id="6756590">byte</span><span class="op" id="6756594">,</span>&nbsp;<span class="num" id="6756596">20</span><span class="op" id="6756598">+</span><span class="builtinfunc" id="6756599">len</span><span class="op" id="6756602">(</span><span class="ident" id="6756603">wb</span><span class="op" id="6756605">)</span><span class="op" id="6756606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756609">if</span>&nbsp;<span class="ident" id="6756612">_</span><span class="op" id="6756613">,</span>&nbsp;<span class="ident" id="6756615">err</span>&nbsp;<span class="op" id="6756619">:=</span>&nbsp;<span class="ident" id="6756622">c</span><span class="op" id="6756623">.</span><span class="ident" id="6756624">WriteToIP</span><span class="op" id="6756633">(</span><span class="ident" id="6756634">wb</span><span class="op" id="6756636">,</span>&nbsp;<span class="ident" id="6756638">c</span><span class="op" id="6756639">.</span><span class="ident" id="6756640">LocalAddr</span><span class="op" id="6756649">(</span><span class="op" id="6756650">)</span><span class="op" id="6756651">.</span><span class="op" id="6756652">(</span><span class="op" id="6756653">*</span><span class="ident" id="6756654">IPAddr</span><span class="op" id="6756660">)</span><span class="op" id="6756661">)</span><span class="op" id="6756662">;</span>&nbsp;<span class="ident" id="6756664">err</span>&nbsp;<span class="op" id="6756668">!=</span>&nbsp;<span class="builtintype" id="6756671">nil</span>&nbsp;<span class="op" id="6756675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756679">t</span><span class="op" id="6756680">.</span><span class="ident" id="6756681">Fatalf</span><span class="op" id="6756687">(</span><span class="string" id="6756688">&#34;IPConn.WriteToIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6756717">,</span>&nbsp;<span class="ident" id="6756719">err</span><span class="op" id="6756722">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756728">if</span>&nbsp;<span class="ident" id="6756731">_</span><span class="op" id="6756732">,</span>&nbsp;<span class="ident" id="6756734">_</span><span class="op" id="6756735">,</span>&nbsp;<span class="ident" id="6756737">err</span>&nbsp;<span class="op" id="6756741">:=</span>&nbsp;<span class="ident" id="6756744">c</span><span class="op" id="6756745">.</span><span class="ident" id="6756746">ReadFromIP</span><span class="op" id="6756756">(</span><span class="ident" id="6756757">rb</span><span class="op" id="6756759">)</span><span class="op" id="6756760">;</span>&nbsp;<span class="ident" id="6756762">err</span>&nbsp;<span class="op" id="6756766">!=</span>&nbsp;<span class="builtintype" id="6756769">nil</span>&nbsp;<span class="op" id="6756773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756777">t</span><span class="op" id="6756778">.</span><span class="ident" id="6756779">Fatalf</span><span class="op" id="6756785">(</span><span class="string" id="6756786">&#34;IPConn.ReadFromIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6756816">,</span>&nbsp;<span class="ident" id="6756818">err</span><span class="op" id="6756821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756827">if</span>&nbsp;<span class="ident" id="6756830">_</span><span class="op" id="6756831">,</span>&nbsp;<span class="ident" id="6756833">_</span><span class="op" id="6756834">,</span>&nbsp;<span class="ident" id="6756836">err</span>&nbsp;<span class="op" id="6756840">:=</span>&nbsp;<span class="ident" id="6756843">c</span><span class="op" id="6756844">.</span><span class="ident" id="6756845">WriteMsgIP</span><span class="op" id="6756855">(</span><span class="ident" id="6756856">wb</span><span class="op" id="6756858">,</span>&nbsp;<span class="builtintype" id="6756860">nil</span><span class="op" id="6756863">,</span>&nbsp;<span class="ident" id="6756865">c</span><span class="op" id="6756866">.</span><span class="ident" id="6756867">LocalAddr</span><span class="op" id="6756876">(</span><span class="op" id="6756877">)</span><span class="op" id="6756878">.</span><span class="op" id="6756879">(</span><span class="op" id="6756880">*</span><span class="ident" id="6756881">IPAddr</span><span class="op" id="6756887">)</span><span class="op" id="6756888">)</span><span class="op" id="6756889">;</span>&nbsp;<span class="ident" id="6756891">err</span>&nbsp;<span class="op" id="6756895">!=</span>&nbsp;<span class="builtintype" id="6756898">nil</span>&nbsp;<span class="op" id="6756902">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756906">condFatalf</span><span class="op" id="6756916">(</span><span class="ident" id="6756917">t</span><span class="op" id="6756918">,</span>&nbsp;<span class="string" id="6756920">&#34;IPConn.WriteMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6756950">,</span>&nbsp;<span class="ident" id="6756952">err</span><span class="op" id="6756955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6756961">if</span>&nbsp;<span class="ident" id="6756964">_</span><span class="op" id="6756965">,</span>&nbsp;<span class="ident" id="6756967">_</span><span class="op" id="6756968">,</span>&nbsp;<span class="ident" id="6756970">_</span><span class="op" id="6756971">,</span>&nbsp;<span class="ident" id="6756973">_</span><span class="op" id="6756974">,</span>&nbsp;<span class="ident" id="6756976">err</span>&nbsp;<span class="op" id="6756980">:=</span>&nbsp;<span class="ident" id="6756983">c</span><span class="op" id="6756984">.</span><span class="ident" id="6756985">ReadMsgIP</span><span class="op" id="6756994">(</span><span class="ident" id="6756995">rb</span><span class="op" id="6756997">,</span>&nbsp;<span class="builtintype" id="6756999">nil</span><span class="op" id="6757002">)</span><span class="op" id="6757003">;</span>&nbsp;<span class="ident" id="6757005">err</span>&nbsp;<span class="op" id="6757009">!=</span>&nbsp;<span class="builtintype" id="6757012">nil</span>&nbsp;<span class="op" id="6757016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757020">condFatalf</span><span class="op" id="6757030">(</span><span class="ident" id="6757031">t</span><span class="op" id="6757032">,</span>&nbsp;<span class="string" id="6757034">&#34;IPConn.ReadMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6757063">,</span>&nbsp;<span class="ident" id="6757065">err</span><span class="op" id="6757068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757071">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757075">if</span>&nbsp;<span class="ident" id="6757078">f</span><span class="op" id="6757079">,</span>&nbsp;<span class="ident" id="6757081">err</span>&nbsp;<span class="op" id="6757085">:=</span>&nbsp;<span class="ident" id="6757088">c</span><span class="op" id="6757089">.</span><span class="ident" id="6757090">File</span><span class="op" id="6757094">(</span><span class="op" id="6757095">)</span><span class="op" id="6757096">;</span>&nbsp;<span class="ident" id="6757098">err</span>&nbsp;<span class="op" id="6757102">!=</span>&nbsp;<span class="builtintype" id="6757105">nil</span>&nbsp;<span class="op" id="6757109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757113">condFatalf</span><span class="op" id="6757123">(</span><span class="ident" id="6757124">t</span><span class="op" id="6757125">,</span>&nbsp;<span class="string" id="6757127">&#34;IPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6757151">,</span>&nbsp;<span class="ident" id="6757153">err</span><span class="op" id="6757156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757159">}</span>&nbsp;<span class="keyword" id="6757161">else</span>&nbsp;<span class="op" id="6757166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757170">f</span><span class="op" id="6757171">.</span><span class="ident" id="6757172">Close</span><span class="op" id="6757177">(</span><span class="op" id="6757178">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757185">defer</span>&nbsp;<span class="keyword" id="6757191">func</span><span class="op" id="6757195">(</span><span class="op" id="6757196">)</span>&nbsp;<span class="op" id="6757198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757202">if</span>&nbsp;<span class="ident" id="6757205">p</span>&nbsp;<span class="op" id="6757207">:=</span>&nbsp;<span class="builtinfunc" id="6757210">recover</span><span class="op" id="6757217">(</span><span class="op" id="6757218">)</span><span class="op" id="6757219">;</span>&nbsp;<span class="ident" id="6757221">p</span>&nbsp;<span class="op" id="6757223">!=</span>&nbsp;<span class="builtintype" id="6757226">nil</span>&nbsp;<span class="op" id="6757230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757235">t</span><span class="op" id="6757236">.</span><span class="ident" id="6757237">Fatalf</span><span class="op" id="6757243">(</span><span class="string" id="6757244">&#34;IPConn.WriteToIP&nbsp;or&nbsp;WriteMsgIP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6757289">,</span>&nbsp;<span class="ident" id="6757291">p</span><span class="op" id="6757292">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757299">}</span><span class="op" id="6757300">(</span><span class="op" id="6757301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757305">c</span><span class="op" id="6757306">.</span><span class="ident" id="6757307">WriteToIP</span><span class="op" id="6757316">(</span><span class="ident" id="6757317">wb</span><span class="op" id="6757319">,</span>&nbsp;<span class="builtintype" id="6757321">nil</span><span class="op" id="6757324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757327">c</span><span class="op" id="6757328">.</span><span class="ident" id="6757329">WriteMsgIP</span><span class="op" id="6757339">(</span><span class="ident" id="6757340">wb</span><span class="op" id="6757342">,</span>&nbsp;<span class="builtintype" id="6757344">nil</span><span class="op" id="6757347">,</span>&nbsp;<span class="builtintype" id="6757349">nil</span><span class="op" id="6757352">)</span><br>
<span class="lineno">235</span><span class="op" id="6757354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6757357">func</span>&nbsp;<span class="ident" id="6757362">TestUnixListenerSpecificMethods</span><span class="op" id="6757393">(</span><span class="ident" id="6757394">t</span>&nbsp;<span class="op" id="6757396">*</span><span class="ident" id="6757397">testing</span><span class="op" id="6757404">.</span><span class="ident" id="6757405">T</span><span class="op" id="6757406">)</span>&nbsp;<span class="op" id="6757408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757411">switch</span>&nbsp;<span class="ident" id="6757418">runtime</span><span class="op" id="6757425">.</span><span class="ident" id="6757426">GOOS</span>&nbsp;<span class="op" id="6757431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757434">case</span>&nbsp;<span class="string" id="6757439">&#34;nacl&#34;</span><span class="op" id="6757445">,</span>&nbsp;<span class="string" id="6757447">&#34;plan9&#34;</span><span class="op" id="6757454">,</span>&nbsp;<span class="string" id="6757456">&#34;windows&#34;</span><span class="op" id="6757465">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757469">t</span><span class="op" id="6757470">.</span><span class="ident" id="6757471">Skipf</span><span class="op" id="6757476">(</span><span class="string" id="6757477">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6757498">,</span>&nbsp;<span class="ident" id="6757500">runtime</span><span class="op" id="6757507">.</span><span class="ident" id="6757508">GOOS</span><span class="op" id="6757512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757519">addr</span>&nbsp;<span class="op" id="6757524">:=</span>&nbsp;<span class="ident" id="6757527">testUnixAddr</span><span class="op" id="6757539">(</span><span class="op" id="6757540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757543">la</span><span class="op" id="6757545">,</span>&nbsp;<span class="ident" id="6757547">err</span>&nbsp;<span class="op" id="6757551">:=</span>&nbsp;<span class="ident" id="6757554">ResolveUnixAddr</span><span class="op" id="6757569">(</span><span class="string" id="6757570">&#34;unix&#34;</span><span class="op" id="6757576">,</span>&nbsp;<span class="ident" id="6757578">addr</span><span class="op" id="6757582">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757585">if</span>&nbsp;<span class="ident" id="6757588">err</span>&nbsp;<span class="op" id="6757592">!=</span>&nbsp;<span class="builtintype" id="6757595">nil</span>&nbsp;<span class="op" id="6757599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757603">t</span><span class="op" id="6757604">.</span><span class="ident" id="6757605">Fatalf</span><span class="op" id="6757611">(</span><span class="string" id="6757612">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6757640">,</span>&nbsp;<span class="ident" id="6757642">err</span><span class="op" id="6757645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757651">ln</span><span class="op" id="6757653">,</span>&nbsp;<span class="ident" id="6757655">err</span>&nbsp;<span class="op" id="6757659">:=</span>&nbsp;<span class="ident" id="6757662">ListenUnix</span><span class="op" id="6757672">(</span><span class="string" id="6757673">&#34;unix&#34;</span><span class="op" id="6757679">,</span>&nbsp;<span class="ident" id="6757681">la</span><span class="op" id="6757683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757686">if</span>&nbsp;<span class="ident" id="6757689">err</span>&nbsp;<span class="op" id="6757693">!=</span>&nbsp;<span class="builtintype" id="6757696">nil</span>&nbsp;<span class="op" id="6757700">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757704">t</span><span class="op" id="6757705">.</span><span class="ident" id="6757706">Fatalf</span><span class="op" id="6757712">(</span><span class="string" id="6757713">&#34;ListenUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6757736">,</span>&nbsp;<span class="ident" id="6757738">err</span><span class="op" id="6757741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757747">defer</span>&nbsp;<span class="ident" id="6757753">ln</span><span class="op" id="6757755">.</span><span class="ident" id="6757756">Close</span><span class="op" id="6757761">(</span><span class="op" id="6757762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757765">defer</span>&nbsp;<span class="ident" id="6757771">os</span><span class="op" id="6757773">.</span><span class="ident" id="6757774">Remove</span><span class="op" id="6757780">(</span><span class="ident" id="6757781">addr</span><span class="op" id="6757785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757788">ln</span><span class="op" id="6757790">.</span><span class="ident" id="6757791">Addr</span><span class="op" id="6757795">(</span><span class="op" id="6757796">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757799">ln</span><span class="op" id="6757801">.</span><span class="ident" id="6757802">SetDeadline</span><span class="op" id="6757813">(</span><span class="ident" id="6757814">time</span><span class="op" id="6757818">.</span><span class="ident" id="6757819">Now</span><span class="op" id="6757822">(</span><span class="op" id="6757823">)</span><span class="op" id="6757824">.</span><span class="ident" id="6757825">Add</span><span class="op" id="6757828">(</span><span class="num" id="6757829">30</span>&nbsp;<span class="op" id="6757832">*</span>&nbsp;<span class="ident" id="6757834">time</span><span class="op" id="6757838">.</span><span class="ident" id="6757839">Nanosecond</span><span class="op" id="6757849">)</span><span class="op" id="6757850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757854">if</span>&nbsp;<span class="ident" id="6757857">c</span><span class="op" id="6757858">,</span>&nbsp;<span class="ident" id="6757860">err</span>&nbsp;<span class="op" id="6757864">:=</span>&nbsp;<span class="ident" id="6757867">ln</span><span class="op" id="6757869">.</span><span class="ident" id="6757870">Accept</span><span class="op" id="6757876">(</span><span class="op" id="6757877">)</span><span class="op" id="6757878">;</span>&nbsp;<span class="ident" id="6757880">err</span>&nbsp;<span class="op" id="6757884">!=</span>&nbsp;<span class="builtintype" id="6757887">nil</span>&nbsp;<span class="op" id="6757891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6757895">if</span>&nbsp;<span class="op" id="6757898">!</span><span class="ident" id="6757899">err</span><span class="op" id="6757902">.</span><span class="op" id="6757903">(</span><span class="ident" id="6757904">Error</span><span class="op" id="6757909">)</span><span class="op" id="6757910">.</span><span class="ident" id="6757911">Timeout</span><span class="op" id="6757918">(</span><span class="op" id="6757919">)</span>&nbsp;<span class="op" id="6757921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757926">t</span><span class="op" id="6757927">.</span><span class="ident" id="6757928">Fatalf</span><span class="op" id="6757934">(</span><span class="string" id="6757935">&#34;UnixListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6757967">,</span>&nbsp;<span class="ident" id="6757969">err</span><span class="op" id="6757972">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757979">}</span>&nbsp;<span class="keyword" id="6757981">else</span>&nbsp;<span class="op" id="6757986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757990">c</span><span class="op" id="6757991">.</span><span class="ident" id="6757992">Close</span><span class="op" id="6757997">(</span><span class="op" id="6757998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758004">if</span>&nbsp;<span class="ident" id="6758007">c</span><span class="op" id="6758008">,</span>&nbsp;<span class="ident" id="6758010">err</span>&nbsp;<span class="op" id="6758014">:=</span>&nbsp;<span class="ident" id="6758017">ln</span><span class="op" id="6758019">.</span><span class="ident" id="6758020">AcceptUnix</span><span class="op" id="6758030">(</span><span class="op" id="6758031">)</span><span class="op" id="6758032">;</span>&nbsp;<span class="ident" id="6758034">err</span>&nbsp;<span class="op" id="6758038">!=</span>&nbsp;<span class="builtintype" id="6758041">nil</span>&nbsp;<span class="op" id="6758045">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758049">if</span>&nbsp;<span class="op" id="6758052">!</span><span class="ident" id="6758053">err</span><span class="op" id="6758056">.</span><span class="op" id="6758057">(</span><span class="ident" id="6758058">Error</span><span class="op" id="6758063">)</span><span class="op" id="6758064">.</span><span class="ident" id="6758065">Timeout</span><span class="op" id="6758072">(</span><span class="op" id="6758073">)</span>&nbsp;<span class="op" id="6758075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758080">t</span><span class="op" id="6758081">.</span><span class="ident" id="6758082">Fatalf</span><span class="op" id="6758088">(</span><span class="string" id="6758089">&#34;UnixListener.AcceptUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6758125">,</span>&nbsp;<span class="ident" id="6758127">err</span><span class="op" id="6758130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758137">}</span>&nbsp;<span class="keyword" id="6758139">else</span>&nbsp;<span class="op" id="6758144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758148">c</span><span class="op" id="6758149">.</span><span class="ident" id="6758150">Close</span><span class="op" id="6758155">(</span><span class="op" id="6758156">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758163">if</span>&nbsp;<span class="ident" id="6758166">f</span><span class="op" id="6758167">,</span>&nbsp;<span class="ident" id="6758169">err</span>&nbsp;<span class="op" id="6758173">:=</span>&nbsp;<span class="ident" id="6758176">ln</span><span class="op" id="6758178">.</span><span class="ident" id="6758179">File</span><span class="op" id="6758183">(</span><span class="op" id="6758184">)</span><span class="op" id="6758185">;</span>&nbsp;<span class="ident" id="6758187">err</span>&nbsp;<span class="op" id="6758191">!=</span>&nbsp;<span class="builtintype" id="6758194">nil</span>&nbsp;<span class="op" id="6758198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758202">t</span><span class="op" id="6758203">.</span><span class="ident" id="6758204">Fatalf</span><span class="op" id="6758210">(</span><span class="string" id="6758211">&#34;UnixListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6758241">,</span>&nbsp;<span class="ident" id="6758243">err</span><span class="op" id="6758246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758249">}</span>&nbsp;<span class="keyword" id="6758251">else</span>&nbsp;<span class="op" id="6758256">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758260">f</span><span class="op" id="6758261">.</span><span class="ident" id="6758262">Close</span><span class="op" id="6758267">(</span><span class="op" id="6758268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758271">}</span><br>
<span class="lineno"></span><span class="op" id="6758273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6758276">func</span>&nbsp;<span class="ident" id="6758281">TestUnixConnSpecificMethods</span><span class="op" id="6758308">(</span><span class="ident" id="6758309">t</span>&nbsp;<span class="op" id="6758311">*</span><span class="ident" id="6758312">testing</span><span class="op" id="6758319">.</span><span class="ident" id="6758320">T</span><span class="op" id="6758321">)</span>&nbsp;<span class="op" id="6758323">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758326">switch</span>&nbsp;<span class="ident" id="6758333">runtime</span><span class="op" id="6758340">.</span><span class="ident" id="6758341">GOOS</span>&nbsp;<span class="op" id="6758346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758349">case</span>&nbsp;<span class="string" id="6758354">&#34;nacl&#34;</span><span class="op" id="6758360">,</span>&nbsp;<span class="string" id="6758362">&#34;plan9&#34;</span><span class="op" id="6758369">,</span>&nbsp;<span class="string" id="6758371">&#34;windows&#34;</span><span class="op" id="6758380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758384">t</span><span class="op" id="6758385">.</span><span class="ident" id="6758386">Skipf</span><span class="op" id="6758391">(</span><span class="string" id="6758392">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6758413">,</span>&nbsp;<span class="ident" id="6758415">runtime</span><span class="op" id="6758422">.</span><span class="ident" id="6758423">GOOS</span><span class="op" id="6758427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758434">addr1</span><span class="op" id="6758439">,</span>&nbsp;<span class="ident" id="6758441">addr2</span><span class="op" id="6758446">,</span>&nbsp;<span class="ident" id="6758448">addr3</span>&nbsp;<span class="op" id="6758454">:=</span>&nbsp;<span class="ident" id="6758457">testUnixAddr</span><span class="op" id="6758469">(</span><span class="op" id="6758470">)</span><span class="op" id="6758471">,</span>&nbsp;<span class="ident" id="6758473">testUnixAddr</span><span class="op" id="6758485">(</span><span class="op" id="6758486">)</span><span class="op" id="6758487">,</span>&nbsp;<span class="ident" id="6758489">testUnixAddr</span><span class="op" id="6758501">(</span><span class="op" id="6758502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758506">a1</span><span class="op" id="6758508">,</span>&nbsp;<span class="ident" id="6758510">err</span>&nbsp;<span class="op" id="6758514">:=</span>&nbsp;<span class="ident" id="6758517">ResolveUnixAddr</span><span class="op" id="6758532">(</span><span class="string" id="6758533">&#34;unixgram&#34;</span><span class="op" id="6758543">,</span>&nbsp;<span class="ident" id="6758545">addr1</span><span class="op" id="6758550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758553">if</span>&nbsp;<span class="ident" id="6758556">err</span>&nbsp;<span class="op" id="6758560">!=</span>&nbsp;<span class="builtintype" id="6758563">nil</span>&nbsp;<span class="op" id="6758567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758571">t</span><span class="op" id="6758572">.</span><span class="ident" id="6758573">Fatalf</span><span class="op" id="6758579">(</span><span class="string" id="6758580">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6758608">,</span>&nbsp;<span class="ident" id="6758610">err</span><span class="op" id="6758613">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758619">c1</span><span class="op" id="6758621">,</span>&nbsp;<span class="ident" id="6758623">err</span>&nbsp;<span class="op" id="6758627">:=</span>&nbsp;<span class="ident" id="6758630">DialUnix</span><span class="op" id="6758638">(</span><span class="string" id="6758639">&#34;unixgram&#34;</span><span class="op" id="6758649">,</span>&nbsp;<span class="ident" id="6758651">a1</span><span class="op" id="6758653">,</span>&nbsp;<span class="builtintype" id="6758655">nil</span><span class="op" id="6758658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758661">if</span>&nbsp;<span class="ident" id="6758664">err</span>&nbsp;<span class="op" id="6758668">!=</span>&nbsp;<span class="builtintype" id="6758671">nil</span>&nbsp;<span class="op" id="6758675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758679">t</span><span class="op" id="6758680">.</span><span class="ident" id="6758681">Fatalf</span><span class="op" id="6758687">(</span><span class="string" id="6758688">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6758709">,</span>&nbsp;<span class="ident" id="6758711">err</span><span class="op" id="6758714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758717">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758720">defer</span>&nbsp;<span class="ident" id="6758726">c1</span><span class="op" id="6758728">.</span><span class="ident" id="6758729">Close</span><span class="op" id="6758734">(</span><span class="op" id="6758735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6758738">defer</span>&nbsp;<span class="ident" id="6758744">os</span><span class="op" id="6758746">.</span><span class="ident" id="6758747">Remove</span><span class="op" id="6758753">(</span><span class="ident" id="6758754">addr1</span><span class="op" id="6758759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758762">c1</span><span class="op" id="6758764">.</span><span class="ident" id="6758765">LocalAddr</span><span class="op" id="6758774">(</span><span class="op" id="6758775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758778">c1</span><span class="op" id="6758780">.</span><span class="ident" id="6758781">RemoteAddr</span><span class="op" id="6758791">(</span><span class="op" id="6758792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758795">c1</span><span class="op" id="6758797">.</span><span class="ident" id="6758798">SetDeadline</span><span class="op" id="6758809">(</span><span class="ident" id="6758810">time</span><span class="op" id="6758814">.</span><span class="ident" id="6758815">Now</span><span class="op" id="6758818">(</span><span class="op" id="6758819">)</span><span class="op" id="6758820">.</span><span class="ident" id="6758821">Add</span><span class="op" id="6758824">(</span><span class="ident" id="6758825">someTimeout</span><span class="op" id="6758836">)</span><span class="op" id="6758837">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758840">c1</span><span class="op" id="6758842">.</span><span class="ident" id="6758843">SetReadDeadline</span><span class="op" id="6758858">(</span><span class="ident" id="6758859">time</span><span class="op" id="6758863">.</span><span class="ident" id="6758864">Now</span><span class="op" id="6758867">(</span><span class="op" id="6758868">)</span><span class="op" id="6758869">.</span><span class="ident" id="6758870">Add</span><span class="op" id="6758873">(</span><span class="ident" id="6758874">someTimeout</span><span class="op" id="6758885">)</span><span class="op" id="6758886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758889">c1</span><span class="op" id="6758891">.</span><span class="ident" id="6758892">SetWriteDeadline</span><span class="op" id="6758908">(</span><span class="ident" id="6758909">time</span><span class="op" id="6758913">.</span><span class="ident" id="6758914">Now</span><span class="op" id="6758917">(</span><span class="op" id="6758918">)</span><span class="op" id="6758919">.</span><span class="ident" id="6758920">Add</span><span class="op" id="6758923">(</span><span class="ident" id="6758924">someTimeout</span><span class="op" id="6758935">)</span><span class="op" id="6758936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758939">c1</span><span class="op" id="6758941">.</span><span class="ident" id="6758942">SetReadBuffer</span><span class="op" id="6758955">(</span><span class="num" id="6758956">2048</span><span class="op" id="6758960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758963">c1</span><span class="op" id="6758965">.</span><span class="ident" id="6758966">SetWriteBuffer</span><span class="op" id="6758980">(</span><span class="num" id="6758981">2048</span><span class="op" id="6758985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758989">a2</span><span class="op" id="6758991">,</span>&nbsp;<span class="ident" id="6758993">err</span>&nbsp;<span class="op" id="6758997">:=</span>&nbsp;<span class="ident" id="6759000">ResolveUnixAddr</span><span class="op" id="6759015">(</span><span class="string" id="6759016">&#34;unixgram&#34;</span><span class="op" id="6759026">,</span>&nbsp;<span class="ident" id="6759028">addr2</span><span class="op" id="6759033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759036">if</span>&nbsp;<span class="ident" id="6759039">err</span>&nbsp;<span class="op" id="6759043">!=</span>&nbsp;<span class="builtintype" id="6759046">nil</span>&nbsp;<span class="op" id="6759050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759054">t</span><span class="op" id="6759055">.</span><span class="ident" id="6759056">Fatalf</span><span class="op" id="6759062">(</span><span class="string" id="6759063">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6759091">,</span>&nbsp;<span class="ident" id="6759093">err</span><span class="op" id="6759096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759102">c2</span><span class="op" id="6759104">,</span>&nbsp;<span class="ident" id="6759106">err</span>&nbsp;<span class="op" id="6759110">:=</span>&nbsp;<span class="ident" id="6759113">DialUnix</span><span class="op" id="6759121">(</span><span class="string" id="6759122">&#34;unixgram&#34;</span><span class="op" id="6759132">,</span>&nbsp;<span class="ident" id="6759134">a2</span><span class="op" id="6759136">,</span>&nbsp;<span class="builtintype" id="6759138">nil</span><span class="op" id="6759141">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759144">if</span>&nbsp;<span class="ident" id="6759147">err</span>&nbsp;<span class="op" id="6759151">!=</span>&nbsp;<span class="builtintype" id="6759154">nil</span>&nbsp;<span class="op" id="6759158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759162">t</span><span class="op" id="6759163">.</span><span class="ident" id="6759164">Fatalf</span><span class="op" id="6759170">(</span><span class="string" id="6759171">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6759192">,</span>&nbsp;<span class="ident" id="6759194">err</span><span class="op" id="6759197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759203">defer</span>&nbsp;<span class="ident" id="6759209">c2</span><span class="op" id="6759211">.</span><span class="ident" id="6759212">Close</span><span class="op" id="6759217">(</span><span class="op" id="6759218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759221">defer</span>&nbsp;<span class="ident" id="6759227">os</span><span class="op" id="6759229">.</span><span class="ident" id="6759230">Remove</span><span class="op" id="6759236">(</span><span class="ident" id="6759237">addr2</span><span class="op" id="6759242">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759245">c2</span><span class="op" id="6759247">.</span><span class="ident" id="6759248">LocalAddr</span><span class="op" id="6759257">(</span><span class="op" id="6759258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759261">c2</span><span class="op" id="6759263">.</span><span class="ident" id="6759264">RemoteAddr</span><span class="op" id="6759274">(</span><span class="op" id="6759275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759278">c2</span><span class="op" id="6759280">.</span><span class="ident" id="6759281">SetDeadline</span><span class="op" id="6759292">(</span><span class="ident" id="6759293">time</span><span class="op" id="6759297">.</span><span class="ident" id="6759298">Now</span><span class="op" id="6759301">(</span><span class="op" id="6759302">)</span><span class="op" id="6759303">.</span><span class="ident" id="6759304">Add</span><span class="op" id="6759307">(</span><span class="ident" id="6759308">someTimeout</span><span class="op" id="6759319">)</span><span class="op" id="6759320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759323">c2</span><span class="op" id="6759325">.</span><span class="ident" id="6759326">SetReadDeadline</span><span class="op" id="6759341">(</span><span class="ident" id="6759342">time</span><span class="op" id="6759346">.</span><span class="ident" id="6759347">Now</span><span class="op" id="6759350">(</span><span class="op" id="6759351">)</span><span class="op" id="6759352">.</span><span class="ident" id="6759353">Add</span><span class="op" id="6759356">(</span><span class="ident" id="6759357">someTimeout</span><span class="op" id="6759368">)</span><span class="op" id="6759369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759372">c2</span><span class="op" id="6759374">.</span><span class="ident" id="6759375">SetWriteDeadline</span><span class="op" id="6759391">(</span><span class="ident" id="6759392">time</span><span class="op" id="6759396">.</span><span class="ident" id="6759397">Now</span><span class="op" id="6759400">(</span><span class="op" id="6759401">)</span><span class="op" id="6759402">.</span><span class="ident" id="6759403">Add</span><span class="op" id="6759406">(</span><span class="ident" id="6759407">someTimeout</span><span class="op" id="6759418">)</span><span class="op" id="6759419">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759422">c2</span><span class="op" id="6759424">.</span><span class="ident" id="6759425">SetReadBuffer</span><span class="op" id="6759438">(</span><span class="num" id="6759439">2048</span><span class="op" id="6759443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759446">c2</span><span class="op" id="6759448">.</span><span class="ident" id="6759449">SetWriteBuffer</span><span class="op" id="6759463">(</span><span class="num" id="6759464">2048</span><span class="op" id="6759468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759472">a3</span><span class="op" id="6759474">,</span>&nbsp;<span class="ident" id="6759476">err</span>&nbsp;<span class="op" id="6759480">:=</span>&nbsp;<span class="ident" id="6759483">ResolveUnixAddr</span><span class="op" id="6759498">(</span><span class="string" id="6759499">&#34;unixgram&#34;</span><span class="op" id="6759509">,</span>&nbsp;<span class="ident" id="6759511">addr3</span><span class="op" id="6759516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759519">if</span>&nbsp;<span class="ident" id="6759522">err</span>&nbsp;<span class="op" id="6759526">!=</span>&nbsp;<span class="builtintype" id="6759529">nil</span>&nbsp;<span class="op" id="6759533">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759537">t</span><span class="op" id="6759538">.</span><span class="ident" id="6759539">Fatalf</span><span class="op" id="6759545">(</span><span class="string" id="6759546">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6759574">,</span>&nbsp;<span class="ident" id="6759576">err</span><span class="op" id="6759579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759585">c3</span><span class="op" id="6759587">,</span>&nbsp;<span class="ident" id="6759589">err</span>&nbsp;<span class="op" id="6759593">:=</span>&nbsp;<span class="ident" id="6759596">ListenUnixgram</span><span class="op" id="6759610">(</span><span class="string" id="6759611">&#34;unixgram&#34;</span><span class="op" id="6759621">,</span>&nbsp;<span class="ident" id="6759623">a3</span><span class="op" id="6759625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759628">if</span>&nbsp;<span class="ident" id="6759631">err</span>&nbsp;<span class="op" id="6759635">!=</span>&nbsp;<span class="builtintype" id="6759638">nil</span>&nbsp;<span class="op" id="6759642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759646">t</span><span class="op" id="6759647">.</span><span class="ident" id="6759648">Fatalf</span><span class="op" id="6759654">(</span><span class="string" id="6759655">&#34;ListenUnixgram&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6759682">,</span>&nbsp;<span class="ident" id="6759684">err</span><span class="op" id="6759687">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759693">defer</span>&nbsp;<span class="ident" id="6759699">c3</span><span class="op" id="6759701">.</span><span class="ident" id="6759702">Close</span><span class="op" id="6759707">(</span><span class="op" id="6759708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759711">defer</span>&nbsp;<span class="ident" id="6759717">os</span><span class="op" id="6759719">.</span><span class="ident" id="6759720">Remove</span><span class="op" id="6759726">(</span><span class="ident" id="6759727">addr3</span><span class="op" id="6759732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759735">c3</span><span class="op" id="6759737">.</span><span class="ident" id="6759738">LocalAddr</span><span class="op" id="6759747">(</span><span class="op" id="6759748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759751">c3</span><span class="op" id="6759753">.</span><span class="ident" id="6759754">RemoteAddr</span><span class="op" id="6759764">(</span><span class="op" id="6759765">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759768">c3</span><span class="op" id="6759770">.</span><span class="ident" id="6759771">SetDeadline</span><span class="op" id="6759782">(</span><span class="ident" id="6759783">time</span><span class="op" id="6759787">.</span><span class="ident" id="6759788">Now</span><span class="op" id="6759791">(</span><span class="op" id="6759792">)</span><span class="op" id="6759793">.</span><span class="ident" id="6759794">Add</span><span class="op" id="6759797">(</span><span class="ident" id="6759798">someTimeout</span><span class="op" id="6759809">)</span><span class="op" id="6759810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759813">c3</span><span class="op" id="6759815">.</span><span class="ident" id="6759816">SetReadDeadline</span><span class="op" id="6759831">(</span><span class="ident" id="6759832">time</span><span class="op" id="6759836">.</span><span class="ident" id="6759837">Now</span><span class="op" id="6759840">(</span><span class="op" id="6759841">)</span><span class="op" id="6759842">.</span><span class="ident" id="6759843">Add</span><span class="op" id="6759846">(</span><span class="ident" id="6759847">someTimeout</span><span class="op" id="6759858">)</span><span class="op" id="6759859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759862">c3</span><span class="op" id="6759864">.</span><span class="ident" id="6759865">SetWriteDeadline</span><span class="op" id="6759881">(</span><span class="ident" id="6759882">time</span><span class="op" id="6759886">.</span><span class="ident" id="6759887">Now</span><span class="op" id="6759890">(</span><span class="op" id="6759891">)</span><span class="op" id="6759892">.</span><span class="ident" id="6759893">Add</span><span class="op" id="6759896">(</span><span class="ident" id="6759897">someTimeout</span><span class="op" id="6759908">)</span><span class="op" id="6759909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759912">c3</span><span class="op" id="6759914">.</span><span class="ident" id="6759915">SetReadBuffer</span><span class="op" id="6759928">(</span><span class="num" id="6759929">2048</span><span class="op" id="6759933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759936">c3</span><span class="op" id="6759938">.</span><span class="ident" id="6759939">SetWriteBuffer</span><span class="op" id="6759953">(</span><span class="num" id="6759954">2048</span><span class="op" id="6759958">)</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759962">wb</span>&nbsp;<span class="op" id="6759965">:=</span>&nbsp;<span class="op" id="6759968">[</span><span class="op" id="6759969">]</span><span class="builtintype" id="6759970">byte</span><span class="op" id="6759974">(</span><span class="string" id="6759975">&#34;UNIXCONN&nbsp;TEST&#34;</span><span class="op" id="6759990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759993">rb1</span>&nbsp;<span class="op" id="6759997">:=</span>&nbsp;<span class="builtinfunc" id="6760000">make</span><span class="op" id="6760004">(</span><span class="op" id="6760005">[</span><span class="op" id="6760006">]</span><span class="builtintype" id="6760007">byte</span><span class="op" id="6760011">,</span>&nbsp;<span class="num" id="6760013">128</span><span class="op" id="6760016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760019">rb2</span>&nbsp;<span class="op" id="6760023">:=</span>&nbsp;<span class="builtinfunc" id="6760026">make</span><span class="op" id="6760030">(</span><span class="op" id="6760031">[</span><span class="op" id="6760032">]</span><span class="builtintype" id="6760033">byte</span><span class="op" id="6760037">,</span>&nbsp;<span class="num" id="6760039">128</span><span class="op" id="6760042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760045">rb3</span>&nbsp;<span class="op" id="6760049">:=</span>&nbsp;<span class="builtinfunc" id="6760052">make</span><span class="op" id="6760056">(</span><span class="op" id="6760057">[</span><span class="op" id="6760058">]</span><span class="builtintype" id="6760059">byte</span><span class="op" id="6760063">,</span>&nbsp;<span class="num" id="6760065">128</span><span class="op" id="6760068">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760071">if</span>&nbsp;<span class="ident" id="6760074">_</span><span class="op" id="6760075">,</span>&nbsp;<span class="ident" id="6760077">_</span><span class="op" id="6760078">,</span>&nbsp;<span class="ident" id="6760080">err</span>&nbsp;<span class="op" id="6760084">:=</span>&nbsp;<span class="ident" id="6760087">c1</span><span class="op" id="6760089">.</span><span class="ident" id="6760090">WriteMsgUnix</span><span class="op" id="6760102">(</span><span class="ident" id="6760103">wb</span><span class="op" id="6760105">,</span>&nbsp;<span class="builtintype" id="6760107">nil</span><span class="op" id="6760110">,</span>&nbsp;<span class="ident" id="6760112">a2</span><span class="op" id="6760114">)</span><span class="op" id="6760115">;</span>&nbsp;<span class="ident" id="6760117">err</span>&nbsp;<span class="op" id="6760121">!=</span>&nbsp;<span class="builtintype" id="6760124">nil</span>&nbsp;<span class="op" id="6760128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760132">t</span><span class="op" id="6760133">.</span><span class="ident" id="6760134">Fatalf</span><span class="op" id="6760140">(</span><span class="string" id="6760141">&#34;UnixConn.WriteMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760175">,</span>&nbsp;<span class="ident" id="6760177">err</span><span class="op" id="6760180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760186">if</span>&nbsp;<span class="ident" id="6760189">_</span><span class="op" id="6760190">,</span>&nbsp;<span class="ident" id="6760192">_</span><span class="op" id="6760193">,</span>&nbsp;<span class="ident" id="6760195">_</span><span class="op" id="6760196">,</span>&nbsp;<span class="ident" id="6760198">_</span><span class="op" id="6760199">,</span>&nbsp;<span class="ident" id="6760201">err</span>&nbsp;<span class="op" id="6760205">:=</span>&nbsp;<span class="ident" id="6760208">c2</span><span class="op" id="6760210">.</span><span class="ident" id="6760211">ReadMsgUnix</span><span class="op" id="6760222">(</span><span class="ident" id="6760223">rb2</span><span class="op" id="6760226">,</span>&nbsp;<span class="builtintype" id="6760228">nil</span><span class="op" id="6760231">)</span><span class="op" id="6760232">;</span>&nbsp;<span class="ident" id="6760234">err</span>&nbsp;<span class="op" id="6760238">!=</span>&nbsp;<span class="builtintype" id="6760241">nil</span>&nbsp;<span class="op" id="6760245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760249">t</span><span class="op" id="6760250">.</span><span class="ident" id="6760251">Fatalf</span><span class="op" id="6760257">(</span><span class="string" id="6760258">&#34;UnixConn.ReadMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760291">,</span>&nbsp;<span class="ident" id="6760293">err</span><span class="op" id="6760296">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760302">if</span>&nbsp;<span class="ident" id="6760305">_</span><span class="op" id="6760306">,</span>&nbsp;<span class="ident" id="6760308">err</span>&nbsp;<span class="op" id="6760312">:=</span>&nbsp;<span class="ident" id="6760315">c2</span><span class="op" id="6760317">.</span><span class="ident" id="6760318">WriteToUnix</span><span class="op" id="6760329">(</span><span class="ident" id="6760330">wb</span><span class="op" id="6760332">,</span>&nbsp;<span class="ident" id="6760334">a1</span><span class="op" id="6760336">)</span><span class="op" id="6760337">;</span>&nbsp;<span class="ident" id="6760339">err</span>&nbsp;<span class="op" id="6760343">!=</span>&nbsp;<span class="builtintype" id="6760346">nil</span>&nbsp;<span class="op" id="6760350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760354">t</span><span class="op" id="6760355">.</span><span class="ident" id="6760356">Fatalf</span><span class="op" id="6760362">(</span><span class="string" id="6760363">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760396">,</span>&nbsp;<span class="ident" id="6760398">err</span><span class="op" id="6760401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760407">if</span>&nbsp;<span class="ident" id="6760410">_</span><span class="op" id="6760411">,</span>&nbsp;<span class="ident" id="6760413">_</span><span class="op" id="6760414">,</span>&nbsp;<span class="ident" id="6760416">err</span>&nbsp;<span class="op" id="6760420">:=</span>&nbsp;<span class="ident" id="6760423">c1</span><span class="op" id="6760425">.</span><span class="ident" id="6760426">ReadFromUnix</span><span class="op" id="6760438">(</span><span class="ident" id="6760439">rb1</span><span class="op" id="6760442">)</span><span class="op" id="6760443">;</span>&nbsp;<span class="ident" id="6760445">err</span>&nbsp;<span class="op" id="6760449">!=</span>&nbsp;<span class="builtintype" id="6760452">nil</span>&nbsp;<span class="op" id="6760456">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760460">t</span><span class="op" id="6760461">.</span><span class="ident" id="6760462">Fatalf</span><span class="op" id="6760468">(</span><span class="string" id="6760469">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760503">,</span>&nbsp;<span class="ident" id="6760505">err</span><span class="op" id="6760508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760514">if</span>&nbsp;<span class="ident" id="6760517">_</span><span class="op" id="6760518">,</span>&nbsp;<span class="ident" id="6760520">err</span>&nbsp;<span class="op" id="6760524">:=</span>&nbsp;<span class="ident" id="6760527">c3</span><span class="op" id="6760529">.</span><span class="ident" id="6760530">WriteToUnix</span><span class="op" id="6760541">(</span><span class="ident" id="6760542">wb</span><span class="op" id="6760544">,</span>&nbsp;<span class="ident" id="6760546">a1</span><span class="op" id="6760548">)</span><span class="op" id="6760549">;</span>&nbsp;<span class="ident" id="6760551">err</span>&nbsp;<span class="op" id="6760555">!=</span>&nbsp;<span class="builtintype" id="6760558">nil</span>&nbsp;<span class="op" id="6760562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760566">t</span><span class="op" id="6760567">.</span><span class="ident" id="6760568">Fatalf</span><span class="op" id="6760574">(</span><span class="string" id="6760575">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760608">,</span>&nbsp;<span class="ident" id="6760610">err</span><span class="op" id="6760613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760616">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760619">if</span>&nbsp;<span class="ident" id="6760622">_</span><span class="op" id="6760623">,</span>&nbsp;<span class="ident" id="6760625">_</span><span class="op" id="6760626">,</span>&nbsp;<span class="ident" id="6760628">err</span>&nbsp;<span class="op" id="6760632">:=</span>&nbsp;<span class="ident" id="6760635">c1</span><span class="op" id="6760637">.</span><span class="ident" id="6760638">ReadFromUnix</span><span class="op" id="6760650">(</span><span class="ident" id="6760651">rb1</span><span class="op" id="6760654">)</span><span class="op" id="6760655">;</span>&nbsp;<span class="ident" id="6760657">err</span>&nbsp;<span class="op" id="6760661">!=</span>&nbsp;<span class="builtintype" id="6760664">nil</span>&nbsp;<span class="op" id="6760668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760672">t</span><span class="op" id="6760673">.</span><span class="ident" id="6760674">Fatalf</span><span class="op" id="6760680">(</span><span class="string" id="6760681">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760715">,</span>&nbsp;<span class="ident" id="6760717">err</span><span class="op" id="6760720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760726">if</span>&nbsp;<span class="ident" id="6760729">_</span><span class="op" id="6760730">,</span>&nbsp;<span class="ident" id="6760732">err</span>&nbsp;<span class="op" id="6760736">:=</span>&nbsp;<span class="ident" id="6760739">c2</span><span class="op" id="6760741">.</span><span class="ident" id="6760742">WriteToUnix</span><span class="op" id="6760753">(</span><span class="ident" id="6760754">wb</span><span class="op" id="6760756">,</span>&nbsp;<span class="ident" id="6760758">a3</span><span class="op" id="6760760">)</span><span class="op" id="6760761">;</span>&nbsp;<span class="ident" id="6760763">err</span>&nbsp;<span class="op" id="6760767">!=</span>&nbsp;<span class="builtintype" id="6760770">nil</span>&nbsp;<span class="op" id="6760774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760778">t</span><span class="op" id="6760779">.</span><span class="ident" id="6760780">Fatalf</span><span class="op" id="6760786">(</span><span class="string" id="6760787">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760820">,</span>&nbsp;<span class="ident" id="6760822">err</span><span class="op" id="6760825">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760831">if</span>&nbsp;<span class="ident" id="6760834">_</span><span class="op" id="6760835">,</span>&nbsp;<span class="ident" id="6760837">_</span><span class="op" id="6760838">,</span>&nbsp;<span class="ident" id="6760840">err</span>&nbsp;<span class="op" id="6760844">:=</span>&nbsp;<span class="ident" id="6760847">c3</span><span class="op" id="6760849">.</span><span class="ident" id="6760850">ReadFromUnix</span><span class="op" id="6760862">(</span><span class="ident" id="6760863">rb3</span><span class="op" id="6760866">)</span><span class="op" id="6760867">;</span>&nbsp;<span class="ident" id="6760869">err</span>&nbsp;<span class="op" id="6760873">!=</span>&nbsp;<span class="builtintype" id="6760876">nil</span>&nbsp;<span class="op" id="6760880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760884">t</span><span class="op" id="6760885">.</span><span class="ident" id="6760886">Fatalf</span><span class="op" id="6760892">(</span><span class="string" id="6760893">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6760927">,</span>&nbsp;<span class="ident" id="6760929">err</span><span class="op" id="6760932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760939">if</span>&nbsp;<span class="ident" id="6760942">f</span><span class="op" id="6760943">,</span>&nbsp;<span class="ident" id="6760945">err</span>&nbsp;<span class="op" id="6760949">:=</span>&nbsp;<span class="ident" id="6760952">c1</span><span class="op" id="6760954">.</span><span class="ident" id="6760955">File</span><span class="op" id="6760959">(</span><span class="op" id="6760960">)</span><span class="op" id="6760961">;</span>&nbsp;<span class="ident" id="6760963">err</span>&nbsp;<span class="op" id="6760967">!=</span>&nbsp;<span class="builtintype" id="6760970">nil</span>&nbsp;<span class="op" id="6760974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760978">t</span><span class="op" id="6760979">.</span><span class="ident" id="6760980">Fatalf</span><span class="op" id="6760986">(</span><span class="string" id="6760987">&#34;UnixConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6761013">,</span>&nbsp;<span class="ident" id="6761015">err</span><span class="op" id="6761018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761021">}</span>&nbsp;<span class="keyword" id="6761023">else</span>&nbsp;<span class="op" id="6761028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761032">f</span><span class="op" id="6761033">.</span><span class="ident" id="6761034">Close</span><span class="op" id="6761039">(</span><span class="op" id="6761040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761043">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6761047">defer</span>&nbsp;<span class="keyword" id="6761053">func</span><span class="op" id="6761057">(</span><span class="op" id="6761058">)</span>&nbsp;<span class="op" id="6761060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6761064">if</span>&nbsp;<span class="ident" id="6761067">p</span>&nbsp;<span class="op" id="6761069">:=</span>&nbsp;<span class="builtinfunc" id="6761072">recover</span><span class="op" id="6761079">(</span><span class="op" id="6761080">)</span><span class="op" id="6761081">;</span>&nbsp;<span class="ident" id="6761083">p</span>&nbsp;<span class="op" id="6761085">!=</span>&nbsp;<span class="builtintype" id="6761088">nil</span>&nbsp;<span class="op" id="6761092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761097">t</span><span class="op" id="6761098">.</span><span class="ident" id="6761099">Fatalf</span><span class="op" id="6761105">(</span><span class="string" id="6761106">&#34;UnixConn.WriteToUnix&nbsp;or&nbsp;WriteMsgUnix&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6761157">,</span>&nbsp;<span class="ident" id="6761159">p</span><span class="op" id="6761160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761164">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761167">}</span><span class="op" id="6761168">(</span><span class="op" id="6761169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761173">c1</span><span class="op" id="6761175">.</span><span class="ident" id="6761176">WriteToUnix</span><span class="op" id="6761187">(</span><span class="ident" id="6761188">wb</span><span class="op" id="6761190">,</span>&nbsp;<span class="builtintype" id="6761192">nil</span><span class="op" id="6761195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761198">c1</span><span class="op" id="6761200">.</span><span class="ident" id="6761201">WriteMsgUnix</span><span class="op" id="6761213">(</span><span class="ident" id="6761214">wb</span><span class="op" id="6761216">,</span>&nbsp;<span class="builtintype" id="6761218">nil</span><span class="op" id="6761221">,</span>&nbsp;<span class="builtintype" id="6761223">nil</span><span class="op" id="6761226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761229">c3</span><span class="op" id="6761231">.</span><span class="ident" id="6761232">WriteToUnix</span><span class="op" id="6761243">(</span><span class="ident" id="6761244">wb</span><span class="op" id="6761246">,</span>&nbsp;<span class="builtintype" id="6761248">nil</span><span class="op" id="6761251">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761254">c3</span><span class="op" id="6761256">.</span><span class="ident" id="6761257">WriteMsgUnix</span><span class="op" id="6761269">(</span><span class="ident" id="6761270">wb</span><span class="op" id="6761272">,</span>&nbsp;<span class="builtintype" id="6761274">nil</span><span class="op" id="6761277">,</span>&nbsp;<span class="builtintype" id="6761279">nil</span><span class="op" id="6761282">)</span><br>
<span class="lineno"></span><span class="op" id="6761284">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
