<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4238306">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4238361">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4238415">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4238466">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4238541">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4238552">package</span>&nbsp;<span class="ident" id="4238560">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4238570">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4238645">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4238720">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4238800">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4238875">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4238949">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4239014">import</span>&nbsp;<span class="op" id="4239021">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4239024">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4239030">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4239042">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4239049">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4239052">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4239116">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4239177">type</span>&nbsp;<span class="ident" id="4239182">Curve</span>&nbsp;<span class="keyword" id="4239188">interface</span>&nbsp;<span class="op" id="4239198">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239201">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239250">Params</span><span class="op" id="4239256">(</span><span class="op" id="4239257">)</span>&nbsp;<span class="op" id="4239259">*</span><span class="ident" id="4239260">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239273">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239338">IsOnCurve</span><span class="op" id="4239347">(</span><span class="ident" id="4239348">x</span><span class="op" id="4239349">,</span>&nbsp;<span class="ident" id="4239351">y</span>&nbsp;<span class="op" id="4239353">*</span><span class="ident" id="4239354">big</span><span class="op" id="4239357">.</span><span class="ident" id="4239358">Int</span><span class="op" id="4239361">)</span>&nbsp;<span class="builtintype" id="4239363">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239369">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239416">Add</span><span class="op" id="4239419">(</span><span class="ident" id="4239420">x1</span><span class="op" id="4239422">,</span>&nbsp;<span class="ident" id="4239424">y1</span><span class="op" id="4239426">,</span>&nbsp;<span class="ident" id="4239428">x2</span><span class="op" id="4239430">,</span>&nbsp;<span class="ident" id="4239432">y2</span>&nbsp;<span class="op" id="4239435">*</span><span class="ident" id="4239436">big</span><span class="op" id="4239439">.</span><span class="ident" id="4239440">Int</span><span class="op" id="4239443">)</span>&nbsp;<span class="op" id="4239445">(</span><span class="ident" id="4239446">x</span><span class="op" id="4239447">,</span>&nbsp;<span class="ident" id="4239449">y</span>&nbsp;<span class="op" id="4239451">*</span><span class="ident" id="4239452">big</span><span class="op" id="4239455">.</span><span class="ident" id="4239456">Int</span><span class="op" id="4239459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239462">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239489">Double</span><span class="op" id="4239495">(</span><span class="ident" id="4239496">x1</span><span class="op" id="4239498">,</span>&nbsp;<span class="ident" id="4239500">y1</span>&nbsp;<span class="op" id="4239503">*</span><span class="ident" id="4239504">big</span><span class="op" id="4239507">.</span><span class="ident" id="4239508">Int</span><span class="op" id="4239511">)</span>&nbsp;<span class="op" id="4239513">(</span><span class="ident" id="4239514">x</span><span class="op" id="4239515">,</span>&nbsp;<span class="ident" id="4239517">y</span>&nbsp;<span class="op" id="4239519">*</span><span class="ident" id="4239520">big</span><span class="op" id="4239523">.</span><span class="ident" id="4239524">Int</span><span class="op" id="4239527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239530">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239603">ScalarMult</span><span class="op" id="4239613">(</span><span class="ident" id="4239614">x1</span><span class="op" id="4239616">,</span>&nbsp;<span class="ident" id="4239618">y1</span>&nbsp;<span class="op" id="4239621">*</span><span class="ident" id="4239622">big</span><span class="op" id="4239625">.</span><span class="ident" id="4239626">Int</span><span class="op" id="4239629">,</span>&nbsp;<span class="ident" id="4239631">k</span>&nbsp;<span class="op" id="4239633">[</span><span class="op" id="4239634">]</span><span class="builtintype" id="4239635">byte</span><span class="op" id="4239639">)</span>&nbsp;<span class="op" id="4239641">(</span><span class="ident" id="4239642">x</span><span class="op" id="4239643">,</span>&nbsp;<span class="ident" id="4239645">y</span>&nbsp;<span class="op" id="4239647">*</span><span class="ident" id="4239648">big</span><span class="op" id="4239651">.</span><span class="ident" id="4239652">Int</span><span class="op" id="4239655">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239658">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4239729">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239773">ScalarBaseMult</span><span class="op" id="4239787">(</span><span class="ident" id="4239788">k</span>&nbsp;<span class="op" id="4239790">[</span><span class="op" id="4239791">]</span><span class="builtintype" id="4239792">byte</span><span class="op" id="4239796">)</span>&nbsp;<span class="op" id="4239798">(</span><span class="ident" id="4239799">x</span><span class="op" id="4239800">,</span>&nbsp;<span class="ident" id="4239802">y</span>&nbsp;<span class="op" id="4239804">*</span><span class="ident" id="4239805">big</span><span class="op" id="4239808">.</span><span class="ident" id="4239809">Int</span><span class="op" id="4239812">)</span><br>
<span class="lineno"></span><span class="op" id="4239814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4239817">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4239895">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4239952">type</span>&nbsp;<span class="ident" id="4239957">CurveParams</span>&nbsp;<span class="keyword" id="4239969">struct</span>&nbsp;<span class="op" id="4239976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4239979">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4239987">*</span><span class="ident" id="4239988">big</span><span class="op" id="4239991">.</span><span class="ident" id="4239992">Int</span>&nbsp;<span class="comment" id="4239996">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240034">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240042">*</span><span class="ident" id="4240043">big</span><span class="op" id="4240046">.</span><span class="ident" id="4240047">Int</span>&nbsp;<span class="comment" id="4240051">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240083">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240091">*</span><span class="ident" id="4240092">big</span><span class="op" id="4240095">.</span><span class="ident" id="4240096">Int</span>&nbsp;<span class="comment" id="4240100">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240139">Gx</span><span class="op" id="4240141">,</span>&nbsp;<span class="ident" id="4240143">Gy</span>&nbsp;&nbsp;<span class="op" id="4240147">*</span><span class="ident" id="4240148">big</span><span class="op" id="4240151">.</span><span class="ident" id="4240152">Int</span>&nbsp;<span class="comment" id="4240156">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240184">BitSize</span>&nbsp;<span class="builtintype" id="4240192">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4240201">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4240237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4240240">func</span>&nbsp;<span class="op" id="4240245">(</span><span class="ident" id="4240246">curve</span>&nbsp;<span class="op" id="4240252">*</span><span class="ident" id="4240253">CurveParams</span><span class="op" id="4240264">)</span>&nbsp;<span class="ident" id="4240266">Params</span><span class="op" id="4240272">(</span><span class="op" id="4240273">)</span>&nbsp;<span class="op" id="4240275">*</span><span class="ident" id="4240276">CurveParams</span>&nbsp;<span class="op" id="4240288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240291">return</span>&nbsp;<span class="ident" id="4240298">curve</span><br>
<span class="lineno"></span><span class="op" id="4240304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4240307">func</span>&nbsp;<span class="op" id="4240312">(</span><span class="ident" id="4240313">curve</span>&nbsp;<span class="op" id="4240319">*</span><span class="ident" id="4240320">CurveParams</span><span class="op" id="4240331">)</span>&nbsp;<span class="ident" id="4240333">IsOnCurve</span><span class="op" id="4240342">(</span><span class="ident" id="4240343">x</span><span class="op" id="4240344">,</span>&nbsp;<span class="ident" id="4240346">y</span>&nbsp;<span class="op" id="4240348">*</span><span class="ident" id="4240349">big</span><span class="op" id="4240352">.</span><span class="ident" id="4240353">Int</span><span class="op" id="4240356">)</span>&nbsp;<span class="builtintype" id="4240358">bool</span>&nbsp;<span class="op" id="4240363">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4240366">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240389">y2</span>&nbsp;<span class="op" id="4240392">:=</span>&nbsp;<span class="builtinfunc" id="4240395">new</span><span class="op" id="4240398">(</span><span class="ident" id="4240399">big</span><span class="op" id="4240402">.</span><span class="ident" id="4240403">Int</span><span class="op" id="4240406">)</span><span class="op" id="4240407">.</span><span class="ident" id="4240408">Mul</span><span class="op" id="4240411">(</span><span class="ident" id="4240412">y</span><span class="op" id="4240413">,</span>&nbsp;<span class="ident" id="4240415">y</span><span class="op" id="4240416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240419">y2</span><span class="op" id="4240421">.</span><span class="ident" id="4240422">Mod</span><span class="op" id="4240425">(</span><span class="ident" id="4240426">y2</span><span class="op" id="4240428">,</span>&nbsp;<span class="ident" id="4240430">curve</span><span class="op" id="4240435">.</span><span class="ident" id="4240436">P</span><span class="op" id="4240437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240441">x3</span>&nbsp;<span class="op" id="4240444">:=</span>&nbsp;<span class="builtinfunc" id="4240447">new</span><span class="op" id="4240450">(</span><span class="ident" id="4240451">big</span><span class="op" id="4240454">.</span><span class="ident" id="4240455">Int</span><span class="op" id="4240458">)</span><span class="op" id="4240459">.</span><span class="ident" id="4240460">Mul</span><span class="op" id="4240463">(</span><span class="ident" id="4240464">x</span><span class="op" id="4240465">,</span>&nbsp;<span class="ident" id="4240467">x</span><span class="op" id="4240468">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240471">x3</span><span class="op" id="4240473">.</span><span class="ident" id="4240474">Mul</span><span class="op" id="4240477">(</span><span class="ident" id="4240478">x3</span><span class="op" id="4240480">,</span>&nbsp;<span class="ident" id="4240482">x</span><span class="op" id="4240483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240487">threeX</span>&nbsp;<span class="op" id="4240494">:=</span>&nbsp;<span class="builtinfunc" id="4240497">new</span><span class="op" id="4240500">(</span><span class="ident" id="4240501">big</span><span class="op" id="4240504">.</span><span class="ident" id="4240505">Int</span><span class="op" id="4240508">)</span><span class="op" id="4240509">.</span><span class="ident" id="4240510">Lsh</span><span class="op" id="4240513">(</span><span class="ident" id="4240514">x</span><span class="op" id="4240515">,</span>&nbsp;<span class="num" id="4240517">1</span><span class="op" id="4240518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240521">threeX</span><span class="op" id="4240527">.</span><span class="ident" id="4240528">Add</span><span class="op" id="4240531">(</span><span class="ident" id="4240532">threeX</span><span class="op" id="4240538">,</span>&nbsp;<span class="ident" id="4240540">x</span><span class="op" id="4240541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240545">x3</span><span class="op" id="4240547">.</span><span class="ident" id="4240548">Sub</span><span class="op" id="4240551">(</span><span class="ident" id="4240552">x3</span><span class="op" id="4240554">,</span>&nbsp;<span class="ident" id="4240556">threeX</span><span class="op" id="4240562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240565">x3</span><span class="op" id="4240567">.</span><span class="ident" id="4240568">Add</span><span class="op" id="4240571">(</span><span class="ident" id="4240572">x3</span><span class="op" id="4240574">,</span>&nbsp;<span class="ident" id="4240576">curve</span><span class="op" id="4240581">.</span><span class="ident" id="4240582">B</span><span class="op" id="4240583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240586">x3</span><span class="op" id="4240588">.</span><span class="ident" id="4240589">Mod</span><span class="op" id="4240592">(</span><span class="ident" id="4240593">x3</span><span class="op" id="4240595">,</span>&nbsp;<span class="ident" id="4240597">curve</span><span class="op" id="4240602">.</span><span class="ident" id="4240603">P</span><span class="op" id="4240604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240608">return</span>&nbsp;<span class="ident" id="4240615">x3</span><span class="op" id="4240617">.</span><span class="ident" id="4240618">Cmp</span><span class="op" id="4240621">(</span><span class="ident" id="4240622">y2</span><span class="op" id="4240624">)</span>&nbsp;<span class="op" id="4240626">==</span>&nbsp;<span class="num" id="4240629">0</span><br>
<span class="lineno">70</span><span class="op" id="4240631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4240634">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4240713">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4240793">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4240845">func</span>&nbsp;<span class="ident" id="4240850">zForAffine</span><span class="op" id="4240860">(</span><span class="ident" id="4240861">x</span><span class="op" id="4240862">,</span>&nbsp;<span class="ident" id="4240864">y</span>&nbsp;<span class="op" id="4240866">*</span><span class="ident" id="4240867">big</span><span class="op" id="4240870">.</span><span class="ident" id="4240871">Int</span><span class="op" id="4240874">)</span>&nbsp;<span class="op" id="4240876">*</span><span class="ident" id="4240877">big</span><span class="op" id="4240880">.</span><span class="ident" id="4240881">Int</span>&nbsp;<span class="op" id="4240885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240888">z</span>&nbsp;<span class="op" id="4240890">:=</span>&nbsp;<span class="builtinfunc" id="4240893">new</span><span class="op" id="4240896">(</span><span class="ident" id="4240897">big</span><span class="op" id="4240900">.</span><span class="ident" id="4240901">Int</span><span class="op" id="4240904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240907">if</span>&nbsp;<span class="ident" id="4240910">x</span><span class="op" id="4240911">.</span><span class="ident" id="4240912">Sign</span><span class="op" id="4240916">(</span><span class="op" id="4240917">)</span>&nbsp;<span class="op" id="4240919">!=</span>&nbsp;<span class="num" id="4240922">0</span>&nbsp;<span class="op" id="4240924">||</span>&nbsp;<span class="ident" id="4240927">y</span><span class="op" id="4240928">.</span><span class="ident" id="4240929">Sign</span><span class="op" id="4240933">(</span><span class="op" id="4240934">)</span>&nbsp;<span class="op" id="4240936">!=</span>&nbsp;<span class="num" id="4240939">0</span>&nbsp;<span class="op" id="4240941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4240945">z</span><span class="op" id="4240946">.</span><span class="ident" id="4240947">SetInt64</span><span class="op" id="4240955">(</span><span class="num" id="4240956">1</span><span class="op" id="4240957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4240960">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4240963">return</span>&nbsp;<span class="ident" id="4240970">z</span><br>
<span class="lineno"></span><span class="op" id="4240972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4240975">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4241053">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4241110">func</span>&nbsp;<span class="op" id="4241115">(</span><span class="ident" id="4241116">curve</span>&nbsp;<span class="op" id="4241122">*</span><span class="ident" id="4241123">CurveParams</span><span class="op" id="4241134">)</span>&nbsp;<span class="ident" id="4241136">affineFromJacobian</span><span class="op" id="4241154">(</span><span class="ident" id="4241155">x</span><span class="op" id="4241156">,</span>&nbsp;<span class="ident" id="4241158">y</span><span class="op" id="4241159">,</span>&nbsp;<span class="ident" id="4241161">z</span>&nbsp;<span class="op" id="4241163">*</span><span class="ident" id="4241164">big</span><span class="op" id="4241167">.</span><span class="ident" id="4241168">Int</span><span class="op" id="4241171">)</span>&nbsp;<span class="op" id="4241173">(</span><span class="ident" id="4241174">xOut</span><span class="op" id="4241178">,</span>&nbsp;<span class="ident" id="4241180">yOut</span>&nbsp;<span class="op" id="4241185">*</span><span class="ident" id="4241186">big</span><span class="op" id="4241189">.</span><span class="ident" id="4241190">Int</span><span class="op" id="4241193">)</span>&nbsp;<span class="op" id="4241195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241198">if</span>&nbsp;<span class="ident" id="4241201">z</span><span class="op" id="4241202">.</span><span class="ident" id="4241203">Sign</span><span class="op" id="4241207">(</span><span class="op" id="4241208">)</span>&nbsp;<span class="op" id="4241210">==</span>&nbsp;<span class="num" id="4241213">0</span>&nbsp;<span class="op" id="4241215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241219">return</span>&nbsp;<span class="builtinfunc" id="4241226">new</span><span class="op" id="4241229">(</span><span class="ident" id="4241230">big</span><span class="op" id="4241233">.</span><span class="ident" id="4241234">Int</span><span class="op" id="4241237">)</span><span class="op" id="4241238">,</span>&nbsp;<span class="builtinfunc" id="4241240">new</span><span class="op" id="4241243">(</span><span class="ident" id="4241244">big</span><span class="op" id="4241247">.</span><span class="ident" id="4241248">Int</span><span class="op" id="4241251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4241254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241258">zinv</span>&nbsp;<span class="op" id="4241263">:=</span>&nbsp;<span class="builtinfunc" id="4241266">new</span><span class="op" id="4241269">(</span><span class="ident" id="4241270">big</span><span class="op" id="4241273">.</span><span class="ident" id="4241274">Int</span><span class="op" id="4241277">)</span><span class="op" id="4241278">.</span><span class="ident" id="4241279">ModInverse</span><span class="op" id="4241289">(</span><span class="ident" id="4241290">z</span><span class="op" id="4241291">,</span>&nbsp;<span class="ident" id="4241293">curve</span><span class="op" id="4241298">.</span><span class="ident" id="4241299">P</span><span class="op" id="4241300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241303">zinvsq</span>&nbsp;<span class="op" id="4241310">:=</span>&nbsp;<span class="builtinfunc" id="4241313">new</span><span class="op" id="4241316">(</span><span class="ident" id="4241317">big</span><span class="op" id="4241320">.</span><span class="ident" id="4241321">Int</span><span class="op" id="4241324">)</span><span class="op" id="4241325">.</span><span class="ident" id="4241326">Mul</span><span class="op" id="4241329">(</span><span class="ident" id="4241330">zinv</span><span class="op" id="4241334">,</span>&nbsp;<span class="ident" id="4241336">zinv</span><span class="op" id="4241340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241344">xOut</span>&nbsp;<span class="op" id="4241349">=</span>&nbsp;<span class="builtinfunc" id="4241351">new</span><span class="op" id="4241354">(</span><span class="ident" id="4241355">big</span><span class="op" id="4241358">.</span><span class="ident" id="4241359">Int</span><span class="op" id="4241362">)</span><span class="op" id="4241363">.</span><span class="ident" id="4241364">Mul</span><span class="op" id="4241367">(</span><span class="ident" id="4241368">x</span><span class="op" id="4241369">,</span>&nbsp;<span class="ident" id="4241371">zinvsq</span><span class="op" id="4241377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241380">xOut</span><span class="op" id="4241384">.</span><span class="ident" id="4241385">Mod</span><span class="op" id="4241388">(</span><span class="ident" id="4241389">xOut</span><span class="op" id="4241393">,</span>&nbsp;<span class="ident" id="4241395">curve</span><span class="op" id="4241400">.</span><span class="ident" id="4241401">P</span><span class="op" id="4241402">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241405">zinvsq</span><span class="op" id="4241411">.</span><span class="ident" id="4241412">Mul</span><span class="op" id="4241415">(</span><span class="ident" id="4241416">zinvsq</span><span class="op" id="4241422">,</span>&nbsp;<span class="ident" id="4241424">zinv</span><span class="op" id="4241428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241431">yOut</span>&nbsp;<span class="op" id="4241436">=</span>&nbsp;<span class="builtinfunc" id="4241438">new</span><span class="op" id="4241441">(</span><span class="ident" id="4241442">big</span><span class="op" id="4241445">.</span><span class="ident" id="4241446">Int</span><span class="op" id="4241449">)</span><span class="op" id="4241450">.</span><span class="ident" id="4241451">Mul</span><span class="op" id="4241454">(</span><span class="ident" id="4241455">y</span><span class="op" id="4241456">,</span>&nbsp;<span class="ident" id="4241458">zinvsq</span><span class="op" id="4241464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241467">yOut</span><span class="op" id="4241471">.</span><span class="ident" id="4241472">Mod</span><span class="op" id="4241475">(</span><span class="ident" id="4241476">yOut</span><span class="op" id="4241480">,</span>&nbsp;<span class="ident" id="4241482">curve</span><span class="op" id="4241487">.</span><span class="ident" id="4241488">P</span><span class="op" id="4241489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241492">return</span><br>
<span class="lineno"></span><span class="op" id="4241499">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4241502">func</span>&nbsp;<span class="op" id="4241507">(</span><span class="ident" id="4241508">curve</span>&nbsp;<span class="op" id="4241514">*</span><span class="ident" id="4241515">CurveParams</span><span class="op" id="4241526">)</span>&nbsp;<span class="ident" id="4241528">Add</span><span class="op" id="4241531">(</span><span class="ident" id="4241532">x1</span><span class="op" id="4241534">,</span>&nbsp;<span class="ident" id="4241536">y1</span><span class="op" id="4241538">,</span>&nbsp;<span class="ident" id="4241540">x2</span><span class="op" id="4241542">,</span>&nbsp;<span class="ident" id="4241544">y2</span>&nbsp;<span class="op" id="4241547">*</span><span class="ident" id="4241548">big</span><span class="op" id="4241551">.</span><span class="ident" id="4241552">Int</span><span class="op" id="4241555">)</span>&nbsp;<span class="op" id="4241557">(</span><span class="op" id="4241558">*</span><span class="ident" id="4241559">big</span><span class="op" id="4241562">.</span><span class="ident" id="4241563">Int</span><span class="op" id="4241566">,</span>&nbsp;<span class="op" id="4241568">*</span><span class="ident" id="4241569">big</span><span class="op" id="4241572">.</span><span class="ident" id="4241573">Int</span><span class="op" id="4241576">)</span>&nbsp;<span class="op" id="4241578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241581">z1</span>&nbsp;<span class="op" id="4241584">:=</span>&nbsp;<span class="ident" id="4241587">zForAffine</span><span class="op" id="4241597">(</span><span class="ident" id="4241598">x1</span><span class="op" id="4241600">,</span>&nbsp;<span class="ident" id="4241602">y1</span><span class="op" id="4241604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4241607">z2</span>&nbsp;<span class="op" id="4241610">:=</span>&nbsp;<span class="ident" id="4241613">zForAffine</span><span class="op" id="4241623">(</span><span class="ident" id="4241624">x2</span><span class="op" id="4241626">,</span>&nbsp;<span class="ident" id="4241628">y2</span><span class="op" id="4241630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4241633">return</span>&nbsp;<span class="ident" id="4241640">curve</span><span class="op" id="4241645">.</span><span class="ident" id="4241646">affineFromJacobian</span><span class="op" id="4241664">(</span><span class="ident" id="4241665">curve</span><span class="op" id="4241670">.</span><span class="ident" id="4241671">addJacobian</span><span class="op" id="4241682">(</span><span class="ident" id="4241683">x1</span><span class="op" id="4241685">,</span>&nbsp;<span class="ident" id="4241687">y1</span><span class="op" id="4241689">,</span>&nbsp;<span class="ident" id="4241691">z1</span><span class="op" id="4241693">,</span>&nbsp;<span class="ident" id="4241695">x2</span><span class="op" id="4241697">,</span>&nbsp;<span class="ident" id="4241699">y2</span><span class="op" id="4241701">,</span>&nbsp;<span class="ident" id="4241703">z2</span><span class="op" id="4241705">)</span><span class="op" id="4241706">)</span><br>
<span class="lineno">105</span><span class="op" id="4241708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4241711">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4241785">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4241847">func</span>&nbsp;<span class="op" id="4241852">(</span><span class="ident" id="4241853">curve</span>&nbsp;<span class="op" id="4241859">*</span><span class="ident" id="4241860">CurveParams</span><span class="op" id="4241871">)</span>&nbsp;<span class="ident" id="4241873">addJacobian</span><span class="op" id="4241884">(</span><span class="ident" id="4241885">x1</span><span class="op" id="4241887">,</span>&nbsp;<span class="ident" id="4241889">y1</span><span class="op" id="4241891">,</span>&nbsp;<span class="ident" id="4241893">z1</span><span class="op" id="4241895">,</span>&nbsp;<span class="ident" id="4241897">x2</span><span class="op" id="4241899">,</span>&nbsp;<span class="ident" id="4241901">y2</span><span class="op" id="4241903">,</span>&nbsp;<span class="ident" id="4241905">z2</span>&nbsp;<span class="op" id="4241908">*</span><span class="ident" id="4241909">big</span><span class="op" id="4241912">.</span><span class="ident" id="4241913">Int</span><span class="op" id="4241916">)</span>&nbsp;<span class="op" id="4241918">(</span><span class="op" id="4241919">*</span><span class="ident" id="4241920">big</span><span class="op" id="4241923">.</span><span class="ident" id="4241924">Int</span><span class="op" id="4241927">,</span>&nbsp;<span class="op" id="4241929">*</span><span class="ident" id="4241930">big</span><span class="op" id="4241933">.</span><span class="ident" id="4241934">Int</span><span class="op" id="4241937">,</span>&nbsp;<span class="op" id="4241939">*</span><span class="ident" id="4241940">big</span><span class="op" id="4241943">.</span><span class="ident" id="4241944">Int</span><span class="op" id="4241947">)</span>&nbsp;<span class="op" id="4241949">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4241952">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242042">x3</span><span class="op" id="4242044">,</span>&nbsp;<span class="ident" id="4242046">y3</span><span class="op" id="4242048">,</span>&nbsp;<span class="ident" id="4242050">z3</span>&nbsp;<span class="op" id="4242053">:=</span>&nbsp;<span class="builtinfunc" id="4242056">new</span><span class="op" id="4242059">(</span><span class="ident" id="4242060">big</span><span class="op" id="4242063">.</span><span class="ident" id="4242064">Int</span><span class="op" id="4242067">)</span><span class="op" id="4242068">,</span>&nbsp;<span class="builtinfunc" id="4242070">new</span><span class="op" id="4242073">(</span><span class="ident" id="4242074">big</span><span class="op" id="4242077">.</span><span class="ident" id="4242078">Int</span><span class="op" id="4242081">)</span><span class="op" id="4242082">,</span>&nbsp;<span class="builtinfunc" id="4242084">new</span><span class="op" id="4242087">(</span><span class="ident" id="4242088">big</span><span class="op" id="4242091">.</span><span class="ident" id="4242092">Int</span><span class="op" id="4242095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242098">if</span>&nbsp;<span class="ident" id="4242101">z1</span><span class="op" id="4242103">.</span><span class="ident" id="4242104">Sign</span><span class="op" id="4242108">(</span><span class="op" id="4242109">)</span>&nbsp;<span class="op" id="4242111">==</span>&nbsp;<span class="num" id="4242114">0</span>&nbsp;<span class="op" id="4242116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242120">x3</span><span class="op" id="4242122">.</span><span class="ident" id="4242123">Set</span><span class="op" id="4242126">(</span><span class="ident" id="4242127">x2</span><span class="op" id="4242129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242133">y3</span><span class="op" id="4242135">.</span><span class="ident" id="4242136">Set</span><span class="op" id="4242139">(</span><span class="ident" id="4242140">y2</span><span class="op" id="4242142">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242146">z3</span><span class="op" id="4242148">.</span><span class="ident" id="4242149">Set</span><span class="op" id="4242152">(</span><span class="ident" id="4242153">z2</span><span class="op" id="4242155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242159">return</span>&nbsp;<span class="ident" id="4242166">x3</span><span class="op" id="4242168">,</span>&nbsp;<span class="ident" id="4242170">y3</span><span class="op" id="4242172">,</span>&nbsp;<span class="ident" id="4242174">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242181">if</span>&nbsp;<span class="ident" id="4242184">z2</span><span class="op" id="4242186">.</span><span class="ident" id="4242187">Sign</span><span class="op" id="4242191">(</span><span class="op" id="4242192">)</span>&nbsp;<span class="op" id="4242194">==</span>&nbsp;<span class="num" id="4242197">0</span>&nbsp;<span class="op" id="4242199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242203">x3</span><span class="op" id="4242205">.</span><span class="ident" id="4242206">Set</span><span class="op" id="4242209">(</span><span class="ident" id="4242210">x1</span><span class="op" id="4242212">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242216">y3</span><span class="op" id="4242218">.</span><span class="ident" id="4242219">Set</span><span class="op" id="4242222">(</span><span class="ident" id="4242223">y1</span><span class="op" id="4242225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242229">z3</span><span class="op" id="4242231">.</span><span class="ident" id="4242232">Set</span><span class="op" id="4242235">(</span><span class="ident" id="4242236">z1</span><span class="op" id="4242238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242242">return</span>&nbsp;<span class="ident" id="4242249">x3</span><span class="op" id="4242251">,</span>&nbsp;<span class="ident" id="4242253">y3</span><span class="op" id="4242255">,</span>&nbsp;<span class="ident" id="4242257">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242265">z1z1</span>&nbsp;<span class="op" id="4242270">:=</span>&nbsp;<span class="builtinfunc" id="4242273">new</span><span class="op" id="4242276">(</span><span class="ident" id="4242277">big</span><span class="op" id="4242280">.</span><span class="ident" id="4242281">Int</span><span class="op" id="4242284">)</span><span class="op" id="4242285">.</span><span class="ident" id="4242286">Mul</span><span class="op" id="4242289">(</span><span class="ident" id="4242290">z1</span><span class="op" id="4242292">,</span>&nbsp;<span class="ident" id="4242294">z1</span><span class="op" id="4242296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242299">z1z1</span><span class="op" id="4242303">.</span><span class="ident" id="4242304">Mod</span><span class="op" id="4242307">(</span><span class="ident" id="4242308">z1z1</span><span class="op" id="4242312">,</span>&nbsp;<span class="ident" id="4242314">curve</span><span class="op" id="4242319">.</span><span class="ident" id="4242320">P</span><span class="op" id="4242321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242324">z2z2</span>&nbsp;<span class="op" id="4242329">:=</span>&nbsp;<span class="builtinfunc" id="4242332">new</span><span class="op" id="4242335">(</span><span class="ident" id="4242336">big</span><span class="op" id="4242339">.</span><span class="ident" id="4242340">Int</span><span class="op" id="4242343">)</span><span class="op" id="4242344">.</span><span class="ident" id="4242345">Mul</span><span class="op" id="4242348">(</span><span class="ident" id="4242349">z2</span><span class="op" id="4242351">,</span>&nbsp;<span class="ident" id="4242353">z2</span><span class="op" id="4242355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242358">z2z2</span><span class="op" id="4242362">.</span><span class="ident" id="4242363">Mod</span><span class="op" id="4242366">(</span><span class="ident" id="4242367">z2z2</span><span class="op" id="4242371">,</span>&nbsp;<span class="ident" id="4242373">curve</span><span class="op" id="4242378">.</span><span class="ident" id="4242379">P</span><span class="op" id="4242380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242384">u1</span>&nbsp;<span class="op" id="4242387">:=</span>&nbsp;<span class="builtinfunc" id="4242390">new</span><span class="op" id="4242393">(</span><span class="ident" id="4242394">big</span><span class="op" id="4242397">.</span><span class="ident" id="4242398">Int</span><span class="op" id="4242401">)</span><span class="op" id="4242402">.</span><span class="ident" id="4242403">Mul</span><span class="op" id="4242406">(</span><span class="ident" id="4242407">x1</span><span class="op" id="4242409">,</span>&nbsp;<span class="ident" id="4242411">z2z2</span><span class="op" id="4242415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242418">u1</span><span class="op" id="4242420">.</span><span class="ident" id="4242421">Mod</span><span class="op" id="4242424">(</span><span class="ident" id="4242425">u1</span><span class="op" id="4242427">,</span>&nbsp;<span class="ident" id="4242429">curve</span><span class="op" id="4242434">.</span><span class="ident" id="4242435">P</span><span class="op" id="4242436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242439">u2</span>&nbsp;<span class="op" id="4242442">:=</span>&nbsp;<span class="builtinfunc" id="4242445">new</span><span class="op" id="4242448">(</span><span class="ident" id="4242449">big</span><span class="op" id="4242452">.</span><span class="ident" id="4242453">Int</span><span class="op" id="4242456">)</span><span class="op" id="4242457">.</span><span class="ident" id="4242458">Mul</span><span class="op" id="4242461">(</span><span class="ident" id="4242462">x2</span><span class="op" id="4242464">,</span>&nbsp;<span class="ident" id="4242466">z1z1</span><span class="op" id="4242470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242473">u2</span><span class="op" id="4242475">.</span><span class="ident" id="4242476">Mod</span><span class="op" id="4242479">(</span><span class="ident" id="4242480">u2</span><span class="op" id="4242482">,</span>&nbsp;<span class="ident" id="4242484">curve</span><span class="op" id="4242489">.</span><span class="ident" id="4242490">P</span><span class="op" id="4242491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242494">h</span>&nbsp;<span class="op" id="4242496">:=</span>&nbsp;<span class="builtinfunc" id="4242499">new</span><span class="op" id="4242502">(</span><span class="ident" id="4242503">big</span><span class="op" id="4242506">.</span><span class="ident" id="4242507">Int</span><span class="op" id="4242510">)</span><span class="op" id="4242511">.</span><span class="ident" id="4242512">Sub</span><span class="op" id="4242515">(</span><span class="ident" id="4242516">u2</span><span class="op" id="4242518">,</span>&nbsp;<span class="ident" id="4242520">u1</span><span class="op" id="4242522">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242525">xEqual</span>&nbsp;<span class="op" id="4242532">:=</span>&nbsp;<span class="ident" id="4242535">h</span><span class="op" id="4242536">.</span><span class="ident" id="4242537">Sign</span><span class="op" id="4242541">(</span><span class="op" id="4242542">)</span>&nbsp;<span class="op" id="4242544">==</span>&nbsp;<span class="num" id="4242547">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242550">if</span>&nbsp;<span class="ident" id="4242553">h</span><span class="op" id="4242554">.</span><span class="ident" id="4242555">Sign</span><span class="op" id="4242559">(</span><span class="op" id="4242560">)</span>&nbsp;<span class="op" id="4242562">==</span>&nbsp;<span class="op" id="4242565">-</span><span class="num" id="4242566">1</span>&nbsp;<span class="op" id="4242568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242572">h</span><span class="op" id="4242573">.</span><span class="ident" id="4242574">Add</span><span class="op" id="4242577">(</span><span class="ident" id="4242578">h</span><span class="op" id="4242579">,</span>&nbsp;<span class="ident" id="4242581">curve</span><span class="op" id="4242586">.</span><span class="ident" id="4242587">P</span><span class="op" id="4242588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242594">i</span>&nbsp;<span class="op" id="4242596">:=</span>&nbsp;<span class="builtinfunc" id="4242599">new</span><span class="op" id="4242602">(</span><span class="ident" id="4242603">big</span><span class="op" id="4242606">.</span><span class="ident" id="4242607">Int</span><span class="op" id="4242610">)</span><span class="op" id="4242611">.</span><span class="ident" id="4242612">Lsh</span><span class="op" id="4242615">(</span><span class="ident" id="4242616">h</span><span class="op" id="4242617">,</span>&nbsp;<span class="num" id="4242619">1</span><span class="op" id="4242620">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242623">i</span><span class="op" id="4242624">.</span><span class="ident" id="4242625">Mul</span><span class="op" id="4242628">(</span><span class="ident" id="4242629">i</span><span class="op" id="4242630">,</span>&nbsp;<span class="ident" id="4242632">i</span><span class="op" id="4242633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242636">j</span>&nbsp;<span class="op" id="4242638">:=</span>&nbsp;<span class="builtinfunc" id="4242641">new</span><span class="op" id="4242644">(</span><span class="ident" id="4242645">big</span><span class="op" id="4242648">.</span><span class="ident" id="4242649">Int</span><span class="op" id="4242652">)</span><span class="op" id="4242653">.</span><span class="ident" id="4242654">Mul</span><span class="op" id="4242657">(</span><span class="ident" id="4242658">h</span><span class="op" id="4242659">,</span>&nbsp;<span class="ident" id="4242661">i</span><span class="op" id="4242662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242666">s1</span>&nbsp;<span class="op" id="4242669">:=</span>&nbsp;<span class="builtinfunc" id="4242672">new</span><span class="op" id="4242675">(</span><span class="ident" id="4242676">big</span><span class="op" id="4242679">.</span><span class="ident" id="4242680">Int</span><span class="op" id="4242683">)</span><span class="op" id="4242684">.</span><span class="ident" id="4242685">Mul</span><span class="op" id="4242688">(</span><span class="ident" id="4242689">y1</span><span class="op" id="4242691">,</span>&nbsp;<span class="ident" id="4242693">z2</span><span class="op" id="4242695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242698">s1</span><span class="op" id="4242700">.</span><span class="ident" id="4242701">Mul</span><span class="op" id="4242704">(</span><span class="ident" id="4242705">s1</span><span class="op" id="4242707">,</span>&nbsp;<span class="ident" id="4242709">z2z2</span><span class="op" id="4242713">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242716">s1</span><span class="op" id="4242718">.</span><span class="ident" id="4242719">Mod</span><span class="op" id="4242722">(</span><span class="ident" id="4242723">s1</span><span class="op" id="4242725">,</span>&nbsp;<span class="ident" id="4242727">curve</span><span class="op" id="4242732">.</span><span class="ident" id="4242733">P</span><span class="op" id="4242734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242737">s2</span>&nbsp;<span class="op" id="4242740">:=</span>&nbsp;<span class="builtinfunc" id="4242743">new</span><span class="op" id="4242746">(</span><span class="ident" id="4242747">big</span><span class="op" id="4242750">.</span><span class="ident" id="4242751">Int</span><span class="op" id="4242754">)</span><span class="op" id="4242755">.</span><span class="ident" id="4242756">Mul</span><span class="op" id="4242759">(</span><span class="ident" id="4242760">y2</span><span class="op" id="4242762">,</span>&nbsp;<span class="ident" id="4242764">z1</span><span class="op" id="4242766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242769">s2</span><span class="op" id="4242771">.</span><span class="ident" id="4242772">Mul</span><span class="op" id="4242775">(</span><span class="ident" id="4242776">s2</span><span class="op" id="4242778">,</span>&nbsp;<span class="ident" id="4242780">z1z1</span><span class="op" id="4242784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242787">s2</span><span class="op" id="4242789">.</span><span class="ident" id="4242790">Mod</span><span class="op" id="4242793">(</span><span class="ident" id="4242794">s2</span><span class="op" id="4242796">,</span>&nbsp;<span class="ident" id="4242798">curve</span><span class="op" id="4242803">.</span><span class="ident" id="4242804">P</span><span class="op" id="4242805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242808">r</span>&nbsp;<span class="op" id="4242810">:=</span>&nbsp;<span class="builtinfunc" id="4242813">new</span><span class="op" id="4242816">(</span><span class="ident" id="4242817">big</span><span class="op" id="4242820">.</span><span class="ident" id="4242821">Int</span><span class="op" id="4242824">)</span><span class="op" id="4242825">.</span><span class="ident" id="4242826">Sub</span><span class="op" id="4242829">(</span><span class="ident" id="4242830">s2</span><span class="op" id="4242832">,</span>&nbsp;<span class="ident" id="4242834">s1</span><span class="op" id="4242836">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242839">if</span>&nbsp;<span class="ident" id="4242842">r</span><span class="op" id="4242843">.</span><span class="ident" id="4242844">Sign</span><span class="op" id="4242848">(</span><span class="op" id="4242849">)</span>&nbsp;<span class="op" id="4242851">==</span>&nbsp;<span class="op" id="4242854">-</span><span class="num" id="4242855">1</span>&nbsp;<span class="op" id="4242857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242861">r</span><span class="op" id="4242862">.</span><span class="ident" id="4242863">Add</span><span class="op" id="4242866">(</span><span class="ident" id="4242867">r</span><span class="op" id="4242868">,</span>&nbsp;<span class="ident" id="4242870">curve</span><span class="op" id="4242875">.</span><span class="ident" id="4242876">P</span><span class="op" id="4242877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242883">yEqual</span>&nbsp;<span class="op" id="4242890">:=</span>&nbsp;<span class="ident" id="4242893">r</span><span class="op" id="4242894">.</span><span class="ident" id="4242895">Sign</span><span class="op" id="4242899">(</span><span class="op" id="4242900">)</span>&nbsp;<span class="op" id="4242902">==</span>&nbsp;<span class="num" id="4242905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242908">if</span>&nbsp;<span class="ident" id="4242911">xEqual</span>&nbsp;<span class="op" id="4242918">&amp;&amp;</span>&nbsp;<span class="ident" id="4242921">yEqual</span>&nbsp;<span class="op" id="4242928">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4242932">return</span>&nbsp;<span class="ident" id="4242939">curve</span><span class="op" id="4242944">.</span><span class="ident" id="4242945">doubleJacobian</span><span class="op" id="4242959">(</span><span class="ident" id="4242960">x1</span><span class="op" id="4242962">,</span>&nbsp;<span class="ident" id="4242964">y1</span><span class="op" id="4242966">,</span>&nbsp;<span class="ident" id="4242968">z1</span><span class="op" id="4242970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4242973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242976">r</span><span class="op" id="4242977">.</span><span class="ident" id="4242978">Lsh</span><span class="op" id="4242981">(</span><span class="ident" id="4242982">r</span><span class="op" id="4242983">,</span>&nbsp;<span class="num" id="4242985">1</span><span class="op" id="4242986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4242989">v</span>&nbsp;<span class="op" id="4242991">:=</span>&nbsp;<span class="builtinfunc" id="4242994">new</span><span class="op" id="4242997">(</span><span class="ident" id="4242998">big</span><span class="op" id="4243001">.</span><span class="ident" id="4243002">Int</span><span class="op" id="4243005">)</span><span class="op" id="4243006">.</span><span class="ident" id="4243007">Mul</span><span class="op" id="4243010">(</span><span class="ident" id="4243011">u1</span><span class="op" id="4243013">,</span>&nbsp;<span class="ident" id="4243015">i</span><span class="op" id="4243016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243020">x3</span><span class="op" id="4243022">.</span><span class="ident" id="4243023">Set</span><span class="op" id="4243026">(</span><span class="ident" id="4243027">r</span><span class="op" id="4243028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243031">x3</span><span class="op" id="4243033">.</span><span class="ident" id="4243034">Mul</span><span class="op" id="4243037">(</span><span class="ident" id="4243038">x3</span><span class="op" id="4243040">,</span>&nbsp;<span class="ident" id="4243042">x3</span><span class="op" id="4243044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243047">x3</span><span class="op" id="4243049">.</span><span class="ident" id="4243050">Sub</span><span class="op" id="4243053">(</span><span class="ident" id="4243054">x3</span><span class="op" id="4243056">,</span>&nbsp;<span class="ident" id="4243058">j</span><span class="op" id="4243059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243062">x3</span><span class="op" id="4243064">.</span><span class="ident" id="4243065">Sub</span><span class="op" id="4243068">(</span><span class="ident" id="4243069">x3</span><span class="op" id="4243071">,</span>&nbsp;<span class="ident" id="4243073">v</span><span class="op" id="4243074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243077">x3</span><span class="op" id="4243079">.</span><span class="ident" id="4243080">Sub</span><span class="op" id="4243083">(</span><span class="ident" id="4243084">x3</span><span class="op" id="4243086">,</span>&nbsp;<span class="ident" id="4243088">v</span><span class="op" id="4243089">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243092">x3</span><span class="op" id="4243094">.</span><span class="ident" id="4243095">Mod</span><span class="op" id="4243098">(</span><span class="ident" id="4243099">x3</span><span class="op" id="4243101">,</span>&nbsp;<span class="ident" id="4243103">curve</span><span class="op" id="4243108">.</span><span class="ident" id="4243109">P</span><span class="op" id="4243110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243114">y3</span><span class="op" id="4243116">.</span><span class="ident" id="4243117">Set</span><span class="op" id="4243120">(</span><span class="ident" id="4243121">r</span><span class="op" id="4243122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243125">v</span><span class="op" id="4243126">.</span><span class="ident" id="4243127">Sub</span><span class="op" id="4243130">(</span><span class="ident" id="4243131">v</span><span class="op" id="4243132">,</span>&nbsp;<span class="ident" id="4243134">x3</span><span class="op" id="4243136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243139">y3</span><span class="op" id="4243141">.</span><span class="ident" id="4243142">Mul</span><span class="op" id="4243145">(</span><span class="ident" id="4243146">y3</span><span class="op" id="4243148">,</span>&nbsp;<span class="ident" id="4243150">v</span><span class="op" id="4243151">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243154">s1</span><span class="op" id="4243156">.</span><span class="ident" id="4243157">Mul</span><span class="op" id="4243160">(</span><span class="ident" id="4243161">s1</span><span class="op" id="4243163">,</span>&nbsp;<span class="ident" id="4243165">j</span><span class="op" id="4243166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243169">s1</span><span class="op" id="4243171">.</span><span class="ident" id="4243172">Lsh</span><span class="op" id="4243175">(</span><span class="ident" id="4243176">s1</span><span class="op" id="4243178">,</span>&nbsp;<span class="num" id="4243180">1</span><span class="op" id="4243181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243184">y3</span><span class="op" id="4243186">.</span><span class="ident" id="4243187">Sub</span><span class="op" id="4243190">(</span><span class="ident" id="4243191">y3</span><span class="op" id="4243193">,</span>&nbsp;<span class="ident" id="4243195">s1</span><span class="op" id="4243197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243200">y3</span><span class="op" id="4243202">.</span><span class="ident" id="4243203">Mod</span><span class="op" id="4243206">(</span><span class="ident" id="4243207">y3</span><span class="op" id="4243209">,</span>&nbsp;<span class="ident" id="4243211">curve</span><span class="op" id="4243216">.</span><span class="ident" id="4243217">P</span><span class="op" id="4243218">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243222">z3</span><span class="op" id="4243224">.</span><span class="ident" id="4243225">Add</span><span class="op" id="4243228">(</span><span class="ident" id="4243229">z1</span><span class="op" id="4243231">,</span>&nbsp;<span class="ident" id="4243233">z2</span><span class="op" id="4243235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243238">z3</span><span class="op" id="4243240">.</span><span class="ident" id="4243241">Mul</span><span class="op" id="4243244">(</span><span class="ident" id="4243245">z3</span><span class="op" id="4243247">,</span>&nbsp;<span class="ident" id="4243249">z3</span><span class="op" id="4243251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243254">z3</span><span class="op" id="4243256">.</span><span class="ident" id="4243257">Sub</span><span class="op" id="4243260">(</span><span class="ident" id="4243261">z3</span><span class="op" id="4243263">,</span>&nbsp;<span class="ident" id="4243265">z1z1</span><span class="op" id="4243269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243272">z3</span><span class="op" id="4243274">.</span><span class="ident" id="4243275">Sub</span><span class="op" id="4243278">(</span><span class="ident" id="4243279">z3</span><span class="op" id="4243281">,</span>&nbsp;<span class="ident" id="4243283">z2z2</span><span class="op" id="4243287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243290">z3</span><span class="op" id="4243292">.</span><span class="ident" id="4243293">Mul</span><span class="op" id="4243296">(</span><span class="ident" id="4243297">z3</span><span class="op" id="4243299">,</span>&nbsp;<span class="ident" id="4243301">h</span><span class="op" id="4243302">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243305">z3</span><span class="op" id="4243307">.</span><span class="ident" id="4243308">Mod</span><span class="op" id="4243311">(</span><span class="ident" id="4243312">z3</span><span class="op" id="4243314">,</span>&nbsp;<span class="ident" id="4243316">curve</span><span class="op" id="4243321">.</span><span class="ident" id="4243322">P</span><span class="op" id="4243323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243327">return</span>&nbsp;<span class="ident" id="4243334">x3</span><span class="op" id="4243336">,</span>&nbsp;<span class="ident" id="4243338">y3</span><span class="op" id="4243340">,</span>&nbsp;<span class="ident" id="4243342">z3</span><br>
<span class="lineno"></span><span class="op" id="4243345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4243348">func</span>&nbsp;<span class="op" id="4243353">(</span><span class="ident" id="4243354">curve</span>&nbsp;<span class="op" id="4243360">*</span><span class="ident" id="4243361">CurveParams</span><span class="op" id="4243372">)</span>&nbsp;<span class="ident" id="4243374">Double</span><span class="op" id="4243380">(</span><span class="ident" id="4243381">x1</span><span class="op" id="4243383">,</span>&nbsp;<span class="ident" id="4243385">y1</span>&nbsp;<span class="op" id="4243388">*</span><span class="ident" id="4243389">big</span><span class="op" id="4243392">.</span><span class="ident" id="4243393">Int</span><span class="op" id="4243396">)</span>&nbsp;<span class="op" id="4243398">(</span><span class="op" id="4243399">*</span><span class="ident" id="4243400">big</span><span class="op" id="4243403">.</span><span class="ident" id="4243404">Int</span><span class="op" id="4243407">,</span>&nbsp;<span class="op" id="4243409">*</span><span class="ident" id="4243410">big</span><span class="op" id="4243413">.</span><span class="ident" id="4243414">Int</span><span class="op" id="4243417">)</span>&nbsp;<span class="op" id="4243419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243422">z1</span>&nbsp;<span class="op" id="4243425">:=</span>&nbsp;<span class="ident" id="4243428">zForAffine</span><span class="op" id="4243438">(</span><span class="ident" id="4243439">x1</span><span class="op" id="4243441">,</span>&nbsp;<span class="ident" id="4243443">y1</span><span class="op" id="4243445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243448">return</span>&nbsp;<span class="ident" id="4243455">curve</span><span class="op" id="4243460">.</span><span class="ident" id="4243461">affineFromJacobian</span><span class="op" id="4243479">(</span><span class="ident" id="4243480">curve</span><span class="op" id="4243485">.</span><span class="ident" id="4243486">doubleJacobian</span><span class="op" id="4243500">(</span><span class="ident" id="4243501">x1</span><span class="op" id="4243503">,</span>&nbsp;<span class="ident" id="4243505">y1</span><span class="op" id="4243507">,</span>&nbsp;<span class="ident" id="4243509">z1</span><span class="op" id="4243511">)</span><span class="op" id="4243512">)</span><br>
<span class="lineno"></span><span class="op" id="4243514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4243517">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4243589">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4243635">func</span>&nbsp;<span class="op" id="4243640">(</span><span class="ident" id="4243641">curve</span>&nbsp;<span class="op" id="4243647">*</span><span class="ident" id="4243648">CurveParams</span><span class="op" id="4243659">)</span>&nbsp;<span class="ident" id="4243661">doubleJacobian</span><span class="op" id="4243675">(</span><span class="ident" id="4243676">x</span><span class="op" id="4243677">,</span>&nbsp;<span class="ident" id="4243679">y</span><span class="op" id="4243680">,</span>&nbsp;<span class="ident" id="4243682">z</span>&nbsp;<span class="op" id="4243684">*</span><span class="ident" id="4243685">big</span><span class="op" id="4243688">.</span><span class="ident" id="4243689">Int</span><span class="op" id="4243692">)</span>&nbsp;<span class="op" id="4243694">(</span><span class="op" id="4243695">*</span><span class="ident" id="4243696">big</span><span class="op" id="4243699">.</span><span class="ident" id="4243700">Int</span><span class="op" id="4243703">,</span>&nbsp;<span class="op" id="4243705">*</span><span class="ident" id="4243706">big</span><span class="op" id="4243709">.</span><span class="ident" id="4243710">Int</span><span class="op" id="4243713">,</span>&nbsp;<span class="op" id="4243715">*</span><span class="ident" id="4243716">big</span><span class="op" id="4243719">.</span><span class="ident" id="4243720">Int</span><span class="op" id="4243723">)</span>&nbsp;<span class="op" id="4243725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4243728">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243817">delta</span>&nbsp;<span class="op" id="4243823">:=</span>&nbsp;<span class="builtinfunc" id="4243826">new</span><span class="op" id="4243829">(</span><span class="ident" id="4243830">big</span><span class="op" id="4243833">.</span><span class="ident" id="4243834">Int</span><span class="op" id="4243837">)</span><span class="op" id="4243838">.</span><span class="ident" id="4243839">Mul</span><span class="op" id="4243842">(</span><span class="ident" id="4243843">z</span><span class="op" id="4243844">,</span>&nbsp;<span class="ident" id="4243846">z</span><span class="op" id="4243847">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243850">delta</span><span class="op" id="4243855">.</span><span class="ident" id="4243856">Mod</span><span class="op" id="4243859">(</span><span class="ident" id="4243860">delta</span><span class="op" id="4243865">,</span>&nbsp;<span class="ident" id="4243867">curve</span><span class="op" id="4243872">.</span><span class="ident" id="4243873">P</span><span class="op" id="4243874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243877">gamma</span>&nbsp;<span class="op" id="4243883">:=</span>&nbsp;<span class="builtinfunc" id="4243886">new</span><span class="op" id="4243889">(</span><span class="ident" id="4243890">big</span><span class="op" id="4243893">.</span><span class="ident" id="4243894">Int</span><span class="op" id="4243897">)</span><span class="op" id="4243898">.</span><span class="ident" id="4243899">Mul</span><span class="op" id="4243902">(</span><span class="ident" id="4243903">y</span><span class="op" id="4243904">,</span>&nbsp;<span class="ident" id="4243906">y</span><span class="op" id="4243907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243910">gamma</span><span class="op" id="4243915">.</span><span class="ident" id="4243916">Mod</span><span class="op" id="4243919">(</span><span class="ident" id="4243920">gamma</span><span class="op" id="4243925">,</span>&nbsp;<span class="ident" id="4243927">curve</span><span class="op" id="4243932">.</span><span class="ident" id="4243933">P</span><span class="op" id="4243934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4243937">alpha</span>&nbsp;<span class="op" id="4243943">:=</span>&nbsp;<span class="builtinfunc" id="4243946">new</span><span class="op" id="4243949">(</span><span class="ident" id="4243950">big</span><span class="op" id="4243953">.</span><span class="ident" id="4243954">Int</span><span class="op" id="4243957">)</span><span class="op" id="4243958">.</span><span class="ident" id="4243959">Sub</span><span class="op" id="4243962">(</span><span class="ident" id="4243963">x</span><span class="op" id="4243964">,</span>&nbsp;<span class="ident" id="4243966">delta</span><span class="op" id="4243971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4243974">if</span>&nbsp;<span class="ident" id="4243977">alpha</span><span class="op" id="4243982">.</span><span class="ident" id="4243983">Sign</span><span class="op" id="4243987">(</span><span class="op" id="4243988">)</span>&nbsp;<span class="op" id="4243990">==</span>&nbsp;<span class="op" id="4243993">-</span><span class="num" id="4243994">1</span>&nbsp;<span class="op" id="4243996">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244000">alpha</span><span class="op" id="4244005">.</span><span class="ident" id="4244006">Add</span><span class="op" id="4244009">(</span><span class="ident" id="4244010">alpha</span><span class="op" id="4244015">,</span>&nbsp;<span class="ident" id="4244017">curve</span><span class="op" id="4244022">.</span><span class="ident" id="4244023">P</span><span class="op" id="4244024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244030">alpha2</span>&nbsp;<span class="op" id="4244037">:=</span>&nbsp;<span class="builtinfunc" id="4244040">new</span><span class="op" id="4244043">(</span><span class="ident" id="4244044">big</span><span class="op" id="4244047">.</span><span class="ident" id="4244048">Int</span><span class="op" id="4244051">)</span><span class="op" id="4244052">.</span><span class="ident" id="4244053">Add</span><span class="op" id="4244056">(</span><span class="ident" id="4244057">x</span><span class="op" id="4244058">,</span>&nbsp;<span class="ident" id="4244060">delta</span><span class="op" id="4244065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244068">alpha</span><span class="op" id="4244073">.</span><span class="ident" id="4244074">Mul</span><span class="op" id="4244077">(</span><span class="ident" id="4244078">alpha</span><span class="op" id="4244083">,</span>&nbsp;<span class="ident" id="4244085">alpha2</span><span class="op" id="4244091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244094">alpha2</span><span class="op" id="4244100">.</span><span class="ident" id="4244101">Set</span><span class="op" id="4244104">(</span><span class="ident" id="4244105">alpha</span><span class="op" id="4244110">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244113">alpha</span><span class="op" id="4244118">.</span><span class="ident" id="4244119">Lsh</span><span class="op" id="4244122">(</span><span class="ident" id="4244123">alpha</span><span class="op" id="4244128">,</span>&nbsp;<span class="num" id="4244130">1</span><span class="op" id="4244131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244134">alpha</span><span class="op" id="4244139">.</span><span class="ident" id="4244140">Add</span><span class="op" id="4244143">(</span><span class="ident" id="4244144">alpha</span><span class="op" id="4244149">,</span>&nbsp;<span class="ident" id="4244151">alpha2</span><span class="op" id="4244157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244161">beta</span>&nbsp;<span class="op" id="4244166">:=</span>&nbsp;<span class="ident" id="4244169">alpha2</span><span class="op" id="4244175">.</span><span class="ident" id="4244176">Mul</span><span class="op" id="4244179">(</span><span class="ident" id="4244180">x</span><span class="op" id="4244181">,</span>&nbsp;<span class="ident" id="4244183">gamma</span><span class="op" id="4244188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244192">x3</span>&nbsp;<span class="op" id="4244195">:=</span>&nbsp;<span class="builtinfunc" id="4244198">new</span><span class="op" id="4244201">(</span><span class="ident" id="4244202">big</span><span class="op" id="4244205">.</span><span class="ident" id="4244206">Int</span><span class="op" id="4244209">)</span><span class="op" id="4244210">.</span><span class="ident" id="4244211">Mul</span><span class="op" id="4244214">(</span><span class="ident" id="4244215">alpha</span><span class="op" id="4244220">,</span>&nbsp;<span class="ident" id="4244222">alpha</span><span class="op" id="4244227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244230">beta8</span>&nbsp;<span class="op" id="4244236">:=</span>&nbsp;<span class="builtinfunc" id="4244239">new</span><span class="op" id="4244242">(</span><span class="ident" id="4244243">big</span><span class="op" id="4244246">.</span><span class="ident" id="4244247">Int</span><span class="op" id="4244250">)</span><span class="op" id="4244251">.</span><span class="ident" id="4244252">Lsh</span><span class="op" id="4244255">(</span><span class="ident" id="4244256">beta</span><span class="op" id="4244260">,</span>&nbsp;<span class="num" id="4244262">3</span><span class="op" id="4244263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244266">x3</span><span class="op" id="4244268">.</span><span class="ident" id="4244269">Sub</span><span class="op" id="4244272">(</span><span class="ident" id="4244273">x3</span><span class="op" id="4244275">,</span>&nbsp;<span class="ident" id="4244277">beta8</span><span class="op" id="4244282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244285">for</span>&nbsp;<span class="ident" id="4244289">x3</span><span class="op" id="4244291">.</span><span class="ident" id="4244292">Sign</span><span class="op" id="4244296">(</span><span class="op" id="4244297">)</span>&nbsp;<span class="op" id="4244299">==</span>&nbsp;<span class="op" id="4244302">-</span><span class="num" id="4244303">1</span>&nbsp;<span class="op" id="4244305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244309">x3</span><span class="op" id="4244311">.</span><span class="ident" id="4244312">Add</span><span class="op" id="4244315">(</span><span class="ident" id="4244316">x3</span><span class="op" id="4244318">,</span>&nbsp;<span class="ident" id="4244320">curve</span><span class="op" id="4244325">.</span><span class="ident" id="4244326">P</span><span class="op" id="4244327">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244333">x3</span><span class="op" id="4244335">.</span><span class="ident" id="4244336">Mod</span><span class="op" id="4244339">(</span><span class="ident" id="4244340">x3</span><span class="op" id="4244342">,</span>&nbsp;<span class="ident" id="4244344">curve</span><span class="op" id="4244349">.</span><span class="ident" id="4244350">P</span><span class="op" id="4244351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244355">z3</span>&nbsp;<span class="op" id="4244358">:=</span>&nbsp;<span class="builtinfunc" id="4244361">new</span><span class="op" id="4244364">(</span><span class="ident" id="4244365">big</span><span class="op" id="4244368">.</span><span class="ident" id="4244369">Int</span><span class="op" id="4244372">)</span><span class="op" id="4244373">.</span><span class="ident" id="4244374">Add</span><span class="op" id="4244377">(</span><span class="ident" id="4244378">y</span><span class="op" id="4244379">,</span>&nbsp;<span class="ident" id="4244381">z</span><span class="op" id="4244382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244385">z3</span><span class="op" id="4244387">.</span><span class="ident" id="4244388">Mul</span><span class="op" id="4244391">(</span><span class="ident" id="4244392">z3</span><span class="op" id="4244394">,</span>&nbsp;<span class="ident" id="4244396">z3</span><span class="op" id="4244398">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244401">z3</span><span class="op" id="4244403">.</span><span class="ident" id="4244404">Sub</span><span class="op" id="4244407">(</span><span class="ident" id="4244408">z3</span><span class="op" id="4244410">,</span>&nbsp;<span class="ident" id="4244412">gamma</span><span class="op" id="4244417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244420">if</span>&nbsp;<span class="ident" id="4244423">z3</span><span class="op" id="4244425">.</span><span class="ident" id="4244426">Sign</span><span class="op" id="4244430">(</span><span class="op" id="4244431">)</span>&nbsp;<span class="op" id="4244433">==</span>&nbsp;<span class="op" id="4244436">-</span><span class="num" id="4244437">1</span>&nbsp;<span class="op" id="4244439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244443">z3</span><span class="op" id="4244445">.</span><span class="ident" id="4244446">Add</span><span class="op" id="4244449">(</span><span class="ident" id="4244450">z3</span><span class="op" id="4244452">,</span>&nbsp;<span class="ident" id="4244454">curve</span><span class="op" id="4244459">.</span><span class="ident" id="4244460">P</span><span class="op" id="4244461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244467">z3</span><span class="op" id="4244469">.</span><span class="ident" id="4244470">Sub</span><span class="op" id="4244473">(</span><span class="ident" id="4244474">z3</span><span class="op" id="4244476">,</span>&nbsp;<span class="ident" id="4244478">delta</span><span class="op" id="4244483">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244486">if</span>&nbsp;<span class="ident" id="4244489">z3</span><span class="op" id="4244491">.</span><span class="ident" id="4244492">Sign</span><span class="op" id="4244496">(</span><span class="op" id="4244497">)</span>&nbsp;<span class="op" id="4244499">==</span>&nbsp;<span class="op" id="4244502">-</span><span class="num" id="4244503">1</span>&nbsp;<span class="op" id="4244505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244509">z3</span><span class="op" id="4244511">.</span><span class="ident" id="4244512">Add</span><span class="op" id="4244515">(</span><span class="ident" id="4244516">z3</span><span class="op" id="4244518">,</span>&nbsp;<span class="ident" id="4244520">curve</span><span class="op" id="4244525">.</span><span class="ident" id="4244526">P</span><span class="op" id="4244527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244533">z3</span><span class="op" id="4244535">.</span><span class="ident" id="4244536">Mod</span><span class="op" id="4244539">(</span><span class="ident" id="4244540">z3</span><span class="op" id="4244542">,</span>&nbsp;<span class="ident" id="4244544">curve</span><span class="op" id="4244549">.</span><span class="ident" id="4244550">P</span><span class="op" id="4244551">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244555">beta</span><span class="op" id="4244559">.</span><span class="ident" id="4244560">Lsh</span><span class="op" id="4244563">(</span><span class="ident" id="4244564">beta</span><span class="op" id="4244568">,</span>&nbsp;<span class="num" id="4244570">2</span><span class="op" id="4244571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244574">beta</span><span class="op" id="4244578">.</span><span class="ident" id="4244579">Sub</span><span class="op" id="4244582">(</span><span class="ident" id="4244583">beta</span><span class="op" id="4244587">,</span>&nbsp;<span class="ident" id="4244589">x3</span><span class="op" id="4244591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244594">if</span>&nbsp;<span class="ident" id="4244597">beta</span><span class="op" id="4244601">.</span><span class="ident" id="4244602">Sign</span><span class="op" id="4244606">(</span><span class="op" id="4244607">)</span>&nbsp;<span class="op" id="4244609">==</span>&nbsp;<span class="op" id="4244612">-</span><span class="num" id="4244613">1</span>&nbsp;<span class="op" id="4244615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244619">beta</span><span class="op" id="4244623">.</span><span class="ident" id="4244624">Add</span><span class="op" id="4244627">(</span><span class="ident" id="4244628">beta</span><span class="op" id="4244632">,</span>&nbsp;<span class="ident" id="4244634">curve</span><span class="op" id="4244639">.</span><span class="ident" id="4244640">P</span><span class="op" id="4244641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244644">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244647">y3</span>&nbsp;<span class="op" id="4244650">:=</span>&nbsp;<span class="ident" id="4244653">alpha</span><span class="op" id="4244658">.</span><span class="ident" id="4244659">Mul</span><span class="op" id="4244662">(</span><span class="ident" id="4244663">alpha</span><span class="op" id="4244668">,</span>&nbsp;<span class="ident" id="4244670">beta</span><span class="op" id="4244674">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244678">gamma</span><span class="op" id="4244683">.</span><span class="ident" id="4244684">Mul</span><span class="op" id="4244687">(</span><span class="ident" id="4244688">gamma</span><span class="op" id="4244693">,</span>&nbsp;<span class="ident" id="4244695">gamma</span><span class="op" id="4244700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244703">gamma</span><span class="op" id="4244708">.</span><span class="ident" id="4244709">Lsh</span><span class="op" id="4244712">(</span><span class="ident" id="4244713">gamma</span><span class="op" id="4244718">,</span>&nbsp;<span class="num" id="4244720">3</span><span class="op" id="4244721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244724">gamma</span><span class="op" id="4244729">.</span><span class="ident" id="4244730">Mod</span><span class="op" id="4244733">(</span><span class="ident" id="4244734">gamma</span><span class="op" id="4244739">,</span>&nbsp;<span class="ident" id="4244741">curve</span><span class="op" id="4244746">.</span><span class="ident" id="4244747">P</span><span class="op" id="4244748">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244752">y3</span><span class="op" id="4244754">.</span><span class="ident" id="4244755">Sub</span><span class="op" id="4244758">(</span><span class="ident" id="4244759">y3</span><span class="op" id="4244761">,</span>&nbsp;<span class="ident" id="4244763">gamma</span><span class="op" id="4244768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244771">if</span>&nbsp;<span class="ident" id="4244774">y3</span><span class="op" id="4244776">.</span><span class="ident" id="4244777">Sign</span><span class="op" id="4244781">(</span><span class="op" id="4244782">)</span>&nbsp;<span class="op" id="4244784">==</span>&nbsp;<span class="op" id="4244787">-</span><span class="num" id="4244788">1</span>&nbsp;<span class="op" id="4244790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244794">y3</span><span class="op" id="4244796">.</span><span class="ident" id="4244797">Add</span><span class="op" id="4244800">(</span><span class="ident" id="4244801">y3</span><span class="op" id="4244803">,</span>&nbsp;<span class="ident" id="4244805">curve</span><span class="op" id="4244810">.</span><span class="ident" id="4244811">P</span><span class="op" id="4244812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4244815">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244818">y3</span><span class="op" id="4244820">.</span><span class="ident" id="4244821">Mod</span><span class="op" id="4244824">(</span><span class="ident" id="4244825">y3</span><span class="op" id="4244827">,</span>&nbsp;<span class="ident" id="4244829">curve</span><span class="op" id="4244834">.</span><span class="ident" id="4244835">P</span><span class="op" id="4244836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4244840">return</span>&nbsp;<span class="ident" id="4244847">x3</span><span class="op" id="4244849">,</span>&nbsp;<span class="ident" id="4244851">y3</span><span class="op" id="4244853">,</span>&nbsp;<span class="ident" id="4244855">z3</span><br>
<span class="lineno"></span><span class="op" id="4244858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4244861">func</span>&nbsp;<span class="op" id="4244866">(</span><span class="ident" id="4244867">curve</span>&nbsp;<span class="op" id="4244873">*</span><span class="ident" id="4244874">CurveParams</span><span class="op" id="4244885">)</span>&nbsp;<span class="ident" id="4244887">ScalarMult</span><span class="op" id="4244897">(</span><span class="ident" id="4244898">Bx</span><span class="op" id="4244900">,</span>&nbsp;<span class="ident" id="4244902">By</span>&nbsp;<span class="op" id="4244905">*</span><span class="ident" id="4244906">big</span><span class="op" id="4244909">.</span><span class="ident" id="4244910">Int</span><span class="op" id="4244913">,</span>&nbsp;<span class="ident" id="4244915">k</span>&nbsp;<span class="op" id="4244917">[</span><span class="op" id="4244918">]</span><span class="builtintype" id="4244919">byte</span><span class="op" id="4244923">)</span>&nbsp;<span class="op" id="4244925">(</span><span class="op" id="4244926">*</span><span class="ident" id="4244927">big</span><span class="op" id="4244930">.</span><span class="ident" id="4244931">Int</span><span class="op" id="4244934">,</span>&nbsp;<span class="op" id="4244936">*</span><span class="ident" id="4244937">big</span><span class="op" id="4244940">.</span><span class="ident" id="4244941">Int</span><span class="op" id="4244944">)</span>&nbsp;<span class="op" id="4244946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244949">Bz</span>&nbsp;<span class="op" id="4244952">:=</span>&nbsp;<span class="builtinfunc" id="4244955">new</span><span class="op" id="4244958">(</span><span class="ident" id="4244959">big</span><span class="op" id="4244962">.</span><span class="ident" id="4244963">Int</span><span class="op" id="4244966">)</span><span class="op" id="4244967">.</span><span class="ident" id="4244968">SetInt64</span><span class="op" id="4244976">(</span><span class="num" id="4244977">1</span><span class="op" id="4244978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4244981">x</span><span class="op" id="4244982">,</span>&nbsp;<span class="ident" id="4244984">y</span><span class="op" id="4244985">,</span>&nbsp;<span class="ident" id="4244987">z</span>&nbsp;<span class="op" id="4244989">:=</span>&nbsp;<span class="builtinfunc" id="4244992">new</span><span class="op" id="4244995">(</span><span class="ident" id="4244996">big</span><span class="op" id="4244999">.</span><span class="ident" id="4245000">Int</span><span class="op" id="4245003">)</span><span class="op" id="4245004">,</span>&nbsp;<span class="builtinfunc" id="4245006">new</span><span class="op" id="4245009">(</span><span class="ident" id="4245010">big</span><span class="op" id="4245013">.</span><span class="ident" id="4245014">Int</span><span class="op" id="4245017">)</span><span class="op" id="4245018">,</span>&nbsp;<span class="builtinfunc" id="4245020">new</span><span class="op" id="4245023">(</span><span class="ident" id="4245024">big</span><span class="op" id="4245027">.</span><span class="ident" id="4245028">Int</span><span class="op" id="4245031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245035">for</span>&nbsp;<span class="ident" id="4245039">_</span><span class="op" id="4245040">,</span>&nbsp;<span class="builtintype" id="4245042">byte</span>&nbsp;<span class="op" id="4245047">:=</span>&nbsp;<span class="keyword" id="4245050">range</span>&nbsp;<span class="ident" id="4245056">k</span>&nbsp;<span class="op" id="4245058">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245062">for</span>&nbsp;<span class="ident" id="4245066">bitNum</span>&nbsp;<span class="op" id="4245073">:=</span>&nbsp;<span class="num" id="4245076">0</span><span class="op" id="4245077">;</span>&nbsp;<span class="ident" id="4245079">bitNum</span>&nbsp;<span class="op" id="4245086">&lt;</span>&nbsp;<span class="num" id="4245088">8</span><span class="op" id="4245089">;</span>&nbsp;<span class="ident" id="4245091">bitNum</span><span class="op" id="4245097">++</span>&nbsp;<span class="op" id="4245100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245105">x</span><span class="op" id="4245106">,</span>&nbsp;<span class="ident" id="4245108">y</span><span class="op" id="4245109">,</span>&nbsp;<span class="ident" id="4245111">z</span>&nbsp;<span class="op" id="4245113">=</span>&nbsp;<span class="ident" id="4245115">curve</span><span class="op" id="4245120">.</span><span class="ident" id="4245121">doubleJacobian</span><span class="op" id="4245135">(</span><span class="ident" id="4245136">x</span><span class="op" id="4245137">,</span>&nbsp;<span class="ident" id="4245139">y</span><span class="op" id="4245140">,</span>&nbsp;<span class="ident" id="4245142">z</span><span class="op" id="4245143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245148">if</span>&nbsp;<span class="builtintype" id="4245151">byte</span><span class="op" id="4245155">&amp;</span><span class="num" id="4245156">0x80</span>&nbsp;<span class="op" id="4245161">==</span>&nbsp;<span class="num" id="4245164">0x80</span>&nbsp;<span class="op" id="4245169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245175">x</span><span class="op" id="4245176">,</span>&nbsp;<span class="ident" id="4245178">y</span><span class="op" id="4245179">,</span>&nbsp;<span class="ident" id="4245181">z</span>&nbsp;<span class="op" id="4245183">=</span>&nbsp;<span class="ident" id="4245185">curve</span><span class="op" id="4245190">.</span><span class="ident" id="4245191">addJacobian</span><span class="op" id="4245202">(</span><span class="ident" id="4245203">Bx</span><span class="op" id="4245205">,</span>&nbsp;<span class="ident" id="4245207">By</span><span class="op" id="4245209">,</span>&nbsp;<span class="ident" id="4245211">Bz</span><span class="op" id="4245213">,</span>&nbsp;<span class="ident" id="4245215">x</span><span class="op" id="4245216">,</span>&nbsp;<span class="ident" id="4245218">y</span><span class="op" id="4245219">,</span>&nbsp;<span class="ident" id="4245221">z</span><span class="op" id="4245222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245227">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4245232">byte</span>&nbsp;<span class="op" id="4245237">&lt;&lt;=</span>&nbsp;<span class="num" id="4245241">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245252">return</span>&nbsp;<span class="ident" id="4245259">curve</span><span class="op" id="4245264">.</span><span class="ident" id="4245265">affineFromJacobian</span><span class="op" id="4245283">(</span><span class="ident" id="4245284">x</span><span class="op" id="4245285">,</span>&nbsp;<span class="ident" id="4245287">y</span><span class="op" id="4245288">,</span>&nbsp;<span class="ident" id="4245290">z</span><span class="op" id="4245291">)</span><br>
<span class="lineno">265</span><span class="op" id="4245293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4245296">func</span>&nbsp;<span class="op" id="4245301">(</span><span class="ident" id="4245302">curve</span>&nbsp;<span class="op" id="4245308">*</span><span class="ident" id="4245309">CurveParams</span><span class="op" id="4245320">)</span>&nbsp;<span class="ident" id="4245322">ScalarBaseMult</span><span class="op" id="4245336">(</span><span class="ident" id="4245337">k</span>&nbsp;<span class="op" id="4245339">[</span><span class="op" id="4245340">]</span><span class="builtintype" id="4245341">byte</span><span class="op" id="4245345">)</span>&nbsp;<span class="op" id="4245347">(</span><span class="op" id="4245348">*</span><span class="ident" id="4245349">big</span><span class="op" id="4245352">.</span><span class="ident" id="4245353">Int</span><span class="op" id="4245356">,</span>&nbsp;<span class="op" id="4245358">*</span><span class="ident" id="4245359">big</span><span class="op" id="4245362">.</span><span class="ident" id="4245363">Int</span><span class="op" id="4245366">)</span>&nbsp;<span class="op" id="4245368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245371">return</span>&nbsp;<span class="ident" id="4245378">curve</span><span class="op" id="4245383">.</span><span class="ident" id="4245384">ScalarMult</span><span class="op" id="4245394">(</span><span class="ident" id="4245395">curve</span><span class="op" id="4245400">.</span><span class="ident" id="4245401">Gx</span><span class="op" id="4245403">,</span>&nbsp;<span class="ident" id="4245405">curve</span><span class="op" id="4245410">.</span><span class="ident" id="4245411">Gy</span><span class="op" id="4245413">,</span>&nbsp;<span class="ident" id="4245415">k</span><span class="op" id="4245416">)</span><br>
<span class="lineno"></span><span class="op" id="4245418">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4245421">var</span>&nbsp;<span class="ident" id="4245425">mask</span>&nbsp;<span class="op" id="4245430">=</span>&nbsp;<span class="op" id="4245432">[</span><span class="op" id="4245433">]</span><span class="builtintype" id="4245434">byte</span><span class="op" id="4245438">{</span><span class="num" id="4245439">0xff</span><span class="op" id="4245443">,</span>&nbsp;<span class="num" id="4245445">0x1</span><span class="op" id="4245448">,</span>&nbsp;<span class="num" id="4245450">0x3</span><span class="op" id="4245453">,</span>&nbsp;<span class="num" id="4245455">0x7</span><span class="op" id="4245458">,</span>&nbsp;<span class="num" id="4245460">0xf</span><span class="op" id="4245463">,</span>&nbsp;<span class="num" id="4245465">0x1f</span><span class="op" id="4245469">,</span>&nbsp;<span class="num" id="4245471">0x3f</span><span class="op" id="4245475">,</span>&nbsp;<span class="num" id="4245477">0x7f</span><span class="op" id="4245481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4245484">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4245553">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4245621">func</span>&nbsp;<span class="ident" id="4245626">GenerateKey</span><span class="op" id="4245637">(</span><span class="ident" id="4245638">curve</span>&nbsp;<span class="ident" id="4245644">Curve</span><span class="op" id="4245649">,</span>&nbsp;<span class="ident" id="4245651">rand</span>&nbsp;<span class="ident" id="4245656">io</span><span class="op" id="4245658">.</span><span class="ident" id="4245659">Reader</span><span class="op" id="4245665">)</span>&nbsp;<span class="op" id="4245667">(</span><span class="ident" id="4245668">priv</span>&nbsp;<span class="op" id="4245673">[</span><span class="op" id="4245674">]</span><span class="builtintype" id="4245675">byte</span><span class="op" id="4245679">,</span>&nbsp;<span class="ident" id="4245681">x</span><span class="op" id="4245682">,</span>&nbsp;<span class="ident" id="4245684">y</span>&nbsp;<span class="op" id="4245686">*</span><span class="ident" id="4245687">big</span><span class="op" id="4245690">.</span><span class="ident" id="4245691">Int</span><span class="op" id="4245694">,</span>&nbsp;<span class="ident" id="4245696">err</span>&nbsp;<span class="builtintype" id="4245700">error</span><span class="op" id="4245705">)</span>&nbsp;<span class="op" id="4245707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245710">bitSize</span>&nbsp;<span class="op" id="4245718">:=</span>&nbsp;<span class="ident" id="4245721">curve</span><span class="op" id="4245726">.</span><span class="ident" id="4245727">Params</span><span class="op" id="4245733">(</span><span class="op" id="4245734">)</span><span class="op" id="4245735">.</span><span class="ident" id="4245736">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245745">byteLen</span>&nbsp;<span class="op" id="4245753">:=</span>&nbsp;<span class="op" id="4245756">(</span><span class="ident" id="4245757">bitSize</span>&nbsp;<span class="op" id="4245765">+</span>&nbsp;<span class="num" id="4245767">7</span><span class="op" id="4245768">)</span>&nbsp;<span class="op" id="4245770">&gt;&gt;</span>&nbsp;<span class="num" id="4245773">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245776">priv</span>&nbsp;<span class="op" id="4245781">=</span>&nbsp;<span class="builtinfunc" id="4245783">make</span><span class="op" id="4245787">(</span><span class="op" id="4245788">[</span><span class="op" id="4245789">]</span><span class="builtintype" id="4245790">byte</span><span class="op" id="4245794">,</span>&nbsp;<span class="ident" id="4245796">byteLen</span><span class="op" id="4245803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245807">for</span>&nbsp;<span class="ident" id="4245811">x</span>&nbsp;<span class="op" id="4245813">==</span>&nbsp;<span class="ident" id="4245816">nil</span>&nbsp;<span class="op" id="4245820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4245824">_</span><span class="op" id="4245825">,</span>&nbsp;<span class="ident" id="4245827">err</span>&nbsp;<span class="op" id="4245831">=</span>&nbsp;<span class="ident" id="4245833">io</span><span class="op" id="4245835">.</span><span class="ident" id="4245836">ReadFull</span><span class="op" id="4245844">(</span><span class="ident" id="4245845">rand</span><span class="op" id="4245849">,</span>&nbsp;<span class="ident" id="4245851">priv</span><span class="op" id="4245855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245859">if</span>&nbsp;<span class="ident" id="4245862">err</span>&nbsp;<span class="op" id="4245866">!=</span>&nbsp;<span class="ident" id="4245869">nil</span>&nbsp;<span class="op" id="4245873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4245878">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4245887">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4245891">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4245965">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246019">priv</span><span class="op" id="4246023">[</span><span class="num" id="4246024">0</span><span class="op" id="4246025">]</span>&nbsp;<span class="op" id="4246027">&amp;=</span>&nbsp;<span class="ident" id="4246030">mask</span><span class="op" id="4246034">[</span><span class="ident" id="4246035">bitSize</span><span class="op" id="4246042">%</span><span class="num" id="4246043">8</span><span class="op" id="4246044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4246048">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4246120">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246177">priv</span><span class="op" id="4246181">[</span><span class="num" id="4246182">1</span><span class="op" id="4246183">]</span>&nbsp;<span class="op" id="4246185">^=</span>&nbsp;<span class="num" id="4246188">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246195">x</span><span class="op" id="4246196">,</span>&nbsp;<span class="ident" id="4246198">y</span>&nbsp;<span class="op" id="4246200">=</span>&nbsp;<span class="ident" id="4246202">curve</span><span class="op" id="4246207">.</span><span class="ident" id="4246208">ScalarBaseMult</span><span class="op" id="4246222">(</span><span class="ident" id="4246223">priv</span><span class="op" id="4246227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246233">return</span><br>
<span class="lineno"></span><span class="op" id="4246240">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4246243">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4246327">func</span>&nbsp;<span class="ident" id="4246332">Marshal</span><span class="op" id="4246339">(</span><span class="ident" id="4246340">curve</span>&nbsp;<span class="ident" id="4246346">Curve</span><span class="op" id="4246351">,</span>&nbsp;<span class="ident" id="4246353">x</span><span class="op" id="4246354">,</span>&nbsp;<span class="ident" id="4246356">y</span>&nbsp;<span class="op" id="4246358">*</span><span class="ident" id="4246359">big</span><span class="op" id="4246362">.</span><span class="ident" id="4246363">Int</span><span class="op" id="4246366">)</span>&nbsp;<span class="op" id="4246368">[</span><span class="op" id="4246369">]</span><span class="builtintype" id="4246370">byte</span>&nbsp;<span class="op" id="4246375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246378">byteLen</span>&nbsp;<span class="op" id="4246386">:=</span>&nbsp;<span class="op" id="4246389">(</span><span class="ident" id="4246390">curve</span><span class="op" id="4246395">.</span><span class="ident" id="4246396">Params</span><span class="op" id="4246402">(</span><span class="op" id="4246403">)</span><span class="op" id="4246404">.</span><span class="ident" id="4246405">BitSize</span>&nbsp;<span class="op" id="4246413">+</span>&nbsp;<span class="num" id="4246415">7</span><span class="op" id="4246416">)</span>&nbsp;<span class="op" id="4246418">&gt;&gt;</span>&nbsp;<span class="num" id="4246421">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246425">ret</span>&nbsp;<span class="op" id="4246429">:=</span>&nbsp;<span class="builtinfunc" id="4246432">make</span><span class="op" id="4246436">(</span><span class="op" id="4246437">[</span><span class="op" id="4246438">]</span><span class="builtintype" id="4246439">byte</span><span class="op" id="4246443">,</span>&nbsp;<span class="num" id="4246445">1</span><span class="op" id="4246446">+</span><span class="num" id="4246447">2</span><span class="op" id="4246448">*</span><span class="ident" id="4246449">byteLen</span><span class="op" id="4246456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246459">ret</span><span class="op" id="4246462">[</span><span class="num" id="4246463">0</span><span class="op" id="4246464">]</span>&nbsp;<span class="op" id="4246466">=</span>&nbsp;<span class="num" id="4246468">4</span>&nbsp;<span class="comment" id="4246470">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246494">xBytes</span>&nbsp;<span class="op" id="4246501">:=</span>&nbsp;<span class="ident" id="4246504">x</span><span class="op" id="4246505">.</span><span class="ident" id="4246506">Bytes</span><span class="op" id="4246511">(</span><span class="op" id="4246512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4246515">copy</span><span class="op" id="4246519">(</span><span class="ident" id="4246520">ret</span><span class="op" id="4246523">[</span><span class="num" id="4246524">1</span><span class="op" id="4246525">+</span><span class="ident" id="4246526">byteLen</span><span class="op" id="4246533">-</span><span class="builtinfunc" id="4246534">len</span><span class="op" id="4246537">(</span><span class="ident" id="4246538">xBytes</span><span class="op" id="4246544">)</span><span class="op" id="4246545">:</span><span class="op" id="4246546">]</span><span class="op" id="4246547">,</span>&nbsp;<span class="ident" id="4246549">xBytes</span><span class="op" id="4246555">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246558">yBytes</span>&nbsp;<span class="op" id="4246565">:=</span>&nbsp;<span class="ident" id="4246568">y</span><span class="op" id="4246569">.</span><span class="ident" id="4246570">Bytes</span><span class="op" id="4246575">(</span><span class="op" id="4246576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4246579">copy</span><span class="op" id="4246583">(</span><span class="ident" id="4246584">ret</span><span class="op" id="4246587">[</span><span class="num" id="4246588">1</span><span class="op" id="4246589">+</span><span class="num" id="4246590">2</span><span class="op" id="4246591">*</span><span class="ident" id="4246592">byteLen</span><span class="op" id="4246599">-</span><span class="builtinfunc" id="4246600">len</span><span class="op" id="4246603">(</span><span class="ident" id="4246604">yBytes</span><span class="op" id="4246610">)</span><span class="op" id="4246611">:</span><span class="op" id="4246612">]</span><span class="op" id="4246613">,</span>&nbsp;<span class="ident" id="4246615">yBytes</span><span class="op" id="4246621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246624">return</span>&nbsp;<span class="ident" id="4246631">ret</span><br>
<span class="lineno"></span><span class="op" id="4246635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4246638">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4246730">func</span>&nbsp;<span class="ident" id="4246735">Unmarshal</span><span class="op" id="4246744">(</span><span class="ident" id="4246745">curve</span>&nbsp;<span class="ident" id="4246751">Curve</span><span class="op" id="4246756">,</span>&nbsp;<span class="ident" id="4246758">data</span>&nbsp;<span class="op" id="4246763">[</span><span class="op" id="4246764">]</span><span class="builtintype" id="4246765">byte</span><span class="op" id="4246769">)</span>&nbsp;<span class="op" id="4246771">(</span><span class="ident" id="4246772">x</span><span class="op" id="4246773">,</span>&nbsp;<span class="ident" id="4246775">y</span>&nbsp;<span class="op" id="4246777">*</span><span class="ident" id="4246778">big</span><span class="op" id="4246781">.</span><span class="ident" id="4246782">Int</span><span class="op" id="4246785">)</span>&nbsp;<span class="op" id="4246787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246790">byteLen</span>&nbsp;<span class="op" id="4246798">:=</span>&nbsp;<span class="op" id="4246801">(</span><span class="ident" id="4246802">curve</span><span class="op" id="4246807">.</span><span class="ident" id="4246808">Params</span><span class="op" id="4246814">(</span><span class="op" id="4246815">)</span><span class="op" id="4246816">.</span><span class="ident" id="4246817">BitSize</span>&nbsp;<span class="op" id="4246825">+</span>&nbsp;<span class="num" id="4246827">7</span><span class="op" id="4246828">)</span>&nbsp;<span class="op" id="4246830">&gt;&gt;</span>&nbsp;<span class="num" id="4246833">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246836">if</span>&nbsp;<span class="builtinfunc" id="4246839">len</span><span class="op" id="4246842">(</span><span class="ident" id="4246843">data</span><span class="op" id="4246847">)</span>&nbsp;<span class="op" id="4246849">!=</span>&nbsp;<span class="num" id="4246852">1</span><span class="op" id="4246853">+</span><span class="num" id="4246854">2</span><span class="op" id="4246855">*</span><span class="ident" id="4246856">byteLen</span>&nbsp;<span class="op" id="4246864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246868">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246879">if</span>&nbsp;<span class="ident" id="4246882">data</span><span class="op" id="4246886">[</span><span class="num" id="4246887">0</span><span class="op" id="4246888">]</span>&nbsp;<span class="op" id="4246890">!=</span>&nbsp;<span class="num" id="4246893">4</span>&nbsp;<span class="op" id="4246895">{</span>&nbsp;<span class="comment" id="4246897">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4246920">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4246928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246931">x</span>&nbsp;<span class="op" id="4246933">=</span>&nbsp;<span class="builtinfunc" id="4246935">new</span><span class="op" id="4246938">(</span><span class="ident" id="4246939">big</span><span class="op" id="4246942">.</span><span class="ident" id="4246943">Int</span><span class="op" id="4246946">)</span><span class="op" id="4246947">.</span><span class="ident" id="4246948">SetBytes</span><span class="op" id="4246956">(</span><span class="ident" id="4246957">data</span><span class="op" id="4246961">[</span><span class="num" id="4246962">1</span>&nbsp;<span class="op" id="4246964">:</span>&nbsp;<span class="num" id="4246966">1</span><span class="op" id="4246967">+</span><span class="ident" id="4246968">byteLen</span><span class="op" id="4246975">]</span><span class="op" id="4246976">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4246979">y</span>&nbsp;<span class="op" id="4246981">=</span>&nbsp;<span class="builtinfunc" id="4246983">new</span><span class="op" id="4246986">(</span><span class="ident" id="4246987">big</span><span class="op" id="4246990">.</span><span class="ident" id="4246991">Int</span><span class="op" id="4246994">)</span><span class="op" id="4246995">.</span><span class="ident" id="4246996">SetBytes</span><span class="op" id="4247004">(</span><span class="ident" id="4247005">data</span><span class="op" id="4247009">[</span><span class="num" id="4247010">1</span><span class="op" id="4247011">+</span><span class="ident" id="4247012">byteLen</span><span class="op" id="4247019">:</span><span class="op" id="4247020">]</span><span class="op" id="4247021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4247024">return</span><br>
<span class="lineno"></span><span class="op" id="4247031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4247034">var</span>&nbsp;<span class="ident" id="4247038">initonce</span>&nbsp;<span class="ident" id="4247047">sync</span><span class="op" id="4247051">.</span><span class="ident" id="4247052">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4247057">var</span>&nbsp;<span class="ident" id="4247061">p384</span>&nbsp;<span class="op" id="4247066">*</span><span class="ident" id="4247067">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4247079">var</span>&nbsp;<span class="ident" id="4247083">p521</span>&nbsp;<span class="op" id="4247088">*</span><span class="ident" id="4247089">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4247102">func</span>&nbsp;<span class="ident" id="4247107">initAll</span><span class="op" id="4247114">(</span><span class="op" id="4247115">)</span>&nbsp;<span class="op" id="4247117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247120">initP224</span><span class="op" id="4247128">(</span><span class="op" id="4247129">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247132">initP256</span><span class="op" id="4247140">(</span><span class="op" id="4247141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247144">initP384</span><span class="op" id="4247152">(</span><span class="op" id="4247153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247156">initP521</span><span class="op" id="4247164">(</span><span class="op" id="4247165">)</span><br>
<span class="lineno"></span><span class="op" id="4247167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4247170">func</span>&nbsp;<span class="ident" id="4247175">initP384</span><span class="op" id="4247183">(</span><span class="op" id="4247184">)</span>&nbsp;<span class="op" id="4247186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4247189">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247223">p384</span>&nbsp;<span class="op" id="4247228">=</span>&nbsp;<span class="builtinfunc" id="4247230">new</span><span class="op" id="4247233">(</span><span class="ident" id="4247234">CurveParams</span><span class="op" id="4247245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247248">p384</span><span class="op" id="4247252">.</span><span class="ident" id="4247253">P</span><span class="op" id="4247254">,</span>&nbsp;<span class="ident" id="4247256">_</span>&nbsp;<span class="op" id="4247258">=</span>&nbsp;<span class="builtinfunc" id="4247260">new</span><span class="op" id="4247263">(</span><span class="ident" id="4247264">big</span><span class="op" id="4247267">.</span><span class="ident" id="4247268">Int</span><span class="op" id="4247271">)</span><span class="op" id="4247272">.</span><span class="ident" id="4247273">SetString</span><span class="op" id="4247282">(</span><span class="string" id="4247283">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4247401">,</span>&nbsp;<span class="num" id="4247403">10</span><span class="op" id="4247405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247408">p384</span><span class="op" id="4247412">.</span><span class="ident" id="4247413">N</span><span class="op" id="4247414">,</span>&nbsp;<span class="ident" id="4247416">_</span>&nbsp;<span class="op" id="4247418">=</span>&nbsp;<span class="builtinfunc" id="4247420">new</span><span class="op" id="4247423">(</span><span class="ident" id="4247424">big</span><span class="op" id="4247427">.</span><span class="ident" id="4247428">Int</span><span class="op" id="4247431">)</span><span class="op" id="4247432">.</span><span class="ident" id="4247433">SetString</span><span class="op" id="4247442">(</span><span class="string" id="4247443">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4247561">,</span>&nbsp;<span class="num" id="4247563">10</span><span class="op" id="4247565">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247568">p384</span><span class="op" id="4247572">.</span><span class="ident" id="4247573">B</span><span class="op" id="4247574">,</span>&nbsp;<span class="ident" id="4247576">_</span>&nbsp;<span class="op" id="4247578">=</span>&nbsp;<span class="builtinfunc" id="4247580">new</span><span class="op" id="4247583">(</span><span class="ident" id="4247584">big</span><span class="op" id="4247587">.</span><span class="ident" id="4247588">Int</span><span class="op" id="4247591">)</span><span class="op" id="4247592">.</span><span class="ident" id="4247593">SetString</span><span class="op" id="4247602">(</span><span class="string" id="4247603">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4247701">,</span>&nbsp;<span class="num" id="4247703">16</span><span class="op" id="4247705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247708">p384</span><span class="op" id="4247712">.</span><span class="ident" id="4247713">Gx</span><span class="op" id="4247715">,</span>&nbsp;<span class="ident" id="4247717">_</span>&nbsp;<span class="op" id="4247719">=</span>&nbsp;<span class="builtinfunc" id="4247721">new</span><span class="op" id="4247724">(</span><span class="ident" id="4247725">big</span><span class="op" id="4247728">.</span><span class="ident" id="4247729">Int</span><span class="op" id="4247732">)</span><span class="op" id="4247733">.</span><span class="ident" id="4247734">SetString</span><span class="op" id="4247743">(</span><span class="string" id="4247744">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4247842">,</span>&nbsp;<span class="num" id="4247844">16</span><span class="op" id="4247846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247849">p384</span><span class="op" id="4247853">.</span><span class="ident" id="4247854">Gy</span><span class="op" id="4247856">,</span>&nbsp;<span class="ident" id="4247858">_</span>&nbsp;<span class="op" id="4247860">=</span>&nbsp;<span class="builtinfunc" id="4247862">new</span><span class="op" id="4247865">(</span><span class="ident" id="4247866">big</span><span class="op" id="4247869">.</span><span class="ident" id="4247870">Int</span><span class="op" id="4247873">)</span><span class="op" id="4247874">.</span><span class="ident" id="4247875">SetString</span><span class="op" id="4247884">(</span><span class="string" id="4247885">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4247983">,</span>&nbsp;<span class="num" id="4247985">16</span><span class="op" id="4247987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4247990">p384</span><span class="op" id="4247994">.</span><span class="ident" id="4247995">BitSize</span>&nbsp;<span class="op" id="4248003">=</span>&nbsp;<span class="num" id="4248005">384</span><br>
<span class="lineno"></span><span class="op" id="4248009">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4248012">func</span>&nbsp;<span class="ident" id="4248017">initP521</span><span class="op" id="4248025">(</span><span class="op" id="4248026">)</span>&nbsp;<span class="op" id="4248028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4248031">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248065">p521</span>&nbsp;<span class="op" id="4248070">=</span>&nbsp;<span class="builtinfunc" id="4248072">new</span><span class="op" id="4248075">(</span><span class="ident" id="4248076">CurveParams</span><span class="op" id="4248087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248090">p521</span><span class="op" id="4248094">.</span><span class="ident" id="4248095">P</span><span class="op" id="4248096">,</span>&nbsp;<span class="ident" id="4248098">_</span>&nbsp;<span class="op" id="4248100">=</span>&nbsp;<span class="builtinfunc" id="4248102">new</span><span class="op" id="4248105">(</span><span class="ident" id="4248106">big</span><span class="op" id="4248109">.</span><span class="ident" id="4248110">Int</span><span class="op" id="4248113">)</span><span class="op" id="4248114">.</span><span class="ident" id="4248115">SetString</span><span class="op" id="4248124">(</span><span class="string" id="4248125">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4248284">,</span>&nbsp;<span class="num" id="4248286">10</span><span class="op" id="4248288">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248291">p521</span><span class="op" id="4248295">.</span><span class="ident" id="4248296">N</span><span class="op" id="4248297">,</span>&nbsp;<span class="ident" id="4248299">_</span>&nbsp;<span class="op" id="4248301">=</span>&nbsp;<span class="builtinfunc" id="4248303">new</span><span class="op" id="4248306">(</span><span class="ident" id="4248307">big</span><span class="op" id="4248310">.</span><span class="ident" id="4248311">Int</span><span class="op" id="4248314">)</span><span class="op" id="4248315">.</span><span class="ident" id="4248316">SetString</span><span class="op" id="4248325">(</span><span class="string" id="4248326">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4248485">,</span>&nbsp;<span class="num" id="4248487">10</span><span class="op" id="4248489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248492">p521</span><span class="op" id="4248496">.</span><span class="ident" id="4248497">B</span><span class="op" id="4248498">,</span>&nbsp;<span class="ident" id="4248500">_</span>&nbsp;<span class="op" id="4248502">=</span>&nbsp;<span class="builtinfunc" id="4248504">new</span><span class="op" id="4248507">(</span><span class="ident" id="4248508">big</span><span class="op" id="4248511">.</span><span class="ident" id="4248512">Int</span><span class="op" id="4248515">)</span><span class="op" id="4248516">.</span><span class="ident" id="4248517">SetString</span><span class="op" id="4248526">(</span><span class="string" id="4248527">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4248660">,</span>&nbsp;<span class="num" id="4248662">16</span><span class="op" id="4248664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248667">p521</span><span class="op" id="4248671">.</span><span class="ident" id="4248672">Gx</span><span class="op" id="4248674">,</span>&nbsp;<span class="ident" id="4248676">_</span>&nbsp;<span class="op" id="4248678">=</span>&nbsp;<span class="builtinfunc" id="4248680">new</span><span class="op" id="4248683">(</span><span class="ident" id="4248684">big</span><span class="op" id="4248687">.</span><span class="ident" id="4248688">Int</span><span class="op" id="4248691">)</span><span class="op" id="4248692">.</span><span class="ident" id="4248693">SetString</span><span class="op" id="4248702">(</span><span class="string" id="4248703">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4248835">,</span>&nbsp;<span class="num" id="4248837">16</span><span class="op" id="4248839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4248842">p521</span><span class="op" id="4248846">.</span><span class="ident" id="4248847">Gy</span><span class="op" id="4248849">,</span>&nbsp;<span class="ident" id="4248851">_</span>&nbsp;<span class="op" id="4248853">=</span>&nbsp;<span class="builtinfunc" id="4248855">new</span><span class="op" id="4248858">(</span><span class="ident" id="4248859">big</span><span class="op" id="4248862">.</span><span class="ident" id="4248863">Int</span><span class="op" id="4248866">)</span><span class="op" id="4248867">.</span><span class="ident" id="4248868">SetString</span><span class="op" id="4248877">(</span><span class="string" id="4248878">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4249011">,</span>&nbsp;<span class="num" id="4249013">16</span><span class="op" id="4249015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249018">p521</span><span class="op" id="4249022">.</span><span class="ident" id="4249023">BitSize</span>&nbsp;<span class="op" id="4249031">=</span>&nbsp;<span class="num" id="4249033">521</span><br>
<span class="lineno">355</span><span class="op" id="4249037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249040">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4249119">func</span>&nbsp;<span class="ident" id="4249124">P256</span><span class="op" id="4249128">(</span><span class="op" id="4249129">)</span>&nbsp;<span class="ident" id="4249131">Curve</span>&nbsp;<span class="op" id="4249137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249140">initonce</span><span class="op" id="4249148">.</span><span class="ident" id="4249149">Do</span><span class="op" id="4249151">(</span><span class="ident" id="4249152">initAll</span><span class="op" id="4249159">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249162">return</span>&nbsp;<span class="ident" id="4249169">p256</span><br>
<span class="lineno"></span><span class="op" id="4249174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249177">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4249256">func</span>&nbsp;<span class="ident" id="4249261">P384</span><span class="op" id="4249265">(</span><span class="op" id="4249266">)</span>&nbsp;<span class="ident" id="4249268">Curve</span>&nbsp;<span class="op" id="4249274">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249277">initonce</span><span class="op" id="4249285">.</span><span class="ident" id="4249286">Do</span><span class="op" id="4249288">(</span><span class="ident" id="4249289">initAll</span><span class="op" id="4249296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249299">return</span>&nbsp;<span class="ident" id="4249306">p384</span><br>
<span class="lineno"></span><span class="op" id="4249311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249314">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4249393">func</span>&nbsp;<span class="ident" id="4249398">P521</span><span class="op" id="4249402">(</span><span class="op" id="4249403">)</span>&nbsp;<span class="ident" id="4249405">Curve</span>&nbsp;<span class="op" id="4249411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249414">initonce</span><span class="op" id="4249422">.</span><span class="ident" id="4249423">Do</span><span class="op" id="4249425">(</span><span class="ident" id="4249426">initAll</span><span class="op" id="4249433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4249436">return</span>&nbsp;<span class="ident" id="4249443">p521</span><br>
<span class="lineno"></span><span class="op" id="4249448">}</span>
</div>
</body>
</html>
