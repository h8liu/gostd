<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3948330">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3948385">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3948439">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3948490">package</span>&nbsp;<span class="ident" id="3948498">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948504">import</span>&nbsp;<span class="op" id="3948511">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3948514">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3948528">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3948545">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3948555">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3948566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3948569">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="3948658">type</span>&nbsp;<span class="ident" id="3948663">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="3948679">struct</span>&nbsp;<span class="op" id="3948686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948689">Version</span>&nbsp;<span class="builtintype" id="3948697">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948702">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948710">*</span><span class="ident" id="3948711">big</span><span class="op" id="3948714">.</span><span class="ident" id="3948715">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948720">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3948728">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948733">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948741">*</span><span class="ident" id="3948742">big</span><span class="op" id="3948745">.</span><span class="ident" id="3948746">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948751">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948759">*</span><span class="ident" id="3948760">big</span><span class="op" id="3948763">.</span><span class="ident" id="3948764">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948769">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948777">*</span><span class="ident" id="3948778">big</span><span class="op" id="3948781">.</span><span class="ident" id="3948782">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948787">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948860">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3948865">*</span><span class="ident" id="3948866">big</span><span class="op" id="3948869">.</span><span class="ident" id="3948870">Int</span>&nbsp;<span class="string" id="3948874">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948893">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3948898">*</span><span class="ident" id="3948899">big</span><span class="op" id="3948902">.</span><span class="ident" id="3948903">Int</span>&nbsp;<span class="string" id="3948907">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948926">Qinv</span>&nbsp;<span class="op" id="3948931">*</span><span class="ident" id="3948932">big</span><span class="op" id="3948935">.</span><span class="ident" id="3948936">Int</span>&nbsp;<span class="string" id="3948940">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948960">AdditionalPrimes</span>&nbsp;<span class="op" id="3948977">[</span><span class="op" id="3948978">]</span><span class="ident" id="3948979">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="3949003">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3949031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3949034">type</span>&nbsp;<span class="ident" id="3949039">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="3949063">struct</span>&nbsp;<span class="op" id="3949070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949073">Prime</span>&nbsp;<span class="op" id="3949079">*</span><span class="ident" id="3949080">big</span><span class="op" id="3949083">.</span><span class="ident" id="3949084">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3949090">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949150">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3949156">*</span><span class="ident" id="3949157">big</span><span class="op" id="3949160">.</span><span class="ident" id="3949161">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949166">Coeff</span>&nbsp;<span class="op" id="3949172">*</span><span class="ident" id="3949173">big</span><span class="op" id="3949176">.</span><span class="ident" id="3949177">Int</span><br>
<span class="lineno"></span><span class="op" id="3949181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3949184">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3949275">func</span>&nbsp;<span class="ident" id="3949280">ParsePKCS1PrivateKey</span><span class="op" id="3949300">(</span><span class="ident" id="3949301">der</span>&nbsp;<span class="op" id="3949305">[</span><span class="op" id="3949306">]</span><span class="builtintype" id="3949307">byte</span><span class="op" id="3949311">)</span>&nbsp;<span class="op" id="3949313">(</span><span class="ident" id="3949314">key</span>&nbsp;<span class="op" id="3949318">*</span><span class="ident" id="3949319">rsa</span><span class="op" id="3949322">.</span><span class="ident" id="3949323">PrivateKey</span><span class="op" id="3949333">,</span>&nbsp;<span class="ident" id="3949335">err</span>&nbsp;<span class="builtintype" id="3949339">error</span><span class="op" id="3949344">)</span>&nbsp;<span class="op" id="3949346">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949349">var</span>&nbsp;<span class="ident" id="3949353">priv</span>&nbsp;<span class="ident" id="3949358">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949375">rest</span><span class="op" id="3949379">,</span>&nbsp;<span class="ident" id="3949381">err</span>&nbsp;<span class="op" id="3949385">:=</span>&nbsp;<span class="ident" id="3949388">asn1</span><span class="op" id="3949392">.</span><span class="ident" id="3949393">Unmarshal</span><span class="op" id="3949402">(</span><span class="ident" id="3949403">der</span><span class="op" id="3949406">,</span>&nbsp;<span class="op" id="3949408">&amp;</span><span class="ident" id="3949409">priv</span><span class="op" id="3949413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949416">if</span>&nbsp;<span class="builtinfunc" id="3949419">len</span><span class="op" id="3949422">(</span><span class="ident" id="3949423">rest</span><span class="op" id="3949427">)</span>&nbsp;<span class="op" id="3949429">&gt;</span>&nbsp;<span class="num" id="3949431">0</span>&nbsp;<span class="op" id="3949433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949437">err</span>&nbsp;<span class="op" id="3949441">=</span>&nbsp;<span class="ident" id="3949443">asn1</span><span class="op" id="3949447">.</span><span class="ident" id="3949448">SyntaxError</span><span class="op" id="3949459">{</span><span class="ident" id="3949460">Msg</span><span class="op" id="3949463">:</span>&nbsp;<span class="string" id="3949465">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3949480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949484">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949495">if</span>&nbsp;<span class="ident" id="3949498">err</span>&nbsp;<span class="op" id="3949502">!=</span>&nbsp;<span class="ident" id="3949505">nil</span>&nbsp;<span class="op" id="3949509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949525">if</span>&nbsp;<span class="ident" id="3949528">priv</span><span class="op" id="3949532">.</span><span class="ident" id="3949533">Version</span>&nbsp;<span class="op" id="3949541">&gt;</span>&nbsp;<span class="num" id="3949543">1</span>&nbsp;<span class="op" id="3949545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949549">return</span>&nbsp;<span class="ident" id="3949556">nil</span><span class="op" id="3949559">,</span>&nbsp;<span class="ident" id="3949561">errors</span><span class="op" id="3949567">.</span><span class="ident" id="3949568">New</span><span class="op" id="3949571">(</span><span class="string" id="3949572">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="3949611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949618">if</span>&nbsp;<span class="ident" id="3949621">priv</span><span class="op" id="3949625">.</span><span class="ident" id="3949626">N</span><span class="op" id="3949627">.</span><span class="ident" id="3949628">Sign</span><span class="op" id="3949632">(</span><span class="op" id="3949633">)</span>&nbsp;<span class="op" id="3949635">&lt;=</span>&nbsp;<span class="num" id="3949638">0</span>&nbsp;<span class="op" id="3949640">||</span>&nbsp;<span class="ident" id="3949643">priv</span><span class="op" id="3949647">.</span><span class="ident" id="3949648">D</span><span class="op" id="3949649">.</span><span class="ident" id="3949650">Sign</span><span class="op" id="3949654">(</span><span class="op" id="3949655">)</span>&nbsp;<span class="op" id="3949657">&lt;=</span>&nbsp;<span class="num" id="3949660">0</span>&nbsp;<span class="op" id="3949662">||</span>&nbsp;<span class="ident" id="3949665">priv</span><span class="op" id="3949669">.</span><span class="ident" id="3949670">P</span><span class="op" id="3949671">.</span><span class="ident" id="3949672">Sign</span><span class="op" id="3949676">(</span><span class="op" id="3949677">)</span>&nbsp;<span class="op" id="3949679">&lt;=</span>&nbsp;<span class="num" id="3949682">0</span>&nbsp;<span class="op" id="3949684">||</span>&nbsp;<span class="ident" id="3949687">priv</span><span class="op" id="3949691">.</span><span class="ident" id="3949692">Q</span><span class="op" id="3949693">.</span><span class="ident" id="3949694">Sign</span><span class="op" id="3949698">(</span><span class="op" id="3949699">)</span>&nbsp;<span class="op" id="3949701">&lt;=</span>&nbsp;<span class="num" id="3949704">0</span>&nbsp;<span class="op" id="3949706">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949710">return</span>&nbsp;<span class="ident" id="3949717">nil</span><span class="op" id="3949720">,</span>&nbsp;<span class="ident" id="3949722">errors</span><span class="op" id="3949728">.</span><span class="ident" id="3949729">New</span><span class="op" id="3949732">(</span><span class="string" id="3949733">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="3949784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949791">key</span>&nbsp;<span class="op" id="3949795">=</span>&nbsp;<span class="builtinfunc" id="3949797">new</span><span class="op" id="3949800">(</span><span class="ident" id="3949801">rsa</span><span class="op" id="3949804">.</span><span class="ident" id="3949805">PrivateKey</span><span class="op" id="3949815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949818">key</span><span class="op" id="3949821">.</span><span class="ident" id="3949822">PublicKey</span>&nbsp;<span class="op" id="3949832">=</span>&nbsp;<span class="ident" id="3949834">rsa</span><span class="op" id="3949837">.</span><span class="ident" id="3949838">PublicKey</span><span class="op" id="3949847">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949851">E</span><span class="op" id="3949852">:</span>&nbsp;<span class="ident" id="3949854">priv</span><span class="op" id="3949858">.</span><span class="ident" id="3949859">E</span><span class="op" id="3949860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949864">N</span><span class="op" id="3949865">:</span>&nbsp;<span class="ident" id="3949867">priv</span><span class="op" id="3949871">.</span><span class="ident" id="3949872">N</span><span class="op" id="3949873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949880">key</span><span class="op" id="3949883">.</span><span class="ident" id="3949884">D</span>&nbsp;<span class="op" id="3949886">=</span>&nbsp;<span class="ident" id="3949888">priv</span><span class="op" id="3949892">.</span><span class="ident" id="3949893">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949896">key</span><span class="op" id="3949899">.</span><span class="ident" id="3949900">Primes</span>&nbsp;<span class="op" id="3949907">=</span>&nbsp;<span class="builtinfunc" id="3949909">make</span><span class="op" id="3949913">(</span><span class="op" id="3949914">[</span><span class="op" id="3949915">]</span><span class="op" id="3949916">*</span><span class="ident" id="3949917">big</span><span class="op" id="3949920">.</span><span class="ident" id="3949921">Int</span><span class="op" id="3949924">,</span>&nbsp;<span class="num" id="3949926">2</span><span class="op" id="3949927">+</span><span class="builtinfunc" id="3949928">len</span><span class="op" id="3949931">(</span><span class="ident" id="3949932">priv</span><span class="op" id="3949936">.</span><span class="ident" id="3949937">AdditionalPrimes</span><span class="op" id="3949953">)</span><span class="op" id="3949954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949957">key</span><span class="op" id="3949960">.</span><span class="ident" id="3949961">Primes</span><span class="op" id="3949967">[</span><span class="num" id="3949968">0</span><span class="op" id="3949969">]</span>&nbsp;<span class="op" id="3949971">=</span>&nbsp;<span class="ident" id="3949973">priv</span><span class="op" id="3949977">.</span><span class="ident" id="3949978">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949981">key</span><span class="op" id="3949984">.</span><span class="ident" id="3949985">Primes</span><span class="op" id="3949991">[</span><span class="num" id="3949992">1</span><span class="op" id="3949993">]</span>&nbsp;<span class="op" id="3949995">=</span>&nbsp;<span class="ident" id="3949997">priv</span><span class="op" id="3950001">.</span><span class="ident" id="3950002">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950005">for</span>&nbsp;<span class="ident" id="3950009">i</span><span class="op" id="3950010">,</span>&nbsp;<span class="ident" id="3950012">a</span>&nbsp;<span class="op" id="3950014">:=</span>&nbsp;<span class="keyword" id="3950017">range</span>&nbsp;<span class="ident" id="3950023">priv</span><span class="op" id="3950027">.</span><span class="ident" id="3950028">AdditionalPrimes</span>&nbsp;<span class="op" id="3950045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950049">if</span>&nbsp;<span class="ident" id="3950052">a</span><span class="op" id="3950053">.</span><span class="ident" id="3950054">Prime</span><span class="op" id="3950059">.</span><span class="ident" id="3950060">Sign</span><span class="op" id="3950064">(</span><span class="op" id="3950065">)</span>&nbsp;<span class="op" id="3950067">&lt;=</span>&nbsp;<span class="num" id="3950070">0</span>&nbsp;<span class="op" id="3950072">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950077">return</span>&nbsp;<span class="ident" id="3950084">nil</span><span class="op" id="3950087">,</span>&nbsp;<span class="ident" id="3950089">errors</span><span class="op" id="3950095">.</span><span class="ident" id="3950096">New</span><span class="op" id="3950099">(</span><span class="string" id="3950100">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="3950151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950159">key</span><span class="op" id="3950162">.</span><span class="ident" id="3950163">Primes</span><span class="op" id="3950169">[</span><span class="ident" id="3950170">i</span><span class="op" id="3950171">+</span><span class="num" id="3950172">2</span><span class="op" id="3950173">]</span>&nbsp;<span class="op" id="3950175">=</span>&nbsp;<span class="ident" id="3950177">a</span><span class="op" id="3950178">.</span><span class="ident" id="3950179">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3950187">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3950250">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950274">err</span>&nbsp;<span class="op" id="3950278">=</span>&nbsp;<span class="ident" id="3950280">key</span><span class="op" id="3950283">.</span><span class="ident" id="3950284">Validate</span><span class="op" id="3950292">(</span><span class="op" id="3950293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950296">if</span>&nbsp;<span class="ident" id="3950299">err</span>&nbsp;<span class="op" id="3950303">!=</span>&nbsp;<span class="ident" id="3950306">nil</span>&nbsp;<span class="op" id="3950310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950314">return</span>&nbsp;<span class="ident" id="3950321">nil</span><span class="op" id="3950324">,</span>&nbsp;<span class="ident" id="3950326">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950334">key</span><span class="op" id="3950337">.</span><span class="ident" id="3950338">Precompute</span><span class="op" id="3950348">(</span><span class="op" id="3950349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950353">return</span><br>
<span class="lineno"></span><span class="op" id="3950360">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3950363">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3950439">func</span>&nbsp;<span class="ident" id="3950444">MarshalPKCS1PrivateKey</span><span class="op" id="3950466">(</span><span class="ident" id="3950467">key</span>&nbsp;<span class="op" id="3950471">*</span><span class="ident" id="3950472">rsa</span><span class="op" id="3950475">.</span><span class="ident" id="3950476">PrivateKey</span><span class="op" id="3950486">)</span>&nbsp;<span class="op" id="3950488">[</span><span class="op" id="3950489">]</span><span class="builtintype" id="3950490">byte</span>&nbsp;<span class="op" id="3950495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950498">key</span><span class="op" id="3950501">.</span><span class="ident" id="3950502">Precompute</span><span class="op" id="3950512">(</span><span class="op" id="3950513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950517">version</span>&nbsp;<span class="op" id="3950525">:=</span>&nbsp;<span class="num" id="3950528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950531">if</span>&nbsp;<span class="builtinfunc" id="3950534">len</span><span class="op" id="3950537">(</span><span class="ident" id="3950538">key</span><span class="op" id="3950541">.</span><span class="ident" id="3950542">Primes</span><span class="op" id="3950548">)</span>&nbsp;<span class="op" id="3950550">&gt;</span>&nbsp;<span class="num" id="3950552">2</span>&nbsp;<span class="op" id="3950554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950558">version</span>&nbsp;<span class="op" id="3950566">=</span>&nbsp;<span class="num" id="3950568">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950575">priv</span>&nbsp;<span class="op" id="3950580">:=</span>&nbsp;<span class="ident" id="3950583">pkcs1PrivateKey</span><span class="op" id="3950598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950602">Version</span><span class="op" id="3950609">:</span>&nbsp;<span class="ident" id="3950611">version</span><span class="op" id="3950618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950622">N</span><span class="op" id="3950623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950631">key</span><span class="op" id="3950634">.</span><span class="ident" id="3950635">N</span><span class="op" id="3950636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950640">E</span><span class="op" id="3950641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950649">key</span><span class="op" id="3950652">.</span><span class="ident" id="3950653">PublicKey</span><span class="op" id="3950662">.</span><span class="ident" id="3950663">E</span><span class="op" id="3950664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950668">D</span><span class="op" id="3950669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950677">key</span><span class="op" id="3950680">.</span><span class="ident" id="3950681">D</span><span class="op" id="3950682">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950686">P</span><span class="op" id="3950687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950695">key</span><span class="op" id="3950698">.</span><span class="ident" id="3950699">Primes</span><span class="op" id="3950705">[</span><span class="num" id="3950706">0</span><span class="op" id="3950707">]</span><span class="op" id="3950708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950712">Q</span><span class="op" id="3950713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950721">key</span><span class="op" id="3950724">.</span><span class="ident" id="3950725">Primes</span><span class="op" id="3950731">[</span><span class="num" id="3950732">1</span><span class="op" id="3950733">]</span><span class="op" id="3950734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950738">Dp</span><span class="op" id="3950740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950747">key</span><span class="op" id="3950750">.</span><span class="ident" id="3950751">Precomputed</span><span class="op" id="3950762">.</span><span class="ident" id="3950763">Dp</span><span class="op" id="3950765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950769">Dq</span><span class="op" id="3950771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950778">key</span><span class="op" id="3950781">.</span><span class="ident" id="3950782">Precomputed</span><span class="op" id="3950793">.</span><span class="ident" id="3950794">Dq</span><span class="op" id="3950796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950800">Qinv</span><span class="op" id="3950804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950809">key</span><span class="op" id="3950812">.</span><span class="ident" id="3950813">Precomputed</span><span class="op" id="3950824">.</span><span class="ident" id="3950825">Qinv</span><span class="op" id="3950829">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950836">priv</span><span class="op" id="3950840">.</span><span class="ident" id="3950841">AdditionalPrimes</span>&nbsp;<span class="op" id="3950858">=</span>&nbsp;<span class="builtinfunc" id="3950860">make</span><span class="op" id="3950864">(</span><span class="op" id="3950865">[</span><span class="op" id="3950866">]</span><span class="ident" id="3950867">pkcs1AdditionalRSAPrime</span><span class="op" id="3950890">,</span>&nbsp;<span class="builtinfunc" id="3950892">len</span><span class="op" id="3950895">(</span><span class="ident" id="3950896">key</span><span class="op" id="3950899">.</span><span class="ident" id="3950900">Precomputed</span><span class="op" id="3950911">.</span><span class="ident" id="3950912">CRTValues</span><span class="op" id="3950921">)</span><span class="op" id="3950922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950925">for</span>&nbsp;<span class="ident" id="3950929">i</span><span class="op" id="3950930">,</span>&nbsp;<span class="ident" id="3950932">values</span>&nbsp;<span class="op" id="3950939">:=</span>&nbsp;<span class="keyword" id="3950942">range</span>&nbsp;<span class="ident" id="3950948">key</span><span class="op" id="3950951">.</span><span class="ident" id="3950952">Precomputed</span><span class="op" id="3950963">.</span><span class="ident" id="3950964">CRTValues</span>&nbsp;<span class="op" id="3950974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950978">priv</span><span class="op" id="3950982">.</span><span class="ident" id="3950983">AdditionalPrimes</span><span class="op" id="3950999">[</span><span class="ident" id="3951000">i</span><span class="op" id="3951001">]</span><span class="op" id="3951002">.</span><span class="ident" id="3951003">Prime</span>&nbsp;<span class="op" id="3951009">=</span>&nbsp;<span class="ident" id="3951011">key</span><span class="op" id="3951014">.</span><span class="ident" id="3951015">Primes</span><span class="op" id="3951021">[</span><span class="num" id="3951022">2</span><span class="op" id="3951023">+</span><span class="ident" id="3951024">i</span><span class="op" id="3951025">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951029">priv</span><span class="op" id="3951033">.</span><span class="ident" id="3951034">AdditionalPrimes</span><span class="op" id="3951050">[</span><span class="ident" id="3951051">i</span><span class="op" id="3951052">]</span><span class="op" id="3951053">.</span><span class="ident" id="3951054">Exp</span>&nbsp;<span class="op" id="3951058">=</span>&nbsp;<span class="ident" id="3951060">values</span><span class="op" id="3951066">.</span><span class="ident" id="3951067">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951073">priv</span><span class="op" id="3951077">.</span><span class="ident" id="3951078">AdditionalPrimes</span><span class="op" id="3951094">[</span><span class="ident" id="3951095">i</span><span class="op" id="3951096">]</span><span class="op" id="3951097">.</span><span class="ident" id="3951098">Coeff</span>&nbsp;<span class="op" id="3951104">=</span>&nbsp;<span class="ident" id="3951106">values</span><span class="op" id="3951112">.</span><span class="ident" id="3951113">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951124">b</span><span class="op" id="3951125">,</span>&nbsp;<span class="ident" id="3951127">_</span>&nbsp;<span class="op" id="3951129">:=</span>&nbsp;<span class="ident" id="3951132">asn1</span><span class="op" id="3951136">.</span><span class="ident" id="3951137">Marshal</span><span class="op" id="3951144">(</span><span class="ident" id="3951145">priv</span><span class="op" id="3951149">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951152">return</span>&nbsp;<span class="ident" id="3951159">b</span><br>
<span class="lineno"></span><span class="op" id="3951161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951164">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3951233">type</span>&nbsp;<span class="ident" id="3951238">rsaPublicKey</span>&nbsp;<span class="keyword" id="3951251">struct</span>&nbsp;<span class="op" id="3951258">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951261">N</span>&nbsp;<span class="op" id="3951263">*</span><span class="ident" id="3951264">big</span><span class="op" id="3951267">.</span><span class="ident" id="3951268">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951273">E</span>&nbsp;<span class="builtintype" id="3951275">int</span><br>
<span class="lineno"></span><span class="op" id="3951279">}</span>
</div>
</body>
</html>
