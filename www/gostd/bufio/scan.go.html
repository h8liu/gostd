<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3854863">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3854918">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3854972">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3855023">package</span>&nbsp;<span class="ident" id="3855031">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3855038">import</span>&nbsp;<span class="op" id="3855045">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3855048">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3855057">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3855067">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3855073">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3855088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3855091">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3855159">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3855225">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3855295">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3855360">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3855428">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3855506">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3855572">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3855641">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3855696">//</span><br>
<span class="lineno"></span><span class="comment" id="3855699">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3855775">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3855845">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3855918">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3855995">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3856044">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3856047">type</span>&nbsp;<span class="ident" id="3856052">Scanner</span>&nbsp;<span class="keyword" id="3856060">struct</span>&nbsp;<span class="op" id="3856067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856070">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856083">io</span><span class="op" id="3856085">.</span><span class="ident" id="3856086">Reader</span>&nbsp;<span class="comment" id="3856093">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856132">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856145">SplitFunc</span>&nbsp;<span class="comment" id="3856155">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856193">maxTokenSize</span>&nbsp;<span class="builtintype" id="3856206">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856216">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856264">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856277">[</span><span class="op" id="3856278">]</span><span class="builtintype" id="3856279">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856287">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856321">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856334">[</span><span class="op" id="3856335">]</span><span class="builtintype" id="3856336">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856344">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856382">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3856395">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856405">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856442">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3856455">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856465">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856489">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3856502">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856512">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856530">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3856543">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3856553">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3856590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3856593">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3856666">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3856744">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3856820">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3856895">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3856970">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3857048">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3857122">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3857200">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3857244">//</span><br>
<span class="lineno"></span><span class="comment" id="3857247">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3857313">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3857343">//</span><br>
<span class="lineno">55</span><span class="comment" id="3857346">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3857416">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3857482">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3857520">type</span>&nbsp;<span class="ident" id="3857525">SplitFunc</span>&nbsp;<span class="keyword" id="3857535">func</span><span class="op" id="3857539">(</span><span class="ident" id="3857540">data</span>&nbsp;<span class="op" id="3857545">[</span><span class="op" id="3857546">]</span><span class="builtintype" id="3857547">byte</span><span class="op" id="3857551">,</span>&nbsp;<span class="ident" id="3857553">atEOF</span>&nbsp;<span class="builtintype" id="3857559">bool</span><span class="op" id="3857563">)</span>&nbsp;<span class="op" id="3857565">(</span><span class="ident" id="3857566">advance</span>&nbsp;<span class="builtintype" id="3857574">int</span><span class="op" id="3857577">,</span>&nbsp;<span class="ident" id="3857579">token</span>&nbsp;<span class="op" id="3857585">[</span><span class="op" id="3857586">]</span><span class="builtintype" id="3857587">byte</span><span class="op" id="3857591">,</span>&nbsp;<span class="ident" id="3857593">err</span>&nbsp;<span class="builtintype" id="3857597">error</span><span class="op" id="3857602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3857605">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3857636">var</span>&nbsp;<span class="op" id="3857640">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857643">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3857662">=</span>&nbsp;<span class="ident" id="3857664">errors</span><span class="op" id="3857670">.</span><span class="ident" id="3857671">New</span><span class="op" id="3857674">(</span><span class="string" id="3857675">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3857706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857709">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3857728">=</span>&nbsp;<span class="ident" id="3857730">errors</span><span class="op" id="3857736">.</span><span class="ident" id="3857737">New</span><span class="op" id="3857740">(</span><span class="string" id="3857741">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3857798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857801">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3857820">=</span>&nbsp;<span class="ident" id="3857822">errors</span><span class="op" id="3857828">.</span><span class="ident" id="3857829">New</span><span class="op" id="3857832">(</span><span class="string" id="3857833">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3857894">)</span><br>
<span class="lineno">65</span><span class="op" id="3857896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3857899">const</span>&nbsp;<span class="op" id="3857905">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857908">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857973">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3858036">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858086">MaxScanTokenSize</span>&nbsp;<span class="op" id="3858103">=</span>&nbsp;<span class="num" id="3858105">64</span>&nbsp;<span class="op" id="3858108">*</span>&nbsp;<span class="num" id="3858110">1024</span><br>
<span class="lineno"></span><span class="op" id="3858115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3858118">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3858170">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3858215">func</span>&nbsp;<span class="ident" id="3858220">NewScanner</span><span class="op" id="3858230">(</span><span class="ident" id="3858231">r</span>&nbsp;<span class="ident" id="3858233">io</span><span class="op" id="3858235">.</span><span class="ident" id="3858236">Reader</span><span class="op" id="3858242">)</span>&nbsp;<span class="op" id="3858244">*</span><span class="ident" id="3858245">Scanner</span>&nbsp;<span class="op" id="3858253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858256">return</span>&nbsp;<span class="op" id="3858263">&amp;</span><span class="ident" id="3858264">Scanner</span><span class="op" id="3858271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858275">r</span><span class="op" id="3858276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3858289">r</span><span class="op" id="3858290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858294">split</span><span class="op" id="3858299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3858308">ScanLines</span><span class="op" id="3858317">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858321">maxTokenSize</span><span class="op" id="3858333">:</span>&nbsp;<span class="ident" id="3858335">MaxScanTokenSize</span><span class="op" id="3858351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858355">buf</span><span class="op" id="3858358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858369">make</span><span class="op" id="3858373">(</span><span class="op" id="3858374">[</span><span class="op" id="3858375">]</span><span class="builtintype" id="3858376">byte</span><span class="op" id="3858380">,</span>&nbsp;<span class="num" id="3858382">4096</span><span class="op" id="3858386">)</span><span class="op" id="3858387">,</span>&nbsp;<span class="comment" id="3858389">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858436">}</span><br>
<span class="lineno"></span><span class="op" id="3858438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3858441">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3858517">func</span>&nbsp;<span class="op" id="3858522">(</span><span class="ident" id="3858523">s</span>&nbsp;<span class="op" id="3858525">*</span><span class="ident" id="3858526">Scanner</span><span class="op" id="3858533">)</span>&nbsp;<span class="ident" id="3858535">Err</span><span class="op" id="3858538">(</span><span class="op" id="3858539">)</span>&nbsp;<span class="builtintype" id="3858541">error</span>&nbsp;<span class="op" id="3858547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858550">if</span>&nbsp;<span class="ident" id="3858553">s</span><span class="op" id="3858554">.</span><span class="ident" id="3858555">err</span>&nbsp;<span class="op" id="3858559">==</span>&nbsp;<span class="ident" id="3858562">io</span><span class="op" id="3858564">.</span><span class="ident" id="3858565">EOF</span>&nbsp;<span class="op" id="3858569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858573">return</span>&nbsp;<span class="ident" id="3858580">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858585">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858588">return</span>&nbsp;<span class="ident" id="3858595">s</span><span class="op" id="3858596">.</span><span class="ident" id="3858597">err</span><br>
<span class="lineno"></span><span class="op" id="3858601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3858604">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3858672">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3858739">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3858795">func</span>&nbsp;<span class="op" id="3858800">(</span><span class="ident" id="3858801">s</span>&nbsp;<span class="op" id="3858803">*</span><span class="ident" id="3858804">Scanner</span><span class="op" id="3858811">)</span>&nbsp;<span class="ident" id="3858813">Bytes</span><span class="op" id="3858818">(</span><span class="op" id="3858819">)</span>&nbsp;<span class="op" id="3858821">[</span><span class="op" id="3858822">]</span><span class="builtintype" id="3858823">byte</span>&nbsp;<span class="op" id="3858828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858831">return</span>&nbsp;<span class="ident" id="3858838">s</span><span class="op" id="3858839">.</span><span class="ident" id="3858840">token</span><br>
<span class="lineno"></span><span class="op" id="3858846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3858849">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3858915">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3858965">func</span>&nbsp;<span class="op" id="3858970">(</span><span class="ident" id="3858971">s</span>&nbsp;<span class="op" id="3858973">*</span><span class="ident" id="3858974">Scanner</span><span class="op" id="3858981">)</span>&nbsp;<span class="ident" id="3858983">Text</span><span class="op" id="3858987">(</span><span class="op" id="3858988">)</span>&nbsp;<span class="builtintype" id="3858990">string</span>&nbsp;<span class="op" id="3858997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859000">return</span>&nbsp;<span class="builtintype" id="3859007">string</span><span class="op" id="3859013">(</span><span class="ident" id="3859014">s</span><span class="op" id="3859015">.</span><span class="ident" id="3859016">token</span><span class="op" id="3859021">)</span><br>
<span class="lineno"></span><span class="op" id="3859023">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3859026">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3859093">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3859166">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3859234">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3859305">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3859368">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3859388">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3859459">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3859525">func</span>&nbsp;<span class="op" id="3859530">(</span><span class="ident" id="3859531">s</span>&nbsp;<span class="op" id="3859533">*</span><span class="ident" id="3859534">Scanner</span><span class="op" id="3859541">)</span>&nbsp;<span class="ident" id="3859543">Scan</span><span class="op" id="3859547">(</span><span class="op" id="3859548">)</span>&nbsp;<span class="builtintype" id="3859550">bool</span>&nbsp;<span class="op" id="3859555">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859558">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859590">for</span>&nbsp;<span class="op" id="3859594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859598">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859656">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859729">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859791">if</span>&nbsp;<span class="ident" id="3859794">s</span><span class="op" id="3859795">.</span><span class="ident" id="3859796">end</span>&nbsp;<span class="op" id="3859800">&gt;</span>&nbsp;<span class="ident" id="3859802">s</span><span class="op" id="3859803">.</span><span class="ident" id="3859804">start</span>&nbsp;<span class="op" id="3859810">||</span>&nbsp;<span class="ident" id="3859813">s</span><span class="op" id="3859814">.</span><span class="ident" id="3859815">err</span>&nbsp;<span class="op" id="3859819">!=</span>&nbsp;<span class="ident" id="3859822">nil</span>&nbsp;<span class="op" id="3859826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859831">advance</span><span class="op" id="3859838">,</span>&nbsp;<span class="ident" id="3859840">token</span><span class="op" id="3859845">,</span>&nbsp;<span class="ident" id="3859847">err</span>&nbsp;<span class="op" id="3859851">:=</span>&nbsp;<span class="ident" id="3859854">s</span><span class="op" id="3859855">.</span><span class="ident" id="3859856">split</span><span class="op" id="3859861">(</span><span class="ident" id="3859862">s</span><span class="op" id="3859863">.</span><span class="ident" id="3859864">buf</span><span class="op" id="3859867">[</span><span class="ident" id="3859868">s</span><span class="op" id="3859869">.</span><span class="ident" id="3859870">start</span><span class="op" id="3859875">:</span><span class="ident" id="3859876">s</span><span class="op" id="3859877">.</span><span class="ident" id="3859878">end</span><span class="op" id="3859881">]</span><span class="op" id="3859882">,</span>&nbsp;<span class="ident" id="3859884">s</span><span class="op" id="3859885">.</span><span class="ident" id="3859886">err</span>&nbsp;<span class="op" id="3859890">!=</span>&nbsp;<span class="ident" id="3859893">nil</span><span class="op" id="3859896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859901">if</span>&nbsp;<span class="ident" id="3859904">err</span>&nbsp;<span class="op" id="3859908">!=</span>&nbsp;<span class="ident" id="3859911">nil</span>&nbsp;<span class="op" id="3859915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859921">s</span><span class="op" id="3859922">.</span><span class="ident" id="3859923">setErr</span><span class="op" id="3859929">(</span><span class="ident" id="3859930">err</span><span class="op" id="3859933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859939">return</span>&nbsp;<span class="builtintype" id="3859946">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859960">if</span>&nbsp;<span class="op" id="3859963">!</span><span class="ident" id="3859964">s</span><span class="op" id="3859965">.</span><span class="ident" id="3859966">advance</span><span class="op" id="3859973">(</span><span class="ident" id="3859974">advance</span><span class="op" id="3859981">)</span>&nbsp;<span class="op" id="3859983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859989">return</span>&nbsp;<span class="builtintype" id="3859996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860010">s</span><span class="op" id="3860011">.</span><span class="ident" id="3860012">token</span>&nbsp;<span class="op" id="3860018">=</span>&nbsp;<span class="ident" id="3860020">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860029">if</span>&nbsp;<span class="ident" id="3860032">token</span>&nbsp;<span class="op" id="3860038">!=</span>&nbsp;<span class="ident" id="3860041">nil</span>&nbsp;<span class="op" id="3860045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860051">if</span>&nbsp;<span class="ident" id="3860054">s</span><span class="op" id="3860055">.</span><span class="ident" id="3860056">err</span>&nbsp;<span class="op" id="3860060">==</span>&nbsp;<span class="ident" id="3860063">nil</span>&nbsp;<span class="op" id="3860067">||</span>&nbsp;<span class="ident" id="3860070">advance</span>&nbsp;<span class="op" id="3860078">&gt;</span>&nbsp;<span class="num" id="3860080">0</span>&nbsp;<span class="op" id="3860082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860089">s</span><span class="op" id="3860090">.</span><span class="ident" id="3860091">empties</span>&nbsp;<span class="op" id="3860099">=</span>&nbsp;<span class="num" id="3860101">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860107">}</span>&nbsp;<span class="keyword" id="3860109">else</span>&nbsp;<span class="op" id="3860114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860121">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860174">s</span><span class="op" id="3860175">.</span><span class="ident" id="3860176">empties</span><span class="op" id="3860183">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860191">if</span>&nbsp;<span class="ident" id="3860194">s</span><span class="op" id="3860195">.</span><span class="ident" id="3860196">empties</span>&nbsp;<span class="op" id="3860204">&gt;</span>&nbsp;<span class="num" id="3860206">100</span>&nbsp;<span class="op" id="3860210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3860218">panic</span><span class="op" id="3860223">(</span><span class="string" id="3860224">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3860274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860287">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860293">return</span>&nbsp;<span class="builtintype" id="3860300">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860316">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860374">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860434">if</span>&nbsp;<span class="ident" id="3860437">s</span><span class="op" id="3860438">.</span><span class="ident" id="3860439">err</span>&nbsp;<span class="op" id="3860443">!=</span>&nbsp;<span class="ident" id="3860446">nil</span>&nbsp;<span class="op" id="3860450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860455">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860475">s</span><span class="op" id="3860476">.</span><span class="ident" id="3860477">start</span>&nbsp;<span class="op" id="3860483">=</span>&nbsp;<span class="num" id="3860485">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860490">s</span><span class="op" id="3860491">.</span><span class="ident" id="3860492">end</span>&nbsp;<span class="op" id="3860496">=</span>&nbsp;<span class="num" id="3860498">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860503">return</span>&nbsp;<span class="builtintype" id="3860510">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860522">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860548">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860625">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860650">if</span>&nbsp;<span class="ident" id="3860653">s</span><span class="op" id="3860654">.</span><span class="ident" id="3860655">start</span>&nbsp;<span class="op" id="3860661">&gt;</span>&nbsp;<span class="num" id="3860663">0</span>&nbsp;<span class="op" id="3860665">&amp;&amp;</span>&nbsp;<span class="op" id="3860668">(</span><span class="ident" id="3860669">s</span><span class="op" id="3860670">.</span><span class="ident" id="3860671">end</span>&nbsp;<span class="op" id="3860675">==</span>&nbsp;<span class="builtinfunc" id="3860678">len</span><span class="op" id="3860681">(</span><span class="ident" id="3860682">s</span><span class="op" id="3860683">.</span><span class="ident" id="3860684">buf</span><span class="op" id="3860687">)</span>&nbsp;<span class="op" id="3860689">||</span>&nbsp;<span class="ident" id="3860692">s</span><span class="op" id="3860693">.</span><span class="ident" id="3860694">start</span>&nbsp;<span class="op" id="3860700">&gt;</span>&nbsp;<span class="builtinfunc" id="3860702">len</span><span class="op" id="3860705">(</span><span class="ident" id="3860706">s</span><span class="op" id="3860707">.</span><span class="ident" id="3860708">buf</span><span class="op" id="3860711">)</span><span class="op" id="3860712">/</span><span class="num" id="3860713">2</span><span class="op" id="3860714">)</span>&nbsp;<span class="op" id="3860716">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3860721">copy</span><span class="op" id="3860725">(</span><span class="ident" id="3860726">s</span><span class="op" id="3860727">.</span><span class="ident" id="3860728">buf</span><span class="op" id="3860731">,</span>&nbsp;<span class="ident" id="3860733">s</span><span class="op" id="3860734">.</span><span class="ident" id="3860735">buf</span><span class="op" id="3860738">[</span><span class="ident" id="3860739">s</span><span class="op" id="3860740">.</span><span class="ident" id="3860741">start</span><span class="op" id="3860746">:</span><span class="ident" id="3860747">s</span><span class="op" id="3860748">.</span><span class="ident" id="3860749">end</span><span class="op" id="3860752">]</span><span class="op" id="3860753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860758">s</span><span class="op" id="3860759">.</span><span class="ident" id="3860760">end</span>&nbsp;<span class="op" id="3860764">-=</span>&nbsp;<span class="ident" id="3860767">s</span><span class="op" id="3860768">.</span><span class="ident" id="3860769">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860778">s</span><span class="op" id="3860779">.</span><span class="ident" id="3860780">start</span>&nbsp;<span class="op" id="3860786">=</span>&nbsp;<span class="num" id="3860788">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860796">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860836">if</span>&nbsp;<span class="ident" id="3860839">s</span><span class="op" id="3860840">.</span><span class="ident" id="3860841">end</span>&nbsp;<span class="op" id="3860845">==</span>&nbsp;<span class="builtinfunc" id="3860848">len</span><span class="op" id="3860851">(</span><span class="ident" id="3860852">s</span><span class="op" id="3860853">.</span><span class="ident" id="3860854">buf</span><span class="op" id="3860857">)</span>&nbsp;<span class="op" id="3860859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860864">if</span>&nbsp;<span class="builtinfunc" id="3860867">len</span><span class="op" id="3860870">(</span><span class="ident" id="3860871">s</span><span class="op" id="3860872">.</span><span class="ident" id="3860873">buf</span><span class="op" id="3860876">)</span>&nbsp;<span class="op" id="3860878">&gt;=</span>&nbsp;<span class="ident" id="3860881">s</span><span class="op" id="3860882">.</span><span class="ident" id="3860883">maxTokenSize</span>&nbsp;<span class="op" id="3860896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860902">s</span><span class="op" id="3860903">.</span><span class="ident" id="3860904">setErr</span><span class="op" id="3860910">(</span><span class="ident" id="3860911">ErrTooLong</span><span class="op" id="3860921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860927">return</span>&nbsp;<span class="builtintype" id="3860934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860943">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860948">newSize</span>&nbsp;<span class="op" id="3860956">:=</span>&nbsp;<span class="builtinfunc" id="3860959">len</span><span class="op" id="3860962">(</span><span class="ident" id="3860963">s</span><span class="op" id="3860964">.</span><span class="ident" id="3860965">buf</span><span class="op" id="3860968">)</span>&nbsp;<span class="op" id="3860970">*</span>&nbsp;<span class="num" id="3860972">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860977">if</span>&nbsp;<span class="ident" id="3860980">newSize</span>&nbsp;<span class="op" id="3860988">&gt;</span>&nbsp;<span class="ident" id="3860990">s</span><span class="op" id="3860991">.</span><span class="ident" id="3860992">maxTokenSize</span>&nbsp;<span class="op" id="3861005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861011">newSize</span>&nbsp;<span class="op" id="3861019">=</span>&nbsp;<span class="ident" id="3861021">s</span><span class="op" id="3861022">.</span><span class="ident" id="3861023">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861044">newBuf</span>&nbsp;<span class="op" id="3861051">:=</span>&nbsp;<span class="builtinfunc" id="3861054">make</span><span class="op" id="3861058">(</span><span class="op" id="3861059">[</span><span class="op" id="3861060">]</span><span class="builtintype" id="3861061">byte</span><span class="op" id="3861065">,</span>&nbsp;<span class="ident" id="3861067">newSize</span><span class="op" id="3861074">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3861079">copy</span><span class="op" id="3861083">(</span><span class="ident" id="3861084">newBuf</span><span class="op" id="3861090">,</span>&nbsp;<span class="ident" id="3861092">s</span><span class="op" id="3861093">.</span><span class="ident" id="3861094">buf</span><span class="op" id="3861097">[</span><span class="ident" id="3861098">s</span><span class="op" id="3861099">.</span><span class="ident" id="3861100">start</span><span class="op" id="3861105">:</span><span class="ident" id="3861106">s</span><span class="op" id="3861107">.</span><span class="ident" id="3861108">end</span><span class="op" id="3861111">]</span><span class="op" id="3861112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861117">s</span><span class="op" id="3861118">.</span><span class="ident" id="3861119">buf</span>&nbsp;<span class="op" id="3861123">=</span>&nbsp;<span class="ident" id="3861125">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861135">s</span><span class="op" id="3861136">.</span><span class="ident" id="3861137">end</span>&nbsp;<span class="op" id="3861141">-=</span>&nbsp;<span class="ident" id="3861144">s</span><span class="op" id="3861145">.</span><span class="ident" id="3861146">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861155">s</span><span class="op" id="3861156">.</span><span class="ident" id="3861157">start</span>&nbsp;<span class="op" id="3861163">=</span>&nbsp;<span class="num" id="3861165">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861170">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861185">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861256">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861330">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861387">for</span>&nbsp;<span class="ident" id="3861391">loop</span>&nbsp;<span class="op" id="3861396">:=</span>&nbsp;<span class="num" id="3861399">0</span><span class="op" id="3861400">;</span>&nbsp;<span class="op" id="3861402">;</span>&nbsp;<span class="op" id="3861404">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861409">n</span><span class="op" id="3861410">,</span>&nbsp;<span class="ident" id="3861412">err</span>&nbsp;<span class="op" id="3861416">:=</span>&nbsp;<span class="ident" id="3861419">s</span><span class="op" id="3861420">.</span><span class="ident" id="3861421">r</span><span class="op" id="3861422">.</span><span class="ident" id="3861423">Read</span><span class="op" id="3861427">(</span><span class="ident" id="3861428">s</span><span class="op" id="3861429">.</span><span class="ident" id="3861430">buf</span><span class="op" id="3861433">[</span><span class="ident" id="3861434">s</span><span class="op" id="3861435">.</span><span class="ident" id="3861436">end</span><span class="op" id="3861439">:</span><span class="builtinfunc" id="3861440">len</span><span class="op" id="3861443">(</span><span class="ident" id="3861444">s</span><span class="op" id="3861445">.</span><span class="ident" id="3861446">buf</span><span class="op" id="3861449">)</span><span class="op" id="3861450">]</span><span class="op" id="3861451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861456">s</span><span class="op" id="3861457">.</span><span class="ident" id="3861458">end</span>&nbsp;<span class="op" id="3861462">+=</span>&nbsp;<span class="ident" id="3861465">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861470">if</span>&nbsp;<span class="ident" id="3861473">err</span>&nbsp;<span class="op" id="3861477">!=</span>&nbsp;<span class="ident" id="3861480">nil</span>&nbsp;<span class="op" id="3861484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861490">s</span><span class="op" id="3861491">.</span><span class="ident" id="3861492">setErr</span><span class="op" id="3861498">(</span><span class="ident" id="3861499">err</span><span class="op" id="3861502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861508">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861522">if</span>&nbsp;<span class="ident" id="3861525">n</span>&nbsp;<span class="op" id="3861527">&gt;</span>&nbsp;<span class="num" id="3861529">0</span>&nbsp;<span class="op" id="3861531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861537">s</span><span class="op" id="3861538">.</span><span class="ident" id="3861539">empties</span>&nbsp;<span class="op" id="3861547">=</span>&nbsp;<span class="num" id="3861549">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861555">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861564">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861569">loop</span><span class="op" id="3861573">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861579">if</span>&nbsp;<span class="ident" id="3861582">loop</span>&nbsp;<span class="op" id="3861587">&gt;</span>&nbsp;<span class="ident" id="3861589">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3861614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861620">s</span><span class="op" id="3861621">.</span><span class="ident" id="3861622">setErr</span><span class="op" id="3861628">(</span><span class="ident" id="3861629">io</span><span class="op" id="3861631">.</span><span class="ident" id="3861632">ErrNoProgress</span><span class="op" id="3861645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861651">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861660">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861667">}</span><br>
<span class="lineno"></span><span class="op" id="3861669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3861672">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3861757">func</span>&nbsp;<span class="op" id="3861762">(</span><span class="ident" id="3861763">s</span>&nbsp;<span class="op" id="3861765">*</span><span class="ident" id="3861766">Scanner</span><span class="op" id="3861773">)</span>&nbsp;<span class="ident" id="3861775">advance</span><span class="op" id="3861782">(</span><span class="ident" id="3861783">n</span>&nbsp;<span class="builtintype" id="3861785">int</span><span class="op" id="3861788">)</span>&nbsp;<span class="builtintype" id="3861790">bool</span>&nbsp;<span class="op" id="3861795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861798">if</span>&nbsp;<span class="ident" id="3861801">n</span>&nbsp;<span class="op" id="3861803">&lt;</span>&nbsp;<span class="num" id="3861805">0</span>&nbsp;<span class="op" id="3861807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861811">s</span><span class="op" id="3861812">.</span><span class="ident" id="3861813">setErr</span><span class="op" id="3861819">(</span><span class="ident" id="3861820">ErrNegativeAdvance</span><span class="op" id="3861838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861842">return</span>&nbsp;<span class="builtintype" id="3861849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861856">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861859">if</span>&nbsp;<span class="ident" id="3861862">n</span>&nbsp;<span class="op" id="3861864">&gt;</span>&nbsp;<span class="ident" id="3861866">s</span><span class="op" id="3861867">.</span><span class="ident" id="3861868">end</span><span class="op" id="3861871">-</span><span class="ident" id="3861872">s</span><span class="op" id="3861873">.</span><span class="ident" id="3861874">start</span>&nbsp;<span class="op" id="3861880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861884">s</span><span class="op" id="3861885">.</span><span class="ident" id="3861886">setErr</span><span class="op" id="3861892">(</span><span class="ident" id="3861893">ErrAdvanceTooFar</span><span class="op" id="3861909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861913">return</span>&nbsp;<span class="builtintype" id="3861920">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861930">s</span><span class="op" id="3861931">.</span><span class="ident" id="3861932">start</span>&nbsp;<span class="op" id="3861938">+=</span>&nbsp;<span class="ident" id="3861941">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861944">return</span>&nbsp;<span class="builtintype" id="3861951">true</span><br>
<span class="lineno"></span><span class="op" id="3861956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3861959">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3862006">func</span>&nbsp;<span class="op" id="3862011">(</span><span class="ident" id="3862012">s</span>&nbsp;<span class="op" id="3862014">*</span><span class="ident" id="3862015">Scanner</span><span class="op" id="3862022">)</span>&nbsp;<span class="ident" id="3862024">setErr</span><span class="op" id="3862030">(</span><span class="ident" id="3862031">err</span>&nbsp;<span class="builtintype" id="3862035">error</span><span class="op" id="3862040">)</span>&nbsp;<span class="op" id="3862042">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862045">if</span>&nbsp;<span class="ident" id="3862048">s</span><span class="op" id="3862049">.</span><span class="ident" id="3862050">err</span>&nbsp;<span class="op" id="3862054">==</span>&nbsp;<span class="ident" id="3862057">nil</span>&nbsp;<span class="op" id="3862061">||</span>&nbsp;<span class="ident" id="3862064">s</span><span class="op" id="3862065">.</span><span class="ident" id="3862066">err</span>&nbsp;<span class="op" id="3862070">==</span>&nbsp;<span class="ident" id="3862073">io</span><span class="op" id="3862075">.</span><span class="ident" id="3862076">EOF</span>&nbsp;<span class="op" id="3862080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862084">s</span><span class="op" id="3862085">.</span><span class="ident" id="3862086">err</span>&nbsp;<span class="op" id="3862090">=</span>&nbsp;<span class="ident" id="3862092">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862097">}</span><br>
<span class="lineno"></span><span class="op" id="3862099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3862102">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3862174">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3862238">func</span>&nbsp;<span class="op" id="3862243">(</span><span class="ident" id="3862244">s</span>&nbsp;<span class="op" id="3862246">*</span><span class="ident" id="3862247">Scanner</span><span class="op" id="3862254">)</span>&nbsp;<span class="ident" id="3862256">Split</span><span class="op" id="3862261">(</span><span class="ident" id="3862262">split</span>&nbsp;<span class="ident" id="3862268">SplitFunc</span><span class="op" id="3862277">)</span>&nbsp;<span class="op" id="3862279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862282">s</span><span class="op" id="3862283">.</span><span class="ident" id="3862284">split</span>&nbsp;<span class="op" id="3862290">=</span>&nbsp;<span class="ident" id="3862292">split</span><br>
<span class="lineno"></span><span class="op" id="3862298">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3862301">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3862321">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3862403">func</span>&nbsp;<span class="ident" id="3862408">ScanBytes</span><span class="op" id="3862417">(</span><span class="ident" id="3862418">data</span>&nbsp;<span class="op" id="3862423">[</span><span class="op" id="3862424">]</span><span class="builtintype" id="3862425">byte</span><span class="op" id="3862429">,</span>&nbsp;<span class="ident" id="3862431">atEOF</span>&nbsp;<span class="builtintype" id="3862437">bool</span><span class="op" id="3862441">)</span>&nbsp;<span class="op" id="3862443">(</span><span class="ident" id="3862444">advance</span>&nbsp;<span class="builtintype" id="3862452">int</span><span class="op" id="3862455">,</span>&nbsp;<span class="ident" id="3862457">token</span>&nbsp;<span class="op" id="3862463">[</span><span class="op" id="3862464">]</span><span class="builtintype" id="3862465">byte</span><span class="op" id="3862469">,</span>&nbsp;<span class="ident" id="3862471">err</span>&nbsp;<span class="builtintype" id="3862475">error</span><span class="op" id="3862480">)</span>&nbsp;<span class="op" id="3862482">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862485">if</span>&nbsp;<span class="ident" id="3862488">atEOF</span>&nbsp;<span class="op" id="3862494">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3862497">len</span><span class="op" id="3862500">(</span><span class="ident" id="3862501">data</span><span class="op" id="3862505">)</span>&nbsp;<span class="op" id="3862507">==</span>&nbsp;<span class="num" id="3862510">0</span>&nbsp;<span class="op" id="3862512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862516">return</span>&nbsp;<span class="num" id="3862523">0</span><span class="op" id="3862524">,</span>&nbsp;<span class="ident" id="3862526">nil</span><span class="op" id="3862529">,</span>&nbsp;<span class="ident" id="3862531">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862539">return</span>&nbsp;<span class="num" id="3862546">1</span><span class="op" id="3862547">,</span>&nbsp;<span class="ident" id="3862549">data</span><span class="op" id="3862553">[</span><span class="num" id="3862554">0</span><span class="op" id="3862555">:</span><span class="num" id="3862556">1</span><span class="op" id="3862557">]</span><span class="op" id="3862558">,</span>&nbsp;<span class="ident" id="3862560">nil</span><br>
<span class="lineno"></span><span class="op" id="3862564">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3862567">var</span>&nbsp;<span class="ident" id="3862571">errorRune</span>&nbsp;<span class="op" id="3862581">=</span>&nbsp;<span class="op" id="3862583">[</span><span class="op" id="3862584">]</span><span class="builtintype" id="3862585">byte</span><span class="op" id="3862589">(</span><span class="builtintype" id="3862590">string</span><span class="op" id="3862596">(</span><span class="ident" id="3862597">utf8</span><span class="op" id="3862601">.</span><span class="ident" id="3862602">RuneError</span><span class="op" id="3862611">)</span><span class="op" id="3862612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3862615">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3862680">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3862748">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3862822">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3862900">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3862977">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3863050">func</span>&nbsp;<span class="ident" id="3863055">ScanRunes</span><span class="op" id="3863064">(</span><span class="ident" id="3863065">data</span>&nbsp;<span class="op" id="3863070">[</span><span class="op" id="3863071">]</span><span class="builtintype" id="3863072">byte</span><span class="op" id="3863076">,</span>&nbsp;<span class="ident" id="3863078">atEOF</span>&nbsp;<span class="builtintype" id="3863084">bool</span><span class="op" id="3863088">)</span>&nbsp;<span class="op" id="3863090">(</span><span class="ident" id="3863091">advance</span>&nbsp;<span class="builtintype" id="3863099">int</span><span class="op" id="3863102">,</span>&nbsp;<span class="ident" id="3863104">token</span>&nbsp;<span class="op" id="3863110">[</span><span class="op" id="3863111">]</span><span class="builtintype" id="3863112">byte</span><span class="op" id="3863116">,</span>&nbsp;<span class="ident" id="3863118">err</span>&nbsp;<span class="builtintype" id="3863122">error</span><span class="op" id="3863127">)</span>&nbsp;<span class="op" id="3863129">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863132">if</span>&nbsp;<span class="ident" id="3863135">atEOF</span>&nbsp;<span class="op" id="3863141">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3863144">len</span><span class="op" id="3863147">(</span><span class="ident" id="3863148">data</span><span class="op" id="3863152">)</span>&nbsp;<span class="op" id="3863154">==</span>&nbsp;<span class="num" id="3863157">0</span>&nbsp;<span class="op" id="3863159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863163">return</span>&nbsp;<span class="num" id="3863170">0</span><span class="op" id="3863171">,</span>&nbsp;<span class="ident" id="3863173">nil</span><span class="op" id="3863176">,</span>&nbsp;<span class="ident" id="3863178">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863187">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863211">if</span>&nbsp;<span class="ident" id="3863214">data</span><span class="op" id="3863218">[</span><span class="num" id="3863219">0</span><span class="op" id="3863220">]</span>&nbsp;<span class="op" id="3863222">&lt;</span>&nbsp;<span class="ident" id="3863224">utf8</span><span class="op" id="3863228">.</span><span class="ident" id="3863229">RuneSelf</span>&nbsp;<span class="op" id="3863238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863242">return</span>&nbsp;<span class="num" id="3863249">1</span><span class="op" id="3863250">,</span>&nbsp;<span class="ident" id="3863252">data</span><span class="op" id="3863256">[</span><span class="num" id="3863257">0</span><span class="op" id="3863258">:</span><span class="num" id="3863259">1</span><span class="op" id="3863260">]</span><span class="op" id="3863261">,</span>&nbsp;<span class="ident" id="3863263">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863272">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863325">_</span><span class="op" id="3863326">,</span>&nbsp;<span class="ident" id="3863328">width</span>&nbsp;<span class="op" id="3863334">:=</span>&nbsp;<span class="ident" id="3863337">utf8</span><span class="op" id="3863341">.</span><span class="ident" id="3863342">DecodeRune</span><span class="op" id="3863352">(</span><span class="ident" id="3863353">data</span><span class="op" id="3863357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863360">if</span>&nbsp;<span class="ident" id="3863363">width</span>&nbsp;<span class="op" id="3863369">&gt;</span>&nbsp;<span class="num" id="3863371">1</span>&nbsp;<span class="op" id="3863373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863377">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863449">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863470">return</span>&nbsp;<span class="ident" id="3863477">width</span><span class="op" id="3863482">,</span>&nbsp;<span class="ident" id="3863484">data</span><span class="op" id="3863488">[</span><span class="num" id="3863489">0</span><span class="op" id="3863490">:</span><span class="ident" id="3863491">width</span><span class="op" id="3863496">]</span><span class="op" id="3863497">,</span>&nbsp;<span class="ident" id="3863499">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863508">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863586">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863651">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863732">if</span>&nbsp;<span class="op" id="3863735">!</span><span class="ident" id="3863736">atEOF</span>&nbsp;<span class="op" id="3863742">&amp;&amp;</span>&nbsp;<span class="op" id="3863745">!</span><span class="ident" id="3863746">utf8</span><span class="op" id="3863750">.</span><span class="ident" id="3863751">FullRune</span><span class="op" id="3863759">(</span><span class="ident" id="3863760">data</span><span class="op" id="3863764">)</span>&nbsp;<span class="op" id="3863766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863770">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863803">return</span>&nbsp;<span class="num" id="3863810">0</span><span class="op" id="3863811">,</span>&nbsp;<span class="ident" id="3863813">nil</span><span class="op" id="3863816">,</span>&nbsp;<span class="ident" id="3863818">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863827">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863905">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863983">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864018">return</span>&nbsp;<span class="num" id="3864025">1</span><span class="op" id="3864026">,</span>&nbsp;<span class="ident" id="3864028">errorRune</span><span class="op" id="3864037">,</span>&nbsp;<span class="ident" id="3864039">nil</span><br>
<span class="lineno"></span><span class="op" id="3864043">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3864046">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3864091">func</span>&nbsp;<span class="ident" id="3864096">dropCR</span><span class="op" id="3864102">(</span><span class="ident" id="3864103">data</span>&nbsp;<span class="op" id="3864108">[</span><span class="op" id="3864109">]</span><span class="builtintype" id="3864110">byte</span><span class="op" id="3864114">)</span>&nbsp;<span class="op" id="3864116">[</span><span class="op" id="3864117">]</span><span class="builtintype" id="3864118">byte</span>&nbsp;<span class="op" id="3864123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864126">if</span>&nbsp;<span class="builtinfunc" id="3864129">len</span><span class="op" id="3864132">(</span><span class="ident" id="3864133">data</span><span class="op" id="3864137">)</span>&nbsp;<span class="op" id="3864139">&gt;</span>&nbsp;<span class="num" id="3864141">0</span>&nbsp;<span class="op" id="3864143">&amp;&amp;</span>&nbsp;<span class="ident" id="3864146">data</span><span class="op" id="3864150">[</span><span class="builtinfunc" id="3864151">len</span><span class="op" id="3864154">(</span><span class="ident" id="3864155">data</span><span class="op" id="3864159">)</span><span class="op" id="3864160">-</span><span class="num" id="3864161">1</span><span class="op" id="3864162">]</span>&nbsp;<span class="op" id="3864164">==</span>&nbsp;<span class="string" id="3864167">&#39;\r&#39;</span>&nbsp;<span class="op" id="3864172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864176">return</span>&nbsp;<span class="ident" id="3864183">data</span><span class="op" id="3864187">[</span><span class="num" id="3864188">0</span>&nbsp;<span class="op" id="3864190">:</span>&nbsp;<span class="builtinfunc" id="3864192">len</span><span class="op" id="3864195">(</span><span class="ident" id="3864196">data</span><span class="op" id="3864200">)</span><span class="op" id="3864201">-</span><span class="num" id="3864202">1</span><span class="op" id="3864203">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864209">return</span>&nbsp;<span class="ident" id="3864216">data</span><br>
<span class="lineno"></span><span class="op" id="3864221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864224">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3864297">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3864373">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3864450">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3864526">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3864597">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3864609">func</span>&nbsp;<span class="ident" id="3864614">ScanLines</span><span class="op" id="3864623">(</span><span class="ident" id="3864624">data</span>&nbsp;<span class="op" id="3864629">[</span><span class="op" id="3864630">]</span><span class="builtintype" id="3864631">byte</span><span class="op" id="3864635">,</span>&nbsp;<span class="ident" id="3864637">atEOF</span>&nbsp;<span class="builtintype" id="3864643">bool</span><span class="op" id="3864647">)</span>&nbsp;<span class="op" id="3864649">(</span><span class="ident" id="3864650">advance</span>&nbsp;<span class="builtintype" id="3864658">int</span><span class="op" id="3864661">,</span>&nbsp;<span class="ident" id="3864663">token</span>&nbsp;<span class="op" id="3864669">[</span><span class="op" id="3864670">]</span><span class="builtintype" id="3864671">byte</span><span class="op" id="3864675">,</span>&nbsp;<span class="ident" id="3864677">err</span>&nbsp;<span class="builtintype" id="3864681">error</span><span class="op" id="3864686">)</span>&nbsp;<span class="op" id="3864688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864691">if</span>&nbsp;<span class="ident" id="3864694">atEOF</span>&nbsp;<span class="op" id="3864700">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3864703">len</span><span class="op" id="3864706">(</span><span class="ident" id="3864707">data</span><span class="op" id="3864711">)</span>&nbsp;<span class="op" id="3864713">==</span>&nbsp;<span class="num" id="3864716">0</span>&nbsp;<span class="op" id="3864718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864722">return</span>&nbsp;<span class="num" id="3864729">0</span><span class="op" id="3864730">,</span>&nbsp;<span class="ident" id="3864732">nil</span><span class="op" id="3864735">,</span>&nbsp;<span class="ident" id="3864737">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864745">if</span>&nbsp;<span class="ident" id="3864748">i</span>&nbsp;<span class="op" id="3864750">:=</span>&nbsp;<span class="ident" id="3864753">bytes</span><span class="op" id="3864758">.</span><span class="ident" id="3864759">IndexByte</span><span class="op" id="3864768">(</span><span class="ident" id="3864769">data</span><span class="op" id="3864773">,</span>&nbsp;<span class="string" id="3864775">&#39;\n&#39;</span><span class="op" id="3864779">)</span><span class="op" id="3864780">;</span>&nbsp;<span class="ident" id="3864782">i</span>&nbsp;<span class="op" id="3864784">&gt;=</span>&nbsp;<span class="num" id="3864787">0</span>&nbsp;<span class="op" id="3864789">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864793">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864838">return</span>&nbsp;<span class="ident" id="3864845">i</span>&nbsp;<span class="op" id="3864847">+</span>&nbsp;<span class="num" id="3864849">1</span><span class="op" id="3864850">,</span>&nbsp;<span class="ident" id="3864852">dropCR</span><span class="op" id="3864858">(</span><span class="ident" id="3864859">data</span><span class="op" id="3864863">[</span><span class="num" id="3864864">0</span><span class="op" id="3864865">:</span><span class="ident" id="3864866">i</span><span class="op" id="3864867">]</span><span class="op" id="3864868">)</span><span class="op" id="3864869">,</span>&nbsp;<span class="ident" id="3864871">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864879">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864949">if</span>&nbsp;<span class="ident" id="3864952">atEOF</span>&nbsp;<span class="op" id="3864958">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864962">return</span>&nbsp;<span class="builtinfunc" id="3864969">len</span><span class="op" id="3864972">(</span><span class="ident" id="3864973">data</span><span class="op" id="3864977">)</span><span class="op" id="3864978">,</span>&nbsp;<span class="ident" id="3864980">dropCR</span><span class="op" id="3864986">(</span><span class="ident" id="3864987">data</span><span class="op" id="3864991">)</span><span class="op" id="3864992">,</span>&nbsp;<span class="ident" id="3864994">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865002">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865025">return</span>&nbsp;<span class="num" id="3865032">0</span><span class="op" id="3865033">,</span>&nbsp;<span class="ident" id="3865035">nil</span><span class="op" id="3865038">,</span>&nbsp;<span class="ident" id="3865040">nil</span><br>
<span class="lineno"></span><span class="op" id="3865044">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3865047">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3865124">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3865212">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3865229">func</span>&nbsp;<span class="ident" id="3865234">isSpace</span><span class="op" id="3865241">(</span><span class="ident" id="3865242">r</span>&nbsp;<span class="builtintype" id="3865244">rune</span><span class="op" id="3865248">)</span>&nbsp;<span class="builtintype" id="3865250">bool</span>&nbsp;<span class="op" id="3865255">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865258">if</span>&nbsp;<span class="ident" id="3865261">r</span>&nbsp;<span class="op" id="3865263">&lt;=</span>&nbsp;<span class="string" id="3865266">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3865275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865279">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865357">switch</span>&nbsp;<span class="ident" id="3865364">r</span>&nbsp;<span class="op" id="3865366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865370">case</span>&nbsp;<span class="string" id="3865375">&#39;&nbsp;&#39;</span><span class="op" id="3865378">,</span>&nbsp;<span class="string" id="3865380">&#39;\t&#39;</span><span class="op" id="3865384">,</span>&nbsp;<span class="string" id="3865386">&#39;\n&#39;</span><span class="op" id="3865390">,</span>&nbsp;<span class="string" id="3865392">&#39;\v&#39;</span><span class="op" id="3865396">,</span>&nbsp;<span class="string" id="3865398">&#39;\f&#39;</span><span class="op" id="3865402">,</span>&nbsp;<span class="string" id="3865404">&#39;\r&#39;</span><span class="op" id="3865408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865413">return</span>&nbsp;<span class="builtintype" id="3865420">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865427">case</span>&nbsp;<span class="string" id="3865432">&#39;\u0085&#39;</span><span class="op" id="3865440">,</span>&nbsp;<span class="string" id="3865442">&#39;\u00A0&#39;</span><span class="op" id="3865450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865455">return</span>&nbsp;<span class="builtintype" id="3865462">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865473">return</span>&nbsp;<span class="builtintype" id="3865480">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865487">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865490">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865512">if</span>&nbsp;<span class="string" id="3865515">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3865524">&lt;=</span>&nbsp;<span class="ident" id="3865527">r</span>&nbsp;<span class="op" id="3865529">&amp;&amp;</span>&nbsp;<span class="ident" id="3865532">r</span>&nbsp;<span class="op" id="3865534">&lt;=</span>&nbsp;<span class="string" id="3865537">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3865546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865550">return</span>&nbsp;<span class="builtintype" id="3865557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865566">switch</span>&nbsp;<span class="ident" id="3865573">r</span>&nbsp;<span class="op" id="3865575">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865578">case</span>&nbsp;<span class="string" id="3865583">&#39;\u1680&#39;</span><span class="op" id="3865591">,</span>&nbsp;<span class="string" id="3865593">&#39;\u2028&#39;</span><span class="op" id="3865601">,</span>&nbsp;<span class="string" id="3865603">&#39;\u2029&#39;</span><span class="op" id="3865611">,</span>&nbsp;<span class="string" id="3865613">&#39;\u202f&#39;</span><span class="op" id="3865621">,</span>&nbsp;<span class="string" id="3865623">&#39;\u205f&#39;</span><span class="op" id="3865631">,</span>&nbsp;<span class="string" id="3865633">&#39;\u3000&#39;</span><span class="op" id="3865641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865645">return</span>&nbsp;<span class="builtintype" id="3865652">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865661">return</span>&nbsp;<span class="builtintype" id="3865668">false</span><br>
<span class="lineno"></span><span class="op" id="3865674">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3865677">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3865742">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3865816">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3865883">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3865903">func</span>&nbsp;<span class="ident" id="3865908">ScanWords</span><span class="op" id="3865917">(</span><span class="ident" id="3865918">data</span>&nbsp;<span class="op" id="3865923">[</span><span class="op" id="3865924">]</span><span class="builtintype" id="3865925">byte</span><span class="op" id="3865929">,</span>&nbsp;<span class="ident" id="3865931">atEOF</span>&nbsp;<span class="builtintype" id="3865937">bool</span><span class="op" id="3865941">)</span>&nbsp;<span class="op" id="3865943">(</span><span class="ident" id="3865944">advance</span>&nbsp;<span class="builtintype" id="3865952">int</span><span class="op" id="3865955">,</span>&nbsp;<span class="ident" id="3865957">token</span>&nbsp;<span class="op" id="3865963">[</span><span class="op" id="3865964">]</span><span class="builtintype" id="3865965">byte</span><span class="op" id="3865969">,</span>&nbsp;<span class="ident" id="3865971">err</span>&nbsp;<span class="builtintype" id="3865975">error</span><span class="op" id="3865980">)</span>&nbsp;<span class="op" id="3865982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865985">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866010">start</span>&nbsp;<span class="op" id="3866016">:=</span>&nbsp;<span class="num" id="3866019">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866022">for</span>&nbsp;<span class="ident" id="3866026">width</span>&nbsp;<span class="op" id="3866032">:=</span>&nbsp;<span class="num" id="3866035">0</span><span class="op" id="3866036">;</span>&nbsp;<span class="ident" id="3866038">start</span>&nbsp;<span class="op" id="3866044">&lt;</span>&nbsp;<span class="builtinfunc" id="3866046">len</span><span class="op" id="3866049">(</span><span class="ident" id="3866050">data</span><span class="op" id="3866054">)</span><span class="op" id="3866055">;</span>&nbsp;<span class="ident" id="3866057">start</span>&nbsp;<span class="op" id="3866063">+=</span>&nbsp;<span class="ident" id="3866066">width</span>&nbsp;<span class="op" id="3866072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866076">var</span>&nbsp;<span class="ident" id="3866080">r</span>&nbsp;<span class="builtintype" id="3866082">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866089">r</span><span class="op" id="3866090">,</span>&nbsp;<span class="ident" id="3866092">width</span>&nbsp;<span class="op" id="3866098">=</span>&nbsp;<span class="ident" id="3866100">utf8</span><span class="op" id="3866104">.</span><span class="ident" id="3866105">DecodeRune</span><span class="op" id="3866115">(</span><span class="ident" id="3866116">data</span><span class="op" id="3866120">[</span><span class="ident" id="3866121">start</span><span class="op" id="3866126">:</span><span class="op" id="3866127">]</span><span class="op" id="3866128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866132">if</span>&nbsp;<span class="op" id="3866135">!</span><span class="ident" id="3866136">isSpace</span><span class="op" id="3866143">(</span><span class="ident" id="3866144">r</span><span class="op" id="3866145">)</span>&nbsp;<span class="op" id="3866147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866152">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866163">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3866166">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866209">for</span>&nbsp;<span class="ident" id="3866213">width</span><span class="op" id="3866218">,</span>&nbsp;<span class="ident" id="3866220">i</span>&nbsp;<span class="op" id="3866222">:=</span>&nbsp;<span class="num" id="3866225">0</span><span class="op" id="3866226">,</span>&nbsp;<span class="ident" id="3866228">start</span><span class="op" id="3866233">;</span>&nbsp;<span class="ident" id="3866235">i</span>&nbsp;<span class="op" id="3866237">&lt;</span>&nbsp;<span class="builtinfunc" id="3866239">len</span><span class="op" id="3866242">(</span><span class="ident" id="3866243">data</span><span class="op" id="3866247">)</span><span class="op" id="3866248">;</span>&nbsp;<span class="ident" id="3866250">i</span>&nbsp;<span class="op" id="3866252">+=</span>&nbsp;<span class="ident" id="3866255">width</span>&nbsp;<span class="op" id="3866261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866265">var</span>&nbsp;<span class="ident" id="3866269">r</span>&nbsp;<span class="builtintype" id="3866271">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866278">r</span><span class="op" id="3866279">,</span>&nbsp;<span class="ident" id="3866281">width</span>&nbsp;<span class="op" id="3866287">=</span>&nbsp;<span class="ident" id="3866289">utf8</span><span class="op" id="3866293">.</span><span class="ident" id="3866294">DecodeRune</span><span class="op" id="3866304">(</span><span class="ident" id="3866305">data</span><span class="op" id="3866309">[</span><span class="ident" id="3866310">i</span><span class="op" id="3866311">:</span><span class="op" id="3866312">]</span><span class="op" id="3866313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866317">if</span>&nbsp;<span class="ident" id="3866320">isSpace</span><span class="op" id="3866327">(</span><span class="ident" id="3866328">r</span><span class="op" id="3866329">)</span>&nbsp;<span class="op" id="3866331">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866336">return</span>&nbsp;<span class="ident" id="3866343">i</span>&nbsp;<span class="op" id="3866345">+</span>&nbsp;<span class="ident" id="3866347">width</span><span class="op" id="3866352">,</span>&nbsp;<span class="ident" id="3866354">data</span><span class="op" id="3866358">[</span><span class="ident" id="3866359">start</span><span class="op" id="3866364">:</span><span class="ident" id="3866365">i</span><span class="op" id="3866366">]</span><span class="op" id="3866367">,</span>&nbsp;<span class="ident" id="3866369">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3866381">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866462">if</span>&nbsp;<span class="ident" id="3866465">atEOF</span>&nbsp;<span class="op" id="3866471">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3866474">len</span><span class="op" id="3866477">(</span><span class="ident" id="3866478">data</span><span class="op" id="3866482">)</span>&nbsp;<span class="op" id="3866484">&gt;</span>&nbsp;<span class="ident" id="3866486">start</span>&nbsp;<span class="op" id="3866492">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866496">return</span>&nbsp;<span class="builtinfunc" id="3866503">len</span><span class="op" id="3866506">(</span><span class="ident" id="3866507">data</span><span class="op" id="3866511">)</span><span class="op" id="3866512">,</span>&nbsp;<span class="ident" id="3866514">data</span><span class="op" id="3866518">[</span><span class="ident" id="3866519">start</span><span class="op" id="3866524">:</span><span class="op" id="3866525">]</span><span class="op" id="3866526">,</span>&nbsp;<span class="ident" id="3866528">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3866536">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866559">return</span>&nbsp;<span class="ident" id="3866566">start</span><span class="op" id="3866571">,</span>&nbsp;<span class="ident" id="3866573">nil</span><span class="op" id="3866576">,</span>&nbsp;<span class="ident" id="3866578">nil</span><br>
<span class="lineno"></span><span class="op" id="3866582">}</span>
</div>
</body>
</html>
