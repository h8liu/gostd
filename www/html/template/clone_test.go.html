<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8417179">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8417234">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8417288">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8417339">package</span>&nbsp;<span class="ident" id="8417347">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8417357">import</span>&nbsp;<span class="op" id="8417364">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8417367">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8417376">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8417386">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8417399">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8417410">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="8417432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8417435">func</span>&nbsp;<span class="ident" id="8417440">TestAddParseTree</span><span class="op" id="8417456">(</span><span class="ident" id="8417457">t</span>&nbsp;<span class="op" id="8417459">*</span><span class="ident" id="8417460"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8417467">.</span><span class="ident" id="8417468">T</span><span class="op" id="8417469">)</span>&nbsp;<span class="op" id="8417471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417474">root</span>&nbsp;<span class="op" id="8417479">:=</span>&nbsp;<span class="ident" id="8417482"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8417486">(</span><span class="ident" id="8417487"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8417490">(</span><span class="string" id="8417491">&#34;root&#34;</span><span class="op" id="8417497">)</span><span class="op" id="8417498">.</span><span class="ident" id="8417499">Parse</span><span class="op" id="8417504">(</span><span class="string" id="8417505">`{{define&nbsp;&#34;a&#34;}}&nbsp;{{.}}&nbsp;{{template&nbsp;&#34;b&#34;}}&nbsp;{{.}}&nbsp;&#34;&gt;&lt;/a&gt;{{end}}`</span><span class="op" id="8417564">)</span><span class="op" id="8417565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417568">tree</span><span class="op" id="8417572">,</span>&nbsp;<span class="ident" id="8417574">err</span>&nbsp;<span class="op" id="8417578">:=</span>&nbsp;<span class="ident" id="8417581"><a href="/html/template/clone_test.go.html#8417410">parse</a></span><span class="op" id="8417586">.</span><span class="ident" id="8417587">Parse</span><span class="op" id="8417592">(</span><span class="string" id="8417593">&#34;t&#34;</span><span class="op" id="8417596">,</span>&nbsp;<span class="string" id="8417598">`{{define&nbsp;&#34;b&#34;}}&lt;a&nbsp;href=&#34;{{end}}`</span><span class="op" id="8417630">,</span>&nbsp;<span class="string" id="8417632">&#34;&#34;</span><span class="op" id="8417634">,</span>&nbsp;<span class="string" id="8417636">&#34;&#34;</span><span class="op" id="8417638">,</span>&nbsp;<span class="ident" id="8417640">nil</span><span class="op" id="8417643">,</span>&nbsp;<span class="ident" id="8417645">nil</span><span class="op" id="8417648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417651">if</span>&nbsp;<span class="ident" id="8417654"><a href="/html/template/clone_test.go.html#8417574">err</a></span>&nbsp;<span class="op" id="8417658">!=</span>&nbsp;<span class="ident" id="8417661">nil</span>&nbsp;<span class="op" id="8417665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417669"><a href="/html/template/clone_test.go.html#8417457">t</a></span><span class="op" id="8417670">.</span><span class="ident" id="8417671">Fatal</span><span class="op" id="8417676">(</span><span class="ident" id="8417677"><a href="/html/template/clone_test.go.html#8417574">err</a></span><span class="op" id="8417680">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417686">added</span>&nbsp;<span class="op" id="8417692">:=</span>&nbsp;<span class="ident" id="8417695"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8417699">(</span><span class="ident" id="8417700"><a href="/html/template/clone_test.go.html#8417474">root</a></span><span class="op" id="8417704">.</span><span class="ident" id="8417705">AddParseTree</span><span class="op" id="8417717">(</span><span class="string" id="8417718">&#34;b&#34;</span><span class="op" id="8417721">,</span>&nbsp;<span class="ident" id="8417723"><a href="/html/template/clone_test.go.html#8417568">tree</a></span><span class="op" id="8417727">[</span><span class="string" id="8417728">&#34;b&#34;</span><span class="op" id="8417731">]</span><span class="op" id="8417732">)</span><span class="op" id="8417733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417736">b</span>&nbsp;<span class="op" id="8417738">:=</span>&nbsp;<span class="builtinfunc" id="8417741">new</span><span class="op" id="8417744">(</span><span class="ident" id="8417745"><a href="/html/template/clone_test.go.html#8417367">bytes</a></span><span class="op" id="8417750">.</span><span class="ident" id="8417751">Buffer</span><span class="op" id="8417757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417760"><a href="/html/template/clone_test.go.html#8417574">err</a></span>&nbsp;<span class="op" id="8417764">=</span>&nbsp;<span class="ident" id="8417766"><a href="/html/template/clone_test.go.html#8417686">added</a></span><span class="op" id="8417771">.</span><span class="ident" id="8417772">ExecuteTemplate</span><span class="op" id="8417787">(</span><span class="ident" id="8417788"><a href="/html/template/clone_test.go.html#8417736">b</a></span><span class="op" id="8417789">,</span>&nbsp;<span class="string" id="8417791">&#34;a&#34;</span><span class="op" id="8417794">,</span>&nbsp;<span class="string" id="8417796">&#34;1&gt;0&#34;</span><span class="op" id="8417801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417804">if</span>&nbsp;<span class="ident" id="8417807"><a href="/html/template/clone_test.go.html#8417574">err</a></span>&nbsp;<span class="op" id="8417811">!=</span>&nbsp;<span class="ident" id="8417814">nil</span>&nbsp;<span class="op" id="8417818">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417822"><a href="/html/template/clone_test.go.html#8417457">t</a></span><span class="op" id="8417823">.</span><span class="ident" id="8417824">Fatal</span><span class="op" id="8417829">(</span><span class="ident" id="8417830"><a href="/html/template/clone_test.go.html#8417574">err</a></span><span class="op" id="8417833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8417839">if</span>&nbsp;<span class="ident" id="8417842">got</span><span class="op" id="8417845">,</span>&nbsp;<span class="ident" id="8417847">want</span>&nbsp;<span class="op" id="8417852">:=</span>&nbsp;<span class="ident" id="8417855"><a href="/html/template/clone_test.go.html#8417736">b</a></span><span class="op" id="8417856">.</span><span class="ident" id="8417857">String</span><span class="op" id="8417863">(</span><span class="op" id="8417864">)</span><span class="op" id="8417865">,</span>&nbsp;<span class="string" id="8417867">`&nbsp;1&amp;gt;0&nbsp;&lt;a&nbsp;href=&#34;&nbsp;1%3e0&nbsp;&#34;&gt;&lt;/a&gt;`</span><span class="op" id="8417899">;</span>&nbsp;<span class="ident" id="8417901"><a href="/html/template/clone_test.go.html#8417842">got</a></span>&nbsp;<span class="op" id="8417905">!=</span>&nbsp;<span class="ident" id="8417908"><a href="/html/template/clone_test.go.html#8417847">want</a></span>&nbsp;<span class="op" id="8417913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8417917"><a href="/html/template/clone_test.go.html#8417457">t</a></span><span class="op" id="8417918">.</span><span class="ident" id="8417919">Errorf</span><span class="op" id="8417925">(</span><span class="string" id="8417926">&#34;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8417942">,</span>&nbsp;<span class="ident" id="8417944"><a href="/html/template/clone_test.go.html#8417842">got</a></span><span class="op" id="8417947">,</span>&nbsp;<span class="ident" id="8417949"><a href="/html/template/clone_test.go.html#8417847">want</a></span><span class="op" id="8417953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8417956">}</span><br>
<span class="lineno">30</span><span class="op" id="8417958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8417961">func</span>&nbsp;<span class="ident" id="8417966">TestClone</span><span class="op" id="8417975">(</span><span class="ident" id="8417976">t</span>&nbsp;<span class="op" id="8417978">*</span><span class="ident" id="8417979"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8417986">.</span><span class="ident" id="8417987">T</span><span class="op" id="8417988">)</span>&nbsp;<span class="op" id="8417990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8417993">//&nbsp;The&nbsp;{{.}}&nbsp;will&nbsp;be&nbsp;executed&nbsp;with&nbsp;data&nbsp;&#34;&lt;i&gt;*/&#34;&nbsp;in&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418065">//&nbsp;In&nbsp;the&nbsp;t0&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;text&nbsp;context.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418119">//&nbsp;In&nbsp;the&nbsp;t1&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;URL&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418172">//&nbsp;In&nbsp;the&nbsp;t2&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;JavaScript&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418232">//&nbsp;In&nbsp;the&nbsp;t3&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;CSS&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418285">const</span>&nbsp;<span class="ident" id="8418291">tmpl</span>&nbsp;<span class="op" id="8418296">=</span>&nbsp;<span class="string" id="8418298">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418364">b</span>&nbsp;<span class="op" id="8418366">:=</span>&nbsp;<span class="builtinfunc" id="8418369">new</span><span class="op" id="8418372">(</span><span class="ident" id="8418373"><a href="/html/template/clone_test.go.html#8417367">bytes</a></span><span class="op" id="8418378">.</span><span class="ident" id="8418379">Buffer</span><span class="op" id="8418385">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418389">//&nbsp;Create&nbsp;an&nbsp;incomplete&nbsp;template&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418427">t0</span>&nbsp;<span class="op" id="8418430">:=</span>&nbsp;<span class="ident" id="8418433"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418437">(</span><span class="ident" id="8418438"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8418441">(</span><span class="string" id="8418442">&#34;t0&#34;</span><span class="op" id="8418446">)</span><span class="op" id="8418447">.</span><span class="ident" id="8418448">Parse</span><span class="op" id="8418453">(</span><span class="ident" id="8418454"><a href="/html/template/clone_test.go.html#8418291">tmpl</a></span><span class="op" id="8418458">)</span><span class="op" id="8418459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418463">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t1.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418483">t1</span>&nbsp;<span class="op" id="8418486">:=</span>&nbsp;<span class="ident" id="8418489"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418493">(</span><span class="ident" id="8418494"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8418496">.</span><span class="ident" id="8418497">Clone</span><span class="op" id="8418502">(</span><span class="op" id="8418503">)</span><span class="op" id="8418504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418507"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418511">(</span><span class="ident" id="8418512"><a href="/html/template/clone_test.go.html#8418483">t1</a></span><span class="op" id="8418514">.</span><span class="ident" id="8418515">Parse</span><span class="op" id="8418520">(</span><span class="string" id="8418521">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}`</span><span class="op" id="8418557">)</span><span class="op" id="8418558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418561"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418565">(</span><span class="ident" id="8418566"><a href="/html/template/clone_test.go.html#8418483">t1</a></span><span class="op" id="8418568">.</span><span class="ident" id="8418569">Parse</span><span class="op" id="8418574">(</span><span class="string" id="8418575">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><span class="op" id="8418608">)</span><span class="op" id="8418609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418613">//&nbsp;Execute&nbsp;t1.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418629"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8418630">.</span><span class="ident" id="8418631">Reset</span><span class="op" id="8418636">(</span><span class="op" id="8418637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418640">if</span>&nbsp;<span class="ident" id="8418643">err</span>&nbsp;<span class="op" id="8418647">:=</span>&nbsp;<span class="ident" id="8418650"><a href="/html/template/clone_test.go.html#8418483">t1</a></span><span class="op" id="8418652">.</span><span class="ident" id="8418653">ExecuteTemplate</span><span class="op" id="8418668">(</span><span class="ident" id="8418669"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8418670">,</span>&nbsp;<span class="string" id="8418672">&#34;a&#34;</span><span class="op" id="8418675">,</span>&nbsp;<span class="string" id="8418677">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8418684">)</span><span class="op" id="8418685">;</span>&nbsp;<span class="ident" id="8418687"><a href="/html/template/clone_test.go.html#8418643">err</a></span>&nbsp;<span class="op" id="8418691">!=</span>&nbsp;<span class="ident" id="8418694">nil</span>&nbsp;<span class="op" id="8418698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418702"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8418703">.</span><span class="ident" id="8418704">Fatal</span><span class="op" id="8418709">(</span><span class="ident" id="8418710"><a href="/html/template/clone_test.go.html#8418643">err</a></span><span class="op" id="8418713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8418719">if</span>&nbsp;<span class="ident" id="8418722">got</span><span class="op" id="8418725">,</span>&nbsp;<span class="ident" id="8418727">want</span>&nbsp;<span class="op" id="8418732">:=</span>&nbsp;<span class="ident" id="8418735"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8418736">.</span><span class="ident" id="8418737">String</span><span class="op" id="8418743">(</span><span class="op" id="8418744">)</span><span class="op" id="8418745">,</span>&nbsp;<span class="string" id="8418747">`&nbsp;&lt;a&nbsp;href=&#34;&nbsp;%3ci%3e*/&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;`</span><span class="op" id="8418777">;</span>&nbsp;<span class="ident" id="8418779"><a href="/html/template/clone_test.go.html#8418722">got</a></span>&nbsp;<span class="op" id="8418783">!=</span>&nbsp;<span class="ident" id="8418786"><a href="/html/template/clone_test.go.html#8418727">want</a></span>&nbsp;<span class="op" id="8418791">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418795"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8418796">.</span><span class="ident" id="8418797">Errorf</span><span class="op" id="8418803">(</span><span class="string" id="8418804">&#34;t1:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8418824">,</span>&nbsp;<span class="ident" id="8418826"><a href="/html/template/clone_test.go.html#8418722">got</a></span><span class="op" id="8418829">,</span>&nbsp;<span class="ident" id="8418831"><a href="/html/template/clone_test.go.html#8418727">want</a></span><span class="op" id="8418835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8418838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8418842">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418862">t2</span>&nbsp;<span class="op" id="8418865">:=</span>&nbsp;<span class="ident" id="8418868"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418872">(</span><span class="ident" id="8418873"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8418875">.</span><span class="ident" id="8418876">Clone</span><span class="op" id="8418881">(</span><span class="op" id="8418882">)</span><span class="op" id="8418883">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418886"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418890">(</span><span class="ident" id="8418891"><a href="/html/template/clone_test.go.html#8418862">t2</a></span><span class="op" id="8418893">.</span><span class="ident" id="8418894">Parse</span><span class="op" id="8418899">(</span><span class="string" id="8418900">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;{{end}}`</span><span class="op" id="8418950">)</span><span class="op" id="8418951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8418954"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8418958">(</span><span class="ident" id="8418959"><a href="/html/template/clone_test.go.html#8418862">t2</a></span><span class="op" id="8418961">.</span><span class="ident" id="8418962">Parse</span><span class="op" id="8418967">(</span><span class="string" id="8418968">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;{{end}}`</span><span class="op" id="8419001">)</span><span class="op" id="8419002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419006">//&nbsp;Execute&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419022"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419023">.</span><span class="ident" id="8419024">Reset</span><span class="op" id="8419029">(</span><span class="op" id="8419030">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419033">if</span>&nbsp;<span class="ident" id="8419036">err</span>&nbsp;<span class="op" id="8419040">:=</span>&nbsp;<span class="ident" id="8419043"><a href="/html/template/clone_test.go.html#8418862">t2</a></span><span class="op" id="8419045">.</span><span class="ident" id="8419046">ExecuteTemplate</span><span class="op" id="8419061">(</span><span class="ident" id="8419062"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419063">,</span>&nbsp;<span class="string" id="8419065">&#34;a&#34;</span><span class="op" id="8419068">,</span>&nbsp;<span class="string" id="8419070">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8419077">)</span><span class="op" id="8419078">;</span>&nbsp;<span class="ident" id="8419080"><a href="/html/template/clone_test.go.html#8419036">err</a></span>&nbsp;<span class="op" id="8419084">!=</span>&nbsp;<span class="ident" id="8419087">nil</span>&nbsp;<span class="op" id="8419091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419095"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8419096">.</span><span class="ident" id="8419097">Fatal</span><span class="op" id="8419102">(</span><span class="ident" id="8419103"><a href="/html/template/clone_test.go.html#8419036">err</a></span><span class="op" id="8419106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419112">if</span>&nbsp;<span class="ident" id="8419115">got</span><span class="op" id="8419118">,</span>&nbsp;<span class="ident" id="8419120">want</span>&nbsp;<span class="op" id="8419125">:=</span>&nbsp;<span class="ident" id="8419128"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419129">.</span><span class="ident" id="8419130">String</span><span class="op" id="8419136">(</span><span class="op" id="8419137">)</span><span class="op" id="8419138">,</span>&nbsp;<span class="string" id="8419140">`&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;&amp;#34;\u003ci\u003e*/&amp;#34;&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;`</span><span class="op" id="8419200">;</span>&nbsp;<span class="ident" id="8419202"><a href="/html/template/clone_test.go.html#8419115">got</a></span>&nbsp;<span class="op" id="8419206">!=</span>&nbsp;<span class="ident" id="8419209"><a href="/html/template/clone_test.go.html#8419120">want</a></span>&nbsp;<span class="op" id="8419214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419218"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8419219">.</span><span class="ident" id="8419220">Errorf</span><span class="op" id="8419226">(</span><span class="string" id="8419227">&#34;t2:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8419247">,</span>&nbsp;<span class="ident" id="8419249"><a href="/html/template/clone_test.go.html#8419115">got</a></span><span class="op" id="8419252">,</span>&nbsp;<span class="ident" id="8419254"><a href="/html/template/clone_test.go.html#8419120">want</a></span><span class="op" id="8419258">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419265">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t3,&nbsp;but&nbsp;do&nbsp;not&nbsp;execute&nbsp;t3&nbsp;yet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419312">t3</span>&nbsp;<span class="op" id="8419315">:=</span>&nbsp;<span class="ident" id="8419318"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419322">(</span><span class="ident" id="8419323"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8419325">.</span><span class="ident" id="8419326">Clone</span><span class="op" id="8419331">(</span><span class="op" id="8419332">)</span><span class="op" id="8419333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419336"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419340">(</span><span class="ident" id="8419341"><a href="/html/template/clone_test.go.html#8419312">t3</a></span><span class="op" id="8419343">.</span><span class="ident" id="8419344">Parse</span><span class="op" id="8419349">(</span><span class="string" id="8419350">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;style&gt;&nbsp;{{end}}`</span><span class="op" id="8419384">)</span><span class="op" id="8419385">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419388"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419392">(</span><span class="ident" id="8419393"><a href="/html/template/clone_test.go.html#8419312">t3</a></span><span class="op" id="8419395">.</span><span class="ident" id="8419396">Parse</span><span class="op" id="8419401">(</span><span class="string" id="8419402">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&lt;/style&gt;&nbsp;{{end}}`</span><span class="op" id="8419437">)</span><span class="op" id="8419438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419442">//&nbsp;Complete&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419459"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419463">(</span><span class="ident" id="8419464"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8419466">.</span><span class="ident" id="8419467">Parse</span><span class="op" id="8419472">(</span><span class="string" id="8419473">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;(&nbsp;{{end}}`</span><span class="op" id="8419501">)</span><span class="op" id="8419502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419505"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419509">(</span><span class="ident" id="8419510"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8419512">.</span><span class="ident" id="8419513">Parse</span><span class="op" id="8419518">(</span><span class="string" id="8419519">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;)&nbsp;{{end}}`</span><span class="op" id="8419547">)</span><span class="op" id="8419548">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419552">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t4.&nbsp;Redefining&nbsp;the&nbsp;&#34;lhs&#34;&nbsp;template&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419615">t4</span>&nbsp;<span class="op" id="8419618">:=</span>&nbsp;<span class="ident" id="8419621"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8419625">(</span><span class="ident" id="8419626"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8419628">.</span><span class="ident" id="8419629">Clone</span><span class="op" id="8419634">(</span><span class="op" id="8419635">)</span><span class="op" id="8419636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419639">if</span>&nbsp;<span class="ident" id="8419642">_</span><span class="op" id="8419643">,</span>&nbsp;<span class="ident" id="8419645">err</span>&nbsp;<span class="op" id="8419649">:=</span>&nbsp;<span class="ident" id="8419652"><a href="/html/template/clone_test.go.html#8419615">t4</a></span><span class="op" id="8419654">.</span><span class="ident" id="8419655">Parse</span><span class="op" id="8419660">(</span><span class="string" id="8419661">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;FAIL&nbsp;{{end}}`</span><span class="op" id="8419692">)</span><span class="op" id="8419693">;</span>&nbsp;<span class="ident" id="8419695"><a href="/html/template/clone_test.go.html#8419645">err</a></span>&nbsp;<span class="op" id="8419699">==</span>&nbsp;<span class="ident" id="8419702">nil</span>&nbsp;<span class="op" id="8419706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419710"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8419711">.</span><span class="ident" id="8419712">Error</span><span class="op" id="8419717">(</span><span class="string" id="8419718">`redefine&nbsp;&#34;lhs&#34;:&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8419760">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419767">//&nbsp;Execute&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419783"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419784">.</span><span class="ident" id="8419785">Reset</span><span class="op" id="8419790">(</span><span class="op" id="8419791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419794">if</span>&nbsp;<span class="ident" id="8419797">err</span>&nbsp;<span class="op" id="8419801">:=</span>&nbsp;<span class="ident" id="8419804"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8419806">.</span><span class="ident" id="8419807">ExecuteTemplate</span><span class="op" id="8419822">(</span><span class="ident" id="8419823"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419824">,</span>&nbsp;<span class="string" id="8419826">&#34;a&#34;</span><span class="op" id="8419829">,</span>&nbsp;<span class="string" id="8419831">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8419838">)</span><span class="op" id="8419839">;</span>&nbsp;<span class="ident" id="8419841"><a href="/html/template/clone_test.go.html#8419797">err</a></span>&nbsp;<span class="op" id="8419845">!=</span>&nbsp;<span class="ident" id="8419848">nil</span>&nbsp;<span class="op" id="8419852">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419856"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8419857">.</span><span class="ident" id="8419858">Fatal</span><span class="op" id="8419863">(</span><span class="ident" id="8419864"><a href="/html/template/clone_test.go.html#8419797">err</a></span><span class="op" id="8419867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8419873">if</span>&nbsp;<span class="ident" id="8419876">got</span><span class="op" id="8419879">,</span>&nbsp;<span class="ident" id="8419881">want</span>&nbsp;<span class="op" id="8419886">:=</span>&nbsp;<span class="ident" id="8419889"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8419890">.</span><span class="ident" id="8419891">String</span><span class="op" id="8419897">(</span><span class="op" id="8419898">)</span><span class="op" id="8419899">,</span>&nbsp;<span class="string" id="8419901">`&nbsp;(&nbsp;&amp;lt;i&amp;gt;*/&nbsp;)&nbsp;`</span><span class="op" id="8419920">;</span>&nbsp;<span class="ident" id="8419922"><a href="/html/template/clone_test.go.html#8419876">got</a></span>&nbsp;<span class="op" id="8419926">!=</span>&nbsp;<span class="ident" id="8419929"><a href="/html/template/clone_test.go.html#8419881">want</a></span>&nbsp;<span class="op" id="8419934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419938"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8419939">.</span><span class="ident" id="8419940">Errorf</span><span class="op" id="8419946">(</span><span class="string" id="8419947">&#34;t0:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8419967">,</span>&nbsp;<span class="ident" id="8419969"><a href="/html/template/clone_test.go.html#8419876">got</a></span><span class="op" id="8419972">,</span>&nbsp;<span class="ident" id="8419974"><a href="/html/template/clone_test.go.html#8419881">want</a></span><span class="op" id="8419978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419981">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8419985">//&nbsp;Clone&nbsp;t0.&nbsp;This&nbsp;should&nbsp;fail,&nbsp;as&nbsp;t0&nbsp;has&nbsp;already&nbsp;executed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420045">if</span>&nbsp;<span class="ident" id="8420048">_</span><span class="op" id="8420049">,</span>&nbsp;<span class="ident" id="8420051">err</span>&nbsp;<span class="op" id="8420055">:=</span>&nbsp;<span class="ident" id="8420058"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8420060">.</span><span class="ident" id="8420061">Clone</span><span class="op" id="8420066">(</span><span class="op" id="8420067">)</span><span class="op" id="8420068">;</span>&nbsp;<span class="ident" id="8420070"><a href="/html/template/clone_test.go.html#8420051">err</a></span>&nbsp;<span class="op" id="8420074">==</span>&nbsp;<span class="ident" id="8420077">nil</span>&nbsp;<span class="op" id="8420081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420085"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8420086">.</span><span class="ident" id="8420087">Error</span><span class="op" id="8420092">(</span><span class="string" id="8420093">`t0.Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8420131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420134">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8420138">//&nbsp;Similarly,&nbsp;cloning&nbsp;sub-templates&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420188">if</span>&nbsp;<span class="ident" id="8420191">_</span><span class="op" id="8420192">,</span>&nbsp;<span class="ident" id="8420194">err</span>&nbsp;<span class="op" id="8420198">:=</span>&nbsp;<span class="ident" id="8420201"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8420203">.</span><span class="ident" id="8420204">Lookup</span><span class="op" id="8420210">(</span><span class="string" id="8420211">&#34;a&#34;</span><span class="op" id="8420214">)</span><span class="op" id="8420215">.</span><span class="ident" id="8420216">Clone</span><span class="op" id="8420221">(</span><span class="op" id="8420222">)</span><span class="op" id="8420223">;</span>&nbsp;<span class="ident" id="8420225"><a href="/html/template/clone_test.go.html#8420194">err</a></span>&nbsp;<span class="op" id="8420229">==</span>&nbsp;<span class="ident" id="8420232">nil</span>&nbsp;<span class="op" id="8420236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420240"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8420241">.</span><span class="ident" id="8420242">Error</span><span class="op" id="8420247">(</span><span class="string" id="8420248">`t0.Lookup(&#34;a&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8420298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420301">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420304">if</span>&nbsp;<span class="ident" id="8420307">_</span><span class="op" id="8420308">,</span>&nbsp;<span class="ident" id="8420310">err</span>&nbsp;<span class="op" id="8420314">:=</span>&nbsp;<span class="ident" id="8420317"><a href="/html/template/clone_test.go.html#8418427">t0</a></span><span class="op" id="8420319">.</span><span class="ident" id="8420320">Lookup</span><span class="op" id="8420326">(</span><span class="string" id="8420327">&#34;lhs&#34;</span><span class="op" id="8420332">)</span><span class="op" id="8420333">.</span><span class="ident" id="8420334">Clone</span><span class="op" id="8420339">(</span><span class="op" id="8420340">)</span><span class="op" id="8420341">;</span>&nbsp;<span class="ident" id="8420343"><a href="/html/template/clone_test.go.html#8420310">err</a></span>&nbsp;<span class="op" id="8420347">==</span>&nbsp;<span class="ident" id="8420350">nil</span>&nbsp;<span class="op" id="8420354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420358"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8420359">.</span><span class="ident" id="8420360">Error</span><span class="op" id="8420365">(</span><span class="string" id="8420366">`t0.Lookup(&#34;lhs&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8420418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8420425">//&nbsp;Execute&nbsp;t3.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420441"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8420442">.</span><span class="ident" id="8420443">Reset</span><span class="op" id="8420448">(</span><span class="op" id="8420449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420452">if</span>&nbsp;<span class="ident" id="8420455">err</span>&nbsp;<span class="op" id="8420459">:=</span>&nbsp;<span class="ident" id="8420462"><a href="/html/template/clone_test.go.html#8419312">t3</a></span><span class="op" id="8420464">.</span><span class="ident" id="8420465">ExecuteTemplate</span><span class="op" id="8420480">(</span><span class="ident" id="8420481"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8420482">,</span>&nbsp;<span class="string" id="8420484">&#34;a&#34;</span><span class="op" id="8420487">,</span>&nbsp;<span class="string" id="8420489">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8420496">)</span><span class="op" id="8420497">;</span>&nbsp;<span class="ident" id="8420499"><a href="/html/template/clone_test.go.html#8420455">err</a></span>&nbsp;<span class="op" id="8420503">!=</span>&nbsp;<span class="ident" id="8420506">nil</span>&nbsp;<span class="op" id="8420510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420514"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8420515">.</span><span class="ident" id="8420516">Fatal</span><span class="op" id="8420521">(</span><span class="ident" id="8420522"><a href="/html/template/clone_test.go.html#8420455">err</a></span><span class="op" id="8420525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420531">if</span>&nbsp;<span class="ident" id="8420534">got</span><span class="op" id="8420537">,</span>&nbsp;<span class="ident" id="8420539">want</span>&nbsp;<span class="op" id="8420544">:=</span>&nbsp;<span class="ident" id="8420547"><a href="/html/template/clone_test.go.html#8418364">b</a></span><span class="op" id="8420548">.</span><span class="ident" id="8420549">String</span><span class="op" id="8420555">(</span><span class="op" id="8420556">)</span><span class="op" id="8420557">,</span>&nbsp;<span class="string" id="8420559">`&nbsp;&lt;style&gt;&nbsp;ZgotmplZ&nbsp;&lt;/style&gt;&nbsp;`</span><span class="op" id="8420588">;</span>&nbsp;<span class="ident" id="8420590"><a href="/html/template/clone_test.go.html#8420534">got</a></span>&nbsp;<span class="op" id="8420594">!=</span>&nbsp;<span class="ident" id="8420597"><a href="/html/template/clone_test.go.html#8420539">want</a></span>&nbsp;<span class="op" id="8420602">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420606"><a href="/html/template/clone_test.go.html#8417976">t</a></span><span class="op" id="8420607">.</span><span class="ident" id="8420608">Errorf</span><span class="op" id="8420614">(</span><span class="string" id="8420615">&#34;t3:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8420635">,</span>&nbsp;<span class="ident" id="8420637"><a href="/html/template/clone_test.go.html#8420534">got</a></span><span class="op" id="8420640">,</span>&nbsp;<span class="ident" id="8420642"><a href="/html/template/clone_test.go.html#8420539">want</a></span><span class="op" id="8420646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420649">}</span><br>
<span class="lineno"></span><span class="op" id="8420651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8420654">func</span>&nbsp;<span class="ident" id="8420659">TestTemplates</span><span class="op" id="8420672">(</span><span class="ident" id="8420673">t</span>&nbsp;<span class="op" id="8420675">*</span><span class="ident" id="8420676"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8420683">.</span><span class="ident" id="8420684">T</span><span class="op" id="8420685">)</span>&nbsp;<span class="op" id="8420687">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420690">names</span>&nbsp;<span class="op" id="8420696">:=</span>&nbsp;<span class="op" id="8420699">[</span><span class="op" id="8420700">]</span><span class="builtintype" id="8420701">string</span><span class="op" id="8420707">{</span><span class="string" id="8420708">&#34;t0&#34;</span><span class="op" id="8420712">,</span>&nbsp;<span class="string" id="8420714">&#34;a&#34;</span><span class="op" id="8420717">,</span>&nbsp;<span class="string" id="8420719">&#34;lhs&#34;</span><span class="op" id="8420724">,</span>&nbsp;<span class="string" id="8420726">&#34;rhs&#34;</span><span class="op" id="8420731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8420734">//&nbsp;Some&nbsp;template&nbsp;definitions&nbsp;borrowed&nbsp;from&nbsp;TestClone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420789">const</span>&nbsp;<span class="ident" id="8420795">tmpl</span>&nbsp;<span class="op" id="8420800">=</span>&nbsp;<span class="string" id="8420802">`<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}<br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420942">t0</span>&nbsp;<span class="op" id="8420945">:=</span>&nbsp;<span class="ident" id="8420948"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8420952">(</span><span class="ident" id="8420953"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8420956">(</span><span class="string" id="8420957">&#34;t0&#34;</span><span class="op" id="8420961">)</span><span class="op" id="8420962">.</span><span class="ident" id="8420963">Parse</span><span class="op" id="8420968">(</span><span class="ident" id="8420969"><a href="/html/template/clone_test.go.html#8420795">tmpl</a></span><span class="op" id="8420973">)</span><span class="op" id="8420974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420977">templates</span>&nbsp;<span class="op" id="8420987">:=</span>&nbsp;<span class="ident" id="8420990"><a href="/html/template/clone_test.go.html#8420942">t0</a></span><span class="op" id="8420992">.</span><span class="ident" id="8420993">Templates</span><span class="op" id="8421002">(</span><span class="op" id="8421003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421006">if</span>&nbsp;<span class="builtinfunc" id="8421009">len</span><span class="op" id="8421012">(</span><span class="ident" id="8421013"><a href="/html/template/clone_test.go.html#8420977">templates</a></span><span class="op" id="8421022">)</span>&nbsp;<span class="op" id="8421024">!=</span>&nbsp;<span class="builtinfunc" id="8421027">len</span><span class="op" id="8421030">(</span><span class="ident" id="8421031"><a href="/html/template/clone_test.go.html#8420690">names</a></span><span class="op" id="8421036">)</span>&nbsp;<span class="op" id="8421038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421042"><a href="/html/template/clone_test.go.html#8420673">t</a></span><span class="op" id="8421043">.</span><span class="ident" id="8421044">Errorf</span><span class="op" id="8421050">(</span><span class="string" id="8421051">&#34;expected&nbsp;%d&nbsp;templates;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8421082">,</span>&nbsp;<span class="builtinfunc" id="8421084">len</span><span class="op" id="8421087">(</span><span class="ident" id="8421088"><a href="/html/template/clone_test.go.html#8420690">names</a></span><span class="op" id="8421093">)</span><span class="op" id="8421094">,</span>&nbsp;<span class="builtinfunc" id="8421096">len</span><span class="op" id="8421099">(</span><span class="ident" id="8421100"><a href="/html/template/clone_test.go.html#8420977">templates</a></span><span class="op" id="8421109">)</span><span class="op" id="8421110">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421116">for</span>&nbsp;<span class="ident" id="8421120">_</span><span class="op" id="8421121">,</span>&nbsp;<span class="ident" id="8421123">name</span>&nbsp;<span class="op" id="8421128">:=</span>&nbsp;<span class="keyword" id="8421131">range</span>&nbsp;<span class="ident" id="8421137"><a href="/html/template/clone_test.go.html#8420690">names</a></span>&nbsp;<span class="op" id="8421143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421147">found</span>&nbsp;<span class="op" id="8421153">:=</span>&nbsp;<span class="builtintype" id="8421156">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421164">for</span>&nbsp;<span class="ident" id="8421168">_</span><span class="op" id="8421169">,</span>&nbsp;<span class="ident" id="8421171">tmpl</span>&nbsp;<span class="op" id="8421176">:=</span>&nbsp;<span class="keyword" id="8421179">range</span>&nbsp;<span class="ident" id="8421185"><a href="/html/template/clone_test.go.html#8420977">templates</a></span>&nbsp;<span class="op" id="8421195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421200">if</span>&nbsp;<span class="ident" id="8421203"><a href="/html/template/clone_test.go.html#8421123">name</a></span>&nbsp;<span class="op" id="8421208">==</span>&nbsp;<span class="ident" id="8421211"><a href="/html/template/clone_test.go.html#8421171">tmpl</a></span><span class="op" id="8421215">.</span><span class="ident" id="8421216">text</span><span class="op" id="8421220">.</span><span class="ident" id="8421221">Name</span><span class="op" id="8421225">(</span><span class="op" id="8421226">)</span>&nbsp;<span class="op" id="8421228">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421234"><a href="/html/template/clone_test.go.html#8421147">found</a></span>&nbsp;<span class="op" id="8421240">=</span>&nbsp;<span class="builtintype" id="8421242">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421251">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421268">if</span>&nbsp;<span class="op" id="8421271">!</span><span class="ident" id="8421272"><a href="/html/template/clone_test.go.html#8421147">found</a></span>&nbsp;<span class="op" id="8421278">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421283"><a href="/html/template/clone_test.go.html#8420673">t</a></span><span class="op" id="8421284">.</span><span class="ident" id="8421285">Error</span><span class="op" id="8421290">(</span><span class="string" id="8421291">&#34;could&nbsp;not&nbsp;find&nbsp;template&#34;</span><span class="op" id="8421316">,</span>&nbsp;<span class="ident" id="8421318"><a href="/html/template/clone_test.go.html#8421123">name</a></span><span class="op" id="8421322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421329">}</span><br>
<span class="lineno"></span><span class="op" id="8421331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="8421334">//&nbsp;This&nbsp;used&nbsp;to&nbsp;crash;&nbsp;http://golang.org/issue/3281</span><br>
<span class="lineno"></span><span class="keyword" id="8421386">func</span>&nbsp;<span class="ident" id="8421391">TestCloneCrash</span><span class="op" id="8421405">(</span><span class="ident" id="8421406">t</span>&nbsp;<span class="op" id="8421408">*</span><span class="ident" id="8421409"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8421416">.</span><span class="ident" id="8421417">T</span><span class="op" id="8421418">)</span>&nbsp;<span class="op" id="8421420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421423">t1</span>&nbsp;<span class="op" id="8421426">:=</span>&nbsp;<span class="ident" id="8421429"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8421432">(</span><span class="string" id="8421433">&#34;all&#34;</span><span class="op" id="8421438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421441"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8421445">(</span><span class="ident" id="8421446"><a href="/html/template/clone_test.go.html#8421423">t1</a></span><span class="op" id="8421448">.</span><span class="ident" id="8421449">New</span><span class="op" id="8421452">(</span><span class="string" id="8421453">&#34;t1&#34;</span><span class="op" id="8421457">)</span><span class="op" id="8421458">.</span><span class="ident" id="8421459">Parse</span><span class="op" id="8421464">(</span><span class="string" id="8421465">`{{define&nbsp;&#34;foo&#34;}}foo{{end}}`</span><span class="op" id="8421493">)</span><span class="op" id="8421494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421497"><a href="/html/template/clone_test.go.html#8421423">t1</a></span><span class="op" id="8421499">.</span><span class="ident" id="8421500">Clone</span><span class="op" id="8421505">(</span><span class="op" id="8421506">)</span><br>
<span class="lineno">150</span><span class="op" id="8421508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8421511">//&nbsp;Ensure&nbsp;that&nbsp;this&nbsp;guarantee&nbsp;from&nbsp;the&nbsp;docs&nbsp;is&nbsp;upheld:</span><br>
<span class="lineno"></span><span class="comment" id="8421566">//&nbsp;&#34;Further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="8421624">//&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&#34;</span><br>
<span class="lineno">155</span><span class="keyword" id="8421665">func</span>&nbsp;<span class="ident" id="8421670">TestCloneThenParse</span><span class="op" id="8421688">(</span><span class="ident" id="8421689">t</span>&nbsp;<span class="op" id="8421691">*</span><span class="ident" id="8421692"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8421699">.</span><span class="ident" id="8421700">T</span><span class="op" id="8421701">)</span>&nbsp;<span class="op" id="8421703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421706">t0</span>&nbsp;<span class="op" id="8421709">:=</span>&nbsp;<span class="ident" id="8421712"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8421716">(</span><span class="ident" id="8421717"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8421720">(</span><span class="string" id="8421721">&#34;t0&#34;</span><span class="op" id="8421725">)</span><span class="op" id="8421726">.</span><span class="ident" id="8421727">Parse</span><span class="op" id="8421732">(</span><span class="string" id="8421733">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;embedded&#34;}}{{end}}`</span><span class="op" id="8421779">)</span><span class="op" id="8421780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421783">t1</span>&nbsp;<span class="op" id="8421786">:=</span>&nbsp;<span class="ident" id="8421789"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8421793">(</span><span class="ident" id="8421794"><a href="/html/template/clone_test.go.html#8421706">t0</a></span><span class="op" id="8421796">.</span><span class="ident" id="8421797">Clone</span><span class="op" id="8421802">(</span><span class="op" id="8421803">)</span><span class="op" id="8421804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421807"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8421811">(</span><span class="ident" id="8421812"><a href="/html/template/clone_test.go.html#8421783">t1</a></span><span class="op" id="8421814">.</span><span class="ident" id="8421815">Parse</span><span class="op" id="8421820">(</span><span class="string" id="8421821">`{{define&nbsp;&#34;embedded&#34;}}t1{{end}}`</span><span class="op" id="8421853">)</span><span class="op" id="8421854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421857">if</span>&nbsp;<span class="builtinfunc" id="8421860">len</span><span class="op" id="8421863">(</span><span class="ident" id="8421864"><a href="/html/template/clone_test.go.html#8421706">t0</a></span><span class="op" id="8421866">.</span><span class="ident" id="8421867">Templates</span><span class="op" id="8421876">(</span><span class="op" id="8421877">)</span><span class="op" id="8421878">)</span><span class="op" id="8421879">+</span><span class="num" id="8421880">1</span>&nbsp;<span class="op" id="8421882">!=</span>&nbsp;<span class="builtinfunc" id="8421885">len</span><span class="op" id="8421888">(</span><span class="ident" id="8421889"><a href="/html/template/clone_test.go.html#8421783">t1</a></span><span class="op" id="8421891">.</span><span class="ident" id="8421892">Templates</span><span class="op" id="8421901">(</span><span class="op" id="8421902">)</span><span class="op" id="8421903">)</span>&nbsp;<span class="op" id="8421905">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421909"><a href="/html/template/clone_test.go.html#8421689">t</a></span><span class="op" id="8421910">.</span><span class="ident" id="8421911">Error</span><span class="op" id="8421916">(</span><span class="string" id="8421917">&#34;adding&nbsp;a&nbsp;template&nbsp;to&nbsp;a&nbsp;clone&nbsp;added&nbsp;it&nbsp;to&nbsp;the&nbsp;original&#34;</span><span class="op" id="8421972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8421978">//&nbsp;double&nbsp;check&nbsp;that&nbsp;the&nbsp;embedded&nbsp;template&nbsp;isn&#39;t&nbsp;available&nbsp;in&nbsp;the&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422054">err</span>&nbsp;<span class="op" id="8422058">:=</span>&nbsp;<span class="ident" id="8422061"><a href="/html/template/clone_test.go.html#8421706">t0</a></span><span class="op" id="8422063">.</span><span class="ident" id="8422064">ExecuteTemplate</span><span class="op" id="8422079">(</span><span class="ident" id="8422080"><a href="/html/template/clone_test.go.html#8417386">ioutil</a></span><span class="op" id="8422086">.</span><span class="ident" id="8422087">Discard</span><span class="op" id="8422094">,</span>&nbsp;<span class="string" id="8422096">&#34;a&#34;</span><span class="op" id="8422099">,</span>&nbsp;<span class="ident" id="8422101">nil</span><span class="op" id="8422104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422107">if</span>&nbsp;<span class="ident" id="8422110"><a href="/html/template/clone_test.go.html#8422054">err</a></span>&nbsp;<span class="op" id="8422114">==</span>&nbsp;<span class="ident" id="8422117">nil</span>&nbsp;<span class="op" id="8422121">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422125"><a href="/html/template/clone_test.go.html#8421689">t</a></span><span class="op" id="8422126">.</span><span class="ident" id="8422127">Error</span><span class="op" id="8422132">(</span><span class="string" id="8422133">&#34;expected&nbsp;&#39;no&nbsp;such&nbsp;template&#39;&nbsp;error&#34;</span><span class="op" id="8422168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422171">}</span><br>
<span class="lineno"></span><span class="op" id="8422173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8422176">//&nbsp;https://code.google.com/p/go/issues/detail?id=5980</span><br>
<span class="lineno">170</span><span class="keyword" id="8422230">func</span>&nbsp;<span class="ident" id="8422235">TestFuncMapWorksAfterClone</span><span class="op" id="8422261">(</span><span class="ident" id="8422262">t</span>&nbsp;<span class="op" id="8422264">*</span><span class="ident" id="8422265"><a href="/html/template/clone_test.go.html#8417399">testing</a></span><span class="op" id="8422272">.</span><span class="ident" id="8422273">T</span><span class="op" id="8422274">)</span>&nbsp;<span class="op" id="8422276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422279">funcs</span>&nbsp;<span class="op" id="8422285">:=</span>&nbsp;<span class="ident" id="8422288"><a href="/html/template/template.go.html#4473753">FuncMap</a></span><span class="op" id="8422295">{</span><span class="string" id="8422296">&#34;customFunc&#34;</span><span class="op" id="8422308">:</span>&nbsp;<span class="keyword" id="8422310">func</span><span class="op" id="8422314">(</span><span class="op" id="8422315">)</span>&nbsp;<span class="op" id="8422317">(</span><span class="builtintype" id="8422318">string</span><span class="op" id="8422324">,</span>&nbsp;<span class="builtintype" id="8422326">error</span><span class="op" id="8422331">)</span>&nbsp;<span class="op" id="8422333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422337">return</span>&nbsp;<span class="string" id="8422344">&#34;&#34;</span><span class="op" id="8422346">,</span>&nbsp;<span class="ident" id="8422348"><a href="/html/template/clone_test.go.html#8417376">errors</a></span><span class="op" id="8422354">.</span><span class="ident" id="8422355">New</span><span class="op" id="8422358">(</span><span class="string" id="8422359">&#34;issue5980&#34;</span><span class="op" id="8422370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422373">}</span><span class="op" id="8422374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422378">//&nbsp;get&nbsp;the&nbsp;expected&nbsp;error&nbsp;output&nbsp;(no&nbsp;clone)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422423">uncloned</span>&nbsp;<span class="op" id="8422432">:=</span>&nbsp;<span class="ident" id="8422435"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8422439">(</span><span class="ident" id="8422440"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8422443">(</span><span class="string" id="8422444">&#34;&#34;</span><span class="op" id="8422446">)</span><span class="op" id="8422447">.</span><span class="ident" id="8422448">Funcs</span><span class="op" id="8422453">(</span><span class="ident" id="8422454"><a href="/html/template/clone_test.go.html#8422279">funcs</a></span><span class="op" id="8422459">)</span><span class="op" id="8422460">.</span><span class="ident" id="8422461">Parse</span><span class="op" id="8422466">(</span><span class="string" id="8422467">&#34;{{customFunc}}&#34;</span><span class="op" id="8422483">)</span><span class="op" id="8422484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422487">wantErr</span>&nbsp;<span class="op" id="8422495">:=</span>&nbsp;<span class="ident" id="8422498"><a href="/html/template/clone_test.go.html#8422423">uncloned</a></span><span class="op" id="8422506">.</span><span class="ident" id="8422507">Execute</span><span class="op" id="8422514">(</span><span class="ident" id="8422515"><a href="/html/template/clone_test.go.html#8417386">ioutil</a></span><span class="op" id="8422521">.</span><span class="ident" id="8422522">Discard</span><span class="op" id="8422529">,</span>&nbsp;<span class="ident" id="8422531">nil</span><span class="op" id="8422534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422538">//&nbsp;toClone&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;uncloned.&nbsp;It&nbsp;has&nbsp;to&nbsp;be&nbsp;recreated&nbsp;from&nbsp;scratch,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422617">//&nbsp;since&nbsp;cloning&nbsp;cannot&nbsp;occur&nbsp;after&nbsp;execution.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422665">toClone</span>&nbsp;<span class="op" id="8422673">:=</span>&nbsp;<span class="ident" id="8422676"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8422680">(</span><span class="ident" id="8422681"><a href="/html/template/template.go.html#4472454">New</a></span><span class="op" id="8422684">(</span><span class="string" id="8422685">&#34;&#34;</span><span class="op" id="8422687">)</span><span class="op" id="8422688">.</span><span class="ident" id="8422689">Funcs</span><span class="op" id="8422694">(</span><span class="ident" id="8422695"><a href="/html/template/clone_test.go.html#8422279">funcs</a></span><span class="op" id="8422700">)</span><span class="op" id="8422701">.</span><span class="ident" id="8422702">Parse</span><span class="op" id="8422707">(</span><span class="string" id="8422708">&#34;{{customFunc}}&#34;</span><span class="op" id="8422724">)</span><span class="op" id="8422725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422728">cloned</span>&nbsp;<span class="op" id="8422735">:=</span>&nbsp;<span class="ident" id="8422738"><a href="/html/template/template.go.html#4475091">Must</a></span><span class="op" id="8422742">(</span><span class="ident" id="8422743"><a href="/html/template/clone_test.go.html#8422665">toClone</a></span><span class="op" id="8422750">.</span><span class="ident" id="8422751">Clone</span><span class="op" id="8422756">(</span><span class="op" id="8422757">)</span><span class="op" id="8422758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422761">gotErr</span>&nbsp;<span class="op" id="8422768">:=</span>&nbsp;<span class="ident" id="8422771"><a href="/html/template/clone_test.go.html#8422728">cloned</a></span><span class="op" id="8422777">.</span><span class="ident" id="8422778">Execute</span><span class="op" id="8422785">(</span><span class="ident" id="8422786"><a href="/html/template/clone_test.go.html#8417386">ioutil</a></span><span class="op" id="8422792">.</span><span class="ident" id="8422793">Discard</span><span class="op" id="8422800">,</span>&nbsp;<span class="ident" id="8422802">nil</span><span class="op" id="8422805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422809">if</span>&nbsp;<span class="ident" id="8422812"><a href="/html/template/clone_test.go.html#8422487">wantErr</a></span><span class="op" id="8422819">.</span><span class="ident" id="8422820">Error</span><span class="op" id="8422825">(</span><span class="op" id="8422826">)</span>&nbsp;<span class="op" id="8422828">!=</span>&nbsp;<span class="ident" id="8422831"><a href="/html/template/clone_test.go.html#8422761">gotErr</a></span><span class="op" id="8422837">.</span><span class="ident" id="8422838">Error</span><span class="op" id="8422843">(</span><span class="op" id="8422844">)</span>&nbsp;<span class="op" id="8422846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422850"><a href="/html/template/clone_test.go.html#8422262">t</a></span><span class="op" id="8422851">.</span><span class="ident" id="8422852">Errorf</span><span class="op" id="8422858">(</span><span class="string" id="8422859">&#34;clone&nbsp;error&nbsp;message&nbsp;mismatch&nbsp;want&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8422904">,</span>&nbsp;<span class="ident" id="8422906"><a href="/html/template/clone_test.go.html#8422487">wantErr</a></span><span class="op" id="8422913">,</span>&nbsp;<span class="ident" id="8422915"><a href="/html/template/clone_test.go.html#8422761">gotErr</a></span><span class="op" id="8422921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422924">}</span><br>
<span class="lineno"></span><span class="op" id="8422926">}</span>
</div>
</body>
</html>
