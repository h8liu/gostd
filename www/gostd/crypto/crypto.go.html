<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1334478">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1334533">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1334587">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1334638">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="1334697">package</span>&nbsp;<span class="ident" id="1334705">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1334713">import</span>&nbsp;<span class="op" id="1334720">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1334723">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1334731">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1334737">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="1334747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1334750">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="1334830">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1334842">type</span>&nbsp;<span class="ident" id="1334847">Hash</span>&nbsp;<span class="builtintype" id="1334852">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1334858">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="1334936">func</span>&nbsp;<span class="op" id="1334941">(</span><span class="ident" id="1334942">h</span>&nbsp;<span class="ident" id="1334944">Hash</span><span class="op" id="1334948">)</span>&nbsp;<span class="ident" id="1334950">HashFunc</span><span class="op" id="1334958">(</span><span class="op" id="1334959">)</span>&nbsp;<span class="ident" id="1334961">Hash</span>&nbsp;<span class="op" id="1334966">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1334969">return</span>&nbsp;<span class="ident" id="1334976">h</span><br>
<span class="lineno"></span><span class="op" id="1334978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1334981">const</span>&nbsp;<span class="op" id="1334987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334990">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1335000">Hash</span>&nbsp;<span class="op" id="1335005">=</span>&nbsp;<span class="num" id="1335007">1</span>&nbsp;<span class="op" id="1335009">+</span>&nbsp;<span class="ident" id="1335011">iota</span>&nbsp;<span class="comment" id="1335016">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335051">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335077">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335099">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335125">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335148">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335174">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335199">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335225">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335250">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335276">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335301">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335327">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335352">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335378">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335427">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335453">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335494">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335520">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335556">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335582">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335618">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335644">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335680">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1335706">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335742">maxHash</span><br>
<span class="lineno"></span><span class="op" id="1335750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1335753">var</span>&nbsp;<span class="ident" id="1335757">digestSizes</span>&nbsp;<span class="op" id="1335769">=</span>&nbsp;<span class="op" id="1335771">[</span><span class="op" id="1335772">]</span><span class="builtintype" id="1335773">uint8</span><span class="op" id="1335778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335781">MD4</span><span class="op" id="1335784">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335792">16</span><span class="op" id="1335794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335797">MD5</span><span class="op" id="1335800">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335808">16</span><span class="op" id="1335810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335813">SHA1</span><span class="op" id="1335817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335824">20</span><span class="op" id="1335826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335829">SHA224</span><span class="op" id="1335835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335840">28</span><span class="op" id="1335842">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335845">SHA256</span><span class="op" id="1335851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335856">32</span><span class="op" id="1335858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335861">SHA384</span><span class="op" id="1335867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335872">48</span><span class="op" id="1335874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335877">SHA512</span><span class="op" id="1335883">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1335888">64</span><span class="op" id="1335890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335893">SHA3_224</span><span class="op" id="1335901">:</span>&nbsp;&nbsp;<span class="num" id="1335904">28</span><span class="op" id="1335906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335909">SHA3_256</span><span class="op" id="1335917">:</span>&nbsp;&nbsp;<span class="num" id="1335920">32</span><span class="op" id="1335922">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335925">SHA3_384</span><span class="op" id="1335933">:</span>&nbsp;&nbsp;<span class="num" id="1335936">48</span><span class="op" id="1335938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335941">SHA3_512</span><span class="op" id="1335949">:</span>&nbsp;&nbsp;<span class="num" id="1335952">64</span><span class="op" id="1335954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335957">MD5SHA1</span><span class="op" id="1335964">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="1335968">36</span><span class="op" id="1335970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335973">RIPEMD160</span><span class="op" id="1335982">:</span>&nbsp;<span class="num" id="1335984">20</span><span class="op" id="1335986">,</span><br>
<span class="lineno"></span><span class="op" id="1335988">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1335991">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="1336071">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="1336148">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="1336169">func</span>&nbsp;<span class="op" id="1336174">(</span><span class="ident" id="1336175">h</span>&nbsp;<span class="ident" id="1336177">Hash</span><span class="op" id="1336181">)</span>&nbsp;<span class="ident" id="1336183">Size</span><span class="op" id="1336187">(</span><span class="op" id="1336188">)</span>&nbsp;<span class="builtintype" id="1336190">int</span>&nbsp;<span class="op" id="1336194">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336197">if</span>&nbsp;<span class="ident" id="1336200">h</span>&nbsp;<span class="op" id="1336202">&gt;</span>&nbsp;<span class="num" id="1336204">0</span>&nbsp;<span class="op" id="1336206">&amp;&amp;</span>&nbsp;<span class="ident" id="1336209">h</span>&nbsp;<span class="op" id="1336211">&lt;</span>&nbsp;<span class="ident" id="1336213">maxHash</span>&nbsp;<span class="op" id="1336221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336225">return</span>&nbsp;<span class="builtintype" id="1336232">int</span><span class="op" id="1336235">(</span><span class="ident" id="1336236">digestSizes</span><span class="op" id="1336247">[</span><span class="ident" id="1336248">h</span><span class="op" id="1336249">]</span><span class="op" id="1336250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1336253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1336256">panic</span><span class="op" id="1336261">(</span><span class="string" id="1336262">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="1336301">)</span><br>
<span class="lineno"></span><span class="op" id="1336303">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1336306">var</span>&nbsp;<span class="ident" id="1336310">hashes</span>&nbsp;<span class="op" id="1336317">=</span>&nbsp;<span class="builtinfunc" id="1336319">make</span><span class="op" id="1336323">(</span><span class="op" id="1336324">[</span><span class="op" id="1336325">]</span><span class="keyword" id="1336326">func</span><span class="op" id="1336330">(</span><span class="op" id="1336331">)</span>&nbsp;<span class="ident" id="1336333">hash</span><span class="op" id="1336337">.</span><span class="ident" id="1336338">Hash</span><span class="op" id="1336342">,</span>&nbsp;<span class="ident" id="1336344">maxHash</span><span class="op" id="1336351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1336354">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="1336433">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="1336488">func</span>&nbsp;<span class="op" id="1336493">(</span><span class="ident" id="1336494">h</span>&nbsp;<span class="ident" id="1336496">Hash</span><span class="op" id="1336500">)</span>&nbsp;<span class="ident" id="1336502">New</span><span class="op" id="1336505">(</span><span class="op" id="1336506">)</span>&nbsp;<span class="ident" id="1336508">hash</span><span class="op" id="1336512">.</span><span class="ident" id="1336513">Hash</span>&nbsp;<span class="op" id="1336518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336521">if</span>&nbsp;<span class="ident" id="1336524">h</span>&nbsp;<span class="op" id="1336526">&gt;</span>&nbsp;<span class="num" id="1336528">0</span>&nbsp;<span class="op" id="1336530">&amp;&amp;</span>&nbsp;<span class="ident" id="1336533">h</span>&nbsp;<span class="op" id="1336535">&lt;</span>&nbsp;<span class="ident" id="1336537">maxHash</span>&nbsp;<span class="op" id="1336545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336549">f</span>&nbsp;<span class="op" id="1336551">:=</span>&nbsp;<span class="ident" id="1336554">hashes</span><span class="op" id="1336560">[</span><span class="ident" id="1336561">h</span><span class="op" id="1336562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336566">if</span>&nbsp;<span class="ident" id="1336569">f</span>&nbsp;<span class="op" id="1336571">!=</span>&nbsp;<span class="ident" id="1336574">nil</span>&nbsp;<span class="op" id="1336578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336583">return</span>&nbsp;<span class="ident" id="1336590">f</span><span class="op" id="1336591">(</span><span class="op" id="1336592">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1336596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1336599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1336602">panic</span><span class="op" id="1336607">(</span><span class="string" id="1336608">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="1336644">+</span>&nbsp;<span class="ident" id="1336646">strconv</span><span class="op" id="1336653">.</span><span class="ident" id="1336654">Itoa</span><span class="op" id="1336658">(</span><span class="builtintype" id="1336659">int</span><span class="op" id="1336662">(</span><span class="ident" id="1336663">h</span><span class="op" id="1336664">)</span><span class="op" id="1336665">)</span>&nbsp;<span class="op" id="1336667">+</span>&nbsp;<span class="string" id="1336669">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="1336686">)</span><br>
<span class="lineno"></span><span class="op" id="1336688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1336691">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="1336771">func</span>&nbsp;<span class="op" id="1336776">(</span><span class="ident" id="1336777">h</span>&nbsp;<span class="ident" id="1336779">Hash</span><span class="op" id="1336783">)</span>&nbsp;<span class="ident" id="1336785">Available</span><span class="op" id="1336794">(</span><span class="op" id="1336795">)</span>&nbsp;<span class="builtintype" id="1336797">bool</span>&nbsp;<span class="op" id="1336802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336805">return</span>&nbsp;<span class="ident" id="1336812">h</span>&nbsp;<span class="op" id="1336814">&lt;</span>&nbsp;<span class="ident" id="1336816">maxHash</span>&nbsp;<span class="op" id="1336824">&amp;&amp;</span>&nbsp;<span class="ident" id="1336827">hashes</span><span class="op" id="1336833">[</span><span class="ident" id="1336834">h</span><span class="op" id="1336835">]</span>&nbsp;<span class="op" id="1336837">!=</span>&nbsp;<span class="ident" id="1336840">nil</span><br>
<span class="lineno"></span><span class="op" id="1336844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1336847">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="1336925">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1336999">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="1337042">func</span>&nbsp;<span class="ident" id="1337047">RegisterHash</span><span class="op" id="1337059">(</span><span class="ident" id="1337060">h</span>&nbsp;<span class="ident" id="1337062">Hash</span><span class="op" id="1337066">,</span>&nbsp;<span class="ident" id="1337068">f</span>&nbsp;<span class="keyword" id="1337070">func</span><span class="op" id="1337074">(</span><span class="op" id="1337075">)</span>&nbsp;<span class="ident" id="1337077">hash</span><span class="op" id="1337081">.</span><span class="ident" id="1337082">Hash</span><span class="op" id="1337086">)</span>&nbsp;<span class="op" id="1337088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337091">if</span>&nbsp;<span class="ident" id="1337094">h</span>&nbsp;<span class="op" id="1337096">&gt;=</span>&nbsp;<span class="ident" id="1337099">maxHash</span>&nbsp;<span class="op" id="1337107">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1337111">panic</span><span class="op" id="1337116">(</span><span class="string" id="1337117">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="1337164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1337167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337170">hashes</span><span class="op" id="1337176">[</span><span class="ident" id="1337177">h</span><span class="op" id="1337178">]</span>&nbsp;<span class="op" id="1337180">=</span>&nbsp;<span class="ident" id="1337182">f</span><br>
<span class="lineno"></span><span class="op" id="1337184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1337187">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="1337256">type</span>&nbsp;<span class="ident" id="1337261">PublicKey</span>&nbsp;<span class="keyword" id="1337271">interface</span><span class="op" id="1337280">{</span><span class="op" id="1337281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1337284">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="1337355">type</span>&nbsp;<span class="ident" id="1337360">PrivateKey</span>&nbsp;<span class="keyword" id="1337371">interface</span><span class="op" id="1337380">{</span><span class="op" id="1337381">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="1337384">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1337457">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="1337531">type</span>&nbsp;<span class="ident" id="1337536">Signer</span>&nbsp;<span class="keyword" id="1337543">interface</span>&nbsp;<span class="op" id="1337553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337556">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337619">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337636">Public</span><span class="op" id="1337642">(</span><span class="op" id="1337643">)</span>&nbsp;<span class="ident" id="1337645">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337657">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337726">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337795">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337867">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337934">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1337938">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338011">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338084">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338152">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338224">Sign</span><span class="op" id="1338228">(</span><span class="ident" id="1338229">rand</span>&nbsp;<span class="ident" id="1338234">io</span><span class="op" id="1338236">.</span><span class="ident" id="1338237">Reader</span><span class="op" id="1338243">,</span>&nbsp;<span class="ident" id="1338245">msg</span>&nbsp;<span class="op" id="1338249">[</span><span class="op" id="1338250">]</span><span class="builtintype" id="1338251">byte</span><span class="op" id="1338255">,</span>&nbsp;<span class="ident" id="1338257">opts</span>&nbsp;<span class="ident" id="1338262">SignerOpts</span><span class="op" id="1338272">)</span>&nbsp;<span class="op" id="1338274">(</span><span class="ident" id="1338275">signature</span>&nbsp;<span class="op" id="1338285">[</span><span class="op" id="1338286">]</span><span class="builtintype" id="1338287">byte</span><span class="op" id="1338291">,</span>&nbsp;<span class="ident" id="1338293">err</span>&nbsp;<span class="builtintype" id="1338297">error</span><span class="op" id="1338302">)</span><br>
<span class="lineno"></span><span class="op" id="1338304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="1338307">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="1338365">type</span>&nbsp;<span class="ident" id="1338370">SignerOpts</span>&nbsp;<span class="keyword" id="1338381">interface</span>&nbsp;<span class="op" id="1338391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338394">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338467">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338539">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338561">HashFunc</span><span class="op" id="1338569">(</span><span class="op" id="1338570">)</span>&nbsp;<span class="ident" id="1338572">Hash</span><br>
<span class="lineno"></span><span class="op" id="1338577">}</span>
</div>
</body>
</html>
