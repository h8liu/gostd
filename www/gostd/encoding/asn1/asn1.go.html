<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4823663">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4823718">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4823772">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4823823">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4823896">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4823930">//</span><br>
<span class="lineno"></span><span class="comment" id="4823933">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4824002">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4824054">package</span>&nbsp;<span class="ident" id="4824062">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4824068">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4824148">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4824224">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4824300">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4824379">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4824454">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4824526">//</span><br>
<span class="lineno"></span><span class="comment" id="4824529">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4824600">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4824629">import</span>&nbsp;<span class="op" id="4824636">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4824639">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4824646">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4824658">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4824669">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4824680">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4824687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4824690">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4824766">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4824806">type</span>&nbsp;<span class="ident" id="4824811">StructuralError</span>&nbsp;<span class="keyword" id="4824827">struct</span>&nbsp;<span class="op" id="4824834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824837">Msg</span>&nbsp;<span class="builtintype" id="4824841">string</span><br>
<span class="lineno"></span><span class="op" id="4824848">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4824851">func</span>&nbsp;<span class="op" id="4824856">(</span><span class="ident" id="4824857">e</span>&nbsp;<span class="ident" id="4824859">StructuralError</span><span class="op" id="4824874">)</span>&nbsp;<span class="ident" id="4824876">Error</span><span class="op" id="4824881">(</span><span class="op" id="4824882">)</span>&nbsp;<span class="builtintype" id="4824884">string</span>&nbsp;<span class="op" id="4824891">{</span>&nbsp;<span class="keyword" id="4824893">return</span>&nbsp;<span class="string" id="4824900">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4824926">+</span>&nbsp;<span class="ident" id="4824928">e</span><span class="op" id="4824929">.</span><span class="ident" id="4824930">Msg</span>&nbsp;<span class="op" id="4824934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4824937">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4824995">type</span>&nbsp;<span class="ident" id="4825000">SyntaxError</span>&nbsp;<span class="keyword" id="4825012">struct</span>&nbsp;<span class="op" id="4825019">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825022">Msg</span>&nbsp;<span class="builtintype" id="4825026">string</span><br>
<span class="lineno"></span><span class="op" id="4825033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4825036">func</span>&nbsp;<span class="op" id="4825041">(</span><span class="ident" id="4825042">e</span>&nbsp;<span class="ident" id="4825044">SyntaxError</span><span class="op" id="4825055">)</span>&nbsp;<span class="ident" id="4825057">Error</span><span class="op" id="4825062">(</span><span class="op" id="4825063">)</span>&nbsp;<span class="builtintype" id="4825065">string</span>&nbsp;<span class="op" id="4825072">{</span>&nbsp;<span class="keyword" id="4825074">return</span>&nbsp;<span class="string" id="4825081">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4825104">+</span>&nbsp;<span class="ident" id="4825106">e</span><span class="op" id="4825107">.</span><span class="ident" id="4825108">Msg</span>&nbsp;<span class="op" id="4825112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4825115">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4825181">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4825193">func</span>&nbsp;<span class="ident" id="4825198">parseBool</span><span class="op" id="4825207">(</span><span class="ident" id="4825208">bytes</span>&nbsp;<span class="op" id="4825214">[</span><span class="op" id="4825215">]</span><span class="builtintype" id="4825216">byte</span><span class="op" id="4825220">)</span>&nbsp;<span class="op" id="4825222">(</span><span class="ident" id="4825223">ret</span>&nbsp;<span class="builtintype" id="4825227">bool</span><span class="op" id="4825231">,</span>&nbsp;<span class="ident" id="4825233">err</span>&nbsp;<span class="builtintype" id="4825237">error</span><span class="op" id="4825242">)</span>&nbsp;<span class="op" id="4825244">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825247">if</span>&nbsp;<span class="builtinfunc" id="4825250">len</span><span class="op" id="4825253">(</span><span class="ident" id="4825254">bytes</span><span class="op" id="4825259">)</span>&nbsp;<span class="op" id="4825261">!=</span>&nbsp;<span class="num" id="4825264">1</span>&nbsp;<span class="op" id="4825266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825270">err</span>&nbsp;<span class="op" id="4825274">=</span>&nbsp;<span class="ident" id="4825276">SyntaxError</span><span class="op" id="4825287">{</span><span class="string" id="4825288">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4825305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825309">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825321">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825394">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825463">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825513">switch</span>&nbsp;<span class="ident" id="4825520">bytes</span><span class="op" id="4825525">[</span><span class="num" id="4825526">0</span><span class="op" id="4825527">]</span>&nbsp;<span class="op" id="4825529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825532">case</span>&nbsp;<span class="num" id="4825537">0</span><span class="op" id="4825538">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825542">ret</span>&nbsp;<span class="op" id="4825546">=</span>&nbsp;<span class="builtintype" id="4825548">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825555">case</span>&nbsp;<span class="num" id="4825560">0xff</span><span class="op" id="4825564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825568">ret</span>&nbsp;<span class="op" id="4825572">=</span>&nbsp;<span class="builtintype" id="4825574">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825580">default</span><span class="op" id="4825587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825591">err</span>&nbsp;<span class="op" id="4825595">=</span>&nbsp;<span class="ident" id="4825597">SyntaxError</span><span class="op" id="4825608">{</span><span class="string" id="4825609">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4825626">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825633">return</span><br>
<span class="lineno"></span><span class="op" id="4825640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4825643">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4825655">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4825728">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4825751">func</span>&nbsp;<span class="ident" id="4825756">parseInt64</span><span class="op" id="4825766">(</span><span class="ident" id="4825767">bytes</span>&nbsp;<span class="op" id="4825773">[</span><span class="op" id="4825774">]</span><span class="builtintype" id="4825775">byte</span><span class="op" id="4825779">)</span>&nbsp;<span class="op" id="4825781">(</span><span class="ident" id="4825782">ret</span>&nbsp;<span class="ident" id="4825786">int64</span><span class="op" id="4825791">,</span>&nbsp;<span class="ident" id="4825793">err</span>&nbsp;<span class="builtintype" id="4825797">error</span><span class="op" id="4825802">)</span>&nbsp;<span class="op" id="4825804">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825807">if</span>&nbsp;<span class="builtinfunc" id="4825810">len</span><span class="op" id="4825813">(</span><span class="ident" id="4825814">bytes</span><span class="op" id="4825819">)</span>&nbsp;<span class="op" id="4825821">&gt;</span>&nbsp;<span class="num" id="4825823">8</span>&nbsp;<span class="op" id="4825825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825829">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825872">err</span>&nbsp;<span class="op" id="4825876">=</span>&nbsp;<span class="ident" id="4825878">StructuralError</span><span class="op" id="4825893">{</span><span class="string" id="4825894">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4825913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825925">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825928">for</span>&nbsp;<span class="ident" id="4825932">bytesRead</span>&nbsp;<span class="op" id="4825942">:=</span>&nbsp;<span class="num" id="4825945">0</span><span class="op" id="4825946">;</span>&nbsp;<span class="ident" id="4825948">bytesRead</span>&nbsp;<span class="op" id="4825958">&lt;</span>&nbsp;<span class="builtinfunc" id="4825960">len</span><span class="op" id="4825963">(</span><span class="ident" id="4825964">bytes</span><span class="op" id="4825969">)</span><span class="op" id="4825970">;</span>&nbsp;<span class="ident" id="4825972">bytesRead</span><span class="op" id="4825981">++</span>&nbsp;<span class="op" id="4825984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825988">ret</span>&nbsp;<span class="op" id="4825992">&lt;&lt;=</span>&nbsp;<span class="num" id="4825996">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826000">ret</span>&nbsp;<span class="op" id="4826004">|=</span>&nbsp;<span class="ident" id="4826007">int64</span><span class="op" id="4826012">(</span><span class="ident" id="4826013">bytes</span><span class="op" id="4826018">[</span><span class="ident" id="4826019">bytesRead</span><span class="op" id="4826028">]</span><span class="op" id="4826029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4826036">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826094">ret</span>&nbsp;<span class="op" id="4826098">&lt;&lt;=</span>&nbsp;<span class="num" id="4826102">64</span>&nbsp;<span class="op" id="4826105">-</span>&nbsp;<span class="builtintype" id="4826107">uint8</span><span class="op" id="4826112">(</span><span class="builtinfunc" id="4826113">len</span><span class="op" id="4826116">(</span><span class="ident" id="4826117">bytes</span><span class="op" id="4826122">)</span><span class="op" id="4826123">)</span><span class="op" id="4826124">*</span><span class="num" id="4826125">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826128">ret</span>&nbsp;<span class="op" id="4826132">&gt;&gt;=</span>&nbsp;<span class="num" id="4826136">64</span>&nbsp;<span class="op" id="4826139">-</span>&nbsp;<span class="builtintype" id="4826141">uint8</span><span class="op" id="4826146">(</span><span class="builtinfunc" id="4826147">len</span><span class="op" id="4826150">(</span><span class="ident" id="4826151">bytes</span><span class="op" id="4826156">)</span><span class="op" id="4826157">)</span><span class="op" id="4826158">*</span><span class="num" id="4826159">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826162">return</span><br>
<span class="lineno"></span><span class="op" id="4826169">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4826172">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4826251">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4826266">func</span>&nbsp;<span class="ident" id="4826271">parseInt32</span><span class="op" id="4826281">(</span><span class="ident" id="4826282">bytes</span>&nbsp;<span class="op" id="4826288">[</span><span class="op" id="4826289">]</span><span class="builtintype" id="4826290">byte</span><span class="op" id="4826294">)</span>&nbsp;<span class="op" id="4826296">(</span><span class="builtintype" id="4826297">int32</span><span class="op" id="4826302">,</span>&nbsp;<span class="builtintype" id="4826304">error</span><span class="op" id="4826309">)</span>&nbsp;<span class="op" id="4826311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826314">ret64</span><span class="op" id="4826319">,</span>&nbsp;<span class="ident" id="4826321">err</span>&nbsp;<span class="op" id="4826325">:=</span>&nbsp;<span class="ident" id="4826328">parseInt64</span><span class="op" id="4826338">(</span><span class="ident" id="4826339">bytes</span><span class="op" id="4826344">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826347">if</span>&nbsp;<span class="ident" id="4826350">err</span>&nbsp;<span class="op" id="4826354">!=</span>&nbsp;<span class="ident" id="4826357">nil</span>&nbsp;<span class="op" id="4826361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826365">return</span>&nbsp;<span class="num" id="4826372">0</span><span class="op" id="4826373">,</span>&nbsp;<span class="ident" id="4826375">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826383">if</span>&nbsp;<span class="ident" id="4826386">ret64</span>&nbsp;<span class="op" id="4826392">!=</span>&nbsp;<span class="ident" id="4826395">int64</span><span class="op" id="4826400">(</span><span class="builtintype" id="4826401">int32</span><span class="op" id="4826406">(</span><span class="ident" id="4826407">ret64</span><span class="op" id="4826412">)</span><span class="op" id="4826413">)</span>&nbsp;<span class="op" id="4826415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826419">return</span>&nbsp;<span class="num" id="4826426">0</span><span class="op" id="4826427">,</span>&nbsp;<span class="ident" id="4826429">StructuralError</span><span class="op" id="4826444">{</span><span class="string" id="4826445">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4826464">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826470">return</span>&nbsp;<span class="builtintype" id="4826477">int32</span><span class="op" id="4826482">(</span><span class="ident" id="4826483">ret64</span><span class="op" id="4826488">)</span><span class="op" id="4826489">,</span>&nbsp;<span class="ident" id="4826491">nil</span><br>
<span class="lineno"></span><span class="op" id="4826495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4826498">var</span>&nbsp;<span class="ident" id="4826502">bigOne</span>&nbsp;<span class="op" id="4826509">=</span>&nbsp;<span class="ident" id="4826511">big</span><span class="op" id="4826514">.</span><span class="ident" id="4826515">NewInt</span><span class="op" id="4826521">(</span><span class="num" id="4826522">1</span><span class="op" id="4826523">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4826526">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4826608">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4826623">func</span>&nbsp;<span class="ident" id="4826628">parseBigInt</span><span class="op" id="4826639">(</span><span class="ident" id="4826640">bytes</span>&nbsp;<span class="op" id="4826646">[</span><span class="op" id="4826647">]</span><span class="builtintype" id="4826648">byte</span><span class="op" id="4826652">)</span>&nbsp;<span class="op" id="4826654">*</span><span class="ident" id="4826655">big</span><span class="op" id="4826658">.</span><span class="ident" id="4826659">Int</span>&nbsp;<span class="op" id="4826663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826666">ret</span>&nbsp;<span class="op" id="4826670">:=</span>&nbsp;<span class="builtinfunc" id="4826673">new</span><span class="op" id="4826676">(</span><span class="ident" id="4826677">big</span><span class="op" id="4826680">.</span><span class="ident" id="4826681">Int</span><span class="op" id="4826684">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826687">if</span>&nbsp;<span class="builtinfunc" id="4826690">len</span><span class="op" id="4826693">(</span><span class="ident" id="4826694">bytes</span><span class="op" id="4826699">)</span>&nbsp;<span class="op" id="4826701">&gt;</span>&nbsp;<span class="num" id="4826703">0</span>&nbsp;<span class="op" id="4826705">&amp;&amp;</span>&nbsp;<span class="ident" id="4826708">bytes</span><span class="op" id="4826713">[</span><span class="num" id="4826714">0</span><span class="op" id="4826715">]</span><span class="op" id="4826716">&amp;</span><span class="num" id="4826717">0x80</span>&nbsp;<span class="op" id="4826722">==</span>&nbsp;<span class="num" id="4826725">0x80</span>&nbsp;<span class="op" id="4826730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4826734">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826766">notBytes</span>&nbsp;<span class="op" id="4826775">:=</span>&nbsp;<span class="builtinfunc" id="4826778">make</span><span class="op" id="4826782">(</span><span class="op" id="4826783">[</span><span class="op" id="4826784">]</span><span class="builtintype" id="4826785">byte</span><span class="op" id="4826789">,</span>&nbsp;<span class="builtinfunc" id="4826791">len</span><span class="op" id="4826794">(</span><span class="ident" id="4826795">bytes</span><span class="op" id="4826800">)</span><span class="op" id="4826801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826805">for</span>&nbsp;<span class="ident" id="4826809">i</span>&nbsp;<span class="op" id="4826811">:=</span>&nbsp;<span class="keyword" id="4826814">range</span>&nbsp;<span class="ident" id="4826820">notBytes</span>&nbsp;<span class="op" id="4826829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826834">notBytes</span><span class="op" id="4826842">[</span><span class="ident" id="4826843">i</span><span class="op" id="4826844">]</span>&nbsp;<span class="op" id="4826846">=</span>&nbsp;<span class="op" id="4826848">^</span><span class="ident" id="4826849">bytes</span><span class="op" id="4826854">[</span><span class="ident" id="4826855">i</span><span class="op" id="4826856">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826864">ret</span><span class="op" id="4826867">.</span><span class="ident" id="4826868">SetBytes</span><span class="op" id="4826876">(</span><span class="ident" id="4826877">notBytes</span><span class="op" id="4826885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826889">ret</span><span class="op" id="4826892">.</span><span class="ident" id="4826893">Add</span><span class="op" id="4826896">(</span><span class="ident" id="4826897">ret</span><span class="op" id="4826900">,</span>&nbsp;<span class="ident" id="4826902">bigOne</span><span class="op" id="4826908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826912">ret</span><span class="op" id="4826915">.</span><span class="ident" id="4826916">Neg</span><span class="op" id="4826919">(</span><span class="ident" id="4826920">ret</span><span class="op" id="4826923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826927">return</span>&nbsp;<span class="ident" id="4826934">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826942">ret</span><span class="op" id="4826945">.</span><span class="ident" id="4826946">SetBytes</span><span class="op" id="4826954">(</span><span class="ident" id="4826955">bytes</span><span class="op" id="4826960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826963">return</span>&nbsp;<span class="ident" id="4826970">ret</span><br>
<span class="lineno"></span><span class="op" id="4826974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4826977">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4826992">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4827071">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4827146">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4827200">type</span>&nbsp;<span class="ident" id="4827205">BitString</span>&nbsp;<span class="keyword" id="4827215">struct</span>&nbsp;<span class="op" id="4827222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827225">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827235">[</span><span class="op" id="4827236">]</span><span class="builtintype" id="4827237">byte</span>&nbsp;<span class="comment" id="4827242">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827270">BitLength</span>&nbsp;<span class="builtintype" id="4827280">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4827287">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4827306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4827309">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4827383">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4827401">func</span>&nbsp;<span class="op" id="4827406">(</span><span class="ident" id="4827407">b</span>&nbsp;<span class="ident" id="4827409">BitString</span><span class="op" id="4827418">)</span>&nbsp;<span class="ident" id="4827420">At</span><span class="op" id="4827422">(</span><span class="ident" id="4827423">i</span>&nbsp;<span class="builtintype" id="4827425">int</span><span class="op" id="4827428">)</span>&nbsp;<span class="builtintype" id="4827430">int</span>&nbsp;<span class="op" id="4827434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827437">if</span>&nbsp;<span class="ident" id="4827440">i</span>&nbsp;<span class="op" id="4827442">&lt;</span>&nbsp;<span class="num" id="4827444">0</span>&nbsp;<span class="op" id="4827446">||</span>&nbsp;<span class="ident" id="4827449">i</span>&nbsp;<span class="op" id="4827451">&gt;=</span>&nbsp;<span class="ident" id="4827454">b</span><span class="op" id="4827455">.</span><span class="ident" id="4827456">BitLength</span>&nbsp;<span class="op" id="4827466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827470">return</span>&nbsp;<span class="num" id="4827477">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827483">x</span>&nbsp;<span class="op" id="4827485">:=</span>&nbsp;<span class="ident" id="4827488">i</span>&nbsp;<span class="op" id="4827490">/</span>&nbsp;<span class="num" id="4827492">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827495">y</span>&nbsp;<span class="op" id="4827497">:=</span>&nbsp;<span class="num" id="4827500">7</span>&nbsp;<span class="op" id="4827502">-</span>&nbsp;<span class="builtintype" id="4827504">uint</span><span class="op" id="4827508">(</span><span class="ident" id="4827509">i</span><span class="op" id="4827510">%</span><span class="num" id="4827511">8</span><span class="op" id="4827512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827515">return</span>&nbsp;<span class="builtintype" id="4827522">int</span><span class="op" id="4827525">(</span><span class="ident" id="4827526">b</span><span class="op" id="4827527">.</span><span class="ident" id="4827528">Bytes</span><span class="op" id="4827533">[</span><span class="ident" id="4827534">x</span><span class="op" id="4827535">]</span><span class="op" id="4827536">&gt;&gt;</span><span class="ident" id="4827538">y</span><span class="op" id="4827539">)</span>&nbsp;<span class="op" id="4827541">&amp;</span>&nbsp;<span class="num" id="4827543">1</span><br>
<span class="lineno"></span><span class="op" id="4827545">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4827548">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4827627">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4827673">func</span>&nbsp;<span class="op" id="4827678">(</span><span class="ident" id="4827679">b</span>&nbsp;<span class="ident" id="4827681">BitString</span><span class="op" id="4827690">)</span>&nbsp;<span class="ident" id="4827692">RightAlign</span><span class="op" id="4827702">(</span><span class="op" id="4827703">)</span>&nbsp;<span class="op" id="4827705">[</span><span class="op" id="4827706">]</span><span class="builtintype" id="4827707">byte</span>&nbsp;<span class="op" id="4827712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827715">shift</span>&nbsp;<span class="op" id="4827721">:=</span>&nbsp;<span class="builtintype" id="4827724">uint</span><span class="op" id="4827728">(</span><span class="num" id="4827729">8</span>&nbsp;<span class="op" id="4827731">-</span>&nbsp;<span class="op" id="4827733">(</span><span class="ident" id="4827734">b</span><span class="op" id="4827735">.</span><span class="ident" id="4827736">BitLength</span>&nbsp;<span class="op" id="4827746">%</span>&nbsp;<span class="num" id="4827748">8</span><span class="op" id="4827749">)</span><span class="op" id="4827750">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827753">if</span>&nbsp;<span class="ident" id="4827756">shift</span>&nbsp;<span class="op" id="4827762">==</span>&nbsp;<span class="num" id="4827765">8</span>&nbsp;<span class="op" id="4827767">||</span>&nbsp;<span class="builtinfunc" id="4827770">len</span><span class="op" id="4827773">(</span><span class="ident" id="4827774">b</span><span class="op" id="4827775">.</span><span class="ident" id="4827776">Bytes</span><span class="op" id="4827781">)</span>&nbsp;<span class="op" id="4827783">==</span>&nbsp;<span class="num" id="4827786">0</span>&nbsp;<span class="op" id="4827788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827792">return</span>&nbsp;<span class="ident" id="4827799">b</span><span class="op" id="4827800">.</span><span class="ident" id="4827801">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827812">a</span>&nbsp;<span class="op" id="4827814">:=</span>&nbsp;<span class="builtinfunc" id="4827817">make</span><span class="op" id="4827821">(</span><span class="op" id="4827822">[</span><span class="op" id="4827823">]</span><span class="builtintype" id="4827824">byte</span><span class="op" id="4827828">,</span>&nbsp;<span class="builtinfunc" id="4827830">len</span><span class="op" id="4827833">(</span><span class="ident" id="4827834">b</span><span class="op" id="4827835">.</span><span class="ident" id="4827836">Bytes</span><span class="op" id="4827841">)</span><span class="op" id="4827842">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827845">a</span><span class="op" id="4827846">[</span><span class="num" id="4827847">0</span><span class="op" id="4827848">]</span>&nbsp;<span class="op" id="4827850">=</span>&nbsp;<span class="ident" id="4827852">b</span><span class="op" id="4827853">.</span><span class="ident" id="4827854">Bytes</span><span class="op" id="4827859">[</span><span class="num" id="4827860">0</span><span class="op" id="4827861">]</span>&nbsp;<span class="op" id="4827863">&gt;&gt;</span>&nbsp;<span class="ident" id="4827866">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827873">for</span>&nbsp;<span class="ident" id="4827877">i</span>&nbsp;<span class="op" id="4827879">:=</span>&nbsp;<span class="num" id="4827882">1</span><span class="op" id="4827883">;</span>&nbsp;<span class="ident" id="4827885">i</span>&nbsp;<span class="op" id="4827887">&lt;</span>&nbsp;<span class="builtinfunc" id="4827889">len</span><span class="op" id="4827892">(</span><span class="ident" id="4827893">b</span><span class="op" id="4827894">.</span><span class="ident" id="4827895">Bytes</span><span class="op" id="4827900">)</span><span class="op" id="4827901">;</span>&nbsp;<span class="ident" id="4827903">i</span><span class="op" id="4827904">++</span>&nbsp;<span class="op" id="4827907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827911">a</span><span class="op" id="4827912">[</span><span class="ident" id="4827913">i</span><span class="op" id="4827914">]</span>&nbsp;<span class="op" id="4827916">=</span>&nbsp;<span class="ident" id="4827918">b</span><span class="op" id="4827919">.</span><span class="ident" id="4827920">Bytes</span><span class="op" id="4827925">[</span><span class="ident" id="4827926">i</span><span class="op" id="4827927">-</span><span class="num" id="4827928">1</span><span class="op" id="4827929">]</span>&nbsp;<span class="op" id="4827931">&lt;&lt;</span>&nbsp;<span class="op" id="4827934">(</span><span class="num" id="4827935">8</span>&nbsp;<span class="op" id="4827937">-</span>&nbsp;<span class="ident" id="4827939">shift</span><span class="op" id="4827944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827948">a</span><span class="op" id="4827949">[</span><span class="ident" id="4827950">i</span><span class="op" id="4827951">]</span>&nbsp;<span class="op" id="4827953">|=</span>&nbsp;<span class="ident" id="4827956">b</span><span class="op" id="4827957">.</span><span class="ident" id="4827958">Bytes</span><span class="op" id="4827963">[</span><span class="ident" id="4827964">i</span><span class="op" id="4827965">]</span>&nbsp;<span class="op" id="4827967">&gt;&gt;</span>&nbsp;<span class="ident" id="4827970">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827977">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827981">return</span>&nbsp;<span class="ident" id="4827988">a</span><br>
<span class="lineno"></span><span class="op" id="4827990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4827993">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4828080">func</span>&nbsp;<span class="ident" id="4828085">parseBitString</span><span class="op" id="4828099">(</span><span class="ident" id="4828100">bytes</span>&nbsp;<span class="op" id="4828106">[</span><span class="op" id="4828107">]</span><span class="builtintype" id="4828108">byte</span><span class="op" id="4828112">)</span>&nbsp;<span class="op" id="4828114">(</span><span class="ident" id="4828115">ret</span>&nbsp;<span class="ident" id="4828119">BitString</span><span class="op" id="4828128">,</span>&nbsp;<span class="ident" id="4828130">err</span>&nbsp;<span class="builtintype" id="4828134">error</span><span class="op" id="4828139">)</span>&nbsp;<span class="op" id="4828141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828144">if</span>&nbsp;<span class="builtinfunc" id="4828147">len</span><span class="op" id="4828150">(</span><span class="ident" id="4828151">bytes</span><span class="op" id="4828156">)</span>&nbsp;<span class="op" id="4828158">==</span>&nbsp;<span class="num" id="4828161">0</span>&nbsp;<span class="op" id="4828163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828167">err</span>&nbsp;<span class="op" id="4828171">=</span>&nbsp;<span class="ident" id="4828173">SyntaxError</span><span class="op" id="4828184">{</span><span class="string" id="4828185">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4828209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828213">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828221">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828224">paddingBits</span>&nbsp;<span class="op" id="4828236">:=</span>&nbsp;<span class="builtintype" id="4828239">int</span><span class="op" id="4828242">(</span><span class="ident" id="4828243">bytes</span><span class="op" id="4828248">[</span><span class="num" id="4828249">0</span><span class="op" id="4828250">]</span><span class="op" id="4828251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828254">if</span>&nbsp;<span class="ident" id="4828257">paddingBits</span>&nbsp;<span class="op" id="4828269">&gt;</span>&nbsp;<span class="num" id="4828271">7</span>&nbsp;<span class="op" id="4828273">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4828278">len</span><span class="op" id="4828281">(</span><span class="ident" id="4828282">bytes</span><span class="op" id="4828287">)</span>&nbsp;<span class="op" id="4828289">==</span>&nbsp;<span class="num" id="4828292">1</span>&nbsp;<span class="op" id="4828294">&amp;&amp;</span>&nbsp;<span class="ident" id="4828297">paddingBits</span>&nbsp;<span class="op" id="4828309">&gt;</span>&nbsp;<span class="num" id="4828311">0</span>&nbsp;<span class="op" id="4828313">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828318">bytes</span><span class="op" id="4828323">[</span><span class="builtinfunc" id="4828324">len</span><span class="op" id="4828327">(</span><span class="ident" id="4828328">bytes</span><span class="op" id="4828333">)</span><span class="op" id="4828334">-</span><span class="num" id="4828335">1</span><span class="op" id="4828336">]</span><span class="op" id="4828337">&amp;</span><span class="op" id="4828338">(</span><span class="op" id="4828339">(</span><span class="num" id="4828340">1</span><span class="op" id="4828341">&lt;&lt;</span><span class="ident" id="4828343">bytes</span><span class="op" id="4828348">[</span><span class="num" id="4828349">0</span><span class="op" id="4828350">]</span><span class="op" id="4828351">)</span><span class="op" id="4828352">-</span><span class="num" id="4828353">1</span><span class="op" id="4828354">)</span>&nbsp;<span class="op" id="4828356">!=</span>&nbsp;<span class="num" id="4828359">0</span>&nbsp;<span class="op" id="4828361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828365">err</span>&nbsp;<span class="op" id="4828369">=</span>&nbsp;<span class="ident" id="4828371">SyntaxError</span><span class="op" id="4828382">{</span><span class="string" id="4828383">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4828419">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828423">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828434">ret</span><span class="op" id="4828437">.</span><span class="ident" id="4828438">BitLength</span>&nbsp;<span class="op" id="4828448">=</span>&nbsp;<span class="op" id="4828450">(</span><span class="builtinfunc" id="4828451">len</span><span class="op" id="4828454">(</span><span class="ident" id="4828455">bytes</span><span class="op" id="4828460">)</span><span class="op" id="4828461">-</span><span class="num" id="4828462">1</span><span class="op" id="4828463">)</span><span class="op" id="4828464">*</span><span class="num" id="4828465">8</span>&nbsp;<span class="op" id="4828467">-</span>&nbsp;<span class="ident" id="4828469">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828482">ret</span><span class="op" id="4828485">.</span><span class="ident" id="4828486">Bytes</span>&nbsp;<span class="op" id="4828492">=</span>&nbsp;<span class="ident" id="4828494">bytes</span><span class="op" id="4828499">[</span><span class="num" id="4828500">1</span><span class="op" id="4828501">:</span><span class="op" id="4828502">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828505">return</span><br>
<span class="lineno">180</span><span class="op" id="4828512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828515">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828537">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4828599">type</span>&nbsp;<span class="ident" id="4828604">ObjectIdentifier</span>&nbsp;<span class="op" id="4828621">[</span><span class="op" id="4828622">]</span><span class="builtintype" id="4828623">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828628">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4828697">func</span>&nbsp;<span class="op" id="4828702">(</span><span class="ident" id="4828703">oi</span>&nbsp;<span class="ident" id="4828706">ObjectIdentifier</span><span class="op" id="4828722">)</span>&nbsp;<span class="ident" id="4828724">Equal</span><span class="op" id="4828729">(</span><span class="ident" id="4828730">other</span>&nbsp;<span class="ident" id="4828736">ObjectIdentifier</span><span class="op" id="4828752">)</span>&nbsp;<span class="builtintype" id="4828754">bool</span>&nbsp;<span class="op" id="4828759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828762">if</span>&nbsp;<span class="builtinfunc" id="4828765">len</span><span class="op" id="4828768">(</span><span class="ident" id="4828769">oi</span><span class="op" id="4828771">)</span>&nbsp;<span class="op" id="4828773">!=</span>&nbsp;<span class="builtinfunc" id="4828776">len</span><span class="op" id="4828779">(</span><span class="ident" id="4828780">other</span><span class="op" id="4828785">)</span>&nbsp;<span class="op" id="4828787">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828791">return</span>&nbsp;<span class="builtintype" id="4828798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828808">for</span>&nbsp;<span class="ident" id="4828812">i</span>&nbsp;<span class="op" id="4828814">:=</span>&nbsp;<span class="num" id="4828817">0</span><span class="op" id="4828818">;</span>&nbsp;<span class="ident" id="4828820">i</span>&nbsp;<span class="op" id="4828822">&lt;</span>&nbsp;<span class="builtinfunc" id="4828824">len</span><span class="op" id="4828827">(</span><span class="ident" id="4828828">oi</span><span class="op" id="4828830">)</span><span class="op" id="4828831">;</span>&nbsp;<span class="ident" id="4828833">i</span><span class="op" id="4828834">++</span>&nbsp;<span class="op" id="4828837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828841">if</span>&nbsp;<span class="ident" id="4828844">oi</span><span class="op" id="4828846">[</span><span class="ident" id="4828847">i</span><span class="op" id="4828848">]</span>&nbsp;<span class="op" id="4828850">!=</span>&nbsp;<span class="ident" id="4828853">other</span><span class="op" id="4828858">[</span><span class="ident" id="4828859">i</span><span class="op" id="4828860">]</span>&nbsp;<span class="op" id="4828862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828867">return</span>&nbsp;<span class="builtintype" id="4828874">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828889">return</span>&nbsp;<span class="builtintype" id="4828896">true</span><br>
<span class="lineno"></span><span class="op" id="4828901">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4828904">func</span>&nbsp;<span class="op" id="4828909">(</span><span class="ident" id="4828910">oi</span>&nbsp;<span class="ident" id="4828913">ObjectIdentifier</span><span class="op" id="4828929">)</span>&nbsp;<span class="ident" id="4828931">String</span><span class="op" id="4828937">(</span><span class="op" id="4828938">)</span>&nbsp;<span class="builtintype" id="4828940">string</span>&nbsp;<span class="op" id="4828947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828950">var</span>&nbsp;<span class="ident" id="4828954">s</span>&nbsp;<span class="builtintype" id="4828956">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828965">for</span>&nbsp;<span class="ident" id="4828969">i</span><span class="op" id="4828970">,</span>&nbsp;<span class="ident" id="4828972">v</span>&nbsp;<span class="op" id="4828974">:=</span>&nbsp;<span class="keyword" id="4828977">range</span>&nbsp;<span class="ident" id="4828983">oi</span>&nbsp;<span class="op" id="4828986">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828990">if</span>&nbsp;<span class="ident" id="4828993">i</span>&nbsp;<span class="op" id="4828995">&gt;</span>&nbsp;<span class="num" id="4828997">0</span>&nbsp;<span class="op" id="4828999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829004">s</span>&nbsp;<span class="op" id="4829006">+=</span>&nbsp;<span class="string" id="4829009">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829019">s</span>&nbsp;<span class="op" id="4829021">+=</span>&nbsp;<span class="ident" id="4829024">strconv</span><span class="op" id="4829031">.</span><span class="ident" id="4829032">Itoa</span><span class="op" id="4829036">(</span><span class="ident" id="4829037">v</span><span class="op" id="4829038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829041">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829045">return</span>&nbsp;<span class="ident" id="4829052">s</span><br>
<span class="lineno"></span><span class="op" id="4829054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4829057">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4829135">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4829213">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4829250">func</span>&nbsp;<span class="ident" id="4829255">parseObjectIdentifier</span><span class="op" id="4829276">(</span><span class="ident" id="4829277">bytes</span>&nbsp;<span class="op" id="4829283">[</span><span class="op" id="4829284">]</span><span class="builtintype" id="4829285">byte</span><span class="op" id="4829289">)</span>&nbsp;<span class="op" id="4829291">(</span><span class="ident" id="4829292">s</span>&nbsp;<span class="op" id="4829294">[</span><span class="op" id="4829295">]</span><span class="builtintype" id="4829296">int</span><span class="op" id="4829299">,</span>&nbsp;<span class="ident" id="4829301">err</span>&nbsp;<span class="builtintype" id="4829305">error</span><span class="op" id="4829310">)</span>&nbsp;<span class="op" id="4829312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829315">if</span>&nbsp;<span class="builtinfunc" id="4829318">len</span><span class="op" id="4829321">(</span><span class="ident" id="4829322">bytes</span><span class="op" id="4829327">)</span>&nbsp;<span class="op" id="4829329">==</span>&nbsp;<span class="num" id="4829332">0</span>&nbsp;<span class="op" id="4829334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829338">err</span>&nbsp;<span class="op" id="4829342">=</span>&nbsp;<span class="ident" id="4829344">SyntaxError</span><span class="op" id="4829355">{</span><span class="string" id="4829356">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4829387">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829391">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829403">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829476">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829546">s</span>&nbsp;<span class="op" id="4829548">=</span>&nbsp;<span class="builtinfunc" id="4829550">make</span><span class="op" id="4829554">(</span><span class="op" id="4829555">[</span><span class="op" id="4829556">]</span><span class="builtintype" id="4829557">int</span><span class="op" id="4829560">,</span>&nbsp;<span class="builtinfunc" id="4829562">len</span><span class="op" id="4829565">(</span><span class="ident" id="4829566">bytes</span><span class="op" id="4829571">)</span><span class="op" id="4829572">+</span><span class="num" id="4829573">1</span><span class="op" id="4829574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829578">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829622">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829697">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829771">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829817">v</span><span class="op" id="4829818">,</span>&nbsp;<span class="ident" id="4829820">offset</span><span class="op" id="4829826">,</span>&nbsp;<span class="ident" id="4829828">err</span>&nbsp;<span class="op" id="4829832">:=</span>&nbsp;<span class="ident" id="4829835">parseBase128Int</span><span class="op" id="4829850">(</span><span class="ident" id="4829851">bytes</span><span class="op" id="4829856">,</span>&nbsp;<span class="num" id="4829858">0</span><span class="op" id="4829859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829862">if</span>&nbsp;<span class="ident" id="4829865">err</span>&nbsp;<span class="op" id="4829869">!=</span>&nbsp;<span class="ident" id="4829872">nil</span>&nbsp;<span class="op" id="4829876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829880">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829888">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829891">if</span>&nbsp;<span class="ident" id="4829894">v</span>&nbsp;<span class="op" id="4829896">&lt;</span>&nbsp;<span class="num" id="4829898">80</span>&nbsp;<span class="op" id="4829901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829905">s</span><span class="op" id="4829906">[</span><span class="num" id="4829907">0</span><span class="op" id="4829908">]</span>&nbsp;<span class="op" id="4829910">=</span>&nbsp;<span class="ident" id="4829912">v</span>&nbsp;<span class="op" id="4829914">/</span>&nbsp;<span class="num" id="4829916">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829921">s</span><span class="op" id="4829922">[</span><span class="num" id="4829923">1</span><span class="op" id="4829924">]</span>&nbsp;<span class="op" id="4829926">=</span>&nbsp;<span class="ident" id="4829928">v</span>&nbsp;<span class="op" id="4829930">%</span>&nbsp;<span class="num" id="4829932">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829936">}</span>&nbsp;<span class="keyword" id="4829938">else</span>&nbsp;<span class="op" id="4829943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829947">s</span><span class="op" id="4829948">[</span><span class="num" id="4829949">0</span><span class="op" id="4829950">]</span>&nbsp;<span class="op" id="4829952">=</span>&nbsp;<span class="num" id="4829954">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829958">s</span><span class="op" id="4829959">[</span><span class="num" id="4829960">1</span><span class="op" id="4829961">]</span>&nbsp;<span class="op" id="4829963">=</span>&nbsp;<span class="ident" id="4829965">v</span>&nbsp;<span class="op" id="4829967">-</span>&nbsp;<span class="num" id="4829969">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829977">i</span>&nbsp;<span class="op" id="4829979">:=</span>&nbsp;<span class="num" id="4829982">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829985">for</span>&nbsp;<span class="op" id="4829989">;</span>&nbsp;<span class="ident" id="4829991">offset</span>&nbsp;<span class="op" id="4829998">&lt;</span>&nbsp;<span class="builtinfunc" id="4830000">len</span><span class="op" id="4830003">(</span><span class="ident" id="4830004">bytes</span><span class="op" id="4830009">)</span><span class="op" id="4830010">;</span>&nbsp;<span class="ident" id="4830012">i</span><span class="op" id="4830013">++</span>&nbsp;<span class="op" id="4830016">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830020">v</span><span class="op" id="4830021">,</span>&nbsp;<span class="ident" id="4830023">offset</span><span class="op" id="4830029">,</span>&nbsp;<span class="ident" id="4830031">err</span>&nbsp;<span class="op" id="4830035">=</span>&nbsp;<span class="ident" id="4830037">parseBase128Int</span><span class="op" id="4830052">(</span><span class="ident" id="4830053">bytes</span><span class="op" id="4830058">,</span>&nbsp;<span class="ident" id="4830060">offset</span><span class="op" id="4830066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830070">if</span>&nbsp;<span class="ident" id="4830073">err</span>&nbsp;<span class="op" id="4830077">!=</span>&nbsp;<span class="ident" id="4830080">nil</span>&nbsp;<span class="op" id="4830084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830089">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830102">s</span><span class="op" id="4830103">[</span><span class="ident" id="4830104">i</span><span class="op" id="4830105">]</span>&nbsp;<span class="op" id="4830107">=</span>&nbsp;<span class="ident" id="4830109">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830115">s</span>&nbsp;<span class="op" id="4830117">=</span>&nbsp;<span class="ident" id="4830119">s</span><span class="op" id="4830120">[</span><span class="num" id="4830121">0</span><span class="op" id="4830122">:</span><span class="ident" id="4830123">i</span><span class="op" id="4830124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830127">return</span><br>
<span class="lineno"></span><span class="op" id="4830134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4830137">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830152">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4830200">type</span>&nbsp;<span class="ident" id="4830205">Enumerated</span>&nbsp;<span class="builtintype" id="4830216">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4830221">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830230">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4830288">type</span>&nbsp;<span class="ident" id="4830293">Flag</span>&nbsp;<span class="builtintype" id="4830298">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4830304">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4830382">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4830444">func</span>&nbsp;<span class="ident" id="4830449">parseBase128Int</span><span class="op" id="4830464">(</span><span class="ident" id="4830465">bytes</span>&nbsp;<span class="op" id="4830471">[</span><span class="op" id="4830472">]</span><span class="builtintype" id="4830473">byte</span><span class="op" id="4830477">,</span>&nbsp;<span class="ident" id="4830479">initOffset</span>&nbsp;<span class="builtintype" id="4830490">int</span><span class="op" id="4830493">)</span>&nbsp;<span class="op" id="4830495">(</span><span class="ident" id="4830496">ret</span><span class="op" id="4830499">,</span>&nbsp;<span class="ident" id="4830501">offset</span>&nbsp;<span class="builtintype" id="4830508">int</span><span class="op" id="4830511">,</span>&nbsp;<span class="ident" id="4830513">err</span>&nbsp;<span class="builtintype" id="4830517">error</span><span class="op" id="4830522">)</span>&nbsp;<span class="op" id="4830524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830527">offset</span>&nbsp;<span class="op" id="4830534">=</span>&nbsp;<span class="ident" id="4830536">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830548">for</span>&nbsp;<span class="ident" id="4830552">shifted</span>&nbsp;<span class="op" id="4830560">:=</span>&nbsp;<span class="num" id="4830563">0</span><span class="op" id="4830564">;</span>&nbsp;<span class="ident" id="4830566">offset</span>&nbsp;<span class="op" id="4830573">&lt;</span>&nbsp;<span class="builtinfunc" id="4830575">len</span><span class="op" id="4830578">(</span><span class="ident" id="4830579">bytes</span><span class="op" id="4830584">)</span><span class="op" id="4830585">;</span>&nbsp;<span class="ident" id="4830587">shifted</span><span class="op" id="4830594">++</span>&nbsp;<span class="op" id="4830597">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830601">if</span>&nbsp;<span class="ident" id="4830604">shifted</span>&nbsp;<span class="op" id="4830612">&gt;</span>&nbsp;<span class="num" id="4830614">4</span>&nbsp;<span class="op" id="4830616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830621">err</span>&nbsp;<span class="op" id="4830625">=</span>&nbsp;<span class="ident" id="4830627">StructuralError</span><span class="op" id="4830642">{</span><span class="string" id="4830643">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4830671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830689">ret</span>&nbsp;<span class="op" id="4830693">&lt;&lt;=</span>&nbsp;<span class="num" id="4830697">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830701">b</span>&nbsp;<span class="op" id="4830703">:=</span>&nbsp;<span class="ident" id="4830706">bytes</span><span class="op" id="4830711">[</span><span class="ident" id="4830712">offset</span><span class="op" id="4830718">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830722">ret</span>&nbsp;<span class="op" id="4830726">|=</span>&nbsp;<span class="builtintype" id="4830729">int</span><span class="op" id="4830732">(</span><span class="ident" id="4830733">b</span>&nbsp;<span class="op" id="4830735">&amp;</span>&nbsp;<span class="num" id="4830737">0x7f</span><span class="op" id="4830741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830745">offset</span><span class="op" id="4830751">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830756">if</span>&nbsp;<span class="ident" id="4830759">b</span><span class="op" id="4830760">&amp;</span><span class="num" id="4830761">0x80</span>&nbsp;<span class="op" id="4830766">==</span>&nbsp;<span class="num" id="4830769">0</span>&nbsp;<span class="op" id="4830771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830776">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830791">err</span>&nbsp;<span class="op" id="4830795">=</span>&nbsp;<span class="ident" id="4830797">SyntaxError</span><span class="op" id="4830808">{</span><span class="string" id="4830809">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4830837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830840">return</span><br>
<span class="lineno"></span><span class="op" id="4830847">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4830850">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4830862">func</span>&nbsp;<span class="ident" id="4830867">parseUTCTime</span><span class="op" id="4830879">(</span><span class="ident" id="4830880">bytes</span>&nbsp;<span class="op" id="4830886">[</span><span class="op" id="4830887">]</span><span class="builtintype" id="4830888">byte</span><span class="op" id="4830892">)</span>&nbsp;<span class="op" id="4830894">(</span><span class="ident" id="4830895">ret</span>&nbsp;<span class="ident" id="4830899">time</span><span class="op" id="4830903">.</span><span class="ident" id="4830904">Time</span><span class="op" id="4830908">,</span>&nbsp;<span class="ident" id="4830910">err</span>&nbsp;<span class="builtintype" id="4830914">error</span><span class="op" id="4830919">)</span>&nbsp;<span class="op" id="4830921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830924">s</span>&nbsp;<span class="op" id="4830926">:=</span>&nbsp;<span class="builtintype" id="4830929">string</span><span class="op" id="4830935">(</span><span class="ident" id="4830936">bytes</span><span class="op" id="4830941">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830944">ret</span><span class="op" id="4830947">,</span>&nbsp;<span class="ident" id="4830949">err</span>&nbsp;<span class="op" id="4830953">=</span>&nbsp;<span class="ident" id="4830955">time</span><span class="op" id="4830959">.</span><span class="ident" id="4830960">Parse</span><span class="op" id="4830965">(</span><span class="string" id="4830966">&#34;0601021504Z0700&#34;</span><span class="op" id="4830983">,</span>&nbsp;<span class="ident" id="4830985">s</span><span class="op" id="4830986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830989">if</span>&nbsp;<span class="ident" id="4830992">err</span>&nbsp;<span class="op" id="4830996">!=</span>&nbsp;<span class="ident" id="4830999">nil</span>&nbsp;<span class="op" id="4831003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831007">ret</span><span class="op" id="4831010">,</span>&nbsp;<span class="ident" id="4831012">err</span>&nbsp;<span class="op" id="4831016">=</span>&nbsp;<span class="ident" id="4831018">time</span><span class="op" id="4831022">.</span><span class="ident" id="4831023">Parse</span><span class="op" id="4831028">(</span><span class="string" id="4831029">&#34;060102150405Z0700&#34;</span><span class="op" id="4831048">,</span>&nbsp;<span class="ident" id="4831050">s</span><span class="op" id="4831051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831057">if</span>&nbsp;<span class="ident" id="4831060">err</span>&nbsp;<span class="op" id="4831064">==</span>&nbsp;<span class="ident" id="4831067">nil</span>&nbsp;<span class="op" id="4831071">&amp;&amp;</span>&nbsp;<span class="ident" id="4831074">ret</span><span class="op" id="4831077">.</span><span class="ident" id="4831078">Year</span><span class="op" id="4831082">(</span><span class="op" id="4831083">)</span>&nbsp;<span class="op" id="4831085">&gt;=</span>&nbsp;<span class="num" id="4831088">2050</span>&nbsp;<span class="op" id="4831093">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4831097">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831202">ret</span>&nbsp;<span class="op" id="4831206">=</span>&nbsp;<span class="ident" id="4831208">ret</span><span class="op" id="4831211">.</span><span class="ident" id="4831212">AddDate</span><span class="op" id="4831219">(</span><span class="op" id="4831220">-</span><span class="num" id="4831221">100</span><span class="op" id="4831224">,</span>&nbsp;<span class="num" id="4831226">0</span><span class="op" id="4831227">,</span>&nbsp;<span class="num" id="4831229">0</span><span class="op" id="4831230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831237">return</span><br>
<span class="lineno">300</span><span class="op" id="4831244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4831247">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4831324">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4831359">func</span>&nbsp;<span class="ident" id="4831364">parseGeneralizedTime</span><span class="op" id="4831384">(</span><span class="ident" id="4831385">bytes</span>&nbsp;<span class="op" id="4831391">[</span><span class="op" id="4831392">]</span><span class="builtintype" id="4831393">byte</span><span class="op" id="4831397">)</span>&nbsp;<span class="op" id="4831399">(</span><span class="ident" id="4831400">ret</span>&nbsp;<span class="ident" id="4831404">time</span><span class="op" id="4831408">.</span><span class="ident" id="4831409">Time</span><span class="op" id="4831413">,</span>&nbsp;<span class="ident" id="4831415">err</span>&nbsp;<span class="builtintype" id="4831419">error</span><span class="op" id="4831424">)</span>&nbsp;<span class="op" id="4831426">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831429">return</span>&nbsp;<span class="ident" id="4831436">time</span><span class="op" id="4831440">.</span><span class="ident" id="4831441">Parse</span><span class="op" id="4831446">(</span><span class="string" id="4831447">&#34;20060102150405Z0700&#34;</span><span class="op" id="4831468">,</span>&nbsp;<span class="builtintype" id="4831470">string</span><span class="op" id="4831476">(</span><span class="ident" id="4831477">bytes</span><span class="op" id="4831482">)</span><span class="op" id="4831483">)</span><br>
<span class="lineno"></span><span class="op" id="4831485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4831488">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4831508">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4831583">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4831608">func</span>&nbsp;<span class="ident" id="4831613">parsePrintableString</span><span class="op" id="4831633">(</span><span class="ident" id="4831634">bytes</span>&nbsp;<span class="op" id="4831640">[</span><span class="op" id="4831641">]</span><span class="builtintype" id="4831642">byte</span><span class="op" id="4831646">)</span>&nbsp;<span class="op" id="4831648">(</span><span class="ident" id="4831649">ret</span>&nbsp;<span class="builtintype" id="4831653">string</span><span class="op" id="4831659">,</span>&nbsp;<span class="ident" id="4831661">err</span>&nbsp;<span class="builtintype" id="4831665">error</span><span class="op" id="4831670">)</span>&nbsp;<span class="op" id="4831672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831675">for</span>&nbsp;<span class="ident" id="4831679">_</span><span class="op" id="4831680">,</span>&nbsp;<span class="ident" id="4831682">b</span>&nbsp;<span class="op" id="4831684">:=</span>&nbsp;<span class="keyword" id="4831687">range</span>&nbsp;<span class="ident" id="4831693">bytes</span>&nbsp;<span class="op" id="4831699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831703">if</span>&nbsp;<span class="op" id="4831706">!</span><span class="ident" id="4831707">isPrintable</span><span class="op" id="4831718">(</span><span class="ident" id="4831719">b</span><span class="op" id="4831720">)</span>&nbsp;<span class="op" id="4831722">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831727">err</span>&nbsp;<span class="op" id="4831731">=</span>&nbsp;<span class="ident" id="4831733">SyntaxError</span><span class="op" id="4831744">{</span><span class="string" id="4831745">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4831789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831794">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831809">ret</span>&nbsp;<span class="op" id="4831813">=</span>&nbsp;<span class="builtintype" id="4831815">string</span><span class="op" id="4831821">(</span><span class="ident" id="4831822">bytes</span><span class="op" id="4831827">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831830">return</span><br>
<span class="lineno"></span><span class="op" id="4831837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4831840">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4831921">func</span>&nbsp;<span class="ident" id="4831926">isPrintable</span><span class="op" id="4831937">(</span><span class="ident" id="4831938">b</span>&nbsp;<span class="builtintype" id="4831940">byte</span><span class="op" id="4831944">)</span>&nbsp;<span class="builtintype" id="4831946">bool</span>&nbsp;<span class="op" id="4831951">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831954">return</span>&nbsp;<span class="string" id="4831961">&#39;a&#39;</span>&nbsp;<span class="op" id="4831965">&lt;=</span>&nbsp;<span class="ident" id="4831968">b</span>&nbsp;<span class="op" id="4831970">&amp;&amp;</span>&nbsp;<span class="ident" id="4831973">b</span>&nbsp;<span class="op" id="4831975">&lt;=</span>&nbsp;<span class="string" id="4831978">&#39;z&#39;</span>&nbsp;<span class="op" id="4831982">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4831987">&#39;A&#39;</span>&nbsp;<span class="op" id="4831991">&lt;=</span>&nbsp;<span class="ident" id="4831994">b</span>&nbsp;<span class="op" id="4831996">&amp;&amp;</span>&nbsp;<span class="ident" id="4831999">b</span>&nbsp;<span class="op" id="4832001">&lt;=</span>&nbsp;<span class="string" id="4832004">&#39;Z&#39;</span>&nbsp;<span class="op" id="4832008">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4832013">&#39;0&#39;</span>&nbsp;<span class="op" id="4832017">&lt;=</span>&nbsp;<span class="ident" id="4832020">b</span>&nbsp;<span class="op" id="4832022">&amp;&amp;</span>&nbsp;<span class="ident" id="4832025">b</span>&nbsp;<span class="op" id="4832027">&lt;=</span>&nbsp;<span class="string" id="4832030">&#39;9&#39;</span>&nbsp;<span class="op" id="4832034">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4832039">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4832044">&lt;=</span>&nbsp;<span class="ident" id="4832047">b</span>&nbsp;<span class="op" id="4832049">&amp;&amp;</span>&nbsp;<span class="ident" id="4832052">b</span>&nbsp;<span class="op" id="4832054">&lt;=</span>&nbsp;<span class="string" id="4832057">&#39;)&#39;</span>&nbsp;<span class="op" id="4832061">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4832066">&#39;+&#39;</span>&nbsp;<span class="op" id="4832070">&lt;=</span>&nbsp;<span class="ident" id="4832073">b</span>&nbsp;<span class="op" id="4832075">&amp;&amp;</span>&nbsp;<span class="ident" id="4832078">b</span>&nbsp;<span class="op" id="4832080">&lt;=</span>&nbsp;<span class="string" id="4832083">&#39;/&#39;</span>&nbsp;<span class="op" id="4832087">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832092">b</span>&nbsp;<span class="op" id="4832094">==</span>&nbsp;<span class="string" id="4832097">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4832101">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832106">b</span>&nbsp;<span class="op" id="4832108">==</span>&nbsp;<span class="string" id="4832111">&#39;:&#39;</span>&nbsp;<span class="op" id="4832115">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832120">b</span>&nbsp;<span class="op" id="4832122">==</span>&nbsp;<span class="string" id="4832125">&#39;=&#39;</span>&nbsp;<span class="op" id="4832129">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832134">b</span>&nbsp;<span class="op" id="4832136">==</span>&nbsp;<span class="string" id="4832139">&#39;?&#39;</span>&nbsp;<span class="op" id="4832143">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4832148">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4832207">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4832267">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832324">b</span>&nbsp;<span class="op" id="4832326">==</span>&nbsp;<span class="string" id="4832329">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4832333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4832336">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4832350">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4832423">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4832453">func</span>&nbsp;<span class="ident" id="4832458">parseIA5String</span><span class="op" id="4832472">(</span><span class="ident" id="4832473">bytes</span>&nbsp;<span class="op" id="4832479">[</span><span class="op" id="4832480">]</span><span class="builtintype" id="4832481">byte</span><span class="op" id="4832485">)</span>&nbsp;<span class="op" id="4832487">(</span><span class="ident" id="4832488">ret</span>&nbsp;<span class="builtintype" id="4832492">string</span><span class="op" id="4832498">,</span>&nbsp;<span class="ident" id="4832500">err</span>&nbsp;<span class="builtintype" id="4832504">error</span><span class="op" id="4832509">)</span>&nbsp;<span class="op" id="4832511">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4832514">for</span>&nbsp;<span class="ident" id="4832518">_</span><span class="op" id="4832519">,</span>&nbsp;<span class="ident" id="4832521">b</span>&nbsp;<span class="op" id="4832523">:=</span>&nbsp;<span class="keyword" id="4832526">range</span>&nbsp;<span class="ident" id="4832532">bytes</span>&nbsp;<span class="op" id="4832538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4832542">if</span>&nbsp;<span class="ident" id="4832545">b</span>&nbsp;<span class="op" id="4832547">&gt;=</span>&nbsp;<span class="num" id="4832550">0x80</span>&nbsp;<span class="op" id="4832555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832560">err</span>&nbsp;<span class="op" id="4832564">=</span>&nbsp;<span class="ident" id="4832566">SyntaxError</span><span class="op" id="4832577">{</span><span class="string" id="4832578">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4832616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4832621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4832630">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4832633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4832636">ret</span>&nbsp;<span class="op" id="4832640">=</span>&nbsp;<span class="builtintype" id="4832642">string</span><span class="op" id="4832648">(</span><span class="ident" id="4832649">bytes</span><span class="op" id="4832654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4832657">return</span><br>
<span class="lineno"></span><span class="op" id="4832664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4832667">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4832681">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4832760">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4832790">func</span>&nbsp;<span class="ident" id="4832795">parseT61String</span><span class="op" id="4832809">(</span><span class="ident" id="4832810">bytes</span>&nbsp;<span class="op" id="4832816">[</span><span class="op" id="4832817">]</span><span class="builtintype" id="4832818">byte</span><span class="op" id="4832822">)</span>&nbsp;<span class="op" id="4832824">(</span><span class="ident" id="4832825">ret</span>&nbsp;<span class="builtintype" id="4832829">string</span><span class="op" id="4832835">,</span>&nbsp;<span class="ident" id="4832837">err</span>&nbsp;<span class="builtintype" id="4832841">error</span><span class="op" id="4832846">)</span>&nbsp;<span class="op" id="4832848">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4832851">return</span>&nbsp;<span class="builtintype" id="4832858">string</span><span class="op" id="4832864">(</span><span class="ident" id="4832865">bytes</span><span class="op" id="4832870">)</span><span class="op" id="4832871">,</span>&nbsp;<span class="ident" id="4832873">nil</span><br>
<span class="lineno"></span><span class="op" id="4832877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4832880">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4832895">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4832972">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4832997">func</span>&nbsp;<span class="ident" id="4833002">parseUTF8String</span><span class="op" id="4833017">(</span><span class="ident" id="4833018">bytes</span>&nbsp;<span class="op" id="4833024">[</span><span class="op" id="4833025">]</span><span class="builtintype" id="4833026">byte</span><span class="op" id="4833030">)</span>&nbsp;<span class="op" id="4833032">(</span><span class="ident" id="4833033">ret</span>&nbsp;<span class="builtintype" id="4833037">string</span><span class="op" id="4833043">,</span>&nbsp;<span class="ident" id="4833045">err</span>&nbsp;<span class="builtintype" id="4833049">error</span><span class="op" id="4833054">)</span>&nbsp;<span class="op" id="4833056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4833059">return</span>&nbsp;<span class="builtintype" id="4833066">string</span><span class="op" id="4833072">(</span><span class="ident" id="4833073">bytes</span><span class="op" id="4833078">)</span><span class="op" id="4833079">,</span>&nbsp;<span class="ident" id="4833081">nil</span><br>
<span class="lineno"></span><span class="op" id="4833085">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4833088">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4833140">type</span>&nbsp;<span class="ident" id="4833145">RawValue</span>&nbsp;<span class="keyword" id="4833154">struct</span>&nbsp;<span class="op" id="4833161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833164">Class</span><span class="op" id="4833169">,</span>&nbsp;<span class="ident" id="4833171">Tag</span>&nbsp;<span class="builtintype" id="4833175">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833180">IsCompound</span>&nbsp;<span class="builtintype" id="4833191">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833197">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4833208">[</span><span class="op" id="4833209">]</span><span class="builtintype" id="4833210">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833216">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4833227">[</span><span class="op" id="4833228">]</span><span class="builtintype" id="4833229">byte</span>&nbsp;<span class="comment" id="4833234">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4833265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4833268">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4833341">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4833419">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4833494">type</span>&nbsp;<span class="ident" id="4833499">RawContent</span>&nbsp;<span class="op" id="4833510">[</span><span class="op" id="4833511">]</span><span class="builtintype" id="4833512">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4833518">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4833530">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4833609">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4833686">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4833762">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4833835">func</span>&nbsp;<span class="ident" id="4833840">parseTagAndLength</span><span class="op" id="4833857">(</span><span class="ident" id="4833858">bytes</span>&nbsp;<span class="op" id="4833864">[</span><span class="op" id="4833865">]</span><span class="builtintype" id="4833866">byte</span><span class="op" id="4833870">,</span>&nbsp;<span class="ident" id="4833872">initOffset</span>&nbsp;<span class="builtintype" id="4833883">int</span><span class="op" id="4833886">)</span>&nbsp;<span class="op" id="4833888">(</span><span class="ident" id="4833889">ret</span>&nbsp;<span class="ident" id="4833893">tagAndLength</span><span class="op" id="4833905">,</span>&nbsp;<span class="ident" id="4833907">offset</span>&nbsp;<span class="builtintype" id="4833914">int</span><span class="op" id="4833917">,</span>&nbsp;<span class="ident" id="4833919">err</span>&nbsp;<span class="builtintype" id="4833923">error</span><span class="op" id="4833928">)</span>&nbsp;<span class="op" id="4833930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833933">offset</span>&nbsp;<span class="op" id="4833940">=</span>&nbsp;<span class="ident" id="4833942">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833954">b</span>&nbsp;<span class="op" id="4833956">:=</span>&nbsp;<span class="ident" id="4833959">bytes</span><span class="op" id="4833964">[</span><span class="ident" id="4833965">offset</span><span class="op" id="4833971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833974">offset</span><span class="op" id="4833980">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4833984">ret</span><span class="op" id="4833987">.</span><span class="ident" id="4833988">class</span>&nbsp;<span class="op" id="4833994">=</span>&nbsp;<span class="builtintype" id="4833996">int</span><span class="op" id="4833999">(</span><span class="ident" id="4834000">b</span>&nbsp;<span class="op" id="4834002">&gt;&gt;</span>&nbsp;<span class="num" id="4834005">6</span><span class="op" id="4834006">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834009">ret</span><span class="op" id="4834012">.</span><span class="ident" id="4834013">isCompound</span>&nbsp;<span class="op" id="4834024">=</span>&nbsp;<span class="ident" id="4834026">b</span><span class="op" id="4834027">&amp;</span><span class="num" id="4834028">0x20</span>&nbsp;<span class="op" id="4834033">==</span>&nbsp;<span class="num" id="4834036">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834042">ret</span><span class="op" id="4834045">.</span><span class="ident" id="4834046">tag</span>&nbsp;<span class="op" id="4834050">=</span>&nbsp;<span class="builtintype" id="4834052">int</span><span class="op" id="4834055">(</span><span class="ident" id="4834056">b</span>&nbsp;<span class="op" id="4834058">&amp;</span>&nbsp;<span class="num" id="4834060">0x1f</span><span class="op" id="4834064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834068">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834146">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834169">if</span>&nbsp;<span class="ident" id="4834172">ret</span><span class="op" id="4834175">.</span><span class="ident" id="4834176">tag</span>&nbsp;<span class="op" id="4834180">==</span>&nbsp;<span class="num" id="4834183">0x1f</span>&nbsp;<span class="op" id="4834188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834192">ret</span><span class="op" id="4834195">.</span><span class="ident" id="4834196">tag</span><span class="op" id="4834199">,</span>&nbsp;<span class="ident" id="4834201">offset</span><span class="op" id="4834207">,</span>&nbsp;<span class="ident" id="4834209">err</span>&nbsp;<span class="op" id="4834213">=</span>&nbsp;<span class="ident" id="4834215">parseBase128Int</span><span class="op" id="4834230">(</span><span class="ident" id="4834231">bytes</span><span class="op" id="4834236">,</span>&nbsp;<span class="ident" id="4834238">offset</span><span class="op" id="4834244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834248">if</span>&nbsp;<span class="ident" id="4834251">err</span>&nbsp;<span class="op" id="4834255">!=</span>&nbsp;<span class="ident" id="4834258">nil</span>&nbsp;<span class="op" id="4834262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834267">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834276">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834282">if</span>&nbsp;<span class="ident" id="4834285">offset</span>&nbsp;<span class="op" id="4834292">&gt;=</span>&nbsp;<span class="builtinfunc" id="4834295">len</span><span class="op" id="4834298">(</span><span class="ident" id="4834299">bytes</span><span class="op" id="4834304">)</span>&nbsp;<span class="op" id="4834306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834310">err</span>&nbsp;<span class="op" id="4834314">=</span>&nbsp;<span class="ident" id="4834316">SyntaxError</span><span class="op" id="4834327">{</span><span class="string" id="4834328">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4834353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834357">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834365">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834368">b</span>&nbsp;<span class="op" id="4834370">=</span>&nbsp;<span class="ident" id="4834372">bytes</span><span class="op" id="4834377">[</span><span class="ident" id="4834378">offset</span><span class="op" id="4834384">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834387">offset</span><span class="op" id="4834393">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834397">if</span>&nbsp;<span class="ident" id="4834400">b</span><span class="op" id="4834401">&amp;</span><span class="num" id="4834402">0x80</span>&nbsp;<span class="op" id="4834407">==</span>&nbsp;<span class="num" id="4834410">0</span>&nbsp;<span class="op" id="4834412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834416">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834465">ret</span><span class="op" id="4834468">.</span><span class="ident" id="4834469">length</span>&nbsp;<span class="op" id="4834476">=</span>&nbsp;<span class="builtintype" id="4834478">int</span><span class="op" id="4834481">(</span><span class="ident" id="4834482">b</span>&nbsp;<span class="op" id="4834484">&amp;</span>&nbsp;<span class="num" id="4834486">0x7f</span><span class="op" id="4834490">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834493">}</span>&nbsp;<span class="keyword" id="4834495">else</span>&nbsp;<span class="op" id="4834500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834504">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834566">numBytes</span>&nbsp;<span class="op" id="4834575">:=</span>&nbsp;<span class="builtintype" id="4834578">int</span><span class="op" id="4834581">(</span><span class="ident" id="4834582">b</span>&nbsp;<span class="op" id="4834584">&amp;</span>&nbsp;<span class="num" id="4834586">0x7f</span><span class="op" id="4834590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834594">if</span>&nbsp;<span class="ident" id="4834597">numBytes</span>&nbsp;<span class="op" id="4834606">==</span>&nbsp;<span class="num" id="4834609">0</span>&nbsp;<span class="op" id="4834611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834616">err</span>&nbsp;<span class="op" id="4834620">=</span>&nbsp;<span class="ident" id="4834622">SyntaxError</span><span class="op" id="4834633">{</span><span class="string" id="4834634">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4834669">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834687">ret</span><span class="op" id="4834690">.</span><span class="ident" id="4834691">length</span>&nbsp;<span class="op" id="4834698">=</span>&nbsp;<span class="num" id="4834700">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834704">for</span>&nbsp;<span class="ident" id="4834708">i</span>&nbsp;<span class="op" id="4834710">:=</span>&nbsp;<span class="num" id="4834713">0</span><span class="op" id="4834714">;</span>&nbsp;<span class="ident" id="4834716">i</span>&nbsp;<span class="op" id="4834718">&lt;</span>&nbsp;<span class="ident" id="4834720">numBytes</span><span class="op" id="4834728">;</span>&nbsp;<span class="ident" id="4834730">i</span><span class="op" id="4834731">++</span>&nbsp;<span class="op" id="4834734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834739">if</span>&nbsp;<span class="ident" id="4834742">offset</span>&nbsp;<span class="op" id="4834749">&gt;=</span>&nbsp;<span class="builtinfunc" id="4834752">len</span><span class="op" id="4834755">(</span><span class="ident" id="4834756">bytes</span><span class="op" id="4834761">)</span>&nbsp;<span class="op" id="4834763">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834769">err</span>&nbsp;<span class="op" id="4834773">=</span>&nbsp;<span class="ident" id="4834775">SyntaxError</span><span class="op" id="4834786">{</span><span class="string" id="4834787">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4834812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4834828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834833">b</span>&nbsp;<span class="op" id="4834835">=</span>&nbsp;<span class="ident" id="4834837">bytes</span><span class="op" id="4834842">[</span><span class="ident" id="4834843">offset</span><span class="op" id="4834849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834854">offset</span><span class="op" id="4834860">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4834866">if</span>&nbsp;<span class="ident" id="4834869">ret</span><span class="op" id="4834872">.</span><span class="ident" id="4834873">length</span>&nbsp;<span class="op" id="4834880">&gt;=</span>&nbsp;<span class="num" id="4834883">1</span><span class="op" id="4834884">&lt;&lt;</span><span class="num" id="4834886">23</span>&nbsp;<span class="op" id="4834889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834895">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4834939">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4834959">err</span>&nbsp;<span class="op" id="4834963">=</span>&nbsp;<span class="ident" id="4834965">StructuralError</span><span class="op" id="4834980">{</span><span class="string" id="4834981">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4834999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835005">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835020">ret</span><span class="op" id="4835023">.</span><span class="ident" id="4835024">length</span>&nbsp;<span class="op" id="4835031">&lt;&lt;=</span>&nbsp;<span class="num" id="4835035">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835040">ret</span><span class="op" id="4835043">.</span><span class="ident" id="4835044">length</span>&nbsp;<span class="op" id="4835051">|=</span>&nbsp;<span class="builtintype" id="4835054">int</span><span class="op" id="4835057">(</span><span class="ident" id="4835058">b</span><span class="op" id="4835059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835064">if</span>&nbsp;<span class="ident" id="4835067">ret</span><span class="op" id="4835070">.</span><span class="ident" id="4835071">length</span>&nbsp;<span class="op" id="4835078">==</span>&nbsp;<span class="num" id="4835081">0</span>&nbsp;<span class="op" id="4835083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835089">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835134">err</span>&nbsp;<span class="op" id="4835138">=</span>&nbsp;<span class="ident" id="4835140">StructuralError</span><span class="op" id="4835155">{</span><span class="string" id="4835156">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4835193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835199">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835216">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835220">return</span><br>
<span class="lineno"></span><span class="op" id="4835227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4835230">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4835310">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4835386">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4835427">func</span>&nbsp;<span class="ident" id="4835432">parseSequenceOf</span><span class="op" id="4835447">(</span><span class="ident" id="4835448">bytes</span>&nbsp;<span class="op" id="4835454">[</span><span class="op" id="4835455">]</span><span class="builtintype" id="4835456">byte</span><span class="op" id="4835460">,</span>&nbsp;<span class="ident" id="4835462">sliceType</span>&nbsp;<span class="ident" id="4835472">reflect</span><span class="op" id="4835479">.</span><span class="ident" id="4835480">Type</span><span class="op" id="4835484">,</span>&nbsp;<span class="ident" id="4835486">elemType</span>&nbsp;<span class="ident" id="4835495">reflect</span><span class="op" id="4835502">.</span><span class="ident" id="4835503">Type</span><span class="op" id="4835507">)</span>&nbsp;<span class="op" id="4835509">(</span><span class="ident" id="4835510">ret</span>&nbsp;<span class="ident" id="4835514">reflect</span><span class="op" id="4835521">.</span><span class="ident" id="4835522">Value</span><span class="op" id="4835527">,</span>&nbsp;<span class="ident" id="4835529">err</span>&nbsp;<span class="builtintype" id="4835533">error</span><span class="op" id="4835538">)</span>&nbsp;<span class="op" id="4835540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835543">expectedTag</span><span class="op" id="4835554">,</span>&nbsp;<span class="ident" id="4835556">compoundType</span><span class="op" id="4835568">,</span>&nbsp;<span class="ident" id="4835570">ok</span>&nbsp;<span class="op" id="4835573">:=</span>&nbsp;<span class="ident" id="4835576">getUniversalType</span><span class="op" id="4835592">(</span><span class="ident" id="4835593">elemType</span><span class="op" id="4835601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835604">if</span>&nbsp;<span class="op" id="4835607">!</span><span class="ident" id="4835608">ok</span>&nbsp;<span class="op" id="4835611">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835615">err</span>&nbsp;<span class="op" id="4835619">=</span>&nbsp;<span class="ident" id="4835621">StructuralError</span><span class="op" id="4835636">{</span><span class="string" id="4835637">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4835664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835668">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835680">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4835750">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835804">numElements</span>&nbsp;<span class="op" id="4835816">:=</span>&nbsp;<span class="num" id="4835819">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835822">for</span>&nbsp;<span class="ident" id="4835826">offset</span>&nbsp;<span class="op" id="4835833">:=</span>&nbsp;<span class="num" id="4835836">0</span><span class="op" id="4835837">;</span>&nbsp;<span class="ident" id="4835839">offset</span>&nbsp;<span class="op" id="4835846">&lt;</span>&nbsp;<span class="builtinfunc" id="4835848">len</span><span class="op" id="4835851">(</span><span class="ident" id="4835852">bytes</span><span class="op" id="4835857">)</span><span class="op" id="4835858">;</span>&nbsp;<span class="op" id="4835860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835864">var</span>&nbsp;<span class="ident" id="4835868">t</span>&nbsp;<span class="ident" id="4835870">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4835885">t</span><span class="op" id="4835886">,</span>&nbsp;<span class="ident" id="4835888">offset</span><span class="op" id="4835894">,</span>&nbsp;<span class="ident" id="4835896">err</span>&nbsp;<span class="op" id="4835900">=</span>&nbsp;<span class="ident" id="4835902">parseTagAndLength</span><span class="op" id="4835919">(</span><span class="ident" id="4835920">bytes</span><span class="op" id="4835925">,</span>&nbsp;<span class="ident" id="4835927">offset</span><span class="op" id="4835933">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835937">if</span>&nbsp;<span class="ident" id="4835940">err</span>&nbsp;<span class="op" id="4835944">!=</span>&nbsp;<span class="ident" id="4835947">nil</span>&nbsp;<span class="op" id="4835951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835956">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4835965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835969">switch</span>&nbsp;<span class="ident" id="4835976">t</span><span class="op" id="4835977">.</span><span class="ident" id="4835978">tag</span>&nbsp;<span class="op" id="4835982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4835986">case</span>&nbsp;<span class="ident" id="4835991">tagIA5String</span><span class="op" id="4836003">,</span>&nbsp;<span class="ident" id="4836005">tagGeneralString</span><span class="op" id="4836021">,</span>&nbsp;<span class="ident" id="4836023">tagT61String</span><span class="op" id="4836035">,</span>&nbsp;<span class="ident" id="4836037">tagUTF8String</span><span class="op" id="4836050">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4836055">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4836108">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4836166">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836196">t</span><span class="op" id="4836197">.</span><span class="ident" id="4836198">tag</span>&nbsp;<span class="op" id="4836202">=</span>&nbsp;<span class="ident" id="4836204">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836225">case</span>&nbsp;<span class="ident" id="4836230">tagGeneralizedTime</span><span class="op" id="4836248">,</span>&nbsp;<span class="ident" id="4836250">tagUTCTime</span><span class="op" id="4836260">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4836265">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836319">t</span><span class="op" id="4836320">.</span><span class="ident" id="4836321">tag</span>&nbsp;<span class="op" id="4836325">=</span>&nbsp;<span class="ident" id="4836327">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836345">if</span>&nbsp;<span class="ident" id="4836348">t</span><span class="op" id="4836349">.</span><span class="ident" id="4836350">class</span>&nbsp;<span class="op" id="4836356">!=</span>&nbsp;<span class="ident" id="4836359">classUniversal</span>&nbsp;<span class="op" id="4836374">||</span>&nbsp;<span class="ident" id="4836377">t</span><span class="op" id="4836378">.</span><span class="ident" id="4836379">isCompound</span>&nbsp;<span class="op" id="4836390">!=</span>&nbsp;<span class="ident" id="4836393">compoundType</span>&nbsp;<span class="op" id="4836406">||</span>&nbsp;<span class="ident" id="4836409">t</span><span class="op" id="4836410">.</span><span class="ident" id="4836411">tag</span>&nbsp;<span class="op" id="4836415">!=</span>&nbsp;<span class="ident" id="4836418">expectedTag</span>&nbsp;<span class="op" id="4836430">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836435">err</span>&nbsp;<span class="op" id="4836439">=</span>&nbsp;<span class="ident" id="4836441">StructuralError</span><span class="op" id="4836456">{</span><span class="string" id="4836457">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4836480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836485">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836498">if</span>&nbsp;<span class="ident" id="4836501">invalidLength</span><span class="op" id="4836514">(</span><span class="ident" id="4836515">offset</span><span class="op" id="4836521">,</span>&nbsp;<span class="ident" id="4836523">t</span><span class="op" id="4836524">.</span><span class="ident" id="4836525">length</span><span class="op" id="4836531">,</span>&nbsp;<span class="builtinfunc" id="4836533">len</span><span class="op" id="4836536">(</span><span class="ident" id="4836537">bytes</span><span class="op" id="4836542">)</span><span class="op" id="4836543">)</span>&nbsp;<span class="op" id="4836545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836550">err</span>&nbsp;<span class="op" id="4836554">=</span>&nbsp;<span class="ident" id="4836556">SyntaxError</span><span class="op" id="4836567">{</span><span class="string" id="4836568">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4836588">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836593">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836606">offset</span>&nbsp;<span class="op" id="4836613">+=</span>&nbsp;<span class="ident" id="4836616">t</span><span class="op" id="4836617">.</span><span class="ident" id="4836618">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836627">numElements</span><span class="op" id="4836638">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836642">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836645">ret</span>&nbsp;<span class="op" id="4836649">=</span>&nbsp;<span class="ident" id="4836651">reflect</span><span class="op" id="4836658">.</span><span class="ident" id="4836659">MakeSlice</span><span class="op" id="4836668">(</span><span class="ident" id="4836669">sliceType</span><span class="op" id="4836678">,</span>&nbsp;<span class="ident" id="4836680">numElements</span><span class="op" id="4836691">,</span>&nbsp;<span class="ident" id="4836693">numElements</span><span class="op" id="4836704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836707">params</span>&nbsp;<span class="op" id="4836714">:=</span>&nbsp;<span class="ident" id="4836717">fieldParameters</span><span class="op" id="4836732">{</span><span class="op" id="4836733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836736">offset</span>&nbsp;<span class="op" id="4836743">:=</span>&nbsp;<span class="num" id="4836746">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836749">for</span>&nbsp;<span class="ident" id="4836753">i</span>&nbsp;<span class="op" id="4836755">:=</span>&nbsp;<span class="num" id="4836758">0</span><span class="op" id="4836759">;</span>&nbsp;<span class="ident" id="4836761">i</span>&nbsp;<span class="op" id="4836763">&lt;</span>&nbsp;<span class="ident" id="4836765">numElements</span><span class="op" id="4836776">;</span>&nbsp;<span class="ident" id="4836778">i</span><span class="op" id="4836779">++</span>&nbsp;<span class="op" id="4836782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836786">offset</span><span class="op" id="4836792">,</span>&nbsp;<span class="ident" id="4836794">err</span>&nbsp;<span class="op" id="4836798">=</span>&nbsp;<span class="ident" id="4836800">parseField</span><span class="op" id="4836810">(</span><span class="ident" id="4836811">ret</span><span class="op" id="4836814">.</span><span class="ident" id="4836815">Index</span><span class="op" id="4836820">(</span><span class="ident" id="4836821">i</span><span class="op" id="4836822">)</span><span class="op" id="4836823">,</span>&nbsp;<span class="ident" id="4836825">bytes</span><span class="op" id="4836830">,</span>&nbsp;<span class="ident" id="4836832">offset</span><span class="op" id="4836838">,</span>&nbsp;<span class="ident" id="4836840">params</span><span class="op" id="4836846">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836850">if</span>&nbsp;<span class="ident" id="4836853">err</span>&nbsp;<span class="op" id="4836857">!=</span>&nbsp;<span class="ident" id="4836860">nil</span>&nbsp;<span class="op" id="4836864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836869">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4836881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4836884">return</span><br>
<span class="lineno">500</span><span class="op" id="4836891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4836894">var</span>&nbsp;<span class="op" id="4836898">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836901">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836922">=</span>&nbsp;<span class="ident" id="4836924">reflect</span><span class="op" id="4836931">.</span><span class="ident" id="4836932">TypeOf</span><span class="op" id="4836938">(</span><span class="ident" id="4836939">BitString</span><span class="op" id="4836948">{</span><span class="op" id="4836949">}</span><span class="op" id="4836950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4836953">objectIdentifierType</span>&nbsp;<span class="op" id="4836974">=</span>&nbsp;<span class="ident" id="4836976">reflect</span><span class="op" id="4836983">.</span><span class="ident" id="4836984">TypeOf</span><span class="op" id="4836990">(</span><span class="ident" id="4836991">ObjectIdentifier</span><span class="op" id="4837007">{</span><span class="op" id="4837008">}</span><span class="op" id="4837009">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837012">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837033">=</span>&nbsp;<span class="ident" id="4837035">reflect</span><span class="op" id="4837042">.</span><span class="ident" id="4837043">TypeOf</span><span class="op" id="4837049">(</span><span class="ident" id="4837050">Enumerated</span><span class="op" id="4837060">(</span><span class="num" id="4837061">0</span><span class="op" id="4837062">)</span><span class="op" id="4837063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837066">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837087">=</span>&nbsp;<span class="ident" id="4837089">reflect</span><span class="op" id="4837096">.</span><span class="ident" id="4837097">TypeOf</span><span class="op" id="4837103">(</span><span class="ident" id="4837104">Flag</span><span class="op" id="4837108">(</span><span class="builtintype" id="4837109">false</span><span class="op" id="4837114">)</span><span class="op" id="4837115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837118">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837139">=</span>&nbsp;<span class="ident" id="4837141">reflect</span><span class="op" id="4837148">.</span><span class="ident" id="4837149">TypeOf</span><span class="op" id="4837155">(</span><span class="ident" id="4837156">time</span><span class="op" id="4837160">.</span><span class="ident" id="4837161">Time</span><span class="op" id="4837165">{</span><span class="op" id="4837166">}</span><span class="op" id="4837167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837170">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837191">=</span>&nbsp;<span class="ident" id="4837193">reflect</span><span class="op" id="4837200">.</span><span class="ident" id="4837201">TypeOf</span><span class="op" id="4837207">(</span><span class="ident" id="4837208">RawValue</span><span class="op" id="4837216">{</span><span class="op" id="4837217">}</span><span class="op" id="4837218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837221">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837242">=</span>&nbsp;<span class="ident" id="4837244">reflect</span><span class="op" id="4837251">.</span><span class="ident" id="4837252">TypeOf</span><span class="op" id="4837258">(</span><span class="ident" id="4837259">RawContent</span><span class="op" id="4837269">(</span><span class="ident" id="4837270">nil</span><span class="op" id="4837273">)</span><span class="op" id="4837274">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837277">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837298">=</span>&nbsp;<span class="ident" id="4837300">reflect</span><span class="op" id="4837307">.</span><span class="ident" id="4837308">TypeOf</span><span class="op" id="4837314">(</span><span class="builtinfunc" id="4837315">new</span><span class="op" id="4837318">(</span><span class="ident" id="4837319">big</span><span class="op" id="4837322">.</span><span class="ident" id="4837323">Int</span><span class="op" id="4837326">)</span><span class="op" id="4837327">)</span><br>
<span class="lineno"></span><span class="op" id="4837329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4837332">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4837407">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4837435">func</span>&nbsp;<span class="ident" id="4837440">invalidLength</span><span class="op" id="4837453">(</span><span class="ident" id="4837454">offset</span><span class="op" id="4837460">,</span>&nbsp;<span class="ident" id="4837462">length</span><span class="op" id="4837468">,</span>&nbsp;<span class="ident" id="4837470">sliceLength</span>&nbsp;<span class="builtintype" id="4837482">int</span><span class="op" id="4837485">)</span>&nbsp;<span class="builtintype" id="4837487">bool</span>&nbsp;<span class="op" id="4837492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4837495">return</span>&nbsp;<span class="ident" id="4837502">offset</span><span class="op" id="4837508">+</span><span class="ident" id="4837509">length</span>&nbsp;<span class="op" id="4837516">&lt;</span>&nbsp;<span class="ident" id="4837518">offset</span>&nbsp;<span class="op" id="4837525">||</span>&nbsp;<span class="ident" id="4837528">offset</span><span class="op" id="4837534">+</span><span class="ident" id="4837535">length</span>&nbsp;<span class="op" id="4837542">&gt;</span>&nbsp;<span class="ident" id="4837544">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4837556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4837559">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4837636">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4837716">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4837739">func</span>&nbsp;<span class="ident" id="4837744">parseField</span><span class="op" id="4837754">(</span><span class="ident" id="4837755">v</span>&nbsp;<span class="ident" id="4837757">reflect</span><span class="op" id="4837764">.</span><span class="ident" id="4837765">Value</span><span class="op" id="4837770">,</span>&nbsp;<span class="ident" id="4837772">bytes</span>&nbsp;<span class="op" id="4837778">[</span><span class="op" id="4837779">]</span><span class="builtintype" id="4837780">byte</span><span class="op" id="4837784">,</span>&nbsp;<span class="ident" id="4837786">initOffset</span>&nbsp;<span class="builtintype" id="4837797">int</span><span class="op" id="4837800">,</span>&nbsp;<span class="ident" id="4837802">params</span>&nbsp;<span class="ident" id="4837809">fieldParameters</span><span class="op" id="4837824">)</span>&nbsp;<span class="op" id="4837826">(</span><span class="ident" id="4837827">offset</span>&nbsp;<span class="builtintype" id="4837834">int</span><span class="op" id="4837837">,</span>&nbsp;<span class="ident" id="4837839">err</span>&nbsp;<span class="builtintype" id="4837843">error</span><span class="op" id="4837848">)</span>&nbsp;<span class="op" id="4837850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837853">offset</span>&nbsp;<span class="op" id="4837860">=</span>&nbsp;<span class="ident" id="4837862">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4837874">fieldType</span>&nbsp;<span class="op" id="4837884">:=</span>&nbsp;<span class="ident" id="4837887">v</span><span class="op" id="4837888">.</span><span class="ident" id="4837889">Type</span><span class="op" id="4837893">(</span><span class="op" id="4837894">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4837898">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4837985">if</span>&nbsp;<span class="ident" id="4837988">offset</span>&nbsp;<span class="op" id="4837995">==</span>&nbsp;<span class="builtinfunc" id="4837998">len</span><span class="op" id="4838001">(</span><span class="ident" id="4838002">bytes</span><span class="op" id="4838007">)</span>&nbsp;<span class="op" id="4838009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838013">if</span>&nbsp;<span class="op" id="4838016">!</span><span class="ident" id="4838017">setDefaultValue</span><span class="op" id="4838032">(</span><span class="ident" id="4838033">v</span><span class="op" id="4838034">,</span>&nbsp;<span class="ident" id="4838036">params</span><span class="op" id="4838042">)</span>&nbsp;<span class="op" id="4838044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838049">err</span>&nbsp;<span class="op" id="4838053">=</span>&nbsp;<span class="ident" id="4838055">SyntaxError</span><span class="op" id="4838066">{</span><span class="string" id="4838067">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4838087">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838095">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4838107">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838133">if</span>&nbsp;<span class="ident" id="4838136">fieldType</span>&nbsp;<span class="op" id="4838146">==</span>&nbsp;<span class="ident" id="4838149">rawValueType</span>&nbsp;<span class="op" id="4838162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838166">var</span>&nbsp;<span class="ident" id="4838170">t</span>&nbsp;<span class="ident" id="4838172">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838187">t</span><span class="op" id="4838188">,</span>&nbsp;<span class="ident" id="4838190">offset</span><span class="op" id="4838196">,</span>&nbsp;<span class="ident" id="4838198">err</span>&nbsp;<span class="op" id="4838202">=</span>&nbsp;<span class="ident" id="4838204">parseTagAndLength</span><span class="op" id="4838221">(</span><span class="ident" id="4838222">bytes</span><span class="op" id="4838227">,</span>&nbsp;<span class="ident" id="4838229">offset</span><span class="op" id="4838235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838239">if</span>&nbsp;<span class="ident" id="4838242">err</span>&nbsp;<span class="op" id="4838246">!=</span>&nbsp;<span class="ident" id="4838249">nil</span>&nbsp;<span class="op" id="4838253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838258">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838271">if</span>&nbsp;<span class="ident" id="4838274">invalidLength</span><span class="op" id="4838287">(</span><span class="ident" id="4838288">offset</span><span class="op" id="4838294">,</span>&nbsp;<span class="ident" id="4838296">t</span><span class="op" id="4838297">.</span><span class="ident" id="4838298">length</span><span class="op" id="4838304">,</span>&nbsp;<span class="builtinfunc" id="4838306">len</span><span class="op" id="4838309">(</span><span class="ident" id="4838310">bytes</span><span class="op" id="4838315">)</span><span class="op" id="4838316">)</span>&nbsp;<span class="op" id="4838318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838323">err</span>&nbsp;<span class="op" id="4838327">=</span>&nbsp;<span class="ident" id="4838329">SyntaxError</span><span class="op" id="4838340">{</span><span class="string" id="4838341">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4838357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838362">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838371">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838375">result</span>&nbsp;<span class="op" id="4838382">:=</span>&nbsp;<span class="ident" id="4838385">RawValue</span><span class="op" id="4838393">{</span><span class="ident" id="4838394">t</span><span class="op" id="4838395">.</span><span class="ident" id="4838396">class</span><span class="op" id="4838401">,</span>&nbsp;<span class="ident" id="4838403">t</span><span class="op" id="4838404">.</span><span class="ident" id="4838405">tag</span><span class="op" id="4838408">,</span>&nbsp;<span class="ident" id="4838410">t</span><span class="op" id="4838411">.</span><span class="ident" id="4838412">isCompound</span><span class="op" id="4838422">,</span>&nbsp;<span class="ident" id="4838424">bytes</span><span class="op" id="4838429">[</span><span class="ident" id="4838430">offset</span>&nbsp;<span class="op" id="4838437">:</span>&nbsp;<span class="ident" id="4838439">offset</span><span class="op" id="4838445">+</span><span class="ident" id="4838446">t</span><span class="op" id="4838447">.</span><span class="ident" id="4838448">length</span><span class="op" id="4838454">]</span><span class="op" id="4838455">,</span>&nbsp;<span class="ident" id="4838457">bytes</span><span class="op" id="4838462">[</span><span class="ident" id="4838463">initOffset</span>&nbsp;<span class="op" id="4838474">:</span>&nbsp;<span class="ident" id="4838476">offset</span><span class="op" id="4838482">+</span><span class="ident" id="4838483">t</span><span class="op" id="4838484">.</span><span class="ident" id="4838485">length</span><span class="op" id="4838491">]</span><span class="op" id="4838492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838496">offset</span>&nbsp;<span class="op" id="4838503">+=</span>&nbsp;<span class="ident" id="4838506">t</span><span class="op" id="4838507">.</span><span class="ident" id="4838508">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838517">v</span><span class="op" id="4838518">.</span><span class="ident" id="4838519">Set</span><span class="op" id="4838522">(</span><span class="ident" id="4838523">reflect</span><span class="op" id="4838530">.</span><span class="ident" id="4838531">ValueOf</span><span class="op" id="4838538">(</span><span class="ident" id="4838539">result</span><span class="op" id="4838545">)</span><span class="op" id="4838546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838550">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838558">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4838562">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838590">if</span>&nbsp;<span class="ident" id="4838593">ifaceType</span>&nbsp;<span class="op" id="4838603">:=</span>&nbsp;<span class="ident" id="4838606">fieldType</span><span class="op" id="4838615">;</span>&nbsp;<span class="ident" id="4838617">ifaceType</span><span class="op" id="4838626">.</span><span class="ident" id="4838627">Kind</span><span class="op" id="4838631">(</span><span class="op" id="4838632">)</span>&nbsp;<span class="op" id="4838634">==</span>&nbsp;<span class="ident" id="4838637">reflect</span><span class="op" id="4838644">.</span><span class="ident" id="4838645">Interface</span>&nbsp;<span class="op" id="4838655">&amp;&amp;</span>&nbsp;<span class="ident" id="4838658">ifaceType</span><span class="op" id="4838667">.</span><span class="ident" id="4838668">NumMethod</span><span class="op" id="4838677">(</span><span class="op" id="4838678">)</span>&nbsp;<span class="op" id="4838680">==</span>&nbsp;<span class="num" id="4838683">0</span>&nbsp;<span class="op" id="4838685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838689">var</span>&nbsp;<span class="ident" id="4838693">t</span>&nbsp;<span class="ident" id="4838695">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838710">t</span><span class="op" id="4838711">,</span>&nbsp;<span class="ident" id="4838713">offset</span><span class="op" id="4838719">,</span>&nbsp;<span class="ident" id="4838721">err</span>&nbsp;<span class="op" id="4838725">=</span>&nbsp;<span class="ident" id="4838727">parseTagAndLength</span><span class="op" id="4838744">(</span><span class="ident" id="4838745">bytes</span><span class="op" id="4838750">,</span>&nbsp;<span class="ident" id="4838752">offset</span><span class="op" id="4838758">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838762">if</span>&nbsp;<span class="ident" id="4838765">err</span>&nbsp;<span class="op" id="4838769">!=</span>&nbsp;<span class="ident" id="4838772">nil</span>&nbsp;<span class="op" id="4838776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838794">if</span>&nbsp;<span class="ident" id="4838797">invalidLength</span><span class="op" id="4838810">(</span><span class="ident" id="4838811">offset</span><span class="op" id="4838817">,</span>&nbsp;<span class="ident" id="4838819">t</span><span class="op" id="4838820">.</span><span class="ident" id="4838821">length</span><span class="op" id="4838827">,</span>&nbsp;<span class="builtinfunc" id="4838829">len</span><span class="op" id="4838832">(</span><span class="ident" id="4838833">bytes</span><span class="op" id="4838838">)</span><span class="op" id="4838839">)</span>&nbsp;<span class="op" id="4838841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838846">err</span>&nbsp;<span class="op" id="4838850">=</span>&nbsp;<span class="ident" id="4838852">SyntaxError</span><span class="op" id="4838863">{</span><span class="string" id="4838864">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4838880">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4838894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838898">var</span>&nbsp;<span class="ident" id="4838902">result</span>&nbsp;<span class="keyword" id="4838909">interface</span><span class="op" id="4838918">{</span><span class="op" id="4838919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4838923">if</span>&nbsp;<span class="op" id="4838926">!</span><span class="ident" id="4838927">t</span><span class="op" id="4838928">.</span><span class="ident" id="4838929">isCompound</span>&nbsp;<span class="op" id="4838940">&amp;&amp;</span>&nbsp;<span class="ident" id="4838943">t</span><span class="op" id="4838944">.</span><span class="ident" id="4838945">class</span>&nbsp;<span class="op" id="4838951">==</span>&nbsp;<span class="ident" id="4838954">classUniversal</span>&nbsp;<span class="op" id="4838969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4838974">innerBytes</span>&nbsp;<span class="op" id="4838985">:=</span>&nbsp;<span class="ident" id="4838988">bytes</span><span class="op" id="4838993">[</span><span class="ident" id="4838994">offset</span>&nbsp;<span class="op" id="4839001">:</span>&nbsp;<span class="ident" id="4839003">offset</span><span class="op" id="4839009">+</span><span class="ident" id="4839010">t</span><span class="op" id="4839011">.</span><span class="ident" id="4839012">length</span><span class="op" id="4839018">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839023">switch</span>&nbsp;<span class="ident" id="4839030">t</span><span class="op" id="4839031">.</span><span class="ident" id="4839032">tag</span>&nbsp;<span class="op" id="4839036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839041">case</span>&nbsp;<span class="ident" id="4839046">tagPrintableString</span><span class="op" id="4839064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839070">result</span><span class="op" id="4839076">,</span>&nbsp;<span class="ident" id="4839078">err</span>&nbsp;<span class="op" id="4839082">=</span>&nbsp;<span class="ident" id="4839084">parsePrintableString</span><span class="op" id="4839104">(</span><span class="ident" id="4839105">innerBytes</span><span class="op" id="4839115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839120">case</span>&nbsp;<span class="ident" id="4839125">tagIA5String</span><span class="op" id="4839137">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839143">result</span><span class="op" id="4839149">,</span>&nbsp;<span class="ident" id="4839151">err</span>&nbsp;<span class="op" id="4839155">=</span>&nbsp;<span class="ident" id="4839157">parseIA5String</span><span class="op" id="4839171">(</span><span class="ident" id="4839172">innerBytes</span><span class="op" id="4839182">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839187">case</span>&nbsp;<span class="ident" id="4839192">tagT61String</span><span class="op" id="4839204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839210">result</span><span class="op" id="4839216">,</span>&nbsp;<span class="ident" id="4839218">err</span>&nbsp;<span class="op" id="4839222">=</span>&nbsp;<span class="ident" id="4839224">parseT61String</span><span class="op" id="4839238">(</span><span class="ident" id="4839239">innerBytes</span><span class="op" id="4839249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839254">case</span>&nbsp;<span class="ident" id="4839259">tagUTF8String</span><span class="op" id="4839272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839278">result</span><span class="op" id="4839284">,</span>&nbsp;<span class="ident" id="4839286">err</span>&nbsp;<span class="op" id="4839290">=</span>&nbsp;<span class="ident" id="4839292">parseUTF8String</span><span class="op" id="4839307">(</span><span class="ident" id="4839308">innerBytes</span><span class="op" id="4839318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839323">case</span>&nbsp;<span class="ident" id="4839328">tagInteger</span><span class="op" id="4839338">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839344">result</span><span class="op" id="4839350">,</span>&nbsp;<span class="ident" id="4839352">err</span>&nbsp;<span class="op" id="4839356">=</span>&nbsp;<span class="ident" id="4839358">parseInt64</span><span class="op" id="4839368">(</span><span class="ident" id="4839369">innerBytes</span><span class="op" id="4839379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839384">case</span>&nbsp;<span class="ident" id="4839389">tagBitString</span><span class="op" id="4839401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839407">result</span><span class="op" id="4839413">,</span>&nbsp;<span class="ident" id="4839415">err</span>&nbsp;<span class="op" id="4839419">=</span>&nbsp;<span class="ident" id="4839421">parseBitString</span><span class="op" id="4839435">(</span><span class="ident" id="4839436">innerBytes</span><span class="op" id="4839446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839451">case</span>&nbsp;<span class="ident" id="4839456">tagOID</span><span class="op" id="4839462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839468">result</span><span class="op" id="4839474">,</span>&nbsp;<span class="ident" id="4839476">err</span>&nbsp;<span class="op" id="4839480">=</span>&nbsp;<span class="ident" id="4839482">parseObjectIdentifier</span><span class="op" id="4839503">(</span><span class="ident" id="4839504">innerBytes</span><span class="op" id="4839514">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839519">case</span>&nbsp;<span class="ident" id="4839524">tagUTCTime</span><span class="op" id="4839534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839540">result</span><span class="op" id="4839546">,</span>&nbsp;<span class="ident" id="4839548">err</span>&nbsp;<span class="op" id="4839552">=</span>&nbsp;<span class="ident" id="4839554">parseUTCTime</span><span class="op" id="4839566">(</span><span class="ident" id="4839567">innerBytes</span><span class="op" id="4839577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839582">case</span>&nbsp;<span class="ident" id="4839587">tagOctetString</span><span class="op" id="4839601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839607">result</span>&nbsp;<span class="op" id="4839614">=</span>&nbsp;<span class="ident" id="4839616">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839630">default</span><span class="op" id="4839637">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839643">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4839718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4839722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839726">offset</span>&nbsp;<span class="op" id="4839733">+=</span>&nbsp;<span class="ident" id="4839736">t</span><span class="op" id="4839737">.</span><span class="ident" id="4839738">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839747">if</span>&nbsp;<span class="ident" id="4839750">err</span>&nbsp;<span class="op" id="4839754">!=</span>&nbsp;<span class="ident" id="4839757">nil</span>&nbsp;<span class="op" id="4839761">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839766">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4839775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839779">if</span>&nbsp;<span class="ident" id="4839782">result</span>&nbsp;<span class="op" id="4839789">!=</span>&nbsp;<span class="ident" id="4839792">nil</span>&nbsp;<span class="op" id="4839796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839801">v</span><span class="op" id="4839802">.</span><span class="ident" id="4839803">Set</span><span class="op" id="4839806">(</span><span class="ident" id="4839807">reflect</span><span class="op" id="4839814">.</span><span class="ident" id="4839815">ValueOf</span><span class="op" id="4839822">(</span><span class="ident" id="4839823">result</span><span class="op" id="4839829">)</span><span class="op" id="4839830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4839834">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839838">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4839846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839849">universalTag</span><span class="op" id="4839861">,</span>&nbsp;<span class="ident" id="4839863">compoundType</span><span class="op" id="4839875">,</span>&nbsp;<span class="ident" id="4839877">ok1</span>&nbsp;<span class="op" id="4839881">:=</span>&nbsp;<span class="ident" id="4839884">getUniversalType</span><span class="op" id="4839900">(</span><span class="ident" id="4839901">fieldType</span><span class="op" id="4839910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839913">if</span>&nbsp;<span class="op" id="4839916">!</span><span class="ident" id="4839917">ok1</span>&nbsp;<span class="op" id="4839921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839925">err</span>&nbsp;<span class="op" id="4839929">=</span>&nbsp;<span class="ident" id="4839931">StructuralError</span><span class="op" id="4839946">{</span><span class="ident" id="4839947">fmt</span><span class="op" id="4839950">.</span><span class="ident" id="4839951">Sprintf</span><span class="op" id="4839958">(</span><span class="string" id="4839959">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4839980">,</span>&nbsp;<span class="ident" id="4839982">fieldType</span><span class="op" id="4839991">)</span><span class="op" id="4839992">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839996">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840008">t</span><span class="op" id="4840009">,</span>&nbsp;<span class="ident" id="4840011">offset</span><span class="op" id="4840017">,</span>&nbsp;<span class="ident" id="4840019">err</span>&nbsp;<span class="op" id="4840023">:=</span>&nbsp;<span class="ident" id="4840026">parseTagAndLength</span><span class="op" id="4840043">(</span><span class="ident" id="4840044">bytes</span><span class="op" id="4840049">,</span>&nbsp;<span class="ident" id="4840051">offset</span><span class="op" id="4840057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840060">if</span>&nbsp;<span class="ident" id="4840063">err</span>&nbsp;<span class="op" id="4840067">!=</span>&nbsp;<span class="ident" id="4840070">nil</span>&nbsp;<span class="op" id="4840074">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840078">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840089">if</span>&nbsp;<span class="ident" id="4840092">params</span><span class="op" id="4840098">.</span><span class="ident" id="4840099">explicit</span>&nbsp;<span class="op" id="4840108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840112">expectedClass</span>&nbsp;<span class="op" id="4840126">:=</span>&nbsp;<span class="ident" id="4840129">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840152">if</span>&nbsp;<span class="ident" id="4840155">params</span><span class="op" id="4840161">.</span><span class="ident" id="4840162">application</span>&nbsp;<span class="op" id="4840174">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840179">expectedClass</span>&nbsp;<span class="op" id="4840193">=</span>&nbsp;<span class="ident" id="4840195">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840218">if</span>&nbsp;<span class="ident" id="4840221">t</span><span class="op" id="4840222">.</span><span class="ident" id="4840223">class</span>&nbsp;<span class="op" id="4840229">==</span>&nbsp;<span class="ident" id="4840232">expectedClass</span>&nbsp;<span class="op" id="4840246">&amp;&amp;</span>&nbsp;<span class="ident" id="4840249">t</span><span class="op" id="4840250">.</span><span class="ident" id="4840251">tag</span>&nbsp;<span class="op" id="4840255">==</span>&nbsp;<span class="op" id="4840258">*</span><span class="ident" id="4840259">params</span><span class="op" id="4840265">.</span><span class="ident" id="4840266">tag</span>&nbsp;<span class="op" id="4840270">&amp;&amp;</span>&nbsp;<span class="op" id="4840273">(</span><span class="ident" id="4840274">t</span><span class="op" id="4840275">.</span><span class="ident" id="4840276">length</span>&nbsp;<span class="op" id="4840283">==</span>&nbsp;<span class="num" id="4840286">0</span>&nbsp;<span class="op" id="4840288">||</span>&nbsp;<span class="ident" id="4840291">t</span><span class="op" id="4840292">.</span><span class="ident" id="4840293">isCompound</span><span class="op" id="4840303">)</span>&nbsp;<span class="op" id="4840305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840310">if</span>&nbsp;<span class="ident" id="4840313">t</span><span class="op" id="4840314">.</span><span class="ident" id="4840315">length</span>&nbsp;<span class="op" id="4840322">&gt;</span>&nbsp;<span class="num" id="4840324">0</span>&nbsp;<span class="op" id="4840326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840332">t</span><span class="op" id="4840333">,</span>&nbsp;<span class="ident" id="4840335">offset</span><span class="op" id="4840341">,</span>&nbsp;<span class="ident" id="4840343">err</span>&nbsp;<span class="op" id="4840347">=</span>&nbsp;<span class="ident" id="4840349">parseTagAndLength</span><span class="op" id="4840366">(</span><span class="ident" id="4840367">bytes</span><span class="op" id="4840372">,</span>&nbsp;<span class="ident" id="4840374">offset</span><span class="op" id="4840380">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840386">if</span>&nbsp;<span class="ident" id="4840389">err</span>&nbsp;<span class="op" id="4840393">!=</span>&nbsp;<span class="ident" id="4840396">nil</span>&nbsp;<span class="op" id="4840400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840423">}</span>&nbsp;<span class="keyword" id="4840425">else</span>&nbsp;<span class="op" id="4840430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840436">if</span>&nbsp;<span class="ident" id="4840439">fieldType</span>&nbsp;<span class="op" id="4840449">!=</span>&nbsp;<span class="ident" id="4840452">flagType</span>&nbsp;<span class="op" id="4840461">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840468">err</span>&nbsp;<span class="op" id="4840472">=</span>&nbsp;<span class="ident" id="4840474">StructuralError</span><span class="op" id="4840489">{</span><span class="string" id="4840490">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4840537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840561">v</span><span class="op" id="4840562">.</span><span class="ident" id="4840563">SetBool</span><span class="op" id="4840570">(</span><span class="builtintype" id="4840571">true</span><span class="op" id="4840575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840581">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840595">}</span>&nbsp;<span class="keyword" id="4840597">else</span>&nbsp;<span class="op" id="4840602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840607">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840669">ok</span>&nbsp;<span class="op" id="4840672">:=</span>&nbsp;<span class="ident" id="4840675">setDefaultValue</span><span class="op" id="4840690">(</span><span class="ident" id="4840691">v</span><span class="op" id="4840692">,</span>&nbsp;<span class="ident" id="4840694">params</span><span class="op" id="4840700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840705">if</span>&nbsp;<span class="ident" id="4840708">ok</span>&nbsp;<span class="op" id="4840711">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840717">offset</span>&nbsp;<span class="op" id="4840724">=</span>&nbsp;<span class="ident" id="4840726">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840740">}</span>&nbsp;<span class="keyword" id="4840742">else</span>&nbsp;<span class="op" id="4840747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840753">err</span>&nbsp;<span class="op" id="4840757">=</span>&nbsp;<span class="ident" id="4840759">StructuralError</span><span class="op" id="4840774">{</span><span class="string" id="4840775">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4840814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840824">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840840">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840911">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840981">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841052">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841101">if</span>&nbsp;<span class="ident" id="4841104">universalTag</span>&nbsp;<span class="op" id="4841117">==</span>&nbsp;<span class="ident" id="4841120">tagPrintableString</span>&nbsp;<span class="op" id="4841139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841143">if</span>&nbsp;<span class="ident" id="4841146">t</span><span class="op" id="4841147">.</span><span class="ident" id="4841148">class</span>&nbsp;<span class="op" id="4841154">==</span>&nbsp;<span class="ident" id="4841157">classUniversal</span>&nbsp;<span class="op" id="4841172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841177">switch</span>&nbsp;<span class="ident" id="4841184">t</span><span class="op" id="4841185">.</span><span class="ident" id="4841186">tag</span>&nbsp;<span class="op" id="4841190">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841195">case</span>&nbsp;<span class="ident" id="4841200">tagIA5String</span><span class="op" id="4841212">,</span>&nbsp;<span class="ident" id="4841214">tagGeneralString</span><span class="op" id="4841230">,</span>&nbsp;<span class="ident" id="4841232">tagT61String</span><span class="op" id="4841244">,</span>&nbsp;<span class="ident" id="4841246">tagUTF8String</span><span class="op" id="4841259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841265">universalTag</span>&nbsp;<span class="op" id="4841278">=</span>&nbsp;<span class="ident" id="4841280">t</span><span class="op" id="4841281">.</span><span class="ident" id="4841282">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841293">}</span>&nbsp;<span class="keyword" id="4841295">else</span>&nbsp;<span class="keyword" id="4841300">if</span>&nbsp;<span class="ident" id="4841303">params</span><span class="op" id="4841309">.</span><span class="ident" id="4841310">stringType</span>&nbsp;<span class="op" id="4841321">!=</span>&nbsp;<span class="num" id="4841324">0</span>&nbsp;<span class="op" id="4841326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841331">universalTag</span>&nbsp;<span class="op" id="4841344">=</span>&nbsp;<span class="ident" id="4841346">params</span><span class="op" id="4841352">.</span><span class="ident" id="4841353">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841373">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841444">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841467">if</span>&nbsp;<span class="ident" id="4841470">universalTag</span>&nbsp;<span class="op" id="4841483">==</span>&nbsp;<span class="ident" id="4841486">tagUTCTime</span>&nbsp;<span class="op" id="4841497">&amp;&amp;</span>&nbsp;<span class="ident" id="4841500">t</span><span class="op" id="4841501">.</span><span class="ident" id="4841502">tag</span>&nbsp;<span class="op" id="4841506">==</span>&nbsp;<span class="ident" id="4841509">tagGeneralizedTime</span>&nbsp;<span class="op" id="4841528">&amp;&amp;</span>&nbsp;<span class="ident" id="4841531">t</span><span class="op" id="4841532">.</span><span class="ident" id="4841533">class</span>&nbsp;<span class="op" id="4841539">==</span>&nbsp;<span class="ident" id="4841542">classUniversal</span>&nbsp;<span class="op" id="4841557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841561">universalTag</span>&nbsp;<span class="op" id="4841574">=</span>&nbsp;<span class="ident" id="4841576">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841600">if</span>&nbsp;<span class="ident" id="4841603">params</span><span class="op" id="4841609">.</span><span class="ident" id="4841610">set</span>&nbsp;<span class="op" id="4841614">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841618">universalTag</span>&nbsp;<span class="op" id="4841631">=</span>&nbsp;<span class="ident" id="4841633">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841645">expectedClass</span>&nbsp;<span class="op" id="4841659">:=</span>&nbsp;<span class="ident" id="4841662">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841678">expectedTag</span>&nbsp;<span class="op" id="4841690">:=</span>&nbsp;<span class="ident" id="4841693">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841708">if</span>&nbsp;<span class="op" id="4841711">!</span><span class="ident" id="4841712">params</span><span class="op" id="4841718">.</span><span class="ident" id="4841719">explicit</span>&nbsp;<span class="op" id="4841728">&amp;&amp;</span>&nbsp;<span class="ident" id="4841731">params</span><span class="op" id="4841737">.</span><span class="ident" id="4841738">tag</span>&nbsp;<span class="op" id="4841742">!=</span>&nbsp;<span class="ident" id="4841745">nil</span>&nbsp;<span class="op" id="4841749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841753">expectedClass</span>&nbsp;<span class="op" id="4841767">=</span>&nbsp;<span class="ident" id="4841769">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841792">expectedTag</span>&nbsp;<span class="op" id="4841804">=</span>&nbsp;<span class="op" id="4841806">*</span><span class="ident" id="4841807">params</span><span class="op" id="4841813">.</span><span class="ident" id="4841814">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841819">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841823">if</span>&nbsp;<span class="op" id="4841826">!</span><span class="ident" id="4841827">params</span><span class="op" id="4841833">.</span><span class="ident" id="4841834">explicit</span>&nbsp;<span class="op" id="4841843">&amp;&amp;</span>&nbsp;<span class="ident" id="4841846">params</span><span class="op" id="4841852">.</span><span class="ident" id="4841853">application</span>&nbsp;<span class="op" id="4841865">&amp;&amp;</span>&nbsp;<span class="ident" id="4841868">params</span><span class="op" id="4841874">.</span><span class="ident" id="4841875">tag</span>&nbsp;<span class="op" id="4841879">!=</span>&nbsp;<span class="ident" id="4841882">nil</span>&nbsp;<span class="op" id="4841886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841890">expectedClass</span>&nbsp;<span class="op" id="4841904">=</span>&nbsp;<span class="ident" id="4841906">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841925">expectedTag</span>&nbsp;<span class="op" id="4841937">=</span>&nbsp;<span class="op" id="4841939">*</span><span class="ident" id="4841940">params</span><span class="op" id="4841946">.</span><span class="ident" id="4841947">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841952">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841956">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842014">if</span>&nbsp;<span class="ident" id="4842017">t</span><span class="op" id="4842018">.</span><span class="ident" id="4842019">class</span>&nbsp;<span class="op" id="4842025">!=</span>&nbsp;<span class="ident" id="4842028">expectedClass</span>&nbsp;<span class="op" id="4842042">||</span>&nbsp;<span class="ident" id="4842045">t</span><span class="op" id="4842046">.</span><span class="ident" id="4842047">tag</span>&nbsp;<span class="op" id="4842051">!=</span>&nbsp;<span class="ident" id="4842054">expectedTag</span>&nbsp;<span class="op" id="4842066">||</span>&nbsp;<span class="ident" id="4842069">t</span><span class="op" id="4842070">.</span><span class="ident" id="4842071">isCompound</span>&nbsp;<span class="op" id="4842082">!=</span>&nbsp;<span class="ident" id="4842085">compoundType</span>&nbsp;<span class="op" id="4842098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842102">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842165">ok</span>&nbsp;<span class="op" id="4842168">:=</span>&nbsp;<span class="ident" id="4842171">setDefaultValue</span><span class="op" id="4842186">(</span><span class="ident" id="4842187">v</span><span class="op" id="4842188">,</span>&nbsp;<span class="ident" id="4842190">params</span><span class="op" id="4842196">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842200">if</span>&nbsp;<span class="ident" id="4842203">ok</span>&nbsp;<span class="op" id="4842206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842211">offset</span>&nbsp;<span class="op" id="4842218">=</span>&nbsp;<span class="ident" id="4842220">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842233">}</span>&nbsp;<span class="keyword" id="4842235">else</span>&nbsp;<span class="op" id="4842240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842245">err</span>&nbsp;<span class="op" id="4842249">=</span>&nbsp;<span class="ident" id="4842251">StructuralError</span><span class="op" id="4842266">{</span><span class="ident" id="4842267">fmt</span><span class="op" id="4842270">.</span><span class="ident" id="4842271">Sprintf</span><span class="op" id="4842278">(</span><span class="string" id="4842279">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4842320">,</span>&nbsp;<span class="ident" id="4842322">expectedTag</span><span class="op" id="4842333">,</span>&nbsp;<span class="ident" id="4842335">t</span><span class="op" id="4842336">,</span>&nbsp;<span class="ident" id="4842338">params</span><span class="op" id="4842344">,</span>&nbsp;<span class="ident" id="4842346">fieldType</span><span class="op" id="4842355">.</span><span class="ident" id="4842356">Name</span><span class="op" id="4842360">(</span><span class="op" id="4842361">)</span><span class="op" id="4842362">,</span>&nbsp;<span class="ident" id="4842364">offset</span><span class="op" id="4842370">)</span><span class="op" id="4842371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842375">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842379">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842390">if</span>&nbsp;<span class="ident" id="4842393">invalidLength</span><span class="op" id="4842406">(</span><span class="ident" id="4842407">offset</span><span class="op" id="4842413">,</span>&nbsp;<span class="ident" id="4842415">t</span><span class="op" id="4842416">.</span><span class="ident" id="4842417">length</span><span class="op" id="4842423">,</span>&nbsp;<span class="builtinfunc" id="4842425">len</span><span class="op" id="4842428">(</span><span class="ident" id="4842429">bytes</span><span class="op" id="4842434">)</span><span class="op" id="4842435">)</span>&nbsp;<span class="op" id="4842437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842441">err</span>&nbsp;<span class="op" id="4842445">=</span>&nbsp;<span class="ident" id="4842447">SyntaxError</span><span class="op" id="4842458">{</span><span class="string" id="4842459">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4842475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842479">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842490">innerBytes</span>&nbsp;<span class="op" id="4842501">:=</span>&nbsp;<span class="ident" id="4842504">bytes</span><span class="op" id="4842509">[</span><span class="ident" id="4842510">offset</span>&nbsp;<span class="op" id="4842517">:</span>&nbsp;<span class="ident" id="4842519">offset</span><span class="op" id="4842525">+</span><span class="ident" id="4842526">t</span><span class="op" id="4842527">.</span><span class="ident" id="4842528">length</span><span class="op" id="4842534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842537">offset</span>&nbsp;<span class="op" id="4842544">+=</span>&nbsp;<span class="ident" id="4842547">t</span><span class="op" id="4842548">.</span><span class="ident" id="4842549">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842558">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842621">switch</span>&nbsp;<span class="ident" id="4842628">fieldType</span>&nbsp;<span class="op" id="4842638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842641">case</span>&nbsp;<span class="ident" id="4842646">objectIdentifierType</span><span class="op" id="4842666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842670">newSlice</span><span class="op" id="4842678">,</span>&nbsp;<span class="ident" id="4842680">err1</span>&nbsp;<span class="op" id="4842685">:=</span>&nbsp;<span class="ident" id="4842688">parseObjectIdentifier</span><span class="op" id="4842709">(</span><span class="ident" id="4842710">innerBytes</span><span class="op" id="4842720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842724">v</span><span class="op" id="4842725">.</span><span class="ident" id="4842726">Set</span><span class="op" id="4842729">(</span><span class="ident" id="4842730">reflect</span><span class="op" id="4842737">.</span><span class="ident" id="4842738">MakeSlice</span><span class="op" id="4842747">(</span><span class="ident" id="4842748">v</span><span class="op" id="4842749">.</span><span class="ident" id="4842750">Type</span><span class="op" id="4842754">(</span><span class="op" id="4842755">)</span><span class="op" id="4842756">,</span>&nbsp;<span class="builtinfunc" id="4842758">len</span><span class="op" id="4842761">(</span><span class="ident" id="4842762">newSlice</span><span class="op" id="4842770">)</span><span class="op" id="4842771">,</span>&nbsp;<span class="builtinfunc" id="4842773">len</span><span class="op" id="4842776">(</span><span class="ident" id="4842777">newSlice</span><span class="op" id="4842785">)</span><span class="op" id="4842786">)</span><span class="op" id="4842787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842791">if</span>&nbsp;<span class="ident" id="4842794">err1</span>&nbsp;<span class="op" id="4842799">==</span>&nbsp;<span class="ident" id="4842802">nil</span>&nbsp;<span class="op" id="4842806">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842811">reflect</span><span class="op" id="4842818">.</span><span class="ident" id="4842819">Copy</span><span class="op" id="4842823">(</span><span class="ident" id="4842824">v</span><span class="op" id="4842825">,</span>&nbsp;<span class="ident" id="4842827">reflect</span><span class="op" id="4842834">.</span><span class="ident" id="4842835">ValueOf</span><span class="op" id="4842842">(</span><span class="ident" id="4842843">newSlice</span><span class="op" id="4842851">)</span><span class="op" id="4842852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842860">err</span>&nbsp;<span class="op" id="4842864">=</span>&nbsp;<span class="ident" id="4842866">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842873">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842881">case</span>&nbsp;<span class="ident" id="4842886">bitStringType</span><span class="op" id="4842899">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842903">bs</span><span class="op" id="4842905">,</span>&nbsp;<span class="ident" id="4842907">err1</span>&nbsp;<span class="op" id="4842912">:=</span>&nbsp;<span class="ident" id="4842915">parseBitString</span><span class="op" id="4842929">(</span><span class="ident" id="4842930">innerBytes</span><span class="op" id="4842940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842944">if</span>&nbsp;<span class="ident" id="4842947">err1</span>&nbsp;<span class="op" id="4842952">==</span>&nbsp;<span class="ident" id="4842955">nil</span>&nbsp;<span class="op" id="4842959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842964">v</span><span class="op" id="4842965">.</span><span class="ident" id="4842966">Set</span><span class="op" id="4842969">(</span><span class="ident" id="4842970">reflect</span><span class="op" id="4842977">.</span><span class="ident" id="4842978">ValueOf</span><span class="op" id="4842985">(</span><span class="ident" id="4842986">bs</span><span class="op" id="4842988">)</span><span class="op" id="4842989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842997">err</span>&nbsp;<span class="op" id="4843001">=</span>&nbsp;<span class="ident" id="4843003">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843010">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843018">case</span>&nbsp;<span class="ident" id="4843023">timeType</span><span class="op" id="4843031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843035">var</span>&nbsp;<span class="ident" id="4843039">time</span>&nbsp;<span class="ident" id="4843044">time</span><span class="op" id="4843048">.</span><span class="ident" id="4843049">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843056">var</span>&nbsp;<span class="ident" id="4843060">err1</span>&nbsp;<span class="builtintype" id="4843065">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843073">if</span>&nbsp;<span class="ident" id="4843076">universalTag</span>&nbsp;<span class="op" id="4843089">==</span>&nbsp;<span class="ident" id="4843092">tagUTCTime</span>&nbsp;<span class="op" id="4843103">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843108">time</span><span class="op" id="4843112">,</span>&nbsp;<span class="ident" id="4843114">err1</span>&nbsp;<span class="op" id="4843119">=</span>&nbsp;<span class="ident" id="4843121">parseUTCTime</span><span class="op" id="4843133">(</span><span class="ident" id="4843134">innerBytes</span><span class="op" id="4843144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843148">}</span>&nbsp;<span class="keyword" id="4843150">else</span>&nbsp;<span class="op" id="4843155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843160">time</span><span class="op" id="4843164">,</span>&nbsp;<span class="ident" id="4843166">err1</span>&nbsp;<span class="op" id="4843171">=</span>&nbsp;<span class="ident" id="4843173">parseGeneralizedTime</span><span class="op" id="4843193">(</span><span class="ident" id="4843194">innerBytes</span><span class="op" id="4843204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843212">if</span>&nbsp;<span class="ident" id="4843215">err1</span>&nbsp;<span class="op" id="4843220">==</span>&nbsp;<span class="ident" id="4843223">nil</span>&nbsp;<span class="op" id="4843227">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843232">v</span><span class="op" id="4843233">.</span><span class="ident" id="4843234">Set</span><span class="op" id="4843237">(</span><span class="ident" id="4843238">reflect</span><span class="op" id="4843245">.</span><span class="ident" id="4843246">ValueOf</span><span class="op" id="4843253">(</span><span class="ident" id="4843254">time</span><span class="op" id="4843258">)</span><span class="op" id="4843259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843267">err</span>&nbsp;<span class="op" id="4843271">=</span>&nbsp;<span class="ident" id="4843273">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843280">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843288">case</span>&nbsp;<span class="ident" id="4843293">enumeratedType</span><span class="op" id="4843307">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843311">parsedInt</span><span class="op" id="4843320">,</span>&nbsp;<span class="ident" id="4843322">err1</span>&nbsp;<span class="op" id="4843327">:=</span>&nbsp;<span class="ident" id="4843330">parseInt32</span><span class="op" id="4843340">(</span><span class="ident" id="4843341">innerBytes</span><span class="op" id="4843351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843355">if</span>&nbsp;<span class="ident" id="4843358">err1</span>&nbsp;<span class="op" id="4843363">==</span>&nbsp;<span class="ident" id="4843366">nil</span>&nbsp;<span class="op" id="4843370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843375">v</span><span class="op" id="4843376">.</span><span class="ident" id="4843377">SetInt</span><span class="op" id="4843383">(</span><span class="ident" id="4843384">int64</span><span class="op" id="4843389">(</span><span class="ident" id="4843390">parsedInt</span><span class="op" id="4843399">)</span><span class="op" id="4843400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843408">err</span>&nbsp;<span class="op" id="4843412">=</span>&nbsp;<span class="ident" id="4843414">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843421">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843429">case</span>&nbsp;<span class="ident" id="4843434">flagType</span><span class="op" id="4843442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843446">v</span><span class="op" id="4843447">.</span><span class="ident" id="4843448">SetBool</span><span class="op" id="4843455">(</span><span class="builtintype" id="4843456">true</span><span class="op" id="4843460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843464">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843472">case</span>&nbsp;<span class="ident" id="4843477">bigIntType</span><span class="op" id="4843487">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843491">parsedInt</span>&nbsp;<span class="op" id="4843501">:=</span>&nbsp;<span class="ident" id="4843504">parseBigInt</span><span class="op" id="4843515">(</span><span class="ident" id="4843516">innerBytes</span><span class="op" id="4843526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843530">v</span><span class="op" id="4843531">.</span><span class="ident" id="4843532">Set</span><span class="op" id="4843535">(</span><span class="ident" id="4843536">reflect</span><span class="op" id="4843543">.</span><span class="ident" id="4843544">ValueOf</span><span class="op" id="4843551">(</span><span class="ident" id="4843552">parsedInt</span><span class="op" id="4843561">)</span><span class="op" id="4843562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843566">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843577">switch</span>&nbsp;<span class="ident" id="4843584">val</span>&nbsp;<span class="op" id="4843588">:=</span>&nbsp;<span class="ident" id="4843591">v</span><span class="op" id="4843592">;</span>&nbsp;<span class="ident" id="4843594">val</span><span class="op" id="4843597">.</span><span class="ident" id="4843598">Kind</span><span class="op" id="4843602">(</span><span class="op" id="4843603">)</span>&nbsp;<span class="op" id="4843605">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843608">case</span>&nbsp;<span class="ident" id="4843613">reflect</span><span class="op" id="4843620">.</span><span class="ident" id="4843621">Bool</span><span class="op" id="4843625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843629">parsedBool</span><span class="op" id="4843639">,</span>&nbsp;<span class="ident" id="4843641">err1</span>&nbsp;<span class="op" id="4843646">:=</span>&nbsp;<span class="ident" id="4843649">parseBool</span><span class="op" id="4843658">(</span><span class="ident" id="4843659">innerBytes</span><span class="op" id="4843669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843673">if</span>&nbsp;<span class="ident" id="4843676">err1</span>&nbsp;<span class="op" id="4843681">==</span>&nbsp;<span class="ident" id="4843684">nil</span>&nbsp;<span class="op" id="4843688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843693">val</span><span class="op" id="4843696">.</span><span class="ident" id="4843697">SetBool</span><span class="op" id="4843704">(</span><span class="ident" id="4843705">parsedBool</span><span class="op" id="4843715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843719">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843723">err</span>&nbsp;<span class="op" id="4843727">=</span>&nbsp;<span class="ident" id="4843729">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843744">case</span>&nbsp;<span class="ident" id="4843749">reflect</span><span class="op" id="4843756">.</span><span class="ident" id="4843757">Int</span><span class="op" id="4843760">,</span>&nbsp;<span class="ident" id="4843762">reflect</span><span class="op" id="4843769">.</span><span class="ident" id="4843770">Int32</span><span class="op" id="4843775">,</span>&nbsp;<span class="ident" id="4843777">reflect</span><span class="op" id="4843784">.</span><span class="ident" id="4843785">Int64</span><span class="op" id="4843790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843794">if</span>&nbsp;<span class="ident" id="4843797">val</span><span class="op" id="4843800">.</span><span class="ident" id="4843801">Type</span><span class="op" id="4843805">(</span><span class="op" id="4843806">)</span><span class="op" id="4843807">.</span><span class="ident" id="4843808">Size</span><span class="op" id="4843812">(</span><span class="op" id="4843813">)</span>&nbsp;<span class="op" id="4843815">==</span>&nbsp;<span class="num" id="4843818">4</span>&nbsp;<span class="op" id="4843820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843825">parsedInt</span><span class="op" id="4843834">,</span>&nbsp;<span class="ident" id="4843836">err1</span>&nbsp;<span class="op" id="4843841">:=</span>&nbsp;<span class="ident" id="4843844">parseInt32</span><span class="op" id="4843854">(</span><span class="ident" id="4843855">innerBytes</span><span class="op" id="4843865">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843870">if</span>&nbsp;<span class="ident" id="4843873">err1</span>&nbsp;<span class="op" id="4843878">==</span>&nbsp;<span class="ident" id="4843881">nil</span>&nbsp;<span class="op" id="4843885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843891">val</span><span class="op" id="4843894">.</span><span class="ident" id="4843895">SetInt</span><span class="op" id="4843901">(</span><span class="ident" id="4843902">int64</span><span class="op" id="4843907">(</span><span class="ident" id="4843908">parsedInt</span><span class="op" id="4843917">)</span><span class="op" id="4843918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843928">err</span>&nbsp;<span class="op" id="4843932">=</span>&nbsp;<span class="ident" id="4843934">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843941">}</span>&nbsp;<span class="keyword" id="4843943">else</span>&nbsp;<span class="op" id="4843948">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843953">parsedInt</span><span class="op" id="4843962">,</span>&nbsp;<span class="ident" id="4843964">err1</span>&nbsp;<span class="op" id="4843969">:=</span>&nbsp;<span class="ident" id="4843972">parseInt64</span><span class="op" id="4843982">(</span><span class="ident" id="4843983">innerBytes</span><span class="op" id="4843993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843998">if</span>&nbsp;<span class="ident" id="4844001">err1</span>&nbsp;<span class="op" id="4844006">==</span>&nbsp;<span class="ident" id="4844009">nil</span>&nbsp;<span class="op" id="4844013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844019">val</span><span class="op" id="4844022">.</span><span class="ident" id="4844023">SetInt</span><span class="op" id="4844029">(</span><span class="ident" id="4844030">parsedInt</span><span class="op" id="4844039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844049">err</span>&nbsp;<span class="op" id="4844053">=</span>&nbsp;<span class="ident" id="4844055">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844066">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4844074">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844132">case</span>&nbsp;<span class="ident" id="4844137">reflect</span><span class="op" id="4844144">.</span><span class="ident" id="4844145">Struct</span><span class="op" id="4844151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844155">structType</span>&nbsp;<span class="op" id="4844166">:=</span>&nbsp;<span class="ident" id="4844169">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844182">if</span>&nbsp;<span class="ident" id="4844185">structType</span><span class="op" id="4844195">.</span><span class="ident" id="4844196">NumField</span><span class="op" id="4844204">(</span><span class="op" id="4844205">)</span>&nbsp;<span class="op" id="4844207">&gt;</span>&nbsp;<span class="num" id="4844209">0</span>&nbsp;<span class="op" id="4844211">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844217">structType</span><span class="op" id="4844227">.</span><span class="ident" id="4844228">Field</span><span class="op" id="4844233">(</span><span class="num" id="4844234">0</span><span class="op" id="4844235">)</span><span class="op" id="4844236">.</span><span class="ident" id="4844237">Type</span>&nbsp;<span class="op" id="4844242">==</span>&nbsp;<span class="ident" id="4844245">rawContentsType</span>&nbsp;<span class="op" id="4844261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844266">bytes</span>&nbsp;<span class="op" id="4844272">:=</span>&nbsp;<span class="ident" id="4844275">bytes</span><span class="op" id="4844280">[</span><span class="ident" id="4844281">initOffset</span><span class="op" id="4844291">:</span><span class="ident" id="4844292">offset</span><span class="op" id="4844298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844303">val</span><span class="op" id="4844306">.</span><span class="ident" id="4844307">Field</span><span class="op" id="4844312">(</span><span class="num" id="4844313">0</span><span class="op" id="4844314">)</span><span class="op" id="4844315">.</span><span class="ident" id="4844316">Set</span><span class="op" id="4844319">(</span><span class="ident" id="4844320">reflect</span><span class="op" id="4844327">.</span><span class="ident" id="4844328">ValueOf</span><span class="op" id="4844335">(</span><span class="ident" id="4844336">RawContent</span><span class="op" id="4844346">(</span><span class="ident" id="4844347">bytes</span><span class="op" id="4844352">)</span><span class="op" id="4844353">)</span><span class="op" id="4844354">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844363">innerOffset</span>&nbsp;<span class="op" id="4844375">:=</span>&nbsp;<span class="num" id="4844378">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844382">for</span>&nbsp;<span class="ident" id="4844386">i</span>&nbsp;<span class="op" id="4844388">:=</span>&nbsp;<span class="num" id="4844391">0</span><span class="op" id="4844392">;</span>&nbsp;<span class="ident" id="4844394">i</span>&nbsp;<span class="op" id="4844396">&lt;</span>&nbsp;<span class="ident" id="4844398">structType</span><span class="op" id="4844408">.</span><span class="ident" id="4844409">NumField</span><span class="op" id="4844417">(</span><span class="op" id="4844418">)</span><span class="op" id="4844419">;</span>&nbsp;<span class="ident" id="4844421">i</span><span class="op" id="4844422">++</span>&nbsp;<span class="op" id="4844425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844430">field</span>&nbsp;<span class="op" id="4844436">:=</span>&nbsp;<span class="ident" id="4844439">structType</span><span class="op" id="4844449">.</span><span class="ident" id="4844450">Field</span><span class="op" id="4844455">(</span><span class="ident" id="4844456">i</span><span class="op" id="4844457">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844462">if</span>&nbsp;<span class="ident" id="4844465">i</span>&nbsp;<span class="op" id="4844467">==</span>&nbsp;<span class="num" id="4844470">0</span>&nbsp;<span class="op" id="4844472">&amp;&amp;</span>&nbsp;<span class="ident" id="4844475">field</span><span class="op" id="4844480">.</span><span class="ident" id="4844481">Type</span>&nbsp;<span class="op" id="4844486">==</span>&nbsp;<span class="ident" id="4844489">rawContentsType</span>&nbsp;<span class="op" id="4844505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844511">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844528">innerOffset</span><span class="op" id="4844539">,</span>&nbsp;<span class="ident" id="4844541">err</span>&nbsp;<span class="op" id="4844545">=</span>&nbsp;<span class="ident" id="4844547">parseField</span><span class="op" id="4844557">(</span><span class="ident" id="4844558">val</span><span class="op" id="4844561">.</span><span class="ident" id="4844562">Field</span><span class="op" id="4844567">(</span><span class="ident" id="4844568">i</span><span class="op" id="4844569">)</span><span class="op" id="4844570">,</span>&nbsp;<span class="ident" id="4844572">innerBytes</span><span class="op" id="4844582">,</span>&nbsp;<span class="ident" id="4844584">innerOffset</span><span class="op" id="4844595">,</span>&nbsp;<span class="ident" id="4844597">parseFieldParameters</span><span class="op" id="4844617">(</span><span class="ident" id="4844618">field</span><span class="op" id="4844623">.</span><span class="ident" id="4844624">Tag</span><span class="op" id="4844627">.</span><span class="ident" id="4844628">Get</span><span class="op" id="4844631">(</span><span class="string" id="4844632">&#34;asn1&#34;</span><span class="op" id="4844638">)</span><span class="op" id="4844639">)</span><span class="op" id="4844640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844645">if</span>&nbsp;<span class="ident" id="4844648">err</span>&nbsp;<span class="op" id="4844652">!=</span>&nbsp;<span class="ident" id="4844655">nil</span>&nbsp;<span class="op" id="4844659">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844665">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4844683">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4844744">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4844806">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844851">case</span>&nbsp;<span class="ident" id="4844856">reflect</span><span class="op" id="4844863">.</span><span class="ident" id="4844864">Slice</span><span class="op" id="4844869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844873">sliceType</span>&nbsp;<span class="op" id="4844883">:=</span>&nbsp;<span class="ident" id="4844886">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844898">if</span>&nbsp;<span class="ident" id="4844901">sliceType</span><span class="op" id="4844910">.</span><span class="ident" id="4844911">Elem</span><span class="op" id="4844915">(</span><span class="op" id="4844916">)</span><span class="op" id="4844917">.</span><span class="ident" id="4844918">Kind</span><span class="op" id="4844922">(</span><span class="op" id="4844923">)</span>&nbsp;<span class="op" id="4844925">==</span>&nbsp;<span class="ident" id="4844928">reflect</span><span class="op" id="4844935">.</span><span class="ident" id="4844936">Uint8</span>&nbsp;<span class="op" id="4844942">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844947">val</span><span class="op" id="4844950">.</span><span class="ident" id="4844951">Set</span><span class="op" id="4844954">(</span><span class="ident" id="4844955">reflect</span><span class="op" id="4844962">.</span><span class="ident" id="4844963">MakeSlice</span><span class="op" id="4844972">(</span><span class="ident" id="4844973">sliceType</span><span class="op" id="4844982">,</span>&nbsp;<span class="builtinfunc" id="4844984">len</span><span class="op" id="4844987">(</span><span class="ident" id="4844988">innerBytes</span><span class="op" id="4844998">)</span><span class="op" id="4844999">,</span>&nbsp;<span class="builtinfunc" id="4845001">len</span><span class="op" id="4845004">(</span><span class="ident" id="4845005">innerBytes</span><span class="op" id="4845015">)</span><span class="op" id="4845016">)</span><span class="op" id="4845017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845022">reflect</span><span class="op" id="4845029">.</span><span class="ident" id="4845030">Copy</span><span class="op" id="4845034">(</span><span class="ident" id="4845035">val</span><span class="op" id="4845038">,</span>&nbsp;<span class="ident" id="4845040">reflect</span><span class="op" id="4845047">.</span><span class="ident" id="4845048">ValueOf</span><span class="op" id="4845055">(</span><span class="ident" id="4845056">innerBytes</span><span class="op" id="4845066">)</span><span class="op" id="4845067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845085">newSlice</span><span class="op" id="4845093">,</span>&nbsp;<span class="ident" id="4845095">err1</span>&nbsp;<span class="op" id="4845100">:=</span>&nbsp;<span class="ident" id="4845103">parseSequenceOf</span><span class="op" id="4845118">(</span><span class="ident" id="4845119">innerBytes</span><span class="op" id="4845129">,</span>&nbsp;<span class="ident" id="4845131">sliceType</span><span class="op" id="4845140">,</span>&nbsp;<span class="ident" id="4845142">sliceType</span><span class="op" id="4845151">.</span><span class="ident" id="4845152">Elem</span><span class="op" id="4845156">(</span><span class="op" id="4845157">)</span><span class="op" id="4845158">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845162">if</span>&nbsp;<span class="ident" id="4845165">err1</span>&nbsp;<span class="op" id="4845170">==</span>&nbsp;<span class="ident" id="4845173">nil</span>&nbsp;<span class="op" id="4845177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845182">val</span><span class="op" id="4845185">.</span><span class="ident" id="4845186">Set</span><span class="op" id="4845189">(</span><span class="ident" id="4845190">newSlice</span><span class="op" id="4845198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845206">err</span>&nbsp;<span class="op" id="4845210">=</span>&nbsp;<span class="ident" id="4845212">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845219">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845227">case</span>&nbsp;<span class="ident" id="4845232">reflect</span><span class="op" id="4845239">.</span><span class="ident" id="4845240">String</span><span class="op" id="4845246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845250">var</span>&nbsp;<span class="ident" id="4845254">v</span>&nbsp;<span class="builtintype" id="4845256">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845265">switch</span>&nbsp;<span class="ident" id="4845272">universalTag</span>&nbsp;<span class="op" id="4845285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845289">case</span>&nbsp;<span class="ident" id="4845294">tagPrintableString</span><span class="op" id="4845312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845317">v</span><span class="op" id="4845318">,</span>&nbsp;<span class="ident" id="4845320">err</span>&nbsp;<span class="op" id="4845324">=</span>&nbsp;<span class="ident" id="4845326">parsePrintableString</span><span class="op" id="4845346">(</span><span class="ident" id="4845347">innerBytes</span><span class="op" id="4845357">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845361">case</span>&nbsp;<span class="ident" id="4845366">tagIA5String</span><span class="op" id="4845378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845383">v</span><span class="op" id="4845384">,</span>&nbsp;<span class="ident" id="4845386">err</span>&nbsp;<span class="op" id="4845390">=</span>&nbsp;<span class="ident" id="4845392">parseIA5String</span><span class="op" id="4845406">(</span><span class="ident" id="4845407">innerBytes</span><span class="op" id="4845417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845421">case</span>&nbsp;<span class="ident" id="4845426">tagT61String</span><span class="op" id="4845438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845443">v</span><span class="op" id="4845444">,</span>&nbsp;<span class="ident" id="4845446">err</span>&nbsp;<span class="op" id="4845450">=</span>&nbsp;<span class="ident" id="4845452">parseT61String</span><span class="op" id="4845466">(</span><span class="ident" id="4845467">innerBytes</span><span class="op" id="4845477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845481">case</span>&nbsp;<span class="ident" id="4845486">tagUTF8String</span><span class="op" id="4845499">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845504">v</span><span class="op" id="4845505">,</span>&nbsp;<span class="ident" id="4845507">err</span>&nbsp;<span class="op" id="4845511">=</span>&nbsp;<span class="ident" id="4845513">parseUTF8String</span><span class="op" id="4845528">(</span><span class="ident" id="4845529">innerBytes</span><span class="op" id="4845539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845543">case</span>&nbsp;<span class="ident" id="4845548">tagGeneralString</span><span class="op" id="4845564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845569">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845623">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845681">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845735">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845790">v</span><span class="op" id="4845791">,</span>&nbsp;<span class="ident" id="4845793">err</span>&nbsp;<span class="op" id="4845797">=</span>&nbsp;<span class="ident" id="4845799">parseT61String</span><span class="op" id="4845813">(</span><span class="ident" id="4845814">innerBytes</span><span class="op" id="4845824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845828">default</span><span class="op" id="4845835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845840">err</span>&nbsp;<span class="op" id="4845844">=</span>&nbsp;<span class="ident" id="4845846">SyntaxError</span><span class="op" id="4845857">{</span><span class="ident" id="4845858">fmt</span><span class="op" id="4845861">.</span><span class="ident" id="4845862">Sprintf</span><span class="op" id="4845869">(</span><span class="string" id="4845870">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4845910">,</span>&nbsp;<span class="ident" id="4845912">universalTag</span><span class="op" id="4845924">)</span><span class="op" id="4845925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845929">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845933">if</span>&nbsp;<span class="ident" id="4845936">err</span>&nbsp;<span class="op" id="4845940">==</span>&nbsp;<span class="ident" id="4845943">nil</span>&nbsp;<span class="op" id="4845947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845952">val</span><span class="op" id="4845955">.</span><span class="ident" id="4845956">SetString</span><span class="op" id="4845965">(</span><span class="ident" id="4845966">v</span><span class="op" id="4845967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845975">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845983">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845986">err</span>&nbsp;<span class="op" id="4845990">=</span>&nbsp;<span class="ident" id="4845992">StructuralError</span><span class="op" id="4846007">{</span><span class="string" id="4846008">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4846024">+</span>&nbsp;<span class="ident" id="4846026">v</span><span class="op" id="4846027">.</span><span class="ident" id="4846028">Type</span><span class="op" id="4846032">(</span><span class="op" id="4846033">)</span><span class="op" id="4846034">.</span><span class="ident" id="4846035">String</span><span class="op" id="4846041">(</span><span class="op" id="4846042">)</span><span class="op" id="4846043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846046">return</span><br>
<span class="lineno"></span><span class="op" id="4846053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4846056">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4846134">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4846181">func</span>&nbsp;<span class="ident" id="4846186">canHaveDefaultValue</span><span class="op" id="4846205">(</span><span class="ident" id="4846206">k</span>&nbsp;<span class="ident" id="4846208">reflect</span><span class="op" id="4846215">.</span><span class="ident" id="4846216">Kind</span><span class="op" id="4846220">)</span>&nbsp;<span class="builtintype" id="4846222">bool</span>&nbsp;<span class="op" id="4846227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846230">switch</span>&nbsp;<span class="ident" id="4846237">k</span>&nbsp;<span class="op" id="4846239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846242">case</span>&nbsp;<span class="ident" id="4846247">reflect</span><span class="op" id="4846254">.</span><span class="ident" id="4846255">Int</span><span class="op" id="4846258">,</span>&nbsp;<span class="ident" id="4846260">reflect</span><span class="op" id="4846267">.</span><span class="ident" id="4846268">Int8</span><span class="op" id="4846272">,</span>&nbsp;<span class="ident" id="4846274">reflect</span><span class="op" id="4846281">.</span><span class="ident" id="4846282">Int16</span><span class="op" id="4846287">,</span>&nbsp;<span class="ident" id="4846289">reflect</span><span class="op" id="4846296">.</span><span class="ident" id="4846297">Int32</span><span class="op" id="4846302">,</span>&nbsp;<span class="ident" id="4846304">reflect</span><span class="op" id="4846311">.</span><span class="ident" id="4846312">Int64</span><span class="op" id="4846317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846321">return</span>&nbsp;<span class="builtintype" id="4846328">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846338">return</span>&nbsp;<span class="builtintype" id="4846345">false</span><br>
<span class="lineno"></span><span class="op" id="4846351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4846354">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4846433">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4846513">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4846575">func</span>&nbsp;<span class="ident" id="4846580">setDefaultValue</span><span class="op" id="4846595">(</span><span class="ident" id="4846596">v</span>&nbsp;<span class="ident" id="4846598">reflect</span><span class="op" id="4846605">.</span><span class="ident" id="4846606">Value</span><span class="op" id="4846611">,</span>&nbsp;<span class="ident" id="4846613">params</span>&nbsp;<span class="ident" id="4846620">fieldParameters</span><span class="op" id="4846635">)</span>&nbsp;<span class="op" id="4846637">(</span><span class="ident" id="4846638">ok</span>&nbsp;<span class="builtintype" id="4846641">bool</span><span class="op" id="4846645">)</span>&nbsp;<span class="op" id="4846647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846650">if</span>&nbsp;<span class="op" id="4846653">!</span><span class="ident" id="4846654">params</span><span class="op" id="4846660">.</span><span class="ident" id="4846661">optional</span>&nbsp;<span class="op" id="4846670">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846685">ok</span>&nbsp;<span class="op" id="4846688">=</span>&nbsp;<span class="builtintype" id="4846690">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846696">if</span>&nbsp;<span class="ident" id="4846699">params</span><span class="op" id="4846705">.</span><span class="ident" id="4846706">defaultValue</span>&nbsp;<span class="op" id="4846719">==</span>&nbsp;<span class="ident" id="4846722">nil</span>&nbsp;<span class="op" id="4846726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846730">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846741">if</span>&nbsp;<span class="ident" id="4846744">canHaveDefaultValue</span><span class="op" id="4846763">(</span><span class="ident" id="4846764">v</span><span class="op" id="4846765">.</span><span class="ident" id="4846766">Kind</span><span class="op" id="4846770">(</span><span class="op" id="4846771">)</span><span class="op" id="4846772">)</span>&nbsp;<span class="op" id="4846774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846778">v</span><span class="op" id="4846779">.</span><span class="ident" id="4846780">SetInt</span><span class="op" id="4846786">(</span><span class="op" id="4846787">*</span><span class="ident" id="4846788">params</span><span class="op" id="4846794">.</span><span class="ident" id="4846795">defaultValue</span><span class="op" id="4846807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846813">return</span><br>
<span class="lineno">855</span><span class="op" id="4846820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4846823">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4846882">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4846963">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4847022">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4847075">//</span><br>
<span class="lineno"></span><span class="comment" id="4847078">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4847138">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4847182">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4847235">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4847271">//</span><br>
<span class="lineno"></span><span class="comment" id="4847274">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4847328">//</span><br>
<span class="lineno"></span><span class="comment" id="4847331">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4847384">//</span><br>
<span class="lineno"></span><span class="comment" id="4847387">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4847438">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4847459">//</span><br>
<span class="lineno"></span><span class="comment" id="4847462">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4847518">//</span><br>
<span class="lineno"></span><span class="comment" id="4847521">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4847591">//</span><br>
<span class="lineno"></span><span class="comment" id="4847594">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4847663">//</span><br>
<span class="lineno">880</span><span class="comment" id="4847666">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4847733">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4847801">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4847838">//</span><br>
<span class="lineno"></span><span class="comment" id="4847841">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4847894">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4847960">//</span><br>
<span class="lineno"></span><span class="comment" id="4847963">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4848018">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4848068">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4848123">//</span><br>
<span class="lineno"></span><span class="comment" id="4848126">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4848200">//</span><br>
<span class="lineno"></span><span class="comment" id="4848203">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4848259">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4848323">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4848401">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4848447">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4848512">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4848585">//</span><br>
<span class="lineno">900</span><span class="comment" id="4848588">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4848664">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4848717">//</span><br>
<span class="lineno"></span><span class="comment" id="4848720">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4848799">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4848875">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4848906">//</span><br>
<span class="lineno"></span><span class="comment" id="4848909">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4848972">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4849008">func</span>&nbsp;<span class="ident" id="4849013">Unmarshal</span><span class="op" id="4849022">(</span><span class="ident" id="4849023">b</span>&nbsp;<span class="op" id="4849025">[</span><span class="op" id="4849026">]</span><span class="builtintype" id="4849027">byte</span><span class="op" id="4849031">,</span>&nbsp;<span class="ident" id="4849033">val</span>&nbsp;<span class="keyword" id="4849037">interface</span><span class="op" id="4849046">{</span><span class="op" id="4849047">}</span><span class="op" id="4849048">)</span>&nbsp;<span class="op" id="4849050">(</span><span class="ident" id="4849051">rest</span>&nbsp;<span class="op" id="4849056">[</span><span class="op" id="4849057">]</span><span class="builtintype" id="4849058">byte</span><span class="op" id="4849062">,</span>&nbsp;<span class="ident" id="4849064">err</span>&nbsp;<span class="builtintype" id="4849068">error</span><span class="op" id="4849073">)</span>&nbsp;<span class="op" id="4849075">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849078">return</span>&nbsp;<span class="ident" id="4849085">UnmarshalWithParams</span><span class="op" id="4849104">(</span><span class="ident" id="4849105">b</span><span class="op" id="4849106">,</span>&nbsp;<span class="ident" id="4849108">val</span><span class="op" id="4849111">,</span>&nbsp;<span class="string" id="4849113">&#34;&#34;</span><span class="op" id="4849115">)</span><br>
<span class="lineno"></span><span class="op" id="4849117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849120">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4849191">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4849267">func</span>&nbsp;<span class="ident" id="4849272">UnmarshalWithParams</span><span class="op" id="4849291">(</span><span class="ident" id="4849292">b</span>&nbsp;<span class="op" id="4849294">[</span><span class="op" id="4849295">]</span><span class="builtintype" id="4849296">byte</span><span class="op" id="4849300">,</span>&nbsp;<span class="ident" id="4849302">val</span>&nbsp;<span class="keyword" id="4849306">interface</span><span class="op" id="4849315">{</span><span class="op" id="4849316">}</span><span class="op" id="4849317">,</span>&nbsp;<span class="ident" id="4849319">params</span>&nbsp;<span class="builtintype" id="4849326">string</span><span class="op" id="4849332">)</span>&nbsp;<span class="op" id="4849334">(</span><span class="ident" id="4849335">rest</span>&nbsp;<span class="op" id="4849340">[</span><span class="op" id="4849341">]</span><span class="builtintype" id="4849342">byte</span><span class="op" id="4849346">,</span>&nbsp;<span class="ident" id="4849348">err</span>&nbsp;<span class="builtintype" id="4849352">error</span><span class="op" id="4849357">)</span>&nbsp;<span class="op" id="4849359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849362">v</span>&nbsp;<span class="op" id="4849364">:=</span>&nbsp;<span class="ident" id="4849367">reflect</span><span class="op" id="4849374">.</span><span class="ident" id="4849375">ValueOf</span><span class="op" id="4849382">(</span><span class="ident" id="4849383">val</span><span class="op" id="4849386">)</span><span class="op" id="4849387">.</span><span class="ident" id="4849388">Elem</span><span class="op" id="4849392">(</span><span class="op" id="4849393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849396">offset</span><span class="op" id="4849402">,</span>&nbsp;<span class="ident" id="4849404">err</span>&nbsp;<span class="op" id="4849408">:=</span>&nbsp;<span class="ident" id="4849411">parseField</span><span class="op" id="4849421">(</span><span class="ident" id="4849422">v</span><span class="op" id="4849423">,</span>&nbsp;<span class="ident" id="4849425">b</span><span class="op" id="4849426">,</span>&nbsp;<span class="num" id="4849428">0</span><span class="op" id="4849429">,</span>&nbsp;<span class="ident" id="4849431">parseFieldParameters</span><span class="op" id="4849451">(</span><span class="ident" id="4849452">params</span><span class="op" id="4849458">)</span><span class="op" id="4849459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849462">if</span>&nbsp;<span class="ident" id="4849465">err</span>&nbsp;<span class="op" id="4849469">!=</span>&nbsp;<span class="ident" id="4849472">nil</span>&nbsp;<span class="op" id="4849476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849480">return</span>&nbsp;<span class="ident" id="4849487">nil</span><span class="op" id="4849490">,</span>&nbsp;<span class="ident" id="4849492">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849500">return</span>&nbsp;<span class="ident" id="4849507">b</span><span class="op" id="4849508">[</span><span class="ident" id="4849509">offset</span><span class="op" id="4849515">:</span><span class="op" id="4849516">]</span><span class="op" id="4849517">,</span>&nbsp;<span class="ident" id="4849519">nil</span><br>
<span class="lineno"></span><span class="op" id="4849523">}</span>
</div>
</body>
</html>
