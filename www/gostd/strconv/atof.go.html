<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html" class="current">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2231215">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2231270">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2231324">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2231375">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2231452">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2231476">package</span>&nbsp;<span class="ident" id="2231484">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2231493">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2231541">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2231555">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2231602">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2231675">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2231735">import</span>&nbsp;<span class="string" id="2231742">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2231750">var</span>&nbsp;<span class="ident" id="2231754">optimize</span>&nbsp;<span class="op" id="2231763">=</span>&nbsp;<span class="builtintype" id="2231765">true</span>&nbsp;<span class="comment" id="2231770">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2231797">func</span>&nbsp;<span class="ident" id="2231802">equalIgnoreCase</span><span class="op" id="2231817">(</span><span class="ident" id="2231818">s1</span><span class="op" id="2231820">,</span>&nbsp;<span class="ident" id="2231822">s2</span>&nbsp;<span class="builtintype" id="2231825">string</span><span class="op" id="2231831">)</span>&nbsp;<span class="builtintype" id="2231833">bool</span>&nbsp;<span class="op" id="2231838">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231841">if</span>&nbsp;<span class="builtinfunc" id="2231844">len</span><span class="op" id="2231847">(</span><span class="ident" id="2231848">s1</span><span class="op" id="2231850">)</span>&nbsp;<span class="op" id="2231852">!=</span>&nbsp;<span class="builtinfunc" id="2231855">len</span><span class="op" id="2231858">(</span><span class="ident" id="2231859">s2</span><span class="op" id="2231861">)</span>&nbsp;<span class="op" id="2231863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231867">return</span>&nbsp;<span class="builtintype" id="2231874">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231884">for</span>&nbsp;<span class="ident" id="2231888">i</span>&nbsp;<span class="op" id="2231890">:=</span>&nbsp;<span class="num" id="2231893">0</span><span class="op" id="2231894">;</span>&nbsp;<span class="ident" id="2231896">i</span>&nbsp;<span class="op" id="2231898">&lt;</span>&nbsp;<span class="builtinfunc" id="2231900">len</span><span class="op" id="2231903">(</span><span class="ident" id="2231904">s1</span><span class="op" id="2231906">)</span><span class="op" id="2231907">;</span>&nbsp;<span class="ident" id="2231909">i</span><span class="op" id="2231910">++</span>&nbsp;<span class="op" id="2231913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231917">c1</span>&nbsp;<span class="op" id="2231920">:=</span>&nbsp;<span class="ident" id="2231923">s1</span><span class="op" id="2231925">[</span><span class="ident" id="2231926">i</span><span class="op" id="2231927">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231931">if</span>&nbsp;<span class="string" id="2231934">&#39;A&#39;</span>&nbsp;<span class="op" id="2231938">&lt;=</span>&nbsp;<span class="ident" id="2231941">c1</span>&nbsp;<span class="op" id="2231944">&amp;&amp;</span>&nbsp;<span class="ident" id="2231947">c1</span>&nbsp;<span class="op" id="2231950">&lt;=</span>&nbsp;<span class="string" id="2231953">&#39;Z&#39;</span>&nbsp;<span class="op" id="2231957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231962">c1</span>&nbsp;<span class="op" id="2231965">+=</span>&nbsp;<span class="string" id="2231968">&#39;a&#39;</span>&nbsp;<span class="op" id="2231972">-</span>&nbsp;<span class="string" id="2231974">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231984">c2</span>&nbsp;<span class="op" id="2231987">:=</span>&nbsp;<span class="ident" id="2231990">s2</span><span class="op" id="2231992">[</span><span class="ident" id="2231993">i</span><span class="op" id="2231994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231998">if</span>&nbsp;<span class="string" id="2232001">&#39;A&#39;</span>&nbsp;<span class="op" id="2232005">&lt;=</span>&nbsp;<span class="ident" id="2232008">c2</span>&nbsp;<span class="op" id="2232011">&amp;&amp;</span>&nbsp;<span class="ident" id="2232014">c2</span>&nbsp;<span class="op" id="2232017">&lt;=</span>&nbsp;<span class="string" id="2232020">&#39;Z&#39;</span>&nbsp;<span class="op" id="2232024">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232029">c2</span>&nbsp;<span class="op" id="2232032">+=</span>&nbsp;<span class="string" id="2232035">&#39;a&#39;</span>&nbsp;<span class="op" id="2232039">-</span>&nbsp;<span class="string" id="2232041">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232051">if</span>&nbsp;<span class="ident" id="2232054">c1</span>&nbsp;<span class="op" id="2232057">!=</span>&nbsp;<span class="ident" id="2232060">c2</span>&nbsp;<span class="op" id="2232063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232068">return</span>&nbsp;<span class="builtintype" id="2232075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232083">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232089">return</span>&nbsp;<span class="builtintype" id="2232096">true</span><br>
<span class="lineno"></span><span class="op" id="2232101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232104">func</span>&nbsp;<span class="ident" id="2232109">special</span><span class="op" id="2232116">(</span><span class="ident" id="2232117">s</span>&nbsp;<span class="builtintype" id="2232119">string</span><span class="op" id="2232125">)</span>&nbsp;<span class="op" id="2232127">(</span><span class="ident" id="2232128">f</span>&nbsp;<span class="builtintype" id="2232130">float64</span><span class="op" id="2232137">,</span>&nbsp;<span class="ident" id="2232139">ok</span>&nbsp;<span class="builtintype" id="2232142">bool</span><span class="op" id="2232146">)</span>&nbsp;<span class="op" id="2232148">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232151">if</span>&nbsp;<span class="builtinfunc" id="2232154">len</span><span class="op" id="2232157">(</span><span class="ident" id="2232158">s</span><span class="op" id="2232159">)</span>&nbsp;<span class="op" id="2232161">==</span>&nbsp;<span class="num" id="2232164">0</span>&nbsp;<span class="op" id="2232166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232181">switch</span>&nbsp;<span class="ident" id="2232188">s</span><span class="op" id="2232189">[</span><span class="num" id="2232190">0</span><span class="op" id="2232191">]</span>&nbsp;<span class="op" id="2232193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232196">default</span><span class="op" id="2232203">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232207">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232215">case</span>&nbsp;<span class="string" id="2232220">&#39;+&#39;</span><span class="op" id="2232223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232227">if</span>&nbsp;<span class="ident" id="2232230">equalIgnoreCase</span><span class="op" id="2232245">(</span><span class="ident" id="2232246">s</span><span class="op" id="2232247">,</span>&nbsp;<span class="string" id="2232249">&#34;+inf&#34;</span><span class="op" id="2232255">)</span>&nbsp;<span class="op" id="2232257">||</span>&nbsp;<span class="ident" id="2232260">equalIgnoreCase</span><span class="op" id="2232275">(</span><span class="ident" id="2232276">s</span><span class="op" id="2232277">,</span>&nbsp;<span class="string" id="2232279">&#34;+infinity&#34;</span><span class="op" id="2232290">)</span>&nbsp;<span class="op" id="2232292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232297">return</span>&nbsp;<span class="ident" id="2232304">math</span><span class="op" id="2232308">.</span><span class="ident" id="2232309">Inf</span><span class="op" id="2232312">(</span><span class="num" id="2232313">1</span><span class="op" id="2232314">)</span><span class="op" id="2232315">,</span>&nbsp;<span class="builtintype" id="2232317">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232324">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232327">case</span>&nbsp;<span class="string" id="2232332">&#39;-&#39;</span><span class="op" id="2232335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232339">if</span>&nbsp;<span class="ident" id="2232342">equalIgnoreCase</span><span class="op" id="2232357">(</span><span class="ident" id="2232358">s</span><span class="op" id="2232359">,</span>&nbsp;<span class="string" id="2232361">&#34;-inf&#34;</span><span class="op" id="2232367">)</span>&nbsp;<span class="op" id="2232369">||</span>&nbsp;<span class="ident" id="2232372">equalIgnoreCase</span><span class="op" id="2232387">(</span><span class="ident" id="2232388">s</span><span class="op" id="2232389">,</span>&nbsp;<span class="string" id="2232391">&#34;-infinity&#34;</span><span class="op" id="2232402">)</span>&nbsp;<span class="op" id="2232404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232409">return</span>&nbsp;<span class="ident" id="2232416">math</span><span class="op" id="2232420">.</span><span class="ident" id="2232421">Inf</span><span class="op" id="2232424">(</span><span class="op" id="2232425">-</span><span class="num" id="2232426">1</span><span class="op" id="2232427">)</span><span class="op" id="2232428">,</span>&nbsp;<span class="builtintype" id="2232430">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232440">case</span>&nbsp;<span class="string" id="2232445">&#39;n&#39;</span><span class="op" id="2232448">,</span>&nbsp;<span class="string" id="2232450">&#39;N&#39;</span><span class="op" id="2232453">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232457">if</span>&nbsp;<span class="ident" id="2232460">equalIgnoreCase</span><span class="op" id="2232475">(</span><span class="ident" id="2232476">s</span><span class="op" id="2232477">,</span>&nbsp;<span class="string" id="2232479">&#34;nan&#34;</span><span class="op" id="2232484">)</span>&nbsp;<span class="op" id="2232486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232491">return</span>&nbsp;<span class="ident" id="2232498">math</span><span class="op" id="2232502">.</span><span class="ident" id="2232503">NaN</span><span class="op" id="2232506">(</span><span class="op" id="2232507">)</span><span class="op" id="2232508">,</span>&nbsp;<span class="builtintype" id="2232510">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232520">case</span>&nbsp;<span class="string" id="2232525">&#39;i&#39;</span><span class="op" id="2232528">,</span>&nbsp;<span class="string" id="2232530">&#39;I&#39;</span><span class="op" id="2232533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232537">if</span>&nbsp;<span class="ident" id="2232540">equalIgnoreCase</span><span class="op" id="2232555">(</span><span class="ident" id="2232556">s</span><span class="op" id="2232557">,</span>&nbsp;<span class="string" id="2232559">&#34;inf&#34;</span><span class="op" id="2232564">)</span>&nbsp;<span class="op" id="2232566">||</span>&nbsp;<span class="ident" id="2232569">equalIgnoreCase</span><span class="op" id="2232584">(</span><span class="ident" id="2232585">s</span><span class="op" id="2232586">,</span>&nbsp;<span class="string" id="2232588">&#34;infinity&#34;</span><span class="op" id="2232598">)</span>&nbsp;<span class="op" id="2232600">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232605">return</span>&nbsp;<span class="ident" id="2232612">math</span><span class="op" id="2232616">.</span><span class="ident" id="2232617">Inf</span><span class="op" id="2232620">(</span><span class="num" id="2232621">1</span><span class="op" id="2232622">)</span><span class="op" id="2232623">,</span>&nbsp;<span class="builtintype" id="2232625">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232638">return</span><br>
<span class="lineno"></span><span class="op" id="2232645">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2232648">func</span>&nbsp;<span class="op" id="2232653">(</span><span class="ident" id="2232654">b</span>&nbsp;<span class="op" id="2232656">*</span><span class="ident" id="2232657">decimal</span><span class="op" id="2232664">)</span>&nbsp;<span class="ident" id="2232666">set</span><span class="op" id="2232669">(</span><span class="ident" id="2232670">s</span>&nbsp;<span class="builtintype" id="2232672">string</span><span class="op" id="2232678">)</span>&nbsp;<span class="op" id="2232680">(</span><span class="ident" id="2232681">ok</span>&nbsp;<span class="builtintype" id="2232684">bool</span><span class="op" id="2232688">)</span>&nbsp;<span class="op" id="2232690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232693">i</span>&nbsp;<span class="op" id="2232695">:=</span>&nbsp;<span class="num" id="2232698">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232701">b</span><span class="op" id="2232702">.</span><span class="ident" id="2232703">neg</span>&nbsp;<span class="op" id="2232707">=</span>&nbsp;<span class="builtintype" id="2232709">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232716">b</span><span class="op" id="2232717">.</span><span class="ident" id="2232718">trunc</span>&nbsp;<span class="op" id="2232724">=</span>&nbsp;<span class="builtintype" id="2232726">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232734">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232752">if</span>&nbsp;<span class="ident" id="2232755">i</span>&nbsp;<span class="op" id="2232757">&gt;=</span>&nbsp;<span class="builtinfunc" id="2232760">len</span><span class="op" id="2232763">(</span><span class="ident" id="2232764">s</span><span class="op" id="2232765">)</span>&nbsp;<span class="op" id="2232767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232771">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232779">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232782">switch</span>&nbsp;<span class="op" id="2232789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232792">case</span>&nbsp;<span class="ident" id="2232797">s</span><span class="op" id="2232798">[</span><span class="ident" id="2232799">i</span><span class="op" id="2232800">]</span>&nbsp;<span class="op" id="2232802">==</span>&nbsp;<span class="string" id="2232805">&#39;+&#39;</span><span class="op" id="2232808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232812">i</span><span class="op" id="2232813">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232817">case</span>&nbsp;<span class="ident" id="2232822">s</span><span class="op" id="2232823">[</span><span class="ident" id="2232824">i</span><span class="op" id="2232825">]</span>&nbsp;<span class="op" id="2232827">==</span>&nbsp;<span class="string" id="2232830">&#39;-&#39;</span><span class="op" id="2232833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232837">b</span><span class="op" id="2232838">.</span><span class="ident" id="2232839">neg</span>&nbsp;<span class="op" id="2232843">=</span>&nbsp;<span class="builtintype" id="2232845">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232852">i</span><span class="op" id="2232853">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232861">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232872">sawdot</span>&nbsp;<span class="op" id="2232879">:=</span>&nbsp;<span class="builtintype" id="2232882">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232889">sawdigits</span>&nbsp;<span class="op" id="2232899">:=</span>&nbsp;<span class="builtintype" id="2232902">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232909">for</span>&nbsp;<span class="op" id="2232913">;</span>&nbsp;<span class="ident" id="2232915">i</span>&nbsp;<span class="op" id="2232917">&lt;</span>&nbsp;<span class="builtinfunc" id="2232919">len</span><span class="op" id="2232922">(</span><span class="ident" id="2232923">s</span><span class="op" id="2232924">)</span><span class="op" id="2232925">;</span>&nbsp;<span class="ident" id="2232927">i</span><span class="op" id="2232928">++</span>&nbsp;<span class="op" id="2232931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232935">switch</span>&nbsp;<span class="op" id="2232942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232946">case</span>&nbsp;<span class="ident" id="2232951">s</span><span class="op" id="2232952">[</span><span class="ident" id="2232953">i</span><span class="op" id="2232954">]</span>&nbsp;<span class="op" id="2232956">==</span>&nbsp;<span class="string" id="2232959">&#39;.&#39;</span><span class="op" id="2232962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232967">if</span>&nbsp;<span class="ident" id="2232970">sawdot</span>&nbsp;<span class="op" id="2232977">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232983">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232998">sawdot</span>&nbsp;<span class="op" id="2233005">=</span>&nbsp;<span class="builtintype" id="2233007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233015">b</span><span class="op" id="2233016">.</span><span class="ident" id="2233017">dp</span>&nbsp;<span class="op" id="2233020">=</span>&nbsp;<span class="ident" id="2233022">b</span><span class="op" id="2233023">.</span><span class="ident" id="2233024">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233030">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233042">case</span>&nbsp;<span class="string" id="2233047">&#39;0&#39;</span>&nbsp;<span class="op" id="2233051">&lt;=</span>&nbsp;<span class="ident" id="2233054">s</span><span class="op" id="2233055">[</span><span class="ident" id="2233056">i</span><span class="op" id="2233057">]</span>&nbsp;<span class="op" id="2233059">&amp;&amp;</span>&nbsp;<span class="ident" id="2233062">s</span><span class="op" id="2233063">[</span><span class="ident" id="2233064">i</span><span class="op" id="2233065">]</span>&nbsp;<span class="op" id="2233067">&lt;=</span>&nbsp;<span class="string" id="2233070">&#39;9&#39;</span><span class="op" id="2233073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233078">sawdigits</span>&nbsp;<span class="op" id="2233088">=</span>&nbsp;<span class="builtintype" id="2233090">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233098">if</span>&nbsp;<span class="ident" id="2233101">s</span><span class="op" id="2233102">[</span><span class="ident" id="2233103">i</span><span class="op" id="2233104">]</span>&nbsp;<span class="op" id="2233106">==</span>&nbsp;<span class="string" id="2233109">&#39;0&#39;</span>&nbsp;<span class="op" id="2233113">&amp;&amp;</span>&nbsp;<span class="ident" id="2233116">b</span><span class="op" id="2233117">.</span><span class="ident" id="2233118">nd</span>&nbsp;<span class="op" id="2233121">==</span>&nbsp;<span class="num" id="2233124">0</span>&nbsp;<span class="op" id="2233126">{</span>&nbsp;<span class="comment" id="2233128">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233156">b</span><span class="op" id="2233157">.</span><span class="ident" id="2233158">dp</span><span class="op" id="2233160">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233167">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233184">if</span>&nbsp;<span class="ident" id="2233187">b</span><span class="op" id="2233188">.</span><span class="ident" id="2233189">nd</span>&nbsp;<span class="op" id="2233192">&lt;</span>&nbsp;<span class="builtinfunc" id="2233194">len</span><span class="op" id="2233197">(</span><span class="ident" id="2233198">b</span><span class="op" id="2233199">.</span><span class="ident" id="2233200">d</span><span class="op" id="2233201">)</span>&nbsp;<span class="op" id="2233203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233209">b</span><span class="op" id="2233210">.</span><span class="ident" id="2233211">d</span><span class="op" id="2233212">[</span><span class="ident" id="2233213">b</span><span class="op" id="2233214">.</span><span class="ident" id="2233215">nd</span><span class="op" id="2233217">]</span>&nbsp;<span class="op" id="2233219">=</span>&nbsp;<span class="ident" id="2233221">s</span><span class="op" id="2233222">[</span><span class="ident" id="2233223">i</span><span class="op" id="2233224">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233230">b</span><span class="op" id="2233231">.</span><span class="ident" id="2233232">nd</span><span class="op" id="2233234">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233240">}</span>&nbsp;<span class="keyword" id="2233242">else</span>&nbsp;<span class="keyword" id="2233247">if</span>&nbsp;<span class="ident" id="2233250">s</span><span class="op" id="2233251">[</span><span class="ident" id="2233252">i</span><span class="op" id="2233253">]</span>&nbsp;<span class="op" id="2233255">!=</span>&nbsp;<span class="string" id="2233258">&#39;0&#39;</span>&nbsp;<span class="op" id="2233262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233268">b</span><span class="op" id="2233269">.</span><span class="ident" id="2233270">trunc</span>&nbsp;<span class="op" id="2233276">=</span>&nbsp;<span class="builtintype" id="2233278">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233291">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233302">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233306">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233316">if</span>&nbsp;<span class="op" id="2233319">!</span><span class="ident" id="2233320">sawdigits</span>&nbsp;<span class="op" id="2233330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233334">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233342">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233345">if</span>&nbsp;<span class="op" id="2233348">!</span><span class="ident" id="2233349">sawdot</span>&nbsp;<span class="op" id="2233356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233360">b</span><span class="op" id="2233361">.</span><span class="ident" id="2233362">dp</span>&nbsp;<span class="op" id="2233365">=</span>&nbsp;<span class="ident" id="2233367">b</span><span class="op" id="2233368">.</span><span class="ident" id="2233369">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233377">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233420">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233467">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233513">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233565">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233591">if</span>&nbsp;<span class="ident" id="2233594">i</span>&nbsp;<span class="op" id="2233596">&lt;</span>&nbsp;<span class="builtinfunc" id="2233598">len</span><span class="op" id="2233601">(</span><span class="ident" id="2233602">s</span><span class="op" id="2233603">)</span>&nbsp;<span class="op" id="2233605">&amp;&amp;</span>&nbsp;<span class="op" id="2233608">(</span><span class="ident" id="2233609">s</span><span class="op" id="2233610">[</span><span class="ident" id="2233611">i</span><span class="op" id="2233612">]</span>&nbsp;<span class="op" id="2233614">==</span>&nbsp;<span class="string" id="2233617">&#39;e&#39;</span>&nbsp;<span class="op" id="2233621">||</span>&nbsp;<span class="ident" id="2233624">s</span><span class="op" id="2233625">[</span><span class="ident" id="2233626">i</span><span class="op" id="2233627">]</span>&nbsp;<span class="op" id="2233629">==</span>&nbsp;<span class="string" id="2233632">&#39;E&#39;</span><span class="op" id="2233635">)</span>&nbsp;<span class="op" id="2233637">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233641">i</span><span class="op" id="2233642">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233647">if</span>&nbsp;<span class="ident" id="2233650">i</span>&nbsp;<span class="op" id="2233652">&gt;=</span>&nbsp;<span class="builtinfunc" id="2233655">len</span><span class="op" id="2233658">(</span><span class="ident" id="2233659">s</span><span class="op" id="2233660">)</span>&nbsp;<span class="op" id="2233662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233680">esign</span>&nbsp;<span class="op" id="2233686">:=</span>&nbsp;<span class="num" id="2233689">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233693">if</span>&nbsp;<span class="ident" id="2233696">s</span><span class="op" id="2233697">[</span><span class="ident" id="2233698">i</span><span class="op" id="2233699">]</span>&nbsp;<span class="op" id="2233701">==</span>&nbsp;<span class="string" id="2233704">&#39;+&#39;</span>&nbsp;<span class="op" id="2233708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233713">i</span><span class="op" id="2233714">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233719">}</span>&nbsp;<span class="keyword" id="2233721">else</span>&nbsp;<span class="keyword" id="2233726">if</span>&nbsp;<span class="ident" id="2233729">s</span><span class="op" id="2233730">[</span><span class="ident" id="2233731">i</span><span class="op" id="2233732">]</span>&nbsp;<span class="op" id="2233734">==</span>&nbsp;<span class="string" id="2233737">&#39;-&#39;</span>&nbsp;<span class="op" id="2233741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233746">i</span><span class="op" id="2233747">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233753">esign</span>&nbsp;<span class="op" id="2233759">=</span>&nbsp;<span class="op" id="2233761">-</span><span class="num" id="2233762">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233770">if</span>&nbsp;<span class="ident" id="2233773">i</span>&nbsp;<span class="op" id="2233775">&gt;=</span>&nbsp;<span class="builtinfunc" id="2233778">len</span><span class="op" id="2233781">(</span><span class="ident" id="2233782">s</span><span class="op" id="2233783">)</span>&nbsp;<span class="op" id="2233785">||</span>&nbsp;<span class="ident" id="2233788">s</span><span class="op" id="2233789">[</span><span class="ident" id="2233790">i</span><span class="op" id="2233791">]</span>&nbsp;<span class="op" id="2233793">&lt;</span>&nbsp;<span class="string" id="2233795">&#39;0&#39;</span>&nbsp;<span class="op" id="2233799">||</span>&nbsp;<span class="ident" id="2233802">s</span><span class="op" id="2233803">[</span><span class="ident" id="2233804">i</span><span class="op" id="2233805">]</span>&nbsp;<span class="op" id="2233807">&gt;</span>&nbsp;<span class="string" id="2233809">&#39;9&#39;</span>&nbsp;<span class="op" id="2233813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233831">e</span>&nbsp;<span class="op" id="2233833">:=</span>&nbsp;<span class="num" id="2233836">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233840">for</span>&nbsp;<span class="op" id="2233844">;</span>&nbsp;<span class="ident" id="2233846">i</span>&nbsp;<span class="op" id="2233848">&lt;</span>&nbsp;<span class="builtinfunc" id="2233850">len</span><span class="op" id="2233853">(</span><span class="ident" id="2233854">s</span><span class="op" id="2233855">)</span>&nbsp;<span class="op" id="2233857">&amp;&amp;</span>&nbsp;<span class="string" id="2233860">&#39;0&#39;</span>&nbsp;<span class="op" id="2233864">&lt;=</span>&nbsp;<span class="ident" id="2233867">s</span><span class="op" id="2233868">[</span><span class="ident" id="2233869">i</span><span class="op" id="2233870">]</span>&nbsp;<span class="op" id="2233872">&amp;&amp;</span>&nbsp;<span class="ident" id="2233875">s</span><span class="op" id="2233876">[</span><span class="ident" id="2233877">i</span><span class="op" id="2233878">]</span>&nbsp;<span class="op" id="2233880">&lt;=</span>&nbsp;<span class="string" id="2233883">&#39;9&#39;</span><span class="op" id="2233886">;</span>&nbsp;<span class="ident" id="2233888">i</span><span class="op" id="2233889">++</span>&nbsp;<span class="op" id="2233892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233897">if</span>&nbsp;<span class="ident" id="2233900">e</span>&nbsp;<span class="op" id="2233902">&lt;</span>&nbsp;<span class="num" id="2233904">10000</span>&nbsp;<span class="op" id="2233910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233916">e</span>&nbsp;<span class="op" id="2233918">=</span>&nbsp;<span class="ident" id="2233920">e</span><span class="op" id="2233921">*</span><span class="num" id="2233922">10</span>&nbsp;<span class="op" id="2233925">+</span>&nbsp;<span class="builtintype" id="2233927">int</span><span class="op" id="2233930">(</span><span class="ident" id="2233931">s</span><span class="op" id="2233932">[</span><span class="ident" id="2233933">i</span><span class="op" id="2233934">]</span><span class="op" id="2233935">)</span>&nbsp;<span class="op" id="2233937">-</span>&nbsp;<span class="string" id="2233939">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233950">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233954">b</span><span class="op" id="2233955">.</span><span class="ident" id="2233956">dp</span>&nbsp;<span class="op" id="2233959">+=</span>&nbsp;<span class="ident" id="2233962">e</span>&nbsp;<span class="op" id="2233964">*</span>&nbsp;<span class="ident" id="2233966">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233977">if</span>&nbsp;<span class="ident" id="2233980">i</span>&nbsp;<span class="op" id="2233982">!=</span>&nbsp;<span class="builtinfunc" id="2233985">len</span><span class="op" id="2233988">(</span><span class="ident" id="2233989">s</span><span class="op" id="2233990">)</span>&nbsp;<span class="op" id="2233992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233996">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234008">ok</span>&nbsp;<span class="op" id="2234011">=</span>&nbsp;<span class="builtintype" id="2234013">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234019">return</span><br>
<span class="lineno"></span><span class="op" id="2234026">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2234029">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2234093">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2234159">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2234198">func</span>&nbsp;<span class="ident" id="2234203">readFloat</span><span class="op" id="2234212">(</span><span class="ident" id="2234213">s</span>&nbsp;<span class="builtintype" id="2234215">string</span><span class="op" id="2234221">)</span>&nbsp;<span class="op" id="2234223">(</span><span class="ident" id="2234224">mantissa</span>&nbsp;<span class="ident" id="2234233">uint64</span><span class="op" id="2234239">,</span>&nbsp;<span class="ident" id="2234241">exp</span>&nbsp;<span class="builtintype" id="2234245">int</span><span class="op" id="2234248">,</span>&nbsp;<span class="ident" id="2234250">neg</span><span class="op" id="2234253">,</span>&nbsp;<span class="ident" id="2234255">trunc</span><span class="op" id="2234260">,</span>&nbsp;<span class="ident" id="2234262">ok</span>&nbsp;<span class="builtintype" id="2234265">bool</span><span class="op" id="2234269">)</span>&nbsp;<span class="op" id="2234271">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234274">const</span>&nbsp;<span class="ident" id="2234280">uint64digits</span>&nbsp;<span class="op" id="2234293">=</span>&nbsp;<span class="num" id="2234295">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234299">i</span>&nbsp;<span class="op" id="2234301">:=</span>&nbsp;<span class="num" id="2234304">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234308">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234326">if</span>&nbsp;<span class="ident" id="2234329">i</span>&nbsp;<span class="op" id="2234331">&gt;=</span>&nbsp;<span class="builtinfunc" id="2234334">len</span><span class="op" id="2234337">(</span><span class="ident" id="2234338">s</span><span class="op" id="2234339">)</span>&nbsp;<span class="op" id="2234341">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234345">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234356">switch</span>&nbsp;<span class="op" id="2234363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234366">case</span>&nbsp;<span class="ident" id="2234371">s</span><span class="op" id="2234372">[</span><span class="ident" id="2234373">i</span><span class="op" id="2234374">]</span>&nbsp;<span class="op" id="2234376">==</span>&nbsp;<span class="string" id="2234379">&#39;+&#39;</span><span class="op" id="2234382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234386">i</span><span class="op" id="2234387">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234391">case</span>&nbsp;<span class="ident" id="2234396">s</span><span class="op" id="2234397">[</span><span class="ident" id="2234398">i</span><span class="op" id="2234399">]</span>&nbsp;<span class="op" id="2234401">==</span>&nbsp;<span class="string" id="2234404">&#39;-&#39;</span><span class="op" id="2234407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234411">neg</span>&nbsp;<span class="op" id="2234415">=</span>&nbsp;<span class="builtintype" id="2234417">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234424">i</span><span class="op" id="2234425">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234433">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234444">sawdot</span>&nbsp;<span class="op" id="2234451">:=</span>&nbsp;<span class="builtintype" id="2234454">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234461">sawdigits</span>&nbsp;<span class="op" id="2234471">:=</span>&nbsp;<span class="builtintype" id="2234474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234481">nd</span>&nbsp;<span class="op" id="2234484">:=</span>&nbsp;<span class="num" id="2234487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234490">ndMant</span>&nbsp;<span class="op" id="2234497">:=</span>&nbsp;<span class="num" id="2234500">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234503">dp</span>&nbsp;<span class="op" id="2234506">:=</span>&nbsp;<span class="num" id="2234509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234512">for</span>&nbsp;<span class="op" id="2234516">;</span>&nbsp;<span class="ident" id="2234518">i</span>&nbsp;<span class="op" id="2234520">&lt;</span>&nbsp;<span class="builtinfunc" id="2234522">len</span><span class="op" id="2234525">(</span><span class="ident" id="2234526">s</span><span class="op" id="2234527">)</span><span class="op" id="2234528">;</span>&nbsp;<span class="ident" id="2234530">i</span><span class="op" id="2234531">++</span>&nbsp;<span class="op" id="2234534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234538">switch</span>&nbsp;<span class="ident" id="2234545">c</span>&nbsp;<span class="op" id="2234547">:=</span>&nbsp;<span class="ident" id="2234550">s</span><span class="op" id="2234551">[</span><span class="ident" id="2234552">i</span><span class="op" id="2234553">]</span><span class="op" id="2234554">;</span>&nbsp;<span class="builtintype" id="2234556">true</span>&nbsp;<span class="op" id="2234561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234565">case</span>&nbsp;<span class="ident" id="2234570">c</span>&nbsp;<span class="op" id="2234572">==</span>&nbsp;<span class="string" id="2234575">&#39;.&#39;</span><span class="op" id="2234578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234583">if</span>&nbsp;<span class="ident" id="2234586">sawdot</span>&nbsp;<span class="op" id="2234593">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234614">sawdot</span>&nbsp;<span class="op" id="2234621">=</span>&nbsp;<span class="builtintype" id="2234623">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234631">dp</span>&nbsp;<span class="op" id="2234634">=</span>&nbsp;<span class="ident" id="2234636">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234642">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234654">case</span>&nbsp;<span class="string" id="2234659">&#39;0&#39;</span>&nbsp;<span class="op" id="2234663">&lt;=</span>&nbsp;<span class="ident" id="2234666">c</span>&nbsp;<span class="op" id="2234668">&amp;&amp;</span>&nbsp;<span class="ident" id="2234671">c</span>&nbsp;<span class="op" id="2234673">&lt;=</span>&nbsp;<span class="string" id="2234676">&#39;9&#39;</span><span class="op" id="2234679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234684">sawdigits</span>&nbsp;<span class="op" id="2234694">=</span>&nbsp;<span class="builtintype" id="2234696">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234704">if</span>&nbsp;<span class="ident" id="2234707">c</span>&nbsp;<span class="op" id="2234709">==</span>&nbsp;<span class="string" id="2234712">&#39;0&#39;</span>&nbsp;<span class="op" id="2234716">&amp;&amp;</span>&nbsp;<span class="ident" id="2234719">nd</span>&nbsp;<span class="op" id="2234722">==</span>&nbsp;<span class="num" id="2234725">0</span>&nbsp;<span class="op" id="2234727">{</span>&nbsp;<span class="comment" id="2234729">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234757">dp</span><span class="op" id="2234759">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234766">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234783">nd</span><span class="op" id="2234785">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234791">if</span>&nbsp;<span class="ident" id="2234794">ndMant</span>&nbsp;<span class="op" id="2234801">&lt;</span>&nbsp;<span class="ident" id="2234803">uint64digits</span>&nbsp;<span class="op" id="2234816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234822">mantissa</span>&nbsp;<span class="op" id="2234831">*=</span>&nbsp;<span class="num" id="2234834">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234841">mantissa</span>&nbsp;<span class="op" id="2234850">+=</span>&nbsp;<span class="ident" id="2234853">uint64</span><span class="op" id="2234859">(</span><span class="ident" id="2234860">c</span>&nbsp;<span class="op" id="2234862">-</span>&nbsp;<span class="string" id="2234864">&#39;0&#39;</span><span class="op" id="2234867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234873">ndMant</span><span class="op" id="2234879">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234885">}</span>&nbsp;<span class="keyword" id="2234887">else</span>&nbsp;<span class="keyword" id="2234892">if</span>&nbsp;<span class="ident" id="2234895">s</span><span class="op" id="2234896">[</span><span class="ident" id="2234897">i</span><span class="op" id="2234898">]</span>&nbsp;<span class="op" id="2234900">!=</span>&nbsp;<span class="string" id="2234903">&#39;0&#39;</span>&nbsp;<span class="op" id="2234907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234913">trunc</span>&nbsp;<span class="op" id="2234919">=</span>&nbsp;<span class="builtintype" id="2234921">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234929">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234934">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234949">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234959">if</span>&nbsp;<span class="op" id="2234962">!</span><span class="ident" id="2234963">sawdigits</span>&nbsp;<span class="op" id="2234973">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234977">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234988">if</span>&nbsp;<span class="op" id="2234991">!</span><span class="ident" id="2234992">sawdot</span>&nbsp;<span class="op" id="2234999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235003">dp</span>&nbsp;<span class="op" id="2235006">=</span>&nbsp;<span class="ident" id="2235008">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235012">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235016">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235059">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235106">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235152">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235204">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235230">if</span>&nbsp;<span class="ident" id="2235233">i</span>&nbsp;<span class="op" id="2235235">&lt;</span>&nbsp;<span class="builtinfunc" id="2235237">len</span><span class="op" id="2235240">(</span><span class="ident" id="2235241">s</span><span class="op" id="2235242">)</span>&nbsp;<span class="op" id="2235244">&amp;&amp;</span>&nbsp;<span class="op" id="2235247">(</span><span class="ident" id="2235248">s</span><span class="op" id="2235249">[</span><span class="ident" id="2235250">i</span><span class="op" id="2235251">]</span>&nbsp;<span class="op" id="2235253">==</span>&nbsp;<span class="string" id="2235256">&#39;e&#39;</span>&nbsp;<span class="op" id="2235260">||</span>&nbsp;<span class="ident" id="2235263">s</span><span class="op" id="2235264">[</span><span class="ident" id="2235265">i</span><span class="op" id="2235266">]</span>&nbsp;<span class="op" id="2235268">==</span>&nbsp;<span class="string" id="2235271">&#39;E&#39;</span><span class="op" id="2235274">)</span>&nbsp;<span class="op" id="2235276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235280">i</span><span class="op" id="2235281">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235286">if</span>&nbsp;<span class="ident" id="2235289">i</span>&nbsp;<span class="op" id="2235291">&gt;=</span>&nbsp;<span class="builtinfunc" id="2235294">len</span><span class="op" id="2235297">(</span><span class="ident" id="2235298">s</span><span class="op" id="2235299">)</span>&nbsp;<span class="op" id="2235301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235306">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235319">esign</span>&nbsp;<span class="op" id="2235325">:=</span>&nbsp;<span class="num" id="2235328">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235332">if</span>&nbsp;<span class="ident" id="2235335">s</span><span class="op" id="2235336">[</span><span class="ident" id="2235337">i</span><span class="op" id="2235338">]</span>&nbsp;<span class="op" id="2235340">==</span>&nbsp;<span class="string" id="2235343">&#39;+&#39;</span>&nbsp;<span class="op" id="2235347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235352">i</span><span class="op" id="2235353">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235358">}</span>&nbsp;<span class="keyword" id="2235360">else</span>&nbsp;<span class="keyword" id="2235365">if</span>&nbsp;<span class="ident" id="2235368">s</span><span class="op" id="2235369">[</span><span class="ident" id="2235370">i</span><span class="op" id="2235371">]</span>&nbsp;<span class="op" id="2235373">==</span>&nbsp;<span class="string" id="2235376">&#39;-&#39;</span>&nbsp;<span class="op" id="2235380">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235385">i</span><span class="op" id="2235386">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235392">esign</span>&nbsp;<span class="op" id="2235398">=</span>&nbsp;<span class="op" id="2235400">-</span><span class="num" id="2235401">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235409">if</span>&nbsp;<span class="ident" id="2235412">i</span>&nbsp;<span class="op" id="2235414">&gt;=</span>&nbsp;<span class="builtinfunc" id="2235417">len</span><span class="op" id="2235420">(</span><span class="ident" id="2235421">s</span><span class="op" id="2235422">)</span>&nbsp;<span class="op" id="2235424">||</span>&nbsp;<span class="ident" id="2235427">s</span><span class="op" id="2235428">[</span><span class="ident" id="2235429">i</span><span class="op" id="2235430">]</span>&nbsp;<span class="op" id="2235432">&lt;</span>&nbsp;<span class="string" id="2235434">&#39;0&#39;</span>&nbsp;<span class="op" id="2235438">||</span>&nbsp;<span class="ident" id="2235441">s</span><span class="op" id="2235442">[</span><span class="ident" id="2235443">i</span><span class="op" id="2235444">]</span>&nbsp;<span class="op" id="2235446">&gt;</span>&nbsp;<span class="string" id="2235448">&#39;9&#39;</span>&nbsp;<span class="op" id="2235452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235457">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235470">e</span>&nbsp;<span class="op" id="2235472">:=</span>&nbsp;<span class="num" id="2235475">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235479">for</span>&nbsp;<span class="op" id="2235483">;</span>&nbsp;<span class="ident" id="2235485">i</span>&nbsp;<span class="op" id="2235487">&lt;</span>&nbsp;<span class="builtinfunc" id="2235489">len</span><span class="op" id="2235492">(</span><span class="ident" id="2235493">s</span><span class="op" id="2235494">)</span>&nbsp;<span class="op" id="2235496">&amp;&amp;</span>&nbsp;<span class="string" id="2235499">&#39;0&#39;</span>&nbsp;<span class="op" id="2235503">&lt;=</span>&nbsp;<span class="ident" id="2235506">s</span><span class="op" id="2235507">[</span><span class="ident" id="2235508">i</span><span class="op" id="2235509">]</span>&nbsp;<span class="op" id="2235511">&amp;&amp;</span>&nbsp;<span class="ident" id="2235514">s</span><span class="op" id="2235515">[</span><span class="ident" id="2235516">i</span><span class="op" id="2235517">]</span>&nbsp;<span class="op" id="2235519">&lt;=</span>&nbsp;<span class="string" id="2235522">&#39;9&#39;</span><span class="op" id="2235525">;</span>&nbsp;<span class="ident" id="2235527">i</span><span class="op" id="2235528">++</span>&nbsp;<span class="op" id="2235531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235536">if</span>&nbsp;<span class="ident" id="2235539">e</span>&nbsp;<span class="op" id="2235541">&lt;</span>&nbsp;<span class="num" id="2235543">10000</span>&nbsp;<span class="op" id="2235549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235555">e</span>&nbsp;<span class="op" id="2235557">=</span>&nbsp;<span class="ident" id="2235559">e</span><span class="op" id="2235560">*</span><span class="num" id="2235561">10</span>&nbsp;<span class="op" id="2235564">+</span>&nbsp;<span class="builtintype" id="2235566">int</span><span class="op" id="2235569">(</span><span class="ident" id="2235570">s</span><span class="op" id="2235571">[</span><span class="ident" id="2235572">i</span><span class="op" id="2235573">]</span><span class="op" id="2235574">)</span>&nbsp;<span class="op" id="2235576">-</span>&nbsp;<span class="string" id="2235578">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235593">dp</span>&nbsp;<span class="op" id="2235596">+=</span>&nbsp;<span class="ident" id="2235599">e</span>&nbsp;<span class="op" id="2235601">*</span>&nbsp;<span class="ident" id="2235603">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235614">if</span>&nbsp;<span class="ident" id="2235617">i</span>&nbsp;<span class="op" id="2235619">!=</span>&nbsp;<span class="builtinfunc" id="2235622">len</span><span class="op" id="2235625">(</span><span class="ident" id="2235626">s</span><span class="op" id="2235627">)</span>&nbsp;<span class="op" id="2235629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235633">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235645">exp</span>&nbsp;<span class="op" id="2235649">=</span>&nbsp;<span class="ident" id="2235651">dp</span>&nbsp;<span class="op" id="2235654">-</span>&nbsp;<span class="ident" id="2235656">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235664">ok</span>&nbsp;<span class="op" id="2235667">=</span>&nbsp;<span class="builtintype" id="2235669">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235675">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2235683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2235686">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2235734">var</span>&nbsp;<span class="ident" id="2235738">powtab</span>&nbsp;<span class="op" id="2235745">=</span>&nbsp;<span class="op" id="2235747">[</span><span class="op" id="2235748">]</span><span class="builtintype" id="2235749">int</span><span class="op" id="2235752">{</span><span class="num" id="2235753">1</span><span class="op" id="2235754">,</span>&nbsp;<span class="num" id="2235756">3</span><span class="op" id="2235757">,</span>&nbsp;<span class="num" id="2235759">6</span><span class="op" id="2235760">,</span>&nbsp;<span class="num" id="2235762">9</span><span class="op" id="2235763">,</span>&nbsp;<span class="num" id="2235765">13</span><span class="op" id="2235767">,</span>&nbsp;<span class="num" id="2235769">16</span><span class="op" id="2235771">,</span>&nbsp;<span class="num" id="2235773">19</span><span class="op" id="2235775">,</span>&nbsp;<span class="num" id="2235777">23</span><span class="op" id="2235779">,</span>&nbsp;<span class="num" id="2235781">26</span><span class="op" id="2235783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235786">func</span>&nbsp;<span class="op" id="2235791">(</span><span class="ident" id="2235792">d</span>&nbsp;<span class="op" id="2235794">*</span><span class="ident" id="2235795">decimal</span><span class="op" id="2235802">)</span>&nbsp;<span class="ident" id="2235804">floatBits</span><span class="op" id="2235813">(</span><span class="ident" id="2235814">flt</span>&nbsp;<span class="op" id="2235818">*</span><span class="ident" id="2235819">floatInfo</span><span class="op" id="2235828">)</span>&nbsp;<span class="op" id="2235830">(</span><span class="ident" id="2235831">b</span>&nbsp;<span class="ident" id="2235833">uint64</span><span class="op" id="2235839">,</span>&nbsp;<span class="ident" id="2235841">overflow</span>&nbsp;<span class="builtintype" id="2235850">bool</span><span class="op" id="2235854">)</span>&nbsp;<span class="op" id="2235856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235859">var</span>&nbsp;<span class="ident" id="2235863">exp</span>&nbsp;<span class="builtintype" id="2235867">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235872">var</span>&nbsp;<span class="ident" id="2235876">mant</span>&nbsp;<span class="ident" id="2235881">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235890">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235925">if</span>&nbsp;<span class="ident" id="2235928">d</span><span class="op" id="2235929">.</span><span class="ident" id="2235930">nd</span>&nbsp;<span class="op" id="2235933">==</span>&nbsp;<span class="num" id="2235936">0</span>&nbsp;<span class="op" id="2235938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235942">mant</span>&nbsp;<span class="op" id="2235947">=</span>&nbsp;<span class="num" id="2235949">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235953">exp</span>&nbsp;<span class="op" id="2235957">=</span>&nbsp;<span class="ident" id="2235959">flt</span><span class="op" id="2235962">.</span><span class="ident" id="2235963">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235970">goto</span>&nbsp;<span class="ident" id="2235975">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2235984">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236016">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236056">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236131">if</span>&nbsp;<span class="ident" id="2236134">d</span><span class="op" id="2236135">.</span><span class="ident" id="2236136">dp</span>&nbsp;<span class="op" id="2236139">&gt;</span>&nbsp;<span class="num" id="2236141">310</span>&nbsp;<span class="op" id="2236145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236149">goto</span>&nbsp;<span class="ident" id="2236154">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236164">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236167">if</span>&nbsp;<span class="ident" id="2236170">d</span><span class="op" id="2236171">.</span><span class="ident" id="2236172">dp</span>&nbsp;<span class="op" id="2236175">&lt;</span>&nbsp;<span class="op" id="2236177">-</span><span class="num" id="2236178">330</span>&nbsp;<span class="op" id="2236182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236186">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236196">mant</span>&nbsp;<span class="op" id="2236201">=</span>&nbsp;<span class="num" id="2236203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236207">exp</span>&nbsp;<span class="op" id="2236211">=</span>&nbsp;<span class="ident" id="2236213">flt</span><span class="op" id="2236216">.</span><span class="ident" id="2236217">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236224">goto</span>&nbsp;<span class="ident" id="2236229">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236238">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236291">exp</span>&nbsp;<span class="op" id="2236295">=</span>&nbsp;<span class="num" id="2236297">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236300">for</span>&nbsp;<span class="ident" id="2236304">d</span><span class="op" id="2236305">.</span><span class="ident" id="2236306">dp</span>&nbsp;<span class="op" id="2236309">&gt;</span>&nbsp;<span class="num" id="2236311">0</span>&nbsp;<span class="op" id="2236313">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236317">var</span>&nbsp;<span class="ident" id="2236321">n</span>&nbsp;<span class="builtintype" id="2236323">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236329">if</span>&nbsp;<span class="ident" id="2236332">d</span><span class="op" id="2236333">.</span><span class="ident" id="2236334">dp</span>&nbsp;<span class="op" id="2236337">&gt;=</span>&nbsp;<span class="builtinfunc" id="2236340">len</span><span class="op" id="2236343">(</span><span class="ident" id="2236344">powtab</span><span class="op" id="2236350">)</span>&nbsp;<span class="op" id="2236352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236357">n</span>&nbsp;<span class="op" id="2236359">=</span>&nbsp;<span class="num" id="2236361">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236366">}</span>&nbsp;<span class="keyword" id="2236368">else</span>&nbsp;<span class="op" id="2236373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236378">n</span>&nbsp;<span class="op" id="2236380">=</span>&nbsp;<span class="ident" id="2236382">powtab</span><span class="op" id="2236388">[</span><span class="ident" id="2236389">d</span><span class="op" id="2236390">.</span><span class="ident" id="2236391">dp</span><span class="op" id="2236393">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236401">d</span><span class="op" id="2236402">.</span><span class="ident" id="2236403">Shift</span><span class="op" id="2236408">(</span><span class="op" id="2236409">-</span><span class="ident" id="2236410">n</span><span class="op" id="2236411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236415">exp</span>&nbsp;<span class="op" id="2236419">+=</span>&nbsp;<span class="ident" id="2236422">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236428">for</span>&nbsp;<span class="ident" id="2236432">d</span><span class="op" id="2236433">.</span><span class="ident" id="2236434">dp</span>&nbsp;<span class="op" id="2236437">&lt;</span>&nbsp;<span class="num" id="2236439">0</span>&nbsp;<span class="op" id="2236441">||</span>&nbsp;<span class="ident" id="2236444">d</span><span class="op" id="2236445">.</span><span class="ident" id="2236446">dp</span>&nbsp;<span class="op" id="2236449">==</span>&nbsp;<span class="num" id="2236452">0</span>&nbsp;<span class="op" id="2236454">&amp;&amp;</span>&nbsp;<span class="ident" id="2236457">d</span><span class="op" id="2236458">.</span><span class="ident" id="2236459">d</span><span class="op" id="2236460">[</span><span class="num" id="2236461">0</span><span class="op" id="2236462">]</span>&nbsp;<span class="op" id="2236464">&lt;</span>&nbsp;<span class="string" id="2236466">&#39;5&#39;</span>&nbsp;<span class="op" id="2236470">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236474">var</span>&nbsp;<span class="ident" id="2236478">n</span>&nbsp;<span class="builtintype" id="2236480">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236486">if</span>&nbsp;<span class="op" id="2236489">-</span><span class="ident" id="2236490">d</span><span class="op" id="2236491">.</span><span class="ident" id="2236492">dp</span>&nbsp;<span class="op" id="2236495">&gt;=</span>&nbsp;<span class="builtinfunc" id="2236498">len</span><span class="op" id="2236501">(</span><span class="ident" id="2236502">powtab</span><span class="op" id="2236508">)</span>&nbsp;<span class="op" id="2236510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236515">n</span>&nbsp;<span class="op" id="2236517">=</span>&nbsp;<span class="num" id="2236519">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236524">}</span>&nbsp;<span class="keyword" id="2236526">else</span>&nbsp;<span class="op" id="2236531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236536">n</span>&nbsp;<span class="op" id="2236538">=</span>&nbsp;<span class="ident" id="2236540">powtab</span><span class="op" id="2236546">[</span><span class="op" id="2236547">-</span><span class="ident" id="2236548">d</span><span class="op" id="2236549">.</span><span class="ident" id="2236550">dp</span><span class="op" id="2236552">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236560">d</span><span class="op" id="2236561">.</span><span class="ident" id="2236562">Shift</span><span class="op" id="2236567">(</span><span class="ident" id="2236568">n</span><span class="op" id="2236569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236573">exp</span>&nbsp;<span class="op" id="2236577">-=</span>&nbsp;<span class="ident" id="2236580">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236587">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236647">exp</span><span class="op" id="2236650">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236655">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236705">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236752">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236778">if</span>&nbsp;<span class="ident" id="2236781">exp</span>&nbsp;<span class="op" id="2236785">&lt;</span>&nbsp;<span class="ident" id="2236787">flt</span><span class="op" id="2236790">.</span><span class="ident" id="2236791">bias</span><span class="op" id="2236795">+</span><span class="num" id="2236796">1</span>&nbsp;<span class="op" id="2236798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236802">n</span>&nbsp;<span class="op" id="2236804">:=</span>&nbsp;<span class="ident" id="2236807">flt</span><span class="op" id="2236810">.</span><span class="ident" id="2236811">bias</span>&nbsp;<span class="op" id="2236816">+</span>&nbsp;<span class="num" id="2236818">1</span>&nbsp;<span class="op" id="2236820">-</span>&nbsp;<span class="ident" id="2236822">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236828">d</span><span class="op" id="2236829">.</span><span class="ident" id="2236830">Shift</span><span class="op" id="2236835">(</span><span class="op" id="2236836">-</span><span class="ident" id="2236837">n</span><span class="op" id="2236838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236842">exp</span>&nbsp;<span class="op" id="2236846">+=</span>&nbsp;<span class="ident" id="2236849">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236856">if</span>&nbsp;<span class="ident" id="2236859">exp</span><span class="op" id="2236862">-</span><span class="ident" id="2236863">flt</span><span class="op" id="2236866">.</span><span class="ident" id="2236867">bias</span>&nbsp;<span class="op" id="2236872">&gt;=</span>&nbsp;<span class="num" id="2236875">1</span><span class="op" id="2236876">&lt;&lt;</span><span class="ident" id="2236878">flt</span><span class="op" id="2236881">.</span><span class="ident" id="2236882">expbits</span><span class="op" id="2236889">-</span><span class="num" id="2236890">1</span>&nbsp;<span class="op" id="2236892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236896">goto</span>&nbsp;<span class="ident" id="2236901">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236911">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236915">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236948">d</span><span class="op" id="2236949">.</span><span class="ident" id="2236950">Shift</span><span class="op" id="2236955">(</span><span class="builtintype" id="2236956">int</span><span class="op" id="2236959">(</span><span class="num" id="2236960">1</span>&nbsp;<span class="op" id="2236962">+</span>&nbsp;<span class="ident" id="2236964">flt</span><span class="op" id="2236967">.</span><span class="ident" id="2236968">mantbits</span><span class="op" id="2236976">)</span><span class="op" id="2236977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236980">mant</span>&nbsp;<span class="op" id="2236985">=</span>&nbsp;<span class="ident" id="2236987">d</span><span class="op" id="2236988">.</span><span class="ident" id="2236989">RoundedInteger</span><span class="op" id="2237003">(</span><span class="op" id="2237004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237008">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237057">if</span>&nbsp;<span class="ident" id="2237060">mant</span>&nbsp;<span class="op" id="2237065">==</span>&nbsp;<span class="num" id="2237068">2</span><span class="op" id="2237069">&lt;&lt;</span><span class="ident" id="2237071">flt</span><span class="op" id="2237074">.</span><span class="ident" id="2237075">mantbits</span>&nbsp;<span class="op" id="2237084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237088">mant</span>&nbsp;<span class="op" id="2237093">&gt;&gt;=</span>&nbsp;<span class="num" id="2237097">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237101">exp</span><span class="op" id="2237104">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237109">if</span>&nbsp;<span class="ident" id="2237112">exp</span><span class="op" id="2237115">-</span><span class="ident" id="2237116">flt</span><span class="op" id="2237119">.</span><span class="ident" id="2237120">bias</span>&nbsp;<span class="op" id="2237125">&gt;=</span>&nbsp;<span class="num" id="2237128">1</span><span class="op" id="2237129">&lt;&lt;</span><span class="ident" id="2237131">flt</span><span class="op" id="2237134">.</span><span class="ident" id="2237135">expbits</span><span class="op" id="2237142">-</span><span class="num" id="2237143">1</span>&nbsp;<span class="op" id="2237145">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237150">goto</span>&nbsp;<span class="ident" id="2237155">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237173">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237191">if</span>&nbsp;<span class="ident" id="2237194">mant</span><span class="op" id="2237198">&amp;</span><span class="op" id="2237199">(</span><span class="num" id="2237200">1</span><span class="op" id="2237201">&lt;&lt;</span><span class="ident" id="2237203">flt</span><span class="op" id="2237206">.</span><span class="ident" id="2237207">mantbits</span><span class="op" id="2237215">)</span>&nbsp;<span class="op" id="2237217">==</span>&nbsp;<span class="num" id="2237220">0</span>&nbsp;<span class="op" id="2237222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237226">exp</span>&nbsp;<span class="op" id="2237230">=</span>&nbsp;<span class="ident" id="2237232">flt</span><span class="op" id="2237235">.</span><span class="ident" id="2237236">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237245">goto</span>&nbsp;<span class="ident" id="2237250">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2237255">overflow</span><span class="op" id="2237263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237266">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237276">mant</span>&nbsp;<span class="op" id="2237281">=</span>&nbsp;<span class="num" id="2237283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237286">exp</span>&nbsp;<span class="op" id="2237290">=</span>&nbsp;<span class="num" id="2237292">1</span><span class="op" id="2237293">&lt;&lt;</span><span class="ident" id="2237295">flt</span><span class="op" id="2237298">.</span><span class="ident" id="2237299">expbits</span>&nbsp;<span class="op" id="2237307">-</span>&nbsp;<span class="num" id="2237309">1</span>&nbsp;<span class="op" id="2237311">+</span>&nbsp;<span class="ident" id="2237313">flt</span><span class="op" id="2237316">.</span><span class="ident" id="2237317">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237323">overflow</span>&nbsp;<span class="op" id="2237332">=</span>&nbsp;<span class="builtintype" id="2237334">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2237340">out</span><span class="op" id="2237343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237346">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237365">bits</span>&nbsp;<span class="op" id="2237370">:=</span>&nbsp;<span class="ident" id="2237373">mant</span>&nbsp;<span class="op" id="2237378">&amp;</span>&nbsp;<span class="op" id="2237380">(</span><span class="ident" id="2237381">uint64</span><span class="op" id="2237387">(</span><span class="num" id="2237388">1</span><span class="op" id="2237389">)</span><span class="op" id="2237390">&lt;&lt;</span><span class="ident" id="2237392">flt</span><span class="op" id="2237395">.</span><span class="ident" id="2237396">mantbits</span>&nbsp;<span class="op" id="2237405">-</span>&nbsp;<span class="num" id="2237407">1</span><span class="op" id="2237408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237411">bits</span>&nbsp;<span class="op" id="2237416">|=</span>&nbsp;<span class="ident" id="2237419">uint64</span><span class="op" id="2237425">(</span><span class="op" id="2237426">(</span><span class="ident" id="2237427">exp</span><span class="op" id="2237430">-</span><span class="ident" id="2237431">flt</span><span class="op" id="2237434">.</span><span class="ident" id="2237435">bias</span><span class="op" id="2237439">)</span><span class="op" id="2237440">&amp;</span><span class="op" id="2237441">(</span><span class="num" id="2237442">1</span><span class="op" id="2237443">&lt;&lt;</span><span class="ident" id="2237445">flt</span><span class="op" id="2237448">.</span><span class="ident" id="2237449">expbits</span><span class="op" id="2237456">-</span><span class="num" id="2237457">1</span><span class="op" id="2237458">)</span><span class="op" id="2237459">)</span>&nbsp;<span class="op" id="2237461">&lt;&lt;</span>&nbsp;<span class="ident" id="2237464">flt</span><span class="op" id="2237467">.</span><span class="ident" id="2237468">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237478">if</span>&nbsp;<span class="ident" id="2237481">d</span><span class="op" id="2237482">.</span><span class="ident" id="2237483">neg</span>&nbsp;<span class="op" id="2237487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237491">bits</span>&nbsp;<span class="op" id="2237496">|=</span>&nbsp;<span class="num" id="2237499">1</span>&nbsp;<span class="op" id="2237501">&lt;&lt;</span>&nbsp;<span class="ident" id="2237504">flt</span><span class="op" id="2237507">.</span><span class="ident" id="2237508">mantbits</span>&nbsp;<span class="op" id="2237517">&lt;&lt;</span>&nbsp;<span class="ident" id="2237520">flt</span><span class="op" id="2237523">.</span><span class="ident" id="2237524">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237536">return</span>&nbsp;<span class="ident" id="2237543">bits</span><span class="op" id="2237547">,</span>&nbsp;<span class="ident" id="2237549">overflow</span><br>
<span class="lineno"></span><span class="op" id="2237558">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2237561">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2237584">var</span>&nbsp;<span class="ident" id="2237588">float64pow10</span>&nbsp;<span class="op" id="2237601">=</span>&nbsp;<span class="op" id="2237603">[</span><span class="op" id="2237604">]</span><span class="builtintype" id="2237605">float64</span><span class="op" id="2237612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2237615">1e0</span><span class="op" id="2237618">,</span>&nbsp;<span class="num" id="2237620">1e1</span><span class="op" id="2237623">,</span>&nbsp;<span class="num" id="2237625">1e2</span><span class="op" id="2237628">,</span>&nbsp;<span class="num" id="2237630">1e3</span><span class="op" id="2237633">,</span>&nbsp;<span class="num" id="2237635">1e4</span><span class="op" id="2237638">,</span>&nbsp;<span class="num" id="2237640">1e5</span><span class="op" id="2237643">,</span>&nbsp;<span class="num" id="2237645">1e6</span><span class="op" id="2237648">,</span>&nbsp;<span class="num" id="2237650">1e7</span><span class="op" id="2237653">,</span>&nbsp;<span class="num" id="2237655">1e8</span><span class="op" id="2237658">,</span>&nbsp;<span class="num" id="2237660">1e9</span><span class="op" id="2237663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2237666">1e10</span><span class="op" id="2237670">,</span>&nbsp;<span class="num" id="2237672">1e11</span><span class="op" id="2237676">,</span>&nbsp;<span class="num" id="2237678">1e12</span><span class="op" id="2237682">,</span>&nbsp;<span class="num" id="2237684">1e13</span><span class="op" id="2237688">,</span>&nbsp;<span class="num" id="2237690">1e14</span><span class="op" id="2237694">,</span>&nbsp;<span class="num" id="2237696">1e15</span><span class="op" id="2237700">,</span>&nbsp;<span class="num" id="2237702">1e16</span><span class="op" id="2237706">,</span>&nbsp;<span class="num" id="2237708">1e17</span><span class="op" id="2237712">,</span>&nbsp;<span class="num" id="2237714">1e18</span><span class="op" id="2237718">,</span>&nbsp;<span class="num" id="2237720">1e19</span><span class="op" id="2237724">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2237727">1e20</span><span class="op" id="2237731">,</span>&nbsp;<span class="num" id="2237733">1e21</span><span class="op" id="2237737">,</span>&nbsp;<span class="num" id="2237739">1e22</span><span class="op" id="2237743">,</span><br>
<span class="lineno"></span><span class="op" id="2237745">}</span><br>
<span class="lineno"></span><span class="keyword" id="2237747">var</span>&nbsp;<span class="ident" id="2237751">float32pow10</span>&nbsp;<span class="op" id="2237764">=</span>&nbsp;<span class="op" id="2237766">[</span><span class="op" id="2237767">]</span><span class="builtintype" id="2237768">float32</span><span class="op" id="2237775">{</span><span class="num" id="2237776">1e0</span><span class="op" id="2237779">,</span>&nbsp;<span class="num" id="2237781">1e1</span><span class="op" id="2237784">,</span>&nbsp;<span class="num" id="2237786">1e2</span><span class="op" id="2237789">,</span>&nbsp;<span class="num" id="2237791">1e3</span><span class="op" id="2237794">,</span>&nbsp;<span class="num" id="2237796">1e4</span><span class="op" id="2237799">,</span>&nbsp;<span class="num" id="2237801">1e5</span><span class="op" id="2237804">,</span>&nbsp;<span class="num" id="2237806">1e6</span><span class="op" id="2237809">,</span>&nbsp;<span class="num" id="2237811">1e7</span><span class="op" id="2237814">,</span>&nbsp;<span class="num" id="2237816">1e8</span><span class="op" id="2237819">,</span>&nbsp;<span class="num" id="2237821">1e9</span><span class="op" id="2237824">,</span>&nbsp;<span class="num" id="2237826">1e10</span><span class="op" id="2237830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2237833">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2237909">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2237996">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2238019">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2238045">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2238092">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2238139">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2238211">func</span>&nbsp;<span class="ident" id="2238216">atof64exact</span><span class="op" id="2238227">(</span><span class="ident" id="2238228">mantissa</span>&nbsp;<span class="ident" id="2238237">uint64</span><span class="op" id="2238243">,</span>&nbsp;<span class="ident" id="2238245">exp</span>&nbsp;<span class="builtintype" id="2238249">int</span><span class="op" id="2238252">,</span>&nbsp;<span class="ident" id="2238254">neg</span>&nbsp;<span class="builtintype" id="2238258">bool</span><span class="op" id="2238262">)</span>&nbsp;<span class="op" id="2238264">(</span><span class="ident" id="2238265">f</span>&nbsp;<span class="builtintype" id="2238267">float64</span><span class="op" id="2238274">,</span>&nbsp;<span class="ident" id="2238276">ok</span>&nbsp;<span class="builtintype" id="2238279">bool</span><span class="op" id="2238283">)</span>&nbsp;<span class="op" id="2238285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238288">if</span>&nbsp;<span class="ident" id="2238291">mantissa</span><span class="op" id="2238299">&gt;&gt;</span><span class="ident" id="2238301">float64info</span><span class="op" id="2238312">.</span><span class="ident" id="2238313">mantbits</span>&nbsp;<span class="op" id="2238322">!=</span>&nbsp;<span class="num" id="2238325">0</span>&nbsp;<span class="op" id="2238327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238331">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238339">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238342">f</span>&nbsp;<span class="op" id="2238344">=</span>&nbsp;<span class="builtintype" id="2238346">float64</span><span class="op" id="2238353">(</span><span class="ident" id="2238354">mantissa</span><span class="op" id="2238362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238365">if</span>&nbsp;<span class="ident" id="2238368">neg</span>&nbsp;<span class="op" id="2238372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238376">f</span>&nbsp;<span class="op" id="2238378">=</span>&nbsp;<span class="op" id="2238380">-</span><span class="ident" id="2238381">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238387">switch</span>&nbsp;<span class="op" id="2238394">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238397">case</span>&nbsp;<span class="ident" id="2238402">exp</span>&nbsp;<span class="op" id="2238406">==</span>&nbsp;<span class="num" id="2238409">0</span><span class="op" id="2238410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238414">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238431">return</span>&nbsp;<span class="ident" id="2238438">f</span><span class="op" id="2238439">,</span>&nbsp;<span class="builtintype" id="2238441">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238447">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238480">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238518">case</span>&nbsp;<span class="ident" id="2238523">exp</span>&nbsp;<span class="op" id="2238527">&gt;</span>&nbsp;<span class="num" id="2238529">0</span>&nbsp;<span class="op" id="2238531">&amp;&amp;</span>&nbsp;<span class="ident" id="2238534">exp</span>&nbsp;<span class="op" id="2238538">&lt;=</span>&nbsp;<span class="num" id="2238541">15</span><span class="op" id="2238543">+</span><span class="num" id="2238544">22</span><span class="op" id="2238546">:</span>&nbsp;<span class="comment" id="2238548">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238564">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238617">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238666">if</span>&nbsp;<span class="ident" id="2238669">exp</span>&nbsp;<span class="op" id="2238673">&gt;</span>&nbsp;<span class="num" id="2238675">22</span>&nbsp;<span class="op" id="2238678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238683">f</span>&nbsp;<span class="op" id="2238685">*=</span>&nbsp;<span class="ident" id="2238688">float64pow10</span><span class="op" id="2238700">[</span><span class="ident" id="2238701">exp</span><span class="op" id="2238704">-</span><span class="num" id="2238705">22</span><span class="op" id="2238707">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238712">exp</span>&nbsp;<span class="op" id="2238716">=</span>&nbsp;<span class="num" id="2238718">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238727">if</span>&nbsp;<span class="ident" id="2238730">f</span>&nbsp;<span class="op" id="2238732">&gt;</span>&nbsp;<span class="num" id="2238734">1e15</span>&nbsp;<span class="op" id="2238739">||</span>&nbsp;<span class="ident" id="2238742">f</span>&nbsp;<span class="op" id="2238744">&lt;</span>&nbsp;<span class="op" id="2238746">-</span><span class="num" id="2238747">1e15</span>&nbsp;<span class="op" id="2238752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2238757">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238798">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238811">return</span>&nbsp;<span class="ident" id="2238818">f</span>&nbsp;<span class="op" id="2238820">*</span>&nbsp;<span class="ident" id="2238822">float64pow10</span><span class="op" id="2238834">[</span><span class="ident" id="2238835">exp</span><span class="op" id="2238838">]</span><span class="op" id="2238839">,</span>&nbsp;<span class="builtintype" id="2238841">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238847">case</span>&nbsp;<span class="ident" id="2238852">exp</span>&nbsp;<span class="op" id="2238856">&lt;</span>&nbsp;<span class="num" id="2238858">0</span>&nbsp;<span class="op" id="2238860">&amp;&amp;</span>&nbsp;<span class="ident" id="2238863">exp</span>&nbsp;<span class="op" id="2238867">&gt;=</span>&nbsp;<span class="op" id="2238870">-</span><span class="num" id="2238871">22</span><span class="op" id="2238873">:</span>&nbsp;<span class="comment" id="2238875">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238891">return</span>&nbsp;<span class="ident" id="2238898">f</span>&nbsp;<span class="op" id="2238900">/</span>&nbsp;<span class="ident" id="2238902">float64pow10</span><span class="op" id="2238914">[</span><span class="op" id="2238915">-</span><span class="ident" id="2238916">exp</span><span class="op" id="2238919">]</span><span class="op" id="2238920">,</span>&nbsp;<span class="builtintype" id="2238922">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238928">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238931">return</span><br>
<span class="lineno"></span><span class="op" id="2238938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2238941">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2239010">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2239083">func</span>&nbsp;<span class="ident" id="2239088">atof32exact</span><span class="op" id="2239099">(</span><span class="ident" id="2239100">mantissa</span>&nbsp;<span class="ident" id="2239109">uint64</span><span class="op" id="2239115">,</span>&nbsp;<span class="ident" id="2239117">exp</span>&nbsp;<span class="builtintype" id="2239121">int</span><span class="op" id="2239124">,</span>&nbsp;<span class="ident" id="2239126">neg</span>&nbsp;<span class="builtintype" id="2239130">bool</span><span class="op" id="2239134">)</span>&nbsp;<span class="op" id="2239136">(</span><span class="ident" id="2239137">f</span>&nbsp;<span class="builtintype" id="2239139">float32</span><span class="op" id="2239146">,</span>&nbsp;<span class="ident" id="2239148">ok</span>&nbsp;<span class="builtintype" id="2239151">bool</span><span class="op" id="2239155">)</span>&nbsp;<span class="op" id="2239157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239160">if</span>&nbsp;<span class="ident" id="2239163">mantissa</span><span class="op" id="2239171">&gt;&gt;</span><span class="ident" id="2239173">float32info</span><span class="op" id="2239184">.</span><span class="ident" id="2239185">mantbits</span>&nbsp;<span class="op" id="2239194">!=</span>&nbsp;<span class="num" id="2239197">0</span>&nbsp;<span class="op" id="2239199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239203">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239214">f</span>&nbsp;<span class="op" id="2239216">=</span>&nbsp;<span class="builtintype" id="2239218">float32</span><span class="op" id="2239225">(</span><span class="ident" id="2239226">mantissa</span><span class="op" id="2239234">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239237">if</span>&nbsp;<span class="ident" id="2239240">neg</span>&nbsp;<span class="op" id="2239244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239248">f</span>&nbsp;<span class="op" id="2239250">=</span>&nbsp;<span class="op" id="2239252">-</span><span class="ident" id="2239253">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239259">switch</span>&nbsp;<span class="op" id="2239266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239269">case</span>&nbsp;<span class="ident" id="2239274">exp</span>&nbsp;<span class="op" id="2239278">==</span>&nbsp;<span class="num" id="2239281">0</span><span class="op" id="2239282">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239286">return</span>&nbsp;<span class="ident" id="2239293">f</span><span class="op" id="2239294">,</span>&nbsp;<span class="builtintype" id="2239296">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239302">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239334">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239372">case</span>&nbsp;<span class="ident" id="2239377">exp</span>&nbsp;<span class="op" id="2239381">&gt;</span>&nbsp;<span class="num" id="2239383">0</span>&nbsp;<span class="op" id="2239385">&amp;&amp;</span>&nbsp;<span class="ident" id="2239388">exp</span>&nbsp;<span class="op" id="2239392">&lt;=</span>&nbsp;<span class="num" id="2239395">7</span><span class="op" id="2239396">+</span><span class="num" id="2239397">10</span><span class="op" id="2239399">:</span>&nbsp;<span class="comment" id="2239401">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239417">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239470">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239519">if</span>&nbsp;<span class="ident" id="2239522">exp</span>&nbsp;<span class="op" id="2239526">&gt;</span>&nbsp;<span class="num" id="2239528">10</span>&nbsp;<span class="op" id="2239531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239536">f</span>&nbsp;<span class="op" id="2239538">*=</span>&nbsp;<span class="ident" id="2239541">float32pow10</span><span class="op" id="2239553">[</span><span class="ident" id="2239554">exp</span><span class="op" id="2239557">-</span><span class="num" id="2239558">10</span><span class="op" id="2239560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239565">exp</span>&nbsp;<span class="op" id="2239569">=</span>&nbsp;<span class="num" id="2239571">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239576">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239580">if</span>&nbsp;<span class="ident" id="2239583">f</span>&nbsp;<span class="op" id="2239585">&gt;</span>&nbsp;<span class="num" id="2239587">1e7</span>&nbsp;<span class="op" id="2239591">||</span>&nbsp;<span class="ident" id="2239594">f</span>&nbsp;<span class="op" id="2239596">&lt;</span>&nbsp;<span class="op" id="2239598">-</span><span class="num" id="2239599">1e7</span>&nbsp;<span class="op" id="2239603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239608">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239662">return</span>&nbsp;<span class="ident" id="2239669">f</span>&nbsp;<span class="op" id="2239671">*</span>&nbsp;<span class="ident" id="2239673">float32pow10</span><span class="op" id="2239685">[</span><span class="ident" id="2239686">exp</span><span class="op" id="2239689">]</span><span class="op" id="2239690">,</span>&nbsp;<span class="builtintype" id="2239692">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239698">case</span>&nbsp;<span class="ident" id="2239703">exp</span>&nbsp;<span class="op" id="2239707">&lt;</span>&nbsp;<span class="num" id="2239709">0</span>&nbsp;<span class="op" id="2239711">&amp;&amp;</span>&nbsp;<span class="ident" id="2239714">exp</span>&nbsp;<span class="op" id="2239718">&gt;=</span>&nbsp;<span class="op" id="2239721">-</span><span class="num" id="2239722">10</span><span class="op" id="2239724">:</span>&nbsp;<span class="comment" id="2239726">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239742">return</span>&nbsp;<span class="ident" id="2239749">f</span>&nbsp;<span class="op" id="2239751">/</span>&nbsp;<span class="ident" id="2239753">float32pow10</span><span class="op" id="2239765">[</span><span class="op" id="2239766">-</span><span class="ident" id="2239767">exp</span><span class="op" id="2239770">]</span><span class="op" id="2239771">,</span>&nbsp;<span class="builtintype" id="2239773">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239782">return</span><br>
<span class="lineno"></span><span class="op" id="2239789">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2239792">const</span>&nbsp;<span class="ident" id="2239798">fnParseFloat</span>&nbsp;<span class="op" id="2239811">=</span>&nbsp;<span class="string" id="2239813">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239827">func</span>&nbsp;<span class="ident" id="2239832">atof32</span><span class="op" id="2239838">(</span><span class="ident" id="2239839">s</span>&nbsp;<span class="builtintype" id="2239841">string</span><span class="op" id="2239847">)</span>&nbsp;<span class="op" id="2239849">(</span><span class="ident" id="2239850">f</span>&nbsp;<span class="builtintype" id="2239852">float32</span><span class="op" id="2239859">,</span>&nbsp;<span class="ident" id="2239861">err</span>&nbsp;<span class="builtintype" id="2239865">error</span><span class="op" id="2239870">)</span>&nbsp;<span class="op" id="2239872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239875">if</span>&nbsp;<span class="ident" id="2239878">val</span><span class="op" id="2239881">,</span>&nbsp;<span class="ident" id="2239883">ok</span>&nbsp;<span class="op" id="2239886">:=</span>&nbsp;<span class="ident" id="2239889">special</span><span class="op" id="2239896">(</span><span class="ident" id="2239897">s</span><span class="op" id="2239898">)</span><span class="op" id="2239899">;</span>&nbsp;<span class="ident" id="2239901">ok</span>&nbsp;<span class="op" id="2239904">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239908">return</span>&nbsp;<span class="builtintype" id="2239915">float32</span><span class="op" id="2239922">(</span><span class="ident" id="2239923">val</span><span class="op" id="2239926">)</span><span class="op" id="2239927">,</span>&nbsp;<span class="ident" id="2239929">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2239934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239938">if</span>&nbsp;<span class="ident" id="2239941">optimize</span>&nbsp;<span class="op" id="2239950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2239954">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239988">mantissa</span><span class="op" id="2239996">,</span>&nbsp;<span class="ident" id="2239998">exp</span><span class="op" id="2240001">,</span>&nbsp;<span class="ident" id="2240003">neg</span><span class="op" id="2240006">,</span>&nbsp;<span class="ident" id="2240008">trunc</span><span class="op" id="2240013">,</span>&nbsp;<span class="ident" id="2240015">ok</span>&nbsp;<span class="op" id="2240018">:=</span>&nbsp;<span class="ident" id="2240021">readFloat</span><span class="op" id="2240030">(</span><span class="ident" id="2240031">s</span><span class="op" id="2240032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240036">if</span>&nbsp;<span class="ident" id="2240039">ok</span>&nbsp;<span class="op" id="2240042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240047">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240100">if</span>&nbsp;<span class="op" id="2240103">!</span><span class="ident" id="2240104">trunc</span>&nbsp;<span class="op" id="2240110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240116">if</span>&nbsp;<span class="ident" id="2240119">f</span><span class="op" id="2240120">,</span>&nbsp;<span class="ident" id="2240122">ok</span>&nbsp;<span class="op" id="2240125">:=</span>&nbsp;<span class="ident" id="2240128">atof32exact</span><span class="op" id="2240139">(</span><span class="ident" id="2240140">mantissa</span><span class="op" id="2240148">,</span>&nbsp;<span class="ident" id="2240150">exp</span><span class="op" id="2240153">,</span>&nbsp;<span class="ident" id="2240155">neg</span><span class="op" id="2240158">)</span><span class="op" id="2240159">;</span>&nbsp;<span class="ident" id="2240161">ok</span>&nbsp;<span class="op" id="2240164">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240171">return</span>&nbsp;<span class="ident" id="2240178">f</span><span class="op" id="2240179">,</span>&nbsp;<span class="ident" id="2240181">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240199">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240228">ext</span>&nbsp;<span class="op" id="2240232">:=</span>&nbsp;<span class="builtinfunc" id="2240235">new</span><span class="op" id="2240238">(</span><span class="ident" id="2240239">extFloat</span><span class="op" id="2240247">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240252">if</span>&nbsp;<span class="ident" id="2240255">ok</span>&nbsp;<span class="op" id="2240258">:=</span>&nbsp;<span class="ident" id="2240261">ext</span><span class="op" id="2240264">.</span><span class="ident" id="2240265">AssignDecimal</span><span class="op" id="2240278">(</span><span class="ident" id="2240279">mantissa</span><span class="op" id="2240287">,</span>&nbsp;<span class="ident" id="2240289">exp</span><span class="op" id="2240292">,</span>&nbsp;<span class="ident" id="2240294">neg</span><span class="op" id="2240297">,</span>&nbsp;<span class="ident" id="2240299">trunc</span><span class="op" id="2240304">,</span>&nbsp;<span class="op" id="2240306">&amp;</span><span class="ident" id="2240307">float32info</span><span class="op" id="2240318">)</span><span class="op" id="2240319">;</span>&nbsp;<span class="ident" id="2240321">ok</span>&nbsp;<span class="op" id="2240324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240330">b</span><span class="op" id="2240331">,</span>&nbsp;<span class="ident" id="2240333">ovf</span>&nbsp;<span class="op" id="2240337">:=</span>&nbsp;<span class="ident" id="2240340">ext</span><span class="op" id="2240343">.</span><span class="ident" id="2240344">floatBits</span><span class="op" id="2240353">(</span><span class="op" id="2240354">&amp;</span><span class="ident" id="2240355">float32info</span><span class="op" id="2240366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240372">f</span>&nbsp;<span class="op" id="2240374">=</span>&nbsp;<span class="ident" id="2240376">math</span><span class="op" id="2240380">.</span><span class="ident" id="2240381">Float32frombits</span><span class="op" id="2240396">(</span><span class="builtintype" id="2240397">uint32</span><span class="op" id="2240403">(</span><span class="ident" id="2240404">b</span><span class="op" id="2240405">)</span><span class="op" id="2240406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240412">if</span>&nbsp;<span class="ident" id="2240415">ovf</span>&nbsp;<span class="op" id="2240419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240426">err</span>&nbsp;<span class="op" id="2240430">=</span>&nbsp;<span class="ident" id="2240432">rangeError</span><span class="op" id="2240442">(</span><span class="ident" id="2240443">fnParseFloat</span><span class="op" id="2240455">,</span>&nbsp;<span class="ident" id="2240457">s</span><span class="op" id="2240458">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240470">return</span>&nbsp;<span class="ident" id="2240477">f</span><span class="op" id="2240478">,</span>&nbsp;<span class="ident" id="2240480">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240494">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240497">var</span>&nbsp;<span class="ident" id="2240501">d</span>&nbsp;<span class="ident" id="2240503">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240512">if</span>&nbsp;<span class="op" id="2240515">!</span><span class="ident" id="2240516">d</span><span class="op" id="2240517">.</span><span class="ident" id="2240518">set</span><span class="op" id="2240521">(</span><span class="ident" id="2240522">s</span><span class="op" id="2240523">)</span>&nbsp;<span class="op" id="2240525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240529">return</span>&nbsp;<span class="num" id="2240536">0</span><span class="op" id="2240537">,</span>&nbsp;<span class="ident" id="2240539">syntaxError</span><span class="op" id="2240550">(</span><span class="ident" id="2240551">fnParseFloat</span><span class="op" id="2240563">,</span>&nbsp;<span class="ident" id="2240565">s</span><span class="op" id="2240566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240572">b</span><span class="op" id="2240573">,</span>&nbsp;<span class="ident" id="2240575">ovf</span>&nbsp;<span class="op" id="2240579">:=</span>&nbsp;<span class="ident" id="2240582">d</span><span class="op" id="2240583">.</span><span class="ident" id="2240584">floatBits</span><span class="op" id="2240593">(</span><span class="op" id="2240594">&amp;</span><span class="ident" id="2240595">float32info</span><span class="op" id="2240606">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240609">f</span>&nbsp;<span class="op" id="2240611">=</span>&nbsp;<span class="ident" id="2240613">math</span><span class="op" id="2240617">.</span><span class="ident" id="2240618">Float32frombits</span><span class="op" id="2240633">(</span><span class="builtintype" id="2240634">uint32</span><span class="op" id="2240640">(</span><span class="ident" id="2240641">b</span><span class="op" id="2240642">)</span><span class="op" id="2240643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240646">if</span>&nbsp;<span class="ident" id="2240649">ovf</span>&nbsp;<span class="op" id="2240653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240657">err</span>&nbsp;<span class="op" id="2240661">=</span>&nbsp;<span class="ident" id="2240663">rangeError</span><span class="op" id="2240673">(</span><span class="ident" id="2240674">fnParseFloat</span><span class="op" id="2240686">,</span>&nbsp;<span class="ident" id="2240688">s</span><span class="op" id="2240689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240695">return</span>&nbsp;<span class="ident" id="2240702">f</span><span class="op" id="2240703">,</span>&nbsp;<span class="ident" id="2240705">err</span><br>
<span class="lineno">475</span><span class="op" id="2240709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240712">func</span>&nbsp;<span class="ident" id="2240717">atof64</span><span class="op" id="2240723">(</span><span class="ident" id="2240724">s</span>&nbsp;<span class="builtintype" id="2240726">string</span><span class="op" id="2240732">)</span>&nbsp;<span class="op" id="2240734">(</span><span class="ident" id="2240735">f</span>&nbsp;<span class="builtintype" id="2240737">float64</span><span class="op" id="2240744">,</span>&nbsp;<span class="ident" id="2240746">err</span>&nbsp;<span class="builtintype" id="2240750">error</span><span class="op" id="2240755">)</span>&nbsp;<span class="op" id="2240757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240760">if</span>&nbsp;<span class="ident" id="2240763">val</span><span class="op" id="2240766">,</span>&nbsp;<span class="ident" id="2240768">ok</span>&nbsp;<span class="op" id="2240771">:=</span>&nbsp;<span class="ident" id="2240774">special</span><span class="op" id="2240781">(</span><span class="ident" id="2240782">s</span><span class="op" id="2240783">)</span><span class="op" id="2240784">;</span>&nbsp;<span class="ident" id="2240786">ok</span>&nbsp;<span class="op" id="2240789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240793">return</span>&nbsp;<span class="ident" id="2240800">val</span><span class="op" id="2240803">,</span>&nbsp;<span class="ident" id="2240805">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240814">if</span>&nbsp;<span class="ident" id="2240817">optimize</span>&nbsp;<span class="op" id="2240826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240830">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240864">mantissa</span><span class="op" id="2240872">,</span>&nbsp;<span class="ident" id="2240874">exp</span><span class="op" id="2240877">,</span>&nbsp;<span class="ident" id="2240879">neg</span><span class="op" id="2240882">,</span>&nbsp;<span class="ident" id="2240884">trunc</span><span class="op" id="2240889">,</span>&nbsp;<span class="ident" id="2240891">ok</span>&nbsp;<span class="op" id="2240894">:=</span>&nbsp;<span class="ident" id="2240897">readFloat</span><span class="op" id="2240906">(</span><span class="ident" id="2240907">s</span><span class="op" id="2240908">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240912">if</span>&nbsp;<span class="ident" id="2240915">ok</span>&nbsp;<span class="op" id="2240918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240923">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240976">if</span>&nbsp;<span class="op" id="2240979">!</span><span class="ident" id="2240980">trunc</span>&nbsp;<span class="op" id="2240986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240992">if</span>&nbsp;<span class="ident" id="2240995">f</span><span class="op" id="2240996">,</span>&nbsp;<span class="ident" id="2240998">ok</span>&nbsp;<span class="op" id="2241001">:=</span>&nbsp;<span class="ident" id="2241004">atof64exact</span><span class="op" id="2241015">(</span><span class="ident" id="2241016">mantissa</span><span class="op" id="2241024">,</span>&nbsp;<span class="ident" id="2241026">exp</span><span class="op" id="2241029">,</span>&nbsp;<span class="ident" id="2241031">neg</span><span class="op" id="2241034">)</span><span class="op" id="2241035">;</span>&nbsp;<span class="ident" id="2241037">ok</span>&nbsp;<span class="op" id="2241040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241047">return</span>&nbsp;<span class="ident" id="2241054">f</span><span class="op" id="2241055">,</span>&nbsp;<span class="ident" id="2241057">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241075">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241104">ext</span>&nbsp;<span class="op" id="2241108">:=</span>&nbsp;<span class="builtinfunc" id="2241111">new</span><span class="op" id="2241114">(</span><span class="ident" id="2241115">extFloat</span><span class="op" id="2241123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241128">if</span>&nbsp;<span class="ident" id="2241131">ok</span>&nbsp;<span class="op" id="2241134">:=</span>&nbsp;<span class="ident" id="2241137">ext</span><span class="op" id="2241140">.</span><span class="ident" id="2241141">AssignDecimal</span><span class="op" id="2241154">(</span><span class="ident" id="2241155">mantissa</span><span class="op" id="2241163">,</span>&nbsp;<span class="ident" id="2241165">exp</span><span class="op" id="2241168">,</span>&nbsp;<span class="ident" id="2241170">neg</span><span class="op" id="2241173">,</span>&nbsp;<span class="ident" id="2241175">trunc</span><span class="op" id="2241180">,</span>&nbsp;<span class="op" id="2241182">&amp;</span><span class="ident" id="2241183">float64info</span><span class="op" id="2241194">)</span><span class="op" id="2241195">;</span>&nbsp;<span class="ident" id="2241197">ok</span>&nbsp;<span class="op" id="2241200">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241206">b</span><span class="op" id="2241207">,</span>&nbsp;<span class="ident" id="2241209">ovf</span>&nbsp;<span class="op" id="2241213">:=</span>&nbsp;<span class="ident" id="2241216">ext</span><span class="op" id="2241219">.</span><span class="ident" id="2241220">floatBits</span><span class="op" id="2241229">(</span><span class="op" id="2241230">&amp;</span><span class="ident" id="2241231">float64info</span><span class="op" id="2241242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241248">f</span>&nbsp;<span class="op" id="2241250">=</span>&nbsp;<span class="ident" id="2241252">math</span><span class="op" id="2241256">.</span><span class="ident" id="2241257">Float64frombits</span><span class="op" id="2241272">(</span><span class="ident" id="2241273">b</span><span class="op" id="2241274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241280">if</span>&nbsp;<span class="ident" id="2241283">ovf</span>&nbsp;<span class="op" id="2241287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241294">err</span>&nbsp;<span class="op" id="2241298">=</span>&nbsp;<span class="ident" id="2241300">rangeError</span><span class="op" id="2241310">(</span><span class="ident" id="2241311">fnParseFloat</span><span class="op" id="2241323">,</span>&nbsp;<span class="ident" id="2241325">s</span><span class="op" id="2241326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241332">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241338">return</span>&nbsp;<span class="ident" id="2241345">f</span><span class="op" id="2241346">,</span>&nbsp;<span class="ident" id="2241348">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241365">var</span>&nbsp;<span class="ident" id="2241369">d</span>&nbsp;<span class="ident" id="2241371">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241380">if</span>&nbsp;<span class="op" id="2241383">!</span><span class="ident" id="2241384">d</span><span class="op" id="2241385">.</span><span class="ident" id="2241386">set</span><span class="op" id="2241389">(</span><span class="ident" id="2241390">s</span><span class="op" id="2241391">)</span>&nbsp;<span class="op" id="2241393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241397">return</span>&nbsp;<span class="num" id="2241404">0</span><span class="op" id="2241405">,</span>&nbsp;<span class="ident" id="2241407">syntaxError</span><span class="op" id="2241418">(</span><span class="ident" id="2241419">fnParseFloat</span><span class="op" id="2241431">,</span>&nbsp;<span class="ident" id="2241433">s</span><span class="op" id="2241434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241440">b</span><span class="op" id="2241441">,</span>&nbsp;<span class="ident" id="2241443">ovf</span>&nbsp;<span class="op" id="2241447">:=</span>&nbsp;<span class="ident" id="2241450">d</span><span class="op" id="2241451">.</span><span class="ident" id="2241452">floatBits</span><span class="op" id="2241461">(</span><span class="op" id="2241462">&amp;</span><span class="ident" id="2241463">float64info</span><span class="op" id="2241474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241477">f</span>&nbsp;<span class="op" id="2241479">=</span>&nbsp;<span class="ident" id="2241481">math</span><span class="op" id="2241485">.</span><span class="ident" id="2241486">Float64frombits</span><span class="op" id="2241501">(</span><span class="ident" id="2241502">b</span><span class="op" id="2241503">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241506">if</span>&nbsp;<span class="ident" id="2241509">ovf</span>&nbsp;<span class="op" id="2241513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241517">err</span>&nbsp;<span class="op" id="2241521">=</span>&nbsp;<span class="ident" id="2241523">rangeError</span><span class="op" id="2241533">(</span><span class="ident" id="2241534">fnParseFloat</span><span class="op" id="2241546">,</span>&nbsp;<span class="ident" id="2241548">s</span><span class="op" id="2241549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241555">return</span>&nbsp;<span class="ident" id="2241562">f</span><span class="op" id="2241563">,</span>&nbsp;<span class="ident" id="2241565">err</span><br>
<span class="lineno"></span><span class="op" id="2241569">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2241572">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2241635">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2241714">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2241784">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2241838">//</span><br>
<span class="lineno"></span><span class="comment" id="2241841">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2241904">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2241968">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2242004">//</span><br>
<span class="lineno">525</span><span class="comment" id="2242007">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2242074">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2242102">//</span><br>
<span class="lineno"></span><span class="comment" id="2242105">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2242187">//</span><br>
<span class="lineno">530</span><span class="comment" id="2242190">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2242252">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2242318">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2242371">func</span>&nbsp;<span class="ident" id="2242376">ParseFloat</span><span class="op" id="2242386">(</span><span class="ident" id="2242387">s</span>&nbsp;<span class="builtintype" id="2242389">string</span><span class="op" id="2242395">,</span>&nbsp;<span class="ident" id="2242397">bitSize</span>&nbsp;<span class="builtintype" id="2242405">int</span><span class="op" id="2242408">)</span>&nbsp;<span class="op" id="2242410">(</span><span class="ident" id="2242411">f</span>&nbsp;<span class="builtintype" id="2242413">float64</span><span class="op" id="2242420">,</span>&nbsp;<span class="ident" id="2242422">err</span>&nbsp;<span class="builtintype" id="2242426">error</span><span class="op" id="2242431">)</span>&nbsp;<span class="op" id="2242433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242436">if</span>&nbsp;<span class="ident" id="2242439">bitSize</span>&nbsp;<span class="op" id="2242447">==</span>&nbsp;<span class="num" id="2242450">32</span>&nbsp;<span class="op" id="2242453">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242457">f1</span><span class="op" id="2242459">,</span>&nbsp;<span class="ident" id="2242461">err1</span>&nbsp;<span class="op" id="2242466">:=</span>&nbsp;<span class="ident" id="2242469">atof32</span><span class="op" id="2242475">(</span><span class="ident" id="2242476">s</span><span class="op" id="2242477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242481">return</span>&nbsp;<span class="builtintype" id="2242488">float64</span><span class="op" id="2242495">(</span><span class="ident" id="2242496">f1</span><span class="op" id="2242498">)</span><span class="op" id="2242499">,</span>&nbsp;<span class="ident" id="2242501">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242510">f1</span><span class="op" id="2242512">,</span>&nbsp;<span class="ident" id="2242514">err1</span>&nbsp;<span class="op" id="2242519">:=</span>&nbsp;<span class="ident" id="2242522">atof64</span><span class="op" id="2242528">(</span><span class="ident" id="2242529">s</span><span class="op" id="2242530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242533">return</span>&nbsp;<span class="ident" id="2242540">f1</span><span class="op" id="2242542">,</span>&nbsp;<span class="ident" id="2242544">err1</span><br>
<span class="lineno">540</span><span class="op" id="2242549">}</span>
</div>
</body>
</html>
