<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3821177">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3821232">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3821286">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3821337">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3821407">package</span>&nbsp;<span class="ident" id="3821415">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3821421">import</span>&nbsp;<span class="op" id="3821428">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821431">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821440">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821446">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3821456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3821459">var</span>&nbsp;<span class="ident" id="3821463">typeFiles</span>&nbsp;<span class="op" id="3821473">=</span>&nbsp;<span class="op" id="3821475">[</span><span class="op" id="3821476">]</span><span class="builtintype" id="3821477">string</span><span class="op" id="3821483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821486">&#34;/etc/mime.types&#34;</span><span class="op" id="3821503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821506">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3821531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3821534">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3821558">,</span><br>
<span class="lineno"></span><span class="op" id="3821560">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3821563">func</span>&nbsp;<span class="ident" id="3821568">loadMimeFile</span><span class="op" id="3821580">(</span><span class="ident" id="3821581">filename</span>&nbsp;<span class="builtintype" id="3821590">string</span><span class="op" id="3821596">)</span>&nbsp;<span class="op" id="3821598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3821601">f</span><span class="op" id="3821602">,</span>&nbsp;<span class="ident" id="3821604">err</span>&nbsp;<span class="op" id="3821608">:=</span>&nbsp;<span class="ident" id="3821611">os</span><span class="op" id="3821613">.</span><span class="ident" id="3821614">Open</span><span class="op" id="3821618">(</span><span class="ident" id="3821619">filename</span><span class="op" id="3821627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821630">if</span>&nbsp;<span class="ident" id="3821633">err</span>&nbsp;<span class="op" id="3821637">!=</span>&nbsp;<span class="ident" id="3821640">nil</span>&nbsp;<span class="op" id="3821644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821648">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3821656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821659">defer</span>&nbsp;<span class="ident" id="3821665">f</span><span class="op" id="3821666">.</span><span class="ident" id="3821667">Close</span><span class="op" id="3821672">(</span><span class="op" id="3821673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3821677">scanner</span>&nbsp;<span class="op" id="3821685">:=</span>&nbsp;<span class="ident" id="3821688">bufio</span><span class="op" id="3821693">.</span><span class="ident" id="3821694">NewScanner</span><span class="op" id="3821704">(</span><span class="ident" id="3821705">f</span><span class="op" id="3821706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821709">for</span>&nbsp;<span class="ident" id="3821713">scanner</span><span class="op" id="3821720">.</span><span class="ident" id="3821721">Scan</span><span class="op" id="3821725">(</span><span class="op" id="3821726">)</span>&nbsp;<span class="op" id="3821728">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3821732">fields</span>&nbsp;<span class="op" id="3821739">:=</span>&nbsp;<span class="ident" id="3821742">strings</span><span class="op" id="3821749">.</span><span class="ident" id="3821750">Fields</span><span class="op" id="3821756">(</span><span class="ident" id="3821757">scanner</span><span class="op" id="3821764">.</span><span class="ident" id="3821765">Text</span><span class="op" id="3821769">(</span><span class="op" id="3821770">)</span><span class="op" id="3821771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821775">if</span>&nbsp;<span class="builtinfunc" id="3821778">len</span><span class="op" id="3821781">(</span><span class="ident" id="3821782">fields</span><span class="op" id="3821788">)</span>&nbsp;<span class="op" id="3821790">&lt;=</span>&nbsp;<span class="num" id="3821793">1</span>&nbsp;<span class="op" id="3821795">||</span>&nbsp;<span class="ident" id="3821798">fields</span><span class="op" id="3821804">[</span><span class="num" id="3821805">0</span><span class="op" id="3821806">]</span><span class="op" id="3821807">[</span><span class="num" id="3821808">0</span><span class="op" id="3821809">]</span>&nbsp;<span class="op" id="3821811">==</span>&nbsp;<span class="string" id="3821814">&#39;#&#39;</span>&nbsp;<span class="op" id="3821818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821823">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3821834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3821838">mimeType</span>&nbsp;<span class="op" id="3821847">:=</span>&nbsp;<span class="ident" id="3821850">fields</span><span class="op" id="3821856">[</span><span class="num" id="3821857">0</span><span class="op" id="3821858">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821862">for</span>&nbsp;<span class="ident" id="3821866">_</span><span class="op" id="3821867">,</span>&nbsp;<span class="ident" id="3821869">ext</span>&nbsp;<span class="op" id="3821873">:=</span>&nbsp;<span class="keyword" id="3821876">range</span>&nbsp;<span class="ident" id="3821882">fields</span><span class="op" id="3821888">[</span><span class="num" id="3821889">1</span><span class="op" id="3821890">:</span><span class="op" id="3821891">]</span>&nbsp;<span class="op" id="3821893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821898">if</span>&nbsp;<span class="ident" id="3821901">ext</span><span class="op" id="3821904">[</span><span class="num" id="3821905">0</span><span class="op" id="3821906">]</span>&nbsp;<span class="op" id="3821908">==</span>&nbsp;<span class="string" id="3821911">&#39;#&#39;</span>&nbsp;<span class="op" id="3821915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821921">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3821930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3821935">setExtensionType</span><span class="op" id="3821951">(</span><span class="string" id="3821952">&#34;.&#34;</span><span class="op" id="3821955">+</span><span class="ident" id="3821956">ext</span><span class="op" id="3821959">,</span>&nbsp;<span class="ident" id="3821961">mimeType</span><span class="op" id="3821969">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3821973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3821976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3821979">if</span>&nbsp;<span class="ident" id="3821982">err</span>&nbsp;<span class="op" id="3821986">:=</span>&nbsp;<span class="ident" id="3821989">scanner</span><span class="op" id="3821996">.</span><span class="ident" id="3821997">Err</span><span class="op" id="3822000">(</span><span class="op" id="3822001">)</span><span class="op" id="3822002">;</span>&nbsp;<span class="ident" id="3822004">err</span>&nbsp;<span class="op" id="3822008">!=</span>&nbsp;<span class="ident" id="3822011">nil</span>&nbsp;<span class="op" id="3822015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3822019">panic</span><span class="op" id="3822024">(</span><span class="ident" id="3822025">err</span><span class="op" id="3822028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3822031">}</span><br>
<span class="lineno">45</span><span class="op" id="3822033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3822036">func</span>&nbsp;<span class="ident" id="3822041">initMime</span><span class="op" id="3822049">(</span><span class="op" id="3822050">)</span>&nbsp;<span class="op" id="3822052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3822055">for</span>&nbsp;<span class="ident" id="3822059">_</span><span class="op" id="3822060">,</span>&nbsp;<span class="ident" id="3822062">filename</span>&nbsp;<span class="op" id="3822071">:=</span>&nbsp;<span class="keyword" id="3822074">range</span>&nbsp;<span class="ident" id="3822080">typeFiles</span>&nbsp;<span class="op" id="3822090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822094">loadMimeFile</span><span class="op" id="3822106">(</span><span class="ident" id="3822107">filename</span><span class="op" id="3822115">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3822118">}</span><br>
<span class="lineno"></span><span class="op" id="3822120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3822123">func</span>&nbsp;<span class="ident" id="3822128">initMimeForTests</span><span class="op" id="3822144">(</span><span class="op" id="3822145">)</span>&nbsp;<span class="keyword" id="3822147">map</span><span class="op" id="3822150">[</span><span class="builtintype" id="3822151">string</span><span class="op" id="3822157">]</span><span class="builtintype" id="3822158">string</span>&nbsp;<span class="op" id="3822165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822168">typeFiles</span>&nbsp;<span class="op" id="3822178">=</span>&nbsp;<span class="op" id="3822180">[</span><span class="op" id="3822181">]</span><span class="builtintype" id="3822182">string</span><span class="op" id="3822188">{</span><span class="string" id="3822189">&#34;testdata/test.types&#34;</span><span class="op" id="3822210">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3822213">return</span>&nbsp;<span class="keyword" id="3822220">map</span><span class="op" id="3822223">[</span><span class="builtintype" id="3822224">string</span><span class="op" id="3822230">]</span><span class="builtintype" id="3822231">string</span><span class="op" id="3822237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822241">&#34;.T1&#34;</span><span class="op" id="3822246">:</span>&nbsp;&nbsp;<span class="string" id="3822249">&#34;application/test&#34;</span><span class="op" id="3822267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822271">&#34;.t2&#34;</span><span class="op" id="3822276">:</span>&nbsp;&nbsp;<span class="string" id="3822279">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3822305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822309">&#34;.png&#34;</span><span class="op" id="3822315">:</span>&nbsp;<span class="string" id="3822317">&#34;image/png&#34;</span><span class="op" id="3822328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3822331">}</span><br>
<span class="lineno">60</span><span class="op" id="3822333">}</span>
</div>
</body>
</html>
