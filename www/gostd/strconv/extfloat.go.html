<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html" class="current">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2336697">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2336752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2336806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2336857">package</span>&nbsp;<span class="ident" id="2336865">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2336874">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2336945">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2337008">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2337080">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2337104">type</span>&nbsp;<span class="ident" id="2337109">extFloat</span>&nbsp;<span class="keyword" id="2337118">struct</span>&nbsp;<span class="op" id="2337125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2337128">mant</span>&nbsp;<span class="ident" id="2337133">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2337141">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2337146">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2337151">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2337156">bool</span><br>
<span class="lineno">15</span><span class="op" id="2337161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2337164">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2337219">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2337266">const</span>&nbsp;<span class="op" id="2337272">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2337275">firstPowerOfTen</span>&nbsp;<span class="op" id="2337291">=</span>&nbsp;<span class="op" id="2337293">-</span><span class="num" id="2337294">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2337299">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2337315">=</span>&nbsp;<span class="num" id="2337317">8</span><br>
<span class="lineno"></span><span class="op" id="2337319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2337322">var</span>&nbsp;<span class="ident" id="2337326">smallPowersOfTen</span>&nbsp;<span class="op" id="2337343">=</span>&nbsp;<span class="op" id="2337345">[</span><span class="op" id="2337346">...</span><span class="op" id="2337349">]</span><span class="ident" id="2337350">extFloat</span><span class="op" id="2337358">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337361">{</span><span class="num" id="2337362">1</span>&nbsp;<span class="op" id="2337364">&lt;&lt;</span>&nbsp;<span class="num" id="2337367">63</span><span class="op" id="2337369">,</span>&nbsp;<span class="op" id="2337371">-</span><span class="num" id="2337372">63</span><span class="op" id="2337374">,</span>&nbsp;<span class="builtintype" id="2337376">false</span><span class="op" id="2337381">}</span><span class="op" id="2337382">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2337391">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337397">{</span><span class="num" id="2337398">0xa</span>&nbsp;<span class="op" id="2337402">&lt;&lt;</span>&nbsp;<span class="num" id="2337405">60</span><span class="op" id="2337407">,</span>&nbsp;<span class="op" id="2337409">-</span><span class="num" id="2337410">60</span><span class="op" id="2337412">,</span>&nbsp;<span class="builtintype" id="2337414">false</span><span class="op" id="2337419">}</span><span class="op" id="2337420">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2337427">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337435">{</span><span class="num" id="2337436">0x64</span>&nbsp;<span class="op" id="2337441">&lt;&lt;</span>&nbsp;<span class="num" id="2337444">57</span><span class="op" id="2337446">,</span>&nbsp;<span class="op" id="2337448">-</span><span class="num" id="2337449">57</span><span class="op" id="2337451">,</span>&nbsp;<span class="builtintype" id="2337453">false</span><span class="op" id="2337458">}</span><span class="op" id="2337459">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2337465">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337473">{</span><span class="num" id="2337474">0x3e8</span>&nbsp;<span class="op" id="2337480">&lt;&lt;</span>&nbsp;<span class="num" id="2337483">54</span><span class="op" id="2337485">,</span>&nbsp;<span class="op" id="2337487">-</span><span class="num" id="2337488">54</span><span class="op" id="2337490">,</span>&nbsp;<span class="builtintype" id="2337492">false</span><span class="op" id="2337497">}</span><span class="op" id="2337498">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2337503">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337511">{</span><span class="num" id="2337512">0x2710</span>&nbsp;<span class="op" id="2337519">&lt;&lt;</span>&nbsp;<span class="num" id="2337522">50</span><span class="op" id="2337524">,</span>&nbsp;<span class="op" id="2337526">-</span><span class="num" id="2337527">50</span><span class="op" id="2337529">,</span>&nbsp;<span class="builtintype" id="2337531">false</span><span class="op" id="2337536">}</span><span class="op" id="2337537">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2337541">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337549">{</span><span class="num" id="2337550">0x186a0</span>&nbsp;<span class="op" id="2337558">&lt;&lt;</span>&nbsp;<span class="num" id="2337561">47</span><span class="op" id="2337563">,</span>&nbsp;<span class="op" id="2337565">-</span><span class="num" id="2337566">47</span><span class="op" id="2337568">,</span>&nbsp;<span class="builtintype" id="2337570">false</span><span class="op" id="2337575">}</span><span class="op" id="2337576">,</span>&nbsp;&nbsp;<span class="comment" id="2337579">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337587">{</span><span class="num" id="2337588">0xf4240</span>&nbsp;<span class="op" id="2337596">&lt;&lt;</span>&nbsp;<span class="num" id="2337599">44</span><span class="op" id="2337601">,</span>&nbsp;<span class="op" id="2337603">-</span><span class="num" id="2337604">44</span><span class="op" id="2337606">,</span>&nbsp;<span class="builtintype" id="2337608">false</span><span class="op" id="2337613">}</span><span class="op" id="2337614">,</span>&nbsp;&nbsp;<span class="comment" id="2337617">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337625">{</span><span class="num" id="2337626">0x989680</span>&nbsp;<span class="op" id="2337635">&lt;&lt;</span>&nbsp;<span class="num" id="2337638">40</span><span class="op" id="2337640">,</span>&nbsp;<span class="op" id="2337642">-</span><span class="num" id="2337643">40</span><span class="op" id="2337645">,</span>&nbsp;<span class="builtintype" id="2337647">false</span><span class="op" id="2337652">}</span><span class="op" id="2337653">,</span>&nbsp;<span class="comment" id="2337655">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2337662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2337665">var</span>&nbsp;<span class="ident" id="2337669">powersOfTen</span>&nbsp;<span class="op" id="2337681">=</span>&nbsp;<span class="op" id="2337683">[</span><span class="op" id="2337684">...</span><span class="op" id="2337687">]</span><span class="ident" id="2337688">extFloat</span><span class="op" id="2337696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337699">{</span><span class="num" id="2337700">0xfa8fd5a0081c0288</span><span class="op" id="2337718">,</span>&nbsp;<span class="op" id="2337720">-</span><span class="num" id="2337721">1220</span><span class="op" id="2337725">,</span>&nbsp;<span class="builtintype" id="2337727">false</span><span class="op" id="2337732">}</span><span class="op" id="2337733">,</span>&nbsp;<span class="comment" id="2337735">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337747">{</span><span class="num" id="2337748">0xbaaee17fa23ebf76</span><span class="op" id="2337766">,</span>&nbsp;<span class="op" id="2337768">-</span><span class="num" id="2337769">1193</span><span class="op" id="2337773">,</span>&nbsp;<span class="builtintype" id="2337775">false</span><span class="op" id="2337780">}</span><span class="op" id="2337781">,</span>&nbsp;<span class="comment" id="2337783">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337795">{</span><span class="num" id="2337796">0x8b16fb203055ac76</span><span class="op" id="2337814">,</span>&nbsp;<span class="op" id="2337816">-</span><span class="num" id="2337817">1166</span><span class="op" id="2337821">,</span>&nbsp;<span class="builtintype" id="2337823">false</span><span class="op" id="2337828">}</span><span class="op" id="2337829">,</span>&nbsp;<span class="comment" id="2337831">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337843">{</span><span class="num" id="2337844">0xcf42894a5dce35ea</span><span class="op" id="2337862">,</span>&nbsp;<span class="op" id="2337864">-</span><span class="num" id="2337865">1140</span><span class="op" id="2337869">,</span>&nbsp;<span class="builtintype" id="2337871">false</span><span class="op" id="2337876">}</span><span class="op" id="2337877">,</span>&nbsp;<span class="comment" id="2337879">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337891">{</span><span class="num" id="2337892">0x9a6bb0aa55653b2d</span><span class="op" id="2337910">,</span>&nbsp;<span class="op" id="2337912">-</span><span class="num" id="2337913">1113</span><span class="op" id="2337917">,</span>&nbsp;<span class="builtintype" id="2337919">false</span><span class="op" id="2337924">}</span><span class="op" id="2337925">,</span>&nbsp;<span class="comment" id="2337927">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337939">{</span><span class="num" id="2337940">0xe61acf033d1a45df</span><span class="op" id="2337958">,</span>&nbsp;<span class="op" id="2337960">-</span><span class="num" id="2337961">1087</span><span class="op" id="2337965">,</span>&nbsp;<span class="builtintype" id="2337967">false</span><span class="op" id="2337972">}</span><span class="op" id="2337973">,</span>&nbsp;<span class="comment" id="2337975">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2337987">{</span><span class="num" id="2337988">0xab70fe17c79ac6ca</span><span class="op" id="2338006">,</span>&nbsp;<span class="op" id="2338008">-</span><span class="num" id="2338009">1060</span><span class="op" id="2338013">,</span>&nbsp;<span class="builtintype" id="2338015">false</span><span class="op" id="2338020">}</span><span class="op" id="2338021">,</span>&nbsp;<span class="comment" id="2338023">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338035">{</span><span class="num" id="2338036">0xff77b1fcbebcdc4f</span><span class="op" id="2338054">,</span>&nbsp;<span class="op" id="2338056">-</span><span class="num" id="2338057">1034</span><span class="op" id="2338061">,</span>&nbsp;<span class="builtintype" id="2338063">false</span><span class="op" id="2338068">}</span><span class="op" id="2338069">,</span>&nbsp;<span class="comment" id="2338071">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338083">{</span><span class="num" id="2338084">0xbe5691ef416bd60c</span><span class="op" id="2338102">,</span>&nbsp;<span class="op" id="2338104">-</span><span class="num" id="2338105">1007</span><span class="op" id="2338109">,</span>&nbsp;<span class="builtintype" id="2338111">false</span><span class="op" id="2338116">}</span><span class="op" id="2338117">,</span>&nbsp;<span class="comment" id="2338119">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338131">{</span><span class="num" id="2338132">0x8dd01fad907ffc3c</span><span class="op" id="2338150">,</span>&nbsp;<span class="op" id="2338152">-</span><span class="num" id="2338153">980</span><span class="op" id="2338156">,</span>&nbsp;<span class="builtintype" id="2338158">false</span><span class="op" id="2338163">}</span><span class="op" id="2338164">,</span>&nbsp;&nbsp;<span class="comment" id="2338167">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338179">{</span><span class="num" id="2338180">0xd3515c2831559a83</span><span class="op" id="2338198">,</span>&nbsp;<span class="op" id="2338200">-</span><span class="num" id="2338201">954</span><span class="op" id="2338204">,</span>&nbsp;<span class="builtintype" id="2338206">false</span><span class="op" id="2338211">}</span><span class="op" id="2338212">,</span>&nbsp;&nbsp;<span class="comment" id="2338215">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338227">{</span><span class="num" id="2338228">0x9d71ac8fada6c9b5</span><span class="op" id="2338246">,</span>&nbsp;<span class="op" id="2338248">-</span><span class="num" id="2338249">927</span><span class="op" id="2338252">,</span>&nbsp;<span class="builtintype" id="2338254">false</span><span class="op" id="2338259">}</span><span class="op" id="2338260">,</span>&nbsp;&nbsp;<span class="comment" id="2338263">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338275">{</span><span class="num" id="2338276">0xea9c227723ee8bcb</span><span class="op" id="2338294">,</span>&nbsp;<span class="op" id="2338296">-</span><span class="num" id="2338297">901</span><span class="op" id="2338300">,</span>&nbsp;<span class="builtintype" id="2338302">false</span><span class="op" id="2338307">}</span><span class="op" id="2338308">,</span>&nbsp;&nbsp;<span class="comment" id="2338311">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338323">{</span><span class="num" id="2338324">0xaecc49914078536d</span><span class="op" id="2338342">,</span>&nbsp;<span class="op" id="2338344">-</span><span class="num" id="2338345">874</span><span class="op" id="2338348">,</span>&nbsp;<span class="builtintype" id="2338350">false</span><span class="op" id="2338355">}</span><span class="op" id="2338356">,</span>&nbsp;&nbsp;<span class="comment" id="2338359">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338371">{</span><span class="num" id="2338372">0x823c12795db6ce57</span><span class="op" id="2338390">,</span>&nbsp;<span class="op" id="2338392">-</span><span class="num" id="2338393">847</span><span class="op" id="2338396">,</span>&nbsp;<span class="builtintype" id="2338398">false</span><span class="op" id="2338403">}</span><span class="op" id="2338404">,</span>&nbsp;&nbsp;<span class="comment" id="2338407">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338419">{</span><span class="num" id="2338420">0xc21094364dfb5637</span><span class="op" id="2338438">,</span>&nbsp;<span class="op" id="2338440">-</span><span class="num" id="2338441">821</span><span class="op" id="2338444">,</span>&nbsp;<span class="builtintype" id="2338446">false</span><span class="op" id="2338451">}</span><span class="op" id="2338452">,</span>&nbsp;&nbsp;<span class="comment" id="2338455">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338467">{</span><span class="num" id="2338468">0x9096ea6f3848984f</span><span class="op" id="2338486">,</span>&nbsp;<span class="op" id="2338488">-</span><span class="num" id="2338489">794</span><span class="op" id="2338492">,</span>&nbsp;<span class="builtintype" id="2338494">false</span><span class="op" id="2338499">}</span><span class="op" id="2338500">,</span>&nbsp;&nbsp;<span class="comment" id="2338503">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338515">{</span><span class="num" id="2338516">0xd77485cb25823ac7</span><span class="op" id="2338534">,</span>&nbsp;<span class="op" id="2338536">-</span><span class="num" id="2338537">768</span><span class="op" id="2338540">,</span>&nbsp;<span class="builtintype" id="2338542">false</span><span class="op" id="2338547">}</span><span class="op" id="2338548">,</span>&nbsp;&nbsp;<span class="comment" id="2338551">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338563">{</span><span class="num" id="2338564">0xa086cfcd97bf97f4</span><span class="op" id="2338582">,</span>&nbsp;<span class="op" id="2338584">-</span><span class="num" id="2338585">741</span><span class="op" id="2338588">,</span>&nbsp;<span class="builtintype" id="2338590">false</span><span class="op" id="2338595">}</span><span class="op" id="2338596">,</span>&nbsp;&nbsp;<span class="comment" id="2338599">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338611">{</span><span class="num" id="2338612">0xef340a98172aace5</span><span class="op" id="2338630">,</span>&nbsp;<span class="op" id="2338632">-</span><span class="num" id="2338633">715</span><span class="op" id="2338636">,</span>&nbsp;<span class="builtintype" id="2338638">false</span><span class="op" id="2338643">}</span><span class="op" id="2338644">,</span>&nbsp;&nbsp;<span class="comment" id="2338647">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338659">{</span><span class="num" id="2338660">0xb23867fb2a35b28e</span><span class="op" id="2338678">,</span>&nbsp;<span class="op" id="2338680">-</span><span class="num" id="2338681">688</span><span class="op" id="2338684">,</span>&nbsp;<span class="builtintype" id="2338686">false</span><span class="op" id="2338691">}</span><span class="op" id="2338692">,</span>&nbsp;&nbsp;<span class="comment" id="2338695">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338707">{</span><span class="num" id="2338708">0x84c8d4dfd2c63f3b</span><span class="op" id="2338726">,</span>&nbsp;<span class="op" id="2338728">-</span><span class="num" id="2338729">661</span><span class="op" id="2338732">,</span>&nbsp;<span class="builtintype" id="2338734">false</span><span class="op" id="2338739">}</span><span class="op" id="2338740">,</span>&nbsp;&nbsp;<span class="comment" id="2338743">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338755">{</span><span class="num" id="2338756">0xc5dd44271ad3cdba</span><span class="op" id="2338774">,</span>&nbsp;<span class="op" id="2338776">-</span><span class="num" id="2338777">635</span><span class="op" id="2338780">,</span>&nbsp;<span class="builtintype" id="2338782">false</span><span class="op" id="2338787">}</span><span class="op" id="2338788">,</span>&nbsp;&nbsp;<span class="comment" id="2338791">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338803">{</span><span class="num" id="2338804">0x936b9fcebb25c996</span><span class="op" id="2338822">,</span>&nbsp;<span class="op" id="2338824">-</span><span class="num" id="2338825">608</span><span class="op" id="2338828">,</span>&nbsp;<span class="builtintype" id="2338830">false</span><span class="op" id="2338835">}</span><span class="op" id="2338836">,</span>&nbsp;&nbsp;<span class="comment" id="2338839">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338851">{</span><span class="num" id="2338852">0xdbac6c247d62a584</span><span class="op" id="2338870">,</span>&nbsp;<span class="op" id="2338872">-</span><span class="num" id="2338873">582</span><span class="op" id="2338876">,</span>&nbsp;<span class="builtintype" id="2338878">false</span><span class="op" id="2338883">}</span><span class="op" id="2338884">,</span>&nbsp;&nbsp;<span class="comment" id="2338887">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338899">{</span><span class="num" id="2338900">0xa3ab66580d5fdaf6</span><span class="op" id="2338918">,</span>&nbsp;<span class="op" id="2338920">-</span><span class="num" id="2338921">555</span><span class="op" id="2338924">,</span>&nbsp;<span class="builtintype" id="2338926">false</span><span class="op" id="2338931">}</span><span class="op" id="2338932">,</span>&nbsp;&nbsp;<span class="comment" id="2338935">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338947">{</span><span class="num" id="2338948">0xf3e2f893dec3f126</span><span class="op" id="2338966">,</span>&nbsp;<span class="op" id="2338968">-</span><span class="num" id="2338969">529</span><span class="op" id="2338972">,</span>&nbsp;<span class="builtintype" id="2338974">false</span><span class="op" id="2338979">}</span><span class="op" id="2338980">,</span>&nbsp;&nbsp;<span class="comment" id="2338983">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2338995">{</span><span class="num" id="2338996">0xb5b5ada8aaff80b8</span><span class="op" id="2339014">,</span>&nbsp;<span class="op" id="2339016">-</span><span class="num" id="2339017">502</span><span class="op" id="2339020">,</span>&nbsp;<span class="builtintype" id="2339022">false</span><span class="op" id="2339027">}</span><span class="op" id="2339028">,</span>&nbsp;&nbsp;<span class="comment" id="2339031">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339043">{</span><span class="num" id="2339044">0x87625f056c7c4a8b</span><span class="op" id="2339062">,</span>&nbsp;<span class="op" id="2339064">-</span><span class="num" id="2339065">475</span><span class="op" id="2339068">,</span>&nbsp;<span class="builtintype" id="2339070">false</span><span class="op" id="2339075">}</span><span class="op" id="2339076">,</span>&nbsp;&nbsp;<span class="comment" id="2339079">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339091">{</span><span class="num" id="2339092">0xc9bcff6034c13053</span><span class="op" id="2339110">,</span>&nbsp;<span class="op" id="2339112">-</span><span class="num" id="2339113">449</span><span class="op" id="2339116">,</span>&nbsp;<span class="builtintype" id="2339118">false</span><span class="op" id="2339123">}</span><span class="op" id="2339124">,</span>&nbsp;&nbsp;<span class="comment" id="2339127">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339139">{</span><span class="num" id="2339140">0x964e858c91ba2655</span><span class="op" id="2339158">,</span>&nbsp;<span class="op" id="2339160">-</span><span class="num" id="2339161">422</span><span class="op" id="2339164">,</span>&nbsp;<span class="builtintype" id="2339166">false</span><span class="op" id="2339171">}</span><span class="op" id="2339172">,</span>&nbsp;&nbsp;<span class="comment" id="2339175">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339187">{</span><span class="num" id="2339188">0xdff9772470297ebd</span><span class="op" id="2339206">,</span>&nbsp;<span class="op" id="2339208">-</span><span class="num" id="2339209">396</span><span class="op" id="2339212">,</span>&nbsp;<span class="builtintype" id="2339214">false</span><span class="op" id="2339219">}</span><span class="op" id="2339220">,</span>&nbsp;&nbsp;<span class="comment" id="2339223">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339235">{</span><span class="num" id="2339236">0xa6dfbd9fb8e5b88f</span><span class="op" id="2339254">,</span>&nbsp;<span class="op" id="2339256">-</span><span class="num" id="2339257">369</span><span class="op" id="2339260">,</span>&nbsp;<span class="builtintype" id="2339262">false</span><span class="op" id="2339267">}</span><span class="op" id="2339268">,</span>&nbsp;&nbsp;<span class="comment" id="2339271">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339282">{</span><span class="num" id="2339283">0xf8a95fcf88747d94</span><span class="op" id="2339301">,</span>&nbsp;<span class="op" id="2339303">-</span><span class="num" id="2339304">343</span><span class="op" id="2339307">,</span>&nbsp;<span class="builtintype" id="2339309">false</span><span class="op" id="2339314">}</span><span class="op" id="2339315">,</span>&nbsp;&nbsp;<span class="comment" id="2339318">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339329">{</span><span class="num" id="2339330">0xb94470938fa89bcf</span><span class="op" id="2339348">,</span>&nbsp;<span class="op" id="2339350">-</span><span class="num" id="2339351">316</span><span class="op" id="2339354">,</span>&nbsp;<span class="builtintype" id="2339356">false</span><span class="op" id="2339361">}</span><span class="op" id="2339362">,</span>&nbsp;&nbsp;<span class="comment" id="2339365">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339376">{</span><span class="num" id="2339377">0x8a08f0f8bf0f156b</span><span class="op" id="2339395">,</span>&nbsp;<span class="op" id="2339397">-</span><span class="num" id="2339398">289</span><span class="op" id="2339401">,</span>&nbsp;<span class="builtintype" id="2339403">false</span><span class="op" id="2339408">}</span><span class="op" id="2339409">,</span>&nbsp;&nbsp;<span class="comment" id="2339412">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339423">{</span><span class="num" id="2339424">0xcdb02555653131b6</span><span class="op" id="2339442">,</span>&nbsp;<span class="op" id="2339444">-</span><span class="num" id="2339445">263</span><span class="op" id="2339448">,</span>&nbsp;<span class="builtintype" id="2339450">false</span><span class="op" id="2339455">}</span><span class="op" id="2339456">,</span>&nbsp;&nbsp;<span class="comment" id="2339459">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339470">{</span><span class="num" id="2339471">0x993fe2c6d07b7fac</span><span class="op" id="2339489">,</span>&nbsp;<span class="op" id="2339491">-</span><span class="num" id="2339492">236</span><span class="op" id="2339495">,</span>&nbsp;<span class="builtintype" id="2339497">false</span><span class="op" id="2339502">}</span><span class="op" id="2339503">,</span>&nbsp;&nbsp;<span class="comment" id="2339506">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339517">{</span><span class="num" id="2339518">0xe45c10c42a2b3b06</span><span class="op" id="2339536">,</span>&nbsp;<span class="op" id="2339538">-</span><span class="num" id="2339539">210</span><span class="op" id="2339542">,</span>&nbsp;<span class="builtintype" id="2339544">false</span><span class="op" id="2339549">}</span><span class="op" id="2339550">,</span>&nbsp;&nbsp;<span class="comment" id="2339553">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339564">{</span><span class="num" id="2339565">0xaa242499697392d3</span><span class="op" id="2339583">,</span>&nbsp;<span class="op" id="2339585">-</span><span class="num" id="2339586">183</span><span class="op" id="2339589">,</span>&nbsp;<span class="builtintype" id="2339591">false</span><span class="op" id="2339596">}</span><span class="op" id="2339597">,</span>&nbsp;&nbsp;<span class="comment" id="2339600">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339611">{</span><span class="num" id="2339612">0xfd87b5f28300ca0e</span><span class="op" id="2339630">,</span>&nbsp;<span class="op" id="2339632">-</span><span class="num" id="2339633">157</span><span class="op" id="2339636">,</span>&nbsp;<span class="builtintype" id="2339638">false</span><span class="op" id="2339643">}</span><span class="op" id="2339644">,</span>&nbsp;&nbsp;<span class="comment" id="2339647">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339658">{</span><span class="num" id="2339659">0xbce5086492111aeb</span><span class="op" id="2339677">,</span>&nbsp;<span class="op" id="2339679">-</span><span class="num" id="2339680">130</span><span class="op" id="2339683">,</span>&nbsp;<span class="builtintype" id="2339685">false</span><span class="op" id="2339690">}</span><span class="op" id="2339691">,</span>&nbsp;&nbsp;<span class="comment" id="2339694">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339705">{</span><span class="num" id="2339706">0x8cbccc096f5088cc</span><span class="op" id="2339724">,</span>&nbsp;<span class="op" id="2339726">-</span><span class="num" id="2339727">103</span><span class="op" id="2339730">,</span>&nbsp;<span class="builtintype" id="2339732">false</span><span class="op" id="2339737">}</span><span class="op" id="2339738">,</span>&nbsp;&nbsp;<span class="comment" id="2339741">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339752">{</span><span class="num" id="2339753">0xd1b71758e219652c</span><span class="op" id="2339771">,</span>&nbsp;<span class="op" id="2339773">-</span><span class="num" id="2339774">77</span><span class="op" id="2339776">,</span>&nbsp;<span class="builtintype" id="2339778">false</span><span class="op" id="2339783">}</span><span class="op" id="2339784">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2339788">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339798">{</span><span class="num" id="2339799">0x9c40000000000000</span><span class="op" id="2339817">,</span>&nbsp;<span class="op" id="2339819">-</span><span class="num" id="2339820">50</span><span class="op" id="2339822">,</span>&nbsp;<span class="builtintype" id="2339824">false</span><span class="op" id="2339829">}</span><span class="op" id="2339830">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2339834">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339843">{</span><span class="num" id="2339844">0xe8d4a51000000000</span><span class="op" id="2339862">,</span>&nbsp;<span class="op" id="2339864">-</span><span class="num" id="2339865">24</span><span class="op" id="2339867">,</span>&nbsp;<span class="builtintype" id="2339869">false</span><span class="op" id="2339874">}</span><span class="op" id="2339875">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2339879">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339889">{</span><span class="num" id="2339890">0xad78ebc5ac620000</span><span class="op" id="2339908">,</span>&nbsp;<span class="num" id="2339910">3</span><span class="op" id="2339911">,</span>&nbsp;<span class="builtintype" id="2339913">false</span><span class="op" id="2339918">}</span><span class="op" id="2339919">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339925">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339935">{</span><span class="num" id="2339936">0x813f3978f8940984</span><span class="op" id="2339954">,</span>&nbsp;<span class="num" id="2339956">30</span><span class="op" id="2339958">,</span>&nbsp;<span class="builtintype" id="2339960">false</span><span class="op" id="2339965">}</span><span class="op" id="2339966">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339971">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339981">{</span><span class="num" id="2339982">0xc097ce7bc90715b3</span><span class="op" id="2340000">,</span>&nbsp;<span class="num" id="2340002">56</span><span class="op" id="2340004">,</span>&nbsp;<span class="builtintype" id="2340006">false</span><span class="op" id="2340011">}</span><span class="op" id="2340012">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2340017">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340027">{</span><span class="num" id="2340028">0x8f7e32ce7bea5c70</span><span class="op" id="2340046">,</span>&nbsp;<span class="num" id="2340048">83</span><span class="op" id="2340050">,</span>&nbsp;<span class="builtintype" id="2340052">false</span><span class="op" id="2340057">}</span><span class="op" id="2340058">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2340063">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340073">{</span><span class="num" id="2340074">0xd5d238a4abe98068</span><span class="op" id="2340092">,</span>&nbsp;<span class="num" id="2340094">109</span><span class="op" id="2340097">,</span>&nbsp;<span class="builtintype" id="2340099">false</span><span class="op" id="2340104">}</span><span class="op" id="2340105">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340109">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340119">{</span><span class="num" id="2340120">0x9f4f2726179a2245</span><span class="op" id="2340138">,</span>&nbsp;<span class="num" id="2340140">136</span><span class="op" id="2340143">,</span>&nbsp;<span class="builtintype" id="2340145">false</span><span class="op" id="2340150">}</span><span class="op" id="2340151">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340155">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340165">{</span><span class="num" id="2340166">0xed63a231d4c4fb27</span><span class="op" id="2340184">,</span>&nbsp;<span class="num" id="2340186">162</span><span class="op" id="2340189">,</span>&nbsp;<span class="builtintype" id="2340191">false</span><span class="op" id="2340196">}</span><span class="op" id="2340197">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340201">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340211">{</span><span class="num" id="2340212">0xb0de65388cc8ada8</span><span class="op" id="2340230">,</span>&nbsp;<span class="num" id="2340232">189</span><span class="op" id="2340235">,</span>&nbsp;<span class="builtintype" id="2340237">false</span><span class="op" id="2340242">}</span><span class="op" id="2340243">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340247">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340257">{</span><span class="num" id="2340258">0x83c7088e1aab65db</span><span class="op" id="2340276">,</span>&nbsp;<span class="num" id="2340278">216</span><span class="op" id="2340281">,</span>&nbsp;<span class="builtintype" id="2340283">false</span><span class="op" id="2340288">}</span><span class="op" id="2340289">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340293">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340303">{</span><span class="num" id="2340304">0xc45d1df942711d9a</span><span class="op" id="2340322">,</span>&nbsp;<span class="num" id="2340324">242</span><span class="op" id="2340327">,</span>&nbsp;<span class="builtintype" id="2340329">false</span><span class="op" id="2340334">}</span><span class="op" id="2340335">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340339">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340349">{</span><span class="num" id="2340350">0x924d692ca61be758</span><span class="op" id="2340368">,</span>&nbsp;<span class="num" id="2340370">269</span><span class="op" id="2340373">,</span>&nbsp;<span class="builtintype" id="2340375">false</span><span class="op" id="2340380">}</span><span class="op" id="2340381">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340385">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340396">{</span><span class="num" id="2340397">0xda01ee641a708dea</span><span class="op" id="2340415">,</span>&nbsp;<span class="num" id="2340417">295</span><span class="op" id="2340420">,</span>&nbsp;<span class="builtintype" id="2340422">false</span><span class="op" id="2340427">}</span><span class="op" id="2340428">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340432">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340443">{</span><span class="num" id="2340444">0xa26da3999aef774a</span><span class="op" id="2340462">,</span>&nbsp;<span class="num" id="2340464">322</span><span class="op" id="2340467">,</span>&nbsp;<span class="builtintype" id="2340469">false</span><span class="op" id="2340474">}</span><span class="op" id="2340475">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340479">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340490">{</span><span class="num" id="2340491">0xf209787bb47d6b85</span><span class="op" id="2340509">,</span>&nbsp;<span class="num" id="2340511">348</span><span class="op" id="2340514">,</span>&nbsp;<span class="builtintype" id="2340516">false</span><span class="op" id="2340521">}</span><span class="op" id="2340522">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340526">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340537">{</span><span class="num" id="2340538">0xb454e4a179dd1877</span><span class="op" id="2340556">,</span>&nbsp;<span class="num" id="2340558">375</span><span class="op" id="2340561">,</span>&nbsp;<span class="builtintype" id="2340563">false</span><span class="op" id="2340568">}</span><span class="op" id="2340569">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340573">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340584">{</span><span class="num" id="2340585">0x865b86925b9bc5c2</span><span class="op" id="2340603">,</span>&nbsp;<span class="num" id="2340605">402</span><span class="op" id="2340608">,</span>&nbsp;<span class="builtintype" id="2340610">false</span><span class="op" id="2340615">}</span><span class="op" id="2340616">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340620">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340631">{</span><span class="num" id="2340632">0xc83553c5c8965d3d</span><span class="op" id="2340650">,</span>&nbsp;<span class="num" id="2340652">428</span><span class="op" id="2340655">,</span>&nbsp;<span class="builtintype" id="2340657">false</span><span class="op" id="2340662">}</span><span class="op" id="2340663">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340667">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340678">{</span><span class="num" id="2340679">0x952ab45cfa97a0b3</span><span class="op" id="2340697">,</span>&nbsp;<span class="num" id="2340699">455</span><span class="op" id="2340702">,</span>&nbsp;<span class="builtintype" id="2340704">false</span><span class="op" id="2340709">}</span><span class="op" id="2340710">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340714">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340725">{</span><span class="num" id="2340726">0xde469fbd99a05fe3</span><span class="op" id="2340744">,</span>&nbsp;<span class="num" id="2340746">481</span><span class="op" id="2340749">,</span>&nbsp;<span class="builtintype" id="2340751">false</span><span class="op" id="2340756">}</span><span class="op" id="2340757">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340761">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340772">{</span><span class="num" id="2340773">0xa59bc234db398c25</span><span class="op" id="2340791">,</span>&nbsp;<span class="num" id="2340793">508</span><span class="op" id="2340796">,</span>&nbsp;<span class="builtintype" id="2340798">false</span><span class="op" id="2340803">}</span><span class="op" id="2340804">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340808">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340819">{</span><span class="num" id="2340820">0xf6c69a72a3989f5c</span><span class="op" id="2340838">,</span>&nbsp;<span class="num" id="2340840">534</span><span class="op" id="2340843">,</span>&nbsp;<span class="builtintype" id="2340845">false</span><span class="op" id="2340850">}</span><span class="op" id="2340851">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340855">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340866">{</span><span class="num" id="2340867">0xb7dcbf5354e9bece</span><span class="op" id="2340885">,</span>&nbsp;<span class="num" id="2340887">561</span><span class="op" id="2340890">,</span>&nbsp;<span class="builtintype" id="2340892">false</span><span class="op" id="2340897">}</span><span class="op" id="2340898">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340902">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340913">{</span><span class="num" id="2340914">0x88fcf317f22241e2</span><span class="op" id="2340932">,</span>&nbsp;<span class="num" id="2340934">588</span><span class="op" id="2340937">,</span>&nbsp;<span class="builtintype" id="2340939">false</span><span class="op" id="2340944">}</span><span class="op" id="2340945">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340949">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340960">{</span><span class="num" id="2340961">0xcc20ce9bd35c78a5</span><span class="op" id="2340979">,</span>&nbsp;<span class="num" id="2340981">614</span><span class="op" id="2340984">,</span>&nbsp;<span class="builtintype" id="2340986">false</span><span class="op" id="2340991">}</span><span class="op" id="2340992">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2340996">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341007">{</span><span class="num" id="2341008">0x98165af37b2153df</span><span class="op" id="2341026">,</span>&nbsp;<span class="num" id="2341028">641</span><span class="op" id="2341031">,</span>&nbsp;<span class="builtintype" id="2341033">false</span><span class="op" id="2341038">}</span><span class="op" id="2341039">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341043">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341054">{</span><span class="num" id="2341055">0xe2a0b5dc971f303a</span><span class="op" id="2341073">,</span>&nbsp;<span class="num" id="2341075">667</span><span class="op" id="2341078">,</span>&nbsp;<span class="builtintype" id="2341080">false</span><span class="op" id="2341085">}</span><span class="op" id="2341086">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341090">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341101">{</span><span class="num" id="2341102">0xa8d9d1535ce3b396</span><span class="op" id="2341120">,</span>&nbsp;<span class="num" id="2341122">694</span><span class="op" id="2341125">,</span>&nbsp;<span class="builtintype" id="2341127">false</span><span class="op" id="2341132">}</span><span class="op" id="2341133">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341137">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341148">{</span><span class="num" id="2341149">0xfb9b7cd9a4a7443c</span><span class="op" id="2341167">,</span>&nbsp;<span class="num" id="2341169">720</span><span class="op" id="2341172">,</span>&nbsp;<span class="builtintype" id="2341174">false</span><span class="op" id="2341179">}</span><span class="op" id="2341180">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341184">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341195">{</span><span class="num" id="2341196">0xbb764c4ca7a44410</span><span class="op" id="2341214">,</span>&nbsp;<span class="num" id="2341216">747</span><span class="op" id="2341219">,</span>&nbsp;<span class="builtintype" id="2341221">false</span><span class="op" id="2341226">}</span><span class="op" id="2341227">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341231">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341242">{</span><span class="num" id="2341243">0x8bab8eefb6409c1a</span><span class="op" id="2341261">,</span>&nbsp;<span class="num" id="2341263">774</span><span class="op" id="2341266">,</span>&nbsp;<span class="builtintype" id="2341268">false</span><span class="op" id="2341273">}</span><span class="op" id="2341274">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341278">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341289">{</span><span class="num" id="2341290">0xd01fef10a657842c</span><span class="op" id="2341308">,</span>&nbsp;<span class="num" id="2341310">800</span><span class="op" id="2341313">,</span>&nbsp;<span class="builtintype" id="2341315">false</span><span class="op" id="2341320">}</span><span class="op" id="2341321">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341325">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341336">{</span><span class="num" id="2341337">0x9b10a4e5e9913129</span><span class="op" id="2341355">,</span>&nbsp;<span class="num" id="2341357">827</span><span class="op" id="2341360">,</span>&nbsp;<span class="builtintype" id="2341362">false</span><span class="op" id="2341367">}</span><span class="op" id="2341368">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341372">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341383">{</span><span class="num" id="2341384">0xe7109bfba19c0c9d</span><span class="op" id="2341402">,</span>&nbsp;<span class="num" id="2341404">853</span><span class="op" id="2341407">,</span>&nbsp;<span class="builtintype" id="2341409">false</span><span class="op" id="2341414">}</span><span class="op" id="2341415">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341419">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341430">{</span><span class="num" id="2341431">0xac2820d9623bf429</span><span class="op" id="2341449">,</span>&nbsp;<span class="num" id="2341451">880</span><span class="op" id="2341454">,</span>&nbsp;<span class="builtintype" id="2341456">false</span><span class="op" id="2341461">}</span><span class="op" id="2341462">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341466">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341477">{</span><span class="num" id="2341478">0x80444b5e7aa7cf85</span><span class="op" id="2341496">,</span>&nbsp;<span class="num" id="2341498">907</span><span class="op" id="2341501">,</span>&nbsp;<span class="builtintype" id="2341503">false</span><span class="op" id="2341508">}</span><span class="op" id="2341509">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341513">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341524">{</span><span class="num" id="2341525">0xbf21e44003acdd2d</span><span class="op" id="2341543">,</span>&nbsp;<span class="num" id="2341545">933</span><span class="op" id="2341548">,</span>&nbsp;<span class="builtintype" id="2341550">false</span><span class="op" id="2341555">}</span><span class="op" id="2341556">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341560">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341571">{</span><span class="num" id="2341572">0x8e679c2f5e44ff8f</span><span class="op" id="2341590">,</span>&nbsp;<span class="num" id="2341592">960</span><span class="op" id="2341595">,</span>&nbsp;<span class="builtintype" id="2341597">false</span><span class="op" id="2341602">}</span><span class="op" id="2341603">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341607">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341618">{</span><span class="num" id="2341619">0xd433179d9c8cb841</span><span class="op" id="2341637">,</span>&nbsp;<span class="num" id="2341639">986</span><span class="op" id="2341642">,</span>&nbsp;<span class="builtintype" id="2341644">false</span><span class="op" id="2341649">}</span><span class="op" id="2341650">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2341654">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341665">{</span><span class="num" id="2341666">0x9e19db92b4e31ba9</span><span class="op" id="2341684">,</span>&nbsp;<span class="num" id="2341686">1013</span><span class="op" id="2341690">,</span>&nbsp;<span class="builtintype" id="2341692">false</span><span class="op" id="2341697">}</span><span class="op" id="2341698">,</span>&nbsp;&nbsp;<span class="comment" id="2341701">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341712">{</span><span class="num" id="2341713">0xeb96bf6ebadf77d9</span><span class="op" id="2341731">,</span>&nbsp;<span class="num" id="2341733">1039</span><span class="op" id="2341737">,</span>&nbsp;<span class="builtintype" id="2341739">false</span><span class="op" id="2341744">}</span><span class="op" id="2341745">,</span>&nbsp;&nbsp;<span class="comment" id="2341748">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341759">{</span><span class="num" id="2341760">0xaf87023b9bf0ee6b</span><span class="op" id="2341778">,</span>&nbsp;<span class="num" id="2341780">1066</span><span class="op" id="2341784">,</span>&nbsp;<span class="builtintype" id="2341786">false</span><span class="op" id="2341791">}</span><span class="op" id="2341792">,</span>&nbsp;&nbsp;<span class="comment" id="2341795">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2341805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2341808">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2341876">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2341939">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2341974">func</span>&nbsp;<span class="op" id="2341979">(</span><span class="ident" id="2341980">f</span>&nbsp;<span class="op" id="2341982">*</span><span class="ident" id="2341983">extFloat</span><span class="op" id="2341991">)</span>&nbsp;<span class="ident" id="2341993">floatBits</span><span class="op" id="2342002">(</span><span class="ident" id="2342003">flt</span>&nbsp;<span class="op" id="2342007">*</span><span class="ident" id="2342008">floatInfo</span><span class="op" id="2342017">)</span>&nbsp;<span class="op" id="2342019">(</span><span class="ident" id="2342020">bits</span>&nbsp;<span class="ident" id="2342025">uint64</span><span class="op" id="2342031">,</span>&nbsp;<span class="ident" id="2342033">overflow</span>&nbsp;<span class="builtintype" id="2342042">bool</span><span class="op" id="2342046">)</span>&nbsp;<span class="op" id="2342048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342051">f</span><span class="op" id="2342052">.</span><span class="ident" id="2342053">Normalize</span><span class="op" id="2342062">(</span><span class="op" id="2342063">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342067">exp</span>&nbsp;<span class="op" id="2342071">:=</span>&nbsp;<span class="ident" id="2342074">f</span><span class="op" id="2342075">.</span><span class="ident" id="2342076">exp</span>&nbsp;<span class="op" id="2342080">+</span>&nbsp;<span class="num" id="2342082">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342087">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342111">if</span>&nbsp;<span class="ident" id="2342114">exp</span>&nbsp;<span class="op" id="2342118">&lt;</span>&nbsp;<span class="ident" id="2342120">flt</span><span class="op" id="2342123">.</span><span class="ident" id="2342124">bias</span><span class="op" id="2342128">+</span><span class="num" id="2342129">1</span>&nbsp;<span class="op" id="2342131">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342135">n</span>&nbsp;<span class="op" id="2342137">:=</span>&nbsp;<span class="ident" id="2342140">flt</span><span class="op" id="2342143">.</span><span class="ident" id="2342144">bias</span>&nbsp;<span class="op" id="2342149">+</span>&nbsp;<span class="num" id="2342151">1</span>&nbsp;<span class="op" id="2342153">-</span>&nbsp;<span class="ident" id="2342155">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342161">f</span><span class="op" id="2342162">.</span><span class="ident" id="2342163">mant</span>&nbsp;<span class="op" id="2342168">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2342172">uint</span><span class="op" id="2342176">(</span><span class="ident" id="2342177">n</span><span class="op" id="2342178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342182">exp</span>&nbsp;<span class="op" id="2342186">+=</span>&nbsp;<span class="ident" id="2342189">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342196">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342254">mant</span>&nbsp;<span class="op" id="2342259">:=</span>&nbsp;<span class="ident" id="2342262">f</span><span class="op" id="2342263">.</span><span class="ident" id="2342264">mant</span>&nbsp;<span class="op" id="2342269">&gt;&gt;</span>&nbsp;<span class="op" id="2342272">(</span><span class="num" id="2342273">63</span>&nbsp;<span class="op" id="2342276">-</span>&nbsp;<span class="ident" id="2342278">flt</span><span class="op" id="2342281">.</span><span class="ident" id="2342282">mantbits</span><span class="op" id="2342290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342293">if</span>&nbsp;<span class="ident" id="2342296">f</span><span class="op" id="2342297">.</span><span class="ident" id="2342298">mant</span><span class="op" id="2342302">&amp;</span><span class="op" id="2342303">(</span><span class="num" id="2342304">1</span><span class="op" id="2342305">&lt;&lt;</span><span class="op" id="2342307">(</span><span class="num" id="2342308">62</span><span class="op" id="2342310">-</span><span class="ident" id="2342311">flt</span><span class="op" id="2342314">.</span><span class="ident" id="2342315">mantbits</span><span class="op" id="2342323">)</span><span class="op" id="2342324">)</span>&nbsp;<span class="op" id="2342326">!=</span>&nbsp;<span class="num" id="2342329">0</span>&nbsp;<span class="op" id="2342331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342335">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342350">mant</span>&nbsp;<span class="op" id="2342355">+=</span>&nbsp;<span class="num" id="2342358">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342365">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342414">if</span>&nbsp;<span class="ident" id="2342417">mant</span>&nbsp;<span class="op" id="2342422">==</span>&nbsp;<span class="num" id="2342425">2</span><span class="op" id="2342426">&lt;&lt;</span><span class="ident" id="2342428">flt</span><span class="op" id="2342431">.</span><span class="ident" id="2342432">mantbits</span>&nbsp;<span class="op" id="2342441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342445">mant</span>&nbsp;<span class="op" id="2342450">&gt;&gt;=</span>&nbsp;<span class="num" id="2342454">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342458">exp</span><span class="op" id="2342461">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342469">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342485">if</span>&nbsp;<span class="ident" id="2342488">exp</span><span class="op" id="2342491">-</span><span class="ident" id="2342492">flt</span><span class="op" id="2342495">.</span><span class="ident" id="2342496">bias</span>&nbsp;<span class="op" id="2342501">&gt;=</span>&nbsp;<span class="num" id="2342504">1</span><span class="op" id="2342505">&lt;&lt;</span><span class="ident" id="2342507">flt</span><span class="op" id="2342510">.</span><span class="ident" id="2342511">expbits</span><span class="op" id="2342518">-</span><span class="num" id="2342519">1</span>&nbsp;<span class="op" id="2342521">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342525">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342536">mant</span>&nbsp;<span class="op" id="2342541">=</span>&nbsp;<span class="num" id="2342543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342547">exp</span>&nbsp;<span class="op" id="2342551">=</span>&nbsp;<span class="num" id="2342553">1</span><span class="op" id="2342554">&lt;&lt;</span><span class="ident" id="2342556">flt</span><span class="op" id="2342559">.</span><span class="ident" id="2342560">expbits</span>&nbsp;<span class="op" id="2342568">-</span>&nbsp;<span class="num" id="2342570">1</span>&nbsp;<span class="op" id="2342572">+</span>&nbsp;<span class="ident" id="2342574">flt</span><span class="op" id="2342577">.</span><span class="ident" id="2342578">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342585">overflow</span>&nbsp;<span class="op" id="2342594">=</span>&nbsp;<span class="builtintype" id="2342596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342602">}</span>&nbsp;<span class="keyword" id="2342604">else</span>&nbsp;<span class="keyword" id="2342609">if</span>&nbsp;<span class="ident" id="2342612">mant</span><span class="op" id="2342616">&amp;</span><span class="op" id="2342617">(</span><span class="num" id="2342618">1</span><span class="op" id="2342619">&lt;&lt;</span><span class="ident" id="2342621">flt</span><span class="op" id="2342624">.</span><span class="ident" id="2342625">mantbits</span><span class="op" id="2342633">)</span>&nbsp;<span class="op" id="2342635">==</span>&nbsp;<span class="num" id="2342638">0</span>&nbsp;<span class="op" id="2342640">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342644">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342663">exp</span>&nbsp;<span class="op" id="2342667">=</span>&nbsp;<span class="ident" id="2342669">flt</span><span class="op" id="2342672">.</span><span class="ident" id="2342673">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342682">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342701">bits</span>&nbsp;<span class="op" id="2342706">=</span>&nbsp;<span class="ident" id="2342708">mant</span>&nbsp;<span class="op" id="2342713">&amp;</span>&nbsp;<span class="op" id="2342715">(</span><span class="ident" id="2342716">uint64</span><span class="op" id="2342722">(</span><span class="num" id="2342723">1</span><span class="op" id="2342724">)</span><span class="op" id="2342725">&lt;&lt;</span><span class="ident" id="2342727">flt</span><span class="op" id="2342730">.</span><span class="ident" id="2342731">mantbits</span>&nbsp;<span class="op" id="2342740">-</span>&nbsp;<span class="num" id="2342742">1</span><span class="op" id="2342743">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342746">bits</span>&nbsp;<span class="op" id="2342751">|=</span>&nbsp;<span class="ident" id="2342754">uint64</span><span class="op" id="2342760">(</span><span class="op" id="2342761">(</span><span class="ident" id="2342762">exp</span><span class="op" id="2342765">-</span><span class="ident" id="2342766">flt</span><span class="op" id="2342769">.</span><span class="ident" id="2342770">bias</span><span class="op" id="2342774">)</span><span class="op" id="2342775">&amp;</span><span class="op" id="2342776">(</span><span class="num" id="2342777">1</span><span class="op" id="2342778">&lt;&lt;</span><span class="ident" id="2342780">flt</span><span class="op" id="2342783">.</span><span class="ident" id="2342784">expbits</span><span class="op" id="2342791">-</span><span class="num" id="2342792">1</span><span class="op" id="2342793">)</span><span class="op" id="2342794">)</span>&nbsp;<span class="op" id="2342796">&lt;&lt;</span>&nbsp;<span class="ident" id="2342799">flt</span><span class="op" id="2342802">.</span><span class="ident" id="2342803">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342813">if</span>&nbsp;<span class="ident" id="2342816">f</span><span class="op" id="2342817">.</span><span class="ident" id="2342818">neg</span>&nbsp;<span class="op" id="2342822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342826">bits</span>&nbsp;<span class="op" id="2342831">|=</span>&nbsp;<span class="num" id="2342834">1</span>&nbsp;<span class="op" id="2342836">&lt;&lt;</span>&nbsp;<span class="op" id="2342839">(</span><span class="ident" id="2342840">flt</span><span class="op" id="2342843">.</span><span class="ident" id="2342844">mantbits</span>&nbsp;<span class="op" id="2342853">+</span>&nbsp;<span class="ident" id="2342855">flt</span><span class="op" id="2342858">.</span><span class="ident" id="2342859">expbits</span><span class="op" id="2342866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342872">return</span><br>
<span class="lineno">170</span><span class="op" id="2342879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2342882">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2342940">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2343003">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2343063">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2343134">func</span>&nbsp;<span class="op" id="2343139">(</span><span class="ident" id="2343140">f</span>&nbsp;<span class="op" id="2343142">*</span><span class="ident" id="2343143">extFloat</span><span class="op" id="2343151">)</span>&nbsp;<span class="ident" id="2343153">AssignComputeBounds</span><span class="op" id="2343172">(</span><span class="ident" id="2343173">mant</span>&nbsp;<span class="ident" id="2343178">uint64</span><span class="op" id="2343184">,</span>&nbsp;<span class="ident" id="2343186">exp</span>&nbsp;<span class="builtintype" id="2343190">int</span><span class="op" id="2343193">,</span>&nbsp;<span class="ident" id="2343195">neg</span>&nbsp;<span class="builtintype" id="2343199">bool</span><span class="op" id="2343203">,</span>&nbsp;<span class="ident" id="2343205">flt</span>&nbsp;<span class="op" id="2343209">*</span><span class="ident" id="2343210">floatInfo</span><span class="op" id="2343219">)</span>&nbsp;<span class="op" id="2343221">(</span><span class="ident" id="2343222">lower</span><span class="op" id="2343227">,</span>&nbsp;<span class="ident" id="2343229">upper</span>&nbsp;<span class="ident" id="2343235">extFloat</span><span class="op" id="2343243">)</span>&nbsp;<span class="op" id="2343245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343248">f</span><span class="op" id="2343249">.</span><span class="ident" id="2343250">mant</span>&nbsp;<span class="op" id="2343255">=</span>&nbsp;<span class="ident" id="2343257">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343263">f</span><span class="op" id="2343264">.</span><span class="ident" id="2343265">exp</span>&nbsp;<span class="op" id="2343269">=</span>&nbsp;<span class="ident" id="2343271">exp</span>&nbsp;<span class="op" id="2343275">-</span>&nbsp;<span class="builtintype" id="2343277">int</span><span class="op" id="2343280">(</span><span class="ident" id="2343281">flt</span><span class="op" id="2343284">.</span><span class="ident" id="2343285">mantbits</span><span class="op" id="2343293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343296">f</span><span class="op" id="2343297">.</span><span class="ident" id="2343298">neg</span>&nbsp;<span class="op" id="2343302">=</span>&nbsp;<span class="ident" id="2343304">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343309">if</span>&nbsp;<span class="ident" id="2343312">f</span><span class="op" id="2343313">.</span><span class="ident" id="2343314">exp</span>&nbsp;<span class="op" id="2343318">&lt;=</span>&nbsp;<span class="num" id="2343321">0</span>&nbsp;<span class="op" id="2343323">&amp;&amp;</span>&nbsp;<span class="ident" id="2343326">mant</span>&nbsp;<span class="op" id="2343331">==</span>&nbsp;<span class="op" id="2343334">(</span><span class="ident" id="2343335">mant</span><span class="op" id="2343339">&gt;&gt;</span><span class="builtintype" id="2343341">uint</span><span class="op" id="2343345">(</span><span class="op" id="2343346">-</span><span class="ident" id="2343347">f</span><span class="op" id="2343348">.</span><span class="ident" id="2343349">exp</span><span class="op" id="2343352">)</span><span class="op" id="2343353">)</span><span class="op" id="2343354">&lt;&lt;</span><span class="builtintype" id="2343356">uint</span><span class="op" id="2343360">(</span><span class="op" id="2343361">-</span><span class="ident" id="2343362">f</span><span class="op" id="2343363">.</span><span class="ident" id="2343364">exp</span><span class="op" id="2343367">)</span>&nbsp;<span class="op" id="2343369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2343373">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343395">f</span><span class="op" id="2343396">.</span><span class="ident" id="2343397">mant</span>&nbsp;<span class="op" id="2343402">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2343406">uint</span><span class="op" id="2343410">(</span><span class="op" id="2343411">-</span><span class="ident" id="2343412">f</span><span class="op" id="2343413">.</span><span class="ident" id="2343414">exp</span><span class="op" id="2343417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343421">f</span><span class="op" id="2343422">.</span><span class="ident" id="2343423">exp</span>&nbsp;<span class="op" id="2343427">=</span>&nbsp;<span class="num" id="2343429">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343433">return</span>&nbsp;<span class="op" id="2343440">*</span><span class="ident" id="2343441">f</span><span class="op" id="2343442">,</span>&nbsp;<span class="op" id="2343444">*</span><span class="ident" id="2343445">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343451">expBiased</span>&nbsp;<span class="op" id="2343461">:=</span>&nbsp;<span class="ident" id="2343464">exp</span>&nbsp;<span class="op" id="2343468">-</span>&nbsp;<span class="ident" id="2343470">flt</span><span class="op" id="2343473">.</span><span class="ident" id="2343474">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343481">upper</span>&nbsp;<span class="op" id="2343487">=</span>&nbsp;<span class="ident" id="2343489">extFloat</span><span class="op" id="2343497">{</span><span class="ident" id="2343498">mant</span><span class="op" id="2343502">:</span>&nbsp;<span class="num" id="2343504">2</span><span class="op" id="2343505">*</span><span class="ident" id="2343506">f</span><span class="op" id="2343507">.</span><span class="ident" id="2343508">mant</span>&nbsp;<span class="op" id="2343513">+</span>&nbsp;<span class="num" id="2343515">1</span><span class="op" id="2343516">,</span>&nbsp;<span class="ident" id="2343518">exp</span><span class="op" id="2343521">:</span>&nbsp;<span class="ident" id="2343523">f</span><span class="op" id="2343524">.</span><span class="ident" id="2343525">exp</span>&nbsp;<span class="op" id="2343529">-</span>&nbsp;<span class="num" id="2343531">1</span><span class="op" id="2343532">,</span>&nbsp;<span class="ident" id="2343534">neg</span><span class="op" id="2343537">:</span>&nbsp;<span class="ident" id="2343539">f</span><span class="op" id="2343540">.</span><span class="ident" id="2343541">neg</span><span class="op" id="2343544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343547">if</span>&nbsp;<span class="ident" id="2343550">mant</span>&nbsp;<span class="op" id="2343555">!=</span>&nbsp;<span class="num" id="2343558">1</span><span class="op" id="2343559">&lt;&lt;</span><span class="ident" id="2343561">flt</span><span class="op" id="2343564">.</span><span class="ident" id="2343565">mantbits</span>&nbsp;<span class="op" id="2343574">||</span>&nbsp;<span class="ident" id="2343577">expBiased</span>&nbsp;<span class="op" id="2343587">==</span>&nbsp;<span class="num" id="2343590">1</span>&nbsp;<span class="op" id="2343592">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343596">lower</span>&nbsp;<span class="op" id="2343602">=</span>&nbsp;<span class="ident" id="2343604">extFloat</span><span class="op" id="2343612">{</span><span class="ident" id="2343613">mant</span><span class="op" id="2343617">:</span>&nbsp;<span class="num" id="2343619">2</span><span class="op" id="2343620">*</span><span class="ident" id="2343621">f</span><span class="op" id="2343622">.</span><span class="ident" id="2343623">mant</span>&nbsp;<span class="op" id="2343628">-</span>&nbsp;<span class="num" id="2343630">1</span><span class="op" id="2343631">,</span>&nbsp;<span class="ident" id="2343633">exp</span><span class="op" id="2343636">:</span>&nbsp;<span class="ident" id="2343638">f</span><span class="op" id="2343639">.</span><span class="ident" id="2343640">exp</span>&nbsp;<span class="op" id="2343644">-</span>&nbsp;<span class="num" id="2343646">1</span><span class="op" id="2343647">,</span>&nbsp;<span class="ident" id="2343649">neg</span><span class="op" id="2343652">:</span>&nbsp;<span class="ident" id="2343654">f</span><span class="op" id="2343655">.</span><span class="ident" id="2343656">neg</span><span class="op" id="2343659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343662">}</span>&nbsp;<span class="keyword" id="2343664">else</span>&nbsp;<span class="op" id="2343669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343673">lower</span>&nbsp;<span class="op" id="2343679">=</span>&nbsp;<span class="ident" id="2343681">extFloat</span><span class="op" id="2343689">{</span><span class="ident" id="2343690">mant</span><span class="op" id="2343694">:</span>&nbsp;<span class="num" id="2343696">4</span><span class="op" id="2343697">*</span><span class="ident" id="2343698">f</span><span class="op" id="2343699">.</span><span class="ident" id="2343700">mant</span>&nbsp;<span class="op" id="2343705">-</span>&nbsp;<span class="num" id="2343707">1</span><span class="op" id="2343708">,</span>&nbsp;<span class="ident" id="2343710">exp</span><span class="op" id="2343713">:</span>&nbsp;<span class="ident" id="2343715">f</span><span class="op" id="2343716">.</span><span class="ident" id="2343717">exp</span>&nbsp;<span class="op" id="2343721">-</span>&nbsp;<span class="num" id="2343723">2</span><span class="op" id="2343724">,</span>&nbsp;<span class="ident" id="2343726">neg</span><span class="op" id="2343729">:</span>&nbsp;<span class="ident" id="2343731">f</span><span class="op" id="2343732">.</span><span class="ident" id="2343733">neg</span><span class="op" id="2343736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343742">return</span><br>
<span class="lineno">195</span><span class="op" id="2343749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2343752">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2343821">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2343892">func</span>&nbsp;<span class="op" id="2343897">(</span><span class="ident" id="2343898">f</span>&nbsp;<span class="op" id="2343900">*</span><span class="ident" id="2343901">extFloat</span><span class="op" id="2343909">)</span>&nbsp;<span class="ident" id="2343911">Normalize</span><span class="op" id="2343920">(</span><span class="op" id="2343921">)</span>&nbsp;<span class="op" id="2343923">(</span><span class="ident" id="2343924">shift</span>&nbsp;<span class="builtintype" id="2343930">uint</span><span class="op" id="2343934">)</span>&nbsp;<span class="op" id="2343936">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343939">mant</span><span class="op" id="2343943">,</span>&nbsp;<span class="ident" id="2343945">exp</span>&nbsp;<span class="op" id="2343949">:=</span>&nbsp;<span class="ident" id="2343952">f</span><span class="op" id="2343953">.</span><span class="ident" id="2343954">mant</span><span class="op" id="2343958">,</span>&nbsp;<span class="ident" id="2343960">f</span><span class="op" id="2343961">.</span><span class="ident" id="2343962">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343967">if</span>&nbsp;<span class="ident" id="2343970">mant</span>&nbsp;<span class="op" id="2343975">==</span>&nbsp;<span class="num" id="2343978">0</span>&nbsp;<span class="op" id="2343980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343984">return</span>&nbsp;<span class="num" id="2343991">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343997">if</span>&nbsp;<span class="ident" id="2344000">mant</span><span class="op" id="2344004">&gt;&gt;</span><span class="op" id="2344006">(</span><span class="num" id="2344007">64</span><span class="op" id="2344009">-</span><span class="num" id="2344010">32</span><span class="op" id="2344012">)</span>&nbsp;<span class="op" id="2344014">==</span>&nbsp;<span class="num" id="2344017">0</span>&nbsp;<span class="op" id="2344019">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344023">mant</span>&nbsp;<span class="op" id="2344028">&lt;&lt;=</span>&nbsp;<span class="num" id="2344032">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344037">exp</span>&nbsp;<span class="op" id="2344041">-=</span>&nbsp;<span class="num" id="2344044">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344051">if</span>&nbsp;<span class="ident" id="2344054">mant</span><span class="op" id="2344058">&gt;&gt;</span><span class="op" id="2344060">(</span><span class="num" id="2344061">64</span><span class="op" id="2344063">-</span><span class="num" id="2344064">16</span><span class="op" id="2344066">)</span>&nbsp;<span class="op" id="2344068">==</span>&nbsp;<span class="num" id="2344071">0</span>&nbsp;<span class="op" id="2344073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344077">mant</span>&nbsp;<span class="op" id="2344082">&lt;&lt;=</span>&nbsp;<span class="num" id="2344086">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344091">exp</span>&nbsp;<span class="op" id="2344095">-=</span>&nbsp;<span class="num" id="2344098">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344105">if</span>&nbsp;<span class="ident" id="2344108">mant</span><span class="op" id="2344112">&gt;&gt;</span><span class="op" id="2344114">(</span><span class="num" id="2344115">64</span><span class="op" id="2344117">-</span><span class="num" id="2344118">8</span><span class="op" id="2344119">)</span>&nbsp;<span class="op" id="2344121">==</span>&nbsp;<span class="num" id="2344124">0</span>&nbsp;<span class="op" id="2344126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344130">mant</span>&nbsp;<span class="op" id="2344135">&lt;&lt;=</span>&nbsp;<span class="num" id="2344139">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344143">exp</span>&nbsp;<span class="op" id="2344147">-=</span>&nbsp;<span class="num" id="2344150">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344156">if</span>&nbsp;<span class="ident" id="2344159">mant</span><span class="op" id="2344163">&gt;&gt;</span><span class="op" id="2344165">(</span><span class="num" id="2344166">64</span><span class="op" id="2344168">-</span><span class="num" id="2344169">4</span><span class="op" id="2344170">)</span>&nbsp;<span class="op" id="2344172">==</span>&nbsp;<span class="num" id="2344175">0</span>&nbsp;<span class="op" id="2344177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344181">mant</span>&nbsp;<span class="op" id="2344186">&lt;&lt;=</span>&nbsp;<span class="num" id="2344190">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344194">exp</span>&nbsp;<span class="op" id="2344198">-=</span>&nbsp;<span class="num" id="2344201">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344204">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344207">if</span>&nbsp;<span class="ident" id="2344210">mant</span><span class="op" id="2344214">&gt;&gt;</span><span class="op" id="2344216">(</span><span class="num" id="2344217">64</span><span class="op" id="2344219">-</span><span class="num" id="2344220">2</span><span class="op" id="2344221">)</span>&nbsp;<span class="op" id="2344223">==</span>&nbsp;<span class="num" id="2344226">0</span>&nbsp;<span class="op" id="2344228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344232">mant</span>&nbsp;<span class="op" id="2344237">&lt;&lt;=</span>&nbsp;<span class="num" id="2344241">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344245">exp</span>&nbsp;<span class="op" id="2344249">-=</span>&nbsp;<span class="num" id="2344252">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344258">if</span>&nbsp;<span class="ident" id="2344261">mant</span><span class="op" id="2344265">&gt;&gt;</span><span class="op" id="2344267">(</span><span class="num" id="2344268">64</span><span class="op" id="2344270">-</span><span class="num" id="2344271">1</span><span class="op" id="2344272">)</span>&nbsp;<span class="op" id="2344274">==</span>&nbsp;<span class="num" id="2344277">0</span>&nbsp;<span class="op" id="2344279">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344283">mant</span>&nbsp;<span class="op" id="2344288">&lt;&lt;=</span>&nbsp;<span class="num" id="2344292">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344296">exp</span>&nbsp;<span class="op" id="2344300">-=</span>&nbsp;<span class="num" id="2344303">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344309">shift</span>&nbsp;<span class="op" id="2344315">=</span>&nbsp;<span class="builtintype" id="2344317">uint</span><span class="op" id="2344321">(</span><span class="ident" id="2344322">f</span><span class="op" id="2344323">.</span><span class="ident" id="2344324">exp</span>&nbsp;<span class="op" id="2344328">-</span>&nbsp;<span class="ident" id="2344330">exp</span><span class="op" id="2344333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344336">f</span><span class="op" id="2344337">.</span><span class="ident" id="2344338">mant</span><span class="op" id="2344342">,</span>&nbsp;<span class="ident" id="2344344">f</span><span class="op" id="2344345">.</span><span class="ident" id="2344346">exp</span>&nbsp;<span class="op" id="2344350">=</span>&nbsp;<span class="ident" id="2344352">mant</span><span class="op" id="2344356">,</span>&nbsp;<span class="ident" id="2344358">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344363">return</span><br>
<span class="lineno"></span><span class="op" id="2344370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2344373">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2344445">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2344468">func</span>&nbsp;<span class="op" id="2344473">(</span><span class="ident" id="2344474">f</span>&nbsp;<span class="op" id="2344476">*</span><span class="ident" id="2344477">extFloat</span><span class="op" id="2344485">)</span>&nbsp;<span class="ident" id="2344487">Multiply</span><span class="op" id="2344495">(</span><span class="ident" id="2344496">g</span>&nbsp;<span class="ident" id="2344498">extFloat</span><span class="op" id="2344506">)</span>&nbsp;<span class="op" id="2344508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344511">fhi</span><span class="op" id="2344514">,</span>&nbsp;<span class="ident" id="2344516">flo</span>&nbsp;<span class="op" id="2344520">:=</span>&nbsp;<span class="ident" id="2344523">f</span><span class="op" id="2344524">.</span><span class="ident" id="2344525">mant</span><span class="op" id="2344529">&gt;&gt;</span><span class="num" id="2344531">32</span><span class="op" id="2344533">,</span>&nbsp;<span class="ident" id="2344535">uint64</span><span class="op" id="2344541">(</span><span class="builtintype" id="2344542">uint32</span><span class="op" id="2344548">(</span><span class="ident" id="2344549">f</span><span class="op" id="2344550">.</span><span class="ident" id="2344551">mant</span><span class="op" id="2344555">)</span><span class="op" id="2344556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344559">ghi</span><span class="op" id="2344562">,</span>&nbsp;<span class="ident" id="2344564">glo</span>&nbsp;<span class="op" id="2344568">:=</span>&nbsp;<span class="ident" id="2344571">g</span><span class="op" id="2344572">.</span><span class="ident" id="2344573">mant</span><span class="op" id="2344577">&gt;&gt;</span><span class="num" id="2344579">32</span><span class="op" id="2344581">,</span>&nbsp;<span class="ident" id="2344583">uint64</span><span class="op" id="2344589">(</span><span class="builtintype" id="2344590">uint32</span><span class="op" id="2344596">(</span><span class="ident" id="2344597">g</span><span class="op" id="2344598">.</span><span class="ident" id="2344599">mant</span><span class="op" id="2344603">)</span><span class="op" id="2344604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2344608">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344628">cross1</span>&nbsp;<span class="op" id="2344635">:=</span>&nbsp;<span class="ident" id="2344638">fhi</span>&nbsp;<span class="op" id="2344642">*</span>&nbsp;<span class="ident" id="2344644">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344649">cross2</span>&nbsp;<span class="op" id="2344656">:=</span>&nbsp;<span class="ident" id="2344659">flo</span>&nbsp;<span class="op" id="2344663">*</span>&nbsp;<span class="ident" id="2344665">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2344671">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344740">f</span><span class="op" id="2344741">.</span><span class="ident" id="2344742">mant</span>&nbsp;<span class="op" id="2344747">=</span>&nbsp;<span class="ident" id="2344749">fhi</span><span class="op" id="2344752">*</span><span class="ident" id="2344753">ghi</span>&nbsp;<span class="op" id="2344757">+</span>&nbsp;<span class="op" id="2344759">(</span><span class="ident" id="2344760">cross1</span>&nbsp;<span class="op" id="2344767">&gt;&gt;</span>&nbsp;<span class="num" id="2344770">32</span><span class="op" id="2344772">)</span>&nbsp;<span class="op" id="2344774">+</span>&nbsp;<span class="op" id="2344776">(</span><span class="ident" id="2344777">cross2</span>&nbsp;<span class="op" id="2344784">&gt;&gt;</span>&nbsp;<span class="num" id="2344787">32</span><span class="op" id="2344789">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344792">rem</span>&nbsp;<span class="op" id="2344796">:=</span>&nbsp;<span class="ident" id="2344799">uint64</span><span class="op" id="2344805">(</span><span class="builtintype" id="2344806">uint32</span><span class="op" id="2344812">(</span><span class="ident" id="2344813">cross1</span><span class="op" id="2344819">)</span><span class="op" id="2344820">)</span>&nbsp;<span class="op" id="2344822">+</span>&nbsp;<span class="ident" id="2344824">uint64</span><span class="op" id="2344830">(</span><span class="builtintype" id="2344831">uint32</span><span class="op" id="2344837">(</span><span class="ident" id="2344838">cross2</span><span class="op" id="2344844">)</span><span class="op" id="2344845">)</span>&nbsp;<span class="op" id="2344847">+</span>&nbsp;<span class="op" id="2344849">(</span><span class="op" id="2344850">(</span><span class="ident" id="2344851">flo</span>&nbsp;<span class="op" id="2344855">*</span>&nbsp;<span class="ident" id="2344857">glo</span><span class="op" id="2344860">)</span>&nbsp;<span class="op" id="2344862">&gt;&gt;</span>&nbsp;<span class="num" id="2344865">32</span><span class="op" id="2344867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2344870">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344884">rem</span>&nbsp;<span class="op" id="2344888">+=</span>&nbsp;<span class="op" id="2344891">(</span><span class="num" id="2344892">1</span>&nbsp;<span class="op" id="2344894">&lt;&lt;</span>&nbsp;<span class="num" id="2344897">31</span><span class="op" id="2344899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344903">f</span><span class="op" id="2344904">.</span><span class="ident" id="2344905">mant</span>&nbsp;<span class="op" id="2344910">+=</span>&nbsp;<span class="op" id="2344913">(</span><span class="ident" id="2344914">rem</span>&nbsp;<span class="op" id="2344918">&gt;&gt;</span>&nbsp;<span class="num" id="2344921">32</span><span class="op" id="2344923">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344926">f</span><span class="op" id="2344927">.</span><span class="ident" id="2344928">exp</span>&nbsp;<span class="op" id="2344932">=</span>&nbsp;<span class="ident" id="2344934">f</span><span class="op" id="2344935">.</span><span class="ident" id="2344936">exp</span>&nbsp;<span class="op" id="2344940">+</span>&nbsp;<span class="ident" id="2344942">g</span><span class="op" id="2344943">.</span><span class="ident" id="2344944">exp</span>&nbsp;<span class="op" id="2344948">+</span>&nbsp;<span class="num" id="2344950">64</span><br>
<span class="lineno"></span><span class="op" id="2344953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2344956">var</span>&nbsp;<span class="ident" id="2344960">uint64pow10</span>&nbsp;<span class="op" id="2344972">=</span>&nbsp;<span class="op" id="2344974">[</span><span class="op" id="2344975">...</span><span class="op" id="2344978">]</span><span class="ident" id="2344979">uint64</span><span class="op" id="2344985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2344988">1</span><span class="op" id="2344989">,</span>&nbsp;<span class="num" id="2344991">1e1</span><span class="op" id="2344994">,</span>&nbsp;<span class="num" id="2344996">1e2</span><span class="op" id="2344999">,</span>&nbsp;<span class="num" id="2345001">1e3</span><span class="op" id="2345004">,</span>&nbsp;<span class="num" id="2345006">1e4</span><span class="op" id="2345009">,</span>&nbsp;<span class="num" id="2345011">1e5</span><span class="op" id="2345014">,</span>&nbsp;<span class="num" id="2345016">1e6</span><span class="op" id="2345019">,</span>&nbsp;<span class="num" id="2345021">1e7</span><span class="op" id="2345024">,</span>&nbsp;<span class="num" id="2345026">1e8</span><span class="op" id="2345029">,</span>&nbsp;<span class="num" id="2345031">1e9</span><span class="op" id="2345034">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2345037">1e10</span><span class="op" id="2345041">,</span>&nbsp;<span class="num" id="2345043">1e11</span><span class="op" id="2345047">,</span>&nbsp;<span class="num" id="2345049">1e12</span><span class="op" id="2345053">,</span>&nbsp;<span class="num" id="2345055">1e13</span><span class="op" id="2345059">,</span>&nbsp;<span class="num" id="2345061">1e14</span><span class="op" id="2345065">,</span>&nbsp;<span class="num" id="2345067">1e15</span><span class="op" id="2345071">,</span>&nbsp;<span class="num" id="2345073">1e16</span><span class="op" id="2345077">,</span>&nbsp;<span class="num" id="2345079">1e17</span><span class="op" id="2345083">,</span>&nbsp;<span class="num" id="2345085">1e18</span><span class="op" id="2345089">,</span>&nbsp;<span class="num" id="2345091">1e19</span><span class="op" id="2345095">,</span><br>
<span class="lineno"></span><span class="op" id="2345097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2345100">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2345168">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2345238">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2345301">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2345330">func</span>&nbsp;<span class="op" id="2345335">(</span><span class="ident" id="2345336">f</span>&nbsp;<span class="op" id="2345338">*</span><span class="ident" id="2345339">extFloat</span><span class="op" id="2345347">)</span>&nbsp;<span class="ident" id="2345349">AssignDecimal</span><span class="op" id="2345362">(</span><span class="ident" id="2345363">mantissa</span>&nbsp;<span class="ident" id="2345372">uint64</span><span class="op" id="2345378">,</span>&nbsp;<span class="ident" id="2345380">exp10</span>&nbsp;<span class="builtintype" id="2345386">int</span><span class="op" id="2345389">,</span>&nbsp;<span class="ident" id="2345391">neg</span>&nbsp;<span class="builtintype" id="2345395">bool</span><span class="op" id="2345399">,</span>&nbsp;<span class="ident" id="2345401">trunc</span>&nbsp;<span class="builtintype" id="2345407">bool</span><span class="op" id="2345411">,</span>&nbsp;<span class="ident" id="2345413">flt</span>&nbsp;<span class="op" id="2345417">*</span><span class="ident" id="2345418">floatInfo</span><span class="op" id="2345427">)</span>&nbsp;<span class="op" id="2345429">(</span><span class="ident" id="2345430">ok</span>&nbsp;<span class="builtintype" id="2345433">bool</span><span class="op" id="2345437">)</span>&nbsp;<span class="op" id="2345439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345442">const</span>&nbsp;<span class="ident" id="2345448">uint64digits</span>&nbsp;<span class="op" id="2345461">=</span>&nbsp;<span class="num" id="2345463">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345467">const</span>&nbsp;<span class="ident" id="2345473">errorscale</span>&nbsp;<span class="op" id="2345484">=</span>&nbsp;<span class="num" id="2345486">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345489">errors</span>&nbsp;<span class="op" id="2345496">:=</span>&nbsp;<span class="num" id="2345499">0</span>&nbsp;<span class="comment" id="2345501">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345559">if</span>&nbsp;<span class="ident" id="2345562">trunc</span>&nbsp;<span class="op" id="2345568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2345572">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345611">errors</span>&nbsp;<span class="op" id="2345618">+=</span>&nbsp;<span class="ident" id="2345621">errorscale</span>&nbsp;<span class="op" id="2345632">/</span>&nbsp;<span class="num" id="2345634">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345637">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345641">f</span><span class="op" id="2345642">.</span><span class="ident" id="2345643">mant</span>&nbsp;<span class="op" id="2345648">=</span>&nbsp;<span class="ident" id="2345650">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345660">f</span><span class="op" id="2345661">.</span><span class="ident" id="2345662">exp</span>&nbsp;<span class="op" id="2345666">=</span>&nbsp;<span class="num" id="2345668">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345671">f</span><span class="op" id="2345672">.</span><span class="ident" id="2345673">neg</span>&nbsp;<span class="op" id="2345677">=</span>&nbsp;<span class="ident" id="2345679">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2345685">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345716">i</span>&nbsp;<span class="op" id="2345718">:=</span>&nbsp;<span class="op" id="2345721">(</span><span class="ident" id="2345722">exp10</span>&nbsp;<span class="op" id="2345728">-</span>&nbsp;<span class="ident" id="2345730">firstPowerOfTen</span><span class="op" id="2345745">)</span>&nbsp;<span class="op" id="2345747">/</span>&nbsp;<span class="ident" id="2345749">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345765">if</span>&nbsp;<span class="ident" id="2345768">exp10</span>&nbsp;<span class="op" id="2345774">&lt;</span>&nbsp;<span class="ident" id="2345776">firstPowerOfTen</span>&nbsp;<span class="op" id="2345792">||</span>&nbsp;<span class="ident" id="2345795">i</span>&nbsp;<span class="op" id="2345797">&gt;=</span>&nbsp;<span class="builtinfunc" id="2345800">len</span><span class="op" id="2345803">(</span><span class="ident" id="2345804">powersOfTen</span><span class="op" id="2345815">)</span>&nbsp;<span class="op" id="2345817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345821">return</span>&nbsp;<span class="builtintype" id="2345828">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345835">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345838">adjExp</span>&nbsp;<span class="op" id="2345845">:=</span>&nbsp;<span class="op" id="2345848">(</span><span class="ident" id="2345849">exp10</span>&nbsp;<span class="op" id="2345855">-</span>&nbsp;<span class="ident" id="2345857">firstPowerOfTen</span><span class="op" id="2345872">)</span>&nbsp;<span class="op" id="2345874">%</span>&nbsp;<span class="ident" id="2345876">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2345893">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345921">if</span>&nbsp;<span class="ident" id="2345924">adjExp</span>&nbsp;<span class="op" id="2345931">&lt;</span>&nbsp;<span class="ident" id="2345933">uint64digits</span>&nbsp;<span class="op" id="2345946">&amp;&amp;</span>&nbsp;<span class="ident" id="2345949">mantissa</span>&nbsp;<span class="op" id="2345958">&lt;</span>&nbsp;<span class="ident" id="2345960">uint64pow10</span><span class="op" id="2345971">[</span><span class="ident" id="2345972">uint64digits</span><span class="op" id="2345984">-</span><span class="ident" id="2345985">adjExp</span><span class="op" id="2345991">]</span>&nbsp;<span class="op" id="2345993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2345997">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346040">f</span><span class="op" id="2346041">.</span><span class="ident" id="2346042">mant</span>&nbsp;<span class="op" id="2346047">*=</span>&nbsp;<span class="ident" id="2346050">uint64pow10</span><span class="op" id="2346061">[</span><span class="ident" id="2346062">adjExp</span><span class="op" id="2346068">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346072">f</span><span class="op" id="2346073">.</span><span class="ident" id="2346074">Normalize</span><span class="op" id="2346083">(</span><span class="op" id="2346084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346087">}</span>&nbsp;<span class="keyword" id="2346089">else</span>&nbsp;<span class="op" id="2346094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346098">f</span><span class="op" id="2346099">.</span><span class="ident" id="2346100">Normalize</span><span class="op" id="2346109">(</span><span class="op" id="2346110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346114">f</span><span class="op" id="2346115">.</span><span class="ident" id="2346116">Multiply</span><span class="op" id="2346124">(</span><span class="ident" id="2346125">smallPowersOfTen</span><span class="op" id="2346141">[</span><span class="ident" id="2346142">adjExp</span><span class="op" id="2346148">]</span><span class="op" id="2346149">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346153">errors</span>&nbsp;<span class="op" id="2346160">+=</span>&nbsp;<span class="ident" id="2346163">errorscale</span>&nbsp;<span class="op" id="2346174">/</span>&nbsp;<span class="num" id="2346176">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346183">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346228">f</span><span class="op" id="2346229">.</span><span class="ident" id="2346230">Multiply</span><span class="op" id="2346238">(</span><span class="ident" id="2346239">powersOfTen</span><span class="op" id="2346250">[</span><span class="ident" id="2346251">i</span><span class="op" id="2346252">]</span><span class="op" id="2346253">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346256">if</span>&nbsp;<span class="ident" id="2346259">errors</span>&nbsp;<span class="op" id="2346266">&gt;</span>&nbsp;<span class="num" id="2346268">0</span>&nbsp;<span class="op" id="2346270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346274">errors</span>&nbsp;<span class="op" id="2346281">+=</span>&nbsp;<span class="num" id="2346284">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346290">errors</span>&nbsp;<span class="op" id="2346297">+=</span>&nbsp;<span class="ident" id="2346300">errorscale</span>&nbsp;<span class="op" id="2346311">/</span>&nbsp;<span class="num" id="2346313">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346317">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346331">shift</span>&nbsp;<span class="op" id="2346337">:=</span>&nbsp;<span class="ident" id="2346340">f</span><span class="op" id="2346341">.</span><span class="ident" id="2346342">Normalize</span><span class="op" id="2346351">(</span><span class="op" id="2346352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346355">errors</span>&nbsp;<span class="op" id="2346362">&lt;&lt;=</span>&nbsp;<span class="ident" id="2346366">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346374">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346424">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346491">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346559">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346628">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346632">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346689">denormalExp</span>&nbsp;<span class="op" id="2346701">:=</span>&nbsp;<span class="ident" id="2346704">flt</span><span class="op" id="2346707">.</span><span class="ident" id="2346708">bias</span>&nbsp;<span class="op" id="2346713">-</span>&nbsp;<span class="num" id="2346715">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346719">var</span>&nbsp;<span class="ident" id="2346723">extrabits</span>&nbsp;<span class="builtintype" id="2346733">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346739">if</span>&nbsp;<span class="ident" id="2346742">f</span><span class="op" id="2346743">.</span><span class="ident" id="2346744">exp</span>&nbsp;<span class="op" id="2346748">&lt;=</span>&nbsp;<span class="ident" id="2346751">denormalExp</span>&nbsp;<span class="op" id="2346763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346767">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346821">extrabits</span>&nbsp;<span class="op" id="2346831">=</span>&nbsp;<span class="builtintype" id="2346833">uint</span><span class="op" id="2346837">(</span><span class="num" id="2346838">63</span>&nbsp;<span class="op" id="2346841">-</span>&nbsp;<span class="ident" id="2346843">flt</span><span class="op" id="2346846">.</span><span class="ident" id="2346847">mantbits</span>&nbsp;<span class="op" id="2346856">+</span>&nbsp;<span class="num" id="2346858">1</span>&nbsp;<span class="op" id="2346860">+</span>&nbsp;<span class="builtintype" id="2346862">uint</span><span class="op" id="2346866">(</span><span class="ident" id="2346867">denormalExp</span><span class="op" id="2346878">-</span><span class="ident" id="2346879">f</span><span class="op" id="2346880">.</span><span class="ident" id="2346881">exp</span><span class="op" id="2346884">)</span><span class="op" id="2346885">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346888">}</span>&nbsp;<span class="keyword" id="2346890">else</span>&nbsp;<span class="op" id="2346895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346899">extrabits</span>&nbsp;<span class="op" id="2346909">=</span>&nbsp;<span class="builtintype" id="2346911">uint</span><span class="op" id="2346915">(</span><span class="num" id="2346916">63</span>&nbsp;<span class="op" id="2346919">-</span>&nbsp;<span class="ident" id="2346921">flt</span><span class="op" id="2346924">.</span><span class="ident" id="2346925">mantbits</span><span class="op" id="2346933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346940">halfway</span>&nbsp;<span class="op" id="2346948">:=</span>&nbsp;<span class="ident" id="2346951">uint64</span><span class="op" id="2346957">(</span><span class="num" id="2346958">1</span><span class="op" id="2346959">)</span>&nbsp;<span class="op" id="2346961">&lt;&lt;</span>&nbsp;<span class="op" id="2346964">(</span><span class="ident" id="2346965">extrabits</span>&nbsp;<span class="op" id="2346975">-</span>&nbsp;<span class="num" id="2346977">1</span><span class="op" id="2346978">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346981">mant_extra</span>&nbsp;<span class="op" id="2346992">:=</span>&nbsp;<span class="ident" id="2346995">f</span><span class="op" id="2346996">.</span><span class="ident" id="2346997">mant</span>&nbsp;<span class="op" id="2347002">&amp;</span>&nbsp;<span class="op" id="2347004">(</span><span class="num" id="2347005">1</span><span class="op" id="2347006">&lt;&lt;</span><span class="ident" id="2347008">extrabits</span>&nbsp;<span class="op" id="2347018">-</span>&nbsp;<span class="num" id="2347020">1</span><span class="op" id="2347021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347025">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347091">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347156">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347198">if</span>&nbsp;<span class="ident" id="2347201">int64</span><span class="op" id="2347206">(</span><span class="ident" id="2347207">halfway</span><span class="op" id="2347214">)</span><span class="op" id="2347215">-</span><span class="ident" id="2347216">int64</span><span class="op" id="2347221">(</span><span class="ident" id="2347222">errors</span><span class="op" id="2347228">)</span>&nbsp;<span class="op" id="2347230">&lt;</span>&nbsp;<span class="ident" id="2347232">int64</span><span class="op" id="2347237">(</span><span class="ident" id="2347238">mant_extra</span><span class="op" id="2347248">)</span>&nbsp;<span class="op" id="2347250">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347255">int64</span><span class="op" id="2347260">(</span><span class="ident" id="2347261">mant_extra</span><span class="op" id="2347271">)</span>&nbsp;<span class="op" id="2347273">&lt;</span>&nbsp;<span class="ident" id="2347275">int64</span><span class="op" id="2347280">(</span><span class="ident" id="2347281">halfway</span><span class="op" id="2347288">)</span><span class="op" id="2347289">+</span><span class="ident" id="2347290">int64</span><span class="op" id="2347295">(</span><span class="ident" id="2347296">errors</span><span class="op" id="2347302">)</span>&nbsp;<span class="op" id="2347304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347308">return</span>&nbsp;<span class="builtintype" id="2347315">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347325">return</span>&nbsp;<span class="builtintype" id="2347332">true</span><br>
<span class="lineno">330</span><span class="op" id="2347337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2347340">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2347410">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2347477">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2347543">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2347604">func</span>&nbsp;<span class="op" id="2347609">(</span><span class="ident" id="2347610">f</span>&nbsp;<span class="op" id="2347612">*</span><span class="ident" id="2347613">extFloat</span><span class="op" id="2347621">)</span>&nbsp;<span class="ident" id="2347623">frexp10</span><span class="op" id="2347630">(</span><span class="op" id="2347631">)</span>&nbsp;<span class="op" id="2347633">(</span><span class="ident" id="2347634">exp10</span><span class="op" id="2347639">,</span>&nbsp;<span class="ident" id="2347641">index</span>&nbsp;<span class="builtintype" id="2347647">int</span><span class="op" id="2347650">)</span>&nbsp;<span class="op" id="2347652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347655">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347724">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347794">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347863">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347936">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347947">const</span>&nbsp;<span class="ident" id="2347953">expMin</span>&nbsp;<span class="op" id="2347960">=</span>&nbsp;<span class="op" id="2347962">-</span><span class="num" id="2347963">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347967">const</span>&nbsp;<span class="ident" id="2347973">expMax</span>&nbsp;<span class="op" id="2347980">=</span>&nbsp;<span class="op" id="2347982">-</span><span class="num" id="2347983">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347987">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2348050">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348081">approxExp10</span>&nbsp;<span class="op" id="2348093">:=</span>&nbsp;<span class="op" id="2348096">(</span><span class="op" id="2348097">(</span><span class="ident" id="2348098">expMin</span><span class="op" id="2348104">+</span><span class="ident" id="2348105">expMax</span><span class="op" id="2348111">)</span><span class="op" id="2348112">/</span><span class="num" id="2348113">2</span>&nbsp;<span class="op" id="2348115">-</span>&nbsp;<span class="ident" id="2348117">f</span><span class="op" id="2348118">.</span><span class="ident" id="2348119">exp</span><span class="op" id="2348122">)</span>&nbsp;<span class="op" id="2348124">*</span>&nbsp;<span class="num" id="2348126">28</span>&nbsp;<span class="op" id="2348129">/</span>&nbsp;<span class="num" id="2348131">93</span>&nbsp;<span class="comment" id="2348134">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348172">i</span>&nbsp;<span class="op" id="2348174">:=</span>&nbsp;<span class="op" id="2348177">(</span><span class="ident" id="2348178">approxExp10</span>&nbsp;<span class="op" id="2348190">-</span>&nbsp;<span class="ident" id="2348192">firstPowerOfTen</span><span class="op" id="2348207">)</span>&nbsp;<span class="op" id="2348209">/</span>&nbsp;<span class="ident" id="2348211">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2348226">Loop</span><span class="op" id="2348230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348233">for</span>&nbsp;<span class="op" id="2348237">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348241">exp</span>&nbsp;<span class="op" id="2348245">:=</span>&nbsp;<span class="ident" id="2348248">f</span><span class="op" id="2348249">.</span><span class="ident" id="2348250">exp</span>&nbsp;<span class="op" id="2348254">+</span>&nbsp;<span class="ident" id="2348256">powersOfTen</span><span class="op" id="2348267">[</span><span class="ident" id="2348268">i</span><span class="op" id="2348269">]</span><span class="op" id="2348270">.</span><span class="ident" id="2348271">exp</span>&nbsp;<span class="op" id="2348275">+</span>&nbsp;<span class="num" id="2348277">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348282">switch</span>&nbsp;<span class="op" id="2348289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348293">case</span>&nbsp;<span class="ident" id="2348298">exp</span>&nbsp;<span class="op" id="2348302">&lt;</span>&nbsp;<span class="ident" id="2348304">expMin</span><span class="op" id="2348310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348315">i</span><span class="op" id="2348316">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348321">case</span>&nbsp;<span class="ident" id="2348326">exp</span>&nbsp;<span class="op" id="2348330">&gt;</span>&nbsp;<span class="ident" id="2348332">expMax</span><span class="op" id="2348338">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348343">i</span><span class="op" id="2348344">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348349">default</span><span class="op" id="2348356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348361">break</span>&nbsp;<span class="ident" id="2348367">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2348374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2348377">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2348380">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2348444">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348507">f</span><span class="op" id="2348508">.</span><span class="ident" id="2348509">Multiply</span><span class="op" id="2348517">(</span><span class="ident" id="2348518">powersOfTen</span><span class="op" id="2348529">[</span><span class="ident" id="2348530">i</span><span class="op" id="2348531">]</span><span class="op" id="2348532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348536">return</span>&nbsp;<span class="op" id="2348543">-</span><span class="op" id="2348544">(</span><span class="ident" id="2348545">firstPowerOfTen</span>&nbsp;<span class="op" id="2348561">+</span>&nbsp;<span class="ident" id="2348563">i</span><span class="op" id="2348564">*</span><span class="ident" id="2348565">stepPowerOfTen</span><span class="op" id="2348579">)</span><span class="op" id="2348580">,</span>&nbsp;<span class="ident" id="2348582">i</span><br>
<span class="lineno">365</span><span class="op" id="2348584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2348587">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2348655">func</span>&nbsp;<span class="ident" id="2348660">frexp10Many</span><span class="op" id="2348671">(</span><span class="ident" id="2348672">a</span><span class="op" id="2348673">,</span>&nbsp;<span class="ident" id="2348675">b</span><span class="op" id="2348676">,</span>&nbsp;<span class="ident" id="2348678">c</span>&nbsp;<span class="op" id="2348680">*</span><span class="ident" id="2348681">extFloat</span><span class="op" id="2348689">)</span>&nbsp;<span class="op" id="2348691">(</span><span class="ident" id="2348692">exp10</span>&nbsp;<span class="builtintype" id="2348698">int</span><span class="op" id="2348701">)</span>&nbsp;<span class="op" id="2348703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348706">exp10</span><span class="op" id="2348711">,</span>&nbsp;<span class="ident" id="2348713">i</span>&nbsp;<span class="op" id="2348715">:=</span>&nbsp;<span class="ident" id="2348718">c</span><span class="op" id="2348719">.</span><span class="ident" id="2348720">frexp10</span><span class="op" id="2348727">(</span><span class="op" id="2348728">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348731">a</span><span class="op" id="2348732">.</span><span class="ident" id="2348733">Multiply</span><span class="op" id="2348741">(</span><span class="ident" id="2348742">powersOfTen</span><span class="op" id="2348753">[</span><span class="ident" id="2348754">i</span><span class="op" id="2348755">]</span><span class="op" id="2348756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348759">b</span><span class="op" id="2348760">.</span><span class="ident" id="2348761">Multiply</span><span class="op" id="2348769">(</span><span class="ident" id="2348770">powersOfTen</span><span class="op" id="2348781">[</span><span class="ident" id="2348782">i</span><span class="op" id="2348783">]</span><span class="op" id="2348784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348787">return</span><br>
<span class="lineno"></span><span class="op" id="2348794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2348797">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2348856">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2348912">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2348951">func</span>&nbsp;<span class="op" id="2348956">(</span><span class="ident" id="2348957">f</span>&nbsp;<span class="op" id="2348959">*</span><span class="ident" id="2348960">extFloat</span><span class="op" id="2348968">)</span>&nbsp;<span class="ident" id="2348970">FixedDecimal</span><span class="op" id="2348982">(</span><span class="ident" id="2348983">d</span>&nbsp;<span class="op" id="2348985">*</span><span class="ident" id="2348986">decimalSlice</span><span class="op" id="2348998">,</span>&nbsp;<span class="ident" id="2349000">n</span>&nbsp;<span class="builtintype" id="2349002">int</span><span class="op" id="2349005">)</span>&nbsp;<span class="builtintype" id="2349007">bool</span>&nbsp;<span class="op" id="2349012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349015">if</span>&nbsp;<span class="ident" id="2349018">f</span><span class="op" id="2349019">.</span><span class="ident" id="2349020">mant</span>&nbsp;<span class="op" id="2349025">==</span>&nbsp;<span class="num" id="2349028">0</span>&nbsp;<span class="op" id="2349030">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349034">d</span><span class="op" id="2349035">.</span><span class="ident" id="2349036">nd</span>&nbsp;<span class="op" id="2349039">=</span>&nbsp;<span class="num" id="2349041">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349045">d</span><span class="op" id="2349046">.</span><span class="ident" id="2349047">dp</span>&nbsp;<span class="op" id="2349050">=</span>&nbsp;<span class="num" id="2349052">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349056">d</span><span class="op" id="2349057">.</span><span class="ident" id="2349058">neg</span>&nbsp;<span class="op" id="2349062">=</span>&nbsp;<span class="ident" id="2349064">f</span><span class="op" id="2349065">.</span><span class="ident" id="2349066">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349072">return</span>&nbsp;<span class="builtintype" id="2349079">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2349085">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349088">if</span>&nbsp;<span class="ident" id="2349091">n</span>&nbsp;<span class="op" id="2349093">==</span>&nbsp;<span class="num" id="2349096">0</span>&nbsp;<span class="op" id="2349098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2349102">panic</span><span class="op" id="2349107">(</span><span class="string" id="2349108">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2349175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2349178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2349181">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2349246">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349269">f</span><span class="op" id="2349270">.</span><span class="ident" id="2349271">Normalize</span><span class="op" id="2349280">(</span><span class="op" id="2349281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349284">exp10</span><span class="op" id="2349289">,</span>&nbsp;<span class="ident" id="2349291">_</span>&nbsp;<span class="op" id="2349293">:=</span>&nbsp;<span class="ident" id="2349296">f</span><span class="op" id="2349297">.</span><span class="ident" id="2349298">frexp10</span><span class="op" id="2349305">(</span><span class="op" id="2349306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349310">shift</span>&nbsp;<span class="op" id="2349316">:=</span>&nbsp;<span class="builtintype" id="2349319">uint</span><span class="op" id="2349323">(</span><span class="op" id="2349324">-</span><span class="ident" id="2349325">f</span><span class="op" id="2349326">.</span><span class="ident" id="2349327">exp</span><span class="op" id="2349330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349333">integer</span>&nbsp;<span class="op" id="2349341">:=</span>&nbsp;<span class="builtintype" id="2349344">uint32</span><span class="op" id="2349350">(</span><span class="ident" id="2349351">f</span><span class="op" id="2349352">.</span><span class="ident" id="2349353">mant</span>&nbsp;<span class="op" id="2349358">&gt;&gt;</span>&nbsp;<span class="ident" id="2349361">shift</span><span class="op" id="2349366">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349369">fraction</span>&nbsp;<span class="op" id="2349378">:=</span>&nbsp;<span class="ident" id="2349381">f</span><span class="op" id="2349382">.</span><span class="ident" id="2349383">mant</span>&nbsp;<span class="op" id="2349388">-</span>&nbsp;<span class="op" id="2349390">(</span><span class="ident" id="2349391">uint64</span><span class="op" id="2349397">(</span><span class="ident" id="2349398">integer</span><span class="op" id="2349405">)</span>&nbsp;<span class="op" id="2349407">&lt;&lt;</span>&nbsp;<span class="ident" id="2349410">shift</span><span class="op" id="2349415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349418"></span>&nbsp;<span class="op" id="2349421">:=</span>&nbsp;<span class="ident" id="2349424">uint64</span><span class="op" id="2349430">(</span><span class="num" id="2349431">1</span><span class="op" id="2349432">)</span>&nbsp;<span class="comment" id="2349434">//&nbsp;&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2349491">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349524">needed</span>&nbsp;<span class="op" id="2349531">:=</span>&nbsp;<span class="ident" id="2349534">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2349543">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349582">integerDigits</span>&nbsp;<span class="op" id="2349596">:=</span>&nbsp;<span class="num" id="2349599">0</span>&nbsp;<span class="comment" id="2349601">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349646">pow10</span>&nbsp;<span class="op" id="2349652">:=</span>&nbsp;<span class="ident" id="2349655">uint64</span><span class="op" id="2349661">(</span><span class="num" id="2349662">1</span><span class="op" id="2349663">)</span>&nbsp;<span class="comment" id="2349665">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349709">for</span>&nbsp;<span class="ident" id="2349713">i</span><span class="op" id="2349714">,</span>&nbsp;<span class="ident" id="2349716">pow</span>&nbsp;<span class="op" id="2349720">:=</span>&nbsp;<span class="num" id="2349723">0</span><span class="op" id="2349724">,</span>&nbsp;<span class="ident" id="2349726">uint64</span><span class="op" id="2349732">(</span><span class="num" id="2349733">1</span><span class="op" id="2349734">)</span><span class="op" id="2349735">;</span>&nbsp;<span class="ident" id="2349737">i</span>&nbsp;<span class="op" id="2349739">&lt;</span>&nbsp;<span class="num" id="2349741">20</span><span class="op" id="2349743">;</span>&nbsp;<span class="ident" id="2349745">i</span><span class="op" id="2349746">++</span>&nbsp;<span class="op" id="2349749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349753">if</span>&nbsp;<span class="ident" id="2349756">pow</span>&nbsp;<span class="op" id="2349760">&gt;</span>&nbsp;<span class="ident" id="2349762">uint64</span><span class="op" id="2349768">(</span><span class="ident" id="2349769">integer</span><span class="op" id="2349776">)</span>&nbsp;<span class="op" id="2349778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349783">integerDigits</span>&nbsp;<span class="op" id="2349797">=</span>&nbsp;<span class="ident" id="2349799">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349804">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2349812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349816">pow</span>&nbsp;<span class="op" id="2349820">*=</span>&nbsp;<span class="num" id="2349823">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2349827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349830">rest</span>&nbsp;<span class="op" id="2349835">:=</span>&nbsp;<span class="ident" id="2349838">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2349847">if</span>&nbsp;<span class="ident" id="2349850">integerDigits</span>&nbsp;<span class="op" id="2349864">&gt;</span>&nbsp;<span class="ident" id="2349866">needed</span>&nbsp;<span class="op" id="2349873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2349877">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349940">pow10</span>&nbsp;<span class="op" id="2349946">=</span>&nbsp;<span class="ident" id="2349948">uint64pow10</span><span class="op" id="2349959">[</span><span class="ident" id="2349960">integerDigits</span><span class="op" id="2349973">-</span><span class="ident" id="2349974">needed</span><span class="op" id="2349980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2349984">integer</span>&nbsp;<span class="op" id="2349992">/=</span>&nbsp;<span class="builtintype" id="2349995">uint32</span><span class="op" id="2350001">(</span><span class="ident" id="2350002">pow10</span><span class="op" id="2350007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350011">rest</span>&nbsp;<span class="op" id="2350016">-=</span>&nbsp;<span class="ident" id="2350019">integer</span>&nbsp;<span class="op" id="2350027">*</span>&nbsp;<span class="builtintype" id="2350029">uint32</span><span class="op" id="2350035">(</span><span class="ident" id="2350036">pow10</span><span class="op" id="2350041">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350044">}</span>&nbsp;<span class="keyword" id="2350046">else</span>&nbsp;<span class="op" id="2350051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350055">rest</span>&nbsp;<span class="op" id="2350060">=</span>&nbsp;<span class="num" id="2350062">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2350069">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350134">var</span>&nbsp;<span class="ident" id="2350138">buf</span>&nbsp;<span class="op" id="2350142">[</span><span class="num" id="2350143">32</span><span class="op" id="2350145">]</span><span class="builtintype" id="2350146">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350152">pos</span>&nbsp;<span class="op" id="2350156">:=</span>&nbsp;<span class="builtinfunc" id="2350159">len</span><span class="op" id="2350162">(</span><span class="ident" id="2350163">buf</span><span class="op" id="2350166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350169">for</span>&nbsp;<span class="ident" id="2350173">v</span>&nbsp;<span class="op" id="2350175">:=</span>&nbsp;<span class="ident" id="2350178">integer</span><span class="op" id="2350185">;</span>&nbsp;<span class="ident" id="2350187">v</span>&nbsp;<span class="op" id="2350189">&gt;</span>&nbsp;<span class="num" id="2350191">0</span><span class="op" id="2350192">;</span>&nbsp;<span class="op" id="2350194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350198">v1</span>&nbsp;<span class="op" id="2350201">:=</span>&nbsp;<span class="ident" id="2350204">v</span>&nbsp;<span class="op" id="2350206">/</span>&nbsp;<span class="num" id="2350208">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350213">v</span>&nbsp;<span class="op" id="2350215">-=</span>&nbsp;<span class="num" id="2350218">10</span>&nbsp;<span class="op" id="2350221">*</span>&nbsp;<span class="ident" id="2350223">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350228">pos</span><span class="op" id="2350231">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350236">buf</span><span class="op" id="2350239">[</span><span class="ident" id="2350240">pos</span><span class="op" id="2350243">]</span>&nbsp;<span class="op" id="2350245">=</span>&nbsp;<span class="builtintype" id="2350247">byte</span><span class="op" id="2350251">(</span><span class="ident" id="2350252">v</span>&nbsp;<span class="op" id="2350254">+</span>&nbsp;<span class="string" id="2350256">&#39;0&#39;</span><span class="op" id="2350259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350263">v</span>&nbsp;<span class="op" id="2350265">=</span>&nbsp;<span class="ident" id="2350267">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350274">for</span>&nbsp;<span class="ident" id="2350278">i</span>&nbsp;<span class="op" id="2350280">:=</span>&nbsp;<span class="ident" id="2350283">pos</span><span class="op" id="2350286">;</span>&nbsp;<span class="ident" id="2350288">i</span>&nbsp;<span class="op" id="2350290">&lt;</span>&nbsp;<span class="builtinfunc" id="2350292">len</span><span class="op" id="2350295">(</span><span class="ident" id="2350296">buf</span><span class="op" id="2350299">)</span><span class="op" id="2350300">;</span>&nbsp;<span class="ident" id="2350302">i</span><span class="op" id="2350303">++</span>&nbsp;<span class="op" id="2350306">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350310">d</span><span class="op" id="2350311">.</span><span class="ident" id="2350312">d</span><span class="op" id="2350313">[</span><span class="ident" id="2350314">i</span><span class="op" id="2350315">-</span><span class="ident" id="2350316">pos</span><span class="op" id="2350319">]</span>&nbsp;<span class="op" id="2350321">=</span>&nbsp;<span class="ident" id="2350323">buf</span><span class="op" id="2350326">[</span><span class="ident" id="2350327">i</span><span class="op" id="2350328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350334">nd</span>&nbsp;<span class="op" id="2350337">:=</span>&nbsp;<span class="builtinfunc" id="2350340">len</span><span class="op" id="2350343">(</span><span class="ident" id="2350344">buf</span><span class="op" id="2350347">)</span>&nbsp;<span class="op" id="2350349">-</span>&nbsp;<span class="ident" id="2350351">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350356">d</span><span class="op" id="2350357">.</span><span class="ident" id="2350358">nd</span>&nbsp;<span class="op" id="2350361">=</span>&nbsp;<span class="ident" id="2350363">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350367">d</span><span class="op" id="2350368">.</span><span class="ident" id="2350369">dp</span>&nbsp;<span class="op" id="2350372">=</span>&nbsp;<span class="ident" id="2350374">integerDigits</span>&nbsp;<span class="op" id="2350388">+</span>&nbsp;<span class="ident" id="2350390">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350397">needed</span>&nbsp;<span class="op" id="2350404">-=</span>&nbsp;<span class="ident" id="2350407">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350412">if</span>&nbsp;<span class="ident" id="2350415">needed</span>&nbsp;<span class="op" id="2350422">&gt;</span>&nbsp;<span class="num" id="2350424">0</span>&nbsp;<span class="op" id="2350426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350430">if</span>&nbsp;<span class="ident" id="2350433">rest</span>&nbsp;<span class="op" id="2350438">!=</span>&nbsp;<span class="num" id="2350441">0</span>&nbsp;<span class="op" id="2350443">||</span>&nbsp;<span class="ident" id="2350446">pow10</span>&nbsp;<span class="op" id="2350452">!=</span>&nbsp;<span class="num" id="2350455">1</span>&nbsp;<span class="op" id="2350457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2350462">panic</span><span class="op" id="2350467">(</span><span class="string" id="2350468">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2350519">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2350527">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2350592">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350632">for</span>&nbsp;<span class="ident" id="2350636">needed</span>&nbsp;<span class="op" id="2350643">&gt;</span>&nbsp;<span class="num" id="2350645">0</span>&nbsp;<span class="op" id="2350647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350652">fraction</span>&nbsp;<span class="op" id="2350661">*=</span>&nbsp;<span class="num" id="2350664">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350670"></span>&nbsp;<span class="op" id="2350673">*=</span>&nbsp;<span class="num" id="2350676">10</span>&nbsp;<span class="comment" id="2350679">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350731">if</span>&nbsp;<span class="num" id="2350734">2</span><span class="op" id="2350735">*</span><span class="ident" id="2350736"></span>&nbsp;<span class="op" id="2350739">&gt;</span>&nbsp;<span class="num" id="2350741">1</span><span class="op" id="2350742">&lt;&lt;</span><span class="ident" id="2350744">shift</span>&nbsp;<span class="op" id="2350750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2350756">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350830">return</span>&nbsp;<span class="builtintype" id="2350837">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350846">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350851">digit</span>&nbsp;<span class="op" id="2350857">:=</span>&nbsp;<span class="ident" id="2350860">fraction</span>&nbsp;<span class="op" id="2350869">&gt;&gt;</span>&nbsp;<span class="ident" id="2350872">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350881">d</span><span class="op" id="2350882">.</span><span class="ident" id="2350883">d</span><span class="op" id="2350884">[</span><span class="ident" id="2350885">nd</span><span class="op" id="2350887">]</span>&nbsp;<span class="op" id="2350889">=</span>&nbsp;<span class="builtintype" id="2350891">byte</span><span class="op" id="2350895">(</span><span class="ident" id="2350896">digit</span>&nbsp;<span class="op" id="2350902">+</span>&nbsp;<span class="string" id="2350904">&#39;0&#39;</span><span class="op" id="2350907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350912">fraction</span>&nbsp;<span class="op" id="2350921">-=</span>&nbsp;<span class="ident" id="2350924">digit</span>&nbsp;<span class="op" id="2350930">&lt;&lt;</span>&nbsp;<span class="ident" id="2350933">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350942">nd</span><span class="op" id="2350944">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350950">needed</span><span class="op" id="2350956">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350965">d</span><span class="op" id="2350966">.</span><span class="ident" id="2350967">nd</span>&nbsp;<span class="op" id="2350970">=</span>&nbsp;<span class="ident" id="2350972">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2350976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2350980">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351062">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351146">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351161">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351165">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351197">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351248">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351301">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351387">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351391">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351437">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351468">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351521">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351525">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351595">ok</span>&nbsp;<span class="op" id="2351598">:=</span>&nbsp;<span class="ident" id="2351601">adjustLastDigitFixed</span><span class="op" id="2351621">(</span><span class="ident" id="2351622">d</span><span class="op" id="2351623">,</span>&nbsp;<span class="ident" id="2351625">uint64</span><span class="op" id="2351631">(</span><span class="ident" id="2351632">rest</span><span class="op" id="2351636">)</span><span class="op" id="2351637">&lt;&lt;</span><span class="ident" id="2351639">shift</span><span class="op" id="2351644">|</span><span class="ident" id="2351645">fraction</span><span class="op" id="2351653">,</span>&nbsp;<span class="ident" id="2351655">pow10</span><span class="op" id="2351660">,</span>&nbsp;<span class="ident" id="2351662">shift</span><span class="op" id="2351667">,</span>&nbsp;<span class="ident" id="2351669"></span><span class="op" id="2351671">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351674">if</span>&nbsp;<span class="op" id="2351677">!</span><span class="ident" id="2351678">ok</span>&nbsp;<span class="op" id="2351681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351685">return</span>&nbsp;<span class="builtintype" id="2351692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351702">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351727">for</span>&nbsp;<span class="ident" id="2351731">i</span>&nbsp;<span class="op" id="2351733">:=</span>&nbsp;<span class="ident" id="2351736">d</span><span class="op" id="2351737">.</span><span class="ident" id="2351738">nd</span>&nbsp;<span class="op" id="2351741">-</span>&nbsp;<span class="num" id="2351743">1</span><span class="op" id="2351744">;</span>&nbsp;<span class="ident" id="2351746">i</span>&nbsp;<span class="op" id="2351748">&gt;=</span>&nbsp;<span class="num" id="2351751">0</span><span class="op" id="2351752">;</span>&nbsp;<span class="ident" id="2351754">i</span><span class="op" id="2351755">--</span>&nbsp;<span class="op" id="2351758">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351762">if</span>&nbsp;<span class="ident" id="2351765">d</span><span class="op" id="2351766">.</span><span class="ident" id="2351767">d</span><span class="op" id="2351768">[</span><span class="ident" id="2351769">i</span><span class="op" id="2351770">]</span>&nbsp;<span class="op" id="2351772">!=</span>&nbsp;<span class="string" id="2351775">&#39;0&#39;</span>&nbsp;<span class="op" id="2351779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351784">d</span><span class="op" id="2351785">.</span><span class="ident" id="2351786">nd</span>&nbsp;<span class="op" id="2351789">=</span>&nbsp;<span class="ident" id="2351791">i</span>&nbsp;<span class="op" id="2351793">+</span>&nbsp;<span class="num" id="2351795">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351800">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351811">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351814">return</span>&nbsp;<span class="builtintype" id="2351821">true</span><br>
<span class="lineno"></span><span class="op" id="2351826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2351829">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2351912">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2351992">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2352070">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2352091">//</span><br>
<span class="lineno"></span><span class="comment" id="2352094">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2352179">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2352264">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2352304">func</span>&nbsp;<span class="ident" id="2352309">adjustLastDigitFixed</span><span class="op" id="2352329">(</span><span class="ident" id="2352330">d</span>&nbsp;<span class="op" id="2352332">*</span><span class="ident" id="2352333">decimalSlice</span><span class="op" id="2352345">,</span>&nbsp;<span class="ident" id="2352347">num</span><span class="op" id="2352350">,</span>&nbsp;<span class="ident" id="2352352">den</span>&nbsp;<span class="ident" id="2352356">uint64</span><span class="op" id="2352362">,</span>&nbsp;<span class="ident" id="2352364">shift</span>&nbsp;<span class="builtintype" id="2352370">uint</span><span class="op" id="2352374">,</span>&nbsp;<span class="ident" id="2352376"></span>&nbsp;<span class="ident" id="2352379">uint64</span><span class="op" id="2352385">)</span>&nbsp;<span class="builtintype" id="2352387">bool</span>&nbsp;<span class="op" id="2352392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352395">if</span>&nbsp;<span class="ident" id="2352398">num</span>&nbsp;<span class="op" id="2352402">&gt;</span>&nbsp;<span class="ident" id="2352404">den</span><span class="op" id="2352407">&lt;&lt;</span><span class="ident" id="2352409">shift</span>&nbsp;<span class="op" id="2352415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2352419">panic</span><span class="op" id="2352424">(</span><span class="string" id="2352425">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2352476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352479">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352482">if</span>&nbsp;<span class="num" id="2352485">2</span><span class="op" id="2352486">*</span><span class="ident" id="2352487"></span>&nbsp;<span class="op" id="2352490">&gt;</span>&nbsp;<span class="ident" id="2352492">den</span><span class="op" id="2352495">&lt;&lt;</span><span class="ident" id="2352497">shift</span>&nbsp;<span class="op" id="2352503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2352507">panic</span><span class="op" id="2352512">(</span><span class="string" id="2352513">&#34;strconv:&nbsp;&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2352543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352549">if</span>&nbsp;<span class="num" id="2352552">2</span><span class="op" id="2352553">*</span><span class="op" id="2352554">(</span><span class="ident" id="2352555">num</span><span class="op" id="2352558">+</span><span class="ident" id="2352559"></span><span class="op" id="2352561">)</span>&nbsp;<span class="op" id="2352563">&lt;</span>&nbsp;<span class="ident" id="2352565">den</span><span class="op" id="2352568">&lt;&lt;</span><span class="ident" id="2352570">shift</span>&nbsp;<span class="op" id="2352576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352580">return</span>&nbsp;<span class="builtintype" id="2352587">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352596">if</span>&nbsp;<span class="num" id="2352599">2</span><span class="op" id="2352600">*</span><span class="op" id="2352601">(</span><span class="ident" id="2352602">num</span><span class="op" id="2352605">-</span><span class="ident" id="2352606"></span><span class="op" id="2352608">)</span>&nbsp;<span class="op" id="2352610">&gt;</span>&nbsp;<span class="ident" id="2352612">den</span><span class="op" id="2352615">&lt;&lt;</span><span class="ident" id="2352617">shift</span>&nbsp;<span class="op" id="2352623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2352627">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352650">i</span>&nbsp;<span class="op" id="2352652">:=</span>&nbsp;<span class="ident" id="2352655">d</span><span class="op" id="2352656">.</span><span class="ident" id="2352657">nd</span>&nbsp;<span class="op" id="2352660">-</span>&nbsp;<span class="num" id="2352662">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352666">for</span>&nbsp;<span class="op" id="2352670">;</span>&nbsp;<span class="ident" id="2352672">i</span>&nbsp;<span class="op" id="2352674">&gt;=</span>&nbsp;<span class="num" id="2352677">0</span><span class="op" id="2352678">;</span>&nbsp;<span class="ident" id="2352680">i</span><span class="op" id="2352681">--</span>&nbsp;<span class="op" id="2352684">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352689">if</span>&nbsp;<span class="ident" id="2352692">d</span><span class="op" id="2352693">.</span><span class="ident" id="2352694">d</span><span class="op" id="2352695">[</span><span class="ident" id="2352696">i</span><span class="op" id="2352697">]</span>&nbsp;<span class="op" id="2352699">==</span>&nbsp;<span class="string" id="2352702">&#39;9&#39;</span>&nbsp;<span class="op" id="2352706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352712">d</span><span class="op" id="2352713">.</span><span class="ident" id="2352714">nd</span><span class="op" id="2352716">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352722">}</span>&nbsp;<span class="keyword" id="2352724">else</span>&nbsp;<span class="op" id="2352729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352735">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352744">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352752">if</span>&nbsp;<span class="ident" id="2352755">i</span>&nbsp;<span class="op" id="2352757">&lt;</span>&nbsp;<span class="num" id="2352759">0</span>&nbsp;<span class="op" id="2352761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352766">d</span><span class="op" id="2352767">.</span><span class="ident" id="2352768">d</span><span class="op" id="2352769">[</span><span class="num" id="2352770">0</span><span class="op" id="2352771">]</span>&nbsp;<span class="op" id="2352773">=</span>&nbsp;<span class="string" id="2352775">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352782">d</span><span class="op" id="2352783">.</span><span class="ident" id="2352784">nd</span>&nbsp;<span class="op" id="2352787">=</span>&nbsp;<span class="num" id="2352789">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352794">d</span><span class="op" id="2352795">.</span><span class="ident" id="2352796">dp</span><span class="op" id="2352798">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352803">}</span>&nbsp;<span class="keyword" id="2352805">else</span>&nbsp;<span class="op" id="2352810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2352815">d</span><span class="op" id="2352816">.</span><span class="ident" id="2352817">d</span><span class="op" id="2352818">[</span><span class="ident" id="2352819">i</span><span class="op" id="2352820">]</span><span class="op" id="2352821">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352830">return</span>&nbsp;<span class="builtintype" id="2352837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2352843">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2352846">return</span>&nbsp;<span class="builtintype" id="2352853">false</span><br>
<span class="lineno"></span><span class="op" id="2352859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2352862">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2352934">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2353008">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2353086">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2353116">func</span>&nbsp;<span class="op" id="2353121">(</span><span class="ident" id="2353122">f</span>&nbsp;<span class="op" id="2353124">*</span><span class="ident" id="2353125">extFloat</span><span class="op" id="2353133">)</span>&nbsp;<span class="ident" id="2353135">ShortestDecimal</span><span class="op" id="2353150">(</span><span class="ident" id="2353151">d</span>&nbsp;<span class="op" id="2353153">*</span><span class="ident" id="2353154">decimalSlice</span><span class="op" id="2353166">,</span>&nbsp;<span class="ident" id="2353168">lower</span><span class="op" id="2353173">,</span>&nbsp;<span class="ident" id="2353175">upper</span>&nbsp;<span class="op" id="2353181">*</span><span class="ident" id="2353182">extFloat</span><span class="op" id="2353190">)</span>&nbsp;<span class="builtintype" id="2353192">bool</span>&nbsp;<span class="op" id="2353197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353200">if</span>&nbsp;<span class="ident" id="2353203">f</span><span class="op" id="2353204">.</span><span class="ident" id="2353205">mant</span>&nbsp;<span class="op" id="2353210">==</span>&nbsp;<span class="num" id="2353213">0</span>&nbsp;<span class="op" id="2353215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353219">d</span><span class="op" id="2353220">.</span><span class="ident" id="2353221">nd</span>&nbsp;<span class="op" id="2353224">=</span>&nbsp;<span class="num" id="2353226">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353230">d</span><span class="op" id="2353231">.</span><span class="ident" id="2353232">dp</span>&nbsp;<span class="op" id="2353235">=</span>&nbsp;<span class="num" id="2353237">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353241">d</span><span class="op" id="2353242">.</span><span class="ident" id="2353243">neg</span>&nbsp;<span class="op" id="2353247">=</span>&nbsp;<span class="ident" id="2353249">f</span><span class="op" id="2353250">.</span><span class="ident" id="2353251">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353257">return</span>&nbsp;<span class="builtintype" id="2353264">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353273">if</span>&nbsp;<span class="ident" id="2353276">f</span><span class="op" id="2353277">.</span><span class="ident" id="2353278">exp</span>&nbsp;<span class="op" id="2353282">==</span>&nbsp;<span class="num" id="2353285">0</span>&nbsp;<span class="op" id="2353287">&amp;&amp;</span>&nbsp;<span class="op" id="2353290">*</span><span class="ident" id="2353291">lower</span>&nbsp;<span class="op" id="2353297">==</span>&nbsp;<span class="op" id="2353300">*</span><span class="ident" id="2353301">f</span>&nbsp;<span class="op" id="2353303">&amp;&amp;</span>&nbsp;<span class="op" id="2353306">*</span><span class="ident" id="2353307">lower</span>&nbsp;<span class="op" id="2353313">==</span>&nbsp;<span class="op" id="2353316">*</span><span class="ident" id="2353317">upper</span>&nbsp;<span class="op" id="2353323">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2353327">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353350">var</span>&nbsp;<span class="ident" id="2353354">buf</span>&nbsp;<span class="op" id="2353358">[</span><span class="num" id="2353359">24</span><span class="op" id="2353361">]</span><span class="builtintype" id="2353362">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353369">n</span>&nbsp;<span class="op" id="2353371">:=</span>&nbsp;<span class="builtinfunc" id="2353374">len</span><span class="op" id="2353377">(</span><span class="ident" id="2353378">buf</span><span class="op" id="2353381">)</span>&nbsp;<span class="op" id="2353383">-</span>&nbsp;<span class="num" id="2353385">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353389">for</span>&nbsp;<span class="ident" id="2353393">v</span>&nbsp;<span class="op" id="2353395">:=</span>&nbsp;<span class="ident" id="2353398">f</span><span class="op" id="2353399">.</span><span class="ident" id="2353400">mant</span><span class="op" id="2353404">;</span>&nbsp;<span class="ident" id="2353406">v</span>&nbsp;<span class="op" id="2353408">&gt;</span>&nbsp;<span class="num" id="2353410">0</span><span class="op" id="2353411">;</span>&nbsp;<span class="op" id="2353413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353418">v1</span>&nbsp;<span class="op" id="2353421">:=</span>&nbsp;<span class="ident" id="2353424">v</span>&nbsp;<span class="op" id="2353426">/</span>&nbsp;<span class="num" id="2353428">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353434">v</span>&nbsp;<span class="op" id="2353436">-=</span>&nbsp;<span class="num" id="2353439">10</span>&nbsp;<span class="op" id="2353442">*</span>&nbsp;<span class="ident" id="2353444">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353450">buf</span><span class="op" id="2353453">[</span><span class="ident" id="2353454">n</span><span class="op" id="2353455">]</span>&nbsp;<span class="op" id="2353457">=</span>&nbsp;<span class="builtintype" id="2353459">byte</span><span class="op" id="2353463">(</span><span class="ident" id="2353464">v</span>&nbsp;<span class="op" id="2353466">+</span>&nbsp;<span class="string" id="2353468">&#39;0&#39;</span><span class="op" id="2353471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353476">n</span><span class="op" id="2353477">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353483">v</span>&nbsp;<span class="op" id="2353485">=</span>&nbsp;<span class="ident" id="2353487">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353492">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353496">nd</span>&nbsp;<span class="op" id="2353499">:=</span>&nbsp;<span class="builtinfunc" id="2353502">len</span><span class="op" id="2353505">(</span><span class="ident" id="2353506">buf</span><span class="op" id="2353509">)</span>&nbsp;<span class="op" id="2353511">-</span>&nbsp;<span class="ident" id="2353513">n</span>&nbsp;<span class="op" id="2353515">-</span>&nbsp;<span class="num" id="2353517">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353521">for</span>&nbsp;<span class="ident" id="2353525">i</span>&nbsp;<span class="op" id="2353527">:=</span>&nbsp;<span class="num" id="2353530">0</span><span class="op" id="2353531">;</span>&nbsp;<span class="ident" id="2353533">i</span>&nbsp;<span class="op" id="2353535">&lt;</span>&nbsp;<span class="ident" id="2353537">nd</span><span class="op" id="2353539">;</span>&nbsp;<span class="ident" id="2353541">i</span><span class="op" id="2353542">++</span>&nbsp;<span class="op" id="2353545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353550">d</span><span class="op" id="2353551">.</span><span class="ident" id="2353552">d</span><span class="op" id="2353553">[</span><span class="ident" id="2353554">i</span><span class="op" id="2353555">]</span>&nbsp;<span class="op" id="2353557">=</span>&nbsp;<span class="ident" id="2353559">buf</span><span class="op" id="2353562">[</span><span class="ident" id="2353563">n</span><span class="op" id="2353564">+</span><span class="num" id="2353565">1</span><span class="op" id="2353566">+</span><span class="ident" id="2353567">i</span><span class="op" id="2353568">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353576">d</span><span class="op" id="2353577">.</span><span class="ident" id="2353578">nd</span><span class="op" id="2353580">,</span>&nbsp;<span class="ident" id="2353582">d</span><span class="op" id="2353583">.</span><span class="ident" id="2353584">dp</span>&nbsp;<span class="op" id="2353587">=</span>&nbsp;<span class="ident" id="2353589">nd</span><span class="op" id="2353591">,</span>&nbsp;<span class="ident" id="2353593">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353598">for</span>&nbsp;<span class="ident" id="2353602">d</span><span class="op" id="2353603">.</span><span class="ident" id="2353604">nd</span>&nbsp;<span class="op" id="2353607">&gt;</span>&nbsp;<span class="num" id="2353609">0</span>&nbsp;<span class="op" id="2353611">&amp;&amp;</span>&nbsp;<span class="ident" id="2353614">d</span><span class="op" id="2353615">.</span><span class="ident" id="2353616">d</span><span class="op" id="2353617">[</span><span class="ident" id="2353618">d</span><span class="op" id="2353619">.</span><span class="ident" id="2353620">nd</span><span class="op" id="2353622">-</span><span class="num" id="2353623">1</span><span class="op" id="2353624">]</span>&nbsp;<span class="op" id="2353626">==</span>&nbsp;<span class="string" id="2353629">&#39;0&#39;</span>&nbsp;<span class="op" id="2353633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353638">d</span><span class="op" id="2353639">.</span><span class="ident" id="2353640">nd</span><span class="op" id="2353642">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353651">if</span>&nbsp;<span class="ident" id="2353654">d</span><span class="op" id="2353655">.</span><span class="ident" id="2353656">nd</span>&nbsp;<span class="op" id="2353659">==</span>&nbsp;<span class="num" id="2353662">0</span>&nbsp;<span class="op" id="2353664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353669">d</span><span class="op" id="2353670">.</span><span class="ident" id="2353671">dp</span>&nbsp;<span class="op" id="2353674">=</span>&nbsp;<span class="num" id="2353676">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353684">d</span><span class="op" id="2353685">.</span><span class="ident" id="2353686">neg</span>&nbsp;<span class="op" id="2353690">=</span>&nbsp;<span class="ident" id="2353692">f</span><span class="op" id="2353693">.</span><span class="ident" id="2353694">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353700">return</span>&nbsp;<span class="builtintype" id="2353707">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353716">upper</span><span class="op" id="2353721">.</span><span class="ident" id="2353722">Normalize</span><span class="op" id="2353731">(</span><span class="op" id="2353732">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2353735">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353761">if</span>&nbsp;<span class="ident" id="2353764">f</span><span class="op" id="2353765">.</span><span class="ident" id="2353766">exp</span>&nbsp;<span class="op" id="2353770">&gt;</span>&nbsp;<span class="ident" id="2353772">upper</span><span class="op" id="2353777">.</span><span class="ident" id="2353778">exp</span>&nbsp;<span class="op" id="2353782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353786">f</span><span class="op" id="2353787">.</span><span class="ident" id="2353788">mant</span>&nbsp;<span class="op" id="2353793">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2353797">uint</span><span class="op" id="2353801">(</span><span class="ident" id="2353802">f</span><span class="op" id="2353803">.</span><span class="ident" id="2353804">exp</span>&nbsp;<span class="op" id="2353808">-</span>&nbsp;<span class="ident" id="2353810">upper</span><span class="op" id="2353815">.</span><span class="ident" id="2353816">exp</span><span class="op" id="2353819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353823">f</span><span class="op" id="2353824">.</span><span class="ident" id="2353825">exp</span>&nbsp;<span class="op" id="2353829">=</span>&nbsp;<span class="ident" id="2353831">upper</span><span class="op" id="2353836">.</span><span class="ident" id="2353837">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353842">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2353845">if</span>&nbsp;<span class="ident" id="2353848">lower</span><span class="op" id="2353853">.</span><span class="ident" id="2353854">exp</span>&nbsp;<span class="op" id="2353858">&gt;</span>&nbsp;<span class="ident" id="2353860">upper</span><span class="op" id="2353865">.</span><span class="ident" id="2353866">exp</span>&nbsp;<span class="op" id="2353870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353874">lower</span><span class="op" id="2353879">.</span><span class="ident" id="2353880">mant</span>&nbsp;<span class="op" id="2353885">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2353889">uint</span><span class="op" id="2353893">(</span><span class="ident" id="2353894">lower</span><span class="op" id="2353899">.</span><span class="ident" id="2353900">exp</span>&nbsp;<span class="op" id="2353904">-</span>&nbsp;<span class="ident" id="2353906">upper</span><span class="op" id="2353911">.</span><span class="ident" id="2353912">exp</span><span class="op" id="2353915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353919">lower</span><span class="op" id="2353924">.</span><span class="ident" id="2353925">exp</span>&nbsp;<span class="op" id="2353929">=</span>&nbsp;<span class="ident" id="2353931">upper</span><span class="op" id="2353936">.</span><span class="ident" id="2353937">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2353942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353946">exp10</span>&nbsp;<span class="op" id="2353952">:=</span>&nbsp;<span class="ident" id="2353955">frexp10Many</span><span class="op" id="2353966">(</span><span class="ident" id="2353967">lower</span><span class="op" id="2353972">,</span>&nbsp;<span class="ident" id="2353974">f</span><span class="op" id="2353975">,</span>&nbsp;<span class="ident" id="2353977">upper</span><span class="op" id="2353982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2353985">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354065">upper</span><span class="op" id="2354070">.</span><span class="ident" id="2354071">mant</span><span class="op" id="2354075">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354079">lower</span><span class="op" id="2354084">.</span><span class="ident" id="2354085">mant</span><span class="op" id="2354089">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354094">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354165">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354211">shift</span>&nbsp;<span class="op" id="2354217">:=</span>&nbsp;<span class="builtintype" id="2354220">uint</span><span class="op" id="2354224">(</span><span class="op" id="2354225">-</span><span class="ident" id="2354226">upper</span><span class="op" id="2354231">.</span><span class="ident" id="2354232">exp</span><span class="op" id="2354235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354238">integer</span>&nbsp;<span class="op" id="2354246">:=</span>&nbsp;<span class="builtintype" id="2354249">uint32</span><span class="op" id="2354255">(</span><span class="ident" id="2354256">upper</span><span class="op" id="2354261">.</span><span class="ident" id="2354262">mant</span>&nbsp;<span class="op" id="2354267">&gt;&gt;</span>&nbsp;<span class="ident" id="2354270">shift</span><span class="op" id="2354275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354278">fraction</span>&nbsp;<span class="op" id="2354287">:=</span>&nbsp;<span class="ident" id="2354290">upper</span><span class="op" id="2354295">.</span><span class="ident" id="2354296">mant</span>&nbsp;<span class="op" id="2354301">-</span>&nbsp;<span class="op" id="2354303">(</span><span class="ident" id="2354304">uint64</span><span class="op" id="2354310">(</span><span class="ident" id="2354311">integer</span><span class="op" id="2354318">)</span>&nbsp;<span class="op" id="2354320">&lt;&lt;</span>&nbsp;<span class="ident" id="2354323">shift</span><span class="op" id="2354328">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354332">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354397">allowance</span>&nbsp;<span class="op" id="2354407">:=</span>&nbsp;<span class="ident" id="2354410">upper</span><span class="op" id="2354415">.</span><span class="ident" id="2354416">mant</span>&nbsp;<span class="op" id="2354421">-</span>&nbsp;<span class="ident" id="2354423">lower</span><span class="op" id="2354428">.</span><span class="ident" id="2354429">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354435">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354490">targetDiff</span>&nbsp;<span class="op" id="2354501">:=</span>&nbsp;<span class="ident" id="2354504">upper</span><span class="op" id="2354509">.</span><span class="ident" id="2354510">mant</span>&nbsp;<span class="op" id="2354515">-</span>&nbsp;<span class="ident" id="2354517">f</span><span class="op" id="2354518">.</span><span class="ident" id="2354519">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354526">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354575">var</span>&nbsp;<span class="ident" id="2354579">integerDigits</span>&nbsp;<span class="builtintype" id="2354593">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354598">for</span>&nbsp;<span class="ident" id="2354602">i</span><span class="op" id="2354603">,</span>&nbsp;<span class="ident" id="2354605">pow</span>&nbsp;<span class="op" id="2354609">:=</span>&nbsp;<span class="num" id="2354612">0</span><span class="op" id="2354613">,</span>&nbsp;<span class="ident" id="2354615">uint64</span><span class="op" id="2354621">(</span><span class="num" id="2354622">1</span><span class="op" id="2354623">)</span><span class="op" id="2354624">;</span>&nbsp;<span class="ident" id="2354626">i</span>&nbsp;<span class="op" id="2354628">&lt;</span>&nbsp;<span class="num" id="2354630">20</span><span class="op" id="2354632">;</span>&nbsp;<span class="ident" id="2354634">i</span><span class="op" id="2354635">++</span>&nbsp;<span class="op" id="2354638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354642">if</span>&nbsp;<span class="ident" id="2354645">pow</span>&nbsp;<span class="op" id="2354649">&gt;</span>&nbsp;<span class="ident" id="2354651">uint64</span><span class="op" id="2354657">(</span><span class="ident" id="2354658">integer</span><span class="op" id="2354665">)</span>&nbsp;<span class="op" id="2354667">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354672">integerDigits</span>&nbsp;<span class="op" id="2354686">=</span>&nbsp;<span class="ident" id="2354688">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354693">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2354701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354705">pow</span>&nbsp;<span class="op" id="2354709">*=</span>&nbsp;<span class="num" id="2354712">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2354716">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354719">for</span>&nbsp;<span class="ident" id="2354723">i</span>&nbsp;<span class="op" id="2354725">:=</span>&nbsp;<span class="num" id="2354728">0</span><span class="op" id="2354729">;</span>&nbsp;<span class="ident" id="2354731">i</span>&nbsp;<span class="op" id="2354733">&lt;</span>&nbsp;<span class="ident" id="2354735">integerDigits</span><span class="op" id="2354748">;</span>&nbsp;<span class="ident" id="2354750">i</span><span class="op" id="2354751">++</span>&nbsp;<span class="op" id="2354754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354758">pow</span>&nbsp;<span class="op" id="2354762">:=</span>&nbsp;<span class="ident" id="2354765">uint64pow10</span><span class="op" id="2354776">[</span><span class="ident" id="2354777">integerDigits</span><span class="op" id="2354790">-</span><span class="ident" id="2354791">i</span><span class="op" id="2354792">-</span><span class="num" id="2354793">1</span><span class="op" id="2354794">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354798">digit</span>&nbsp;<span class="op" id="2354804">:=</span>&nbsp;<span class="ident" id="2354807">integer</span>&nbsp;<span class="op" id="2354815">/</span>&nbsp;<span class="builtintype" id="2354817">uint32</span><span class="op" id="2354823">(</span><span class="ident" id="2354824">pow</span><span class="op" id="2354827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354831">d</span><span class="op" id="2354832">.</span><span class="ident" id="2354833">d</span><span class="op" id="2354834">[</span><span class="ident" id="2354835">i</span><span class="op" id="2354836">]</span>&nbsp;<span class="op" id="2354838">=</span>&nbsp;<span class="builtintype" id="2354840">byte</span><span class="op" id="2354844">(</span><span class="ident" id="2354845">digit</span>&nbsp;<span class="op" id="2354851">+</span>&nbsp;<span class="string" id="2354853">&#39;0&#39;</span><span class="op" id="2354856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354860">integer</span>&nbsp;<span class="op" id="2354868">-=</span>&nbsp;<span class="ident" id="2354871">digit</span>&nbsp;<span class="op" id="2354877">*</span>&nbsp;<span class="builtintype" id="2354879">uint32</span><span class="op" id="2354885">(</span><span class="ident" id="2354886">pow</span><span class="op" id="2354889">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2354893">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2354931">if</span>&nbsp;<span class="ident" id="2354934">currentDiff</span>&nbsp;<span class="op" id="2354946">:=</span>&nbsp;<span class="ident" id="2354949">uint64</span><span class="op" id="2354955">(</span><span class="ident" id="2354956">integer</span><span class="op" id="2354963">)</span><span class="op" id="2354964">&lt;&lt;</span><span class="ident" id="2354966">shift</span>&nbsp;<span class="op" id="2354972">+</span>&nbsp;<span class="ident" id="2354974">fraction</span><span class="op" id="2354982">;</span>&nbsp;<span class="ident" id="2354984">currentDiff</span>&nbsp;<span class="op" id="2354996">&lt;</span>&nbsp;<span class="ident" id="2354998">allowance</span>&nbsp;<span class="op" id="2355008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355013">d</span><span class="op" id="2355014">.</span><span class="ident" id="2355015">nd</span>&nbsp;<span class="op" id="2355018">=</span>&nbsp;<span class="ident" id="2355020">i</span>&nbsp;<span class="op" id="2355022">+</span>&nbsp;<span class="num" id="2355024">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355029">d</span><span class="op" id="2355030">.</span><span class="ident" id="2355031">dp</span>&nbsp;<span class="op" id="2355034">=</span>&nbsp;<span class="ident" id="2355036">integerDigits</span>&nbsp;<span class="op" id="2355050">+</span>&nbsp;<span class="ident" id="2355052">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355061">d</span><span class="op" id="2355062">.</span><span class="ident" id="2355063">neg</span>&nbsp;<span class="op" id="2355067">=</span>&nbsp;<span class="ident" id="2355069">f</span><span class="op" id="2355070">.</span><span class="ident" id="2355071">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355078">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355148">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2355186">return</span>&nbsp;<span class="ident" id="2355193">adjustLastDigit</span><span class="op" id="2355208">(</span><span class="ident" id="2355209">d</span><span class="op" id="2355210">,</span>&nbsp;<span class="ident" id="2355212">currentDiff</span><span class="op" id="2355223">,</span>&nbsp;<span class="ident" id="2355225">targetDiff</span><span class="op" id="2355235">,</span>&nbsp;<span class="ident" id="2355237">allowance</span><span class="op" id="2355246">,</span>&nbsp;<span class="ident" id="2355248">pow</span><span class="op" id="2355251">&lt;&lt;</span><span class="ident" id="2355253">shift</span><span class="op" id="2355258">,</span>&nbsp;<span class="num" id="2355260">2</span><span class="op" id="2355261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2355265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2355268">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355271">d</span><span class="op" id="2355272">.</span><span class="ident" id="2355273">nd</span>&nbsp;<span class="op" id="2355276">=</span>&nbsp;<span class="ident" id="2355278">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355293">d</span><span class="op" id="2355294">.</span><span class="ident" id="2355295">dp</span>&nbsp;<span class="op" id="2355298">=</span>&nbsp;<span class="ident" id="2355300">d</span><span class="op" id="2355301">.</span><span class="ident" id="2355302">nd</span>&nbsp;<span class="op" id="2355305">+</span>&nbsp;<span class="ident" id="2355307">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355314">d</span><span class="op" id="2355315">.</span><span class="ident" id="2355316">neg</span>&nbsp;<span class="op" id="2355320">=</span>&nbsp;<span class="ident" id="2355322">f</span><span class="op" id="2355323">.</span><span class="ident" id="2355324">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355330">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355404">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2355480">var</span>&nbsp;<span class="ident" id="2355484">digit</span>&nbsp;<span class="builtintype" id="2355490">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355495">multiplier</span>&nbsp;<span class="op" id="2355506">:=</span>&nbsp;<span class="ident" id="2355509">uint64</span><span class="op" id="2355515">(</span><span class="num" id="2355516">1</span><span class="op" id="2355517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2355520">for</span>&nbsp;<span class="op" id="2355524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355528">fraction</span>&nbsp;<span class="op" id="2355537">*=</span>&nbsp;<span class="num" id="2355540">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355545">multiplier</span>&nbsp;<span class="op" id="2355556">*=</span>&nbsp;<span class="num" id="2355559">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355564">digit</span>&nbsp;<span class="op" id="2355570">=</span>&nbsp;<span class="builtintype" id="2355572">int</span><span class="op" id="2355575">(</span><span class="ident" id="2355576">fraction</span>&nbsp;<span class="op" id="2355585">&gt;&gt;</span>&nbsp;<span class="ident" id="2355588">shift</span><span class="op" id="2355593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355597">d</span><span class="op" id="2355598">.</span><span class="ident" id="2355599">d</span><span class="op" id="2355600">[</span><span class="ident" id="2355601">d</span><span class="op" id="2355602">.</span><span class="ident" id="2355603">nd</span><span class="op" id="2355605">]</span>&nbsp;<span class="op" id="2355607">=</span>&nbsp;<span class="builtintype" id="2355609">byte</span><span class="op" id="2355613">(</span><span class="ident" id="2355614">digit</span>&nbsp;<span class="op" id="2355620">+</span>&nbsp;<span class="string" id="2355622">&#39;0&#39;</span><span class="op" id="2355625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355629">d</span><span class="op" id="2355630">.</span><span class="ident" id="2355631">nd</span><span class="op" id="2355633">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355638">fraction</span>&nbsp;<span class="op" id="2355647">-=</span>&nbsp;<span class="ident" id="2355650">uint64</span><span class="op" id="2355656">(</span><span class="ident" id="2355657">digit</span><span class="op" id="2355662">)</span>&nbsp;<span class="op" id="2355664">&lt;&lt;</span>&nbsp;<span class="ident" id="2355667">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2355675">if</span>&nbsp;<span class="ident" id="2355678">fraction</span>&nbsp;<span class="op" id="2355687">&lt;</span>&nbsp;<span class="ident" id="2355689">allowance</span><span class="op" id="2355698">*</span><span class="ident" id="2355699">multiplier</span>&nbsp;<span class="op" id="2355710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355715">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355788">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2355865">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2355914">return</span>&nbsp;<span class="ident" id="2355921">adjustLastDigit</span><span class="op" id="2355936">(</span><span class="ident" id="2355937">d</span><span class="op" id="2355938">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355944">fraction</span><span class="op" id="2355952">,</span>&nbsp;<span class="ident" id="2355954">targetDiff</span><span class="op" id="2355964">*</span><span class="ident" id="2355965">multiplier</span><span class="op" id="2355975">,</span>&nbsp;<span class="ident" id="2355977">allowance</span><span class="op" id="2355986">*</span><span class="ident" id="2355987">multiplier</span><span class="op" id="2355997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2356003">1</span><span class="op" id="2356004">&lt;&lt;</span><span class="ident" id="2356006">shift</span><span class="op" id="2356011">,</span>&nbsp;<span class="ident" id="2356013">multiplier</span><span class="op" id="2356023">*</span><span class="num" id="2356024">2</span><span class="op" id="2356025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356032">}</span><br>
<span class="lineno"></span><span class="op" id="2356034">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2356037">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2356105">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*.</span><br>
<span class="lineno"></span><span class="comment" id="2356173">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2356241">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*.</span><br>
<span class="lineno">645</span><span class="keyword" id="2356301">func</span>&nbsp;<span class="ident" id="2356306">adjustLastDigit</span><span class="op" id="2356321">(</span><span class="ident" id="2356322">d</span>&nbsp;<span class="op" id="2356324">*</span><span class="ident" id="2356325">decimalSlice</span><span class="op" id="2356337">,</span>&nbsp;<span class="ident" id="2356339">currentDiff</span><span class="op" id="2356350">,</span>&nbsp;<span class="ident" id="2356352">targetDiff</span><span class="op" id="2356362">,</span>&nbsp;<span class="ident" id="2356364">maxDiff</span><span class="op" id="2356371">,</span>&nbsp;<span class="ident" id="2356373">ulpDecimal</span><span class="op" id="2356383">,</span>&nbsp;<span class="ident" id="2356385">ulpBinary</span>&nbsp;<span class="ident" id="2356395">uint64</span><span class="op" id="2356401">)</span>&nbsp;<span class="builtintype" id="2356403">bool</span>&nbsp;<span class="op" id="2356408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356411">if</span>&nbsp;<span class="ident" id="2356414">ulpDecimal</span>&nbsp;<span class="op" id="2356425">&lt;</span>&nbsp;<span class="num" id="2356427">2</span><span class="op" id="2356428">*</span><span class="ident" id="2356429">ulpBinary</span>&nbsp;<span class="op" id="2356439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2356443">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356475">return</span>&nbsp;<span class="builtintype" id="2356482">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356489">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356492">for</span>&nbsp;<span class="ident" id="2356496">currentDiff</span><span class="op" id="2356507">+</span><span class="ident" id="2356508">ulpDecimal</span><span class="op" id="2356518">/</span><span class="num" id="2356519">2</span><span class="op" id="2356520">+</span><span class="ident" id="2356521">ulpBinary</span>&nbsp;<span class="op" id="2356531">&lt;</span>&nbsp;<span class="ident" id="2356533">targetDiff</span>&nbsp;<span class="op" id="2356544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2356548">d</span><span class="op" id="2356549">.</span><span class="ident" id="2356550">d</span><span class="op" id="2356551">[</span><span class="ident" id="2356552">d</span><span class="op" id="2356553">.</span><span class="ident" id="2356554">nd</span><span class="op" id="2356556">-</span><span class="num" id="2356557">1</span><span class="op" id="2356558">]</span><span class="op" id="2356559">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2356564">currentDiff</span>&nbsp;<span class="op" id="2356576">+=</span>&nbsp;<span class="ident" id="2356579">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356594">if</span>&nbsp;<span class="ident" id="2356597">currentDiff</span><span class="op" id="2356608">+</span><span class="ident" id="2356609">ulpDecimal</span>&nbsp;<span class="op" id="2356620">&lt;=</span>&nbsp;<span class="ident" id="2356623">targetDiff</span><span class="op" id="2356633">+</span><span class="ident" id="2356634">ulpDecimal</span><span class="op" id="2356644">/</span><span class="num" id="2356645">2</span><span class="op" id="2356646">+</span><span class="ident" id="2356647">ulpBinary</span>&nbsp;<span class="op" id="2356657">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2356661">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356714">return</span>&nbsp;<span class="builtintype" id="2356721">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356731">if</span>&nbsp;<span class="ident" id="2356734">currentDiff</span>&nbsp;<span class="op" id="2356746">&lt;</span>&nbsp;<span class="ident" id="2356748">ulpBinary</span>&nbsp;<span class="op" id="2356758">||</span>&nbsp;<span class="ident" id="2356761">currentDiff</span>&nbsp;<span class="op" id="2356773">&gt;</span>&nbsp;<span class="ident" id="2356775">maxDiff</span><span class="op" id="2356782">-</span><span class="ident" id="2356783">ulpBinary</span>&nbsp;<span class="op" id="2356793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2356797">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356818">return</span>&nbsp;<span class="builtintype" id="2356825">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356835">if</span>&nbsp;<span class="ident" id="2356838">d</span><span class="op" id="2356839">.</span><span class="ident" id="2356840">nd</span>&nbsp;<span class="op" id="2356843">==</span>&nbsp;<span class="num" id="2356846">1</span>&nbsp;<span class="op" id="2356848">&amp;&amp;</span>&nbsp;<span class="ident" id="2356851">d</span><span class="op" id="2356852">.</span><span class="ident" id="2356853">d</span><span class="op" id="2356854">[</span><span class="num" id="2356855">0</span><span class="op" id="2356856">]</span>&nbsp;<span class="op" id="2356858">==</span>&nbsp;<span class="string" id="2356861">&#39;0&#39;</span>&nbsp;<span class="op" id="2356865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2356869">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2356912">d</span><span class="op" id="2356913">.</span><span class="ident" id="2356914">nd</span>&nbsp;<span class="op" id="2356917">=</span>&nbsp;<span class="num" id="2356919">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2356923">d</span><span class="op" id="2356924">.</span><span class="ident" id="2356925">dp</span>&nbsp;<span class="op" id="2356928">=</span>&nbsp;<span class="num" id="2356930">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2356933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2356936">return</span>&nbsp;<span class="builtintype" id="2356943">true</span><br>
<span class="lineno"></span><span class="op" id="2356948">}</span>
</div>
</body>
</html>
