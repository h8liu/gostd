<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4016065">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4016120">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4016174">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4016225">package</span>&nbsp;<span class="ident" id="4016233">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4016239">import</span>&nbsp;<span class="op" id="4016246">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016249">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016256">&#34;net&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016263">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016274">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016285">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016293">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4016308">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4016311">type</span>&nbsp;<span class="ident" id="4016316">InvalidReason</span>&nbsp;<span class="builtintype" id="4016330">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4016335">const</span>&nbsp;<span class="op" id="4016341">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016344">//&nbsp;NotAuthorizedToSign&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;another</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016416">//&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016460">NotAuthorizedToSign</span>&nbsp;<span class="ident" id="4016480"><a href="/crypto/x509/verify.go.html#4016316">InvalidReason</a></span>&nbsp;<span class="op" id="4016494">=</span>&nbsp;<span class="ident" id="4016496">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016502">//&nbsp;Expired&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;has&nbsp;expired,&nbsp;based&nbsp;on&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016572">//&nbsp;given&nbsp;in&nbsp;the&nbsp;VerifyOptions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016604">Expired</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016613">//&nbsp;CANotAuthorizedForThisName&nbsp;results&nbsp;when&nbsp;an&nbsp;intermediate&nbsp;or&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016681">//&nbsp;certificate&nbsp;has&nbsp;a&nbsp;name&nbsp;constraint&nbsp;which&nbsp;doesn&#39;t&nbsp;include&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016750">//&nbsp;being&nbsp;checked.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016769">CANotAuthorizedForThisName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016797">//&nbsp;TooManyIntermediates&nbsp;results&nbsp;when&nbsp;a&nbsp;path&nbsp;length&nbsp;constraint&nbsp;is</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016863">//&nbsp;violated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016877">TooManyIntermediates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016899">//&nbsp;IncompatibleUsage&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&#39;s&nbsp;key&nbsp;usage&nbsp;indicates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016972">//&nbsp;that&nbsp;it&nbsp;may&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;a&nbsp;different&nbsp;purpose.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017026">IncompatibleUsage</span><br>
<span class="lineno">35</span><span class="op" id="4017044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4017047">//&nbsp;CertificateInvalidError&nbsp;results&nbsp;when&nbsp;an&nbsp;odd&nbsp;error&nbsp;occurs.&nbsp;Users&nbsp;of&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4017122">//&nbsp;library&nbsp;probably&nbsp;want&nbsp;to&nbsp;handle&nbsp;all&nbsp;these&nbsp;errors&nbsp;uniformly.</span><br>
<span class="lineno"></span><span class="keyword" id="4017185">type</span>&nbsp;<span class="ident" id="4017190">CertificateInvalidError</span>&nbsp;<span class="keyword" id="4017214">struct</span>&nbsp;<span class="op" id="4017221">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017224">Cert</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4017231">*</span><span class="ident" id="4017232"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017245">Reason</span>&nbsp;<span class="ident" id="4017252"><a href="/crypto/x509/verify.go.html#4016316">InvalidReason</a></span><br>
<span class="lineno"></span><span class="op" id="4017266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4017269">func</span>&nbsp;<span class="op" id="4017274">(</span><span class="ident" id="4017275">e</span>&nbsp;<span class="ident" id="4017277"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4017300">)</span>&nbsp;<span class="ident" id="4017302">Error</span><span class="op" id="4017307">(</span><span class="op" id="4017308">)</span>&nbsp;<span class="builtintype" id="4017310">string</span>&nbsp;<span class="op" id="4017317">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017320">switch</span>&nbsp;<span class="ident" id="4017327"><a href="/crypto/x509/verify.go.html#4017275">e</a></span><span class="op" id="4017328">.</span><span class="ident" id="4017329">Reason</span>&nbsp;<span class="op" id="4017336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017339">case</span>&nbsp;<span class="ident" id="4017344"><a href="/crypto/x509/verify.go.html#4016460">NotAuthorizedToSign</a></span><span class="op" id="4017363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017367">return</span>&nbsp;<span class="string" id="4017374">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;other&nbsp;certificates&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017440">case</span>&nbsp;<span class="ident" id="4017445"><a href="/crypto/x509/verify.go.html#4016604">Expired</a></span><span class="op" id="4017452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017456">return</span>&nbsp;<span class="string" id="4017463">&#34;x509:&nbsp;certificate&nbsp;has&nbsp;expired&nbsp;or&nbsp;is&nbsp;not&nbsp;yet&nbsp;valid&#34;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017516">case</span>&nbsp;<span class="ident" id="4017521"><a href="/crypto/x509/verify.go.html#4016769">CANotAuthorizedForThisName</a></span><span class="op" id="4017547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017551">return</span>&nbsp;<span class="string" id="4017558">&#34;x509:&nbsp;a&nbsp;root&nbsp;or&nbsp;intermediate&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;in&nbsp;this&nbsp;domain&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017643">case</span>&nbsp;<span class="ident" id="4017648"><a href="/crypto/x509/verify.go.html#4016877">TooManyIntermediates</a></span><span class="op" id="4017668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017672">return</span>&nbsp;<span class="string" id="4017679">&#34;x509:&nbsp;too&nbsp;many&nbsp;intermediates&nbsp;for&nbsp;path&nbsp;length&nbsp;constraint&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017738">case</span>&nbsp;<span class="ident" id="4017743"><a href="/crypto/x509/verify.go.html#4017026">IncompatibleUsage</a></span><span class="op" id="4017760">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017764">return</span>&nbsp;<span class="string" id="4017771">&#34;x509:&nbsp;certificate&nbsp;specifies&nbsp;an&nbsp;incompatible&nbsp;key&nbsp;usage&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017831">return</span>&nbsp;<span class="string" id="4017838">&#34;x509:&nbsp;unknown&nbsp;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="4017860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="4017863">//&nbsp;HostnameError&nbsp;results&nbsp;when&nbsp;the&nbsp;set&nbsp;of&nbsp;authorized&nbsp;names&nbsp;doesn&#39;t&nbsp;match&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4017939">//&nbsp;requested&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4017958">type</span>&nbsp;<span class="ident" id="4017963">HostnameError</span>&nbsp;<span class="keyword" id="4017977">struct</span>&nbsp;<span class="op" id="4017984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017987">Certificate</span>&nbsp;<span class="op" id="4017999">*</span><span class="ident" id="4018000"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018013">Host</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4018025">string</span><br>
<span class="lineno">65</span><span class="op" id="4018032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4018035">func</span>&nbsp;<span class="op" id="4018040">(</span><span class="ident" id="4018041">h</span>&nbsp;<span class="ident" id="4018043"><a href="/crypto/x509/verify.go.html#4017963">HostnameError</a></span><span class="op" id="4018056">)</span>&nbsp;<span class="ident" id="4018058">Error</span><span class="op" id="4018063">(</span><span class="op" id="4018064">)</span>&nbsp;<span class="builtintype" id="4018066">string</span>&nbsp;<span class="op" id="4018073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018076">c</span>&nbsp;<span class="op" id="4018078">:=</span>&nbsp;<span class="ident" id="4018081"><a href="/crypto/x509/verify.go.html#4018041">h</a></span><span class="op" id="4018082">.</span><span class="ident" id="4018083">Certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018097">var</span>&nbsp;<span class="ident" id="4018101">valid</span>&nbsp;<span class="builtintype" id="4018107">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018115">if</span>&nbsp;<span class="ident" id="4018118">ip</span>&nbsp;<span class="op" id="4018121">:=</span>&nbsp;<span class="ident" id="4018124"><a href="/crypto/x509/verify.go.html#4016256">net</a></span><span class="op" id="4018127">.</span><span class="ident" id="4018128">ParseIP</span><span class="op" id="4018135">(</span><span class="ident" id="4018136"><a href="/crypto/x509/verify.go.html#4018041">h</a></span><span class="op" id="4018137">.</span><span class="ident" id="4018138">Host</span><span class="op" id="4018142">)</span><span class="op" id="4018143">;</span>&nbsp;<span class="ident" id="4018145"><a href="/crypto/x509/verify.go.html#4018118">ip</a></span>&nbsp;<span class="op" id="4018148">!=</span>&nbsp;<span class="ident" id="4018151">nil</span>&nbsp;<span class="op" id="4018155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018159">//&nbsp;Trying&nbsp;to&nbsp;validate&nbsp;an&nbsp;IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018189">if</span>&nbsp;<span class="builtinfunc" id="4018192">len</span><span class="op" id="4018195">(</span><span class="ident" id="4018196"><a href="/crypto/x509/verify.go.html#4018076">c</a></span><span class="op" id="4018197">.</span><span class="ident" id="4018198">IPAddresses</span><span class="op" id="4018209">)</span>&nbsp;<span class="op" id="4018211">==</span>&nbsp;<span class="num" id="4018214">0</span>&nbsp;<span class="op" id="4018216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018221">return</span>&nbsp;<span class="string" id="4018228">&#34;x509:&nbsp;cannot&nbsp;validate&nbsp;certificate&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4018269">+</span>&nbsp;<span class="ident" id="4018271"><a href="/crypto/x509/verify.go.html#4018041">h</a></span><span class="op" id="4018272">.</span><span class="ident" id="4018273">Host</span>&nbsp;<span class="op" id="4018278">+</span>&nbsp;<span class="string" id="4018280">&#34;&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;contain&nbsp;any&nbsp;IP&nbsp;SANs&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018328">for</span>&nbsp;<span class="ident" id="4018332">_</span><span class="op" id="4018333">,</span>&nbsp;<span class="ident" id="4018335">san</span>&nbsp;<span class="op" id="4018339">:=</span>&nbsp;<span class="keyword" id="4018342">range</span>&nbsp;<span class="ident" id="4018348"><a href="/crypto/x509/verify.go.html#4018076">c</a></span><span class="op" id="4018349">.</span><span class="ident" id="4018350">IPAddresses</span>&nbsp;<span class="op" id="4018362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018367">if</span>&nbsp;<span class="builtinfunc" id="4018370">len</span><span class="op" id="4018373">(</span><span class="ident" id="4018374"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span><span class="op" id="4018379">)</span>&nbsp;<span class="op" id="4018381">&gt;</span>&nbsp;<span class="num" id="4018383">0</span>&nbsp;<span class="op" id="4018385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018391"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span>&nbsp;<span class="op" id="4018397">+=</span>&nbsp;<span class="string" id="4018400">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018408">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018413"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span>&nbsp;<span class="op" id="4018419">+=</span>&nbsp;<span class="ident" id="4018422"><a href="/crypto/x509/verify.go.html#4018335">san</a></span><span class="op" id="4018425">.</span><span class="ident" id="4018426">String</span><span class="op" id="4018432">(</span><span class="op" id="4018433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018440">}</span>&nbsp;<span class="keyword" id="4018442">else</span>&nbsp;<span class="op" id="4018447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018451">if</span>&nbsp;<span class="builtinfunc" id="4018454">len</span><span class="op" id="4018457">(</span><span class="ident" id="4018458"><a href="/crypto/x509/verify.go.html#4018076">c</a></span><span class="op" id="4018459">.</span><span class="ident" id="4018460">DNSNames</span><span class="op" id="4018468">)</span>&nbsp;<span class="op" id="4018470">&gt;</span>&nbsp;<span class="num" id="4018472">0</span>&nbsp;<span class="op" id="4018474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018479"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span>&nbsp;<span class="op" id="4018485">=</span>&nbsp;<span class="ident" id="4018487"><a href="/crypto/x509/verify.go.html#4016274">strings</a></span><span class="op" id="4018494">.</span><span class="ident" id="4018495">Join</span><span class="op" id="4018499">(</span><span class="ident" id="4018500"><a href="/crypto/x509/verify.go.html#4018076">c</a></span><span class="op" id="4018501">.</span><span class="ident" id="4018502">DNSNames</span><span class="op" id="4018510">,</span>&nbsp;<span class="string" id="4018512">&#34;,&nbsp;&#34;</span><span class="op" id="4018516">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018520">}</span>&nbsp;<span class="keyword" id="4018522">else</span>&nbsp;<span class="op" id="4018527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018532"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span>&nbsp;<span class="op" id="4018538">=</span>&nbsp;<span class="ident" id="4018540"><a href="/crypto/x509/verify.go.html#4018076">c</a></span><span class="op" id="4018541">.</span><span class="ident" id="4018542">Subject</span><span class="op" id="4018549">.</span><span class="ident" id="4018550">CommonName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018569">return</span>&nbsp;<span class="string" id="4018576">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;valid&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4018610">+</span>&nbsp;<span class="ident" id="4018612"><a href="/crypto/x509/verify.go.html#4018101">valid</a></span>&nbsp;<span class="op" id="4018618">+</span>&nbsp;<span class="string" id="4018620">&#34;,&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="4018629">+</span>&nbsp;<span class="ident" id="4018631"><a href="/crypto/x509/verify.go.html#4018041">h</a></span><span class="op" id="4018632">.</span><span class="ident" id="4018633">Host</span><br>
<span class="lineno">90</span><span class="op" id="4018638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018641">//&nbsp;UnknownAuthorityError&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&nbsp;issuer&nbsp;is&nbsp;unknown</span><br>
<span class="lineno"></span><span class="keyword" id="4018713">type</span>&nbsp;<span class="ident" id="4018718">UnknownAuthorityError</span>&nbsp;<span class="keyword" id="4018740">struct</span>&nbsp;<span class="op" id="4018747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018750">cert</span>&nbsp;<span class="op" id="4018755">*</span><span class="ident" id="4018756"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018769">//&nbsp;hintErr&nbsp;contains&nbsp;an&nbsp;error&nbsp;that&nbsp;may&nbsp;be&nbsp;helpful&nbsp;in&nbsp;determining&nbsp;why&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018841">//&nbsp;authority&nbsp;wasn&#39;t&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018869">hintErr</span>&nbsp;<span class="builtintype" id="4018877">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018884">//&nbsp;hintCert&nbsp;contains&nbsp;a&nbsp;possible&nbsp;authority&nbsp;certificate&nbsp;that&nbsp;was&nbsp;rejected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018957">//&nbsp;because&nbsp;of&nbsp;the&nbsp;error&nbsp;in&nbsp;hintErr.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018994">hintCert</span>&nbsp;<span class="op" id="4019003">*</span><span class="ident" id="4019004"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="4019016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4019019">func</span>&nbsp;<span class="op" id="4019024">(</span><span class="ident" id="4019025">e</span>&nbsp;<span class="ident" id="4019027"><a href="/crypto/x509/verify.go.html#4018718">UnknownAuthorityError</a></span><span class="op" id="4019048">)</span>&nbsp;<span class="ident" id="4019050">Error</span><span class="op" id="4019055">(</span><span class="op" id="4019056">)</span>&nbsp;<span class="builtintype" id="4019058">string</span>&nbsp;<span class="op" id="4019065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019068">s</span>&nbsp;<span class="op" id="4019070">:=</span>&nbsp;<span class="string" id="4019073">&#34;x509:&nbsp;certificate&nbsp;signed&nbsp;by&nbsp;unknown&nbsp;authority&#34;</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019122">if</span>&nbsp;<span class="ident" id="4019125"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019126">.</span><span class="ident" id="4019127">hintErr</span>&nbsp;<span class="op" id="4019135">!=</span>&nbsp;<span class="ident" id="4019138">nil</span>&nbsp;<span class="op" id="4019142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019146">certName</span>&nbsp;<span class="op" id="4019155">:=</span>&nbsp;<span class="ident" id="4019158"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019159">.</span><span class="ident" id="4019160">hintCert</span><span class="op" id="4019168">.</span><span class="ident" id="4019169">Subject</span><span class="op" id="4019176">.</span><span class="ident" id="4019177">CommonName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019190">if</span>&nbsp;<span class="builtinfunc" id="4019193">len</span><span class="op" id="4019196">(</span><span class="ident" id="4019197"><a href="/crypto/x509/verify.go.html#4019146">certName</a></span><span class="op" id="4019205">)</span>&nbsp;<span class="op" id="4019207">==</span>&nbsp;<span class="num" id="4019210">0</span>&nbsp;<span class="op" id="4019212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019217">if</span>&nbsp;<span class="builtinfunc" id="4019220">len</span><span class="op" id="4019223">(</span><span class="ident" id="4019224"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019225">.</span><span class="ident" id="4019226">hintCert</span><span class="op" id="4019234">.</span><span class="ident" id="4019235">Subject</span><span class="op" id="4019242">.</span><span class="ident" id="4019243">Organization</span><span class="op" id="4019255">)</span>&nbsp;<span class="op" id="4019257">&gt;</span>&nbsp;<span class="num" id="4019259">0</span>&nbsp;<span class="op" id="4019261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019267"><a href="/crypto/x509/verify.go.html#4019146">certName</a></span>&nbsp;<span class="op" id="4019276">=</span>&nbsp;<span class="ident" id="4019278"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019279">.</span><span class="ident" id="4019280">hintCert</span><span class="op" id="4019288">.</span><span class="ident" id="4019289">Subject</span><span class="op" id="4019296">.</span><span class="ident" id="4019297">Organization</span><span class="op" id="4019309">[</span><span class="num" id="4019310">0</span><span class="op" id="4019311">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019321"><a href="/crypto/x509/verify.go.html#4019146">certName</a></span>&nbsp;<span class="op" id="4019330">=</span>&nbsp;<span class="string" id="4019332">&#34;serial:&#34;</span>&nbsp;<span class="op" id="4019342">+</span>&nbsp;<span class="ident" id="4019344"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019345">.</span><span class="ident" id="4019346">hintCert</span><span class="op" id="4019354">.</span><span class="ident" id="4019355">SerialNumber</span><span class="op" id="4019367">.</span><span class="ident" id="4019368">String</span><span class="op" id="4019374">(</span><span class="op" id="4019375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019383"><a href="/crypto/x509/verify.go.html#4019068">s</a></span>&nbsp;<span class="op" id="4019385">+=</span>&nbsp;<span class="ident" id="4019388"><a href="/crypto/x509/verify.go.html#4016249">fmt</a></span><span class="op" id="4019391">.</span><span class="ident" id="4019392">Sprintf</span><span class="op" id="4019399">(</span><span class="string" id="4019400">&#34;&nbsp;(possibly&nbsp;because&nbsp;of&nbsp;%q&nbsp;while&nbsp;trying&nbsp;to&nbsp;verify&nbsp;candidate&nbsp;authority&nbsp;certificate&nbsp;%q)&#34;</span><span class="op" id="4019485">,</span>&nbsp;<span class="ident" id="4019487"><a href="/crypto/x509/verify.go.html#4019025">e</a></span><span class="op" id="4019488">.</span><span class="ident" id="4019489">hintErr</span><span class="op" id="4019496">,</span>&nbsp;<span class="ident" id="4019498"><a href="/crypto/x509/verify.go.html#4019146">certName</a></span><span class="op" id="4019506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019509">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019512">return</span>&nbsp;<span class="ident" id="4019519"><a href="/crypto/x509/verify.go.html#4019068">s</a></span><br>
<span class="lineno"></span><span class="op" id="4019521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4019524">//&nbsp;SystemRootsError&nbsp;results&nbsp;when&nbsp;we&nbsp;fail&nbsp;to&nbsp;load&nbsp;the&nbsp;system&nbsp;root&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4019603">type</span>&nbsp;<span class="ident" id="4019608">SystemRootsError</span>&nbsp;<span class="keyword" id="4019625">struct</span><span class="op" id="4019631">{</span><span class="op" id="4019632">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4019635">func</span>&nbsp;<span class="op" id="4019640">(</span><span class="ident" id="4019641"><a href="/crypto/x509/verify.go.html#4019608">SystemRootsError</a></span><span class="op" id="4019657">)</span>&nbsp;<span class="ident" id="4019659">Error</span><span class="op" id="4019664">(</span><span class="op" id="4019665">)</span>&nbsp;<span class="builtintype" id="4019667">string</span>&nbsp;<span class="op" id="4019674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019677">return</span>&nbsp;<span class="string" id="4019684">&#34;x509:&nbsp;failed&nbsp;to&nbsp;load&nbsp;system&nbsp;roots&nbsp;and&nbsp;no&nbsp;roots&nbsp;provided&#34;</span><br>
<span class="lineno"></span><span class="op" id="4019742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4019745">//&nbsp;VerifyOptions&nbsp;contains&nbsp;parameters&nbsp;for&nbsp;Certificate.Verify.&nbsp;It&#39;s&nbsp;a&nbsp;structure</span><br>
<span class="lineno"></span><span class="comment" id="4019823">//&nbsp;because&nbsp;other&nbsp;PKIX&nbsp;verification&nbsp;APIs&nbsp;have&nbsp;ended&nbsp;up&nbsp;needing&nbsp;many&nbsp;options.</span><br>
<span class="lineno"></span><span class="keyword" id="4019899">type</span>&nbsp;<span class="ident" id="4019904">VerifyOptions</span>&nbsp;<span class="keyword" id="4019918">struct</span>&nbsp;<span class="op" id="4019925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019928">DNSName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4019942">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019950">Intermediates</span>&nbsp;<span class="op" id="4019964">*</span><span class="ident" id="4019965"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019975">Roots</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019989">*</span><span class="ident" id="4019990"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span>&nbsp;<span class="comment" id="4019999">//&nbsp;if&nbsp;nil,&nbsp;the&nbsp;system&nbsp;roots&nbsp;are&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020037">CurrentTime</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4020051"><a href="/crypto/x509/verify.go.html#4016285">time</a></span><span class="op" id="4020055">.</span><span class="ident" id="4020056">Time</span>&nbsp;<span class="comment" id="4020061">//&nbsp;if&nbsp;zero,&nbsp;the&nbsp;current&nbsp;time&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020099">//&nbsp;KeyUsage&nbsp;specifies&nbsp;which&nbsp;Extended&nbsp;Key&nbsp;Usage&nbsp;values&nbsp;are&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020170">//&nbsp;An&nbsp;empty&nbsp;list&nbsp;means&nbsp;ExtKeyUsageServerAuth.&nbsp;Key&nbsp;usage&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020243">//&nbsp;constraint&nbsp;down&nbsp;the&nbsp;chain&nbsp;which&nbsp;mirrors&nbsp;Windows&nbsp;CryptoAPI&nbsp;behaviour,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020316">//&nbsp;but&nbsp;not&nbsp;the&nbsp;spec.&nbsp;To&nbsp;accept&nbsp;any&nbsp;key&nbsp;usage,&nbsp;include&nbsp;ExtKeyUsageAny.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020387">KeyUsages</span>&nbsp;<span class="op" id="4020397">[</span><span class="op" id="4020398">]</span><span class="ident" id="4020399"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><br>
<span class="lineno"></span><span class="op" id="4020411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4020414">const</span>&nbsp;<span class="op" id="4020420">(</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020423">leafCertificate</span>&nbsp;<span class="op" id="4020439">=</span>&nbsp;<span class="ident" id="4020441">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020447">intermediateCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020472">rootCertificate</span><br>
<span class="lineno"></span><span class="op" id="4020488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4020491">//&nbsp;isValid&nbsp;performs&nbsp;validity&nbsp;checks&nbsp;on&nbsp;the&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4020537">func</span>&nbsp;<span class="op" id="4020542">(</span><span class="ident" id="4020543">c</span>&nbsp;<span class="op" id="4020545">*</span><span class="ident" id="4020546"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4020557">)</span>&nbsp;<span class="ident" id="4020559">isValid</span><span class="op" id="4020566">(</span><span class="ident" id="4020567">certType</span>&nbsp;<span class="builtintype" id="4020576">int</span><span class="op" id="4020579">,</span>&nbsp;<span class="ident" id="4020581">currentChain</span>&nbsp;<span class="op" id="4020594">[</span><span class="op" id="4020595">]</span><span class="op" id="4020596">*</span><span class="ident" id="4020597"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4020608">,</span>&nbsp;<span class="ident" id="4020610">opts</span>&nbsp;<span class="op" id="4020615">*</span><span class="ident" id="4020616"><a href="/crypto/x509/verify.go.html#4019904">VerifyOptions</a></span><span class="op" id="4020629">)</span>&nbsp;<span class="builtintype" id="4020631">error</span>&nbsp;<span class="op" id="4020637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020640">now</span>&nbsp;<span class="op" id="4020644">:=</span>&nbsp;<span class="ident" id="4020647"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4020651">.</span><span class="ident" id="4020652">CurrentTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020665">if</span>&nbsp;<span class="ident" id="4020668"><a href="/crypto/x509/verify.go.html#4020640">now</a></span><span class="op" id="4020671">.</span><span class="ident" id="4020672">IsZero</span><span class="op" id="4020678">(</span><span class="op" id="4020679">)</span>&nbsp;<span class="op" id="4020681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020685"><a href="/crypto/x509/verify.go.html#4020640">now</a></span>&nbsp;<span class="op" id="4020689">=</span>&nbsp;<span class="ident" id="4020691"><a href="/crypto/x509/verify.go.html#4016285">time</a></span><span class="op" id="4020695">.</span><span class="ident" id="4020696">Now</span><span class="op" id="4020699">(</span><span class="op" id="4020700">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020706">if</span>&nbsp;<span class="ident" id="4020709"><a href="/crypto/x509/verify.go.html#4020640">now</a></span><span class="op" id="4020712">.</span><span class="ident" id="4020713">Before</span><span class="op" id="4020719">(</span><span class="ident" id="4020720"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4020721">.</span><span class="ident" id="4020722">NotBefore</span><span class="op" id="4020731">)</span>&nbsp;<span class="op" id="4020733">||</span>&nbsp;<span class="ident" id="4020736"><a href="/crypto/x509/verify.go.html#4020640">now</a></span><span class="op" id="4020739">.</span><span class="ident" id="4020740">After</span><span class="op" id="4020745">(</span><span class="ident" id="4020746"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4020747">.</span><span class="ident" id="4020748">NotAfter</span><span class="op" id="4020756">)</span>&nbsp;<span class="op" id="4020758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020762">return</span>&nbsp;<span class="ident" id="4020769"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4020792">{</span><span class="ident" id="4020793"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4020794">,</span>&nbsp;<span class="ident" id="4020796"><a href="/crypto/x509/verify.go.html#4016604">Expired</a></span><span class="op" id="4020803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020810">if</span>&nbsp;<span class="builtinfunc" id="4020813">len</span><span class="op" id="4020816">(</span><span class="ident" id="4020817"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4020818">.</span><span class="ident" id="4020819">PermittedDNSDomains</span><span class="op" id="4020838">)</span>&nbsp;<span class="op" id="4020840">&gt;</span>&nbsp;<span class="num" id="4020842">0</span>&nbsp;<span class="op" id="4020844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020848">ok</span>&nbsp;<span class="op" id="4020851">:=</span>&nbsp;<span class="builtintype" id="4020854">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020862">for</span>&nbsp;<span class="ident" id="4020866">_</span><span class="op" id="4020867">,</span>&nbsp;<span class="ident" id="4020869">domain</span>&nbsp;<span class="op" id="4020876">:=</span>&nbsp;<span class="keyword" id="4020879">range</span>&nbsp;<span class="ident" id="4020885"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4020886">.</span><span class="ident" id="4020887">PermittedDNSDomains</span>&nbsp;<span class="op" id="4020907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020912">if</span>&nbsp;<span class="ident" id="4020915"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4020919">.</span><span class="ident" id="4020920">DNSName</span>&nbsp;<span class="op" id="4020928">==</span>&nbsp;<span class="ident" id="4020931"><a href="/crypto/x509/verify.go.html#4020869">domain</a></span>&nbsp;<span class="op" id="4020938">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020945">(</span><span class="ident" id="4020946"><a href="/crypto/x509/verify.go.html#4016274">strings</a></span><span class="op" id="4020953">.</span><span class="ident" id="4020954">HasSuffix</span><span class="op" id="4020963">(</span><span class="ident" id="4020964"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4020968">.</span><span class="ident" id="4020969">DNSName</span><span class="op" id="4020976">,</span>&nbsp;<span class="ident" id="4020978"><a href="/crypto/x509/verify.go.html#4020869">domain</a></span><span class="op" id="4020984">)</span>&nbsp;<span class="op" id="4020986">&amp;&amp;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4020994">len</span><span class="op" id="4020997">(</span><span class="ident" id="4020998"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4021002">.</span><span class="ident" id="4021003">DNSName</span><span class="op" id="4021010">)</span>&nbsp;<span class="op" id="4021012">&gt;=</span>&nbsp;<span class="num" id="4021015">1</span><span class="op" id="4021016">+</span><span class="builtinfunc" id="4021017">len</span><span class="op" id="4021020">(</span><span class="ident" id="4021021"><a href="/crypto/x509/verify.go.html#4020869">domain</a></span><span class="op" id="4021027">)</span>&nbsp;<span class="op" id="4021029">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021037"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4021041">.</span><span class="ident" id="4021042">DNSName</span><span class="op" id="4021049">[</span><span class="builtinfunc" id="4021050">len</span><span class="op" id="4021053">(</span><span class="ident" id="4021054"><a href="/crypto/x509/verify.go.html#4020610">opts</a></span><span class="op" id="4021058">.</span><span class="ident" id="4021059">DNSName</span><span class="op" id="4021066">)</span><span class="op" id="4021067">-</span><span class="builtinfunc" id="4021068">len</span><span class="op" id="4021071">(</span><span class="ident" id="4021072"><a href="/crypto/x509/verify.go.html#4020869">domain</a></span><span class="op" id="4021078">)</span><span class="op" id="4021079">-</span><span class="num" id="4021080">1</span><span class="op" id="4021081">]</span>&nbsp;<span class="op" id="4021083">==</span>&nbsp;<span class="string" id="4021086">&#39;.&#39;</span><span class="op" id="4021089">)</span>&nbsp;<span class="op" id="4021091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021097"><a href="/crypto/x509/verify.go.html#4020848">ok</a></span>&nbsp;<span class="op" id="4021100">=</span>&nbsp;<span class="builtintype" id="4021102">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4021111">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4021120">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4021124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4021129">if</span>&nbsp;<span class="op" id="4021132">!</span><span class="ident" id="4021133"><a href="/crypto/x509/verify.go.html#4020848">ok</a></span>&nbsp;<span class="op" id="4021136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4021141">return</span>&nbsp;<span class="ident" id="4021148"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4021171">{</span><span class="ident" id="4021172"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4021173">,</span>&nbsp;<span class="ident" id="4021175"><a href="/crypto/x509/verify.go.html#4016769">CANotAuthorizedForThisName</a></span><span class="op" id="4021201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4021205">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4021208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021212">//&nbsp;KeyUsage&nbsp;status&nbsp;flags&nbsp;are&nbsp;ignored.&nbsp;From&nbsp;Engineering&nbsp;Security,&nbsp;Peter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021284">//&nbsp;Gutmann:&nbsp;A&nbsp;European&nbsp;government&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signing&nbsp;certificates&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021357">//&nbsp;being&nbsp;valid&nbsp;for&nbsp;encryption&nbsp;only,&nbsp;but&nbsp;no-one&nbsp;noticed.&nbsp;Another</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021422">//&nbsp;European&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signature&nbsp;keys&nbsp;as&nbsp;not&nbsp;being&nbsp;valid&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021487">//&nbsp;signatures.&nbsp;A&nbsp;different&nbsp;CA&nbsp;marked&nbsp;its&nbsp;own&nbsp;trusted&nbsp;root&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021558">//&nbsp;as&nbsp;being&nbsp;invalid&nbsp;for&nbsp;certificate&nbsp;signing.&nbsp;&nbsp;Another&nbsp;national&nbsp;CA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021625">//&nbsp;distributed&nbsp;a&nbsp;certificate&nbsp;to&nbsp;be&nbsp;used&nbsp;to&nbsp;encrypt&nbsp;data&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021690">//&nbsp;countryâ€™s&nbsp;tax&nbsp;authority&nbsp;that&nbsp;was&nbsp;marked&nbsp;as&nbsp;only&nbsp;being&nbsp;usable&nbsp;for</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021761">//&nbsp;digital&nbsp;signatures&nbsp;but&nbsp;not&nbsp;for&nbsp;encryption.&nbsp;Yet&nbsp;another&nbsp;CA&nbsp;reversed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021832">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;bit&nbsp;flags&nbsp;in&nbsp;the&nbsp;keyUsage&nbsp;due&nbsp;to&nbsp;confusion&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021901">//&nbsp;encoding&nbsp;endianness,&nbsp;essentially&nbsp;setting&nbsp;a&nbsp;random&nbsp;keyUsage&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021967">//&nbsp;certificates&nbsp;that&nbsp;it&nbsp;issued.&nbsp;Another&nbsp;CA&nbsp;created&nbsp;a&nbsp;self-invalidating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022039">//&nbsp;certificate&nbsp;by&nbsp;adding&nbsp;a&nbsp;certificate&nbsp;policy&nbsp;statement&nbsp;stipulating</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022108">//&nbsp;that&nbsp;the&nbsp;certificate&nbsp;had&nbsp;to&nbsp;be&nbsp;used&nbsp;strictly&nbsp;as&nbsp;specified&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022177">//&nbsp;keyUsage,&nbsp;and&nbsp;a&nbsp;keyUsage&nbsp;containing&nbsp;a&nbsp;flag&nbsp;indicating&nbsp;that&nbsp;the&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022248">//&nbsp;encryption&nbsp;key&nbsp;could&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;Diffie-Hellman&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022321">if</span>&nbsp;<span class="ident" id="4022324"><a href="/crypto/x509/verify.go.html#4020567">certType</a></span>&nbsp;<span class="op" id="4022333">==</span>&nbsp;<span class="ident" id="4022336"><a href="/crypto/x509/verify.go.html#4020447">intermediateCertificate</a></span>&nbsp;<span class="op" id="4022360">&amp;&amp;</span>&nbsp;<span class="op" id="4022363">(</span><span class="op" id="4022364">!</span><span class="ident" id="4022365"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022366">.</span><span class="ident" id="4022367">BasicConstraintsValid</span>&nbsp;<span class="op" id="4022389">||</span>&nbsp;<span class="op" id="4022392">!</span><span class="ident" id="4022393"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022394">.</span><span class="ident" id="4022395">IsCA</span><span class="op" id="4022399">)</span>&nbsp;<span class="op" id="4022401">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022405">return</span>&nbsp;<span class="ident" id="4022412"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4022435">{</span><span class="ident" id="4022436"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022437">,</span>&nbsp;<span class="ident" id="4022439"><a href="/crypto/x509/verify.go.html#4016460">NotAuthorizedToSign</a></span><span class="op" id="4022458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4022461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022465">if</span>&nbsp;<span class="ident" id="4022468"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022469">.</span><span class="ident" id="4022470">BasicConstraintsValid</span>&nbsp;<span class="op" id="4022492">&amp;&amp;</span>&nbsp;<span class="ident" id="4022495"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022496">.</span><span class="ident" id="4022497">MaxPathLen</span>&nbsp;<span class="op" id="4022508">&gt;=</span>&nbsp;<span class="num" id="4022511">0</span>&nbsp;<span class="op" id="4022513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022517">numIntermediates</span>&nbsp;<span class="op" id="4022534">:=</span>&nbsp;<span class="builtinfunc" id="4022537">len</span><span class="op" id="4022540">(</span><span class="ident" id="4022541"><a href="/crypto/x509/verify.go.html#4020581">currentChain</a></span><span class="op" id="4022553">)</span>&nbsp;<span class="op" id="4022555">-</span>&nbsp;<span class="num" id="4022557">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022561">if</span>&nbsp;<span class="ident" id="4022564"><a href="/crypto/x509/verify.go.html#4022517">numIntermediates</a></span>&nbsp;<span class="op" id="4022581">&gt;</span>&nbsp;<span class="ident" id="4022583"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022584">.</span><span class="ident" id="4022585">MaxPathLen</span>&nbsp;<span class="op" id="4022596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022601">return</span>&nbsp;<span class="ident" id="4022608"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4022631">{</span><span class="ident" id="4022632"><a href="/crypto/x509/verify.go.html#4020543">c</a></span><span class="op" id="4022633">,</span>&nbsp;<span class="ident" id="4022635"><a href="/crypto/x509/verify.go.html#4016877">TooManyIntermediates</a></span><span class="op" id="4022655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4022659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4022662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022666">return</span>&nbsp;<span class="ident" id="4022673">nil</span><br>
<span class="lineno"></span><span class="op" id="4022677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022680">//&nbsp;Verify&nbsp;attempts&nbsp;to&nbsp;verify&nbsp;c&nbsp;by&nbsp;building&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;from&nbsp;c&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4022754">//&nbsp;certificate&nbsp;in&nbsp;opts.Roots,&nbsp;using&nbsp;certificates&nbsp;in&nbsp;opts.Intermediates&nbsp;if</span><br>
<span class="lineno">205</span><span class="comment" id="4022828">//&nbsp;needed.&nbsp;If&nbsp;successful,&nbsp;it&nbsp;returns&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;where&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="4022900">//&nbsp;element&nbsp;of&nbsp;the&nbsp;chain&nbsp;is&nbsp;c&nbsp;and&nbsp;the&nbsp;last&nbsp;element&nbsp;is&nbsp;from&nbsp;opts.Roots.</span><br>
<span class="lineno"></span><span class="comment" id="4022970">//</span><br>
<span class="lineno"></span><span class="comment" id="4022973">//&nbsp;If&nbsp;opts.Roots&nbsp;is&nbsp;nil&nbsp;and&nbsp;system&nbsp;roots&nbsp;are&nbsp;unavailable&nbsp;the&nbsp;returned&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="4023049">//&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;SystemRootsError.</span><br>
<span class="lineno">210</span><span class="comment" id="4023086">//</span><br>
<span class="lineno"></span><span class="comment" id="4023089">//&nbsp;WARNING:&nbsp;this&nbsp;doesn&#39;t&nbsp;do&nbsp;any&nbsp;revocation&nbsp;checking.</span><br>
<span class="lineno"></span><span class="keyword" id="4023142">func</span>&nbsp;<span class="op" id="4023147">(</span><span class="ident" id="4023148">c</span>&nbsp;<span class="op" id="4023150">*</span><span class="ident" id="4023151"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4023162">)</span>&nbsp;<span class="ident" id="4023164">Verify</span><span class="op" id="4023170">(</span><span class="ident" id="4023171">opts</span>&nbsp;<span class="ident" id="4023176"><a href="/crypto/x509/verify.go.html#4019904">VerifyOptions</a></span><span class="op" id="4023189">)</span>&nbsp;<span class="op" id="4023191">(</span><span class="ident" id="4023192">chains</span>&nbsp;<span class="op" id="4023199">[</span><span class="op" id="4023200">]</span><span class="op" id="4023201">[</span><span class="op" id="4023202">]</span><span class="op" id="4023203">*</span><span class="ident" id="4023204"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4023215">,</span>&nbsp;<span class="ident" id="4023217">err</span>&nbsp;<span class="builtintype" id="4023221">error</span><span class="op" id="4023226">)</span>&nbsp;<span class="op" id="4023228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023231">//&nbsp;Use&nbsp;Windows&#39;s&nbsp;own&nbsp;verification&nbsp;and&nbsp;chain&nbsp;building.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023286">if</span>&nbsp;<span class="ident" id="4023289"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023293">.</span><span class="ident" id="4023294">Roots</span>&nbsp;<span class="op" id="4023300">==</span>&nbsp;<span class="ident" id="4023303">nil</span>&nbsp;<span class="op" id="4023307">&amp;&amp;</span>&nbsp;<span class="ident" id="4023310"><a href="/crypto/x509/verify.go.html#4016263">runtime</a></span><span class="op" id="4023317">.</span><span class="ident" id="4023318">GOOS</span>&nbsp;<span class="op" id="4023323">==</span>&nbsp;<span class="string" id="4023326">&#34;windows&#34;</span>&nbsp;<span class="op" id="4023336">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023340">return</span>&nbsp;<span class="ident" id="4023347"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4023348">.</span><span class="ident" id="4023349">systemVerify</span><span class="op" id="4023361">(</span><span class="op" id="4023362">&amp;</span><span class="ident" id="4023363"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023374">if</span>&nbsp;<span class="ident" id="4023377"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023381">.</span><span class="ident" id="4023382">Roots</span>&nbsp;<span class="op" id="4023388">==</span>&nbsp;<span class="ident" id="4023391">nil</span>&nbsp;<span class="op" id="4023395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023399"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023403">.</span><span class="ident" id="4023404">Roots</span>&nbsp;<span class="op" id="4023410">=</span>&nbsp;<span class="ident" id="4023412"><a href="/crypto/x509/root.go.html#4011567">systemRootsPool</a></span><span class="op" id="4023427">(</span><span class="op" id="4023428">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023432">if</span>&nbsp;<span class="ident" id="4023435"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023439">.</span><span class="ident" id="4023440">Roots</span>&nbsp;<span class="op" id="4023446">==</span>&nbsp;<span class="ident" id="4023449">nil</span>&nbsp;<span class="op" id="4023453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023458">return</span>&nbsp;<span class="ident" id="4023465">nil</span><span class="op" id="4023468">,</span>&nbsp;<span class="ident" id="4023470"><a href="/crypto/x509/verify.go.html#4019608">SystemRootsError</a></span><span class="op" id="4023486">{</span><span class="op" id="4023487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023498"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023502">=</span>&nbsp;<span class="ident" id="4023504"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4023505">.</span><span class="ident" id="4023506">isValid</span><span class="op" id="4023513">(</span><span class="ident" id="4023514"><a href="/crypto/x509/verify.go.html#4020423">leafCertificate</a></span><span class="op" id="4023529">,</span>&nbsp;<span class="ident" id="4023531">nil</span><span class="op" id="4023534">,</span>&nbsp;<span class="op" id="4023536">&amp;</span><span class="ident" id="4023537"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023544">if</span>&nbsp;<span class="ident" id="4023547"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023551">!=</span>&nbsp;<span class="ident" id="4023554">nil</span>&nbsp;<span class="op" id="4023558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023574">if</span>&nbsp;<span class="builtinfunc" id="4023577">len</span><span class="op" id="4023580">(</span><span class="ident" id="4023581"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023585">.</span><span class="ident" id="4023586">DNSName</span><span class="op" id="4023593">)</span>&nbsp;<span class="op" id="4023595">&gt;</span>&nbsp;<span class="num" id="4023597">0</span>&nbsp;<span class="op" id="4023599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023603"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023607">=</span>&nbsp;<span class="ident" id="4023609"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4023610">.</span><span class="ident" id="4023611">VerifyHostname</span><span class="op" id="4023625">(</span><span class="ident" id="4023626"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023630">.</span><span class="ident" id="4023631">DNSName</span><span class="op" id="4023638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023642">if</span>&nbsp;<span class="ident" id="4023645"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023649">!=</span>&nbsp;<span class="ident" id="4023652">nil</span>&nbsp;<span class="op" id="4023656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023670">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023677">candidateChains</span><span class="op" id="4023692">,</span>&nbsp;<span class="ident" id="4023694"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023698">:=</span>&nbsp;<span class="ident" id="4023701"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4023702">.</span><span class="ident" id="4023703">buildChains</span><span class="op" id="4023714">(</span><span class="builtinfunc" id="4023715">make</span><span class="op" id="4023719">(</span><span class="keyword" id="4023720">map</span><span class="op" id="4023723">[</span><span class="builtintype" id="4023724">int</span><span class="op" id="4023727">]</span><span class="op" id="4023728">[</span><span class="op" id="4023729">]</span><span class="op" id="4023730">[</span><span class="op" id="4023731">]</span><span class="op" id="4023732">*</span><span class="ident" id="4023733"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4023744">)</span><span class="op" id="4023745">,</span>&nbsp;<span class="op" id="4023747">[</span><span class="op" id="4023748">]</span><span class="op" id="4023749">*</span><span class="ident" id="4023750"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4023761">{</span><span class="ident" id="4023762"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4023763">}</span><span class="op" id="4023764">,</span>&nbsp;<span class="op" id="4023766">&amp;</span><span class="ident" id="4023767"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023774">if</span>&nbsp;<span class="ident" id="4023777"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4023781">!=</span>&nbsp;<span class="ident" id="4023784">nil</span>&nbsp;<span class="op" id="4023788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023792">return</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023804">keyUsages</span>&nbsp;<span class="op" id="4023814">:=</span>&nbsp;<span class="ident" id="4023817"><a href="/crypto/x509/verify.go.html#4023171">opts</a></span><span class="op" id="4023821">.</span><span class="ident" id="4023822">KeyUsages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023833">if</span>&nbsp;<span class="builtinfunc" id="4023836">len</span><span class="op" id="4023839">(</span><span class="ident" id="4023840"><a href="/crypto/x509/verify.go.html#4023804">keyUsages</a></span><span class="op" id="4023849">)</span>&nbsp;<span class="op" id="4023851">==</span>&nbsp;<span class="num" id="4023854">0</span>&nbsp;<span class="op" id="4023856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023860"><a href="/crypto/x509/verify.go.html#4023804">keyUsages</a></span>&nbsp;<span class="op" id="4023870">=</span>&nbsp;<span class="op" id="4023872">[</span><span class="op" id="4023873">]</span><span class="ident" id="4023874"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="4023885">{</span><span class="ident" id="4023886"><a href="/crypto/x509/x509.go.html#4042581">ExtKeyUsageServerAuth</a></span><span class="op" id="4023907">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023914">//&nbsp;If&nbsp;any&nbsp;key&nbsp;usage&nbsp;is&nbsp;acceptable&nbsp;then&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023966">for</span>&nbsp;<span class="ident" id="4023970">_</span><span class="op" id="4023971">,</span>&nbsp;<span class="ident" id="4023973">usage</span>&nbsp;<span class="op" id="4023979">:=</span>&nbsp;<span class="keyword" id="4023982">range</span>&nbsp;<span class="ident" id="4023988"><a href="/crypto/x509/verify.go.html#4023804">keyUsages</a></span>&nbsp;<span class="op" id="4023998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024002">if</span>&nbsp;<span class="ident" id="4024005"><a href="/crypto/x509/verify.go.html#4023973">usage</a></span>&nbsp;<span class="op" id="4024011">==</span>&nbsp;<span class="ident" id="4024014"><a href="/crypto/x509/x509.go.html#4042546">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4024029">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024034"><a href="/crypto/x509/verify.go.html#4023192">chains</a></span>&nbsp;<span class="op" id="4024041">=</span>&nbsp;<span class="ident" id="4024043"><a href="/crypto/x509/verify.go.html#4023677">candidateChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024078">for</span>&nbsp;<span class="ident" id="4024082">_</span><span class="op" id="4024083">,</span>&nbsp;<span class="ident" id="4024085">candidate</span>&nbsp;<span class="op" id="4024095">:=</span>&nbsp;<span class="keyword" id="4024098">range</span>&nbsp;<span class="ident" id="4024104"><a href="/crypto/x509/verify.go.html#4023677">candidateChains</a></span>&nbsp;<span class="op" id="4024120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024124">if</span>&nbsp;<span class="ident" id="4024127"><a href="/crypto/x509/verify.go.html#4028167">checkChainForKeyUsage</a></span><span class="op" id="4024148">(</span><span class="ident" id="4024149"><a href="/crypto/x509/verify.go.html#4024085">candidate</a></span><span class="op" id="4024158">,</span>&nbsp;<span class="ident" id="4024160"><a href="/crypto/x509/verify.go.html#4023804">keyUsages</a></span><span class="op" id="4024169">)</span>&nbsp;<span class="op" id="4024171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024176"><a href="/crypto/x509/verify.go.html#4023192">chains</a></span>&nbsp;<span class="op" id="4024183">=</span>&nbsp;<span class="builtinfunc" id="4024185">append</span><span class="op" id="4024191">(</span><span class="ident" id="4024192"><a href="/crypto/x509/verify.go.html#4023192">chains</a></span><span class="op" id="4024198">,</span>&nbsp;<span class="ident" id="4024200"><a href="/crypto/x509/verify.go.html#4024085">candidate</a></span><span class="op" id="4024209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024216">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024220">if</span>&nbsp;<span class="builtinfunc" id="4024223">len</span><span class="op" id="4024226">(</span><span class="ident" id="4024227"><a href="/crypto/x509/verify.go.html#4023192">chains</a></span><span class="op" id="4024233">)</span>&nbsp;<span class="op" id="4024235">==</span>&nbsp;<span class="num" id="4024238">0</span>&nbsp;<span class="op" id="4024240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024244"><a href="/crypto/x509/verify.go.html#4023217">err</a></span>&nbsp;<span class="op" id="4024248">=</span>&nbsp;<span class="ident" id="4024250"><a href="/crypto/x509/verify.go.html#4017190">CertificateInvalidError</a></span><span class="op" id="4024273">{</span><span class="ident" id="4024274"><a href="/crypto/x509/verify.go.html#4023148">c</a></span><span class="op" id="4024275">,</span>&nbsp;<span class="ident" id="4024277"><a href="/crypto/x509/verify.go.html#4017026">IncompatibleUsage</a></span><span class="op" id="4024294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024301">return</span><br>
<span class="lineno"></span><span class="op" id="4024308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024311">func</span>&nbsp;<span class="ident" id="4024316">appendToFreshChain</span><span class="op" id="4024334">(</span><span class="ident" id="4024335">chain</span>&nbsp;<span class="op" id="4024341">[</span><span class="op" id="4024342">]</span><span class="op" id="4024343">*</span><span class="ident" id="4024344"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024355">,</span>&nbsp;<span class="ident" id="4024357">cert</span>&nbsp;<span class="op" id="4024362">*</span><span class="ident" id="4024363"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024374">)</span>&nbsp;<span class="op" id="4024376">[</span><span class="op" id="4024377">]</span><span class="op" id="4024378">*</span><span class="ident" id="4024379"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span>&nbsp;<span class="op" id="4024391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024394">n</span>&nbsp;<span class="op" id="4024396">:=</span>&nbsp;<span class="builtinfunc" id="4024399">make</span><span class="op" id="4024403">(</span><span class="op" id="4024404">[</span><span class="op" id="4024405">]</span><span class="op" id="4024406">*</span><span class="ident" id="4024407"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024418">,</span>&nbsp;<span class="builtinfunc" id="4024420">len</span><span class="op" id="4024423">(</span><span class="ident" id="4024424"><a href="/crypto/x509/verify.go.html#4024335">chain</a></span><span class="op" id="4024429">)</span><span class="op" id="4024430">+</span><span class="num" id="4024431">1</span><span class="op" id="4024432">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4024435">copy</span><span class="op" id="4024439">(</span><span class="ident" id="4024440"><a href="/crypto/x509/verify.go.html#4024394">n</a></span><span class="op" id="4024441">,</span>&nbsp;<span class="ident" id="4024443"><a href="/crypto/x509/verify.go.html#4024335">chain</a></span><span class="op" id="4024448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024451"><a href="/crypto/x509/verify.go.html#4024394">n</a></span><span class="op" id="4024452">[</span><span class="builtinfunc" id="4024453">len</span><span class="op" id="4024456">(</span><span class="ident" id="4024457"><a href="/crypto/x509/verify.go.html#4024335">chain</a></span><span class="op" id="4024462">)</span><span class="op" id="4024463">]</span>&nbsp;<span class="op" id="4024465">=</span>&nbsp;<span class="ident" id="4024467"><a href="/crypto/x509/verify.go.html#4024357">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024473">return</span>&nbsp;<span class="ident" id="4024480"><a href="/crypto/x509/verify.go.html#4024394">n</a></span><br>
<span class="lineno"></span><span class="op" id="4024482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="4024485">func</span>&nbsp;<span class="op" id="4024490">(</span><span class="ident" id="4024491">c</span>&nbsp;<span class="op" id="4024493">*</span><span class="ident" id="4024494"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024505">)</span>&nbsp;<span class="ident" id="4024507">buildChains</span><span class="op" id="4024518">(</span><span class="ident" id="4024519">cache</span>&nbsp;<span class="keyword" id="4024525">map</span><span class="op" id="4024528">[</span><span class="builtintype" id="4024529">int</span><span class="op" id="4024532">]</span><span class="op" id="4024533">[</span><span class="op" id="4024534">]</span><span class="op" id="4024535">[</span><span class="op" id="4024536">]</span><span class="op" id="4024537">*</span><span class="ident" id="4024538"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024549">,</span>&nbsp;<span class="ident" id="4024551">currentChain</span>&nbsp;<span class="op" id="4024564">[</span><span class="op" id="4024565">]</span><span class="op" id="4024566">*</span><span class="ident" id="4024567"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024578">,</span>&nbsp;<span class="ident" id="4024580">opts</span>&nbsp;<span class="op" id="4024585">*</span><span class="ident" id="4024586"><a href="/crypto/x509/verify.go.html#4019904">VerifyOptions</a></span><span class="op" id="4024599">)</span>&nbsp;<span class="op" id="4024601">(</span><span class="ident" id="4024602">chains</span>&nbsp;<span class="op" id="4024609">[</span><span class="op" id="4024610">]</span><span class="op" id="4024611">[</span><span class="op" id="4024612">]</span><span class="op" id="4024613">*</span><span class="ident" id="4024614"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4024625">,</span>&nbsp;<span class="ident" id="4024627">err</span>&nbsp;<span class="builtintype" id="4024631">error</span><span class="op" id="4024636">)</span>&nbsp;<span class="op" id="4024638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024641">possibleRoots</span><span class="op" id="4024654">,</span>&nbsp;<span class="ident" id="4024656">failedRoot</span><span class="op" id="4024666">,</span>&nbsp;<span class="ident" id="4024668">rootErr</span>&nbsp;<span class="op" id="4024676">:=</span>&nbsp;<span class="ident" id="4024679"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4024683">.</span><span class="ident" id="4024684">Roots</span><span class="op" id="4024689">.</span><span class="ident" id="4024690">findVerifiedParents</span><span class="op" id="4024709">(</span><span class="ident" id="4024710"><a href="/crypto/x509/verify.go.html#4024491">c</a></span><span class="op" id="4024711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024714">for</span>&nbsp;<span class="ident" id="4024718">_</span><span class="op" id="4024719">,</span>&nbsp;<span class="ident" id="4024721">rootNum</span>&nbsp;<span class="op" id="4024729">:=</span>&nbsp;<span class="keyword" id="4024732">range</span>&nbsp;<span class="ident" id="4024738"><a href="/crypto/x509/verify.go.html#4024641">possibleRoots</a></span>&nbsp;<span class="op" id="4024752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024756">root</span>&nbsp;<span class="op" id="4024761">:=</span>&nbsp;<span class="ident" id="4024764"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4024768">.</span><span class="ident" id="4024769">Roots</span><span class="op" id="4024774">.</span><span class="ident" id="4024775">certs</span><span class="op" id="4024780">[</span><span class="ident" id="4024781"><a href="/crypto/x509/verify.go.html#4024721">rootNum</a></span><span class="op" id="4024788">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024792"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4024796">=</span>&nbsp;<span class="ident" id="4024798"><a href="/crypto/x509/verify.go.html#4024756">root</a></span><span class="op" id="4024802">.</span><span class="ident" id="4024803">isValid</span><span class="op" id="4024810">(</span><span class="ident" id="4024811"><a href="/crypto/x509/verify.go.html#4020472">rootCertificate</a></span><span class="op" id="4024826">,</span>&nbsp;<span class="ident" id="4024828"><a href="/crypto/x509/verify.go.html#4024551">currentChain</a></span><span class="op" id="4024840">,</span>&nbsp;<span class="ident" id="4024842"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4024846">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024850">if</span>&nbsp;<span class="ident" id="4024853"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4024857">!=</span>&nbsp;<span class="ident" id="4024860">nil</span>&nbsp;<span class="op" id="4024864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024884"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span>&nbsp;<span class="op" id="4024891">=</span>&nbsp;<span class="builtinfunc" id="4024893">append</span><span class="op" id="4024899">(</span><span class="ident" id="4024900"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span><span class="op" id="4024906">,</span>&nbsp;<span class="ident" id="4024908"><a href="/crypto/x509/verify.go.html#4024316">appendToFreshChain</a></span><span class="op" id="4024926">(</span><span class="ident" id="4024927"><a href="/crypto/x509/verify.go.html#4024551">currentChain</a></span><span class="op" id="4024939">,</span>&nbsp;<span class="ident" id="4024941"><a href="/crypto/x509/verify.go.html#4024756">root</a></span><span class="op" id="4024945">)</span><span class="op" id="4024946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024949">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024953">possibleIntermediates</span><span class="op" id="4024974">,</span>&nbsp;<span class="ident" id="4024976">failedIntermediate</span><span class="op" id="4024994">,</span>&nbsp;<span class="ident" id="4024996">intermediateErr</span>&nbsp;<span class="op" id="4025012">:=</span>&nbsp;<span class="ident" id="4025015"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4025019">.</span><span class="ident" id="4025020">Intermediates</span><span class="op" id="4025033">.</span><span class="ident" id="4025034">findVerifiedParents</span><span class="op" id="4025053">(</span><span class="ident" id="4025054"><a href="/crypto/x509/verify.go.html#4024491">c</a></span><span class="op" id="4025055">)</span><br>
<span class="lineno"></span><span class="ident" id="4025057">nextIntermediate</span><span class="op" id="4025073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025076">for</span>&nbsp;<span class="ident" id="4025080">_</span><span class="op" id="4025081">,</span>&nbsp;<span class="ident" id="4025083">intermediateNum</span>&nbsp;<span class="op" id="4025099">:=</span>&nbsp;<span class="keyword" id="4025102">range</span>&nbsp;<span class="ident" id="4025108"><a href="/crypto/x509/verify.go.html#4024953">possibleIntermediates</a></span>&nbsp;<span class="op" id="4025130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025134">intermediate</span>&nbsp;<span class="op" id="4025147">:=</span>&nbsp;<span class="ident" id="4025150"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4025154">.</span><span class="ident" id="4025155">Intermediates</span><span class="op" id="4025168">.</span><span class="ident" id="4025169">certs</span><span class="op" id="4025174">[</span><span class="ident" id="4025175"><a href="/crypto/x509/verify.go.html#4025083">intermediateNum</a></span><span class="op" id="4025190">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025194">for</span>&nbsp;<span class="ident" id="4025198">_</span><span class="op" id="4025199">,</span>&nbsp;<span class="ident" id="4025201">cert</span>&nbsp;<span class="op" id="4025206">:=</span>&nbsp;<span class="keyword" id="4025209">range</span>&nbsp;<span class="ident" id="4025215"><a href="/crypto/x509/verify.go.html#4024551">currentChain</a></span>&nbsp;<span class="op" id="4025228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025233">if</span>&nbsp;<span class="ident" id="4025236"><a href="/crypto/x509/verify.go.html#4025201">cert</a></span>&nbsp;<span class="op" id="4025241">==</span>&nbsp;<span class="ident" id="4025244"><a href="/crypto/x509/verify.go.html#4025134">intermediate</a></span>&nbsp;<span class="op" id="4025257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025263">continue</span>&nbsp;<span class="ident" id="4025272">nextIntermediate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025296">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025300"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025304">=</span>&nbsp;<span class="ident" id="4025306"><a href="/crypto/x509/verify.go.html#4025134">intermediate</a></span><span class="op" id="4025318">.</span><span class="ident" id="4025319">isValid</span><span class="op" id="4025326">(</span><span class="ident" id="4025327"><a href="/crypto/x509/verify.go.html#4020447">intermediateCertificate</a></span><span class="op" id="4025350">,</span>&nbsp;<span class="ident" id="4025352"><a href="/crypto/x509/verify.go.html#4024551">currentChain</a></span><span class="op" id="4025364">,</span>&nbsp;<span class="ident" id="4025366"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4025370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025374">if</span>&nbsp;<span class="ident" id="4025377"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025381">!=</span>&nbsp;<span class="ident" id="4025384">nil</span>&nbsp;<span class="op" id="4025388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025393">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025408">var</span>&nbsp;<span class="ident" id="4025412">childChains</span>&nbsp;<span class="op" id="4025424">[</span><span class="op" id="4025425">]</span><span class="op" id="4025426">[</span><span class="op" id="4025427">]</span><span class="op" id="4025428">*</span><span class="ident" id="4025429"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025443"><a href="/crypto/x509/verify.go.html#4025412">childChains</a></span><span class="op" id="4025454">,</span>&nbsp;<span class="ident" id="4025456">ok</span>&nbsp;<span class="op" id="4025459">:=</span>&nbsp;<span class="ident" id="4025462"><a href="/crypto/x509/verify.go.html#4024519">cache</a></span><span class="op" id="4025467">[</span><span class="ident" id="4025468"><a href="/crypto/x509/verify.go.html#4025083">intermediateNum</a></span><span class="op" id="4025483">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025487">if</span>&nbsp;<span class="op" id="4025490">!</span><span class="ident" id="4025491"><a href="/crypto/x509/verify.go.html#4025456">ok</a></span>&nbsp;<span class="op" id="4025494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025499"><a href="/crypto/x509/verify.go.html#4025412">childChains</a></span><span class="op" id="4025510">,</span>&nbsp;<span class="ident" id="4025512"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025516">=</span>&nbsp;<span class="ident" id="4025518"><a href="/crypto/x509/verify.go.html#4025134">intermediate</a></span><span class="op" id="4025530">.</span><span class="ident" id="4025531">buildChains</span><span class="op" id="4025542">(</span><span class="ident" id="4025543"><a href="/crypto/x509/verify.go.html#4024519">cache</a></span><span class="op" id="4025548">,</span>&nbsp;<span class="ident" id="4025550"><a href="/crypto/x509/verify.go.html#4024316">appendToFreshChain</a></span><span class="op" id="4025568">(</span><span class="ident" id="4025569"><a href="/crypto/x509/verify.go.html#4024551">currentChain</a></span><span class="op" id="4025581">,</span>&nbsp;<span class="ident" id="4025583"><a href="/crypto/x509/verify.go.html#4025134">intermediate</a></span><span class="op" id="4025595">)</span><span class="op" id="4025596">,</span>&nbsp;<span class="ident" id="4025598"><a href="/crypto/x509/verify.go.html#4024580">opts</a></span><span class="op" id="4025602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025607"><a href="/crypto/x509/verify.go.html#4024519">cache</a></span><span class="op" id="4025612">[</span><span class="ident" id="4025613"><a href="/crypto/x509/verify.go.html#4025083">intermediateNum</a></span><span class="op" id="4025628">]</span>&nbsp;<span class="op" id="4025630">=</span>&nbsp;<span class="ident" id="4025632"><a href="/crypto/x509/verify.go.html#4025412">childChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025646">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025650"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span>&nbsp;<span class="op" id="4025657">=</span>&nbsp;<span class="builtinfunc" id="4025659">append</span><span class="op" id="4025665">(</span><span class="ident" id="4025666"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span><span class="op" id="4025672">,</span>&nbsp;<span class="ident" id="4025674"><a href="/crypto/x509/verify.go.html#4025412">childChains</a></span><span class="op" id="4025685">...</span><span class="op" id="4025688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025695">if</span>&nbsp;<span class="builtinfunc" id="4025698">len</span><span class="op" id="4025701">(</span><span class="ident" id="4025702"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span><span class="op" id="4025708">)</span>&nbsp;<span class="op" id="4025710">&gt;</span>&nbsp;<span class="num" id="4025712">0</span>&nbsp;<span class="op" id="4025714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025718"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025722">=</span>&nbsp;<span class="ident" id="4025724">nil</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025733">if</span>&nbsp;<span class="builtinfunc" id="4025736">len</span><span class="op" id="4025739">(</span><span class="ident" id="4025740"><a href="/crypto/x509/verify.go.html#4024602">chains</a></span><span class="op" id="4025746">)</span>&nbsp;<span class="op" id="4025748">==</span>&nbsp;<span class="num" id="4025751">0</span>&nbsp;<span class="op" id="4025753">&amp;&amp;</span>&nbsp;<span class="ident" id="4025756"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025760">==</span>&nbsp;<span class="ident" id="4025763">nil</span>&nbsp;<span class="op" id="4025767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025771">hintErr</span>&nbsp;<span class="op" id="4025779">:=</span>&nbsp;<span class="ident" id="4025782"><a href="/crypto/x509/verify.go.html#4024668">rootErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025792">hintCert</span>&nbsp;<span class="op" id="4025801">:=</span>&nbsp;<span class="ident" id="4025804"><a href="/crypto/x509/verify.go.html#4024656">failedRoot</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025817">if</span>&nbsp;<span class="ident" id="4025820"><a href="/crypto/x509/verify.go.html#4025771">hintErr</a></span>&nbsp;<span class="op" id="4025828">==</span>&nbsp;<span class="ident" id="4025831">nil</span>&nbsp;<span class="op" id="4025835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025840"><a href="/crypto/x509/verify.go.html#4025771">hintErr</a></span>&nbsp;<span class="op" id="4025848">=</span>&nbsp;<span class="ident" id="4025850"><a href="/crypto/x509/verify.go.html#4024996">intermediateErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025869"><a href="/crypto/x509/verify.go.html#4025792">hintCert</a></span>&nbsp;<span class="op" id="4025878">=</span>&nbsp;<span class="ident" id="4025880"><a href="/crypto/x509/verify.go.html#4024976">failedIntermediate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025905"><a href="/crypto/x509/verify.go.html#4024627">err</a></span>&nbsp;<span class="op" id="4025909">=</span>&nbsp;<span class="ident" id="4025911"><a href="/crypto/x509/verify.go.html#4018718">UnknownAuthorityError</a></span><span class="op" id="4025932">{</span><span class="ident" id="4025933"><a href="/crypto/x509/verify.go.html#4024491">c</a></span><span class="op" id="4025934">,</span>&nbsp;<span class="ident" id="4025936"><a href="/crypto/x509/verify.go.html#4025771">hintErr</a></span><span class="op" id="4025943">,</span>&nbsp;<span class="ident" id="4025945"><a href="/crypto/x509/verify.go.html#4025792">hintCert</a></span><span class="op" id="4025953">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025960">return</span><br>
<span class="lineno"></span><span class="op" id="4025967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="4025970">func</span>&nbsp;<span class="ident" id="4025975">matchHostnames</span><span class="op" id="4025989">(</span><span class="ident" id="4025990">pattern</span><span class="op" id="4025997">,</span>&nbsp;<span class="ident" id="4025999">host</span>&nbsp;<span class="builtintype" id="4026004">string</span><span class="op" id="4026010">)</span>&nbsp;<span class="builtintype" id="4026012">bool</span>&nbsp;<span class="op" id="4026017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026020">if</span>&nbsp;<span class="builtinfunc" id="4026023">len</span><span class="op" id="4026026">(</span><span class="ident" id="4026027"><a href="/crypto/x509/verify.go.html#4025990">pattern</a></span><span class="op" id="4026034">)</span>&nbsp;<span class="op" id="4026036">==</span>&nbsp;<span class="num" id="4026039">0</span>&nbsp;<span class="op" id="4026041">||</span>&nbsp;<span class="builtinfunc" id="4026044">len</span><span class="op" id="4026047">(</span><span class="ident" id="4026048"><a href="/crypto/x509/verify.go.html#4025999">host</a></span><span class="op" id="4026052">)</span>&nbsp;<span class="op" id="4026054">==</span>&nbsp;<span class="num" id="4026057">0</span>&nbsp;<span class="op" id="4026059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026063">return</span>&nbsp;<span class="builtintype" id="4026070">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026081">patternParts</span>&nbsp;<span class="op" id="4026094">:=</span>&nbsp;<span class="ident" id="4026097"><a href="/crypto/x509/verify.go.html#4016274">strings</a></span><span class="op" id="4026104">.</span><span class="ident" id="4026105">Split</span><span class="op" id="4026110">(</span><span class="ident" id="4026111"><a href="/crypto/x509/verify.go.html#4025990">pattern</a></span><span class="op" id="4026118">,</span>&nbsp;<span class="string" id="4026120">&#34;.&#34;</span><span class="op" id="4026123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026126">hostParts</span>&nbsp;<span class="op" id="4026136">:=</span>&nbsp;<span class="ident" id="4026139"><a href="/crypto/x509/verify.go.html#4016274">strings</a></span><span class="op" id="4026146">.</span><span class="ident" id="4026147">Split</span><span class="op" id="4026152">(</span><span class="ident" id="4026153"><a href="/crypto/x509/verify.go.html#4025999">host</a></span><span class="op" id="4026157">,</span>&nbsp;<span class="string" id="4026159">&#34;.&#34;</span><span class="op" id="4026162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026166">if</span>&nbsp;<span class="builtinfunc" id="4026169">len</span><span class="op" id="4026172">(</span><span class="ident" id="4026173"><a href="/crypto/x509/verify.go.html#4026081">patternParts</a></span><span class="op" id="4026185">)</span>&nbsp;<span class="op" id="4026187">!=</span>&nbsp;<span class="builtinfunc" id="4026190">len</span><span class="op" id="4026193">(</span><span class="ident" id="4026194"><a href="/crypto/x509/verify.go.html#4026126">hostParts</a></span><span class="op" id="4026203">)</span>&nbsp;<span class="op" id="4026205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026209">return</span>&nbsp;<span class="builtintype" id="4026216">false</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026227">for</span>&nbsp;<span class="ident" id="4026231">i</span><span class="op" id="4026232">,</span>&nbsp;<span class="ident" id="4026234">patternPart</span>&nbsp;<span class="op" id="4026246">:=</span>&nbsp;<span class="keyword" id="4026249">range</span>&nbsp;<span class="ident" id="4026255"><a href="/crypto/x509/verify.go.html#4026081">patternParts</a></span>&nbsp;<span class="op" id="4026268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026272">if</span>&nbsp;<span class="ident" id="4026275"><a href="/crypto/x509/verify.go.html#4026234">patternPart</a></span>&nbsp;<span class="op" id="4026287">==</span>&nbsp;<span class="string" id="4026290">&#34;*&#34;</span>&nbsp;<span class="op" id="4026294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026299">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026314">if</span>&nbsp;<span class="ident" id="4026317"><a href="/crypto/x509/verify.go.html#4026234">patternPart</a></span>&nbsp;<span class="op" id="4026329">!=</span>&nbsp;<span class="ident" id="4026332"><a href="/crypto/x509/verify.go.html#4026126">hostParts</a></span><span class="op" id="4026341">[</span><span class="ident" id="4026342"><a href="/crypto/x509/verify.go.html#4026231">i</a></span><span class="op" id="4026343">]</span>&nbsp;<span class="op" id="4026345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026350">return</span>&nbsp;<span class="builtintype" id="4026357">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026368">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026372">return</span>&nbsp;<span class="builtintype" id="4026379">true</span><br>
<span class="lineno"></span><span class="op" id="4026384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4026387">//&nbsp;toLowerCaseASCII&nbsp;returns&nbsp;a&nbsp;lower-case&nbsp;version&nbsp;of&nbsp;in.&nbsp;See&nbsp;RFC&nbsp;6125&nbsp;6.4.1.&nbsp;We&nbsp;use</span><br>
<span class="lineno">350</span><span class="comment" id="4026470">//&nbsp;an&nbsp;explicitly&nbsp;ASCII&nbsp;function&nbsp;to&nbsp;avoid&nbsp;any&nbsp;sharp&nbsp;corners&nbsp;resulting&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4026544">//&nbsp;performing&nbsp;Unicode&nbsp;operations&nbsp;on&nbsp;DNS&nbsp;labels.</span><br>
<span class="lineno"></span><span class="keyword" id="4026592">func</span>&nbsp;<span class="ident" id="4026597">toLowerCaseASCII</span><span class="op" id="4026613">(</span><span class="ident" id="4026614">in</span>&nbsp;<span class="builtintype" id="4026617">string</span><span class="op" id="4026623">)</span>&nbsp;<span class="builtintype" id="4026625">string</span>&nbsp;<span class="op" id="4026632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4026635">//&nbsp;If&nbsp;the&nbsp;string&nbsp;is&nbsp;already&nbsp;lower-case&nbsp;then&nbsp;there&#39;s&nbsp;nothing&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026703">isAlreadyLowerCase</span>&nbsp;<span class="op" id="4026722">:=</span>&nbsp;<span class="builtintype" id="4026725">true</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026731">for</span>&nbsp;<span class="ident" id="4026735">_</span><span class="op" id="4026736">,</span>&nbsp;<span class="ident" id="4026738">c</span>&nbsp;<span class="op" id="4026740">:=</span>&nbsp;<span class="keyword" id="4026743">range</span>&nbsp;<span class="ident" id="4026749"><a href="/crypto/x509/verify.go.html#4026614">in</a></span>&nbsp;<span class="op" id="4026752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026756">if</span>&nbsp;<span class="ident" id="4026759"><a href="/crypto/x509/verify.go.html#4026738">c</a></span>&nbsp;<span class="op" id="4026761">==</span>&nbsp;<span class="ident" id="4026764"><a href="/crypto/x509/verify.go.html#4016293">utf8</a></span><span class="op" id="4026768">.</span><span class="ident" id="4026769">RuneError</span>&nbsp;<span class="op" id="4026779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4026784">//&nbsp;If&nbsp;we&nbsp;get&nbsp;a&nbsp;UTF-8&nbsp;error&nbsp;then&nbsp;there&nbsp;might&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4026834">//&nbsp;upper-case&nbsp;ASCII&nbsp;bytes&nbsp;in&nbsp;the&nbsp;invalid&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026888"><a href="/crypto/x509/verify.go.html#4026703">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4026907">=</span>&nbsp;<span class="builtintype" id="4026909">false</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026918">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026930">if</span>&nbsp;<span class="string" id="4026933">&#39;A&#39;</span>&nbsp;<span class="op" id="4026937">&lt;=</span>&nbsp;<span class="ident" id="4026940"><a href="/crypto/x509/verify.go.html#4026738">c</a></span>&nbsp;<span class="op" id="4026942">&amp;&amp;</span>&nbsp;<span class="ident" id="4026945"><a href="/crypto/x509/verify.go.html#4026738">c</a></span>&nbsp;<span class="op" id="4026947">&lt;=</span>&nbsp;<span class="string" id="4026950">&#39;Z&#39;</span>&nbsp;<span class="op" id="4026954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026959"><a href="/crypto/x509/verify.go.html#4026703">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4026978">=</span>&nbsp;<span class="builtintype" id="4026980">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026989">break</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027004">if</span>&nbsp;<span class="ident" id="4027007"><a href="/crypto/x509/verify.go.html#4026703">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4027026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027030">return</span>&nbsp;<span class="ident" id="4027037"><a href="/crypto/x509/verify.go.html#4026614">in</a></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027045">out</span>&nbsp;<span class="op" id="4027049">:=</span>&nbsp;<span class="op" id="4027052">[</span><span class="op" id="4027053">]</span><span class="builtintype" id="4027054">byte</span><span class="op" id="4027058">(</span><span class="ident" id="4027059"><a href="/crypto/x509/verify.go.html#4026614">in</a></span><span class="op" id="4027061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027064">for</span>&nbsp;<span class="ident" id="4027068">i</span><span class="op" id="4027069">,</span>&nbsp;<span class="ident" id="4027071">c</span>&nbsp;<span class="op" id="4027073">:=</span>&nbsp;<span class="keyword" id="4027076">range</span>&nbsp;<span class="ident" id="4027082"><a href="/crypto/x509/verify.go.html#4027045">out</a></span>&nbsp;<span class="op" id="4027086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027090">if</span>&nbsp;<span class="string" id="4027093">&#39;A&#39;</span>&nbsp;<span class="op" id="4027097">&lt;=</span>&nbsp;<span class="ident" id="4027100"><a href="/crypto/x509/verify.go.html#4027071">c</a></span>&nbsp;<span class="op" id="4027102">&amp;&amp;</span>&nbsp;<span class="ident" id="4027105"><a href="/crypto/x509/verify.go.html#4027071">c</a></span>&nbsp;<span class="op" id="4027107">&lt;=</span>&nbsp;<span class="string" id="4027110">&#39;Z&#39;</span>&nbsp;<span class="op" id="4027114">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027119"><a href="/crypto/x509/verify.go.html#4027045">out</a></span><span class="op" id="4027122">[</span><span class="ident" id="4027123"><a href="/crypto/x509/verify.go.html#4027068">i</a></span><span class="op" id="4027124">]</span>&nbsp;<span class="op" id="4027126">+=</span>&nbsp;<span class="string" id="4027129">&#39;a&#39;</span>&nbsp;<span class="op" id="4027133">-</span>&nbsp;<span class="string" id="4027135">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027147">return</span>&nbsp;<span class="builtintype" id="4027154">string</span><span class="op" id="4027160">(</span><span class="ident" id="4027161"><a href="/crypto/x509/verify.go.html#4027045">out</a></span><span class="op" id="4027164">)</span><br>
<span class="lineno"></span><span class="op" id="4027166">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="comment" id="4027169">//&nbsp;VerifyHostname&nbsp;returns&nbsp;nil&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;certificate&nbsp;for&nbsp;the&nbsp;named&nbsp;host.</span><br>
<span class="lineno"></span><span class="comment" id="4027247">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;an&nbsp;error&nbsp;describing&nbsp;the&nbsp;mismatch.</span><br>
<span class="lineno"></span><span class="keyword" id="4027305">func</span>&nbsp;<span class="op" id="4027310">(</span><span class="ident" id="4027311">c</span>&nbsp;<span class="op" id="4027313">*</span><span class="ident" id="4027314"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4027325">)</span>&nbsp;<span class="ident" id="4027327">VerifyHostname</span><span class="op" id="4027341">(</span><span class="ident" id="4027342">h</span>&nbsp;<span class="builtintype" id="4027344">string</span><span class="op" id="4027350">)</span>&nbsp;<span class="builtintype" id="4027352">error</span>&nbsp;<span class="op" id="4027358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027361">//&nbsp;IP&nbsp;addresses&nbsp;may&nbsp;be&nbsp;written&nbsp;in&nbsp;[&nbsp;].</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027401">candidateIP</span>&nbsp;<span class="op" id="4027413">:=</span>&nbsp;<span class="ident" id="4027416"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027419">if</span>&nbsp;<span class="builtinfunc" id="4027422">len</span><span class="op" id="4027425">(</span><span class="ident" id="4027426"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027427">)</span>&nbsp;<span class="op" id="4027429">&gt;=</span>&nbsp;<span class="num" id="4027432">3</span>&nbsp;<span class="op" id="4027434">&amp;&amp;</span>&nbsp;<span class="ident" id="4027437"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027438">[</span><span class="num" id="4027439">0</span><span class="op" id="4027440">]</span>&nbsp;<span class="op" id="4027442">==</span>&nbsp;<span class="string" id="4027445">&#39;[&#39;</span>&nbsp;<span class="op" id="4027449">&amp;&amp;</span>&nbsp;<span class="ident" id="4027452"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027453">[</span><span class="builtinfunc" id="4027454">len</span><span class="op" id="4027457">(</span><span class="ident" id="4027458"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027459">)</span><span class="op" id="4027460">-</span><span class="num" id="4027461">1</span><span class="op" id="4027462">]</span>&nbsp;<span class="op" id="4027464">==</span>&nbsp;<span class="string" id="4027467">&#39;]&#39;</span>&nbsp;<span class="op" id="4027471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027475"><a href="/crypto/x509/verify.go.html#4027401">candidateIP</a></span>&nbsp;<span class="op" id="4027487">=</span>&nbsp;<span class="ident" id="4027489"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027490">[</span><span class="num" id="4027491">1</span>&nbsp;<span class="op" id="4027493">:</span>&nbsp;<span class="builtinfunc" id="4027495">len</span><span class="op" id="4027498">(</span><span class="ident" id="4027499"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027500">)</span><span class="op" id="4027501">-</span><span class="num" id="4027502">1</span><span class="op" id="4027503">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027509">if</span>&nbsp;<span class="ident" id="4027512">ip</span>&nbsp;<span class="op" id="4027515">:=</span>&nbsp;<span class="ident" id="4027518"><a href="/crypto/x509/verify.go.html#4016256">net</a></span><span class="op" id="4027521">.</span><span class="ident" id="4027522">ParseIP</span><span class="op" id="4027529">(</span><span class="ident" id="4027530"><a href="/crypto/x509/verify.go.html#4027401">candidateIP</a></span><span class="op" id="4027541">)</span><span class="op" id="4027542">;</span>&nbsp;<span class="ident" id="4027544"><a href="/crypto/x509/verify.go.html#4027512">ip</a></span>&nbsp;<span class="op" id="4027547">!=</span>&nbsp;<span class="ident" id="4027550">nil</span>&nbsp;<span class="op" id="4027554">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027558">//&nbsp;We&nbsp;only&nbsp;match&nbsp;IP&nbsp;addresses&nbsp;against&nbsp;IP&nbsp;SANs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027607">//&nbsp;https://tools.ietf.org/html/rfc6125#appendix-B.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027661">for</span>&nbsp;<span class="ident" id="4027665">_</span><span class="op" id="4027666">,</span>&nbsp;<span class="ident" id="4027668">candidate</span>&nbsp;<span class="op" id="4027678">:=</span>&nbsp;<span class="keyword" id="4027681">range</span>&nbsp;<span class="ident" id="4027687"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4027688">.</span><span class="ident" id="4027689">IPAddresses</span>&nbsp;<span class="op" id="4027701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027706">if</span>&nbsp;<span class="ident" id="4027709"><a href="/crypto/x509/verify.go.html#4027512">ip</a></span><span class="op" id="4027711">.</span><span class="ident" id="4027712">Equal</span><span class="op" id="4027717">(</span><span class="ident" id="4027718"><a href="/crypto/x509/verify.go.html#4027668">candidate</a></span><span class="op" id="4027727">)</span>&nbsp;<span class="op" id="4027729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027735">return</span>&nbsp;<span class="ident" id="4027742">nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027757">return</span>&nbsp;<span class="ident" id="4027764"><a href="/crypto/x509/verify.go.html#4017963">HostnameError</a></span><span class="op" id="4027777">{</span><span class="ident" id="4027778"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4027779">,</span>&nbsp;<span class="ident" id="4027781"><a href="/crypto/x509/verify.go.html#4027401">candidateIP</a></span><span class="op" id="4027792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027799">lowered</span>&nbsp;<span class="op" id="4027807">:=</span>&nbsp;<span class="ident" id="4027810"><a href="/crypto/x509/verify.go.html#4026597">toLowerCaseASCII</a></span><span class="op" id="4027826">(</span><span class="ident" id="4027827"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4027828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027832">if</span>&nbsp;<span class="builtinfunc" id="4027835">len</span><span class="op" id="4027838">(</span><span class="ident" id="4027839"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4027840">.</span><span class="ident" id="4027841">DNSNames</span><span class="op" id="4027849">)</span>&nbsp;<span class="op" id="4027851">&gt;</span>&nbsp;<span class="num" id="4027853">0</span>&nbsp;<span class="op" id="4027855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027859">for</span>&nbsp;<span class="ident" id="4027863">_</span><span class="op" id="4027864">,</span>&nbsp;<span class="ident" id="4027866">match</span>&nbsp;<span class="op" id="4027872">:=</span>&nbsp;<span class="keyword" id="4027875">range</span>&nbsp;<span class="ident" id="4027881"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4027882">.</span><span class="ident" id="4027883">DNSNames</span>&nbsp;<span class="op" id="4027892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027897">if</span>&nbsp;<span class="ident" id="4027900"><a href="/crypto/x509/verify.go.html#4025975">matchHostnames</a></span><span class="op" id="4027914">(</span><span class="ident" id="4027915"><a href="/crypto/x509/verify.go.html#4026597">toLowerCaseASCII</a></span><span class="op" id="4027931">(</span><span class="ident" id="4027932"><a href="/crypto/x509/verify.go.html#4027866">match</a></span><span class="op" id="4027937">)</span><span class="op" id="4027938">,</span>&nbsp;<span class="ident" id="4027940"><a href="/crypto/x509/verify.go.html#4027799">lowered</a></span><span class="op" id="4027947">)</span>&nbsp;<span class="op" id="4027949">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027955">return</span>&nbsp;<span class="ident" id="4027962">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027977">//&nbsp;If&nbsp;Subject&nbsp;Alt&nbsp;Name&nbsp;is&nbsp;given,&nbsp;we&nbsp;ignore&nbsp;the&nbsp;common&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028038">}</span>&nbsp;<span class="keyword" id="4028040">else</span>&nbsp;<span class="keyword" id="4028045">if</span>&nbsp;<span class="ident" id="4028048"><a href="/crypto/x509/verify.go.html#4025975">matchHostnames</a></span><span class="op" id="4028062">(</span><span class="ident" id="4028063"><a href="/crypto/x509/verify.go.html#4026597">toLowerCaseASCII</a></span><span class="op" id="4028079">(</span><span class="ident" id="4028080"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4028081">.</span><span class="ident" id="4028082">Subject</span><span class="op" id="4028089">.</span><span class="ident" id="4028090">CommonName</span><span class="op" id="4028100">)</span><span class="op" id="4028101">,</span>&nbsp;<span class="ident" id="4028103"><a href="/crypto/x509/verify.go.html#4027799">lowered</a></span><span class="op" id="4028110">)</span>&nbsp;<span class="op" id="4028112">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028116">return</span>&nbsp;<span class="ident" id="4028123">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028132">return</span>&nbsp;<span class="ident" id="4028139"><a href="/crypto/x509/verify.go.html#4017963">HostnameError</a></span><span class="op" id="4028152">{</span><span class="ident" id="4028153"><a href="/crypto/x509/verify.go.html#4027311">c</a></span><span class="op" id="4028154">,</span>&nbsp;<span class="ident" id="4028156"><a href="/crypto/x509/verify.go.html#4027342">h</a></span><span class="op" id="4028157">}</span><br>
<span class="lineno"></span><span class="op" id="4028159">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="4028162">func</span>&nbsp;<span class="ident" id="4028167">checkChainForKeyUsage</span><span class="op" id="4028188">(</span><span class="ident" id="4028189">chain</span>&nbsp;<span class="op" id="4028195">[</span><span class="op" id="4028196">]</span><span class="op" id="4028197">*</span><span class="ident" id="4028198"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4028209">,</span>&nbsp;<span class="ident" id="4028211">keyUsages</span>&nbsp;<span class="op" id="4028221">[</span><span class="op" id="4028222">]</span><span class="ident" id="4028223"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="4028234">)</span>&nbsp;<span class="builtintype" id="4028236">bool</span>&nbsp;<span class="op" id="4028241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028244">usages</span>&nbsp;<span class="op" id="4028251">:=</span>&nbsp;<span class="builtinfunc" id="4028254">make</span><span class="op" id="4028258">(</span><span class="op" id="4028259">[</span><span class="op" id="4028260">]</span><span class="ident" id="4028261"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="4028272">,</span>&nbsp;<span class="builtinfunc" id="4028274">len</span><span class="op" id="4028277">(</span><span class="ident" id="4028278"><a href="/crypto/x509/verify.go.html#4028211">keyUsages</a></span><span class="op" id="4028287">)</span><span class="op" id="4028288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4028291">copy</span><span class="op" id="4028295">(</span><span class="ident" id="4028296"><a href="/crypto/x509/verify.go.html#4028244">usages</a></span><span class="op" id="4028302">,</span>&nbsp;<span class="ident" id="4028304"><a href="/crypto/x509/verify.go.html#4028211">keyUsages</a></span><span class="op" id="4028313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028317">if</span>&nbsp;<span class="builtinfunc" id="4028320">len</span><span class="op" id="4028323">(</span><span class="ident" id="4028324"><a href="/crypto/x509/verify.go.html#4028189">chain</a></span><span class="op" id="4028329">)</span>&nbsp;<span class="op" id="4028331">==</span>&nbsp;<span class="num" id="4028334">0</span>&nbsp;<span class="op" id="4028336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028340">return</span>&nbsp;<span class="builtintype" id="4028347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028358">usagesRemaining</span>&nbsp;<span class="op" id="4028374">:=</span>&nbsp;<span class="builtinfunc" id="4028377">len</span><span class="op" id="4028380">(</span><span class="ident" id="4028381"><a href="/crypto/x509/verify.go.html#4028244">usages</a></span><span class="op" id="4028387">)</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4028391">//&nbsp;We&nbsp;walk&nbsp;down&nbsp;the&nbsp;list&nbsp;and&nbsp;cross&nbsp;out&nbsp;any&nbsp;usages&nbsp;that&nbsp;aren&#39;t&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4028464">//&nbsp;by&nbsp;each&nbsp;certificate.&nbsp;If&nbsp;we&nbsp;cross&nbsp;out&nbsp;all&nbsp;the&nbsp;usages,&nbsp;then&nbsp;the&nbsp;chain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4028536">//&nbsp;is&nbsp;unacceptable.</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="ident" id="4028557">NextCert</span><span class="op" id="4028565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028568">for</span>&nbsp;<span class="ident" id="4028572">i</span>&nbsp;<span class="op" id="4028574">:=</span>&nbsp;<span class="builtinfunc" id="4028577">len</span><span class="op" id="4028580">(</span><span class="ident" id="4028581"><a href="/crypto/x509/verify.go.html#4028189">chain</a></span><span class="op" id="4028586">)</span>&nbsp;<span class="op" id="4028588">-</span>&nbsp;<span class="num" id="4028590">1</span><span class="op" id="4028591">;</span>&nbsp;<span class="ident" id="4028593"><a href="/crypto/x509/verify.go.html#4028572">i</a></span>&nbsp;<span class="op" id="4028595">&gt;=</span>&nbsp;<span class="num" id="4028598">0</span><span class="op" id="4028599">;</span>&nbsp;<span class="ident" id="4028601"><a href="/crypto/x509/verify.go.html#4028572">i</a></span><span class="op" id="4028602">--</span>&nbsp;<span class="op" id="4028605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028609">cert</span>&nbsp;<span class="op" id="4028614">:=</span>&nbsp;<span class="ident" id="4028617"><a href="/crypto/x509/verify.go.html#4028189">chain</a></span><span class="op" id="4028622">[</span><span class="ident" id="4028623"><a href="/crypto/x509/verify.go.html#4028572">i</a></span><span class="op" id="4028624">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028628">if</span>&nbsp;<span class="builtinfunc" id="4028631">len</span><span class="op" id="4028634">(</span><span class="ident" id="4028635"><a href="/crypto/x509/verify.go.html#4028609">cert</a></span><span class="op" id="4028639">.</span><span class="ident" id="4028640">ExtKeyUsage</span><span class="op" id="4028651">)</span>&nbsp;<span class="op" id="4028653">==</span>&nbsp;<span class="num" id="4028656">0</span>&nbsp;<span class="op" id="4028658">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4028661">len</span><span class="op" id="4028664">(</span><span class="ident" id="4028665"><a href="/crypto/x509/verify.go.html#4028609">cert</a></span><span class="op" id="4028669">.</span><span class="ident" id="4028670">UnknownExtKeyUsage</span><span class="op" id="4028688">)</span>&nbsp;<span class="op" id="4028690">==</span>&nbsp;<span class="num" id="4028693">0</span>&nbsp;<span class="op" id="4028695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4028700">//&nbsp;The&nbsp;certificate&nbsp;doesn&#39;t&nbsp;have&nbsp;any&nbsp;extended&nbsp;key&nbsp;usage&nbsp;specified.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028769">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028785">for</span>&nbsp;<span class="ident" id="4028789">_</span><span class="op" id="4028790">,</span>&nbsp;<span class="ident" id="4028792">usage</span>&nbsp;<span class="op" id="4028798">:=</span>&nbsp;<span class="keyword" id="4028801">range</span>&nbsp;<span class="ident" id="4028807"><a href="/crypto/x509/verify.go.html#4028609">cert</a></span><span class="op" id="4028811">.</span><span class="ident" id="4028812">ExtKeyUsage</span>&nbsp;<span class="op" id="4028824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028829">if</span>&nbsp;<span class="ident" id="4028832"><a href="/crypto/x509/verify.go.html#4028792">usage</a></span>&nbsp;<span class="op" id="4028838">==</span>&nbsp;<span class="ident" id="4028841"><a href="/crypto/x509/x509.go.html#4042546">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4028856">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4028862">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;explicitly&nbsp;good&nbsp;for&nbsp;any&nbsp;usage.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028919">continue</span>&nbsp;<span class="ident" id="4028928">NextCert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028949">const</span>&nbsp;<span class="ident" id="4028955">invalidUsage</span>&nbsp;<span class="ident" id="4028968"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4028980">=</span>&nbsp;<span class="op" id="4028982">-</span><span class="num" id="4028983">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028987">NextRequestedUsage</span><span class="op" id="4029005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029009">for</span>&nbsp;<span class="ident" id="4029013">i</span><span class="op" id="4029014">,</span>&nbsp;<span class="ident" id="4029016">requestedUsage</span>&nbsp;<span class="op" id="4029031">:=</span>&nbsp;<span class="keyword" id="4029034">range</span>&nbsp;<span class="ident" id="4029040"><a href="/crypto/x509/verify.go.html#4028244">usages</a></span>&nbsp;<span class="op" id="4029047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029052">if</span>&nbsp;<span class="ident" id="4029055"><a href="/crypto/x509/verify.go.html#4029016">requestedUsage</a></span>&nbsp;<span class="op" id="4029070">==</span>&nbsp;<span class="ident" id="4029073"><a href="/crypto/x509/verify.go.html#4028955">invalidUsage</a></span>&nbsp;<span class="op" id="4029086">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029092">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029110">for</span>&nbsp;<span class="ident" id="4029114">_</span><span class="op" id="4029115">,</span>&nbsp;<span class="ident" id="4029117">usage</span>&nbsp;<span class="op" id="4029123">:=</span>&nbsp;<span class="keyword" id="4029126">range</span>&nbsp;<span class="ident" id="4029132"><a href="/crypto/x509/verify.go.html#4028609">cert</a></span><span class="op" id="4029136">.</span><span class="ident" id="4029137">ExtKeyUsage</span>&nbsp;<span class="op" id="4029149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029155">if</span>&nbsp;<span class="ident" id="4029158"><a href="/crypto/x509/verify.go.html#4029016">requestedUsage</a></span>&nbsp;<span class="op" id="4029173">==</span>&nbsp;<span class="ident" id="4029176"><a href="/crypto/x509/verify.go.html#4029117">usage</a></span>&nbsp;<span class="op" id="4029182">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029189">continue</span>&nbsp;<span class="ident" id="4029198">NextRequestedUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029221">}</span>&nbsp;<span class="keyword" id="4029223">else</span>&nbsp;<span class="keyword" id="4029228">if</span>&nbsp;<span class="ident" id="4029231"><a href="/crypto/x509/verify.go.html#4029016">requestedUsage</a></span>&nbsp;<span class="op" id="4029246">==</span>&nbsp;<span class="ident" id="4029249"><a href="/crypto/x509/x509.go.html#4042581">ExtKeyUsageServerAuth</a></span>&nbsp;<span class="op" id="4029271">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029279">(</span><span class="ident" id="4029280"><a href="/crypto/x509/verify.go.html#4029117">usage</a></span>&nbsp;<span class="op" id="4029286">==</span>&nbsp;<span class="ident" id="4029289"><a href="/crypto/x509/x509.go.html#4042840">ExtKeyUsageNetscapeServerGatedCrypto</a></span>&nbsp;<span class="op" id="4029326">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029335"><a href="/crypto/x509/verify.go.html#4029117">usage</a></span>&nbsp;<span class="op" id="4029341">==</span>&nbsp;<span class="ident" id="4029344"><a href="/crypto/x509/x509.go.html#4042801">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4029381">)</span>&nbsp;<span class="op" id="4029383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029390">//&nbsp;In&nbsp;order&nbsp;to&nbsp;support&nbsp;COMODO</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029425">//&nbsp;certificate&nbsp;chains,&nbsp;we&nbsp;have&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029464">//&nbsp;accept&nbsp;Netscape&nbsp;or&nbsp;Microsoft&nbsp;SGC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029505">//&nbsp;usages&nbsp;as&nbsp;equal&nbsp;to&nbsp;ServerAuth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029544">continue</span>&nbsp;<span class="ident" id="4029553">NextRequestedUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029576">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029587"><a href="/crypto/x509/verify.go.html#4028244">usages</a></span><span class="op" id="4029593">[</span><span class="ident" id="4029594"><a href="/crypto/x509/verify.go.html#4029013">i</a></span><span class="op" id="4029595">]</span>&nbsp;<span class="op" id="4029597">=</span>&nbsp;<span class="ident" id="4029599"><a href="/crypto/x509/verify.go.html#4028955">invalidUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029615"><a href="/crypto/x509/verify.go.html#4028358">usagesRemaining</a></span><span class="op" id="4029630">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029636">if</span>&nbsp;<span class="ident" id="4029639"><a href="/crypto/x509/verify.go.html#4028358">usagesRemaining</a></span>&nbsp;<span class="op" id="4029655">==</span>&nbsp;<span class="num" id="4029658">0</span>&nbsp;<span class="op" id="4029660">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029666">return</span>&nbsp;<span class="builtintype" id="4029673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029693">return</span>&nbsp;<span class="builtintype" id="4029700">true</span><br>
<span class="lineno"></span><span class="op" id="4029705">}</span>
</div>
</body>
</html>
