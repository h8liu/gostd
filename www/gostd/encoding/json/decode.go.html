<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html" class="current">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3350888">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3350943">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3350997">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3351048">//&nbsp;Represents&nbsp;JSON&nbsp;data&nbsp;structure&nbsp;using&nbsp;native&nbsp;Go&nbsp;types:&nbsp;booleans,&nbsp;floats,</span><br>
<span class="lineno"></span><span class="comment" id="3351123">//&nbsp;strings,&nbsp;arrays,&nbsp;and&nbsp;maps.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3351154">package</span>&nbsp;<span class="ident" id="3351162">json</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3351168">import</span>&nbsp;<span class="op" id="3351175">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351178">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351187">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351199">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351218">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351228">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351235">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351246">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351257">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351268">&#34;unicode&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351279">&#34;unicode/utf16&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3351296">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3351311">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3351314">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;JSON-encoded&nbsp;data&nbsp;and&nbsp;stores&nbsp;the&nbsp;result</span><br>
<span class="lineno">25</span><span class="comment" id="3351378">//&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3351411">//</span><br>
<span class="lineno"></span><span class="comment" id="3351414">//&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;encodings&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3351466">//&nbsp;Marshal&nbsp;uses,&nbsp;allocating&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;pointers&nbsp;as&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3351535">//&nbsp;with&nbsp;the&nbsp;following&nbsp;additional&nbsp;rules:</span><br>
<span class="lineno">30</span><span class="comment" id="3351575">//</span><br>
<span class="lineno"></span><span class="comment" id="3351578">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;pointer,&nbsp;Unmarshal&nbsp;first&nbsp;handles&nbsp;the&nbsp;case&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3351651">//&nbsp;the&nbsp;JSON&nbsp;being&nbsp;the&nbsp;JSON&nbsp;literal&nbsp;null.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;Unmarshal&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="3351722">//&nbsp;the&nbsp;pointer&nbsp;to&nbsp;nil.&nbsp;&nbsp;Otherwise,&nbsp;Unmarshal&nbsp;unmarshals&nbsp;the&nbsp;JSON&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3351792">//&nbsp;the&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;the&nbsp;pointer.&nbsp;&nbsp;If&nbsp;the&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;Unmarshal</span><br>
<span class="lineno">35</span><span class="comment" id="3351866">//&nbsp;allocates&nbsp;a&nbsp;new&nbsp;value&nbsp;for&nbsp;it&nbsp;to&nbsp;point&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment" id="3351911">//</span><br>
<span class="lineno"></span><span class="comment" id="3351914">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;struct,&nbsp;Unmarshal&nbsp;matches&nbsp;incoming&nbsp;object</span><br>
<span class="lineno"></span><span class="comment" id="3351984">//&nbsp;keys&nbsp;to&nbsp;the&nbsp;keys&nbsp;used&nbsp;by&nbsp;Marshal&nbsp;(either&nbsp;the&nbsp;struct&nbsp;field&nbsp;name&nbsp;or&nbsp;its&nbsp;tag),</span><br>
<span class="lineno"></span><span class="comment" id="3352063">//&nbsp;preferring&nbsp;an&nbsp;exact&nbsp;match&nbsp;but&nbsp;also&nbsp;accepting&nbsp;a&nbsp;case-insensitive&nbsp;match.</span><br>
<span class="lineno">40</span><span class="comment" id="3352137">//</span><br>
<span class="lineno"></span><span class="comment" id="3352140">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;an&nbsp;interface&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="3352186">//&nbsp;Unmarshal&nbsp;stores&nbsp;one&nbsp;of&nbsp;these&nbsp;in&nbsp;the&nbsp;interface&nbsp;value:</span><br>
<span class="lineno"></span><span class="comment" id="3352243">//</span><br>
<span class="lineno"></span><span class="comment" id="3352246">//&nbsp;&nbsp;&nbsp;&nbsp;bool,&nbsp;for&nbsp;JSON&nbsp;booleans</span><br>
<span class="lineno">45</span><span class="comment" id="3352273">//&nbsp;&nbsp;&nbsp;&nbsp;float64,&nbsp;for&nbsp;JSON&nbsp;numbers</span><br>
<span class="lineno"></span><span class="comment" id="3352302">//&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;for&nbsp;JSON&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3352330">//&nbsp;&nbsp;&nbsp;&nbsp;[]interface{},&nbsp;for&nbsp;JSON&nbsp;arrays</span><br>
<span class="lineno"></span><span class="comment" id="3352364">//&nbsp;&nbsp;&nbsp;&nbsp;map[string]interface{},&nbsp;for&nbsp;JSON&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="3352408">//&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;for&nbsp;JSON&nbsp;null</span><br>
<span class="lineno">50</span><span class="comment" id="3352429">//</span><br>
<span class="lineno"></span><span class="comment" id="3352432">//&nbsp;If&nbsp;a&nbsp;JSON&nbsp;value&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;given&nbsp;target&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3352495">//&nbsp;or&nbsp;if&nbsp;a&nbsp;JSON&nbsp;number&nbsp;overflows&nbsp;the&nbsp;target&nbsp;type,&nbsp;Unmarshal</span><br>
<span class="lineno"></span><span class="comment" id="3352555">//&nbsp;skips&nbsp;that&nbsp;field&nbsp;and&nbsp;completes&nbsp;the&nbsp;unmarshalling&nbsp;as&nbsp;best&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span><span class="comment" id="3352623">//&nbsp;If&nbsp;no&nbsp;more&nbsp;serious&nbsp;errors&nbsp;are&nbsp;encountered,&nbsp;Unmarshal&nbsp;returns</span><br>
<span class="lineno">55</span><span class="comment" id="3352687">//&nbsp;an&nbsp;UnmarshalTypeError&nbsp;describing&nbsp;the&nbsp;earliest&nbsp;such&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3352748">//</span><br>
<span class="lineno"></span><span class="comment" id="3352751">//&nbsp;The&nbsp;JSON&nbsp;null&nbsp;value&nbsp;unmarshals&nbsp;into&nbsp;an&nbsp;interface,&nbsp;map,&nbsp;pointer,&nbsp;or&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3352827">//&nbsp;by&nbsp;setting&nbsp;that&nbsp;Go&nbsp;value&nbsp;to&nbsp;nil.&nbsp;Because&nbsp;null&nbsp;is&nbsp;often&nbsp;used&nbsp;in&nbsp;JSON&nbsp;to&nbsp;mean</span><br>
<span class="lineno"></span><span class="comment" id="3352906">//&nbsp;``not&nbsp;present,&#39;&#39;&nbsp;unmarshaling&nbsp;a&nbsp;JSON&nbsp;null&nbsp;into&nbsp;any&nbsp;other&nbsp;Go&nbsp;type&nbsp;has&nbsp;no&nbsp;effect</span><br>
<span class="lineno">60</span><span class="comment" id="3352988">//&nbsp;on&nbsp;the&nbsp;value&nbsp;and&nbsp;produces&nbsp;no&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3353027">//</span><br>
<span class="lineno"></span><span class="comment" id="3353030">//&nbsp;When&nbsp;unmarshaling&nbsp;quoted&nbsp;strings,&nbsp;invalid&nbsp;UTF-8&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3353084">//&nbsp;invalid&nbsp;UTF-16&nbsp;surrogate&nbsp;pairs&nbsp;are&nbsp;not&nbsp;treated&nbsp;as&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3353147">//&nbsp;Instead,&nbsp;they&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;Unicode&nbsp;replacement</span><br>
<span class="lineno">65</span><span class="comment" id="3353204">//&nbsp;character&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="comment" id="3353225">//</span><br>
<span class="lineno"></span><span class="keyword" id="3353228">func</span>&nbsp;<span class="ident" id="3353233">Unmarshal</span><span class="op" id="3353242">(</span><span class="ident" id="3353243">data</span>&nbsp;<span class="op" id="3353248">[</span><span class="op" id="3353249">]</span><span class="builtintype" id="3353250">byte</span><span class="op" id="3353254">,</span>&nbsp;<span class="ident" id="3353256">v</span>&nbsp;<span class="keyword" id="3353258">interface</span><span class="op" id="3353267">{</span><span class="op" id="3353268">}</span><span class="op" id="3353269">)</span>&nbsp;<span class="builtintype" id="3353271">error</span>&nbsp;<span class="op" id="3353277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3353280">//&nbsp;Check&nbsp;for&nbsp;well-formedness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3353311">//&nbsp;Avoids&nbsp;filling&nbsp;out&nbsp;half&nbsp;a&nbsp;data&nbsp;structure</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3353356">//&nbsp;before&nbsp;discovering&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3353400">var</span>&nbsp;<span class="ident" id="3353404">d</span>&nbsp;<span class="ident" id="3353406">decodeState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3353419">err</span>&nbsp;<span class="op" id="3353423">:=</span>&nbsp;<span class="ident" id="3353426">checkValid</span><span class="op" id="3353436">(</span><span class="ident" id="3353437">data</span><span class="op" id="3353441">,</span>&nbsp;<span class="op" id="3353443">&amp;</span><span class="ident" id="3353444">d</span><span class="op" id="3353445">.</span><span class="ident" id="3353446">scan</span><span class="op" id="3353450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3353453">if</span>&nbsp;<span class="ident" id="3353456">err</span>&nbsp;<span class="op" id="3353460">!=</span>&nbsp;<span class="builtintype" id="3353463">nil</span>&nbsp;<span class="op" id="3353467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3353471">return</span>&nbsp;<span class="ident" id="3353478">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3353483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3353487">d</span><span class="op" id="3353488">.</span><span class="ident" id="3353489">init</span><span class="op" id="3353493">(</span><span class="ident" id="3353494">data</span><span class="op" id="3353498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3353501">return</span>&nbsp;<span class="ident" id="3353508">d</span><span class="op" id="3353509">.</span><span class="ident" id="3353510">unmarshal</span><span class="op" id="3353519">(</span><span class="ident" id="3353520">v</span><span class="op" id="3353521">)</span><br>
<span class="lineno"></span><span class="op" id="3353523">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3353526">//&nbsp;Unmarshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="3353581">//&nbsp;that&nbsp;can&nbsp;unmarshal&nbsp;a&nbsp;JSON&nbsp;description&nbsp;of&nbsp;themselves.</span><br>
<span class="lineno"></span><span class="comment" id="3353637">//&nbsp;The&nbsp;input&nbsp;can&nbsp;be&nbsp;assumed&nbsp;to&nbsp;be&nbsp;a&nbsp;valid&nbsp;encoding&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3353691">//&nbsp;a&nbsp;JSON&nbsp;value.&nbsp;UnmarshalJSON&nbsp;must&nbsp;copy&nbsp;the&nbsp;JSON&nbsp;data</span><br>
<span class="lineno">85</span><span class="comment" id="3353746">//&nbsp;if&nbsp;it&nbsp;wishes&nbsp;to&nbsp;retain&nbsp;the&nbsp;data&nbsp;after&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="3353798">type</span>&nbsp;<span class="ident" id="3353803">Unmarshaler</span>&nbsp;<span class="keyword" id="3353815">interface</span>&nbsp;<span class="op" id="3353825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3353828">UnmarshalJSON</span><span class="op" id="3353841">(</span><span class="op" id="3353842">[</span><span class="op" id="3353843">]</span><span class="builtintype" id="3353844">byte</span><span class="op" id="3353848">)</span>&nbsp;<span class="builtintype" id="3353850">error</span><br>
<span class="lineno"></span><span class="op" id="3353856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="3353859">//&nbsp;An&nbsp;UnmarshalTypeError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;that&nbsp;was</span><br>
<span class="lineno"></span><span class="comment" id="3353916">//&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;value&nbsp;of&nbsp;a&nbsp;specific&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3353970">type</span>&nbsp;<span class="ident" id="3353975">UnmarshalTypeError</span>&nbsp;<span class="keyword" id="3353994">struct</span>&nbsp;<span class="op" id="3354001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354004">Value</span>&nbsp;<span class="builtintype" id="3354010">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3354023">//&nbsp;description&nbsp;of&nbsp;JSON&nbsp;value&nbsp;-&nbsp;&#34;bool&#34;,&nbsp;&#34;array&#34;,&nbsp;&#34;number&nbsp;-5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354084">Type</span>&nbsp;&nbsp;<span class="ident" id="3354090">reflect</span><span class="op" id="3354097">.</span><span class="ident" id="3354098">Type</span>&nbsp;<span class="comment" id="3354103">//&nbsp;type&nbsp;of&nbsp;Go&nbsp;value&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;assigned&nbsp;to</span><br>
<span class="lineno">95</span><span class="op" id="3354151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3354154">func</span>&nbsp;<span class="op" id="3354159">(</span><span class="ident" id="3354160">e</span>&nbsp;<span class="op" id="3354162">*</span><span class="ident" id="3354163">UnmarshalTypeError</span><span class="op" id="3354181">)</span>&nbsp;<span class="ident" id="3354183">Error</span><span class="op" id="3354188">(</span><span class="op" id="3354189">)</span>&nbsp;<span class="builtintype" id="3354191">string</span>&nbsp;<span class="op" id="3354198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3354201">return</span>&nbsp;<span class="string" id="3354208">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;&#34;</span>&nbsp;<span class="op" id="3354234">+</span>&nbsp;<span class="ident" id="3354236">e</span><span class="op" id="3354237">.</span><span class="ident" id="3354238">Value</span>&nbsp;<span class="op" id="3354244">+</span>&nbsp;<span class="string" id="3354246">&#34;&nbsp;into&nbsp;Go&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="3354272">+</span>&nbsp;<span class="ident" id="3354274">e</span><span class="op" id="3354275">.</span><span class="ident" id="3354276">Type</span><span class="op" id="3354280">.</span><span class="ident" id="3354281">String</span><span class="op" id="3354287">(</span><span class="op" id="3354288">)</span><br>
<span class="lineno"></span><span class="op" id="3354290">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3354293">//&nbsp;An&nbsp;UnmarshalFieldError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;object&nbsp;key&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3354352">//&nbsp;led&nbsp;to&nbsp;an&nbsp;unexported&nbsp;(and&nbsp;therefore&nbsp;unwritable)&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="3354417">//&nbsp;(No&nbsp;longer&nbsp;used;&nbsp;kept&nbsp;for&nbsp;compatibility.)</span><br>
<span class="lineno"></span><span class="keyword" id="3354462">type</span>&nbsp;<span class="ident" id="3354467">UnmarshalFieldError</span>&nbsp;<span class="keyword" id="3354487">struct</span>&nbsp;<span class="op" id="3354494">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354497">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3354503">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354511">Type</span>&nbsp;&nbsp;<span class="ident" id="3354517">reflect</span><span class="op" id="3354524">.</span><span class="ident" id="3354525">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354531">Field</span>&nbsp;<span class="ident" id="3354537">reflect</span><span class="op" id="3354544">.</span><span class="ident" id="3354545">StructField</span><br>
<span class="lineno"></span><span class="op" id="3354557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="3354560">func</span>&nbsp;<span class="op" id="3354565">(</span><span class="ident" id="3354566">e</span>&nbsp;<span class="op" id="3354568">*</span><span class="ident" id="3354569">UnmarshalFieldError</span><span class="op" id="3354588">)</span>&nbsp;<span class="ident" id="3354590">Error</span><span class="op" id="3354595">(</span><span class="op" id="3354596">)</span>&nbsp;<span class="builtintype" id="3354598">string</span>&nbsp;<span class="op" id="3354605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3354608">return</span>&nbsp;<span class="string" id="3354615">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;object&nbsp;key&nbsp;&#34;</span>&nbsp;<span class="op" id="3354652">+</span>&nbsp;<span class="ident" id="3354654">strconv</span><span class="op" id="3354661">.</span><span class="ident" id="3354662">Quote</span><span class="op" id="3354667">(</span><span class="ident" id="3354668">e</span><span class="op" id="3354669">.</span><span class="ident" id="3354670">Key</span><span class="op" id="3354673">)</span>&nbsp;<span class="op" id="3354675">+</span>&nbsp;<span class="string" id="3354677">&#34;&nbsp;into&nbsp;unexported&nbsp;field&nbsp;&#34;</span>&nbsp;<span class="op" id="3354703">+</span>&nbsp;<span class="ident" id="3354705">e</span><span class="op" id="3354706">.</span><span class="ident" id="3354707">Field</span><span class="op" id="3354712">.</span><span class="ident" id="3354713">Name</span>&nbsp;<span class="op" id="3354718">+</span>&nbsp;<span class="string" id="3354720">&#34;&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="3354732">+</span>&nbsp;<span class="ident" id="3354734">e</span><span class="op" id="3354735">.</span><span class="ident" id="3354736">Type</span><span class="op" id="3354740">.</span><span class="ident" id="3354741">String</span><span class="op" id="3354747">(</span><span class="op" id="3354748">)</span><br>
<span class="lineno"></span><span class="op" id="3354750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3354753">//&nbsp;An&nbsp;InvalidUnmarshalError&nbsp;describes&nbsp;an&nbsp;invalid&nbsp;argument&nbsp;passed&nbsp;to&nbsp;Unmarshal.</span><br>
<span class="lineno">115</span><span class="comment" id="3354832">//&nbsp;(The&nbsp;argument&nbsp;to&nbsp;Unmarshal&nbsp;must&nbsp;be&nbsp;a&nbsp;non-nil&nbsp;pointer.)</span><br>
<span class="lineno"></span><span class="keyword" id="3354890">type</span>&nbsp;<span class="ident" id="3354895">InvalidUnmarshalError</span>&nbsp;<span class="keyword" id="3354917">struct</span>&nbsp;<span class="op" id="3354924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3354927">Type</span>&nbsp;<span class="ident" id="3354932">reflect</span><span class="op" id="3354939">.</span><span class="ident" id="3354940">Type</span><br>
<span class="lineno"></span><span class="op" id="3354945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="3354948">func</span>&nbsp;<span class="op" id="3354953">(</span><span class="ident" id="3354954">e</span>&nbsp;<span class="op" id="3354956">*</span><span class="ident" id="3354957">InvalidUnmarshalError</span><span class="op" id="3354978">)</span>&nbsp;<span class="ident" id="3354980">Error</span><span class="op" id="3354985">(</span><span class="op" id="3354986">)</span>&nbsp;<span class="builtintype" id="3354988">string</span>&nbsp;<span class="op" id="3354995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3354998">if</span>&nbsp;<span class="ident" id="3355001">e</span><span class="op" id="3355002">.</span><span class="ident" id="3355003">Type</span>&nbsp;<span class="op" id="3355008">==</span>&nbsp;<span class="builtintype" id="3355011">nil</span>&nbsp;<span class="op" id="3355015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355019">return</span>&nbsp;<span class="string" id="3355026">&#34;json:&nbsp;Unmarshal(nil)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355054">if</span>&nbsp;<span class="ident" id="3355057">e</span><span class="op" id="3355058">.</span><span class="ident" id="3355059">Type</span><span class="op" id="3355063">.</span><span class="ident" id="3355064">Kind</span><span class="op" id="3355068">(</span><span class="op" id="3355069">)</span>&nbsp;<span class="op" id="3355071">!=</span>&nbsp;<span class="ident" id="3355074">reflect</span><span class="op" id="3355081">.</span><span class="ident" id="3355082">Ptr</span>&nbsp;<span class="op" id="3355086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355090">return</span>&nbsp;<span class="string" id="3355097">&#34;json:&nbsp;Unmarshal(non-pointer&nbsp;&#34;</span>&nbsp;<span class="op" id="3355128">+</span>&nbsp;<span class="ident" id="3355130">e</span><span class="op" id="3355131">.</span><span class="ident" id="3355132">Type</span><span class="op" id="3355136">.</span><span class="ident" id="3355137">String</span><span class="op" id="3355143">(</span><span class="op" id="3355144">)</span>&nbsp;<span class="op" id="3355146">+</span>&nbsp;<span class="string" id="3355148">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355156">return</span>&nbsp;<span class="string" id="3355163">&#34;json:&nbsp;Unmarshal(nil&nbsp;&#34;</span>&nbsp;<span class="op" id="3355186">+</span>&nbsp;<span class="ident" id="3355188">e</span><span class="op" id="3355189">.</span><span class="ident" id="3355190">Type</span><span class="op" id="3355194">.</span><span class="ident" id="3355195">String</span><span class="op" id="3355201">(</span><span class="op" id="3355202">)</span>&nbsp;<span class="op" id="3355204">+</span>&nbsp;<span class="string" id="3355206">&#34;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="3355210">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3355213">func</span>&nbsp;<span class="op" id="3355218">(</span><span class="ident" id="3355219">d</span>&nbsp;<span class="op" id="3355221">*</span><span class="ident" id="3355222">decodeState</span><span class="op" id="3355233">)</span>&nbsp;<span class="ident" id="3355235">unmarshal</span><span class="op" id="3355244">(</span><span class="ident" id="3355245">v</span>&nbsp;<span class="keyword" id="3355247">interface</span><span class="op" id="3355256">{</span><span class="op" id="3355257">}</span><span class="op" id="3355258">)</span>&nbsp;<span class="op" id="3355260">(</span><span class="ident" id="3355261">err</span>&nbsp;<span class="builtintype" id="3355265">error</span><span class="op" id="3355270">)</span>&nbsp;<span class="op" id="3355272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355275">defer</span>&nbsp;<span class="keyword" id="3355281">func</span><span class="op" id="3355285">(</span><span class="op" id="3355286">)</span>&nbsp;<span class="op" id="3355288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355292">if</span>&nbsp;<span class="ident" id="3355295">r</span>&nbsp;<span class="op" id="3355297">:=</span>&nbsp;<span class="builtinfunc" id="3355300">recover</span><span class="op" id="3355307">(</span><span class="op" id="3355308">)</span><span class="op" id="3355309">;</span>&nbsp;<span class="ident" id="3355311">r</span>&nbsp;<span class="op" id="3355313">!=</span>&nbsp;<span class="builtintype" id="3355316">nil</span>&nbsp;<span class="op" id="3355320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355325">if</span>&nbsp;<span class="ident" id="3355328">_</span><span class="op" id="3355329">,</span>&nbsp;<span class="ident" id="3355331">ok</span>&nbsp;<span class="op" id="3355334">:=</span>&nbsp;<span class="ident" id="3355337">r</span><span class="op" id="3355338">.</span><span class="op" id="3355339">(</span><span class="ident" id="3355340">runtime</span><span class="op" id="3355347">.</span><span class="ident" id="3355348">Error</span><span class="op" id="3355353">)</span><span class="op" id="3355354">;</span>&nbsp;<span class="ident" id="3355356">ok</span>&nbsp;<span class="op" id="3355359">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3355365">panic</span><span class="op" id="3355370">(</span><span class="ident" id="3355371">r</span><span class="op" id="3355372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3355382">err</span>&nbsp;<span class="op" id="3355386">=</span>&nbsp;<span class="ident" id="3355388">r</span><span class="op" id="3355389">.</span><span class="op" id="3355390">(</span><span class="builtintype" id="3355391">error</span><span class="op" id="3355396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355403">}</span><span class="op" id="3355404">(</span><span class="op" id="3355405">)</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3355409">rv</span>&nbsp;<span class="op" id="3355412">:=</span>&nbsp;<span class="ident" id="3355415">reflect</span><span class="op" id="3355422">.</span><span class="ident" id="3355423">ValueOf</span><span class="op" id="3355430">(</span><span class="ident" id="3355431">v</span><span class="op" id="3355432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355435">if</span>&nbsp;<span class="ident" id="3355438">rv</span><span class="op" id="3355440">.</span><span class="ident" id="3355441">Kind</span><span class="op" id="3355445">(</span><span class="op" id="3355446">)</span>&nbsp;<span class="op" id="3355448">!=</span>&nbsp;<span class="ident" id="3355451">reflect</span><span class="op" id="3355458">.</span><span class="ident" id="3355459">Ptr</span>&nbsp;<span class="op" id="3355463">||</span>&nbsp;<span class="ident" id="3355466">rv</span><span class="op" id="3355468">.</span><span class="ident" id="3355469">IsNil</span><span class="op" id="3355474">(</span><span class="op" id="3355475">)</span>&nbsp;<span class="op" id="3355477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355481">return</span>&nbsp;<span class="op" id="3355488">&amp;</span><span class="ident" id="3355489">InvalidUnmarshalError</span><span class="op" id="3355510">{</span><span class="ident" id="3355511">reflect</span><span class="op" id="3355518">.</span><span class="ident" id="3355519">TypeOf</span><span class="op" id="3355525">(</span><span class="ident" id="3355526">v</span><span class="op" id="3355527">)</span><span class="op" id="3355528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3355531">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3355535">d</span><span class="op" id="3355536">.</span><span class="ident" id="3355537">scan</span><span class="op" id="3355541">.</span><span class="ident" id="3355542">reset</span><span class="op" id="3355547">(</span><span class="op" id="3355548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3355551">//&nbsp;We&nbsp;decode&nbsp;rv&nbsp;not&nbsp;rv.Elem&nbsp;because&nbsp;the&nbsp;Unmarshaler&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3355614">//&nbsp;test&nbsp;must&nbsp;be&nbsp;applied&nbsp;at&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3355670">d</span><span class="op" id="3355671">.</span><span class="ident" id="3355672">value</span><span class="op" id="3355677">(</span><span class="ident" id="3355678">rv</span><span class="op" id="3355680">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355683">return</span>&nbsp;<span class="ident" id="3355690">d</span><span class="op" id="3355691">.</span><span class="ident" id="3355692">savedError</span><br>
<span class="lineno"></span><span class="op" id="3355703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3355706">//&nbsp;A&nbsp;Number&nbsp;represents&nbsp;a&nbsp;JSON&nbsp;number&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="3355752">type</span>&nbsp;<span class="ident" id="3355757">Number</span>&nbsp;<span class="builtintype" id="3355764">string</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3355772">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;literal&nbsp;text&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3355822">func</span>&nbsp;<span class="op" id="3355827">(</span><span class="ident" id="3355828">n</span>&nbsp;<span class="ident" id="3355830">Number</span><span class="op" id="3355836">)</span>&nbsp;<span class="ident" id="3355838">String</span><span class="op" id="3355844">(</span><span class="op" id="3355845">)</span>&nbsp;<span class="builtintype" id="3355847">string</span>&nbsp;<span class="op" id="3355854">{</span>&nbsp;<span class="keyword" id="3355856">return</span>&nbsp;<span class="builtintype" id="3355863">string</span><span class="op" id="3355869">(</span><span class="ident" id="3355870">n</span><span class="op" id="3355871">)</span>&nbsp;<span class="op" id="3355873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3355876">//&nbsp;Float64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno">160</span><span class="keyword" id="3355920">func</span>&nbsp;<span class="op" id="3355925">(</span><span class="ident" id="3355926">n</span>&nbsp;<span class="ident" id="3355928">Number</span><span class="op" id="3355934">)</span>&nbsp;<span class="ident" id="3355936">Float64</span><span class="op" id="3355943">(</span><span class="op" id="3355944">)</span>&nbsp;<span class="op" id="3355946">(</span><span class="builtintype" id="3355947">float64</span><span class="op" id="3355954">,</span>&nbsp;<span class="builtintype" id="3355956">error</span><span class="op" id="3355961">)</span>&nbsp;<span class="op" id="3355963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3355966">return</span>&nbsp;<span class="ident" id="3355973">strconv</span><span class="op" id="3355980">.</span><span class="ident" id="3355981">ParseFloat</span><span class="op" id="3355991">(</span><span class="builtintype" id="3355992">string</span><span class="op" id="3355998">(</span><span class="ident" id="3355999">n</span><span class="op" id="3356000">)</span><span class="op" id="3356001">,</span>&nbsp;<span class="num" id="3356003">64</span><span class="op" id="3356005">)</span><br>
<span class="lineno"></span><span class="op" id="3356007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3356010">//&nbsp;Int64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;an&nbsp;int64.</span><br>
<span class="lineno">165</span><span class="keyword" id="3356051">func</span>&nbsp;<span class="op" id="3356056">(</span><span class="ident" id="3356057">n</span>&nbsp;<span class="ident" id="3356059">Number</span><span class="op" id="3356065">)</span>&nbsp;<span class="ident" id="3356067">Int64</span><span class="op" id="3356072">(</span><span class="op" id="3356073">)</span>&nbsp;<span class="op" id="3356075">(</span><span class="builtintype" id="3356076">int64</span><span class="op" id="3356081">,</span>&nbsp;<span class="builtintype" id="3356083">error</span><span class="op" id="3356088">)</span>&nbsp;<span class="op" id="3356090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3356093">return</span>&nbsp;<span class="ident" id="3356100">strconv</span><span class="op" id="3356107">.</span><span class="ident" id="3356108">ParseInt</span><span class="op" id="3356116">(</span><span class="builtintype" id="3356117">string</span><span class="op" id="3356123">(</span><span class="ident" id="3356124">n</span><span class="op" id="3356125">)</span><span class="op" id="3356126">,</span>&nbsp;<span class="num" id="3356128">10</span><span class="op" id="3356130">,</span>&nbsp;<span class="num" id="3356132">64</span><span class="op" id="3356134">)</span><br>
<span class="lineno"></span><span class="op" id="3356136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3356139">//&nbsp;decodeState&nbsp;represents&nbsp;the&nbsp;state&nbsp;while&nbsp;decoding&nbsp;a&nbsp;JSON&nbsp;value.</span><br>
<span class="lineno">170</span><span class="keyword" id="3356204">type</span>&nbsp;<span class="ident" id="3356209">decodeState</span>&nbsp;<span class="keyword" id="3356221">struct</span>&nbsp;<span class="op" id="3356228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356231">data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3356242">[</span><span class="op" id="3356243">]</span><span class="builtintype" id="3356244">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356250">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3356261">int</span>&nbsp;<span class="comment" id="3356265">//&nbsp;read&nbsp;offset&nbsp;in&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356289">scan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356300">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356309">nextscan</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3356320">scanner</span>&nbsp;<span class="comment" id="3356328">//&nbsp;for&nbsp;calls&nbsp;to&nbsp;nextValue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356355">savedError</span>&nbsp;<span class="builtintype" id="3356366">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356373">useNumber</span>&nbsp;&nbsp;<span class="builtintype" id="3356384">bool</span><br>
<span class="lineno"></span><span class="op" id="3356389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3356392">//&nbsp;errPhase&nbsp;is&nbsp;used&nbsp;for&nbsp;errors&nbsp;that&nbsp;should&nbsp;not&nbsp;happen&nbsp;unless</span><br>
<span class="lineno">180</span><span class="comment" id="3356453">//&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;JSON&nbsp;decoder&nbsp;or&nbsp;something&nbsp;is&nbsp;editing</span><br>
<span class="lineno"></span><span class="comment" id="3356515">//&nbsp;the&nbsp;data&nbsp;slice&nbsp;while&nbsp;the&nbsp;decoder&nbsp;executes.</span><br>
<span class="lineno"></span><span class="keyword" id="3356561">var</span>&nbsp;<span class="ident" id="3356565">errPhase</span>&nbsp;<span class="op" id="3356574">=</span>&nbsp;<span class="ident" id="3356576">errors</span><span class="op" id="3356582">.</span><span class="ident" id="3356583">New</span><span class="op" id="3356586">(</span><span class="string" id="3356587">&#34;JSON&nbsp;decoder&nbsp;out&nbsp;of&nbsp;sync&nbsp;-&nbsp;data&nbsp;changing&nbsp;underfoot?&#34;</span><span class="op" id="3356640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3356643">func</span>&nbsp;<span class="op" id="3356648">(</span><span class="ident" id="3356649">d</span>&nbsp;<span class="op" id="3356651">*</span><span class="ident" id="3356652">decodeState</span><span class="op" id="3356663">)</span>&nbsp;<span class="ident" id="3356665">init</span><span class="op" id="3356669">(</span><span class="ident" id="3356670">data</span>&nbsp;<span class="op" id="3356675">[</span><span class="op" id="3356676">]</span><span class="builtintype" id="3356677">byte</span><span class="op" id="3356681">)</span>&nbsp;<span class="op" id="3356683">*</span><span class="ident" id="3356684">decodeState</span>&nbsp;<span class="op" id="3356696">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356699">d</span><span class="op" id="3356700">.</span><span class="ident" id="3356701">data</span>&nbsp;<span class="op" id="3356706">=</span>&nbsp;<span class="ident" id="3356708">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356714">d</span><span class="op" id="3356715">.</span><span class="ident" id="3356716">off</span>&nbsp;<span class="op" id="3356720">=</span>&nbsp;<span class="num" id="3356722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3356725">d</span><span class="op" id="3356726">.</span><span class="ident" id="3356727">savedError</span>&nbsp;<span class="op" id="3356738">=</span>&nbsp;<span class="builtintype" id="3356740">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3356745">return</span>&nbsp;<span class="ident" id="3356752">d</span><br>
<span class="lineno"></span><span class="op" id="3356754">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3356757">//&nbsp;error&nbsp;aborts&nbsp;the&nbsp;decoding&nbsp;by&nbsp;panicking&nbsp;with&nbsp;err.</span><br>
<span class="lineno"></span><span class="keyword" id="3356809">func</span>&nbsp;<span class="op" id="3356814">(</span><span class="ident" id="3356815">d</span>&nbsp;<span class="op" id="3356817">*</span><span class="ident" id="3356818">decodeState</span><span class="op" id="3356829">)</span>&nbsp;<span class="builtintype" id="3356831">error</span><span class="op" id="3356836">(</span><span class="ident" id="3356837">err</span>&nbsp;<span class="builtintype" id="3356841">error</span><span class="op" id="3356846">)</span>&nbsp;<span class="op" id="3356848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3356851">panic</span><span class="op" id="3356856">(</span><span class="ident" id="3356857">err</span><span class="op" id="3356860">)</span><br>
<span class="lineno"></span><span class="op" id="3356862">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="3356865">//&nbsp;saveError&nbsp;saves&nbsp;the&nbsp;first&nbsp;err&nbsp;it&nbsp;is&nbsp;called&nbsp;with,</span><br>
<span class="lineno"></span><span class="comment" id="3356917">//&nbsp;for&nbsp;reporting&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;unmarshal.</span><br>
<span class="lineno"></span><span class="keyword" id="3356963">func</span>&nbsp;<span class="op" id="3356968">(</span><span class="ident" id="3356969">d</span>&nbsp;<span class="op" id="3356971">*</span><span class="ident" id="3356972">decodeState</span><span class="op" id="3356983">)</span>&nbsp;<span class="ident" id="3356985">saveError</span><span class="op" id="3356994">(</span><span class="ident" id="3356995">err</span>&nbsp;<span class="builtintype" id="3356999">error</span><span class="op" id="3357004">)</span>&nbsp;<span class="op" id="3357006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357009">if</span>&nbsp;<span class="ident" id="3357012">d</span><span class="op" id="3357013">.</span><span class="ident" id="3357014">savedError</span>&nbsp;<span class="op" id="3357025">==</span>&nbsp;<span class="builtintype" id="3357028">nil</span>&nbsp;<span class="op" id="3357032">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357036">d</span><span class="op" id="3357037">.</span><span class="ident" id="3357038">savedError</span>&nbsp;<span class="op" id="3357049">=</span>&nbsp;<span class="ident" id="3357051">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3357056">}</span><br>
<span class="lineno"></span><span class="op" id="3357058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3357061">//&nbsp;next&nbsp;cuts&nbsp;off&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;full&nbsp;JSON&nbsp;value&nbsp;in&nbsp;d.data[d.off:].</span><br>
<span class="lineno">205</span><span class="comment" id="3357134">//&nbsp;The&nbsp;next&nbsp;value&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;an&nbsp;object&nbsp;or&nbsp;array,&nbsp;not&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="3357202">func</span>&nbsp;<span class="op" id="3357207">(</span><span class="ident" id="3357208">d</span>&nbsp;<span class="op" id="3357210">*</span><span class="ident" id="3357211">decodeState</span><span class="op" id="3357222">)</span>&nbsp;<span class="ident" id="3357224">next</span><span class="op" id="3357228">(</span><span class="op" id="3357229">)</span>&nbsp;<span class="op" id="3357231">[</span><span class="op" id="3357232">]</span><span class="builtintype" id="3357233">byte</span>&nbsp;<span class="op" id="3357238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357241">c</span>&nbsp;<span class="op" id="3357243">:=</span>&nbsp;<span class="ident" id="3357246">d</span><span class="op" id="3357247">.</span><span class="ident" id="3357248">data</span><span class="op" id="3357252">[</span><span class="ident" id="3357253">d</span><span class="op" id="3357254">.</span><span class="ident" id="3357255">off</span><span class="op" id="3357258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357261">item</span><span class="op" id="3357265">,</span>&nbsp;<span class="ident" id="3357267">rest</span><span class="op" id="3357271">,</span>&nbsp;<span class="ident" id="3357273">err</span>&nbsp;<span class="op" id="3357277">:=</span>&nbsp;<span class="ident" id="3357280">nextValue</span><span class="op" id="3357289">(</span><span class="ident" id="3357290">d</span><span class="op" id="3357291">.</span><span class="ident" id="3357292">data</span><span class="op" id="3357296">[</span><span class="ident" id="3357297">d</span><span class="op" id="3357298">.</span><span class="ident" id="3357299">off</span><span class="op" id="3357302">:</span><span class="op" id="3357303">]</span><span class="op" id="3357304">,</span>&nbsp;<span class="op" id="3357306">&amp;</span><span class="ident" id="3357307">d</span><span class="op" id="3357308">.</span><span class="ident" id="3357309">nextscan</span><span class="op" id="3357317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357320">if</span>&nbsp;<span class="ident" id="3357323">err</span>&nbsp;<span class="op" id="3357327">!=</span>&nbsp;<span class="builtintype" id="3357330">nil</span>&nbsp;<span class="op" id="3357334">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357338">d</span><span class="op" id="3357339">.</span><span class="builtintype" id="3357340">error</span><span class="op" id="3357345">(</span><span class="ident" id="3357346">err</span><span class="op" id="3357349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3357352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357355">d</span><span class="op" id="3357356">.</span><span class="ident" id="3357357">off</span>&nbsp;<span class="op" id="3357361">=</span>&nbsp;<span class="builtinfunc" id="3357363">len</span><span class="op" id="3357366">(</span><span class="ident" id="3357367">d</span><span class="op" id="3357368">.</span><span class="ident" id="3357369">data</span><span class="op" id="3357373">)</span>&nbsp;<span class="op" id="3357375">-</span>&nbsp;<span class="builtinfunc" id="3357377">len</span><span class="op" id="3357380">(</span><span class="ident" id="3357381">rest</span><span class="op" id="3357385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3357389">//&nbsp;Our&nbsp;scanner&nbsp;has&nbsp;seen&nbsp;the&nbsp;opening&nbsp;brace/bracket</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3357440">//&nbsp;and&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;the&nbsp;object.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3357496">//&nbsp;invent&nbsp;a&nbsp;closing&nbsp;brace/bracket&nbsp;to&nbsp;get&nbsp;it&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357546">if</span>&nbsp;<span class="ident" id="3357549">c</span>&nbsp;<span class="op" id="3357551">==</span>&nbsp;<span class="string" id="3357554">&#39;{&#39;</span>&nbsp;<span class="op" id="3357558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357562">d</span><span class="op" id="3357563">.</span><span class="ident" id="3357564">scan</span><span class="op" id="3357568">.</span><span class="ident" id="3357569">step</span><span class="op" id="3357573">(</span><span class="op" id="3357574">&amp;</span><span class="ident" id="3357575">d</span><span class="op" id="3357576">.</span><span class="ident" id="3357577">scan</span><span class="op" id="3357581">,</span>&nbsp;<span class="string" id="3357583">&#39;}&#39;</span><span class="op" id="3357586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3357589">}</span>&nbsp;<span class="keyword" id="3357591">else</span>&nbsp;<span class="op" id="3357596">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357600">d</span><span class="op" id="3357601">.</span><span class="ident" id="3357602">scan</span><span class="op" id="3357606">.</span><span class="ident" id="3357607">step</span><span class="op" id="3357611">(</span><span class="op" id="3357612">&amp;</span><span class="ident" id="3357613">d</span><span class="op" id="3357614">.</span><span class="ident" id="3357615">scan</span><span class="op" id="3357619">,</span>&nbsp;<span class="string" id="3357621">&#39;]&#39;</span><span class="op" id="3357624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3357627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357631">return</span>&nbsp;<span class="ident" id="3357638">item</span><br>
<span class="lineno"></span><span class="op" id="3357643">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3357646">//&nbsp;scanWhile&nbsp;processes&nbsp;bytes&nbsp;in&nbsp;d.data[d.off:]&nbsp;until&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3357702">//&nbsp;receives&nbsp;a&nbsp;scan&nbsp;code&nbsp;not&nbsp;equal&nbsp;to&nbsp;op.</span><br>
<span class="lineno"></span><span class="comment" id="3357743">//&nbsp;It&nbsp;updates&nbsp;d.off&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;scan&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="3357794">func</span>&nbsp;<span class="op" id="3357799">(</span><span class="ident" id="3357800">d</span>&nbsp;<span class="op" id="3357802">*</span><span class="ident" id="3357803">decodeState</span><span class="op" id="3357814">)</span>&nbsp;<span class="ident" id="3357816">scanWhile</span><span class="op" id="3357825">(</span><span class="ident" id="3357826">op</span>&nbsp;<span class="builtintype" id="3357829">int</span><span class="op" id="3357832">)</span>&nbsp;<span class="builtintype" id="3357834">int</span>&nbsp;<span class="op" id="3357838">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357841">var</span>&nbsp;<span class="ident" id="3357845">newOp</span>&nbsp;<span class="builtintype" id="3357851">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357856">for</span>&nbsp;<span class="op" id="3357860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3357864">if</span>&nbsp;<span class="ident" id="3357867">d</span><span class="op" id="3357868">.</span><span class="ident" id="3357869">off</span>&nbsp;<span class="op" id="3357873">&gt;=</span>&nbsp;<span class="builtinfunc" id="3357876">len</span><span class="op" id="3357879">(</span><span class="ident" id="3357880">d</span><span class="op" id="3357881">.</span><span class="ident" id="3357882">data</span><span class="op" id="3357886">)</span>&nbsp;<span class="op" id="3357888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357893">newOp</span>&nbsp;<span class="op" id="3357899">=</span>&nbsp;<span class="ident" id="3357901">d</span><span class="op" id="3357902">.</span><span class="ident" id="3357903">scan</span><span class="op" id="3357907">.</span><span class="ident" id="3357908">eof</span><span class="op" id="3357911">(</span><span class="op" id="3357912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357917">d</span><span class="op" id="3357918">.</span><span class="ident" id="3357919">off</span>&nbsp;<span class="op" id="3357923">=</span>&nbsp;<span class="builtinfunc" id="3357925">len</span><span class="op" id="3357928">(</span><span class="ident" id="3357929">d</span><span class="op" id="3357930">.</span><span class="ident" id="3357931">data</span><span class="op" id="3357935">)</span>&nbsp;<span class="op" id="3357937">+</span>&nbsp;<span class="num" id="3357939">1</span>&nbsp;<span class="comment" id="3357941">//&nbsp;mark&nbsp;processed&nbsp;EOF&nbsp;with&nbsp;len+1</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3357976">}</span>&nbsp;<span class="keyword" id="3357978">else</span>&nbsp;<span class="op" id="3357983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3357988">c</span>&nbsp;<span class="op" id="3357990">:=</span>&nbsp;<span class="builtintype" id="3357993">int</span><span class="op" id="3357996">(</span><span class="ident" id="3357997">d</span><span class="op" id="3357998">.</span><span class="ident" id="3357999">data</span><span class="op" id="3358003">[</span><span class="ident" id="3358004">d</span><span class="op" id="3358005">.</span><span class="ident" id="3358006">off</span><span class="op" id="3358009">]</span><span class="op" id="3358010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358015">d</span><span class="op" id="3358016">.</span><span class="ident" id="3358017">off</span><span class="op" id="3358020">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358026">newOp</span>&nbsp;<span class="op" id="3358032">=</span>&nbsp;<span class="ident" id="3358034">d</span><span class="op" id="3358035">.</span><span class="ident" id="3358036">scan</span><span class="op" id="3358040">.</span><span class="ident" id="3358041">step</span><span class="op" id="3358045">(</span><span class="op" id="3358046">&amp;</span><span class="ident" id="3358047">d</span><span class="op" id="3358048">.</span><span class="ident" id="3358049">scan</span><span class="op" id="3358053">,</span>&nbsp;<span class="ident" id="3358055">c</span><span class="op" id="3358056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3358060">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358064">if</span>&nbsp;<span class="ident" id="3358067">newOp</span>&nbsp;<span class="op" id="3358073">!=</span>&nbsp;<span class="ident" id="3358076">op</span>&nbsp;<span class="op" id="3358079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358084">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3358092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3358095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358098">return</span>&nbsp;<span class="ident" id="3358105">newOp</span><br>
<span class="lineno">245</span><span class="op" id="3358111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3358114">//&nbsp;value&nbsp;decodes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;from&nbsp;d.data[d.off:]&nbsp;into&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3358180">//&nbsp;it&nbsp;updates&nbsp;d.off&nbsp;to&nbsp;point&nbsp;past&nbsp;the&nbsp;decoded&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3358233">func</span>&nbsp;<span class="op" id="3358238">(</span><span class="ident" id="3358239">d</span>&nbsp;<span class="op" id="3358241">*</span><span class="ident" id="3358242">decodeState</span><span class="op" id="3358253">)</span>&nbsp;<span class="ident" id="3358255">value</span><span class="op" id="3358260">(</span><span class="ident" id="3358261">v</span>&nbsp;<span class="ident" id="3358263">reflect</span><span class="op" id="3358270">.</span><span class="ident" id="3358271">Value</span><span class="op" id="3358276">)</span>&nbsp;<span class="op" id="3358278">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358281">if</span>&nbsp;<span class="op" id="3358284">!</span><span class="ident" id="3358285">v</span><span class="op" id="3358286">.</span><span class="ident" id="3358287">IsValid</span><span class="op" id="3358294">(</span><span class="op" id="3358295">)</span>&nbsp;<span class="op" id="3358297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358301">_</span><span class="op" id="3358302">,</span>&nbsp;<span class="ident" id="3358304">rest</span><span class="op" id="3358308">,</span>&nbsp;<span class="ident" id="3358310">err</span>&nbsp;<span class="op" id="3358314">:=</span>&nbsp;<span class="ident" id="3358317">nextValue</span><span class="op" id="3358326">(</span><span class="ident" id="3358327">d</span><span class="op" id="3358328">.</span><span class="ident" id="3358329">data</span><span class="op" id="3358333">[</span><span class="ident" id="3358334">d</span><span class="op" id="3358335">.</span><span class="ident" id="3358336">off</span><span class="op" id="3358339">:</span><span class="op" id="3358340">]</span><span class="op" id="3358341">,</span>&nbsp;<span class="op" id="3358343">&amp;</span><span class="ident" id="3358344">d</span><span class="op" id="3358345">.</span><span class="ident" id="3358346">nextscan</span><span class="op" id="3358354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358358">if</span>&nbsp;<span class="ident" id="3358361">err</span>&nbsp;<span class="op" id="3358365">!=</span>&nbsp;<span class="builtintype" id="3358368">nil</span>&nbsp;<span class="op" id="3358372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358377">d</span><span class="op" id="3358378">.</span><span class="builtintype" id="3358379">error</span><span class="op" id="3358384">(</span><span class="ident" id="3358385">err</span><span class="op" id="3358388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3358392">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358396">d</span><span class="op" id="3358397">.</span><span class="ident" id="3358398">off</span>&nbsp;<span class="op" id="3358402">=</span>&nbsp;<span class="builtinfunc" id="3358404">len</span><span class="op" id="3358407">(</span><span class="ident" id="3358408">d</span><span class="op" id="3358409">.</span><span class="ident" id="3358410">data</span><span class="op" id="3358414">)</span>&nbsp;<span class="op" id="3358416">-</span>&nbsp;<span class="builtinfunc" id="3358418">len</span><span class="op" id="3358421">(</span><span class="ident" id="3358422">rest</span><span class="op" id="3358426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3358431">//&nbsp;d.scan&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3358492">//&nbsp;Feed&nbsp;in&nbsp;an&nbsp;empty&nbsp;string&nbsp;-&nbsp;the&nbsp;shortest,&nbsp;simplest&nbsp;value&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3358554">//&nbsp;so&nbsp;that&nbsp;it&nbsp;knows&nbsp;we&nbsp;got&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358608">if</span>&nbsp;<span class="ident" id="3358611">d</span><span class="op" id="3358612">.</span><span class="ident" id="3358613">scan</span><span class="op" id="3358617">.</span><span class="ident" id="3358618">redo</span>&nbsp;<span class="op" id="3358623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3358628">//&nbsp;rewind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358642">d</span><span class="op" id="3358643">.</span><span class="ident" id="3358644">scan</span><span class="op" id="3358648">.</span><span class="ident" id="3358649">redo</span>&nbsp;<span class="op" id="3358654">=</span>&nbsp;<span class="builtintype" id="3358656">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358665">d</span><span class="op" id="3358666">.</span><span class="ident" id="3358667">scan</span><span class="op" id="3358671">.</span><span class="ident" id="3358672">step</span>&nbsp;<span class="op" id="3358677">=</span>&nbsp;<span class="ident" id="3358679">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3358697">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358701">d</span><span class="op" id="3358702">.</span><span class="ident" id="3358703">scan</span><span class="op" id="3358707">.</span><span class="ident" id="3358708">step</span><span class="op" id="3358712">(</span><span class="op" id="3358713">&amp;</span><span class="ident" id="3358714">d</span><span class="op" id="3358715">.</span><span class="ident" id="3358716">scan</span><span class="op" id="3358720">,</span>&nbsp;<span class="string" id="3358722">&#39;&#34;&#39;</span><span class="op" id="3358725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358729">d</span><span class="op" id="3358730">.</span><span class="ident" id="3358731">scan</span><span class="op" id="3358735">.</span><span class="ident" id="3358736">step</span><span class="op" id="3358740">(</span><span class="op" id="3358741">&amp;</span><span class="ident" id="3358742">d</span><span class="op" id="3358743">.</span><span class="ident" id="3358744">scan</span><span class="op" id="3358748">,</span>&nbsp;<span class="string" id="3358750">&#39;&#34;&#39;</span><span class="op" id="3358753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358758">n</span>&nbsp;<span class="op" id="3358760">:=</span>&nbsp;<span class="builtinfunc" id="3358763">len</span><span class="op" id="3358766">(</span><span class="ident" id="3358767">d</span><span class="op" id="3358768">.</span><span class="ident" id="3358769">scan</span><span class="op" id="3358773">.</span><span class="ident" id="3358774">parseState</span><span class="op" id="3358784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3358788">if</span>&nbsp;<span class="ident" id="3358791">n</span>&nbsp;<span class="op" id="3358793">&gt;</span>&nbsp;<span class="num" id="3358795">0</span>&nbsp;<span class="op" id="3358797">&amp;&amp;</span>&nbsp;<span class="ident" id="3358800">d</span><span class="op" id="3358801">.</span><span class="ident" id="3358802">scan</span><span class="op" id="3358806">.</span><span class="ident" id="3358807">parseState</span><span class="op" id="3358817">[</span><span class="ident" id="3358818">n</span><span class="op" id="3358819">-</span><span class="num" id="3358820">1</span><span class="op" id="3358821">]</span>&nbsp;<span class="op" id="3358823">==</span>&nbsp;<span class="ident" id="3358826">parseObjectKey</span>&nbsp;<span class="op" id="3358841">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3358846">//&nbsp;d.scan&nbsp;thinks&nbsp;we&nbsp;just&nbsp;read&nbsp;an&nbsp;object&nbsp;key;&nbsp;finish&nbsp;the&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358912">d</span><span class="op" id="3358913">.</span><span class="ident" id="3358914">scan</span><span class="op" id="3358918">.</span><span class="ident" id="3358919">step</span><span class="op" id="3358923">(</span><span class="op" id="3358924">&amp;</span><span class="ident" id="3358925">d</span><span class="op" id="3358926">.</span><span class="ident" id="3358927">scan</span><span class="op" id="3358931">,</span>&nbsp;<span class="string" id="3358933">&#39;:&#39;</span><span class="op" id="3358936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358941">d</span><span class="op" id="3358942">.</span><span class="ident" id="3358943">scan</span><span class="op" id="3358947">.</span><span class="ident" id="3358948">step</span><span class="op" id="3358952">(</span><span class="op" id="3358953">&amp;</span><span class="ident" id="3358954">d</span><span class="op" id="3358955">.</span><span class="ident" id="3358956">scan</span><span class="op" id="3358960">,</span>&nbsp;<span class="string" id="3358962">&#39;&#34;&#39;</span><span class="op" id="3358965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358970">d</span><span class="op" id="3358971">.</span><span class="ident" id="3358972">scan</span><span class="op" id="3358976">.</span><span class="ident" id="3358977">step</span><span class="op" id="3358981">(</span><span class="op" id="3358982">&amp;</span><span class="ident" id="3358983">d</span><span class="op" id="3358984">.</span><span class="ident" id="3358985">scan</span><span class="op" id="3358989">,</span>&nbsp;<span class="string" id="3358991">&#39;&#34;&#39;</span><span class="op" id="3358994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3358999">d</span><span class="op" id="3359000">.</span><span class="ident" id="3359001">scan</span><span class="op" id="3359005">.</span><span class="ident" id="3359006">step</span><span class="op" id="3359010">(</span><span class="op" id="3359011">&amp;</span><span class="ident" id="3359012">d</span><span class="op" id="3359013">.</span><span class="ident" id="3359014">scan</span><span class="op" id="3359018">,</span>&nbsp;<span class="string" id="3359020">&#39;}&#39;</span><span class="op" id="3359023">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3359027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3359040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359044">switch</span>&nbsp;<span class="ident" id="3359051">op</span>&nbsp;<span class="op" id="3359054">:=</span>&nbsp;<span class="ident" id="3359057">d</span><span class="op" id="3359058">.</span><span class="ident" id="3359059">scanWhile</span><span class="op" id="3359068">(</span><span class="ident" id="3359069">scanSkipSpace</span><span class="op" id="3359082">)</span><span class="op" id="3359083">;</span>&nbsp;<span class="ident" id="3359085">op</span>&nbsp;<span class="op" id="3359088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359091">default</span><span class="op" id="3359098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359102">d</span><span class="op" id="3359103">.</span><span class="builtintype" id="3359104">error</span><span class="op" id="3359109">(</span><span class="ident" id="3359110">errPhase</span><span class="op" id="3359118">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359122">case</span>&nbsp;<span class="ident" id="3359127">scanBeginArray</span><span class="op" id="3359141">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359145">d</span><span class="op" id="3359146">.</span><span class="ident" id="3359147">array</span><span class="op" id="3359152">(</span><span class="ident" id="3359153">v</span><span class="op" id="3359154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359158">case</span>&nbsp;<span class="ident" id="3359163">scanBeginObject</span><span class="op" id="3359178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359182">d</span><span class="op" id="3359183">.</span><span class="ident" id="3359184">object</span><span class="op" id="3359190">(</span><span class="ident" id="3359191">v</span><span class="op" id="3359192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359196">case</span>&nbsp;<span class="ident" id="3359201">scanBeginLiteral</span><span class="op" id="3359217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359221">d</span><span class="op" id="3359222">.</span><span class="ident" id="3359223">literal</span><span class="op" id="3359230">(</span><span class="ident" id="3359231">v</span><span class="op" id="3359232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3359235">}</span><br>
<span class="lineno"></span><span class="op" id="3359237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="3359240">type</span>&nbsp;<span class="ident" id="3359245">unquotedValue</span>&nbsp;<span class="keyword" id="3359259">struct</span><span class="op" id="3359265">{</span><span class="op" id="3359266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3359269">//&nbsp;valueQuoted&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;decodes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3359312">//&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;literal&nbsp;null&nbsp;into&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3359378">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;anything&nbsp;other&nbsp;than&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;null,</span><br>
<span class="lineno">300</span><span class="comment" id="3359446">//&nbsp;valueQuoted&nbsp;returns&nbsp;unquotedValue{}.</span><br>
<span class="lineno"></span><span class="keyword" id="3359486">func</span>&nbsp;<span class="op" id="3359491">(</span><span class="ident" id="3359492">d</span>&nbsp;<span class="op" id="3359494">*</span><span class="ident" id="3359495">decodeState</span><span class="op" id="3359506">)</span>&nbsp;<span class="ident" id="3359508">valueQuoted</span><span class="op" id="3359519">(</span><span class="op" id="3359520">)</span>&nbsp;<span class="keyword" id="3359522">interface</span><span class="op" id="3359531">{</span><span class="op" id="3359532">}</span>&nbsp;<span class="op" id="3359534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359537">switch</span>&nbsp;<span class="ident" id="3359544">op</span>&nbsp;<span class="op" id="3359547">:=</span>&nbsp;<span class="ident" id="3359550">d</span><span class="op" id="3359551">.</span><span class="ident" id="3359552">scanWhile</span><span class="op" id="3359561">(</span><span class="ident" id="3359562">scanSkipSpace</span><span class="op" id="3359575">)</span><span class="op" id="3359576">;</span>&nbsp;<span class="ident" id="3359578">op</span>&nbsp;<span class="op" id="3359581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359584">default</span><span class="op" id="3359591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359595">d</span><span class="op" id="3359596">.</span><span class="builtintype" id="3359597">error</span><span class="op" id="3359602">(</span><span class="ident" id="3359603">errPhase</span><span class="op" id="3359611">)</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359615">case</span>&nbsp;<span class="ident" id="3359620">scanBeginArray</span><span class="op" id="3359634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359638">d</span><span class="op" id="3359639">.</span><span class="ident" id="3359640">array</span><span class="op" id="3359645">(</span><span class="ident" id="3359646">reflect</span><span class="op" id="3359653">.</span><span class="ident" id="3359654">Value</span><span class="op" id="3359659">{</span><span class="op" id="3359660">}</span><span class="op" id="3359661">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359665">case</span>&nbsp;<span class="ident" id="3359670">scanBeginObject</span><span class="op" id="3359685">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3359689">d</span><span class="op" id="3359690">.</span><span class="ident" id="3359691">object</span><span class="op" id="3359697">(</span><span class="ident" id="3359698">reflect</span><span class="op" id="3359705">.</span><span class="ident" id="3359706">Value</span><span class="op" id="3359711">{</span><span class="op" id="3359712">}</span><span class="op" id="3359713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359717">case</span>&nbsp;<span class="ident" id="3359722">scanBeginLiteral</span><span class="op" id="3359738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359742">switch</span>&nbsp;<span class="ident" id="3359749">v</span>&nbsp;<span class="op" id="3359751">:=</span>&nbsp;<span class="ident" id="3359754">d</span><span class="op" id="3359755">.</span><span class="ident" id="3359756">literalInterface</span><span class="op" id="3359772">(</span><span class="op" id="3359773">)</span><span class="op" id="3359774">.</span><span class="op" id="3359775">(</span><span class="keyword" id="3359776">type</span><span class="op" id="3359780">)</span>&nbsp;<span class="op" id="3359782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359786">case</span>&nbsp;<span class="builtintype" id="3359791">nil</span><span class="op" id="3359794">,</span>&nbsp;<span class="builtintype" id="3359796">string</span><span class="op" id="3359802">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359807">return</span>&nbsp;<span class="ident" id="3359814">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3359818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3359821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3359824">return</span>&nbsp;<span class="ident" id="3359831">unquotedValue</span><span class="op" id="3359844">{</span><span class="op" id="3359845">}</span><br>
<span class="lineno"></span><span class="op" id="3359847">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="3359850">//&nbsp;indirect&nbsp;walks&nbsp;down&nbsp;v&nbsp;allocating&nbsp;pointers&nbsp;as&nbsp;needed,</span><br>
<span class="lineno"></span><span class="comment" id="3359906">//&nbsp;until&nbsp;it&nbsp;gets&nbsp;to&nbsp;a&nbsp;non-pointer.</span><br>
<span class="lineno"></span><span class="comment" id="3359941">//&nbsp;if&nbsp;it&nbsp;encounters&nbsp;an&nbsp;Unmarshaler,&nbsp;indirect&nbsp;stops&nbsp;and&nbsp;returns&nbsp;that.</span><br>
<span class="lineno"></span><span class="comment" id="3360010">//&nbsp;if&nbsp;decodingNull&nbsp;is&nbsp;true,&nbsp;indirect&nbsp;stops&nbsp;at&nbsp;the&nbsp;last&nbsp;pointer&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;set&nbsp;to&nbsp;nil.</span><br>
<span class="lineno">325</span><span class="keyword" id="3360098">func</span>&nbsp;<span class="op" id="3360103">(</span><span class="ident" id="3360104">d</span>&nbsp;<span class="op" id="3360106">*</span><span class="ident" id="3360107">decodeState</span><span class="op" id="3360118">)</span>&nbsp;<span class="ident" id="3360120">indirect</span><span class="op" id="3360128">(</span><span class="ident" id="3360129">v</span>&nbsp;<span class="ident" id="3360131">reflect</span><span class="op" id="3360138">.</span><span class="ident" id="3360139">Value</span><span class="op" id="3360144">,</span>&nbsp;<span class="ident" id="3360146">decodingNull</span>&nbsp;<span class="builtintype" id="3360159">bool</span><span class="op" id="3360163">)</span>&nbsp;<span class="op" id="3360165">(</span><span class="ident" id="3360166">Unmarshaler</span><span class="op" id="3360177">,</span>&nbsp;<span class="ident" id="3360179">encoding</span><span class="op" id="3360187">.</span><span class="ident" id="3360188">TextUnmarshaler</span><span class="op" id="3360203">,</span>&nbsp;<span class="ident" id="3360205">reflect</span><span class="op" id="3360212">.</span><span class="ident" id="3360213">Value</span><span class="op" id="3360218">)</span>&nbsp;<span class="op" id="3360220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3360223">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;named&nbsp;type&nbsp;and&nbsp;is&nbsp;addressable,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3360268">//&nbsp;start&nbsp;with&nbsp;its&nbsp;address,&nbsp;so&nbsp;that&nbsp;if&nbsp;the&nbsp;type&nbsp;has&nbsp;pointer&nbsp;methods,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3360337">//&nbsp;we&nbsp;find&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360355">if</span>&nbsp;<span class="ident" id="3360358">v</span><span class="op" id="3360359">.</span><span class="ident" id="3360360">Kind</span><span class="op" id="3360364">(</span><span class="op" id="3360365">)</span>&nbsp;<span class="op" id="3360367">!=</span>&nbsp;<span class="ident" id="3360370">reflect</span><span class="op" id="3360377">.</span><span class="ident" id="3360378">Ptr</span>&nbsp;<span class="op" id="3360382">&amp;&amp;</span>&nbsp;<span class="ident" id="3360385">v</span><span class="op" id="3360386">.</span><span class="ident" id="3360387">Type</span><span class="op" id="3360391">(</span><span class="op" id="3360392">)</span><span class="op" id="3360393">.</span><span class="ident" id="3360394">Name</span><span class="op" id="3360398">(</span><span class="op" id="3360399">)</span>&nbsp;<span class="op" id="3360401">!=</span>&nbsp;<span class="string" id="3360404">&#34;&#34;</span>&nbsp;<span class="op" id="3360407">&amp;&amp;</span>&nbsp;<span class="ident" id="3360410">v</span><span class="op" id="3360411">.</span><span class="ident" id="3360412">CanAddr</span><span class="op" id="3360419">(</span><span class="op" id="3360420">)</span>&nbsp;<span class="op" id="3360422">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3360426">v</span>&nbsp;<span class="op" id="3360428">=</span>&nbsp;<span class="ident" id="3360430">v</span><span class="op" id="3360431">.</span><span class="ident" id="3360432">Addr</span><span class="op" id="3360436">(</span><span class="op" id="3360437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360443">for</span>&nbsp;<span class="op" id="3360447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3360451">//&nbsp;Load&nbsp;value&nbsp;from&nbsp;interface,&nbsp;but&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3360514">//&nbsp;usefully&nbsp;addressable.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360541">if</span>&nbsp;<span class="ident" id="3360544">v</span><span class="op" id="3360545">.</span><span class="ident" id="3360546">Kind</span><span class="op" id="3360550">(</span><span class="op" id="3360551">)</span>&nbsp;<span class="op" id="3360553">==</span>&nbsp;<span class="ident" id="3360556">reflect</span><span class="op" id="3360563">.</span><span class="ident" id="3360564">Interface</span>&nbsp;<span class="op" id="3360574">&amp;&amp;</span>&nbsp;<span class="op" id="3360577">!</span><span class="ident" id="3360578">v</span><span class="op" id="3360579">.</span><span class="ident" id="3360580">IsNil</span><span class="op" id="3360585">(</span><span class="op" id="3360586">)</span>&nbsp;<span class="op" id="3360588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3360593">e</span>&nbsp;<span class="op" id="3360595">:=</span>&nbsp;<span class="ident" id="3360598">v</span><span class="op" id="3360599">.</span><span class="ident" id="3360600">Elem</span><span class="op" id="3360604">(</span><span class="op" id="3360605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360610">if</span>&nbsp;<span class="ident" id="3360613">e</span><span class="op" id="3360614">.</span><span class="ident" id="3360615">Kind</span><span class="op" id="3360619">(</span><span class="op" id="3360620">)</span>&nbsp;<span class="op" id="3360622">==</span>&nbsp;<span class="ident" id="3360625">reflect</span><span class="op" id="3360632">.</span><span class="ident" id="3360633">Ptr</span>&nbsp;<span class="op" id="3360637">&amp;&amp;</span>&nbsp;<span class="op" id="3360640">!</span><span class="ident" id="3360641">e</span><span class="op" id="3360642">.</span><span class="ident" id="3360643">IsNil</span><span class="op" id="3360648">(</span><span class="op" id="3360649">)</span>&nbsp;<span class="op" id="3360651">&amp;&amp;</span>&nbsp;<span class="op" id="3360654">(</span><span class="op" id="3360655">!</span><span class="ident" id="3360656">decodingNull</span>&nbsp;<span class="op" id="3360669">||</span>&nbsp;<span class="ident" id="3360672">e</span><span class="op" id="3360673">.</span><span class="ident" id="3360674">Elem</span><span class="op" id="3360678">(</span><span class="op" id="3360679">)</span><span class="op" id="3360680">.</span><span class="ident" id="3360681">Kind</span><span class="op" id="3360685">(</span><span class="op" id="3360686">)</span>&nbsp;<span class="op" id="3360688">==</span>&nbsp;<span class="ident" id="3360691">reflect</span><span class="op" id="3360698">.</span><span class="ident" id="3360699">Ptr</span><span class="op" id="3360702">)</span>&nbsp;<span class="op" id="3360704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3360710">v</span>&nbsp;<span class="op" id="3360712">=</span>&nbsp;<span class="ident" id="3360714">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360720">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360741">if</span>&nbsp;<span class="ident" id="3360744">v</span><span class="op" id="3360745">.</span><span class="ident" id="3360746">Kind</span><span class="op" id="3360750">(</span><span class="op" id="3360751">)</span>&nbsp;<span class="op" id="3360753">!=</span>&nbsp;<span class="ident" id="3360756">reflect</span><span class="op" id="3360763">.</span><span class="ident" id="3360764">Ptr</span>&nbsp;<span class="op" id="3360768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360773">break</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360786">if</span>&nbsp;<span class="ident" id="3360789">v</span><span class="op" id="3360790">.</span><span class="ident" id="3360791">Elem</span><span class="op" id="3360795">(</span><span class="op" id="3360796">)</span><span class="op" id="3360797">.</span><span class="ident" id="3360798">Kind</span><span class="op" id="3360802">(</span><span class="op" id="3360803">)</span>&nbsp;<span class="op" id="3360805">!=</span>&nbsp;<span class="ident" id="3360808">reflect</span><span class="op" id="3360815">.</span><span class="ident" id="3360816">Ptr</span>&nbsp;<span class="op" id="3360820">&amp;&amp;</span>&nbsp;<span class="ident" id="3360823">decodingNull</span>&nbsp;<span class="op" id="3360836">&amp;&amp;</span>&nbsp;<span class="ident" id="3360839">v</span><span class="op" id="3360840">.</span><span class="ident" id="3360841">CanSet</span><span class="op" id="3360847">(</span><span class="op" id="3360848">)</span>&nbsp;<span class="op" id="3360850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360855">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360863">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360867">if</span>&nbsp;<span class="ident" id="3360870">v</span><span class="op" id="3360871">.</span><span class="ident" id="3360872">IsNil</span><span class="op" id="3360877">(</span><span class="op" id="3360878">)</span>&nbsp;<span class="op" id="3360880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3360885">v</span><span class="op" id="3360886">.</span><span class="ident" id="3360887">Set</span><span class="op" id="3360890">(</span><span class="ident" id="3360891">reflect</span><span class="op" id="3360898">.</span><span class="ident" id="3360899">New</span><span class="op" id="3360902">(</span><span class="ident" id="3360903">v</span><span class="op" id="3360904">.</span><span class="ident" id="3360905">Type</span><span class="op" id="3360909">(</span><span class="op" id="3360910">)</span><span class="op" id="3360911">.</span><span class="ident" id="3360912">Elem</span><span class="op" id="3360916">(</span><span class="op" id="3360917">)</span><span class="op" id="3360918">)</span><span class="op" id="3360919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3360923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360927">if</span>&nbsp;<span class="ident" id="3360930">v</span><span class="op" id="3360931">.</span><span class="ident" id="3360932">Type</span><span class="op" id="3360936">(</span><span class="op" id="3360937">)</span><span class="op" id="3360938">.</span><span class="ident" id="3360939">NumMethod</span><span class="op" id="3360948">(</span><span class="op" id="3360949">)</span>&nbsp;<span class="op" id="3360951">&gt;</span>&nbsp;<span class="num" id="3360953">0</span>&nbsp;<span class="op" id="3360955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3360960">if</span>&nbsp;<span class="ident" id="3360963">u</span><span class="op" id="3360964">,</span>&nbsp;<span class="ident" id="3360966">ok</span>&nbsp;<span class="op" id="3360969">:=</span>&nbsp;<span class="ident" id="3360972">v</span><span class="op" id="3360973">.</span><span class="ident" id="3360974">Interface</span><span class="op" id="3360983">(</span><span class="op" id="3360984">)</span><span class="op" id="3360985">.</span><span class="op" id="3360986">(</span><span class="ident" id="3360987">Unmarshaler</span><span class="op" id="3360998">)</span><span class="op" id="3360999">;</span>&nbsp;<span class="ident" id="3361001">ok</span>&nbsp;<span class="op" id="3361004">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361010">return</span>&nbsp;<span class="ident" id="3361017">u</span><span class="op" id="3361018">,</span>&nbsp;<span class="builtintype" id="3361020">nil</span><span class="op" id="3361023">,</span>&nbsp;<span class="ident" id="3361025">reflect</span><span class="op" id="3361032">.</span><span class="ident" id="3361033">Value</span><span class="op" id="3361038">{</span><span class="op" id="3361039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361049">if</span>&nbsp;<span class="ident" id="3361052">u</span><span class="op" id="3361053">,</span>&nbsp;<span class="ident" id="3361055">ok</span>&nbsp;<span class="op" id="3361058">:=</span>&nbsp;<span class="ident" id="3361061">v</span><span class="op" id="3361062">.</span><span class="ident" id="3361063">Interface</span><span class="op" id="3361072">(</span><span class="op" id="3361073">)</span><span class="op" id="3361074">.</span><span class="op" id="3361075">(</span><span class="ident" id="3361076">encoding</span><span class="op" id="3361084">.</span><span class="ident" id="3361085">TextUnmarshaler</span><span class="op" id="3361100">)</span><span class="op" id="3361101">;</span>&nbsp;<span class="ident" id="3361103">ok</span>&nbsp;<span class="op" id="3361106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361112">return</span>&nbsp;<span class="builtintype" id="3361119">nil</span><span class="op" id="3361122">,</span>&nbsp;<span class="ident" id="3361124">u</span><span class="op" id="3361125">,</span>&nbsp;<span class="ident" id="3361127">reflect</span><span class="op" id="3361134">.</span><span class="ident" id="3361135">Value</span><span class="op" id="3361140">{</span><span class="op" id="3361141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361146">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361154">v</span>&nbsp;<span class="op" id="3361156">=</span>&nbsp;<span class="ident" id="3361158">v</span><span class="op" id="3361159">.</span><span class="ident" id="3361160">Elem</span><span class="op" id="3361164">(</span><span class="op" id="3361165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361171">return</span>&nbsp;<span class="builtintype" id="3361178">nil</span><span class="op" id="3361181">,</span>&nbsp;<span class="builtintype" id="3361183">nil</span><span class="op" id="3361186">,</span>&nbsp;<span class="ident" id="3361188">v</span><br>
<span class="lineno"></span><span class="op" id="3361190">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3361193">//&nbsp;array&nbsp;consumes&nbsp;an&nbsp;array&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3361270">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;array&nbsp;(&#39;[&#39;)&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="3361330">func</span>&nbsp;<span class="op" id="3361335">(</span><span class="ident" id="3361336">d</span>&nbsp;<span class="op" id="3361338">*</span><span class="ident" id="3361339">decodeState</span><span class="op" id="3361350">)</span>&nbsp;<span class="ident" id="3361352">array</span><span class="op" id="3361357">(</span><span class="ident" id="3361358">v</span>&nbsp;<span class="ident" id="3361360">reflect</span><span class="op" id="3361367">.</span><span class="ident" id="3361368">Value</span><span class="op" id="3361373">)</span>&nbsp;<span class="op" id="3361375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361378">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361405">u</span><span class="op" id="3361406">,</span>&nbsp;<span class="ident" id="3361408">ut</span><span class="op" id="3361410">,</span>&nbsp;<span class="ident" id="3361412">pv</span>&nbsp;<span class="op" id="3361415">:=</span>&nbsp;<span class="ident" id="3361418">d</span><span class="op" id="3361419">.</span><span class="ident" id="3361420">indirect</span><span class="op" id="3361428">(</span><span class="ident" id="3361429">v</span><span class="op" id="3361430">,</span>&nbsp;<span class="builtintype" id="3361432">false</span><span class="op" id="3361437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361440">if</span>&nbsp;<span class="ident" id="3361443">u</span>&nbsp;<span class="op" id="3361445">!=</span>&nbsp;<span class="builtintype" id="3361448">nil</span>&nbsp;<span class="op" id="3361452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361456">d</span><span class="op" id="3361457">.</span><span class="ident" id="3361458">off</span><span class="op" id="3361461">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361466">err</span>&nbsp;<span class="op" id="3361470">:=</span>&nbsp;<span class="ident" id="3361473">u</span><span class="op" id="3361474">.</span><span class="ident" id="3361475">UnmarshalJSON</span><span class="op" id="3361488">(</span><span class="ident" id="3361489">d</span><span class="op" id="3361490">.</span><span class="ident" id="3361491">next</span><span class="op" id="3361495">(</span><span class="op" id="3361496">)</span><span class="op" id="3361497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361501">if</span>&nbsp;<span class="ident" id="3361504">err</span>&nbsp;<span class="op" id="3361508">!=</span>&nbsp;<span class="builtintype" id="3361511">nil</span>&nbsp;<span class="op" id="3361515">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361520">d</span><span class="op" id="3361521">.</span><span class="builtintype" id="3361522">error</span><span class="op" id="3361527">(</span><span class="ident" id="3361528">err</span><span class="op" id="3361531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361550">if</span>&nbsp;<span class="ident" id="3361553">ut</span>&nbsp;<span class="op" id="3361556">!=</span>&nbsp;<span class="builtintype" id="3361559">nil</span>&nbsp;<span class="op" id="3361563">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361567">d</span><span class="op" id="3361568">.</span><span class="ident" id="3361569">saveError</span><span class="op" id="3361578">(</span><span class="op" id="3361579">&amp;</span><span class="ident" id="3361580">UnmarshalTypeError</span><span class="op" id="3361598">{</span><span class="string" id="3361599">&#34;array&#34;</span><span class="op" id="3361606">,</span>&nbsp;<span class="ident" id="3361608">v</span><span class="op" id="3361609">.</span><span class="ident" id="3361610">Type</span><span class="op" id="3361614">(</span><span class="op" id="3361615">)</span><span class="op" id="3361616">}</span><span class="op" id="3361617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361621">d</span><span class="op" id="3361622">.</span><span class="ident" id="3361623">off</span><span class="op" id="3361626">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361631">d</span><span class="op" id="3361632">.</span><span class="ident" id="3361633">next</span><span class="op" id="3361637">(</span><span class="op" id="3361638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361642">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361650">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361654">v</span>&nbsp;<span class="op" id="3361656">=</span>&nbsp;<span class="ident" id="3361658">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361663">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361689">switch</span>&nbsp;<span class="ident" id="3361696">v</span><span class="op" id="3361697">.</span><span class="ident" id="3361698">Kind</span><span class="op" id="3361702">(</span><span class="op" id="3361703">)</span>&nbsp;<span class="op" id="3361705">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361708">case</span>&nbsp;<span class="ident" id="3361713">reflect</span><span class="op" id="3361720">.</span><span class="ident" id="3361721">Interface</span><span class="op" id="3361730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361734">if</span>&nbsp;<span class="ident" id="3361737">v</span><span class="op" id="3361738">.</span><span class="ident" id="3361739">NumMethod</span><span class="op" id="3361748">(</span><span class="op" id="3361749">)</span>&nbsp;<span class="op" id="3361751">==</span>&nbsp;<span class="num" id="3361754">0</span>&nbsp;<span class="op" id="3361756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361761">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361825">v</span><span class="op" id="3361826">.</span><span class="ident" id="3361827">Set</span><span class="op" id="3361830">(</span><span class="ident" id="3361831">reflect</span><span class="op" id="3361838">.</span><span class="ident" id="3361839">ValueOf</span><span class="op" id="3361846">(</span><span class="ident" id="3361847">d</span><span class="op" id="3361848">.</span><span class="ident" id="3361849">arrayInterface</span><span class="op" id="3361863">(</span><span class="op" id="3361864">)</span><span class="op" id="3361865">)</span><span class="op" id="3361866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361871">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3361880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361884">//&nbsp;Otherwise&nbsp;it&#39;s&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361913">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3361926">default</span><span class="op" id="3361933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361937">d</span><span class="op" id="3361938">.</span><span class="ident" id="3361939">saveError</span><span class="op" id="3361948">(</span><span class="op" id="3361949">&amp;</span><span class="ident" id="3361950">UnmarshalTypeError</span><span class="op" id="3361968">{</span><span class="string" id="3361969">&#34;array&#34;</span><span class="op" id="3361976">,</span>&nbsp;<span class="ident" id="3361978">v</span><span class="op" id="3361979">.</span><span class="ident" id="3361980">Type</span><span class="op" id="3361984">(</span><span class="op" id="3361985">)</span><span class="op" id="3361986">}</span><span class="op" id="3361987">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361991">d</span><span class="op" id="3361992">.</span><span class="ident" id="3361993">off</span><span class="op" id="3361996">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362001">d</span><span class="op" id="3362002">.</span><span class="ident" id="3362003">next</span><span class="op" id="3362007">(</span><span class="op" id="3362008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362012">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362020">case</span>&nbsp;<span class="ident" id="3362025">reflect</span><span class="op" id="3362032">.</span><span class="ident" id="3362033">Array</span><span class="op" id="3362038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362041">case</span>&nbsp;<span class="ident" id="3362046">reflect</span><span class="op" id="3362053">.</span><span class="ident" id="3362054">Slice</span><span class="op" id="3362059">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362063">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362074">i</span>&nbsp;<span class="op" id="3362076">:=</span>&nbsp;<span class="num" id="3362079">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362082">for</span>&nbsp;<span class="op" id="3362086">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362090">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362150">op</span>&nbsp;<span class="op" id="3362153">:=</span>&nbsp;<span class="ident" id="3362156">d</span><span class="op" id="3362157">.</span><span class="ident" id="3362158">scanWhile</span><span class="op" id="3362167">(</span><span class="ident" id="3362168">scanSkipSpace</span><span class="op" id="3362181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362185">if</span>&nbsp;<span class="ident" id="3362188">op</span>&nbsp;<span class="op" id="3362191">==</span>&nbsp;<span class="ident" id="3362194">scanEndArray</span>&nbsp;<span class="op" id="3362207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362212">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362220">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362225">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362281">d</span><span class="op" id="3362282">.</span><span class="ident" id="3362283">off</span><span class="op" id="3362286">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362291">d</span><span class="op" id="3362292">.</span><span class="ident" id="3362293">scan</span><span class="op" id="3362297">.</span><span class="ident" id="3362298">undo</span><span class="op" id="3362302">(</span><span class="ident" id="3362303">op</span><span class="op" id="3362305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362310">//&nbsp;Get&nbsp;element&nbsp;of&nbsp;array,&nbsp;growing&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362359">if</span>&nbsp;<span class="ident" id="3362362">v</span><span class="op" id="3362363">.</span><span class="ident" id="3362364">Kind</span><span class="op" id="3362368">(</span><span class="op" id="3362369">)</span>&nbsp;<span class="op" id="3362371">==</span>&nbsp;<span class="ident" id="3362374">reflect</span><span class="op" id="3362381">.</span><span class="ident" id="3362382">Slice</span>&nbsp;<span class="op" id="3362388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362393">//&nbsp;Grow&nbsp;slice&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362423">if</span>&nbsp;<span class="ident" id="3362426">i</span>&nbsp;<span class="op" id="3362428">&gt;=</span>&nbsp;<span class="ident" id="3362431">v</span><span class="op" id="3362432">.</span><span class="ident" id="3362433">Cap</span><span class="op" id="3362436">(</span><span class="op" id="3362437">)</span>&nbsp;<span class="op" id="3362439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362445">newcap</span>&nbsp;<span class="op" id="3362452">:=</span>&nbsp;<span class="ident" id="3362455">v</span><span class="op" id="3362456">.</span><span class="ident" id="3362457">Cap</span><span class="op" id="3362460">(</span><span class="op" id="3362461">)</span>&nbsp;<span class="op" id="3362463">+</span>&nbsp;<span class="ident" id="3362465">v</span><span class="op" id="3362466">.</span><span class="ident" id="3362467">Cap</span><span class="op" id="3362470">(</span><span class="op" id="3362471">)</span><span class="op" id="3362472">/</span><span class="num" id="3362473">2</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362479">if</span>&nbsp;<span class="ident" id="3362482">newcap</span>&nbsp;<span class="op" id="3362489">&lt;</span>&nbsp;<span class="num" id="3362491">4</span>&nbsp;<span class="op" id="3362493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362500">newcap</span>&nbsp;<span class="op" id="3362507">=</span>&nbsp;<span class="num" id="3362509">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362521">newv</span>&nbsp;<span class="op" id="3362526">:=</span>&nbsp;<span class="ident" id="3362529">reflect</span><span class="op" id="3362536">.</span><span class="ident" id="3362537">MakeSlice</span><span class="op" id="3362546">(</span><span class="ident" id="3362547">v</span><span class="op" id="3362548">.</span><span class="ident" id="3362549">Type</span><span class="op" id="3362553">(</span><span class="op" id="3362554">)</span><span class="op" id="3362555">,</span>&nbsp;<span class="ident" id="3362557">v</span><span class="op" id="3362558">.</span><span class="ident" id="3362559">Len</span><span class="op" id="3362562">(</span><span class="op" id="3362563">)</span><span class="op" id="3362564">,</span>&nbsp;<span class="ident" id="3362566">newcap</span><span class="op" id="3362572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362578">reflect</span><span class="op" id="3362585">.</span><span class="ident" id="3362586">Copy</span><span class="op" id="3362590">(</span><span class="ident" id="3362591">newv</span><span class="op" id="3362595">,</span>&nbsp;<span class="ident" id="3362597">v</span><span class="op" id="3362598">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362604">v</span><span class="op" id="3362605">.</span><span class="ident" id="3362606">Set</span><span class="op" id="3362609">(</span><span class="ident" id="3362610">newv</span><span class="op" id="3362614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362624">if</span>&nbsp;<span class="ident" id="3362627">i</span>&nbsp;<span class="op" id="3362629">&gt;=</span>&nbsp;<span class="ident" id="3362632">v</span><span class="op" id="3362633">.</span><span class="ident" id="3362634">Len</span><span class="op" id="3362637">(</span><span class="op" id="3362638">)</span>&nbsp;<span class="op" id="3362640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362646">v</span><span class="op" id="3362647">.</span><span class="ident" id="3362648">SetLen</span><span class="op" id="3362654">(</span><span class="ident" id="3362655">i</span>&nbsp;<span class="op" id="3362657">+</span>&nbsp;<span class="num" id="3362659">1</span><span class="op" id="3362660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362665">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362674">if</span>&nbsp;<span class="ident" id="3362677">i</span>&nbsp;<span class="op" id="3362679">&lt;</span>&nbsp;<span class="ident" id="3362681">v</span><span class="op" id="3362682">.</span><span class="ident" id="3362683">Len</span><span class="op" id="3362686">(</span><span class="op" id="3362687">)</span>&nbsp;<span class="op" id="3362689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362694">//&nbsp;Decode&nbsp;into&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362721">d</span><span class="op" id="3362722">.</span><span class="ident" id="3362723">value</span><span class="op" id="3362728">(</span><span class="ident" id="3362729">v</span><span class="op" id="3362730">.</span><span class="ident" id="3362731">Index</span><span class="op" id="3362736">(</span><span class="ident" id="3362737">i</span><span class="op" id="3362738">)</span><span class="op" id="3362739">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362743">}</span>&nbsp;<span class="keyword" id="3362745">else</span>&nbsp;<span class="op" id="3362750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362755">//&nbsp;Ran&nbsp;out&nbsp;of&nbsp;fixed&nbsp;array:&nbsp;skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362791">d</span><span class="op" id="3362792">.</span><span class="ident" id="3362793">value</span><span class="op" id="3362798">(</span><span class="ident" id="3362799">reflect</span><span class="op" id="3362806">.</span><span class="ident" id="3362807">Value</span><span class="op" id="3362812">{</span><span class="op" id="3362813">}</span><span class="op" id="3362814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362822">i</span><span class="op" id="3362823">++</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362829">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362861">op</span>&nbsp;<span class="op" id="3362864">=</span>&nbsp;<span class="ident" id="3362866">d</span><span class="op" id="3362867">.</span><span class="ident" id="3362868">scanWhile</span><span class="op" id="3362877">(</span><span class="ident" id="3362878">scanSkipSpace</span><span class="op" id="3362891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362895">if</span>&nbsp;<span class="ident" id="3362898">op</span>&nbsp;<span class="op" id="3362901">==</span>&nbsp;<span class="ident" id="3362904">scanEndArray</span>&nbsp;<span class="op" id="3362917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362922">break</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362934">if</span>&nbsp;<span class="ident" id="3362937">op</span>&nbsp;<span class="op" id="3362940">!=</span>&nbsp;<span class="ident" id="3362943">scanArrayValue</span>&nbsp;<span class="op" id="3362958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362963">d</span><span class="op" id="3362964">.</span><span class="builtintype" id="3362965">error</span><span class="op" id="3362970">(</span><span class="ident" id="3362971">errPhase</span><span class="op" id="3362979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362986">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362990">if</span>&nbsp;<span class="ident" id="3362993">i</span>&nbsp;<span class="op" id="3362995">&lt;</span>&nbsp;<span class="ident" id="3362997">v</span><span class="op" id="3362998">.</span><span class="ident" id="3362999">Len</span><span class="op" id="3363002">(</span><span class="op" id="3363003">)</span>&nbsp;<span class="op" id="3363005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363009">if</span>&nbsp;<span class="ident" id="3363012">v</span><span class="op" id="3363013">.</span><span class="ident" id="3363014">Kind</span><span class="op" id="3363018">(</span><span class="op" id="3363019">)</span>&nbsp;<span class="op" id="3363021">==</span>&nbsp;<span class="ident" id="3363024">reflect</span><span class="op" id="3363031">.</span><span class="ident" id="3363032">Array</span>&nbsp;<span class="op" id="3363038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363043">//&nbsp;Array.&nbsp;&nbsp;Zero&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363072">z</span>&nbsp;<span class="op" id="3363074">:=</span>&nbsp;<span class="ident" id="3363077">reflect</span><span class="op" id="3363084">.</span><span class="ident" id="3363085">Zero</span><span class="op" id="3363089">(</span><span class="ident" id="3363090">v</span><span class="op" id="3363091">.</span><span class="ident" id="3363092">Type</span><span class="op" id="3363096">(</span><span class="op" id="3363097">)</span><span class="op" id="3363098">.</span><span class="ident" id="3363099">Elem</span><span class="op" id="3363103">(</span><span class="op" id="3363104">)</span><span class="op" id="3363105">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363110">for</span>&nbsp;<span class="op" id="3363114">;</span>&nbsp;<span class="ident" id="3363116">i</span>&nbsp;<span class="op" id="3363118">&lt;</span>&nbsp;<span class="ident" id="3363120">v</span><span class="op" id="3363121">.</span><span class="ident" id="3363122">Len</span><span class="op" id="3363125">(</span><span class="op" id="3363126">)</span><span class="op" id="3363127">;</span>&nbsp;<span class="ident" id="3363129">i</span><span class="op" id="3363130">++</span>&nbsp;<span class="op" id="3363133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363139">v</span><span class="op" id="3363140">.</span><span class="ident" id="3363141">Index</span><span class="op" id="3363146">(</span><span class="ident" id="3363147">i</span><span class="op" id="3363148">)</span><span class="op" id="3363149">.</span><span class="ident" id="3363150">Set</span><span class="op" id="3363153">(</span><span class="ident" id="3363154">z</span><span class="op" id="3363155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363164">}</span>&nbsp;<span class="keyword" id="3363166">else</span>&nbsp;<span class="op" id="3363171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363176">v</span><span class="op" id="3363177">.</span><span class="ident" id="3363178">SetLen</span><span class="op" id="3363184">(</span><span class="ident" id="3363185">i</span><span class="op" id="3363186">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363196">if</span>&nbsp;<span class="ident" id="3363199">i</span>&nbsp;<span class="op" id="3363201">==</span>&nbsp;<span class="num" id="3363204">0</span>&nbsp;<span class="op" id="3363206">&amp;&amp;</span>&nbsp;<span class="ident" id="3363209">v</span><span class="op" id="3363210">.</span><span class="ident" id="3363211">Kind</span><span class="op" id="3363215">(</span><span class="op" id="3363216">)</span>&nbsp;<span class="op" id="3363218">==</span>&nbsp;<span class="ident" id="3363221">reflect</span><span class="op" id="3363228">.</span><span class="ident" id="3363229">Slice</span>&nbsp;<span class="op" id="3363235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363239">v</span><span class="op" id="3363240">.</span><span class="ident" id="3363241">Set</span><span class="op" id="3363244">(</span><span class="ident" id="3363245">reflect</span><span class="op" id="3363252">.</span><span class="ident" id="3363253">MakeSlice</span><span class="op" id="3363262">(</span><span class="ident" id="3363263">v</span><span class="op" id="3363264">.</span><span class="ident" id="3363265">Type</span><span class="op" id="3363269">(</span><span class="op" id="3363270">)</span><span class="op" id="3363271">,</span>&nbsp;<span class="num" id="3363273">0</span><span class="op" id="3363274">,</span>&nbsp;<span class="num" id="3363276">0</span><span class="op" id="3363277">)</span><span class="op" id="3363278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363281">}</span><br>
<span class="lineno">470</span><span class="op" id="3363283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3363286">var</span>&nbsp;<span class="ident" id="3363290">nullLiteral</span>&nbsp;<span class="op" id="3363302">=</span>&nbsp;<span class="op" id="3363304">[</span><span class="op" id="3363305">]</span><span class="builtintype" id="3363306">byte</span><span class="op" id="3363310">(</span><span class="string" id="3363311">&#34;null&#34;</span><span class="op" id="3363317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3363320">//&nbsp;object&nbsp;consumes&nbsp;an&nbsp;object&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno">475</span><span class="comment" id="3363399">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;(&#39;{&#39;)&nbsp;of&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="3363460">func</span>&nbsp;<span class="op" id="3363465">(</span><span class="ident" id="3363466">d</span>&nbsp;<span class="op" id="3363468">*</span><span class="ident" id="3363469">decodeState</span><span class="op" id="3363480">)</span>&nbsp;<span class="ident" id="3363482">object</span><span class="op" id="3363488">(</span><span class="ident" id="3363489">v</span>&nbsp;<span class="ident" id="3363491">reflect</span><span class="op" id="3363498">.</span><span class="ident" id="3363499">Value</span><span class="op" id="3363504">)</span>&nbsp;<span class="op" id="3363506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363509">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363536">u</span><span class="op" id="3363537">,</span>&nbsp;<span class="ident" id="3363539">ut</span><span class="op" id="3363541">,</span>&nbsp;<span class="ident" id="3363543">pv</span>&nbsp;<span class="op" id="3363546">:=</span>&nbsp;<span class="ident" id="3363549">d</span><span class="op" id="3363550">.</span><span class="ident" id="3363551">indirect</span><span class="op" id="3363559">(</span><span class="ident" id="3363560">v</span><span class="op" id="3363561">,</span>&nbsp;<span class="builtintype" id="3363563">false</span><span class="op" id="3363568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363571">if</span>&nbsp;<span class="ident" id="3363574">u</span>&nbsp;<span class="op" id="3363576">!=</span>&nbsp;<span class="builtintype" id="3363579">nil</span>&nbsp;<span class="op" id="3363583">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363587">d</span><span class="op" id="3363588">.</span><span class="ident" id="3363589">off</span><span class="op" id="3363592">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363597">err</span>&nbsp;<span class="op" id="3363601">:=</span>&nbsp;<span class="ident" id="3363604">u</span><span class="op" id="3363605">.</span><span class="ident" id="3363606">UnmarshalJSON</span><span class="op" id="3363619">(</span><span class="ident" id="3363620">d</span><span class="op" id="3363621">.</span><span class="ident" id="3363622">next</span><span class="op" id="3363626">(</span><span class="op" id="3363627">)</span><span class="op" id="3363628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363632">if</span>&nbsp;<span class="ident" id="3363635">err</span>&nbsp;<span class="op" id="3363639">!=</span>&nbsp;<span class="builtintype" id="3363642">nil</span>&nbsp;<span class="op" id="3363646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363651">d</span><span class="op" id="3363652">.</span><span class="builtintype" id="3363653">error</span><span class="op" id="3363658">(</span><span class="ident" id="3363659">err</span><span class="op" id="3363662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363666">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363670">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363681">if</span>&nbsp;<span class="ident" id="3363684">ut</span>&nbsp;<span class="op" id="3363687">!=</span>&nbsp;<span class="builtintype" id="3363690">nil</span>&nbsp;<span class="op" id="3363694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363698">d</span><span class="op" id="3363699">.</span><span class="ident" id="3363700">saveError</span><span class="op" id="3363709">(</span><span class="op" id="3363710">&amp;</span><span class="ident" id="3363711">UnmarshalTypeError</span><span class="op" id="3363729">{</span><span class="string" id="3363730">&#34;object&#34;</span><span class="op" id="3363738">,</span>&nbsp;<span class="ident" id="3363740">v</span><span class="op" id="3363741">.</span><span class="ident" id="3363742">Type</span><span class="op" id="3363746">(</span><span class="op" id="3363747">)</span><span class="op" id="3363748">}</span><span class="op" id="3363749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363753">d</span><span class="op" id="3363754">.</span><span class="ident" id="3363755">off</span><span class="op" id="3363758">--</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363763">d</span><span class="op" id="3363764">.</span><span class="ident" id="3363765">next</span><span class="op" id="3363769">(</span><span class="op" id="3363770">)</span>&nbsp;<span class="comment" id="3363772">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363800">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363811">v</span>&nbsp;<span class="op" id="3363813">=</span>&nbsp;<span class="ident" id="3363815">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363820">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363882">if</span>&nbsp;<span class="ident" id="3363885">v</span><span class="op" id="3363886">.</span><span class="ident" id="3363887">Kind</span><span class="op" id="3363891">(</span><span class="op" id="3363892">)</span>&nbsp;<span class="op" id="3363894">==</span>&nbsp;<span class="ident" id="3363897">reflect</span><span class="op" id="3363904">.</span><span class="ident" id="3363905">Interface</span>&nbsp;<span class="op" id="3363915">&amp;&amp;</span>&nbsp;<span class="ident" id="3363918">v</span><span class="op" id="3363919">.</span><span class="ident" id="3363920">NumMethod</span><span class="op" id="3363929">(</span><span class="op" id="3363930">)</span>&nbsp;<span class="op" id="3363932">==</span>&nbsp;<span class="num" id="3363935">0</span>&nbsp;<span class="op" id="3363937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363941">v</span><span class="op" id="3363942">.</span><span class="ident" id="3363943">Set</span><span class="op" id="3363946">(</span><span class="ident" id="3363947">reflect</span><span class="op" id="3363954">.</span><span class="ident" id="3363955">ValueOf</span><span class="op" id="3363962">(</span><span class="ident" id="3363963">d</span><span class="op" id="3363964">.</span><span class="ident" id="3363965">objectInterface</span><span class="op" id="3363980">(</span><span class="op" id="3363981">)</span><span class="op" id="3363982">)</span><span class="op" id="3363983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363987">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363995">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363999">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target:&nbsp;struct&nbsp;or&nbsp;map[string]T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364048">switch</span>&nbsp;<span class="ident" id="3364055">v</span><span class="op" id="3364056">.</span><span class="ident" id="3364057">Kind</span><span class="op" id="3364061">(</span><span class="op" id="3364062">)</span>&nbsp;<span class="op" id="3364064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364067">case</span>&nbsp;<span class="ident" id="3364072">reflect</span><span class="op" id="3364079">.</span><span class="ident" id="3364080">Map</span><span class="op" id="3364083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364087">//&nbsp;map&nbsp;must&nbsp;have&nbsp;string&nbsp;kind</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364118">t</span>&nbsp;<span class="op" id="3364120">:=</span>&nbsp;<span class="ident" id="3364123">v</span><span class="op" id="3364124">.</span><span class="ident" id="3364125">Type</span><span class="op" id="3364129">(</span><span class="op" id="3364130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364134">if</span>&nbsp;<span class="ident" id="3364137">t</span><span class="op" id="3364138">.</span><span class="ident" id="3364139">Key</span><span class="op" id="3364142">(</span><span class="op" id="3364143">)</span><span class="op" id="3364144">.</span><span class="ident" id="3364145">Kind</span><span class="op" id="3364149">(</span><span class="op" id="3364150">)</span>&nbsp;<span class="op" id="3364152">!=</span>&nbsp;<span class="ident" id="3364155">reflect</span><span class="op" id="3364162">.</span><span class="ident" id="3364163">String</span>&nbsp;<span class="op" id="3364170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364175">d</span><span class="op" id="3364176">.</span><span class="ident" id="3364177">saveError</span><span class="op" id="3364186">(</span><span class="op" id="3364187">&amp;</span><span class="ident" id="3364188">UnmarshalTypeError</span><span class="op" id="3364206">{</span><span class="string" id="3364207">&#34;object&#34;</span><span class="op" id="3364215">,</span>&nbsp;<span class="ident" id="3364217">v</span><span class="op" id="3364218">.</span><span class="ident" id="3364219">Type</span><span class="op" id="3364223">(</span><span class="op" id="3364224">)</span><span class="op" id="3364225">}</span><span class="op" id="3364226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364231">d</span><span class="op" id="3364232">.</span><span class="ident" id="3364233">off</span><span class="op" id="3364236">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364242">d</span><span class="op" id="3364243">.</span><span class="ident" id="3364244">next</span><span class="op" id="3364248">(</span><span class="op" id="3364249">)</span>&nbsp;<span class="comment" id="3364251">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364280">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364293">if</span>&nbsp;<span class="ident" id="3364296">v</span><span class="op" id="3364297">.</span><span class="ident" id="3364298">IsNil</span><span class="op" id="3364303">(</span><span class="op" id="3364304">)</span>&nbsp;<span class="op" id="3364306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364311">v</span><span class="op" id="3364312">.</span><span class="ident" id="3364313">Set</span><span class="op" id="3364316">(</span><span class="ident" id="3364317">reflect</span><span class="op" id="3364324">.</span><span class="ident" id="3364325">MakeMap</span><span class="op" id="3364332">(</span><span class="ident" id="3364333">t</span><span class="op" id="3364334">)</span><span class="op" id="3364335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364339">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364342">case</span>&nbsp;<span class="ident" id="3364347">reflect</span><span class="op" id="3364354">.</span><span class="ident" id="3364355">Struct</span><span class="op" id="3364361">:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364365">default</span><span class="op" id="3364372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364376">d</span><span class="op" id="3364377">.</span><span class="ident" id="3364378">saveError</span><span class="op" id="3364387">(</span><span class="op" id="3364388">&amp;</span><span class="ident" id="3364389">UnmarshalTypeError</span><span class="op" id="3364407">{</span><span class="string" id="3364408">&#34;object&#34;</span><span class="op" id="3364416">,</span>&nbsp;<span class="ident" id="3364418">v</span><span class="op" id="3364419">.</span><span class="ident" id="3364420">Type</span><span class="op" id="3364424">(</span><span class="op" id="3364425">)</span><span class="op" id="3364426">}</span><span class="op" id="3364427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364431">d</span><span class="op" id="3364432">.</span><span class="ident" id="3364433">off</span><span class="op" id="3364436">--</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364441">d</span><span class="op" id="3364442">.</span><span class="ident" id="3364443">next</span><span class="op" id="3364447">(</span><span class="op" id="3364448">)</span>&nbsp;<span class="comment" id="3364450">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364478">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364490">var</span>&nbsp;<span class="ident" id="3364494">mapElem</span>&nbsp;<span class="ident" id="3364502">reflect</span><span class="op" id="3364509">.</span><span class="ident" id="3364510">Value</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364518">for</span>&nbsp;<span class="op" id="3364522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364526">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364574">op</span>&nbsp;<span class="op" id="3364577">:=</span>&nbsp;<span class="ident" id="3364580">d</span><span class="op" id="3364581">.</span><span class="ident" id="3364582">scanWhile</span><span class="op" id="3364591">(</span><span class="ident" id="3364592">scanSkipSpace</span><span class="op" id="3364605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364609">if</span>&nbsp;<span class="ident" id="3364612">op</span>&nbsp;<span class="op" id="3364615">==</span>&nbsp;<span class="ident" id="3364618">scanEndObject</span>&nbsp;<span class="op" id="3364632">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364637">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364691">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364703">if</span>&nbsp;<span class="ident" id="3364706">op</span>&nbsp;<span class="op" id="3364709">!=</span>&nbsp;<span class="ident" id="3364712">scanBeginLiteral</span>&nbsp;<span class="op" id="3364729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364734">d</span><span class="op" id="3364735">.</span><span class="builtintype" id="3364736">error</span><span class="op" id="3364741">(</span><span class="ident" id="3364742">errPhase</span><span class="op" id="3364750">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364759">//&nbsp;Read&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364774">start</span>&nbsp;<span class="op" id="3364780">:=</span>&nbsp;<span class="ident" id="3364783">d</span><span class="op" id="3364784">.</span><span class="ident" id="3364785">off</span>&nbsp;<span class="op" id="3364789">-</span>&nbsp;<span class="num" id="3364791">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364795">op</span>&nbsp;<span class="op" id="3364798">=</span>&nbsp;<span class="ident" id="3364800">d</span><span class="op" id="3364801">.</span><span class="ident" id="3364802">scanWhile</span><span class="op" id="3364811">(</span><span class="ident" id="3364812">scanContinue</span><span class="op" id="3364824">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364828">item</span>&nbsp;<span class="op" id="3364833">:=</span>&nbsp;<span class="ident" id="3364836">d</span><span class="op" id="3364837">.</span><span class="ident" id="3364838">data</span><span class="op" id="3364842">[</span><span class="ident" id="3364843">start</span>&nbsp;<span class="op" id="3364849">:</span>&nbsp;<span class="ident" id="3364851">d</span><span class="op" id="3364852">.</span><span class="ident" id="3364853">off</span><span class="op" id="3364856">-</span><span class="num" id="3364857">1</span><span class="op" id="3364858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364862">key</span><span class="op" id="3364865">,</span>&nbsp;<span class="ident" id="3364867">ok</span>&nbsp;<span class="op" id="3364870">:=</span>&nbsp;<span class="ident" id="3364873">unquoteBytes</span><span class="op" id="3364885">(</span><span class="ident" id="3364886">item</span><span class="op" id="3364890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364894">if</span>&nbsp;<span class="op" id="3364897">!</span><span class="ident" id="3364898">ok</span>&nbsp;<span class="op" id="3364901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364906">d</span><span class="op" id="3364907">.</span><span class="builtintype" id="3364908">error</span><span class="op" id="3364913">(</span><span class="ident" id="3364914">errPhase</span><span class="op" id="3364922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364926">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364931">//&nbsp;Figure&nbsp;out&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364975">var</span>&nbsp;<span class="ident" id="3364979">subv</span>&nbsp;<span class="ident" id="3364984">reflect</span><span class="op" id="3364991">.</span><span class="ident" id="3364992">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365000">destring</span>&nbsp;<span class="op" id="3365009">:=</span>&nbsp;<span class="builtintype" id="3365012">false</span>&nbsp;<span class="comment" id="3365018">//&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;wrapped&nbsp;in&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;decoded&nbsp;first</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365085">if</span>&nbsp;<span class="ident" id="3365088">v</span><span class="op" id="3365089">.</span><span class="ident" id="3365090">Kind</span><span class="op" id="3365094">(</span><span class="op" id="3365095">)</span>&nbsp;<span class="op" id="3365097">==</span>&nbsp;<span class="ident" id="3365100">reflect</span><span class="op" id="3365107">.</span><span class="ident" id="3365108">Map</span>&nbsp;<span class="op" id="3365112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365117">elemType</span>&nbsp;<span class="op" id="3365126">:=</span>&nbsp;<span class="ident" id="3365129">v</span><span class="op" id="3365130">.</span><span class="ident" id="3365131">Type</span><span class="op" id="3365135">(</span><span class="op" id="3365136">)</span><span class="op" id="3365137">.</span><span class="ident" id="3365138">Elem</span><span class="op" id="3365142">(</span><span class="op" id="3365143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365148">if</span>&nbsp;<span class="op" id="3365151">!</span><span class="ident" id="3365152">mapElem</span><span class="op" id="3365159">.</span><span class="ident" id="3365160">IsValid</span><span class="op" id="3365167">(</span><span class="op" id="3365168">)</span>&nbsp;<span class="op" id="3365170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365176">mapElem</span>&nbsp;<span class="op" id="3365184">=</span>&nbsp;<span class="ident" id="3365186">reflect</span><span class="op" id="3365193">.</span><span class="ident" id="3365194">New</span><span class="op" id="3365197">(</span><span class="ident" id="3365198">elemType</span><span class="op" id="3365206">)</span><span class="op" id="3365207">.</span><span class="ident" id="3365208">Elem</span><span class="op" id="3365212">(</span><span class="op" id="3365213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365218">}</span>&nbsp;<span class="keyword" id="3365220">else</span>&nbsp;<span class="op" id="3365225">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365231">mapElem</span><span class="op" id="3365238">.</span><span class="ident" id="3365239">Set</span><span class="op" id="3365242">(</span><span class="ident" id="3365243">reflect</span><span class="op" id="3365250">.</span><span class="ident" id="3365251">Zero</span><span class="op" id="3365255">(</span><span class="ident" id="3365256">elemType</span><span class="op" id="3365264">)</span><span class="op" id="3365265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365275">subv</span>&nbsp;<span class="op" id="3365280">=</span>&nbsp;<span class="ident" id="3365282">mapElem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365292">}</span>&nbsp;<span class="keyword" id="3365294">else</span>&nbsp;<span class="op" id="3365299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365304">var</span>&nbsp;<span class="ident" id="3365308">f</span>&nbsp;<span class="op" id="3365310">*</span><span class="ident" id="3365311">field</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365320">fields</span>&nbsp;<span class="op" id="3365327">:=</span>&nbsp;<span class="ident" id="3365330">cachedTypeFields</span><span class="op" id="3365346">(</span><span class="ident" id="3365347">v</span><span class="op" id="3365348">.</span><span class="ident" id="3365349">Type</span><span class="op" id="3365353">(</span><span class="op" id="3365354">)</span><span class="op" id="3365355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365360">for</span>&nbsp;<span class="ident" id="3365364">i</span>&nbsp;<span class="op" id="3365366">:=</span>&nbsp;<span class="keyword" id="3365369">range</span>&nbsp;<span class="ident" id="3365375">fields</span>&nbsp;<span class="op" id="3365382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365388">ff</span>&nbsp;<span class="op" id="3365391">:=</span>&nbsp;<span class="op" id="3365394">&amp;</span><span class="ident" id="3365395">fields</span><span class="op" id="3365401">[</span><span class="ident" id="3365402">i</span><span class="op" id="3365403">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365409">if</span>&nbsp;<span class="ident" id="3365412">bytes</span><span class="op" id="3365417">.</span><span class="ident" id="3365418">Equal</span><span class="op" id="3365423">(</span><span class="ident" id="3365424">ff</span><span class="op" id="3365426">.</span><span class="ident" id="3365427">nameBytes</span><span class="op" id="3365436">,</span>&nbsp;<span class="ident" id="3365438">key</span><span class="op" id="3365441">)</span>&nbsp;<span class="op" id="3365443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365450">f</span>&nbsp;<span class="op" id="3365452">=</span>&nbsp;<span class="ident" id="3365454">ff</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365462">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365478">if</span>&nbsp;<span class="ident" id="3365481">f</span>&nbsp;<span class="op" id="3365483">==</span>&nbsp;<span class="builtintype" id="3365486">nil</span>&nbsp;<span class="op" id="3365490">&amp;&amp;</span>&nbsp;<span class="ident" id="3365493">ff</span><span class="op" id="3365495">.</span><span class="ident" id="3365496">equalFold</span><span class="op" id="3365505">(</span><span class="ident" id="3365506">ff</span><span class="op" id="3365508">.</span><span class="ident" id="3365509">nameBytes</span><span class="op" id="3365518">,</span>&nbsp;<span class="ident" id="3365520">key</span><span class="op" id="3365523">)</span>&nbsp;<span class="op" id="3365525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365532">f</span>&nbsp;<span class="op" id="3365534">=</span>&nbsp;<span class="ident" id="3365536">ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365543">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365553">if</span>&nbsp;<span class="ident" id="3365556">f</span>&nbsp;<span class="op" id="3365558">!=</span>&nbsp;<span class="builtintype" id="3365561">nil</span>&nbsp;<span class="op" id="3365565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365571">subv</span>&nbsp;<span class="op" id="3365576">=</span>&nbsp;<span class="ident" id="3365578">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365584">destring</span>&nbsp;<span class="op" id="3365593">=</span>&nbsp;<span class="ident" id="3365595">f</span><span class="op" id="3365596">.</span><span class="ident" id="3365597">quoted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365608">for</span>&nbsp;<span class="ident" id="3365612">_</span><span class="op" id="3365613">,</span>&nbsp;<span class="ident" id="3365615">i</span>&nbsp;<span class="op" id="3365617">:=</span>&nbsp;<span class="keyword" id="3365620">range</span>&nbsp;<span class="ident" id="3365626">f</span><span class="op" id="3365627">.</span><span class="ident" id="3365628">index</span>&nbsp;<span class="op" id="3365634">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365641">if</span>&nbsp;<span class="ident" id="3365644">subv</span><span class="op" id="3365648">.</span><span class="ident" id="3365649">Kind</span><span class="op" id="3365653">(</span><span class="op" id="3365654">)</span>&nbsp;<span class="op" id="3365656">==</span>&nbsp;<span class="ident" id="3365659">reflect</span><span class="op" id="3365666">.</span><span class="ident" id="3365667">Ptr</span>&nbsp;<span class="op" id="3365671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365679">if</span>&nbsp;<span class="ident" id="3365682">subv</span><span class="op" id="3365686">.</span><span class="ident" id="3365687">IsNil</span><span class="op" id="3365692">(</span><span class="op" id="3365693">)</span>&nbsp;<span class="op" id="3365695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365704">subv</span><span class="op" id="3365708">.</span><span class="ident" id="3365709">Set</span><span class="op" id="3365712">(</span><span class="ident" id="3365713">reflect</span><span class="op" id="3365720">.</span><span class="ident" id="3365721">New</span><span class="op" id="3365724">(</span><span class="ident" id="3365725">subv</span><span class="op" id="3365729">.</span><span class="ident" id="3365730">Type</span><span class="op" id="3365734">(</span><span class="op" id="3365735">)</span><span class="op" id="3365736">.</span><span class="ident" id="3365737">Elem</span><span class="op" id="3365741">(</span><span class="op" id="3365742">)</span><span class="op" id="3365743">)</span><span class="op" id="3365744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365760">subv</span>&nbsp;<span class="op" id="3365765">=</span>&nbsp;<span class="ident" id="3365767">subv</span><span class="op" id="3365771">.</span><span class="ident" id="3365772">Elem</span><span class="op" id="3365776">(</span><span class="op" id="3365777">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365791">subv</span>&nbsp;<span class="op" id="3365796">=</span>&nbsp;<span class="ident" id="3365798">subv</span><span class="op" id="3365802">.</span><span class="ident" id="3365803">Field</span><span class="op" id="3365808">(</span><span class="ident" id="3365809">i</span><span class="op" id="3365810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365825">}</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365830">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365856">if</span>&nbsp;<span class="ident" id="3365859">op</span>&nbsp;<span class="op" id="3365862">==</span>&nbsp;<span class="ident" id="3365865">scanSkipSpace</span>&nbsp;<span class="op" id="3365879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365884">op</span>&nbsp;<span class="op" id="3365887">=</span>&nbsp;<span class="ident" id="3365889">d</span><span class="op" id="3365890">.</span><span class="ident" id="3365891">scanWhile</span><span class="op" id="3365900">(</span><span class="ident" id="3365901">scanSkipSpace</span><span class="op" id="3365914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365918">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365922">if</span>&nbsp;<span class="ident" id="3365925">op</span>&nbsp;<span class="op" id="3365928">!=</span>&nbsp;<span class="ident" id="3365931">scanObjectKey</span>&nbsp;<span class="op" id="3365945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365950">d</span><span class="op" id="3365951">.</span><span class="builtintype" id="3365952">error</span><span class="op" id="3365957">(</span><span class="ident" id="3365958">errPhase</span><span class="op" id="3365966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365975">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365992">if</span>&nbsp;<span class="ident" id="3365995">destring</span>&nbsp;<span class="op" id="3366004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366009">switch</span>&nbsp;<span class="ident" id="3366016">qv</span>&nbsp;<span class="op" id="3366019">:=</span>&nbsp;<span class="ident" id="3366022">d</span><span class="op" id="3366023">.</span><span class="ident" id="3366024">valueQuoted</span><span class="op" id="3366035">(</span><span class="op" id="3366036">)</span><span class="op" id="3366037">.</span><span class="op" id="3366038">(</span><span class="keyword" id="3366039">type</span><span class="op" id="3366043">)</span>&nbsp;<span class="op" id="3366045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366050">case</span>&nbsp;<span class="builtintype" id="3366055">nil</span><span class="op" id="3366058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366064">d</span><span class="op" id="3366065">.</span><span class="ident" id="3366066">literalStore</span><span class="op" id="3366078">(</span><span class="ident" id="3366079">nullLiteral</span><span class="op" id="3366090">,</span>&nbsp;<span class="ident" id="3366092">subv</span><span class="op" id="3366096">,</span>&nbsp;<span class="builtintype" id="3366098">false</span><span class="op" id="3366103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366108">case</span>&nbsp;<span class="builtintype" id="3366113">string</span><span class="op" id="3366119">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366125">d</span><span class="op" id="3366126">.</span><span class="ident" id="3366127">literalStore</span><span class="op" id="3366139">(</span><span class="op" id="3366140">[</span><span class="op" id="3366141">]</span><span class="builtintype" id="3366142">byte</span><span class="op" id="3366146">(</span><span class="ident" id="3366147">qv</span><span class="op" id="3366149">)</span><span class="op" id="3366150">,</span>&nbsp;<span class="ident" id="3366152">subv</span><span class="op" id="3366156">,</span>&nbsp;<span class="builtintype" id="3366158">true</span><span class="op" id="3366162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366167">default</span><span class="op" id="3366174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366180">d</span><span class="op" id="3366181">.</span><span class="ident" id="3366182">saveError</span><span class="op" id="3366191">(</span><span class="ident" id="3366192">fmt</span><span class="op" id="3366195">.</span><span class="ident" id="3366196">Errorf</span><span class="op" id="3366202">(</span><span class="string" id="3366203">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;unquoted&nbsp;value&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3366288">,</span>&nbsp;<span class="ident" id="3366290">item</span><span class="op" id="3366294">,</span>&nbsp;<span class="ident" id="3366296">v</span><span class="op" id="3366297">.</span><span class="ident" id="3366298">Type</span><span class="op" id="3366302">(</span><span class="op" id="3366303">)</span><span class="op" id="3366304">)</span><span class="op" id="3366305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366314">}</span>&nbsp;<span class="keyword" id="3366316">else</span>&nbsp;<span class="op" id="3366321">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366326">d</span><span class="op" id="3366327">.</span><span class="ident" id="3366328">value</span><span class="op" id="3366333">(</span><span class="ident" id="3366334">subv</span><span class="op" id="3366338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366347">//&nbsp;Write&nbsp;value&nbsp;back&nbsp;to&nbsp;map;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366377">//&nbsp;if&nbsp;using&nbsp;struct,&nbsp;subv&nbsp;points&nbsp;into&nbsp;struct&nbsp;already.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366432">if</span>&nbsp;<span class="ident" id="3366435">v</span><span class="op" id="3366436">.</span><span class="ident" id="3366437">Kind</span><span class="op" id="3366441">(</span><span class="op" id="3366442">)</span>&nbsp;<span class="op" id="3366444">==</span>&nbsp;<span class="ident" id="3366447">reflect</span><span class="op" id="3366454">.</span><span class="ident" id="3366455">Map</span>&nbsp;<span class="op" id="3366459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366464">kv</span>&nbsp;<span class="op" id="3366467">:=</span>&nbsp;<span class="ident" id="3366470">reflect</span><span class="op" id="3366477">.</span><span class="ident" id="3366478">ValueOf</span><span class="op" id="3366485">(</span><span class="ident" id="3366486">key</span><span class="op" id="3366489">)</span><span class="op" id="3366490">.</span><span class="ident" id="3366491">Convert</span><span class="op" id="3366498">(</span><span class="ident" id="3366499">v</span><span class="op" id="3366500">.</span><span class="ident" id="3366501">Type</span><span class="op" id="3366505">(</span><span class="op" id="3366506">)</span><span class="op" id="3366507">.</span><span class="ident" id="3366508">Key</span><span class="op" id="3366511">(</span><span class="op" id="3366512">)</span><span class="op" id="3366513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366518">v</span><span class="op" id="3366519">.</span><span class="ident" id="3366520">SetMapIndex</span><span class="op" id="3366531">(</span><span class="ident" id="3366532">kv</span><span class="op" id="3366534">,</span>&nbsp;<span class="ident" id="3366536">subv</span><span class="op" id="3366540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366549">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366581">op</span>&nbsp;<span class="op" id="3366584">=</span>&nbsp;<span class="ident" id="3366586">d</span><span class="op" id="3366587">.</span><span class="ident" id="3366588">scanWhile</span><span class="op" id="3366597">(</span><span class="ident" id="3366598">scanSkipSpace</span><span class="op" id="3366611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366615">if</span>&nbsp;<span class="ident" id="3366618">op</span>&nbsp;<span class="op" id="3366621">==</span>&nbsp;<span class="ident" id="3366624">scanEndObject</span>&nbsp;<span class="op" id="3366638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366643">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366651">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366655">if</span>&nbsp;<span class="ident" id="3366658">op</span>&nbsp;<span class="op" id="3366661">!=</span>&nbsp;<span class="ident" id="3366664">scanObjectValue</span>&nbsp;<span class="op" id="3366680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366685">d</span><span class="op" id="3366686">.</span><span class="builtintype" id="3366687">error</span><span class="op" id="3366692">(</span><span class="ident" id="3366693">errPhase</span><span class="op" id="3366701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366708">}</span><br>
<span class="lineno"></span><span class="op" id="3366710">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="comment" id="3366713">//&nbsp;literal&nbsp;consumes&nbsp;a&nbsp;literal&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3366793">//&nbsp;The&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;literal&nbsp;has&nbsp;been&nbsp;read&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3366848">//&nbsp;(that&#39;s&nbsp;how&nbsp;the&nbsp;caller&nbsp;knows&nbsp;it&#39;s&nbsp;a&nbsp;literal).</span><br>
<span class="lineno"></span><span class="keyword" id="3366897">func</span>&nbsp;<span class="op" id="3366902">(</span><span class="ident" id="3366903">d</span>&nbsp;<span class="op" id="3366905">*</span><span class="ident" id="3366906">decodeState</span><span class="op" id="3366917">)</span>&nbsp;<span class="ident" id="3366919">literal</span><span class="op" id="3366926">(</span><span class="ident" id="3366927">v</span>&nbsp;<span class="ident" id="3366929">reflect</span><span class="op" id="3366936">.</span><span class="ident" id="3366937">Value</span><span class="op" id="3366942">)</span>&nbsp;<span class="op" id="3366944">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366947">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367005">start</span>&nbsp;<span class="op" id="3367011">:=</span>&nbsp;<span class="ident" id="3367014">d</span><span class="op" id="3367015">.</span><span class="ident" id="3367016">off</span>&nbsp;<span class="op" id="3367020">-</span>&nbsp;<span class="num" id="3367022">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367025">op</span>&nbsp;<span class="op" id="3367028">:=</span>&nbsp;<span class="ident" id="3367031">d</span><span class="op" id="3367032">.</span><span class="ident" id="3367033">scanWhile</span><span class="op" id="3367042">(</span><span class="ident" id="3367043">scanContinue</span><span class="op" id="3367055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367059">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367100">d</span><span class="op" id="3367101">.</span><span class="ident" id="3367102">off</span><span class="op" id="3367105">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367109">d</span><span class="op" id="3367110">.</span><span class="ident" id="3367111">scan</span><span class="op" id="3367115">.</span><span class="ident" id="3367116">undo</span><span class="op" id="3367120">(</span><span class="ident" id="3367121">op</span><span class="op" id="3367123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367127">d</span><span class="op" id="3367128">.</span><span class="ident" id="3367129">literalStore</span><span class="op" id="3367141">(</span><span class="ident" id="3367142">d</span><span class="op" id="3367143">.</span><span class="ident" id="3367144">data</span><span class="op" id="3367148">[</span><span class="ident" id="3367149">start</span><span class="op" id="3367154">:</span><span class="ident" id="3367155">d</span><span class="op" id="3367156">.</span><span class="ident" id="3367157">off</span><span class="op" id="3367160">]</span><span class="op" id="3367161">,</span>&nbsp;<span class="ident" id="3367163">v</span><span class="op" id="3367164">,</span>&nbsp;<span class="builtintype" id="3367166">false</span><span class="op" id="3367171">)</span><br>
<span class="lineno"></span><span class="op" id="3367173">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="3367176">//&nbsp;convertNumber&nbsp;converts&nbsp;the&nbsp;number&nbsp;literal&nbsp;s&nbsp;to&nbsp;a&nbsp;float64&nbsp;or&nbsp;a&nbsp;Number</span><br>
<span class="lineno"></span><span class="comment" id="3367248">//&nbsp;depending&nbsp;on&nbsp;the&nbsp;setting&nbsp;of&nbsp;d.useNumber.</span><br>
<span class="lineno"></span><span class="keyword" id="3367292">func</span>&nbsp;<span class="op" id="3367297">(</span><span class="ident" id="3367298">d</span>&nbsp;<span class="op" id="3367300">*</span><span class="ident" id="3367301">decodeState</span><span class="op" id="3367312">)</span>&nbsp;<span class="ident" id="3367314">convertNumber</span><span class="op" id="3367327">(</span><span class="ident" id="3367328">s</span>&nbsp;<span class="builtintype" id="3367330">string</span><span class="op" id="3367336">)</span>&nbsp;<span class="op" id="3367338">(</span><span class="keyword" id="3367339">interface</span><span class="op" id="3367348">{</span><span class="op" id="3367349">}</span><span class="op" id="3367350">,</span>&nbsp;<span class="builtintype" id="3367352">error</span><span class="op" id="3367357">)</span>&nbsp;<span class="op" id="3367359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367362">if</span>&nbsp;<span class="ident" id="3367365">d</span><span class="op" id="3367366">.</span><span class="ident" id="3367367">useNumber</span>&nbsp;<span class="op" id="3367377">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367381">return</span>&nbsp;<span class="ident" id="3367388">Number</span><span class="op" id="3367394">(</span><span class="ident" id="3367395">s</span><span class="op" id="3367396">)</span><span class="op" id="3367397">,</span>&nbsp;<span class="builtintype" id="3367399">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367407">f</span><span class="op" id="3367408">,</span>&nbsp;<span class="ident" id="3367410">err</span>&nbsp;<span class="op" id="3367414">:=</span>&nbsp;<span class="ident" id="3367417">strconv</span><span class="op" id="3367424">.</span><span class="ident" id="3367425">ParseFloat</span><span class="op" id="3367435">(</span><span class="ident" id="3367436">s</span><span class="op" id="3367437">,</span>&nbsp;<span class="num" id="3367439">64</span><span class="op" id="3367441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367444">if</span>&nbsp;<span class="ident" id="3367447">err</span>&nbsp;<span class="op" id="3367451">!=</span>&nbsp;<span class="builtintype" id="3367454">nil</span>&nbsp;<span class="op" id="3367458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367462">return</span>&nbsp;<span class="builtintype" id="3367469">nil</span><span class="op" id="3367472">,</span>&nbsp;<span class="op" id="3367474">&amp;</span><span class="ident" id="3367475">UnmarshalTypeError</span><span class="op" id="3367493">{</span><span class="string" id="3367494">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="3367504">+</span>&nbsp;<span class="ident" id="3367506">s</span><span class="op" id="3367507">,</span>&nbsp;<span class="ident" id="3367509">reflect</span><span class="op" id="3367516">.</span><span class="ident" id="3367517">TypeOf</span><span class="op" id="3367523">(</span><span class="num" id="3367524">0.0</span><span class="op" id="3367527">)</span><span class="op" id="3367528">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367534">return</span>&nbsp;<span class="ident" id="3367541">f</span><span class="op" id="3367542">,</span>&nbsp;<span class="builtintype" id="3367544">nil</span><br>
<span class="lineno"></span><span class="op" id="3367548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3367551">var</span>&nbsp;<span class="ident" id="3367555">numberType</span>&nbsp;<span class="op" id="3367566">=</span>&nbsp;<span class="ident" id="3367568">reflect</span><span class="op" id="3367575">.</span><span class="ident" id="3367576">TypeOf</span><span class="op" id="3367582">(</span><span class="ident" id="3367583">Number</span><span class="op" id="3367589">(</span><span class="string" id="3367590">&#34;&#34;</span><span class="op" id="3367592">)</span><span class="op" id="3367593">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span><span class="comment" id="3367596">//&nbsp;literalStore&nbsp;decodes&nbsp;a&nbsp;literal&nbsp;stored&nbsp;in&nbsp;item&nbsp;into&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3367653">//</span><br>
<span class="lineno"></span><span class="comment" id="3367656">//&nbsp;fromQuoted&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;literal&nbsp;came&nbsp;from&nbsp;unwrapping&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3367724">//&nbsp;string&nbsp;from&nbsp;the&nbsp;&#34;,string&#34;&nbsp;struct&nbsp;tag&nbsp;option.&nbsp;this&nbsp;is&nbsp;used&nbsp;only&nbsp;to</span><br>
<span class="lineno">660</span><span class="comment" id="3367793">//&nbsp;produce&nbsp;more&nbsp;helpful&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="3367833">func</span>&nbsp;<span class="op" id="3367838">(</span><span class="ident" id="3367839">d</span>&nbsp;<span class="op" id="3367841">*</span><span class="ident" id="3367842">decodeState</span><span class="op" id="3367853">)</span>&nbsp;<span class="ident" id="3367855">literalStore</span><span class="op" id="3367867">(</span><span class="ident" id="3367868">item</span>&nbsp;<span class="op" id="3367873">[</span><span class="op" id="3367874">]</span><span class="builtintype" id="3367875">byte</span><span class="op" id="3367879">,</span>&nbsp;<span class="ident" id="3367881">v</span>&nbsp;<span class="ident" id="3367883">reflect</span><span class="op" id="3367890">.</span><span class="ident" id="3367891">Value</span><span class="op" id="3367896">,</span>&nbsp;<span class="ident" id="3367898">fromQuoted</span>&nbsp;<span class="builtintype" id="3367909">bool</span><span class="op" id="3367913">)</span>&nbsp;<span class="op" id="3367915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367918">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367945">if</span>&nbsp;<span class="builtinfunc" id="3367948">len</span><span class="op" id="3367951">(</span><span class="ident" id="3367952">item</span><span class="op" id="3367956">)</span>&nbsp;<span class="op" id="3367958">==</span>&nbsp;<span class="num" id="3367961">0</span>&nbsp;<span class="op" id="3367963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367967">//Empty&nbsp;string&nbsp;given</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367990">d</span><span class="op" id="3367991">.</span><span class="ident" id="3367992">saveError</span><span class="op" id="3368001">(</span><span class="ident" id="3368002">fmt</span><span class="op" id="3368005">.</span><span class="ident" id="3368006">Errorf</span><span class="op" id="3368012">(</span><span class="string" id="3368013">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3368086">,</span>&nbsp;<span class="ident" id="3368088">item</span><span class="op" id="3368092">,</span>&nbsp;<span class="ident" id="3368094">v</span><span class="op" id="3368095">.</span><span class="ident" id="3368096">Type</span><span class="op" id="3368100">(</span><span class="op" id="3368101">)</span><span class="op" id="3368102">)</span><span class="op" id="3368103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368107">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368118">wantptr</span>&nbsp;<span class="op" id="3368126">:=</span>&nbsp;<span class="ident" id="3368129">item</span><span class="op" id="3368133">[</span><span class="num" id="3368134">0</span><span class="op" id="3368135">]</span>&nbsp;<span class="op" id="3368137">==</span>&nbsp;<span class="string" id="3368140">&#39;n&#39;</span>&nbsp;<span class="comment" id="3368144">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368153">u</span><span class="op" id="3368154">,</span>&nbsp;<span class="ident" id="3368156">ut</span><span class="op" id="3368158">,</span>&nbsp;<span class="ident" id="3368160">pv</span>&nbsp;<span class="op" id="3368163">:=</span>&nbsp;<span class="ident" id="3368166">d</span><span class="op" id="3368167">.</span><span class="ident" id="3368168">indirect</span><span class="op" id="3368176">(</span><span class="ident" id="3368177">v</span><span class="op" id="3368178">,</span>&nbsp;<span class="ident" id="3368180">wantptr</span><span class="op" id="3368187">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368190">if</span>&nbsp;<span class="ident" id="3368193">u</span>&nbsp;<span class="op" id="3368195">!=</span>&nbsp;<span class="builtintype" id="3368198">nil</span>&nbsp;<span class="op" id="3368202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368206">err</span>&nbsp;<span class="op" id="3368210">:=</span>&nbsp;<span class="ident" id="3368213">u</span><span class="op" id="3368214">.</span><span class="ident" id="3368215">UnmarshalJSON</span><span class="op" id="3368228">(</span><span class="ident" id="3368229">item</span><span class="op" id="3368233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368237">if</span>&nbsp;<span class="ident" id="3368240">err</span>&nbsp;<span class="op" id="3368244">!=</span>&nbsp;<span class="builtintype" id="3368247">nil</span>&nbsp;<span class="op" id="3368251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368256">d</span><span class="op" id="3368257">.</span><span class="builtintype" id="3368258">error</span><span class="op" id="3368263">(</span><span class="ident" id="3368264">err</span><span class="op" id="3368267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368271">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368275">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368286">if</span>&nbsp;<span class="ident" id="3368289">ut</span>&nbsp;<span class="op" id="3368292">!=</span>&nbsp;<span class="builtintype" id="3368295">nil</span>&nbsp;<span class="op" id="3368299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368303">if</span>&nbsp;<span class="ident" id="3368306">item</span><span class="op" id="3368310">[</span><span class="num" id="3368311">0</span><span class="op" id="3368312">]</span>&nbsp;<span class="op" id="3368314">!=</span>&nbsp;<span class="string" id="3368317">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3368321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368326">if</span>&nbsp;<span class="ident" id="3368329">fromQuoted</span>&nbsp;<span class="op" id="3368340">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368346">d</span><span class="op" id="3368347">.</span><span class="ident" id="3368348">saveError</span><span class="op" id="3368357">(</span><span class="ident" id="3368358">fmt</span><span class="op" id="3368361">.</span><span class="ident" id="3368362">Errorf</span><span class="op" id="3368368">(</span><span class="string" id="3368369">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3368442">,</span>&nbsp;<span class="ident" id="3368444">item</span><span class="op" id="3368448">,</span>&nbsp;<span class="ident" id="3368450">v</span><span class="op" id="3368451">.</span><span class="ident" id="3368452">Type</span><span class="op" id="3368456">(</span><span class="op" id="3368457">)</span><span class="op" id="3368458">)</span><span class="op" id="3368459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368464">}</span>&nbsp;<span class="keyword" id="3368466">else</span>&nbsp;<span class="op" id="3368471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368477">d</span><span class="op" id="3368478">.</span><span class="ident" id="3368479">saveError</span><span class="op" id="3368488">(</span><span class="op" id="3368489">&amp;</span><span class="ident" id="3368490">UnmarshalTypeError</span><span class="op" id="3368508">{</span><span class="string" id="3368509">&#34;string&#34;</span><span class="op" id="3368517">,</span>&nbsp;<span class="ident" id="3368519">v</span><span class="op" id="3368520">.</span><span class="ident" id="3368521">Type</span><span class="op" id="3368525">(</span><span class="op" id="3368526">)</span><span class="op" id="3368527">}</span><span class="op" id="3368528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368537">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368541">s</span><span class="op" id="3368542">,</span>&nbsp;<span class="ident" id="3368544">ok</span>&nbsp;<span class="op" id="3368547">:=</span>&nbsp;<span class="ident" id="3368550">unquoteBytes</span><span class="op" id="3368562">(</span><span class="ident" id="3368563">item</span><span class="op" id="3368567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368571">if</span>&nbsp;<span class="op" id="3368574">!</span><span class="ident" id="3368575">ok</span>&nbsp;<span class="op" id="3368578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368583">if</span>&nbsp;<span class="ident" id="3368586">fromQuoted</span>&nbsp;<span class="op" id="3368597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368603">d</span><span class="op" id="3368604">.</span><span class="builtintype" id="3368605">error</span><span class="op" id="3368610">(</span><span class="ident" id="3368611">fmt</span><span class="op" id="3368614">.</span><span class="ident" id="3368615">Errorf</span><span class="op" id="3368621">(</span><span class="string" id="3368622">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3368695">,</span>&nbsp;<span class="ident" id="3368697">item</span><span class="op" id="3368701">,</span>&nbsp;<span class="ident" id="3368703">v</span><span class="op" id="3368704">.</span><span class="ident" id="3368705">Type</span><span class="op" id="3368709">(</span><span class="op" id="3368710">)</span><span class="op" id="3368711">)</span><span class="op" id="3368712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368717">}</span>&nbsp;<span class="keyword" id="3368719">else</span>&nbsp;<span class="op" id="3368724">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368730">d</span><span class="op" id="3368731">.</span><span class="builtintype" id="3368732">error</span><span class="op" id="3368737">(</span><span class="ident" id="3368738">errPhase</span><span class="op" id="3368746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368759">err</span>&nbsp;<span class="op" id="3368763">:=</span>&nbsp;<span class="ident" id="3368766">ut</span><span class="op" id="3368768">.</span><span class="ident" id="3368769">UnmarshalText</span><span class="op" id="3368782">(</span><span class="ident" id="3368783">s</span><span class="op" id="3368784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368788">if</span>&nbsp;<span class="ident" id="3368791">err</span>&nbsp;<span class="op" id="3368795">!=</span>&nbsp;<span class="builtintype" id="3368798">nil</span>&nbsp;<span class="op" id="3368802">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368807">d</span><span class="op" id="3368808">.</span><span class="builtintype" id="3368809">error</span><span class="op" id="3368814">(</span><span class="ident" id="3368815">err</span><span class="op" id="3368818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368826">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368838">v</span>&nbsp;<span class="op" id="3368840">=</span>&nbsp;<span class="ident" id="3368842">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368847">switch</span>&nbsp;<span class="ident" id="3368854">c</span>&nbsp;<span class="op" id="3368856">:=</span>&nbsp;<span class="ident" id="3368859">item</span><span class="op" id="3368863">[</span><span class="num" id="3368864">0</span><span class="op" id="3368865">]</span><span class="op" id="3368866">;</span>&nbsp;<span class="ident" id="3368868">c</span>&nbsp;<span class="op" id="3368870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368873">case</span>&nbsp;<span class="string" id="3368878">&#39;n&#39;</span><span class="op" id="3368881">:</span>&nbsp;<span class="comment" id="3368883">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368893">switch</span>&nbsp;<span class="ident" id="3368900">v</span><span class="op" id="3368901">.</span><span class="ident" id="3368902">Kind</span><span class="op" id="3368906">(</span><span class="op" id="3368907">)</span>&nbsp;<span class="op" id="3368909">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368913">case</span>&nbsp;<span class="ident" id="3368918">reflect</span><span class="op" id="3368925">.</span><span class="ident" id="3368926">Interface</span><span class="op" id="3368935">,</span>&nbsp;<span class="ident" id="3368937">reflect</span><span class="op" id="3368944">.</span><span class="ident" id="3368945">Ptr</span><span class="op" id="3368948">,</span>&nbsp;<span class="ident" id="3368950">reflect</span><span class="op" id="3368957">.</span><span class="ident" id="3368958">Map</span><span class="op" id="3368961">,</span>&nbsp;<span class="ident" id="3368963">reflect</span><span class="op" id="3368970">.</span><span class="ident" id="3368971">Slice</span><span class="op" id="3368976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368981">v</span><span class="op" id="3368982">.</span><span class="ident" id="3368983">Set</span><span class="op" id="3368986">(</span><span class="ident" id="3368987">reflect</span><span class="op" id="3368994">.</span><span class="ident" id="3368995">Zero</span><span class="op" id="3368999">(</span><span class="ident" id="3369000">v</span><span class="op" id="3369001">.</span><span class="ident" id="3369002">Type</span><span class="op" id="3369006">(</span><span class="op" id="3369007">)</span><span class="op" id="3369008">)</span><span class="op" id="3369009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3369014">//&nbsp;otherwise,&nbsp;ignore&nbsp;null&nbsp;for&nbsp;primitives/string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369067">case</span>&nbsp;<span class="string" id="3369072">&#39;t&#39;</span><span class="op" id="3369075">,</span>&nbsp;<span class="string" id="3369077">&#39;f&#39;</span><span class="op" id="3369080">:</span>&nbsp;<span class="comment" id="3369082">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369099">value</span>&nbsp;<span class="op" id="3369105">:=</span>&nbsp;<span class="ident" id="3369108">c</span>&nbsp;<span class="op" id="3369110">==</span>&nbsp;<span class="string" id="3369113">&#39;t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369119">switch</span>&nbsp;<span class="ident" id="3369126">v</span><span class="op" id="3369127">.</span><span class="ident" id="3369128">Kind</span><span class="op" id="3369132">(</span><span class="op" id="3369133">)</span>&nbsp;<span class="op" id="3369135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369139">default</span><span class="op" id="3369146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369151">if</span>&nbsp;<span class="ident" id="3369154">fromQuoted</span>&nbsp;<span class="op" id="3369165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369171">d</span><span class="op" id="3369172">.</span><span class="ident" id="3369173">saveError</span><span class="op" id="3369182">(</span><span class="ident" id="3369183">fmt</span><span class="op" id="3369186">.</span><span class="ident" id="3369187">Errorf</span><span class="op" id="3369193">(</span><span class="string" id="3369194">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3369267">,</span>&nbsp;<span class="ident" id="3369269">item</span><span class="op" id="3369273">,</span>&nbsp;<span class="ident" id="3369275">v</span><span class="op" id="3369276">.</span><span class="ident" id="3369277">Type</span><span class="op" id="3369281">(</span><span class="op" id="3369282">)</span><span class="op" id="3369283">)</span><span class="op" id="3369284">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369289">}</span>&nbsp;<span class="keyword" id="3369291">else</span>&nbsp;<span class="op" id="3369296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369302">d</span><span class="op" id="3369303">.</span><span class="ident" id="3369304">saveError</span><span class="op" id="3369313">(</span><span class="op" id="3369314">&amp;</span><span class="ident" id="3369315">UnmarshalTypeError</span><span class="op" id="3369333">{</span><span class="string" id="3369334">&#34;bool&#34;</span><span class="op" id="3369340">,</span>&nbsp;<span class="ident" id="3369342">v</span><span class="op" id="3369343">.</span><span class="ident" id="3369344">Type</span><span class="op" id="3369348">(</span><span class="op" id="3369349">)</span><span class="op" id="3369350">}</span><span class="op" id="3369351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369360">case</span>&nbsp;<span class="ident" id="3369365">reflect</span><span class="op" id="3369372">.</span><span class="ident" id="3369373">Bool</span><span class="op" id="3369377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369382">v</span><span class="op" id="3369383">.</span><span class="ident" id="3369384">SetBool</span><span class="op" id="3369391">(</span><span class="ident" id="3369392">value</span><span class="op" id="3369397">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369401">case</span>&nbsp;<span class="ident" id="3369406">reflect</span><span class="op" id="3369413">.</span><span class="ident" id="3369414">Interface</span><span class="op" id="3369423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369428">if</span>&nbsp;<span class="ident" id="3369431">v</span><span class="op" id="3369432">.</span><span class="ident" id="3369433">NumMethod</span><span class="op" id="3369442">(</span><span class="op" id="3369443">)</span>&nbsp;<span class="op" id="3369445">==</span>&nbsp;<span class="num" id="3369448">0</span>&nbsp;<span class="op" id="3369450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369456">v</span><span class="op" id="3369457">.</span><span class="ident" id="3369458">Set</span><span class="op" id="3369461">(</span><span class="ident" id="3369462">reflect</span><span class="op" id="3369469">.</span><span class="ident" id="3369470">ValueOf</span><span class="op" id="3369477">(</span><span class="ident" id="3369478">value</span><span class="op" id="3369483">)</span><span class="op" id="3369484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369489">}</span>&nbsp;<span class="keyword" id="3369491">else</span>&nbsp;<span class="op" id="3369496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369502">d</span><span class="op" id="3369503">.</span><span class="ident" id="3369504">saveError</span><span class="op" id="3369513">(</span><span class="op" id="3369514">&amp;</span><span class="ident" id="3369515">UnmarshalTypeError</span><span class="op" id="3369533">{</span><span class="string" id="3369534">&#34;bool&#34;</span><span class="op" id="3369540">,</span>&nbsp;<span class="ident" id="3369542">v</span><span class="op" id="3369543">.</span><span class="ident" id="3369544">Type</span><span class="op" id="3369548">(</span><span class="op" id="3369549">)</span><span class="op" id="3369550">}</span><span class="op" id="3369551">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369564">case</span>&nbsp;<span class="string" id="3369569">&#39;&#34;&#39;</span><span class="op" id="3369572">:</span>&nbsp;<span class="comment" id="3369574">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369586">s</span><span class="op" id="3369587">,</span>&nbsp;<span class="ident" id="3369589">ok</span>&nbsp;<span class="op" id="3369592">:=</span>&nbsp;<span class="ident" id="3369595">unquoteBytes</span><span class="op" id="3369607">(</span><span class="ident" id="3369608">item</span><span class="op" id="3369612">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369616">if</span>&nbsp;<span class="op" id="3369619">!</span><span class="ident" id="3369620">ok</span>&nbsp;<span class="op" id="3369623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369628">if</span>&nbsp;<span class="ident" id="3369631">fromQuoted</span>&nbsp;<span class="op" id="3369642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369648">d</span><span class="op" id="3369649">.</span><span class="builtintype" id="3369650">error</span><span class="op" id="3369655">(</span><span class="ident" id="3369656">fmt</span><span class="op" id="3369659">.</span><span class="ident" id="3369660">Errorf</span><span class="op" id="3369666">(</span><span class="string" id="3369667">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3369740">,</span>&nbsp;<span class="ident" id="3369742">item</span><span class="op" id="3369746">,</span>&nbsp;<span class="ident" id="3369748">v</span><span class="op" id="3369749">.</span><span class="ident" id="3369750">Type</span><span class="op" id="3369754">(</span><span class="op" id="3369755">)</span><span class="op" id="3369756">)</span><span class="op" id="3369757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369762">}</span>&nbsp;<span class="keyword" id="3369764">else</span>&nbsp;<span class="op" id="3369769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369775">d</span><span class="op" id="3369776">.</span><span class="builtintype" id="3369777">error</span><span class="op" id="3369782">(</span><span class="ident" id="3369783">errPhase</span><span class="op" id="3369791">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369804">switch</span>&nbsp;<span class="ident" id="3369811">v</span><span class="op" id="3369812">.</span><span class="ident" id="3369813">Kind</span><span class="op" id="3369817">(</span><span class="op" id="3369818">)</span>&nbsp;<span class="op" id="3369820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369824">default</span><span class="op" id="3369831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369836">d</span><span class="op" id="3369837">.</span><span class="ident" id="3369838">saveError</span><span class="op" id="3369847">(</span><span class="op" id="3369848">&amp;</span><span class="ident" id="3369849">UnmarshalTypeError</span><span class="op" id="3369867">{</span><span class="string" id="3369868">&#34;string&#34;</span><span class="op" id="3369876">,</span>&nbsp;<span class="ident" id="3369878">v</span><span class="op" id="3369879">.</span><span class="ident" id="3369880">Type</span><span class="op" id="3369884">(</span><span class="op" id="3369885">)</span><span class="op" id="3369886">}</span><span class="op" id="3369887">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369891">case</span>&nbsp;<span class="ident" id="3369896">reflect</span><span class="op" id="3369903">.</span><span class="ident" id="3369904">Slice</span><span class="op" id="3369909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369914">if</span>&nbsp;<span class="ident" id="3369917">v</span><span class="op" id="3369918">.</span><span class="ident" id="3369919">Type</span><span class="op" id="3369923">(</span><span class="op" id="3369924">)</span>&nbsp;<span class="op" id="3369926">!=</span>&nbsp;<span class="ident" id="3369929">byteSliceType</span>&nbsp;<span class="op" id="3369943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369949">d</span><span class="op" id="3369950">.</span><span class="ident" id="3369951">saveError</span><span class="op" id="3369960">(</span><span class="op" id="3369961">&amp;</span><span class="ident" id="3369962">UnmarshalTypeError</span><span class="op" id="3369980">{</span><span class="string" id="3369981">&#34;string&#34;</span><span class="op" id="3369989">,</span>&nbsp;<span class="ident" id="3369991">v</span><span class="op" id="3369992">.</span><span class="ident" id="3369993">Type</span><span class="op" id="3369997">(</span><span class="op" id="3369998">)</span><span class="op" id="3369999">}</span><span class="op" id="3370000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370006">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370015">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370020">b</span>&nbsp;<span class="op" id="3370022">:=</span>&nbsp;<span class="builtinfunc" id="3370025">make</span><span class="op" id="3370029">(</span><span class="op" id="3370030">[</span><span class="op" id="3370031">]</span><span class="builtintype" id="3370032">byte</span><span class="op" id="3370036">,</span>&nbsp;<span class="ident" id="3370038">base64</span><span class="op" id="3370044">.</span><span class="ident" id="3370045">StdEncoding</span><span class="op" id="3370056">.</span><span class="ident" id="3370057">DecodedLen</span><span class="op" id="3370067">(</span><span class="builtinfunc" id="3370068">len</span><span class="op" id="3370071">(</span><span class="ident" id="3370072">s</span><span class="op" id="3370073">)</span><span class="op" id="3370074">)</span><span class="op" id="3370075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370080">n</span><span class="op" id="3370081">,</span>&nbsp;<span class="ident" id="3370083">err</span>&nbsp;<span class="op" id="3370087">:=</span>&nbsp;<span class="ident" id="3370090">base64</span><span class="op" id="3370096">.</span><span class="ident" id="3370097">StdEncoding</span><span class="op" id="3370108">.</span><span class="ident" id="3370109">Decode</span><span class="op" id="3370115">(</span><span class="ident" id="3370116">b</span><span class="op" id="3370117">,</span>&nbsp;<span class="ident" id="3370119">s</span><span class="op" id="3370120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370125">if</span>&nbsp;<span class="ident" id="3370128">err</span>&nbsp;<span class="op" id="3370132">!=</span>&nbsp;<span class="builtintype" id="3370135">nil</span>&nbsp;<span class="op" id="3370139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370145">d</span><span class="op" id="3370146">.</span><span class="ident" id="3370147">saveError</span><span class="op" id="3370156">(</span><span class="ident" id="3370157">err</span><span class="op" id="3370160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370166">break</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370180">v</span><span class="op" id="3370181">.</span><span class="ident" id="3370182">Set</span><span class="op" id="3370185">(</span><span class="ident" id="3370186">reflect</span><span class="op" id="3370193">.</span><span class="ident" id="3370194">ValueOf</span><span class="op" id="3370201">(</span><span class="ident" id="3370202">b</span><span class="op" id="3370203">[</span><span class="num" id="3370204">0</span><span class="op" id="3370205">:</span><span class="ident" id="3370206">n</span><span class="op" id="3370207">]</span><span class="op" id="3370208">)</span><span class="op" id="3370209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370213">case</span>&nbsp;<span class="ident" id="3370218">reflect</span><span class="op" id="3370225">.</span><span class="ident" id="3370226">String</span><span class="op" id="3370232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370237">v</span><span class="op" id="3370238">.</span><span class="ident" id="3370239">SetString</span><span class="op" id="3370248">(</span><span class="builtintype" id="3370249">string</span><span class="op" id="3370255">(</span><span class="ident" id="3370256">s</span><span class="op" id="3370257">)</span><span class="op" id="3370258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370262">case</span>&nbsp;<span class="ident" id="3370267">reflect</span><span class="op" id="3370274">.</span><span class="ident" id="3370275">Interface</span><span class="op" id="3370284">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370289">if</span>&nbsp;<span class="ident" id="3370292">v</span><span class="op" id="3370293">.</span><span class="ident" id="3370294">NumMethod</span><span class="op" id="3370303">(</span><span class="op" id="3370304">)</span>&nbsp;<span class="op" id="3370306">==</span>&nbsp;<span class="num" id="3370309">0</span>&nbsp;<span class="op" id="3370311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370317">v</span><span class="op" id="3370318">.</span><span class="ident" id="3370319">Set</span><span class="op" id="3370322">(</span><span class="ident" id="3370323">reflect</span><span class="op" id="3370330">.</span><span class="ident" id="3370331">ValueOf</span><span class="op" id="3370338">(</span><span class="builtintype" id="3370339">string</span><span class="op" id="3370345">(</span><span class="ident" id="3370346">s</span><span class="op" id="3370347">)</span><span class="op" id="3370348">)</span><span class="op" id="3370349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370354">}</span>&nbsp;<span class="keyword" id="3370356">else</span>&nbsp;<span class="op" id="3370361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370367">d</span><span class="op" id="3370368">.</span><span class="ident" id="3370369">saveError</span><span class="op" id="3370378">(</span><span class="op" id="3370379">&amp;</span><span class="ident" id="3370380">UnmarshalTypeError</span><span class="op" id="3370398">{</span><span class="string" id="3370399">&#34;string&#34;</span><span class="op" id="3370407">,</span>&nbsp;<span class="ident" id="3370409">v</span><span class="op" id="3370410">.</span><span class="ident" id="3370411">Type</span><span class="op" id="3370415">(</span><span class="op" id="3370416">)</span><span class="op" id="3370417">}</span><span class="op" id="3370418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370423">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370431">default</span><span class="op" id="3370438">:</span>&nbsp;<span class="comment" id="3370440">//&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370452">if</span>&nbsp;<span class="ident" id="3370455">c</span>&nbsp;<span class="op" id="3370457">!=</span>&nbsp;<span class="string" id="3370460">&#39;-&#39;</span>&nbsp;<span class="op" id="3370464">&amp;&amp;</span>&nbsp;<span class="op" id="3370467">(</span><span class="ident" id="3370468">c</span>&nbsp;<span class="op" id="3370470">&lt;</span>&nbsp;<span class="string" id="3370472">&#39;0&#39;</span>&nbsp;<span class="op" id="3370476">||</span>&nbsp;<span class="ident" id="3370479">c</span>&nbsp;<span class="op" id="3370481">&gt;</span>&nbsp;<span class="string" id="3370483">&#39;9&#39;</span><span class="op" id="3370486">)</span>&nbsp;<span class="op" id="3370488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370493">if</span>&nbsp;<span class="ident" id="3370496">fromQuoted</span>&nbsp;<span class="op" id="3370507">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370513">d</span><span class="op" id="3370514">.</span><span class="builtintype" id="3370515">error</span><span class="op" id="3370520">(</span><span class="ident" id="3370521">fmt</span><span class="op" id="3370524">.</span><span class="ident" id="3370525">Errorf</span><span class="op" id="3370531">(</span><span class="string" id="3370532">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3370605">,</span>&nbsp;<span class="ident" id="3370607">item</span><span class="op" id="3370611">,</span>&nbsp;<span class="ident" id="3370613">v</span><span class="op" id="3370614">.</span><span class="ident" id="3370615">Type</span><span class="op" id="3370619">(</span><span class="op" id="3370620">)</span><span class="op" id="3370621">)</span><span class="op" id="3370622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370627">}</span>&nbsp;<span class="keyword" id="3370629">else</span>&nbsp;<span class="op" id="3370634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370640">d</span><span class="op" id="3370641">.</span><span class="builtintype" id="3370642">error</span><span class="op" id="3370647">(</span><span class="ident" id="3370648">errPhase</span><span class="op" id="3370656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370665">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370669">s</span>&nbsp;<span class="op" id="3370671">:=</span>&nbsp;<span class="builtintype" id="3370674">string</span><span class="op" id="3370680">(</span><span class="ident" id="3370681">item</span><span class="op" id="3370685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370689">switch</span>&nbsp;<span class="ident" id="3370696">v</span><span class="op" id="3370697">.</span><span class="ident" id="3370698">Kind</span><span class="op" id="3370702">(</span><span class="op" id="3370703">)</span>&nbsp;<span class="op" id="3370705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370709">default</span><span class="op" id="3370716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370721">if</span>&nbsp;<span class="ident" id="3370724">v</span><span class="op" id="3370725">.</span><span class="ident" id="3370726">Kind</span><span class="op" id="3370730">(</span><span class="op" id="3370731">)</span>&nbsp;<span class="op" id="3370733">==</span>&nbsp;<span class="ident" id="3370736">reflect</span><span class="op" id="3370743">.</span><span class="ident" id="3370744">String</span>&nbsp;<span class="op" id="3370751">&amp;&amp;</span>&nbsp;<span class="ident" id="3370754">v</span><span class="op" id="3370755">.</span><span class="ident" id="3370756">Type</span><span class="op" id="3370760">(</span><span class="op" id="3370761">)</span>&nbsp;<span class="op" id="3370763">==</span>&nbsp;<span class="ident" id="3370766">numberType</span>&nbsp;<span class="op" id="3370777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370783">v</span><span class="op" id="3370784">.</span><span class="ident" id="3370785">SetString</span><span class="op" id="3370794">(</span><span class="ident" id="3370795">s</span><span class="op" id="3370796">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370802">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370816">if</span>&nbsp;<span class="ident" id="3370819">fromQuoted</span>&nbsp;<span class="op" id="3370830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370836">d</span><span class="op" id="3370837">.</span><span class="builtintype" id="3370838">error</span><span class="op" id="3370843">(</span><span class="ident" id="3370844">fmt</span><span class="op" id="3370847">.</span><span class="ident" id="3370848">Errorf</span><span class="op" id="3370854">(</span><span class="string" id="3370855">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="3370928">,</span>&nbsp;<span class="ident" id="3370930">item</span><span class="op" id="3370934">,</span>&nbsp;<span class="ident" id="3370936">v</span><span class="op" id="3370937">.</span><span class="ident" id="3370938">Type</span><span class="op" id="3370942">(</span><span class="op" id="3370943">)</span><span class="op" id="3370944">)</span><span class="op" id="3370945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370950">}</span>&nbsp;<span class="keyword" id="3370952">else</span>&nbsp;<span class="op" id="3370957">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370963">d</span><span class="op" id="3370964">.</span><span class="builtintype" id="3370965">error</span><span class="op" id="3370970">(</span><span class="op" id="3370971">&amp;</span><span class="ident" id="3370972">UnmarshalTypeError</span><span class="op" id="3370990">{</span><span class="string" id="3370991">&#34;number&#34;</span><span class="op" id="3370999">,</span>&nbsp;<span class="ident" id="3371001">v</span><span class="op" id="3371002">.</span><span class="ident" id="3371003">Type</span><span class="op" id="3371007">(</span><span class="op" id="3371008">)</span><span class="op" id="3371009">}</span><span class="op" id="3371010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371019">case</span>&nbsp;<span class="ident" id="3371024">reflect</span><span class="op" id="3371031">.</span><span class="ident" id="3371032">Interface</span><span class="op" id="3371041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371046">n</span><span class="op" id="3371047">,</span>&nbsp;<span class="ident" id="3371049">err</span>&nbsp;<span class="op" id="3371053">:=</span>&nbsp;<span class="ident" id="3371056">d</span><span class="op" id="3371057">.</span><span class="ident" id="3371058">convertNumber</span><span class="op" id="3371071">(</span><span class="ident" id="3371072">s</span><span class="op" id="3371073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371078">if</span>&nbsp;<span class="ident" id="3371081">err</span>&nbsp;<span class="op" id="3371085">!=</span>&nbsp;<span class="builtintype" id="3371088">nil</span>&nbsp;<span class="op" id="3371092">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371098">d</span><span class="op" id="3371099">.</span><span class="ident" id="3371100">saveError</span><span class="op" id="3371109">(</span><span class="ident" id="3371110">err</span><span class="op" id="3371113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371119">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371133">if</span>&nbsp;<span class="ident" id="3371136">v</span><span class="op" id="3371137">.</span><span class="ident" id="3371138">NumMethod</span><span class="op" id="3371147">(</span><span class="op" id="3371148">)</span>&nbsp;<span class="op" id="3371150">!=</span>&nbsp;<span class="num" id="3371153">0</span>&nbsp;<span class="op" id="3371155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371161">d</span><span class="op" id="3371162">.</span><span class="ident" id="3371163">saveError</span><span class="op" id="3371172">(</span><span class="op" id="3371173">&amp;</span><span class="ident" id="3371174">UnmarshalTypeError</span><span class="op" id="3371192">{</span><span class="string" id="3371193">&#34;number&#34;</span><span class="op" id="3371201">,</span>&nbsp;<span class="ident" id="3371203">v</span><span class="op" id="3371204">.</span><span class="ident" id="3371205">Type</span><span class="op" id="3371209">(</span><span class="op" id="3371210">)</span><span class="op" id="3371211">}</span><span class="op" id="3371212">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371218">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371232">v</span><span class="op" id="3371233">.</span><span class="ident" id="3371234">Set</span><span class="op" id="3371237">(</span><span class="ident" id="3371238">reflect</span><span class="op" id="3371245">.</span><span class="ident" id="3371246">ValueOf</span><span class="op" id="3371253">(</span><span class="ident" id="3371254">n</span><span class="op" id="3371255">)</span><span class="op" id="3371256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371261">case</span>&nbsp;<span class="ident" id="3371266">reflect</span><span class="op" id="3371273">.</span><span class="ident" id="3371274">Int</span><span class="op" id="3371277">,</span>&nbsp;<span class="ident" id="3371279">reflect</span><span class="op" id="3371286">.</span><span class="ident" id="3371287">Int8</span><span class="op" id="3371291">,</span>&nbsp;<span class="ident" id="3371293">reflect</span><span class="op" id="3371300">.</span><span class="ident" id="3371301">Int16</span><span class="op" id="3371306">,</span>&nbsp;<span class="ident" id="3371308">reflect</span><span class="op" id="3371315">.</span><span class="ident" id="3371316">Int32</span><span class="op" id="3371321">,</span>&nbsp;<span class="ident" id="3371323">reflect</span><span class="op" id="3371330">.</span><span class="ident" id="3371331">Int64</span><span class="op" id="3371336">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371341">n</span><span class="op" id="3371342">,</span>&nbsp;<span class="ident" id="3371344">err</span>&nbsp;<span class="op" id="3371348">:=</span>&nbsp;<span class="ident" id="3371351">strconv</span><span class="op" id="3371358">.</span><span class="ident" id="3371359">ParseInt</span><span class="op" id="3371367">(</span><span class="ident" id="3371368">s</span><span class="op" id="3371369">,</span>&nbsp;<span class="num" id="3371371">10</span><span class="op" id="3371373">,</span>&nbsp;<span class="num" id="3371375">64</span><span class="op" id="3371377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371382">if</span>&nbsp;<span class="ident" id="3371385">err</span>&nbsp;<span class="op" id="3371389">!=</span>&nbsp;<span class="builtintype" id="3371392">nil</span>&nbsp;<span class="op" id="3371396">||</span>&nbsp;<span class="ident" id="3371399">v</span><span class="op" id="3371400">.</span><span class="ident" id="3371401">OverflowInt</span><span class="op" id="3371412">(</span><span class="ident" id="3371413">n</span><span class="op" id="3371414">)</span>&nbsp;<span class="op" id="3371416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371422">d</span><span class="op" id="3371423">.</span><span class="ident" id="3371424">saveError</span><span class="op" id="3371433">(</span><span class="op" id="3371434">&amp;</span><span class="ident" id="3371435">UnmarshalTypeError</span><span class="op" id="3371453">{</span><span class="string" id="3371454">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="3371464">+</span>&nbsp;<span class="ident" id="3371466">s</span><span class="op" id="3371467">,</span>&nbsp;<span class="ident" id="3371469">v</span><span class="op" id="3371470">.</span><span class="ident" id="3371471">Type</span><span class="op" id="3371475">(</span><span class="op" id="3371476">)</span><span class="op" id="3371477">}</span><span class="op" id="3371478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371484">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371493">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371498">v</span><span class="op" id="3371499">.</span><span class="ident" id="3371500">SetInt</span><span class="op" id="3371506">(</span><span class="ident" id="3371507">n</span><span class="op" id="3371508">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371513">case</span>&nbsp;<span class="ident" id="3371518">reflect</span><span class="op" id="3371525">.</span><span class="ident" id="3371526">Uint</span><span class="op" id="3371530">,</span>&nbsp;<span class="ident" id="3371532">reflect</span><span class="op" id="3371539">.</span><span class="ident" id="3371540">Uint8</span><span class="op" id="3371545">,</span>&nbsp;<span class="ident" id="3371547">reflect</span><span class="op" id="3371554">.</span><span class="ident" id="3371555">Uint16</span><span class="op" id="3371561">,</span>&nbsp;<span class="ident" id="3371563">reflect</span><span class="op" id="3371570">.</span><span class="ident" id="3371571">Uint32</span><span class="op" id="3371577">,</span>&nbsp;<span class="ident" id="3371579">reflect</span><span class="op" id="3371586">.</span><span class="ident" id="3371587">Uint64</span><span class="op" id="3371593">,</span>&nbsp;<span class="ident" id="3371595">reflect</span><span class="op" id="3371602">.</span><span class="ident" id="3371603">Uintptr</span><span class="op" id="3371610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371615">n</span><span class="op" id="3371616">,</span>&nbsp;<span class="ident" id="3371618">err</span>&nbsp;<span class="op" id="3371622">:=</span>&nbsp;<span class="ident" id="3371625">strconv</span><span class="op" id="3371632">.</span><span class="ident" id="3371633">ParseUint</span><span class="op" id="3371642">(</span><span class="ident" id="3371643">s</span><span class="op" id="3371644">,</span>&nbsp;<span class="num" id="3371646">10</span><span class="op" id="3371648">,</span>&nbsp;<span class="num" id="3371650">64</span><span class="op" id="3371652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371657">if</span>&nbsp;<span class="ident" id="3371660">err</span>&nbsp;<span class="op" id="3371664">!=</span>&nbsp;<span class="builtintype" id="3371667">nil</span>&nbsp;<span class="op" id="3371671">||</span>&nbsp;<span class="ident" id="3371674">v</span><span class="op" id="3371675">.</span><span class="ident" id="3371676">OverflowUint</span><span class="op" id="3371688">(</span><span class="ident" id="3371689">n</span><span class="op" id="3371690">)</span>&nbsp;<span class="op" id="3371692">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371698">d</span><span class="op" id="3371699">.</span><span class="ident" id="3371700">saveError</span><span class="op" id="3371709">(</span><span class="op" id="3371710">&amp;</span><span class="ident" id="3371711">UnmarshalTypeError</span><span class="op" id="3371729">{</span><span class="string" id="3371730">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="3371740">+</span>&nbsp;<span class="ident" id="3371742">s</span><span class="op" id="3371743">,</span>&nbsp;<span class="ident" id="3371745">v</span><span class="op" id="3371746">.</span><span class="ident" id="3371747">Type</span><span class="op" id="3371751">(</span><span class="op" id="3371752">)</span><span class="op" id="3371753">}</span><span class="op" id="3371754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371760">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371774">v</span><span class="op" id="3371775">.</span><span class="ident" id="3371776">SetUint</span><span class="op" id="3371783">(</span><span class="ident" id="3371784">n</span><span class="op" id="3371785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371790">case</span>&nbsp;<span class="ident" id="3371795">reflect</span><span class="op" id="3371802">.</span><span class="ident" id="3371803">Float32</span><span class="op" id="3371810">,</span>&nbsp;<span class="ident" id="3371812">reflect</span><span class="op" id="3371819">.</span><span class="ident" id="3371820">Float64</span><span class="op" id="3371827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371832">n</span><span class="op" id="3371833">,</span>&nbsp;<span class="ident" id="3371835">err</span>&nbsp;<span class="op" id="3371839">:=</span>&nbsp;<span class="ident" id="3371842">strconv</span><span class="op" id="3371849">.</span><span class="ident" id="3371850">ParseFloat</span><span class="op" id="3371860">(</span><span class="ident" id="3371861">s</span><span class="op" id="3371862">,</span>&nbsp;<span class="ident" id="3371864">v</span><span class="op" id="3371865">.</span><span class="ident" id="3371866">Type</span><span class="op" id="3371870">(</span><span class="op" id="3371871">)</span><span class="op" id="3371872">.</span><span class="ident" id="3371873">Bits</span><span class="op" id="3371877">(</span><span class="op" id="3371878">)</span><span class="op" id="3371879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371884">if</span>&nbsp;<span class="ident" id="3371887">err</span>&nbsp;<span class="op" id="3371891">!=</span>&nbsp;<span class="builtintype" id="3371894">nil</span>&nbsp;<span class="op" id="3371898">||</span>&nbsp;<span class="ident" id="3371901">v</span><span class="op" id="3371902">.</span><span class="ident" id="3371903">OverflowFloat</span><span class="op" id="3371916">(</span><span class="ident" id="3371917">n</span><span class="op" id="3371918">)</span>&nbsp;<span class="op" id="3371920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371926">d</span><span class="op" id="3371927">.</span><span class="ident" id="3371928">saveError</span><span class="op" id="3371937">(</span><span class="op" id="3371938">&amp;</span><span class="ident" id="3371939">UnmarshalTypeError</span><span class="op" id="3371957">{</span><span class="string" id="3371958">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="3371968">+</span>&nbsp;<span class="ident" id="3371970">s</span><span class="op" id="3371971">,</span>&nbsp;<span class="ident" id="3371973">v</span><span class="op" id="3371974">.</span><span class="ident" id="3371975">Type</span><span class="op" id="3371979">(</span><span class="op" id="3371980">)</span><span class="op" id="3371981">}</span><span class="op" id="3371982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371988">break</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372002">v</span><span class="op" id="3372003">.</span><span class="ident" id="3372004">SetFloat</span><span class="op" id="3372012">(</span><span class="ident" id="3372013">n</span><span class="op" id="3372014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372021">}</span><br>
<span class="lineno"></span><span class="op" id="3372023">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="comment" id="3372026">//&nbsp;The&nbsp;xxxInterface&nbsp;routines&nbsp;build&nbsp;up&nbsp;a&nbsp;value&nbsp;to&nbsp;be&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="3372085">//&nbsp;in&nbsp;an&nbsp;empty&nbsp;interface.&nbsp;&nbsp;They&nbsp;are&nbsp;not&nbsp;strictly&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3372145">//&nbsp;but&nbsp;they&nbsp;avoid&nbsp;the&nbsp;weight&nbsp;of&nbsp;reflection&nbsp;in&nbsp;this&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="3372210">//&nbsp;valueInterface&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;returns&nbsp;interface{}</span><br>
<span class="lineno"></span><span class="keyword" id="3372266">func</span>&nbsp;<span class="op" id="3372271">(</span><span class="ident" id="3372272">d</span>&nbsp;<span class="op" id="3372274">*</span><span class="ident" id="3372275">decodeState</span><span class="op" id="3372286">)</span>&nbsp;<span class="ident" id="3372288">valueInterface</span><span class="op" id="3372302">(</span><span class="op" id="3372303">)</span>&nbsp;<span class="keyword" id="3372305">interface</span><span class="op" id="3372314">{</span><span class="op" id="3372315">}</span>&nbsp;<span class="op" id="3372317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372320">switch</span>&nbsp;<span class="ident" id="3372327">d</span><span class="op" id="3372328">.</span><span class="ident" id="3372329">scanWhile</span><span class="op" id="3372338">(</span><span class="ident" id="3372339">scanSkipSpace</span><span class="op" id="3372352">)</span>&nbsp;<span class="op" id="3372354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372357">default</span><span class="op" id="3372364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372368">d</span><span class="op" id="3372369">.</span><span class="builtintype" id="3372370">error</span><span class="op" id="3372375">(</span><span class="ident" id="3372376">errPhase</span><span class="op" id="3372384">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3372388">panic</span><span class="op" id="3372393">(</span><span class="string" id="3372394">&#34;unreachable&#34;</span><span class="op" id="3372407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372410">case</span>&nbsp;<span class="ident" id="3372415">scanBeginArray</span><span class="op" id="3372429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372433">return</span>&nbsp;<span class="ident" id="3372440">d</span><span class="op" id="3372441">.</span><span class="ident" id="3372442">arrayInterface</span><span class="op" id="3372456">(</span><span class="op" id="3372457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372460">case</span>&nbsp;<span class="ident" id="3372465">scanBeginObject</span><span class="op" id="3372480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372484">return</span>&nbsp;<span class="ident" id="3372491">d</span><span class="op" id="3372492">.</span><span class="ident" id="3372493">objectInterface</span><span class="op" id="3372508">(</span><span class="op" id="3372509">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372512">case</span>&nbsp;<span class="ident" id="3372517">scanBeginLiteral</span><span class="op" id="3372533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372537">return</span>&nbsp;<span class="ident" id="3372544">d</span><span class="op" id="3372545">.</span><span class="ident" id="3372546">literalInterface</span><span class="op" id="3372562">(</span><span class="op" id="3372563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372566">}</span><br>
<span class="lineno"></span><span class="op" id="3372568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="3372571">//&nbsp;arrayInterface&nbsp;is&nbsp;like&nbsp;array&nbsp;but&nbsp;returns&nbsp;[]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="3372630">func</span>&nbsp;<span class="op" id="3372635">(</span><span class="ident" id="3372636">d</span>&nbsp;<span class="op" id="3372638">*</span><span class="ident" id="3372639">decodeState</span><span class="op" id="3372650">)</span>&nbsp;<span class="ident" id="3372652">arrayInterface</span><span class="op" id="3372666">(</span><span class="op" id="3372667">)</span>&nbsp;<span class="op" id="3372669">[</span><span class="op" id="3372670">]</span><span class="keyword" id="3372671">interface</span><span class="op" id="3372680">{</span><span class="op" id="3372681">}</span>&nbsp;<span class="op" id="3372683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372686">var</span>&nbsp;<span class="ident" id="3372690">v</span>&nbsp;<span class="op" id="3372692">=</span>&nbsp;<span class="builtinfunc" id="3372694">make</span><span class="op" id="3372698">(</span><span class="op" id="3372699">[</span><span class="op" id="3372700">]</span><span class="keyword" id="3372701">interface</span><span class="op" id="3372710">{</span><span class="op" id="3372711">}</span><span class="op" id="3372712">,</span>&nbsp;<span class="num" id="3372714">0</span><span class="op" id="3372715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372718">for</span>&nbsp;<span class="op" id="3372722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3372726">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372786">op</span>&nbsp;<span class="op" id="3372789">:=</span>&nbsp;<span class="ident" id="3372792">d</span><span class="op" id="3372793">.</span><span class="ident" id="3372794">scanWhile</span><span class="op" id="3372803">(</span><span class="ident" id="3372804">scanSkipSpace</span><span class="op" id="3372817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372821">if</span>&nbsp;<span class="ident" id="3372824">op</span>&nbsp;<span class="op" id="3372827">==</span>&nbsp;<span class="ident" id="3372830">scanEndArray</span>&nbsp;<span class="op" id="3372843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372848">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3372861">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372917">d</span><span class="op" id="3372918">.</span><span class="ident" id="3372919">off</span><span class="op" id="3372922">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372927">d</span><span class="op" id="3372928">.</span><span class="ident" id="3372929">scan</span><span class="op" id="3372933">.</span><span class="ident" id="3372934">undo</span><span class="op" id="3372938">(</span><span class="ident" id="3372939">op</span><span class="op" id="3372941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372946">v</span>&nbsp;<span class="op" id="3372948">=</span>&nbsp;<span class="builtinfunc" id="3372950">append</span><span class="op" id="3372956">(</span><span class="ident" id="3372957">v</span><span class="op" id="3372958">,</span>&nbsp;<span class="ident" id="3372960">d</span><span class="op" id="3372961">.</span><span class="ident" id="3372962">valueInterface</span><span class="op" id="3372976">(</span><span class="op" id="3372977">)</span><span class="op" id="3372978">)</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3372983">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373015">op</span>&nbsp;<span class="op" id="3373018">=</span>&nbsp;<span class="ident" id="3373020">d</span><span class="op" id="3373021">.</span><span class="ident" id="3373022">scanWhile</span><span class="op" id="3373031">(</span><span class="ident" id="3373032">scanSkipSpace</span><span class="op" id="3373045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373049">if</span>&nbsp;<span class="ident" id="3373052">op</span>&nbsp;<span class="op" id="3373055">==</span>&nbsp;<span class="ident" id="3373058">scanEndArray</span>&nbsp;<span class="op" id="3373071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373076">break</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373088">if</span>&nbsp;<span class="ident" id="3373091">op</span>&nbsp;<span class="op" id="3373094">!=</span>&nbsp;<span class="ident" id="3373097">scanArrayValue</span>&nbsp;<span class="op" id="3373112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373117">d</span><span class="op" id="3373118">.</span><span class="builtintype" id="3373119">error</span><span class="op" id="3373124">(</span><span class="ident" id="3373125">errPhase</span><span class="op" id="3373133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373140">}</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373143">return</span>&nbsp;<span class="ident" id="3373150">v</span><br>
<span class="lineno"></span><span class="op" id="3373152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3373155">//&nbsp;objectInterface&nbsp;is&nbsp;like&nbsp;object&nbsp;but&nbsp;returns&nbsp;map[string]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="3373225">func</span>&nbsp;<span class="op" id="3373230">(</span><span class="ident" id="3373231">d</span>&nbsp;<span class="op" id="3373233">*</span><span class="ident" id="3373234">decodeState</span><span class="op" id="3373245">)</span>&nbsp;<span class="ident" id="3373247">objectInterface</span><span class="op" id="3373262">(</span><span class="op" id="3373263">)</span>&nbsp;<span class="keyword" id="3373265">map</span><span class="op" id="3373268">[</span><span class="builtintype" id="3373269">string</span><span class="op" id="3373275">]</span><span class="keyword" id="3373276">interface</span><span class="op" id="3373285">{</span><span class="op" id="3373286">}</span>&nbsp;<span class="op" id="3373288">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373291">m</span>&nbsp;<span class="op" id="3373293">:=</span>&nbsp;<span class="builtinfunc" id="3373296">make</span><span class="op" id="3373300">(</span><span class="keyword" id="3373301">map</span><span class="op" id="3373304">[</span><span class="builtintype" id="3373305">string</span><span class="op" id="3373311">]</span><span class="keyword" id="3373312">interface</span><span class="op" id="3373321">{</span><span class="op" id="3373322">}</span><span class="op" id="3373323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373326">for</span>&nbsp;<span class="op" id="3373330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373334">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373382">op</span>&nbsp;<span class="op" id="3373385">:=</span>&nbsp;<span class="ident" id="3373388">d</span><span class="op" id="3373389">.</span><span class="ident" id="3373390">scanWhile</span><span class="op" id="3373399">(</span><span class="ident" id="3373400">scanSkipSpace</span><span class="op" id="3373413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373417">if</span>&nbsp;<span class="ident" id="3373420">op</span>&nbsp;<span class="op" id="3373423">==</span>&nbsp;<span class="ident" id="3373426">scanEndObject</span>&nbsp;<span class="op" id="3373440">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373445">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373499">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373511">if</span>&nbsp;<span class="ident" id="3373514">op</span>&nbsp;<span class="op" id="3373517">!=</span>&nbsp;<span class="ident" id="3373520">scanBeginLiteral</span>&nbsp;<span class="op" id="3373537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373542">d</span><span class="op" id="3373543">.</span><span class="builtintype" id="3373544">error</span><span class="op" id="3373549">(</span><span class="ident" id="3373550">errPhase</span><span class="op" id="3373558">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373567">//&nbsp;Read&nbsp;string&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373589">start</span>&nbsp;<span class="op" id="3373595">:=</span>&nbsp;<span class="ident" id="3373598">d</span><span class="op" id="3373599">.</span><span class="ident" id="3373600">off</span>&nbsp;<span class="op" id="3373604">-</span>&nbsp;<span class="num" id="3373606">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373610">op</span>&nbsp;<span class="op" id="3373613">=</span>&nbsp;<span class="ident" id="3373615">d</span><span class="op" id="3373616">.</span><span class="ident" id="3373617">scanWhile</span><span class="op" id="3373626">(</span><span class="ident" id="3373627">scanContinue</span><span class="op" id="3373639">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373643">item</span>&nbsp;<span class="op" id="3373648">:=</span>&nbsp;<span class="ident" id="3373651">d</span><span class="op" id="3373652">.</span><span class="ident" id="3373653">data</span><span class="op" id="3373657">[</span><span class="ident" id="3373658">start</span>&nbsp;<span class="op" id="3373664">:</span>&nbsp;<span class="ident" id="3373666">d</span><span class="op" id="3373667">.</span><span class="ident" id="3373668">off</span><span class="op" id="3373671">-</span><span class="num" id="3373672">1</span><span class="op" id="3373673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373677">key</span><span class="op" id="3373680">,</span>&nbsp;<span class="ident" id="3373682">ok</span>&nbsp;<span class="op" id="3373685">:=</span>&nbsp;<span class="ident" id="3373688">unquote</span><span class="op" id="3373695">(</span><span class="ident" id="3373696">item</span><span class="op" id="3373700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373704">if</span>&nbsp;<span class="op" id="3373707">!</span><span class="ident" id="3373708">ok</span>&nbsp;<span class="op" id="3373711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373716">d</span><span class="op" id="3373717">.</span><span class="builtintype" id="3373718">error</span><span class="op" id="3373723">(</span><span class="ident" id="3373724">errPhase</span><span class="op" id="3373732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373736">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373741">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373767">if</span>&nbsp;<span class="ident" id="3373770">op</span>&nbsp;<span class="op" id="3373773">==</span>&nbsp;<span class="ident" id="3373776">scanSkipSpace</span>&nbsp;<span class="op" id="3373790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373795">op</span>&nbsp;<span class="op" id="3373798">=</span>&nbsp;<span class="ident" id="3373800">d</span><span class="op" id="3373801">.</span><span class="ident" id="3373802">scanWhile</span><span class="op" id="3373811">(</span><span class="ident" id="3373812">scanSkipSpace</span><span class="op" id="3373825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373829">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373833">if</span>&nbsp;<span class="ident" id="3373836">op</span>&nbsp;<span class="op" id="3373839">!=</span>&nbsp;<span class="ident" id="3373842">scanObjectKey</span>&nbsp;<span class="op" id="3373856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373861">d</span><span class="op" id="3373862">.</span><span class="builtintype" id="3373863">error</span><span class="op" id="3373868">(</span><span class="ident" id="3373869">errPhase</span><span class="op" id="3373877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373886">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373903">m</span><span class="op" id="3373904">[</span><span class="ident" id="3373905">key</span><span class="op" id="3373908">]</span>&nbsp;<span class="op" id="3373910">=</span>&nbsp;<span class="ident" id="3373912">d</span><span class="op" id="3373913">.</span><span class="ident" id="3373914">valueInterface</span><span class="op" id="3373928">(</span><span class="op" id="3373929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3373934">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373966">op</span>&nbsp;<span class="op" id="3373969">=</span>&nbsp;<span class="ident" id="3373971">d</span><span class="op" id="3373972">.</span><span class="ident" id="3373973">scanWhile</span><span class="op" id="3373982">(</span><span class="ident" id="3373983">scanSkipSpace</span><span class="op" id="3373996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374000">if</span>&nbsp;<span class="ident" id="3374003">op</span>&nbsp;<span class="op" id="3374006">==</span>&nbsp;<span class="ident" id="3374009">scanEndObject</span>&nbsp;<span class="op" id="3374023">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374028">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374040">if</span>&nbsp;<span class="ident" id="3374043">op</span>&nbsp;<span class="op" id="3374046">!=</span>&nbsp;<span class="ident" id="3374049">scanObjectValue</span>&nbsp;<span class="op" id="3374065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374070">d</span><span class="op" id="3374071">.</span><span class="builtintype" id="3374072">error</span><span class="op" id="3374077">(</span><span class="ident" id="3374078">errPhase</span><span class="op" id="3374086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374090">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374096">return</span>&nbsp;<span class="ident" id="3374103">m</span><br>
<span class="lineno"></span><span class="op" id="3374105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3374108">//&nbsp;literalInterface&nbsp;is&nbsp;like&nbsp;literal&nbsp;but&nbsp;returns&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno">915</span><span class="keyword" id="3374176">func</span>&nbsp;<span class="op" id="3374181">(</span><span class="ident" id="3374182">d</span>&nbsp;<span class="op" id="3374184">*</span><span class="ident" id="3374185">decodeState</span><span class="op" id="3374196">)</span>&nbsp;<span class="ident" id="3374198">literalInterface</span><span class="op" id="3374214">(</span><span class="op" id="3374215">)</span>&nbsp;<span class="keyword" id="3374217">interface</span><span class="op" id="3374226">{</span><span class="op" id="3374227">}</span>&nbsp;<span class="op" id="3374229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3374232">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374290">start</span>&nbsp;<span class="op" id="3374296">:=</span>&nbsp;<span class="ident" id="3374299">d</span><span class="op" id="3374300">.</span><span class="ident" id="3374301">off</span>&nbsp;<span class="op" id="3374305">-</span>&nbsp;<span class="num" id="3374307">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374310">op</span>&nbsp;<span class="op" id="3374313">:=</span>&nbsp;<span class="ident" id="3374316">d</span><span class="op" id="3374317">.</span><span class="ident" id="3374318">scanWhile</span><span class="op" id="3374327">(</span><span class="ident" id="3374328">scanContinue</span><span class="op" id="3374340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3374344">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374385">d</span><span class="op" id="3374386">.</span><span class="ident" id="3374387">off</span><span class="op" id="3374390">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374394">d</span><span class="op" id="3374395">.</span><span class="ident" id="3374396">scan</span><span class="op" id="3374400">.</span><span class="ident" id="3374401">undo</span><span class="op" id="3374405">(</span><span class="ident" id="3374406">op</span><span class="op" id="3374408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374411">item</span>&nbsp;<span class="op" id="3374416">:=</span>&nbsp;<span class="ident" id="3374419">d</span><span class="op" id="3374420">.</span><span class="ident" id="3374421">data</span><span class="op" id="3374425">[</span><span class="ident" id="3374426">start</span><span class="op" id="3374431">:</span><span class="ident" id="3374432">d</span><span class="op" id="3374433">.</span><span class="ident" id="3374434">off</span><span class="op" id="3374437">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374441">switch</span>&nbsp;<span class="ident" id="3374448">c</span>&nbsp;<span class="op" id="3374450">:=</span>&nbsp;<span class="ident" id="3374453">item</span><span class="op" id="3374457">[</span><span class="num" id="3374458">0</span><span class="op" id="3374459">]</span><span class="op" id="3374460">;</span>&nbsp;<span class="ident" id="3374462">c</span>&nbsp;<span class="op" id="3374464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374467">case</span>&nbsp;<span class="string" id="3374472">&#39;n&#39;</span><span class="op" id="3374475">:</span>&nbsp;<span class="comment" id="3374477">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374487">return</span>&nbsp;<span class="builtintype" id="3374494">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374500">case</span>&nbsp;<span class="string" id="3374505">&#39;t&#39;</span><span class="op" id="3374508">,</span>&nbsp;<span class="string" id="3374510">&#39;f&#39;</span><span class="op" id="3374513">:</span>&nbsp;<span class="comment" id="3374515">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374532">return</span>&nbsp;<span class="ident" id="3374539">c</span>&nbsp;<span class="op" id="3374541">==</span>&nbsp;<span class="string" id="3374544">&#39;t&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374550">case</span>&nbsp;<span class="string" id="3374555">&#39;&#34;&#39;</span><span class="op" id="3374558">:</span>&nbsp;<span class="comment" id="3374560">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374572">s</span><span class="op" id="3374573">,</span>&nbsp;<span class="ident" id="3374575">ok</span>&nbsp;<span class="op" id="3374578">:=</span>&nbsp;<span class="ident" id="3374581">unquote</span><span class="op" id="3374588">(</span><span class="ident" id="3374589">item</span><span class="op" id="3374593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374597">if</span>&nbsp;<span class="op" id="3374600">!</span><span class="ident" id="3374601">ok</span>&nbsp;<span class="op" id="3374604">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374609">d</span><span class="op" id="3374610">.</span><span class="builtintype" id="3374611">error</span><span class="op" id="3374616">(</span><span class="ident" id="3374617">errPhase</span><span class="op" id="3374625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374633">return</span>&nbsp;<span class="ident" id="3374640">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374644">default</span><span class="op" id="3374651">:</span>&nbsp;<span class="comment" id="3374653">//&nbsp;number</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374665">if</span>&nbsp;<span class="ident" id="3374668">c</span>&nbsp;<span class="op" id="3374670">!=</span>&nbsp;<span class="string" id="3374673">&#39;-&#39;</span>&nbsp;<span class="op" id="3374677">&amp;&amp;</span>&nbsp;<span class="op" id="3374680">(</span><span class="ident" id="3374681">c</span>&nbsp;<span class="op" id="3374683">&lt;</span>&nbsp;<span class="string" id="3374685">&#39;0&#39;</span>&nbsp;<span class="op" id="3374689">||</span>&nbsp;<span class="ident" id="3374692">c</span>&nbsp;<span class="op" id="3374694">&gt;</span>&nbsp;<span class="string" id="3374696">&#39;9&#39;</span><span class="op" id="3374699">)</span>&nbsp;<span class="op" id="3374701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374706">d</span><span class="op" id="3374707">.</span><span class="builtintype" id="3374708">error</span><span class="op" id="3374713">(</span><span class="ident" id="3374714">errPhase</span><span class="op" id="3374722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374730">n</span><span class="op" id="3374731">,</span>&nbsp;<span class="ident" id="3374733">err</span>&nbsp;<span class="op" id="3374737">:=</span>&nbsp;<span class="ident" id="3374740">d</span><span class="op" id="3374741">.</span><span class="ident" id="3374742">convertNumber</span><span class="op" id="3374755">(</span><span class="builtintype" id="3374756">string</span><span class="op" id="3374762">(</span><span class="ident" id="3374763">item</span><span class="op" id="3374767">)</span><span class="op" id="3374768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374772">if</span>&nbsp;<span class="ident" id="3374775">err</span>&nbsp;<span class="op" id="3374779">!=</span>&nbsp;<span class="builtintype" id="3374782">nil</span>&nbsp;<span class="op" id="3374786">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374791">d</span><span class="op" id="3374792">.</span><span class="ident" id="3374793">saveError</span><span class="op" id="3374802">(</span><span class="ident" id="3374803">err</span><span class="op" id="3374806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374814">return</span>&nbsp;<span class="ident" id="3374821">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374824">}</span><br>
<span class="lineno"></span><span class="op" id="3374826">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="comment" id="3374829">//&nbsp;getu4&nbsp;decodes&nbsp;\uXXXX&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s,&nbsp;returning&nbsp;the&nbsp;hex&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="3374903">//&nbsp;or&nbsp;it&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="3374924">func</span>&nbsp;<span class="ident" id="3374929">getu4</span><span class="op" id="3374934">(</span><span class="ident" id="3374935">s</span>&nbsp;<span class="op" id="3374937">[</span><span class="op" id="3374938">]</span><span class="builtintype" id="3374939">byte</span><span class="op" id="3374943">)</span>&nbsp;<span class="builtintype" id="3374945">rune</span>&nbsp;<span class="op" id="3374950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374953">if</span>&nbsp;<span class="builtinfunc" id="3374956">len</span><span class="op" id="3374959">(</span><span class="ident" id="3374960">s</span><span class="op" id="3374961">)</span>&nbsp;<span class="op" id="3374963">&lt;</span>&nbsp;<span class="num" id="3374965">6</span>&nbsp;<span class="op" id="3374967">||</span>&nbsp;<span class="ident" id="3374970">s</span><span class="op" id="3374971">[</span><span class="num" id="3374972">0</span><span class="op" id="3374973">]</span>&nbsp;<span class="op" id="3374975">!=</span>&nbsp;<span class="string" id="3374978">&#39;\\&#39;</span>&nbsp;<span class="op" id="3374983">||</span>&nbsp;<span class="ident" id="3374986">s</span><span class="op" id="3374987">[</span><span class="num" id="3374988">1</span><span class="op" id="3374989">]</span>&nbsp;<span class="op" id="3374991">!=</span>&nbsp;<span class="string" id="3374994">&#39;u&#39;</span>&nbsp;<span class="op" id="3374998">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375002">return</span>&nbsp;<span class="op" id="3375009">-</span><span class="num" id="3375010">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375016">r</span><span class="op" id="3375017">,</span>&nbsp;<span class="ident" id="3375019">err</span>&nbsp;<span class="op" id="3375023">:=</span>&nbsp;<span class="ident" id="3375026">strconv</span><span class="op" id="3375033">.</span><span class="ident" id="3375034">ParseUint</span><span class="op" id="3375043">(</span><span class="builtintype" id="3375044">string</span><span class="op" id="3375050">(</span><span class="ident" id="3375051">s</span><span class="op" id="3375052">[</span><span class="num" id="3375053">2</span><span class="op" id="3375054">:</span><span class="num" id="3375055">6</span><span class="op" id="3375056">]</span><span class="op" id="3375057">)</span><span class="op" id="3375058">,</span>&nbsp;<span class="num" id="3375060">16</span><span class="op" id="3375062">,</span>&nbsp;<span class="num" id="3375064">64</span><span class="op" id="3375066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375069">if</span>&nbsp;<span class="ident" id="3375072">err</span>&nbsp;<span class="op" id="3375076">!=</span>&nbsp;<span class="builtintype" id="3375079">nil</span>&nbsp;<span class="op" id="3375083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375087">return</span>&nbsp;<span class="op" id="3375094">-</span><span class="num" id="3375095">1</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375101">return</span>&nbsp;<span class="builtintype" id="3375108">rune</span><span class="op" id="3375112">(</span><span class="ident" id="3375113">r</span><span class="op" id="3375114">)</span><br>
<span class="lineno"></span><span class="op" id="3375116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3375119">//&nbsp;unquote&nbsp;converts&nbsp;a&nbsp;quoted&nbsp;JSON&nbsp;string&nbsp;literal&nbsp;s&nbsp;into&nbsp;an&nbsp;actual&nbsp;string&nbsp;t.</span><br>
<span class="lineno">965</span><span class="comment" id="3375195">//&nbsp;The&nbsp;rules&nbsp;are&nbsp;different&nbsp;than&nbsp;for&nbsp;Go,&nbsp;so&nbsp;cannot&nbsp;use&nbsp;strconv.Unquote.</span><br>
<span class="lineno"></span><span class="keyword" id="3375266">func</span>&nbsp;<span class="ident" id="3375271">unquote</span><span class="op" id="3375278">(</span><span class="ident" id="3375279">s</span>&nbsp;<span class="op" id="3375281">[</span><span class="op" id="3375282">]</span><span class="builtintype" id="3375283">byte</span><span class="op" id="3375287">)</span>&nbsp;<span class="op" id="3375289">(</span><span class="ident" id="3375290">t</span>&nbsp;<span class="builtintype" id="3375292">string</span><span class="op" id="3375298">,</span>&nbsp;<span class="ident" id="3375300">ok</span>&nbsp;<span class="builtintype" id="3375303">bool</span><span class="op" id="3375307">)</span>&nbsp;<span class="op" id="3375309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375312">s</span><span class="op" id="3375313">,</span>&nbsp;<span class="ident" id="3375315">ok</span>&nbsp;<span class="op" id="3375318">=</span>&nbsp;<span class="ident" id="3375320">unquoteBytes</span><span class="op" id="3375332">(</span><span class="ident" id="3375333">s</span><span class="op" id="3375334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375337">t</span>&nbsp;<span class="op" id="3375339">=</span>&nbsp;<span class="builtintype" id="3375341">string</span><span class="op" id="3375347">(</span><span class="ident" id="3375348">s</span><span class="op" id="3375349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375352">return</span><br>
<span class="lineno">970</span><span class="op" id="3375359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3375362">func</span>&nbsp;<span class="ident" id="3375367">unquoteBytes</span><span class="op" id="3375379">(</span><span class="ident" id="3375380">s</span>&nbsp;<span class="op" id="3375382">[</span><span class="op" id="3375383">]</span><span class="builtintype" id="3375384">byte</span><span class="op" id="3375388">)</span>&nbsp;<span class="op" id="3375390">(</span><span class="ident" id="3375391">t</span>&nbsp;<span class="op" id="3375393">[</span><span class="op" id="3375394">]</span><span class="builtintype" id="3375395">byte</span><span class="op" id="3375399">,</span>&nbsp;<span class="ident" id="3375401">ok</span>&nbsp;<span class="builtintype" id="3375404">bool</span><span class="op" id="3375408">)</span>&nbsp;<span class="op" id="3375410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375413">if</span>&nbsp;<span class="builtinfunc" id="3375416">len</span><span class="op" id="3375419">(</span><span class="ident" id="3375420">s</span><span class="op" id="3375421">)</span>&nbsp;<span class="op" id="3375423">&lt;</span>&nbsp;<span class="num" id="3375425">2</span>&nbsp;<span class="op" id="3375427">||</span>&nbsp;<span class="ident" id="3375430">s</span><span class="op" id="3375431">[</span><span class="num" id="3375432">0</span><span class="op" id="3375433">]</span>&nbsp;<span class="op" id="3375435">!=</span>&nbsp;<span class="string" id="3375438">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3375442">||</span>&nbsp;<span class="ident" id="3375445">s</span><span class="op" id="3375446">[</span><span class="builtinfunc" id="3375447">len</span><span class="op" id="3375450">(</span><span class="ident" id="3375451">s</span><span class="op" id="3375452">)</span><span class="op" id="3375453">-</span><span class="num" id="3375454">1</span><span class="op" id="3375455">]</span>&nbsp;<span class="op" id="3375457">!=</span>&nbsp;<span class="string" id="3375460">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3375464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375468">return</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375479">s</span>&nbsp;<span class="op" id="3375481">=</span>&nbsp;<span class="ident" id="3375483">s</span><span class="op" id="3375484">[</span><span class="num" id="3375485">1</span>&nbsp;<span class="op" id="3375487">:</span>&nbsp;<span class="builtinfunc" id="3375489">len</span><span class="op" id="3375492">(</span><span class="ident" id="3375493">s</span><span class="op" id="3375494">)</span><span class="op" id="3375495">-</span><span class="num" id="3375496">1</span><span class="op" id="3375497">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375501">//&nbsp;Check&nbsp;for&nbsp;unusual&nbsp;characters.&nbsp;If&nbsp;there&nbsp;are&nbsp;none,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375554">//&nbsp;then&nbsp;no&nbsp;unquoting&nbsp;is&nbsp;needed,&nbsp;so&nbsp;return&nbsp;a&nbsp;slice&nbsp;of&nbsp;the</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375612">//&nbsp;original&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375632">r</span>&nbsp;<span class="op" id="3375634">:=</span>&nbsp;<span class="num" id="3375637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375640">for</span>&nbsp;<span class="ident" id="3375644">r</span>&nbsp;<span class="op" id="3375646">&lt;</span>&nbsp;<span class="builtinfunc" id="3375648">len</span><span class="op" id="3375651">(</span><span class="ident" id="3375652">s</span><span class="op" id="3375653">)</span>&nbsp;<span class="op" id="3375655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375659">c</span>&nbsp;<span class="op" id="3375661">:=</span>&nbsp;<span class="ident" id="3375664">s</span><span class="op" id="3375665">[</span><span class="ident" id="3375666">r</span><span class="op" id="3375667">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375671">if</span>&nbsp;<span class="ident" id="3375674">c</span>&nbsp;<span class="op" id="3375676">==</span>&nbsp;<span class="string" id="3375679">&#39;\\&#39;</span>&nbsp;<span class="op" id="3375684">||</span>&nbsp;<span class="ident" id="3375687">c</span>&nbsp;<span class="op" id="3375689">==</span>&nbsp;<span class="string" id="3375692">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3375696">||</span>&nbsp;<span class="ident" id="3375699">c</span>&nbsp;<span class="op" id="3375701">&lt;</span>&nbsp;<span class="string" id="3375703">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3375707">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375712">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375724">if</span>&nbsp;<span class="ident" id="3375727">c</span>&nbsp;<span class="op" id="3375729">&lt;</span>&nbsp;<span class="ident" id="3375731">utf8</span><span class="op" id="3375735">.</span><span class="ident" id="3375736">RuneSelf</span>&nbsp;<span class="op" id="3375745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375750">r</span><span class="op" id="3375751">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375757">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375772">rr</span><span class="op" id="3375774">,</span>&nbsp;<span class="ident" id="3375776">size</span>&nbsp;<span class="op" id="3375781">:=</span>&nbsp;<span class="ident" id="3375784">utf8</span><span class="op" id="3375788">.</span><span class="ident" id="3375789">DecodeRune</span><span class="op" id="3375799">(</span><span class="ident" id="3375800">s</span><span class="op" id="3375801">[</span><span class="ident" id="3375802">r</span><span class="op" id="3375803">:</span><span class="op" id="3375804">]</span><span class="op" id="3375805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375809">if</span>&nbsp;<span class="ident" id="3375812">rr</span>&nbsp;<span class="op" id="3375815">==</span>&nbsp;<span class="ident" id="3375818">utf8</span><span class="op" id="3375822">.</span><span class="ident" id="3375823">RuneError</span>&nbsp;<span class="op" id="3375833">&amp;&amp;</span>&nbsp;<span class="ident" id="3375836">size</span>&nbsp;<span class="op" id="3375841">==</span>&nbsp;<span class="num" id="3375844">1</span>&nbsp;<span class="op" id="3375846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375851">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375859">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375863">r</span>&nbsp;<span class="op" id="3375865">+=</span>&nbsp;<span class="ident" id="3375868">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375877">if</span>&nbsp;<span class="ident" id="3375880">r</span>&nbsp;<span class="op" id="3375882">==</span>&nbsp;<span class="builtinfunc" id="3375885">len</span><span class="op" id="3375888">(</span><span class="ident" id="3375889">s</span><span class="op" id="3375890">)</span>&nbsp;<span class="op" id="3375892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375896">return</span>&nbsp;<span class="ident" id="3375903">s</span><span class="op" id="3375904">,</span>&nbsp;<span class="builtintype" id="3375906">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375912">}</span><br>
<span class="lineno">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375916">b</span>&nbsp;<span class="op" id="3375918">:=</span>&nbsp;<span class="builtinfunc" id="3375921">make</span><span class="op" id="3375925">(</span><span class="op" id="3375926">[</span><span class="op" id="3375927">]</span><span class="builtintype" id="3375928">byte</span><span class="op" id="3375932">,</span>&nbsp;<span class="builtinfunc" id="3375934">len</span><span class="op" id="3375937">(</span><span class="ident" id="3375938">s</span><span class="op" id="3375939">)</span><span class="op" id="3375940">+</span><span class="num" id="3375941">2</span><span class="op" id="3375942">*</span><span class="ident" id="3375943">utf8</span><span class="op" id="3375947">.</span><span class="ident" id="3375948">UTFMax</span><span class="op" id="3375954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375957">w</span>&nbsp;<span class="op" id="3375959">:=</span>&nbsp;<span class="builtinfunc" id="3375962">copy</span><span class="op" id="3375966">(</span><span class="ident" id="3375967">b</span><span class="op" id="3375968">,</span>&nbsp;<span class="ident" id="3375970">s</span><span class="op" id="3375971">[</span><span class="num" id="3375972">0</span><span class="op" id="3375973">:</span><span class="ident" id="3375974">r</span><span class="op" id="3375975">]</span><span class="op" id="3375976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375979">for</span>&nbsp;<span class="ident" id="3375983">r</span>&nbsp;<span class="op" id="3375985">&lt;</span>&nbsp;<span class="builtinfunc" id="3375987">len</span><span class="op" id="3375990">(</span><span class="ident" id="3375991">s</span><span class="op" id="3375992">)</span>&nbsp;<span class="op" id="3375994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375998">//&nbsp;Out&nbsp;of&nbsp;room?&nbsp;&nbsp;Can&nbsp;only&nbsp;happen&nbsp;if&nbsp;s&nbsp;is&nbsp;full&nbsp;of</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376049">//&nbsp;malformed&nbsp;UTF-8&nbsp;and&nbsp;we&#39;re&nbsp;replacing&nbsp;each</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376095">//&nbsp;byte&nbsp;with&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376121">if</span>&nbsp;<span class="ident" id="3376124">w</span>&nbsp;<span class="op" id="3376126">&gt;=</span>&nbsp;<span class="builtinfunc" id="3376129">len</span><span class="op" id="3376132">(</span><span class="ident" id="3376133">b</span><span class="op" id="3376134">)</span><span class="op" id="3376135">-</span><span class="num" id="3376136">2</span><span class="op" id="3376137">*</span><span class="ident" id="3376138">utf8</span><span class="op" id="3376142">.</span><span class="ident" id="3376143">UTFMax</span>&nbsp;<span class="op" id="3376150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376155">nb</span>&nbsp;<span class="op" id="3376158">:=</span>&nbsp;<span class="builtinfunc" id="3376161">make</span><span class="op" id="3376165">(</span><span class="op" id="3376166">[</span><span class="op" id="3376167">]</span><span class="builtintype" id="3376168">byte</span><span class="op" id="3376172">,</span>&nbsp;<span class="op" id="3376174">(</span><span class="builtinfunc" id="3376175">len</span><span class="op" id="3376178">(</span><span class="ident" id="3376179">b</span><span class="op" id="3376180">)</span><span class="op" id="3376181">+</span><span class="ident" id="3376182">utf8</span><span class="op" id="3376186">.</span><span class="ident" id="3376187">UTFMax</span><span class="op" id="3376193">)</span><span class="op" id="3376194">*</span><span class="num" id="3376195">2</span><span class="op" id="3376196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3376201">copy</span><span class="op" id="3376205">(</span><span class="ident" id="3376206">nb</span><span class="op" id="3376208">,</span>&nbsp;<span class="ident" id="3376210">b</span><span class="op" id="3376211">[</span><span class="num" id="3376212">0</span><span class="op" id="3376213">:</span><span class="ident" id="3376214">w</span><span class="op" id="3376215">]</span><span class="op" id="3376216">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376221">b</span>&nbsp;<span class="op" id="3376223">=</span>&nbsp;<span class="ident" id="3376225">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376234">switch</span>&nbsp;<span class="ident" id="3376241">c</span>&nbsp;<span class="op" id="3376243">:=</span>&nbsp;<span class="ident" id="3376246">s</span><span class="op" id="3376247">[</span><span class="ident" id="3376248">r</span><span class="op" id="3376249">]</span><span class="op" id="3376250">;</span>&nbsp;<span class="op" id="3376252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376256">case</span>&nbsp;<span class="ident" id="3376261">c</span>&nbsp;<span class="op" id="3376263">==</span>&nbsp;<span class="string" id="3376266">&#39;\\&#39;</span><span class="op" id="3376270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376275">r</span><span class="op" id="3376276">++</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376282">if</span>&nbsp;<span class="ident" id="3376285">r</span>&nbsp;<span class="op" id="3376287">&gt;=</span>&nbsp;<span class="builtinfunc" id="3376290">len</span><span class="op" id="3376293">(</span><span class="ident" id="3376294">s</span><span class="op" id="3376295">)</span>&nbsp;<span class="op" id="3376297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376303">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376318">switch</span>&nbsp;<span class="ident" id="3376325">s</span><span class="op" id="3376326">[</span><span class="ident" id="3376327">r</span><span class="op" id="3376328">]</span>&nbsp;<span class="op" id="3376330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376335">default</span><span class="op" id="3376342">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376348">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376358">case</span>&nbsp;<span class="string" id="3376363">&#39;&#34;&#39;</span><span class="op" id="3376366">,</span>&nbsp;<span class="string" id="3376368">&#39;\\&#39;</span><span class="op" id="3376372">,</span>&nbsp;<span class="string" id="3376374">&#39;/&#39;</span><span class="op" id="3376377">,</span>&nbsp;<span class="string" id="3376379">&#39;\&#39;&#39;</span><span class="op" id="3376383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376389">b</span><span class="op" id="3376390">[</span><span class="ident" id="3376391">w</span><span class="op" id="3376392">]</span>&nbsp;<span class="op" id="3376394">=</span>&nbsp;<span class="ident" id="3376396">s</span><span class="op" id="3376397">[</span><span class="ident" id="3376398">r</span><span class="op" id="3376399">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376405">r</span><span class="op" id="3376406">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376413">w</span><span class="op" id="3376414">++</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376420">case</span>&nbsp;<span class="string" id="3376425">&#39;b&#39;</span><span class="op" id="3376428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376434">b</span><span class="op" id="3376435">[</span><span class="ident" id="3376436">w</span><span class="op" id="3376437">]</span>&nbsp;<span class="op" id="3376439">=</span>&nbsp;<span class="string" id="3376441">&#39;\b&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376450">r</span><span class="op" id="3376451">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376458">w</span><span class="op" id="3376459">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376465">case</span>&nbsp;<span class="string" id="3376470">&#39;f&#39;</span><span class="op" id="3376473">:</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376479">b</span><span class="op" id="3376480">[</span><span class="ident" id="3376481">w</span><span class="op" id="3376482">]</span>&nbsp;<span class="op" id="3376484">=</span>&nbsp;<span class="string" id="3376486">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376495">r</span><span class="op" id="3376496">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376503">w</span><span class="op" id="3376504">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376510">case</span>&nbsp;<span class="string" id="3376515">&#39;n&#39;</span><span class="op" id="3376518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376524">b</span><span class="op" id="3376525">[</span><span class="ident" id="3376526">w</span><span class="op" id="3376527">]</span>&nbsp;<span class="op" id="3376529">=</span>&nbsp;<span class="string" id="3376531">&#39;\n&#39;</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376540">r</span><span class="op" id="3376541">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376548">w</span><span class="op" id="3376549">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376555">case</span>&nbsp;<span class="string" id="3376560">&#39;r&#39;</span><span class="op" id="3376563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376569">b</span><span class="op" id="3376570">[</span><span class="ident" id="3376571">w</span><span class="op" id="3376572">]</span>&nbsp;<span class="op" id="3376574">=</span>&nbsp;<span class="string" id="3376576">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376585">r</span><span class="op" id="3376586">++</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376593">w</span><span class="op" id="3376594">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376600">case</span>&nbsp;<span class="string" id="3376605">&#39;t&#39;</span><span class="op" id="3376608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376614">b</span><span class="op" id="3376615">[</span><span class="ident" id="3376616">w</span><span class="op" id="3376617">]</span>&nbsp;<span class="op" id="3376619">=</span>&nbsp;<span class="string" id="3376621">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376630">r</span><span class="op" id="3376631">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376638">w</span><span class="op" id="3376639">++</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376645">case</span>&nbsp;<span class="string" id="3376650">&#39;u&#39;</span><span class="op" id="3376653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376659">r</span><span class="op" id="3376660">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376667">rr</span>&nbsp;<span class="op" id="3376670">:=</span>&nbsp;<span class="ident" id="3376673">getu4</span><span class="op" id="3376678">(</span><span class="ident" id="3376679">s</span><span class="op" id="3376680">[</span><span class="ident" id="3376681">r</span><span class="op" id="3376682">:</span><span class="op" id="3376683">]</span><span class="op" id="3376684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376690">if</span>&nbsp;<span class="ident" id="3376693">rr</span>&nbsp;<span class="op" id="3376696">&lt;</span>&nbsp;<span class="num" id="3376698">0</span>&nbsp;<span class="op" id="3376700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376707">return</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376724">r</span>&nbsp;<span class="op" id="3376726">+=</span>&nbsp;<span class="num" id="3376729">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376735">if</span>&nbsp;<span class="ident" id="3376738">utf16</span><span class="op" id="3376743">.</span><span class="ident" id="3376744">IsSurrogate</span><span class="op" id="3376755">(</span><span class="ident" id="3376756">rr</span><span class="op" id="3376758">)</span>&nbsp;<span class="op" id="3376760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376767">rr1</span>&nbsp;<span class="op" id="3376771">:=</span>&nbsp;<span class="ident" id="3376774">getu4</span><span class="op" id="3376779">(</span><span class="ident" id="3376780">s</span><span class="op" id="3376781">[</span><span class="ident" id="3376782">r</span><span class="op" id="3376783">:</span><span class="op" id="3376784">]</span><span class="op" id="3376785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376792">if</span>&nbsp;<span class="ident" id="3376795">dec</span>&nbsp;<span class="op" id="3376799">:=</span>&nbsp;<span class="ident" id="3376802">utf16</span><span class="op" id="3376807">.</span><span class="ident" id="3376808">DecodeRune</span><span class="op" id="3376818">(</span><span class="ident" id="3376819">rr</span><span class="op" id="3376821">,</span>&nbsp;<span class="ident" id="3376823">rr1</span><span class="op" id="3376826">)</span><span class="op" id="3376827">;</span>&nbsp;<span class="ident" id="3376829">dec</span>&nbsp;<span class="op" id="3376833">!=</span>&nbsp;<span class="ident" id="3376836">unicode</span><span class="op" id="3376843">.</span><span class="ident" id="3376844">ReplacementChar</span>&nbsp;<span class="op" id="3376860">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376868">//&nbsp;A&nbsp;valid&nbsp;pair;&nbsp;consume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376900">r</span>&nbsp;<span class="op" id="3376902">+=</span>&nbsp;<span class="num" id="3376905">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376913">w</span>&nbsp;<span class="op" id="3376915">+=</span>&nbsp;<span class="ident" id="3376918">utf8</span><span class="op" id="3376922">.</span><span class="ident" id="3376923">EncodeRune</span><span class="op" id="3376933">(</span><span class="ident" id="3376934">b</span><span class="op" id="3376935">[</span><span class="ident" id="3376936">w</span><span class="op" id="3376937">:</span><span class="op" id="3376938">]</span><span class="op" id="3376939">,</span>&nbsp;<span class="ident" id="3376941">dec</span><span class="op" id="3376944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376952">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376963">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376970">//&nbsp;Invalid&nbsp;surrogate;&nbsp;fall&nbsp;back&nbsp;to&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377028">rr</span>&nbsp;<span class="op" id="3377031">=</span>&nbsp;<span class="ident" id="3377033">unicode</span><span class="op" id="3377040">.</span><span class="ident" id="3377041">ReplacementChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377067">w</span>&nbsp;<span class="op" id="3377069">+=</span>&nbsp;<span class="ident" id="3377072">utf8</span><span class="op" id="3377076">.</span><span class="ident" id="3377077">EncodeRune</span><span class="op" id="3377087">(</span><span class="ident" id="3377088">b</span><span class="op" id="3377089">[</span><span class="ident" id="3377090">w</span><span class="op" id="3377091">:</span><span class="op" id="3377092">]</span><span class="op" id="3377093">,</span>&nbsp;<span class="ident" id="3377095">rr</span><span class="op" id="3377097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377102">}</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3377107">//&nbsp;Quote,&nbsp;control&nbsp;characters&nbsp;are&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377151">case</span>&nbsp;<span class="ident" id="3377156">c</span>&nbsp;<span class="op" id="3377158">==</span>&nbsp;<span class="string" id="3377161">&#39;&#34;&#39;</span><span class="op" id="3377164">,</span>&nbsp;<span class="ident" id="3377166">c</span>&nbsp;<span class="op" id="3377168">&lt;</span>&nbsp;<span class="string" id="3377170">&#39;&nbsp;&#39;</span><span class="op" id="3377173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377178">return</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3377188">//&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377199">case</span>&nbsp;<span class="ident" id="3377204">c</span>&nbsp;<span class="op" id="3377206">&lt;</span>&nbsp;<span class="ident" id="3377208">utf8</span><span class="op" id="3377212">.</span><span class="ident" id="3377213">RuneSelf</span><span class="op" id="3377221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377226">b</span><span class="op" id="3377227">[</span><span class="ident" id="3377228">w</span><span class="op" id="3377229">]</span>&nbsp;<span class="op" id="3377231">=</span>&nbsp;<span class="ident" id="3377233">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377238">r</span><span class="op" id="3377239">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377245">w</span><span class="op" id="3377246">++</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3377252">//&nbsp;Coerce&nbsp;to&nbsp;well-formed&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377286">default</span><span class="op" id="3377293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377298">rr</span><span class="op" id="3377300">,</span>&nbsp;<span class="ident" id="3377302">size</span>&nbsp;<span class="op" id="3377307">:=</span>&nbsp;<span class="ident" id="3377310">utf8</span><span class="op" id="3377314">.</span><span class="ident" id="3377315">DecodeRune</span><span class="op" id="3377325">(</span><span class="ident" id="3377326">s</span><span class="op" id="3377327">[</span><span class="ident" id="3377328">r</span><span class="op" id="3377329">:</span><span class="op" id="3377330">]</span><span class="op" id="3377331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377336">r</span>&nbsp;<span class="op" id="3377338">+=</span>&nbsp;<span class="ident" id="3377341">size</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377349">w</span>&nbsp;<span class="op" id="3377351">+=</span>&nbsp;<span class="ident" id="3377354">utf8</span><span class="op" id="3377358">.</span><span class="ident" id="3377359">EncodeRune</span><span class="op" id="3377369">(</span><span class="ident" id="3377370">b</span><span class="op" id="3377371">[</span><span class="ident" id="3377372">w</span><span class="op" id="3377373">:</span><span class="op" id="3377374">]</span><span class="op" id="3377375">,</span>&nbsp;<span class="ident" id="3377377">rr</span><span class="op" id="3377379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377389">return</span>&nbsp;<span class="ident" id="3377396">b</span><span class="op" id="3377397">[</span><span class="num" id="3377398">0</span><span class="op" id="3377399">:</span><span class="ident" id="3377400">w</span><span class="op" id="3377401">]</span><span class="op" id="3377402">,</span>&nbsp;<span class="builtintype" id="3377404">true</span><br>
<span class="lineno"></span><span class="op" id="3377409">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
