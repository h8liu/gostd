<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8360766">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8360822">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8360876">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8360927">package</span>&nbsp;<span class="ident" id="8360935">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8360940">import</span>&nbsp;<span class="op" id="8360947">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360950">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360961">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360972">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360983">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360994">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8361001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8361004">func</span>&nbsp;<span class="ident" id="8361009">TestResolveUDPAddr</span><span class="op" id="8361027">(</span><span class="ident" id="8361028">t</span>&nbsp;<span class="op" id="8361030">*</span><span class="ident" id="8361031">testing</span><span class="op" id="8361038">.</span><span class="ident" id="8361039">T</span><span class="op" id="8361040">)</span>&nbsp;<span class="op" id="8361042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361045">for</span>&nbsp;<span class="ident" id="8361049">_</span><span class="op" id="8361050">,</span>&nbsp;<span class="ident" id="8361052">tt</span>&nbsp;<span class="op" id="8361055">:=</span>&nbsp;<span class="keyword" id="8361058">range</span>&nbsp;<span class="ident" id="8361064">resolveTCPAddrTests</span>&nbsp;<span class="op" id="8361084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361088">net</span>&nbsp;<span class="op" id="8361092">:=</span>&nbsp;<span class="ident" id="8361095">strings</span><span class="op" id="8361102">.</span><span class="ident" id="8361103">Replace</span><span class="op" id="8361110">(</span><span class="ident" id="8361111">tt</span><span class="op" id="8361113">.</span><span class="ident" id="8361114">net</span><span class="op" id="8361117">,</span>&nbsp;<span class="string" id="8361119">&#34;tcp&#34;</span><span class="op" id="8361124">,</span>&nbsp;<span class="string" id="8361126">&#34;udp&#34;</span><span class="op" id="8361131">,</span>&nbsp;<span class="op" id="8361133">-</span><span class="num" id="8361134">1</span><span class="op" id="8361135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361139">addr</span><span class="op" id="8361143">,</span>&nbsp;<span class="ident" id="8361145">err</span>&nbsp;<span class="op" id="8361149">:=</span>&nbsp;<span class="ident" id="8361152">ResolveUDPAddr</span><span class="op" id="8361166">(</span><span class="ident" id="8361167">net</span><span class="op" id="8361170">,</span>&nbsp;<span class="ident" id="8361172">tt</span><span class="op" id="8361174">.</span><span class="ident" id="8361175">litAddrOrName</span><span class="op" id="8361188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361192">if</span>&nbsp;<span class="ident" id="8361195">err</span>&nbsp;<span class="op" id="8361199">!=</span>&nbsp;<span class="ident" id="8361202">tt</span><span class="op" id="8361204">.</span><span class="ident" id="8361205">err</span>&nbsp;<span class="op" id="8361209">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361214">t</span><span class="op" id="8361215">.</span><span class="ident" id="8361216">Fatalf</span><span class="op" id="8361222">(</span><span class="string" id="8361223">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8361258">,</span>&nbsp;<span class="ident" id="8361260">net</span><span class="op" id="8361263">,</span>&nbsp;<span class="ident" id="8361265">tt</span><span class="op" id="8361267">.</span><span class="ident" id="8361268">litAddrOrName</span><span class="op" id="8361281">,</span>&nbsp;<span class="ident" id="8361283">err</span><span class="op" id="8361286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361294">if</span>&nbsp;<span class="op" id="8361297">!</span><span class="ident" id="8361298">reflect</span><span class="op" id="8361305">.</span><span class="ident" id="8361306">DeepEqual</span><span class="op" id="8361315">(</span><span class="ident" id="8361316">addr</span><span class="op" id="8361320">,</span>&nbsp;<span class="op" id="8361322">(</span><span class="op" id="8361323">*</span><span class="ident" id="8361324">UDPAddr</span><span class="op" id="8361331">)</span><span class="op" id="8361332">(</span><span class="ident" id="8361333">tt</span><span class="op" id="8361335">.</span><span class="ident" id="8361336">addr</span><span class="op" id="8361340">)</span><span class="op" id="8361341">)</span>&nbsp;<span class="op" id="8361343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361348">t</span><span class="op" id="8361349">.</span><span class="ident" id="8361350">Fatalf</span><span class="op" id="8361356">(</span><span class="string" id="8361357">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8361397">,</span>&nbsp;<span class="ident" id="8361399">net</span><span class="op" id="8361402">,</span>&nbsp;<span class="ident" id="8361404">tt</span><span class="op" id="8361406">.</span><span class="ident" id="8361407">litAddrOrName</span><span class="op" id="8361420">,</span>&nbsp;<span class="ident" id="8361422">addr</span><span class="op" id="8361426">,</span>&nbsp;<span class="ident" id="8361428">tt</span><span class="op" id="8361430">.</span><span class="ident" id="8361431">addr</span><span class="op" id="8361435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361439">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361443">if</span>&nbsp;<span class="ident" id="8361446">err</span>&nbsp;<span class="op" id="8361450">==</span>&nbsp;<span class="ident" id="8361453">nil</span>&nbsp;<span class="op" id="8361457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361462">str</span>&nbsp;<span class="op" id="8361466">:=</span>&nbsp;<span class="ident" id="8361469">addr</span><span class="op" id="8361473">.</span><span class="ident" id="8361474">String</span><span class="op" id="8361480">(</span><span class="op" id="8361481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361486">addr1</span><span class="op" id="8361491">,</span>&nbsp;<span class="ident" id="8361493">err</span>&nbsp;<span class="op" id="8361497">:=</span>&nbsp;<span class="ident" id="8361500">ResolveUDPAddr</span><span class="op" id="8361514">(</span><span class="ident" id="8361515">net</span><span class="op" id="8361518">,</span>&nbsp;<span class="ident" id="8361520">str</span><span class="op" id="8361523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361528">if</span>&nbsp;<span class="ident" id="8361531">err</span>&nbsp;<span class="op" id="8361535">!=</span>&nbsp;<span class="ident" id="8361538">nil</span>&nbsp;<span class="op" id="8361542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361548">t</span><span class="op" id="8361549">.</span><span class="ident" id="8361550">Fatalf</span><span class="op" id="8361556">(</span><span class="string" id="8361557">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="8361595">,</span>&nbsp;<span class="ident" id="8361597">net</span><span class="op" id="8361600">,</span>&nbsp;<span class="ident" id="8361602">str</span><span class="op" id="8361605">,</span>&nbsp;<span class="ident" id="8361607">tt</span><span class="op" id="8361609">.</span><span class="ident" id="8361610">litAddrOrName</span><span class="op" id="8361623">,</span>&nbsp;<span class="ident" id="8361625">err</span><span class="op" id="8361628">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361638">if</span>&nbsp;<span class="op" id="8361641">!</span><span class="ident" id="8361642">reflect</span><span class="op" id="8361649">.</span><span class="ident" id="8361650">DeepEqual</span><span class="op" id="8361659">(</span><span class="ident" id="8361660">addr1</span><span class="op" id="8361665">,</span>&nbsp;<span class="ident" id="8361667">addr</span><span class="op" id="8361671">)</span>&nbsp;<span class="op" id="8361673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361679">t</span><span class="op" id="8361680">.</span><span class="ident" id="8361681">Fatalf</span><span class="op" id="8361687">(</span><span class="string" id="8361688">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8361738">,</span>&nbsp;<span class="ident" id="8361740">net</span><span class="op" id="8361743">,</span>&nbsp;<span class="ident" id="8361745">str</span><span class="op" id="8361748">,</span>&nbsp;<span class="ident" id="8361750">tt</span><span class="op" id="8361752">.</span><span class="ident" id="8361753">litAddrOrName</span><span class="op" id="8361766">,</span>&nbsp;<span class="ident" id="8361768">addr1</span><span class="op" id="8361773">,</span>&nbsp;<span class="ident" id="8361775">addr</span><span class="op" id="8361779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361788">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361791">}</span><br>
<span class="lineno"></span><span class="op" id="8361793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8361796">func</span>&nbsp;<span class="ident" id="8361801">TestReadFromUDP</span><span class="op" id="8361816">(</span><span class="ident" id="8361817">t</span>&nbsp;<span class="op" id="8361819">*</span><span class="ident" id="8361820">testing</span><span class="op" id="8361827">.</span><span class="ident" id="8361828">T</span><span class="op" id="8361829">)</span>&nbsp;<span class="op" id="8361831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361834">switch</span>&nbsp;<span class="ident" id="8361841">runtime</span><span class="op" id="8361848">.</span><span class="ident" id="8361849">GOOS</span>&nbsp;<span class="op" id="8361854">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361857">case</span>&nbsp;<span class="string" id="8361862">&#34;nacl&#34;</span><span class="op" id="8361868">,</span>&nbsp;<span class="string" id="8361870">&#34;plan9&#34;</span><span class="op" id="8361877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361881">t</span><span class="op" id="8361882">.</span><span class="ident" id="8361883">Skipf</span><span class="op" id="8361888">(</span><span class="string" id="8361889">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="8361926">,</span>&nbsp;<span class="ident" id="8361928">runtime</span><span class="op" id="8361935">.</span><span class="ident" id="8361936">GOOS</span><span class="op" id="8361940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361947">ra</span><span class="op" id="8361949">,</span>&nbsp;<span class="ident" id="8361951">err</span>&nbsp;<span class="op" id="8361955">:=</span>&nbsp;<span class="ident" id="8361958">ResolveUDPAddr</span><span class="op" id="8361972">(</span><span class="string" id="8361973">&#34;udp&#34;</span><span class="op" id="8361978">,</span>&nbsp;<span class="string" id="8361980">&#34;127.0.0.1:7&#34;</span><span class="op" id="8361993">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8361996">if</span>&nbsp;<span class="ident" id="8361999">err</span>&nbsp;<span class="op" id="8362003">!=</span>&nbsp;<span class="ident" id="8362006">nil</span>&nbsp;<span class="op" id="8362010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362014">t</span><span class="op" id="8362015">.</span><span class="ident" id="8362016">Fatal</span><span class="op" id="8362021">(</span><span class="ident" id="8362022">err</span><span class="op" id="8362025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362032">la</span><span class="op" id="8362034">,</span>&nbsp;<span class="ident" id="8362036">err</span>&nbsp;<span class="op" id="8362040">:=</span>&nbsp;<span class="ident" id="8362043">ResolveUDPAddr</span><span class="op" id="8362057">(</span><span class="string" id="8362058">&#34;udp&#34;</span><span class="op" id="8362063">,</span>&nbsp;<span class="string" id="8362065">&#34;127.0.0.1:0&#34;</span><span class="op" id="8362078">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362081">if</span>&nbsp;<span class="ident" id="8362084">err</span>&nbsp;<span class="op" id="8362088">!=</span>&nbsp;<span class="ident" id="8362091">nil</span>&nbsp;<span class="op" id="8362095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362099">t</span><span class="op" id="8362100">.</span><span class="ident" id="8362101">Fatal</span><span class="op" id="8362106">(</span><span class="ident" id="8362107">err</span><span class="op" id="8362110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362117">c</span><span class="op" id="8362118">,</span>&nbsp;<span class="ident" id="8362120">err</span>&nbsp;<span class="op" id="8362124">:=</span>&nbsp;<span class="ident" id="8362127">ListenUDP</span><span class="op" id="8362136">(</span><span class="string" id="8362137">&#34;udp&#34;</span><span class="op" id="8362142">,</span>&nbsp;<span class="ident" id="8362144">la</span><span class="op" id="8362146">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362149">if</span>&nbsp;<span class="ident" id="8362152">err</span>&nbsp;<span class="op" id="8362156">!=</span>&nbsp;<span class="ident" id="8362159">nil</span>&nbsp;<span class="op" id="8362163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362167">t</span><span class="op" id="8362168">.</span><span class="ident" id="8362169">Fatal</span><span class="op" id="8362174">(</span><span class="ident" id="8362175">err</span><span class="op" id="8362178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362184">defer</span>&nbsp;<span class="ident" id="8362190">c</span><span class="op" id="8362191">.</span><span class="ident" id="8362192">Close</span><span class="op" id="8362197">(</span><span class="op" id="8362198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362202">_</span><span class="op" id="8362203">,</span>&nbsp;<span class="ident" id="8362205">err</span>&nbsp;<span class="op" id="8362209">=</span>&nbsp;<span class="ident" id="8362211">c</span><span class="op" id="8362212">.</span><span class="ident" id="8362213">WriteToUDP</span><span class="op" id="8362223">(</span><span class="op" id="8362224">[</span><span class="op" id="8362225">]</span><span class="builtintype" id="8362226">byte</span><span class="op" id="8362230">(</span><span class="string" id="8362231">&#34;a&#34;</span><span class="op" id="8362234">)</span><span class="op" id="8362235">,</span>&nbsp;<span class="ident" id="8362237">ra</span><span class="op" id="8362239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362242">if</span>&nbsp;<span class="ident" id="8362245">err</span>&nbsp;<span class="op" id="8362249">!=</span>&nbsp;<span class="ident" id="8362252">nil</span>&nbsp;<span class="op" id="8362256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362260">t</span><span class="op" id="8362261">.</span><span class="ident" id="8362262">Fatal</span><span class="op" id="8362267">(</span><span class="ident" id="8362268">err</span><span class="op" id="8362271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362278">err</span>&nbsp;<span class="op" id="8362282">=</span>&nbsp;<span class="ident" id="8362284">c</span><span class="op" id="8362285">.</span><span class="ident" id="8362286">SetDeadline</span><span class="op" id="8362297">(</span><span class="ident" id="8362298">time</span><span class="op" id="8362302">.</span><span class="ident" id="8362303">Now</span><span class="op" id="8362306">(</span><span class="op" id="8362307">)</span><span class="op" id="8362308">.</span><span class="ident" id="8362309">Add</span><span class="op" id="8362312">(</span><span class="num" id="8362313">100</span>&nbsp;<span class="op" id="8362317">*</span>&nbsp;<span class="ident" id="8362319">time</span><span class="op" id="8362323">.</span><span class="ident" id="8362324">Millisecond</span><span class="op" id="8362335">)</span><span class="op" id="8362336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362339">if</span>&nbsp;<span class="ident" id="8362342">err</span>&nbsp;<span class="op" id="8362346">!=</span>&nbsp;<span class="ident" id="8362349">nil</span>&nbsp;<span class="op" id="8362353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362357">t</span><span class="op" id="8362358">.</span><span class="ident" id="8362359">Fatal</span><span class="op" id="8362364">(</span><span class="ident" id="8362365">err</span><span class="op" id="8362368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362374">b</span>&nbsp;<span class="op" id="8362376">:=</span>&nbsp;<span class="builtinfunc" id="8362379">make</span><span class="op" id="8362383">(</span><span class="op" id="8362384">[</span><span class="op" id="8362385">]</span><span class="builtintype" id="8362386">byte</span><span class="op" id="8362390">,</span>&nbsp;<span class="num" id="8362392">1</span><span class="op" id="8362393">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362396">_</span><span class="op" id="8362397">,</span>&nbsp;<span class="ident" id="8362399">_</span><span class="op" id="8362400">,</span>&nbsp;<span class="ident" id="8362402">err</span>&nbsp;<span class="op" id="8362406">=</span>&nbsp;<span class="ident" id="8362408">c</span><span class="op" id="8362409">.</span><span class="ident" id="8362410">ReadFromUDP</span><span class="op" id="8362421">(</span><span class="ident" id="8362422">b</span><span class="op" id="8362423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362426">if</span>&nbsp;<span class="ident" id="8362429">err</span>&nbsp;<span class="op" id="8362433">==</span>&nbsp;<span class="ident" id="8362436">nil</span>&nbsp;<span class="op" id="8362440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362444">t</span><span class="op" id="8362445">.</span><span class="ident" id="8362446">Fatal</span><span class="op" id="8362451">(</span><span class="string" id="8362452">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8362477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362480">}</span>&nbsp;<span class="keyword" id="8362482">else</span>&nbsp;<span class="keyword" id="8362487">if</span>&nbsp;<span class="op" id="8362490">!</span><span class="ident" id="8362491">isTimeout</span><span class="op" id="8362500">(</span><span class="ident" id="8362501">err</span><span class="op" id="8362504">)</span>&nbsp;<span class="op" id="8362506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362510">t</span><span class="op" id="8362511">.</span><span class="ident" id="8362512">Fatal</span><span class="op" id="8362517">(</span><span class="ident" id="8362518">err</span><span class="op" id="8362521">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362524">}</span><br>
<span class="lineno"></span><span class="op" id="8362526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8362529">func</span>&nbsp;<span class="ident" id="8362534">TestWriteToUDP</span><span class="op" id="8362548">(</span><span class="ident" id="8362549">t</span>&nbsp;<span class="op" id="8362551">*</span><span class="ident" id="8362552">testing</span><span class="op" id="8362559">.</span><span class="ident" id="8362560">T</span><span class="op" id="8362561">)</span>&nbsp;<span class="op" id="8362563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362566">switch</span>&nbsp;<span class="ident" id="8362573">runtime</span><span class="op" id="8362580">.</span><span class="ident" id="8362581">GOOS</span>&nbsp;<span class="op" id="8362586">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362589">case</span>&nbsp;<span class="string" id="8362594">&#34;plan9&#34;</span><span class="op" id="8362601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362605">t</span><span class="op" id="8362606">.</span><span class="ident" id="8362607">Skipf</span><span class="op" id="8362612">(</span><span class="string" id="8362613">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8362634">,</span>&nbsp;<span class="ident" id="8362636">runtime</span><span class="op" id="8362643">.</span><span class="ident" id="8362644">GOOS</span><span class="op" id="8362648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362655">l</span><span class="op" id="8362656">,</span>&nbsp;<span class="ident" id="8362658">err</span>&nbsp;<span class="op" id="8362662">:=</span>&nbsp;<span class="ident" id="8362665">ListenPacket</span><span class="op" id="8362677">(</span><span class="string" id="8362678">&#34;udp&#34;</span><span class="op" id="8362683">,</span>&nbsp;<span class="string" id="8362685">&#34;127.0.0.1:0&#34;</span><span class="op" id="8362698">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362701">if</span>&nbsp;<span class="ident" id="8362704">err</span>&nbsp;<span class="op" id="8362708">!=</span>&nbsp;<span class="ident" id="8362711">nil</span>&nbsp;<span class="op" id="8362715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362719">t</span><span class="op" id="8362720">.</span><span class="ident" id="8362721">Fatalf</span><span class="op" id="8362727">(</span><span class="string" id="8362728">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8362747">,</span>&nbsp;<span class="ident" id="8362749">err</span><span class="op" id="8362752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362758">defer</span>&nbsp;<span class="ident" id="8362764">l</span><span class="op" id="8362765">.</span><span class="ident" id="8362766">Close</span><span class="op" id="8362771">(</span><span class="op" id="8362772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362776">testWriteToConn</span><span class="op" id="8362791">(</span><span class="ident" id="8362792">t</span><span class="op" id="8362793">,</span>&nbsp;<span class="ident" id="8362795">l</span><span class="op" id="8362796">.</span><span class="ident" id="8362797">LocalAddr</span><span class="op" id="8362806">(</span><span class="op" id="8362807">)</span><span class="op" id="8362808">.</span><span class="ident" id="8362809">String</span><span class="op" id="8362815">(</span><span class="op" id="8362816">)</span><span class="op" id="8362817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362820">testWriteToPacketConn</span><span class="op" id="8362841">(</span><span class="ident" id="8362842">t</span><span class="op" id="8362843">,</span>&nbsp;<span class="ident" id="8362845">l</span><span class="op" id="8362846">.</span><span class="ident" id="8362847">LocalAddr</span><span class="op" id="8362856">(</span><span class="op" id="8362857">)</span><span class="op" id="8362858">.</span><span class="ident" id="8362859">String</span><span class="op" id="8362865">(</span><span class="op" id="8362866">)</span><span class="op" id="8362867">)</span><br>
<span class="lineno"></span><span class="op" id="8362869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8362872">func</span>&nbsp;<span class="ident" id="8362877">testWriteToConn</span><span class="op" id="8362892">(</span><span class="ident" id="8362893">t</span>&nbsp;<span class="op" id="8362895">*</span><span class="ident" id="8362896">testing</span><span class="op" id="8362903">.</span><span class="ident" id="8362904">T</span><span class="op" id="8362905">,</span>&nbsp;<span class="ident" id="8362907">raddr</span>&nbsp;<span class="builtintype" id="8362913">string</span><span class="op" id="8362919">)</span>&nbsp;<span class="op" id="8362921">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362924">c</span><span class="op" id="8362925">,</span>&nbsp;<span class="ident" id="8362927">err</span>&nbsp;<span class="op" id="8362931">:=</span>&nbsp;<span class="ident" id="8362934">Dial</span><span class="op" id="8362938">(</span><span class="string" id="8362939">&#34;udp&#34;</span><span class="op" id="8362944">,</span>&nbsp;<span class="ident" id="8362946">raddr</span><span class="op" id="8362951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8362954">if</span>&nbsp;<span class="ident" id="8362957">err</span>&nbsp;<span class="op" id="8362961">!=</span>&nbsp;<span class="ident" id="8362964">nil</span>&nbsp;<span class="op" id="8362968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362972">t</span><span class="op" id="8362973">.</span><span class="ident" id="8362974">Fatalf</span><span class="op" id="8362980">(</span><span class="string" id="8362981">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8362998">,</span>&nbsp;<span class="ident" id="8363000">err</span><span class="op" id="8363003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363009">defer</span>&nbsp;<span class="ident" id="8363015">c</span><span class="op" id="8363016">.</span><span class="ident" id="8363017">Close</span><span class="op" id="8363022">(</span><span class="op" id="8363023">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363027">ra</span><span class="op" id="8363029">,</span>&nbsp;<span class="ident" id="8363031">err</span>&nbsp;<span class="op" id="8363035">:=</span>&nbsp;<span class="ident" id="8363038">ResolveUDPAddr</span><span class="op" id="8363052">(</span><span class="string" id="8363053">&#34;udp&#34;</span><span class="op" id="8363058">,</span>&nbsp;<span class="ident" id="8363060">raddr</span><span class="op" id="8363065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363068">if</span>&nbsp;<span class="ident" id="8363071">err</span>&nbsp;<span class="op" id="8363075">!=</span>&nbsp;<span class="ident" id="8363078">nil</span>&nbsp;<span class="op" id="8363082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363086">t</span><span class="op" id="8363087">.</span><span class="ident" id="8363088">Fatalf</span><span class="op" id="8363094">(</span><span class="string" id="8363095">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8363122">,</span>&nbsp;<span class="ident" id="8363124">err</span><span class="op" id="8363127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363130">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363134">_</span><span class="op" id="8363135">,</span>&nbsp;<span class="ident" id="8363137">err</span>&nbsp;<span class="op" id="8363141">=</span>&nbsp;<span class="ident" id="8363143">c</span><span class="op" id="8363144">.</span><span class="op" id="8363145">(</span><span class="op" id="8363146">*</span><span class="ident" id="8363147">UDPConn</span><span class="op" id="8363154">)</span><span class="op" id="8363155">.</span><span class="ident" id="8363156">WriteToUDP</span><span class="op" id="8363166">(</span><span class="op" id="8363167">[</span><span class="op" id="8363168">]</span><span class="builtintype" id="8363169">byte</span><span class="op" id="8363173">(</span><span class="string" id="8363174">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8363207">)</span><span class="op" id="8363208">,</span>&nbsp;<span class="ident" id="8363210">ra</span><span class="op" id="8363212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363215">if</span>&nbsp;<span class="ident" id="8363218">err</span>&nbsp;<span class="op" id="8363222">==</span>&nbsp;<span class="ident" id="8363225">nil</span>&nbsp;<span class="op" id="8363229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363233">t</span><span class="op" id="8363234">.</span><span class="ident" id="8363235">Fatal</span><span class="op" id="8363240">(</span><span class="string" id="8363241">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8363265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363268">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363271">if</span>&nbsp;<span class="ident" id="8363274">err</span>&nbsp;<span class="op" id="8363278">!=</span>&nbsp;<span class="ident" id="8363281">nil</span>&nbsp;<span class="op" id="8363285">&amp;&amp;</span>&nbsp;<span class="ident" id="8363288">err</span><span class="op" id="8363291">.</span><span class="op" id="8363292">(</span><span class="op" id="8363293">*</span><span class="ident" id="8363294">OpError</span><span class="op" id="8363301">)</span><span class="op" id="8363302">.</span><span class="ident" id="8363303">Err</span>&nbsp;<span class="op" id="8363307">!=</span>&nbsp;<span class="ident" id="8363310">ErrWriteToConnected</span>&nbsp;<span class="op" id="8363330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363334">t</span><span class="op" id="8363335">.</span><span class="ident" id="8363336">Fatalf</span><span class="op" id="8363342">(</span><span class="string" id="8363343">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8363394">,</span>&nbsp;<span class="ident" id="8363396">err</span><span class="op" id="8363399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363406">_</span><span class="op" id="8363407">,</span>&nbsp;<span class="ident" id="8363409">err</span>&nbsp;<span class="op" id="8363413">=</span>&nbsp;<span class="ident" id="8363415">c</span><span class="op" id="8363416">.</span><span class="op" id="8363417">(</span><span class="op" id="8363418">*</span><span class="ident" id="8363419">UDPConn</span><span class="op" id="8363426">)</span><span class="op" id="8363427">.</span><span class="ident" id="8363428">WriteTo</span><span class="op" id="8363435">(</span><span class="op" id="8363436">[</span><span class="op" id="8363437">]</span><span class="builtintype" id="8363438">byte</span><span class="op" id="8363442">(</span><span class="string" id="8363443">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8363476">)</span><span class="op" id="8363477">,</span>&nbsp;<span class="ident" id="8363479">ra</span><span class="op" id="8363481">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363484">if</span>&nbsp;<span class="ident" id="8363487">err</span>&nbsp;<span class="op" id="8363491">==</span>&nbsp;<span class="ident" id="8363494">nil</span>&nbsp;<span class="op" id="8363498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363502">t</span><span class="op" id="8363503">.</span><span class="ident" id="8363504">Fatal</span><span class="op" id="8363509">(</span><span class="string" id="8363510">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8363531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363537">if</span>&nbsp;<span class="ident" id="8363540">err</span>&nbsp;<span class="op" id="8363544">!=</span>&nbsp;<span class="ident" id="8363547">nil</span>&nbsp;<span class="op" id="8363551">&amp;&amp;</span>&nbsp;<span class="ident" id="8363554">err</span><span class="op" id="8363557">.</span><span class="op" id="8363558">(</span><span class="op" id="8363559">*</span><span class="ident" id="8363560">OpError</span><span class="op" id="8363567">)</span><span class="op" id="8363568">.</span><span class="ident" id="8363569">Err</span>&nbsp;<span class="op" id="8363573">!=</span>&nbsp;<span class="ident" id="8363576">ErrWriteToConnected</span>&nbsp;<span class="op" id="8363596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363600">t</span><span class="op" id="8363601">.</span><span class="ident" id="8363602">Fatalf</span><span class="op" id="8363608">(</span><span class="string" id="8363609">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8363657">,</span>&nbsp;<span class="ident" id="8363659">err</span><span class="op" id="8363662">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363669">_</span><span class="op" id="8363670">,</span>&nbsp;<span class="ident" id="8363672">err</span>&nbsp;<span class="op" id="8363676">=</span>&nbsp;<span class="ident" id="8363678">c</span><span class="op" id="8363679">.</span><span class="ident" id="8363680">Write</span><span class="op" id="8363685">(</span><span class="op" id="8363686">[</span><span class="op" id="8363687">]</span><span class="builtintype" id="8363688">byte</span><span class="op" id="8363692">(</span><span class="string" id="8363693">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8363726">)</span><span class="op" id="8363727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363730">if</span>&nbsp;<span class="ident" id="8363733">err</span>&nbsp;<span class="op" id="8363737">!=</span>&nbsp;<span class="ident" id="8363740">nil</span>&nbsp;<span class="op" id="8363744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363748">t</span><span class="op" id="8363749">.</span><span class="ident" id="8363750">Fatalf</span><span class="op" id="8363756">(</span><span class="string" id="8363757">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8363775">,</span>&nbsp;<span class="ident" id="8363777">err</span><span class="op" id="8363780">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363783">}</span><br>
<span class="lineno"></span><span class="op" id="8363785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8363788">func</span>&nbsp;<span class="ident" id="8363793">testWriteToPacketConn</span><span class="op" id="8363814">(</span><span class="ident" id="8363815">t</span>&nbsp;<span class="op" id="8363817">*</span><span class="ident" id="8363818">testing</span><span class="op" id="8363825">.</span><span class="ident" id="8363826">T</span><span class="op" id="8363827">,</span>&nbsp;<span class="ident" id="8363829">raddr</span>&nbsp;<span class="builtintype" id="8363835">string</span><span class="op" id="8363841">)</span>&nbsp;<span class="op" id="8363843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363846">c</span><span class="op" id="8363847">,</span>&nbsp;<span class="ident" id="8363849">err</span>&nbsp;<span class="op" id="8363853">:=</span>&nbsp;<span class="ident" id="8363856">ListenPacket</span><span class="op" id="8363868">(</span><span class="string" id="8363869">&#34;udp&#34;</span><span class="op" id="8363874">,</span>&nbsp;<span class="string" id="8363876">&#34;127.0.0.1:0&#34;</span><span class="op" id="8363889">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363892">if</span>&nbsp;<span class="ident" id="8363895">err</span>&nbsp;<span class="op" id="8363899">!=</span>&nbsp;<span class="ident" id="8363902">nil</span>&nbsp;<span class="op" id="8363906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363910">t</span><span class="op" id="8363911">.</span><span class="ident" id="8363912">Fatalf</span><span class="op" id="8363918">(</span><span class="string" id="8363919">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8363944">,</span>&nbsp;<span class="ident" id="8363946">err</span><span class="op" id="8363949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8363955">defer</span>&nbsp;<span class="ident" id="8363961">c</span><span class="op" id="8363962">.</span><span class="ident" id="8363963">Close</span><span class="op" id="8363968">(</span><span class="op" id="8363969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363973">ra</span><span class="op" id="8363975">,</span>&nbsp;<span class="ident" id="8363977">err</span>&nbsp;<span class="op" id="8363981">:=</span>&nbsp;<span class="ident" id="8363984">ResolveUDPAddr</span><span class="op" id="8363998">(</span><span class="string" id="8363999">&#34;udp&#34;</span><span class="op" id="8364004">,</span>&nbsp;<span class="ident" id="8364006">raddr</span><span class="op" id="8364011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364014">if</span>&nbsp;<span class="ident" id="8364017">err</span>&nbsp;<span class="op" id="8364021">!=</span>&nbsp;<span class="ident" id="8364024">nil</span>&nbsp;<span class="op" id="8364028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364032">t</span><span class="op" id="8364033">.</span><span class="ident" id="8364034">Fatalf</span><span class="op" id="8364040">(</span><span class="string" id="8364041">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8364068">,</span>&nbsp;<span class="ident" id="8364070">err</span><span class="op" id="8364073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364080">_</span><span class="op" id="8364081">,</span>&nbsp;<span class="ident" id="8364083">err</span>&nbsp;<span class="op" id="8364087">=</span>&nbsp;<span class="ident" id="8364089">c</span><span class="op" id="8364090">.</span><span class="op" id="8364091">(</span><span class="op" id="8364092">*</span><span class="ident" id="8364093">UDPConn</span><span class="op" id="8364100">)</span><span class="op" id="8364101">.</span><span class="ident" id="8364102">WriteToUDP</span><span class="op" id="8364112">(</span><span class="op" id="8364113">[</span><span class="op" id="8364114">]</span><span class="builtintype" id="8364115">byte</span><span class="op" id="8364119">(</span><span class="string" id="8364120">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8364149">)</span><span class="op" id="8364150">,</span>&nbsp;<span class="ident" id="8364152">ra</span><span class="op" id="8364154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364157">if</span>&nbsp;<span class="ident" id="8364160">err</span>&nbsp;<span class="op" id="8364164">!=</span>&nbsp;<span class="ident" id="8364167">nil</span>&nbsp;<span class="op" id="8364171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364175">t</span><span class="op" id="8364176">.</span><span class="ident" id="8364177">Fatalf</span><span class="op" id="8364183">(</span><span class="string" id="8364184">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8364207">,</span>&nbsp;<span class="ident" id="8364209">err</span><span class="op" id="8364212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364219">_</span><span class="op" id="8364220">,</span>&nbsp;<span class="ident" id="8364222">err</span>&nbsp;<span class="op" id="8364226">=</span>&nbsp;<span class="ident" id="8364228">c</span><span class="op" id="8364229">.</span><span class="ident" id="8364230">WriteTo</span><span class="op" id="8364237">(</span><span class="op" id="8364238">[</span><span class="op" id="8364239">]</span><span class="builtintype" id="8364240">byte</span><span class="op" id="8364244">(</span><span class="string" id="8364245">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8364274">)</span><span class="op" id="8364275">,</span>&nbsp;<span class="ident" id="8364277">ra</span><span class="op" id="8364279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364282">if</span>&nbsp;<span class="ident" id="8364285">err</span>&nbsp;<span class="op" id="8364289">!=</span>&nbsp;<span class="ident" id="8364292">nil</span>&nbsp;<span class="op" id="8364296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364300">t</span><span class="op" id="8364301">.</span><span class="ident" id="8364302">Fatalf</span><span class="op" id="8364308">(</span><span class="string" id="8364309">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8364329">,</span>&nbsp;<span class="ident" id="8364331">err</span><span class="op" id="8364334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364341">_</span><span class="op" id="8364342">,</span>&nbsp;<span class="ident" id="8364344">err</span>&nbsp;<span class="op" id="8364348">=</span>&nbsp;<span class="ident" id="8364350">c</span><span class="op" id="8364351">.</span><span class="op" id="8364352">(</span><span class="op" id="8364353">*</span><span class="ident" id="8364354">UDPConn</span><span class="op" id="8364361">)</span><span class="op" id="8364362">.</span><span class="ident" id="8364363">Write</span><span class="op" id="8364368">(</span><span class="op" id="8364369">[</span><span class="op" id="8364370">]</span><span class="builtintype" id="8364371">byte</span><span class="op" id="8364375">(</span><span class="string" id="8364376">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8364405">)</span><span class="op" id="8364406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364409">if</span>&nbsp;<span class="ident" id="8364412">err</span>&nbsp;<span class="op" id="8364416">==</span>&nbsp;<span class="ident" id="8364419">nil</span>&nbsp;<span class="op" id="8364423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364427">t</span><span class="op" id="8364428">.</span><span class="ident" id="8364429">Fatal</span><span class="op" id="8364434">(</span><span class="string" id="8364435">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8364454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364457">}</span><br>
<span class="lineno"></span><span class="op" id="8364459">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="8364462">var</span>&nbsp;<span class="ident" id="8364466">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8364488">=</span>&nbsp;<span class="op" id="8364490">[</span><span class="op" id="8364491">]</span><span class="keyword" id="8364492">struct</span>&nbsp;<span class="op" id="8364499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364502">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8364508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364516">laddr</span>&nbsp;<span class="op" id="8364522">*</span><span class="ident" id="8364523">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="8364531">}</span><span class="op" id="8364532">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364535">{</span><span class="string" id="8364536">&#34;udp4&#34;</span><span class="op" id="8364542">,</span>&nbsp;<span class="op" id="8364544">&amp;</span><span class="ident" id="8364545">UDPAddr</span><span class="op" id="8364552">{</span><span class="ident" id="8364553">IP</span><span class="op" id="8364555">:</span>&nbsp;<span class="ident" id="8364557">IPv4</span><span class="op" id="8364561">(</span><span class="num" id="8364562">127</span><span class="op" id="8364565">,</span>&nbsp;<span class="num" id="8364567">0</span><span class="op" id="8364568">,</span>&nbsp;<span class="num" id="8364570">0</span><span class="op" id="8364571">,</span>&nbsp;<span class="num" id="8364573">1</span><span class="op" id="8364574">)</span><span class="op" id="8364575">}</span><span class="op" id="8364576">}</span><span class="op" id="8364577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364580">{</span><span class="string" id="8364581">&#34;udp4&#34;</span><span class="op" id="8364587">,</span>&nbsp;<span class="op" id="8364589">&amp;</span><span class="ident" id="8364590">UDPAddr</span><span class="op" id="8364597">{</span><span class="op" id="8364598">}</span><span class="op" id="8364599">}</span><span class="op" id="8364600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364603">{</span><span class="string" id="8364604">&#34;udp4&#34;</span><span class="op" id="8364610">,</span>&nbsp;<span class="ident" id="8364612">nil</span><span class="op" id="8364615">}</span><span class="op" id="8364616">,</span><br>
<span class="lineno"></span><span class="op" id="8364618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="8364621">func</span>&nbsp;<span class="ident" id="8364626">TestUDPConnLocalName</span><span class="op" id="8364646">(</span><span class="ident" id="8364647">t</span>&nbsp;<span class="op" id="8364649">*</span><span class="ident" id="8364650">testing</span><span class="op" id="8364657">.</span><span class="ident" id="8364658">T</span><span class="op" id="8364659">)</span>&nbsp;<span class="op" id="8364661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364664">if</span>&nbsp;<span class="ident" id="8364667">testing</span><span class="op" id="8364674">.</span><span class="ident" id="8364675">Short</span><span class="op" id="8364680">(</span><span class="op" id="8364681">)</span>&nbsp;<span class="op" id="8364683">||</span>&nbsp;<span class="op" id="8364686">!</span><span class="op" id="8364687">*</span><span class="ident" id="8364688">testExternal</span>&nbsp;<span class="op" id="8364701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364705">t</span><span class="op" id="8364706">.</span><span class="ident" id="8364707">Skip</span><span class="op" id="8364711">(</span><span class="string" id="8364712">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8364753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364760">for</span>&nbsp;<span class="ident" id="8364764">_</span><span class="op" id="8364765">,</span>&nbsp;<span class="ident" id="8364767">tt</span>&nbsp;<span class="op" id="8364770">:=</span>&nbsp;<span class="keyword" id="8364773">range</span>&nbsp;<span class="ident" id="8364779">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8364801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364805">c</span><span class="op" id="8364806">,</span>&nbsp;<span class="ident" id="8364808">err</span>&nbsp;<span class="op" id="8364812">:=</span>&nbsp;<span class="ident" id="8364815">ListenUDP</span><span class="op" id="8364824">(</span><span class="ident" id="8364825">tt</span><span class="op" id="8364827">.</span><span class="ident" id="8364828">net</span><span class="op" id="8364831">,</span>&nbsp;<span class="ident" id="8364833">tt</span><span class="op" id="8364835">.</span><span class="ident" id="8364836">laddr</span><span class="op" id="8364841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364845">if</span>&nbsp;<span class="ident" id="8364848">err</span>&nbsp;<span class="op" id="8364852">!=</span>&nbsp;<span class="ident" id="8364855">nil</span>&nbsp;<span class="op" id="8364859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364864">t</span><span class="op" id="8364865">.</span><span class="ident" id="8364866">Fatalf</span><span class="op" id="8364872">(</span><span class="string" id="8364873">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8364895">,</span>&nbsp;<span class="ident" id="8364897">err</span><span class="op" id="8364900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364904">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364908">defer</span>&nbsp;<span class="ident" id="8364914">c</span><span class="op" id="8364915">.</span><span class="ident" id="8364916">Close</span><span class="op" id="8364921">(</span><span class="op" id="8364922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364926">la</span>&nbsp;<span class="op" id="8364929">:=</span>&nbsp;<span class="ident" id="8364932">c</span><span class="op" id="8364933">.</span><span class="ident" id="8364934">LocalAddr</span><span class="op" id="8364943">(</span><span class="op" id="8364944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8364948">if</span>&nbsp;<span class="ident" id="8364951">a</span><span class="op" id="8364952">,</span>&nbsp;<span class="ident" id="8364954">ok</span>&nbsp;<span class="op" id="8364957">:=</span>&nbsp;<span class="ident" id="8364960">la</span><span class="op" id="8364962">.</span><span class="op" id="8364963">(</span><span class="op" id="8364964">*</span><span class="ident" id="8364965">UDPAddr</span><span class="op" id="8364972">)</span><span class="op" id="8364973">;</span>&nbsp;<span class="op" id="8364975">!</span><span class="ident" id="8364976">ok</span>&nbsp;<span class="op" id="8364979">||</span>&nbsp;<span class="ident" id="8364982">a</span><span class="op" id="8364983">.</span><span class="ident" id="8364984">Port</span>&nbsp;<span class="op" id="8364989">==</span>&nbsp;<span class="num" id="8364992">0</span>&nbsp;<span class="op" id="8364994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364999">t</span><span class="op" id="8365000">.</span><span class="ident" id="8365001">Fatalf</span><span class="op" id="8365007">(</span><span class="string" id="8365008">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8365069">,</span>&nbsp;<span class="ident" id="8365071">la</span><span class="op" id="8365073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365077">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365080">}</span><br>
<span class="lineno"></span><span class="op" id="8365082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8365085">func</span>&nbsp;<span class="ident" id="8365090">TestUDPConnLocalAndRemoteNames</span><span class="op" id="8365120">(</span><span class="ident" id="8365121">t</span>&nbsp;<span class="op" id="8365123">*</span><span class="ident" id="8365124">testing</span><span class="op" id="8365131">.</span><span class="ident" id="8365132">T</span><span class="op" id="8365133">)</span>&nbsp;<span class="op" id="8365135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365138">for</span>&nbsp;<span class="ident" id="8365142">_</span><span class="op" id="8365143">,</span>&nbsp;<span class="ident" id="8365145">laddr</span>&nbsp;<span class="op" id="8365151">:=</span>&nbsp;<span class="keyword" id="8365154">range</span>&nbsp;<span class="op" id="8365160">[</span><span class="op" id="8365161">]</span><span class="builtintype" id="8365162">string</span><span class="op" id="8365168">{</span><span class="string" id="8365169">&#34;&#34;</span><span class="op" id="8365171">,</span>&nbsp;<span class="string" id="8365173">&#34;127.0.0.1:0&#34;</span><span class="op" id="8365186">}</span>&nbsp;<span class="op" id="8365188">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365192">c1</span><span class="op" id="8365194">,</span>&nbsp;<span class="ident" id="8365196">err</span>&nbsp;<span class="op" id="8365200">:=</span>&nbsp;<span class="ident" id="8365203">ListenPacket</span><span class="op" id="8365215">(</span><span class="string" id="8365216">&#34;udp&#34;</span><span class="op" id="8365221">,</span>&nbsp;<span class="string" id="8365223">&#34;127.0.0.1:0&#34;</span><span class="op" id="8365236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365240">if</span>&nbsp;<span class="ident" id="8365243">err</span>&nbsp;<span class="op" id="8365247">!=</span>&nbsp;<span class="ident" id="8365250">nil</span>&nbsp;<span class="op" id="8365254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365259">t</span><span class="op" id="8365260">.</span><span class="ident" id="8365261">Fatalf</span><span class="op" id="8365267">(</span><span class="string" id="8365268">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8365290">,</span>&nbsp;<span class="ident" id="8365292">err</span><span class="op" id="8365295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365303">defer</span>&nbsp;<span class="ident" id="8365309">c1</span><span class="op" id="8365311">.</span><span class="ident" id="8365312">Close</span><span class="op" id="8365317">(</span><span class="op" id="8365318">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365323">var</span>&nbsp;<span class="ident" id="8365327">la</span>&nbsp;<span class="op" id="8365330">*</span><span class="ident" id="8365331">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365341">if</span>&nbsp;<span class="ident" id="8365344">laddr</span>&nbsp;<span class="op" id="8365350">!=</span>&nbsp;<span class="string" id="8365353">&#34;&#34;</span>&nbsp;<span class="op" id="8365356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365361">var</span>&nbsp;<span class="ident" id="8365365">err</span>&nbsp;<span class="builtintype" id="8365369">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365378">if</span>&nbsp;<span class="ident" id="8365381">la</span><span class="op" id="8365383">,</span>&nbsp;<span class="ident" id="8365385">err</span>&nbsp;<span class="op" id="8365389">=</span>&nbsp;<span class="ident" id="8365391">ResolveUDPAddr</span><span class="op" id="8365405">(</span><span class="string" id="8365406">&#34;udp&#34;</span><span class="op" id="8365411">,</span>&nbsp;<span class="ident" id="8365413">laddr</span><span class="op" id="8365418">)</span><span class="op" id="8365419">;</span>&nbsp;<span class="ident" id="8365421">err</span>&nbsp;<span class="op" id="8365425">!=</span>&nbsp;<span class="ident" id="8365428">nil</span>&nbsp;<span class="op" id="8365432">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365438">t</span><span class="op" id="8365439">.</span><span class="ident" id="8365440">Fatalf</span><span class="op" id="8365446">(</span><span class="string" id="8365447">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8365474">,</span>&nbsp;<span class="ident" id="8365476">err</span><span class="op" id="8365479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365492">c2</span><span class="op" id="8365494">,</span>&nbsp;<span class="ident" id="8365496">err</span>&nbsp;<span class="op" id="8365500">:=</span>&nbsp;<span class="ident" id="8365503">DialUDP</span><span class="op" id="8365510">(</span><span class="string" id="8365511">&#34;udp&#34;</span><span class="op" id="8365516">,</span>&nbsp;<span class="ident" id="8365518">la</span><span class="op" id="8365520">,</span>&nbsp;<span class="ident" id="8365522">c1</span><span class="op" id="8365524">.</span><span class="ident" id="8365525">LocalAddr</span><span class="op" id="8365534">(</span><span class="op" id="8365535">)</span><span class="op" id="8365536">.</span><span class="op" id="8365537">(</span><span class="op" id="8365538">*</span><span class="ident" id="8365539">UDPAddr</span><span class="op" id="8365546">)</span><span class="op" id="8365547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365551">if</span>&nbsp;<span class="ident" id="8365554">err</span>&nbsp;<span class="op" id="8365558">!=</span>&nbsp;<span class="ident" id="8365561">nil</span>&nbsp;<span class="op" id="8365565">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365570">t</span><span class="op" id="8365571">.</span><span class="ident" id="8365572">Fatalf</span><span class="op" id="8365578">(</span><span class="string" id="8365579">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8365599">,</span>&nbsp;<span class="ident" id="8365601">err</span><span class="op" id="8365604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365612">defer</span>&nbsp;<span class="ident" id="8365618">c2</span><span class="op" id="8365620">.</span><span class="ident" id="8365621">Close</span><span class="op" id="8365626">(</span><span class="op" id="8365627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365632">var</span>&nbsp;<span class="ident" id="8365636">connAddrs</span>&nbsp;<span class="op" id="8365646">=</span>&nbsp;<span class="op" id="8365648">[</span><span class="num" id="8365649">4</span><span class="op" id="8365650">]</span><span class="keyword" id="8365651">struct</span>&nbsp;<span class="op" id="8365658">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365663">got</span>&nbsp;<span class="ident" id="8365667">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365675">ok</span>&nbsp;&nbsp;<span class="builtintype" id="8365679">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365686">}</span><span class="op" id="8365687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365692">{</span><span class="ident" id="8365693">c1</span><span class="op" id="8365695">.</span><span class="ident" id="8365696">LocalAddr</span><span class="op" id="8365705">(</span><span class="op" id="8365706">)</span><span class="op" id="8365707">,</span>&nbsp;<span class="builtintype" id="8365709">true</span><span class="op" id="8365713">}</span><span class="op" id="8365714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365719">{</span><span class="ident" id="8365720">c1</span><span class="op" id="8365722">.</span><span class="op" id="8365723">(</span><span class="op" id="8365724">*</span><span class="ident" id="8365725">UDPConn</span><span class="op" id="8365732">)</span><span class="op" id="8365733">.</span><span class="ident" id="8365734">RemoteAddr</span><span class="op" id="8365744">(</span><span class="op" id="8365745">)</span><span class="op" id="8365746">,</span>&nbsp;<span class="builtintype" id="8365748">false</span><span class="op" id="8365753">}</span><span class="op" id="8365754">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365759">{</span><span class="ident" id="8365760">c2</span><span class="op" id="8365762">.</span><span class="ident" id="8365763">LocalAddr</span><span class="op" id="8365772">(</span><span class="op" id="8365773">)</span><span class="op" id="8365774">,</span>&nbsp;<span class="builtintype" id="8365776">true</span><span class="op" id="8365780">}</span><span class="op" id="8365781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365786">{</span><span class="ident" id="8365787">c2</span><span class="op" id="8365789">.</span><span class="ident" id="8365790">RemoteAddr</span><span class="op" id="8365800">(</span><span class="op" id="8365801">)</span><span class="op" id="8365802">,</span>&nbsp;<span class="builtintype" id="8365804">true</span><span class="op" id="8365808">}</span><span class="op" id="8365809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365817">for</span>&nbsp;<span class="ident" id="8365821">_</span><span class="op" id="8365822">,</span>&nbsp;<span class="ident" id="8365824">ca</span>&nbsp;<span class="op" id="8365827">:=</span>&nbsp;<span class="keyword" id="8365830">range</span>&nbsp;<span class="ident" id="8365836">connAddrs</span>&nbsp;<span class="op" id="8365846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8365851">if</span>&nbsp;<span class="ident" id="8365854">a</span><span class="op" id="8365855">,</span>&nbsp;<span class="ident" id="8365857">ok</span>&nbsp;<span class="op" id="8365860">:=</span>&nbsp;<span class="ident" id="8365863">ca</span><span class="op" id="8365865">.</span><span class="ident" id="8365866">got</span><span class="op" id="8365869">.</span><span class="op" id="8365870">(</span><span class="op" id="8365871">*</span><span class="ident" id="8365872">UDPAddr</span><span class="op" id="8365879">)</span><span class="op" id="8365880">;</span>&nbsp;<span class="ident" id="8365882">ok</span>&nbsp;<span class="op" id="8365885">!=</span>&nbsp;<span class="ident" id="8365888">ca</span><span class="op" id="8365890">.</span><span class="ident" id="8365891">ok</span>&nbsp;<span class="op" id="8365894">||</span>&nbsp;<span class="ident" id="8365897">ok</span>&nbsp;<span class="op" id="8365900">&amp;&amp;</span>&nbsp;<span class="ident" id="8365903">a</span><span class="op" id="8365904">.</span><span class="ident" id="8365905">Port</span>&nbsp;<span class="op" id="8365910">==</span>&nbsp;<span class="num" id="8365913">0</span>&nbsp;<span class="op" id="8365915">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365921">t</span><span class="op" id="8365922">.</span><span class="ident" id="8365923">Fatalf</span><span class="op" id="8365929">(</span><span class="string" id="8365930">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8365991">,</span>&nbsp;<span class="ident" id="8365993">ca</span><span class="op" id="8365995">.</span><span class="ident" id="8365996">got</span><span class="op" id="8365999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366011">}</span><br>
<span class="lineno"></span><span class="op" id="8366013">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="8366016">func</span>&nbsp;<span class="ident" id="8366021">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="8366048">(</span><span class="ident" id="8366049">t</span>&nbsp;<span class="op" id="8366051">*</span><span class="ident" id="8366052">testing</span><span class="op" id="8366059">.</span><span class="ident" id="8366060">T</span><span class="op" id="8366061">)</span>&nbsp;<span class="op" id="8366063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366066">if</span>&nbsp;<span class="ident" id="8366069">testing</span><span class="op" id="8366076">.</span><span class="ident" id="8366077">Short</span><span class="op" id="8366082">(</span><span class="op" id="8366083">)</span>&nbsp;<span class="op" id="8366085">||</span>&nbsp;<span class="op" id="8366088">!</span><span class="op" id="8366089">*</span><span class="ident" id="8366090">testExternal</span>&nbsp;<span class="op" id="8366103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366107">t</span><span class="op" id="8366108">.</span><span class="ident" id="8366109">Skip</span><span class="op" id="8366113">(</span><span class="string" id="8366114">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8366155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366158">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366161">if</span>&nbsp;<span class="op" id="8366164">!</span><span class="ident" id="8366165">supportsIPv6</span>&nbsp;<span class="op" id="8366178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366182">t</span><span class="op" id="8366183">.</span><span class="ident" id="8366184">Skip</span><span class="op" id="8366188">(</span><span class="string" id="8366189">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8366212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366218">ifi</span>&nbsp;<span class="op" id="8366222">:=</span>&nbsp;<span class="ident" id="8366225">loopbackInterface</span><span class="op" id="8366242">(</span><span class="op" id="8366243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366246">if</span>&nbsp;<span class="ident" id="8366249">ifi</span>&nbsp;<span class="op" id="8366253">==</span>&nbsp;<span class="ident" id="8366256">nil</span>&nbsp;<span class="op" id="8366260">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366264">t</span><span class="op" id="8366265">.</span><span class="ident" id="8366266">Skip</span><span class="op" id="8366270">(</span><span class="string" id="8366271">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="8366301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366307">laddr</span>&nbsp;<span class="op" id="8366313">:=</span>&nbsp;<span class="ident" id="8366316">ipv6LinkLocalUnicastAddr</span><span class="op" id="8366340">(</span><span class="ident" id="8366341">ifi</span><span class="op" id="8366344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366347">if</span>&nbsp;<span class="ident" id="8366350">laddr</span>&nbsp;<span class="op" id="8366356">==</span>&nbsp;<span class="string" id="8366359">&#34;&#34;</span>&nbsp;<span class="op" id="8366362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366366">t</span><span class="op" id="8366367">.</span><span class="ident" id="8366368">Skip</span><span class="op" id="8366372">(</span><span class="string" id="8366373">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="8366417">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366424">type</span>&nbsp;<span class="ident" id="8366429">test</span>&nbsp;<span class="keyword" id="8366434">struct</span>&nbsp;<span class="op" id="8366441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366445">net</span><span class="op" id="8366448">,</span>&nbsp;<span class="ident" id="8366450">addr</span>&nbsp;&nbsp;<span class="builtintype" id="8366456">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366465">nameLookup</span>&nbsp;<span class="builtintype" id="8366476">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366485">var</span>&nbsp;<span class="ident" id="8366489">tests</span>&nbsp;<span class="op" id="8366495">=</span>&nbsp;<span class="op" id="8366497">[</span><span class="op" id="8366498">]</span><span class="ident" id="8366499">test</span><span class="op" id="8366503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366507">{</span><span class="string" id="8366508">&#34;udp&#34;</span><span class="op" id="8366513">,</span>&nbsp;<span class="string" id="8366515">&#34;[&#34;</span>&nbsp;<span class="op" id="8366519">+</span>&nbsp;<span class="ident" id="8366521">laddr</span>&nbsp;<span class="op" id="8366527">+</span>&nbsp;<span class="string" id="8366529">&#34;%&#34;</span>&nbsp;<span class="op" id="8366533">+</span>&nbsp;<span class="ident" id="8366535">ifi</span><span class="op" id="8366538">.</span><span class="ident" id="8366539">Name</span>&nbsp;<span class="op" id="8366544">+</span>&nbsp;<span class="string" id="8366546">&#34;]:0&#34;</span><span class="op" id="8366551">,</span>&nbsp;<span class="builtintype" id="8366553">false</span><span class="op" id="8366558">}</span><span class="op" id="8366559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366563">{</span><span class="string" id="8366564">&#34;udp6&#34;</span><span class="op" id="8366570">,</span>&nbsp;<span class="string" id="8366572">&#34;[&#34;</span>&nbsp;<span class="op" id="8366576">+</span>&nbsp;<span class="ident" id="8366578">laddr</span>&nbsp;<span class="op" id="8366584">+</span>&nbsp;<span class="string" id="8366586">&#34;%&#34;</span>&nbsp;<span class="op" id="8366590">+</span>&nbsp;<span class="ident" id="8366592">ifi</span><span class="op" id="8366595">.</span><span class="ident" id="8366596">Name</span>&nbsp;<span class="op" id="8366601">+</span>&nbsp;<span class="string" id="8366603">&#34;]:0&#34;</span><span class="op" id="8366608">,</span>&nbsp;<span class="builtintype" id="8366610">false</span><span class="op" id="8366615">}</span><span class="op" id="8366616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366619">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8366622">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366682">if</span>&nbsp;<span class="ident" id="8366685">runtime</span><span class="op" id="8366692">.</span><span class="ident" id="8366693">GOOS</span>&nbsp;<span class="op" id="8366698">==</span>&nbsp;<span class="string" id="8366701">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="8366713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366717">tests</span>&nbsp;<span class="op" id="8366723">=</span>&nbsp;<span class="ident" id="8366725">tests</span><span class="op" id="8366730">[</span><span class="num" id="8366731">1</span><span class="op" id="8366732">:</span><span class="op" id="8366733">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366739">switch</span>&nbsp;<span class="ident" id="8366746">runtime</span><span class="op" id="8366753">.</span><span class="ident" id="8366754">GOOS</span>&nbsp;<span class="op" id="8366759">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366762">case</span>&nbsp;<span class="string" id="8366767">&#34;darwin&#34;</span><span class="op" id="8366775">,</span>&nbsp;<span class="string" id="8366777">&#34;dragonfly&#34;</span><span class="op" id="8366788">,</span>&nbsp;<span class="string" id="8366790">&#34;freebsd&#34;</span><span class="op" id="8366799">,</span>&nbsp;<span class="string" id="8366801">&#34;openbsd&#34;</span><span class="op" id="8366810">,</span>&nbsp;<span class="string" id="8366812">&#34;netbsd&#34;</span><span class="op" id="8366820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366824">tests</span>&nbsp;<span class="op" id="8366830">=</span>&nbsp;<span class="builtinfunc" id="8366832">append</span><span class="op" id="8366838">(</span><span class="ident" id="8366839">tests</span><span class="op" id="8366844">,</span>&nbsp;<span class="op" id="8366846">[</span><span class="op" id="8366847">]</span><span class="ident" id="8366848">test</span><span class="op" id="8366852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366857">{</span><span class="string" id="8366858">&#34;udp&#34;</span><span class="op" id="8366863">,</span>&nbsp;<span class="string" id="8366865">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8366879">+</span>&nbsp;<span class="ident" id="8366881">ifi</span><span class="op" id="8366884">.</span><span class="ident" id="8366885">Name</span>&nbsp;<span class="op" id="8366890">+</span>&nbsp;<span class="string" id="8366892">&#34;]:0&#34;</span><span class="op" id="8366897">,</span>&nbsp;<span class="builtintype" id="8366899">true</span><span class="op" id="8366903">}</span><span class="op" id="8366904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366909">{</span><span class="string" id="8366910">&#34;udp6&#34;</span><span class="op" id="8366916">,</span>&nbsp;<span class="string" id="8366918">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8366932">+</span>&nbsp;<span class="ident" id="8366934">ifi</span><span class="op" id="8366937">.</span><span class="ident" id="8366938">Name</span>&nbsp;<span class="op" id="8366943">+</span>&nbsp;<span class="string" id="8366945">&#34;]:0&#34;</span><span class="op" id="8366950">,</span>&nbsp;<span class="builtintype" id="8366952">true</span><span class="op" id="8366956">}</span><span class="op" id="8366957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366961">}</span><span class="op" id="8366962">...</span><span class="op" id="8366965">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8366968">case</span>&nbsp;<span class="string" id="8366973">&#34;linux&#34;</span><span class="op" id="8366980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366984">tests</span>&nbsp;<span class="op" id="8366990">=</span>&nbsp;<span class="builtinfunc" id="8366992">append</span><span class="op" id="8366998">(</span><span class="ident" id="8366999">tests</span><span class="op" id="8367004">,</span>&nbsp;<span class="op" id="8367006">[</span><span class="op" id="8367007">]</span><span class="ident" id="8367008">test</span><span class="op" id="8367012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367017">{</span><span class="string" id="8367018">&#34;udp&#34;</span><span class="op" id="8367023">,</span>&nbsp;<span class="string" id="8367025">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8367043">+</span>&nbsp;<span class="ident" id="8367045">ifi</span><span class="op" id="8367048">.</span><span class="ident" id="8367049">Name</span>&nbsp;<span class="op" id="8367054">+</span>&nbsp;<span class="string" id="8367056">&#34;]:0&#34;</span><span class="op" id="8367061">,</span>&nbsp;<span class="builtintype" id="8367063">true</span><span class="op" id="8367067">}</span><span class="op" id="8367068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367073">{</span><span class="string" id="8367074">&#34;udp6&#34;</span><span class="op" id="8367080">,</span>&nbsp;<span class="string" id="8367082">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8367100">+</span>&nbsp;<span class="ident" id="8367102">ifi</span><span class="op" id="8367105">.</span><span class="ident" id="8367106">Name</span>&nbsp;<span class="op" id="8367111">+</span>&nbsp;<span class="string" id="8367113">&#34;]:0&#34;</span><span class="op" id="8367118">,</span>&nbsp;<span class="builtintype" id="8367120">true</span><span class="op" id="8367124">}</span><span class="op" id="8367125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367129">}</span><span class="op" id="8367130">...</span><span class="op" id="8367133">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367139">for</span>&nbsp;<span class="ident" id="8367143">_</span><span class="op" id="8367144">,</span>&nbsp;<span class="ident" id="8367146">tt</span>&nbsp;<span class="op" id="8367149">:=</span>&nbsp;<span class="keyword" id="8367152">range</span>&nbsp;<span class="ident" id="8367158">tests</span>&nbsp;<span class="op" id="8367164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367168">c1</span><span class="op" id="8367170">,</span>&nbsp;<span class="ident" id="8367172">err</span>&nbsp;<span class="op" id="8367176">:=</span>&nbsp;<span class="ident" id="8367179">ListenPacket</span><span class="op" id="8367191">(</span><span class="ident" id="8367192">tt</span><span class="op" id="8367194">.</span><span class="ident" id="8367195">net</span><span class="op" id="8367198">,</span>&nbsp;<span class="ident" id="8367200">tt</span><span class="op" id="8367202">.</span><span class="ident" id="8367203">addr</span><span class="op" id="8367207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367211">if</span>&nbsp;<span class="ident" id="8367214">err</span>&nbsp;<span class="op" id="8367218">!=</span>&nbsp;<span class="ident" id="8367221">nil</span>&nbsp;<span class="op" id="8367225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8367230">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8367276">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367325">t</span><span class="op" id="8367326">.</span><span class="ident" id="8367327">Logf</span><span class="op" id="8367331">(</span><span class="string" id="8367332">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8367357">,</span>&nbsp;<span class="ident" id="8367359">err</span><span class="op" id="8367362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367367">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367382">defer</span>&nbsp;<span class="ident" id="8367388">c1</span><span class="op" id="8367390">.</span><span class="ident" id="8367391">Close</span><span class="op" id="8367396">(</span><span class="op" id="8367397">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367401">if</span>&nbsp;<span class="ident" id="8367404">la</span><span class="op" id="8367406">,</span>&nbsp;<span class="ident" id="8367408">ok</span>&nbsp;<span class="op" id="8367411">:=</span>&nbsp;<span class="ident" id="8367414">c1</span><span class="op" id="8367416">.</span><span class="ident" id="8367417">LocalAddr</span><span class="op" id="8367426">(</span><span class="op" id="8367427">)</span><span class="op" id="8367428">.</span><span class="op" id="8367429">(</span><span class="op" id="8367430">*</span><span class="ident" id="8367431">UDPAddr</span><span class="op" id="8367438">)</span><span class="op" id="8367439">;</span>&nbsp;<span class="op" id="8367441">!</span><span class="ident" id="8367442">ok</span>&nbsp;<span class="op" id="8367445">||</span>&nbsp;<span class="op" id="8367448">!</span><span class="ident" id="8367449">tt</span><span class="op" id="8367451">.</span><span class="ident" id="8367452">nameLookup</span>&nbsp;<span class="op" id="8367463">&amp;&amp;</span>&nbsp;<span class="ident" id="8367466">la</span><span class="op" id="8367468">.</span><span class="ident" id="8367469">Zone</span>&nbsp;<span class="op" id="8367474">==</span>&nbsp;<span class="string" id="8367477">&#34;&#34;</span>&nbsp;<span class="op" id="8367480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367485">t</span><span class="op" id="8367486">.</span><span class="ident" id="8367487">Fatalf</span><span class="op" id="8367493">(</span><span class="string" id="8367494">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8367550">,</span>&nbsp;<span class="ident" id="8367552">la</span><span class="op" id="8367554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367563">c2</span><span class="op" id="8367565">,</span>&nbsp;<span class="ident" id="8367567">err</span>&nbsp;<span class="op" id="8367571">:=</span>&nbsp;<span class="ident" id="8367574">Dial</span><span class="op" id="8367578">(</span><span class="ident" id="8367579">tt</span><span class="op" id="8367581">.</span><span class="ident" id="8367582">net</span><span class="op" id="8367585">,</span>&nbsp;<span class="ident" id="8367587">c1</span><span class="op" id="8367589">.</span><span class="ident" id="8367590">LocalAddr</span><span class="op" id="8367599">(</span><span class="op" id="8367600">)</span><span class="op" id="8367601">.</span><span class="ident" id="8367602">String</span><span class="op" id="8367608">(</span><span class="op" id="8367609">)</span><span class="op" id="8367610">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367614">if</span>&nbsp;<span class="ident" id="8367617">err</span>&nbsp;<span class="op" id="8367621">!=</span>&nbsp;<span class="ident" id="8367624">nil</span>&nbsp;<span class="op" id="8367628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367633">t</span><span class="op" id="8367634">.</span><span class="ident" id="8367635">Fatalf</span><span class="op" id="8367641">(</span><span class="string" id="8367642">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8367659">,</span>&nbsp;<span class="ident" id="8367661">err</span><span class="op" id="8367664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367672">defer</span>&nbsp;<span class="ident" id="8367678">c2</span><span class="op" id="8367680">.</span><span class="ident" id="8367681">Close</span><span class="op" id="8367686">(</span><span class="op" id="8367687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367691">if</span>&nbsp;<span class="ident" id="8367694">la</span><span class="op" id="8367696">,</span>&nbsp;<span class="ident" id="8367698">ok</span>&nbsp;<span class="op" id="8367701">:=</span>&nbsp;<span class="ident" id="8367704">c2</span><span class="op" id="8367706">.</span><span class="ident" id="8367707">LocalAddr</span><span class="op" id="8367716">(</span><span class="op" id="8367717">)</span><span class="op" id="8367718">.</span><span class="op" id="8367719">(</span><span class="op" id="8367720">*</span><span class="ident" id="8367721">UDPAddr</span><span class="op" id="8367728">)</span><span class="op" id="8367729">;</span>&nbsp;<span class="op" id="8367731">!</span><span class="ident" id="8367732">ok</span>&nbsp;<span class="op" id="8367735">||</span>&nbsp;<span class="op" id="8367738">!</span><span class="ident" id="8367739">tt</span><span class="op" id="8367741">.</span><span class="ident" id="8367742">nameLookup</span>&nbsp;<span class="op" id="8367753">&amp;&amp;</span>&nbsp;<span class="ident" id="8367756">la</span><span class="op" id="8367758">.</span><span class="ident" id="8367759">Zone</span>&nbsp;<span class="op" id="8367764">==</span>&nbsp;<span class="string" id="8367767">&#34;&#34;</span>&nbsp;<span class="op" id="8367770">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367775">t</span><span class="op" id="8367776">.</span><span class="ident" id="8367777">Fatalf</span><span class="op" id="8367783">(</span><span class="string" id="8367784">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8367840">,</span>&nbsp;<span class="ident" id="8367842">la</span><span class="op" id="8367844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367852">if</span>&nbsp;<span class="ident" id="8367855">ra</span><span class="op" id="8367857">,</span>&nbsp;<span class="ident" id="8367859">ok</span>&nbsp;<span class="op" id="8367862">:=</span>&nbsp;<span class="ident" id="8367865">c2</span><span class="op" id="8367867">.</span><span class="ident" id="8367868">RemoteAddr</span><span class="op" id="8367878">(</span><span class="op" id="8367879">)</span><span class="op" id="8367880">.</span><span class="op" id="8367881">(</span><span class="op" id="8367882">*</span><span class="ident" id="8367883">UDPAddr</span><span class="op" id="8367890">)</span><span class="op" id="8367891">;</span>&nbsp;<span class="op" id="8367893">!</span><span class="ident" id="8367894">ok</span>&nbsp;<span class="op" id="8367897">||</span>&nbsp;<span class="op" id="8367900">!</span><span class="ident" id="8367901">tt</span><span class="op" id="8367903">.</span><span class="ident" id="8367904">nameLookup</span>&nbsp;<span class="op" id="8367915">&amp;&amp;</span>&nbsp;<span class="ident" id="8367918">ra</span><span class="op" id="8367920">.</span><span class="ident" id="8367921">Zone</span>&nbsp;<span class="op" id="8367926">==</span>&nbsp;<span class="string" id="8367929">&#34;&#34;</span>&nbsp;<span class="op" id="8367932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367937">t</span><span class="op" id="8367938">.</span><span class="ident" id="8367939">Fatalf</span><span class="op" id="8367945">(</span><span class="string" id="8367946">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8368002">,</span>&nbsp;<span class="ident" id="8368004">ra</span><span class="op" id="8368006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368010">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8368015">if</span>&nbsp;<span class="ident" id="8368018">_</span><span class="op" id="8368019">,</span>&nbsp;<span class="ident" id="8368021">err</span>&nbsp;<span class="op" id="8368025">:=</span>&nbsp;<span class="ident" id="8368028">c2</span><span class="op" id="8368030">.</span><span class="ident" id="8368031">Write</span><span class="op" id="8368036">(</span><span class="op" id="8368037">[</span><span class="op" id="8368038">]</span><span class="builtintype" id="8368039">byte</span><span class="op" id="8368043">(</span><span class="string" id="8368044">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="8368074">)</span><span class="op" id="8368075">)</span><span class="op" id="8368076">;</span>&nbsp;<span class="ident" id="8368078">err</span>&nbsp;<span class="op" id="8368082">!=</span>&nbsp;<span class="ident" id="8368085">nil</span>&nbsp;<span class="op" id="8368089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368094">t</span><span class="op" id="8368095">.</span><span class="ident" id="8368096">Fatalf</span><span class="op" id="8368102">(</span><span class="string" id="8368103">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8368126">,</span>&nbsp;<span class="ident" id="8368128">err</span><span class="op" id="8368131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368139">b</span>&nbsp;<span class="op" id="8368141">:=</span>&nbsp;<span class="builtinfunc" id="8368144">make</span><span class="op" id="8368148">(</span><span class="op" id="8368149">[</span><span class="op" id="8368150">]</span><span class="builtintype" id="8368151">byte</span><span class="op" id="8368155">,</span>&nbsp;<span class="num" id="8368157">32</span><span class="op" id="8368159">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8368163">if</span>&nbsp;<span class="ident" id="8368166">_</span><span class="op" id="8368167">,</span>&nbsp;<span class="ident" id="8368169">from</span><span class="op" id="8368173">,</span>&nbsp;<span class="ident" id="8368175">err</span>&nbsp;<span class="op" id="8368179">:=</span>&nbsp;<span class="ident" id="8368182">c1</span><span class="op" id="8368184">.</span><span class="ident" id="8368185">ReadFrom</span><span class="op" id="8368193">(</span><span class="ident" id="8368194">b</span><span class="op" id="8368195">)</span><span class="op" id="8368196">;</span>&nbsp;<span class="ident" id="8368198">err</span>&nbsp;<span class="op" id="8368202">!=</span>&nbsp;<span class="ident" id="8368205">nil</span>&nbsp;<span class="op" id="8368209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368214">t</span><span class="op" id="8368215">.</span><span class="ident" id="8368216">Fatalf</span><span class="op" id="8368222">(</span><span class="string" id="8368223">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8368255">,</span>&nbsp;<span class="ident" id="8368257">err</span><span class="op" id="8368260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368264">}</span>&nbsp;<span class="keyword" id="8368266">else</span>&nbsp;<span class="op" id="8368271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8368276">if</span>&nbsp;<span class="ident" id="8368279">ra</span><span class="op" id="8368281">,</span>&nbsp;<span class="ident" id="8368283">ok</span>&nbsp;<span class="op" id="8368286">:=</span>&nbsp;<span class="ident" id="8368289">from</span><span class="op" id="8368293">.</span><span class="op" id="8368294">(</span><span class="op" id="8368295">*</span><span class="ident" id="8368296">UDPAddr</span><span class="op" id="8368303">)</span><span class="op" id="8368304">;</span>&nbsp;<span class="op" id="8368306">!</span><span class="ident" id="8368307">ok</span>&nbsp;<span class="op" id="8368310">||</span>&nbsp;<span class="op" id="8368313">!</span><span class="ident" id="8368314">tt</span><span class="op" id="8368316">.</span><span class="ident" id="8368317">nameLookup</span>&nbsp;<span class="op" id="8368328">&amp;&amp;</span>&nbsp;<span class="ident" id="8368331">ra</span><span class="op" id="8368333">.</span><span class="ident" id="8368334">Zone</span>&nbsp;<span class="op" id="8368339">==</span>&nbsp;<span class="string" id="8368342">&#34;&#34;</span>&nbsp;<span class="op" id="8368345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368351">t</span><span class="op" id="8368352">.</span><span class="ident" id="8368353">Fatalf</span><span class="op" id="8368359">(</span><span class="string" id="8368360">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8368416">,</span>&nbsp;<span class="ident" id="8368418">ra</span><span class="op" id="8368420">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368432">}</span><br>
<span class="lineno"></span><span class="op" id="8368434">}</span>
</div>
</body>
</html>
