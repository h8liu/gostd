<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1560982">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1561037">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1561091">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1561142">package</span>&nbsp;<span class="ident" id="1561150">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1561159">import</span>&nbsp;<span class="op" id="1561166">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1561169">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1561178">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1561181">const</span>&nbsp;<span class="op" id="1561187">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561190">hashSize</span>&nbsp;<span class="op" id="1561199">=</span>&nbsp;<span class="num" id="1561201">1009</span><br>
<span class="lineno"></span><span class="op" id="1561206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1561209">var</span>&nbsp;<span class="op" id="1561213">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561216">ifaceLock</span>&nbsp;<span class="ident" id="1561226">mutex</span>&nbsp;<span class="comment" id="1561232">//&nbsp;lock&nbsp;for&nbsp;accessing&nbsp;hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561260">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1561270">[</span><span class="ident" id="1561271">hashSize</span><span class="op" id="1561279">]</span><span class="op" id="1561280">*</span><span class="ident" id="1561281">itab</span><br>
<span class="lineno"></span><span class="op" id="1561286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="1561289">//&nbsp;fInterface&nbsp;is&nbsp;our&nbsp;standard&nbsp;non-empty&nbsp;interface.&nbsp;&nbsp;We&nbsp;use&nbsp;it&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="1561359">//&nbsp;of&nbsp;interface{f()}&nbsp;in&nbsp;function&nbsp;prototypes&nbsp;because&nbsp;gofmt&nbsp;insists&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1561428">//&nbsp;putting&nbsp;lots&nbsp;of&nbsp;newlines&nbsp;in&nbsp;the&nbsp;otherwise&nbsp;concise&nbsp;interface{f()}.</span><br>
<span class="lineno"></span><span class="keyword" id="1561497">type</span>&nbsp;<span class="ident" id="1561502">fInterface</span>&nbsp;<span class="keyword" id="1561513">interface</span>&nbsp;<span class="op" id="1561523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561526">f</span><span class="op" id="1561527">(</span><span class="op" id="1561528">)</span><br>
<span class="lineno">25</span><span class="op" id="1561530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1561533">func</span>&nbsp;<span class="ident" id="1561538">getitab</span><span class="op" id="1561545">(</span><span class="ident" id="1561546">inter</span>&nbsp;<span class="op" id="1561552">*</span><span class="ident" id="1561553">interfacetype</span><span class="op" id="1561566">,</span>&nbsp;<span class="ident" id="1561568">typ</span>&nbsp;<span class="op" id="1561572">*</span><span class="ident" id="1561573">_type</span><span class="op" id="1561578">,</span>&nbsp;<span class="ident" id="1561580">canfail</span>&nbsp;<span class="builtintype" id="1561588">bool</span><span class="op" id="1561592">)</span>&nbsp;<span class="op" id="1561594">*</span><span class="ident" id="1561595">itab</span>&nbsp;<span class="op" id="1561600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1561603">if</span>&nbsp;<span class="builtinfunc" id="1561606">len</span><span class="op" id="1561609">(</span><span class="ident" id="1561610">inter</span><span class="op" id="1561615">.</span><span class="ident" id="1561616">mhdr</span><span class="op" id="1561620">)</span>&nbsp;<span class="op" id="1561622">==</span>&nbsp;<span class="num" id="1561625">0</span>&nbsp;<span class="op" id="1561627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561631">gothrow</span><span class="op" id="1561638">(</span><span class="string" id="1561639">&#34;internal&nbsp;error&nbsp;-&nbsp;misuse&nbsp;of&nbsp;itab&#34;</span><span class="op" id="1561672">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1561675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1561679">//&nbsp;easy&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561693">x</span>&nbsp;<span class="op" id="1561695">:=</span>&nbsp;<span class="ident" id="1561698">typ</span><span class="op" id="1561701">.</span><span class="ident" id="1561702">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1561705">if</span>&nbsp;<span class="ident" id="1561708">x</span>&nbsp;<span class="op" id="1561710">==</span>&nbsp;<span class="ident" id="1561713">nil</span>&nbsp;<span class="op" id="1561717">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1561721">if</span>&nbsp;<span class="ident" id="1561724">canfail</span>&nbsp;<span class="op" id="1561732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1561737">return</span>&nbsp;<span class="ident" id="1561744">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1561750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561754">i</span>&nbsp;<span class="op" id="1561756">:=</span>&nbsp;<span class="op" id="1561759">(</span><span class="op" id="1561760">*</span><span class="ident" id="1561761">imethod</span><span class="op" id="1561768">)</span><span class="op" id="1561769">(</span><span class="ident" id="1561770">add</span><span class="op" id="1561773">(</span><span class="ident" id="1561774">unsafe</span><span class="op" id="1561780">.</span><span class="ident" id="1561781">Pointer</span><span class="op" id="1561788">(</span><span class="ident" id="1561789">inter</span><span class="op" id="1561794">)</span><span class="op" id="1561795">,</span>&nbsp;<span class="ident" id="1561797">unsafe</span><span class="op" id="1561803">.</span><span class="ident" id="1561804">Sizeof</span><span class="op" id="1561810">(</span><span class="ident" id="1561811">interfacetype</span><span class="op" id="1561824">{</span><span class="op" id="1561825">}</span><span class="op" id="1561826">)</span><span class="op" id="1561827">)</span><span class="op" id="1561828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1561832">panic</span><span class="op" id="1561837">(</span><span class="op" id="1561838">&amp;</span><span class="ident" id="1561839">TypeAssertionError</span><span class="op" id="1561857">{</span><span class="string" id="1561858">&#34;&#34;</span><span class="op" id="1561860">,</span>&nbsp;<span class="op" id="1561862">*</span><span class="ident" id="1561863">typ</span><span class="op" id="1561866">.</span><span class="ident" id="1561867">_string</span><span class="op" id="1561874">,</span>&nbsp;<span class="op" id="1561876">*</span><span class="ident" id="1561877">inter</span><span class="op" id="1561882">.</span><span class="ident" id="1561883">typ</span><span class="op" id="1561886">.</span><span class="ident" id="1561887">_string</span><span class="op" id="1561894">,</span>&nbsp;<span class="op" id="1561896">*</span><span class="ident" id="1561897">i</span><span class="op" id="1561898">.</span><span class="ident" id="1561899">name</span><span class="op" id="1561903">}</span><span class="op" id="1561904">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1561907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1561911">//&nbsp;compiler&nbsp;has&nbsp;provided&nbsp;some&nbsp;good&nbsp;hash&nbsp;codes&nbsp;for&nbsp;us.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561966">h</span>&nbsp;<span class="op" id="1561968">:=</span>&nbsp;<span class="ident" id="1561971">inter</span><span class="op" id="1561976">.</span><span class="ident" id="1561977">typ</span><span class="op" id="1561980">.</span><span class="ident" id="1561981">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1561987">h</span>&nbsp;<span class="op" id="1561989">+=</span>&nbsp;<span class="num" id="1561992">17</span>&nbsp;<span class="op" id="1561995">*</span>&nbsp;<span class="ident" id="1561997">typ</span><span class="op" id="1562000">.</span><span class="ident" id="1562001">hash</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562007">//&nbsp;TODO(rsc):&nbsp;h&nbsp;+=&nbsp;23&nbsp;*&nbsp;x.mhash&nbsp;?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562042">h</span>&nbsp;<span class="op" id="1562044">%=</span>&nbsp;<span class="ident" id="1562047">hashSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562058">//&nbsp;look&nbsp;twice&nbsp;-&nbsp;once&nbsp;without&nbsp;lock,&nbsp;once&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562105">//&nbsp;common&nbsp;case&nbsp;will&nbsp;be&nbsp;no&nbsp;lock&nbsp;contention.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562149">var</span>&nbsp;<span class="ident" id="1562153">m</span>&nbsp;<span class="op" id="1562155">*</span><span class="ident" id="1562156">itab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562162">var</span>&nbsp;<span class="ident" id="1562166">locked</span>&nbsp;<span class="builtintype" id="1562173">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562178">for</span>&nbsp;<span class="ident" id="1562182">locked</span>&nbsp;<span class="op" id="1562189">=</span>&nbsp;<span class="num" id="1562191">0</span><span class="op" id="1562192">;</span>&nbsp;<span class="ident" id="1562194">locked</span>&nbsp;<span class="op" id="1562201">&lt;</span>&nbsp;<span class="num" id="1562203">2</span><span class="op" id="1562204">;</span>&nbsp;<span class="ident" id="1562206">locked</span><span class="op" id="1562212">++</span>&nbsp;<span class="op" id="1562215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562219">if</span>&nbsp;<span class="ident" id="1562222">locked</span>&nbsp;<span class="op" id="1562229">!=</span>&nbsp;<span class="num" id="1562232">0</span>&nbsp;<span class="op" id="1562234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562239">lock</span><span class="op" id="1562243">(</span><span class="op" id="1562244">&amp;</span><span class="ident" id="1562245">ifaceLock</span><span class="op" id="1562254">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562262">for</span>&nbsp;<span class="ident" id="1562266">m</span>&nbsp;<span class="op" id="1562268">=</span>&nbsp;<span class="op" id="1562270">(</span><span class="op" id="1562271">*</span><span class="ident" id="1562272">itab</span><span class="op" id="1562276">)</span><span class="op" id="1562277">(</span><span class="ident" id="1562278">atomicloadp</span><span class="op" id="1562289">(</span><span class="ident" id="1562290">unsafe</span><span class="op" id="1562296">.</span><span class="ident" id="1562297">Pointer</span><span class="op" id="1562304">(</span><span class="op" id="1562305">&amp;</span><span class="ident" id="1562306">hash</span><span class="op" id="1562310">[</span><span class="ident" id="1562311">h</span><span class="op" id="1562312">]</span><span class="op" id="1562313">)</span><span class="op" id="1562314">)</span><span class="op" id="1562315">)</span><span class="op" id="1562316">;</span>&nbsp;<span class="ident" id="1562318">m</span>&nbsp;<span class="op" id="1562320">!=</span>&nbsp;<span class="ident" id="1562323">nil</span><span class="op" id="1562326">;</span>&nbsp;<span class="ident" id="1562328">m</span>&nbsp;<span class="op" id="1562330">=</span>&nbsp;<span class="ident" id="1562332">m</span><span class="op" id="1562333">.</span><span class="ident" id="1562334">link</span>&nbsp;<span class="op" id="1562339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562344">if</span>&nbsp;<span class="ident" id="1562347">m</span><span class="op" id="1562348">.</span><span class="ident" id="1562349">inter</span>&nbsp;<span class="op" id="1562355">==</span>&nbsp;<span class="ident" id="1562358">inter</span>&nbsp;<span class="op" id="1562364">&amp;&amp;</span>&nbsp;<span class="ident" id="1562367">m</span><span class="op" id="1562368">.</span><span class="ident" id="1562369">_type</span>&nbsp;<span class="op" id="1562375">==</span>&nbsp;<span class="ident" id="1562378">typ</span>&nbsp;<span class="op" id="1562382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562388">if</span>&nbsp;<span class="ident" id="1562391">m</span><span class="op" id="1562392">.</span><span class="ident" id="1562393">bad</span>&nbsp;<span class="op" id="1562397">!=</span>&nbsp;<span class="num" id="1562400">0</span>&nbsp;<span class="op" id="1562402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562409">m</span>&nbsp;<span class="op" id="1562411">=</span>&nbsp;<span class="ident" id="1562413">nil</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562422">if</span>&nbsp;<span class="op" id="1562425">!</span><span class="ident" id="1562426">canfail</span>&nbsp;<span class="op" id="1562434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562442">//&nbsp;this&nbsp;can&nbsp;only&nbsp;happen&nbsp;if&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562490">//&nbsp;was&nbsp;already&nbsp;done&nbsp;once&nbsp;using&nbsp;the&nbsp;,&nbsp;ok&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562541">//&nbsp;and&nbsp;we&nbsp;have&nbsp;a&nbsp;cached&nbsp;negative&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562588">//&nbsp;the&nbsp;cached&nbsp;result&nbsp;doesn&#39;t&nbsp;record&nbsp;which</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562636">//&nbsp;interface&nbsp;function&nbsp;was&nbsp;missing,&nbsp;so&nbsp;jump</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562685">//&nbsp;down&nbsp;to&nbsp;the&nbsp;interface&nbsp;check,&nbsp;which&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562734">//&nbsp;do&nbsp;more&nbsp;work&nbsp;but&nbsp;give&nbsp;a&nbsp;better&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562781">goto</span>&nbsp;<span class="ident" id="1562786">search</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562798">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562810">if</span>&nbsp;<span class="ident" id="1562813">locked</span>&nbsp;<span class="op" id="1562820">!=</span>&nbsp;<span class="num" id="1562823">0</span>&nbsp;<span class="op" id="1562825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562832">unlock</span><span class="op" id="1562838">(</span><span class="op" id="1562839">&amp;</span><span class="ident" id="1562840">ifaceLock</span><span class="op" id="1562849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1562861">return</span>&nbsp;<span class="ident" id="1562868">m</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1562880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562884">m</span>&nbsp;<span class="op" id="1562886">=</span>&nbsp;<span class="op" id="1562888">(</span><span class="op" id="1562889">*</span><span class="ident" id="1562890">itab</span><span class="op" id="1562894">)</span><span class="op" id="1562895">(</span><span class="ident" id="1562896">persistentalloc</span><span class="op" id="1562911">(</span><span class="ident" id="1562912">unsafe</span><span class="op" id="1562918">.</span><span class="ident" id="1562919">Sizeof</span><span class="op" id="1562925">(</span><span class="ident" id="1562926">itab</span><span class="op" id="1562930">{</span><span class="op" id="1562931">}</span><span class="op" id="1562932">)</span><span class="op" id="1562933">+</span><span class="builtintype" id="1562934">uintptr</span><span class="op" id="1562941">(</span><span class="builtinfunc" id="1562942">len</span><span class="op" id="1562945">(</span><span class="ident" id="1562946">inter</span><span class="op" id="1562951">.</span><span class="ident" id="1562952">mhdr</span><span class="op" id="1562956">)</span><span class="op" id="1562957">)</span><span class="op" id="1562958">*</span><span class="ident" id="1562959">ptrSize</span><span class="op" id="1562966">,</span>&nbsp;<span class="num" id="1562968">0</span><span class="op" id="1562969">,</span>&nbsp;<span class="op" id="1562971">&amp;</span><span class="ident" id="1562972">memstats</span><span class="op" id="1562980">.</span><span class="ident" id="1562981">other_sys</span><span class="op" id="1562990">)</span><span class="op" id="1562991">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1562994">m</span><span class="op" id="1562995">.</span><span class="ident" id="1562996">inter</span>&nbsp;<span class="op" id="1563002">=</span>&nbsp;<span class="ident" id="1563004">inter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563011">m</span><span class="op" id="1563012">.</span><span class="ident" id="1563013">_type</span>&nbsp;<span class="op" id="1563019">=</span>&nbsp;<span class="ident" id="1563021">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1563026">search</span><span class="op" id="1563032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1563035">//&nbsp;both&nbsp;inter&nbsp;and&nbsp;typ&nbsp;have&nbsp;method&nbsp;sorted&nbsp;by&nbsp;name,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1563086">//&nbsp;and&nbsp;interface&nbsp;names&nbsp;are&nbsp;unique,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1563122">//&nbsp;so&nbsp;can&nbsp;iterate&nbsp;over&nbsp;both&nbsp;in&nbsp;lock&nbsp;step;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1563165">//&nbsp;the&nbsp;loop&nbsp;is&nbsp;O(ni+nt)&nbsp;not&nbsp;O(ni*nt).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563204">ni</span>&nbsp;<span class="op" id="1563207">:=</span>&nbsp;<span class="builtinfunc" id="1563210">len</span><span class="op" id="1563213">(</span><span class="ident" id="1563214">inter</span><span class="op" id="1563219">.</span><span class="ident" id="1563220">mhdr</span><span class="op" id="1563224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563227">nt</span>&nbsp;<span class="op" id="1563230">:=</span>&nbsp;<span class="builtinfunc" id="1563233">len</span><span class="op" id="1563236">(</span><span class="ident" id="1563237">x</span><span class="op" id="1563238">.</span><span class="ident" id="1563239">mhdr</span><span class="op" id="1563243">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563246">j</span>&nbsp;<span class="op" id="1563248">:=</span>&nbsp;<span class="num" id="1563251">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563254">for</span>&nbsp;<span class="ident" id="1563258">k</span>&nbsp;<span class="op" id="1563260">:=</span>&nbsp;<span class="num" id="1563263">0</span><span class="op" id="1563264">;</span>&nbsp;<span class="ident" id="1563266">k</span>&nbsp;<span class="op" id="1563268">&lt;</span>&nbsp;<span class="ident" id="1563270">ni</span><span class="op" id="1563272">;</span>&nbsp;<span class="ident" id="1563274">k</span><span class="op" id="1563275">++</span>&nbsp;<span class="op" id="1563278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563282">i</span>&nbsp;<span class="op" id="1563284">:=</span>&nbsp;<span class="op" id="1563287">(</span><span class="op" id="1563288">*</span><span class="ident" id="1563289">imethod</span><span class="op" id="1563296">)</span><span class="op" id="1563297">(</span><span class="ident" id="1563298">add</span><span class="op" id="1563301">(</span><span class="ident" id="1563302">unsafe</span><span class="op" id="1563308">.</span><span class="ident" id="1563309">Pointer</span><span class="op" id="1563316">(</span><span class="ident" id="1563317">inter</span><span class="op" id="1563322">)</span><span class="op" id="1563323">,</span>&nbsp;<span class="ident" id="1563325">unsafe</span><span class="op" id="1563331">.</span><span class="ident" id="1563332">Sizeof</span><span class="op" id="1563338">(</span><span class="ident" id="1563339">interfacetype</span><span class="op" id="1563352">{</span><span class="op" id="1563353">}</span><span class="op" id="1563354">)</span><span class="op" id="1563355">+</span><span class="builtintype" id="1563356">uintptr</span><span class="op" id="1563363">(</span><span class="ident" id="1563364">k</span><span class="op" id="1563365">)</span><span class="op" id="1563366">*</span><span class="ident" id="1563367">unsafe</span><span class="op" id="1563373">.</span><span class="ident" id="1563374">Sizeof</span><span class="op" id="1563380">(</span><span class="ident" id="1563381">imethod</span><span class="op" id="1563388">{</span><span class="op" id="1563389">}</span><span class="op" id="1563390">)</span><span class="op" id="1563391">)</span><span class="op" id="1563392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563396">iname</span>&nbsp;<span class="op" id="1563402">:=</span>&nbsp;<span class="ident" id="1563405">i</span><span class="op" id="1563406">.</span><span class="ident" id="1563407">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563414">ipkgpath</span>&nbsp;<span class="op" id="1563423">:=</span>&nbsp;<span class="ident" id="1563426">i</span><span class="op" id="1563427">.</span><span class="ident" id="1563428">pkgpath</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563438">itype</span>&nbsp;<span class="op" id="1563444">:=</span>&nbsp;<span class="ident" id="1563447">i</span><span class="op" id="1563448">.</span><span class="ident" id="1563449">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563457">for</span>&nbsp;<span class="op" id="1563461">;</span>&nbsp;<span class="ident" id="1563463">j</span>&nbsp;<span class="op" id="1563465">&lt;</span>&nbsp;<span class="ident" id="1563467">nt</span><span class="op" id="1563469">;</span>&nbsp;<span class="ident" id="1563471">j</span><span class="op" id="1563472">++</span>&nbsp;<span class="op" id="1563475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563480">t</span>&nbsp;<span class="op" id="1563482">:=</span>&nbsp;<span class="op" id="1563485">(</span><span class="op" id="1563486">*</span><span class="ident" id="1563487">method</span><span class="op" id="1563493">)</span><span class="op" id="1563494">(</span><span class="ident" id="1563495">add</span><span class="op" id="1563498">(</span><span class="ident" id="1563499">unsafe</span><span class="op" id="1563505">.</span><span class="ident" id="1563506">Pointer</span><span class="op" id="1563513">(</span><span class="ident" id="1563514">x</span><span class="op" id="1563515">)</span><span class="op" id="1563516">,</span>&nbsp;<span class="ident" id="1563518">unsafe</span><span class="op" id="1563524">.</span><span class="ident" id="1563525">Sizeof</span><span class="op" id="1563531">(</span><span class="ident" id="1563532">uncommontype</span><span class="op" id="1563544">{</span><span class="op" id="1563545">}</span><span class="op" id="1563546">)</span><span class="op" id="1563547">+</span><span class="builtintype" id="1563548">uintptr</span><span class="op" id="1563555">(</span><span class="ident" id="1563556">j</span><span class="op" id="1563557">)</span><span class="op" id="1563558">*</span><span class="ident" id="1563559">unsafe</span><span class="op" id="1563565">.</span><span class="ident" id="1563566">Sizeof</span><span class="op" id="1563572">(</span><span class="ident" id="1563573">method</span><span class="op" id="1563579">{</span><span class="op" id="1563580">}</span><span class="op" id="1563581">)</span><span class="op" id="1563582">)</span><span class="op" id="1563583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563588">if</span>&nbsp;<span class="ident" id="1563591">t</span><span class="op" id="1563592">.</span><span class="ident" id="1563593">mtyp</span>&nbsp;<span class="op" id="1563598">==</span>&nbsp;<span class="ident" id="1563601">itype</span>&nbsp;<span class="op" id="1563607">&amp;&amp;</span>&nbsp;<span class="ident" id="1563610">t</span><span class="op" id="1563611">.</span><span class="ident" id="1563612">name</span>&nbsp;<span class="op" id="1563617">==</span>&nbsp;<span class="ident" id="1563620">iname</span>&nbsp;<span class="op" id="1563626">&amp;&amp;</span>&nbsp;<span class="ident" id="1563629">t</span><span class="op" id="1563630">.</span><span class="ident" id="1563631">pkgpath</span>&nbsp;<span class="op" id="1563639">==</span>&nbsp;<span class="ident" id="1563642">ipkgpath</span>&nbsp;<span class="op" id="1563651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563657">if</span>&nbsp;<span class="ident" id="1563660">m</span>&nbsp;<span class="op" id="1563662">!=</span>&nbsp;<span class="ident" id="1563665">nil</span>&nbsp;<span class="op" id="1563669">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563676">*</span><span class="op" id="1563677">(</span><span class="op" id="1563678">*</span><span class="ident" id="1563679">unsafe</span><span class="op" id="1563685">.</span><span class="ident" id="1563686">Pointer</span><span class="op" id="1563693">)</span><span class="op" id="1563694">(</span><span class="ident" id="1563695">add</span><span class="op" id="1563698">(</span><span class="ident" id="1563699">unsafe</span><span class="op" id="1563705">.</span><span class="ident" id="1563706">Pointer</span><span class="op" id="1563713">(</span><span class="ident" id="1563714">m</span><span class="op" id="1563715">)</span><span class="op" id="1563716">,</span>&nbsp;<span class="ident" id="1563718">unsafe</span><span class="op" id="1563724">.</span><span class="ident" id="1563725">Sizeof</span><span class="op" id="1563731">(</span><span class="ident" id="1563732">itab</span><span class="op" id="1563736">{</span><span class="op" id="1563737">}</span><span class="op" id="1563738">)</span><span class="op" id="1563739">+</span><span class="builtintype" id="1563740">uintptr</span><span class="op" id="1563747">(</span><span class="ident" id="1563748">k</span><span class="op" id="1563749">)</span><span class="op" id="1563750">*</span><span class="ident" id="1563751">ptrSize</span><span class="op" id="1563758">)</span><span class="op" id="1563759">)</span>&nbsp;<span class="op" id="1563761">=</span>&nbsp;<span class="ident" id="1563763">t</span><span class="op" id="1563764">.</span><span class="ident" id="1563765">ifn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563779">goto</span>&nbsp;<span class="ident" id="1563784">nextimethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563803">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1563807">//&nbsp;didn&#39;t&nbsp;find&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563831">if</span>&nbsp;<span class="op" id="1563834">!</span><span class="ident" id="1563835">canfail</span>&nbsp;<span class="op" id="1563843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563848">if</span>&nbsp;<span class="ident" id="1563851">locked</span>&nbsp;<span class="op" id="1563858">!=</span>&nbsp;<span class="num" id="1563861">0</span>&nbsp;<span class="op" id="1563863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563869">unlock</span><span class="op" id="1563875">(</span><span class="op" id="1563876">&amp;</span><span class="ident" id="1563877">ifaceLock</span><span class="op" id="1563886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563891">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1563896">panic</span><span class="op" id="1563901">(</span><span class="op" id="1563902">&amp;</span><span class="ident" id="1563903">TypeAssertionError</span><span class="op" id="1563921">{</span><span class="string" id="1563922">&#34;&#34;</span><span class="op" id="1563924">,</span>&nbsp;<span class="op" id="1563926">*</span><span class="ident" id="1563927">typ</span><span class="op" id="1563930">.</span><span class="ident" id="1563931">_string</span><span class="op" id="1563938">,</span>&nbsp;<span class="op" id="1563940">*</span><span class="ident" id="1563941">inter</span><span class="op" id="1563946">.</span><span class="ident" id="1563947">typ</span><span class="op" id="1563950">.</span><span class="ident" id="1563951">_string</span><span class="op" id="1563958">,</span>&nbsp;<span class="op" id="1563960">*</span><span class="ident" id="1563961">iname</span><span class="op" id="1563966">}</span><span class="op" id="1563967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1563971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563975">m</span><span class="op" id="1563976">.</span><span class="ident" id="1563977">bad</span>&nbsp;<span class="op" id="1563981">=</span>&nbsp;<span class="num" id="1563983">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1563987">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1563994">nextimethod</span><span class="op" id="1564005">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1564008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564011">if</span>&nbsp;<span class="ident" id="1564014">locked</span>&nbsp;<span class="op" id="1564021">==</span>&nbsp;<span class="num" id="1564024">0</span>&nbsp;<span class="op" id="1564026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564030">gothrow</span><span class="op" id="1564037">(</span><span class="string" id="1564038">&#34;invalid&nbsp;itab&nbsp;locking&#34;</span><span class="op" id="1564060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1564063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564066">m</span><span class="op" id="1564067">.</span><span class="ident" id="1564068">link</span>&nbsp;<span class="op" id="1564073">=</span>&nbsp;<span class="ident" id="1564075">hash</span><span class="op" id="1564079">[</span><span class="ident" id="1564080">h</span><span class="op" id="1564081">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564084">atomicstorep</span><span class="op" id="1564096">(</span><span class="ident" id="1564097">unsafe</span><span class="op" id="1564103">.</span><span class="ident" id="1564104">Pointer</span><span class="op" id="1564111">(</span><span class="op" id="1564112">&amp;</span><span class="ident" id="1564113">hash</span><span class="op" id="1564117">[</span><span class="ident" id="1564118">h</span><span class="op" id="1564119">]</span><span class="op" id="1564120">)</span><span class="op" id="1564121">,</span>&nbsp;<span class="ident" id="1564123">unsafe</span><span class="op" id="1564129">.</span><span class="ident" id="1564130">Pointer</span><span class="op" id="1564137">(</span><span class="ident" id="1564138">m</span><span class="op" id="1564139">)</span><span class="op" id="1564140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564143">unlock</span><span class="op" id="1564149">(</span><span class="op" id="1564150">&amp;</span><span class="ident" id="1564151">ifaceLock</span><span class="op" id="1564160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564163">if</span>&nbsp;<span class="ident" id="1564166">m</span><span class="op" id="1564167">.</span><span class="ident" id="1564168">bad</span>&nbsp;<span class="op" id="1564172">!=</span>&nbsp;<span class="num" id="1564175">0</span>&nbsp;<span class="op" id="1564177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564181">return</span>&nbsp;<span class="ident" id="1564188">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1564193">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564196">return</span>&nbsp;<span class="ident" id="1564203">m</span><br>
<span class="lineno"></span><span class="op" id="1564205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1564208">func</span>&nbsp;<span class="ident" id="1564213">typ2Itab</span><span class="op" id="1564221">(</span><span class="ident" id="1564222">t</span>&nbsp;<span class="op" id="1564224">*</span><span class="ident" id="1564225">_type</span><span class="op" id="1564230">,</span>&nbsp;<span class="ident" id="1564232">inter</span>&nbsp;<span class="op" id="1564238">*</span><span class="ident" id="1564239">interfacetype</span><span class="op" id="1564252">,</span>&nbsp;<span class="ident" id="1564254">cache</span>&nbsp;<span class="op" id="1564260">*</span><span class="op" id="1564261">*</span><span class="ident" id="1564262">itab</span><span class="op" id="1564266">)</span>&nbsp;<span class="op" id="1564268">*</span><span class="ident" id="1564269">itab</span>&nbsp;<span class="op" id="1564274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564277">tab</span>&nbsp;<span class="op" id="1564281">:=</span>&nbsp;<span class="ident" id="1564284">getitab</span><span class="op" id="1564291">(</span><span class="ident" id="1564292">inter</span><span class="op" id="1564297">,</span>&nbsp;<span class="ident" id="1564299">t</span><span class="op" id="1564300">,</span>&nbsp;<span class="ident" id="1564302">false</span><span class="op" id="1564307">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564310">atomicstorep</span><span class="op" id="1564322">(</span><span class="ident" id="1564323">unsafe</span><span class="op" id="1564329">.</span><span class="ident" id="1564330">Pointer</span><span class="op" id="1564337">(</span><span class="ident" id="1564338">cache</span><span class="op" id="1564343">)</span><span class="op" id="1564344">,</span>&nbsp;<span class="ident" id="1564346">unsafe</span><span class="op" id="1564352">.</span><span class="ident" id="1564353">Pointer</span><span class="op" id="1564360">(</span><span class="ident" id="1564361">tab</span><span class="op" id="1564364">)</span><span class="op" id="1564365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564368">return</span>&nbsp;<span class="ident" id="1564375">tab</span><br>
<span class="lineno"></span><span class="op" id="1564379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1564382">func</span>&nbsp;<span class="ident" id="1564387">convT2E</span><span class="op" id="1564394">(</span><span class="ident" id="1564395">t</span>&nbsp;<span class="op" id="1564397">*</span><span class="ident" id="1564398">_type</span><span class="op" id="1564403">,</span>&nbsp;<span class="ident" id="1564405">elem</span>&nbsp;<span class="ident" id="1564410">unsafe</span><span class="op" id="1564416">.</span><span class="ident" id="1564417">Pointer</span><span class="op" id="1564424">)</span>&nbsp;<span class="op" id="1564426">(</span><span class="ident" id="1564427">e</span>&nbsp;<span class="keyword" id="1564429">interface</span><span class="op" id="1564438">{</span><span class="op" id="1564439">}</span><span class="op" id="1564440">)</span>&nbsp;<span class="op" id="1564442">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564445">size</span>&nbsp;<span class="op" id="1564450">:=</span>&nbsp;<span class="builtintype" id="1564453">uintptr</span><span class="op" id="1564460">(</span><span class="ident" id="1564461">t</span><span class="op" id="1564462">.</span><span class="ident" id="1564463">size</span><span class="op" id="1564467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564470">ep</span>&nbsp;<span class="op" id="1564473">:=</span>&nbsp;<span class="op" id="1564476">(</span><span class="op" id="1564477">*</span><span class="ident" id="1564478">eface</span><span class="op" id="1564483">)</span><span class="op" id="1564484">(</span><span class="ident" id="1564485">unsafe</span><span class="op" id="1564491">.</span><span class="ident" id="1564492">Pointer</span><span class="op" id="1564499">(</span><span class="op" id="1564500">&amp;</span><span class="ident" id="1564501">e</span><span class="op" id="1564502">)</span><span class="op" id="1564503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564506">if</span>&nbsp;<span class="ident" id="1564509">isDirectIface</span><span class="op" id="1564522">(</span><span class="ident" id="1564523">t</span><span class="op" id="1564524">)</span>&nbsp;<span class="op" id="1564526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564530">ep</span><span class="op" id="1564532">.</span><span class="ident" id="1564533">_type</span>&nbsp;<span class="op" id="1564539">=</span>&nbsp;<span class="ident" id="1564541">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564545">memmove</span><span class="op" id="1564552">(</span><span class="ident" id="1564553">unsafe</span><span class="op" id="1564559">.</span><span class="ident" id="1564560">Pointer</span><span class="op" id="1564567">(</span><span class="op" id="1564568">&amp;</span><span class="ident" id="1564569">ep</span><span class="op" id="1564571">.</span><span class="ident" id="1564572">data</span><span class="op" id="1564576">)</span><span class="op" id="1564577">,</span>&nbsp;<span class="ident" id="1564579">elem</span><span class="op" id="1564583">,</span>&nbsp;<span class="ident" id="1564585">size</span><span class="op" id="1564589">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1564592">}</span>&nbsp;<span class="keyword" id="1564594">else</span>&nbsp;<span class="op" id="1564599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564603">x</span>&nbsp;<span class="op" id="1564605">:=</span>&nbsp;<span class="ident" id="1564608">newobject</span><span class="op" id="1564617">(</span><span class="ident" id="1564618">t</span><span class="op" id="1564619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1564623">//&nbsp;TODO:&nbsp;We&nbsp;allocate&nbsp;a&nbsp;zeroed&nbsp;object&nbsp;only&nbsp;to&nbsp;overwrite&nbsp;it&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1564688">//&nbsp;actual&nbsp;data.&nbsp;&nbsp;Figure&nbsp;out&nbsp;how&nbsp;to&nbsp;avoid&nbsp;zeroing.&nbsp;&nbsp;Also&nbsp;below&nbsp;in&nbsp;convT2I.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564764">memmove</span><span class="op" id="1564771">(</span><span class="ident" id="1564772">x</span><span class="op" id="1564773">,</span>&nbsp;<span class="ident" id="1564775">elem</span><span class="op" id="1564779">,</span>&nbsp;<span class="ident" id="1564781">size</span><span class="op" id="1564785">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564789">ep</span><span class="op" id="1564791">.</span><span class="ident" id="1564792">_type</span>&nbsp;<span class="op" id="1564798">=</span>&nbsp;<span class="ident" id="1564800">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564804">ep</span><span class="op" id="1564806">.</span><span class="ident" id="1564807">data</span>&nbsp;<span class="op" id="1564812">=</span>&nbsp;<span class="ident" id="1564814">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1564817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564820">return</span><br>
<span class="lineno"></span><span class="op" id="1564827">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="1564830">func</span>&nbsp;<span class="ident" id="1564835">convT2I</span><span class="op" id="1564842">(</span><span class="ident" id="1564843">t</span>&nbsp;<span class="op" id="1564845">*</span><span class="ident" id="1564846">_type</span><span class="op" id="1564851">,</span>&nbsp;<span class="ident" id="1564853">inter</span>&nbsp;<span class="op" id="1564859">*</span><span class="ident" id="1564860">interfacetype</span><span class="op" id="1564873">,</span>&nbsp;<span class="ident" id="1564875">cache</span>&nbsp;<span class="op" id="1564881">*</span><span class="op" id="1564882">*</span><span class="ident" id="1564883">itab</span><span class="op" id="1564887">,</span>&nbsp;<span class="ident" id="1564889">elem</span>&nbsp;<span class="ident" id="1564894">unsafe</span><span class="op" id="1564900">.</span><span class="ident" id="1564901">Pointer</span><span class="op" id="1564908">)</span>&nbsp;<span class="op" id="1564910">(</span><span class="ident" id="1564911">i</span>&nbsp;<span class="ident" id="1564913">fInterface</span><span class="op" id="1564923">)</span>&nbsp;<span class="op" id="1564925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564928">tab</span>&nbsp;<span class="op" id="1564932">:=</span>&nbsp;<span class="op" id="1564935">(</span><span class="op" id="1564936">*</span><span class="ident" id="1564937">itab</span><span class="op" id="1564941">)</span><span class="op" id="1564942">(</span><span class="ident" id="1564943">atomicloadp</span><span class="op" id="1564954">(</span><span class="ident" id="1564955">unsafe</span><span class="op" id="1564961">.</span><span class="ident" id="1564962">Pointer</span><span class="op" id="1564969">(</span><span class="ident" id="1564970">cache</span><span class="op" id="1564975">)</span><span class="op" id="1564976">)</span><span class="op" id="1564977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1564980">if</span>&nbsp;<span class="ident" id="1564983">tab</span>&nbsp;<span class="op" id="1564987">==</span>&nbsp;<span class="ident" id="1564990">nil</span>&nbsp;<span class="op" id="1564994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1564998">tab</span>&nbsp;<span class="op" id="1565002">=</span>&nbsp;<span class="ident" id="1565004">getitab</span><span class="op" id="1565011">(</span><span class="ident" id="1565012">inter</span><span class="op" id="1565017">,</span>&nbsp;<span class="ident" id="1565019">t</span><span class="op" id="1565020">,</span>&nbsp;<span class="ident" id="1565022">false</span><span class="op" id="1565027">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565031">atomicstorep</span><span class="op" id="1565043">(</span><span class="ident" id="1565044">unsafe</span><span class="op" id="1565050">.</span><span class="ident" id="1565051">Pointer</span><span class="op" id="1565058">(</span><span class="ident" id="1565059">cache</span><span class="op" id="1565064">)</span><span class="op" id="1565065">,</span>&nbsp;<span class="ident" id="1565067">unsafe</span><span class="op" id="1565073">.</span><span class="ident" id="1565074">Pointer</span><span class="op" id="1565081">(</span><span class="ident" id="1565082">tab</span><span class="op" id="1565085">)</span><span class="op" id="1565086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565092">size</span>&nbsp;<span class="op" id="1565097">:=</span>&nbsp;<span class="builtintype" id="1565100">uintptr</span><span class="op" id="1565107">(</span><span class="ident" id="1565108">t</span><span class="op" id="1565109">.</span><span class="ident" id="1565110">size</span><span class="op" id="1565114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565117">pi</span>&nbsp;<span class="op" id="1565120">:=</span>&nbsp;<span class="op" id="1565123">(</span><span class="op" id="1565124">*</span><span class="ident" id="1565125">iface</span><span class="op" id="1565130">)</span><span class="op" id="1565131">(</span><span class="ident" id="1565132">unsafe</span><span class="op" id="1565138">.</span><span class="ident" id="1565139">Pointer</span><span class="op" id="1565146">(</span><span class="op" id="1565147">&amp;</span><span class="ident" id="1565148">i</span><span class="op" id="1565149">)</span><span class="op" id="1565150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565153">if</span>&nbsp;<span class="ident" id="1565156">isDirectIface</span><span class="op" id="1565169">(</span><span class="ident" id="1565170">t</span><span class="op" id="1565171">)</span>&nbsp;<span class="op" id="1565173">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565177">pi</span><span class="op" id="1565179">.</span><span class="ident" id="1565180">tab</span>&nbsp;<span class="op" id="1565184">=</span>&nbsp;<span class="ident" id="1565186">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565192">memmove</span><span class="op" id="1565199">(</span><span class="ident" id="1565200">unsafe</span><span class="op" id="1565206">.</span><span class="ident" id="1565207">Pointer</span><span class="op" id="1565214">(</span><span class="op" id="1565215">&amp;</span><span class="ident" id="1565216">pi</span><span class="op" id="1565218">.</span><span class="ident" id="1565219">data</span><span class="op" id="1565223">)</span><span class="op" id="1565224">,</span>&nbsp;<span class="ident" id="1565226">elem</span><span class="op" id="1565230">,</span>&nbsp;<span class="ident" id="1565232">size</span><span class="op" id="1565236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565239">}</span>&nbsp;<span class="keyword" id="1565241">else</span>&nbsp;<span class="op" id="1565246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565250">x</span>&nbsp;<span class="op" id="1565252">:=</span>&nbsp;<span class="ident" id="1565255">newobject</span><span class="op" id="1565264">(</span><span class="ident" id="1565265">t</span><span class="op" id="1565266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565270">memmove</span><span class="op" id="1565277">(</span><span class="ident" id="1565278">x</span><span class="op" id="1565279">,</span>&nbsp;<span class="ident" id="1565281">elem</span><span class="op" id="1565285">,</span>&nbsp;<span class="ident" id="1565287">size</span><span class="op" id="1565291">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565295">pi</span><span class="op" id="1565297">.</span><span class="ident" id="1565298">tab</span>&nbsp;<span class="op" id="1565302">=</span>&nbsp;<span class="ident" id="1565304">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565310">pi</span><span class="op" id="1565312">.</span><span class="ident" id="1565313">data</span>&nbsp;<span class="op" id="1565318">=</span>&nbsp;<span class="ident" id="1565320">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565326">return</span><br>
<span class="lineno"></span><span class="op" id="1565333">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="comment" id="1565336">//&nbsp;TODO:&nbsp;give&nbsp;these&nbsp;routines&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;result&nbsp;area&nbsp;instead&nbsp;of&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="1565413">//&nbsp;extra&nbsp;data&nbsp;in&nbsp;the&nbsp;outargs&nbsp;section.&nbsp;&nbsp;Then&nbsp;we&nbsp;can&nbsp;get&nbsp;rid&nbsp;of&nbsp;go:nosplit.</span><br>
<span class="lineno"></span><span class="comment" id="1565487">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1565500">func</span>&nbsp;<span class="ident" id="1565505">assertI2T</span><span class="op" id="1565514">(</span><span class="ident" id="1565515">t</span>&nbsp;<span class="op" id="1565517">*</span><span class="ident" id="1565518">_type</span><span class="op" id="1565523">,</span>&nbsp;<span class="ident" id="1565525">i</span>&nbsp;<span class="ident" id="1565527">fInterface</span><span class="op" id="1565537">)</span>&nbsp;<span class="op" id="1565539">(</span><span class="ident" id="1565540">r</span>&nbsp;<span class="keyword" id="1565542">struct</span><span class="op" id="1565548">{</span><span class="op" id="1565549">}</span><span class="op" id="1565550">)</span>&nbsp;<span class="op" id="1565552">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565555">ip</span>&nbsp;<span class="op" id="1565558">:=</span>&nbsp;<span class="op" id="1565561">(</span><span class="op" id="1565562">*</span><span class="ident" id="1565563">iface</span><span class="op" id="1565568">)</span><span class="op" id="1565569">(</span><span class="ident" id="1565570">unsafe</span><span class="op" id="1565576">.</span><span class="ident" id="1565577">Pointer</span><span class="op" id="1565584">(</span><span class="op" id="1565585">&amp;</span><span class="ident" id="1565586">i</span><span class="op" id="1565587">)</span><span class="op" id="1565588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565591">tab</span>&nbsp;<span class="op" id="1565595">:=</span>&nbsp;<span class="ident" id="1565598">ip</span><span class="op" id="1565600">.</span><span class="ident" id="1565601">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565606">if</span>&nbsp;<span class="ident" id="1565609">tab</span>&nbsp;<span class="op" id="1565613">==</span>&nbsp;<span class="ident" id="1565616">nil</span>&nbsp;<span class="op" id="1565620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1565624">panic</span><span class="op" id="1565629">(</span><span class="op" id="1565630">&amp;</span><span class="ident" id="1565631">TypeAssertionError</span><span class="op" id="1565649">{</span><span class="string" id="1565650">&#34;&#34;</span><span class="op" id="1565652">,</span>&nbsp;<span class="string" id="1565654">&#34;&#34;</span><span class="op" id="1565656">,</span>&nbsp;<span class="op" id="1565658">*</span><span class="ident" id="1565659">t</span><span class="op" id="1565660">.</span><span class="ident" id="1565661">_string</span><span class="op" id="1565668">,</span>&nbsp;<span class="string" id="1565670">&#34;&#34;</span><span class="op" id="1565672">}</span><span class="op" id="1565673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565676">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565679">if</span>&nbsp;<span class="ident" id="1565682">tab</span><span class="op" id="1565685">.</span><span class="ident" id="1565686">_type</span>&nbsp;<span class="op" id="1565692">!=</span>&nbsp;<span class="ident" id="1565695">t</span>&nbsp;<span class="op" id="1565697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1565701">panic</span><span class="op" id="1565706">(</span><span class="op" id="1565707">&amp;</span><span class="ident" id="1565708">TypeAssertionError</span><span class="op" id="1565726">{</span><span class="op" id="1565727">*</span><span class="ident" id="1565728">tab</span><span class="op" id="1565731">.</span><span class="ident" id="1565732">inter</span><span class="op" id="1565737">.</span><span class="ident" id="1565738">typ</span><span class="op" id="1565741">.</span><span class="ident" id="1565742">_string</span><span class="op" id="1565749">,</span>&nbsp;<span class="op" id="1565751">*</span><span class="ident" id="1565752">tab</span><span class="op" id="1565755">.</span><span class="ident" id="1565756">_type</span><span class="op" id="1565761">.</span><span class="ident" id="1565762">_string</span><span class="op" id="1565769">,</span>&nbsp;<span class="op" id="1565771">*</span><span class="ident" id="1565772">t</span><span class="op" id="1565773">.</span><span class="ident" id="1565774">_string</span><span class="op" id="1565781">,</span>&nbsp;<span class="string" id="1565783">&#34;&#34;</span><span class="op" id="1565785">}</span><span class="op" id="1565786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565792">size</span>&nbsp;<span class="op" id="1565797">:=</span>&nbsp;<span class="builtintype" id="1565800">uintptr</span><span class="op" id="1565807">(</span><span class="ident" id="1565808">t</span><span class="op" id="1565809">.</span><span class="ident" id="1565810">size</span><span class="op" id="1565814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565817">if</span>&nbsp;<span class="ident" id="1565820">isDirectIface</span><span class="op" id="1565833">(</span><span class="ident" id="1565834">t</span><span class="op" id="1565835">)</span>&nbsp;<span class="op" id="1565837">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565841">memmove</span><span class="op" id="1565848">(</span><span class="ident" id="1565849">unsafe</span><span class="op" id="1565855">.</span><span class="ident" id="1565856">Pointer</span><span class="op" id="1565863">(</span><span class="op" id="1565864">&amp;</span><span class="ident" id="1565865">r</span><span class="op" id="1565866">)</span><span class="op" id="1565867">,</span>&nbsp;<span class="ident" id="1565869">unsafe</span><span class="op" id="1565875">.</span><span class="ident" id="1565876">Pointer</span><span class="op" id="1565883">(</span><span class="op" id="1565884">&amp;</span><span class="ident" id="1565885">ip</span><span class="op" id="1565887">.</span><span class="ident" id="1565888">data</span><span class="op" id="1565892">)</span><span class="op" id="1565893">,</span>&nbsp;<span class="ident" id="1565895">size</span><span class="op" id="1565899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565902">}</span>&nbsp;<span class="keyword" id="1565904">else</span>&nbsp;<span class="op" id="1565909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1565913">memmove</span><span class="op" id="1565920">(</span><span class="ident" id="1565921">unsafe</span><span class="op" id="1565927">.</span><span class="ident" id="1565928">Pointer</span><span class="op" id="1565935">(</span><span class="op" id="1565936">&amp;</span><span class="ident" id="1565937">r</span><span class="op" id="1565938">)</span><span class="op" id="1565939">,</span>&nbsp;<span class="ident" id="1565941">ip</span><span class="op" id="1565943">.</span><span class="ident" id="1565944">data</span><span class="op" id="1565948">,</span>&nbsp;<span class="ident" id="1565950">size</span><span class="op" id="1565954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1565957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1565960">return</span><br>
<span class="lineno">190</span><span class="op" id="1565967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1565970">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1565983">func</span>&nbsp;<span class="ident" id="1565988">assertI2T2</span><span class="op" id="1565998">(</span><span class="ident" id="1565999">t</span>&nbsp;<span class="op" id="1566001">*</span><span class="ident" id="1566002">_type</span><span class="op" id="1566007">,</span>&nbsp;<span class="ident" id="1566009">i</span>&nbsp;<span class="ident" id="1566011">fInterface</span><span class="op" id="1566021">)</span>&nbsp;<span class="op" id="1566023">(</span><span class="ident" id="1566024">r</span>&nbsp;<span class="builtintype" id="1566026">byte</span><span class="op" id="1566030">)</span>&nbsp;<span class="op" id="1566032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566035">ip</span>&nbsp;<span class="op" id="1566038">:=</span>&nbsp;<span class="op" id="1566041">(</span><span class="op" id="1566042">*</span><span class="ident" id="1566043">iface</span><span class="op" id="1566048">)</span><span class="op" id="1566049">(</span><span class="ident" id="1566050">unsafe</span><span class="op" id="1566056">.</span><span class="ident" id="1566057">Pointer</span><span class="op" id="1566064">(</span><span class="op" id="1566065">&amp;</span><span class="ident" id="1566066">i</span><span class="op" id="1566067">)</span><span class="op" id="1566068">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566071">size</span>&nbsp;<span class="op" id="1566076">:=</span>&nbsp;<span class="builtintype" id="1566079">uintptr</span><span class="op" id="1566086">(</span><span class="ident" id="1566087">t</span><span class="op" id="1566088">.</span><span class="ident" id="1566089">size</span><span class="op" id="1566093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566096">ok</span>&nbsp;<span class="op" id="1566099">:=</span>&nbsp;<span class="op" id="1566102">(</span><span class="op" id="1566103">*</span><span class="builtintype" id="1566104">bool</span><span class="op" id="1566108">)</span><span class="op" id="1566109">(</span><span class="ident" id="1566110">add</span><span class="op" id="1566113">(</span><span class="ident" id="1566114">unsafe</span><span class="op" id="1566120">.</span><span class="ident" id="1566121">Pointer</span><span class="op" id="1566128">(</span><span class="op" id="1566129">&amp;</span><span class="ident" id="1566130">r</span><span class="op" id="1566131">)</span><span class="op" id="1566132">,</span>&nbsp;<span class="ident" id="1566134">size</span><span class="op" id="1566138">)</span><span class="op" id="1566139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566142">tab</span>&nbsp;<span class="op" id="1566146">:=</span>&nbsp;<span class="ident" id="1566149">ip</span><span class="op" id="1566151">.</span><span class="ident" id="1566152">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566157">if</span>&nbsp;<span class="ident" id="1566160">tab</span>&nbsp;<span class="op" id="1566164">==</span>&nbsp;<span class="ident" id="1566167">nil</span>&nbsp;<span class="op" id="1566171">||</span>&nbsp;<span class="ident" id="1566174">tab</span><span class="op" id="1566177">.</span><span class="ident" id="1566178">_type</span>&nbsp;<span class="op" id="1566184">!=</span>&nbsp;<span class="ident" id="1566187">t</span>&nbsp;<span class="op" id="1566189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566193">*</span><span class="ident" id="1566194">ok</span>&nbsp;<span class="op" id="1566197">=</span>&nbsp;<span class="ident" id="1566199">false</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566207">memclr</span><span class="op" id="1566213">(</span><span class="ident" id="1566214">unsafe</span><span class="op" id="1566220">.</span><span class="ident" id="1566221">Pointer</span><span class="op" id="1566228">(</span><span class="op" id="1566229">&amp;</span><span class="ident" id="1566230">r</span><span class="op" id="1566231">)</span><span class="op" id="1566232">,</span>&nbsp;<span class="ident" id="1566234">size</span><span class="op" id="1566238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566253">*</span><span class="ident" id="1566254">ok</span>&nbsp;<span class="op" id="1566257">=</span>&nbsp;<span class="ident" id="1566259">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566265">if</span>&nbsp;<span class="ident" id="1566268">isDirectIface</span><span class="op" id="1566281">(</span><span class="ident" id="1566282">t</span><span class="op" id="1566283">)</span>&nbsp;<span class="op" id="1566285">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566289">memmove</span><span class="op" id="1566296">(</span><span class="ident" id="1566297">unsafe</span><span class="op" id="1566303">.</span><span class="ident" id="1566304">Pointer</span><span class="op" id="1566311">(</span><span class="op" id="1566312">&amp;</span><span class="ident" id="1566313">r</span><span class="op" id="1566314">)</span><span class="op" id="1566315">,</span>&nbsp;<span class="ident" id="1566317">unsafe</span><span class="op" id="1566323">.</span><span class="ident" id="1566324">Pointer</span><span class="op" id="1566331">(</span><span class="op" id="1566332">&amp;</span><span class="ident" id="1566333">ip</span><span class="op" id="1566335">.</span><span class="ident" id="1566336">data</span><span class="op" id="1566340">)</span><span class="op" id="1566341">,</span>&nbsp;<span class="ident" id="1566343">size</span><span class="op" id="1566347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566350">}</span>&nbsp;<span class="keyword" id="1566352">else</span>&nbsp;<span class="op" id="1566357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566361">memmove</span><span class="op" id="1566368">(</span><span class="ident" id="1566369">unsafe</span><span class="op" id="1566375">.</span><span class="ident" id="1566376">Pointer</span><span class="op" id="1566383">(</span><span class="op" id="1566384">&amp;</span><span class="ident" id="1566385">r</span><span class="op" id="1566386">)</span><span class="op" id="1566387">,</span>&nbsp;<span class="ident" id="1566389">ip</span><span class="op" id="1566391">.</span><span class="ident" id="1566392">data</span><span class="op" id="1566396">,</span>&nbsp;<span class="ident" id="1566398">size</span><span class="op" id="1566402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566408">return</span><br>
<span class="lineno">210</span><span class="op" id="1566415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1566418">func</span>&nbsp;<span class="ident" id="1566423">assertI2TOK</span><span class="op" id="1566434">(</span><span class="ident" id="1566435">t</span>&nbsp;<span class="op" id="1566437">*</span><span class="ident" id="1566438">_type</span><span class="op" id="1566443">,</span>&nbsp;<span class="ident" id="1566445">i</span>&nbsp;<span class="ident" id="1566447">fInterface</span><span class="op" id="1566457">)</span>&nbsp;<span class="builtintype" id="1566459">bool</span>&nbsp;<span class="op" id="1566464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566467">ip</span>&nbsp;<span class="op" id="1566470">:=</span>&nbsp;<span class="op" id="1566473">(</span><span class="op" id="1566474">*</span><span class="ident" id="1566475">iface</span><span class="op" id="1566480">)</span><span class="op" id="1566481">(</span><span class="ident" id="1566482">unsafe</span><span class="op" id="1566488">.</span><span class="ident" id="1566489">Pointer</span><span class="op" id="1566496">(</span><span class="op" id="1566497">&amp;</span><span class="ident" id="1566498">i</span><span class="op" id="1566499">)</span><span class="op" id="1566500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566503">tab</span>&nbsp;<span class="op" id="1566507">:=</span>&nbsp;<span class="ident" id="1566510">ip</span><span class="op" id="1566512">.</span><span class="ident" id="1566513">tab</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566518">return</span>&nbsp;<span class="ident" id="1566525">tab</span>&nbsp;<span class="op" id="1566529">!=</span>&nbsp;<span class="ident" id="1566532">nil</span>&nbsp;<span class="op" id="1566536">&amp;&amp;</span>&nbsp;<span class="ident" id="1566539">tab</span><span class="op" id="1566542">.</span><span class="ident" id="1566543">_type</span>&nbsp;<span class="op" id="1566549">==</span>&nbsp;<span class="ident" id="1566552">t</span><br>
<span class="lineno"></span><span class="op" id="1566554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1566557">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1566570">func</span>&nbsp;<span class="ident" id="1566575">assertE2T</span><span class="op" id="1566584">(</span><span class="ident" id="1566585">t</span>&nbsp;<span class="op" id="1566587">*</span><span class="ident" id="1566588">_type</span><span class="op" id="1566593">,</span>&nbsp;<span class="ident" id="1566595">e</span>&nbsp;<span class="keyword" id="1566597">interface</span><span class="op" id="1566606">{</span><span class="op" id="1566607">}</span><span class="op" id="1566608">)</span>&nbsp;<span class="op" id="1566610">(</span><span class="ident" id="1566611">r</span>&nbsp;<span class="keyword" id="1566613">struct</span><span class="op" id="1566619">{</span><span class="op" id="1566620">}</span><span class="op" id="1566621">)</span>&nbsp;<span class="op" id="1566623">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566626">ep</span>&nbsp;<span class="op" id="1566629">:=</span>&nbsp;<span class="op" id="1566632">(</span><span class="op" id="1566633">*</span><span class="ident" id="1566634">eface</span><span class="op" id="1566639">)</span><span class="op" id="1566640">(</span><span class="ident" id="1566641">unsafe</span><span class="op" id="1566647">.</span><span class="ident" id="1566648">Pointer</span><span class="op" id="1566655">(</span><span class="op" id="1566656">&amp;</span><span class="ident" id="1566657">e</span><span class="op" id="1566658">)</span><span class="op" id="1566659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566662">if</span>&nbsp;<span class="ident" id="1566665">ep</span><span class="op" id="1566667">.</span><span class="ident" id="1566668">_type</span>&nbsp;<span class="op" id="1566674">==</span>&nbsp;<span class="ident" id="1566677">nil</span>&nbsp;<span class="op" id="1566681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1566685">panic</span><span class="op" id="1566690">(</span><span class="op" id="1566691">&amp;</span><span class="ident" id="1566692">TypeAssertionError</span><span class="op" id="1566710">{</span><span class="string" id="1566711">&#34;&#34;</span><span class="op" id="1566713">,</span>&nbsp;<span class="string" id="1566715">&#34;&#34;</span><span class="op" id="1566717">,</span>&nbsp;<span class="op" id="1566719">*</span><span class="ident" id="1566720">t</span><span class="op" id="1566721">.</span><span class="ident" id="1566722">_string</span><span class="op" id="1566729">,</span>&nbsp;<span class="string" id="1566731">&#34;&#34;</span><span class="op" id="1566733">}</span><span class="op" id="1566734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566740">if</span>&nbsp;<span class="ident" id="1566743">ep</span><span class="op" id="1566745">.</span><span class="ident" id="1566746">_type</span>&nbsp;<span class="op" id="1566752">!=</span>&nbsp;<span class="ident" id="1566755">t</span>&nbsp;<span class="op" id="1566757">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1566761">panic</span><span class="op" id="1566766">(</span><span class="op" id="1566767">&amp;</span><span class="ident" id="1566768">TypeAssertionError</span><span class="op" id="1566786">{</span><span class="string" id="1566787">&#34;&#34;</span><span class="op" id="1566789">,</span>&nbsp;<span class="op" id="1566791">*</span><span class="ident" id="1566792">ep</span><span class="op" id="1566794">.</span><span class="ident" id="1566795">_type</span><span class="op" id="1566800">.</span><span class="ident" id="1566801">_string</span><span class="op" id="1566808">,</span>&nbsp;<span class="op" id="1566810">*</span><span class="ident" id="1566811">t</span><span class="op" id="1566812">.</span><span class="ident" id="1566813">_string</span><span class="op" id="1566820">,</span>&nbsp;<span class="string" id="1566822">&#34;&#34;</span><span class="op" id="1566824">}</span><span class="op" id="1566825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566831">size</span>&nbsp;<span class="op" id="1566836">:=</span>&nbsp;<span class="builtintype" id="1566839">uintptr</span><span class="op" id="1566846">(</span><span class="ident" id="1566847">t</span><span class="op" id="1566848">.</span><span class="ident" id="1566849">size</span><span class="op" id="1566853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566856">if</span>&nbsp;<span class="ident" id="1566859">isDirectIface</span><span class="op" id="1566872">(</span><span class="ident" id="1566873">t</span><span class="op" id="1566874">)</span>&nbsp;<span class="op" id="1566876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566880">memmove</span><span class="op" id="1566887">(</span><span class="ident" id="1566888">unsafe</span><span class="op" id="1566894">.</span><span class="ident" id="1566895">Pointer</span><span class="op" id="1566902">(</span><span class="op" id="1566903">&amp;</span><span class="ident" id="1566904">r</span><span class="op" id="1566905">)</span><span class="op" id="1566906">,</span>&nbsp;<span class="ident" id="1566908">unsafe</span><span class="op" id="1566914">.</span><span class="ident" id="1566915">Pointer</span><span class="op" id="1566922">(</span><span class="op" id="1566923">&amp;</span><span class="ident" id="1566924">ep</span><span class="op" id="1566926">.</span><span class="ident" id="1566927">data</span><span class="op" id="1566931">)</span><span class="op" id="1566932">,</span>&nbsp;<span class="ident" id="1566934">size</span><span class="op" id="1566938">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566941">}</span>&nbsp;<span class="keyword" id="1566943">else</span>&nbsp;<span class="op" id="1566948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566952">memmove</span><span class="op" id="1566959">(</span><span class="ident" id="1566960">unsafe</span><span class="op" id="1566966">.</span><span class="ident" id="1566967">Pointer</span><span class="op" id="1566974">(</span><span class="op" id="1566975">&amp;</span><span class="ident" id="1566976">r</span><span class="op" id="1566977">)</span><span class="op" id="1566978">,</span>&nbsp;<span class="ident" id="1566980">ep</span><span class="op" id="1566982">.</span><span class="ident" id="1566983">data</span><span class="op" id="1566987">,</span>&nbsp;<span class="ident" id="1566989">size</span><span class="op" id="1566993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566999">return</span><br>
<span class="lineno"></span><span class="op" id="1567006">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="1567009">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1567022">func</span>&nbsp;<span class="ident" id="1567027">assertE2T2</span><span class="op" id="1567037">(</span><span class="ident" id="1567038">t</span>&nbsp;<span class="op" id="1567040">*</span><span class="ident" id="1567041">_type</span><span class="op" id="1567046">,</span>&nbsp;<span class="ident" id="1567048">e</span>&nbsp;<span class="keyword" id="1567050">interface</span><span class="op" id="1567059">{</span><span class="op" id="1567060">}</span><span class="op" id="1567061">)</span>&nbsp;<span class="op" id="1567063">(</span><span class="ident" id="1567064">r</span>&nbsp;<span class="builtintype" id="1567066">byte</span><span class="op" id="1567070">)</span>&nbsp;<span class="op" id="1567072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567075">ep</span>&nbsp;<span class="op" id="1567078">:=</span>&nbsp;<span class="op" id="1567081">(</span><span class="op" id="1567082">*</span><span class="ident" id="1567083">eface</span><span class="op" id="1567088">)</span><span class="op" id="1567089">(</span><span class="ident" id="1567090">unsafe</span><span class="op" id="1567096">.</span><span class="ident" id="1567097">Pointer</span><span class="op" id="1567104">(</span><span class="op" id="1567105">&amp;</span><span class="ident" id="1567106">e</span><span class="op" id="1567107">)</span><span class="op" id="1567108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567111">size</span>&nbsp;<span class="op" id="1567116">:=</span>&nbsp;<span class="builtintype" id="1567119">uintptr</span><span class="op" id="1567126">(</span><span class="ident" id="1567127">t</span><span class="op" id="1567128">.</span><span class="ident" id="1567129">size</span><span class="op" id="1567133">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567136">ok</span>&nbsp;<span class="op" id="1567139">:=</span>&nbsp;<span class="op" id="1567142">(</span><span class="op" id="1567143">*</span><span class="builtintype" id="1567144">bool</span><span class="op" id="1567148">)</span><span class="op" id="1567149">(</span><span class="ident" id="1567150">add</span><span class="op" id="1567153">(</span><span class="ident" id="1567154">unsafe</span><span class="op" id="1567160">.</span><span class="ident" id="1567161">Pointer</span><span class="op" id="1567168">(</span><span class="op" id="1567169">&amp;</span><span class="ident" id="1567170">r</span><span class="op" id="1567171">)</span><span class="op" id="1567172">,</span>&nbsp;<span class="ident" id="1567174">size</span><span class="op" id="1567178">)</span><span class="op" id="1567179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567182">if</span>&nbsp;<span class="ident" id="1567185">ep</span><span class="op" id="1567187">.</span><span class="ident" id="1567188">_type</span>&nbsp;<span class="op" id="1567194">!=</span>&nbsp;<span class="ident" id="1567197">t</span>&nbsp;<span class="op" id="1567199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567203">*</span><span class="ident" id="1567204">ok</span>&nbsp;<span class="op" id="1567207">=</span>&nbsp;<span class="ident" id="1567209">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567217">memclr</span><span class="op" id="1567223">(</span><span class="ident" id="1567224">unsafe</span><span class="op" id="1567230">.</span><span class="ident" id="1567231">Pointer</span><span class="op" id="1567238">(</span><span class="op" id="1567239">&amp;</span><span class="ident" id="1567240">r</span><span class="op" id="1567241">)</span><span class="op" id="1567242">,</span>&nbsp;<span class="ident" id="1567244">size</span><span class="op" id="1567248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567252">return</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567263">*</span><span class="ident" id="1567264">ok</span>&nbsp;<span class="op" id="1567267">=</span>&nbsp;<span class="ident" id="1567269">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567275">if</span>&nbsp;<span class="ident" id="1567278">isDirectIface</span><span class="op" id="1567291">(</span><span class="ident" id="1567292">t</span><span class="op" id="1567293">)</span>&nbsp;<span class="op" id="1567295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567299">memmove</span><span class="op" id="1567306">(</span><span class="ident" id="1567307">unsafe</span><span class="op" id="1567313">.</span><span class="ident" id="1567314">Pointer</span><span class="op" id="1567321">(</span><span class="op" id="1567322">&amp;</span><span class="ident" id="1567323">r</span><span class="op" id="1567324">)</span><span class="op" id="1567325">,</span>&nbsp;<span class="ident" id="1567327">unsafe</span><span class="op" id="1567333">.</span><span class="ident" id="1567334">Pointer</span><span class="op" id="1567341">(</span><span class="op" id="1567342">&amp;</span><span class="ident" id="1567343">ep</span><span class="op" id="1567345">.</span><span class="ident" id="1567346">data</span><span class="op" id="1567350">)</span><span class="op" id="1567351">,</span>&nbsp;<span class="ident" id="1567353">size</span><span class="op" id="1567357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567360">}</span>&nbsp;<span class="keyword" id="1567362">else</span>&nbsp;<span class="op" id="1567367">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567371">memmove</span><span class="op" id="1567378">(</span><span class="ident" id="1567379">unsafe</span><span class="op" id="1567385">.</span><span class="ident" id="1567386">Pointer</span><span class="op" id="1567393">(</span><span class="op" id="1567394">&amp;</span><span class="ident" id="1567395">r</span><span class="op" id="1567396">)</span><span class="op" id="1567397">,</span>&nbsp;<span class="ident" id="1567399">ep</span><span class="op" id="1567401">.</span><span class="ident" id="1567402">data</span><span class="op" id="1567406">,</span>&nbsp;<span class="ident" id="1567408">size</span><span class="op" id="1567412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567418">return</span><br>
<span class="lineno"></span><span class="op" id="1567425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="1567428">func</span>&nbsp;<span class="ident" id="1567433">assertE2TOK</span><span class="op" id="1567444">(</span><span class="ident" id="1567445">t</span>&nbsp;<span class="op" id="1567447">*</span><span class="ident" id="1567448">_type</span><span class="op" id="1567453">,</span>&nbsp;<span class="ident" id="1567455">e</span>&nbsp;<span class="keyword" id="1567457">interface</span><span class="op" id="1567466">{</span><span class="op" id="1567467">}</span><span class="op" id="1567468">)</span>&nbsp;<span class="builtintype" id="1567470">bool</span>&nbsp;<span class="op" id="1567475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567478">ep</span>&nbsp;<span class="op" id="1567481">:=</span>&nbsp;<span class="op" id="1567484">(</span><span class="op" id="1567485">*</span><span class="ident" id="1567486">eface</span><span class="op" id="1567491">)</span><span class="op" id="1567492">(</span><span class="ident" id="1567493">unsafe</span><span class="op" id="1567499">.</span><span class="ident" id="1567500">Pointer</span><span class="op" id="1567507">(</span><span class="op" id="1567508">&amp;</span><span class="ident" id="1567509">e</span><span class="op" id="1567510">)</span><span class="op" id="1567511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567514">return</span>&nbsp;<span class="ident" id="1567521">t</span>&nbsp;<span class="op" id="1567523">==</span>&nbsp;<span class="ident" id="1567526">ep</span><span class="op" id="1567528">.</span><span class="ident" id="1567529">_type</span><br>
<span class="lineno"></span><span class="op" id="1567535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="1567538">func</span>&nbsp;<span class="ident" id="1567543">convI2E</span><span class="op" id="1567550">(</span><span class="ident" id="1567551">i</span>&nbsp;<span class="ident" id="1567553">fInterface</span><span class="op" id="1567563">)</span>&nbsp;<span class="op" id="1567565">(</span><span class="ident" id="1567566">r</span>&nbsp;<span class="keyword" id="1567568">interface</span><span class="op" id="1567577">{</span><span class="op" id="1567578">}</span><span class="op" id="1567579">)</span>&nbsp;<span class="op" id="1567581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567584">ip</span>&nbsp;<span class="op" id="1567587">:=</span>&nbsp;<span class="op" id="1567590">(</span><span class="op" id="1567591">*</span><span class="ident" id="1567592">iface</span><span class="op" id="1567597">)</span><span class="op" id="1567598">(</span><span class="ident" id="1567599">unsafe</span><span class="op" id="1567605">.</span><span class="ident" id="1567606">Pointer</span><span class="op" id="1567613">(</span><span class="op" id="1567614">&amp;</span><span class="ident" id="1567615">i</span><span class="op" id="1567616">)</span><span class="op" id="1567617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567620">tab</span>&nbsp;<span class="op" id="1567624">:=</span>&nbsp;<span class="ident" id="1567627">ip</span><span class="op" id="1567629">.</span><span class="ident" id="1567630">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567635">if</span>&nbsp;<span class="ident" id="1567638">tab</span>&nbsp;<span class="op" id="1567642">==</span>&nbsp;<span class="ident" id="1567645">nil</span>&nbsp;<span class="op" id="1567649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567653">return</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567664">rp</span>&nbsp;<span class="op" id="1567667">:=</span>&nbsp;<span class="op" id="1567670">(</span><span class="op" id="1567671">*</span><span class="ident" id="1567672">eface</span><span class="op" id="1567677">)</span><span class="op" id="1567678">(</span><span class="ident" id="1567679">unsafe</span><span class="op" id="1567685">.</span><span class="ident" id="1567686">Pointer</span><span class="op" id="1567693">(</span><span class="op" id="1567694">&amp;</span><span class="ident" id="1567695">r</span><span class="op" id="1567696">)</span><span class="op" id="1567697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567700">rp</span><span class="op" id="1567702">.</span><span class="ident" id="1567703">_type</span>&nbsp;<span class="op" id="1567709">=</span>&nbsp;<span class="ident" id="1567711">tab</span><span class="op" id="1567714">.</span><span class="ident" id="1567715">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567722">rp</span><span class="op" id="1567724">.</span><span class="ident" id="1567725">data</span>&nbsp;<span class="op" id="1567730">=</span>&nbsp;<span class="ident" id="1567732">ip</span><span class="op" id="1567734">.</span><span class="ident" id="1567735">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567741">return</span><br>
<span class="lineno">270</span><span class="op" id="1567748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1567751">func</span>&nbsp;<span class="ident" id="1567756">assertI2E</span><span class="op" id="1567765">(</span><span class="ident" id="1567766">inter</span>&nbsp;<span class="op" id="1567772">*</span><span class="ident" id="1567773">interfacetype</span><span class="op" id="1567786">,</span>&nbsp;<span class="ident" id="1567788">i</span>&nbsp;<span class="ident" id="1567790">fInterface</span><span class="op" id="1567800">)</span>&nbsp;<span class="op" id="1567802">(</span><span class="ident" id="1567803">r</span>&nbsp;<span class="keyword" id="1567805">interface</span><span class="op" id="1567814">{</span><span class="op" id="1567815">}</span><span class="op" id="1567816">)</span>&nbsp;<span class="op" id="1567818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567821">ip</span>&nbsp;<span class="op" id="1567824">:=</span>&nbsp;<span class="op" id="1567827">(</span><span class="op" id="1567828">*</span><span class="ident" id="1567829">iface</span><span class="op" id="1567834">)</span><span class="op" id="1567835">(</span><span class="ident" id="1567836">unsafe</span><span class="op" id="1567842">.</span><span class="ident" id="1567843">Pointer</span><span class="op" id="1567850">(</span><span class="op" id="1567851">&amp;</span><span class="ident" id="1567852">i</span><span class="op" id="1567853">)</span><span class="op" id="1567854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567857">tab</span>&nbsp;<span class="op" id="1567861">:=</span>&nbsp;<span class="ident" id="1567864">ip</span><span class="op" id="1567866">.</span><span class="ident" id="1567867">tab</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567872">if</span>&nbsp;<span class="ident" id="1567875">tab</span>&nbsp;<span class="op" id="1567879">==</span>&nbsp;<span class="ident" id="1567882">nil</span>&nbsp;<span class="op" id="1567886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1567890">//&nbsp;explicit&nbsp;conversions&nbsp;require&nbsp;non-nil&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1567949">panic</span><span class="op" id="1567954">(</span><span class="op" id="1567955">&amp;</span><span class="ident" id="1567956">TypeAssertionError</span><span class="op" id="1567974">{</span><span class="string" id="1567975">&#34;&#34;</span><span class="op" id="1567977">,</span>&nbsp;<span class="string" id="1567979">&#34;&#34;</span><span class="op" id="1567981">,</span>&nbsp;<span class="op" id="1567983">*</span><span class="ident" id="1567984">inter</span><span class="op" id="1567989">.</span><span class="ident" id="1567990">typ</span><span class="op" id="1567993">.</span><span class="ident" id="1567994">_string</span><span class="op" id="1568001">,</span>&nbsp;<span class="string" id="1568003">&#34;&#34;</span><span class="op" id="1568005">}</span><span class="op" id="1568006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568012">rp</span>&nbsp;<span class="op" id="1568015">:=</span>&nbsp;<span class="op" id="1568018">(</span><span class="op" id="1568019">*</span><span class="ident" id="1568020">eface</span><span class="op" id="1568025">)</span><span class="op" id="1568026">(</span><span class="ident" id="1568027">unsafe</span><span class="op" id="1568033">.</span><span class="ident" id="1568034">Pointer</span><span class="op" id="1568041">(</span><span class="op" id="1568042">&amp;</span><span class="ident" id="1568043">r</span><span class="op" id="1568044">)</span><span class="op" id="1568045">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568048">rp</span><span class="op" id="1568050">.</span><span class="ident" id="1568051">_type</span>&nbsp;<span class="op" id="1568057">=</span>&nbsp;<span class="ident" id="1568059">tab</span><span class="op" id="1568062">.</span><span class="ident" id="1568063">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568070">rp</span><span class="op" id="1568072">.</span><span class="ident" id="1568073">data</span>&nbsp;<span class="op" id="1568078">=</span>&nbsp;<span class="ident" id="1568080">ip</span><span class="op" id="1568082">.</span><span class="ident" id="1568083">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568089">return</span><br>
<span class="lineno"></span><span class="op" id="1568096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="1568099">func</span>&nbsp;<span class="ident" id="1568104">assertI2E2</span><span class="op" id="1568114">(</span><span class="ident" id="1568115">inter</span>&nbsp;<span class="op" id="1568121">*</span><span class="ident" id="1568122">interfacetype</span><span class="op" id="1568135">,</span>&nbsp;<span class="ident" id="1568137">i</span>&nbsp;<span class="ident" id="1568139">fInterface</span><span class="op" id="1568149">)</span>&nbsp;<span class="op" id="1568151">(</span><span class="ident" id="1568152">r</span>&nbsp;<span class="keyword" id="1568154">interface</span><span class="op" id="1568163">{</span><span class="op" id="1568164">}</span><span class="op" id="1568165">,</span>&nbsp;<span class="ident" id="1568167">ok</span>&nbsp;<span class="builtintype" id="1568170">bool</span><span class="op" id="1568174">)</span>&nbsp;<span class="op" id="1568176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568179">ip</span>&nbsp;<span class="op" id="1568182">:=</span>&nbsp;<span class="op" id="1568185">(</span><span class="op" id="1568186">*</span><span class="ident" id="1568187">iface</span><span class="op" id="1568192">)</span><span class="op" id="1568193">(</span><span class="ident" id="1568194">unsafe</span><span class="op" id="1568200">.</span><span class="ident" id="1568201">Pointer</span><span class="op" id="1568208">(</span><span class="op" id="1568209">&amp;</span><span class="ident" id="1568210">i</span><span class="op" id="1568211">)</span><span class="op" id="1568212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568215">tab</span>&nbsp;<span class="op" id="1568219">:=</span>&nbsp;<span class="ident" id="1568222">ip</span><span class="op" id="1568224">.</span><span class="ident" id="1568225">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568230">if</span>&nbsp;<span class="ident" id="1568233">tab</span>&nbsp;<span class="op" id="1568237">==</span>&nbsp;<span class="ident" id="1568240">nil</span>&nbsp;<span class="op" id="1568244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568248">return</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568259">rp</span>&nbsp;<span class="op" id="1568262">:=</span>&nbsp;<span class="op" id="1568265">(</span><span class="op" id="1568266">*</span><span class="ident" id="1568267">eface</span><span class="op" id="1568272">)</span><span class="op" id="1568273">(</span><span class="ident" id="1568274">unsafe</span><span class="op" id="1568280">.</span><span class="ident" id="1568281">Pointer</span><span class="op" id="1568288">(</span><span class="op" id="1568289">&amp;</span><span class="ident" id="1568290">r</span><span class="op" id="1568291">)</span><span class="op" id="1568292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568295">rp</span><span class="op" id="1568297">.</span><span class="ident" id="1568298">_type</span>&nbsp;<span class="op" id="1568304">=</span>&nbsp;<span class="ident" id="1568306">tab</span><span class="op" id="1568309">.</span><span class="ident" id="1568310">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568317">rp</span><span class="op" id="1568319">.</span><span class="ident" id="1568320">data</span>&nbsp;<span class="op" id="1568325">=</span>&nbsp;<span class="ident" id="1568327">ip</span><span class="op" id="1568329">.</span><span class="ident" id="1568330">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568336">ok</span>&nbsp;<span class="op" id="1568339">=</span>&nbsp;<span class="ident" id="1568341">true</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568347">return</span><br>
<span class="lineno"></span><span class="op" id="1568354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1568357">func</span>&nbsp;<span class="ident" id="1568362">convI2I</span><span class="op" id="1568369">(</span><span class="ident" id="1568370">inter</span>&nbsp;<span class="op" id="1568376">*</span><span class="ident" id="1568377">interfacetype</span><span class="op" id="1568390">,</span>&nbsp;<span class="ident" id="1568392">i</span>&nbsp;<span class="ident" id="1568394">fInterface</span><span class="op" id="1568404">)</span>&nbsp;<span class="op" id="1568406">(</span><span class="ident" id="1568407">r</span>&nbsp;<span class="ident" id="1568409">fInterface</span><span class="op" id="1568419">)</span>&nbsp;<span class="op" id="1568421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568424">ip</span>&nbsp;<span class="op" id="1568427">:=</span>&nbsp;<span class="op" id="1568430">(</span><span class="op" id="1568431">*</span><span class="ident" id="1568432">iface</span><span class="op" id="1568437">)</span><span class="op" id="1568438">(</span><span class="ident" id="1568439">unsafe</span><span class="op" id="1568445">.</span><span class="ident" id="1568446">Pointer</span><span class="op" id="1568453">(</span><span class="op" id="1568454">&amp;</span><span class="ident" id="1568455">i</span><span class="op" id="1568456">)</span><span class="op" id="1568457">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568460">tab</span>&nbsp;<span class="op" id="1568464">:=</span>&nbsp;<span class="ident" id="1568467">ip</span><span class="op" id="1568469">.</span><span class="ident" id="1568470">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568475">if</span>&nbsp;<span class="ident" id="1568478">tab</span>&nbsp;<span class="op" id="1568482">==</span>&nbsp;<span class="ident" id="1568485">nil</span>&nbsp;<span class="op" id="1568489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568504">rp</span>&nbsp;<span class="op" id="1568507">:=</span>&nbsp;<span class="op" id="1568510">(</span><span class="op" id="1568511">*</span><span class="ident" id="1568512">iface</span><span class="op" id="1568517">)</span><span class="op" id="1568518">(</span><span class="ident" id="1568519">unsafe</span><span class="op" id="1568525">.</span><span class="ident" id="1568526">Pointer</span><span class="op" id="1568533">(</span><span class="op" id="1568534">&amp;</span><span class="ident" id="1568535">r</span><span class="op" id="1568536">)</span><span class="op" id="1568537">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568540">if</span>&nbsp;<span class="ident" id="1568543">tab</span><span class="op" id="1568546">.</span><span class="ident" id="1568547">inter</span>&nbsp;<span class="op" id="1568553">==</span>&nbsp;<span class="ident" id="1568556">inter</span>&nbsp;<span class="op" id="1568562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568566">rp</span><span class="op" id="1568568">.</span><span class="ident" id="1568569">tab</span>&nbsp;<span class="op" id="1568573">=</span>&nbsp;<span class="ident" id="1568575">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568581">rp</span><span class="op" id="1568583">.</span><span class="ident" id="1568584">data</span>&nbsp;<span class="op" id="1568589">=</span>&nbsp;<span class="ident" id="1568591">ip</span><span class="op" id="1568593">.</span><span class="ident" id="1568594">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568609">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568612">rp</span><span class="op" id="1568614">.</span><span class="ident" id="1568615">tab</span>&nbsp;<span class="op" id="1568619">=</span>&nbsp;<span class="ident" id="1568621">getitab</span><span class="op" id="1568628">(</span><span class="ident" id="1568629">inter</span><span class="op" id="1568634">,</span>&nbsp;<span class="ident" id="1568636">tab</span><span class="op" id="1568639">.</span><span class="ident" id="1568640">_type</span><span class="op" id="1568645">,</span>&nbsp;<span class="ident" id="1568647">false</span><span class="op" id="1568652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568655">rp</span><span class="op" id="1568657">.</span><span class="ident" id="1568658">data</span>&nbsp;<span class="op" id="1568663">=</span>&nbsp;<span class="ident" id="1568665">ip</span><span class="op" id="1568667">.</span><span class="ident" id="1568668">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568674">return</span><br>
<span class="lineno"></span><span class="op" id="1568681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="keyword" id="1568684">func</span>&nbsp;<span class="ident" id="1568689">assertI2I</span><span class="op" id="1568698">(</span><span class="ident" id="1568699">inter</span>&nbsp;<span class="op" id="1568705">*</span><span class="ident" id="1568706">interfacetype</span><span class="op" id="1568719">,</span>&nbsp;<span class="ident" id="1568721">i</span>&nbsp;<span class="ident" id="1568723">fInterface</span><span class="op" id="1568733">)</span>&nbsp;<span class="op" id="1568735">(</span><span class="ident" id="1568736">r</span>&nbsp;<span class="ident" id="1568738">fInterface</span><span class="op" id="1568748">)</span>&nbsp;<span class="op" id="1568750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568753">ip</span>&nbsp;<span class="op" id="1568756">:=</span>&nbsp;<span class="op" id="1568759">(</span><span class="op" id="1568760">*</span><span class="ident" id="1568761">iface</span><span class="op" id="1568766">)</span><span class="op" id="1568767">(</span><span class="ident" id="1568768">unsafe</span><span class="op" id="1568774">.</span><span class="ident" id="1568775">Pointer</span><span class="op" id="1568782">(</span><span class="op" id="1568783">&amp;</span><span class="ident" id="1568784">i</span><span class="op" id="1568785">)</span><span class="op" id="1568786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568789">tab</span>&nbsp;<span class="op" id="1568793">:=</span>&nbsp;<span class="ident" id="1568796">ip</span><span class="op" id="1568798">.</span><span class="ident" id="1568799">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568804">if</span>&nbsp;<span class="ident" id="1568807">tab</span>&nbsp;<span class="op" id="1568811">==</span>&nbsp;<span class="ident" id="1568814">nil</span>&nbsp;<span class="op" id="1568818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1568822">//&nbsp;explicit&nbsp;conversions&nbsp;require&nbsp;non-nil&nbsp;interface&nbsp;value.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1568881">panic</span><span class="op" id="1568886">(</span><span class="op" id="1568887">&amp;</span><span class="ident" id="1568888">TypeAssertionError</span><span class="op" id="1568906">{</span><span class="string" id="1568907">&#34;&#34;</span><span class="op" id="1568909">,</span>&nbsp;<span class="string" id="1568911">&#34;&#34;</span><span class="op" id="1568913">,</span>&nbsp;<span class="op" id="1568915">*</span><span class="ident" id="1568916">inter</span><span class="op" id="1568921">.</span><span class="ident" id="1568922">typ</span><span class="op" id="1568925">.</span><span class="ident" id="1568926">_string</span><span class="op" id="1568933">,</span>&nbsp;<span class="string" id="1568935">&#34;&#34;</span><span class="op" id="1568937">}</span><span class="op" id="1568938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568944">rp</span>&nbsp;<span class="op" id="1568947">:=</span>&nbsp;<span class="op" id="1568950">(</span><span class="op" id="1568951">*</span><span class="ident" id="1568952">iface</span><span class="op" id="1568957">)</span><span class="op" id="1568958">(</span><span class="ident" id="1568959">unsafe</span><span class="op" id="1568965">.</span><span class="ident" id="1568966">Pointer</span><span class="op" id="1568973">(</span><span class="op" id="1568974">&amp;</span><span class="ident" id="1568975">r</span><span class="op" id="1568976">)</span><span class="op" id="1568977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568980">if</span>&nbsp;<span class="ident" id="1568983">tab</span><span class="op" id="1568986">.</span><span class="ident" id="1568987">inter</span>&nbsp;<span class="op" id="1568993">==</span>&nbsp;<span class="ident" id="1568996">inter</span>&nbsp;<span class="op" id="1569002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569006">rp</span><span class="op" id="1569008">.</span><span class="ident" id="1569009">tab</span>&nbsp;<span class="op" id="1569013">=</span>&nbsp;<span class="ident" id="1569015">tab</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569021">rp</span><span class="op" id="1569023">.</span><span class="ident" id="1569024">data</span>&nbsp;<span class="op" id="1569029">=</span>&nbsp;<span class="ident" id="1569031">ip</span><span class="op" id="1569033">.</span><span class="ident" id="1569034">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569041">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1569049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569052">rp</span><span class="op" id="1569054">.</span><span class="ident" id="1569055">tab</span>&nbsp;<span class="op" id="1569059">=</span>&nbsp;<span class="ident" id="1569061">getitab</span><span class="op" id="1569068">(</span><span class="ident" id="1569069">inter</span><span class="op" id="1569074">,</span>&nbsp;<span class="ident" id="1569076">tab</span><span class="op" id="1569079">.</span><span class="ident" id="1569080">_type</span><span class="op" id="1569085">,</span>&nbsp;<span class="ident" id="1569087">false</span><span class="op" id="1569092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569095">rp</span><span class="op" id="1569097">.</span><span class="ident" id="1569098">data</span>&nbsp;<span class="op" id="1569103">=</span>&nbsp;<span class="ident" id="1569105">ip</span><span class="op" id="1569107">.</span><span class="ident" id="1569108">data</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569114">return</span><br>
<span class="lineno"></span><span class="op" id="1569121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1569124">func</span>&nbsp;<span class="ident" id="1569129">assertI2I2</span><span class="op" id="1569139">(</span><span class="ident" id="1569140">inter</span>&nbsp;<span class="op" id="1569146">*</span><span class="ident" id="1569147">interfacetype</span><span class="op" id="1569160">,</span>&nbsp;<span class="ident" id="1569162">i</span>&nbsp;<span class="ident" id="1569164">fInterface</span><span class="op" id="1569174">)</span>&nbsp;<span class="op" id="1569176">(</span><span class="ident" id="1569177">r</span>&nbsp;<span class="ident" id="1569179">fInterface</span><span class="op" id="1569189">,</span>&nbsp;<span class="ident" id="1569191">ok</span>&nbsp;<span class="builtintype" id="1569194">bool</span><span class="op" id="1569198">)</span>&nbsp;<span class="op" id="1569200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569203">ip</span>&nbsp;<span class="op" id="1569206">:=</span>&nbsp;<span class="op" id="1569209">(</span><span class="op" id="1569210">*</span><span class="ident" id="1569211">iface</span><span class="op" id="1569216">)</span><span class="op" id="1569217">(</span><span class="ident" id="1569218">unsafe</span><span class="op" id="1569224">.</span><span class="ident" id="1569225">Pointer</span><span class="op" id="1569232">(</span><span class="op" id="1569233">&amp;</span><span class="ident" id="1569234">i</span><span class="op" id="1569235">)</span><span class="op" id="1569236">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569239">tab</span>&nbsp;<span class="op" id="1569243">:=</span>&nbsp;<span class="ident" id="1569246">ip</span><span class="op" id="1569248">.</span><span class="ident" id="1569249">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569254">if</span>&nbsp;<span class="ident" id="1569257">tab</span>&nbsp;<span class="op" id="1569261">==</span>&nbsp;<span class="ident" id="1569264">nil</span>&nbsp;<span class="op" id="1569268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569272">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1569280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569283">rp</span>&nbsp;<span class="op" id="1569286">:=</span>&nbsp;<span class="op" id="1569289">(</span><span class="op" id="1569290">*</span><span class="ident" id="1569291">iface</span><span class="op" id="1569296">)</span><span class="op" id="1569297">(</span><span class="ident" id="1569298">unsafe</span><span class="op" id="1569304">.</span><span class="ident" id="1569305">Pointer</span><span class="op" id="1569312">(</span><span class="op" id="1569313">&amp;</span><span class="ident" id="1569314">r</span><span class="op" id="1569315">)</span><span class="op" id="1569316">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569319">if</span>&nbsp;<span class="ident" id="1569322">tab</span><span class="op" id="1569325">.</span><span class="ident" id="1569326">inter</span>&nbsp;<span class="op" id="1569332">==</span>&nbsp;<span class="ident" id="1569335">inter</span>&nbsp;<span class="op" id="1569341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569345">rp</span><span class="op" id="1569347">.</span><span class="ident" id="1569348">tab</span>&nbsp;<span class="op" id="1569352">=</span>&nbsp;<span class="ident" id="1569354">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569360">rp</span><span class="op" id="1569362">.</span><span class="ident" id="1569363">data</span>&nbsp;<span class="op" id="1569368">=</span>&nbsp;<span class="ident" id="1569370">ip</span><span class="op" id="1569372">.</span><span class="ident" id="1569373">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569380">ok</span>&nbsp;<span class="op" id="1569383">=</span>&nbsp;<span class="ident" id="1569385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569392">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1569400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569403">tab</span>&nbsp;<span class="op" id="1569407">=</span>&nbsp;<span class="ident" id="1569409">getitab</span><span class="op" id="1569416">(</span><span class="ident" id="1569417">inter</span><span class="op" id="1569422">,</span>&nbsp;<span class="ident" id="1569424">tab</span><span class="op" id="1569427">.</span><span class="ident" id="1569428">_type</span><span class="op" id="1569433">,</span>&nbsp;<span class="ident" id="1569435">true</span><span class="op" id="1569439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569442">if</span>&nbsp;<span class="ident" id="1569445">tab</span>&nbsp;<span class="op" id="1569449">==</span>&nbsp;<span class="ident" id="1569452">nil</span>&nbsp;<span class="op" id="1569456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569460">rp</span><span class="op" id="1569462">.</span><span class="ident" id="1569463">data</span>&nbsp;<span class="op" id="1569468">=</span>&nbsp;<span class="ident" id="1569470">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569476">rp</span><span class="op" id="1569478">.</span><span class="ident" id="1569479">tab</span>&nbsp;<span class="op" id="1569483">=</span>&nbsp;<span class="ident" id="1569485">nil</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569491">ok</span>&nbsp;<span class="op" id="1569494">=</span>&nbsp;<span class="ident" id="1569496">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569504">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1569512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569515">rp</span><span class="op" id="1569517">.</span><span class="ident" id="1569518">tab</span>&nbsp;<span class="op" id="1569522">=</span>&nbsp;<span class="ident" id="1569524">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569529">rp</span><span class="op" id="1569531">.</span><span class="ident" id="1569532">data</span>&nbsp;<span class="op" id="1569537">=</span>&nbsp;<span class="ident" id="1569539">ip</span><span class="op" id="1569541">.</span><span class="ident" id="1569542">data</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569548">ok</span>&nbsp;<span class="op" id="1569551">=</span>&nbsp;<span class="ident" id="1569553">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569559">return</span><br>
<span class="lineno"></span><span class="op" id="1569566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1569569">func</span>&nbsp;<span class="ident" id="1569574">assertE2I</span><span class="op" id="1569583">(</span><span class="ident" id="1569584">inter</span>&nbsp;<span class="op" id="1569590">*</span><span class="ident" id="1569591">interfacetype</span><span class="op" id="1569604">,</span>&nbsp;<span class="ident" id="1569606">e</span>&nbsp;<span class="keyword" id="1569608">interface</span><span class="op" id="1569617">{</span><span class="op" id="1569618">}</span><span class="op" id="1569619">)</span>&nbsp;<span class="op" id="1569621">(</span><span class="ident" id="1569622">r</span>&nbsp;<span class="ident" id="1569624">fInterface</span><span class="op" id="1569634">)</span>&nbsp;<span class="op" id="1569636">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569639">ep</span>&nbsp;<span class="op" id="1569642">:=</span>&nbsp;<span class="op" id="1569645">(</span><span class="op" id="1569646">*</span><span class="ident" id="1569647">eface</span><span class="op" id="1569652">)</span><span class="op" id="1569653">(</span><span class="ident" id="1569654">unsafe</span><span class="op" id="1569660">.</span><span class="ident" id="1569661">Pointer</span><span class="op" id="1569668">(</span><span class="op" id="1569669">&amp;</span><span class="ident" id="1569670">e</span><span class="op" id="1569671">)</span><span class="op" id="1569672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569675">t</span>&nbsp;<span class="op" id="1569677">:=</span>&nbsp;<span class="ident" id="1569680">ep</span><span class="op" id="1569682">.</span><span class="ident" id="1569683">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569690">if</span>&nbsp;<span class="ident" id="1569693">t</span>&nbsp;<span class="op" id="1569695">==</span>&nbsp;<span class="ident" id="1569698">nil</span>&nbsp;<span class="op" id="1569702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1569706">//&nbsp;explicit&nbsp;conversions&nbsp;require&nbsp;non-nil&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1569765">panic</span><span class="op" id="1569770">(</span><span class="op" id="1569771">&amp;</span><span class="ident" id="1569772">TypeAssertionError</span><span class="op" id="1569790">{</span><span class="string" id="1569791">&#34;&#34;</span><span class="op" id="1569793">,</span>&nbsp;<span class="string" id="1569795">&#34;&#34;</span><span class="op" id="1569797">,</span>&nbsp;<span class="op" id="1569799">*</span><span class="ident" id="1569800">inter</span><span class="op" id="1569805">.</span><span class="ident" id="1569806">typ</span><span class="op" id="1569809">.</span><span class="ident" id="1569810">_string</span><span class="op" id="1569817">,</span>&nbsp;<span class="string" id="1569819">&#34;&#34;</span><span class="op" id="1569821">}</span><span class="op" id="1569822">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1569825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569828">rp</span>&nbsp;<span class="op" id="1569831">:=</span>&nbsp;<span class="op" id="1569834">(</span><span class="op" id="1569835">*</span><span class="ident" id="1569836">iface</span><span class="op" id="1569841">)</span><span class="op" id="1569842">(</span><span class="ident" id="1569843">unsafe</span><span class="op" id="1569849">.</span><span class="ident" id="1569850">Pointer</span><span class="op" id="1569857">(</span><span class="op" id="1569858">&amp;</span><span class="ident" id="1569859">r</span><span class="op" id="1569860">)</span><span class="op" id="1569861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569864">rp</span><span class="op" id="1569866">.</span><span class="ident" id="1569867">tab</span>&nbsp;<span class="op" id="1569871">=</span>&nbsp;<span class="ident" id="1569873">getitab</span><span class="op" id="1569880">(</span><span class="ident" id="1569881">inter</span><span class="op" id="1569886">,</span>&nbsp;<span class="ident" id="1569888">t</span><span class="op" id="1569889">,</span>&nbsp;<span class="ident" id="1569891">false</span><span class="op" id="1569896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1569899">rp</span><span class="op" id="1569901">.</span><span class="ident" id="1569902">data</span>&nbsp;<span class="op" id="1569907">=</span>&nbsp;<span class="ident" id="1569909">ep</span><span class="op" id="1569911">.</span><span class="ident" id="1569912">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1569918">return</span><br>
<span class="lineno">370</span><span class="op" id="1569925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1569928">func</span>&nbsp;<span class="ident" id="1569933">assertE2I2</span><span class="op" id="1569943">(</span><span class="ident" id="1569944">inter</span>&nbsp;<span class="op" id="1569950">*</span><span class="ident" id="1569951">interfacetype</span><span class="op" id="1569964">,</span>&nbsp;<span class="ident" id="1569966">e</span>&nbsp;<span class="keyword" id="1569968">interface</span><span class="op" id="1569977">{</span><span class="op" id="1569978">}</span><span class="op" id="1569979">)</span>&nbsp;<span class="op" id="1569981">(</span><span class="ident" id="1569982">r</span>&nbsp;<span class="ident" id="1569984">fInterface</span><span class="op" id="1569994">,</span>&nbsp;<span class="ident" id="1569996">ok</span>&nbsp;<span class="builtintype" id="1569999">bool</span><span class="op" id="1570003">)</span>&nbsp;<span class="op" id="1570005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570008">ep</span>&nbsp;<span class="op" id="1570011">:=</span>&nbsp;<span class="op" id="1570014">(</span><span class="op" id="1570015">*</span><span class="ident" id="1570016">eface</span><span class="op" id="1570021">)</span><span class="op" id="1570022">(</span><span class="ident" id="1570023">unsafe</span><span class="op" id="1570029">.</span><span class="ident" id="1570030">Pointer</span><span class="op" id="1570037">(</span><span class="op" id="1570038">&amp;</span><span class="ident" id="1570039">e</span><span class="op" id="1570040">)</span><span class="op" id="1570041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570044">t</span>&nbsp;<span class="op" id="1570046">:=</span>&nbsp;<span class="ident" id="1570049">ep</span><span class="op" id="1570051">.</span><span class="ident" id="1570052">_type</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570059">if</span>&nbsp;<span class="ident" id="1570062">t</span>&nbsp;<span class="op" id="1570064">==</span>&nbsp;<span class="ident" id="1570067">nil</span>&nbsp;<span class="op" id="1570071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570086">tab</span>&nbsp;<span class="op" id="1570090">:=</span>&nbsp;<span class="ident" id="1570093">getitab</span><span class="op" id="1570100">(</span><span class="ident" id="1570101">inter</span><span class="op" id="1570106">,</span>&nbsp;<span class="ident" id="1570108">t</span><span class="op" id="1570109">,</span>&nbsp;<span class="ident" id="1570111">true</span><span class="op" id="1570115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570118">if</span>&nbsp;<span class="ident" id="1570121">tab</span>&nbsp;<span class="op" id="1570125">==</span>&nbsp;<span class="ident" id="1570128">nil</span>&nbsp;<span class="op" id="1570132">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570136">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570147">rp</span>&nbsp;<span class="op" id="1570150">:=</span>&nbsp;<span class="op" id="1570153">(</span><span class="op" id="1570154">*</span><span class="ident" id="1570155">iface</span><span class="op" id="1570160">)</span><span class="op" id="1570161">(</span><span class="ident" id="1570162">unsafe</span><span class="op" id="1570168">.</span><span class="ident" id="1570169">Pointer</span><span class="op" id="1570176">(</span><span class="op" id="1570177">&amp;</span><span class="ident" id="1570178">r</span><span class="op" id="1570179">)</span><span class="op" id="1570180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570183">rp</span><span class="op" id="1570185">.</span><span class="ident" id="1570186">tab</span>&nbsp;<span class="op" id="1570190">=</span>&nbsp;<span class="ident" id="1570192">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570197">rp</span><span class="op" id="1570199">.</span><span class="ident" id="1570200">data</span>&nbsp;<span class="op" id="1570205">=</span>&nbsp;<span class="ident" id="1570207">ep</span><span class="op" id="1570209">.</span><span class="ident" id="1570210">data</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570216">ok</span>&nbsp;<span class="op" id="1570219">=</span>&nbsp;<span class="ident" id="1570221">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570227">return</span><br>
<span class="lineno"></span><span class="op" id="1570234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1570237">func</span>&nbsp;<span class="ident" id="1570242">reflect_ifaceE2I</span><span class="op" id="1570258">(</span><span class="ident" id="1570259">inter</span>&nbsp;<span class="op" id="1570265">*</span><span class="ident" id="1570266">interfacetype</span><span class="op" id="1570279">,</span>&nbsp;<span class="ident" id="1570281">e</span>&nbsp;<span class="keyword" id="1570283">interface</span><span class="op" id="1570292">{</span><span class="op" id="1570293">}</span><span class="op" id="1570294">,</span>&nbsp;<span class="ident" id="1570296">dst</span>&nbsp;<span class="op" id="1570300">*</span><span class="ident" id="1570301">fInterface</span><span class="op" id="1570311">)</span>&nbsp;<span class="op" id="1570313">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570316">*</span><span class="ident" id="1570317">dst</span>&nbsp;<span class="op" id="1570321">=</span>&nbsp;<span class="ident" id="1570323">assertE2I</span><span class="op" id="1570332">(</span><span class="ident" id="1570333">inter</span><span class="op" id="1570338">,</span>&nbsp;<span class="ident" id="1570340">e</span><span class="op" id="1570341">)</span><br>
<span class="lineno"></span><span class="op" id="1570343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1570346">func</span>&nbsp;<span class="ident" id="1570351">assertE2E</span><span class="op" id="1570360">(</span><span class="ident" id="1570361">inter</span>&nbsp;<span class="op" id="1570367">*</span><span class="ident" id="1570368">interfacetype</span><span class="op" id="1570381">,</span>&nbsp;<span class="ident" id="1570383">e</span>&nbsp;<span class="keyword" id="1570385">interface</span><span class="op" id="1570394">{</span><span class="op" id="1570395">}</span><span class="op" id="1570396">)</span>&nbsp;<span class="keyword" id="1570398">interface</span><span class="op" id="1570407">{</span><span class="op" id="1570408">}</span>&nbsp;<span class="op" id="1570410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570413">ep</span>&nbsp;<span class="op" id="1570416">:=</span>&nbsp;<span class="op" id="1570419">(</span><span class="op" id="1570420">*</span><span class="ident" id="1570421">eface</span><span class="op" id="1570426">)</span><span class="op" id="1570427">(</span><span class="ident" id="1570428">unsafe</span><span class="op" id="1570434">.</span><span class="ident" id="1570435">Pointer</span><span class="op" id="1570442">(</span><span class="op" id="1570443">&amp;</span><span class="ident" id="1570444">e</span><span class="op" id="1570445">)</span><span class="op" id="1570446">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570449">if</span>&nbsp;<span class="ident" id="1570452">ep</span><span class="op" id="1570454">.</span><span class="ident" id="1570455">_type</span>&nbsp;<span class="op" id="1570461">==</span>&nbsp;<span class="ident" id="1570464">nil</span>&nbsp;<span class="op" id="1570468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1570472">//&nbsp;explicit&nbsp;conversions&nbsp;require&nbsp;non-nil&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1570531">panic</span><span class="op" id="1570536">(</span><span class="op" id="1570537">&amp;</span><span class="ident" id="1570538">TypeAssertionError</span><span class="op" id="1570556">{</span><span class="string" id="1570557">&#34;&#34;</span><span class="op" id="1570559">,</span>&nbsp;<span class="string" id="1570561">&#34;&#34;</span><span class="op" id="1570563">,</span>&nbsp;<span class="op" id="1570565">*</span><span class="ident" id="1570566">inter</span><span class="op" id="1570571">.</span><span class="ident" id="1570572">typ</span><span class="op" id="1570575">.</span><span class="ident" id="1570576">_string</span><span class="op" id="1570583">,</span>&nbsp;<span class="string" id="1570585">&#34;&#34;</span><span class="op" id="1570587">}</span><span class="op" id="1570588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570594">return</span>&nbsp;<span class="ident" id="1570601">e</span><br>
<span class="lineno">400</span><span class="op" id="1570603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1570606">func</span>&nbsp;<span class="ident" id="1570611">assertE2E2</span><span class="op" id="1570621">(</span><span class="ident" id="1570622">inter</span>&nbsp;<span class="op" id="1570628">*</span><span class="ident" id="1570629">interfacetype</span><span class="op" id="1570642">,</span>&nbsp;<span class="ident" id="1570644">e</span>&nbsp;<span class="keyword" id="1570646">interface</span><span class="op" id="1570655">{</span><span class="op" id="1570656">}</span><span class="op" id="1570657">)</span>&nbsp;<span class="op" id="1570659">(</span><span class="keyword" id="1570660">interface</span><span class="op" id="1570669">{</span><span class="op" id="1570670">}</span><span class="op" id="1570671">,</span>&nbsp;<span class="builtintype" id="1570673">bool</span><span class="op" id="1570677">)</span>&nbsp;<span class="op" id="1570679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570682">ep</span>&nbsp;<span class="op" id="1570685">:=</span>&nbsp;<span class="op" id="1570688">(</span><span class="op" id="1570689">*</span><span class="ident" id="1570690">eface</span><span class="op" id="1570695">)</span><span class="op" id="1570696">(</span><span class="ident" id="1570697">unsafe</span><span class="op" id="1570703">.</span><span class="ident" id="1570704">Pointer</span><span class="op" id="1570711">(</span><span class="op" id="1570712">&amp;</span><span class="ident" id="1570713">e</span><span class="op" id="1570714">)</span><span class="op" id="1570715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570718">if</span>&nbsp;<span class="ident" id="1570721">ep</span><span class="op" id="1570723">.</span><span class="ident" id="1570724">_type</span>&nbsp;<span class="op" id="1570730">==</span>&nbsp;<span class="ident" id="1570733">nil</span>&nbsp;<span class="op" id="1570737">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570741">return</span>&nbsp;<span class="ident" id="1570748">nil</span><span class="op" id="1570751">,</span>&nbsp;<span class="ident" id="1570753">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570763">return</span>&nbsp;<span class="ident" id="1570770">e</span><span class="op" id="1570771">,</span>&nbsp;<span class="ident" id="1570773">true</span><br>
<span class="lineno"></span><span class="op" id="1570778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="1570781">func</span>&nbsp;<span class="ident" id="1570786">ifacethash</span><span class="op" id="1570796">(</span><span class="ident" id="1570797">i</span>&nbsp;<span class="ident" id="1570799">fInterface</span><span class="op" id="1570809">)</span>&nbsp;<span class="builtintype" id="1570811">uint32</span>&nbsp;<span class="op" id="1570818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570821">ip</span>&nbsp;<span class="op" id="1570824">:=</span>&nbsp;<span class="op" id="1570827">(</span><span class="op" id="1570828">*</span><span class="ident" id="1570829">iface</span><span class="op" id="1570834">)</span><span class="op" id="1570835">(</span><span class="ident" id="1570836">unsafe</span><span class="op" id="1570842">.</span><span class="ident" id="1570843">Pointer</span><span class="op" id="1570850">(</span><span class="op" id="1570851">&amp;</span><span class="ident" id="1570852">i</span><span class="op" id="1570853">)</span><span class="op" id="1570854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570857">tab</span>&nbsp;<span class="op" id="1570861">:=</span>&nbsp;<span class="ident" id="1570864">ip</span><span class="op" id="1570866">.</span><span class="ident" id="1570867">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570872">if</span>&nbsp;<span class="ident" id="1570875">tab</span>&nbsp;<span class="op" id="1570879">==</span>&nbsp;<span class="ident" id="1570882">nil</span>&nbsp;<span class="op" id="1570886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570890">return</span>&nbsp;<span class="num" id="1570897">0</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1570900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1570903">return</span>&nbsp;<span class="ident" id="1570910">tab</span><span class="op" id="1570913">.</span><span class="ident" id="1570914">_type</span><span class="op" id="1570919">.</span><span class="ident" id="1570920">hash</span><br>
<span class="lineno"></span><span class="op" id="1570925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1570928">func</span>&nbsp;<span class="ident" id="1570933">efacethash</span><span class="op" id="1570943">(</span><span class="ident" id="1570944">e</span>&nbsp;<span class="keyword" id="1570946">interface</span><span class="op" id="1570955">{</span><span class="op" id="1570956">}</span><span class="op" id="1570957">)</span>&nbsp;<span class="builtintype" id="1570959">uint32</span>&nbsp;<span class="op" id="1570966">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1570969">ep</span>&nbsp;<span class="op" id="1570972">:=</span>&nbsp;<span class="op" id="1570975">(</span><span class="op" id="1570976">*</span><span class="ident" id="1570977">eface</span><span class="op" id="1570982">)</span><span class="op" id="1570983">(</span><span class="ident" id="1570984">unsafe</span><span class="op" id="1570990">.</span><span class="ident" id="1570991">Pointer</span><span class="op" id="1570998">(</span><span class="op" id="1570999">&amp;</span><span class="ident" id="1571000">e</span><span class="op" id="1571001">)</span><span class="op" id="1571002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1571005">t</span>&nbsp;<span class="op" id="1571007">:=</span>&nbsp;<span class="ident" id="1571010">ep</span><span class="op" id="1571012">.</span><span class="ident" id="1571013">_type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571020">if</span>&nbsp;<span class="ident" id="1571023">t</span>&nbsp;<span class="op" id="1571025">==</span>&nbsp;<span class="ident" id="1571028">nil</span>&nbsp;<span class="op" id="1571032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571036">return</span>&nbsp;<span class="num" id="1571043">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1571046">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571049">return</span>&nbsp;<span class="ident" id="1571056">t</span><span class="op" id="1571057">.</span><span class="ident" id="1571058">hash</span><br>
<span class="lineno"></span><span class="op" id="1571063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1571066">func</span>&nbsp;<span class="ident" id="1571071">iterate_itabs</span><span class="op" id="1571084">(</span><span class="ident" id="1571085">fn</span>&nbsp;<span class="keyword" id="1571088">func</span><span class="op" id="1571092">(</span><span class="op" id="1571093">*</span><span class="ident" id="1571094">itab</span><span class="op" id="1571098">)</span><span class="op" id="1571099">)</span>&nbsp;<span class="op" id="1571101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571104">for</span>&nbsp;<span class="ident" id="1571108">_</span><span class="op" id="1571109">,</span>&nbsp;<span class="ident" id="1571111">h</span>&nbsp;<span class="op" id="1571113">:=</span>&nbsp;<span class="keyword" id="1571116">range</span>&nbsp;<span class="op" id="1571122">&amp;</span><span class="ident" id="1571123">hash</span>&nbsp;<span class="op" id="1571128">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571132">for</span>&nbsp;<span class="op" id="1571136">;</span>&nbsp;<span class="ident" id="1571138">h</span>&nbsp;<span class="op" id="1571140">!=</span>&nbsp;<span class="ident" id="1571143">nil</span><span class="op" id="1571146">;</span>&nbsp;<span class="ident" id="1571148">h</span>&nbsp;<span class="op" id="1571150">=</span>&nbsp;<span class="ident" id="1571152">h</span><span class="op" id="1571153">.</span><span class="ident" id="1571154">link</span>&nbsp;<span class="op" id="1571159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1571164">fn</span><span class="op" id="1571166">(</span><span class="ident" id="1571167">h</span><span class="op" id="1571168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1571172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1571175">}</span><br>
<span class="lineno"></span><span class="op" id="1571177">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="1571180">func</span>&nbsp;<span class="ident" id="1571185">ifaceE2I2</span><span class="op" id="1571194">(</span><span class="ident" id="1571195">inter</span>&nbsp;<span class="op" id="1571201">*</span><span class="ident" id="1571202">interfacetype</span><span class="op" id="1571215">,</span>&nbsp;<span class="ident" id="1571217">e</span>&nbsp;<span class="keyword" id="1571219">interface</span><span class="op" id="1571228">{</span><span class="op" id="1571229">}</span><span class="op" id="1571230">,</span>&nbsp;<span class="ident" id="1571232">r</span>&nbsp;<span class="op" id="1571234">*</span><span class="ident" id="1571235">fInterface</span><span class="op" id="1571245">)</span>&nbsp;<span class="op" id="1571247">(</span><span class="ident" id="1571248">ok</span>&nbsp;<span class="builtintype" id="1571251">bool</span><span class="op" id="1571255">)</span>&nbsp;<span class="op" id="1571257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1571260">*</span><span class="ident" id="1571261">r</span><span class="op" id="1571262">,</span>&nbsp;<span class="ident" id="1571264">ok</span>&nbsp;<span class="op" id="1571267">=</span>&nbsp;<span class="ident" id="1571269">assertE2I2</span><span class="op" id="1571279">(</span><span class="ident" id="1571280">inter</span><span class="op" id="1571285">,</span>&nbsp;<span class="ident" id="1571287">e</span><span class="op" id="1571288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1571291">return</span><br>
<span class="lineno"></span><span class="op" id="1571298">}</span>
</div>
</body>
</html>
