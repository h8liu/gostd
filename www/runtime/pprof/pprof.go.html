<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4621710">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4621766">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4621820">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4621871">//&nbsp;Package&nbsp;pprof&nbsp;writes&nbsp;runtime&nbsp;profiling&nbsp;data&nbsp;in&nbsp;the&nbsp;format&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4621941">//&nbsp;by&nbsp;the&nbsp;pprof&nbsp;visualization&nbsp;tool.</span><br>
<span class="lineno"></span><span class="comment" id="4621977">//&nbsp;For&nbsp;more&nbsp;information&nbsp;about&nbsp;pprof,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="4622018">//&nbsp;http://code.google.com/p/google-perftools/.</span><br>
<span class="lineno"></span><span class="keyword" id="4622065">package</span>&nbsp;<span class="ident" id="4622073">pprof</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4622080">import</span>&nbsp;<span class="op" id="4622087">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622090">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622099">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622108">&#34;fmt&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622115">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622121">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622132">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622140">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622151">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4622159">&#34;text/tabwriter&#34;</span><br>
<span class="lineno"></span><span class="op" id="4622176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4622179">//&nbsp;BUG(rsc):&nbsp;Profiles&nbsp;are&nbsp;incomplete&nbsp;and&nbsp;inaccurate&nbsp;on&nbsp;NetBSD&nbsp;and&nbsp;OS&nbsp;X.</span><br>
<span class="lineno"></span><span class="comment" id="4622251">//&nbsp;See&nbsp;http://golang.org/issue/6047&nbsp;for&nbsp;details.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4622301">//&nbsp;A&nbsp;Profile&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;stack&nbsp;traces&nbsp;showing&nbsp;the&nbsp;call&nbsp;sequences</span><br>
<span class="lineno"></span><span class="comment" id="4622373">//&nbsp;that&nbsp;led&nbsp;to&nbsp;instances&nbsp;of&nbsp;a&nbsp;particular&nbsp;event,&nbsp;such&nbsp;as&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="comment" id="4622441">//&nbsp;Packages&nbsp;can&nbsp;create&nbsp;and&nbsp;maintain&nbsp;their&nbsp;own&nbsp;profiles;&nbsp;the&nbsp;most&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4622513">//&nbsp;use&nbsp;is&nbsp;for&nbsp;tracking&nbsp;resources&nbsp;that&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;closed,&nbsp;such&nbsp;as&nbsp;files</span><br>
<span class="lineno">30</span><span class="comment" id="4622592">//&nbsp;or&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="comment" id="4622619">//</span><br>
<span class="lineno"></span><span class="comment" id="4622622">//&nbsp;A&nbsp;Profile&#39;s&nbsp;methods&nbsp;can&nbsp;be&nbsp;called&nbsp;from&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="4622700">//</span><br>
<span class="lineno"></span><span class="comment" id="4622703">//&nbsp;Each&nbsp;Profile&nbsp;has&nbsp;a&nbsp;unique&nbsp;name.&nbsp;&nbsp;A&nbsp;few&nbsp;profiles&nbsp;are&nbsp;predefined:</span><br>
<span class="lineno">35</span><span class="comment" id="4622770">//</span><br>
<span class="lineno"></span><span class="comment" id="4622773">//&nbsp;&nbsp;&nbsp;&nbspgoroutine&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;of&nbsp;all&nbsp;current&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="4622830">//&nbsp;&nbsp;&nbsp;&nbspheap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;sampling&nbsp;of&nbsp;all&nbsp;heap&nbsp;allocations</span><br>
<span class="lineno"></span><span class="comment" id="4622883">//&nbsp;&nbsp;&nbsp;&nbspthreadcreate&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;the&nbsp;creation&nbsp;of&nbsp;new&nbsp;OS&nbsp;threads</span><br>
<span class="lineno"></span><span class="comment" id="4622957">//&nbsp;&nbsp;&nbsp;&nbspblock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;blocking&nbsp;on&nbsp;synchronization&nbsp;primitives</span><br>
<span class="lineno">40</span><span class="comment" id="4623039">//</span><br>
<span class="lineno"></span><span class="comment" id="4623042">//&nbsp;These&nbsp;predefined&nbsp;profiles&nbsp;maintain&nbsp;themselves&nbsp;and&nbsp;panic&nbsp;on&nbsp;an&nbsp;explicit</span><br>
<span class="lineno"></span><span class="comment" id="4623116">//&nbsp;Add&nbsp;or&nbsp;Remove&nbsp;method&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="4623146">//</span><br>
<span class="lineno"></span><span class="comment" id="4623149">//&nbsp;The&nbsp;CPU&nbsp;profile&nbsp;is&nbsp;not&nbsp;available&nbsp;as&nbsp;a&nbsp;Profile.&nbsp;&nbsp;It&nbsp;has&nbsp;a&nbsp;special&nbsp;API,</span><br>
<span class="lineno">45</span><span class="comment" id="4623222">//&nbsp;the&nbsp;StartCPUProfile&nbsp;and&nbsp;StopCPUProfile&nbsp;functions,&nbsp;because&nbsp;it&nbsp;streams</span><br>
<span class="lineno"></span><span class="comment" id="4623294">//&nbsp;output&nbsp;to&nbsp;a&nbsp;writer&nbsp;during&nbsp;profiling.</span><br>
<span class="lineno"></span><span class="comment" id="4623334">//</span><br>
<span class="lineno"></span><span class="keyword" id="4623337">type</span>&nbsp;<span class="ident" id="4623342">Profile</span>&nbsp;<span class="keyword" id="4623350">struct</span>&nbsp;<span class="op" id="4623357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623360">name</span>&nbsp;&nbsp;<span class="builtintype" id="4623366">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623374">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623380"><a href="/runtime/pprof/pprof.go.html#4622151">sync</a></span><span class="op" id="4623384">.</span><span class="ident" id="4623385">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623392">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623398">map</span><span class="op" id="4623401">[</span><span class="keyword" id="4623402">interface</span><span class="op" id="4623411">{</span><span class="op" id="4623412">}</span><span class="op" id="4623413">]</span><span class="op" id="4623414">[</span><span class="op" id="4623415">]</span><span class="builtintype" id="4623416">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623425">count</span>&nbsp;<span class="keyword" id="4623431">func</span><span class="op" id="4623435">(</span><span class="op" id="4623436">)</span>&nbsp;<span class="builtintype" id="4623438">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623443">write</span>&nbsp;<span class="keyword" id="4623449">func</span><span class="op" id="4623453">(</span><span class="ident" id="4623454"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4623456">.</span><span class="ident" id="4623457">Writer</span><span class="op" id="4623463">,</span>&nbsp;<span class="builtintype" id="4623465">int</span><span class="op" id="4623468">)</span>&nbsp;<span class="builtintype" id="4623470">error</span><br>
<span class="lineno"></span><span class="op" id="4623476">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4623479">//&nbsp;profiles&nbsp;records&nbsp;all&nbsp;registered&nbsp;profiles.</span><br>
<span class="lineno"></span><span class="keyword" id="4623524">var</span>&nbsp;<span class="ident" id="4623528">profiles</span>&nbsp;<span class="keyword" id="4623537">struct</span>&nbsp;<span class="op" id="4623544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623547">mu</span>&nbsp;<span class="ident" id="4623550"><a href="/runtime/pprof/pprof.go.html#4622151">sync</a></span><span class="op" id="4623554">.</span><span class="ident" id="4623555">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623562">m</span>&nbsp;&nbsp;<span class="keyword" id="4623565">map</span><span class="op" id="4623568">[</span><span class="builtintype" id="4623569">string</span><span class="op" id="4623575">]</span><span class="op" id="4623576">*</span><span class="ident" id="4623577"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><br>
<span class="lineno">60</span><span class="op" id="4623585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4623588">var</span>&nbsp;<span class="ident" id="4623592">goroutineProfile</span>&nbsp;<span class="op" id="4623609">=</span>&nbsp;<span class="op" id="4623611">&amp;</span><span class="ident" id="4623612"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4623619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623622">name</span><span class="op" id="4623626">:</span>&nbsp;&nbsp;<span class="string" id="4623629">&#34;goroutine&#34;</span><span class="op" id="4623640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623643">count</span><span class="op" id="4623648">:</span>&nbsp;<span class="ident" id="4623650"><a href="/runtime/pprof/pprof.go.html#4635684">countGoroutine</a></span><span class="op" id="4623664">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623667">write</span><span class="op" id="4623672">:</span>&nbsp;<span class="ident" id="4623674"><a href="/runtime/pprof/pprof.go.html#4635814">writeGoroutine</a></span><span class="op" id="4623688">,</span><br>
<span class="lineno"></span><span class="op" id="4623690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4623693">var</span>&nbsp;<span class="ident" id="4623697">threadcreateProfile</span>&nbsp;<span class="op" id="4623717">=</span>&nbsp;<span class="op" id="4623719">&amp;</span><span class="ident" id="4623720"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4623727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623730">name</span><span class="op" id="4623734">:</span>&nbsp;&nbsp;<span class="string" id="4623737">&#34;threadcreate&#34;</span><span class="op" id="4623751">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623754">count</span><span class="op" id="4623759">:</span>&nbsp;<span class="ident" id="4623761"><a href="/runtime/pprof/pprof.go.html#4635331">countThreadCreate</a></span><span class="op" id="4623778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623781">write</span><span class="op" id="4623786">:</span>&nbsp;<span class="ident" id="4623788"><a href="/runtime/pprof/pprof.go.html#4635491">writeThreadCreate</a></span><span class="op" id="4623805">,</span><br>
<span class="lineno"></span><span class="op" id="4623807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4623810">var</span>&nbsp;<span class="ident" id="4623814">heapProfile</span>&nbsp;<span class="op" id="4623826">=</span>&nbsp;<span class="op" id="4623828">&amp;</span><span class="ident" id="4623829"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4623836">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623839">name</span><span class="op" id="4623843">:</span>&nbsp;&nbsp;<span class="string" id="4623846">&#34;heap&#34;</span><span class="op" id="4623852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623855">count</span><span class="op" id="4623860">:</span>&nbsp;<span class="ident" id="4623862"><a href="/runtime/pprof/pprof.go.html#4631981">countHeap</a></span><span class="op" id="4623871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623874">write</span><span class="op" id="4623879">:</span>&nbsp;<span class="ident" id="4623881"><a href="/runtime/pprof/pprof.go.html#4632115">writeHeap</a></span><span class="op" id="4623890">,</span><br>
<span class="lineno"></span><span class="op" id="4623892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4623895">var</span>&nbsp;<span class="ident" id="4623899">blockProfile</span>&nbsp;<span class="op" id="4623912">=</span>&nbsp;<span class="op" id="4623914">&amp;</span><span class="ident" id="4623915"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4623922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623925">name</span><span class="op" id="4623929">:</span>&nbsp;&nbsp;<span class="string" id="4623932">&#34;block&#34;</span><span class="op" id="4623939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623942">count</span><span class="op" id="4623947">:</span>&nbsp;<span class="ident" id="4623949"><a href="/runtime/pprof/pprof.go.html#4639429">countBlock</a></span><span class="op" id="4623959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4623962">write</span><span class="op" id="4623967">:</span>&nbsp;<span class="ident" id="4623969"><a href="/runtime/pprof/pprof.go.html#4639557">writeBlock</a></span><span class="op" id="4623979">,</span><br>
<span class="lineno"></span><span class="op" id="4623981">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4623984">func</span>&nbsp;<span class="ident" id="4623989">lockProfiles</span><span class="op" id="4624001">(</span><span class="op" id="4624002">)</span>&nbsp;<span class="op" id="4624004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624007"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624015">.</span><span class="ident" id="4624016">mu</span><span class="op" id="4624018">.</span><span class="ident" id="4624019">Lock</span><span class="op" id="4624023">(</span><span class="op" id="4624024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624027">if</span>&nbsp;<span class="ident" id="4624030"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624038">.</span><span class="ident" id="4624039">m</span>&nbsp;<span class="op" id="4624041">==</span>&nbsp;<span class="ident" id="4624044">nil</span>&nbsp;<span class="op" id="4624048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624052">//&nbsp;Initial&nbsp;built-in&nbsp;profiles.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624084"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624092">.</span><span class="ident" id="4624093">m</span>&nbsp;<span class="op" id="4624095">=</span>&nbsp;<span class="keyword" id="4624097">map</span><span class="op" id="4624100">[</span><span class="builtintype" id="4624101">string</span><span class="op" id="4624107">]</span><span class="op" id="4624108">*</span><span class="ident" id="4624109"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4624116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624121">&#34;goroutine&#34;</span><span class="op" id="4624132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624137"><a href="/runtime/pprof/pprof.go.html#4623592">goroutineProfile</a></span><span class="op" id="4624153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624158">&#34;threadcreate&#34;</span><span class="op" id="4624172">:</span>&nbsp;<span class="ident" id="4624174"><a href="/runtime/pprof/pprof.go.html#4623697">threadcreateProfile</a></span><span class="op" id="4624193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624198">&#34;heap&#34;</span><span class="op" id="4624204">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624214"><a href="/runtime/pprof/pprof.go.html#4623814">heapProfile</a></span><span class="op" id="4624225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4624230">&#34;block&#34;</span><span class="op" id="4624237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624246"><a href="/runtime/pprof/pprof.go.html#4623899">blockProfile</a></span><span class="op" id="4624258">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624265">}</span><br>
<span class="lineno"></span><span class="op" id="4624267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4624270">func</span>&nbsp;<span class="ident" id="4624275">unlockProfiles</span><span class="op" id="4624289">(</span><span class="op" id="4624290">)</span>&nbsp;<span class="op" id="4624292">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624295"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624303">.</span><span class="ident" id="4624304">mu</span><span class="op" id="4624306">.</span><span class="ident" id="4624307">Unlock</span><span class="op" id="4624313">(</span><span class="op" id="4624314">)</span><br>
<span class="lineno"></span><span class="op" id="4624316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4624319">//&nbsp;NewProfile&nbsp;creates&nbsp;a&nbsp;new&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4624376">//&nbsp;If&nbsp;a&nbsp;profile&nbsp;with&nbsp;that&nbsp;name&nbsp;already&nbsp;exists,&nbsp;NewProfile&nbsp;panics.</span><br>
<span class="lineno">105</span><span class="comment" id="4624442">//&nbsp;The&nbsp;convention&nbsp;is&nbsp;to&nbsp;use&nbsp;a&nbsp;&#39;import/path.&#39;&nbsp;prefix&nbsp;to&nbsp;create</span><br>
<span class="lineno"></span><span class="comment" id="4624504">//&nbsp;separate&nbsp;name&nbsp;spaces&nbsp;for&nbsp;each&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4624546">func</span>&nbsp;<span class="ident" id="4624551">NewProfile</span><span class="op" id="4624561">(</span><span class="ident" id="4624562">name</span>&nbsp;<span class="builtintype" id="4624567">string</span><span class="op" id="4624573">)</span>&nbsp;<span class="op" id="4624575">*</span><span class="ident" id="4624576"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span>&nbsp;<span class="op" id="4624584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624587"><a href="/runtime/pprof/pprof.go.html#4623989">lockProfiles</a></span><span class="op" id="4624599">(</span><span class="op" id="4624600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624603">defer</span>&nbsp;<span class="ident" id="4624609"><a href="/runtime/pprof/pprof.go.html#4624275">unlockProfiles</a></span><span class="op" id="4624623">(</span><span class="op" id="4624624">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624627">if</span>&nbsp;<span class="ident" id="4624630"><a href="/runtime/pprof/pprof.go.html#4624562">name</a></span>&nbsp;<span class="op" id="4624635">==</span>&nbsp;<span class="string" id="4624638">&#34;&#34;</span>&nbsp;<span class="op" id="4624641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4624645">panic</span><span class="op" id="4624650">(</span><span class="string" id="4624651">&#34;pprof:&nbsp;NewProfile&nbsp;with&nbsp;empty&nbsp;name&#34;</span><span class="op" id="4624686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624692">if</span>&nbsp;<span class="ident" id="4624695"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624703">.</span><span class="ident" id="4624704">m</span><span class="op" id="4624705">[</span><span class="ident" id="4624706"><a href="/runtime/pprof/pprof.go.html#4624562">name</a></span><span class="op" id="4624710">]</span>&nbsp;<span class="op" id="4624712">!=</span>&nbsp;<span class="ident" id="4624715">nil</span>&nbsp;<span class="op" id="4624719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4624723">panic</span><span class="op" id="4624728">(</span><span class="string" id="4624729">&#34;pprof:&nbsp;NewProfile&nbsp;name&nbsp;already&nbsp;in&nbsp;use:&nbsp;&#34;</span>&nbsp;<span class="op" id="4624771">+</span>&nbsp;<span class="ident" id="4624773"><a href="/runtime/pprof/pprof.go.html#4624562">name</a></span><span class="op" id="4624777">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624783">p</span>&nbsp;<span class="op" id="4624785">:=</span>&nbsp;<span class="op" id="4624788">&amp;</span><span class="ident" id="4624789"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4624796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624800">name</span><span class="op" id="4624804">:</span>&nbsp;<span class="ident" id="4624806"><a href="/runtime/pprof/pprof.go.html#4624562">name</a></span><span class="op" id="4624810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624814">m</span><span class="op" id="4624815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624820">map</span><span class="op" id="4624823">[</span><span class="keyword" id="4624824">interface</span><span class="op" id="4624833">{</span><span class="op" id="4624834">}</span><span class="op" id="4624835">]</span><span class="op" id="4624836">[</span><span class="op" id="4624837">]</span><span class="builtintype" id="4624838">uintptr</span><span class="op" id="4624845">{</span><span class="op" id="4624846">}</span><span class="op" id="4624847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624850">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624853"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4624861">.</span><span class="ident" id="4624862">m</span><span class="op" id="4624863">[</span><span class="ident" id="4624864"><a href="/runtime/pprof/pprof.go.html#4624562">name</a></span><span class="op" id="4624868">]</span>&nbsp;<span class="op" id="4624870">=</span>&nbsp;<span class="ident" id="4624872"><a href="/runtime/pprof/pprof.go.html#4624783">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624875">return</span>&nbsp;<span class="ident" id="4624882"><a href="/runtime/pprof/pprof.go.html#4624783">p</a></span><br>
<span class="lineno"></span><span class="op" id="4624884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4624887">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such&nbsp;profile&nbsp;exists.</span><br>
<span class="lineno">125</span><span class="keyword" id="4624972">func</span>&nbsp;<span class="ident" id="4624977">Lookup</span><span class="op" id="4624983">(</span><span class="ident" id="4624984">name</span>&nbsp;<span class="builtintype" id="4624989">string</span><span class="op" id="4624995">)</span>&nbsp;<span class="op" id="4624997">*</span><span class="ident" id="4624998"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span>&nbsp;<span class="op" id="4625006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625009"><a href="/runtime/pprof/pprof.go.html#4623989">lockProfiles</a></span><span class="op" id="4625021">(</span><span class="op" id="4625022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625025">defer</span>&nbsp;<span class="ident" id="4625031"><a href="/runtime/pprof/pprof.go.html#4624275">unlockProfiles</a></span><span class="op" id="4625045">(</span><span class="op" id="4625046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625049">return</span>&nbsp;<span class="ident" id="4625056"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4625064">.</span><span class="ident" id="4625065">m</span><span class="op" id="4625066">[</span><span class="ident" id="4625067"><a href="/runtime/pprof/pprof.go.html#4624984">name</a></span><span class="op" id="4625071">]</span><br>
<span class="lineno"></span><span class="op" id="4625073">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4625076">//&nbsp;Profiles&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;known&nbsp;profiles,&nbsp;sorted&nbsp;by&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4625147">func</span>&nbsp;<span class="ident" id="4625152">Profiles</span><span class="op" id="4625160">(</span><span class="op" id="4625161">)</span>&nbsp;<span class="op" id="4625163">[</span><span class="op" id="4625164">]</span><span class="op" id="4625165">*</span><span class="ident" id="4625166"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span>&nbsp;<span class="op" id="4625174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625177"><a href="/runtime/pprof/pprof.go.html#4623989">lockProfiles</a></span><span class="op" id="4625189">(</span><span class="op" id="4625190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625193">defer</span>&nbsp;<span class="ident" id="4625199"><a href="/runtime/pprof/pprof.go.html#4624275">unlockProfiles</a></span><span class="op" id="4625213">(</span><span class="op" id="4625214">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625218">var</span>&nbsp;<span class="ident" id="4625222">all</span>&nbsp;<span class="op" id="4625226">[</span><span class="op" id="4625227">]</span><span class="op" id="4625228">*</span><span class="ident" id="4625229"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625238">for</span>&nbsp;<span class="ident" id="4625242">_</span><span class="op" id="4625243">,</span>&nbsp;<span class="ident" id="4625245">p</span>&nbsp;<span class="op" id="4625247">:=</span>&nbsp;<span class="keyword" id="4625250">range</span>&nbsp;<span class="ident" id="4625256"><a href="/runtime/pprof/pprof.go.html#4623528">profiles</a></span><span class="op" id="4625264">.</span><span class="ident" id="4625265">m</span>&nbsp;<span class="op" id="4625267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625271"><a href="/runtime/pprof/pprof.go.html#4625222">all</a></span>&nbsp;<span class="op" id="4625275">=</span>&nbsp;<span class="builtinfunc" id="4625277">append</span><span class="op" id="4625283">(</span><span class="ident" id="4625284"><a href="/runtime/pprof/pprof.go.html#4625222">all</a></span><span class="op" id="4625287">,</span>&nbsp;<span class="ident" id="4625289"><a href="/runtime/pprof/pprof.go.html#4625245">p</a></span><span class="op" id="4625290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625293">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625297"><a href="/runtime/pprof/pprof.go.html#4622132">sort</a></span><span class="op" id="4625301">.</span><span class="ident" id="4625302">Sort</span><span class="op" id="4625306">(</span><span class="ident" id="4625307"><a href="/runtime/pprof/pprof.go.html#4625340">byName</a></span><span class="op" id="4625313">(</span><span class="ident" id="4625314"><a href="/runtime/pprof/pprof.go.html#4625222">all</a></span><span class="op" id="4625317">)</span><span class="op" id="4625318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625321">return</span>&nbsp;<span class="ident" id="4625328"><a href="/runtime/pprof/pprof.go.html#4625222">all</a></span><br>
<span class="lineno"></span><span class="op" id="4625332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="4625335">type</span>&nbsp;<span class="ident" id="4625340">byName</span>&nbsp;<span class="op" id="4625347">[</span><span class="op" id="4625348">]</span><span class="op" id="4625349">*</span><span class="ident" id="4625350"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4625359">func</span>&nbsp;<span class="op" id="4625364">(</span><span class="ident" id="4625365">x</span>&nbsp;<span class="ident" id="4625367"><a href="/runtime/pprof/pprof.go.html#4625340">byName</a></span><span class="op" id="4625373">)</span>&nbsp;<span class="ident" id="4625375">Len</span><span class="op" id="4625378">(</span><span class="op" id="4625379">)</span>&nbsp;<span class="builtintype" id="4625381">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625395">{</span>&nbsp;<span class="keyword" id="4625397">return</span>&nbsp;<span class="builtinfunc" id="4625404">len</span><span class="op" id="4625407">(</span><span class="ident" id="4625408"><a href="/runtime/pprof/pprof.go.html#4625365">x</a></span><span class="op" id="4625409">)</span>&nbsp;<span class="op" id="4625411">}</span><br>
<span class="lineno"></span><span class="keyword" id="4625413">func</span>&nbsp;<span class="op" id="4625418">(</span><span class="ident" id="4625419">x</span>&nbsp;<span class="ident" id="4625421"><a href="/runtime/pprof/pprof.go.html#4625340">byName</a></span><span class="op" id="4625427">)</span>&nbsp;<span class="ident" id="4625429">Swap</span><span class="op" id="4625433">(</span><span class="ident" id="4625434">i</span><span class="op" id="4625435">,</span>&nbsp;<span class="ident" id="4625437">j</span>&nbsp;<span class="builtintype" id="4625439">int</span><span class="op" id="4625442">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625449">{</span>&nbsp;<span class="ident" id="4625451"><a href="/runtime/pprof/pprof.go.html#4625419">x</a></span><span class="op" id="4625452">[</span><span class="ident" id="4625453"><a href="/runtime/pprof/pprof.go.html#4625434">i</a></span><span class="op" id="4625454">]</span><span class="op" id="4625455">,</span>&nbsp;<span class="ident" id="4625457"><a href="/runtime/pprof/pprof.go.html#4625419">x</a></span><span class="op" id="4625458">[</span><span class="ident" id="4625459"><a href="/runtime/pprof/pprof.go.html#4625437">j</a></span><span class="op" id="4625460">]</span>&nbsp;<span class="op" id="4625462">=</span>&nbsp;<span class="ident" id="4625464"><a href="/runtime/pprof/pprof.go.html#4625419">x</a></span><span class="op" id="4625465">[</span><span class="ident" id="4625466"><a href="/runtime/pprof/pprof.go.html#4625437">j</a></span><span class="op" id="4625467">]</span><span class="op" id="4625468">,</span>&nbsp;<span class="ident" id="4625470"><a href="/runtime/pprof/pprof.go.html#4625419">x</a></span><span class="op" id="4625471">[</span><span class="ident" id="4625472"><a href="/runtime/pprof/pprof.go.html#4625434">i</a></span><span class="op" id="4625473">]</span>&nbsp;<span class="op" id="4625475">}</span><br>
<span class="lineno"></span><span class="keyword" id="4625477">func</span>&nbsp;<span class="op" id="4625482">(</span><span class="ident" id="4625483">x</span>&nbsp;<span class="ident" id="4625485"><a href="/runtime/pprof/pprof.go.html#4625340">byName</a></span><span class="op" id="4625491">)</span>&nbsp;<span class="ident" id="4625493">Less</span><span class="op" id="4625497">(</span><span class="ident" id="4625498">i</span><span class="op" id="4625499">,</span>&nbsp;<span class="ident" id="4625501">j</span>&nbsp;<span class="builtintype" id="4625503">int</span><span class="op" id="4625506">)</span>&nbsp;<span class="builtintype" id="4625508">bool</span>&nbsp;<span class="op" id="4625513">{</span>&nbsp;<span class="keyword" id="4625515">return</span>&nbsp;<span class="ident" id="4625522"><a href="/runtime/pprof/pprof.go.html#4625483">x</a></span><span class="op" id="4625523">[</span><span class="ident" id="4625524"><a href="/runtime/pprof/pprof.go.html#4625498">i</a></span><span class="op" id="4625525">]</span><span class="op" id="4625526">.</span><span class="ident" id="4625527">name</span>&nbsp;<span class="op" id="4625532">&lt;</span>&nbsp;<span class="ident" id="4625534"><a href="/runtime/pprof/pprof.go.html#4625483">x</a></span><span class="op" id="4625535">[</span><span class="ident" id="4625536"><a href="/runtime/pprof/pprof.go.html#4625501">j</a></span><span class="op" id="4625537">]</span><span class="op" id="4625538">.</span><span class="ident" id="4625539">name</span>&nbsp;<span class="op" id="4625544">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="4625547">//&nbsp;Name&nbsp;returns&nbsp;this&nbsp;profile&#39;s&nbsp;name,&nbsp;which&nbsp;can&nbsp;be&nbsp;passed&nbsp;to&nbsp;Lookup&nbsp;to&nbsp;reobtain&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4625639">func</span>&nbsp;<span class="op" id="4625644">(</span><span class="ident" id="4625645">p</span>&nbsp;<span class="op" id="4625647">*</span><span class="ident" id="4625648"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4625655">)</span>&nbsp;<span class="ident" id="4625657">Name</span><span class="op" id="4625661">(</span><span class="op" id="4625662">)</span>&nbsp;<span class="builtintype" id="4625664">string</span>&nbsp;<span class="op" id="4625671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625674">return</span>&nbsp;<span class="ident" id="4625681"><a href="/runtime/pprof/pprof.go.html#4625645">p</a></span><span class="op" id="4625682">.</span><span class="ident" id="4625683">name</span><br>
<span class="lineno"></span><span class="op" id="4625688">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4625691">//&nbsp;Count&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;execution&nbsp;stacks&nbsp;currently&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4625765">func</span>&nbsp;<span class="op" id="4625770">(</span><span class="ident" id="4625771">p</span>&nbsp;<span class="op" id="4625773">*</span><span class="ident" id="4625774"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4625781">)</span>&nbsp;<span class="ident" id="4625783">Count</span><span class="op" id="4625788">(</span><span class="op" id="4625789">)</span>&nbsp;<span class="builtintype" id="4625791">int</span>&nbsp;<span class="op" id="4625795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625798"><a href="/runtime/pprof/pprof.go.html#4625771">p</a></span><span class="op" id="4625799">.</span><span class="ident" id="4625800">mu</span><span class="op" id="4625802">.</span><span class="ident" id="4625803">Lock</span><span class="op" id="4625807">(</span><span class="op" id="4625808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625811">defer</span>&nbsp;<span class="ident" id="4625817"><a href="/runtime/pprof/pprof.go.html#4625771">p</a></span><span class="op" id="4625818">.</span><span class="ident" id="4625819">mu</span><span class="op" id="4625821">.</span><span class="ident" id="4625822">Unlock</span><span class="op" id="4625828">(</span><span class="op" id="4625829">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625832">if</span>&nbsp;<span class="ident" id="4625835"><a href="/runtime/pprof/pprof.go.html#4625771">p</a></span><span class="op" id="4625836">.</span><span class="ident" id="4625837">count</span>&nbsp;<span class="op" id="4625843">!=</span>&nbsp;<span class="ident" id="4625846">nil</span>&nbsp;<span class="op" id="4625850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625854">return</span>&nbsp;<span class="ident" id="4625861"><a href="/runtime/pprof/pprof.go.html#4625771">p</a></span><span class="op" id="4625862">.</span><span class="ident" id="4625863">count</span><span class="op" id="4625868">(</span><span class="op" id="4625869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625875">return</span>&nbsp;<span class="builtinfunc" id="4625882">len</span><span class="op" id="4625885">(</span><span class="ident" id="4625886"><a href="/runtime/pprof/pprof.go.html#4625771">p</a></span><span class="op" id="4625887">.</span><span class="ident" id="4625888">m</span><span class="op" id="4625889">)</span><br>
<span class="lineno"></span><span class="op" id="4625891">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4625894">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;current&nbsp;execution&nbsp;stack&nbsp;to&nbsp;the&nbsp;profile,&nbsp;associated&nbsp;with&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4625973">//&nbsp;Add&nbsp;stores&nbsp;value&nbsp;in&nbsp;an&nbsp;internal&nbsp;map,&nbsp;so&nbsp;value&nbsp;must&nbsp;be&nbsp;suitable&nbsp;for&nbsp;use&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4626050">//&nbsp;a&nbsp;map&nbsp;key&nbsp;and&nbsp;will&nbsp;not&nbsp;be&nbsp;garbage&nbsp;collected&nbsp;until&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="4626121">//&nbsp;call&nbsp;to&nbsp;Remove.&nbsp;&nbsp;Add&nbsp;panics&nbsp;if&nbsp;the&nbsp;profile&nbsp;already&nbsp;contains&nbsp;a&nbsp;stack&nbsp;for&nbsp;value.</span><br>
<span class="lineno">170</span><span class="comment" id="4626203">//</span><br>
<span class="lineno"></span><span class="comment" id="4626206">//&nbsp;The&nbsp;skip&nbsp;parameter&nbsp;has&nbsp;the&nbsp;same&nbsp;meaning&nbsp;as&nbsp;runtime.Caller&#39;s&nbsp;skip</span><br>
<span class="lineno"></span><span class="comment" id="4626274">//&nbsp;and&nbsp;controls&nbsp;where&nbsp;the&nbsp;stack&nbsp;trace&nbsp;begins.&nbsp;&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4626347">//&nbsp;trace&nbsp;in&nbsp;the&nbsp;function&nbsp;calling&nbsp;Add.&nbsp;&nbsp;For&nbsp;example,&nbsp;given&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4626410">//&nbsp;execution&nbsp;stack:</span><br>
<span class="lineno">175</span><span class="comment" id="4626430">//</span><br>
<span class="lineno"></span><span class="comment" id="4626433">//&nbsp;&nbsp;&nbsp;&nbspAdd</span><br>
<span class="lineno"></span><span class="comment" id="4626440">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;rpc.NewClient</span><br>
<span class="lineno"></span><span class="comment" id="4626469">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;mypkg.Run</span><br>
<span class="lineno"></span><span class="comment" id="4626494">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;main.main</span><br>
<span class="lineno">180</span><span class="comment" id="4626519">//</span><br>
<span class="lineno"></span><span class="comment" id="4626522">//&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;Add&nbsp;inside&nbsp;rpc.NewClient.</span><br>
<span class="lineno"></span><span class="comment" id="4626604">//&nbsp;Passing&nbsp;skip=1&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;NewClient&nbsp;inside&nbsp;mypkg.Run.</span><br>
<span class="lineno"></span><span class="comment" id="4626688">//</span><br>
<span class="lineno"></span><span class="keyword" id="4626691">func</span>&nbsp;<span class="op" id="4626696">(</span><span class="ident" id="4626697">p</span>&nbsp;<span class="op" id="4626699">*</span><span class="ident" id="4626700"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4626707">)</span>&nbsp;<span class="ident" id="4626709">Add</span><span class="op" id="4626712">(</span><span class="ident" id="4626713">value</span>&nbsp;<span class="keyword" id="4626719">interface</span><span class="op" id="4626728">{</span><span class="op" id="4626729">}</span><span class="op" id="4626730">,</span>&nbsp;<span class="ident" id="4626732">skip</span>&nbsp;<span class="builtintype" id="4626737">int</span><span class="op" id="4626740">)</span>&nbsp;<span class="op" id="4626742">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626745">if</span>&nbsp;<span class="ident" id="4626748"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4626749">.</span><span class="ident" id="4626750">name</span>&nbsp;<span class="op" id="4626755">==</span>&nbsp;<span class="string" id="4626758">&#34;&#34;</span>&nbsp;<span class="op" id="4626761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4626765">panic</span><span class="op" id="4626770">(</span><span class="string" id="4626771">&#34;pprof:&nbsp;use&nbsp;of&nbsp;uninitialized&nbsp;Profile&#34;</span><span class="op" id="4626808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626814">if</span>&nbsp;<span class="ident" id="4626817"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4626818">.</span><span class="ident" id="4626819">write</span>&nbsp;<span class="op" id="4626825">!=</span>&nbsp;<span class="ident" id="4626828">nil</span>&nbsp;<span class="op" id="4626832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4626836">panic</span><span class="op" id="4626841">(</span><span class="string" id="4626842">&#34;pprof:&nbsp;Add&nbsp;called&nbsp;on&nbsp;built-in&nbsp;Profile&nbsp;&#34;</span>&nbsp;<span class="op" id="4626883">+</span>&nbsp;<span class="ident" id="4626885"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4626886">.</span><span class="ident" id="4626887">name</span><span class="op" id="4626891">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626898">stk</span>&nbsp;<span class="op" id="4626902">:=</span>&nbsp;<span class="builtinfunc" id="4626905">make</span><span class="op" id="4626909">(</span><span class="op" id="4626910">[</span><span class="op" id="4626911">]</span><span class="builtintype" id="4626912">uintptr</span><span class="op" id="4626919">,</span>&nbsp;<span class="num" id="4626921">32</span><span class="op" id="4626923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626926">n</span>&nbsp;<span class="op" id="4626928">:=</span>&nbsp;<span class="ident" id="4626931"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4626938">.</span><span class="ident" id="4626939">Callers</span><span class="op" id="4626946">(</span><span class="ident" id="4626947"><a href="/runtime/pprof/pprof.go.html#4626732">skip</a></span><span class="op" id="4626951">+</span><span class="num" id="4626952">1</span><span class="op" id="4626953">,</span>&nbsp;<span class="ident" id="4626955"><a href="/runtime/pprof/pprof.go.html#4626898">stk</a></span><span class="op" id="4626958">[</span><span class="op" id="4626959">:</span><span class="op" id="4626960">]</span><span class="op" id="4626961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626965"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4626966">.</span><span class="ident" id="4626967">mu</span><span class="op" id="4626969">.</span><span class="ident" id="4626970">Lock</span><span class="op" id="4626974">(</span><span class="op" id="4626975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626978">defer</span>&nbsp;<span class="ident" id="4626984"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4626985">.</span><span class="ident" id="4626986">mu</span><span class="op" id="4626988">.</span><span class="ident" id="4626989">Unlock</span><span class="op" id="4626995">(</span><span class="op" id="4626996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626999">if</span>&nbsp;<span class="ident" id="4627002"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4627003">.</span><span class="ident" id="4627004">m</span><span class="op" id="4627005">[</span><span class="ident" id="4627006"><a href="/runtime/pprof/pprof.go.html#4626713">value</a></span><span class="op" id="4627011">]</span>&nbsp;<span class="op" id="4627013">!=</span>&nbsp;<span class="ident" id="4627016">nil</span>&nbsp;<span class="op" id="4627020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4627024">panic</span><span class="op" id="4627029">(</span><span class="string" id="4627030">&#34;pprof:&nbsp;Profile.Add&nbsp;of&nbsp;duplicate&nbsp;value&#34;</span><span class="op" id="4627069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4627072">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627075"><a href="/runtime/pprof/pprof.go.html#4626697">p</a></span><span class="op" id="4627076">.</span><span class="ident" id="4627077">m</span><span class="op" id="4627078">[</span><span class="ident" id="4627079"><a href="/runtime/pprof/pprof.go.html#4626713">value</a></span><span class="op" id="4627084">]</span>&nbsp;<span class="op" id="4627086">=</span>&nbsp;<span class="ident" id="4627088"><a href="/runtime/pprof/pprof.go.html#4626898">stk</a></span><span class="op" id="4627091">[</span><span class="op" id="4627092">:</span><span class="ident" id="4627093"><a href="/runtime/pprof/pprof.go.html#4626926">n</a></span><span class="op" id="4627094">]</span><br>
<span class="lineno"></span><span class="op" id="4627096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4627099">//&nbsp;Remove&nbsp;removes&nbsp;the&nbsp;execution&nbsp;stack&nbsp;associated&nbsp;with&nbsp;value&nbsp;from&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="comment" id="4627177">//&nbsp;It&nbsp;is&nbsp;a&nbsp;no-op&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno">205</span><span class="keyword" id="4627230">func</span>&nbsp;<span class="op" id="4627235">(</span><span class="ident" id="4627236">p</span>&nbsp;<span class="op" id="4627238">*</span><span class="ident" id="4627239"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4627246">)</span>&nbsp;<span class="ident" id="4627248">Remove</span><span class="op" id="4627254">(</span><span class="ident" id="4627255">value</span>&nbsp;<span class="keyword" id="4627261">interface</span><span class="op" id="4627270">{</span><span class="op" id="4627271">}</span><span class="op" id="4627272">)</span>&nbsp;<span class="op" id="4627274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4627277"><a href="/runtime/pprof/pprof.go.html#4627236">p</a></span><span class="op" id="4627278">.</span><span class="ident" id="4627279">mu</span><span class="op" id="4627281">.</span><span class="ident" id="4627282">Lock</span><span class="op" id="4627286">(</span><span class="op" id="4627287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4627290">defer</span>&nbsp;<span class="ident" id="4627296"><a href="/runtime/pprof/pprof.go.html#4627236">p</a></span><span class="op" id="4627297">.</span><span class="ident" id="4627298">mu</span><span class="op" id="4627300">.</span><span class="ident" id="4627301">Unlock</span><span class="op" id="4627307">(</span><span class="op" id="4627308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4627311">delete</span><span class="op" id="4627317">(</span><span class="ident" id="4627318"><a href="/runtime/pprof/pprof.go.html#4627236">p</a></span><span class="op" id="4627319">.</span><span class="ident" id="4627320">m</span><span class="op" id="4627321">,</span>&nbsp;<span class="ident" id="4627323"><a href="/runtime/pprof/pprof.go.html#4627255">value</a></span><span class="op" id="4627328">)</span><br>
<span class="lineno"></span><span class="op" id="4627330">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="4627333">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;pprof-formatted&nbsp;snapshot&nbsp;of&nbsp;the&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4627399">//&nbsp;If&nbsp;a&nbsp;write&nbsp;to&nbsp;w&nbsp;returns&nbsp;an&nbsp;error,&nbsp;WriteTo&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4627464">//&nbsp;Otherwise,&nbsp;WriteTo&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4627499">//</span><br>
<span class="lineno">215</span><span class="comment" id="4627502">//&nbsp;The&nbsp;debug&nbsp;parameter&nbsp;enables&nbsp;additional&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="4627552">//&nbsp;Passing&nbsp;debug=0&nbsp;prints&nbsp;only&nbsp;the&nbsp;hexadecimal&nbsp;addresses&nbsp;that&nbsp;pprof&nbsp;needs.</span><br>
<span class="lineno"></span><span class="comment" id="4627627">//&nbsp;Passing&nbsp;debug=1&nbsp;adds&nbsp;comments&nbsp;translating&nbsp;addresses&nbsp;to&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span><span class="comment" id="4627700">//&nbsp;and&nbsp;line&nbsp;numbers,&nbsp;so&nbsp;that&nbsp;a&nbsp;programmer&nbsp;can&nbsp;read&nbsp;the&nbsp;profile&nbsp;without&nbsp;tools.</span><br>
<span class="lineno"></span><span class="comment" id="4627778">//</span><br>
<span class="lineno">220</span><span class="comment" id="4627781">//&nbsp;The&nbsp;predefined&nbsp;profiles&nbsp;may&nbsp;assign&nbsp;meaning&nbsp;to&nbsp;other&nbsp;debug&nbsp;values;</span><br>
<span class="lineno"></span><span class="comment" id="4627850">//&nbsp;for&nbsp;example,&nbsp;when&nbsp;printing&nbsp;the&nbsp;&#34;goroutine&#34;&nbsp;profile,&nbsp;debug=2&nbsp;means&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4627922">//&nbsp;print&nbsp;the&nbsp;goroutine&nbsp;stacks&nbsp;in&nbsp;the&nbsp;same&nbsp;form&nbsp;that&nbsp;a&nbsp;Go&nbsp;program&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4627992">//&nbsp;when&nbsp;dying&nbsp;due&nbsp;to&nbsp;an&nbsp;unrecovered&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="4628035">func</span>&nbsp;<span class="op" id="4628040">(</span><span class="ident" id="4628041">p</span>&nbsp;<span class="op" id="4628043">*</span><span class="ident" id="4628044"><a href="/runtime/pprof/pprof.go.html#4623342">Profile</a></span><span class="op" id="4628051">)</span>&nbsp;<span class="ident" id="4628053">WriteTo</span><span class="op" id="4628060">(</span><span class="ident" id="4628061">w</span>&nbsp;<span class="ident" id="4628063"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4628065">.</span><span class="ident" id="4628066">Writer</span><span class="op" id="4628072">,</span>&nbsp;<span class="ident" id="4628074">debug</span>&nbsp;<span class="builtintype" id="4628080">int</span><span class="op" id="4628083">)</span>&nbsp;<span class="builtintype" id="4628085">error</span>&nbsp;<span class="op" id="4628091">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628094">if</span>&nbsp;<span class="ident" id="4628097"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628098">.</span><span class="ident" id="4628099">name</span>&nbsp;<span class="op" id="4628104">==</span>&nbsp;<span class="string" id="4628107">&#34;&#34;</span>&nbsp;<span class="op" id="4628110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4628114">panic</span><span class="op" id="4628119">(</span><span class="string" id="4628120">&#34;pprof:&nbsp;use&nbsp;of&nbsp;zero&nbsp;Profile&#34;</span><span class="op" id="4628148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628154">if</span>&nbsp;<span class="ident" id="4628157"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628158">.</span><span class="ident" id="4628159">write</span>&nbsp;<span class="op" id="4628165">!=</span>&nbsp;<span class="ident" id="4628168">nil</span>&nbsp;<span class="op" id="4628172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628176">return</span>&nbsp;<span class="ident" id="4628183"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628184">.</span><span class="ident" id="4628185">write</span><span class="op" id="4628190">(</span><span class="ident" id="4628191"><a href="/runtime/pprof/pprof.go.html#4628061">w</a></span><span class="op" id="4628192">,</span>&nbsp;<span class="ident" id="4628194"><a href="/runtime/pprof/pprof.go.html#4628074">debug</a></span><span class="op" id="4628199">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4628206">//&nbsp;Obtain&nbsp;consistent&nbsp;snapshot&nbsp;under&nbsp;lock;&nbsp;then&nbsp;process&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628276">var</span>&nbsp;<span class="ident" id="4628280">all</span>&nbsp;<span class="op" id="4628284">[</span><span class="op" id="4628285">]</span><span class="op" id="4628286">[</span><span class="op" id="4628287">]</span><span class="builtintype" id="4628288">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628297"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628298">.</span><span class="ident" id="4628299">mu</span><span class="op" id="4628301">.</span><span class="ident" id="4628302">Lock</span><span class="op" id="4628306">(</span><span class="op" id="4628307">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628310">for</span>&nbsp;<span class="ident" id="4628314">_</span><span class="op" id="4628315">,</span>&nbsp;<span class="ident" id="4628317">stk</span>&nbsp;<span class="op" id="4628321">:=</span>&nbsp;<span class="keyword" id="4628324">range</span>&nbsp;<span class="ident" id="4628330"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628331">.</span><span class="ident" id="4628332">m</span>&nbsp;<span class="op" id="4628334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628338"><a href="/runtime/pprof/pprof.go.html#4628280">all</a></span>&nbsp;<span class="op" id="4628342">=</span>&nbsp;<span class="builtinfunc" id="4628344">append</span><span class="op" id="4628350">(</span><span class="ident" id="4628351"><a href="/runtime/pprof/pprof.go.html#4628280">all</a></span><span class="op" id="4628354">,</span>&nbsp;<span class="ident" id="4628356"><a href="/runtime/pprof/pprof.go.html#4628317">stk</a></span><span class="op" id="4628359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628365"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628366">.</span><span class="ident" id="4628367">mu</span><span class="op" id="4628369">.</span><span class="ident" id="4628370">Unlock</span><span class="op" id="4628376">(</span><span class="op" id="4628377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4628381">//&nbsp;Map&nbsp;order&nbsp;is&nbsp;non-deterministic;&nbsp;make&nbsp;output&nbsp;deterministic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628444"><a href="/runtime/pprof/pprof.go.html#4622132">sort</a></span><span class="op" id="4628448">.</span><span class="ident" id="4628449">Sort</span><span class="op" id="4628453">(</span><span class="ident" id="4628454"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628466">(</span><span class="ident" id="4628467"><a href="/runtime/pprof/pprof.go.html#4628280">all</a></span><span class="op" id="4628470">)</span><span class="op" id="4628471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628475">return</span>&nbsp;<span class="ident" id="4628482"><a href="/runtime/pprof/pprof.go.html#4629334">printCountProfile</a></span><span class="op" id="4628499">(</span><span class="ident" id="4628500"><a href="/runtime/pprof/pprof.go.html#4628061">w</a></span><span class="op" id="4628501">,</span>&nbsp;<span class="ident" id="4628503"><a href="/runtime/pprof/pprof.go.html#4628074">debug</a></span><span class="op" id="4628508">,</span>&nbsp;<span class="ident" id="4628510"><a href="/runtime/pprof/pprof.go.html#4628041">p</a></span><span class="op" id="4628511">.</span><span class="ident" id="4628512">name</span><span class="op" id="4628516">,</span>&nbsp;<span class="ident" id="4628518"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628530">(</span><span class="ident" id="4628531"><a href="/runtime/pprof/pprof.go.html#4628280">all</a></span><span class="op" id="4628534">)</span><span class="op" id="4628535">)</span><br>
<span class="lineno"></span><span class="op" id="4628537">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4628540">type</span>&nbsp;<span class="ident" id="4628545">stackProfile</span>&nbsp;<span class="op" id="4628558">[</span><span class="op" id="4628559">]</span><span class="op" id="4628560">[</span><span class="op" id="4628561">]</span><span class="builtintype" id="4628562">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4628571">func</span>&nbsp;<span class="op" id="4628576">(</span><span class="ident" id="4628577">x</span>&nbsp;<span class="ident" id="4628579"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628591">)</span>&nbsp;<span class="ident" id="4628593">Len</span><span class="op" id="4628596">(</span><span class="op" id="4628597">)</span>&nbsp;<span class="builtintype" id="4628599">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628616">{</span>&nbsp;<span class="keyword" id="4628618">return</span>&nbsp;<span class="builtinfunc" id="4628625">len</span><span class="op" id="4628628">(</span><span class="ident" id="4628629"><a href="/runtime/pprof/pprof.go.html#4628577">x</a></span><span class="op" id="4628630">)</span>&nbsp;<span class="op" id="4628632">}</span><br>
<span class="lineno"></span><span class="keyword" id="4628634">func</span>&nbsp;<span class="op" id="4628639">(</span><span class="ident" id="4628640">x</span>&nbsp;<span class="ident" id="4628642"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628654">)</span>&nbsp;<span class="ident" id="4628656">Stack</span><span class="op" id="4628661">(</span><span class="ident" id="4628662">i</span>&nbsp;<span class="builtintype" id="4628664">int</span><span class="op" id="4628667">)</span>&nbsp;<span class="op" id="4628669">[</span><span class="op" id="4628670">]</span><span class="builtintype" id="4628671">uintptr</span>&nbsp;<span class="op" id="4628679">{</span>&nbsp;<span class="keyword" id="4628681">return</span>&nbsp;<span class="ident" id="4628688"><a href="/runtime/pprof/pprof.go.html#4628640">x</a></span><span class="op" id="4628689">[</span><span class="ident" id="4628690"><a href="/runtime/pprof/pprof.go.html#4628662">i</a></span><span class="op" id="4628691">]</span>&nbsp;<span class="op" id="4628693">}</span><br>
<span class="lineno">250</span><span class="keyword" id="4628695">func</span>&nbsp;<span class="op" id="4628700">(</span><span class="ident" id="4628701">x</span>&nbsp;<span class="ident" id="4628703"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628715">)</span>&nbsp;<span class="ident" id="4628717">Swap</span><span class="op" id="4628721">(</span><span class="ident" id="4628722">i</span><span class="op" id="4628723">,</span>&nbsp;<span class="ident" id="4628725">j</span>&nbsp;<span class="builtintype" id="4628727">int</span><span class="op" id="4628730">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628740">{</span>&nbsp;<span class="ident" id="4628742"><a href="/runtime/pprof/pprof.go.html#4628701">x</a></span><span class="op" id="4628743">[</span><span class="ident" id="4628744"><a href="/runtime/pprof/pprof.go.html#4628722">i</a></span><span class="op" id="4628745">]</span><span class="op" id="4628746">,</span>&nbsp;<span class="ident" id="4628748"><a href="/runtime/pprof/pprof.go.html#4628701">x</a></span><span class="op" id="4628749">[</span><span class="ident" id="4628750"><a href="/runtime/pprof/pprof.go.html#4628725">j</a></span><span class="op" id="4628751">]</span>&nbsp;<span class="op" id="4628753">=</span>&nbsp;<span class="ident" id="4628755"><a href="/runtime/pprof/pprof.go.html#4628701">x</a></span><span class="op" id="4628756">[</span><span class="ident" id="4628757"><a href="/runtime/pprof/pprof.go.html#4628725">j</a></span><span class="op" id="4628758">]</span><span class="op" id="4628759">,</span>&nbsp;<span class="ident" id="4628761"><a href="/runtime/pprof/pprof.go.html#4628701">x</a></span><span class="op" id="4628762">[</span><span class="ident" id="4628763"><a href="/runtime/pprof/pprof.go.html#4628722">i</a></span><span class="op" id="4628764">]</span>&nbsp;<span class="op" id="4628766">}</span><br>
<span class="lineno"></span><span class="keyword" id="4628768">func</span>&nbsp;<span class="op" id="4628773">(</span><span class="ident" id="4628774">x</span>&nbsp;<span class="ident" id="4628776"><a href="/runtime/pprof/pprof.go.html#4628545">stackProfile</a></span><span class="op" id="4628788">)</span>&nbsp;<span class="ident" id="4628790">Less</span><span class="op" id="4628794">(</span><span class="ident" id="4628795">i</span><span class="op" id="4628796">,</span>&nbsp;<span class="ident" id="4628798">j</span>&nbsp;<span class="builtintype" id="4628800">int</span><span class="op" id="4628803">)</span>&nbsp;<span class="builtintype" id="4628805">bool</span>&nbsp;<span class="op" id="4628810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4628813">t</span><span class="op" id="4628814">,</span>&nbsp;<span class="ident" id="4628816">u</span>&nbsp;<span class="op" id="4628818">:=</span>&nbsp;<span class="ident" id="4628821"><a href="/runtime/pprof/pprof.go.html#4628774">x</a></span><span class="op" id="4628822">[</span><span class="ident" id="4628823"><a href="/runtime/pprof/pprof.go.html#4628795">i</a></span><span class="op" id="4628824">]</span><span class="op" id="4628825">,</span>&nbsp;<span class="ident" id="4628827"><a href="/runtime/pprof/pprof.go.html#4628774">x</a></span><span class="op" id="4628828">[</span><span class="ident" id="4628829"><a href="/runtime/pprof/pprof.go.html#4628798">j</a></span><span class="op" id="4628830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628833">for</span>&nbsp;<span class="ident" id="4628837">k</span>&nbsp;<span class="op" id="4628839">:=</span>&nbsp;<span class="num" id="4628842">0</span><span class="op" id="4628843">;</span>&nbsp;<span class="ident" id="4628845"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span>&nbsp;<span class="op" id="4628847">&lt;</span>&nbsp;<span class="builtinfunc" id="4628849">len</span><span class="op" id="4628852">(</span><span class="ident" id="4628853"><a href="/runtime/pprof/pprof.go.html#4628813">t</a></span><span class="op" id="4628854">)</span>&nbsp;<span class="op" id="4628856">&amp;&amp;</span>&nbsp;<span class="ident" id="4628859"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span>&nbsp;<span class="op" id="4628861">&lt;</span>&nbsp;<span class="builtinfunc" id="4628863">len</span><span class="op" id="4628866">(</span><span class="ident" id="4628867"><a href="/runtime/pprof/pprof.go.html#4628816">u</a></span><span class="op" id="4628868">)</span><span class="op" id="4628869">;</span>&nbsp;<span class="ident" id="4628871"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span><span class="op" id="4628872">++</span>&nbsp;<span class="op" id="4628875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628879">if</span>&nbsp;<span class="ident" id="4628882"><a href="/runtime/pprof/pprof.go.html#4628813">t</a></span><span class="op" id="4628883">[</span><span class="ident" id="4628884"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span><span class="op" id="4628885">]</span>&nbsp;<span class="op" id="4628887">!=</span>&nbsp;<span class="ident" id="4628890"><a href="/runtime/pprof/pprof.go.html#4628816">u</a></span><span class="op" id="4628891">[</span><span class="ident" id="4628892"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span><span class="op" id="4628893">]</span>&nbsp;<span class="op" id="4628895">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628900">return</span>&nbsp;<span class="ident" id="4628907"><a href="/runtime/pprof/pprof.go.html#4628813">t</a></span><span class="op" id="4628908">[</span><span class="ident" id="4628909"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span><span class="op" id="4628910">]</span>&nbsp;<span class="op" id="4628912">&lt;</span>&nbsp;<span class="ident" id="4628914"><a href="/runtime/pprof/pprof.go.html#4628816">u</a></span><span class="op" id="4628915">[</span><span class="ident" id="4628916"><a href="/runtime/pprof/pprof.go.html#4628837">k</a></span><span class="op" id="4628917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4628924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4628927">return</span>&nbsp;<span class="builtinfunc" id="4628934">len</span><span class="op" id="4628937">(</span><span class="ident" id="4628938"><a href="/runtime/pprof/pprof.go.html#4628813">t</a></span><span class="op" id="4628939">)</span>&nbsp;<span class="op" id="4628941">&lt;</span>&nbsp;<span class="builtinfunc" id="4628943">len</span><span class="op" id="4628946">(</span><span class="ident" id="4628947"><a href="/runtime/pprof/pprof.go.html#4628816">u</a></span><span class="op" id="4628948">)</span><br>
<span class="lineno"></span><span class="op" id="4628950">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="4628953">//&nbsp;A&nbsp;countProfile&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;stack&nbsp;traces&nbsp;to&nbsp;be&nbsp;printed&nbsp;as&nbsp;counts</span><br>
<span class="lineno"></span><span class="comment" id="4629020">//&nbsp;grouped&nbsp;by&nbsp;stack&nbsp;trace.&nbsp;&nbsp;There&nbsp;are&nbsp;multiple&nbsp;implementations:</span><br>
<span class="lineno"></span><span class="comment" id="4629084">//&nbsp;all&nbsp;that&nbsp;matters&nbsp;is&nbsp;that&nbsp;we&nbsp;can&nbsp;find&nbsp;out&nbsp;how&nbsp;many&nbsp;traces&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4629154">//&nbsp;and&nbsp;obtain&nbsp;each&nbsp;trace&nbsp;in&nbsp;turn.</span><br>
<span class="lineno">265</span><span class="keyword" id="4629188">type</span>&nbsp;<span class="ident" id="4629193">countProfile</span>&nbsp;<span class="keyword" id="4629206">interface</span>&nbsp;<span class="op" id="4629216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629219">Len</span><span class="op" id="4629222">(</span><span class="op" id="4629223">)</span>&nbsp;<span class="builtintype" id="4629225">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629230">Stack</span><span class="op" id="4629235">(</span><span class="ident" id="4629236">i</span>&nbsp;<span class="builtintype" id="4629238">int</span><span class="op" id="4629241">)</span>&nbsp;<span class="op" id="4629243">[</span><span class="op" id="4629244">]</span><span class="builtintype" id="4629245">uintptr</span><br>
<span class="lineno"></span><span class="op" id="4629253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="4629256">//&nbsp;printCountProfile&nbsp;prints&nbsp;a&nbsp;countProfile&nbsp;at&nbsp;the&nbsp;specified&nbsp;debug&nbsp;level.</span><br>
<span class="lineno"></span><span class="keyword" id="4629329">func</span>&nbsp;<span class="ident" id="4629334">printCountProfile</span><span class="op" id="4629351">(</span><span class="ident" id="4629352">w</span>&nbsp;<span class="ident" id="4629354"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4629356">.</span><span class="ident" id="4629357">Writer</span><span class="op" id="4629363">,</span>&nbsp;<span class="ident" id="4629365">debug</span>&nbsp;<span class="builtintype" id="4629371">int</span><span class="op" id="4629374">,</span>&nbsp;<span class="ident" id="4629376">name</span>&nbsp;<span class="builtintype" id="4629381">string</span><span class="op" id="4629387">,</span>&nbsp;<span class="ident" id="4629389">p</span>&nbsp;<span class="ident" id="4629391"><a href="/runtime/pprof/pprof.go.html#4629193">countProfile</a></span><span class="op" id="4629403">)</span>&nbsp;<span class="builtintype" id="4629405">error</span>&nbsp;<span class="op" id="4629411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629414">b</span>&nbsp;<span class="op" id="4629416">:=</span>&nbsp;<span class="ident" id="4629419"><a href="/runtime/pprof/pprof.go.html#4622090">bufio</a></span><span class="op" id="4629424">.</span><span class="ident" id="4629425">NewWriter</span><span class="op" id="4629434">(</span><span class="ident" id="4629435"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span><span class="op" id="4629436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629439">var</span>&nbsp;<span class="ident" id="4629443">tw</span>&nbsp;<span class="op" id="4629446">*</span><span class="ident" id="4629447"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4629456">.</span><span class="ident" id="4629457">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629465"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span>&nbsp;<span class="op" id="4629467">=</span>&nbsp;<span class="ident" id="4629469"><a href="/runtime/pprof/pprof.go.html#4629414">b</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629472">if</span>&nbsp;<span class="ident" id="4629475"><a href="/runtime/pprof/pprof.go.html#4629365">debug</a></span>&nbsp;<span class="op" id="4629481">&gt;</span>&nbsp;<span class="num" id="4629483">0</span>&nbsp;<span class="op" id="4629485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629489"><a href="/runtime/pprof/pprof.go.html#4629443">tw</a></span>&nbsp;<span class="op" id="4629492">=</span>&nbsp;<span class="ident" id="4629494"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4629503">.</span><span class="ident" id="4629504">NewWriter</span><span class="op" id="4629513">(</span><span class="ident" id="4629514"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span><span class="op" id="4629515">,</span>&nbsp;<span class="num" id="4629517">1</span><span class="op" id="4629518">,</span>&nbsp;<span class="num" id="4629520">8</span><span class="op" id="4629521">,</span>&nbsp;<span class="num" id="4629523">1</span><span class="op" id="4629524">,</span>&nbsp;<span class="string" id="4629526">&#39;\t&#39;</span><span class="op" id="4629530">,</span>&nbsp;<span class="num" id="4629532">0</span><span class="op" id="4629533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629537"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span>&nbsp;<span class="op" id="4629539">=</span>&nbsp;<span class="ident" id="4629541"><a href="/runtime/pprof/pprof.go.html#4629443">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629549"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4629552">.</span><span class="ident" id="4629553">Fprintf</span><span class="op" id="4629560">(</span><span class="ident" id="4629561"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span><span class="op" id="4629562">,</span>&nbsp;<span class="string" id="4629564">&#34;%s&nbsp;profile:&nbsp;total&nbsp;%d\n&#34;</span><span class="op" id="4629588">,</span>&nbsp;<span class="ident" id="4629590"><a href="/runtime/pprof/pprof.go.html#4629376">name</a></span><span class="op" id="4629594">,</span>&nbsp;<span class="ident" id="4629596"><a href="/runtime/pprof/pprof.go.html#4629389">p</a></span><span class="op" id="4629597">.</span><span class="ident" id="4629598">Len</span><span class="op" id="4629601">(</span><span class="op" id="4629602">)</span><span class="op" id="4629603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4629607">//&nbsp;Build&nbsp;count&nbsp;of&nbsp;each&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629638">var</span>&nbsp;<span class="ident" id="4629642">buf</span>&nbsp;<span class="ident" id="4629646"><a href="/runtime/pprof/pprof.go.html#4622099">bytes</a></span><span class="op" id="4629651">.</span><span class="ident" id="4629652">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629660">key</span>&nbsp;<span class="op" id="4629664">:=</span>&nbsp;<span class="keyword" id="4629667">func</span><span class="op" id="4629671">(</span><span class="ident" id="4629672">stk</span>&nbsp;<span class="op" id="4629676">[</span><span class="op" id="4629677">]</span><span class="builtintype" id="4629678">uintptr</span><span class="op" id="4629685">)</span>&nbsp;<span class="builtintype" id="4629687">string</span>&nbsp;<span class="op" id="4629694">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629698"><a href="/runtime/pprof/pprof.go.html#4629642">buf</a></span><span class="op" id="4629701">.</span><span class="ident" id="4629702">Reset</span><span class="op" id="4629707">(</span><span class="op" id="4629708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629712"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4629715">.</span><span class="ident" id="4629716">Fprintf</span><span class="op" id="4629723">(</span><span class="op" id="4629724">&amp;</span><span class="ident" id="4629725"><a href="/runtime/pprof/pprof.go.html#4629642">buf</a></span><span class="op" id="4629728">,</span>&nbsp;<span class="string" id="4629730">&#34;@&#34;</span><span class="op" id="4629733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629737">for</span>&nbsp;<span class="ident" id="4629741">_</span><span class="op" id="4629742">,</span>&nbsp;<span class="ident" id="4629744">pc</span>&nbsp;<span class="op" id="4629747">:=</span>&nbsp;<span class="keyword" id="4629750">range</span>&nbsp;<span class="ident" id="4629756"><a href="/runtime/pprof/pprof.go.html#4629672">stk</a></span>&nbsp;<span class="op" id="4629760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629765"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4629768">.</span><span class="ident" id="4629769">Fprintf</span><span class="op" id="4629776">(</span><span class="op" id="4629777">&amp;</span><span class="ident" id="4629778"><a href="/runtime/pprof/pprof.go.html#4629642">buf</a></span><span class="op" id="4629781">,</span>&nbsp;<span class="string" id="4629783">&#34;&nbsp;%#x&#34;</span><span class="op" id="4629789">,</span>&nbsp;<span class="ident" id="4629791"><a href="/runtime/pprof/pprof.go.html#4629744">pc</a></span><span class="op" id="4629793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629797">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629801">return</span>&nbsp;<span class="ident" id="4629808"><a href="/runtime/pprof/pprof.go.html#4629642">buf</a></span><span class="op" id="4629811">.</span><span class="ident" id="4629812">String</span><span class="op" id="4629818">(</span><span class="op" id="4629819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629825">m</span>&nbsp;<span class="op" id="4629827">:=</span>&nbsp;<span class="keyword" id="4629830">map</span><span class="op" id="4629833">[</span><span class="builtintype" id="4629834">string</span><span class="op" id="4629840">]</span><span class="builtintype" id="4629841">int</span><span class="op" id="4629844">{</span><span class="op" id="4629845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629848">n</span>&nbsp;<span class="op" id="4629850">:=</span>&nbsp;<span class="ident" id="4629853"><a href="/runtime/pprof/pprof.go.html#4629389">p</a></span><span class="op" id="4629854">.</span><span class="ident" id="4629855">Len</span><span class="op" id="4629858">(</span><span class="op" id="4629859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629862">for</span>&nbsp;<span class="ident" id="4629866">i</span>&nbsp;<span class="op" id="4629868">:=</span>&nbsp;<span class="num" id="4629871">0</span><span class="op" id="4629872">;</span>&nbsp;<span class="ident" id="4629874"><a href="/runtime/pprof/pprof.go.html#4629866">i</a></span>&nbsp;<span class="op" id="4629876">&lt;</span>&nbsp;<span class="ident" id="4629878"><a href="/runtime/pprof/pprof.go.html#4629848">n</a></span><span class="op" id="4629879">;</span>&nbsp;<span class="ident" id="4629881"><a href="/runtime/pprof/pprof.go.html#4629866">i</a></span><span class="op" id="4629882">++</span>&nbsp;<span class="op" id="4629885">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4629889"><a href="/runtime/pprof/pprof.go.html#4629825">m</a></span><span class="op" id="4629890">[</span><span class="ident" id="4629891"><a href="/runtime/pprof/pprof.go.html#4629660">key</a></span><span class="op" id="4629894">(</span><span class="ident" id="4629895"><a href="/runtime/pprof/pprof.go.html#4629389">p</a></span><span class="op" id="4629896">.</span><span class="ident" id="4629897">Stack</span><span class="op" id="4629902">(</span><span class="ident" id="4629903"><a href="/runtime/pprof/pprof.go.html#4629866">i</a></span><span class="op" id="4629904">)</span><span class="op" id="4629905">)</span><span class="op" id="4629906">]</span><span class="op" id="4629907">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4629911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4629915">//&nbsp;Print&nbsp;stacks,&nbsp;listing&nbsp;count&nbsp;on&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;a&nbsp;unique&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4629986">for</span>&nbsp;<span class="ident" id="4629990">i</span>&nbsp;<span class="op" id="4629992">:=</span>&nbsp;<span class="num" id="4629995">0</span><span class="op" id="4629996">;</span>&nbsp;<span class="ident" id="4629998"><a href="/runtime/pprof/pprof.go.html#4629990">i</a></span>&nbsp;<span class="op" id="4630000">&lt;</span>&nbsp;<span class="ident" id="4630002"><a href="/runtime/pprof/pprof.go.html#4629848">n</a></span><span class="op" id="4630003">;</span>&nbsp;<span class="ident" id="4630005"><a href="/runtime/pprof/pprof.go.html#4629990">i</a></span><span class="op" id="4630006">++</span>&nbsp;<span class="op" id="4630009">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630013">stk</span>&nbsp;<span class="op" id="4630017">:=</span>&nbsp;<span class="ident" id="4630020"><a href="/runtime/pprof/pprof.go.html#4629389">p</a></span><span class="op" id="4630021">.</span><span class="ident" id="4630022">Stack</span><span class="op" id="4630027">(</span><span class="ident" id="4630028"><a href="/runtime/pprof/pprof.go.html#4629990">i</a></span><span class="op" id="4630029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630033">s</span>&nbsp;<span class="op" id="4630035">:=</span>&nbsp;<span class="ident" id="4630038"><a href="/runtime/pprof/pprof.go.html#4629660">key</a></span><span class="op" id="4630041">(</span><span class="ident" id="4630042"><a href="/runtime/pprof/pprof.go.html#4630013">stk</a></span><span class="op" id="4630045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630049">if</span>&nbsp;<span class="ident" id="4630052">count</span>&nbsp;<span class="op" id="4630058">:=</span>&nbsp;<span class="ident" id="4630061"><a href="/runtime/pprof/pprof.go.html#4629825">m</a></span><span class="op" id="4630062">[</span><span class="ident" id="4630063"><a href="/runtime/pprof/pprof.go.html#4630033">s</a></span><span class="op" id="4630064">]</span><span class="op" id="4630065">;</span>&nbsp;<span class="ident" id="4630067"><a href="/runtime/pprof/pprof.go.html#4630052">count</a></span>&nbsp;<span class="op" id="4630073">!=</span>&nbsp;<span class="num" id="4630076">0</span>&nbsp;<span class="op" id="4630078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630083"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4630086">.</span><span class="ident" id="4630087">Fprintf</span><span class="op" id="4630094">(</span><span class="ident" id="4630095"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span><span class="op" id="4630096">,</span>&nbsp;<span class="string" id="4630098">&#34;%d&nbsp;%s\n&#34;</span><span class="op" id="4630107">,</span>&nbsp;<span class="ident" id="4630109"><a href="/runtime/pprof/pprof.go.html#4630052">count</a></span><span class="op" id="4630114">,</span>&nbsp;<span class="ident" id="4630116"><a href="/runtime/pprof/pprof.go.html#4630033">s</a></span><span class="op" id="4630117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630122">if</span>&nbsp;<span class="ident" id="4630125"><a href="/runtime/pprof/pprof.go.html#4629365">debug</a></span>&nbsp;<span class="op" id="4630131">&gt;</span>&nbsp;<span class="num" id="4630133">0</span>&nbsp;<span class="op" id="4630135">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630141"><a href="/runtime/pprof/pprof.go.html#4630355">printStackRecord</a></span><span class="op" id="4630157">(</span><span class="ident" id="4630158"><a href="/runtime/pprof/pprof.go.html#4629352">w</a></span><span class="op" id="4630159">,</span>&nbsp;<span class="ident" id="4630161"><a href="/runtime/pprof/pprof.go.html#4630013">stk</a></span><span class="op" id="4630164">,</span>&nbsp;<span class="ident" id="4630166">false</span><span class="op" id="4630171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4630181">delete</span><span class="op" id="4630187">(</span><span class="ident" id="4630188"><a href="/runtime/pprof/pprof.go.html#4629825">m</a></span><span class="op" id="4630189">,</span>&nbsp;<span class="ident" id="4630191"><a href="/runtime/pprof/pprof.go.html#4630033">s</a></span><span class="op" id="4630192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630199">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630203">if</span>&nbsp;<span class="ident" id="4630206"><a href="/runtime/pprof/pprof.go.html#4629443">tw</a></span>&nbsp;<span class="op" id="4630209">!=</span>&nbsp;<span class="ident" id="4630212">nil</span>&nbsp;<span class="op" id="4630216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630220"><a href="/runtime/pprof/pprof.go.html#4629443">tw</a></span><span class="op" id="4630222">.</span><span class="ident" id="4630223">Flush</span><span class="op" id="4630228">(</span><span class="op" id="4630229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630235">return</span>&nbsp;<span class="ident" id="4630242"><a href="/runtime/pprof/pprof.go.html#4629414">b</a></span><span class="op" id="4630243">.</span><span class="ident" id="4630244">Flush</span><span class="op" id="4630249">(</span><span class="op" id="4630250">)</span><br>
<span class="lineno">315</span><span class="op" id="4630252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4630255">//&nbsp;printStackRecord&nbsp;prints&nbsp;the&nbsp;function&nbsp;+&nbsp;source&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="4630321">//&nbsp;for&nbsp;a&nbsp;single&nbsp;stack&nbsp;trace.</span><br>
<span class="lineno"></span><span class="keyword" id="4630350">func</span>&nbsp;<span class="ident" id="4630355">printStackRecord</span><span class="op" id="4630371">(</span><span class="ident" id="4630372">w</span>&nbsp;<span class="ident" id="4630374"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4630376">.</span><span class="ident" id="4630377">Writer</span><span class="op" id="4630383">,</span>&nbsp;<span class="ident" id="4630385">stk</span>&nbsp;<span class="op" id="4630389">[</span><span class="op" id="4630390">]</span><span class="builtintype" id="4630391">uintptr</span><span class="op" id="4630398">,</span>&nbsp;<span class="ident" id="4630400">allFrames</span>&nbsp;<span class="builtintype" id="4630410">bool</span><span class="op" id="4630414">)</span>&nbsp;<span class="op" id="4630416">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630419">show</span>&nbsp;<span class="op" id="4630424">:=</span>&nbsp;<span class="ident" id="4630427"><a href="/runtime/pprof/pprof.go.html#4630400">allFrames</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630438">wasPanic</span>&nbsp;<span class="op" id="4630447">:=</span>&nbsp;<span class="ident" id="4630450">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630457">for</span>&nbsp;<span class="ident" id="4630461">i</span><span class="op" id="4630462">,</span>&nbsp;<span class="ident" id="4630464">pc</span>&nbsp;<span class="op" id="4630467">:=</span>&nbsp;<span class="keyword" id="4630470">range</span>&nbsp;<span class="ident" id="4630476"><a href="/runtime/pprof/pprof.go.html#4630385">stk</a></span>&nbsp;<span class="op" id="4630480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630484">f</span>&nbsp;<span class="op" id="4630486">:=</span>&nbsp;<span class="ident" id="4630489"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4630496">.</span><span class="ident" id="4630497">FuncForPC</span><span class="op" id="4630506">(</span><span class="ident" id="4630507"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span><span class="op" id="4630509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630513">if</span>&nbsp;<span class="ident" id="4630516"><a href="/runtime/pprof/pprof.go.html#4630484">f</a></span>&nbsp;<span class="op" id="4630518">==</span>&nbsp;<span class="ident" id="4630521">nil</span>&nbsp;<span class="op" id="4630525">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630530"><a href="/runtime/pprof/pprof.go.html#4630419">show</a></span>&nbsp;<span class="op" id="4630535">=</span>&nbsp;<span class="ident" id="4630537">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630545"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4630548">.</span><span class="ident" id="4630549">Fprintf</span><span class="op" id="4630556">(</span><span class="ident" id="4630557"><a href="/runtime/pprof/pprof.go.html#4630372">w</a></span><span class="op" id="4630558">,</span>&nbsp;<span class="string" id="4630560">&#34;#\t%#x\n&#34;</span><span class="op" id="4630570">,</span>&nbsp;<span class="ident" id="4630572"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span><span class="op" id="4630574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630579"><a href="/runtime/pprof/pprof.go.html#4630438">wasPanic</a></span>&nbsp;<span class="op" id="4630588">=</span>&nbsp;<span class="ident" id="4630590">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630598">}</span>&nbsp;<span class="keyword" id="4630600">else</span>&nbsp;<span class="op" id="4630605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630610">tracepc</span>&nbsp;<span class="op" id="4630618">:=</span>&nbsp;<span class="ident" id="4630621"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630627">//&nbsp;Back&nbsp;up&nbsp;to&nbsp;call&nbsp;instruction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630662">if</span>&nbsp;<span class="ident" id="4630665"><a href="/runtime/pprof/pprof.go.html#4630461">i</a></span>&nbsp;<span class="op" id="4630667">&gt;</span>&nbsp;<span class="num" id="4630669">0</span>&nbsp;<span class="op" id="4630671">&amp;&amp;</span>&nbsp;<span class="ident" id="4630674"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span>&nbsp;<span class="op" id="4630677">&gt;</span>&nbsp;<span class="ident" id="4630679"><a href="/runtime/pprof/pprof.go.html#4630484">f</a></span><span class="op" id="4630680">.</span><span class="ident" id="4630681">Entry</span><span class="op" id="4630686">(</span><span class="op" id="4630687">)</span>&nbsp;<span class="op" id="4630689">&amp;&amp;</span>&nbsp;<span class="op" id="4630692">!</span><span class="ident" id="4630693"><a href="/runtime/pprof/pprof.go.html#4630438">wasPanic</a></span>&nbsp;<span class="op" id="4630702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4630708">if</span>&nbsp;<span class="ident" id="4630711"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4630718">.</span><span class="ident" id="4630719">GOARCH</span>&nbsp;<span class="op" id="4630726">==</span>&nbsp;<span class="string" id="4630729">&#34;386&#34;</span>&nbsp;<span class="op" id="4630735">||</span>&nbsp;<span class="ident" id="4630738"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4630745">.</span><span class="ident" id="4630746">GOARCH</span>&nbsp;<span class="op" id="4630753">==</span>&nbsp;<span class="string" id="4630756">&#34;amd64&#34;</span>&nbsp;<span class="op" id="4630764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630771"><a href="/runtime/pprof/pprof.go.html#4630610">tracepc</a></span><span class="op" id="4630778">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630785">}</span>&nbsp;<span class="keyword" id="4630787">else</span>&nbsp;<span class="op" id="4630792">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630799"><a href="/runtime/pprof/pprof.go.html#4630610">tracepc</a></span>&nbsp;<span class="op" id="4630807">-=</span>&nbsp;<span class="num" id="4630810">4</span>&nbsp;<span class="comment" id="4630812">//&nbsp;arm,&nbsp;etc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4630833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630838">file</span><span class="op" id="4630842">,</span>&nbsp;<span class="ident" id="4630844">line</span>&nbsp;<span class="op" id="4630849">:=</span>&nbsp;<span class="ident" id="4630852"><a href="/runtime/pprof/pprof.go.html#4630484">f</a></span><span class="op" id="4630853">.</span><span class="ident" id="4630854">FileLine</span><span class="op" id="4630862">(</span><span class="ident" id="4630863"><a href="/runtime/pprof/pprof.go.html#4630610">tracepc</a></span><span class="op" id="4630870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4630875">name</span>&nbsp;<span class="op" id="4630880">:=</span>&nbsp;<span class="ident" id="4630883"><a href="/runtime/pprof/pprof.go.html#4630484">f</a></span><span class="op" id="4630884">.</span><span class="ident" id="4630885">Name</span><span class="op" id="4630889">(</span><span class="op" id="4630890">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630895">//&nbsp;Hide&nbsp;runtime.goexit&nbsp;and&nbsp;any&nbsp;runtime&nbsp;functions&nbsp;at&nbsp;the&nbsp;beginning.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4630965">//&nbsp;This&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;allocation&nbsp;traces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631016"><a href="/runtime/pprof/pprof.go.html#4630438">wasPanic</a></span>&nbsp;<span class="op" id="4631025">=</span>&nbsp;<span class="ident" id="4631027"><a href="/runtime/pprof/pprof.go.html#4630875">name</a></span>&nbsp;<span class="op" id="4631032">==</span>&nbsp;<span class="string" id="4631035">&#34;runtime.panic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631054">if</span>&nbsp;<span class="ident" id="4631057"><a href="/runtime/pprof/pprof.go.html#4630875">name</a></span>&nbsp;<span class="op" id="4631062">==</span>&nbsp;<span class="string" id="4631065">&#34;runtime.goexit&#34;</span>&nbsp;<span class="op" id="4631082">||</span>&nbsp;<span class="op" id="4631085">!</span><span class="ident" id="4631086"><a href="/runtime/pprof/pprof.go.html#4630419">show</a></span>&nbsp;<span class="op" id="4631091">&amp;&amp;</span>&nbsp;<span class="ident" id="4631094"><a href="/runtime/pprof/pprof.go.html#4622140">strings</a></span><span class="op" id="4631101">.</span><span class="ident" id="4631102">HasPrefix</span><span class="op" id="4631111">(</span><span class="ident" id="4631112"><a href="/runtime/pprof/pprof.go.html#4630875">name</a></span><span class="op" id="4631116">,</span>&nbsp;<span class="string" id="4631118">&#34;runtime.&#34;</span><span class="op" id="4631128">)</span>&nbsp;<span class="op" id="4631130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631136">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631153"><a href="/runtime/pprof/pprof.go.html#4630419">show</a></span>&nbsp;<span class="op" id="4631158">=</span>&nbsp;<span class="ident" id="4631160">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631168"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4631171">.</span><span class="ident" id="4631172">Fprintf</span><span class="op" id="4631179">(</span><span class="ident" id="4631180"><a href="/runtime/pprof/pprof.go.html#4630372">w</a></span><span class="op" id="4631181">,</span>&nbsp;<span class="string" id="4631183">&#34;#\t%#x\t%s+%#x\t%s:%d\n&#34;</span><span class="op" id="4631208">,</span>&nbsp;<span class="ident" id="4631210"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span><span class="op" id="4631212">,</span>&nbsp;<span class="ident" id="4631214"><a href="/runtime/pprof/pprof.go.html#4630875">name</a></span><span class="op" id="4631218">,</span>&nbsp;<span class="ident" id="4631220"><a href="/runtime/pprof/pprof.go.html#4630464">pc</a></span><span class="op" id="4631222">-</span><span class="ident" id="4631223"><a href="/runtime/pprof/pprof.go.html#4630484">f</a></span><span class="op" id="4631224">.</span><span class="ident" id="4631225">Entry</span><span class="op" id="4631230">(</span><span class="op" id="4631231">)</span><span class="op" id="4631232">,</span>&nbsp;<span class="ident" id="4631234"><a href="/runtime/pprof/pprof.go.html#4630838">file</a></span><span class="op" id="4631238">,</span>&nbsp;<span class="ident" id="4631240"><a href="/runtime/pprof/pprof.go.html#4630844">line</a></span><span class="op" id="4631244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631251">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631254">if</span>&nbsp;<span class="op" id="4631257">!</span><span class="ident" id="4631258"><a href="/runtime/pprof/pprof.go.html#4630419">show</a></span>&nbsp;<span class="op" id="4631263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4631267">//&nbsp;We&nbsp;didn&#39;t&nbsp;print&nbsp;anything;&nbsp;do&nbsp;it&nbsp;again,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4631311">//&nbsp;and&nbsp;this&nbsp;time&nbsp;include&nbsp;runtime&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631357"><a href="/runtime/pprof/pprof.go.html#4630355">printStackRecord</a></span><span class="op" id="4631373">(</span><span class="ident" id="4631374"><a href="/runtime/pprof/pprof.go.html#4630372">w</a></span><span class="op" id="4631375">,</span>&nbsp;<span class="ident" id="4631377"><a href="/runtime/pprof/pprof.go.html#4630385">stk</a></span><span class="op" id="4631380">,</span>&nbsp;<span class="ident" id="4631382">true</span><span class="op" id="4631386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631390">return</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4631398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4631401"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4631404">.</span><span class="ident" id="4631405">Fprintf</span><span class="op" id="4631412">(</span><span class="ident" id="4631413"><a href="/runtime/pprof/pprof.go.html#4630372">w</a></span><span class="op" id="4631414">,</span>&nbsp;<span class="string" id="4631416">&#34;\n&#34;</span><span class="op" id="4631420">)</span><br>
<span class="lineno"></span><span class="op" id="4631422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4631425">//&nbsp;Interface&nbsp;to&nbsp;system&nbsp;profiles.</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4631459">type</span>&nbsp;<span class="ident" id="4631464">byInUseBytes</span>&nbsp;<span class="op" id="4631477">[</span><span class="op" id="4631478">]</span><span class="ident" id="4631479"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4631486">.</span><span class="ident" id="4631487">MemProfileRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4631505">func</span>&nbsp;<span class="op" id="4631510">(</span><span class="ident" id="4631511">x</span>&nbsp;<span class="ident" id="4631513"><a href="/runtime/pprof/pprof.go.html#4631464">byInUseBytes</a></span><span class="op" id="4631525">)</span>&nbsp;<span class="ident" id="4631527">Len</span><span class="op" id="4631530">(</span><span class="op" id="4631531">)</span>&nbsp;<span class="builtintype" id="4631533">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631547">{</span>&nbsp;<span class="keyword" id="4631549">return</span>&nbsp;<span class="builtinfunc" id="4631556">len</span><span class="op" id="4631559">(</span><span class="ident" id="4631560"><a href="/runtime/pprof/pprof.go.html#4631511">x</a></span><span class="op" id="4631561">)</span>&nbsp;<span class="op" id="4631563">}</span><br>
<span class="lineno"></span><span class="keyword" id="4631565">func</span>&nbsp;<span class="op" id="4631570">(</span><span class="ident" id="4631571">x</span>&nbsp;<span class="ident" id="4631573"><a href="/runtime/pprof/pprof.go.html#4631464">byInUseBytes</a></span><span class="op" id="4631585">)</span>&nbsp;<span class="ident" id="4631587">Swap</span><span class="op" id="4631591">(</span><span class="ident" id="4631592">i</span><span class="op" id="4631593">,</span>&nbsp;<span class="ident" id="4631595">j</span>&nbsp;<span class="builtintype" id="4631597">int</span><span class="op" id="4631600">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631607">{</span>&nbsp;<span class="ident" id="4631609"><a href="/runtime/pprof/pprof.go.html#4631571">x</a></span><span class="op" id="4631610">[</span><span class="ident" id="4631611"><a href="/runtime/pprof/pprof.go.html#4631592">i</a></span><span class="op" id="4631612">]</span><span class="op" id="4631613">,</span>&nbsp;<span class="ident" id="4631615"><a href="/runtime/pprof/pprof.go.html#4631571">x</a></span><span class="op" id="4631616">[</span><span class="ident" id="4631617"><a href="/runtime/pprof/pprof.go.html#4631595">j</a></span><span class="op" id="4631618">]</span>&nbsp;<span class="op" id="4631620">=</span>&nbsp;<span class="ident" id="4631622"><a href="/runtime/pprof/pprof.go.html#4631571">x</a></span><span class="op" id="4631623">[</span><span class="ident" id="4631624"><a href="/runtime/pprof/pprof.go.html#4631595">j</a></span><span class="op" id="4631625">]</span><span class="op" id="4631626">,</span>&nbsp;<span class="ident" id="4631628"><a href="/runtime/pprof/pprof.go.html#4631571">x</a></span><span class="op" id="4631629">[</span><span class="ident" id="4631630"><a href="/runtime/pprof/pprof.go.html#4631592">i</a></span><span class="op" id="4631631">]</span>&nbsp;<span class="op" id="4631633">}</span><br>
<span class="lineno">365</span><span class="keyword" id="4631635">func</span>&nbsp;<span class="op" id="4631640">(</span><span class="ident" id="4631641">x</span>&nbsp;<span class="ident" id="4631643"><a href="/runtime/pprof/pprof.go.html#4631464">byInUseBytes</a></span><span class="op" id="4631655">)</span>&nbsp;<span class="ident" id="4631657">Less</span><span class="op" id="4631661">(</span><span class="ident" id="4631662">i</span><span class="op" id="4631663">,</span>&nbsp;<span class="ident" id="4631665">j</span>&nbsp;<span class="builtintype" id="4631667">int</span><span class="op" id="4631670">)</span>&nbsp;<span class="builtintype" id="4631672">bool</span>&nbsp;<span class="op" id="4631677">{</span>&nbsp;<span class="keyword" id="4631679">return</span>&nbsp;<span class="ident" id="4631686"><a href="/runtime/pprof/pprof.go.html#4631641">x</a></span><span class="op" id="4631687">[</span><span class="ident" id="4631688"><a href="/runtime/pprof/pprof.go.html#4631662">i</a></span><span class="op" id="4631689">]</span><span class="op" id="4631690">.</span><span class="ident" id="4631691">InUseBytes</span><span class="op" id="4631701">(</span><span class="op" id="4631702">)</span>&nbsp;<span class="op" id="4631704">&gt;</span>&nbsp;<span class="ident" id="4631706"><a href="/runtime/pprof/pprof.go.html#4631641">x</a></span><span class="op" id="4631707">[</span><span class="ident" id="4631708"><a href="/runtime/pprof/pprof.go.html#4631665">j</a></span><span class="op" id="4631709">]</span><span class="op" id="4631710">.</span><span class="ident" id="4631711">InUseBytes</span><span class="op" id="4631721">(</span><span class="op" id="4631722">)</span>&nbsp;<span class="op" id="4631724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4631727">//&nbsp;WriteHeapProfile&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Lookup(&#34;heap&#34;).WriteTo(w,&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="4631794">//&nbsp;It&nbsp;is&nbsp;preserved&nbsp;for&nbsp;backwards&nbsp;compatibility.</span><br>
<span class="lineno"></span><span class="keyword" id="4631842">func</span>&nbsp;<span class="ident" id="4631847">WriteHeapProfile</span><span class="op" id="4631863">(</span><span class="ident" id="4631864">w</span>&nbsp;<span class="ident" id="4631866"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4631868">.</span><span class="ident" id="4631869">Writer</span><span class="op" id="4631875">)</span>&nbsp;<span class="builtintype" id="4631877">error</span>&nbsp;<span class="op" id="4631883">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4631886">return</span>&nbsp;<span class="ident" id="4631893"><a href="/runtime/pprof/pprof.go.html#4632115">writeHeap</a></span><span class="op" id="4631902">(</span><span class="ident" id="4631903"><a href="/runtime/pprof/pprof.go.html#4631864">w</a></span><span class="op" id="4631904">,</span>&nbsp;<span class="num" id="4631906">0</span><span class="op" id="4631907">)</span><br>
<span class="lineno"></span><span class="op" id="4631909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4631912">//&nbsp;countHeap&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;heap&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4631976">func</span>&nbsp;<span class="ident" id="4631981">countHeap</span><span class="op" id="4631990">(</span><span class="op" id="4631991">)</span>&nbsp;<span class="builtintype" id="4631993">int</span>&nbsp;<span class="op" id="4631997">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632000">n</span><span class="op" id="4632001">,</span>&nbsp;<span class="ident" id="4632003">_</span>&nbsp;<span class="op" id="4632005">:=</span>&nbsp;<span class="ident" id="4632008"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4632015">.</span><span class="ident" id="4632016">MemProfile</span><span class="op" id="4632026">(</span><span class="ident" id="4632027">nil</span><span class="op" id="4632030">,</span>&nbsp;<span class="ident" id="4632032">true</span><span class="op" id="4632036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632039">return</span>&nbsp;<span class="ident" id="4632046"><a href="/runtime/pprof/pprof.go.html#4632000">n</a></span><br>
<span class="lineno"></span><span class="op" id="4632048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4632051">//&nbsp;writeHeap&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;heap&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno">380</span><span class="keyword" id="4632110">func</span>&nbsp;<span class="ident" id="4632115">writeHeap</span><span class="op" id="4632124">(</span><span class="ident" id="4632125">w</span>&nbsp;<span class="ident" id="4632127"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4632129">.</span><span class="ident" id="4632130">Writer</span><span class="op" id="4632136">,</span>&nbsp;<span class="ident" id="4632138">debug</span>&nbsp;<span class="builtintype" id="4632144">int</span><span class="op" id="4632147">)</span>&nbsp;<span class="builtintype" id="4632149">error</span>&nbsp;<span class="op" id="4632155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632158">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(MemProfile(nil,&nbsp;true)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632223">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632273">//&nbsp;There&#39;s&nbsp;a&nbsp;race—more&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632330">//&nbsp;the&nbsp;two&nbsp;calls—so&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632393">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632439">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632506">var</span>&nbsp;<span class="ident" id="4632510">p</span>&nbsp;<span class="op" id="4632512">[</span><span class="op" id="4632513">]</span><span class="ident" id="4632514"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4632521">.</span><span class="ident" id="4632522">MemProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632540">n</span><span class="op" id="4632541">,</span>&nbsp;<span class="ident" id="4632543">ok</span>&nbsp;<span class="op" id="4632546">:=</span>&nbsp;<span class="ident" id="4632549"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4632556">.</span><span class="ident" id="4632557">MemProfile</span><span class="op" id="4632567">(</span><span class="ident" id="4632568">nil</span><span class="op" id="4632571">,</span>&nbsp;<span class="ident" id="4632573">true</span><span class="op" id="4632577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632580">for</span>&nbsp;<span class="op" id="4632584">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632588">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632638">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632686">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;MemProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632721"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span>&nbsp;<span class="op" id="4632723">=</span>&nbsp;<span class="builtinfunc" id="4632725">make</span><span class="op" id="4632729">(</span><span class="op" id="4632730">[</span><span class="op" id="4632731">]</span><span class="ident" id="4632732"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4632739">.</span><span class="ident" id="4632740">MemProfileRecord</span><span class="op" id="4632756">,</span>&nbsp;<span class="ident" id="4632758"><a href="/runtime/pprof/pprof.go.html#4632540">n</a></span><span class="op" id="4632759">+</span><span class="num" id="4632760">50</span><span class="op" id="4632762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632766"><a href="/runtime/pprof/pprof.go.html#4632540">n</a></span><span class="op" id="4632767">,</span>&nbsp;<span class="ident" id="4632769"><a href="/runtime/pprof/pprof.go.html#4632543">ok</a></span>&nbsp;<span class="op" id="4632772">=</span>&nbsp;<span class="ident" id="4632774"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4632781">.</span><span class="ident" id="4632782">MemProfile</span><span class="op" id="4632792">(</span><span class="ident" id="4632793"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span><span class="op" id="4632794">,</span>&nbsp;<span class="ident" id="4632796">true</span><span class="op" id="4632800">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632804">if</span>&nbsp;<span class="ident" id="4632807"><a href="/runtime/pprof/pprof.go.html#4632543">ok</a></span>&nbsp;<span class="op" id="4632810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632815"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span>&nbsp;<span class="op" id="4632817">=</span>&nbsp;<span class="ident" id="4632819"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span><span class="op" id="4632820">[</span><span class="num" id="4632821">0</span><span class="op" id="4632822">:</span><span class="ident" id="4632823"><a href="/runtime/pprof/pprof.go.html#4632540">n</a></span><span class="op" id="4632824">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632829">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4632837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4632841">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4632870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632874"><a href="/runtime/pprof/pprof.go.html#4622132">sort</a></span><span class="op" id="4632878">.</span><span class="ident" id="4632879">Sort</span><span class="op" id="4632883">(</span><span class="ident" id="4632884"><a href="/runtime/pprof/pprof.go.html#4631464">byInUseBytes</a></span><span class="op" id="4632896">(</span><span class="ident" id="4632897"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span><span class="op" id="4632898">)</span><span class="op" id="4632899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632903">b</span>&nbsp;<span class="op" id="4632905">:=</span>&nbsp;<span class="ident" id="4632908"><a href="/runtime/pprof/pprof.go.html#4622090">bufio</a></span><span class="op" id="4632913">.</span><span class="ident" id="4632914">NewWriter</span><span class="op" id="4632923">(</span><span class="ident" id="4632924"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4632925">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632928">var</span>&nbsp;<span class="ident" id="4632932">tw</span>&nbsp;<span class="op" id="4632935">*</span><span class="ident" id="4632936"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4632945">.</span><span class="ident" id="4632946">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632954"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span>&nbsp;<span class="op" id="4632956">=</span>&nbsp;<span class="ident" id="4632958"><a href="/runtime/pprof/pprof.go.html#4632903">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4632961">if</span>&nbsp;<span class="ident" id="4632964"><a href="/runtime/pprof/pprof.go.html#4632138">debug</a></span>&nbsp;<span class="op" id="4632970">&gt;</span>&nbsp;<span class="num" id="4632972">0</span>&nbsp;<span class="op" id="4632974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4632978"><a href="/runtime/pprof/pprof.go.html#4632932">tw</a></span>&nbsp;<span class="op" id="4632981">=</span>&nbsp;<span class="ident" id="4632983"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4632992">.</span><span class="ident" id="4632993">NewWriter</span><span class="op" id="4633002">(</span><span class="ident" id="4633003"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633004">,</span>&nbsp;<span class="num" id="4633006">1</span><span class="op" id="4633007">,</span>&nbsp;<span class="num" id="4633009">8</span><span class="op" id="4633010">,</span>&nbsp;<span class="num" id="4633012">1</span><span class="op" id="4633013">,</span>&nbsp;<span class="string" id="4633015">&#39;\t&#39;</span><span class="op" id="4633019">,</span>&nbsp;<span class="num" id="4633021">0</span><span class="op" id="4633022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633026"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span>&nbsp;<span class="op" id="4633028">=</span>&nbsp;<span class="ident" id="4633030"><a href="/runtime/pprof/pprof.go.html#4632932">tw</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4633034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633038">var</span>&nbsp;<span class="ident" id="4633042">total</span>&nbsp;<span class="ident" id="4633048"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4633055">.</span><span class="ident" id="4633056">MemProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633074">for</span>&nbsp;<span class="ident" id="4633078">i</span>&nbsp;<span class="op" id="4633080">:=</span>&nbsp;<span class="keyword" id="4633083">range</span>&nbsp;<span class="ident" id="4633089"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span>&nbsp;<span class="op" id="4633091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633095">r</span>&nbsp;<span class="op" id="4633097">:=</span>&nbsp;<span class="op" id="4633100">&amp;</span><span class="ident" id="4633101"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span><span class="op" id="4633102">[</span><span class="ident" id="4633103"><a href="/runtime/pprof/pprof.go.html#4633078">i</a></span><span class="op" id="4633104">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633108"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633113">.</span><span class="ident" id="4633114">AllocBytes</span>&nbsp;<span class="op" id="4633125">+=</span>&nbsp;<span class="ident" id="4633128"><a href="/runtime/pprof/pprof.go.html#4633095">r</a></span><span class="op" id="4633129">.</span><span class="ident" id="4633130">AllocBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633143"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633148">.</span><span class="ident" id="4633149">AllocObjects</span>&nbsp;<span class="op" id="4633162">+=</span>&nbsp;<span class="ident" id="4633165"><a href="/runtime/pprof/pprof.go.html#4633095">r</a></span><span class="op" id="4633166">.</span><span class="ident" id="4633167">AllocObjects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633182"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633187">.</span><span class="ident" id="4633188">FreeBytes</span>&nbsp;<span class="op" id="4633198">+=</span>&nbsp;<span class="ident" id="4633201"><a href="/runtime/pprof/pprof.go.html#4633095">r</a></span><span class="op" id="4633202">.</span><span class="ident" id="4633203">FreeBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633215"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633220">.</span><span class="ident" id="4633221">FreeObjects</span>&nbsp;<span class="op" id="4633233">+=</span>&nbsp;<span class="ident" id="4633236"><a href="/runtime/pprof/pprof.go.html#4633095">r</a></span><span class="op" id="4633237">.</span><span class="ident" id="4633238">FreeObjects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4633251">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4633255">//&nbsp;Technically&nbsp;the&nbsp;rate&nbsp;is&nbsp;MemProfileRate&nbsp;not&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4633320">//&nbsp;but&nbsp;early&nbsp;versions&nbsp;of&nbsp;the&nbsp;C++&nbsp;heap&nbsp;profiler&nbsp;reported&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4633395">//&nbsp;so&nbsp;that&#39;s&nbsp;what&nbsp;pprof&nbsp;has&nbsp;come&nbsp;to&nbsp;expect.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633440"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4633443">.</span><span class="ident" id="4633444">Fprintf</span><span class="op" id="4633451">(</span><span class="ident" id="4633452"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633453">,</span>&nbsp;<span class="string" id="4633455">&#34;heap&nbsp;profile:&nbsp;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&nbsp;heap/%d\n&#34;</span><span class="op" id="4633498">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633502"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633507">.</span><span class="ident" id="4633508">InUseObjects</span><span class="op" id="4633520">(</span><span class="op" id="4633521">)</span><span class="op" id="4633522">,</span>&nbsp;<span class="ident" id="4633524"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633529">.</span><span class="ident" id="4633530">InUseBytes</span><span class="op" id="4633540">(</span><span class="op" id="4633541">)</span><span class="op" id="4633542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633546"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633551">.</span><span class="ident" id="4633552">AllocObjects</span><span class="op" id="4633564">,</span>&nbsp;<span class="ident" id="4633566"><a href="/runtime/pprof/pprof.go.html#4633042">total</a></span><span class="op" id="4633571">.</span><span class="ident" id="4633572">AllocBytes</span><span class="op" id="4633582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4633586">2</span><span class="op" id="4633587">*</span><span class="ident" id="4633588"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4633595">.</span><span class="ident" id="4633596">MemProfileRate</span><span class="op" id="4633610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633614">for</span>&nbsp;<span class="ident" id="4633618">i</span>&nbsp;<span class="op" id="4633620">:=</span>&nbsp;<span class="keyword" id="4633623">range</span>&nbsp;<span class="ident" id="4633629"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span>&nbsp;<span class="op" id="4633631">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633635">r</span>&nbsp;<span class="op" id="4633637">:=</span>&nbsp;<span class="op" id="4633640">&amp;</span><span class="ident" id="4633641"><a href="/runtime/pprof/pprof.go.html#4632510">p</a></span><span class="op" id="4633642">[</span><span class="ident" id="4633643"><a href="/runtime/pprof/pprof.go.html#4633618">i</a></span><span class="op" id="4633644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633648"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4633651">.</span><span class="ident" id="4633652">Fprintf</span><span class="op" id="4633659">(</span><span class="ident" id="4633660"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633661">,</span>&nbsp;<span class="string" id="4633663">&#34;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&#34;</span><span class="op" id="4633682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633687"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633688">.</span><span class="ident" id="4633689">InUseObjects</span><span class="op" id="4633701">(</span><span class="op" id="4633702">)</span><span class="op" id="4633703">,</span>&nbsp;<span class="ident" id="4633705"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633706">.</span><span class="ident" id="4633707">InUseBytes</span><span class="op" id="4633717">(</span><span class="op" id="4633718">)</span><span class="op" id="4633719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633724"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633725">.</span><span class="ident" id="4633726">AllocObjects</span><span class="op" id="4633738">,</span>&nbsp;<span class="ident" id="4633740"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633741">.</span><span class="ident" id="4633742">AllocBytes</span><span class="op" id="4633752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633756">for</span>&nbsp;<span class="ident" id="4633760">_</span><span class="op" id="4633761">,</span>&nbsp;<span class="ident" id="4633763">pc</span>&nbsp;<span class="op" id="4633766">:=</span>&nbsp;<span class="keyword" id="4633769">range</span>&nbsp;<span class="ident" id="4633775"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633776">.</span><span class="ident" id="4633777">Stack</span><span class="op" id="4633782">(</span><span class="op" id="4633783">)</span>&nbsp;<span class="op" id="4633785">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633790"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4633793">.</span><span class="ident" id="4633794">Fprintf</span><span class="op" id="4633801">(</span><span class="ident" id="4633802"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633803">,</span>&nbsp;<span class="string" id="4633805">&#34;&nbsp;%#x&#34;</span><span class="op" id="4633811">,</span>&nbsp;<span class="ident" id="4633813"><a href="/runtime/pprof/pprof.go.html#4633763">pc</a></span><span class="op" id="4633815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4633819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633823"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4633826">.</span><span class="ident" id="4633827">Fprintf</span><span class="op" id="4633834">(</span><span class="ident" id="4633835"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633836">,</span>&nbsp;<span class="string" id="4633838">&#34;\n&#34;</span><span class="op" id="4633842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633846">if</span>&nbsp;<span class="ident" id="4633849"><a href="/runtime/pprof/pprof.go.html#4632138">debug</a></span>&nbsp;<span class="op" id="4633855">&gt;</span>&nbsp;<span class="num" id="4633857">0</span>&nbsp;<span class="op" id="4633859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4633864"><a href="/runtime/pprof/pprof.go.html#4630355">printStackRecord</a></span><span class="op" id="4633880">(</span><span class="ident" id="4633881"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4633882">,</span>&nbsp;<span class="ident" id="4633884"><a href="/runtime/pprof/pprof.go.html#4633635">r</a></span><span class="op" id="4633885">.</span><span class="ident" id="4633886">Stack</span><span class="op" id="4633891">(</span><span class="op" id="4633892">)</span><span class="op" id="4633893">,</span>&nbsp;<span class="ident" id="4633895">false</span><span class="op" id="4633900">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4633904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4633907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4633911">//&nbsp;Print&nbsp;memstats&nbsp;information&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4633947">//&nbsp;Pprof&nbsp;will&nbsp;ignore,&nbsp;but&nbsp;useful&nbsp;for&nbsp;people</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4633992">if</span>&nbsp;<span class="ident" id="4633995"><a href="/runtime/pprof/pprof.go.html#4632138">debug</a></span>&nbsp;<span class="op" id="4634001">&gt;</span>&nbsp;<span class="num" id="4634003">0</span>&nbsp;<span class="op" id="4634005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634009">s</span>&nbsp;<span class="op" id="4634011">:=</span>&nbsp;<span class="builtinfunc" id="4634014">new</span><span class="op" id="4634017">(</span><span class="ident" id="4634018"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4634025">.</span><span class="ident" id="4634026">MemStats</span><span class="op" id="4634034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634038"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4634045">.</span><span class="ident" id="4634046">ReadMemStats</span><span class="op" id="4634058">(</span><span class="ident" id="4634059"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634064"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634067">.</span><span class="ident" id="4634068">Fprintf</span><span class="op" id="4634075">(</span><span class="ident" id="4634076"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634077">,</span>&nbsp;<span class="string" id="4634079">&#34;\n#&nbsp;runtime.MemStats\n&#34;</span><span class="op" id="4634103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634107"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634110">.</span><span class="ident" id="4634111">Fprintf</span><span class="op" id="4634118">(</span><span class="ident" id="4634119"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634120">,</span>&nbsp;<span class="string" id="4634122">&#34;#&nbsp;Alloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634138">,</span>&nbsp;<span class="ident" id="4634140"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634141">.</span><span class="ident" id="4634142">Alloc</span><span class="op" id="4634147">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634151"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634154">.</span><span class="ident" id="4634155">Fprintf</span><span class="op" id="4634162">(</span><span class="ident" id="4634163"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634164">,</span>&nbsp;<span class="string" id="4634166">&#34;#&nbsp;TotalAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634187">,</span>&nbsp;<span class="ident" id="4634189"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634190">.</span><span class="ident" id="4634191">TotalAlloc</span><span class="op" id="4634201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634205"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634208">.</span><span class="ident" id="4634209">Fprintf</span><span class="op" id="4634216">(</span><span class="ident" id="4634217"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634218">,</span>&nbsp;<span class="string" id="4634220">&#34;#&nbsp;Sys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634234">,</span>&nbsp;<span class="ident" id="4634236"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634237">.</span><span class="ident" id="4634238">Sys</span><span class="op" id="4634241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634245"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634248">.</span><span class="ident" id="4634249">Fprintf</span><span class="op" id="4634256">(</span><span class="ident" id="4634257"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634258">,</span>&nbsp;<span class="string" id="4634260">&#34;#&nbsp;Lookups&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634278">,</span>&nbsp;<span class="ident" id="4634280"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634281">.</span><span class="ident" id="4634282">Lookups</span><span class="op" id="4634289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634293"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634296">.</span><span class="ident" id="4634297">Fprintf</span><span class="op" id="4634304">(</span><span class="ident" id="4634305"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634306">,</span>&nbsp;<span class="string" id="4634308">&#34;#&nbsp;Mallocs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634326">,</span>&nbsp;<span class="ident" id="4634328"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634329">.</span><span class="ident" id="4634330">Mallocs</span><span class="op" id="4634337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634341"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634344">.</span><span class="ident" id="4634345">Fprintf</span><span class="op" id="4634352">(</span><span class="ident" id="4634353"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634354">,</span>&nbsp;<span class="string" id="4634356">&#34;#&nbsp;Frees&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634372">,</span>&nbsp;<span class="ident" id="4634374"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634375">.</span><span class="ident" id="4634376">Frees</span><span class="op" id="4634381">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634386"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634389">.</span><span class="ident" id="4634390">Fprintf</span><span class="op" id="4634397">(</span><span class="ident" id="4634398"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634399">,</span>&nbsp;<span class="string" id="4634401">&#34;#&nbsp;HeapAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634421">,</span>&nbsp;<span class="ident" id="4634423"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634424">.</span><span class="ident" id="4634425">HeapAlloc</span><span class="op" id="4634434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634438"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634441">.</span><span class="ident" id="4634442">Fprintf</span><span class="op" id="4634449">(</span><span class="ident" id="4634450"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634451">,</span>&nbsp;<span class="string" id="4634453">&#34;#&nbsp;HeapSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634471">,</span>&nbsp;<span class="ident" id="4634473"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634474">.</span><span class="ident" id="4634475">HeapSys</span><span class="op" id="4634482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634486"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634489">.</span><span class="ident" id="4634490">Fprintf</span><span class="op" id="4634497">(</span><span class="ident" id="4634498"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634499">,</span>&nbsp;<span class="string" id="4634501">&#34;#&nbsp;HeapIdle&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634520">,</span>&nbsp;<span class="ident" id="4634522"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634523">.</span><span class="ident" id="4634524">HeapIdle</span><span class="op" id="4634532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634536"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634539">.</span><span class="ident" id="4634540">Fprintf</span><span class="op" id="4634547">(</span><span class="ident" id="4634548"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634549">,</span>&nbsp;<span class="string" id="4634551">&#34;#&nbsp;HeapInuse&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634571">,</span>&nbsp;<span class="ident" id="4634573"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634574">.</span><span class="ident" id="4634575">HeapInuse</span><span class="op" id="4634584">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634588"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634591">.</span><span class="ident" id="4634592">Fprintf</span><span class="op" id="4634599">(</span><span class="ident" id="4634600"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634601">,</span>&nbsp;<span class="string" id="4634603">&#34;#&nbsp;HeapReleased&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634626">,</span>&nbsp;<span class="ident" id="4634628"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634629">.</span><span class="ident" id="4634630">HeapReleased</span><span class="op" id="4634642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634646"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634649">.</span><span class="ident" id="4634650">Fprintf</span><span class="op" id="4634657">(</span><span class="ident" id="4634658"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634659">,</span>&nbsp;<span class="string" id="4634661">&#34;#&nbsp;HeapObjects&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634683">,</span>&nbsp;<span class="ident" id="4634685"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634686">.</span><span class="ident" id="4634687">HeapObjects</span><span class="op" id="4634698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634703"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634706">.</span><span class="ident" id="4634707">Fprintf</span><span class="op" id="4634714">(</span><span class="ident" id="4634715"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634716">,</span>&nbsp;<span class="string" id="4634718">&#34;#&nbsp;Stack&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4634739">,</span>&nbsp;<span class="ident" id="4634741"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634742">.</span><span class="ident" id="4634743">StackInuse</span><span class="op" id="4634753">,</span>&nbsp;<span class="ident" id="4634755"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634756">.</span><span class="ident" id="4634757">StackSys</span><span class="op" id="4634765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634769"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634772">.</span><span class="ident" id="4634773">Fprintf</span><span class="op" id="4634780">(</span><span class="ident" id="4634781"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634782">,</span>&nbsp;<span class="string" id="4634784">&#34;#&nbsp;MSpan&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4634805">,</span>&nbsp;<span class="ident" id="4634807"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634808">.</span><span class="ident" id="4634809">MSpanInuse</span><span class="op" id="4634819">,</span>&nbsp;<span class="ident" id="4634821"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634822">.</span><span class="ident" id="4634823">MSpanSys</span><span class="op" id="4634831">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634835"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634838">.</span><span class="ident" id="4634839">Fprintf</span><span class="op" id="4634846">(</span><span class="ident" id="4634847"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634848">,</span>&nbsp;<span class="string" id="4634850">&#34;#&nbsp;MCache&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4634872">,</span>&nbsp;<span class="ident" id="4634874"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634875">.</span><span class="ident" id="4634876">MCacheInuse</span><span class="op" id="4634887">,</span>&nbsp;<span class="ident" id="4634889"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634890">.</span><span class="ident" id="4634891">MCacheSys</span><span class="op" id="4634900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634904"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634907">.</span><span class="ident" id="4634908">Fprintf</span><span class="op" id="4634915">(</span><span class="ident" id="4634916"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634917">,</span>&nbsp;<span class="string" id="4634919">&#34;#&nbsp;BuckHashSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634941">,</span>&nbsp;<span class="ident" id="4634943"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634944">.</span><span class="ident" id="4634945">BuckHashSys</span><span class="op" id="4634956">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4634961"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4634964">.</span><span class="ident" id="4634965">Fprintf</span><span class="op" id="4634972">(</span><span class="ident" id="4634973"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4634974">,</span>&nbsp;<span class="string" id="4634976">&#34;#&nbsp;NextGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4634993">,</span>&nbsp;<span class="ident" id="4634995"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4634996">.</span><span class="ident" id="4634997">NextGC</span><span class="op" id="4635003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635007"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4635010">.</span><span class="ident" id="4635011">Fprintf</span><span class="op" id="4635018">(</span><span class="ident" id="4635019"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4635020">,</span>&nbsp;<span class="string" id="4635022">&#34;#&nbsp;PauseNs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4635040">,</span>&nbsp;<span class="ident" id="4635042"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4635043">.</span><span class="ident" id="4635044">PauseNs</span><span class="op" id="4635051">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635055"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4635058">.</span><span class="ident" id="4635059">Fprintf</span><span class="op" id="4635066">(</span><span class="ident" id="4635067"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4635068">,</span>&nbsp;<span class="string" id="4635070">&#34;#&nbsp;NumGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4635086">,</span>&nbsp;<span class="ident" id="4635088"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4635089">.</span><span class="ident" id="4635090">NumGC</span><span class="op" id="4635095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635099"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4635102">.</span><span class="ident" id="4635103">Fprintf</span><span class="op" id="4635110">(</span><span class="ident" id="4635111"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4635112">,</span>&nbsp;<span class="string" id="4635114">&#34;#&nbsp;EnableGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="4635133">,</span>&nbsp;<span class="ident" id="4635135"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4635136">.</span><span class="ident" id="4635137">EnableGC</span><span class="op" id="4635145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635149"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4635152">.</span><span class="ident" id="4635153">Fprintf</span><span class="op" id="4635160">(</span><span class="ident" id="4635161"><a href="/runtime/pprof/pprof.go.html#4632125">w</a></span><span class="op" id="4635162">,</span>&nbsp;<span class="string" id="4635164">&#34;#&nbsp;DebugGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="4635182">,</span>&nbsp;<span class="ident" id="4635184"><a href="/runtime/pprof/pprof.go.html#4634009">s</a></span><span class="op" id="4635185">.</span><span class="ident" id="4635186">DebugGC</span><span class="op" id="4635193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4635196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635200">if</span>&nbsp;<span class="ident" id="4635203"><a href="/runtime/pprof/pprof.go.html#4632932">tw</a></span>&nbsp;<span class="op" id="4635206">!=</span>&nbsp;<span class="ident" id="4635209">nil</span>&nbsp;<span class="op" id="4635213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635217"><a href="/runtime/pprof/pprof.go.html#4632932">tw</a></span><span class="op" id="4635219">.</span><span class="ident" id="4635220">Flush</span><span class="op" id="4635225">(</span><span class="op" id="4635226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4635229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635232">return</span>&nbsp;<span class="ident" id="4635239"><a href="/runtime/pprof/pprof.go.html#4632903">b</a></span><span class="op" id="4635240">.</span><span class="ident" id="4635241">Flush</span><span class="op" id="4635246">(</span><span class="op" id="4635247">)</span><br>
<span class="lineno"></span><span class="op" id="4635249">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="4635252">//&nbsp;countThreadCreate&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;current&nbsp;ThreadCreateProfile.</span><br>
<span class="lineno"></span><span class="keyword" id="4635326">func</span>&nbsp;<span class="ident" id="4635331">countThreadCreate</span><span class="op" id="4635348">(</span><span class="op" id="4635349">)</span>&nbsp;<span class="builtintype" id="4635351">int</span>&nbsp;<span class="op" id="4635355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4635358">n</span><span class="op" id="4635359">,</span>&nbsp;<span class="ident" id="4635361">_</span>&nbsp;<span class="op" id="4635363">:=</span>&nbsp;<span class="ident" id="4635366"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4635373">.</span><span class="ident" id="4635374">ThreadCreateProfile</span><span class="op" id="4635393">(</span><span class="ident" id="4635394">nil</span><span class="op" id="4635397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635400">return</span>&nbsp;<span class="ident" id="4635407"><a href="/runtime/pprof/pprof.go.html#4635358">n</a></span><br>
<span class="lineno">485</span><span class="op" id="4635409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4635412">//&nbsp;writeThreadCreate&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;ThreadCreateProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4635486">func</span>&nbsp;<span class="ident" id="4635491">writeThreadCreate</span><span class="op" id="4635508">(</span><span class="ident" id="4635509">w</span>&nbsp;<span class="ident" id="4635511"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4635513">.</span><span class="ident" id="4635514">Writer</span><span class="op" id="4635520">,</span>&nbsp;<span class="ident" id="4635522">debug</span>&nbsp;<span class="builtintype" id="4635528">int</span><span class="op" id="4635531">)</span>&nbsp;<span class="builtintype" id="4635533">error</span>&nbsp;<span class="op" id="4635539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635542">return</span>&nbsp;<span class="ident" id="4635549"><a href="/runtime/pprof/pprof.go.html#4636528">writeRuntimeProfile</a></span><span class="op" id="4635568">(</span><span class="ident" id="4635569"><a href="/runtime/pprof/pprof.go.html#4635509">w</a></span><span class="op" id="4635570">,</span>&nbsp;<span class="ident" id="4635572"><a href="/runtime/pprof/pprof.go.html#4635522">debug</a></span><span class="op" id="4635577">,</span>&nbsp;<span class="string" id="4635579">&#34;threadcreate&#34;</span><span class="op" id="4635593">,</span>&nbsp;<span class="ident" id="4635595"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4635602">.</span><span class="ident" id="4635603">ThreadCreateProfile</span><span class="op" id="4635622">)</span><br>
<span class="lineno">490</span><span class="op" id="4635624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4635627">//&nbsp;countGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="4635679">func</span>&nbsp;<span class="ident" id="4635684">countGoroutine</span><span class="op" id="4635698">(</span><span class="op" id="4635699">)</span>&nbsp;<span class="builtintype" id="4635701">int</span>&nbsp;<span class="op" id="4635705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635708">return</span>&nbsp;<span class="ident" id="4635715"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4635722">.</span><span class="ident" id="4635723">NumGoroutine</span><span class="op" id="4635735">(</span><span class="op" id="4635736">)</span><br>
<span class="lineno">495</span><span class="op" id="4635738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4635741">//&nbsp;writeGoroutine&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;GoroutineProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4635809">func</span>&nbsp;<span class="ident" id="4635814">writeGoroutine</span><span class="op" id="4635828">(</span><span class="ident" id="4635829">w</span>&nbsp;<span class="ident" id="4635831"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4635833">.</span><span class="ident" id="4635834">Writer</span><span class="op" id="4635840">,</span>&nbsp;<span class="ident" id="4635842">debug</span>&nbsp;<span class="builtintype" id="4635848">int</span><span class="op" id="4635851">)</span>&nbsp;<span class="builtintype" id="4635853">error</span>&nbsp;<span class="op" id="4635859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635862">if</span>&nbsp;<span class="ident" id="4635865"><a href="/runtime/pprof/pprof.go.html#4635842">debug</a></span>&nbsp;<span class="op" id="4635871">&gt;=</span>&nbsp;<span class="num" id="4635874">2</span>&nbsp;<span class="op" id="4635876">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635880">return</span>&nbsp;<span class="ident" id="4635887"><a href="/runtime/pprof/pprof.go.html#4635999">writeGoroutineStacks</a></span><span class="op" id="4635907">(</span><span class="ident" id="4635908"><a href="/runtime/pprof/pprof.go.html#4635829">w</a></span><span class="op" id="4635909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4635912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4635915">return</span>&nbsp;<span class="ident" id="4635922"><a href="/runtime/pprof/pprof.go.html#4636528">writeRuntimeProfile</a></span><span class="op" id="4635941">(</span><span class="ident" id="4635942"><a href="/runtime/pprof/pprof.go.html#4635829">w</a></span><span class="op" id="4635943">,</span>&nbsp;<span class="ident" id="4635945"><a href="/runtime/pprof/pprof.go.html#4635842">debug</a></span><span class="op" id="4635950">,</span>&nbsp;<span class="string" id="4635952">&#34;goroutine&#34;</span><span class="op" id="4635963">,</span>&nbsp;<span class="ident" id="4635965"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4635972">.</span><span class="ident" id="4635973">GoroutineProfile</span><span class="op" id="4635989">)</span><br>
<span class="lineno"></span><span class="op" id="4635991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="4635994">func</span>&nbsp;<span class="ident" id="4635999">writeGoroutineStacks</span><span class="op" id="4636019">(</span><span class="ident" id="4636020">w</span>&nbsp;<span class="ident" id="4636022"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4636024">.</span><span class="ident" id="4636025">Writer</span><span class="op" id="4636031">)</span>&nbsp;<span class="builtintype" id="4636033">error</span>&nbsp;<span class="op" id="4636039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636042">//&nbsp;We&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;big&nbsp;the&nbsp;buffer&nbsp;needs&nbsp;to&nbsp;be&nbsp;to&nbsp;collect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636102">//&nbsp;all&nbsp;the&nbsp;goroutines.&nbsp;&nbsp;Start&nbsp;with&nbsp;1&nbsp;MB&nbsp;and&nbsp;try&nbsp;a&nbsp;few&nbsp;times,&nbsp;doubling&nbsp;each&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636184">//&nbsp;Give&nbsp;up&nbsp;and&nbsp;use&nbsp;a&nbsp;truncated&nbsp;trace&nbsp;if&nbsp;64&nbsp;MB&nbsp;is&nbsp;not&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636246">buf</span>&nbsp;<span class="op" id="4636250">:=</span>&nbsp;<span class="builtinfunc" id="4636253">make</span><span class="op" id="4636257">(</span><span class="op" id="4636258">[</span><span class="op" id="4636259">]</span><span class="builtintype" id="4636260">byte</span><span class="op" id="4636264">,</span>&nbsp;<span class="num" id="4636266">1</span><span class="op" id="4636267">&lt;&lt;</span><span class="num" id="4636269">20</span><span class="op" id="4636271">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636274">for</span>&nbsp;<span class="ident" id="4636278">i</span>&nbsp;<span class="op" id="4636280">:=</span>&nbsp;<span class="num" id="4636283">0</span><span class="op" id="4636284">;</span>&nbsp;<span class="op" id="4636286">;</span>&nbsp;<span class="ident" id="4636288"><a href="/runtime/pprof/pprof.go.html#4636278">i</a></span><span class="op" id="4636289">++</span>&nbsp;<span class="op" id="4636292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636296">n</span>&nbsp;<span class="op" id="4636298">:=</span>&nbsp;<span class="ident" id="4636301"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4636308">.</span><span class="ident" id="4636309">Stack</span><span class="op" id="4636314">(</span><span class="ident" id="4636315"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636318">,</span>&nbsp;<span class="ident" id="4636320">true</span><span class="op" id="4636324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636328">if</span>&nbsp;<span class="ident" id="4636331"><a href="/runtime/pprof/pprof.go.html#4636296">n</a></span>&nbsp;<span class="op" id="4636333">&lt;</span>&nbsp;<span class="builtinfunc" id="4636335">len</span><span class="op" id="4636338">(</span><span class="ident" id="4636339"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636342">)</span>&nbsp;<span class="op" id="4636344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636349"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span>&nbsp;<span class="op" id="4636353">=</span>&nbsp;<span class="ident" id="4636355"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636358">[</span><span class="op" id="4636359">:</span><span class="ident" id="4636360"><a href="/runtime/pprof/pprof.go.html#4636296">n</a></span><span class="op" id="4636361">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636366">break</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4636374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636378">if</span>&nbsp;<span class="builtinfunc" id="4636381">len</span><span class="op" id="4636384">(</span><span class="ident" id="4636385"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636388">)</span>&nbsp;<span class="op" id="4636390">&gt;=</span>&nbsp;<span class="num" id="4636393">64</span><span class="op" id="4636395">&lt;&lt;</span><span class="num" id="4636397">20</span>&nbsp;<span class="op" id="4636400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636405">//&nbsp;Filled&nbsp;64&nbsp;MB&nbsp;-&nbsp;stop&nbsp;there.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636438">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4636446">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636450"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span>&nbsp;<span class="op" id="4636454">=</span>&nbsp;<span class="builtinfunc" id="4636456">make</span><span class="op" id="4636460">(</span><span class="op" id="4636461">[</span><span class="op" id="4636462">]</span><span class="builtintype" id="4636463">byte</span><span class="op" id="4636467">,</span>&nbsp;<span class="num" id="4636469">2</span><span class="op" id="4636470">*</span><span class="builtinfunc" id="4636471">len</span><span class="op" id="4636474">(</span><span class="ident" id="4636475"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636478">)</span><span class="op" id="4636479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4636482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4636485">_</span><span class="op" id="4636486">,</span>&nbsp;<span class="ident" id="4636488">err</span>&nbsp;<span class="op" id="4636492">:=</span>&nbsp;<span class="ident" id="4636495"><a href="/runtime/pprof/pprof.go.html#4636020">w</a></span><span class="op" id="4636496">.</span><span class="ident" id="4636497">Write</span><span class="op" id="4636502">(</span><span class="ident" id="4636503"><a href="/runtime/pprof/pprof.go.html#4636246">buf</a></span><span class="op" id="4636506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636509">return</span>&nbsp;<span class="ident" id="4636516"><a href="/runtime/pprof/pprof.go.html#4636488">err</a></span><br>
<span class="lineno"></span><span class="op" id="4636520">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="4636523">func</span>&nbsp;<span class="ident" id="4636528">writeRuntimeProfile</span><span class="op" id="4636547">(</span><span class="ident" id="4636548">w</span>&nbsp;<span class="ident" id="4636550"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4636552">.</span><span class="ident" id="4636553">Writer</span><span class="op" id="4636559">,</span>&nbsp;<span class="ident" id="4636561">debug</span>&nbsp;<span class="builtintype" id="4636567">int</span><span class="op" id="4636570">,</span>&nbsp;<span class="ident" id="4636572">name</span>&nbsp;<span class="builtintype" id="4636577">string</span><span class="op" id="4636583">,</span>&nbsp;<span class="ident" id="4636585">fetch</span>&nbsp;<span class="keyword" id="4636591">func</span><span class="op" id="4636595">(</span><span class="op" id="4636596">[</span><span class="op" id="4636597">]</span><span class="ident" id="4636598"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4636605">.</span><span class="ident" id="4636606">StackRecord</span><span class="op" id="4636617">)</span>&nbsp;<span class="op" id="4636619">(</span><span class="builtintype" id="4636620">int</span><span class="op" id="4636623">,</span>&nbsp;<span class="builtintype" id="4636625">bool</span><span class="op" id="4636629">)</span><span class="op" id="4636630">)</span>&nbsp;<span class="builtintype" id="4636632">error</span>&nbsp;<span class="op" id="4636638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636641">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(fetch(nil)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636695">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636745">//&nbsp;There&#39;s&nbsp;a&nbsp;race—more&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636802">//&nbsp;the&nbsp;two&nbsp;calls—so&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636865">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4636911">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4636978">var</span>&nbsp;<span class="ident" id="4636982">p</span>&nbsp;<span class="op" id="4636984">[</span><span class="op" id="4636985">]</span><span class="ident" id="4636986"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4636993">.</span><span class="ident" id="4636994">StackRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637007">n</span><span class="op" id="4637008">,</span>&nbsp;<span class="ident" id="4637010">ok</span>&nbsp;<span class="op" id="4637013">:=</span>&nbsp;<span class="ident" id="4637016"><a href="/runtime/pprof/pprof.go.html#4636585">fetch</a></span><span class="op" id="4637021">(</span><span class="ident" id="4637022">nil</span><span class="op" id="4637025">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637028">for</span>&nbsp;<span class="op" id="4637032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637036">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637086">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637134">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;ThreadProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637172"><a href="/runtime/pprof/pprof.go.html#4636982">p</a></span>&nbsp;<span class="op" id="4637174">=</span>&nbsp;<span class="builtinfunc" id="4637176">make</span><span class="op" id="4637180">(</span><span class="op" id="4637181">[</span><span class="op" id="4637182">]</span><span class="ident" id="4637183"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4637190">.</span><span class="ident" id="4637191">StackRecord</span><span class="op" id="4637202">,</span>&nbsp;<span class="ident" id="4637204"><a href="/runtime/pprof/pprof.go.html#4637007">n</a></span><span class="op" id="4637205">+</span><span class="num" id="4637206">10</span><span class="op" id="4637208">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637212"><a href="/runtime/pprof/pprof.go.html#4637007">n</a></span><span class="op" id="4637213">,</span>&nbsp;<span class="ident" id="4637215"><a href="/runtime/pprof/pprof.go.html#4637010">ok</a></span>&nbsp;<span class="op" id="4637218">=</span>&nbsp;<span class="ident" id="4637220"><a href="/runtime/pprof/pprof.go.html#4636585">fetch</a></span><span class="op" id="4637225">(</span><span class="ident" id="4637226"><a href="/runtime/pprof/pprof.go.html#4636982">p</a></span><span class="op" id="4637227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637231">if</span>&nbsp;<span class="ident" id="4637234"><a href="/runtime/pprof/pprof.go.html#4637010">ok</a></span>&nbsp;<span class="op" id="4637237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637242"><a href="/runtime/pprof/pprof.go.html#4636982">p</a></span>&nbsp;<span class="op" id="4637244">=</span>&nbsp;<span class="ident" id="4637246"><a href="/runtime/pprof/pprof.go.html#4636982">p</a></span><span class="op" id="4637247">[</span><span class="num" id="4637248">0</span><span class="op" id="4637249">:</span><span class="ident" id="4637250"><a href="/runtime/pprof/pprof.go.html#4637007">n</a></span><span class="op" id="4637251">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637256">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4637264">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637268">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4637297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4637301">return</span>&nbsp;<span class="ident" id="4637308"><a href="/runtime/pprof/pprof.go.html#4629334">printCountProfile</a></span><span class="op" id="4637325">(</span><span class="ident" id="4637326"><a href="/runtime/pprof/pprof.go.html#4636548">w</a></span><span class="op" id="4637327">,</span>&nbsp;<span class="ident" id="4637329"><a href="/runtime/pprof/pprof.go.html#4636561">debug</a></span><span class="op" id="4637334">,</span>&nbsp;<span class="ident" id="4637336"><a href="/runtime/pprof/pprof.go.html#4636572">name</a></span><span class="op" id="4637340">,</span>&nbsp;<span class="ident" id="4637342"><a href="/runtime/pprof/pprof.go.html#4637369">runtimeProfile</a></span><span class="op" id="4637356">(</span><span class="ident" id="4637357"><a href="/runtime/pprof/pprof.go.html#4636982">p</a></span><span class="op" id="4637358">)</span><span class="op" id="4637359">)</span><br>
<span class="lineno"></span><span class="op" id="4637361">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="4637364">type</span>&nbsp;<span class="ident" id="4637369">runtimeProfile</span>&nbsp;<span class="op" id="4637384">[</span><span class="op" id="4637385">]</span><span class="ident" id="4637386"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4637393">.</span><span class="ident" id="4637394">StackRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4637407">func</span>&nbsp;<span class="op" id="4637412">(</span><span class="ident" id="4637413">p</span>&nbsp;<span class="ident" id="4637415"><a href="/runtime/pprof/pprof.go.html#4637369">runtimeProfile</a></span><span class="op" id="4637429">)</span>&nbsp;<span class="ident" id="4637431">Len</span><span class="op" id="4637434">(</span><span class="op" id="4637435">)</span>&nbsp;<span class="builtintype" id="4637437">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4637454">{</span>&nbsp;<span class="keyword" id="4637456">return</span>&nbsp;<span class="builtinfunc" id="4637463">len</span><span class="op" id="4637466">(</span><span class="ident" id="4637467"><a href="/runtime/pprof/pprof.go.html#4637413">p</a></span><span class="op" id="4637468">)</span>&nbsp;<span class="op" id="4637470">}</span><br>
<span class="lineno"></span><span class="keyword" id="4637472">func</span>&nbsp;<span class="op" id="4637477">(</span><span class="ident" id="4637478">p</span>&nbsp;<span class="ident" id="4637480"><a href="/runtime/pprof/pprof.go.html#4637369">runtimeProfile</a></span><span class="op" id="4637494">)</span>&nbsp;<span class="ident" id="4637496">Stack</span><span class="op" id="4637501">(</span><span class="ident" id="4637502">i</span>&nbsp;<span class="builtintype" id="4637504">int</span><span class="op" id="4637507">)</span>&nbsp;<span class="op" id="4637509">[</span><span class="op" id="4637510">]</span><span class="builtintype" id="4637511">uintptr</span>&nbsp;<span class="op" id="4637519">{</span>&nbsp;<span class="keyword" id="4637521">return</span>&nbsp;<span class="ident" id="4637528"><a href="/runtime/pprof/pprof.go.html#4637478">p</a></span><span class="op" id="4637529">[</span><span class="ident" id="4637530"><a href="/runtime/pprof/pprof.go.html#4637502">i</a></span><span class="op" id="4637531">]</span><span class="op" id="4637532">.</span><span class="ident" id="4637533">Stack</span><span class="op" id="4637538">(</span><span class="op" id="4637539">)</span>&nbsp;<span class="op" id="4637541">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="4637544">var</span>&nbsp;<span class="ident" id="4637548">cpu</span>&nbsp;<span class="keyword" id="4637552">struct</span>&nbsp;<span class="op" id="4637559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637562"><a href="/runtime/pprof/pprof.go.html#4622151">sync</a></span><span class="op" id="4637566">.</span><span class="ident" id="4637567">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637574">profiling</span>&nbsp;<span class="builtintype" id="4637584">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4637590">done</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4637600">chan</span>&nbsp;<span class="builtintype" id="4637605">bool</span><br>
<span class="lineno">560</span><span class="op" id="4637610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4637613">//&nbsp;StartCPUProfile&nbsp;enables&nbsp;CPU&nbsp;profiling&nbsp;for&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="4637679">//&nbsp;While&nbsp;profiling,&nbsp;the&nbsp;profile&nbsp;will&nbsp;be&nbsp;buffered&nbsp;and&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4637746">//&nbsp;StartCPUProfile&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;profiling&nbsp;is&nbsp;already&nbsp;enabled.</span><br>
<span class="lineno">565</span><span class="keyword" id="4637815">func</span>&nbsp;<span class="ident" id="4637820">StartCPUProfile</span><span class="op" id="4637835">(</span><span class="ident" id="4637836">w</span>&nbsp;<span class="ident" id="4637838"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4637840">.</span><span class="ident" id="4637841">Writer</span><span class="op" id="4637847">)</span>&nbsp;<span class="builtintype" id="4637849">error</span>&nbsp;<span class="op" id="4637855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637858">//&nbsp;The&nbsp;runtime&nbsp;routines&nbsp;allow&nbsp;a&nbsp;variable&nbsp;profiling&nbsp;rate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637916">//&nbsp;but&nbsp;in&nbsp;practice&nbsp;operating&nbsp;systems&nbsp;cannot&nbsp;trigger&nbsp;signals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4637977">//&nbsp;at&nbsp;more&nbsp;than&nbsp;about&nbsp;500&nbsp;Hz,&nbsp;and&nbsp;our&nbsp;processing&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638034">//&nbsp;signal&nbsp;is&nbsp;not&nbsp;cheap&nbsp;(mostly&nbsp;getting&nbsp;the&nbsp;stack&nbsp;trace).</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638092">//&nbsp;100&nbsp;Hz&nbsp;is&nbsp;a&nbsp;reasonable&nbsp;choice:&nbsp;it&nbsp;is&nbsp;frequent&nbsp;enough&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638152">//&nbsp;produce&nbsp;useful&nbsp;data,&nbsp;rare&nbsp;enough&nbsp;not&nbsp;to&nbsp;bog&nbsp;down&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638209">//&nbsp;system,&nbsp;and&nbsp;a&nbsp;nice&nbsp;round&nbsp;number&nbsp;to&nbsp;make&nbsp;it&nbsp;easy&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638264">//&nbsp;convert&nbsp;sample&nbsp;counts&nbsp;to&nbsp;seconds.&nbsp;&nbsp;Instead&nbsp;of&nbsp;requiring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638324">//&nbsp;each&nbsp;client&nbsp;to&nbsp;specify&nbsp;the&nbsp;frequency,&nbsp;we&nbsp;hard&nbsp;code&nbsp;it.</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638383">const</span>&nbsp;<span class="ident" id="4638389">hz</span>&nbsp;<span class="op" id="4638392">=</span>&nbsp;<span class="num" id="4638394">100</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638400"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638403">.</span><span class="ident" id="4638404">Lock</span><span class="op" id="4638408">(</span><span class="op" id="4638409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638412">defer</span>&nbsp;<span class="ident" id="4638418"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638421">.</span><span class="ident" id="4638422">Unlock</span><span class="op" id="4638428">(</span><span class="op" id="4638429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638432">if</span>&nbsp;<span class="ident" id="4638435"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638438">.</span><span class="ident" id="4638439">done</span>&nbsp;<span class="op" id="4638444">==</span>&nbsp;<span class="ident" id="4638447">nil</span>&nbsp;<span class="op" id="4638451">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638455"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638458">.</span><span class="ident" id="4638459">done</span>&nbsp;<span class="op" id="4638464">=</span>&nbsp;<span class="builtinfunc" id="4638466">make</span><span class="op" id="4638470">(</span><span class="keyword" id="4638471">chan</span>&nbsp;<span class="builtintype" id="4638476">bool</span><span class="op" id="4638480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4638483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4638486">//&nbsp;Double-check.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638504">if</span>&nbsp;<span class="ident" id="4638507"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638510">.</span><span class="ident" id="4638511">profiling</span>&nbsp;<span class="op" id="4638521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638525">return</span>&nbsp;<span class="ident" id="4638532"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4638535">.</span><span class="ident" id="4638536">Errorf</span><span class="op" id="4638542">(</span><span class="string" id="4638543">&#34;cpu&nbsp;profiling&nbsp;already&nbsp;in&nbsp;use&#34;</span><span class="op" id="4638573">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4638576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638579"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638582">.</span><span class="ident" id="4638583">profiling</span>&nbsp;<span class="op" id="4638593">=</span>&nbsp;<span class="ident" id="4638595">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638601"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4638608">.</span><span class="ident" id="4638609">SetCPUProfileRate</span><span class="op" id="4638626">(</span><span class="ident" id="4638627"><a href="/runtime/pprof/pprof.go.html#4638389">hz</a></span><span class="op" id="4638629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638632">go</span>&nbsp;<span class="ident" id="4638635"><a href="/runtime/pprof/pprof.go.html#4638672">profileWriter</a></span><span class="op" id="4638648">(</span><span class="ident" id="4638649"><a href="/runtime/pprof/pprof.go.html#4637836">w</a></span><span class="op" id="4638650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638653">return</span>&nbsp;<span class="ident" id="4638660">nil</span><br>
<span class="lineno">590</span><span class="op" id="4638664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4638667">func</span>&nbsp;<span class="ident" id="4638672">profileWriter</span><span class="op" id="4638685">(</span><span class="ident" id="4638686">w</span>&nbsp;<span class="ident" id="4638688"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4638690">.</span><span class="ident" id="4638691">Writer</span><span class="op" id="4638697">)</span>&nbsp;<span class="op" id="4638699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638702">for</span>&nbsp;<span class="op" id="4638706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638710">data</span>&nbsp;<span class="op" id="4638715">:=</span>&nbsp;<span class="ident" id="4638718"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4638725">.</span><span class="ident" id="4638726">CPUProfile</span><span class="op" id="4638736">(</span><span class="op" id="4638737">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638741">if</span>&nbsp;<span class="ident" id="4638744"><a href="/runtime/pprof/pprof.go.html#4638710">data</a></span>&nbsp;<span class="op" id="4638749">==</span>&nbsp;<span class="ident" id="4638752">nil</span>&nbsp;<span class="op" id="4638756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638761">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4638769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638773"><a href="/runtime/pprof/pprof.go.html#4638686">w</a></span><span class="op" id="4638774">.</span><span class="ident" id="4638775">Write</span><span class="op" id="4638780">(</span><span class="ident" id="4638781"><a href="/runtime/pprof/pprof.go.html#4638710">data</a></span><span class="op" id="4638785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4638788">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638791"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638794">.</span><span class="ident" id="4638795">done</span>&nbsp;<span class="op" id="4638800">&lt;-</span>&nbsp;<span class="ident" id="4638803">true</span><br>
<span class="lineno"></span><span class="op" id="4638808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4638811">//&nbsp;StopCPUProfile&nbsp;stops&nbsp;the&nbsp;current&nbsp;CPU&nbsp;profile,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="4638868">//&nbsp;StopCPUProfile&nbsp;only&nbsp;returns&nbsp;after&nbsp;all&nbsp;the&nbsp;writes&nbsp;for&nbsp;the</span><br>
<span class="lineno">605</span><span class="comment" id="4638928">//&nbsp;profile&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="4638955">func</span>&nbsp;<span class="ident" id="4638960">StopCPUProfile</span><span class="op" id="4638974">(</span><span class="op" id="4638975">)</span>&nbsp;<span class="op" id="4638977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4638980"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4638983">.</span><span class="ident" id="4638984">Lock</span><span class="op" id="4638988">(</span><span class="op" id="4638989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4638992">defer</span>&nbsp;<span class="ident" id="4638998"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4639001">.</span><span class="ident" id="4639002">Unlock</span><span class="op" id="4639008">(</span><span class="op" id="4639009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639013">if</span>&nbsp;<span class="op" id="4639016">!</span><span class="ident" id="4639017"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4639020">.</span><span class="ident" id="4639021">profiling</span>&nbsp;<span class="op" id="4639031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639035">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4639043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639046"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4639049">.</span><span class="ident" id="4639050">profiling</span>&nbsp;<span class="op" id="4639060">=</span>&nbsp;<span class="ident" id="4639062">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639069"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639076">.</span><span class="ident" id="4639077">SetCPUProfileRate</span><span class="op" id="4639094">(</span><span class="num" id="4639095">0</span><span class="op" id="4639096">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4639099">&lt;-</span><span class="ident" id="4639101"><a href="/runtime/pprof/pprof.go.html#4637548">cpu</a></span><span class="op" id="4639104">.</span><span class="ident" id="4639105">done</span><br>
<span class="lineno"></span><span class="op" id="4639110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4639113">type</span>&nbsp;<span class="ident" id="4639118">byCycles</span>&nbsp;<span class="op" id="4639127">[</span><span class="op" id="4639128">]</span><span class="ident" id="4639129"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639136">.</span><span class="ident" id="4639137">BlockProfileRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="keyword" id="4639157">func</span>&nbsp;<span class="op" id="4639162">(</span><span class="ident" id="4639163">x</span>&nbsp;<span class="ident" id="4639165"><a href="/runtime/pprof/pprof.go.html#4639118">byCycles</a></span><span class="op" id="4639173">)</span>&nbsp;<span class="ident" id="4639175">Len</span><span class="op" id="4639178">(</span><span class="op" id="4639179">)</span>&nbsp;<span class="builtintype" id="4639181">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639195">{</span>&nbsp;<span class="keyword" id="4639197">return</span>&nbsp;<span class="builtinfunc" id="4639204">len</span><span class="op" id="4639207">(</span><span class="ident" id="4639208"><a href="/runtime/pprof/pprof.go.html#4639163">x</a></span><span class="op" id="4639209">)</span>&nbsp;<span class="op" id="4639211">}</span><br>
<span class="lineno"></span><span class="keyword" id="4639213">func</span>&nbsp;<span class="op" id="4639218">(</span><span class="ident" id="4639219">x</span>&nbsp;<span class="ident" id="4639221"><a href="/runtime/pprof/pprof.go.html#4639118">byCycles</a></span><span class="op" id="4639229">)</span>&nbsp;<span class="ident" id="4639231">Swap</span><span class="op" id="4639235">(</span><span class="ident" id="4639236">i</span><span class="op" id="4639237">,</span>&nbsp;<span class="ident" id="4639239">j</span>&nbsp;<span class="builtintype" id="4639241">int</span><span class="op" id="4639244">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639251">{</span>&nbsp;<span class="ident" id="4639253"><a href="/runtime/pprof/pprof.go.html#4639219">x</a></span><span class="op" id="4639254">[</span><span class="ident" id="4639255"><a href="/runtime/pprof/pprof.go.html#4639236">i</a></span><span class="op" id="4639256">]</span><span class="op" id="4639257">,</span>&nbsp;<span class="ident" id="4639259"><a href="/runtime/pprof/pprof.go.html#4639219">x</a></span><span class="op" id="4639260">[</span><span class="ident" id="4639261"><a href="/runtime/pprof/pprof.go.html#4639239">j</a></span><span class="op" id="4639262">]</span>&nbsp;<span class="op" id="4639264">=</span>&nbsp;<span class="ident" id="4639266"><a href="/runtime/pprof/pprof.go.html#4639219">x</a></span><span class="op" id="4639267">[</span><span class="ident" id="4639268"><a href="/runtime/pprof/pprof.go.html#4639239">j</a></span><span class="op" id="4639269">]</span><span class="op" id="4639270">,</span>&nbsp;<span class="ident" id="4639272"><a href="/runtime/pprof/pprof.go.html#4639219">x</a></span><span class="op" id="4639273">[</span><span class="ident" id="4639274"><a href="/runtime/pprof/pprof.go.html#4639236">i</a></span><span class="op" id="4639275">]</span>&nbsp;<span class="op" id="4639277">}</span><br>
<span class="lineno"></span><span class="keyword" id="4639279">func</span>&nbsp;<span class="op" id="4639284">(</span><span class="ident" id="4639285">x</span>&nbsp;<span class="ident" id="4639287"><a href="/runtime/pprof/pprof.go.html#4639118">byCycles</a></span><span class="op" id="4639295">)</span>&nbsp;<span class="ident" id="4639297">Less</span><span class="op" id="4639301">(</span><span class="ident" id="4639302">i</span><span class="op" id="4639303">,</span>&nbsp;<span class="ident" id="4639305">j</span>&nbsp;<span class="builtintype" id="4639307">int</span><span class="op" id="4639310">)</span>&nbsp;<span class="builtintype" id="4639312">bool</span>&nbsp;<span class="op" id="4639317">{</span>&nbsp;<span class="keyword" id="4639319">return</span>&nbsp;<span class="ident" id="4639326"><a href="/runtime/pprof/pprof.go.html#4639285">x</a></span><span class="op" id="4639327">[</span><span class="ident" id="4639328"><a href="/runtime/pprof/pprof.go.html#4639302">i</a></span><span class="op" id="4639329">]</span><span class="op" id="4639330">.</span><span class="ident" id="4639331">Cycles</span>&nbsp;<span class="op" id="4639338">&gt;</span>&nbsp;<span class="ident" id="4639340"><a href="/runtime/pprof/pprof.go.html#4639285">x</a></span><span class="op" id="4639341">[</span><span class="ident" id="4639342"><a href="/runtime/pprof/pprof.go.html#4639305">j</a></span><span class="op" id="4639343">]</span><span class="op" id="4639344">.</span><span class="ident" id="4639345">Cycles</span>&nbsp;<span class="op" id="4639352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4639355">//&nbsp;countBlock&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;blocking&nbsp;profile.</span><br>
<span class="lineno">625</span><span class="keyword" id="4639424">func</span>&nbsp;<span class="ident" id="4639429">countBlock</span><span class="op" id="4639439">(</span><span class="op" id="4639440">)</span>&nbsp;<span class="builtintype" id="4639442">int</span>&nbsp;<span class="op" id="4639446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639449">n</span><span class="op" id="4639450">,</span>&nbsp;<span class="ident" id="4639452">_</span>&nbsp;<span class="op" id="4639454">:=</span>&nbsp;<span class="ident" id="4639457"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639464">.</span><span class="ident" id="4639465">BlockProfile</span><span class="op" id="4639477">(</span><span class="ident" id="4639478">nil</span><span class="op" id="4639481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639484">return</span>&nbsp;<span class="ident" id="4639491"><a href="/runtime/pprof/pprof.go.html#4639449">n</a></span><br>
<span class="lineno"></span><span class="op" id="4639493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="comment" id="4639496">//&nbsp;writeBlock&nbsp;writes&nbsp;the&nbsp;current&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4639552">func</span>&nbsp;<span class="ident" id="4639557">writeBlock</span><span class="op" id="4639567">(</span><span class="ident" id="4639568">w</span>&nbsp;<span class="ident" id="4639570"><a href="/runtime/pprof/pprof.go.html#4622115">io</a></span><span class="op" id="4639572">.</span><span class="ident" id="4639573">Writer</span><span class="op" id="4639579">,</span>&nbsp;<span class="ident" id="4639581">debug</span>&nbsp;<span class="builtintype" id="4639587">int</span><span class="op" id="4639590">)</span>&nbsp;<span class="builtintype" id="4639592">error</span>&nbsp;<span class="op" id="4639598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639601">var</span>&nbsp;<span class="ident" id="4639605">p</span>&nbsp;<span class="op" id="4639607">[</span><span class="op" id="4639608">]</span><span class="ident" id="4639609"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639616">.</span><span class="ident" id="4639617">BlockProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639637">n</span><span class="op" id="4639638">,</span>&nbsp;<span class="ident" id="4639640">ok</span>&nbsp;<span class="op" id="4639643">:=</span>&nbsp;<span class="ident" id="4639646"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639653">.</span><span class="ident" id="4639654">BlockProfile</span><span class="op" id="4639666">(</span><span class="ident" id="4639667">nil</span><span class="op" id="4639670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639673">for</span>&nbsp;<span class="op" id="4639677">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639681"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span>&nbsp;<span class="op" id="4639683">=</span>&nbsp;<span class="builtinfunc" id="4639685">make</span><span class="op" id="4639689">(</span><span class="op" id="4639690">[</span><span class="op" id="4639691">]</span><span class="ident" id="4639692"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639699">.</span><span class="ident" id="4639700">BlockProfileRecord</span><span class="op" id="4639718">,</span>&nbsp;<span class="ident" id="4639720"><a href="/runtime/pprof/pprof.go.html#4639637">n</a></span><span class="op" id="4639721">+</span><span class="num" id="4639722">50</span><span class="op" id="4639724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639728"><a href="/runtime/pprof/pprof.go.html#4639637">n</a></span><span class="op" id="4639729">,</span>&nbsp;<span class="ident" id="4639731"><a href="/runtime/pprof/pprof.go.html#4639640">ok</a></span>&nbsp;<span class="op" id="4639734">=</span>&nbsp;<span class="ident" id="4639736"><a href="/runtime/pprof/pprof.go.html#4622121">runtime</a></span><span class="op" id="4639743">.</span><span class="ident" id="4639744">BlockProfile</span><span class="op" id="4639756">(</span><span class="ident" id="4639757"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span><span class="op" id="4639758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639762">if</span>&nbsp;<span class="ident" id="4639765"><a href="/runtime/pprof/pprof.go.html#4639640">ok</a></span>&nbsp;<span class="op" id="4639768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639773"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span>&nbsp;<span class="op" id="4639775">=</span>&nbsp;<span class="ident" id="4639777"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span><span class="op" id="4639778">[</span><span class="op" id="4639779">:</span><span class="ident" id="4639780"><a href="/runtime/pprof/pprof.go.html#4639637">n</a></span><span class="op" id="4639781">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639786">break</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4639794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4639797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639801"><a href="/runtime/pprof/pprof.go.html#4622132">sort</a></span><span class="op" id="4639805">.</span><span class="ident" id="4639806">Sort</span><span class="op" id="4639810">(</span><span class="ident" id="4639811"><a href="/runtime/pprof/pprof.go.html#4639118">byCycles</a></span><span class="op" id="4639819">(</span><span class="ident" id="4639820"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span><span class="op" id="4639821">)</span><span class="op" id="4639822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639826">b</span>&nbsp;<span class="op" id="4639828">:=</span>&nbsp;<span class="ident" id="4639831"><a href="/runtime/pprof/pprof.go.html#4622090">bufio</a></span><span class="op" id="4639836">.</span><span class="ident" id="4639837">NewWriter</span><span class="op" id="4639846">(</span><span class="ident" id="4639847"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4639848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639851">var</span>&nbsp;<span class="ident" id="4639855">tw</span>&nbsp;<span class="op" id="4639858">*</span><span class="ident" id="4639859"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4639868">.</span><span class="ident" id="4639869">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639877"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span>&nbsp;<span class="op" id="4639879">=</span>&nbsp;<span class="ident" id="4639881"><a href="/runtime/pprof/pprof.go.html#4639826">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4639884">if</span>&nbsp;<span class="ident" id="4639887"><a href="/runtime/pprof/pprof.go.html#4639581">debug</a></span>&nbsp;<span class="op" id="4639893">&gt;</span>&nbsp;<span class="num" id="4639895">0</span>&nbsp;<span class="op" id="4639897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639901"><a href="/runtime/pprof/pprof.go.html#4639855">tw</a></span>&nbsp;<span class="op" id="4639904">=</span>&nbsp;<span class="ident" id="4639906"><a href="/runtime/pprof/pprof.go.html#4622159">tabwriter</a></span><span class="op" id="4639915">.</span><span class="ident" id="4639916">NewWriter</span><span class="op" id="4639925">(</span><span class="ident" id="4639926"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4639927">,</span>&nbsp;<span class="num" id="4639929">1</span><span class="op" id="4639930">,</span>&nbsp;<span class="num" id="4639932">8</span><span class="op" id="4639933">,</span>&nbsp;<span class="num" id="4639935">1</span><span class="op" id="4639936">,</span>&nbsp;<span class="string" id="4639938">&#39;\t&#39;</span><span class="op" id="4639942">,</span>&nbsp;<span class="num" id="4639944">0</span><span class="op" id="4639945">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639949"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span>&nbsp;<span class="op" id="4639951">=</span>&nbsp;<span class="ident" id="4639953"><a href="/runtime/pprof/pprof.go.html#4639855">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4639957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639961"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4639964">.</span><span class="ident" id="4639965">Fprintf</span><span class="op" id="4639972">(</span><span class="ident" id="4639973"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4639974">,</span>&nbsp;<span class="string" id="4639976">&#34;---&nbsp;contention:\n&#34;</span><span class="op" id="4639995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4639998"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4640001">.</span><span class="ident" id="4640002">Fprintf</span><span class="op" id="4640009">(</span><span class="ident" id="4640010"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4640011">,</span>&nbsp;<span class="string" id="4640013">&#34;cycles/second=%v\n&#34;</span><span class="op" id="4640033">,</span>&nbsp;<span class="ident" id="4640035"><a href="/runtime/pprof/pprof.go.html#4640354">runtime_cyclesPerSecond</a></span><span class="op" id="4640058">(</span><span class="op" id="4640059">)</span><span class="op" id="4640060">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4640063">for</span>&nbsp;<span class="ident" id="4640067">i</span>&nbsp;<span class="op" id="4640069">:=</span>&nbsp;<span class="keyword" id="4640072">range</span>&nbsp;<span class="ident" id="4640078"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span>&nbsp;<span class="op" id="4640080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640084">r</span>&nbsp;<span class="op" id="4640086">:=</span>&nbsp;<span class="op" id="4640089">&amp;</span><span class="ident" id="4640090"><a href="/runtime/pprof/pprof.go.html#4639605">p</a></span><span class="op" id="4640091">[</span><span class="ident" id="4640092"><a href="/runtime/pprof/pprof.go.html#4640067">i</a></span><span class="op" id="4640093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640097"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4640100">.</span><span class="ident" id="4640101">Fprintf</span><span class="op" id="4640108">(</span><span class="ident" id="4640109"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4640110">,</span>&nbsp;<span class="string" id="4640112">&#34;%v&nbsp;%v&nbsp;@&#34;</span><span class="op" id="4640121">,</span>&nbsp;<span class="ident" id="4640123"><a href="/runtime/pprof/pprof.go.html#4640084">r</a></span><span class="op" id="4640124">.</span><span class="ident" id="4640125">Cycles</span><span class="op" id="4640131">,</span>&nbsp;<span class="ident" id="4640133"><a href="/runtime/pprof/pprof.go.html#4640084">r</a></span><span class="op" id="4640134">.</span><span class="ident" id="4640135">Count</span><span class="op" id="4640140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4640144">for</span>&nbsp;<span class="ident" id="4640148">_</span><span class="op" id="4640149">,</span>&nbsp;<span class="ident" id="4640151">pc</span>&nbsp;<span class="op" id="4640154">:=</span>&nbsp;<span class="keyword" id="4640157">range</span>&nbsp;<span class="ident" id="4640163"><a href="/runtime/pprof/pprof.go.html#4640084">r</a></span><span class="op" id="4640164">.</span><span class="ident" id="4640165">Stack</span><span class="op" id="4640170">(</span><span class="op" id="4640171">)</span>&nbsp;<span class="op" id="4640173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640178"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4640181">.</span><span class="ident" id="4640182">Fprintf</span><span class="op" id="4640189">(</span><span class="ident" id="4640190"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4640191">,</span>&nbsp;<span class="string" id="4640193">&#34;&nbsp;%#x&#34;</span><span class="op" id="4640199">,</span>&nbsp;<span class="ident" id="4640201"><a href="/runtime/pprof/pprof.go.html#4640151">pc</a></span><span class="op" id="4640203">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4640207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640211"><a href="/runtime/pprof/pprof.go.html#4622108">fmt</a></span><span class="op" id="4640214">.</span><span class="ident" id="4640215">Fprint</span><span class="op" id="4640221">(</span><span class="ident" id="4640222"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4640223">,</span>&nbsp;<span class="string" id="4640225">&#34;\n&#34;</span><span class="op" id="4640229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4640233">if</span>&nbsp;<span class="ident" id="4640236"><a href="/runtime/pprof/pprof.go.html#4639581">debug</a></span>&nbsp;<span class="op" id="4640242">&gt;</span>&nbsp;<span class="num" id="4640244">0</span>&nbsp;<span class="op" id="4640246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640251"><a href="/runtime/pprof/pprof.go.html#4630355">printStackRecord</a></span><span class="op" id="4640267">(</span><span class="ident" id="4640268"><a href="/runtime/pprof/pprof.go.html#4639568">w</a></span><span class="op" id="4640269">,</span>&nbsp;<span class="ident" id="4640271"><a href="/runtime/pprof/pprof.go.html#4640084">r</a></span><span class="op" id="4640272">.</span><span class="ident" id="4640273">Stack</span><span class="op" id="4640278">(</span><span class="op" id="4640279">)</span><span class="op" id="4640280">,</span>&nbsp;<span class="ident" id="4640282">true</span><span class="op" id="4640286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4640290">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4640293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4640297">if</span>&nbsp;<span class="ident" id="4640300"><a href="/runtime/pprof/pprof.go.html#4639855">tw</a></span>&nbsp;<span class="op" id="4640303">!=</span>&nbsp;<span class="ident" id="4640306">nil</span>&nbsp;<span class="op" id="4640310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4640314"><a href="/runtime/pprof/pprof.go.html#4639855">tw</a></span><span class="op" id="4640316">.</span><span class="ident" id="4640317">Flush</span><span class="op" id="4640322">(</span><span class="op" id="4640323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4640326">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4640329">return</span>&nbsp;<span class="ident" id="4640336"><a href="/runtime/pprof/pprof.go.html#4639826">b</a></span><span class="op" id="4640337">.</span><span class="ident" id="4640338">Flush</span><span class="op" id="4640343">(</span><span class="op" id="4640344">)</span><br>
<span class="lineno"></span><span class="op" id="4640346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4640349">func</span>&nbsp;<span class="ident" id="4640354">runtime_cyclesPerSecond</span><span class="op" id="4640377">(</span><span class="op" id="4640378">)</span>&nbsp;<span class="ident" id="4640380">int64</span>
</div>
</body>
</html>
