<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html" class="current">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4631631">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4631686">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4631740">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4631791">package</span>&nbsp;<span class="ident" id="4631799">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4631805">import</span>&nbsp;<span class="op" id="4631812">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631815">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631822">&#34;net&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631829">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631840">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631851">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4631859">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4631874">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4631877">type</span>&nbsp;<span class="ident" id="4631882">InvalidReason</span>&nbsp;<span class="builtintype" id="4631896">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4631901">const</span>&nbsp;<span class="op" id="4631907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4631910">//&nbsp;NotAuthorizedToSign&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;another</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4631982">//&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632026">NotAuthorizedToSign</span>&nbsp;<span class="ident" id="4632046"><a href="/gostd/crypto/x509/verify.go.html#4631882">InvalidReason</a></span>&nbsp;<span class="op" id="4632060">=</span>&nbsp;<span class="ident" id="4632062">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632068">//&nbsp;Expired&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;has&nbsp;expired,&nbsp;based&nbsp;on&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632138">//&nbsp;given&nbsp;in&nbsp;the&nbsp;VerifyOptions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632170">Expired</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632179">//&nbsp;CANotAuthorizedForThisName&nbsp;results&nbsp;when&nbsp;an&nbsp;intermediate&nbsp;or&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632247">//&nbsp;certificate&nbsp;has&nbsp;a&nbsp;name&nbsp;constraint&nbsp;which&nbsp;doesn&#39;t&nbsp;include&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632316">//&nbsp;being&nbsp;checked.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632335">CANotAuthorizedForThisName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632363">//&nbsp;TooManyIntermediates&nbsp;results&nbsp;when&nbsp;a&nbsp;path&nbsp;length&nbsp;constraint&nbsp;is</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632429">//&nbsp;violated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632443">TooManyIntermediates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632465">//&nbsp;IncompatibleUsage&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&#39;s&nbsp;key&nbsp;usage&nbsp;indicates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632538">//&nbsp;that&nbsp;it&nbsp;may&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;a&nbsp;different&nbsp;purpose.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632592">IncompatibleUsage</span><br>
<span class="lineno">35</span><span class="op" id="4632610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4632613">//&nbsp;CertificateInvalidError&nbsp;results&nbsp;when&nbsp;an&nbsp;odd&nbsp;error&nbsp;occurs.&nbsp;Users&nbsp;of&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4632688">//&nbsp;library&nbsp;probably&nbsp;want&nbsp;to&nbsp;handle&nbsp;all&nbsp;these&nbsp;errors&nbsp;uniformly.</span><br>
<span class="lineno"></span><span class="keyword" id="4632751">type</span>&nbsp;<span class="ident" id="4632756">CertificateInvalidError</span>&nbsp;<span class="keyword" id="4632780">struct</span>&nbsp;<span class="op" id="4632787">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632790">Cert</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4632797">*</span><span class="ident" id="4632798"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632811">Reason</span>&nbsp;<span class="ident" id="4632818"><a href="/gostd/crypto/x509/verify.go.html#4631882">InvalidReason</a></span><br>
<span class="lineno"></span><span class="op" id="4632832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632835">func</span>&nbsp;<span class="op" id="4632840">(</span><span class="ident" id="4632841">e</span>&nbsp;<span class="ident" id="4632843"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4632866">)</span>&nbsp;<span class="ident" id="4632868">Error</span><span class="op" id="4632873">(</span><span class="op" id="4632874">)</span>&nbsp;<span class="builtintype" id="4632876">string</span>&nbsp;<span class="op" id="4632883">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632886">switch</span>&nbsp;<span class="ident" id="4632893"><a href="/gostd/crypto/x509/verify.go.html#4632841">e</a></span><span class="op" id="4632894">.</span><span class="ident" id="4632895"><a href="/gostd/crypto/x509/verify.go.html#4632811">Reason</a></span>&nbsp;<span class="op" id="4632902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632905">case</span>&nbsp;<span class="ident" id="4632910"><a href="/gostd/crypto/x509/verify.go.html#4632026">NotAuthorizedToSign</a></span><span class="op" id="4632929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632933">return</span>&nbsp;<span class="string" id="4632940">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;other&nbsp;certificates&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633006">case</span>&nbsp;<span class="ident" id="4633011"><a href="/gostd/crypto/x509/verify.go.html#4632170">Expired</a></span><span class="op" id="4633018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633022">return</span>&nbsp;<span class="string" id="4633029">&#34;x509:&nbsp;certificate&nbsp;has&nbsp;expired&nbsp;or&nbsp;is&nbsp;not&nbsp;yet&nbsp;valid&#34;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633082">case</span>&nbsp;<span class="ident" id="4633087"><a href="/gostd/crypto/x509/verify.go.html#4632335">CANotAuthorizedForThisName</a></span><span class="op" id="4633113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633117">return</span>&nbsp;<span class="string" id="4633124">&#34;x509:&nbsp;a&nbsp;root&nbsp;or&nbsp;intermediate&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;in&nbsp;this&nbsp;domain&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633209">case</span>&nbsp;<span class="ident" id="4633214"><a href="/gostd/crypto/x509/verify.go.html#4632443">TooManyIntermediates</a></span><span class="op" id="4633234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633238">return</span>&nbsp;<span class="string" id="4633245">&#34;x509:&nbsp;too&nbsp;many&nbsp;intermediates&nbsp;for&nbsp;path&nbsp;length&nbsp;constraint&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633304">case</span>&nbsp;<span class="ident" id="4633309"><a href="/gostd/crypto/x509/verify.go.html#4632592">IncompatibleUsage</a></span><span class="op" id="4633326">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633330">return</span>&nbsp;<span class="string" id="4633337">&#34;x509:&nbsp;certificate&nbsp;specifies&nbsp;an&nbsp;incompatible&nbsp;key&nbsp;usage&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633397">return</span>&nbsp;<span class="string" id="4633404">&#34;x509:&nbsp;unknown&nbsp;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="4633426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="4633429">//&nbsp;HostnameError&nbsp;results&nbsp;when&nbsp;the&nbsp;set&nbsp;of&nbsp;authorized&nbsp;names&nbsp;doesn&#39;t&nbsp;match&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4633505">//&nbsp;requested&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4633524">type</span>&nbsp;<span class="ident" id="4633529">HostnameError</span>&nbsp;<span class="keyword" id="4633543">struct</span>&nbsp;<span class="op" id="4633550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633553">Certificate</span>&nbsp;<span class="op" id="4633565">*</span><span class="ident" id="4633566"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633579">Host</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4633591">string</span><br>
<span class="lineno">65</span><span class="op" id="4633598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4633601">func</span>&nbsp;<span class="op" id="4633606">(</span><span class="ident" id="4633607">h</span>&nbsp;<span class="ident" id="4633609"><a href="/gostd/crypto/x509/verify.go.html#4633529">HostnameError</a></span><span class="op" id="4633622">)</span>&nbsp;<span class="ident" id="4633624">Error</span><span class="op" id="4633629">(</span><span class="op" id="4633630">)</span>&nbsp;<span class="builtintype" id="4633632">string</span>&nbsp;<span class="op" id="4633639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633642">c</span>&nbsp;<span class="op" id="4633644">:=</span>&nbsp;<span class="ident" id="4633647"><a href="/gostd/crypto/x509/verify.go.html#4633607">h</a></span><span class="op" id="4633648">.</span><span class="ident" id="4633649"><a href="/gostd/crypto/x509/verify.go.html#4633553">Certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633663">var</span>&nbsp;<span class="ident" id="4633667">valid</span>&nbsp;<span class="builtintype" id="4633673">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633681">if</span>&nbsp;<span class="ident" id="4633684">ip</span>&nbsp;<span class="op" id="4633687">:=</span>&nbsp;<span class="ident" id="4633690"><a href="/gostd/crypto/x509/verify.go.html#4631822">net</a></span><span class="op" id="4633693">.</span><span class="ident" id="4633694"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="4633701">(</span><span class="ident" id="4633702"><a href="/gostd/crypto/x509/verify.go.html#4633607">h</a></span><span class="op" id="4633703">.</span><span class="ident" id="4633704"><a href="/gostd/crypto/x509/verify.go.html#4633579">Host</a></span><span class="op" id="4633708">)</span><span class="op" id="4633709">;</span>&nbsp;<span class="ident" id="4633711"><a href="/gostd/crypto/x509/verify.go.html#4633684">ip</a></span>&nbsp;<span class="op" id="4633714">!=</span>&nbsp;<span class="builtintype" id="4633717">nil</span>&nbsp;<span class="op" id="4633721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4633725">//&nbsp;Trying&nbsp;to&nbsp;validate&nbsp;an&nbsp;IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633755">if</span>&nbsp;<span class="builtinfunc" id="4633758">len</span><span class="op" id="4633761">(</span><span class="ident" id="4633762"><a href="/gostd/crypto/x509/verify.go.html#4633642">c</a></span><span class="op" id="4633763">.</span><span class="ident" id="4633764"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="4633775">)</span>&nbsp;<span class="op" id="4633777">==</span>&nbsp;<span class="num" id="4633780">0</span>&nbsp;<span class="op" id="4633782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633787">return</span>&nbsp;<span class="string" id="4633794">&#34;x509:&nbsp;cannot&nbsp;validate&nbsp;certificate&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4633835">+</span>&nbsp;<span class="ident" id="4633837"><a href="/gostd/crypto/x509/verify.go.html#4633607">h</a></span><span class="op" id="4633838">.</span><span class="ident" id="4633839"><a href="/gostd/crypto/x509/verify.go.html#4633579">Host</a></span>&nbsp;<span class="op" id="4633844">+</span>&nbsp;<span class="string" id="4633846">&#34;&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;contain&nbsp;any&nbsp;IP&nbsp;SANs&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633894">for</span>&nbsp;<span class="ident" id="4633898">_</span><span class="op" id="4633899">,</span>&nbsp;<span class="ident" id="4633901">san</span>&nbsp;<span class="op" id="4633905">:=</span>&nbsp;<span class="keyword" id="4633908">range</span>&nbsp;<span class="ident" id="4633914"><a href="/gostd/crypto/x509/verify.go.html#4633642">c</a></span><span class="op" id="4633915">.</span><span class="ident" id="4633916"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span>&nbsp;<span class="op" id="4633928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633933">if</span>&nbsp;<span class="builtinfunc" id="4633936">len</span><span class="op" id="4633939">(</span><span class="ident" id="4633940"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span><span class="op" id="4633945">)</span>&nbsp;<span class="op" id="4633947">&gt;</span>&nbsp;<span class="num" id="4633949">0</span>&nbsp;<span class="op" id="4633951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633957"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span>&nbsp;<span class="op" id="4633963">+=</span>&nbsp;<span class="string" id="4633966">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633974">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633979"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span>&nbsp;<span class="op" id="4633985">+=</span>&nbsp;<span class="ident" id="4633988"><a href="/gostd/crypto/x509/verify.go.html#4633901">san</a></span><span class="op" id="4633991">.</span><span class="ident" id="4633992"><a href="/gostd/net/ip.go.html#3291839">String</a></span><span class="op" id="4633998">(</span><span class="op" id="4633999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634006">}</span>&nbsp;<span class="keyword" id="4634008">else</span>&nbsp;<span class="op" id="4634013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4634017">if</span>&nbsp;<span class="builtinfunc" id="4634020">len</span><span class="op" id="4634023">(</span><span class="ident" id="4634024"><a href="/gostd/crypto/x509/verify.go.html#4633642">c</a></span><span class="op" id="4634025">.</span><span class="ident" id="4634026"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4634034">)</span>&nbsp;<span class="op" id="4634036">&gt;</span>&nbsp;<span class="num" id="4634038">0</span>&nbsp;<span class="op" id="4634040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634045"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span>&nbsp;<span class="op" id="4634051">=</span>&nbsp;<span class="ident" id="4634053"><a href="/gostd/crypto/x509/verify.go.html#4631840">strings</a></span><span class="op" id="4634060">.</span><span class="ident" id="4634061"><a href="/gostd/strings/strings.go.html#2974969">Join</a></span><span class="op" id="4634065">(</span><span class="ident" id="4634066"><a href="/gostd/crypto/x509/verify.go.html#4633642">c</a></span><span class="op" id="4634067">.</span><span class="ident" id="4634068"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4634076">,</span>&nbsp;<span class="string" id="4634078">&#34;,&nbsp;&#34;</span><span class="op" id="4634082">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634086">}</span>&nbsp;<span class="keyword" id="4634088">else</span>&nbsp;<span class="op" id="4634093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634098"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span>&nbsp;<span class="op" id="4634104">=</span>&nbsp;<span class="ident" id="4634106"><a href="/gostd/crypto/x509/verify.go.html#4633642">c</a></span><span class="op" id="4634107">.</span><span class="ident" id="4634108"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4634115">.</span><span class="ident" id="4634116"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4634135">return</span>&nbsp;<span class="string" id="4634142">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;valid&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4634176">+</span>&nbsp;<span class="ident" id="4634178"><a href="/gostd/crypto/x509/verify.go.html#4633667">valid</a></span>&nbsp;<span class="op" id="4634184">+</span>&nbsp;<span class="string" id="4634186">&#34;,&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="4634195">+</span>&nbsp;<span class="ident" id="4634197"><a href="/gostd/crypto/x509/verify.go.html#4633607">h</a></span><span class="op" id="4634198">.</span><span class="ident" id="4634199"><a href="/gostd/crypto/x509/verify.go.html#4633579">Host</a></span><br>
<span class="lineno">90</span><span class="op" id="4634204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4634207">//&nbsp;UnknownAuthorityError&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&nbsp;issuer&nbsp;is&nbsp;unknown</span><br>
<span class="lineno"></span><span class="keyword" id="4634279">type</span>&nbsp;<span class="ident" id="4634284">UnknownAuthorityError</span>&nbsp;<span class="keyword" id="4634306">struct</span>&nbsp;<span class="op" id="4634313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634316">cert</span>&nbsp;<span class="op" id="4634321">*</span><span class="ident" id="4634322"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4634335">//&nbsp;hintErr&nbsp;contains&nbsp;an&nbsp;error&nbsp;that&nbsp;may&nbsp;be&nbsp;helpful&nbsp;in&nbsp;determining&nbsp;why&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4634407">//&nbsp;authority&nbsp;wasn&#39;t&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634435">hintErr</span>&nbsp;<span class="builtintype" id="4634443">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4634450">//&nbsp;hintCert&nbsp;contains&nbsp;a&nbsp;possible&nbsp;authority&nbsp;certificate&nbsp;that&nbsp;was&nbsp;rejected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4634523">//&nbsp;because&nbsp;of&nbsp;the&nbsp;error&nbsp;in&nbsp;hintErr.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634560">hintCert</span>&nbsp;<span class="op" id="4634569">*</span><span class="ident" id="4634570"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="4634582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4634585">func</span>&nbsp;<span class="op" id="4634590">(</span><span class="ident" id="4634591">e</span>&nbsp;<span class="ident" id="4634593"><a href="/gostd/crypto/x509/verify.go.html#4634284">UnknownAuthorityError</a></span><span class="op" id="4634614">)</span>&nbsp;<span class="ident" id="4634616">Error</span><span class="op" id="4634621">(</span><span class="op" id="4634622">)</span>&nbsp;<span class="builtintype" id="4634624">string</span>&nbsp;<span class="op" id="4634631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634634">s</span>&nbsp;<span class="op" id="4634636">:=</span>&nbsp;<span class="string" id="4634639">&#34;x509:&nbsp;certificate&nbsp;signed&nbsp;by&nbsp;unknown&nbsp;authority&#34;</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4634688">if</span>&nbsp;<span class="ident" id="4634691"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4634692">.</span><span class="ident" id="4634693"><a href="/gostd/crypto/x509/verify.go.html#4634435">hintErr</a></span>&nbsp;<span class="op" id="4634701">!=</span>&nbsp;<span class="builtintype" id="4634704">nil</span>&nbsp;<span class="op" id="4634708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634712">certName</span>&nbsp;<span class="op" id="4634721">:=</span>&nbsp;<span class="ident" id="4634724"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4634725">.</span><span class="ident" id="4634726"><a href="/gostd/crypto/x509/verify.go.html#4634560">hintCert</a></span><span class="op" id="4634734">.</span><span class="ident" id="4634735"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4634742">.</span><span class="ident" id="4634743"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4634756">if</span>&nbsp;<span class="builtinfunc" id="4634759">len</span><span class="op" id="4634762">(</span><span class="ident" id="4634763"><a href="/gostd/crypto/x509/verify.go.html#4634712">certName</a></span><span class="op" id="4634771">)</span>&nbsp;<span class="op" id="4634773">==</span>&nbsp;<span class="num" id="4634776">0</span>&nbsp;<span class="op" id="4634778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4634783">if</span>&nbsp;<span class="builtinfunc" id="4634786">len</span><span class="op" id="4634789">(</span><span class="ident" id="4634790"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4634791">.</span><span class="ident" id="4634792"><a href="/gostd/crypto/x509/verify.go.html#4634560">hintCert</a></span><span class="op" id="4634800">.</span><span class="ident" id="4634801"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4634808">.</span><span class="ident" id="4634809"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="4634821">)</span>&nbsp;<span class="op" id="4634823">&gt;</span>&nbsp;<span class="num" id="4634825">0</span>&nbsp;<span class="op" id="4634827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634833"><a href="/gostd/crypto/x509/verify.go.html#4634712">certName</a></span>&nbsp;<span class="op" id="4634842">=</span>&nbsp;<span class="ident" id="4634844"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4634845">.</span><span class="ident" id="4634846"><a href="/gostd/crypto/x509/verify.go.html#4634560">hintCert</a></span><span class="op" id="4634854">.</span><span class="ident" id="4634855"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4634862">.</span><span class="ident" id="4634863"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408300">Organization</a></span><span class="op" id="4634875">[</span><span class="num" id="4634876">0</span><span class="op" id="4634877">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634887"><a href="/gostd/crypto/x509/verify.go.html#4634712">certName</a></span>&nbsp;<span class="op" id="4634896">=</span>&nbsp;<span class="string" id="4634898">&#34;serial:&#34;</span>&nbsp;<span class="op" id="4634908">+</span>&nbsp;<span class="ident" id="4634910"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4634911">.</span><span class="ident" id="4634912"><a href="/gostd/crypto/x509/verify.go.html#4634560">hintCert</a></span><span class="op" id="4634920">.</span><span class="ident" id="4634921"><a href="/gostd/crypto/x509/x509.go.html#4660321">SerialNumber</a></span><span class="op" id="4634933">.</span><span class="ident" id="4634934"><a href="/gostd/math/big/int.go.html#2043213">String</a></span><span class="op" id="4634940">(</span><span class="op" id="4634941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4634945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4634949"><a href="/gostd/crypto/x509/verify.go.html#4634634">s</a></span>&nbsp;<span class="op" id="4634951">+=</span>&nbsp;<span class="ident" id="4634954"><a href="/gostd/crypto/x509/verify.go.html#4631815">fmt</a></span><span class="op" id="4634957">.</span><span class="ident" id="4634958"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4634965">(</span><span class="string" id="4634966">&#34;&nbsp;(possibly&nbsp;because&nbsp;of&nbsp;%q&nbsp;while&nbsp;trying&nbsp;to&nbsp;verify&nbsp;candidate&nbsp;authority&nbsp;certificate&nbsp;%q)&#34;</span><span class="op" id="4635051">,</span>&nbsp;<span class="ident" id="4635053"><a href="/gostd/crypto/x509/verify.go.html#4634591">e</a></span><span class="op" id="4635054">.</span><span class="ident" id="4635055"><a href="/gostd/crypto/x509/verify.go.html#4634435">hintErr</a></span><span class="op" id="4635062">,</span>&nbsp;<span class="ident" id="4635064"><a href="/gostd/crypto/x509/verify.go.html#4634712">certName</a></span><span class="op" id="4635072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4635075">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4635078">return</span>&nbsp;<span class="ident" id="4635085"><a href="/gostd/crypto/x509/verify.go.html#4634634">s</a></span><br>
<span class="lineno"></span><span class="op" id="4635087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4635090">//&nbsp;SystemRootsError&nbsp;results&nbsp;when&nbsp;we&nbsp;fail&nbsp;to&nbsp;load&nbsp;the&nbsp;system&nbsp;root&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4635169">type</span>&nbsp;<span class="ident" id="4635174">SystemRootsError</span>&nbsp;<span class="keyword" id="4635191">struct</span><span class="op" id="4635197">{</span><span class="op" id="4635198">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4635201">func</span>&nbsp;<span class="op" id="4635206">(</span><span class="ident" id="4635207"><a href="/gostd/crypto/x509/verify.go.html#4635174">SystemRootsError</a></span><span class="op" id="4635223">)</span>&nbsp;<span class="ident" id="4635225">Error</span><span class="op" id="4635230">(</span><span class="op" id="4635231">)</span>&nbsp;<span class="builtintype" id="4635233">string</span>&nbsp;<span class="op" id="4635240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4635243">return</span>&nbsp;<span class="string" id="4635250">&#34;x509:&nbsp;failed&nbsp;to&nbsp;load&nbsp;system&nbsp;roots&nbsp;and&nbsp;no&nbsp;roots&nbsp;provided&#34;</span><br>
<span class="lineno"></span><span class="op" id="4635308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4635311">//&nbsp;VerifyOptions&nbsp;contains&nbsp;parameters&nbsp;for&nbsp;Certificate.Verify.&nbsp;It&#39;s&nbsp;a&nbsp;structure</span><br>
<span class="lineno"></span><span class="comment" id="4635389">//&nbsp;because&nbsp;other&nbsp;PKIX&nbsp;verification&nbsp;APIs&nbsp;have&nbsp;ended&nbsp;up&nbsp;needing&nbsp;many&nbsp;options.</span><br>
<span class="lineno"></span><span class="keyword" id="4635465">type</span>&nbsp;<span class="ident" id="4635470">VerifyOptions</span>&nbsp;<span class="keyword" id="4635484">struct</span>&nbsp;<span class="op" id="4635491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635494">DNSName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4635508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635516">Intermediates</span>&nbsp;<span class="op" id="4635530">*</span><span class="ident" id="4635531"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635541">Roots</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4635555">*</span><span class="ident" id="4635556"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span>&nbsp;<span class="comment" id="4635565">//&nbsp;if&nbsp;nil,&nbsp;the&nbsp;system&nbsp;roots&nbsp;are&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635603">CurrentTime</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4635617"><a href="/gostd/crypto/x509/verify.go.html#4631851">time</a></span><span class="op" id="4635621">.</span><span class="ident" id="4635622"><a href="/gostd/time/time.go.html#2722087">Time</a></span>&nbsp;<span class="comment" id="4635627">//&nbsp;if&nbsp;zero,&nbsp;the&nbsp;current&nbsp;time&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4635665">//&nbsp;KeyUsage&nbsp;specifies&nbsp;which&nbsp;Extended&nbsp;Key&nbsp;Usage&nbsp;values&nbsp;are&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4635736">//&nbsp;An&nbsp;empty&nbsp;list&nbsp;means&nbsp;ExtKeyUsageServerAuth.&nbsp;Key&nbsp;usage&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4635809">//&nbsp;constraint&nbsp;down&nbsp;the&nbsp;chain&nbsp;which&nbsp;mirrors&nbsp;Windows&nbsp;CryptoAPI&nbsp;behaviour,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4635882">//&nbsp;but&nbsp;not&nbsp;the&nbsp;spec.&nbsp;To&nbsp;accept&nbsp;any&nbsp;key&nbsp;usage,&nbsp;include&nbsp;ExtKeyUsageAny.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635953">KeyUsages</span>&nbsp;<span class="op" id="4635963">[</span><span class="op" id="4635964">]</span><span class="ident" id="4635965"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><br>
<span class="lineno"></span><span class="op" id="4635977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4635980">const</span>&nbsp;<span class="op" id="4635986">(</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4635989">leafCertificate</span>&nbsp;<span class="op" id="4636005">=</span>&nbsp;<span class="ident" id="4636007">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636013">intermediateCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636038">rootCertificate</span><br>
<span class="lineno"></span><span class="op" id="4636054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4636057">//&nbsp;isValid&nbsp;performs&nbsp;validity&nbsp;checks&nbsp;on&nbsp;the&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4636103">func</span>&nbsp;<span class="op" id="4636108">(</span><span class="ident" id="4636109">c</span>&nbsp;<span class="op" id="4636111">*</span><span class="ident" id="4636112"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4636123">)</span>&nbsp;<span class="ident" id="4636125">isValid</span><span class="op" id="4636132">(</span><span class="ident" id="4636133">certType</span>&nbsp;<span class="builtintype" id="4636142">int</span><span class="op" id="4636145">,</span>&nbsp;<span class="ident" id="4636147">currentChain</span>&nbsp;<span class="op" id="4636160">[</span><span class="op" id="4636161">]</span><span class="op" id="4636162">*</span><span class="ident" id="4636163"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4636174">,</span>&nbsp;<span class="ident" id="4636176">opts</span>&nbsp;<span class="op" id="4636181">*</span><span class="ident" id="4636182"><a href="/gostd/crypto/x509/verify.go.html#4635470">VerifyOptions</a></span><span class="op" id="4636195">)</span>&nbsp;<span class="builtintype" id="4636197">error</span>&nbsp;<span class="op" id="4636203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636206">now</span>&nbsp;<span class="op" id="4636210">:=</span>&nbsp;<span class="ident" id="4636213"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636217">.</span><span class="ident" id="4636218"><a href="/gostd/crypto/x509/verify.go.html#4635603">CurrentTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636231">if</span>&nbsp;<span class="ident" id="4636234"><a href="/gostd/crypto/x509/verify.go.html#4636206">now</a></span><span class="op" id="4636237">.</span><span class="ident" id="4636238"><a href="/gostd/time/time.go.html#2728744">IsZero</a></span><span class="op" id="4636244">(</span><span class="op" id="4636245">)</span>&nbsp;<span class="op" id="4636247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636251"><a href="/gostd/crypto/x509/verify.go.html#4636206">now</a></span>&nbsp;<span class="op" id="4636255">=</span>&nbsp;<span class="ident" id="4636257"><a href="/gostd/crypto/x509/verify.go.html#4631851">time</a></span><span class="op" id="4636261">.</span><span class="ident" id="4636262"><a href="/gostd/time/time.go.html#2743088">Now</a></span><span class="op" id="4636265">(</span><span class="op" id="4636266">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636272">if</span>&nbsp;<span class="ident" id="4636275"><a href="/gostd/crypto/x509/verify.go.html#4636206">now</a></span><span class="op" id="4636278">.</span><span class="ident" id="4636279"><a href="/gostd/time/time.go.html#2722823">Before</a></span><span class="op" id="4636285">(</span><span class="ident" id="4636286"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636287">.</span><span class="ident" id="4636288"><a href="/gostd/crypto/x509/x509.go.html#4660413">NotBefore</a></span><span class="op" id="4636297">)</span>&nbsp;<span class="op" id="4636299">||</span>&nbsp;<span class="ident" id="4636302"><a href="/gostd/crypto/x509/verify.go.html#4636206">now</a></span><span class="op" id="4636305">.</span><span class="ident" id="4636306"><a href="/gostd/time/time.go.html#2722668">After</a></span><span class="op" id="4636311">(</span><span class="ident" id="4636312"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636313">.</span><span class="ident" id="4636314"><a href="/gostd/crypto/x509/x509.go.html#4660424">NotAfter</a></span><span class="op" id="4636322">)</span>&nbsp;<span class="op" id="4636324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636328">return</span>&nbsp;<span class="ident" id="4636335"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4636358">{</span><span class="ident" id="4636359"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636360">,</span>&nbsp;<span class="ident" id="4636362"><a href="/gostd/crypto/x509/verify.go.html#4632170">Expired</a></span><span class="op" id="4636369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636376">if</span>&nbsp;<span class="builtinfunc" id="4636379">len</span><span class="op" id="4636382">(</span><span class="ident" id="4636383"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636384">.</span><span class="ident" id="4636385"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="4636404">)</span>&nbsp;<span class="op" id="4636406">&gt;</span>&nbsp;<span class="num" id="4636408">0</span>&nbsp;<span class="op" id="4636410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636414">ok</span>&nbsp;<span class="op" id="4636417">:=</span>&nbsp;<span class="builtintype" id="4636420">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636428">for</span>&nbsp;<span class="ident" id="4636432">_</span><span class="op" id="4636433">,</span>&nbsp;<span class="ident" id="4636435">domain</span>&nbsp;<span class="op" id="4636442">:=</span>&nbsp;<span class="keyword" id="4636445">range</span>&nbsp;<span class="ident" id="4636451"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636452">.</span><span class="ident" id="4636453"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span>&nbsp;<span class="op" id="4636473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636478">if</span>&nbsp;<span class="ident" id="4636481"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636485">.</span><span class="ident" id="4636486"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span>&nbsp;<span class="op" id="4636494">==</span>&nbsp;<span class="ident" id="4636497"><a href="/gostd/crypto/x509/verify.go.html#4636435">domain</a></span>&nbsp;<span class="op" id="4636504">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636511">(</span><span class="ident" id="4636512"><a href="/gostd/crypto/x509/verify.go.html#4631840">strings</a></span><span class="op" id="4636519">.</span><span class="ident" id="4636520"><a href="/gostd/strings/strings.go.html#2975527">HasSuffix</a></span><span class="op" id="4636529">(</span><span class="ident" id="4636530"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636534">.</span><span class="ident" id="4636535"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4636542">,</span>&nbsp;<span class="ident" id="4636544"><a href="/gostd/crypto/x509/verify.go.html#4636435">domain</a></span><span class="op" id="4636550">)</span>&nbsp;<span class="op" id="4636552">&amp;&amp;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4636560">len</span><span class="op" id="4636563">(</span><span class="ident" id="4636564"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636568">.</span><span class="ident" id="4636569"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4636576">)</span>&nbsp;<span class="op" id="4636578">&gt;=</span>&nbsp;<span class="num" id="4636581">1</span><span class="op" id="4636582">+</span><span class="builtinfunc" id="4636583">len</span><span class="op" id="4636586">(</span><span class="ident" id="4636587"><a href="/gostd/crypto/x509/verify.go.html#4636435">domain</a></span><span class="op" id="4636593">)</span>&nbsp;<span class="op" id="4636595">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636603"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636607">.</span><span class="ident" id="4636608"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4636615">[</span><span class="builtinfunc" id="4636616">len</span><span class="op" id="4636619">(</span><span class="ident" id="4636620"><a href="/gostd/crypto/x509/verify.go.html#4636176">opts</a></span><span class="op" id="4636624">.</span><span class="ident" id="4636625"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4636632">)</span><span class="op" id="4636633">-</span><span class="builtinfunc" id="4636634">len</span><span class="op" id="4636637">(</span><span class="ident" id="4636638"><a href="/gostd/crypto/x509/verify.go.html#4636435">domain</a></span><span class="op" id="4636644">)</span><span class="op" id="4636645">-</span><span class="num" id="4636646">1</span><span class="op" id="4636647">]</span>&nbsp;<span class="op" id="4636649">==</span>&nbsp;<span class="string" id="4636652">&#39;.&#39;</span><span class="op" id="4636655">)</span>&nbsp;<span class="op" id="4636657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4636663"><a href="/gostd/crypto/x509/verify.go.html#4636414">ok</a></span>&nbsp;<span class="op" id="4636666">=</span>&nbsp;<span class="builtintype" id="4636668">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636677">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636686">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636695">if</span>&nbsp;<span class="op" id="4636698">!</span><span class="ident" id="4636699"><a href="/gostd/crypto/x509/verify.go.html#4636414">ok</a></span>&nbsp;<span class="op" id="4636702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4636707">return</span>&nbsp;<span class="ident" id="4636714"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4636737">{</span><span class="ident" id="4636738"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4636739">,</span>&nbsp;<span class="ident" id="4636741"><a href="/gostd/crypto/x509/verify.go.html#4632335">CANotAuthorizedForThisName</a></span><span class="op" id="4636767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636771">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4636774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636778">//&nbsp;KeyUsage&nbsp;status&nbsp;flags&nbsp;are&nbsp;ignored.&nbsp;From&nbsp;Engineering&nbsp;Security,&nbsp;Peter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636850">//&nbsp;Gutmann:&nbsp;A&nbsp;European&nbsp;government&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signing&nbsp;certificates&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636923">//&nbsp;being&nbsp;valid&nbsp;for&nbsp;encryption&nbsp;only,&nbsp;but&nbsp;no-one&nbsp;noticed.&nbsp;Another</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4636988">//&nbsp;European&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signature&nbsp;keys&nbsp;as&nbsp;not&nbsp;being&nbsp;valid&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637053">//&nbsp;signatures.&nbsp;A&nbsp;different&nbsp;CA&nbsp;marked&nbsp;its&nbsp;own&nbsp;trusted&nbsp;root&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637124">//&nbsp;as&nbsp;being&nbsp;invalid&nbsp;for&nbsp;certificate&nbsp;signing.&nbsp;&nbsp;Another&nbsp;national&nbsp;CA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637191">//&nbsp;distributed&nbsp;a&nbsp;certificate&nbsp;to&nbsp;be&nbsp;used&nbsp;to&nbsp;encrypt&nbsp;data&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637256">//&nbsp;countrys&nbsp;tax&nbsp;authority&nbsp;that&nbsp;was&nbsp;marked&nbsp;as&nbsp;only&nbsp;being&nbsp;usable&nbsp;for</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637327">//&nbsp;digital&nbsp;signatures&nbsp;but&nbsp;not&nbsp;for&nbsp;encryption.&nbsp;Yet&nbsp;another&nbsp;CA&nbsp;reversed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637398">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;bit&nbsp;flags&nbsp;in&nbsp;the&nbsp;keyUsage&nbsp;due&nbsp;to&nbsp;confusion&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637467">//&nbsp;encoding&nbsp;endianness,&nbsp;essentially&nbsp;setting&nbsp;a&nbsp;random&nbsp;keyUsage&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637533">//&nbsp;certificates&nbsp;that&nbsp;it&nbsp;issued.&nbsp;Another&nbsp;CA&nbsp;created&nbsp;a&nbsp;self-invalidating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637605">//&nbsp;certificate&nbsp;by&nbsp;adding&nbsp;a&nbsp;certificate&nbsp;policy&nbsp;statement&nbsp;stipulating</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637674">//&nbsp;that&nbsp;the&nbsp;certificate&nbsp;had&nbsp;to&nbsp;be&nbsp;used&nbsp;strictly&nbsp;as&nbsp;specified&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637743">//&nbsp;keyUsage,&nbsp;and&nbsp;a&nbsp;keyUsage&nbsp;containing&nbsp;a&nbsp;flag&nbsp;indicating&nbsp;that&nbsp;the&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4637814">//&nbsp;encryption&nbsp;key&nbsp;could&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;Diffie-Hellman&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4637887">if</span>&nbsp;<span class="ident" id="4637890"><a href="/gostd/crypto/x509/verify.go.html#4636133">certType</a></span>&nbsp;<span class="op" id="4637899">==</span>&nbsp;<span class="ident" id="4637902"><a href="/gostd/crypto/x509/verify.go.html#4636013">intermediateCertificate</a></span>&nbsp;<span class="op" id="4637926">&amp;&amp;</span>&nbsp;<span class="op" id="4637929">(</span><span class="op" id="4637930">!</span><span class="ident" id="4637931"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4637932">.</span><span class="ident" id="4637933"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4637955">||</span>&nbsp;<span class="op" id="4637958">!</span><span class="ident" id="4637959"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4637960">.</span><span class="ident" id="4637961"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span><span class="op" id="4637965">)</span>&nbsp;<span class="op" id="4637967">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4637971">return</span>&nbsp;<span class="ident" id="4637978"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4638001">{</span><span class="ident" id="4638002"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4638003">,</span>&nbsp;<span class="ident" id="4638005"><a href="/gostd/crypto/x509/verify.go.html#4632026">NotAuthorizedToSign</a></span><span class="op" id="4638024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4638027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638031">if</span>&nbsp;<span class="ident" id="4638034"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4638035">.</span><span class="ident" id="4638036"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4638058">&amp;&amp;</span>&nbsp;<span class="ident" id="4638061"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4638062">.</span><span class="ident" id="4638063"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="4638074">&gt;=</span>&nbsp;<span class="num" id="4638077">0</span>&nbsp;<span class="op" id="4638079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4638083">numIntermediates</span>&nbsp;<span class="op" id="4638100">:=</span>&nbsp;<span class="builtinfunc" id="4638103">len</span><span class="op" id="4638106">(</span><span class="ident" id="4638107"><a href="/gostd/crypto/x509/verify.go.html#4636147">currentChain</a></span><span class="op" id="4638119">)</span>&nbsp;<span class="op" id="4638121">-</span>&nbsp;<span class="num" id="4638123">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638127">if</span>&nbsp;<span class="ident" id="4638130"><a href="/gostd/crypto/x509/verify.go.html#4638083">numIntermediates</a></span>&nbsp;<span class="op" id="4638147">&gt;</span>&nbsp;<span class="ident" id="4638149"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4638150">.</span><span class="ident" id="4638151"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="4638162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638167">return</span>&nbsp;<span class="ident" id="4638174"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4638197">{</span><span class="ident" id="4638198"><a href="/gostd/crypto/x509/verify.go.html#4636109">c</a></span><span class="op" id="4638199">,</span>&nbsp;<span class="ident" id="4638201"><a href="/gostd/crypto/x509/verify.go.html#4632443">TooManyIntermediates</a></span><span class="op" id="4638221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4638225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4638228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638232">return</span>&nbsp;<span class="builtintype" id="4638239">nil</span><br>
<span class="lineno"></span><span class="op" id="4638243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4638246">//&nbsp;Verify&nbsp;attempts&nbsp;to&nbsp;verify&nbsp;c&nbsp;by&nbsp;building&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;from&nbsp;c&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4638320">//&nbsp;certificate&nbsp;in&nbsp;opts.Roots,&nbsp;using&nbsp;certificates&nbsp;in&nbsp;opts.Intermediates&nbsp;if</span><br>
<span class="lineno">205</span><span class="comment" id="4638394">//&nbsp;needed.&nbsp;If&nbsp;successful,&nbsp;it&nbsp;returns&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;where&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="4638466">//&nbsp;element&nbsp;of&nbsp;the&nbsp;chain&nbsp;is&nbsp;c&nbsp;and&nbsp;the&nbsp;last&nbsp;element&nbsp;is&nbsp;from&nbsp;opts.Roots.</span><br>
<span class="lineno"></span><span class="comment" id="4638536">//</span><br>
<span class="lineno"></span><span class="comment" id="4638539">//&nbsp;If&nbsp;opts.Roots&nbsp;is&nbsp;nil&nbsp;and&nbsp;system&nbsp;roots&nbsp;are&nbsp;unavailable&nbsp;the&nbsp;returned&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="4638615">//&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;SystemRootsError.</span><br>
<span class="lineno">210</span><span class="comment" id="4638652">//</span><br>
<span class="lineno"></span><span class="comment" id="4638655">//&nbsp;WARNING:&nbsp;this&nbsp;doesn&#39;t&nbsp;do&nbsp;any&nbsp;revocation&nbsp;checking.</span><br>
<span class="lineno"></span><span class="keyword" id="4638708">func</span>&nbsp;<span class="op" id="4638713">(</span><span class="ident" id="4638714">c</span>&nbsp;<span class="op" id="4638716">*</span><span class="ident" id="4638717"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4638728">)</span>&nbsp;<span class="ident" id="4638730">Verify</span><span class="op" id="4638736">(</span><span class="ident" id="4638737">opts</span>&nbsp;<span class="ident" id="4638742"><a href="/gostd/crypto/x509/verify.go.html#4635470">VerifyOptions</a></span><span class="op" id="4638755">)</span>&nbsp;<span class="op" id="4638757">(</span><span class="ident" id="4638758">chains</span>&nbsp;<span class="op" id="4638765">[</span><span class="op" id="4638766">]</span><span class="op" id="4638767">[</span><span class="op" id="4638768">]</span><span class="op" id="4638769">*</span><span class="ident" id="4638770"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4638781">,</span>&nbsp;<span class="ident" id="4638783">err</span>&nbsp;<span class="builtintype" id="4638787">error</span><span class="op" id="4638792">)</span>&nbsp;<span class="op" id="4638794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4638797">//&nbsp;Use&nbsp;Windows&#39;s&nbsp;own&nbsp;verification&nbsp;and&nbsp;chain&nbsp;building.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638852">if</span>&nbsp;<span class="ident" id="4638855"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4638859">.</span><span class="ident" id="4638860"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span>&nbsp;<span class="op" id="4638866">==</span>&nbsp;<span class="builtintype" id="4638869">nil</span>&nbsp;<span class="op" id="4638873">&amp;&amp;</span>&nbsp;<span class="ident" id="4638876"><a href="/gostd/crypto/x509/verify.go.html#4631829">runtime</a></span><span class="op" id="4638883">.</span><span class="ident" id="4638884"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="4638889">==</span>&nbsp;<span class="string" id="4638892">&#34;windows&#34;</span>&nbsp;<span class="op" id="4638902">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638906">return</span>&nbsp;<span class="ident" id="4638913"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4638914">.</span><span class="ident" id="4638915"><a href="/gostd/crypto/x509/root_unix.go.html#4628192">systemVerify</a></span><span class="op" id="4638927">(</span><span class="op" id="4638928">&amp;</span><span class="ident" id="4638929"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4638933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4638936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638940">if</span>&nbsp;<span class="ident" id="4638943"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4638947">.</span><span class="ident" id="4638948"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span>&nbsp;<span class="op" id="4638954">==</span>&nbsp;<span class="builtintype" id="4638957">nil</span>&nbsp;<span class="op" id="4638961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4638965"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4638969">.</span><span class="ident" id="4638970"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span>&nbsp;<span class="op" id="4638976">=</span>&nbsp;<span class="ident" id="4638978"><a href="/gostd/crypto/x509/root.go.html#4627133">systemRootsPool</a></span><span class="op" id="4638993">(</span><span class="op" id="4638994">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4638998">if</span>&nbsp;<span class="ident" id="4639001"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639005">.</span><span class="ident" id="4639006"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span>&nbsp;<span class="op" id="4639012">==</span>&nbsp;<span class="builtintype" id="4639015">nil</span>&nbsp;<span class="op" id="4639019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639024">return</span>&nbsp;<span class="builtintype" id="4639031">nil</span><span class="op" id="4639034">,</span>&nbsp;<span class="ident" id="4639036"><a href="/gostd/crypto/x509/verify.go.html#4635174">SystemRootsError</a></span><span class="op" id="4639052">{</span><span class="op" id="4639053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639064"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639068">=</span>&nbsp;<span class="ident" id="4639070"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4639071">.</span><span class="ident" id="4639072"><a href="/gostd/crypto/x509/verify.go.html#4636125">isValid</a></span><span class="op" id="4639079">(</span><span class="ident" id="4639080"><a href="/gostd/crypto/x509/verify.go.html#4635989">leafCertificate</a></span><span class="op" id="4639095">,</span>&nbsp;<span class="builtintype" id="4639097">nil</span><span class="op" id="4639100">,</span>&nbsp;<span class="op" id="4639102">&amp;</span><span class="ident" id="4639103"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639110">if</span>&nbsp;<span class="ident" id="4639113"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639117">!=</span>&nbsp;<span class="builtintype" id="4639120">nil</span>&nbsp;<span class="op" id="4639124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639128">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639140">if</span>&nbsp;<span class="builtinfunc" id="4639143">len</span><span class="op" id="4639146">(</span><span class="ident" id="4639147"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639151">.</span><span class="ident" id="4639152"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4639159">)</span>&nbsp;<span class="op" id="4639161">&gt;</span>&nbsp;<span class="num" id="4639163">0</span>&nbsp;<span class="op" id="4639165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639169"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639173">=</span>&nbsp;<span class="ident" id="4639175"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4639176">.</span><span class="ident" id="4639177"><a href="/gostd/crypto/x509/verify.go.html#4642893">VerifyHostname</a></span><span class="op" id="4639191">(</span><span class="ident" id="4639192"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639196">.</span><span class="ident" id="4639197"><a href="/gostd/crypto/x509/verify.go.html#4635494">DNSName</a></span><span class="op" id="4639204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639208">if</span>&nbsp;<span class="ident" id="4639211"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639215">!=</span>&nbsp;<span class="builtintype" id="4639218">nil</span>&nbsp;<span class="op" id="4639222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639236">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639243">candidateChains</span><span class="op" id="4639258">,</span>&nbsp;<span class="ident" id="4639260"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639264">:=</span>&nbsp;<span class="ident" id="4639267"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4639268">.</span><span class="ident" id="4639269"><a href="/gostd/crypto/x509/verify.go.html#4640073">buildChains</a></span><span class="op" id="4639280">(</span><span class="builtinfunc" id="4639281">make</span><span class="op" id="4639285">(</span><span class="keyword" id="4639286">map</span><span class="op" id="4639289">[</span><span class="builtintype" id="4639290">int</span><span class="op" id="4639293">]</span><span class="op" id="4639294">[</span><span class="op" id="4639295">]</span><span class="op" id="4639296">[</span><span class="op" id="4639297">]</span><span class="op" id="4639298">*</span><span class="ident" id="4639299"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4639310">)</span><span class="op" id="4639311">,</span>&nbsp;<span class="op" id="4639313">[</span><span class="op" id="4639314">]</span><span class="op" id="4639315">*</span><span class="ident" id="4639316"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4639327">{</span><span class="ident" id="4639328"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4639329">}</span><span class="op" id="4639330">,</span>&nbsp;<span class="op" id="4639332">&amp;</span><span class="ident" id="4639333"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639340">if</span>&nbsp;<span class="ident" id="4639343"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639347">!=</span>&nbsp;<span class="builtintype" id="4639350">nil</span>&nbsp;<span class="op" id="4639354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639358">return</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639370">keyUsages</span>&nbsp;<span class="op" id="4639380">:=</span>&nbsp;<span class="ident" id="4639383"><a href="/gostd/crypto/x509/verify.go.html#4638737">opts</a></span><span class="op" id="4639387">.</span><span class="ident" id="4639388"><a href="/gostd/crypto/x509/verify.go.html#4635953">KeyUsages</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639399">if</span>&nbsp;<span class="builtinfunc" id="4639402">len</span><span class="op" id="4639405">(</span><span class="ident" id="4639406"><a href="/gostd/crypto/x509/verify.go.html#4639370">keyUsages</a></span><span class="op" id="4639415">)</span>&nbsp;<span class="op" id="4639417">==</span>&nbsp;<span class="num" id="4639420">0</span>&nbsp;<span class="op" id="4639422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639426"><a href="/gostd/crypto/x509/verify.go.html#4639370">keyUsages</a></span>&nbsp;<span class="op" id="4639436">=</span>&nbsp;<span class="op" id="4639438">[</span><span class="op" id="4639439">]</span><span class="ident" id="4639440"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="4639451">{</span><span class="ident" id="4639452"><a href="/gostd/crypto/x509/x509.go.html#4658147">ExtKeyUsageServerAuth</a></span><span class="op" id="4639473">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4639480">//&nbsp;If&nbsp;any&nbsp;key&nbsp;usage&nbsp;is&nbsp;acceptable&nbsp;then&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639532">for</span>&nbsp;<span class="ident" id="4639536">_</span><span class="op" id="4639537">,</span>&nbsp;<span class="ident" id="4639539">usage</span>&nbsp;<span class="op" id="4639545">:=</span>&nbsp;<span class="keyword" id="4639548">range</span>&nbsp;<span class="ident" id="4639554"><a href="/gostd/crypto/x509/verify.go.html#4639370">keyUsages</a></span>&nbsp;<span class="op" id="4639564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639568">if</span>&nbsp;<span class="ident" id="4639571"><a href="/gostd/crypto/x509/verify.go.html#4639539">usage</a></span>&nbsp;<span class="op" id="4639577">==</span>&nbsp;<span class="ident" id="4639580"><a href="/gostd/crypto/x509/x509.go.html#4658112">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4639595">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639600"><a href="/gostd/crypto/x509/verify.go.html#4638758">chains</a></span>&nbsp;<span class="op" id="4639607">=</span>&nbsp;<span class="ident" id="4639609"><a href="/gostd/crypto/x509/verify.go.html#4639243">candidateChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639628">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639644">for</span>&nbsp;<span class="ident" id="4639648">_</span><span class="op" id="4639649">,</span>&nbsp;<span class="ident" id="4639651">candidate</span>&nbsp;<span class="op" id="4639661">:=</span>&nbsp;<span class="keyword" id="4639664">range</span>&nbsp;<span class="ident" id="4639670"><a href="/gostd/crypto/x509/verify.go.html#4639243">candidateChains</a></span>&nbsp;<span class="op" id="4639686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639690">if</span>&nbsp;<span class="ident" id="4639693"><a href="/gostd/crypto/x509/verify.go.html#4643733">checkChainForKeyUsage</a></span><span class="op" id="4639714">(</span><span class="ident" id="4639715"><a href="/gostd/crypto/x509/verify.go.html#4639651">candidate</a></span><span class="op" id="4639724">,</span>&nbsp;<span class="ident" id="4639726"><a href="/gostd/crypto/x509/verify.go.html#4639370">keyUsages</a></span><span class="op" id="4639735">)</span>&nbsp;<span class="op" id="4639737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639742"><a href="/gostd/crypto/x509/verify.go.html#4638758">chains</a></span>&nbsp;<span class="op" id="4639749">=</span>&nbsp;<span class="builtinfunc" id="4639751">append</span><span class="op" id="4639757">(</span><span class="ident" id="4639758"><a href="/gostd/crypto/x509/verify.go.html#4638758">chains</a></span><span class="op" id="4639764">,</span>&nbsp;<span class="ident" id="4639766"><a href="/gostd/crypto/x509/verify.go.html#4639651">candidate</a></span><span class="op" id="4639775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639782">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639786">if</span>&nbsp;<span class="builtinfunc" id="4639789">len</span><span class="op" id="4639792">(</span><span class="ident" id="4639793"><a href="/gostd/crypto/x509/verify.go.html#4638758">chains</a></span><span class="op" id="4639799">)</span>&nbsp;<span class="op" id="4639801">==</span>&nbsp;<span class="num" id="4639804">0</span>&nbsp;<span class="op" id="4639806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639810"><a href="/gostd/crypto/x509/verify.go.html#4638783">err</a></span>&nbsp;<span class="op" id="4639814">=</span>&nbsp;<span class="ident" id="4639816"><a href="/gostd/crypto/x509/verify.go.html#4632756">CertificateInvalidError</a></span><span class="op" id="4639839">{</span><span class="ident" id="4639840"><a href="/gostd/crypto/x509/verify.go.html#4638714">c</a></span><span class="op" id="4639841">,</span>&nbsp;<span class="ident" id="4639843"><a href="/gostd/crypto/x509/verify.go.html#4632592">IncompatibleUsage</a></span><span class="op" id="4639860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4639863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4639867">return</span><br>
<span class="lineno"></span><span class="op" id="4639874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4639877">func</span>&nbsp;<span class="ident" id="4639882">appendToFreshChain</span><span class="op" id="4639900">(</span><span class="ident" id="4639901">chain</span>&nbsp;<span class="op" id="4639907">[</span><span class="op" id="4639908">]</span><span class="op" id="4639909">*</span><span class="ident" id="4639910"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4639921">,</span>&nbsp;<span class="ident" id="4639923">cert</span>&nbsp;<span class="op" id="4639928">*</span><span class="ident" id="4639929"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4639940">)</span>&nbsp;<span class="op" id="4639942">[</span><span class="op" id="4639943">]</span><span class="op" id="4639944">*</span><span class="ident" id="4639945"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span>&nbsp;<span class="op" id="4639957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4639960">n</span>&nbsp;<span class="op" id="4639962">:=</span>&nbsp;<span class="builtinfunc" id="4639965">make</span><span class="op" id="4639969">(</span><span class="op" id="4639970">[</span><span class="op" id="4639971">]</span><span class="op" id="4639972">*</span><span class="ident" id="4639973"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4639984">,</span>&nbsp;<span class="builtinfunc" id="4639986">len</span><span class="op" id="4639989">(</span><span class="ident" id="4639990"><a href="/gostd/crypto/x509/verify.go.html#4639901">chain</a></span><span class="op" id="4639995">)</span><span class="op" id="4639996">+</span><span class="num" id="4639997">1</span><span class="op" id="4639998">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4640001">copy</span><span class="op" id="4640005">(</span><span class="ident" id="4640006"><a href="/gostd/crypto/x509/verify.go.html#4639960">n</a></span><span class="op" id="4640007">,</span>&nbsp;<span class="ident" id="4640009"><a href="/gostd/crypto/x509/verify.go.html#4639901">chain</a></span><span class="op" id="4640014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640017"><a href="/gostd/crypto/x509/verify.go.html#4639960">n</a></span><span class="op" id="4640018">[</span><span class="builtinfunc" id="4640019">len</span><span class="op" id="4640022">(</span><span class="ident" id="4640023"><a href="/gostd/crypto/x509/verify.go.html#4639901">chain</a></span><span class="op" id="4640028">)</span><span class="op" id="4640029">]</span>&nbsp;<span class="op" id="4640031">=</span>&nbsp;<span class="ident" id="4640033"><a href="/gostd/crypto/x509/verify.go.html#4639923">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640039">return</span>&nbsp;<span class="ident" id="4640046"><a href="/gostd/crypto/x509/verify.go.html#4639960">n</a></span><br>
<span class="lineno"></span><span class="op" id="4640048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="4640051">func</span>&nbsp;<span class="op" id="4640056">(</span><span class="ident" id="4640057">c</span>&nbsp;<span class="op" id="4640059">*</span><span class="ident" id="4640060"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4640071">)</span>&nbsp;<span class="ident" id="4640073">buildChains</span><span class="op" id="4640084">(</span><span class="ident" id="4640085">cache</span>&nbsp;<span class="keyword" id="4640091">map</span><span class="op" id="4640094">[</span><span class="builtintype" id="4640095">int</span><span class="op" id="4640098">]</span><span class="op" id="4640099">[</span><span class="op" id="4640100">]</span><span class="op" id="4640101">[</span><span class="op" id="4640102">]</span><span class="op" id="4640103">*</span><span class="ident" id="4640104"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4640115">,</span>&nbsp;<span class="ident" id="4640117">currentChain</span>&nbsp;<span class="op" id="4640130">[</span><span class="op" id="4640131">]</span><span class="op" id="4640132">*</span><span class="ident" id="4640133"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4640144">,</span>&nbsp;<span class="ident" id="4640146">opts</span>&nbsp;<span class="op" id="4640151">*</span><span class="ident" id="4640152"><a href="/gostd/crypto/x509/verify.go.html#4635470">VerifyOptions</a></span><span class="op" id="4640165">)</span>&nbsp;<span class="op" id="4640167">(</span><span class="ident" id="4640168">chains</span>&nbsp;<span class="op" id="4640175">[</span><span class="op" id="4640176">]</span><span class="op" id="4640177">[</span><span class="op" id="4640178">]</span><span class="op" id="4640179">*</span><span class="ident" id="4640180"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4640191">,</span>&nbsp;<span class="ident" id="4640193">err</span>&nbsp;<span class="builtintype" id="4640197">error</span><span class="op" id="4640202">)</span>&nbsp;<span class="op" id="4640204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640207">possibleRoots</span><span class="op" id="4640220">,</span>&nbsp;<span class="ident" id="4640222">failedRoot</span><span class="op" id="4640232">,</span>&nbsp;<span class="ident" id="4640234">rootErr</span>&nbsp;<span class="op" id="4640242">:=</span>&nbsp;<span class="ident" id="4640245"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640249">.</span><span class="ident" id="4640250"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span><span class="op" id="4640255">.</span><span class="ident" id="4640256"><a href="/gostd/crypto/x509/cert_pool.go.html#4613972">findVerifiedParents</a></span><span class="op" id="4640275">(</span><span class="ident" id="4640276"><a href="/gostd/crypto/x509/verify.go.html#4640057">c</a></span><span class="op" id="4640277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640280">for</span>&nbsp;<span class="ident" id="4640284">_</span><span class="op" id="4640285">,</span>&nbsp;<span class="ident" id="4640287">rootNum</span>&nbsp;<span class="op" id="4640295">:=</span>&nbsp;<span class="keyword" id="4640298">range</span>&nbsp;<span class="ident" id="4640304"><a href="/gostd/crypto/x509/verify.go.html#4640207">possibleRoots</a></span>&nbsp;<span class="op" id="4640318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640322">root</span>&nbsp;<span class="op" id="4640327">:=</span>&nbsp;<span class="ident" id="4640330"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640334">.</span><span class="ident" id="4640335"><a href="/gostd/crypto/x509/verify.go.html#4635541">Roots</a></span><span class="op" id="4640340">.</span><span class="ident" id="4640341"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4640346">[</span><span class="ident" id="4640347"><a href="/gostd/crypto/x509/verify.go.html#4640287">rootNum</a></span><span class="op" id="4640354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640358"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4640362">=</span>&nbsp;<span class="ident" id="4640364"><a href="/gostd/crypto/x509/verify.go.html#4640322">root</a></span><span class="op" id="4640368">.</span><span class="ident" id="4640369"><a href="/gostd/crypto/x509/verify.go.html#4636125">isValid</a></span><span class="op" id="4640376">(</span><span class="ident" id="4640377"><a href="/gostd/crypto/x509/verify.go.html#4636038">rootCertificate</a></span><span class="op" id="4640392">,</span>&nbsp;<span class="ident" id="4640394"><a href="/gostd/crypto/x509/verify.go.html#4640117">currentChain</a></span><span class="op" id="4640406">,</span>&nbsp;<span class="ident" id="4640408"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640412">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640416">if</span>&nbsp;<span class="ident" id="4640419"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4640423">!=</span>&nbsp;<span class="builtintype" id="4640426">nil</span>&nbsp;<span class="op" id="4640430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640435">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4640446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640450"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span>&nbsp;<span class="op" id="4640457">=</span>&nbsp;<span class="builtinfunc" id="4640459">append</span><span class="op" id="4640465">(</span><span class="ident" id="4640466"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span><span class="op" id="4640472">,</span>&nbsp;<span class="ident" id="4640474"><a href="/gostd/crypto/x509/verify.go.html#4639882">appendToFreshChain</a></span><span class="op" id="4640492">(</span><span class="ident" id="4640493"><a href="/gostd/crypto/x509/verify.go.html#4640117">currentChain</a></span><span class="op" id="4640505">,</span>&nbsp;<span class="ident" id="4640507"><a href="/gostd/crypto/x509/verify.go.html#4640322">root</a></span><span class="op" id="4640511">)</span><span class="op" id="4640512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4640515">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640519">possibleIntermediates</span><span class="op" id="4640540">,</span>&nbsp;<span class="ident" id="4640542">failedIntermediate</span><span class="op" id="4640560">,</span>&nbsp;<span class="ident" id="4640562">intermediateErr</span>&nbsp;<span class="op" id="4640578">:=</span>&nbsp;<span class="ident" id="4640581"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640585">.</span><span class="ident" id="4640586"><a href="/gostd/crypto/x509/verify.go.html#4635516">Intermediates</a></span><span class="op" id="4640599">.</span><span class="ident" id="4640600"><a href="/gostd/crypto/x509/cert_pool.go.html#4613972">findVerifiedParents</a></span><span class="op" id="4640619">(</span><span class="ident" id="4640620"><a href="/gostd/crypto/x509/verify.go.html#4640057">c</a></span><span class="op" id="4640621">)</span><br>
<span class="lineno"></span><span class="ident" id="4640623">nextIntermediate</span><span class="op" id="4640639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640642">for</span>&nbsp;<span class="ident" id="4640646">_</span><span class="op" id="4640647">,</span>&nbsp;<span class="ident" id="4640649">intermediateNum</span>&nbsp;<span class="op" id="4640665">:=</span>&nbsp;<span class="keyword" id="4640668">range</span>&nbsp;<span class="ident" id="4640674"><a href="/gostd/crypto/x509/verify.go.html#4640519">possibleIntermediates</a></span>&nbsp;<span class="op" id="4640696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640700">intermediate</span>&nbsp;<span class="op" id="4640713">:=</span>&nbsp;<span class="ident" id="4640716"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640720">.</span><span class="ident" id="4640721"><a href="/gostd/crypto/x509/verify.go.html#4635516">Intermediates</a></span><span class="op" id="4640734">.</span><span class="ident" id="4640735"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4640740">[</span><span class="ident" id="4640741"><a href="/gostd/crypto/x509/verify.go.html#4640649">intermediateNum</a></span><span class="op" id="4640756">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640760">for</span>&nbsp;<span class="ident" id="4640764">_</span><span class="op" id="4640765">,</span>&nbsp;<span class="ident" id="4640767">cert</span>&nbsp;<span class="op" id="4640772">:=</span>&nbsp;<span class="keyword" id="4640775">range</span>&nbsp;<span class="ident" id="4640781"><a href="/gostd/crypto/x509/verify.go.html#4640117">currentChain</a></span>&nbsp;<span class="op" id="4640794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640799">if</span>&nbsp;<span class="ident" id="4640802"><a href="/gostd/crypto/x509/verify.go.html#4640767">cert</a></span>&nbsp;<span class="op" id="4640807">==</span>&nbsp;<span class="ident" id="4640810"><a href="/gostd/crypto/x509/verify.go.html#4640700">intermediate</a></span>&nbsp;<span class="op" id="4640823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640829">continue</span>&nbsp;<span class="ident" id="4640838"><a href="/gostd/crypto/x509/verify.go.html#4640623">nextIntermediate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4640858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4640862">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4640866"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4640870">=</span>&nbsp;<span class="ident" id="4640872"><a href="/gostd/crypto/x509/verify.go.html#4640700">intermediate</a></span><span class="op" id="4640884">.</span><span class="ident" id="4640885"><a href="/gostd/crypto/x509/verify.go.html#4636125">isValid</a></span><span class="op" id="4640892">(</span><span class="ident" id="4640893"><a href="/gostd/crypto/x509/verify.go.html#4636013">intermediateCertificate</a></span><span class="op" id="4640916">,</span>&nbsp;<span class="ident" id="4640918"><a href="/gostd/crypto/x509/verify.go.html#4640117">currentChain</a></span><span class="op" id="4640930">,</span>&nbsp;<span class="ident" id="4640932"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4640936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640940">if</span>&nbsp;<span class="ident" id="4640943"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4640947">!=</span>&nbsp;<span class="builtintype" id="4640950">nil</span>&nbsp;<span class="op" id="4640954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640959">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4640970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4640974">var</span>&nbsp;<span class="ident" id="4640978">childChains</span>&nbsp;<span class="op" id="4640990">[</span><span class="op" id="4640991">]</span><span class="op" id="4640992">[</span><span class="op" id="4640993">]</span><span class="op" id="4640994">*</span><span class="ident" id="4640995"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641009"><a href="/gostd/crypto/x509/verify.go.html#4640978">childChains</a></span><span class="op" id="4641020">,</span>&nbsp;<span class="ident" id="4641022">ok</span>&nbsp;<span class="op" id="4641025">:=</span>&nbsp;<span class="ident" id="4641028"><a href="/gostd/crypto/x509/verify.go.html#4640085">cache</a></span><span class="op" id="4641033">[</span><span class="ident" id="4641034"><a href="/gostd/crypto/x509/verify.go.html#4640649">intermediateNum</a></span><span class="op" id="4641049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641053">if</span>&nbsp;<span class="op" id="4641056">!</span><span class="ident" id="4641057"><a href="/gostd/crypto/x509/verify.go.html#4641022">ok</a></span>&nbsp;<span class="op" id="4641060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641065"><a href="/gostd/crypto/x509/verify.go.html#4640978">childChains</a></span><span class="op" id="4641076">,</span>&nbsp;<span class="ident" id="4641078"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4641082">=</span>&nbsp;<span class="ident" id="4641084"><a href="/gostd/crypto/x509/verify.go.html#4640700">intermediate</a></span><span class="op" id="4641096">.</span><span class="ident" id="4641097"><a href="/gostd/crypto/x509/verify.go.html#4640073">buildChains</a></span><span class="op" id="4641108">(</span><span class="ident" id="4641109"><a href="/gostd/crypto/x509/verify.go.html#4640085">cache</a></span><span class="op" id="4641114">,</span>&nbsp;<span class="ident" id="4641116"><a href="/gostd/crypto/x509/verify.go.html#4639882">appendToFreshChain</a></span><span class="op" id="4641134">(</span><span class="ident" id="4641135"><a href="/gostd/crypto/x509/verify.go.html#4640117">currentChain</a></span><span class="op" id="4641147">,</span>&nbsp;<span class="ident" id="4641149"><a href="/gostd/crypto/x509/verify.go.html#4640700">intermediate</a></span><span class="op" id="4641161">)</span><span class="op" id="4641162">,</span>&nbsp;<span class="ident" id="4641164"><a href="/gostd/crypto/x509/verify.go.html#4640146">opts</a></span><span class="op" id="4641168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641173"><a href="/gostd/crypto/x509/verify.go.html#4640085">cache</a></span><span class="op" id="4641178">[</span><span class="ident" id="4641179"><a href="/gostd/crypto/x509/verify.go.html#4640649">intermediateNum</a></span><span class="op" id="4641194">]</span>&nbsp;<span class="op" id="4641196">=</span>&nbsp;<span class="ident" id="4641198"><a href="/gostd/crypto/x509/verify.go.html#4640978">childChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641212">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641216"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span>&nbsp;<span class="op" id="4641223">=</span>&nbsp;<span class="builtinfunc" id="4641225">append</span><span class="op" id="4641231">(</span><span class="ident" id="4641232"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span><span class="op" id="4641238">,</span>&nbsp;<span class="ident" id="4641240"><a href="/gostd/crypto/x509/verify.go.html#4640978">childChains</a></span><span class="op" id="4641251">...</span><span class="op" id="4641254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641261">if</span>&nbsp;<span class="builtinfunc" id="4641264">len</span><span class="op" id="4641267">(</span><span class="ident" id="4641268"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span><span class="op" id="4641274">)</span>&nbsp;<span class="op" id="4641276">&gt;</span>&nbsp;<span class="num" id="4641278">0</span>&nbsp;<span class="op" id="4641280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641284"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4641288">=</span>&nbsp;<span class="builtintype" id="4641290">nil</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641299">if</span>&nbsp;<span class="builtinfunc" id="4641302">len</span><span class="op" id="4641305">(</span><span class="ident" id="4641306"><a href="/gostd/crypto/x509/verify.go.html#4640168">chains</a></span><span class="op" id="4641312">)</span>&nbsp;<span class="op" id="4641314">==</span>&nbsp;<span class="num" id="4641317">0</span>&nbsp;<span class="op" id="4641319">&amp;&amp;</span>&nbsp;<span class="ident" id="4641322"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4641326">==</span>&nbsp;<span class="builtintype" id="4641329">nil</span>&nbsp;<span class="op" id="4641333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641337">hintErr</span>&nbsp;<span class="op" id="4641345">:=</span>&nbsp;<span class="ident" id="4641348"><a href="/gostd/crypto/x509/verify.go.html#4640234">rootErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641358">hintCert</span>&nbsp;<span class="op" id="4641367">:=</span>&nbsp;<span class="ident" id="4641370"><a href="/gostd/crypto/x509/verify.go.html#4640222">failedRoot</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641383">if</span>&nbsp;<span class="ident" id="4641386"><a href="/gostd/crypto/x509/verify.go.html#4641337">hintErr</a></span>&nbsp;<span class="op" id="4641394">==</span>&nbsp;<span class="builtintype" id="4641397">nil</span>&nbsp;<span class="op" id="4641401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641406"><a href="/gostd/crypto/x509/verify.go.html#4641337">hintErr</a></span>&nbsp;<span class="op" id="4641414">=</span>&nbsp;<span class="ident" id="4641416"><a href="/gostd/crypto/x509/verify.go.html#4640562">intermediateErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641435"><a href="/gostd/crypto/x509/verify.go.html#4641358">hintCert</a></span>&nbsp;<span class="op" id="4641444">=</span>&nbsp;<span class="ident" id="4641446"><a href="/gostd/crypto/x509/verify.go.html#4640542">failedIntermediate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641471"><a href="/gostd/crypto/x509/verify.go.html#4640193">err</a></span>&nbsp;<span class="op" id="4641475">=</span>&nbsp;<span class="ident" id="4641477"><a href="/gostd/crypto/x509/verify.go.html#4634284">UnknownAuthorityError</a></span><span class="op" id="4641498">{</span><span class="ident" id="4641499"><a href="/gostd/crypto/x509/verify.go.html#4640057">c</a></span><span class="op" id="4641500">,</span>&nbsp;<span class="ident" id="4641502"><a href="/gostd/crypto/x509/verify.go.html#4641337">hintErr</a></span><span class="op" id="4641509">,</span>&nbsp;<span class="ident" id="4641511"><a href="/gostd/crypto/x509/verify.go.html#4641358">hintCert</a></span><span class="op" id="4641519">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641526">return</span><br>
<span class="lineno"></span><span class="op" id="4641533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="4641536">func</span>&nbsp;<span class="ident" id="4641541">matchHostnames</span><span class="op" id="4641555">(</span><span class="ident" id="4641556">pattern</span><span class="op" id="4641563">,</span>&nbsp;<span class="ident" id="4641565">host</span>&nbsp;<span class="builtintype" id="4641570">string</span><span class="op" id="4641576">)</span>&nbsp;<span class="builtintype" id="4641578">bool</span>&nbsp;<span class="op" id="4641583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641586">if</span>&nbsp;<span class="builtinfunc" id="4641589">len</span><span class="op" id="4641592">(</span><span class="ident" id="4641593"><a href="/gostd/crypto/x509/verify.go.html#4641556">pattern</a></span><span class="op" id="4641600">)</span>&nbsp;<span class="op" id="4641602">==</span>&nbsp;<span class="num" id="4641605">0</span>&nbsp;<span class="op" id="4641607">||</span>&nbsp;<span class="builtinfunc" id="4641610">len</span><span class="op" id="4641613">(</span><span class="ident" id="4641614"><a href="/gostd/crypto/x509/verify.go.html#4641565">host</a></span><span class="op" id="4641618">)</span>&nbsp;<span class="op" id="4641620">==</span>&nbsp;<span class="num" id="4641623">0</span>&nbsp;<span class="op" id="4641625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641629">return</span>&nbsp;<span class="builtintype" id="4641636">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641647">patternParts</span>&nbsp;<span class="op" id="4641660">:=</span>&nbsp;<span class="ident" id="4641663"><a href="/gostd/crypto/x509/verify.go.html#4631840">strings</a></span><span class="op" id="4641670">.</span><span class="ident" id="4641671"><a href="/gostd/strings/strings.go.html#2973136">Split</a></span><span class="op" id="4641676">(</span><span class="ident" id="4641677"><a href="/gostd/crypto/x509/verify.go.html#4641556">pattern</a></span><span class="op" id="4641684">,</span>&nbsp;<span class="string" id="4641686">&#34;.&#34;</span><span class="op" id="4641689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4641692">hostParts</span>&nbsp;<span class="op" id="4641702">:=</span>&nbsp;<span class="ident" id="4641705"><a href="/gostd/crypto/x509/verify.go.html#4631840">strings</a></span><span class="op" id="4641712">.</span><span class="ident" id="4641713"><a href="/gostd/strings/strings.go.html#2973136">Split</a></span><span class="op" id="4641718">(</span><span class="ident" id="4641719"><a href="/gostd/crypto/x509/verify.go.html#4641565">host</a></span><span class="op" id="4641723">,</span>&nbsp;<span class="string" id="4641725">&#34;.&#34;</span><span class="op" id="4641728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641732">if</span>&nbsp;<span class="builtinfunc" id="4641735">len</span><span class="op" id="4641738">(</span><span class="ident" id="4641739"><a href="/gostd/crypto/x509/verify.go.html#4641647">patternParts</a></span><span class="op" id="4641751">)</span>&nbsp;<span class="op" id="4641753">!=</span>&nbsp;<span class="builtinfunc" id="4641756">len</span><span class="op" id="4641759">(</span><span class="ident" id="4641760"><a href="/gostd/crypto/x509/verify.go.html#4641692">hostParts</a></span><span class="op" id="4641769">)</span>&nbsp;<span class="op" id="4641771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641775">return</span>&nbsp;<span class="builtintype" id="4641782">false</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641793">for</span>&nbsp;<span class="ident" id="4641797">i</span><span class="op" id="4641798">,</span>&nbsp;<span class="ident" id="4641800">patternPart</span>&nbsp;<span class="op" id="4641812">:=</span>&nbsp;<span class="keyword" id="4641815">range</span>&nbsp;<span class="ident" id="4641821"><a href="/gostd/crypto/x509/verify.go.html#4641647">patternParts</a></span>&nbsp;<span class="op" id="4641834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641838">if</span>&nbsp;<span class="ident" id="4641841"><a href="/gostd/crypto/x509/verify.go.html#4641800">patternPart</a></span>&nbsp;<span class="op" id="4641853">==</span>&nbsp;<span class="string" id="4641856">&#34;*&#34;</span>&nbsp;<span class="op" id="4641860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641865">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641880">if</span>&nbsp;<span class="ident" id="4641883"><a href="/gostd/crypto/x509/verify.go.html#4641800">patternPart</a></span>&nbsp;<span class="op" id="4641895">!=</span>&nbsp;<span class="ident" id="4641898"><a href="/gostd/crypto/x509/verify.go.html#4641692">hostParts</a></span><span class="op" id="4641907">[</span><span class="ident" id="4641908"><a href="/gostd/crypto/x509/verify.go.html#4641797">i</a></span><span class="op" id="4641909">]</span>&nbsp;<span class="op" id="4641911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641916">return</span>&nbsp;<span class="builtintype" id="4641923">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4641934">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4641938">return</span>&nbsp;<span class="builtintype" id="4641945">true</span><br>
<span class="lineno"></span><span class="op" id="4641950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4641953">//&nbsp;toLowerCaseASCII&nbsp;returns&nbsp;a&nbsp;lower-case&nbsp;version&nbsp;of&nbsp;in.&nbsp;See&nbsp;RFC&nbsp;6125&nbsp;6.4.1.&nbsp;We&nbsp;use</span><br>
<span class="lineno">350</span><span class="comment" id="4642036">//&nbsp;an&nbsp;explicitly&nbsp;ASCII&nbsp;function&nbsp;to&nbsp;avoid&nbsp;any&nbsp;sharp&nbsp;corners&nbsp;resulting&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4642110">//&nbsp;performing&nbsp;Unicode&nbsp;operations&nbsp;on&nbsp;DNS&nbsp;labels.</span><br>
<span class="lineno"></span><span class="keyword" id="4642158">func</span>&nbsp;<span class="ident" id="4642163">toLowerCaseASCII</span><span class="op" id="4642179">(</span><span class="ident" id="4642180">in</span>&nbsp;<span class="builtintype" id="4642183">string</span><span class="op" id="4642189">)</span>&nbsp;<span class="builtintype" id="4642191">string</span>&nbsp;<span class="op" id="4642198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4642201">//&nbsp;If&nbsp;the&nbsp;string&nbsp;is&nbsp;already&nbsp;lower-case&nbsp;then&nbsp;there&#39;s&nbsp;nothing&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642269">isAlreadyLowerCase</span>&nbsp;<span class="op" id="4642288">:=</span>&nbsp;<span class="builtintype" id="4642291">true</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642297">for</span>&nbsp;<span class="ident" id="4642301">_</span><span class="op" id="4642302">,</span>&nbsp;<span class="ident" id="4642304">c</span>&nbsp;<span class="op" id="4642306">:=</span>&nbsp;<span class="keyword" id="4642309">range</span>&nbsp;<span class="ident" id="4642315"><a href="/gostd/crypto/x509/verify.go.html#4642180">in</a></span>&nbsp;<span class="op" id="4642318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642322">if</span>&nbsp;<span class="ident" id="4642325"><a href="/gostd/crypto/x509/verify.go.html#4642304">c</a></span>&nbsp;<span class="op" id="4642327">==</span>&nbsp;<span class="ident" id="4642330"><a href="/gostd/crypto/x509/verify.go.html#4631859">utf8</a></span><span class="op" id="4642334">.</span><span class="ident" id="4642335"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="4642345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4642350">//&nbsp;If&nbsp;we&nbsp;get&nbsp;a&nbsp;UTF-8&nbsp;error&nbsp;then&nbsp;there&nbsp;might&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4642400">//&nbsp;upper-case&nbsp;ASCII&nbsp;bytes&nbsp;in&nbsp;the&nbsp;invalid&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642454"><a href="/gostd/crypto/x509/verify.go.html#4642269">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4642473">=</span>&nbsp;<span class="builtintype" id="4642475">false</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642484">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642496">if</span>&nbsp;<span class="string" id="4642499">&#39;A&#39;</span>&nbsp;<span class="op" id="4642503">&lt;=</span>&nbsp;<span class="ident" id="4642506"><a href="/gostd/crypto/x509/verify.go.html#4642304">c</a></span>&nbsp;<span class="op" id="4642508">&amp;&amp;</span>&nbsp;<span class="ident" id="4642511"><a href="/gostd/crypto/x509/verify.go.html#4642304">c</a></span>&nbsp;<span class="op" id="4642513">&lt;=</span>&nbsp;<span class="string" id="4642516">&#39;Z&#39;</span>&nbsp;<span class="op" id="4642520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642525"><a href="/gostd/crypto/x509/verify.go.html#4642269">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4642544">=</span>&nbsp;<span class="builtintype" id="4642546">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642555">break</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642570">if</span>&nbsp;<span class="ident" id="4642573"><a href="/gostd/crypto/x509/verify.go.html#4642269">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4642592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642596">return</span>&nbsp;<span class="ident" id="4642603"><a href="/gostd/crypto/x509/verify.go.html#4642180">in</a></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642611">out</span>&nbsp;<span class="op" id="4642615">:=</span>&nbsp;<span class="op" id="4642618">[</span><span class="op" id="4642619">]</span><span class="builtintype" id="4642620">byte</span><span class="op" id="4642624">(</span><span class="ident" id="4642625"><a href="/gostd/crypto/x509/verify.go.html#4642180">in</a></span><span class="op" id="4642627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642630">for</span>&nbsp;<span class="ident" id="4642634">i</span><span class="op" id="4642635">,</span>&nbsp;<span class="ident" id="4642637">c</span>&nbsp;<span class="op" id="4642639">:=</span>&nbsp;<span class="keyword" id="4642642">range</span>&nbsp;<span class="ident" id="4642648"><a href="/gostd/crypto/x509/verify.go.html#4642611">out</a></span>&nbsp;<span class="op" id="4642652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642656">if</span>&nbsp;<span class="string" id="4642659">&#39;A&#39;</span>&nbsp;<span class="op" id="4642663">&lt;=</span>&nbsp;<span class="ident" id="4642666"><a href="/gostd/crypto/x509/verify.go.html#4642637">c</a></span>&nbsp;<span class="op" id="4642668">&amp;&amp;</span>&nbsp;<span class="ident" id="4642671"><a href="/gostd/crypto/x509/verify.go.html#4642637">c</a></span>&nbsp;<span class="op" id="4642673">&lt;=</span>&nbsp;<span class="string" id="4642676">&#39;Z&#39;</span>&nbsp;<span class="op" id="4642680">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642685"><a href="/gostd/crypto/x509/verify.go.html#4642611">out</a></span><span class="op" id="4642688">[</span><span class="ident" id="4642689"><a href="/gostd/crypto/x509/verify.go.html#4642634">i</a></span><span class="op" id="4642690">]</span>&nbsp;<span class="op" id="4642692">+=</span>&nbsp;<span class="string" id="4642695">&#39;a&#39;</span>&nbsp;<span class="op" id="4642699">-</span>&nbsp;<span class="string" id="4642701">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4642710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642713">return</span>&nbsp;<span class="builtintype" id="4642720">string</span><span class="op" id="4642726">(</span><span class="ident" id="4642727"><a href="/gostd/crypto/x509/verify.go.html#4642611">out</a></span><span class="op" id="4642730">)</span><br>
<span class="lineno"></span><span class="op" id="4642732">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="comment" id="4642735">//&nbsp;VerifyHostname&nbsp;returns&nbsp;nil&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;certificate&nbsp;for&nbsp;the&nbsp;named&nbsp;host.</span><br>
<span class="lineno"></span><span class="comment" id="4642813">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;an&nbsp;error&nbsp;describing&nbsp;the&nbsp;mismatch.</span><br>
<span class="lineno"></span><span class="keyword" id="4642871">func</span>&nbsp;<span class="op" id="4642876">(</span><span class="ident" id="4642877">c</span>&nbsp;<span class="op" id="4642879">*</span><span class="ident" id="4642880"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4642891">)</span>&nbsp;<span class="ident" id="4642893">VerifyHostname</span><span class="op" id="4642907">(</span><span class="ident" id="4642908">h</span>&nbsp;<span class="builtintype" id="4642910">string</span><span class="op" id="4642916">)</span>&nbsp;<span class="builtintype" id="4642918">error</span>&nbsp;<span class="op" id="4642924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4642927">//&nbsp;IP&nbsp;addresses&nbsp;may&nbsp;be&nbsp;written&nbsp;in&nbsp;[&nbsp;].</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4642967">candidateIP</span>&nbsp;<span class="op" id="4642979">:=</span>&nbsp;<span class="ident" id="4642982"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4642985">if</span>&nbsp;<span class="builtinfunc" id="4642988">len</span><span class="op" id="4642991">(</span><span class="ident" id="4642992"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4642993">)</span>&nbsp;<span class="op" id="4642995">&gt;=</span>&nbsp;<span class="num" id="4642998">3</span>&nbsp;<span class="op" id="4643000">&amp;&amp;</span>&nbsp;<span class="ident" id="4643003"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643004">[</span><span class="num" id="4643005">0</span><span class="op" id="4643006">]</span>&nbsp;<span class="op" id="4643008">==</span>&nbsp;<span class="string" id="4643011">&#39;[&#39;</span>&nbsp;<span class="op" id="4643015">&amp;&amp;</span>&nbsp;<span class="ident" id="4643018"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643019">[</span><span class="builtinfunc" id="4643020">len</span><span class="op" id="4643023">(</span><span class="ident" id="4643024"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643025">)</span><span class="op" id="4643026">-</span><span class="num" id="4643027">1</span><span class="op" id="4643028">]</span>&nbsp;<span class="op" id="4643030">==</span>&nbsp;<span class="string" id="4643033">&#39;]&#39;</span>&nbsp;<span class="op" id="4643037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643041"><a href="/gostd/crypto/x509/verify.go.html#4642967">candidateIP</a></span>&nbsp;<span class="op" id="4643053">=</span>&nbsp;<span class="ident" id="4643055"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643056">[</span><span class="num" id="4643057">1</span>&nbsp;<span class="op" id="4643059">:</span>&nbsp;<span class="builtinfunc" id="4643061">len</span><span class="op" id="4643064">(</span><span class="ident" id="4643065"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643066">)</span><span class="op" id="4643067">-</span><span class="num" id="4643068">1</span><span class="op" id="4643069">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643075">if</span>&nbsp;<span class="ident" id="4643078">ip</span>&nbsp;<span class="op" id="4643081">:=</span>&nbsp;<span class="ident" id="4643084"><a href="/gostd/crypto/x509/verify.go.html#4631822">net</a></span><span class="op" id="4643087">.</span><span class="ident" id="4643088"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="4643095">(</span><span class="ident" id="4643096"><a href="/gostd/crypto/x509/verify.go.html#4642967">candidateIP</a></span><span class="op" id="4643107">)</span><span class="op" id="4643108">;</span>&nbsp;<span class="ident" id="4643110"><a href="/gostd/crypto/x509/verify.go.html#4643078">ip</a></span>&nbsp;<span class="op" id="4643113">!=</span>&nbsp;<span class="builtintype" id="4643116">nil</span>&nbsp;<span class="op" id="4643120">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4643124">//&nbsp;We&nbsp;only&nbsp;match&nbsp;IP&nbsp;addresses&nbsp;against&nbsp;IP&nbsp;SANs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4643173">//&nbsp;https://tools.ietf.org/html/rfc6125#appendix-B.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643227">for</span>&nbsp;<span class="ident" id="4643231">_</span><span class="op" id="4643232">,</span>&nbsp;<span class="ident" id="4643234">candidate</span>&nbsp;<span class="op" id="4643244">:=</span>&nbsp;<span class="keyword" id="4643247">range</span>&nbsp;<span class="ident" id="4643253"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643254">.</span><span class="ident" id="4643255"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span>&nbsp;<span class="op" id="4643267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643272">if</span>&nbsp;<span class="ident" id="4643275"><a href="/gostd/crypto/x509/verify.go.html#4643078">ip</a></span><span class="op" id="4643277">.</span><span class="ident" id="4643278"><a href="/gostd/net/ip.go.html#3293893">Equal</a></span><span class="op" id="4643283">(</span><span class="ident" id="4643284"><a href="/gostd/crypto/x509/verify.go.html#4643234">candidate</a></span><span class="op" id="4643293">)</span>&nbsp;<span class="op" id="4643295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643301">return</span>&nbsp;<span class="builtintype" id="4643308">nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643323">return</span>&nbsp;<span class="ident" id="4643330"><a href="/gostd/crypto/x509/verify.go.html#4633529">HostnameError</a></span><span class="op" id="4643343">{</span><span class="ident" id="4643344"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643345">,</span>&nbsp;<span class="ident" id="4643347"><a href="/gostd/crypto/x509/verify.go.html#4642967">candidateIP</a></span><span class="op" id="4643358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643365">lowered</span>&nbsp;<span class="op" id="4643373">:=</span>&nbsp;<span class="ident" id="4643376"><a href="/gostd/crypto/x509/verify.go.html#4642163">toLowerCaseASCII</a></span><span class="op" id="4643392">(</span><span class="ident" id="4643393"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643398">if</span>&nbsp;<span class="builtinfunc" id="4643401">len</span><span class="op" id="4643404">(</span><span class="ident" id="4643405"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643406">.</span><span class="ident" id="4643407"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4643415">)</span>&nbsp;<span class="op" id="4643417">&gt;</span>&nbsp;<span class="num" id="4643419">0</span>&nbsp;<span class="op" id="4643421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643425">for</span>&nbsp;<span class="ident" id="4643429">_</span><span class="op" id="4643430">,</span>&nbsp;<span class="ident" id="4643432">match</span>&nbsp;<span class="op" id="4643438">:=</span>&nbsp;<span class="keyword" id="4643441">range</span>&nbsp;<span class="ident" id="4643447"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643448">.</span><span class="ident" id="4643449"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span>&nbsp;<span class="op" id="4643458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643463">if</span>&nbsp;<span class="ident" id="4643466"><a href="/gostd/crypto/x509/verify.go.html#4641541">matchHostnames</a></span><span class="op" id="4643480">(</span><span class="ident" id="4643481"><a href="/gostd/crypto/x509/verify.go.html#4642163">toLowerCaseASCII</a></span><span class="op" id="4643497">(</span><span class="ident" id="4643498"><a href="/gostd/crypto/x509/verify.go.html#4643432">match</a></span><span class="op" id="4643503">)</span><span class="op" id="4643504">,</span>&nbsp;<span class="ident" id="4643506"><a href="/gostd/crypto/x509/verify.go.html#4643365">lowered</a></span><span class="op" id="4643513">)</span>&nbsp;<span class="op" id="4643515">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643521">return</span>&nbsp;<span class="builtintype" id="4643528">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4643543">//&nbsp;If&nbsp;Subject&nbsp;Alt&nbsp;Name&nbsp;is&nbsp;given,&nbsp;we&nbsp;ignore&nbsp;the&nbsp;common&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643604">}</span>&nbsp;<span class="keyword" id="4643606">else</span>&nbsp;<span class="keyword" id="4643611">if</span>&nbsp;<span class="ident" id="4643614"><a href="/gostd/crypto/x509/verify.go.html#4641541">matchHostnames</a></span><span class="op" id="4643628">(</span><span class="ident" id="4643629"><a href="/gostd/crypto/x509/verify.go.html#4642163">toLowerCaseASCII</a></span><span class="op" id="4643645">(</span><span class="ident" id="4643646"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643647">.</span><span class="ident" id="4643648"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4643655">.</span><span class="ident" id="4643656"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408461">CommonName</a></span><span class="op" id="4643666">)</span><span class="op" id="4643667">,</span>&nbsp;<span class="ident" id="4643669"><a href="/gostd/crypto/x509/verify.go.html#4643365">lowered</a></span><span class="op" id="4643676">)</span>&nbsp;<span class="op" id="4643678">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643682">return</span>&nbsp;<span class="builtintype" id="4643689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643698">return</span>&nbsp;<span class="ident" id="4643705"><a href="/gostd/crypto/x509/verify.go.html#4633529">HostnameError</a></span><span class="op" id="4643718">{</span><span class="ident" id="4643719"><a href="/gostd/crypto/x509/verify.go.html#4642877">c</a></span><span class="op" id="4643720">,</span>&nbsp;<span class="ident" id="4643722"><a href="/gostd/crypto/x509/verify.go.html#4642908">h</a></span><span class="op" id="4643723">}</span><br>
<span class="lineno"></span><span class="op" id="4643725">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="4643728">func</span>&nbsp;<span class="ident" id="4643733">checkChainForKeyUsage</span><span class="op" id="4643754">(</span><span class="ident" id="4643755">chain</span>&nbsp;<span class="op" id="4643761">[</span><span class="op" id="4643762">]</span><span class="op" id="4643763">*</span><span class="ident" id="4643764"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4643775">,</span>&nbsp;<span class="ident" id="4643777">keyUsages</span>&nbsp;<span class="op" id="4643787">[</span><span class="op" id="4643788">]</span><span class="ident" id="4643789"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="4643800">)</span>&nbsp;<span class="builtintype" id="4643802">bool</span>&nbsp;<span class="op" id="4643807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643810">usages</span>&nbsp;<span class="op" id="4643817">:=</span>&nbsp;<span class="builtinfunc" id="4643820">make</span><span class="op" id="4643824">(</span><span class="op" id="4643825">[</span><span class="op" id="4643826">]</span><span class="ident" id="4643827"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="4643838">,</span>&nbsp;<span class="builtinfunc" id="4643840">len</span><span class="op" id="4643843">(</span><span class="ident" id="4643844"><a href="/gostd/crypto/x509/verify.go.html#4643777">keyUsages</a></span><span class="op" id="4643853">)</span><span class="op" id="4643854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4643857">copy</span><span class="op" id="4643861">(</span><span class="ident" id="4643862"><a href="/gostd/crypto/x509/verify.go.html#4643810">usages</a></span><span class="op" id="4643868">,</span>&nbsp;<span class="ident" id="4643870"><a href="/gostd/crypto/x509/verify.go.html#4643777">keyUsages</a></span><span class="op" id="4643879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643883">if</span>&nbsp;<span class="builtinfunc" id="4643886">len</span><span class="op" id="4643889">(</span><span class="ident" id="4643890"><a href="/gostd/crypto/x509/verify.go.html#4643755">chain</a></span><span class="op" id="4643895">)</span>&nbsp;<span class="op" id="4643897">==</span>&nbsp;<span class="num" id="4643900">0</span>&nbsp;<span class="op" id="4643902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4643906">return</span>&nbsp;<span class="builtintype" id="4643913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4643920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4643924">usagesRemaining</span>&nbsp;<span class="op" id="4643940">:=</span>&nbsp;<span class="builtinfunc" id="4643943">len</span><span class="op" id="4643946">(</span><span class="ident" id="4643947"><a href="/gostd/crypto/x509/verify.go.html#4643810">usages</a></span><span class="op" id="4643953">)</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4643957">//&nbsp;We&nbsp;walk&nbsp;down&nbsp;the&nbsp;list&nbsp;and&nbsp;cross&nbsp;out&nbsp;any&nbsp;usages&nbsp;that&nbsp;aren&#39;t&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644030">//&nbsp;by&nbsp;each&nbsp;certificate.&nbsp;If&nbsp;we&nbsp;cross&nbsp;out&nbsp;all&nbsp;the&nbsp;usages,&nbsp;then&nbsp;the&nbsp;chain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644102">//&nbsp;is&nbsp;unacceptable.</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="ident" id="4644123">NextCert</span><span class="op" id="4644131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644134">for</span>&nbsp;<span class="ident" id="4644138">i</span>&nbsp;<span class="op" id="4644140">:=</span>&nbsp;<span class="builtinfunc" id="4644143">len</span><span class="op" id="4644146">(</span><span class="ident" id="4644147"><a href="/gostd/crypto/x509/verify.go.html#4643755">chain</a></span><span class="op" id="4644152">)</span>&nbsp;<span class="op" id="4644154">-</span>&nbsp;<span class="num" id="4644156">1</span><span class="op" id="4644157">;</span>&nbsp;<span class="ident" id="4644159"><a href="/gostd/crypto/x509/verify.go.html#4644138">i</a></span>&nbsp;<span class="op" id="4644161">&gt;=</span>&nbsp;<span class="num" id="4644164">0</span><span class="op" id="4644165">;</span>&nbsp;<span class="ident" id="4644167"><a href="/gostd/crypto/x509/verify.go.html#4644138">i</a></span><span class="op" id="4644168">--</span>&nbsp;<span class="op" id="4644171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4644175">cert</span>&nbsp;<span class="op" id="4644180">:=</span>&nbsp;<span class="ident" id="4644183"><a href="/gostd/crypto/x509/verify.go.html#4643755">chain</a></span><span class="op" id="4644188">[</span><span class="ident" id="4644189"><a href="/gostd/crypto/x509/verify.go.html#4644138">i</a></span><span class="op" id="4644190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644194">if</span>&nbsp;<span class="builtinfunc" id="4644197">len</span><span class="op" id="4644200">(</span><span class="ident" id="4644201"><a href="/gostd/crypto/x509/verify.go.html#4644175">cert</a></span><span class="op" id="4644205">.</span><span class="ident" id="4644206"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="4644217">)</span>&nbsp;<span class="op" id="4644219">==</span>&nbsp;<span class="num" id="4644222">0</span>&nbsp;<span class="op" id="4644224">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4644227">len</span><span class="op" id="4644230">(</span><span class="ident" id="4644231"><a href="/gostd/crypto/x509/verify.go.html#4644175">cert</a></span><span class="op" id="4644235">.</span><span class="ident" id="4644236"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="4644254">)</span>&nbsp;<span class="op" id="4644256">==</span>&nbsp;<span class="num" id="4644259">0</span>&nbsp;<span class="op" id="4644261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644266">//&nbsp;The&nbsp;certificate&nbsp;doesn&#39;t&nbsp;have&nbsp;any&nbsp;extended&nbsp;key&nbsp;usage&nbsp;specified.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644335">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644351">for</span>&nbsp;<span class="ident" id="4644355">_</span><span class="op" id="4644356">,</span>&nbsp;<span class="ident" id="4644358">usage</span>&nbsp;<span class="op" id="4644364">:=</span>&nbsp;<span class="keyword" id="4644367">range</span>&nbsp;<span class="ident" id="4644373"><a href="/gostd/crypto/x509/verify.go.html#4644175">cert</a></span><span class="op" id="4644377">.</span><span class="ident" id="4644378"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4644390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644395">if</span>&nbsp;<span class="ident" id="4644398"><a href="/gostd/crypto/x509/verify.go.html#4644358">usage</a></span>&nbsp;<span class="op" id="4644404">==</span>&nbsp;<span class="ident" id="4644407"><a href="/gostd/crypto/x509/x509.go.html#4658112">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4644422">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644428">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;explicitly&nbsp;good&nbsp;for&nbsp;any&nbsp;usage.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644485">continue</span>&nbsp;<span class="ident" id="4644494"><a href="/gostd/crypto/x509/verify.go.html#4644123">NextCert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644515">const</span>&nbsp;<span class="ident" id="4644521">invalidUsage</span>&nbsp;<span class="ident" id="4644534"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4644546">=</span>&nbsp;<span class="op" id="4644548">-</span><span class="num" id="4644549">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4644553">NextRequestedUsage</span><span class="op" id="4644571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644575">for</span>&nbsp;<span class="ident" id="4644579">i</span><span class="op" id="4644580">,</span>&nbsp;<span class="ident" id="4644582">requestedUsage</span>&nbsp;<span class="op" id="4644597">:=</span>&nbsp;<span class="keyword" id="4644600">range</span>&nbsp;<span class="ident" id="4644606"><a href="/gostd/crypto/x509/verify.go.html#4643810">usages</a></span>&nbsp;<span class="op" id="4644613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644618">if</span>&nbsp;<span class="ident" id="4644621"><a href="/gostd/crypto/x509/verify.go.html#4644582">requestedUsage</a></span>&nbsp;<span class="op" id="4644636">==</span>&nbsp;<span class="ident" id="4644639"><a href="/gostd/crypto/x509/verify.go.html#4644521">invalidUsage</a></span>&nbsp;<span class="op" id="4644652">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644658">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644676">for</span>&nbsp;<span class="ident" id="4644680">_</span><span class="op" id="4644681">,</span>&nbsp;<span class="ident" id="4644683">usage</span>&nbsp;<span class="op" id="4644689">:=</span>&nbsp;<span class="keyword" id="4644692">range</span>&nbsp;<span class="ident" id="4644698"><a href="/gostd/crypto/x509/verify.go.html#4644175">cert</a></span><span class="op" id="4644702">.</span><span class="ident" id="4644703"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4644715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644721">if</span>&nbsp;<span class="ident" id="4644724"><a href="/gostd/crypto/x509/verify.go.html#4644582">requestedUsage</a></span>&nbsp;<span class="op" id="4644739">==</span>&nbsp;<span class="ident" id="4644742"><a href="/gostd/crypto/x509/verify.go.html#4644683">usage</a></span>&nbsp;<span class="op" id="4644748">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4644755">continue</span>&nbsp;<span class="ident" id="4644764"><a href="/gostd/crypto/x509/verify.go.html#4644553">NextRequestedUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644787">}</span>&nbsp;<span class="keyword" id="4644789">else</span>&nbsp;<span class="keyword" id="4644794">if</span>&nbsp;<span class="ident" id="4644797"><a href="/gostd/crypto/x509/verify.go.html#4644582">requestedUsage</a></span>&nbsp;<span class="op" id="4644812">==</span>&nbsp;<span class="ident" id="4644815"><a href="/gostd/crypto/x509/x509.go.html#4658147">ExtKeyUsageServerAuth</a></span>&nbsp;<span class="op" id="4644837">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4644845">(</span><span class="ident" id="4644846"><a href="/gostd/crypto/x509/verify.go.html#4644683">usage</a></span>&nbsp;<span class="op" id="4644852">==</span>&nbsp;<span class="ident" id="4644855"><a href="/gostd/crypto/x509/x509.go.html#4658406">ExtKeyUsageNetscapeServerGatedCrypto</a></span>&nbsp;<span class="op" id="4644892">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4644901"><a href="/gostd/crypto/x509/verify.go.html#4644683">usage</a></span>&nbsp;<span class="op" id="4644907">==</span>&nbsp;<span class="ident" id="4644910"><a href="/gostd/crypto/x509/x509.go.html#4658367">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4644947">)</span>&nbsp;<span class="op" id="4644949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644956">//&nbsp;In&nbsp;order&nbsp;to&nbsp;support&nbsp;COMODO</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4644991">//&nbsp;certificate&nbsp;chains,&nbsp;we&nbsp;have&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4645030">//&nbsp;accept&nbsp;Netscape&nbsp;or&nbsp;Microsoft&nbsp;SGC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4645071">//&nbsp;usages&nbsp;as&nbsp;equal&nbsp;to&nbsp;ServerAuth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645110">continue</span>&nbsp;<span class="ident" id="4645119"><a href="/gostd/crypto/x509/verify.go.html#4644553">NextRequestedUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645142">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645153"><a href="/gostd/crypto/x509/verify.go.html#4643810">usages</a></span><span class="op" id="4645159">[</span><span class="ident" id="4645160"><a href="/gostd/crypto/x509/verify.go.html#4644579">i</a></span><span class="op" id="4645161">]</span>&nbsp;<span class="op" id="4645163">=</span>&nbsp;<span class="ident" id="4645165"><a href="/gostd/crypto/x509/verify.go.html#4644521">invalidUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645181"><a href="/gostd/crypto/x509/verify.go.html#4643924">usagesRemaining</a></span><span class="op" id="4645196">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645202">if</span>&nbsp;<span class="ident" id="4645205"><a href="/gostd/crypto/x509/verify.go.html#4643924">usagesRemaining</a></span>&nbsp;<span class="op" id="4645221">==</span>&nbsp;<span class="num" id="4645224">0</span>&nbsp;<span class="op" id="4645226">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645232">return</span>&nbsp;<span class="builtintype" id="4645239">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645259">return</span>&nbsp;<span class="builtintype" id="4645266">true</span><br>
<span class="lineno"></span><span class="op" id="4645271">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
